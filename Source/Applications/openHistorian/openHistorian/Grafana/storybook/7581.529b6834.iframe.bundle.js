"use strict";(self.webpackChunk_grafana_ui=self.webpackChunk_grafana_ui||[]).push([[7581],{"../grafana-data/src/dataframe/processDataFrame.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{KR:function(){return getTimeField},dF:function(){return guessFieldTypeForField},HW:function(){return guessFieldTypeFromValue},ci:function(){return isDataFrame},LI:function(){return isDataFrameWithValue},ES:function(){return sortDataFrame},Kl:function(){return toDataFrameDTO}});var lodash=__webpack_require__("../../node_modules/lodash/lodash.js"),moment_wrapper=__webpack_require__("../grafana-data/src/datetime/moment_wrapper.ts"),dataFrame=__webpack_require__("../grafana-data/src/types/dataFrame.ts"),fieldIndexComparer=function(field){var reverse=arguments.length>1&&void 0!==arguments[1]&&arguments[1],values=field.values;switch(field.type){case dataFrame.PU.number:return numericIndexComparer(values,reverse);case dataFrame.PU.string:return stringIndexComparer(values,reverse);case dataFrame.PU.boolean:return booleanIndexComparer(values,reverse);case dataFrame.PU.time:return"number"==typeof field.values[0]?timestampIndexComparer(values,reverse):timeIndexComparer(values,reverse);default:return naturalIndexComparer(reverse)}},timeComparer=function(a,b){if(!a||!b)return falsyComparer(a,b);if((0,lodash.isNumber)(a)&&(0,lodash.isNumber)(b))return numericComparer(a,b);if((0,moment_wrapper.u8)(a)&&(0,moment_wrapper.u8)(b)){if((0,moment_wrapper.KQ)(a).isBefore(b))return-1;if((0,moment_wrapper.KQ)(b).isBefore(a))return 1}return 0},numericComparer=function(a,b){return a-b},stringComparer=function(a,b){return a&&b?a.localeCompare(b):falsyComparer(a,b)},booleanComparer=function(a,b){return falsyComparer(a,b)},falsyComparer=function(a,b){return!a&&b?1:a&&!b?-1:0},timestampIndexComparer=function(values,reverse){var mult=reverse?-1:1;return function(a,b){return mult*(values[a]-values[b])}},timeIndexComparer=function(values,reverse){return function(a,b){var vA=values[a],vB=values[b];return reverse?timeComparer(vB,vA):timeComparer(vA,vB)}},booleanIndexComparer=function(values,reverse){return function(a,b){var vA=values[a],vB=values[b];return reverse?booleanComparer(vB,vA):booleanComparer(vA,vB)}},numericIndexComparer=function(values,reverse){return function(a,b){var vA=values[a],vB=values[b];return reverse?numericComparer(vB,vA):numericComparer(vA,vB)}},stringIndexComparer=function(values,reverse){return function(a,b){var vA=values[a],vB=values[b];return reverse?stringComparer(vB,vA):stringComparer(vA,vB)}},naturalIndexComparer=function(reverse){return function(a,b){return reverse?numericComparer(b,a):numericComparer(a,b)}};function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _instanceof(left,right){return null!=right&&"undefined"!=typeof Symbol&&right[Symbol.hasInstance]?!!right[Symbol.hasInstance](left):left instanceof right}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}var NUMBER=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function guessFieldTypeFromValue(v){return _instanceof(v,Date)||(0,moment_wrapper.Ar)(v)?dataFrame.PU.time:(0,lodash.isNumber)(v)?dataFrame.PU.number:(0,lodash.isString)(v)?NUMBER.test(v)?dataFrame.PU.number:"true"===v||"TRUE"===v||"True"===v||"false"===v||"FALSE"===v||"False"===v?dataFrame.PU.boolean:dataFrame.PU.string:(0,lodash.isBoolean)(v)?dataFrame.PU.boolean:dataFrame.PU.other}function guessFieldTypeForField(field){if(field.name){var name=field.name.toLowerCase();if("date"===name||"time"===name)return dataFrame.PU.time}for(var i=0;i<field.values.length;i++){var v=field.values[i];if(null!=v)return guessFieldTypeFromValue(v)}}var isDataFrame=function(data){return Boolean(data&&data.hasOwnProperty("fields"))},isDataFrameWithValue=function(data){return Boolean(isDataFrame(data)&&data.hasOwnProperty("value"))};function sortDataFrame(data,sortIndex){var reverse=arguments.length>2&&void 0!==arguments[2]&&arguments[2],field=data.fields[sortIndex];if(!field)return data;for(var index=[],i=0;i<data.length;i++)index.push(i);var fieldComparer=fieldIndexComparer(field,reverse);return index.sort(fieldComparer),_object_spread_props(_object_spread({},data),{fields:data.fields.map((function(f){var newF=_object_spread_props(_object_spread({},f),{values:f.values.map((function(v,i){return f.values[index[i]]}))}),nanos=f.nanos;return void 0!==nanos&&(newF.nanos=nanos.map((function(n,i){return nanos[index[i]]}))),newF}))})}function toDataFrameDTO(data){return function toFilteredDataFrameDTO(data,fieldPredicate){var filteredFields=fieldPredicate?data.fields.filter(fieldPredicate):data.fields;return{fields:filteredFields.map((function(f){var values=f.values;return{name:f.name,type:f.type,config:f.config,values:values,labels:f.labels}})),refId:data.refId,meta:data.meta,name:data.name}}(data)}var getTimeField=function(series){for(var i=0;i<series.fields.length;i++)if(series.fields[i].type===dataFrame.PU.time)return{timeField:series.fields[i],timeIndex:i};return{}}},"../grafana-data/src/field/fieldState.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Ct:function(){return getFieldDisplayName}});var dataFrame=__webpack_require__("../grafana-data/src/types/dataFrame.ts");function getFieldDisplayName(field,frame,allFrames){var _field_state,_field_state1,existingTitle=null===(_field_state=field.state)||void 0===_field_state?void 0:_field_state.displayName,multipleFrames=Boolean(allFrames&&allFrames.length>1);if(existingTitle&&multipleFrames===(null===(_field_state1=field.state)||void 0===_field_state1?void 0:_field_state1.multipleFrames))return existingTitle;var displayName=function calculateFieldDisplayName(field,frame,allFrames){var _field_config,_field_config1,_frame_meta_timeCompare,_frame_meta,_field_config2,hasConfigTitle=(null===(_field_config=field.config)||void 0===_field_config?void 0:_field_config.displayName)&&(null===(_field_config1=field.config)||void 0===_field_config1?void 0:_field_config1.displayName.length),isComparisonSeries=Boolean(null==frame||null===(_frame_meta=frame.meta)||void 0===_frame_meta||null===(_frame_meta_timeCompare=_frame_meta.timeCompare)||void 0===_frame_meta_timeCompare?void 0:_frame_meta_timeCompare.isTimeShiftQuery),displayName=hasConfigTitle?field.config.displayName:field.name;if(hasConfigTitle)return isComparisonSeries?"".concat(displayName," (comparison)"):displayName;if(frame&&(null===(_field_config2=field.config)||void 0===_field_config2?void 0:_field_config2.displayNameFromDS))return isComparisonSeries?"".concat(field.config.displayNameFromDS," (comparison)"):field.config.displayNameFromDS;if(field.type===dataFrame.PU.time&&!field.labels)return null!=displayName?displayName:dataFrame.LE;var parts=[],frameNamesDiffer=!1;if(allFrames&&allFrames.length>1)for(var i=1;i<allFrames.length;i++){if(allFrames[i].name!==allFrames[i-1].name){frameNamesDiffer=!0;break}}var frameNameAdded=!1,labelsAdded=!1;frameNamesDiffer&&(null==frame?void 0:frame.name)&&(parts.push(frame.name),frameNameAdded=!0);field.name&&field.name!==dataFrame.Bc&&parts.push(field.name);if(field.labels&&frame){var singleLabelName=function getSingleLabelName(frames){for(var singleName=null,i=0;i<frames.length;i++){var frame=frames[i],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=frame.fields[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var field=_step.value;if(field.labels)for(var labelKey in field.labels)if(null===singleName)singleName=labelKey;else if(labelKey!==singleName)return null}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}return singleName}(null!=allFrames?allFrames:[frame]);if(singleLabelName)field.labels[singleLabelName]&&(parts.push(field.labels[singleLabelName]),labelsAdded=!0);else{var allLabels=function formatLabels(labels){var defaultValue=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",withoutBraces=arguments.length>2?arguments[2]:void 0;if(!labels||0===Object.keys(labels).length)return defaultValue;var cleanSelector=Object.keys(labels).sort().map((function(key){return"".concat(key,'="').concat(labels[key],'"')})).join(", ");return withoutBraces?cleanSelector:["{",cleanSelector,"}"].join("")}(field.labels);allLabels&&(parts.push(allLabels),labelsAdded=!0)}}!frame||frameNameAdded||labelsAdded||field.name!==dataFrame.Bc||frame.name&&frame.name.length>0&&(parts.push(frame.name),frameNameAdded=!0);displayName=parts.length?parts.join(" "):field.name?field.name:dataFrame.Bc;displayName===field.name&&(displayName=function getUniqueFieldName(field,frame){var dupeCount=0,foundSelf=!1;if(frame)for(var i=0;i<frame.fields.length;i++){var otherField=frame.fields[i];if(field===otherField){if(foundSelf=!0,dupeCount>0){dupeCount++;break}}else if(field.name===otherField.name&&(dupeCount++,foundSelf))break}if(dupeCount)return"".concat(field.name," ").concat(dupeCount);return field.name}(field,frame));isComparisonSeries&&(displayName="".concat(displayName," (comparison)"));return displayName}(field,frame,allFrames);return field.state=field.state||{},field.state.displayName=displayName,field.state.multipleFrames=multipleFrames,displayName}},"../grafana-data/src/transformations/matchers.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{sJ:function(){return fieldMatchers},RE:function(){return frameMatchers},NS:function(){return getFieldMatcher},Dq:function(){return getFrameMatchers}});var Registry=__webpack_require__("../grafana-data/src/utils/Registry.ts"),dataFrame=__webpack_require__("../grafana-data/src/types/dataFrame.ts"),ids=__webpack_require__("../grafana-data/src/transformations/matchers/ids.ts");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var fieldTypeMatcher={id:ids.Ct.byType,name:"Field Type",description:"match based on the field type",defaultOptions:dataFrame.PU.number,get:function(type){return function(field,frame,allFrames){return type===field.type}},getOptionsDisplayText:function(type){return"Field type: ".concat(type)}},fieldTypesMatcher={id:ids.Ct.byTypes,name:"Field Type",description:"match based on the field types",defaultOptions:new Set,get:function(types){return function(field,frame,allFrames){return types.has(field.type)}},getOptionsDisplayText:function(types){return"Field types: ".concat(_to_consumable_array(types).join(" | "))}},numericMatcher={id:ids.Ct.numeric,name:"Numeric Fields",description:"Fields with type number",get:function(){return fieldTypeMatcher.get(dataFrame.PU.number)},getOptionsDisplayText:function(){return"Numeric Fields"}},timeMatcher={id:ids.Ct.time,name:"Time Fields",description:"Fields with type time",get:function(){return fieldTypeMatcher.get(dataFrame.PU.time)},getOptionsDisplayText:function(){return"Time Fields"}};var common_gen=__webpack_require__("../grafana-schema/src/common/common.gen.ts"),fieldReducer=__webpack_require__("../grafana-data/src/transformations/fieldReducer.ts");var ByNamesMatcherMode,fieldValueMatcherInfo={id:ids.Ct.byValue,name:"By value (reducer)",description:"Reduce a field to a single value and test for inclusion",defaultOptions:{reducer:fieldReducer.gy.allIsZero,op:common_gen.zT.GTE,value:0},get:function(props){if(!props||!props.reducer)return function(){return!1};var reducer=props.reducer,op=props.op,value=props.value,isBoolean=function isBooleanReducer(r){return r===fieldReducer.gy.allIsNull||r===fieldReducer.gy.allIsZero}(reducer);return op||(op=common_gen.zT.EQ),function(field,frame,allFrames){var left=(0,fieldReducer.Nw)({field:field,reducers:[reducer]})[reducer];return isBoolean?Boolean(left):function compareValues(left,op,right){switch(null!=left&&null!=right||(null==left&&(left="null"),null==right&&(right="null"),op!==common_gen.zT.GTE&&op!==common_gen.zT.LTE||(op=common_gen.zT.EQ)),op){case common_gen.zT.EQ:return"".concat(left)==="".concat(right);case common_gen.zT.NEQ:return"".concat(left)!=="".concat(right);case common_gen.zT.GT:return left>right;case common_gen.zT.GTE:return left>=right;case common_gen.zT.LT:return left<right;case common_gen.zT.LTE:return left<=right;default:return!1}}(left,op,value)}},getOptionsDisplayText:function(props){return"By value (".concat(props.reducer,")")}},fieldState=__webpack_require__("../grafana-data/src/field/fieldState.ts"),string=__webpack_require__("../grafana-data/src/text/string.ts");!function(ByNamesMatcherMode){ByNamesMatcherMode.exclude="exclude",ByNamesMatcherMode.include="include"}(ByNamesMatcherMode||(ByNamesMatcherMode={}));var fieldNameMatcher={id:ids.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:function(name){var fallback=fieldNameFallback(new Set([name]));return function(field,frame,allFrames){return name===field.name||name===(0,fieldState.Ct)(field,frame,allFrames)||Boolean(fallback&&fallback(field,frame,allFrames))}},getOptionsDisplayText:function(name){return"Field name: ".concat(name)}},multipleFieldNamesMatcher={id:ids.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:function(options){var names=options.names,_options_mode=options.mode,mode=void 0===_options_mode?"include":_options_mode,uniqueNames=new Set(null!=names?names:[]),fallback=fieldNameFallback(uniqueNames),matcher=function(field,frame,frames){return uniqueNames.has(field.name)||uniqueNames.has((0,fieldState.Ct)(field,frame,frames))||Boolean(fallback&&fallback(field,frame,frames))};return"exclude"===mode?function(field,frame,frames){return!matcher(field,frame,frames)}:matcher},getOptionsDisplayText:function(options){var names=options.names,mode=options.mode,displayText=(null!=names?names:[]).join(", ");return"exclude"===mode?"All except: ".concat(displayText):"All of: ".concat(displayText)}};function fieldNameFallback(fields){var _window_grafanaBootData_settings_featureToggles,_window_grafanaBootData_settings,_window_grafanaBootData,_window,fallback=void 0;return(null===(_window=window)||void 0===_window||null===(_window_grafanaBootData=_window.grafanaBootData)||void 0===_window_grafanaBootData||null===(_window_grafanaBootData_settings=_window_grafanaBootData.settings)||void 0===_window_grafanaBootData_settings||null===(_window_grafanaBootData_settings_featureToggles=_window_grafanaBootData_settings.featureToggles)||void 0===_window_grafanaBootData_settings_featureToggles?void 0:_window_grafanaBootData_settings_featureToggles.dataplaneFrontendFallback)&&(fields.has(dataFrame.Bc)?fallback=function(field,frame){var _field_labels;return Boolean(field.labels)&&(null===(_field_labels=field.labels)||void 0===_field_labels?void 0:_field_labels.__name__)===field.name}:(fields.has("Time")||fields.has("time"))&&(fallback=function(field,frame){var _frame_meta;return null==(null===(_frame_meta=frame.meta)||void 0===_frame_meta?void 0:_frame_meta.typeVersion)&&field.type===dataFrame.PU.time})),fallback}var regexpFieldNameMatcher={id:ids.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:function(pattern){var regexp=patternToRegex(pattern);return function(field,frame,allFrames){var displayName=(0,fieldState.Ct)(field,frame,allFrames);return!!regexp&&regexp.test(displayName)}},getOptionsDisplayText:function(pattern){return"Field name by pattern: ".concat(pattern)}},fieldsInFrameMatcher={id:ids.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:function(refId){return function(field,frame,allFrames){return frame.refId===refId}},getOptionsDisplayText:function(refId){return"Math all fields returned by query with reference ID: ".concat(refId)}},regexpOrMultipleNamesMatcher={id:ids.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:function(options){var _options_names,regexpMatcher=regexpFieldNameMatcher.get((null==options?void 0:options.pattern)||""),namesMatcher=multipleFieldNamesMatcher.get({mode:"include",names:null!==(_options_names=null==options?void 0:options.names)&&void 0!==_options_names?_options_names:[]});return function(field,frame,allFrames){return namesMatcher(field,frame,allFrames)||regexpMatcher(field,frame,allFrames)}},getOptionsDisplayText:function(options){var _options_names,_options_pattern,_options_names_join,pattern=null!==(_options_pattern=null==options?void 0:options.pattern)&&void 0!==_options_pattern?_options_pattern:"",names=null!==(_options_names_join=null==options||null===(_options_names=options.names)||void 0===_options_names?void 0:_options_names.join(","))&&void 0!==_options_names_join?_options_names_join:"";return"Field name by pattern: ".concat(pattern," or names: ").concat(names)}},patternToRegex=function(pattern){if(pattern)try{return(0,string.dO)(pattern)}catch(error){return void console.error(error)}},frameNameMatcher={id:ids.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:function(pattern){var regex=(0,string.dO)(pattern);return function(frame){return regex.test(frame.name||"")}},getOptionsDisplayText:function(pattern){return"Frame name: ".concat(pattern)}};var anyFieldMatcher={id:ids.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:function(options){var children=options.map((function(option){return getFieldMatcher(option)}));return function(field,frame,allFrames){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=children[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if((0,_step.value)(field,frame,allFrames))return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return!1}},getOptionsDisplayText:function(options){var text="",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=options[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var sub=_step.value;text.length>0&&(text+=" OR ");var matcher=fieldMatchers.get(sub.id);text+=matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(sub):matcher.name}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return text}},anyFrameMatcher={id:ids.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:function(options){var children=options.map((function(option){return getFrameMatchers(option)}));return function(frame){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=children[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if((0,_step.value)(frame))return!0}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return!1}},getOptionsDisplayText:function(options){var text="",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=options[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var sub=_step.value;text.length>0&&(text+=" OR ");var matcher=frameMatchers.get(sub.id);text+=matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(sub):matcher.name}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return text}},allFieldsMatcher={id:ids.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:function(options){var children=options.map((function(option){return getFieldMatcher(option)}));return function(field,frame,allFrames){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=children[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if(!(0,_step.value)(field,frame,allFrames))return!1}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return!0}},getOptionsDisplayText:function(options){var text="",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=options[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var sub=_step.value;text.length>0&&(text+=" AND ");var matcher=fieldMatchers.get(sub.id);text+=matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(sub):matcher.name}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return text}},allFramesMatcher={id:ids.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:function(options){var children=options.map((function(option){return getFrameMatchers(option)}));return function(frame){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=children[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){if(!(0,_step.value)(frame))return!1}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return!0}},getOptionsDisplayText:function(options){var text="",_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=options[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var sub=_step.value;text.length>0&&(text+=" AND ");var matcher=frameMatchers.get(sub.id);text+=matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(sub):matcher.name}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return text}},notFieldMatcher={id:ids.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:function(option){var check=getFieldMatcher(option);return function(field,frame,allFrames){return!check(field,frame,allFrames)}},getOptionsDisplayText:function(options){var matcher=fieldMatchers.get(options.id);return"NOT "+(matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(options.options):matcher.name)}},notFrameMatcher={id:ids.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:function(option){var check=getFrameMatchers(option);return function(frame){return!check(frame)}},getOptionsDisplayText:function(options){var matcher=frameMatchers.get(options.id);return"NOT "+(matcher.getOptionsDisplayText?matcher.getOptionsDisplayText(options.options):matcher.name)}},alwaysFieldMatcher=function(field){return!0},alwaysFrameMatcher=function(frame){return!0},neverFieldMatcher=function(field){return!1},neverFrameMatcher=function(frame){return!1},alwaysFieldMatcherInfo={id:ids.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:function(_option){return alwaysFieldMatcher},getOptionsDisplayText:function(_options){return"Always"}},alwaysFrameMatcherInfo={id:ids.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:function(_option){return alwaysFrameMatcher},getOptionsDisplayText:function(_options){return"Always"}},neverFieldMatcherInfo={id:ids.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:function(_option){return neverFieldMatcher},getOptionsDisplayText:function(_options){return"Never"}},neverFrameMatcherInfo={id:ids.cV.neverMatch,name:"No Frames",description:"Never Match",get:function(_option){return neverFrameMatcher},getOptionsDisplayText:function(_options){return"Never"}};var refIdMatcher={id:ids.jR.byRefId,name:"Query refId",description:"match the refId",defaultOptions:"A",get:function(pattern){var regex=(0,string.dO)(pattern);return function(frame){return regex.test(frame.refId||"")}},getOptionsDisplayText:function(pattern){return"RefID: ".concat(pattern)}};var firstFieldMatcher={id:ids.Ct.first,name:"First Field",description:"The first field in the frame",get:function(type){return function(field,frame,allFrames){return field===frame.fields[0]}},getOptionsDisplayText:function(){return"First field"}},firstTimeFieldMatcher={id:ids.Ct.firstTimeField,name:"First time field",description:"The first field of type time in a frame",get:function(type){return function(field,frame,allFrames){return field.type===dataFrame.PU.time&&field===frame.fields.find((function(f){return f.type===dataFrame.PU.time}))}},getOptionsDisplayText:function(){return"First time field"}};var isEqualValueMatcher={id:ids.Js.equal,name:"Is equal",description:"Match where value for given field is equal to options value.",get:function(options){return function(valueIndex,field){return field.values[valueIndex]==options.value}},getOptionsDisplayText:function(){return"Matches all rows where field is null."},isApplicable:function(){return!0},getDefaultOptions:function(){return{value:""}}},isNotEqualValueMatcher={id:ids.Js.notEqual,name:"Is not equal",description:"Match where value for given field is not equal to options value.",get:function(options){return function(valueIndex,field){return field.values[valueIndex]!=options.value}},getOptionsDisplayText:function(){return"Matches all rows where field is not null."},isApplicable:function(){return!0},getDefaultOptions:function(){return{value:""}}},isNullValueMatcher={id:ids.Js.isNull,name:"Is null",description:"Match where value for given field is null.",get:function(){return function(valueIndex,field){return null==field.values[valueIndex]}},getOptionsDisplayText:function(){return"Matches all rows where field is null."},isApplicable:function(){return!0},getDefaultOptions:function(){return{}}},isNotNullValueMatcher={id:ids.Js.isNotNull,name:"Is not null",description:"Match where value for given field is not null.",get:function(){return function(valueIndex,field){return null!=field.values[valueIndex]}},getOptionsDisplayText:function(){return"Matches all rows where field is not null."},isApplicable:function(){return!0},getDefaultOptions:function(){return{}}},isGreaterValueMatcher={id:ids.Js.greater,name:"Is greater",description:"Match when field value is greater than option.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return!isNaN(value)&&value>options.value}},getOptionsDisplayText:function(options){return"Matches all rows where field value is greater than: ".concat(options.value,".")},isApplicable:function(field){return field.type===dataFrame.PU.number},getDefaultOptions:function(){return{value:0}}},isGreaterOrEqualValueMatcher={id:ids.Js.greaterOrEqual,name:"Is greater or equal",description:"Match when field value is greater than or equal to option.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return!isNaN(value)&&value>=options.value}},getOptionsDisplayText:function(options){return"Matches all rows where field value is greater than or equal to: ".concat(options.value,".")},isApplicable:function(field){return field.type===dataFrame.PU.number},getDefaultOptions:function(){return{value:0}}},isLowerValueMatcher={id:ids.Js.lower,name:"Is lower",description:"Match when field value is lower than option.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return!isNaN(value)&&value<options.value}},getOptionsDisplayText:function(options){return"Matches all rows where field value is lower than: ".concat(options.value,".")},isApplicable:function(field){return field.type===dataFrame.PU.number},getDefaultOptions:function(){return{value:0}}},isLowerOrEqualValueMatcher={id:ids.Js.lowerOrEqual,name:"Is lower or equal",description:"Match when field value is lower or equal than option.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return!isNaN(value)&&value<=options.value}},getOptionsDisplayText:function(options){return"Matches all rows where field value is lower or equal than: ".concat(options.value,".")},isApplicable:function(field){return field.type===dataFrame.PU.number},getDefaultOptions:function(){return{value:0}}},isBetweenValueMatcher={id:ids.Js.between,name:"Is between",description:"Match when field value is between given option values.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return!isNaN(value)&&(value>options.from&&value<options.to)}},getOptionsDisplayText:function(options){return"Matches all rows where field value is between ".concat(options.from," and ").concat(options.to,".")},isApplicable:function(field){return field.type===dataFrame.PU.number},getDefaultOptions:function(){return{from:0,to:100}}},regexValueMatcher={id:ids.Js.regex,name:"Regex",description:"Match when field value is matching regex.",get:function(options){var regex=new RegExp(options.value);return function(valueIndex,field){var value=field.values[valueIndex];return regex.test(value)}},getOptionsDisplayText:function(options){return"Matches all rows where field value is matching regex: ".concat(options.value)},isApplicable:function(){return!0},getDefaultOptions:function(){return{value:".*"}}},isSubstringMatcher={id:ids.Js.substring,name:"Contains substring",description:"Match where value for given field is a substring to options value.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return value&&options.value&&"string"==typeof value&&value.toLowerCase().includes(options.value.toLowerCase())||""===options.value}},getOptionsDisplayText:function(){return"Matches all rows where field is similar to the value."},isApplicable:function(field){return field.type===dataFrame.PU.string},getDefaultOptions:function(){return{value:""}}},isNotSubstringValueMatcher={id:ids.Js.notSubstring,name:"Does not contain substring",description:"Match where value for given field is not a substring to options value.",get:function(options){return function(valueIndex,field){var value=field.values[valueIndex];return"string"==typeof value&&options.value&&value&&""!==options.value&&!value.toLowerCase().includes(options.value.toLowerCase())}},getOptionsDisplayText:function(){return"Matches all rows where field is not similar to the value."},isApplicable:function(field){return field.type===dataFrame.PU.string},getDefaultOptions:function(){return{value:""}}};function matchers_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function matchers_to_consumable_array(arr){return function matchers_array_without_holes(arr){if(Array.isArray(arr))return matchers_array_like_to_array(arr)}(arr)||function matchers_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function matchers_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return matchers_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return matchers_array_like_to_array(o,minLen)}(arr)||function matchers_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var fieldMatchers=new Registry.O((function(){return matchers_to_consumable_array(function getFieldPredicateMatchers(){return[anyFieldMatcher,allFieldsMatcher,notFieldMatcher,alwaysFieldMatcherInfo,neverFieldMatcherInfo]}()).concat(matchers_to_consumable_array(function getFieldTypeMatchers(){return[fieldTypeMatcher,fieldTypesMatcher,numericMatcher,timeMatcher]}()),matchers_to_consumable_array(function getFieldNameMatchers(){return[fieldNameMatcher,regexpFieldNameMatcher,multipleFieldNamesMatcher,regexpOrMultipleNamesMatcher,fieldsInFrameMatcher]}()),matchers_to_consumable_array(function getSimpleFieldMatchers(){return[firstFieldMatcher,firstTimeFieldMatcher]}()),[fieldValueMatcherInfo])})),frameMatchers=new Registry.O((function(){return matchers_to_consumable_array(function getFramePredicateMatchers(){return[anyFrameMatcher,allFramesMatcher,notFrameMatcher,alwaysFrameMatcherInfo,neverFrameMatcherInfo]}()).concat(matchers_to_consumable_array(function getFrameNameMatchers(){return[frameNameMatcher]}()),matchers_to_consumable_array(function getRefIdMatchers(){return[refIdMatcher]}()))}));new Registry.O((function(){return matchers_to_consumable_array([isNullValueMatcher,isNotNullValueMatcher]).concat(matchers_to_consumable_array([isGreaterValueMatcher,isGreaterOrEqualValueMatcher,isLowerValueMatcher,isLowerOrEqualValueMatcher]),matchers_to_consumable_array([isEqualValueMatcher,isNotEqualValueMatcher]),matchers_to_consumable_array([isSubstringMatcher,isNotSubstringValueMatcher]),matchers_to_consumable_array([isBetweenValueMatcher]),matchers_to_consumable_array([regexValueMatcher]))}));function getFieldMatcher(config){var info=fieldMatchers.get(config.id);if(!info)throw new Error("Unknown field matcher: "+config.id);return info.get(config.options)}function getFrameMatchers(config){var info=frameMatchers.get(config.id);if(!info)throw new Error("Unknown frame matcher: "+config.id);return info.get(config.options)}},"../grafana-data/src/transformations/matchers/ids.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var MatcherID,FieldMatcherID,FrameMatcherID,ValueMatcherID;__webpack_require__.d(__webpack_exports__,{Ct:function(){return FieldMatcherID},Js:function(){return ValueMatcherID},cV:function(){return MatcherID},jR:function(){return FrameMatcherID}}),function(MatcherID){MatcherID.anyMatch="anyMatch",MatcherID.allMatch="allMatch",MatcherID.invertMatch="invertMatch",MatcherID.alwaysMatch="alwaysMatch",MatcherID.neverMatch="neverMatch"}(MatcherID||(MatcherID={})),function(FieldMatcherID){FieldMatcherID.numeric="numeric",FieldMatcherID.time="time",FieldMatcherID.first="first",FieldMatcherID.firstTimeField="firstTimeField",FieldMatcherID.byType="byType",FieldMatcherID.byTypes="byTypes",FieldMatcherID.byName="byName",FieldMatcherID.byNames="byNames",FieldMatcherID.byRegexp="byRegexp",FieldMatcherID.byRegexpOrNames="byRegexpOrNames",FieldMatcherID.byFrameRefID="byFrameRefID",FieldMatcherID.byValue="byValue"}(FieldMatcherID||(FieldMatcherID={})),function(FrameMatcherID){FrameMatcherID.byName="byName",FrameMatcherID.byRefId="byRefId",FrameMatcherID.byIndex="byIndex"}(FrameMatcherID||(FrameMatcherID={})),function(ValueMatcherID){ValueMatcherID.regex="regex",ValueMatcherID.isNull="isNull",ValueMatcherID.isNotNull="isNotNull",ValueMatcherID.greater="greater",ValueMatcherID.greaterOrEqual="greaterOrEqual",ValueMatcherID.lower="lower",ValueMatcherID.lowerOrEqual="lowerOrEqual",ValueMatcherID.equal="equal",ValueMatcherID.notEqual="notEqual",ValueMatcherID.substring="substring",ValueMatcherID.notSubstring="notSubstring",ValueMatcherID.between="between"}(ValueMatcherID||(ValueMatcherID={}))},"./src/components/Sparkline/Sparkline.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{O:function(){return Sparkline}});var jsx_runtime=__webpack_require__("../../node_modules/react/jsx-runtime.js"),lodash=__webpack_require__("../../node_modules/lodash/lodash.js"),react=__webpack_require__("../../node_modules/react/index.js");var defaultCmp=function(a,b){return a===b};function shallowCompare(a,b){var key,cmp=arguments.length>2&&void 0!==arguments[2]?arguments[2]:defaultCmp;if(a===b)return!0;if(Object.keys(a).length!==Object.keys(b).length)return!1;for(key in a)if(!cmp(a[key],b[key]))return!1;return!0}var dataFrame=__webpack_require__("../grafana-data/src/types/dataFrame.ts"),fieldColor=__webpack_require__("../grafana-data/src/field/fieldColor.ts");function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function nullToValueField(field,noValue){for(var transformedVals=field.values.slice(),i=0;i<transformedVals.length;i++)null===transformedVals[i]&&(transformedVals[i]=noValue);return _object_spread_props(_object_spread({},field),{values:transformedVals})}var DataTransformerID,common_gen=__webpack_require__("../grafana-schema/src/common/common.gen.ts"),uPlot_esm=__webpack_require__("../../node_modules/uplot/dist/uPlot.esm.js"),map=__webpack_require__("../../node_modules/rxjs/dist/esm5/internal/operators/map.js"),parser=__webpack_require__("../grafana-data/src/datetime/parser.ts"),matchers=__webpack_require__("../grafana-data/src/transformations/matchers.ts"),ids=__webpack_require__("../grafana-data/src/transformations/matchers/ids.ts");function convertFieldType_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function convertFieldType_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){convertFieldType_define_property(target,key,source[key])}))}return target}function convertFieldType_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function convertFieldType_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}!function(DataTransformerID){DataTransformerID.append="append",DataTransformerID.reduce="reduce",DataTransformerID.order="order",DataTransformerID.organize="organize",DataTransformerID.rename="rename",DataTransformerID.calculateField="calculateField",DataTransformerID.seriesToColumns="seriesToColumns",DataTransformerID.seriesToRows="seriesToRows",DataTransformerID.merge="merge",DataTransformerID.concatenate="concatenate",DataTransformerID.labelsToFields="labelsToFields",DataTransformerID.filterFields="filterFields",DataTransformerID.filterFieldsByName="filterFieldsByName",DataTransformerID.filterFrames="filterFrames",DataTransformerID.filterByRefId="filterByRefId",DataTransformerID.renameByRegex="renameByRegex",DataTransformerID.filterByValue="filterByValue",DataTransformerID.noop="noop",DataTransformerID.ensureColumns="ensureColumns",DataTransformerID.groupBy="groupBy",DataTransformerID.sortBy="sortBy",DataTransformerID.histogram="histogram",DataTransformerID.configFromData="configFromData",DataTransformerID.rowsToFields="rowsToFields",DataTransformerID.prepareTimeSeries="prepareTimeSeries",DataTransformerID.convertFieldType="convertFieldType",DataTransformerID.fieldLookup="fieldLookup",DataTransformerID.heatmap="heatmap",DataTransformerID.spatial="spatial",DataTransformerID.joinByField="joinByField",DataTransformerID.joinByLabels="joinByLabels",DataTransformerID.extractFields="extractFields",DataTransformerID.groupingToMatrix="groupingToMatrix",DataTransformerID.limit="limit",DataTransformerID.partitionByValues="partitionByValues",DataTransformerID.timeSeriesTable="timeSeriesTable",DataTransformerID.transpose="transpose",DataTransformerID.formatTime="formatTime",DataTransformerID.formatString="formatString",DataTransformerID.regression="regression",DataTransformerID.groupToNestedTable="groupToNestedTable"}(DataTransformerID||(DataTransformerID={}));var convertFieldTypeTransformer={id:DataTransformerID.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:function(options,ctx){return function(source){return source.pipe((0,map.T)((function(data){return convertFieldTypeTransformer.transformer(options,ctx)(data)})))}},transformer:function(options){return function(data){return Array.isArray(data)&&0!==data.length?null!==(_convertFieldTypes=function convertFieldTypes(options,frames){if(!options.conversions.length)return frames;var framesCopy=frames.map((function(frame){return convertFieldType_object_spread({},frame)})),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_loop=function(){var conversion=_step.value;if(!conversion.targetField)return"continue";var matches=matchers.sJ.get(ids.Ct.byName).get(conversion.targetField),_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step1,_loop=function(){var frame=_step1.value;frame.fields=frame.fields.map((function(field){return matches(field,frame,framesCopy)?function convertFieldType(field,opts){switch(opts.destinationType){case dataFrame.PU.time:return ensureTimeField(field,opts.dateFormat);case dataFrame.PU.number:return function fieldToNumberField(field){for(var numValues=field.values.slice(),valuesAsStrings=numValues.some((function(v){return"string"==typeof v})),n=0;n<numValues.length;n++){var toBeConverted=numValues[n];valuesAsStrings&&null!=toBeConverted&&"string"==typeof toBeConverted&&(toBeConverted=toBeConverted.replace(/,/g,""));var number=+toBeConverted;numValues[n]=Number.isFinite(number)?number:null}return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.number,values:numValues})}(field);case dataFrame.PU.string:return function fieldToStringField(field,dateFormat,parseOptions,joinWith){var values=field.values;switch(field.type){case dataFrame.PU.time:values=values.map((function(v){return(0,parser.b)(v,parseOptions).format(dateFormat)}));break;case dataFrame.PU.other:values=values.map((function(v){return(null==joinWith?void 0:joinWith.length)&&Array.isArray(v)?v.join(joinWith):JSON.stringify(v)}));break;default:values=values.map((function(v){return"".concat(v)}))}return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.string,values:values})}(field,opts.dateFormat,{timeZone:opts.timezone},opts.joinWith);case dataFrame.PU.boolean:return function fieldToBooleanField(field){for(var booleanValues=field.values.slice(),b=0;b<booleanValues.length;b++)booleanValues[b]=Boolean(!!booleanValues[b]);return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.boolean,values:booleanValues})}(field);case dataFrame.PU.enum:return function fieldToEnumField(field,config){var enumConfig=convertFieldType_object_spread({},config),enumValues=field.values.slice(),lookup=new Map;if(!(enumConfig.text&&enumConfig.text.length>0))return field;for(var i=0;i<enumConfig.text.length;i++)lookup.set(enumConfig.text[i],i);for(var i1=0;i1<enumValues.length;i1++){var value=enumValues[i1];enumValues[i1]=lookup.get(value)}return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{config:convertFieldType_object_spread_props(convertFieldType_object_spread({},field.config),{type:{enum:enumConfig}}),type:dataFrame.PU.enum,values:enumValues})}(field,opts.enumConfig);case dataFrame.PU.other:return function fieldToComplexField(field){for(var complexValues=field.values.slice(),s=0;s<complexValues.length;s++)try{complexValues[s]=JSON.parse(complexValues[s])}catch(e){complexValues[s]=null}return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.other,values:complexValues})}(field);default:return field}}(field,conversion):field}))},_iterator=framesCopy[Symbol.iterator]();!(_iteratorNormalCompletion=(_step1=_iterator.next()).done);_iteratorNormalCompletion=!0)_loop()}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}},_iterator=options.conversions[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)_loop()}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return framesCopy}(options,data))&&void 0!==_convertFieldTypes?_convertFieldTypes:[]:data;var _convertFieldTypes}}};var iso8601Regex=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function ensureTimeField(field,dateFormat){var firstValueTypeIsNumber="number"==typeof field.values[0];return field.type===dataFrame.PU.time&&firstValueTypeIsNumber?field:firstValueTypeIsNumber?convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.time}):function fieldToTimeField(field,dateFormat){for(var opts=dateFormat?{format:dateFormat}:void 0,timeValues=field.values.slice(),firstDefined=timeValues.find((function(v){return null!=v})),isISO8601="string"==typeof firstDefined&&iso8601Regex.test(firstDefined),t=0;t<timeValues.length;t++)if(timeValues[t]){var parsed=isISO8601?Date.parse(timeValues[t]):(0,parser.b)(timeValues[t],opts).valueOf();timeValues[t]=Number.isFinite(parsed)?parsed:null}else timeValues[t]=null;return convertFieldType_object_spread_props(convertFieldType_object_spread({},field),{type:dataFrame.PU.time,values:timeValues})}(field,dateFormat)}function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(0,lodash.throttle)((function(){for(var _len=arguments.length,t=new Array(_len),_key=0;_key<_len;_key++)t[_key]=arguments[_key];var _console;(_console=console).log.apply(_console,_to_consumable_array(t))}),500);var FIXED_UNIT="__fixed",PlotConfigBuilder=function PlotConfigBuilder(props){!function _class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PlotConfigBuilder),function types_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}(this,"props",void 0),this.props=props};function buildScaleKey(config,fieldType){var _config_custom,_config_custom1,_config_custom2,_config_custom3,_config_custom4,_config_custom5,_config_unit,scaleRange="".concat(void 0!==config.min?config.min:"na","-").concat(void 0!==config.max?config.max:"na"),scaleSoftRange="".concat(void 0!==(null===(_config_custom=config.custom)||void 0===_config_custom?void 0:_config_custom.axisSoftMin)?config.custom.axisSoftMin:"na","-").concat(void 0!==(null===(_config_custom1=config.custom)||void 0===_config_custom1?void 0:_config_custom1.axisSoftMax)?config.custom.axisSoftMax:"na"),scalePlacement="".concat(void 0!==(null===(_config_custom2=config.custom)||void 0===_config_custom2?void 0:_config_custom2.axisPlacement)?null===(_config_custom3=config.custom)||void 0===_config_custom3?void 0:_config_custom3.axisPlacement:common_gen.vM.Auto),scaleUnit=null!==(_config_unit=config.unit)&&void 0!==_config_unit?_config_unit:FIXED_UNIT,scaleDistribution=(null===(_config_custom4=config.custom)||void 0===_config_custom4?void 0:_config_custom4.scaleDistribution)?function getScaleDistributionPart(config){if(config.type===common_gen.L4.Log)return"".concat(config.type).concat(config.log);return config.type}(config.custom.scaleDistribution):common_gen.L4.Linear,scaleLabel=Boolean(null===(_config_custom5=config.custom)||void 0===_config_custom5?void 0:_config_custom5.axisLabel)?config.custom.axisLabel:"na";return"".concat(scaleUnit,"/").concat(scaleRange,"/").concat(scaleSoftRange,"/").concat(scalePlacement,"/").concat(scaleDistribution,"/").concat(scaleLabel,"/").concat(fieldType)}function utils_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function utils_to_consumable_array(arr){return function utils_array_without_holes(arr){if(Array.isArray(arr))return utils_array_like_to_array(arr)}(arr)||function utils_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function utils_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return utils_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return utils_array_like_to_array(o,minLen)}(arr)||function utils_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var paddingSide=function(u,side,sidesWithAxes){var hasCrossAxis=side%2?sidesWithAxes[0]||sidesWithAxes[2]:sidesWithAxes[1]||sidesWithAxes[3];return sidesWithAxes[side]||!hasCrossAxis?0:8},DEFAULT_PLOT_CONFIG={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[paddingSide,paddingSide,paddingSide,paddingSide],series:[],hooks:{}};function getStackingGroups(frame){var groups=new Map;return frame.fields.forEach((function(param,i){var _custom_hideFrom,config=param.config,values=param.values,type=param.type;if(0!==i){var custom=config.custom;if(null!=custom&&!(null===(_custom_hideFrom=custom.hideFrom)||void 0===_custom_hideFrom?void 0:_custom_hideFrom.viz)){var stacking=custom.stacking;if(null!=stacking){var stackingMode=stacking.mode,stackingGroup=stacking.group;if(stackingMode!==common_gen.gs.None){var stackDir=function getStackDirection(transform,data){var hasNegSamp=function hasNegSample(data){var samples=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,len=data.length;if(0===len)return!1;var firstIdx=0,lastIdx=len-1;for(;firstIdx<=lastIdx&&null==data[firstIdx];)firstIdx++;for(;lastIdx>=firstIdx&&null==data[lastIdx];)lastIdx--;var negCount=0,posCount=0;if(lastIdx>=firstIdx){for(var stride=Math.max(1,Math.floor((lastIdx-firstIdx+1)/samples)),i=firstIdx;i<=lastIdx;i+=stride){var v=data[i];null!=v&&"number"==typeof v&&(v<0||Object.is(v,-0)?negCount++:v>0&&posCount++)}if(negCount>posCount)return!0}return!1}(data);if(transform===common_gen.NU.NegativeY)return hasNegSamp?1:-1;return hasNegSamp?-1:1}(custom.transform,values),drawStyle=custom.drawStyle,drawStyle2=drawStyle===common_gen.GR.Bars?custom.barAlignment:drawStyle===common_gen.GR.Line?custom.lineInterpolation:null,stackKey="".concat(stackDir,"|").concat(stackingMode,"|").concat(stackingGroup,"|").concat(buildScaleKey(config,type),"|").concat(drawStyle,"|").concat(drawStyle2),group=groups.get(stackKey);null==group&&(group={series:[],dir:stackDir},groups.set(stackKey,group)),group.series.push(i)}}}}})),utils_to_consumable_array(groups.values())}function preparePlotData2(frame,stackingGroups,onStackMeta){var data=Array(frame.fields.length),stacksQty=stackingGroups.length,dataLen=frame.length,zeroArr=stacksQty>0?Array(dataLen).fill(0):[],falseArr=stacksQty>0?Array(dataLen).fill(!1):[],accums=Array.from({length:stacksQty},(function(){return zeroArr.slice()})),anyValsAtX=Array.from({length:stacksQty},(function(){return falseArr.slice()}));(stackingGroups.forEach((function(group,groupIdx){var groupValsAtX=anyValsAtX[groupIdx];group.series.forEach((function(seriesIdx){var _field_config_custom_hideFrom,_field_config_custom,field=frame.fields[seriesIdx];if(!(null===(_field_config_custom=field.config.custom)||void 0===_field_config_custom||null===(_field_config_custom_hideFrom=_field_config_custom.hideFrom)||void 0===_field_config_custom_hideFrom?void 0:_field_config_custom_hideFrom.viz))for(var vals=field.values,i=0;i<dataLen;i++)null!=vals[i]&&(groupValsAtX[i]=!0)}))})),frame.fields.forEach((function(field,i){var _custom_hideFrom,_custom_stacking,vals=field.values;if(0!==i){var custom=field.config.custom;if(custom&&!(null===(_custom_hideFrom=custom.hideFrom)||void 0===_custom_hideFrom?void 0:_custom_hideFrom.viz)){if(custom.transform===common_gen.NU.Constant){var firstValIdx=vals.findIndex((function(v){return null!=v})),firstVal=vals[firstValIdx];(vals=Array(vals.length).fill(void 0))[firstValIdx]=firstVal}else if(vals=vals.slice(),custom.transform===common_gen.NU.NegativeY)for(var _$i=0;_$i<vals.length;_$i++)null!=vals[_$i]&&(vals[_$i]*=-1);var stackingMode=null===(_custom_stacking=custom.stacking)||void 0===_custom_stacking?void 0:_custom_stacking.mode;if(stackingMode&&stackingMode!==common_gen.gs.None)for(var stackIdx=stackingGroups.findIndex((function(group){return group.series.indexOf(i)>-1})),accum=accums[stackIdx],groupValsAtX=anyValsAtX[stackIdx],stacked=data[i]=Array(dataLen),_$i1=0;_$i1<dataLen;_$i1++){var v=vals[_$i1];stacked[_$i1]=null!=v?accum[_$i1]+=v:groupValsAtX[_$i1]?accum[_$i1]:v}else data[i]=vals}else data[i]=vals}else field.type===dataFrame.PU.time?data[0]=ensureTimeField(field).values:data[0]=vals})),onStackMeta)&&onStackMeta({totals:data.map((function(vals,i){var stackIdx=stackingGroups.findIndex((function(group){return group.series.indexOf(i)>-1}));return-1!==stackIdx?accums[stackIdx]:vals}))});return frame.fields.forEach((function(field,i){var _field_config_custom_hideFrom,_field_config_custom,_field_config_custom_stacking,_field_config_custom1;if(0!==i&&!(null===(_field_config_custom=field.config.custom)||void 0===_field_config_custom||null===(_field_config_custom_hideFrom=_field_config_custom.hideFrom)||void 0===_field_config_custom_hideFrom?void 0:_field_config_custom_hideFrom.viz)&&(null===(_field_config_custom1=field.config.custom)||void 0===_field_config_custom1||null===(_field_config_custom_stacking=_field_config_custom1.stacking)||void 0===_field_config_custom_stacking?void 0:_field_config_custom_stacking.mode)===common_gen.gs.Percent)for(var stackIdx=stackingGroups.findIndex((function(group){return group.series.indexOf(i)>-1})),accum=accums[stackIdx],group=stackingGroups[stackIdx],stacked=data[i],_$i=0;_$i<dataLen;_$i++){var v=stacked[_$i];null!=v&&(stacked[_$i]=0===accum[_$i]?0:group.dir*(v/accum[_$i]))}})),data}var loggingEnabled,pluginLogger=(loggingEnabled=!1,"undefined"!=typeof window&&(loggingEnabled="true"===window.localStorage.getItem("grafana.debug")),{logger:function(id){for(var _len=arguments.length,t=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)t[_key-2]=arguments[_key]},enable:function(){return loggingEnabled=!0},disable:function(){return loggingEnabled=!1},isEnabled:function(){return loggingEnabled}}),pluginLog=pluginLogger.logger;__webpack_require__("../../node_modules/uplot/dist/uPlot.min.css");function _assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Plot_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _get_prototype_of(o){return _get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},_get_prototype_of(o)}function _possible_constructor_return(self,call){return!call||"object"!==function _type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?_assert_this_initialized(self):call}function _set_prototype_of(o,p){return _set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},_set_prototype_of(o,p)}function _create_super(Derived){var hasNativeReflectConstruct=function _is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possible_constructor_return(this,result)}}var UPlotChart=function(Component){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_set_prototype_of(subClass,superClass)}(UPlotChart,Component);var _super=_create_super(UPlotChart);function UPlotChart(props){var _this;return function Plot_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UPlotChart),Plot_define_property(_assert_this_initialized(_this=_super.call(this,props)),"plotContainer",(0,react.createRef)()),Plot_define_property(_assert_this_initialized(_this),"plotCanvasBBox",(0,react.createRef)()),_this.state={plot:null},_this}return function _create_class(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(UPlotChart,[{key:"reinitPlot",value:function reinitPlot(){var _this_state_plot,_this_props=this.props,width=_this_props.width,height=_this_props.height,plotRef=_this_props.plotRef;if(null===(_this_state_plot=this.state.plot)||void 0===_this_state_plot||_this_state_plot.destroy(),0!==width||0!==height){this.props.config.addHook("setSize",(function(u){u.over}));var config=function Plot_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){Plot_define_property(target,key,source[key])}))}return target}({width:Math.floor(this.props.width),height:Math.floor(this.props.height)},this.props.config.getConfig());pluginLog("UPlot",!1,"Reinitializing plot",config);var plot=new uPlot_esm.A(config,this.props.data,this.plotContainer.current);plotRef&&plotRef(plot),this.setState({plot:plot})}}},{key:"componentDidMount",value:function componentDidMount(){this.reinitPlot()}},{key:"componentWillUnmount",value:function componentWillUnmount(){var _this_state_plot;null===(_this_state_plot=this.state.plot)||void 0===_this_state_plot||_this_state_plot.destroy()}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps){var plot=this.state.plot;!function sameDims(prevProps,nextProps){return nextProps.width===prevProps.width&&nextProps.height===prevProps.height}(prevProps,this.props)?null==plot||plot.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)}):!function sameConfig(prevProps,nextProps){return nextProps.config===prevProps.config}(prevProps,this.props)?this.reinitPlot():function sameData(prevProps,nextProps){return nextProps.data===prevProps.data}(prevProps,this.props)||null==plot||plot.setData(this.props.data)}},{key:"render",value:function render(){return(0,jsx_runtime.jsxs)("div",{style:{position:"relative"},children:[(0,jsx_runtime.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}]),UPlotChart}(react.Component);try{UPlotChart.displayName="UPlotChart",UPlotChart.__docgenInfo={description:"",displayName:"UPlotChart",props:{data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"AlignedData | [_: null, ...series: FacetValues[]]"}},width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},config:{defaultValue:null,description:"",name:"config",required:!0,type:{name:"UPlotConfigBuilder"}},plotRef:{defaultValue:null,description:"",name:"plotRef",required:!1,type:{name:"((u: uPlot) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/uPlot/Plot.tsx#UPlotChart"]={docgenInfo:UPlotChart.__docgenInfo,name:"UPlotChart",path:"src/components/uPlot/Plot.tsx#UPlotChart"})}catch(__react_docgen_typescript_loader_error){}var time=__webpack_require__("../grafana-data/src/types/time.ts"),timezones=__webpack_require__("../grafana-data/src/datetime/timezones.ts"),valueFormats=__webpack_require__("../grafana-data/src/valueFormats/valueFormats.ts");function numbers_roundDecimals(val){var dec=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Number.isInteger(val))return val;var p=Math.pow(10,dec),n=val*p*(1+Number.EPSILON);return Math.round(n)/p}var dataFrameTypes_DataFrameType,formats=__webpack_require__("../grafana-data/src/datetime/formats.ts"),formatter=__webpack_require__("../grafana-data/src/datetime/formatter.ts"),measureText=__webpack_require__("./src/utils/measureText.ts"),displayProcessor=__webpack_require__("../grafana-data/src/field/displayProcessor.ts"),createTheme=__webpack_require__("../grafana-data/src/themes/createTheme.ts");!function(DataFrameType){DataFrameType.TimeSeriesWide="timeseries-wide",DataFrameType.TimeSeriesLong="timeseries-long",DataFrameType.TimeSeriesMany="timeseries-many",DataFrameType.TimeSeriesMulti="timeseries-multi",DataFrameType.NumericWide="numeric-wide",DataFrameType.NumericMulti="numeric-multi",DataFrameType.NumericLong="numeric-long",DataFrameType.LogLines="log-lines",DataFrameType.DirectoryListing="directory-listing",DataFrameType.HeatmapRows="heatmap-rows",DataFrameType.HeatmapCells="heatmap-cells",DataFrameType.Histogram="histogram"}(dataFrameTypes_DataFrameType||(dataFrameTypes_DataFrameType={}));var JoinMode,processDataFrame=__webpack_require__("../grafana-data/src/dataframe/processDataFrame.ts");!function(JoinMode){JoinMode.outer="outer",JoinMode.inner="inner",JoinMode.outerTabular="outerTabular"}(JoinMode||(JoinMode={}));var joinByFieldTransformer={id:DataTransformerID.joinByField,aliasIds:[DataTransformerID.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:function(options,ctx){return function(source){return source.pipe((0,map.T)((function(data){return joinByFieldTransformer.transformer(options,ctx)(data)})))}},transformer:function(options,ctx){var joinBy=void 0;return function(data){if(data.length>1){options.byField&&!joinBy&&(joinBy=matchers.sJ.get(ids.Ct.byName).get(ctx.interpolate(options.byField)));var joined=function joinDataFrames(options){var _options_frames,_options_nullMode;if(!(null===(_options_frames=options.frames)||void 0===_options_frames?void 0:_options_frames.length))return;var nullMode=null!==(_options_nullMode=options.nullMode)&&void 0!==_options_nullMode?_options_nullMode:function(field){var _field_config_custom,spanNulls=null===(_field_config_custom=field.config.custom)||void 0===_field_config_custom?void 0:_field_config_custom.spanNulls;return!0===spanNulls?NULL_REMOVE:-1===spanNulls?NULL_RETAIN:NULL_EXPAND};if(1===options.frames.length){var frame=options.frames[0],frameCopy=frame,joinFieldMatcher=getJoinMatcher(options),joinIndex=frameCopy.fields.findIndex((function(f){return joinFieldMatcher(f,frameCopy,options.frames)}));if(options.keepOriginIndices&&(frameCopy=joinDataFrames_object_spread_props(joinDataFrames_object_spread({},frame),{fields:frame.fields.map((function(f,fieldIndex){var copy=joinDataFrames_object_spread({},f),origin={frameIndex:0,fieldIndex:fieldIndex};return copy.state?copy.state.origin=origin:copy.state={origin:origin},copy}))}),joinIndex>0)){var joinField=frameCopy.fields[joinIndex],fields=frameCopy.fields.filter((function(f,idx){return idx!==joinIndex}));fields.unshift(joinField),frameCopy.fields=fields,joinIndex=0}if(joinIndex>=0&&(frameCopy=function maybeSortFrame(frame,fieldIdx){if(fieldIdx>=0){var sortByField=frame.fields[fieldIdx];sortByField.type===dataFrame.PU.string||isLikelyAscendingVector(sortByField.values)||(frame=(0,processDataFrame.ES)(frame,fieldIdx))}return frame}(frameCopy,joinIndex)),options.keep){var fields1=frameCopy.fields.filter((function(f,fieldIdx){return fieldIdx===joinIndex||options.keep(f,frameCopy,options.frames)}));frame!==frameCopy?frameCopy.fields=fields1:frameCopy=joinDataFrames_object_spread_props(joinDataFrames_object_spread({},frame),{fields:fields1})}return frameCopy}for(var nullModes=[],allData=[],originalFields=[],originalFieldsOrderByFrame=[],fieldsOrder=1,joinFieldMatcher1=getJoinMatcher(options),frameIndex=0;frameIndex<options.frames.length;frameIndex++){var _frame_fields,frame1=options.frames[frameIndex];if(frame1&&(null===(_frame_fields=frame1.fields)||void 0===_frame_fields?void 0:_frame_fields.length)){for(var nullModesFrame=[NULL_REMOVE],_$join=void 0,fields2=[],frameFieldsOrder=[],fieldIndex=0;fieldIndex<frame1.fields.length;fieldIndex++){var field=frame1.fields[fieldIndex];if(field.state=field.state||{},!_$join&&joinFieldMatcher1(field,frame1,options.frames))_$join=field;else{if(options.keep&&!options.keep(field,frame1,options.frames))continue;var _field_labels;nullModesFrame.push(nullMode(field));var labels=null!==(_field_labels=field.labels)&&void 0!==_field_labels?_field_labels:{},name=field.name;frame1.name&&(field.name===dataFrame.Bc?name=frame1.name:null==labels.name&&(labels=joinDataFrames_object_spread_props(joinDataFrames_object_spread({},labels),{name:frame1.name}))),fields2.push(joinDataFrames_object_spread_props(joinDataFrames_object_spread({},field),{name:name,labels:labels}))}options.keepOriginIndices&&(field.state.origin={frameIndex:frameIndex,fieldIndex:fieldIndex})}if(_$join){0===originalFields.length&&originalFields.push(_$join),nullModes.push(nullModesFrame);var a=[_$join.values],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=fields2[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var _field_state,field1=_step.value;if(a.push(field1.values),originalFields.push(field1),!options.keepDisplayNames)null===(_field_state=field1.state)||void 0===_field_state||delete _field_state.displayName;frameFieldsOrder.push(fieldsOrder),fieldsOrder++}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}originalFieldsOrderByFrame.push(frameFieldsOrder),allData.push(a)}}}var joined=[];joined=options.mode===JoinMode.outerTabular?function joinOuterTabular(tables,originalFieldsOrderByFrame,numberOfFields,nullModes){for(var duplicateHash={},tableIdx=0;tableIdx<tables.length;tableIdx++)for(var table=tables[tableIdx],joinOnTableField=table[0],otherTablesIdx=0;otherTablesIdx<tables.length;otherTablesIdx++)if(otherTablesIdx!==tableIdx)for(var otherTable=tables[otherTablesIdx],otherTableJoinOnField=otherTable[0],joinTableFieldValuesIdx=0;joinTableFieldValuesIdx<joinOnTableField.length;joinTableFieldValuesIdx++){for(var joinedRow=[joinOnTableField[joinTableFieldValuesIdx]].concat(new Array(numberOfFields-1)),tableFieldValIdx=0,fieldsIdx=1;fieldsIdx<table.length;fieldsIdx++){joinedRow[originalFieldsOrderByFrame[tableIdx][tableFieldValIdx]]=table[fieldsIdx][joinTableFieldValuesIdx],tableFieldValIdx++}for(var otherTableValuesIdx=0;otherTableValuesIdx<otherTableJoinOnField.length;otherTableValuesIdx++)if(joinOnTableField[joinTableFieldValuesIdx]===otherTableJoinOnField[otherTableValuesIdx]){for(var tableFieldValIdx1=0,fieldsIdx1=1;fieldsIdx1<otherTable.length;fieldsIdx1++){joinedRow[originalFieldsOrderByFrame[otherTablesIdx][tableFieldValIdx1]]=otherTable[fieldsIdx1][otherTableValuesIdx],tableFieldValIdx1++}break}duplicateHash[JSON.stringify(joinedRow)]=joinedRow}for(var data=[],field=0;field<numberOfFields;field++)data.push(new Array(0));for(var key in duplicateHash)for(var row=duplicateHash[key],valIdx=0;valIdx<row.length;valIdx++)data[valIdx].push(row[valIdx]);return data}(allData,originalFieldsOrderByFrame,originalFields.length):options.mode===JoinMode.inner?function joinInner(tables){var joinedTables=[],joinTables=function(currentTables,currentIndex,currentRow){if(currentIndex!==currentTables.length)for(var _currentTable=function _to_array(arr){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||joinDataFrames_iterable_to_array(arr)||joinDataFrames_unsupported_iterable_to_array(arr)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(currentTables[currentIndex]),xValues=_currentTable[0],yValues=_currentTable.slice(1),i=0;i<xValues.length;i++){var value=xValues[i];if(0===currentIndex||currentRow.includes(value)){var newRow=joinDataFrames_to_consumable_array(currentRow);0===currentIndex&&newRow.push(value);for(var j=0;j<yValues.length;j++)newRow.push(yValues[j][i]);joinTables(currentTables,currentIndex+1,newRow)}}else joinedTables.push(currentRow)};if(joinTables(tables,0,[]),0===joinedTables.length){var fieldCount=tables.reduce((function(count,table){return count+(table.length-1)}),1);return Array.from({length:fieldCount},(function(){return[]}))}return joinedTables[0].map((function(_,colIndex){return joinedTables.map((function(row){return row[colIndex]}))}))}(allData):join(allData,nullModes,options.mode);return{length:joined[0]?joined[0].length:0,fields:originalFields.map((function(f,index){return joinDataFrames_object_spread_props(joinDataFrames_object_spread({},f),{values:joined[index]})}))}}({frames:data,joinBy:joinBy,mode:options.mode});if(joined)return[joined]}return data}}};function joinDataFrames_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function joinDataFrames_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function joinDataFrames_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function joinDataFrames_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){joinDataFrames_define_property(target,key,source[key])}))}return target}function joinDataFrames_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function joinDataFrames_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function joinDataFrames_to_consumable_array(arr){return function joinDataFrames_array_without_holes(arr){if(Array.isArray(arr))return joinDataFrames_array_like_to_array(arr)}(arr)||joinDataFrames_iterable_to_array(arr)||joinDataFrames_unsupported_iterable_to_array(arr)||function joinDataFrames_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function joinDataFrames_unsupported_iterable_to_array(o,minLen){if(o){if("string"==typeof o)return joinDataFrames_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?joinDataFrames_array_like_to_array(o,minLen):void 0}}function getJoinMatcher(options){var _options_joinBy;return null!==(_options_joinBy=options.joinBy)&&void 0!==_options_joinBy?_options_joinBy:function pickBestJoinField(data){var _loop=function(i){var names=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[0].fields[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var f=_step.value;f.type===dataFrame.PU.number&&names.push(f.name)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}common=common.filter((function(v){return!names.includes(v)}))};if((0,processDataFrame.KR)(data[0]).timeField)return matchers.sJ.get(ids.Ct.firstTimeField).get({});var common=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=data[0].fields[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var f=_step.value;f.type===dataFrame.PU.number&&common.push(f.name)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}for(var i=1;i<data.length;i++)_loop();return matchers.sJ.get(ids.Ct.byName).get(common[0])}(options.frames)}var NULL_REMOVE=0,NULL_RETAIN=1,NULL_EXPAND=2;function nullExpand(yVals,nullIdxs,alignedLen){for(var xi,i=0,lastNullIdx=-1;i<nullIdxs.length;i++){var nullIdx=nullIdxs[i];if(nullIdx>lastNullIdx){for(xi=nullIdx-1;xi>=0&&null==yVals[xi];)yVals[xi--]=null;for(xi=nullIdx+1;xi<alignedLen&&null==yVals[xi];)yVals[lastNullIdx=xi++]=null}}}function join(tables,nullModes){arguments.length>2&&void 0!==arguments[2]||JoinMode.outer;for(var xVals=new Set,ti=0;ti<tables.length;ti++)for(var xs=tables[ti][0],len=xs.length,i=0;i<len;i++)xVals.add(xs[i]);for(var data=[Array.from(xVals).sort((function(a,b){return a-b}))],alignedLen=data[0].length,xIdxs=new Map,i1=0;i1<alignedLen;i1++)xIdxs.set(data[0][i1],i1);for(var ti1=0;ti1<tables.length;ti1++)for(var t1=tables[ti1],xs1=t1[0],si=1;si<t1.length;si++){for(var ys=t1[si],yVals=Array(alignedLen).fill(void 0),nullMode=nullModes?nullModes[ti1][si]:NULL_RETAIN,nullIdxs=[],i2=0;i2<ys.length;i2++){var yVal=ys[i2],alignedIdx=xIdxs.get(xs1[i2]);null===yVal?nullMode!==NULL_REMOVE&&(yVals[alignedIdx]=yVal,nullMode===NULL_EXPAND&&nullIdxs.push(alignedIdx)):yVals[alignedIdx]=yVal}nullExpand(yVals,nullIdxs,alignedLen),data.push(yVals)}return data}function isLikelyAscendingVector(data){var samples=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,len=data.length;if(len<=1)return!0;for(var firstIdx=0,lastIdx=len-1;firstIdx<=lastIdx&&null==data[firstIdx];)firstIdx++;for(;lastIdx>=firstIdx&&null==data[lastIdx];)lastIdx--;if(lastIdx<=firstIdx)return!0;for(var stride=Math.max(1,Math.floor((lastIdx-firstIdx+1)/samples)),prevVal=data[firstIdx],i=firstIdx+stride;i<=lastIdx;i+=stride){var v=data[i];if(null!=v&&null!=prevVal){if(v<=prevVal)return!1;prevVal=v}}return!0}var transformationsVariableSupport=function(){var _window_grafanaBootData_settings_featureToggles,_window_grafanaBootData_settings,_window_grafanaBootData,_window;return null===(_window=window)||void 0===_window||null===(_window_grafanaBootData=_window.grafanaBootData)||void 0===_window_grafanaBootData||null===(_window_grafanaBootData_settings=_window_grafanaBootData.settings)||void 0===_window_grafanaBootData_settings||null===(_window_grafanaBootData_settings_featureToggles=_window_grafanaBootData_settings.featureToggles)||void 0===_window_grafanaBootData_settings_featureToggles?void 0:_window_grafanaBootData_settings_featureToggles.transformationsVariableSupport};function histogram_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function histogram_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function histogram_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){histogram_define_property(target,key,source[key])}))}return target}function histogram_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function histogram_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function histogram_to_consumable_array(arr){return function histogram_array_without_holes(arr){if(Array.isArray(arr))return histogram_array_like_to_array(arr)}(arr)||function histogram_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function histogram_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return histogram_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return histogram_array_like_to_array(o,minLen)}(arr)||function histogram_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var histogramBucketSizes=[1e-9,2e-9,2.5e-9,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],histFilter=[],histSort=function(a,b){return a-b},histogramTransformer={id:DataTransformerID.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:function(options,ctx){return function(source){return source.pipe((0,map.T)((function(data){return histogramTransformer.transformer(options,ctx)(data)})))}},transformer:function(options,ctx){return function(data){if(!Array.isArray(data)||0===data.length)return data;var bucketSize,bucketOffset=void 0;options.bucketSize&&(transformationsVariableSupport()&&(options.bucketSize=ctx.interpolate(options.bucketSize.toString())),bucketSize="string"==typeof options.bucketSize?parseFloat(options.bucketSize):options.bucketSize,isNaN(bucketSize)&&(bucketSize=void 0)),options.bucketOffset&&(transformationsVariableSupport()&&(options.bucketOffset=ctx.interpolate(options.bucketOffset.toString())),bucketOffset="string"==typeof options.bucketOffset?parseFloat(options.bucketOffset):options.bucketOffset,isNaN(bucketOffset)&&(bucketOffset=void 0));var hist=function buildHistogram(frames,options){var _options_bucketCount,_options_bucketOffset,bucketSize=null==options?void 0:options.bucketSize,bucketCount=null!==(_options_bucketCount=null==options?void 0:options.bucketCount)&&void 0!==_options_bucketCount?_options_bucketCount:30,bucketOffset=null!==(_options_bucketOffset=null==options?void 0:options.bucketOffset)&&void 0!==_options_bucketOffset?_options_bucketOffset:0;if(frames=frames.map((function(frame){return histogram_object_spread_props(histogram_object_spread({},frame),{fields:frame.fields.map((function(field){if(field.type===dataFrame.PU.number){var noValue=Number(field.config.noValue);field=Number.isNaN(noValue)?histogram_object_spread_props(histogram_object_spread({},field),{values:field.values.filter((function(v){return null!=v}))}):nullToValueField(field,noValue)}return field}))})})),!bucketSize||bucketSize<0){var allValues=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=frames[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var frame=_step.value,_iteratorNormalCompletion1=!0,_didIteratorError1=!1,_iteratorError1=void 0;try{for(var _step1,_iterator1=frame.fields[Symbol.iterator]();!(_iteratorNormalCompletion1=(_step1=_iterator1.next()).done);_iteratorNormalCompletion1=!0){var field=_step1.value;field.type===dataFrame.PU.number&&(allValues=allValues.concat(field.values))}}catch(err){_didIteratorError1=!0,_iteratorError1=err}finally{try{_iteratorNormalCompletion1||null==_iterator1.return||_iterator1.return()}finally{if(_didIteratorError1)throw _iteratorError1}}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}allValues.sort((function(a,b){return a-b}));var smallestDelta=1/0;if(1===allValues.length)smallestDelta=1;else for(var i=1;i<allValues.length;i++){var delta=allValues[i]-allValues[i-1];0!==delta&&(smallestDelta=Math.min(smallestDelta,delta))}for(var min=allValues[0],targetSize=(allValues[allValues.length-1]-min)/bucketCount,i1=0;i1<histogramBucketSizes.length;i1++){var _bucketSize=histogramBucketSizes[i1];if(targetSize<_bucketSize&&_bucketSize>=smallestDelta){bucketSize=_bucketSize;break}}}var _match,getBucket=function(v){return numbers_roundDecimals(incrRoundDn(v-bucketOffset,bucketSize)+bucketOffset,9)},bucketDecimals=(null!==(_match=(""+bucketSize).match(/\.\d+$/))&&void 0!==_match?_match:["."])[0].length-1,histograms=[],counts=[],config=void 0,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=frames[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var frame1=_step2.value,_iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=frame1.fields[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var field1=_step3.value;if(field1.type===dataFrame.PU.number){var fieldHist=histogram(field1.values,getBucket,histFilter,histSort);histograms.push(fieldHist),counts.push(histogram_object_spread_props(histogram_object_spread({},field1),{config:histogram_object_spread_props(histogram_object_spread({},field1.config),{unit:"short"===field1.config.unit?"short":void 0})})),!config&&field1.config.unit&&(config=field1.config)}}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{_iteratorNormalCompletion3||null==_iterator3.return||_iterator3.return()}finally{if(_didIteratorError3)throw _iteratorError3}}}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}if(!counts.length)return null;for(var joinedHists=join(histograms),histIdx=1;histIdx<joinedHists.length;histIdx++)for(var hist=joinedHists[histIdx],bucketIdx=0;bucketIdx<hist.length;bucketIdx++)null==hist[bucketIdx]&&(hist[bucketIdx]=0);var xMin={name:histogramFrameBucketMinFieldName,values:joinedHists[0],type:dataFrame.PU.number,state:void 0,config:0===bucketDecimals?null!=config?config:{}:histogram_object_spread_props(histogram_object_spread({},config),{decimals:bucketDecimals})},xMax=histogram_object_spread_props(histogram_object_spread({},xMin),{name:histogramFrameBucketMaxFieldName,values:joinedHists[0].map((function(v){return v+bucketSize}))});if(null==options?void 0:options.combine){for(var vals=new Array(joinedHists[0].length).fill(0),i2=1;i2<joinedHists.length;i2++)for(var j=0;j<vals.length;j++)vals[j]+=joinedHists[i2][j];counts=[histogram_object_spread_props(histogram_object_spread({},counts[0]),{name:"count",values:vals,type:dataFrame.PU.number,state:histogram_object_spread_props(histogram_object_spread({},counts[0].state),{displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}})})]}else counts.forEach((function(field,i){field.values=joinedHists[i+1]}));return{xMin:xMin,xMax:xMax,counts:counts}}(data,{bucketSize:bucketSize,bucketOffset:bucketOffset,combine:options.combine});return null==hist?[]:[histogramFieldsToFrame(hist)]}}},histogramFrameBucketMinFieldName="xMin";var histogramFrameBucketMaxFieldName="xMax";function incrRoundUp(num,incr){return Math.ceil(num/incr)*incr}function incrRoundDn(num,incr){return Math.floor(num/incr)*incr}function histogram(vals,getBucket,filterOut,sort){for(var hist=new Map,i=0;i<vals.length;i++){var v=vals[i];null!=v&&(v=getBucket(v));var entry=hist.get(v);entry?entry.count++:hist.set(v,{value:v,count:1})}filterOut&&filterOut.forEach((function(v){return hist.delete(v)}));var bins=histogram_to_consumable_array(hist.values());sort&&bins.sort((function(a,b){return sort(a.value,b.value)}));for(var values=Array(bins.length),counts=Array(bins.length),i1=0;i1<bins.length;i1++)values[i1]=bins[i1].value,counts[i1]=bins[i1].count;return[values,counts]}function histogramFieldsToFrame(info,theme){if(!info.xMin.display){var display=(0,displayProcessor.J)({field:info.xMin,theme:null!=theme?theme:(0,createTheme.a)()});info.xMin.display=display,info.xMax.display=display}return info.counts[0].display=(0,displayProcessor.J)({field:info.counts[0],theme:null!=theme?theme:(0,createTheme.a)()}),{length:info.xMin.values.length,meta:{type:dataFrameTypes_DataFrameType.Histogram},fields:[info.xMin,info.xMax].concat(histogram_to_consumable_array(info.counts))}}function UPlotScaleBuilder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function UPlotScaleBuilder_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function UPlotScaleBuilder_get_prototype_of(o){return UPlotScaleBuilder_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},UPlotScaleBuilder_get_prototype_of(o)}function UPlotScaleBuilder_possible_constructor_return(self,call){return!call||"object"!==function UPlotScaleBuilder_type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?function UPlotScaleBuilder_assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function UPlotScaleBuilder_set_prototype_of(o,p){return UPlotScaleBuilder_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},UPlotScaleBuilder_set_prototype_of(o,p)}function UPlotScaleBuilder_create_super(Derived){var hasNativeReflectConstruct=function UPlotScaleBuilder_is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=UPlotScaleBuilder_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=UPlotScaleBuilder_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return UPlotScaleBuilder_possible_constructor_return(this,result)}}var UPlotScaleBuilder=function(PlotConfigBuilder){!function UPlotScaleBuilder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&UPlotScaleBuilder_set_prototype_of(subClass,superClass)}(UPlotScaleBuilder,PlotConfigBuilder);var _super=UPlotScaleBuilder_create_super(UPlotScaleBuilder);function UPlotScaleBuilder(){return function UPlotScaleBuilder_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UPlotScaleBuilder),_super.apply(this,arguments)}return function UPlotScaleBuilder_create_class(Constructor,protoProps,staticProps){return protoProps&&UPlotScaleBuilder_defineProperties(Constructor.prototype,protoProps),staticProps&&UPlotScaleBuilder_defineProperties(Constructor,staticProps),Constructor}(UPlotScaleBuilder,[{key:"merge",value:function merge(props){this.props.min=optMinMax("min",this.props.min,props.min),this.props.max=optMinMax("max",this.props.max,props.max)}},{key:"getConfig",value:function getConfig(){var _this_props=this.props,isTime=_this_props.isTime,scaleKey=_this_props.scaleKey,hardMin=_this_props.min,hardMax=_this_props.max,softMin=_this_props.softMin,softMax=_this_props.softMax,range=_this_props.range,direction=_this_props.direction,orientation=_this_props.orientation,centeredZero=_this_props.centeredZero,decimals=_this_props.decimals;_this_props.stackingMode===common_gen.gs.Percent&&(null==hardMin&&null==softMin&&(softMin=0),null==hardMax&&null==softMax&&(softMax=1));var _this_props_log,_this_props_linearThreshold,distr=this.props.distribution,distribution=isTime?{}:{distr:distr===common_gen.L4.Symlog?4:distr===common_gen.L4.Log?3:distr===common_gen.L4.Ordinal?2:1,log:distr===common_gen.L4.Log||distr===common_gen.L4.Symlog?null!==(_this_props_log=this.props.log)&&void 0!==_this_props_log?_this_props_log:2:void 0,asinh:distr===common_gen.L4.Symlog?null!==(_this_props_linearThreshold=this.props.linearThreshold)&&void 0!==_this_props_linearThreshold?_this_props_linearThreshold:1:void 0};if(distr===common_gen.L4.Log){var logBase=this.props.log,logFn=2===logBase?Math.log2:Math.log10;null!=hardMin&&(hardMin=hardMin<=0?null:Math.pow(logBase,Math.floor(logFn(hardMin)))),null!=hardMax&&(hardMax=hardMax<=0?null:Math.pow(logBase,Math.ceil(logFn(hardMax)))),null!=softMin&&(softMin=softMin<=0?null:Math.pow(logBase,Math.floor(logFn(softMin)))),null!=softMax&&(softMax=softMax<=0?null:Math.pow(logBase,Math.ceil(logFn(softMax))))}var rangeConfig={min:{pad:.1,hard:null!=hardMin?hardMin:-1/0,soft:softMin||0,mode:null==softMin?3:1},max:{pad:.1,hard:null!=hardMax?hardMax:1/0,soft:softMax||0,mode:null==softMax?3:1}},hardMinOnly=null==softMin&&null!=hardMin,hardMaxOnly=null==softMax&&null!=hardMax,hasFixedRange=hardMinOnly&&hardMaxOnly,auto=!isTime&&!hasFixedRange;return(0,valueFormats.j9)(scaleKey)&&(auto=!1,range=[0,1]),UPlotScaleBuilder_define_property({},scaleKey,function UPlotScaleBuilder_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){UPlotScaleBuilder_define_property(target,key,source[key])}))}return target}({time:isTime,auto:auto,range:null!=range?range:function(u,dataMin,dataMax,scaleKey){var _scale_log,scale=u.scales[scaleKey],minMax=[dataMin,dataMax];if(!hasFixedRange&&null==dataMin&&null==dataMax)return minMax;var logBase=null!==(_scale_log=scale.log)&&void 0!==_scale_log?_scale_log:10;if(1===scale.distr||2===scale.distr||4===scale.distr){if(centeredZero){var absMin=Math.abs(dataMin),absMax=Math.abs(dataMax),max=Math.max(absMin,absMax);0===max&&(max=80),dataMin=-max,dataMax=max}minMax=4===scale.distr?uPlot_esm.A.rangeAsinh(dataMin,dataMax,logBase,!0):uPlot_esm.A.rangeNum(hardMinOnly?hardMin:dataMin,hardMaxOnly?hardMax:dataMax,rangeConfig)}else 3===scale.distr&&(minMax=uPlot_esm.A.rangeLog(null!=hardMin?hardMin:dataMin,null!=hardMax?hardMax:dataMax,logBase,!0));if(0===decimals)if(1===scale.distr||2===scale.distr)minMax[0]=incrRoundDn(minMax[0],1),minMax[1]=incrRoundUp(minMax[1],1);else if(3===scale.distr){var logFn=2===scale.log?Math.log2:Math.log10;if(minMax[0]<=1)minMax[0]=1;else{var minExp=Math.floor(logFn(minMax[0]));minMax[0]=Math.pow(logBase,minExp)}var maxExp=Math.ceil(logFn(minMax[1]));minMax[1]=Math.pow(logBase,maxExp),minMax[0]===minMax[1]&&(minMax[1]*=logBase)}else 4===scale.distr&&(minMax[0]=incrRoundDn(minMax[0],1),minMax[1]=incrRoundUp(minMax[1],1));return 1!==scale.distr&&4!==scale.distr||(hardMinOnly&&(minMax[0]=hardMin),hardMaxOnly&&(minMax[1]=hardMax)),minMax[0]>=minMax[1]&&(minMax[0]=3===scale.distr?1:0,minMax[1]=100),minMax},dir:direction,ori:orientation},distribution))}}]),UPlotScaleBuilder}(PlotConfigBuilder);function optMinMax(minmax,a,b){return!(null==a)?!(null==b)?"min"===minmax?a<b?a:b:a>b?a:b:a:b}function UPlotAxisBuilder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function UPlotAxisBuilder_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function UPlotAxisBuilder_get_prototype_of(o){return UPlotAxisBuilder_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},UPlotAxisBuilder_get_prototype_of(o)}function UPlotAxisBuilder_possible_constructor_return(self,call){return!call||"object"!==function UPlotAxisBuilder_type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?function UPlotAxisBuilder_assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function UPlotAxisBuilder_set_prototype_of(o,p){return UPlotAxisBuilder_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},UPlotAxisBuilder_set_prototype_of(o,p)}function UPlotAxisBuilder_create_super(Derived){var hasNativeReflectConstruct=function UPlotAxisBuilder_is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=UPlotAxisBuilder_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=UPlotAxisBuilder_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return UPlotAxisBuilder_possible_constructor_return(this,result)}}var UPlotAxisBuilder=function(PlotConfigBuilder){!function UPlotAxisBuilder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&UPlotAxisBuilder_set_prototype_of(subClass,superClass)}(UPlotAxisBuilder,PlotConfigBuilder);var _super=UPlotAxisBuilder_create_super(UPlotAxisBuilder);function UPlotAxisBuilder(){return function UPlotAxisBuilder_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UPlotAxisBuilder),_super.apply(this,arguments)}return function UPlotAxisBuilder_create_class(Constructor,protoProps,staticProps){return protoProps&&UPlotAxisBuilder_defineProperties(Constructor.prototype,protoProps),staticProps&&UPlotAxisBuilder_defineProperties(Constructor,staticProps),Constructor}(UPlotAxisBuilder,[{key:"merge",value:function merge(props){this.props.size=optMinMax("max",this.props.size,props.size),this.props.label||(this.props.label=props.label),this.props.placement===common_gen.vM.Auto&&(this.props.placement=props.placement)}},{key:"getConfig",value:function getConfig(){var _this_props=this.props,scaleKey=_this_props.scaleKey,label=_this_props.label,_this_props_show=_this_props.show,show=void 0===_this_props_show||_this_props_show,_this_props_placement=_this_props.placement,placement=void 0===_this_props_placement?common_gen.vM.Auto:_this_props_placement,_this_props_grid=_this_props.grid,grid=void 0===_this_props_grid?{show:!0}:_this_props_grid,ticks=_this_props.ticks,space=_this_props.space,filter=_this_props.filter,_this_props_gap=_this_props.gap,gap=void 0===_this_props_gap?5:_this_props_gap,formatValue=_this_props.formatValue,splits=_this_props.splits,values=_this_props.values,incrs=_this_props.incrs,isTime=_this_props.isTime,timeZone=_this_props.timeZone,theme=_this_props.theme,tickLabelRotation=_this_props.tickLabelRotation,size=_this_props.size,color=_this_props.color,border=_this_props.border,decimals=_this_props.decimals,_this_props_distr=_this_props.distr,distr=void 0===_this_props_distr?common_gen.L4.Linear:_this_props_distr,font="".concat(12,"px ").concat(theme.typography.fontFamily),gridColor=theme.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,valueFormats.j9)(scaleKey)&&(splits=[0,1]),0===decimals&&distr===common_gen.L4.Linear&&(filter=function(u,splits){return splits.map((function(v){return Number.isInteger(v)?v:null}))});var config={scale:scaleKey,show:show,stroke:null!=color?color:theme.colors.text.primary,side:getUPlotSideFromAxis(placement),font:font,size:null!=size?size:function(self,values,axisIdx){return function calculateAxisSize(self,values,axisIdx){var axis=self.axes[axisIdx],axisSize=axis.ticks.size;if(2===axis.side)axisSize+=axis.gap+12;else if(null==values?void 0:values.length){var maxTextWidth=values.reduce((function(acc,value){return Math.max(acc,(0,measureText.kD)(value,12).width)}),0),textWidthWithLimit=Math.min(.4*self.width,maxTextWidth);axisSize+=axis.gap+axis.labelGap+textWidthWithLimit}return Math.ceil(axisSize)}(self,values,axisIdx)},rotate:tickLabelRotation,gap:gap,labelGap:0,grid:{show:grid.show,stroke:gridColor,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:(null==border?void 0:border.show)?null!=color?color:theme.colors.text.primary:gridColor,width:1/devicePixelRatio,size:4},ticks),splits:splits,values:values,space:null!=space?space:function(self,axisIdx,scaleMin,scaleMax,plotDim){return function calculateSpace(self,axisIdx,scaleMin,scaleMax,plotDim,formatValue){var axis=self.axes[axisIdx],scale=self.scales[axis.scale];if(2!==axis.side||!scale)return plotDim<=150?15:30;var maxTicks=plotDim/40,increment=(scaleMax-scaleMin)/maxTicks,bigValue=Math.max(Math.abs(scaleMin),Math.abs(scaleMax)),sample="";if(scale.time)sample=formatTime(self,[bigValue],axisIdx,40,increment)[0];else{if(null==formatValue)return 40;sample=formatValue(bigValue)}return(0,measureText.kD)(sample,12).width+18}(self,axisIdx,scaleMin,scaleMax,plotDim,formatValue)},filter:filter,incrs:incrs};return(null==border?void 0:border.show)&&(config.border=function UPlotAxisBuilder_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){UPlotAxisBuilder_define_property(target,key,source[key])}))}return target}({stroke:null!=color?color:theme.colors.text.primary,width:1/devicePixelRatio},border)),null!=label&&label.length>0&&(config.label=label,config.labelSize=20,config.labelFont=font,config.labelGap=8),values?config.values=values:isTime?config.values=formatTime:formatValue&&(config.values=function(u,splits,axisIdx,tickSpace,tickIncr){var decimals=function guessDecimals(num){return((""+num).split(".")[1]||"").length}(numbers_roundDecimals(tickIncr,6));return splits.map((function(v){return null==v?null:formatValue(v,decimals>0?decimals:void 0)}))}),config.timeZone=timeZone,config}}]),UPlotAxisBuilder}(PlotConfigBuilder),timeUnitSize={second:1e3,minute:6e4,hour:36e5,day:864e5,month:24192e5,year:31536e6};function formatTime(self,splits,axisIdx,foundSpace,foundIncr){var _scale_max,_scale_min,axis=self.axes[axisIdx],timeZone="timeZone"in axis&&"string"==typeof axis.timeZone?axis.timeZone:void 0,scale=self.scales.x,range=(null!==(_scale_max=null==scale?void 0:scale.max)&&void 0!==_scale_max?_scale_max:0)-(null!==(_scale_min=null==scale?void 0:scale.min)&&void 0!==_scale_min?_scale_min:0),yearRoundedToDay=Math.round(timeUnitSize.year/timeUnitSize.day)*timeUnitSize.day,incrementRoundedToDay=Math.round(foundIncr/timeUnitSize.day)*timeUnitSize.day,format=formats.WC.interval.year;return foundIncr<timeUnitSize.second?format=formats.WC.interval.millisecond:foundIncr<=timeUnitSize.minute?format=formats.WC.interval.second:range<=timeUnitSize.day?format=formats.WC.interval.minute:foundIncr<=timeUnitSize.day?format=formats.WC.interval.hour:range<timeUnitSize.year?format=formats.WC.interval.day:incrementRoundedToDay===yearRoundedToDay?format=formats.WC.interval.year:foundIncr<=timeUnitSize.year&&(format=formats.WC.interval.month),splits.map((function(v){return null==v?"":(0,formatter.LE)(v,{format:format,timeZone:timeZone})}))}function getUPlotSideFromAxis(axis){switch(axis){case common_gen.vM.Top:return 0;case common_gen.vM.Right:return 1;case common_gen.vM.Bottom:return 2;case common_gen.vM.Left:}return 3}var GradientDirection,types_fieldColor=__webpack_require__("../grafana-data/src/types/fieldColor.ts"),colorManipulator=__webpack_require__("../grafana-data/src/themes/colorManipulator.ts"),tinycolor=__webpack_require__("../../node_modules/tinycolor2/esm/tinycolor.js"),types_thresholds=__webpack_require__("../grafana-data/src/types/thresholds.ts");function gradientFills_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _sliced_to_array(arr,i){return function gradientFills_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function gradientFills_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return gradientFills_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gradientFills_array_like_to_array(o,minLen)}(arr,i)||function gradientFills_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function makeDirectionalGradient(direction,bbox,ctx){var x0=0,y0=0,x1=0,y1=0;return 3===direction?(y0=bbox.top,y1=bbox.top+bbox.height):2===direction?(x0=bbox.left+bbox.width,x1=bbox.left):1===direction?(y0=bbox.top+bbox.height,y1=bbox.top):0===direction&&(x0=bbox.left,x1=bbox.left+bbox.width),ctx.createLinearGradient(x0,y0,x1,y1)}function getHueGradientFn(color,opacity,theme){return function(plot,seriesIdx){var ctx=(0,measureText.Yc)(),gradient=makeDirectionalGradient(plot.scales.x.ori===common_gen.Lt.Horizontal?3:2,plot.bbox,ctx),color1=(0,tinycolor.A)(color).spin(-25).darken(5),color2=(0,tinycolor.A)(color).saturate(20).spin(20).brighten(10);return theme.isDark?(gradient.addColorStop(0,color2.lighten(10).setAlpha(opacity).toString()),gradient.addColorStop(1,color1.darken(10).setAlpha(opacity).toString())):(gradient.addColorStop(0,color2.lighten(10).setAlpha(opacity).toString()),gradient.addColorStop(1,color1.setAlpha(opacity).toString())),gradient}}function scaleGradient(u,scaleKey,scaleStops){for(var discrete=arguments.length>3&&void 0!==arguments[3]&&arguments[3],scale=u.scales[scaleKey],minStopIdx=null,maxStopIdx=null,i=0;i<scaleStops.length;i++){var stopVal=scaleStops[i][0];if((stopVal<=scale.min||null==minStopIdx)&&(minStopIdx=i),maxStopIdx=i,stopVal>=scale.max)break}if(minStopIdx===maxStopIdx)return scaleStops[minStopIdx][1];var minStopVal=scaleStops[minStopIdx][0],maxStopVal=scaleStops[maxStopIdx][0];minStopVal===-1/0&&(minStopVal=scale.min),maxStopVal===1/0&&(maxStopVal=scale.max);var x0,y0,x1,y1,minStopPos=Math.round(u.valToPos(minStopVal,scaleKey,!0)),maxStopPos=Math.round(u.valToPos(maxStopVal,scaleKey,!0)),range=minStopPos-maxStopPos;if(0===range)return scaleStops[maxStopIdx][1];u.scales.x.ori===common_gen.Lt.Horizontal?(x0=x1=0,y0=minStopPos,y1=maxStopPos):(y0=y1=0,x0=minStopPos,x1=maxStopPos);for(var prevColor,grd=(0,measureText.Yc)().createLinearGradient(x0,y0,x1,y1),i1=minStopIdx;i1<=maxStopIdx;i1++){var s=scaleStops[i1],pct=(minStopPos-(i1===minStopIdx?minStopPos:i1===maxStopIdx?maxStopPos:Math.round(u.valToPos(s[0],scaleKey,!0))))/range;discrete&&i1>minStopIdx&&grd.addColorStop(pct,prevColor),grd.addColorStop(pct,prevColor=s[1])}return grd}function getGradientRange(u,scaleKey,hardMin,hardMax,softMin,softMax){var _ref,_ref1,min=null!==(_ref=null!=hardMin?hardMin:softMin)&&void 0!==_ref?_ref:null,max=null!==(_ref1=null!=hardMax?hardMax:softMax)&&void 0!==_ref1?_ref1:null;if(null==min||null==max){var _ref2,_ref3,_getDataRange=_sliced_to_array(function getDataRange(plot,scaleKey){var sc=plot.scales[scaleKey],min=1/0,max=-1/0;return plot.series.forEach((function(ser,seriesIdx){if(ser.show&&ser.scale===scaleKey)if(null==ser.min)for(var data=plot.data[seriesIdx],i=0;i<data.length;i++)null!=data[i]&&(min=Math.min(min,data[i]),max=Math.max(max,data[i]));else min=Math.min(min,ser.min),max=Math.max(max,ser.max)})),max===min&&(min=sc.min,max=sc.max),[min,max]}(u,scaleKey),2),dataMin=_getDataRange[0],dataMax=_getDataRange[1];min=null!==(_ref2=null!=min?min:dataMin)&&void 0!==_ref2?_ref2:0,max=null!==(_ref3=null!=max?max:dataMax)&&void 0!==_ref3?_ref3:100}return[min,max]}function getScaleGradientFn(opacity,theme,colorMode,thresholds,hardMin,hardMax,softMin,softMax){if(!colorMode)throw Error("Missing colorMode required for color scheme gradients");if(!thresholds)throw Error("Missing thresholds required for color scheme gradients");return function(plot,seriesIdx){var scaleKey=plot.series[seriesIdx].scale,gradient="";if(colorMode.id===types_fieldColor.Y.Thresholds)if(thresholds.mode===types_thresholds.O.Absolute){gradient=scaleGradient(plot,scaleKey,thresholds.steps.map((function(step){return[step.value,(color=step.color,"transparent"===color||"#"===color[0]&&"00"===color.slice(-2)?"#0000":colorManipulator.MV.alpha(theme.visualization.getColorByName(step.color),opacity))];var color})),!0)}else{var _getGradientRange=_sliced_to_array(getGradientRange(plot,scaleKey,hardMin,hardMax,softMin,softMax),2),min=_getGradientRange[0],range=_getGradientRange[1]-min;gradient=scaleGradient(plot,scaleKey,thresholds.steps.map((function(step){return[min+range*(step.value/100),colorManipulator.MV.alpha(theme.visualization.getColorByName(step.color),opacity)]})),!0)}else if(colorMode.getColors){var colors=colorMode.getColors(theme),_getGradientRange1=_sliced_to_array(getGradientRange(plot,scaleKey,hardMin,hardMax,softMin,softMax),2),min1=_getGradientRange1[0],range1=_getGradientRange1[1]-min1;gradient=scaleGradient(plot,scaleKey,colors.map((function(color,i){return[min1+range1*(i/(colors.length-1)),colorManipulator.MV.alpha(theme.visualization.getColorByName(color),opacity)]})),!1)}return gradient}}function UPlotSeriesBuilder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function UPlotSeriesBuilder_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function UPlotSeriesBuilder_get_prototype_of(o){return UPlotSeriesBuilder_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},UPlotSeriesBuilder_get_prototype_of(o)}function UPlotSeriesBuilder_possible_constructor_return(self,call){return!call||"object"!==function UPlotSeriesBuilder_type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?function UPlotSeriesBuilder_assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function UPlotSeriesBuilder_set_prototype_of(o,p){return UPlotSeriesBuilder_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},UPlotSeriesBuilder_set_prototype_of(o,p)}function UPlotSeriesBuilder_create_super(Derived){var hasNativeReflectConstruct=function UPlotSeriesBuilder_is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=UPlotSeriesBuilder_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=UPlotSeriesBuilder_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return UPlotSeriesBuilder_possible_constructor_return(this,result)}}!function(GradientDirection){GradientDirection[GradientDirection.Right=0]="Right",GradientDirection[GradientDirection.Up=1]="Up",GradientDirection[GradientDirection.Left=2]="Left",GradientDirection[GradientDirection.Down=3]="Down"}(GradientDirection||(GradientDirection={}));var UPlotSeriesBuilder=function(PlotConfigBuilder){!function UPlotSeriesBuilder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&UPlotSeriesBuilder_set_prototype_of(subClass,superClass)}(UPlotSeriesBuilder,PlotConfigBuilder);var _super=UPlotSeriesBuilder_create_super(UPlotSeriesBuilder);function UPlotSeriesBuilder(){return function UPlotSeriesBuilder_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UPlotSeriesBuilder),_super.apply(this,arguments)}return function UPlotSeriesBuilder_create_class(Constructor,protoProps,staticProps){return protoProps&&UPlotSeriesBuilder_defineProperties(Constructor.prototype,protoProps),staticProps&&UPlotSeriesBuilder_defineProperties(Constructor,staticProps),Constructor}(UPlotSeriesBuilder,[{key:"getConfig",value:function getConfig(){var _lineStyle_dash,_this_props=this.props,facets=_this_props.facets,drawStyle=_this_props.drawStyle,pathBuilder=_this_props.pathBuilder,pointsBuilder=_this_props.pointsBuilder,pointsFilter=_this_props.pointsFilter,lineInterpolation=_this_props.lineInterpolation,lineWidth=_this_props.lineWidth,lineStyle=_this_props.lineStyle,barAlignment=_this_props.barAlignment,barWidthFactor=_this_props.barWidthFactor,barMaxWidth=_this_props.barMaxWidth,showPoints=_this_props.showPoints,pointSize=_this_props.pointSize,scaleKey=_this_props.scaleKey,pxAlign=_this_props.pxAlign,spanNulls=_this_props.spanNulls,_this_props_show=_this_props.show,show=void 0===_this_props_show||_this_props_show,lineConfig={},lineColor=this.getLineColor();(lineConfig.stroke=lineColor,lineConfig.width=lineWidth,lineStyle&&"solid"!==lineStyle.fill)&&("dot"===lineStyle.fill&&(lineConfig.cap="round"),lineConfig.dash=null!==(_lineStyle_dash=lineStyle.dash)&&void 0!==_lineStyle_dash?_lineStyle_dash:[10,10]);null!=pathBuilder?lineConfig.paths=pathBuilder:drawStyle===common_gen.GR.Points?lineConfig.paths=function(){return null}:null!=drawStyle&&(lineConfig.paths=function(self,seriesIdx,idx0,idx1){var pathsBuilder=function mapDrawStyleToPathBuilder(style,lineInterpolation){var barAlignment=arguments.length>2&&void 0!==arguments[2]?arguments[2]:common_gen.Nj.Center,barWidthFactor=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.6,barMaxWidth=arguments.length>4&&void 0!==arguments[4]?arguments[4]:200,pathBuilders=uPlot_esm.A.paths;builders||(builders={linear:pathBuilders.linear(),smooth:pathBuilders.spline(),stepBefore:pathBuilders.stepped({align:-1}),stepAfter:pathBuilders.stepped({align:1})});if(style===common_gen.GR.Bars){var barsCfgKey="bars|".concat(barAlignment,"|").concat(barWidthFactor,"|").concat(barMaxWidth);return builders[barsCfgKey]||(builders[barsCfgKey]=pathBuilders.bars({size:[barWidthFactor,barMaxWidth],align:barAlignment})),builders[barsCfgKey]}if(style===common_gen.GR.Line){if(lineInterpolation===common_gen.dx.StepBefore)return builders.stepBefore;if(lineInterpolation===common_gen.dx.StepAfter)return builders.stepAfter;if(lineInterpolation===common_gen.dx.Smooth)return builders.smooth}return builders.linear}(drawStyle,lineInterpolation,barAlignment,barWidthFactor,barMaxWidth);return pathsBuilder(self,seriesIdx,idx0,idx1)});var useColor="string"==typeof lineColor?lineColor:function(u,seriesIdx){return u.series[seriesIdx]._stroke},pointsConfig={points:{stroke:useColor,fill:useColor,size:!pointSize||pointSize<lineWidth?void 0:pointSize,filter:pointsFilter}};return null!=pointsBuilder?pointsConfig.points.show=pointsBuilder:drawStyle===common_gen.GR.Points?pointsConfig.points.show=!0:showPoints===common_gen.yL.Auto?drawStyle===common_gen.GR.Bars&&(pointsConfig.points.show=!1):showPoints===common_gen.yL.Never?pointsConfig.points.show=!1:showPoints===common_gen.yL.Always&&(pointsConfig.points.show=!0),function UPlotSeriesBuilder_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){UPlotSeriesBuilder_define_property(target,key,source[key])}))}return target}({scale:scaleKey,facets:facets,spanGaps:"number"!=typeof spanNulls&&spanNulls,value:function(){return""},pxAlign:pxAlign,show:show,fill:this.getFill()},lineConfig,pointsConfig)}},{key:"getLineColor",value:function getLineColor(){var _this_props=this.props,lineColor=_this_props.lineColor,gradientMode=_this_props.gradientMode,colorMode=_this_props.colorMode,thresholds=_this_props.thresholds,theme=_this_props.theme,hardMin=_this_props.hardMin,hardMax=_this_props.hardMax,softMin=_this_props.softMin,softMax=_this_props.softMax,dynamicSeriesColor=_this_props.dynamicSeriesColor;return gradientMode===common_gen.on.None&&dynamicSeriesColor?function(plot,seriesIdx){var _dynamicSeriesColor,_ref;return null!==(_ref=null!==(_dynamicSeriesColor=dynamicSeriesColor(seriesIdx))&&void 0!==_dynamicSeriesColor?_dynamicSeriesColor:lineColor)&&void 0!==_ref?_ref:types_fieldColor.F}:gradientMode===common_gen.on.Scheme&&(null==colorMode?void 0:colorMode.id)!==types_fieldColor.Y.Fixed?getScaleGradientFn(1,theme,colorMode,thresholds,hardMin,hardMax,softMin,softMax):gradientMode===common_gen.on.Hue?getHueGradientFn(null!=lineColor?lineColor:types_fieldColor.F,1,theme):null!=lineColor?lineColor:types_fieldColor.F}},{key:"getFill",value:function getFill(){var _this_props=this.props,lineColor=_this_props.lineColor,fillColor=_this_props.fillColor,gradientMode=_this_props.gradientMode,fillOpacity=_this_props.fillOpacity,colorMode=_this_props.colorMode,thresholds=_this_props.thresholds,theme=_this_props.theme,hardMin=_this_props.hardMin,hardMax=_this_props.hardMax,softMin=_this_props.softMin,softMax=_this_props.softMax,dynamicSeriesColor=_this_props.dynamicSeriesColor;if(fillColor)return fillColor;var mode=null!=gradientMode?gradientMode:common_gen.on.None,opacityPercent=(null!=fillOpacity?fillOpacity:0)/100;if(mode===common_gen.on.None&&dynamicSeriesColor&&opacityPercent>0)return function(u,seriesIdx){var lineColor=u.series[seriesIdx]._stroke;return colorManipulator.MV.alpha(null!=lineColor?lineColor:"",opacityPercent)};switch(mode){case common_gen.on.Opacity:return function getOpacityGradientFn(color,opacity){return function(plot,seriesIdx){var ctx=(0,measureText.Yc)(),gradient=makeDirectionalGradient(plot.scales.x.ori===common_gen.Lt.Horizontal?3:2,plot.bbox,ctx);return gradient.addColorStop(0,colorManipulator.MV.alpha(color,opacity)),gradient.addColorStop(1,colorManipulator.MV.alpha(color,0)),gradient}}(null!=fillColor?fillColor:lineColor,opacityPercent);case common_gen.on.Hue:return getHueGradientFn(null!=fillColor?fillColor:lineColor,opacityPercent,theme);case common_gen.on.Scheme:if((null==colorMode?void 0:colorMode.id)!==types_fieldColor.Y.Fixed)return getScaleGradientFn(opacityPercent,theme,colorMode,thresholds,hardMin,hardMax,softMin,softMax);default:if(opacityPercent>0)return colorManipulator.MV.alpha(null!=lineColor?lineColor:"",opacityPercent)}}}]),UPlotSeriesBuilder}(PlotConfigBuilder),builders=void 0;function UPlotThresholds_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function UPlotThresholds_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function UPlotThresholds_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function UPlotThresholds_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function UPlotThresholds_sliced_to_array(arr,i){return function UPlotThresholds_array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function UPlotThresholds_iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function UPlotThresholds_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return UPlotThresholds_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UPlotThresholds_array_like_to_array(o,minLen)}(arr,i)||function UPlotThresholds_non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function getThresholdsDrawHook(options){var dashSegments=options.config.mode===common_gen.Ly.Dashed||options.config.mode===common_gen.Ly.DashedAndArea?[10,10]:[];function addLines(u,yScaleKey,steps,theme){for(var ctx=u.ctx,transparentIndex=0,idx=0;idx<steps.length;idx++){if("transparent"===steps[idx].color){transparentIndex=idx;break}}ctx.lineWidth=2,ctx.setLineDash(dashSegments);for(var idx1=1;idx1<steps.length;idx1++){var step1=steps[idx1],color=void 0;1===(color=transparentIndex>=idx1&&idx1>0?(0,tinycolor.A)(theme.visualization.getColorByName(steps[idx1-1].color)):(0,tinycolor.A)(theme.visualization.getColorByName(step1.color))).getAlpha()&&color.setAlpha(.7);var isHorizontal=u.scales.x.ori===common_gen.Lt.Horizontal,scaleVal=u.valToPos(step1.value,yScaleKey,!0),x0=Math.round(isHorizontal?u.bbox.left:scaleVal),y0=Math.round(isHorizontal?scaleVal:u.bbox.top),x1=Math.round(isHorizontal?u.bbox.left+u.bbox.width:scaleVal),y1=Math.round(isHorizontal?scaleVal:u.bbox.top+u.bbox.height);ctx.beginPath(),ctx.moveTo(x0,y0),ctx.lineTo(x1,y1),ctx.strokeStyle=color.toString(),ctx.stroke()}}function addAreas(u,yScaleKey,steps,theme){var ctx=u.ctx,grd=scaleGradient(u,yScaleKey,steps.map((function(step){var color=(0,tinycolor.A)(theme.visualization.getColorByName(step.color));return 1===color.getAlpha()&&color.setAlpha(.15),[step.value,color.toString()]})),!0);ctx.fillStyle=grd,ctx.fillRect(u.bbox.left,u.bbox.top,u.bbox.width,u.bbox.height)}var scaleKey=options.scaleKey,thresholds=options.thresholds,theme=options.theme,config=options.config,hardMin=options.hardMin,hardMax=options.hardMax,softMin=options.softMin,softMax=options.softMax;return function(u){var ctx=u.ctx,_u_scales_x=u.scales.x,xMin=_u_scales_x.min,xMax=_u_scales_x.max,_u_scales_scaleKey=u.scales[scaleKey],yMin=_u_scales_scaleKey.min,yMax=_u_scales_scaleKey.max;if(null!=xMin&&null!=xMax&&null!=yMin&&null!=yMax){var steps=thresholds.steps;if(thresholds.mode===types_thresholds.O.Percentage){var _getGradientRange=UPlotThresholds_sliced_to_array(getGradientRange(u,scaleKey,hardMin,hardMax,softMin,softMax),2),min=_getGradientRange[0],range=_getGradientRange[1]-min;steps=steps.map((function(step){return UPlotThresholds_object_spread_props(function UPlotThresholds_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){UPlotThresholds_define_property(target,key,source[key])}))}return target}({},step),{value:min+range*(step.value/100)})}))}switch(ctx.save(),config.mode){case common_gen.Ly.Line:case common_gen.Ly.Dashed:addLines(u,scaleKey,steps,theme);break;case common_gen.Ly.Area:addAreas(u,scaleKey,steps,theme);break;case common_gen.Ly.LineAndArea:case common_gen.Ly.DashedAndArea:addAreas(u,scaleKey,steps,theme),addLines(u,scaleKey,steps,theme)}ctx.restore()}}}function UPlotConfigBuilder_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function UPlotConfigBuilder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function UPlotConfigBuilder_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function UPlotConfigBuilder_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){UPlotConfigBuilder_define_property(target,key,source[key])}))}return target}function UPlotConfigBuilder_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function UPlotConfigBuilder_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function UPlotConfigBuilder_to_consumable_array(arr){return function UPlotConfigBuilder_array_without_holes(arr){if(Array.isArray(arr))return UPlotConfigBuilder_array_like_to_array(arr)}(arr)||function UPlotConfigBuilder_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function UPlotConfigBuilder_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return UPlotConfigBuilder_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return UPlotConfigBuilder_array_like_to_array(o,minLen)}(arr)||function UPlotConfigBuilder_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var cursorDefaults={drag:{setScale:!1},points:{size:function(u,seriesIdx){return 2*u.series[seriesIdx].points.size},width:function(u,seriesIdx,size){return size/4}},focus:{prox:30}},UPlotConfigBuilder=function(){function UPlotConfigBuilder(){var _getTimeZoneInfo,_this=this,timeZone=arguments.length>0&&void 0!==arguments[0]?arguments[0]:time.lE;!function UPlotConfigBuilder_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UPlotConfigBuilder),UPlotConfigBuilder_define_property(this,"uid",Math.random().toString(36).slice(2)),UPlotConfigBuilder_define_property(this,"series",[]),UPlotConfigBuilder_define_property(this,"axes",{}),UPlotConfigBuilder_define_property(this,"scales",[]),UPlotConfigBuilder_define_property(this,"bands",[]),UPlotConfigBuilder_define_property(this,"stackingGroups",[]),UPlotConfigBuilder_define_property(this,"cursor",void 0),UPlotConfigBuilder_define_property(this,"select",void 0),UPlotConfigBuilder_define_property(this,"hasLeftAxis",!1),UPlotConfigBuilder_define_property(this,"hooks",{}),UPlotConfigBuilder_define_property(this,"tz",void 0),UPlotConfigBuilder_define_property(this,"mode",1),UPlotConfigBuilder_define_property(this,"frames",void 0),UPlotConfigBuilder_define_property(this,"thresholds",{}),UPlotConfigBuilder_define_property(this,"padding",void 0),UPlotConfigBuilder_define_property(this,"cachedConfig",void 0),UPlotConfigBuilder_define_property(this,"prepData",void 0),UPlotConfigBuilder_define_property(this,"scaleKeys",["",""]),UPlotConfigBuilder_define_property(this,"tzDate",(function(ts){var date=new Date(ts);return _this.tz?uPlot_esm.A.tzDate(date,_this.tz):date})),this.tz=null===(_getTimeZoneInfo=(0,timezones.QZ)(timeZone,Date.now()))||void 0===_getTimeZoneInfo?void 0:_getTimeZoneInfo.ianaName}return function UPlotConfigBuilder_create_class(Constructor,protoProps,staticProps){return protoProps&&UPlotConfigBuilder_defineProperties(Constructor.prototype,protoProps),staticProps&&UPlotConfigBuilder_defineProperties(Constructor,staticProps),Constructor}(UPlotConfigBuilder,[{key:"addHook",value:function addHook(type,hook){pluginLog("UPlotConfigBuilder",!1,"addHook",type),this.hooks[type]||(this.hooks[type]=[]),this.hooks[type].push(hook)}},{key:"addThresholds",value:function addThresholds(options){this.thresholds[options.scaleKey]||(this.thresholds[options.scaleKey]=options,this.addHook("drawClear",getThresholdsDrawHook(options)))}},{key:"addAxis",value:function addAxis(props){var _props_placement,_props_grid;props.placement=null!==(_props_placement=props.placement)&&void 0!==_props_placement?_props_placement:common_gen.vM.Auto,props.grid=null!==(_props_grid=props.grid)&&void 0!==_props_grid?_props_grid:{};var _props_timeZone,scaleKey=props.scaleKey;"x"===scaleKey&&(scaleKey+=null!==(_props_timeZone=props.timeZone)&&void 0!==_props_timeZone?_props_timeZone:"");this.axes[scaleKey]?this.axes[scaleKey].merge(props):(props.placement===common_gen.vM.Auto&&(props.placement=this.hasLeftAxis?common_gen.vM.Right:common_gen.vM.Left),props.placement===common_gen.vM.Left&&(this.hasLeftAxis=!0),props.placement===common_gen.vM.Hidden&&(props.grid.show=!1,props.size=0),this.axes[scaleKey]=new UPlotAxisBuilder(props))}},{key:"getAxisPlacement",value:function getAxisPlacement(scaleKey){var _axis_props_placement,axis=this.axes[scaleKey];return null!==(_axis_props_placement=null==axis?void 0:axis.props.placement)&&void 0!==_axis_props_placement?_axis_props_placement:common_gen.vM.Left}},{key:"setCursor",value:function setCursor(cursor){this.cursor=(0,lodash.merge)({},this.cursor,cursor)}},{key:"setMode",value:function setMode(mode){this.mode=mode}},{key:"setSelect",value:function setSelect(select){this.select=select}},{key:"addSeries",value:function addSeries(props){this.series.push(new UPlotSeriesBuilder(props))}},{key:"getSeries",value:function getSeries(){return this.series}},{key:"addScale",value:function addScale(props){var current=this.scales.find((function(v){return v.props.scaleKey===props.scaleKey}));current?current.merge(props):this.scales.push(new UPlotScaleBuilder(props))}},{key:"addBand",value:function addBand(band){this.bands.push(band)}},{key:"setStackingGroups",value:function setStackingGroups(groups){this.stackingGroups=groups}},{key:"getStackingGroups",value:function getStackingGroups(){return this.stackingGroups}},{key:"setPrepData",value:function setPrepData(prepData){var _this=this;this.prepData=function(frames){return _this.frames=frames,prepData(frames,_this.getStackingGroups())}}},{key:"setPadding",value:function setPadding(padding){this.padding=padding}},{key:"getConfig",value:function getConfig(){var _this=this,_this1=this;if(this.cachedConfig)return this.cachedConfig;var config=UPlotConfigBuilder_object_spread_props(UPlotConfigBuilder_object_spread({},DEFAULT_PLOT_CONFIG),{mode:this.mode,series:[2===this.mode?null:{value:function(){return""}}]});config.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map((function(a){return a.getConfig()})),config.series=UPlotConfigBuilder_to_consumable_array(config.series).concat(UPlotConfigBuilder_to_consumable_array(this.series.map((function(s){return s.getConfig()})))),config.scales=this.scales.reduce((function(acc,s){return UPlotConfigBuilder_object_spread({},acc,s.getConfig())}),{}),config.hooks=this.hooks,config.select=this.select;var pointColorFn=function(){var alphaHex=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(u,seriesIdx){var s=u.series[seriesIdx].points._stroke;if("string"!=typeof s){var field=_this1.frames[0].fields[seriesIdx];s=field.display(field.values[u.cursor.idxs[seriesIdx]]).color}return s+alphaHex}};return config.cursor=(0,lodash.merge)({},cursorDefaults,{points:{stroke:pointColorFn("80"),fill:pointColorFn()}},this.cursor),config.tzDate=this.tzDate,Array.isArray(this.padding)&&(config.padding=this.padding),this.stackingGroups.forEach((function(group){(function getStackingBands(group){var bands=[],series=group.series,dir=group.dir,lastIdx=series.length-1,rSeries=series.slice().reverse();return rSeries.forEach((function(si,i){if(i!==lastIdx){var nextIdx=rSeries[i+1];bands.push({series:[si,nextIdx],dir:-1*dir})}})),bands})(group).forEach((function(band){_this.addBand(band)}))})),this.bands.length&&(config.bands=this.bands),this.cachedConfig=config,config}},{key:"ensureNonOverlappingAxes",value:function ensureNonOverlappingAxes(axes){for(var xAxis=axes.find((function(a){return"x"===a.props.scaleKey})),axesWithoutGridSet=axes.filter((function(a){var _a_props_grid;return void 0===(null===(_a_props_grid=a.props.grid)||void 0===_a_props_grid?void 0:_a_props_grid.show)})),firstValueAxisIdx=axesWithoutGridSet.findIndex((function(a){return a.props.placement===common_gen.vM.Left||a.props.placement===common_gen.vM.Right||a.props.placement===common_gen.vM.Bottom&&a!==xAxis})),i=0;i<axesWithoutGridSet.length;i++)axesWithoutGridSet[i]===xAxis||i===firstValueAxisIdx?axesWithoutGridSet[i].props.grid.show=!0:axesWithoutGridSet[i].props.grid.show=!1;return axes}}]),UPlotConfigBuilder}();function nullInsertThreshold_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function nullInsertThreshold_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){nullInsertThreshold_define_property(target,key,source[key])}))}return target}function nullInsertThreshold_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function nullInsertThreshold_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}var INSERT_MODES={threshold:function(prev,next,threshold){return prev+threshold},midpoint:function(prev,next,threshold){return(prev+next)/2},plusone:function(prev,next,threshold){return prev+1}};function applyNullInsertThreshold(opts){if(0===opts.frame.length)return opts.frame;var frame=opts.frame,refFieldName=opts.refFieldName,refFieldPseudoMax=opts.refFieldPseudoMax,refFieldPseudoMin=opts.refFieldPseudoMin,insertMode=opts.insertMode;insertMode||(insertMode=INSERT_MODES.threshold);var refField=function getRefField(frame,refFieldName){return frame.fields.find((function(field){return null!=refFieldName?field.name===refFieldName:field.type===dataFrame.PU.time}))}(frame,refFieldName);if(null==refField)return frame;refField.state=nullInsertThreshold_object_spread_props(nullInsertThreshold_object_spread({},refField.state),{nullThresholdApplied:!0});var thresholds=frame.fields.map((function(field){var _field_config_custom;return(null===(_field_config_custom=field.config.custom)||void 0===_field_config_custom?void 0:_field_config_custom.insertNulls)||refField.config.interval||null})),uniqueThresholds=new Set(thresholds);if(uniqueThresholds.delete(null),0===uniqueThresholds.size)return frame;if(1===uniqueThresholds.size){var threshold=uniqueThresholds.values().next().value;if(threshold<=0)return frame;var refValues=refField.values,frameValues=frame.fields.map((function(field){return field.values})),filledFieldValues=function nullInsertThreshold(refValues,frameValues,threshold){var refFieldPseudoMin=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,refFieldPseudoMax=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,getInsertValue=arguments.length>5?arguments[5]:void 0,thorough=arguments.length>6?arguments[6]:void 0,len=refValues.length,refValuesNew=[];if(null!=refFieldPseudoMin&&refFieldPseudoMin<refValues[0])for(var preFillCount=Math.ceil((refValues[0]-refFieldPseudoMin)/threshold),prevSlot=refValues[0]-preFillCount*threshold;prevSlot<refValues[0];)refValuesNew.push(getInsertValue(prevSlot-threshold,prevSlot,threshold)),prevSlot+=threshold;refValuesNew.push(refValues[0]);for(var prevValue=refValues[0],i=1;i<len;i++){for(var curValue=refValues[i];curValue-prevValue>threshold&&(refValuesNew.push(getInsertValue(prevValue,curValue,threshold)),prevValue+=threshold,thorough););refValuesNew.push(curValue),prevValue=curValue}if(null!=refFieldPseudoMax&&refFieldPseudoMax>prevValue)for(;prevValue+threshold<refFieldPseudoMax;)refValuesNew.push(getInsertValue(prevValue,refFieldPseudoMax,threshold)),prevValue+=threshold;var filledLen=refValuesNew.length;if(filledLen===len)return frameValues;var filledFieldValues=[],_iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=frameValues[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var fieldValues=_step.value,filledValues=void 0;if(fieldValues!==refValues){filledValues=Array(filledLen);for(var i1=0,j=0;i1<filledLen;i1++)filledValues[i1]=refValues[j]===refValuesNew[i1]?fieldValues[j++]:null}else filledValues=refValuesNew;filledFieldValues.push(filledValues)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return filledFieldValues}(refValues,frameValues,threshold,refFieldPseudoMin,refFieldPseudoMax,insertMode,!0);return filledFieldValues===frameValues?frame:nullInsertThreshold_object_spread_props(nullInsertThreshold_object_spread({},frame),{length:filledFieldValues[0].length,fields:frame.fields.map((function(field,i){return nullInsertThreshold_object_spread_props(nullInsertThreshold_object_spread({},field),{values:filledFieldValues[i]})}))})}return frame}function Sparkline_utils_array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function Sparkline_utils_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Sparkline_utils_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){Sparkline_utils_define_property(target,key,source[key])}))}return target}function Sparkline_utils_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function Sparkline_utils_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function Sparkline_utils_to_consumable_array(arr){return function Sparkline_utils_array_without_holes(arr){if(Array.isArray(arr))return Sparkline_utils_array_like_to_array(arr)}(arr)||function Sparkline_utils_iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function Sparkline_utils_unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return Sparkline_utils_array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Sparkline_utils_array_like_to_array(o,minLen)}(arr)||function Sparkline_utils_non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function preparePlotFrame(sparkline,config){var _sparkline_timeRange,_sparkline_timeRange1,_sparkline_x,length=sparkline.y.values.length,yFieldConfig=Sparkline_utils_object_spread({},sparkline.y.config,config),xField=null!==(_sparkline_x=sparkline.x)&&void 0!==_sparkline_x?_sparkline_x:{name:"",values:Sparkline_utils_to_consumable_array(Array(length).keys()),type:dataFrame.PU.number,config:{}},frame={refId:"sparkline",fields:[xField,Sparkline_utils_object_spread_props(Sparkline_utils_object_spread({},sparkline.y),{config:yFieldConfig})],length:length};return isLikelyAscendingVector(xField.values)||(frame=(0,processDataFrame.ES)(frame,0)),applyNullInsertThreshold({frame:frame,refFieldPseudoMin:null===(_sparkline_timeRange=sparkline.timeRange)||void 0===_sparkline_timeRange?void 0:_sparkline_timeRange.from.valueOf(),refFieldPseudoMax:null===(_sparkline_timeRange1=sparkline.timeRange)||void 0===_sparkline_timeRange1?void 0:_sparkline_timeRange1.to.valueOf()})}function Sparkline_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function Sparkline_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function Sparkline_get_prototype_of(o){return Sparkline_get_prototype_of=Object.setPrototypeOf?Object.getPrototypeOf:function getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)},Sparkline_get_prototype_of(o)}function Sparkline_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){Sparkline_define_property(target,key,source[key])}))}return target}function Sparkline_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function Sparkline_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function Sparkline_possible_constructor_return(self,call){return!call||"object"!==function Sparkline_type_of(obj){return obj&&"undefined"!=typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj}(call)&&"function"!=typeof call?function Sparkline_assert_this_initialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function Sparkline_set_prototype_of(o,p){return Sparkline_set_prototype_of=Object.setPrototypeOf||function setPrototypeOf(o,p){return o.__proto__=p,o},Sparkline_set_prototype_of(o,p)}function Sparkline_create_super(Derived){var hasNativeReflectConstruct=function Sparkline_is_native_reflect_construct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var result,Super=Sparkline_get_prototype_of(Derived);if(hasNativeReflectConstruct){var NewTarget=Sparkline_get_prototype_of(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return Sparkline_possible_constructor_return(this,result)}}var defaultConfig={drawStyle:common_gen.GR.Line,showPoints:common_gen.yL.Auto,axisPlacement:common_gen.vM.Hidden,pointSize:2},Sparkline=function(PureComponent){!function Sparkline_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&Sparkline_set_prototype_of(subClass,superClass)}(Sparkline,PureComponent);var _super=Sparkline_create_super(Sparkline);function Sparkline(props){var _this;!function Sparkline_class_call_check(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Sparkline),_this=_super.call(this,props);var alignedDataFrame=preparePlotFrame(props.sparkline,props.config);return _this.state={data:preparePlotData2(alignedDataFrame,getStackingGroups(alignedDataFrame)),alignedDataFrame:alignedDataFrame,configBuilder:_this.prepareConfig(alignedDataFrame)},_this}return function Sparkline_create_class(Constructor,protoProps,staticProps){return protoProps&&Sparkline_defineProperties(Constructor.prototype,protoProps),staticProps&&Sparkline_defineProperties(Constructor,staticProps),Constructor}(Sparkline,[{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState){var alignedDataFrame=this.state.alignedDataFrame;if(alignedDataFrame){var rebuildConfig=!1;if(prevProps.sparkline!==this.props.sparkline){var _alignedDataFrame_fields__state,_prevState_alignedDataFrame_fields__state,isStructureChanged=!function compareDataFrameStructures(a,b,skipConfig){var _a_fields,_b_fields;if(a===b)return!0;if((null==a||null===(_a_fields=a.fields)||void 0===_a_fields?void 0:_a_fields.length)!==(null==b||null===(_b_fields=b.fields)||void 0===_b_fields?void 0:_b_fields.length))return!1;if(a.name!==b.name)return!1;for(var i=0;i<a.fields.length;i++){var fA=a.fields[i],fB=b.fields[i];if(fA.type!==fB.type||fA.name!==fB.name)return!1;if(!skipConfig){if(fA.labels&&fB.labels&&!shallowCompare(fA.labels,fB.labels))return!1;var cfgA=fA.config,cfgB=fB.config;if(Object.keys(cfgA).length!==Object.keys(cfgB).length)return!1;var key=void 0;for(key in cfgA){if(!(key in cfgB))return!1;if("interval"!==key&&!(0,lodash.isEqual)(cfgA[key],cfgB[key]))return!1}}}return!0}(this.state.alignedDataFrame,prevState.alignedDataFrame),isRangeChanged=!(0,lodash.isEqual)(null===(_alignedDataFrame_fields__state=alignedDataFrame.fields[1].state)||void 0===_alignedDataFrame_fields__state?void 0:_alignedDataFrame_fields__state.range,null===(_prevState_alignedDataFrame_fields__state=prevState.alignedDataFrame.fields[1].state)||void 0===_prevState_alignedDataFrame_fields__state?void 0:_prevState_alignedDataFrame_fields__state.range);rebuildConfig=isStructureChanged||isRangeChanged}else rebuildConfig=!(0,lodash.isEqual)(prevProps.config,this.props.config);rebuildConfig&&this.setState({configBuilder:this.prepareConfig(alignedDataFrame)})}}},{key:"getYRange",value:function getYRange(field){var _this_state_alignedDataFrame_fields__state,_this_state_alignedDataFrame_fields__config,_field_config_min,_field_config_max,_ref=null===(_this_state_alignedDataFrame_fields__state=this.state.alignedDataFrame.fields[1].state)||void 0===_this_state_alignedDataFrame_fields__state?void 0:_this_state_alignedDataFrame_fields__state.range,min=_ref.min,max=_ref.max,noValue=+(null===(_this_state_alignedDataFrame_fields__config=this.state.alignedDataFrame.fields[1].config)||void 0===_this_state_alignedDataFrame_fields__config?void 0:_this_state_alignedDataFrame_fields__config.noValue);return Number.isNaN(noValue)||(min=Math.min(min,+noValue),max=Math.max(max,+noValue)),min===max?(0===min?max=100:(min=0,max*=2),[min,max]):[Math.max(min,null!==(_field_config_min=field.config.min)&&void 0!==_field_config_min?_field_config_min:-1/0),Math.min(max,null!==(_field_config_max=field.config.max)&&void 0!==_field_config_max?_field_config_max:1/0)]}},{key:"prepareConfig",value:function prepareConfig(data){var _loop=function(i){var field=data.fields[i],config=field.config,customConfig=Sparkline_object_spread({},defaultConfig,config.custom);if(field===xField||field.type!==dataFrame.PU.number)return"continue";var scaleKey=config.unit||"__fixed";builder.addScale({scaleKey:scaleKey,orientation:common_gen.Lt.Vertical,direction:common_gen.ON.Up,range:function(){return _this.getYRange(field)}}),builder.addAxis({scaleKey:scaleKey,theme:theme,placement:common_gen.vM.Hidden});var _customConfig_lineColor,colorMode=(0,fieldColor.Qi)(field),seriesColor=colorMode.getCalculator(field,theme)(0,0),pointsMode=customConfig.drawStyle===common_gen.GR.Points?common_gen.yL.Always:customConfig.showPoints;builder.addSeries({pxAlign:!1,scaleKey:scaleKey,theme:theme,colorMode:colorMode,thresholds:config.thresholds,drawStyle:customConfig.drawStyle,lineColor:null!==(_customConfig_lineColor=customConfig.lineColor)&&void 0!==_customConfig_lineColor?_customConfig_lineColor:seriesColor,lineWidth:customConfig.lineWidth,lineInterpolation:customConfig.lineInterpolation,showPoints:pointsMode,pointSize:customConfig.pointSize,fillOpacity:customConfig.fillOpacity,fillColor:customConfig.fillColor,lineStyle:customConfig.lineStyle,gradientMode:customConfig.gradientMode,spanNulls:customConfig.spanNulls})},_this=this,theme=this.props.theme,builder=new UPlotConfigBuilder;builder.setCursor({show:!1,x:!1,y:!1});var xField=data.fields[0];builder.addScale({scaleKey:"x",orientation:common_gen.Lt.Horizontal,direction:common_gen.ON.Right,isTime:!1,range:function(){var sparkline=_this.props.sparkline;if(sparkline.x){if(sparkline.timeRange&&sparkline.x.type===dataFrame.PU.time)return[sparkline.timeRange.from.valueOf(),sparkline.timeRange.to.valueOf()];var vals=sparkline.x.values;return[vals[0],vals[vals.length-1]]}return[0,sparkline.y.values.length-1]}}),builder.addAxis({scaleKey:"x",theme:theme,placement:common_gen.vM.Hidden});for(var i=0;i<data.fields.length;i++)_loop(i);return builder}},{key:"render",value:function render(){var _this_state=this.state,data=_this_state.data,configBuilder=_this_state.configBuilder,_this_props=this.props,width=_this_props.width,height=_this_props.height;return(0,jsx_runtime.jsx)(UPlotChart,{data:data,config:configBuilder,width:width,height:height})}}],[{key:"getDerivedStateFromProps",value:function getDerivedStateFromProps(props,state){var frame=function nullToValue(frame){return _object_spread_props(_object_spread({},frame),{fields:frame.fields.map((function(field){var noValue=Number(field.config.noValue);return Number.isNaN(noValue)?field:nullToValueField(field,noValue)}))})}(preparePlotFrame(props.sparkline,props.config));return frame?Sparkline_object_spread_props(Sparkline_object_spread({},state),{data:preparePlotData2(frame,getStackingGroups(frame)),alignedDataFrame:frame}):Sparkline_object_spread({},state)}}]),Sparkline}(react.PureComponent);try{Sparkline.displayName="Sparkline",Sparkline.__docgenInfo={description:"",displayName:"Sparkline",props:{width:{defaultValue:null,description:"",name:"width",required:!0,type:{name:"number"}},height:{defaultValue:null,description:"",name:"height",required:!0,type:{name:"number"}},config:{defaultValue:null,description:"",name:"config",required:!1,type:{name:"FieldConfig<GraphFieldConfig>"}},sparkline:{defaultValue:null,description:"",name:"sparkline",required:!0,type:{name:"FieldSparkline"}},theme:{defaultValue:null,description:"",name:"theme",required:!0,type:{name:"GrafanaTheme2"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Sparkline/Sparkline.tsx#Sparkline"]={docgenInfo:Sparkline.__docgenInfo,name:"Sparkline",path:"src/components/Sparkline/Sparkline.tsx#Sparkline"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/colors.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{mZ:function(){return getTextColorForAlphaBackground}});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/lodash/lodash.js"),tinycolor2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/tinycolor2/esm/tinycolor.js");function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _to_consumable_array(arr){return function _array_without_holes(arr){if(Array.isArray(arr))return _array_like_to_array(arr)}(arr)||function _iterable_to_array(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr)||function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hexToHsl(color){return(0,tinycolor2__WEBPACK_IMPORTED_MODULE_1__.A)(color).toHsl()}function hslToHex(color){return(0,tinycolor2__WEBPACK_IMPORTED_MODULE_1__.A)(color).toHexString()}function getTextColorForAlphaBackground(color,themeIsDark){var tcolor=(0,tinycolor2__WEBPACK_IMPORTED_MODULE_1__.A)(color),b=tcolor.getBrightness();return tcolor.getAlpha()<.3?themeIsDark?"rgb(247, 248, 250)":"rgb(32, 34, 38)":b>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}(function sortColorsByHue(hexColors){var hslColors=(0,lodash__WEBPACK_IMPORTED_MODULE_0__.map)(hexColors,hexToHsl),sortedHSLColors=(0,lodash__WEBPACK_IMPORTED_MODULE_0__.sortBy)(hslColors,["h"]),chunkedHSLColors=(0,lodash__WEBPACK_IMPORTED_MODULE_0__.chunk)(sortedHSLColors,4),sortedChunkedHSLColors=(0,lodash__WEBPACK_IMPORTED_MODULE_0__.map)(chunkedHSLColors,(function(chunk){return(0,lodash__WEBPACK_IMPORTED_MODULE_0__.sortBy)(chunk,"l")})),flattenedZippedSortedChunkedHSLColors=(0,lodash__WEBPACK_IMPORTED_MODULE_0__.flattenDeep)(lodash__WEBPACK_IMPORTED_MODULE_0__.zip.apply(void 0,_to_consumable_array(sortedChunkedHSLColors)));return(0,lodash__WEBPACK_IMPORTED_MODULE_0__.map)(flattenedZippedSortedChunkedHSLColors,hslToHex)})(["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"])}}]);