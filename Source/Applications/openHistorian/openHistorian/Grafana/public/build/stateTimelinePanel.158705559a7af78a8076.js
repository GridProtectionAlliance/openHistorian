"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6199],{17665:(Nt,O,t)=>{t.r(O),t.d(O,{plugin:()=>dt});var Y=t(65158),Z=t(37055),G=t(24293),j=t(11261),F=t(27310),f=t(52622),Q=t(11404),J=t(22680),X=t(89654),R=t(11082),H=t(34163),i=t(74848),S=t(32196),p=t(96540),w=t(49185),E=t(94624),b=t(19384),k=t(40845),q=t(79041),_=t(68268),V=t(38761),tt=t(82389),v=t(28895),et=t(62567),nt=t(7874),at=t(82915),st=t(87232);const h={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:f.yL.Auto},W={fillOpacity:70,lineWidth:0},N={container:(0,S.css)({display:"flex",flexDirection:"column"}),paginationContainer:(0,S.css)({display:"flex",justifyContent:"center",width:"100%"}),paginationElement:(0,S.css)({marginTop:"8px"})};function ot(n,e){const[o,a]=(0,p.useState)(1),[u,{height:g,width:c}]=(0,w.A)(),r=(0,p.useMemo)(()=>!e||n==null?n:(0,v.uB)(n),[n,e]);if(!e||r==null)return{paginatedFrames:r,paginationRev:"disabled",paginationElement:void 0,paginationHeight:0};e||=h.perPage;const s=Math.ceil(r.length/e),l=Math.min(o,s),d=(l-1)*e,m=r.slice(d,d+e),A=`${l}/${e}`,x=c<550,M=(0,i.jsx)("div",{className:N.paginationContainer,ref:u,children:(0,i.jsx)(b.d,{className:N.paginationElement,currentPage:l,numberOfPages:s,showSmallVersion:x,onNavigate:a})});return{paginatedFrames:m,paginationRev:A,paginationElement:M,paginationHeight:g}}const lt=({data:n,timeRange:e,timeZone:o,options:a,width:u,height:g,replaceVariables:c,onChangeTimeRange:r})=>{const s=(0,k.$j)(),[l,d]=(0,p.useState)(null),{sync:m,eventsScope:A,canAddAnnotations:x,dataLinkPostProcessor:M,eventBus:gt}=(0,q.d2)(),T=m?.()??E.y.Off,{frames:mt,warn:L}=(0,p.useMemo)(()=>(0,v.Qe)(n.series,a.mergeValues??!0,e,s),[n.series,a.mergeValues,e,s]),{paginatedFrames:y,paginationRev:ft,paginationElement:pt,paginationHeight:ct}=ot(mt,a.perPage),ht=(0,p.useMemo)(()=>(0,v.Or)(y,a.legend,s),[y,a.legend,s]),vt=(0,p.useMemo)(()=>(0,at.Fg)(a.timezone,o),[a.timezone,o]);if(!y||L)return(0,i.jsx)("div",{className:"panel-empty",children:(0,i.jsx)("p",{children:L??"No data found in response"})});const D=!!(x&&x());return(0,i.jsxs)("div",{className:N.container,children:[(0,i.jsx)(tt.I,{theme:s,frames:y,structureRev:n.structureRev,paginationRev:ft,timeRange:e,timeZone:vt,width:u,height:g-ct,legendItems:ht,...a,mode:v.pm.Changes,replaceVariables:c,dataLinkPostProcessor:M,cursorSync:T,children:(C,$)=>(0,i.jsxs)(i.Fragment,{children:[T!==E.y.Off&&(0,i.jsx)(_.K,{config:C,eventBus:gt,frame:$}),a.tooltip.mode!==f.$N.None&&(0,i.jsx)(V.xl,{config:C,hoverMode:a.tooltip.mode===f.$N.Multi?V.b3.xAll:V.b3.xOne,queryZoom:r,syncMode:T,syncScope:A,render:(B,xt,yt,Ct,z,U,St)=>{if(D&&U!=null){d(U),z();return}const Vt=()=>{let K=B.posToVal(B.cursor.left,"x");d({from:K,to:K}),z()};return(0,i.jsx)(st.K,{series:$,dataIdxs:xt,seriesIdx:yt,mode:St?f.$N.Multi:a.tooltip.mode,sortOrder:a.tooltip.sort,isPinned:Ct,timeRange:e,annotate:D?Vt:void 0,withDuration:!0,maxHeight:a.tooltip.maxHeight,replaceVariables:c})},maxWidth:a.tooltip.maxWidth}),(0,i.jsx)(et.W,{annotations:n.annotations??[],config:C,timeZone:o,newRange:l,setNewRange:d,canvasRegionRendering:!1}),(0,i.jsx)(nt.U,{config:C,onChangeTimeRange:r})]})}),pt]})};var P=t(2543),I=t(25019);const it=(n,e,o)=>{let a=n.options??{};if(e==="natel-discrete-panel"&&o.angular){const u=o.angular,g=n.fieldConfig??{defaults:{},overrides:[]};u.units&&(g.defaults.unit=u.units);const c={fillOpacity:100,lineWidth:0};g.defaults.custom=c,a.mergeValues=!0;const r={type:I.d.ValueToText,options:{}};if(g.defaults.mappings=[r],(0,P.isArray)(u.colorMaps))for(const s of u.colorMaps){const l=s.color;l&&(r.options[s.text]={color:l})}if((0,P.isArray)(u.valueMaps))for(const s of u.valueMaps){const l=s.text,d=s.value;if(l&&d){let m=r.options[d];m?m.text=l:r.options[d]={text:l}}}if((0,P.isArray)(u.rangeMaps))for(const s of u.rangeMaps){let l=+s.from,d=+s.to;const m=s.text;m&&g.defaults.mappings.push({type:I.d.RangeToText,options:{from:l,to:d,result:{text:m}}})}n.fieldConfig=g}return a};var ut=t(38824);class rt{getSuggestionsForData(e){const{dataSummary:o}=e;if(!o.hasData||!o.hasTimeField||!o.hasStringField&&!o.hasNumberField||o.numberFieldCount>=30||o.preferredVisualisationType==="logs")return;e.getListAppender({name:"",pluginId:"state-timeline",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]}}).append({name:ut.m.StateTimeline})}}const dt=new Y.m(lt).setPanelChangeHandler(it).useFieldConfig({standardOptions:{[Z.uo.Color]:{settings:{byValueSupport:!0},defaultValue:{mode:G.Y.ContinuousGrYlRd}}},useCustomConfig:n=>{n.addSliderInput({path:"lineWidth",name:"Line width",defaultValue:W.lineWidth,settings:{min:0,max:10,step:1}}).addSliderInput({path:"fillOpacity",name:"Fill opacity",defaultValue:W.fillOpacity,settings:{min:0,max:100,step:1}}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",defaultValue:!1,editor:H.e,override:H.e,shouldApply:e=>e.type!==j.PU.time,process:F.hS,settings:{isTime:!0}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",defaultValue:!1,editor:R.Z,override:R.Z,shouldApply:e=>e.type!==j.PU.time,process:F.hS,settings:{isTime:!0}}),Q.e(n)}}).setPanelOptions(n=>{n.addBooleanSwitch({path:"mergeValues",name:"Merge equal consecutive values",defaultValue:h.mergeValues}).addRadio({path:"showValue",name:"Show values",settings:{options:[{value:f.yL.Auto,label:"Auto"},{value:f.yL.Always,label:"Always"},{value:f.yL.Never,label:"Never"}]},defaultValue:h.showValue}).addRadio({path:"alignValue",name:"Align values",settings:{options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},defaultValue:h.alignValue}).addSliderInput({path:"rowHeight",name:"Row height",settings:{min:0,max:1,step:.01},defaultValue:h.rowHeight}).addNumberInput({path:"perPage",name:"Page size (enable pagination)",settings:{min:1,step:1,integer:!0}}),J.H(n,!1),X.D(n)}).setSuggestionsSupplier(new rt).setDataSupport({annotations:!0})}}]);

//# sourceMappingURL=stateTimelinePanel.158705559a7af78a8076.js.map