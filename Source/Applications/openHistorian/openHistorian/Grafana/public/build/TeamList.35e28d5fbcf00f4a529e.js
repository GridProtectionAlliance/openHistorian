"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1036],{31084:(x,M,e)=>{e.d(M,{Y:()=>_});var a=e(74848),D=e(96540),r=e(41053),c=e(10096),m=e(31678),O=e(37425),f=e(85927);const _=({teamId:o,roleOptions:n,disabled:E,roles:d,onApplyRoles:P,pendingRoles:p,apply:v=!1,maxWidth:W,width:L,isLoading:K})=>{const[{loading:h,value:g=d||[]},T]=(0,r.A)(async()=>{try{if(d)return d;if(v&&p?.length)return p;if(c.TP.hasPermission(m.AccessControlAction.ActionTeamsRolesList)&&o>0)return await(0,f.xN)(o)}catch(s){console.error("Error loading options",s)}return[]},[o,p,d]);(0,D.useEffect)(()=>{T()},[T]);const $=async s=>{v?P&&P(s):(await(0,f.G3)(s,o),await T())},t=c.TP.hasPermission(m.AccessControlAction.ActionTeamsRolesAdd)&&c.TP.hasPermission(m.AccessControlAction.ActionTeamsRolesRemove);return(0,a.jsx)(O.n,{apply:v,onRolesChange:$,roleOptions:n,appliedRoles:g,isLoading:h||K,disabled:E,basicRoleDisabled:!0,canUpdateRoles:t,maxWidth:W,width:L})}},76323:(x,M,e)=>{e.d(M,{J:()=>O});var a=e(74848),D=e(32196),r=e(96540),c=e(14110),m=e(40845);const O=({text:_="PRO",className:o,experimentId:n,eventVariant:E="",...d})=>{const P=(0,m.of)(f);return(0,r.useEffect)(()=>{n&&(0,c.Xp)(n,"test",E)},[n,E]),(0,a.jsx)("span",{className:(0,D.cx)(P.badge,o),...d,children:_})},f=_=>({badge:(0,D.css)`
      margin-left: ${_.spacing(1.25)};
      border-radius: ${_.shape.borderRadius(5)};
      background-color: ${_.colors.success.main};
      padding: ${_.spacing(.25,.75)};
      color: white; // use the same color for both themes
      font-weight: ${_.typography.fontWeightMedium};
      font-size: ${_.typography.pxToRem(10)};
    `})},35538:(x,M,e)=>{e.d(M,{pL:()=>D,z5:()=>c});var a=e(32264);const D=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;function r(){const m=a.$.licenseInfo?.trialExpiry;return!!(m&&m>0)}const c=()=>r()&&a.$.featureToggles.featureHighlights},52576:(x,M,e)=>{e.r(M),e.d(M,{TeamList:()=>l,default:()=>B});var a=e(74848),D=e(32196),r=e(96540),c=e(70255),m=e(71468),O=e(40845),f=e(12942),_=e(72109),o=e(67061),n=e(55852),E=e(91605),d=e(69529),P=e(14186),p=e(67647),v=e(48840),W=e(19384),L=e(21780),K=e(85927),h=e(8484),g=e(16233),T=e(31678),$=e(31084),t=e(33667);const s=new Array(3).fill(null).map((u,U)=>({id:U,uid:"",memberCount:0,name:"",orgId:0,permission:0})),l=({teams:u,query:U,noTeams:I,hasFetched:C,loadTeams:b,deleteTeam:Y,changeQuery:H,totalPages:X,page:F,rolesLoading:Q,changePage:w,changeSort:k})=>{const[J,q]=(0,r.useState)([]),j=(0,O.of)(z);(0,r.useEffect)(()=>{b(!0)},[b]),(0,r.useEffect)(()=>{g.TP.licensedAccessControlEnabled()&&g.TP.hasPermission(T.AccessControlAction.ActionRolesList)&&(0,K.RL)().then(i=>q(i))},[]);const N=g.TP.hasPermission(T.AccessControlAction.ActionTeamsCreate),V=A(),ee=(0,r.useMemo)(()=>[{id:"avatarUrl",header:"",disableGrow:!0,cell:({cell:{value:i}})=>C?i&&(0,a.jsx)(f.e,{src:i,alt:"User avatar"}):(0,a.jsx)(c.A,{containerClassName:j.blockSkeleton,width:24,height:24,circle:!0})},{id:"name",header:"Name",cell:({cell:{value:i},row:{original:R}})=>C?g.TP.hasPermissionInMetadata(T.AccessControlAction.ActionTeamsRead,R)?(0,a.jsx)(_.Y,{color:"primary",inline:!1,href:`/org/teams/edit/${R.uid}`,title:"Edit team",children:i}):i:(0,a.jsx)(c.A,{width:100}),sortType:"string"},{id:"email",header:"Email",cell:({cell:{value:i}})=>C?i:(0,a.jsx)(c.A,{width:60}),sortType:"string"},{id:"memberCount",header:"Members",disableGrow:!0,cell:({cell:{value:i}})=>C?i:(0,a.jsx)(c.A,{width:40}),sortType:"number"},...V?[{id:"role",header:"Role",cell:({cell:{value:i},row:{original:R}})=>C?g.TP.hasPermissionInMetadata(T.AccessControlAction.ActionTeamsRolesList,R)&&(0,a.jsx)($.Y,{teamId:R.id,roles:R.roles||[],isLoading:Q,roleOptions:J,width:40}):(0,a.jsx)(c.A,{width:320,height:32,containerClassName:j.blockSkeleton})}]:[],{id:"actions",header:"",disableGrow:!0,cell:({row:{original:i}})=>{if(!C)return(0,a.jsxs)(o.B,{direction:"row",justifyContent:"flex-end",alignItems:"center",children:[(0,a.jsx)(c.A,{containerClassName:j.blockSkeleton,width:16,height:16}),(0,a.jsx)(c.A,{containerClassName:j.blockSkeleton,width:22,height:24})]});const R=g.TP.hasPermissionInMetadata(T.AccessControlAction.ActionTeamsRead,i),G=g.TP.hasPermissionInMetadata(T.AccessControlAction.ActionTeamsDelete,i);return(0,a.jsxs)(o.B,{direction:"row",justifyContent:"flex-end",gap:2,children:[R&&(0,a.jsx)(n.z9,{href:`org/teams/edit/${i.uid}`,"aria-label":`Edit team ${i.name}`,icon:"pen",size:"sm",variant:"secondary",tooltip:"Edit team"}),(0,a.jsx)(E.e,{"aria-label":`Delete team ${i.name}`,size:"sm",disabled:!G,onConfirm:()=>Y(i.uid)})]})}}],[V,C,Q,J,Y,j]);return(0,a.jsx)(L.YW,{navId:"teams",actions:I?void 0:(0,a.jsx)(n.z9,{href:N?"org/teams/new":"#",disabled:!N,children:"New Team"}),children:(0,a.jsx)(L.YW.Contents,{children:I?(0,a.jsx)(d.p,{variant:"call-to-action",button:(0,a.jsx)(n.z9,{disabled:!N,href:"org/teams/new",icon:"users-alt",size:"lg",children:(0,a.jsx)(h.x6,{i18nKey:"teams.empty-state.button-title",children:"New team"})}),message:(0,h.t)("teams.empty-state.title","You haven't created any teams yet"),children:(0,a.jsxs)(h.x6,{i18nKey:"teams.empty-state.pro-tip",children:["Assign folder and dashboard permissions to teams instead of users to ease administration."," ",(0,a.jsx)(_.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/administration/team-management",children:"Learn more"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"page-action-bar",children:(0,a.jsx)(P.I,{grow:!0,children:(0,a.jsx)(p.Z,{placeholder:"Search teams",value:U,onChange:H})})}),C&&u.length===0?(0,a.jsx)(d.p,{variant:"not-found",message:(0,h.t)("teams.empty-state.message","No teams found")}):(0,a.jsxs)(o.B,{direction:"column",gap:2,children:[(0,a.jsx)(v.j,{columns:ee,data:C?u:s,getRowId:i=>String(i.id),fetchData:k}),(0,a.jsx)(o.B,{justifyContent:"flex-end",children:(0,a.jsx)(W.d,{hideWhenSinglePage:!0,currentPage:F,numberOfPages:X,onNavigate:w})})]})]})})})};function A(){return g.TP.licensedAccessControlEnabled()&&g.TP.hasPermission(T.AccessControlAction.ActionTeamsRolesList)&&g.TP.hasPermission(T.AccessControlAction.ActionRolesList)}function y(u){return{teams:u.teams.teams,query:u.teams.query,perPage:u.teams.perPage,page:u.teams.page,noTeams:u.teams.noTeams,totalPages:u.teams.totalPages,hasFetched:u.teams.hasFetched,rolesLoading:u.teams.rolesLoading}}const S={loadTeams:t.Bu,deleteTeam:t.To,changePage:t.yd,changeQuery:t.nM,changeSort:t.Vk},B=(0,m.connect)(y,S)(l),z=u=>({blockSkeleton:(0,D.css)({lineHeight:1,display:"flex"})})},33667:(x,M,e)=>{e.d(M,{Bu:()=>n,It:()=>g,To:()=>P,Vk:()=>W,aK:()=>h,eo:()=>d,n7:()=>K,nC:()=>T,nM:()=>p,yd:()=>v});var a=e(2543),D=e.n(a),r=e(17172),c=e(82467),m=e(10096),O=e(80714),f=e(31678),_=e(78319),o=e(34655);function n(t=!1){return async(s,l)=>{const{query:A,page:y,perPage:S,sort:Z}=l().teams;if(!m.TP.hasPermission(f.AccessControlAction.ActionTeamsRead)){s((0,o.Q9)({teams:[],totalCount:0,page:1,perPage:S,noTeams:!0}));return}const B=await(0,r.AI)().get("/api/teams/search",(0,O.F)({query:A,page:y,perpage:S,sort:Z}));let z=!1;if(t&&(z=B.teams.length===0),m.TP.licensedAccessControlEnabled()&&m.TP.hasPermission(f.AccessControlAction.ActionTeamsRolesList)){s((0,o.dJ)());const u=B?.teams.map(I=>I.id),U=await(0,r.AI)().post("/api/access-control/teams/roles/search",{teamIds:u});B.teams.forEach(I=>{I.roles=U?U[I.id]||[]:[]}),s((0,o.jE)())}s((0,o.Q9)({noTeams:z,...B}))}}const E=(0,a.debounce)(t=>t(n()),500);function d(t){return async s=>{const l=await(0,r.AI)().get(`/api/teams/${t}`,(0,O.F)());s((0,o.$T)(l)),s((0,c.Vz)((0,_.R)(l)))}}function P(t){return async s=>{await(0,r.AI)().delete(`/api/teams/${t}`),await m.TP.fetchUserPermissions(),s(n())}}function p(t){return async s=>{s((0,o.L5)(t)),E(s)}}function v(t){return async s=>{s((0,o.EC)(t)),s(n())}}function W({sortBy:t}){const s=t.length?`${t[0].id}-${t[0].desc?"desc":"asc"}`:void 0;return async l=>{l((0,o.$u)(s)),l(n())}}function L(){return async(t,s)=>{const l=s().team.team,A=await getBackendSrv().get(`/api/teams/${l.uid}/members`);t(teamMembersLoaded(A))}}function K(t,s){return async(l,A)=>{const y=A().team.team;await(0,r.AI)().put(`/api/teams/${y.uid}`,{name:t,email:s}),l(d(y.uid))}}function h(){return async(t,s)=>{const l=s().team.team,A=await(0,r.AI)().get(`/api/teams/${l.id}/groups`);t((0,o.tC)(A))}}function g(t){return async(s,l)=>{const A=l().team.team;await(0,r.AI)().post(`/api/teams/${A.id}/groups`,{groupId:t}),s(h())}}function T(t){return async(s,l)=>{const A=l().team.team;await(0,r.AI)().delete(`/api/teams/${A.id}/groups?groupId=${encodeURIComponent(t)}`),s(h())}}function $(t){return async s=>{await getBackendSrv().put(`/api/teams/${t.teamId}/members/${t.userId}`,{permission:t.permission}),s(L())}}},78319:(x,M,e)=>{e.d(M,{R:()=>_,X:()=>o});var a=e(33378),D=e(76323),r=e(2913),c=e(16233),m=e(35538),O=e(31678);const f={avatarUrl:"public/img/user_profile.png",id:1,uid:"",name:"Loading",email:"loading",memberCount:0,permission:O.TeamPermissionLevel.Member,accessControl:{isEditor:!1},orgId:0,updated:""};function _(n){const E={img:n.avatarUrl,id:"team-"+n.uid,subTitle:"Manage members and settings",url:`org/teams/edit/${n.uid}`,text:n.name,children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${n.uid}`,text:"Settings",url:`org/teams/edit/${n.uid}/settings`}]};(n===f||c.TP.hasPermissionInMetadata(O.AccessControlAction.ActionTeamsPermissionsRead,n))&&E.children.unshift({active:!1,icon:"users-alt",id:`team-members-${n.uid}`,text:"Members",url:`org/teams/edit/${n.uid}/members`});const d={active:!1,icon:"sync",id:`team-groupsync-${n.uid}`,text:"External group sync",url:`org/teams/edit/${n.uid}/groupsync`},P=n===f;return(0,m.z5)()&&(d.tabSuffix=()=>(0,D.J)({experimentId:P?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,a.a)("teamsync")?(P||c.TP.hasPermissionInMetadata(O.AccessControlAction.ActionTeamsPermissionsRead,n))&&E.children.push(d):r.Ay.featureToggles.featureHighlights&&E.children.push({...d,tabSuffix:()=>(0,D.J)({experimentId:P?"":"feature-highlights-team-sync-badge"})}),E}function o(n){const E=_(f);let d;for(const P of E.children)if(P.id.indexOf(n)>0){P.active=!0,d=P;break}return{main:E,node:d}}}}]);

//# sourceMappingURL=TeamList.35e28d5fbcf00f4a529e.js.map