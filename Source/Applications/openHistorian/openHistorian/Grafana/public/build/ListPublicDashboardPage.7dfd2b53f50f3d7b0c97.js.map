{"version":3,"file":"ListPublicDashboardPage.7dfd2b53f50f3d7b0c97.js","mappings":"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","sources":["webpack://grafana/./public/app/features/manage-dashboards/components/PublicDashboardListTable/DeletePublicDashboardButton.tsx","webpack://grafana/./public/app/features/manage-dashboards/components/PublicDashboardListTable/PublicDashboardListTable.tsx","webpack://grafana/./public/app/features/manage-dashboards/PublicDashboardListPage.tsx"],"sourcesContent":["import * as React from 'react';\n\nimport { config } from '@grafana/runtime';\nimport { Button, ModalsController, ButtonProps } from '@grafana/ui/src';\nimport { t } from 'app/core/internationalization';\nimport { useDeletePublicDashboardMutation } from 'app/features/dashboard/api/publicDashboardApi';\nimport { DashboardModel } from 'app/features/dashboard/state/DashboardModel';\n\nimport { DeletePublicDashboardModal } from './DeletePublicDashboardModal';\n\nexport interface PublicDashboardDeletion {\n  uid: string;\n  dashboardUid: string;\n  title: string;\n}\n\nexport const DeletePublicDashboardButton = ({\n  dashboard,\n  publicDashboard,\n  loader,\n  children,\n  onDismiss,\n  ...rest\n}: {\n  dashboard?: DashboardModel;\n  publicDashboard: PublicDashboardDeletion;\n  loader?: JSX.Element;\n  children?: React.ReactNode;\n  onDismiss?: () => void;\n} & ButtonProps) => {\n  const [deletePublicDashboard, { isLoading }] = useDeletePublicDashboardMutation();\n\n  const onDeletePublicDashboardClick = (pd: PublicDashboardDeletion, onDelete: () => void) => {\n    deletePublicDashboard({\n      dashboard,\n      uid: pd.uid,\n      dashboardUid: pd.dashboardUid,\n    });\n    onDelete();\n  };\n\n  return (\n    <ModalsController>\n      {({ showModal, hideModal }) => {\n        const translatedRevocationButtonText = config.featureToggles.newDashboardSharingComponent\n          ? t('shared-dashboard-list.button.revoke-button-text', 'Revoke access')\n          : t('public-dashboard-list.button.revoke-button-text', 'Revoke public URL');\n        return (\n          <Button\n            aria-label={translatedRevocationButtonText}\n            title={translatedRevocationButtonText}\n            onClick={() =>\n              showModal(DeletePublicDashboardModal, {\n                onConfirm: () => onDeletePublicDashboardClick(publicDashboard, hideModal),\n                onDismiss: () => {\n                  onDismiss ? onDismiss() : hideModal();\n                },\n              })\n            }\n            {...rest}\n          >\n            {isLoading && loader ? loader : children}\n          </Button>\n        );\n      }}\n    </ModalsController>\n  );\n};\n","import { css } from '@emotion/css';\nimport { useMemo, useState } from 'react';\nimport { useMedia } from 'react-use';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { selectors as e2eSelectors } from '@grafana/e2e-selectors/src';\nimport { config, reportInteraction } from '@grafana/runtime';\nimport {\n  Card,\n  EmptyState,\n  HorizontalGroup,\n  LinkButton,\n  Pagination,\n  Spinner,\n  Switch,\n  TextLink,\n  useStyles2,\n  useTheme2,\n} from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { t, Trans } from 'app/core/internationalization';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport {\n  useListPublicDashboardsQuery,\n  useUpdatePublicDashboardMutation,\n} from 'app/features/dashboard/api/publicDashboardApi';\nimport {\n  generatePublicDashboardConfigUrl,\n  generatePublicDashboardUrl,\n} from 'app/features/dashboard/components/ShareModal/SharePublicDashboard/SharePublicDashboardUtils';\nimport { AccessControlAction } from 'app/types';\n\nimport { PublicDashboardListResponse } from '../../types';\n\nimport { DeletePublicDashboardButton } from './DeletePublicDashboardButton';\n\nconst PublicDashboardCard = ({ pd }: { pd: PublicDashboardListResponse }) => {\n  const styles = useStyles2(getStyles);\n  const theme = useTheme2();\n  const isMobile = useMedia(`(max-width: ${theme.breakpoints.values.sm}px)`);\n\n  const [update, { isLoading: isUpdateLoading }] = useUpdatePublicDashboardMutation();\n\n  const selectors = e2eSelectors.pages.PublicDashboards;\n  const hasWritePermissions = contextSrv.hasPermission(AccessControlAction.DashboardsPublicWrite);\n\n  const onTogglePause = (pd: PublicDashboardListResponse, isPaused: boolean) => {\n    const req = {\n      dashboard: { uid: pd.dashboardUid },\n      payload: {\n        uid: pd.uid,\n        isEnabled: !isPaused,\n      },\n    };\n\n    update(req);\n  };\n\n  const CardActions = useMemo(() => (isMobile ? Card.Actions : Card.SecondaryActions), [isMobile]);\n\n  const isNewSharingComponentEnabled = config.featureToggles.newDashboardSharingComponent;\n  const translatedPauseSharingText = isNewSharingComponentEnabled\n    ? t('shared-dashboard-list.toggle.pause-sharing-toggle-text', 'Pause access')\n    : t('public-dashboard-list.toggle.pause-sharing-toggle-text', 'Pause sharing');\n\n  return (\n    <Card className={styles.card} href={`/d/${pd.dashboardUid}`}>\n      <Card.Heading className={styles.heading}>\n        <span>{pd.title}</span>\n      </Card.Heading>\n      <CardActions className={styles.actions}>\n        <div className={styles.pauseSwitch}>\n          <Switch\n            value={!pd.isEnabled}\n            label={translatedPauseSharingText}\n            disabled={isUpdateLoading}\n            onChange={(e) => {\n              reportInteraction('grafana_dashboards_public_enable_clicked', {\n                action: e.currentTarget.checked ? 'disable' : 'enable',\n              });\n              onTogglePause(pd, e.currentTarget.checked);\n            }}\n            data-testid={selectors.ListItem.pauseSwitch}\n          />\n          <span>{translatedPauseSharingText}</span>\n        </div>\n        <LinkButton\n          fill=\"text\"\n          icon=\"external-link-alt\"\n          variant=\"secondary\"\n          target=\"_blank\"\n          color={theme.colors.warning.text}\n          href={generatePublicDashboardUrl(pd.accessToken)}\n          key=\"public-dashboard-url\"\n          tooltip={\n            isNewSharingComponentEnabled\n              ? t('shared-dashboard-list.button.view-button-tooltip', 'View shared dashboard')\n              : t('public-dashboard-list.button.view-button-tooltip', 'View public dashboard')\n          }\n          data-testid={selectors.ListItem.linkButton}\n        />\n        <LinkButton\n          fill=\"text\"\n          icon=\"cog\"\n          variant=\"secondary\"\n          color={theme.colors.warning.text}\n          href={generatePublicDashboardConfigUrl(pd.dashboardUid, pd.slug)}\n          key=\"public-dashboard-config-url\"\n          tooltip={\n            isNewSharingComponentEnabled\n              ? t('shared-dashboard-list.button.config-button-tooltip', 'Configure shared dashboard')\n              : t('public-dashboard-list.button.config-button-tooltip', 'Configure public dashboard')\n          }\n          data-testid={selectors.ListItem.configButton}\n        />\n        {hasWritePermissions && (\n          <DeletePublicDashboardButton\n            fill=\"text\"\n            icon=\"trash-alt\"\n            variant=\"secondary\"\n            publicDashboard={pd}\n            tooltip={\n              isNewSharingComponentEnabled\n                ? t('shared-dashboard-list.button.revoke-button-tooltip', 'Revoke access')\n                : t('public-dashboard-list.button.revoke-button-tooltip', 'Revoke public dashboard URL')\n            }\n            loader={<Spinner />}\n            data-testid={selectors.ListItem.trashcanButton}\n          />\n        )}\n      </CardActions>\n    </Card>\n  );\n};\n\nexport const PublicDashboardListTable = () => {\n  const [page, setPage] = useState(1);\n\n  const styles = useStyles2(getStyles);\n  const { data: paginatedPublicDashboards, isLoading, isError } = useListPublicDashboardsQuery(page);\n\n  return (\n    <Page navId=\"dashboards/public\">\n      <Page.Contents isLoading={isLoading}>\n        {!isLoading && !isError && !!paginatedPublicDashboards && (\n          <div>\n            {paginatedPublicDashboards.publicDashboards.length === 0 ? (\n              config.featureToggles.newDashboardSharingComponent ? (\n                <EmptyState\n                  variant=\"call-to-action\"\n                  message={t(\n                    'shared-dashboard-list.empty-state.message',\n                    \"You haven't created any shared dashboards yet\"\n                  )}\n                >\n                  <Trans i18nKey=\"shared-dashboard-list.empty-state.more-info\">\n                    Create a shared dashboard from any existing dashboard through the <b>Share</b> modal.{' '}\n                    <TextLink\n                      external\n                      href=\"https://grafana.com/docs/grafana/latest/dashboards/share-dashboards-panels/shared-dashboards\"\n                    >\n                      Learn more\n                    </TextLink>\n                  </Trans>\n                </EmptyState>\n              ) : (\n                <EmptyState\n                  variant=\"call-to-action\"\n                  message={t(\n                    'public-dashboard-list.empty-state.message',\n                    \"You haven't created any public dashboards yet\"\n                  )}\n                >\n                  <Trans i18nKey=\"public-dashboard-list.empty-state.more-info\">\n                    Create a public dashboard from any existing dashboard through the <b>Share</b> modal.{' '}\n                    <TextLink\n                      external\n                      href=\"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/#make-a-dashboard-public\"\n                    >\n                      Learn more\n                    </TextLink>\n                  </Trans>\n                </EmptyState>\n              )\n            ) : (\n              <>\n                <ul className={styles.list}>\n                  {paginatedPublicDashboards.publicDashboards.map((pd: PublicDashboardListResponse) => (\n                    <li key={pd.uid}>\n                      <PublicDashboardCard pd={pd} />\n                    </li>\n                  ))}\n                </ul>\n                <HorizontalGroup justify=\"flex-end\">\n                  <Pagination\n                    onNavigate={setPage}\n                    currentPage={paginatedPublicDashboards.page}\n                    numberOfPages={paginatedPublicDashboards.totalPages}\n                    hideWhenSinglePage\n                  />\n                </HorizontalGroup>\n              </>\n            )}\n          </div>\n        )}\n      </Page.Contents>\n    </Page>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  list: css`\n    list-style-type: none;\n    margin-bottom: ${theme.spacing(2)};\n  `,\n  card: css`\n    ${theme.breakpoints.up('sm')} {\n      display: flex;\n    }\n  `,\n  heading: css`\n    display: flex;\n    align-items: center;\n    gap: ${theme.spacing(1)};\n    flex: 1;\n  `,\n  orphanedTitle: css`\n    display: flex;\n    align-items: center;\n    gap: ${theme.spacing(1)};\n  `,\n  actions: css`\n    display: flex;\n    align-items: center;\n    position: relative;\n\n    gap: ${theme.spacing(0.5)};\n    ${theme.breakpoints.up('sm')} {\n      gap: ${theme.spacing(1)};\n    }\n  `,\n  pauseSwitch: css`\n    display: flex;\n    gap: ${theme.spacing(1)};\n    align-items: center;\n    font-size: ${theme.typography.bodySmall.fontSize};\n    margin-bottom: 0;\n    flex: 1;\n\n    ${theme.breakpoints.up('sm')} {\n      padding-right: ${theme.spacing(2)};\n    }\n  `,\n});\n","import { PublicDashboardListTable } from './components/PublicDashboardListTable/PublicDashboardListTable';\n\nexport const ListPublicDashboardPage = ({}) => {\n  return <PublicDashboardListTable />;\n};\n\nexport default ListPublicDashboardPage;\n"],"names":["DeletePublicDashboardButton","dashboard","publicDashboard","loader","children","onDismiss","rest","deletePublicDashboard","isLoading","onDeletePublicDashboardClick","pd","onDelete","showModal","hideModal","translatedRevocationButtonText","config","Button","DeletePublicDashboardModal","PublicDashboardCard","styles","getStyles","theme","isMobile","useMedia","update","isUpdateLoading","selectors","hasWritePermissions","onTogglePause","isPaused","req","CardActions","Card","isNewSharingComponentEnabled","translatedPauseSharingText","Switch","e","Spinner","PublicDashboardListTable","page","setPage","paginatedPublicDashboards","isError","Page","EmptyState","TextLink","Pagination","ListPublicDashboardPage"],"sourceRoot":""}