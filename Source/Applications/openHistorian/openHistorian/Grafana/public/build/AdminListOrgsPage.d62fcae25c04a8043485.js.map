{"version":3,"file":"AdminListOrgsPage.d62fcae25c04a8043485.js","mappings":"wOAWO,SAASA,EAAe,CAAE,KAAAC,EAAM,SAAAC,CAAS,EAAU,CACxD,MAAMC,EAAgB,mBAAyB,gCAA8B,EAEvE,CAACC,EAAWC,CAAY,KAAI,YAAuB,EACzD,OACE,gBAAC,SAAM,UAAU,gDACf,gBAAC,aACC,gBAAC,UACC,gBAAC,UAAG,IAAE,EACN,gBAAC,UAAG,MAAI,EACR,gBAAC,MAAG,MAAO,CAAE,MAAO,IAAK,EAAG,CAC9B,CACF,EACA,gBAAC,aACEJ,EAAK,IAAKK,GACT,gBAAC,MAAG,IAAK,GAAGA,EAAI,MAAMA,EAAI,QACxB,gBAAC,MAAG,UAAU,WACZ,gBAAC,KAAE,KAAM,mBAAmBA,EAAI,MAAOA,EAAI,EAAG,CAChD,EACA,gBAAC,MAAG,UAAU,WACZ,gBAAC,KAAE,KAAM,mBAAmBA,EAAI,MAAOA,EAAI,IAAK,CAClD,EACA,gBAAC,MAAG,UAAU,cACZ,gBAACC,EAAA,IACC,QAAQ,cACR,KAAK,KACL,KAAK,QACL,QAAS,IAAMF,EAAaC,CAAG,EAC/B,aAAW,aACX,SAAU,CAACH,CAAA,CACb,CACF,CACF,CACD,CACH,EACCC,GACC,gBAACI,EAAA,GACC,OAAM,GACN,KAAK,YACL,MAAM,SACN,KACE,gBAAC,WAAI,oCACoCJ,EAAU,KAAK,KACtD,gBAAC,SAAG,EAAE,IAAC,gBAAC,aAAM,uDAAqD,CACrE,EAEF,YAAY,SACZ,UAAW,IAAMC,EAAa,MAAS,EACvC,UAAW,IAAM,CACfH,EAASE,EAAU,EAAE,EACrBC,EAAa,MAAS,CACxB,EACF,CAEJ,CAEJ,CCxDA,MAAMD,EAAY,MAAOK,GAChB,QAAM,KAAc,EAAE,OAAO,aAAeA,CAAK,EAGpDC,EAAU,SACP,QAAM,KAAc,EAAE,IAAI,WAAW,EAGxCC,EAAmBC,MAChB,MAAaA,CAAK,EAAIA,GAAO,MAAM,QAAU,gCAGvC,SAASC,GAAqB,CAC3C,KAAM,CAACC,EAAOC,CAAS,KAAIC,EAAA,SAAW,SAAY,MAAMN,EAAQ,EAAG,CAAC,CAAC,EAC/DO,EAAe,mBAAyB,gCAA8B,EAE5E,sBAAU,IAAM,CACdF,EAAU,CACZ,EAAG,CAACA,CAAS,CAAC,EAGZ,gBAACG,EAAA,EAAI,CAAC,MAAM,eACV,gBAACA,EAAA,gBACC,gCACE,gBAAC,OAAI,UAAU,mBACb,gBAAC,OAAI,UAAU,yBAA0B,GACzC,gBAAC,KAAU,CAAC,KAAK,OAAO,KAAK,UAAU,SAAU,CAACD,CAAA,EAAc,SAEhE,CACF,EACCH,EAAM,OAASH,EAAgBG,EAAM,KAAK,EAC1CA,EAAM,SAAW,yBACjBA,EAAM,OACL,gBAACd,EAAA,CACC,KAAMc,EAAM,MACZ,SAAWL,GAAU,CACnBL,EAAUK,CAAK,EAAE,KAAK,IAAMM,EAAU,CAAC,CACzC,EACF,CAEJ,CACF,CACF,CAEJ,C","sources":["webpack://grafana/./public/app/features/admin/AdminOrgsTable.tsx","webpack://grafana/./public/app/features/admin/AdminListOrgsPage.tsx"],"sourcesContent":["import React, { useState } from 'react';\n\nimport { Button, ConfirmModal } from '@grafana/ui';\nimport { contextSrv } from 'app/core/core';\nimport { AccessControlAction, Organization } from 'app/types';\n\ninterface Props {\n  orgs: Organization[];\n  onDelete: (orgId: number) => void;\n}\n\nexport function AdminOrgsTable({ orgs, onDelete }: Props) {\n  const canDeleteOrgs = contextSrv.hasPermission(AccessControlAction.OrgsDelete);\n\n  const [deleteOrg, setDeleteOrg] = useState<Organization>();\n  return (\n    <table className=\"filter-table form-inline filter-table--hover\">\n      <thead>\n        <tr>\n          <th>ID</th>\n          <th>Name</th>\n          <th style={{ width: '1%' }}></th>\n        </tr>\n      </thead>\n      <tbody>\n        {orgs.map((org) => (\n          <tr key={`${org.id}-${org.name}`}>\n            <td className=\"link-td\">\n              <a href={`admin/orgs/edit/${org.id}`}>{org.id}</a>\n            </td>\n            <td className=\"link-td\">\n              <a href={`admin/orgs/edit/${org.id}`}>{org.name}</a>\n            </td>\n            <td className=\"text-right\">\n              <Button\n                variant=\"destructive\"\n                size=\"sm\"\n                icon=\"times\"\n                onClick={() => setDeleteOrg(org)}\n                aria-label=\"Delete org\"\n                disabled={!canDeleteOrgs}\n              />\n            </td>\n          </tr>\n        ))}\n      </tbody>\n      {deleteOrg && (\n        <ConfirmModal\n          isOpen\n          icon=\"trash-alt\"\n          title=\"Delete\"\n          body={\n            <div>\n              Are you sure you want to delete &apos;{deleteOrg.name}&apos;?\n              <br /> <small>All dashboards for this organization will be removed!</small>\n            </div>\n          }\n          confirmText=\"Delete\"\n          onDismiss={() => setDeleteOrg(undefined)}\n          onConfirm={() => {\n            onDelete(deleteOrg.id);\n            setDeleteOrg(undefined);\n          }}\n        />\n      )}\n    </table>\n  );\n}\n","import React, { useEffect } from 'react';\nimport useAsyncFn from 'react-use/lib/useAsyncFn';\n\nimport { getBackendSrv, isFetchError } from '@grafana/runtime';\nimport { LinkButton } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { AccessControlAction } from 'app/types';\n\nimport { AdminOrgsTable } from './AdminOrgsTable';\n\nconst deleteOrg = async (orgId: number) => {\n  return await getBackendSrv().delete('/api/orgs/' + orgId);\n};\n\nconst getOrgs = async () => {\n  return await getBackendSrv().get('/api/orgs');\n};\n\nconst getErrorMessage = (error: Error) => {\n  return isFetchError(error) ? error?.data?.message : 'An unexpected error happened.';\n};\n\nexport default function AdminListOrgsPages() {\n  const [state, fetchOrgs] = useAsyncFn(async () => await getOrgs(), []);\n  const canCreateOrg = contextSrv.hasPermission(AccessControlAction.OrgsCreate);\n\n  useEffect(() => {\n    fetchOrgs();\n  }, [fetchOrgs]);\n\n  return (\n    <Page navId=\"global-orgs\">\n      <Page.Contents>\n        <>\n          <div className=\"page-action-bar\">\n            <div className=\"page-action-bar__spacer\" />\n            <LinkButton icon=\"plus\" href=\"org/new\" disabled={!canCreateOrg}>\n              New org\n            </LinkButton>\n          </div>\n          {state.error && getErrorMessage(state.error)}\n          {state.loading && 'Fetching organizations'}\n          {state.value && (\n            <AdminOrgsTable\n              orgs={state.value}\n              onDelete={(orgId) => {\n                deleteOrg(orgId).then(() => fetchOrgs());\n              }}\n            />\n          )}\n        </>\n      </Page.Contents>\n    </Page>\n  );\n}\n"],"names":["AdminOrgsTable","orgs","onDelete","canDeleteOrgs","deleteOrg","setDeleteOrg","org","Button","ConfirmModal","orgId","getOrgs","getErrorMessage","error","AdminListOrgsPages","state","fetchOrgs","useAsyncFn","canCreateOrg","Page"],"sourceRoot":""}