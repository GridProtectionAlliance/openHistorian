"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[295],{20469:(t,e,n)=>{n.d(e,{ZP:()=>s,hF:()=>a,rb:()=>i});var o=n(93964),r=n.n(o);const a=r().module("grafana.core",["ngRoute"]),i=[a,r().module("grafana.controllers",[]),r().module("grafana.directives",[]),r().module("grafana.factories",[]),r().module("grafana.services",[]),r().module("grafana.filters",[]),r().module("grafana.routes",[])],s=a},69435:(t,e,n)=>{n.d(e,{GO:()=>s,rR:()=>i});var o=n(20469),r=n(78837);class a{constructor(){var t,e,n;n=void 0,(e="navItems")in(t=this)?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,this.navItems=r.ZP.bootData.navTree}getCfgNode(){return this.navItems.find((t=>"cfg"===t.id))}getNav(){var t;let e=this.navItems;const n={breadcrumbs:[]};for(var o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];for(const t of r){if("number"==typeof t){n.main=n.breadcrumbs[t];break}const o=e.find((e=>e.id===t));var i;if(o)n.breadcrumbs.push(o),n.node=o,n.main=o,e=null!==(i=o.children)&&void 0!==i?i:[]}if(null!==(t=n.main)&&void 0!==t&&t.children)for(const t of n.main.children){var s;t.active=t.url===(null===(s=n.node)||void 0===s?void 0:s.url)}return n}getNotFoundNav(){return i()}}function i(){return s("Page not found","404 Error")}function s(t,e){const n={text:t,subTitle:e,icon:"exclamation-triangle"};return{node:n,main:n}}a.$inject=[],o.ZP.service("navModelSrv",a)},25309:(t,e,n)=>{n.r(e),n.d(e,{default:()=>x,getAppPluginPageError:()=>C});var o,r,a,i,s=n(68404),l=n(87524),u=(o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},o(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p="html",d="svg",c=function(t,e){var n,o,r,a={};if(t===p)r=document.createElement("div");else{if(t!==d)throw new Error('Invalid element type "'+t+'" for createPortalNode: must be "html" or "svg".');r=document.createElementNS("http://www.w3.org/2000/svg","g")}if(e&&"object"==typeof e)for(var i=0,s=Object.entries(e.attributes);i<s.length;i++){var l=s[i],u=l[0],c=l[1];r.setAttribute(u,c)}var h={element:r,elementType:t,setPortalProps:function(t){a=t},getInitialPortalProps:function(){return a},mount:function(e,r){if(r!==o){if(h.unmount(),e!==n&&!function(t,e){if(e===p)return t instanceof HTMLElement;if(e===d)return t instanceof SVGElement;throw new Error('Unrecognized element type "'+e+'" for validateElementType.')}(e,t))throw new Error('Invalid element type for portal: "'+t+'" portalNodes must be used with '+t+" elements, but OutPortal is within <"+e.tagName+">.");e.replaceChild(h.element,r),n=e,o=r}},unmount:function(t){t&&t!==o||n&&o&&(n.replaceChild(o,h.element),n=void 0,o=void 0)}};return h},h=function(t){function e(e){var n=t.call(this,e)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(t){n.setState({nodeProps:t})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return u(e,t),e.prototype.componentDidMount=function(){this.addPropsChannel()},e.prototype.componentDidUpdate=function(){this.addPropsChannel()},e.prototype.render=function(){var t=this,e=this.props,n=e.children,o=e.node;return l.createPortal(s.Children.map(n,(function(e){return s.isValidElement(e)?s.cloneElement(e,t.state.nodeProps):e})),o.element)},e}(s.PureComponent),m=function(t){function e(e){var n=t.call(this,e)||this;return n.placeholderNode=s.createRef(),n.passPropsThroughPortal(),n}return u(e,t),e.prototype.passPropsThroughPortal=function(){var t=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(t)},e.prototype.componentDidMount=function(){var t=this.props.node;this.currentPortalNode=t;var e=this.placeholderNode.current,n=e.parentNode;t.mount(n,e),this.passPropsThroughPortal()},e.prototype.componentDidUpdate=function(){var t=this.props.node;this.currentPortalNode&&t!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode.setPortalProps({}),this.currentPortalNode=t);var e=this.placeholderNode.current,n=e.parentNode;t.mount(n,e),this.passPropsThroughPortal()},e.prototype.componentWillUnmount=function(){var t=this.props.node;t.unmount(this.placeholderNode.current),t.setPortalProps({})},e.prototype.render=function(){return s.createElement("div",{ref:this.placeholderNode})},e}(s.PureComponent),f=c.bind(null,p),v=(c.bind(null,d),n(43215)),g=n(69435),P=n(69371),b=n(22584),y=n(98163),N=n(32569),j=n(33566),w=n(45916);function C(t){return t?t.type!==v.PluginType.app?"Plugin must be an app":t.enabled?null:"Application Not Enabled":"Unknown Plugin"}class E extends s.Component{constructor(t){var e,n,o;super(t),o=t=>{this.setState({nav:t})},(n="onNavChanged")in(e=this)?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,this.state={loading:!0,portalNode:f()}}shouldComponentUpdate(t){return t.location.pathname.startsWith("/a/")}async loadPluginSettings(){const{params:t}=this.props.match;try{const e=await(0,N.a)(t.pluginId).then((t=>{const e=C(t);return e?(y.h$.emit(v.AppEvents.alertError,[e]),this.setState({nav:(0,g.GO)(e)}),null):(0,j.Av)(t)}));this.setState({plugin:e,loading:!1,nav:void 0})}catch(t){this.setState({plugin:null,loading:!1,nav:(0,g.rR)()})}}componentDidMount(){this.loadPluginSettings()}componentDidUpdate(t){const{params:e}=this.props.match;t.match.params.pluginId!==e.pluginId&&(this.setState({loading:!0,plugin:null}),this.loadPluginSettings())}render(){const{loading:t,plugin:e,nav:n,portalNode:o}=this.state;return e&&this.props.match.params.pluginId===e.meta.id?e.root?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(h,{node:o,children:(0,w.jsx)(e.root,{meta:e.meta,basename:this.props.match.url,onNavChanged:this.onNavChanged,query:this.props.queryParams,path:this.props.location.pathname})}),n?(0,w.jsx)(P.T,{navModel:n,children:(0,w.jsx)(P.T.Contents,{isLoading:t,children:(0,w.jsx)(m,{node:o})})}):(0,w.jsxs)(P.T,{children:[(0,w.jsx)(m,{node:o}),t&&(i||(i=(0,w.jsx)(b.Z,{})))]})]}):a||(a=(0,w.jsx)("div",{children:"No Root App"})):r||(r=(0,w.jsx)(P.T,{children:(0,w.jsx)(b.Z,{})}))}}const x=E}}]);
//# sourceMappingURL=AppRootPage.2ee44eb5e92b96c988cb.js.map