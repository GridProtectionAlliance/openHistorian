{"version":3,"file":"DashboardListPage.0099be6c25a1c7f4ed52.js","mappings":"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","sources":["webpack://grafana/./public/app/features/search/components/DashboardActions.tsx","webpack://grafana/./public/app/features/search/components/ManageDashboardsNew.tsx","webpack://grafana/./public/app/features/search/components/DashboardListPage.tsx","webpack://grafana/./public/app/features/search/loaders.ts"],"sourcesContent":["import React, { FC } from 'react';\n\nimport { Menu, Dropdown, Button, Icon } from '@grafana/ui';\n\nexport interface Props {\n  folderId?: number;\n  canCreateFolders?: boolean;\n  canCreateDashboards?: boolean;\n}\n\nexport const DashboardActions: FC<Props> = ({ folderId, canCreateFolders = false, canCreateDashboards = false }) => {\n  const actionUrl = (type: string) => {\n    let url = `dashboard/${type}`;\n\n    if (folderId) {\n      url += `?folderId=${folderId}`;\n    }\n\n    return url;\n  };\n\n  const MenuActions = () => {\n    return (\n      <Menu>\n        {canCreateDashboards && <Menu.Item url={actionUrl('new')} label=\"New Dashboard\" />}\n        {!folderId && canCreateFolders && <Menu.Item url=\"dashboards/folder/new\" label=\"New Folder\" />}\n        {canCreateDashboards && <Menu.Item url={actionUrl('import')} label=\"Import\" />}\n      </Menu>\n    );\n  };\n\n  return (\n    <div>\n      <Dropdown overlay={MenuActions} placement=\"bottom-start\">\n        <Button variant=\"primary\">\n          New\n          <Icon name=\"angle-down\" />\n        </Button>\n      </Dropdown>\n    </div>\n  );\n};\n","import { css, cx } from '@emotion/css';\nimport React, { useState } from 'react';\nimport { useDebounce, useLocalStorage } from 'react-use';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Input, useStyles2, Spinner } from '@grafana/ui';\nimport { contextSrv } from 'app/core/services/context_srv';\nimport { FolderDTO, AccessControlAction } from 'app/types';\n\nimport { SEARCH_PANELS_LOCAL_STORAGE_KEY } from '../constants';\nimport { useKeyNavigationListener } from '../hooks/useSearchKeyboardSelection';\nimport { useSearchQuery } from '../hooks/useSearchQuery';\nimport { SearchView } from '../page/components/SearchView';\n\nimport { DashboardActions } from './DashboardActions';\n\nexport interface Props {\n  folder?: FolderDTO;\n}\n\nexport const ManageDashboardsNew = React.memo(({ folder }: Props) => {\n  const styles = useStyles2(getStyles);\n  // since we don't use \"query\" from use search... it is not actually loaded from the URL!\n  const { query, onQueryChange } = useSearchQuery({});\n  const { onKeyDown, keyboardEvents } = useKeyNavigationListener();\n\n  // TODO: we need to refactor DashboardActions to use folder.uid instead\n  const folderId = folder?.id;\n  // const folderUid = folder?.uid;\n  const canSave = folder?.canSave;\n  const hasEditPermissionInFolders = folder ? canSave : contextSrv.hasEditPermissionInFolders;\n\n  let [includePanels, setIncludePanels] = useLocalStorage<boolean>(SEARCH_PANELS_LOCAL_STORAGE_KEY, true);\n  if (!config.featureToggles.panelTitleSearch) {\n    includePanels = false;\n  }\n\n  const { isEditor } = contextSrv;\n\n  const [inputValue, setInputValue] = useState(query.query ?? '');\n  const onSearchQueryChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    e.preventDefault();\n    setInputValue(e.currentTarget.value);\n  };\n  useDebounce(() => onQueryChange(inputValue), 200, [inputValue]);\n\n  return (\n    <>\n      <div className={cx(styles.actionBar, 'page-action-bar')}>\n        <div className={cx(styles.inputWrapper, 'gf-form gf-form--grow m-r-2')}>\n          <Input\n            value={inputValue}\n            onChange={onSearchQueryChange}\n            onKeyDown={onKeyDown}\n            autoFocus\n            spellCheck={false}\n            placeholder={includePanels ? 'Search for dashboards and panels' : 'Search for dashboards'}\n            className={styles.searchInput}\n            suffix={false ? <Spinner /> : null}\n          />\n        </div>\n        <DashboardActions\n          folderId={folderId}\n          canCreateFolders={contextSrv.hasAccess(AccessControlAction.FoldersCreate, isEditor)}\n          canCreateDashboards={contextSrv.hasAccess(\n            AccessControlAction.DashboardsCreate,\n            hasEditPermissionInFolders || !!canSave\n          )}\n        />\n      </div>\n\n      <SearchView\n        showManage={isEditor || hasEditPermissionInFolders || canSave}\n        folderDTO={folder}\n        queryText={query.query}\n        onQueryTextChange={(newQueryText) => {\n          setInputValue(newQueryText);\n        }}\n        hidePseudoFolders={true}\n        includePanels={includePanels!}\n        setIncludePanels={setIncludePanels}\n        keyboardEvents={keyboardEvents}\n      />\n    </>\n  );\n});\n\nManageDashboardsNew.displayName = 'ManageDashboardsNew';\n\nexport default ManageDashboardsNew;\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actionBar: css`\n    ${theme.breakpoints.down('sm')} {\n      flex-wrap: wrap;\n    }\n  `,\n  inputWrapper: css`\n    ${theme.breakpoints.down('sm')} {\n      margin-right: 0 !important;\n    }\n  `,\n  searchInput: css`\n    margin-bottom: 6px;\n    min-height: ${theme.spacing(4)};\n  `,\n  unsupported: css`\n    padding: 10px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    font-size: 18px;\n  `,\n  noResults: css`\n    padding: ${theme.v1.spacing.md};\n    background: ${theme.v1.colors.bg2};\n    font-style: italic;\n    margin-top: ${theme.v1.spacing.md};\n  `,\n});\n","import { css } from '@emotion/css';\nimport React, { FC, memo } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { locationUtil, NavModelItem } from '@grafana/data';\nimport { locationService } from '@grafana/runtime';\nimport { Page } from 'app/core/components/Page/Page';\nimport { FolderDTO } from 'app/types';\n\nimport { GrafanaRouteComponentProps } from '../../../core/navigation/types';\nimport { loadFolderPage } from '../loaders';\n\nimport ManageDashboardsNew from './ManageDashboardsNew';\n\nexport interface DashboardListPageRouteParams {\n  uid?: string;\n  slug?: string;\n}\n\ninterface Props extends GrafanaRouteComponentProps<DashboardListPageRouteParams> {}\n\nexport const DashboardListPage: FC<Props> = memo(({ match, location }) => {\n  const { loading, value } = useAsync<() => Promise<{ folder?: FolderDTO; pageNav?: NavModelItem }>>(() => {\n    const uid = match.params.uid;\n    const url = location.pathname;\n    if (!uid || !url.startsWith('/dashboards')) {\n      return Promise.resolve({});\n    }\n\n    return loadFolderPage(uid!).then(({ folder, folderNav }) => {\n      const path = locationUtil.stripBaseFromUrl(folder.url);\n\n      if (path !== location.pathname) {\n        locationService.replace(path);\n      }\n\n      return { folder, pageNav: folderNav };\n    });\n  }, [match.params.uid]);\n\n  return (\n    <Page navId=\"dashboards/browse\" pageNav={value?.pageNav}>\n      <Page.Contents\n        isLoading={loading}\n        className={css`\n          display: flex;\n          flex-direction: column;\n          overflow: hidden;\n        `}\n      >\n        <ManageDashboardsNew folder={value?.folder} />\n      </Page.Contents>\n    </Page>\n  );\n});\n\nDashboardListPage.displayName = 'DashboardListPage';\n\nexport default DashboardListPage;\n","import { backendSrv } from 'app/core/services/backend_srv';\n\nimport { buildNavModel } from '../folders/state/navModel';\n\nexport const loadFolderPage = (uid: string) => {\n  return backendSrv.getFolderByUid(uid).then((folder) => {\n    const navModel = buildNavModel(folder);\n    navModel.children![0].active = true;\n\n    return { folder, folderNav: navModel };\n  });\n};\n"],"names":["DashboardActions","folderId","canCreateFolders","canCreateDashboards","actionUrl","type","url","Dropdown","overlay","Menu","label","placement","Button","variant","Icon","name","ManageDashboardsNew","React","folder","styles","useStyles2","getStyles","query","onQueryChange","useSearchQuery","onKeyDown","keyboardEvents","useKeyNavigationListener","id","canSave","hasEditPermissionInFolders","contextSrv","includePanels","setIncludePanels","useLocalStorage","SEARCH_PANELS_LOCAL_STORAGE_KEY","config","isEditor","inputValue","setInputValue","useState","useDebounce","className","cx","actionBar","inputWrapper","Input","value","onChange","e","preventDefault","currentTarget","autoFocus","spellCheck","placeholder","searchInput","suffix","AccessControlAction","SearchView","showManage","folderDTO","queryText","onQueryTextChange","newQueryText","hidePseudoFolders","displayName","theme","css","breakpoints","down","spacing","unsupported","noResults","v1","md","colors","bg2","DashboardListPage","memo","match","location","loading","useAsync","uid","params","pathname","startsWith","backendSrv","then","navModel","buildNavModel","children","active","folderNav","loadFolderPage","path","locationUtil","locationService","pageNav","Promise","resolve","Page","navId","isLoading"],"sourceRoot":""}