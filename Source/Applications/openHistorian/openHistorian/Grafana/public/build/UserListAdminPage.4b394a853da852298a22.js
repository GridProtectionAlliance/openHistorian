"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8580],{68082:(j,f,t)=>{t.r(f),t.d(f,{UserListAdminPage:()=>L,UserListAdminPageContent:()=>p,addExtraFilters:()=>W,default:()=>$});var s=t(9892),e=t(68404),N=t(36635),g=t(72648),M=t(14747),U=t(2594),C=t(31403),m=t(6554),i=t(39904),b=t(78889),P=t(79396),y=t(21731),T=t(77582),R=t(2555),I=t(81168),E=t(37592);const A=[],W=a=>{A.push(a)},B={fetchUsers:E.uh,changeQuery:E.R5,changePage:E.oO,changeFilter:E.M6},x=a=>({users:a.userListAdmin.users,query:a.userListAdmin.query,showPaging:a.userListAdmin.showPaging,totalPages:a.userListAdmin.totalPages,page:a.userListAdmin.page,filters:a.userListAdmin.filters,isLoading:a.userListAdmin.isLoading}),p=(0,N.connect)(x,B)(({fetchUsers:a,query:c,changeQuery:l,users:n,showPaging:h,totalPages:F,page:w,changePage:S,changeFilter:v,filters:D,isLoading:J})=>{const d=(0,g.wW)(_);(0,e.useEffect)(()=>{a()},[a]);const O=(0,e.useMemo)(()=>n.some(r=>r.licensedRole),[n]);return e.createElement(P.T.Contents,null,e.createElement("div",{className:"page-action-bar"},e.createElement("div",{className:"gf-form gf-form--grow"},e.createElement(M.H,{placeholder:"Search user by login, email, or name.",autoFocus:!0,value:c,onChange:l}),e.createElement(U.S,{options:[{label:"All users",value:!1},{label:"Active last 30 days",value:!0}],onChange:r=>v({name:"activeLast30Days",value:r}),value:D.find(r=>r.name==="activeLast30Days")?.value,className:d.filter}),A.map((r,Q)=>e.createElement(r,{key:Q,filters:D,onChange:v,className:d.filter}))),T.Vt.hasPermission(I.AccessControlAction.UsersCreate)&&e.createElement(C.Qj,{href:"admin/users/create",variant:"primary"},"New user")),J?e.createElement(R.Z,null):e.createElement(e.Fragment,null,e.createElement("div",{className:(0,s.cx)(d.table,"admin-list-table")},e.createElement("table",{className:"filter-table form-inline filter-table--hover"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null),e.createElement("th",null,"Login"),e.createElement("th",null,"Email"),e.createElement("th",null,"Name"),e.createElement("th",null,"Belongs to"),O&&e.createElement("th",null,"Licensed role"," ",e.createElement(m.u,{placement:"top",content:e.createElement(e.Fragment,null,"Licensed role is based on a user's Org role (i.e. Viewer, Editor, Admin) and their dashboard/folder permissions."," ",e.createElement("a",{className:d.link,target:"_blank",rel:"noreferrer noopener",href:"https://grafana.com/docs/grafana/next/enterprise/license/license-restrictions/#active-users-limit"},"Learn more"))},e.createElement(i.J,{name:"question-circle"}))),e.createElement("th",null,"Last active\xA0",e.createElement(m.u,{placement:"top",content:"Time since user was seen using Grafana"},e.createElement(i.J,{name:"question-circle"}))),e.createElement("th",{style:{width:"1%"}},"Origin"))),e.createElement("tbody",null,n.map(r=>e.createElement(u,{user:r,showLicensedRole:O,key:r.id}))))),h&&e.createElement(b.t,{numberOfPages:F,currentPage:w,onNavigate:S})))});function L(){return e.createElement(P.T,{navId:"global-users"},e.createElement(p,null))}const o=a=>`Edit user's ${a} details`,u=(0,e.memo)(({user:a,showLicensedRole:c})=>{const l=(0,g.wW)(_),n=`admin/users/edit/${a.id}`;return e.createElement("tr",{key:a.id},e.createElement("td",{className:"width-4 text-center link-td"},e.createElement("a",{href:n,"aria-label":`Edit user's ${a.name} details`},e.createElement("img",{className:"filter-table__avatar",src:a.avatarUrl,alt:`Avatar for user ${a.name}`}))),e.createElement("td",{className:"link-td max-width-10"},e.createElement("a",{className:"ellipsis",href:n,title:a.login,"aria-label":o(a.name)},a.login)),e.createElement("td",{className:"link-td max-width-10"},e.createElement("a",{className:"ellipsis",href:n,title:a.email,"aria-label":o(a.name)},a.email)),e.createElement("td",{className:"link-td max-width-10"},e.createElement("a",{className:"ellipsis",href:n,title:a.name,"aria-label":o(a.name)},a.name)),e.createElement("td",{className:l.row,title:a.orgs?.length?`The user is a member of the following organizations: ${a.orgs.map(h=>h.name).join(",")}`:void 0},e.createElement(K,{units:a.orgs,icon:"building"}),a.isAdmin&&e.createElement("a",{href:n,"aria-label":o(a.name)},e.createElement(m.u,{placement:"top",content:"Grafana Admin"},e.createElement(i.J,{name:"shield"})))),c&&e.createElement("td",{className:(0,s.cx)("link-td",l.iconRow)},e.createElement("a",{className:"ellipsis",href:n,title:a.name,"aria-label":o(a.name)},a.licensedRole==="None"?e.createElement("span",{className:l.disabled},"Not assigned"," ",e.createElement(m.u,{placement:"top",content:"A licensed role will be assigned when this user signs in"},e.createElement(i.J,{name:"question-circle"}))):a.licensedRole)),e.createElement("td",{className:"link-td"},a.lastSeenAtAge&&e.createElement("a",{href:n,"aria-label":`Last seen at ${a.lastSeenAtAge}. Follow to edit user's ${a.name} details.`},a.lastSeenAtAge==="10 years"?e.createElement("span",{className:l.disabled},"Never"):a.lastSeenAtAge)),e.createElement("td",{className:"text-right"},Array.isArray(a.authLabels)&&a.authLabels.length>0&&e.createElement(y.e,{label:a.authLabels[0],removeIcon:!1,count:0})),e.createElement("td",{className:"text-right"},a.isDisabled&&e.createElement("span",{className:"label label-tag label-tag--gray"},"Disabled")))});u.displayName="UserListItem";const K=({units:a,icon:c})=>{const l=(0,g.wW)(_);return a?.length?a.length>1?e.createElement(m.u,{placement:"top",content:e.createElement("div",{className:l.unitTooltip},a?.map(n=>e.createElement("a",{href:n.url,className:l.link,title:n.name,key:n.name,"aria-label":`Edit ${n.name}`},n.name)))},e.createElement("div",{className:l.unitItem},e.createElement(i.J,{name:c})," ",e.createElement("span",null,a.length))):e.createElement("a",{href:a[0].url,className:l.unitItem,title:a[0].name,key:a[0].name,"aria-label":`Edit ${a[0].name}`},e.createElement(i.J,{name:c})," ",a[0].name):null},_=a=>({table:s.css`
      margin-top: ${a.spacing(3)};
    `,filter:s.css`
      margin: 0 ${a.spacing(1)};
    `,iconRow:s.css`
      svg {
        margin-left: ${a.spacing(.5)};
      }
    `,row:s.css`
      display: flex;
      align-items: center;
      height: 100% !important;

      a {
        padding: ${a.spacing(.5)} 0 !important;
      }
    `,unitTooltip:s.css`
      display: flex;
      flex-direction: column;
    `,unitItem:s.css`
      cursor: pointer;
      padding: ${a.spacing(.5)} 0;
      margin-right: ${a.spacing(1)};
    `,disabled:s.css`
      color: ${a.colors.text.disabled};
    `,link:s.css`
      color: inherit;
      cursor: pointer;
      text-decoration: underline;
    `}),$=L}}]);

//# sourceMappingURL=UserListAdminPage.4b394a853da852298a22.js.map