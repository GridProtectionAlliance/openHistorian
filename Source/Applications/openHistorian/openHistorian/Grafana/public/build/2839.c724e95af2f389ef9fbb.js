"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2839],{39127:(U,P,t)=>{t.d(P,{A:()=>A});var a=t(74848),B=t(90182),_=t(37198),C=t(98164);const W=({name:g,time_intervals:j})=>({value:g,label:g,description:j.map(o=>(0,C.LF)(o)).join(", AND ")}),A=({alertmanager:g,selectProps:j})=>{const{data:o}=(0,_.my)({alertmanager:g}),I=o?.map(r=>W(r))||[];return(0,a.jsx)(B.KF,{"aria-label":"Mute timings",options:I,placeholder:"Select mute timings...",...j})}},37198:(U,P,t)=>{t.d(P,{XW:()=>n,gB:()=>S,zm:()=>d,Ad:()=>F,my:()=>y,SD:()=>R,br:()=>K});var a=t(96540),B=t(82843),_=t(49962);const C=["TimeInterval"],f=_.H.enhanceEndpoints({addTagTypes:C}).injectEndpoints({endpoints:s=>({listNamespacedTimeInterval:s.query({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals`,params:{pretty:e.pretty,allowWatchBookmarks:e.allowWatchBookmarks,continue:e.continue,fieldSelector:e.fieldSelector,labelSelector:e.labelSelector,limit:e.limit,resourceVersion:e.resourceVersion,resourceVersionMatch:e.resourceVersionMatch,sendInitialEvents:e.sendInitialEvents,timeoutSeconds:e.timeoutSeconds,watch:e.watch}}),providesTags:["TimeInterval"]}),createNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals`,method:"POST",body:e.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:e.pretty,dryRun:e.dryRun,fieldManager:e.fieldManager,fieldValidation:e.fieldValidation}}),invalidatesTags:["TimeInterval"]}),replaceNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals/${e.name}`,method:"PUT",body:e.comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval,params:{pretty:e.pretty,dryRun:e.dryRun,fieldManager:e.fieldManager,fieldValidation:e.fieldValidation}}),invalidatesTags:["TimeInterval"]}),deleteNamespacedTimeInterval:s.mutation({query:e=>({url:`/apis/notifications.alerting.grafana.app/v0alpha1/namespaces/${e.namespace}/timeintervals/${e.name}`,method:"DELETE",body:e.ioK8SApimachineryPkgApisMetaV1DeleteOptions,params:{pretty:e.pretty,dryRun:e.dryRun,gracePeriodSeconds:e.gracePeriodSeconds,orphanDependents:e.orphanDependents,propagationPolicy:e.propagationPolicy}}),invalidatesTags:["TimeInterval"]})}),overrideExisting:!1});var A=t(4724),g=t(57220),j=t(2859),o=t(51703),I=t(6833),r=t(4750),i=t(5591);const{useLazyGetAlertmanagerConfigurationQuery:c,useGetMuteTimingListQuery:p}=B.m,{useLazyListNamespacedTimeIntervalQuery:m,useCreateNamespacedTimeIntervalMutation:v,useReplaceNamespacedTimeIntervalMutation:D,useDeleteNamespacedTimeIntervalMutation:x}=f,b=s=>{const{metadata:e,spec:l}=s;return{...l,id:l.name,metadata:e,provisioned:(0,o.Uo)(s)}},G=(s,e)=>({...s,id:s.name,provisioned:!!(e&&e!==j.rh)}),L=()=>c({selectFromResult:({data:s,...e})=>{if(!s)return{data:s,...e};const{alertmanager_config:l}=s,h=l.muteTimeProvenances??{};return{data:(0,A.IT)(l).map(E=>G(E,h[E.name])),...e}}}),w=()=>m({selectFromResult:({data:s,...e})=>({data:s?.items.map(l=>b(l)),...e})}),F=({alertmanager:s,skip:e})=>{const l=(0,o.dM)(s),[h,O]=w(),[T,E]=L();return(0,a.useEffect)(()=>{if(!e)if(l){const u=(0,o.kb)();h({namespace:u})}else T(s)},[s,T,h,e,l]),l?O:E},n=({alertmanager:s})=>{const e=(0,o.dM)(s),[l]=v(),[h]=(0,r.d)(),O=(0,I.Yb)(({interval:E})=>{const u=(0,o.kb)();return l({namespace:u,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{metadata:{},spec:E}}).unwrap()}),T=(0,I.Yb)(({interval:E})=>{const u=(0,i.X9)({interval:E});return h(u)});return e?O:T},d=({alertmanager:s,name:e})=>{const l=(0,o.dM)(s),[h,O]=m({selectFromResult:({data:u,...M})=>u?u.items.length===0?{...M,data:void 0,isError:!0}:{data:b(u.items[0]),...M}:{data:u,...M}}),[T,E]=c({selectFromResult:({data:u,...M})=>{if(!u)return{data:u,...M};const H=u?.alertmanager_config??{},Y=(0,A.IT)(H).find(({name:$})=>$===e);if(Y){const $=H?.muteTimeProvenances??{};return{data:G(Y,$[Y.name]),...M}}return{...M,data:void 0,isError:!0}}});return(0,a.useEffect)(()=>{if(l){const u=(0,o.kb)();h({namespace:u,fieldSelector:`spec.name=${e}`},!0)}else T(s,!0)},[s,T,h,e,l]),l?O:E},R=({alertmanager:s})=>{const e=(0,o.dM)(s),[l]=D(),[h]=(0,r.d)(),O=(0,I.Yb)(async({interval:E,originalName:u})=>{const M=(0,o.kb)();return l({name:u,namespace:M,comGithubGrafanaGrafanaPkgApisAlertingNotificationsV0Alpha1TimeInterval:{spec:E,metadata:{name:u}}}).unwrap()}),T=(0,I.Yb)(async({interval:E,originalName:u})=>{const M=(0,i.ov)({interval:E,originalName:u});return h(M)});return e?O:T},S=({alertmanager:s})=>{const e=(0,o.dM)(s),[l,h]=(0,r.d)(),[O]=x(),T=(0,I.Yb)(async({name:u})=>{const M=(0,i.$8)({name:u});return l(M)}),E=(0,I.Yb)(async({name:u})=>{const M=(0,o.kb)();await O({name:u,namespace:M,ioK8SApimachineryPkgApisMetaV1DeleteOptions:{}}).unwrap()});return e?E:T},K=({alertmanager:s})=>{const e=(0,o.dM)(s),[l]=L();return e?()=>{}:async(h,O)=>{if(!O)return l(s).unwrap().then(T=>!!(0,A.IT)(T.alertmanager_config)?.find(M=>M.name===h)?`Mute timing already exists with name "${h}"`:void 0)}},y=({alertmanager:s})=>{const e=(0,o.dM)(s),l=s===g.hY&&!e,h=p(void 0,{skip:!l}),O=F({alertmanager:s,skip:l});return l?h:O}},4724:(U,P,t)=>{t.d(P,{Hy:()=>g,IT:()=>j,av:()=>I,oB:()=>o});var a=t(74848),B=t(95093),_=t.n(B),C=t(96540),W=t(67061),f=t(98164);const A=/^((([01][0-9])|(2[0-3])):[0-5][0-9])$|(^24:00$)/,g=r=>r?A.test(r):!0,j=r=>[...r.mute_time_intervals??[],...r.time_intervals??[]],o=(r,i)=>{if(!r&&!i)return!0;if(!r&&i||r&&!i)return!1;const c="HH:mm",p=_()().startOf("day").add(r,c),m=_()().startOf("day").add(i,c);return!!(r&&i&&p.isBefore(m)||r&&i&&m.isAfter(p))};function I(r){const c=r.time_intervals.map((p,m)=>{const{times:v,weekdays:D,days_of_month:x,months:b,years:G,location:L}=p,w=(0,f.Dm)(v,L),F=(0,f.uH)(D),n=(0,f.UL)(x),d=(0,f.$P)(b),R=(0,f.mP)(G);return(0,a.jsx)(C.Fragment,{children:(0,a.jsxs)("div",{children:[`${w} ${F}`,(0,a.jsx)("br",{}),[n,d,R].join(" | "),(0,a.jsx)("br",{})]})},JSON.stringify(p)+m)});return(0,a.jsx)(W.B,{direction:"column",gap:1,children:c})}},33915:(U,P,t)=>{t.d(P,{V:()=>r});var a=t(74848),B=t(96540),_=t(10354),C=t(14578),W=t(35108),f=t(32196),A=t(40845),g=t(41068);function j(){const i=(0,A.of)(I);return(0,a.jsxs)("div",{children:["Prometheus duration format consist of a number followed by a time unit.",(0,a.jsx)("br",{}),"Different units can be combined for more granularity.",(0,a.jsx)("hr",{}),(0,a.jsxs)("div",{className:i.list,children:[(0,a.jsxs)("div",{className:i.header,children:[(0,a.jsx)("div",{children:"Symbol"}),(0,a.jsx)("div",{children:"Time unit"}),(0,a.jsx)("div",{children:"Example"})]}),(0,a.jsx)(o,{unit:g.y.seconds,name:"seconds",example:"20s"}),(0,a.jsx)(o,{unit:g.y.minutes,name:"minutes",example:"10m"}),(0,a.jsx)(o,{unit:g.y.hours,name:"hours",example:"4h"}),(0,a.jsx)(o,{unit:g.y.days,name:"days",example:"3d"}),(0,a.jsx)(o,{unit:g.y.weeks,name:"weeks",example:"2w"}),(0,a.jsxs)("div",{className:i.examples,children:[(0,a.jsx)("div",{children:"Multiple units combined"}),(0,a.jsx)("code",{children:"1m30s, 2h30m20s, 1w2d"})]})]})]})}function o({unit:i,name:c,example:p}){const m=(0,A.of)(I);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:m.unit,children:i}),(0,a.jsx)("div",{children:c}),(0,a.jsx)("code",{children:p})]})}const I=i=>({unit:(0,f.css)({fontWeight:i.typography.fontWeightBold}),list:(0,f.css)({display:"grid",gridTemplateColumns:"max-content 1fr 2fr",gap:i.spacing(1,3)}),header:(0,f.css)({display:"contents",fontWeight:i.typography.fontWeightBold}),examples:(0,f.css)({display:"contents","& > div":{gridColumn:"1 / span 2"}})}),r=(0,B.forwardRef)((i,c)=>(0,a.jsx)(_.p,{suffix:(0,a.jsx)(W.B,{content:(0,a.jsx)(j,{}),disabled:!1,children:(0,a.jsx)(C.I,{name:"info-circle",size:"lg"})}),...i,ref:c}));r.displayName="PromDurationInput"},99903:(U,P,t)=>{t.d(P,{t:()=>B});var a=t(32196);const B=_=>({container:(0,a.css)({alignItems:"center",display:"flex",flexFlow:"row nowrap","& > * + *":{marginLeft:_.spacing(1)}}),input:(0,a.css)({flex:1}),promDurationInput:(0,a.css)({maxWidth:_.spacing(32)}),timingFormContainer:(0,a.css)({padding:_.spacing(1)}),linkText:(0,a.css)({textDecoration:"underline"}),collapse:(0,a.css)({border:"none",background:"none",color:_.colors.text.primary})})},97174:(U,P,t)=>{t.d(P,{G:()=>a});const a={groupWait:{label:"Group wait",description:"The wait time before sending the first notification for a new group of alerts. If empty, it is inherited from the parent policy.",ariaLabel:"Group wait value"},groupInterval:{label:"Group interval",description:"The wait time before sending a notification about changes in the alert group after the first notification has been sent. If empty, it is inherited from the parent policy.",ariaLabel:"Group interval value"},repeatInterval:{label:"Repeat interval",description:"The wait time before resending a notification that has already been sent successfully.",ariaLabel:"Repeat interval value"}}},27835:(U,P,t)=>{t.d(P,{H:()=>a});const a={group_wait:"30s",group_interval:"5m",repeat_interval:"4h"}},79657:(U,P,t)=>{t.d(P,{DY:()=>F,Mk:()=>x,QM:()=>m,Rg:()=>r,SJ:()=>D,YE:()=>v,Yl:()=>c,gY:()=>b,hH:()=>L,ie:()=>G});var a=t(2543),B=t.n(a),_=t(60021),C=t(98164),W=t(57220),f=t(32642),A=t(67332),g=t(25968);const j=(n,d)=>Object.entries(n??{}).reduce((R,[S,K])=>[...R,{name:S,value:K,operator:d?_.ho.regex:_.ho.equal}],[]),o=n=>n.value,I=n=>(n??[]).map(o),r={name:"",value:"",operator:_.ho.equal},i=["grafana_folder","alertname"],c=[{label:"grafana_folder",value:"grafana_folder",isFixed:!0},{label:"alertname",value:"alertname",isFixed:!0},{label:"Disable (...)",value:"..."}],p={id:"",overrideGrouping:!1,groupBy:i,object_matchers:[],routes:[],continue:!1,receiver:"",overrideTimings:!1,groupWaitValue:"",groupIntervalValue:"",repeatIntervalValue:"",muteTimeIntervals:[]};function m(n){return{id:(0,a.uniqueId)("route-"),...n,routes:(n.routes??[]).map(m)}}const v=n=>{if(!n)return p;const d="id"in n?n.id:(0,a.uniqueId)("route-");if(Object.keys(n).length===0)return{...p,id:d};const R=[];n.routes?.forEach(y=>{const s=v(y);R.push(s)});const S=n.object_matchers?.map(y=>({name:y[0],operator:y[1],value:y[2]}))??[],K=n.matchers?.flatMap(y=>(0,f.So)(y).flatMap(C.MU)).map(({name:y,operator:s,value:e})=>({name:(0,f.Ig)(y),operator:s,value:(0,f.Ig)(e)}))??[];return{id:d,object_matchers:[...K,...S,...j(n.match,!1),...j(n.match_re,!0)],continue:n.continue??!1,receiver:n.receiver??"",overrideGrouping:Array.isArray(n.group_by)&&n.group_by.length>0,groupBy:n.group_by??void 0,overrideTimings:[n.group_wait,n.group_interval,n.repeat_interval].some(Boolean),groupWaitValue:n.group_wait??"",groupIntervalValue:n.group_interval??"",repeatIntervalValue:n.repeat_interval??"",routes:R,muteTimeIntervals:n.mute_time_intervals??[]}},D=(n,d,R)=>{const S=(0,A.eM)(d.id??"",R),{overrideGrouping:K,groupBy:y,overrideTimings:s,groupWaitValue:e,groupIntervalValue:l,repeatIntervalValue:h,receiver:O}=d,T=void 0,E=K?y:T,M=s&&e?e:T,J=s&&l?l:T,$=s&&h?h:T,z=d.object_matchers?.filter(V=>V.name&&V.operator&&V.value!==null&&V.value!==void 0).map(({name:V,operator:X,value:Z})=>[V,X,Z]),Q=d.routes?.map(V=>D(n,V,R)),N={...S??{},continue:d.continue,group_by:E,object_matchers:z,match:void 0,match_re:void 0,group_wait:M,group_interval:J,repeat_interval:$,routes:Q,mute_time_intervals:d.muteTimeIntervals,receiver:O};return n!==W.hY?(N.matchers=d.object_matchers?.map(f.b2),N.object_matchers=void 0):(N.object_matchers=(0,f.J$)(N),N.matchers=void 0),d.receiver&&(N.receiver=d.receiver),N},x=n=>({label:n,value:n}),b=n=>(n??[]).map(x),G=n=>n?I(n):[];function L(n){return!n||n.length===0?!0:(0,g.TN)(n)||"Invalid duration format. Must be {number}{time_unit}"}const w=n=>n.map(d=>{const[R,S,K]=d;return`${R}${S}${K}`}),F=(n,d="")=>{if(n.length===0)return!0;const R=L(n),S=L(d);if(R!==!0)return R;if(S!==!0)return S;const K=(0,g.P8)(n),y=(0,g.P8)(d);return y!==0&&K<y?"Repeat interval should be higher or equal to Group interval":!0}},67332:(U,P,t)=>{t.d(P,{AB:()=>f,AS:()=>A,I8:()=>g,dn:()=>o,eM:()=>I});var a=t(1932),B=t(2543),_=t.n(B),C=t(14588),W=t(79657);const f=(r,i,c)=>{if(!I(i.id??"",c))throw new Error(`No such route with ID '${i.id}'`);function m(v){let D=v;if(v.id===i.id){const x=(0,W.SJ)(r,i,c);D={...v,...x}}return{...D,routes:v.routes?.map(m)}}return m(c)},A=(r,i)=>{if(r.id===i.id)throw new Error("You cant remove the root policy");function c(p){return{...p,routes:p.routes?.reduce((m=[],v)=>(v.id===r.id||m.push(c(v)),m),[])}}return c(i)},g=(r,i,c,p,m)=>{const v=(0,W.SJ)(r,i,p);return(0,a.jM)(p,D=>{const[x,b,G]=j(D,c);if(x===void 0||b===void 0||G===void 0)throw new Error(`could not find reference route "${c.id}" in tree`);m==="child"&&(x.routes?x.routes.push(v):x.routes=[v]),m==="above"&&(b.routes=(0,C.insertBeforeImmutably)(b.routes??[],v,G)),m==="below"&&(b.routes=(0,C.insertAfterImmutably)(b.routes??[],v,G))})};function j(r,i){let c,p,m;function v(D,x,b){c||(D.id===i.id&&(c=D,p=b,m=x),D.routes&&D.routes.forEach((G,L)=>v(G,L,D)))}return v(r,0,r),[c,p,m]}function o(r){return(0,B.omit)({...r,routes:r.routes?.map(i=>o(i))},"id")}function I(r,i){return i.id===r?i:i.routes?.find(c=>I(r,c))}}}]);

//# sourceMappingURL=2839.c724e95af2f389ef9fbb.js.map