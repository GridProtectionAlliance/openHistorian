"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[8612],{67833:(e,s,t)=>{t.d(s,{Z:()=>S,v:()=>C});var a,n,r,i,o,d=t(25235),l=t(19309),c=t(36636),m=t(68404),h=t(43215),u=t(16695),g=t(90923),p=t(3490),b=t(57512),f=t(76187),x=t(28659),j=t(45916);function v(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}const y=[{value:"",label:l.ag._({id:"shared-preferences.theme.default-label",message:"Default"})},{value:"dark",label:l.ag._({id:"shared-preferences.theme.dark-label",message:"Dark"})},{value:"light",label:l.ag._({id:"shared-preferences.theme.light-label",message:"Light"})}],T=[{value:"",label:l.ag._({id:"common.locale.default",message:"Default"})},{value:b.cV,label:l.ag._({id:"common.locale.en",message:"English"})},{value:b.Hc,label:l.ag._({id:"common.locale.es",message:"Spanish"})},{value:b.jW,label:l.ag._({id:"common.locale.fr",message:"French"})}],w=Boolean(g.config.featureToggles.internationalization),I={title:"Default",tags:[],type:"",uid:void 0,uri:"",url:"",folderId:0,folderTitle:"",folderUid:"",folderUrl:"",isStarred:!1,slug:"",items:[]};class C extends m.PureComponent{constructor(e){super(e),v(this,"service",void 0),v(this,"onSubmitForm",(async()=>{const{homeDashboardUID:e,theme:s,timezone:t,weekStart:a,locale:n,queryHistory:r}=this.state;await this.service.update({homeDashboardUID:e,theme:s,timezone:t,weekStart:a,locale:n,queryHistory:r}),window.location.reload()})),v(this,"onThemeChanged",(e=>{this.setState({theme:e})})),v(this,"onTimeZoneChanged",(e=>{e&&this.setState({timezone:e})})),v(this,"onWeekStartChanged",(e=>{this.setState({weekStart:e})})),v(this,"onHomeDashboardChanged",(e=>{this.setState({homeDashboardUID:e})})),v(this,"onLocaleChanged",(e=>{this.setState({locale:e})})),v(this,"getFullDashName",(e=>void 0===e.folderTitle||""===e.folderTitle?e.title:e.folderTitle+" / "+e.title)),this.service=new f.y(e.resourceUri),this.state={homeDashboardUID:I.uid,theme:"",timezone:"",weekStart:"",locale:"",dashboards:[],queryHistory:{homeTab:""}}}async componentDidMount(){const e=await this.service.load(),s=await x.ae.search({starred:!0});if(e.homeDashboardUID&&!s.find((s=>s.uid===e.homeDashboardUID))){const t=await x.ae.search({dashboardUIDs:e.homeDashboardUID});t.length>0&&s.push(t[0])}this.setState({homeDashboardUID:e.homeDashboardUID,theme:e.theme,timezone:e.timezone,weekStart:e.weekStart,locale:e.locale,dashboards:[I,...s],queryHistory:e.queryHistory})}render(){const{theme:e,timezone:s,weekStart:t,homeDashboardUID:c,locale:m,dashboards:g}=this.state,{disabled:b}=this.props,f=k(),x=a||(a=(0,j.jsx)(p.Tooltip,{content:(0,j.jsx)(d.cC,{id:"shared-preferences.fields.home-dashboard-tooltip"}),children:(0,j.jsx)(p.Icon,{name:"info-circle"})}));return(0,j.jsx)(p.Form,{onSubmit:this.onSubmitForm,children:()=>{var a;return(0,j.jsxs)(p.FieldSet,{label:n||(n=(0,j.jsx)(d.cC,{id:"shared-preferences.title"})),disabled:b,children:[(0,j.jsx)(p.Field,{label:l.ag._({id:"shared-preferences.fields.theme-label",message:"UI Theme"}),children:(0,j.jsx)(p.RadioButtonGroup,{options:y,value:null===(a=y.find((s=>s.value===e)))||void 0===a?void 0:a.value,onChange:this.onThemeChanged})}),(0,j.jsx)(p.Field,{label:(0,j.jsxs)(p.Label,{htmlFor:"home-dashboard-select",children:[(0,j.jsx)("span",{className:f.labelText,children:r||(r=(0,j.jsx)(d.cC,{id:"shared-preferences.fields.home-dashboard-label"}))}),x]}),"data-testid":"User preferences home dashboard drop down",children:(0,j.jsx)(p.Select,{value:g.find((e=>e.uid===c)),getOptionValue:e=>e.uid,getOptionLabel:this.getFullDashName,onChange:e=>this.onHomeDashboardChanged(e.uid),options:g,placeholder:l.ag._({id:"shared-preferences.fields.home-dashboard-placeholder",message:"Choose default dashboard"}),inputId:"home-dashboard-select"})}),(0,j.jsx)(p.Field,{label:l.ag._({id:"shared-dashboard.fields.timezone-label",message:"Timezone"}),"data-testid":u.wl.components.TimeZonePicker.containerV2,children:(0,j.jsx)(p.TimeZonePicker,{includeInternal:!0,value:s,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})}),(0,j.jsx)(p.Field,{label:l.ag._({id:"shared-preferences.fields.week-start-label",message:"Week start"}),"data-testid":u.wl.components.WeekStartPicker.containerV2,children:(0,j.jsx)(p.WeekStartPicker,{value:t,onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})}),w?(0,j.jsx)(p.Field,{label:(0,j.jsxs)(p.Label,{htmlFor:"locale-select",children:[(0,j.jsx)("span",{className:f.labelText,children:i||(i=(0,j.jsx)(d.cC,{id:"shared-preferences.fields.locale-label"}))}),(0,j.jsx)(p.FeatureBadge,{featureState:h.FeatureState.alpha})]}),"data-testid":"User preferences language drop down",children:(0,j.jsx)(p.Select,{value:T.find((e=>e.value===m)),onChange:e=>{var s;return this.onLocaleChanged(null!==(s=e.value)&&void 0!==s?s:"")},options:T,placeholder:l.ag._({id:"shared-preferences.fields.locale-placeholder",message:"Choose language"}),inputId:"locale-select"})}):null,(0,j.jsx)("div",{className:"gf-form-button-row",children:(0,j.jsx)(p.Button,{type:"submit",variant:"primary","data-testid":u.wl.components.UserProfile.preferencesSaveButton,children:o||(o=(0,j.jsx)(d.cC,{id:"common.save"}))})})]})}})}}const S=C,k=(0,p.stylesFactory)((()=>({labelText:c.css`
      margin-right: 6px;
    `})))},65623:(e,s,t)=>{t.d(s,{d:()=>n});var a=t(90923);const n=()=>function(){var e;const s=null===(e=a.config.licenseInfo)||void 0===e?void 0:e.trialExpiry;return!!(s&&s>0)}()&&a.config.featureToggles.featureHighlights},85642:(e,s,t)=>{t.r(s),t.d(s,{TeamPages:()=>ye,default:()=>Te});var a=t(82897),n=t(68404),r=t(18745),i=t(90923),o=t(3490),d=t(69371),l=t(36636),c=t(45916);const m=["featureName","className","children","text","featureId","eventVariant","size"];const h=e=>{let{featureName:s,className:t,text:a,featureId:r,eventVariant:d="",size:h="md"}=e,g=function(e,s){if(null==e)return{};var t,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)t=r[a],s.indexOf(t)>=0||(n[t]=e[t]);return n}(e,m);const p=(0,o.useStyles2)((e=>u(e,h)));return(0,n.useEffect)((()=>{(0,i.reportExperimentView)(`feature-highlights-${r}`,"test",d)}),[d,r]),(0,c.jsxs)("div",Object.assign({className:(0,l.cx)(p.box,t)},g,{children:[(0,c.jsx)(o.Icon,{name:"rocket",className:p.icon}),(0,c.jsxs)("div",{className:p.inner,children:[(0,c.jsxs)("p",{className:p.text,children:["Youâ€™ve discovered a Pro feature! ",a||`Get the Grafana Pro plan to access ${s}.`]}),(0,c.jsx)(o.LinkButton,{variant:"secondary",size:h,className:p.button,href:"https://grafana.com/profile/org/subscription",target:"__blank",rel:"noopener noreferrer",children:"Upgrade"})]})]}))},u=(e,s)=>{const t=e.shape.borderRadius(2),a="md"===s?"body":"bodySmall";return{box:l.css`
      display: flex;
      align-items: center;
      position: relative;
      border-radius: ${t};
      background: ${e.colors.success.transparent};
      padding: ${e.spacing(2)};
      color: ${e.colors.success.text};
      font-size: ${e.typography[a].fontSize};
      text-align: left;
      line-height: 16px;
      margin: ${e.spacing(0,"auto",3,"auto")};
      max-width: ${e.breakpoints.values.xxl}px;
      width: 100%;
    `,inner:l.css`
      display: flex;
      align-items: center;
      width: 100%;
      justify-content: space-between;
    `,text:l.css`
      margin: 0;
    `,button:l.css`
      background-color: ${e.colors.success.main};
      font-weight: ${e.typography.fontWeightLight};
      color: white;

      &:hover {
        background-color: ${e.colors.success.main};
      }

      &:focus-visible {
        box-shadow: none;
        color: ${e.colors.text.primary};
        outline: 2px solid ${e.colors.primary.main};
      }
    `,icon:l.css`
      margin: ${e.spacing(.5,1,.5,.5)};
    `}},g=e=>{let{listItems:s,image:t,featureUrl:a,featureName:n,description:r,caption:i,action:d}=e;const l=(0,o.useStyles2)(p);return(0,c.jsxs)("div",{className:l.container,children:[(0,c.jsxs)("div",{className:l.content,children:[(0,c.jsxs)("h3",{className:l.title,children:["Get started with ",n]}),r&&(0,c.jsx)("h6",{className:l.description,children:r}),(0,c.jsx)("ul",{className:l.list,children:s.map(((e,s)=>(0,c.jsxs)("li",{children:[(0,c.jsx)(o.Icon,{name:"check",size:"xl",className:l.icon})," ",e]},s)))}),(null==d?void 0:d.link)&&(0,c.jsx)(o.LinkButton,{variant:"primary",href:d.link,children:d.text}),(null==d?void 0:d.onClick)&&(0,c.jsx)(o.Button,{variant:"primary",onClick:d.onClick,children:d.text}),a&&(0,c.jsx)(o.LinkButton,{fill:"text",href:a,className:l.link,target:"_blank",rel:"noreferrer noopener",children:"Learn more"})]}),(0,c.jsxs)("div",{className:l.media,children:[(0,c.jsx)("img",{src:b(t),alt:"Feature screenshot"}),i&&(0,c.jsx)("p",{className:l.caption,children:i})]})]})},p=e=>({container:l.css`
      display: flex;
      justify-content: space-between;
    `,content:l.css`
      width: 45%;
      margin-right: ${e.spacing(4)};
    `,media:l.css`
      width: 55%;

      img {
        width: 100%;
      }
    `,title:l.css`
      color: ${e.colors.text.maxContrast};
    `,description:l.css`
      color: ${e.colors.text.primary};
      font-weight: ${e.typography.fontWeightLight};
    `,list:l.css`
      list-style: none;
      margin: ${e.spacing(4,0,2,0)};

      li {
        display: flex;
        align-items: flex-start;
        color: ${e.colors.text.primary};
        padding: ${e.spacing(1,0)};
      }
    `,icon:l.css`
      color: ${e.colors.success.main};
      margin-right: ${e.spacing(1)};
    `,link:l.css`
      margin-left: ${e.spacing(2)};
    `,caption:l.css`
      font-weight: ${e.typography.fontWeightLight};
      margin: ${e.spacing(1,0,0)};
    `}),b=e=>e.startsWith("http")?e:"/public/img/enterprise/highlights/"+e;var f,x,j,v,y,T,w,I=t(78837),C=t(8674),S=t(61959),k=t(47570),A=t(72779),P=t(6347),N=t(28436),$=t(65623),L=t(44083),U=t(71181);function D(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}function M(e){return{groups:(0,U.JB)(e.team)}}const G={loadTeamGroups:L.j_,addTeamGroup:L.A_,removeTeamGroup:L.P5},F=((0,r.connect)(M,G),"Sync LDAP, OAuth or SAML groups with your Grafana teams.");class B extends n.PureComponent{constructor(e){super(e),D(this,"onToggleAdding",(()=>{this.setState({isAdding:!this.state.isAdding})})),D(this,"onNewGroupIdChanged",(e=>{this.setState({newGroupId:e.target.value})})),D(this,"onAddGroup",(e=>{e.preventDefault(),this.props.addTeamGroup(this.state.newGroupId),this.setState({isAdding:!1,newGroupId:""})})),D(this,"onRemoveGroup",(e=>{this.props.removeTeamGroup(e.groupId)})),this.state={isAdding:!1,newGroupId:""}}componentDidMount(){this.fetchTeamGroups()}async fetchTeamGroups(){await this.props.loadTeamGroups()}isNewGroupValid(){return this.state.newGroupId.length>1}renderGroup(e){const{isReadOnly:s}=this.props;return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{children:e.groupId}),(0,c.jsx)("td",{style:{width:"1%"},children:(0,c.jsx)(o.Button,{size:"sm",variant:"destructive",onClick:()=>this.onRemoveGroup(e),disabled:s,"aria-label":`Remove group ${e.groupId}`,children:f||(f=(0,c.jsx)(o.Icon,{name:"times"}))})})]},e.groupId)}render(){const{isAdding:e,newGroupId:s}=this.state,{groups:t,isReadOnly:a}=this.props;return(0,c.jsxs)("div",{children:[(0,$.d)()&&(x||(x=(0,c.jsx)(h,{featureId:"team-sync",eventVariant:"trial",featureName:"team sync",text:"Add a group to enable team sync for free during your trial of Grafana Pro."}))),(0,c.jsxs)("div",{className:"page-action-bar",children:[(!(0,$.d)()||t.length>0)&&(0,c.jsxs)(c.Fragment,{children:[j||(j=(0,c.jsx)("h3",{className:"page-sub-heading",children:"External group sync"})),v||(v=(0,c.jsx)(o.Tooltip,{placement:"auto",content:F,children:(0,c.jsx)(o.Icon,{className:"icon--has-hover page-sub-heading-icon",name:"question-circle"})}))]}),y||(y=(0,c.jsx)("div",{className:"page-action-bar__spacer"})),t.length>0&&(0,c.jsxs)(o.Button,{className:"pull-right",onClick:this.onToggleAdding,disabled:a,children:[T||(T=(0,c.jsx)(o.Icon,{name:"plus"}))," Add group"]})]}),(0,c.jsx)(A.s,{in:e,children:(0,c.jsxs)("div",{className:"cta-form",children:[(0,c.jsx)(P.P,{onClick:this.onToggleAdding}),(0,c.jsx)("form",{onSubmit:this.onAddGroup,children:(0,c.jsxs)(o.InlineFieldRow,{children:[(0,c.jsx)(o.InlineField,{label:"Add External Group",tooltip:"LDAP Group Example: cn=users,ou=groups,dc=grafana,dc=org.",children:(0,c.jsx)(o.Input,{type:"text",id:"add-external-group",placeholder:"",value:s,onChange:this.onNewGroupIdChanged,disabled:a})}),(0,c.jsx)(o.Button,{type:"submit",disabled:a||!this.isNewGroupValid(),style:{marginLeft:4},children:"Add group"})]})})]})}),0===t.length&&!e&&((0,$.d)()?(0,c.jsx)(V,{action:{onClick:this.onToggleAdding,text:"Add group"}}):(0,c.jsx)(N.Z,{onClick:this.onToggleAdding,buttonIcon:"users-alt",title:"There are no external groups to sync with",buttonTitle:"Add group",proTip:F,proTipLinkTitle:"Learn more",proTipLink:"https://docs.grafana.org/auth/enhanced_ldap/",proTipTarget:"_blank",buttonDisabled:a})),t.length>0&&(0,c.jsx)("div",{className:"admin-list-table",children:(0,c.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[w||(w=(0,c.jsx)("th",{children:"External Group ID"})),(0,c.jsx)("th",{style:{width:"1%"}})]})}),(0,c.jsx)("tbody",{children:t.map((e=>this.renderGroup(e)))})]})})]})}}const V=e=>{let{action:s}=e;const t=(0,o.useTheme2)();return(0,c.jsx)(g,{action:s,listItems:["Stop managing user access in two places - assign users to groups in SAML, LDAP or Oauth, and manage access at a Team level in Grafana","Update usersâ€™ permissions immediately when you add or remove them from an LDAP group, with no need for them to sign out and back in"],image:`team-sync-${t.isLight?"light":"dark"}.png`,featureName:"team sync",featureUrl:"https://grafana.com/docs/grafana/latest/enterprise/team-sync",description:"Team Sync makes it easier for you to manage usersâ€™ access in Grafana, by immediately updating each userâ€™s Grafana teams and permissions based on their single sign-on group membership, instead of when users sign in."})},E=(0,r.connect)(M,G)(B);var _=t(28909),z=t(87261);const R=e=>{let{featureToggle:s,children:t}=e;return!0===s?(0,c.jsx)(c.Fragment,{children:t}):null};var O;const W={removeTeamMember:L.zT,updateTeamMember:L.zZ},Z=(0,r.connect)(null,W);class Q extends n.PureComponent{constructor(e){var s,t,a;super(e),a=(e,s)=>{const t=e.value,a=Object.assign({},s,{permission:t});this.props.updateTeamMember(a)},(t="onPermissionChange")in(s=this)?Object.defineProperty(s,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):s[t]=a,this.renderLabels=this.renderLabels.bind(this),this.renderPermissions=this.renderPermissions.bind(this)}onRemoveMember(e){this.props.removeTeamMember(e.userId)}renderPermissions(e){const{editorsCanAdmin:s,signedInUserIsTeamAdmin:t}=this.props,a=k.eL.find((s=>s.value===e.permission));return(0,c.jsx)(R,{featureToggle:s,children:(0,c.jsx)("td",{className:"width-5 team-permissions",children:t?(0,c.jsx)(o.Select,{isSearchable:!1,options:k.eL,onChange:s=>this.onPermissionChange(s,e),value:a,width:32,"aria-label":`Select member's ${e.name} permission level`}):(0,c.jsx)("span",{children:a.label})})})}renderLabels(e){return e?(0,c.jsx)("td",{children:e.map((e=>(0,c.jsx)(z.e,{label:e,removeIcon:!1,count:0,onClick:()=>{}},e)))}):O||(O=(0,c.jsx)("td",{}))}render(){const{member:e,syncEnabled:s,signedInUserIsTeamAdmin:t}=this.props;return(0,c.jsxs)("tr",{children:[(0,c.jsx)("td",{className:"width-4 text-center",children:(0,c.jsx)("img",{alt:`Avatar for team member "${e.name}"`,className:"filter-table__avatar",src:e.avatarUrl})}),(0,c.jsx)("td",{children:e.login}),(0,c.jsx)("td",{children:e.email}),(0,c.jsx)("td",{children:e.name}),this.renderPermissions(e),s&&this.renderLabels(e.labels),(0,c.jsx)("td",{className:"text-right",children:(0,c.jsx)(o.DeleteButton,{"aria-label":`Remove team member ${e.name}`,size:"sm",disabled:!t,onConfirm:()=>this.onRemoveMember(e)})})]},e.userId)}}const q=Z(Q);var H,Y,J,X,K,ee,se,te,ae=t(99574);function ne(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}const re={addTeamMember:L.Lt,setSearchMemberQuery:ae.UD},ie=(0,r.connect)((function(e){return{searchMemberQuery:(0,U.xc)(e.team),editorsCanAdmin:I.vc.editorsCanAdmin,signedInUser:S.Vt.user}}),re);class oe extends n.PureComponent{constructor(e){super(e),ne(this,"onSearchQueryChange",(e=>{this.props.setSearchMemberQuery(e)})),ne(this,"onToggleAdding",(()=>{this.setState({isAdding:!this.state.isAdding})})),ne(this,"onUserSelected",(e=>{this.setState({newTeamMember:e})})),ne(this,"onAddUserToTeam",(async()=>{this.props.addTeamMember(this.state.newTeamMember.id),this.setState({newTeamMember:null})})),this.state={isAdding:!1,newTeamMember:null}}renderLabels(e){return e?(0,c.jsx)("td",{children:e.map((e=>(0,c.jsx)(z.e,{label:e,removeIcon:!1,count:0,onClick:()=>{}},e)))}):H||(H=(0,c.jsx)("td",{}))}render(){const{isAdding:e}=this.state,{searchMemberQuery:s,members:t,syncEnabled:a,editorsCanAdmin:n,signedInUser:r}=this.props,i=(0,U.vt)({members:t,editorsCanAdmin:n,signedInUser:r});return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{className:"page-action-bar",children:[(0,c.jsx)("div",{className:"gf-form gf-form--grow",children:(0,c.jsx)(o.FilterInput,{placeholder:"Search members",value:s,onChange:this.onSearchQueryChange})}),(0,c.jsx)(o.Button,{className:"pull-right",onClick:this.onToggleAdding,disabled:e||!i,children:"Add member"})]}),(0,c.jsx)(A.s,{in:e,children:(0,c.jsxs)("div",{className:"cta-form",children:[(0,c.jsx)(P.P,{"aria-label":"Close 'Add team member' dialogue",onClick:this.onToggleAdding}),Y||(Y=(0,c.jsx)(o.Label,{htmlFor:"user-picker",children:"Add team member"})),(0,c.jsxs)("div",{className:"gf-form-inline",children:[(0,c.jsx)(_.f,{inputId:"user-picker",onSelected:this.onUserSelected,className:"min-width-30"}),this.state.newTeamMember&&(0,c.jsx)(o.Button,{type:"submit",onClick:this.onAddUserToTeam,children:"Add to team"})]})]})}),(0,c.jsx)("div",{className:"admin-list-table",children:(0,c.jsxs)("table",{className:"filter-table filter-table--hover form-inline",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{children:[J||(J=(0,c.jsx)("th",{})),X||(X=(0,c.jsx)("th",{children:"Login"})),K||(K=(0,c.jsx)("th",{children:"Email"})),ee||(ee=(0,c.jsx)("th",{children:"Name"})),(0,c.jsx)(R,{featureToggle:n,children:se||(se=(0,c.jsx)("th",{children:"Permission"}))}),a&&(te||(te=(0,c.jsx)("th",{}))),(0,c.jsx)("th",{style:{width:"1%"}})]})}),(0,c.jsx)("tbody",{children:t&&t.map((e=>(0,c.jsx)(q,{member:e,syncEnabled:a,editorsCanAdmin:n,signedInUserIsTeamAdmin:i},e.userId)))})]})})]})}}const de=ie(oe);var le=t(83654);const ce=e=>{const s=S.Vt.hasPermissionInMetadata(k.bW.ActionTeamsPermissionsWrite,e.team);return(0,c.jsx)(le.P,{title:"",addPermissionTitle:"Add member",buttonLabel:"Add member",resource:"teams",resourceId:e.team.id,canSetPermissions:s})};var me=t(67833);const he={updateTeam:L.fs},ue=(0,r.connect)(null,he)((e=>{let{team:s,updateTeam:t}=e;const a=S.Vt.hasPermissionInMetadata(k.bW.ActionTeamsWrite,s);return(0,c.jsxs)(o.VerticalGroup,{children:[(0,c.jsx)(o.FieldSet,{label:"Team settings",children:(0,c.jsx)(o.Form,{defaultValues:Object.assign({},s),onSubmit:e=>{t(e.name,e.email)},disabled:!a,children:e=>{let{register:s,errors:t}=e;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.Field,{label:"Name",disabled:!a,required:!0,invalid:!!t.name,error:"Name is required",children:(0,c.jsx)(o.Input,Object.assign({},s("name",{required:!0}),{id:"name-input"}))}),(0,c.jsx)(o.Field,{label:"Email",description:"This is optional and is primarily used to set the team profile avatar (via gravatar service).",disabled:!a,children:(0,c.jsx)(o.Input,Object.assign({},s("email"),{placeholder:"team@email.com",type:"email",id:"email-input"}))}),(0,c.jsx)(o.Button,{type:"submit",disabled:!a,children:"Update"})]})}})}),(0,c.jsx)(me.v,{resourceUri:`teams/${s.id}`,disabled:!a})]})}));var ge,pe,be,fe=t(91574);function xe(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}!function(e){e.Members="members",e.Settings="settings",e.GroupSync="groupsync"}(be||(be={}));const je={loadTeam:L.QX,loadTeamMembers:L.ei},ve=(0,r.connect)((function(e,s){var t;const a=parseInt(s.match.params.id,10),n=(0,U.VP)(e.team,a);let r="members";S.Vt.accessControlEnabled()&&(n&&S.Vt.hasPermissionInMetadata(k.bW.ActionTeamsPermissionsRead,n)||(r="settings"));const i=null!==(t=s.match.params.page)&&void 0!==t?t:r,o=(0,fe.o)(i);return{pageNav:(0,C.h)(e.navIndex,`team-${i}-${a}`,o).main,teamId:a,pageName:i,team:n,members:(0,U.YY)(e.team),editorsCanAdmin:I.ZP.editorsCanAdmin,signedInUser:S.Vt.user}}),je);class ye extends n.PureComponent{constructor(e){super(e),xe(this,"textsAreEqual",((e,s)=>!e&&!s||!(!e||!s)&&e.toLocaleLowerCase()===s.toLocaleLowerCase())),xe(this,"hideTabsFromNonTeamAdmin",((e,s)=>(S.Vt.accessControlEnabled()||!s&&e&&e.children&&e.children.filter((e=>!this.textsAreEqual(e.text,be.Members))).map((e=>{e.hideFromTabs=!0})),e))),this.state={isLoading:!1,isSyncEnabled:(0,i.featureEnabled)("teamsync")}}async componentDidMount(){await this.fetchTeam()}async fetchTeam(){const{loadTeam:e,teamId:s}=this.props;this.setState({isLoading:!0});const t=await e(s);return S.Vt.accessControlEnabled()||await this.props.loadTeamMembers(),this.setState({isLoading:!1}),t}getCurrentPage(){const e=["members","settings","groupsync"],s=this.props.pageName;return(0,a.includes)(e,s)?s:e[0]}renderPage(e){const{isSyncEnabled:s}=this.state,{members:t,team:a}=this.props,n=this.getCurrentPage(),r=S.Vt.hasAccessInMetadata(k.bW.ActionTeamsRead,a,e),i=S.Vt.hasAccessInMetadata(k.bW.ActionTeamsPermissionsRead,a,e),o=S.Vt.hasAccessInMetadata(k.bW.ActionTeamsPermissionsWrite,a,e);switch(n){case be.Members:return S.Vt.accessControlEnabled()?(0,c.jsx)(ce,{team:a}):(0,c.jsx)(de,{syncEnabled:s,members:t});case be.Settings:return r&&(0,c.jsx)(ue,{team:a});case be.GroupSync:if(s){if(i)return(0,c.jsx)(E,{isReadOnly:!o})}else if(I.ZP.featureToggles.featureHighlights)return(0,c.jsxs)(c.Fragment,{children:[ge||(ge=(0,c.jsx)(h,{featureName:"team sync",featureId:"team-sync"})),pe||(pe=(0,c.jsx)(V,{}))]})}return null}render(){const{team:e,pageNav:s,members:t,editorsCanAdmin:a,signedInUser:n}=this.props,r=(0,U.vt)({members:t,editorsCanAdmin:a,signedInUser:n});return(0,c.jsx)(d.T,{navId:"teams",pageNav:this.hideTabsFromNonTeamAdmin(s,r),children:(0,c.jsx)(d.T.Contents,{isLoading:this.state.isLoading,children:e&&0!==Object.keys(e).length&&this.renderPage(r)})})}}const Te=ve((0,o.withTheme2)(ye))},44083:(e,s,t)=>{t.d(s,{A_:()=>f,Lt:()=>u,P5:()=>x,QX:()=>m,ei:()=>h,fC:()=>j,fs:()=>p,jI:()=>c,j_:()=>b,zT:()=>g,zZ:()=>v});var a=t(90923),n=t(36537),r=t(98163),i=t(66728),o=t(47570),d=t(91574),l=t(99574);function c(){return async e=>{if(!r.Vt.hasPermission(o.bW.ActionTeamsRead))return void e((0,l.PL)([]));const s=await(0,a.getBackendSrv)().get("/api/teams/search",(0,i.y)({perpage:1e3,page:1}));e((0,l.PL)(s.teams))}}function m(e){return async s=>{const t=await(0,a.getBackendSrv)().get(`/api/teams/${e}`,(0,i.y)());s((0,l.y$)(t)),s((0,n.RL)((0,d.B)(t)))}}function h(){return async(e,s)=>{const t=s().team.team,n=await(0,a.getBackendSrv)().get(`/api/teams/${t.id}/members`);e((0,l.n2)(n))}}function u(e){return async(s,t)=>{const n=t().team.team;await(0,a.getBackendSrv)().post(`/api/teams/${n.id}/members`,{userId:e}),s(h())}}function g(e){return async(s,t)=>{const n=t().team.team;await(0,a.getBackendSrv)().delete(`/api/teams/${n.id}/members/${e}`),s(h())}}function p(e,s){return async(t,n)=>{const r=n().team.team;await(0,a.getBackendSrv)().put(`/api/teams/${r.id}`,{name:e,email:s}),t(m(r.id))}}function b(){return async(e,s)=>{const t=s().team.team,n=await(0,a.getBackendSrv)().get(`/api/teams/${t.id}/groups`);e((0,l.iI)(n))}}function f(e){return async(s,t)=>{const n=t().team.team;await(0,a.getBackendSrv)().post(`/api/teams/${n.id}/groups`,{groupId:e}),s(b())}}function x(e){return async(s,t)=>{const n=t().team.team;await(0,a.getBackendSrv)().delete(`/api/teams/${n.id}/groups/${encodeURIComponent(e)}`),s(b())}}function j(e){return async s=>{await(0,a.getBackendSrv)().delete(`/api/teams/${e}`),await r.Vt.fetchUserPermissions(),s(c())}}function v(e){return async s=>{await(0,a.getBackendSrv)().put(`/api/teams/${e.teamId}/members/${e.userId}`,{permission:e.permission}),s(h())}}},91574:(e,s,t)=>{t.d(s,{B:()=>c,o:()=>m});var a=t(90923),n=t(17963),r=t(78837),i=t(61959),o=t(65623),d=t(47570);const l={avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:d.hw.Member};function c(e){const s={img:e.avatarUrl,id:"team-"+e.id,subTitle:"Manage members and settings",url:"",text:e.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"sliders-v-alt",id:`team-settings-${e.id}`,text:"Settings",url:`org/teams/edit/${e.id}/settings`}]};(e===l||i.Vt.hasPermissionInMetadata(d.bW.ActionTeamsPermissionsRead,e))&&s.children.unshift({active:!1,icon:"users-alt",id:`team-members-${e.id}`,text:"Members",url:`org/teams/edit/${e.id}/members`});const t={active:!1,icon:"sync",id:`team-groupsync-${e.id}`,text:"External group sync",url:`org/teams/edit/${e.id}/groupsync`},c=e===l;return(0,o.d)()&&(t.tabSuffix=()=>(0,n.Z)({experimentId:c?"":"feature-highlights-team-sync-badge",eventVariant:"trial"})),(0,a.featureEnabled)("teamsync")?(c||i.Vt.hasPermissionInMetadata(d.bW.ActionTeamsPermissionsRead,e))&&s.children.push(t):r.ZP.featureToggles.featureHighlights&&s.children.push(Object.assign({},t,{tabSuffix:()=>(0,n.Z)({experimentId:c?"":"feature-highlights-team-sync-badge"})})),s}function m(e){const s=c(l);let t;for(const a of s.children)if(a.id.indexOf(e)>0){a.active=!0,t=a;break}return{main:s,node:t}}},71181:(e,s,t)=>{t.d(s,{JB:()=>i,LK:()=>c,VP:()=>l,YY:()=>m,_u:()=>d,kC:()=>u,uP:()=>n,v7:()=>o,vt:()=>h,xc:()=>r});var a=t(47570);const n=e=>e.searchQuery,r=e=>e.searchMemberQuery,i=e=>e.groups,o=e=>e.teams.length,d=e=>e.searchPage,l=(e,s)=>e.team.id===parseInt(s,10)?e.team:null,c=e=>{const s=RegExp(e.searchQuery,"i");return e.teams.filter((e=>s.test(e.name)))},m=e=>{const s=RegExp(e.searchMemberQuery,"i");return e.members.filter((e=>s.test(e.login)||s.test(e.email)||s.test(e.name)))},h=e=>{const{members:s,signedInUser:t,editorsCanAdmin:n}=e,r=s.find((e=>e.userId===t.id)),i=r?r.permission:a.hw.Member;return u({permission:i,signedInUser:t,editorsCanAdmin:n})},u=e=>{const{permission:s,signedInUser:t,editorsCanAdmin:n}=e,r=t.isGrafanaAdmin||t.orgRole===a.B5.Admin,i=s===a.hw.Admin;return r||i||!n}}}]);
//# sourceMappingURL=TeamPages.8e7c7a3f1e7a29340238.js.map