"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4785],{89858:(J,D,s)=>{s.r(D),s.d(D,{DataTrailsPage:()=>z,default:()=>Q});var t=s(74848),u=s(96540),y=s(24180),C=s(64388),H=s(39601),m=s(81887),N=s(21780),l=s(32196),F=s(54148),A=s(40845),v=s(67061),E=s(55852),M=s(69529),B=s(94753),U=s(76412),O=s(72724),f=s(10860),V=s(78369),$=s(29158),i=s(74764),T=s(4200),c=s(51080);function L(e){const{onSelect:a,onDelete:o,bookmark:r}=e,n=(0,A.of)(P),j=(0,u.useMemo)(()=>{let x=e.trail||r&&(0,i._r)().getTrailForBookmark(r);if(!x)return null;const w=m.jh.lookupVariable(T.Ao,x);if(!(w instanceof m.H9))return null;const X=r?.createdAt||x.state.createdAt;return{dsValue:(0,c.U4)(x),filters:w.state.filters,metric:x.state.metric,createdAt:X}},[e.trail,r]);if(!j)return null;const{dsValue:d,filters:h,metric:p,createdAt:I}=j;return(0,t.jsxs)(f.Z,{onClick:a,className:n.card,children:[(0,t.jsx)(f.Z.Heading,{className:n.wordwrap,children:(0,c.aO)(p)}),(0,t.jsx)("div",{className:n.description,children:(0,t.jsx)(v.B,{gap:1.5,wrap:"wrap",children:h.map(x=>(0,t.jsx)(V.v,{name:`${x.key}: ${x.value}`,colorIndex:12},x.key))})}),(0,t.jsx)(f.Z.Actions,{className:n.actions,children:(0,t.jsxs)(v.B,{gap:1,justifyContent:"space-between",grow:1,children:[(0,t.jsxs)("div",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Datasource:"})," ",(0,c.nH)(d)]}),I&&(0,t.jsxs)("i",{className:n.secondary,children:[(0,t.jsx)("b",{children:"Created:"})," ",(0,O.LE)(I,{format:"LL"})]})]})}),o&&(0,t.jsx)(f.Z.SecondaryActions,{children:(0,t.jsx)($.K,{name:"trash-alt",className:n.secondary,tooltip:"Remove bookmark",onClick:o},"delete")})]})}function P(e){return{tag:(0,l.css)({maxWidth:"260px",overflow:"hidden",textOverflow:"ellipsis"}),card:(0,l.css)({padding:e.spacing(1)}),secondary:(0,l.css)({color:e.colors.text.secondary,fontSize:"12px"}),description:(0,l.css)({width:"100%",gridArea:"Description",margin:e.spacing(1,0,0),color:e.colors.text.secondary,lineHeight:e.typography.body.lineHeight,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),actions:(0,l.css)({marginRight:e.spacing(1)}),wordwrap:(0,l.css)({overflow:"hidden",overflowWrap:"anywhere"})}}var g=s(40588);class W extends m.Bs{constructor(a){super(a),this.onNewMetricsTrail=()=>{const o=k(this),r=(0,c.ef)((0,c.hR)());(0,g.z)("exploration_started",{cause:"new_clicked"}),(0,i._r)().setRecentTrail(r),o.goToUrlForTrail(r)},this.onSelectRecentTrail=o=>{const r=k(this);(0,g.z)("exploration_started",{cause:"recent_clicked"}),(0,i._r)().setRecentTrail(o),r.goToUrlForTrail(o)},this.onSelectBookmark=o=>{const r=k(this);(0,g.z)("exploration_started",{cause:"bookmark_clicked"});const n=(0,i._r)().getTrailForBookmarkIndex(o);(0,i._r)().setRecentTrail(n),r.goToUrlForTrail(n)}}static{this.Component=({model:a})=>{const[o,r]=(0,u.useState)(Date.now()),n=(0,A.of)(Z),j=d=>{(0,i._r)().removeBookmark(d),(0,g.z)("bookmark_changed",{action:"deleted"}),r(Date.now())};if(!(0,i._r)().recent.length){const d=(0,c.ef)((0,c.hR)());return(0,t.jsx)(F.C5,{replace:!0,to:(0,c.xi)(d)})}return(0,t.jsxs)("div",{className:n.container,children:[(0,t.jsx)(v.B,{direction:"column",gap:1,alignItems:"start",children:(0,t.jsx)(E.$n,{icon:"plus",size:"md",variant:"primary",onClick:a.onNewMetricsTrail,children:"New metric exploration"})}),(0,t.jsxs)(v.B,{gap:5,children:[(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(B.E,{variant:"h4",children:"Recent metrics explorations"}),(0,t.jsx)("div",{className:n.trailList,children:(0,i._r)().recent.map((d,h)=>{const p=d.resolve();return(0,t.jsx)(L,{trail:p,onSelect:()=>a.onSelectRecentTrail(p)},(p.state.key||"")+h)})})]}),(0,t.jsx)("div",{className:n.verticalLine}),(0,t.jsxs)("div",{className:n.column,children:[(0,t.jsx)(B.E,{variant:"h4",children:"Bookmarks"}),(0,t.jsx)("div",{className:n.trailList,children:(0,i._r)().bookmarks.length?(0,i._r)().bookmarks.map((d,h)=>(0,t.jsx)(L,{bookmark:d,onSelect:()=>a.onSelectBookmark(h),onDelete:()=>j(h)},(0,i.yn)(d))):(0,t.jsx)(M.p,{variant:"call-to-action",message:"",image:!1,children:(0,t.jsx)(U.x,{i18nKey:"trails.bookmarks.empty-state",children:"You haven't created any bookmarks yet. Use the Explore Metrics bookmarks feature to save your panels as bookmarks."})})})]})]})]})}}}function k(e){return m.jh.getAncestor(e,R)}function Z(e){return{container:(0,l.css)({flexGrow:1,display:"flex",flexDirection:"column",gap:e.spacing(3)}),column:(0,l.css)({display:"flex",flexGrow:1,flexDirection:"column",gap:e.spacing(2)}),newTrail:(0,l.css)({height:"auto",justifyContent:"center",fontSize:e.typography.h5.fontSize}),trailCard:(0,l.css)({}),trailList:(0,l.css)({display:"flex",flexDirection:"column",gap:e.spacing(2)}),verticalLine:(0,l.css)({borderLeft:`1px solid ${e.colors.border.weak}`})}}var Y=s(90623);class R extends m.Bs{constructor(a){super(a)}goToUrlForTrail(a){H.Ny.push((0,c.xi)(a)),this.setState({trail:a})}static{this.Component=({model:a})=>{const{trail:o,home:r}=a.useState();return(0,t.jsxs)(y.dO,{children:[(0,t.jsx)(y.qh,{exact:!0,path:T.QX,render:()=>(0,t.jsx)(N.YW,{navId:"explore/metrics",layout:C.k.Standard,renderTitle:()=>(0,t.jsx)(Y.p,{}),subTitle:"",children:(0,t.jsx)(r.Component,{model:r})})}),(0,t.jsx)(y.qh,{exact:!0,path:T.km,render:()=>(0,t.jsx)(G,{trail:o})})]})}}}function G({trail:e}){const[a,o]=(0,u.useState)(!1),{metric:r}=e.useState();return(0,u.useEffect)(()=>{a||((0,i._r)().setRecentTrail(e),o(!0))},[e,a]),a?(0,t.jsx)(m.$L,{scene:e,children:(0,t.jsx)(N.YW,{navId:"explore/metrics",pageNav:{text:(0,c.aO)(r)},layout:C.k.Custom,children:(0,t.jsx)(e.Component,{model:e})})}):null}let S;function K(){return S||(S=new R({trail:(0,c.ef)(),home:new W({})})),S}function z(){const e=K();return(0,t.jsx)(e.Component,{model:e})}const Q=z}}]);

//# sourceMappingURL=DataTrailsPage.f3b7b20abdcecea28c2f.js.map