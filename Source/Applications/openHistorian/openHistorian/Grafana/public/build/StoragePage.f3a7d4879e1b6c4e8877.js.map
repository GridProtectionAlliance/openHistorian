{"version":3,"file":"StoragePage.f3a7d4879e1b6c4e8877.js","mappings":"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","sources":["webpack://grafana/./public/app/core/hooks/useNavModel.ts","webpack://grafana/./public/app/features/storage/AddRootView.tsx","webpack://grafana/./public/app/features/storage/Breadcrumb.tsx","webpack://grafana/./public/app/features/storage/CreateNewFolderModal.tsx","webpack://grafana/./public/app/features/storage/ExportView.tsx","webpack://grafana/./public/app/features/storage/FileView.tsx","webpack://grafana/./public/app/features/storage/FolderView.tsx","webpack://grafana/./public/app/features/storage/RootView.tsx","webpack://grafana/./public/app/features/storage/UploadButton.tsx","webpack://grafana/./public/app/features/storage/StoragePage.tsx"],"sourcesContent":["import { useSelector } from 'react-redux';\n\nimport { NavModel } from '@grafana/data';\nimport { StoreState } from 'app/types/store';\n\nimport { getNavModel } from '../selectors/navModel';\n\nexport const useNavModel = (id: string): NavModel => {\n  const navIndex = useSelector((state: StoreState) => state.navIndex);\n  return getNavModel(navIndex, id);\n};\n","import React from 'react';\n\nimport { Button } from '@grafana/ui';\n\nimport { StorageView } from './types';\n\ninterface Props {\n  onPathChange: (p: string, v?: StorageView) => void;\n}\n\nexport function AddRootView({ onPathChange }: Props) {\n  return (\n    <div>\n      <div>TODO... Add ROOT</div>\n      <Button variant=\"secondary\" onClick={() => onPathChange('/')}>\n        Cancel\n      </Button>\n    </div>\n  );\n}\n","import { css } from '@emotion/css';\nimport { uniqueId } from 'lodash';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Icon, IconName, useStyles2 } from '@grafana/ui';\n\ninterface Props {\n  rootIcon?: IconName;\n  pathName: string;\n  onPathChange: (path: string) => void;\n}\n\nexport function Breadcrumb({ pathName, onPathChange, rootIcon }: Props) {\n  const styles = useStyles2(getStyles);\n  const paths = pathName.split('/').filter(Boolean);\n\n  return (\n    <ul className={styles.breadCrumb}>\n      {rootIcon && (\n        <li onClick={() => onPathChange('')}>\n          <Icon name={rootIcon} />\n        </li>\n      )}\n      {paths.map((path, index) => {\n        let url = '/' + paths.slice(0, index + 1).join('/');\n        const onClickBreadcrumb = () => onPathChange(url);\n        const isLastBreadcrumb = index === paths.length - 1;\n        return (\n          <li key={uniqueId(path)} onClick={isLastBreadcrumb ? undefined : onClickBreadcrumb}>\n            {path}\n          </li>\n        );\n      })}\n    </ul>\n  );\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    breadCrumb: css`\n      list-style: none;\n      padding: ${theme.spacing(2, 1)};\n\n      li {\n        display: inline;\n\n        :not(:last-child) {\n          color: ${theme.colors.text.link};\n          cursor: pointer;\n        }\n        + li:before {\n          content: '>';\n          padding: ${theme.spacing(1)};\n          color: ${theme.colors.text.secondary};\n        }\n      }\n    `,\n  };\n}\n","import React from 'react';\nimport { SubmitHandler, Validate } from 'react-hook-form';\n\nimport { Button, Field, Form, Input, Modal } from '@grafana/ui';\n\ntype FormModel = { folderName: string };\n\ninterface Props {\n  onSubmit: SubmitHandler<FormModel>;\n  onDismiss: () => void;\n  validate: Validate<string>;\n}\n\nconst initialFormModel = { folderName: '' };\n\nexport function CreateNewFolderModal({ validate, onDismiss, onSubmit }: Props) {\n  return (\n    <Modal onDismiss={onDismiss} isOpen={true} title=\"New Folder\">\n      <Form defaultValues={initialFormModel} onSubmit={onSubmit} maxWidth={'none'}>\n        {({ register, errors }) => (\n          <>\n            <Field\n              label=\"Folder name\"\n              invalid={!!errors.folderName}\n              error={errors.folderName && errors.folderName.message}\n            >\n              <Input\n                id=\"folder-name-input\"\n                {...register('folderName', {\n                  required: 'Folder name is required.',\n                  validate: { validate },\n                })}\n              />\n            </Field>\n\n            <Modal.ButtonRow>\n              <Button type=\"submit\">Create</Button>\n            </Modal.ButtonRow>\n          </>\n        )}\n      </Form>\n    </Modal>\n  );\n}\n","import React, { useEffect, useState, useCallback } from 'react';\nimport { useAsync, useLocalStorage } from 'react-use';\n\nimport { isLiveChannelMessageEvent, isLiveChannelStatusEvent, LiveChannelScope, SelectableValue } from '@grafana/data';\nimport { getBackendSrv, getGrafanaLiveSrv } from '@grafana/runtime';\nimport {\n  Button,\n  CodeEditor,\n  Collapse,\n  Field,\n  HorizontalGroup,\n  InlineField,\n  InlineFieldRow,\n  InlineSwitch,\n  Input,\n  LinkButton,\n  Select,\n  Switch,\n} from '@grafana/ui';\n\nimport { StorageView } from './types';\n\nexport const EXPORT_LOCAL_STORAGE_KEY = 'grafana.export.config';\n\ninterface ExportStatusMessage {\n  running: boolean;\n  target: string;\n  started: number;\n  finished: number;\n  update: number;\n  count: number;\n  current: number;\n  last: string;\n  status: string;\n}\n\ninterface ExportJob {\n  format: string; // 'git';\n  generalFolderPath: string;\n  history: boolean;\n  exclude: Record<string, boolean>;\n\n  git?: {};\n}\n\nconst defaultJob: ExportJob = {\n  format: 'git',\n  generalFolderPath: 'general',\n  history: true,\n  exclude: {},\n  git: {},\n};\n\ninterface ExporterInfo {\n  key: string;\n  name: string;\n  description: string;\n  children?: ExporterInfo[];\n}\n\nconst formats: Array<SelectableValue<string>> = [\n  { label: 'GIT', value: 'git', description: 'Exports a fresh git repository' },\n];\n\ninterface Props {\n  onPathChange: (p: string, v?: StorageView) => void;\n}\n\nconst labelWith = 18;\n\nexport const ExportView = ({ onPathChange }: Props) => {\n  const [status, setStatus] = useState<ExportStatusMessage>();\n  const [body, setBody] = useLocalStorage<ExportJob>(EXPORT_LOCAL_STORAGE_KEY, defaultJob);\n  const [details, setDetails] = useState(false);\n\n  const serverOptions = useAsync(() => {\n    return getBackendSrv().get<{ exporters: ExporterInfo[] }>('/api/admin/export/options');\n  }, []);\n\n  const doStart = () => {\n    getBackendSrv()\n      .post('/api/admin/export', body)\n      .then((v) => {\n        if (v.cfg && v.status.running) {\n          setBody(v.cfg); // saves the valid parsed body\n        }\n      });\n  };\n\n  const doStop = () => {\n    getBackendSrv().post('/api/admin/export/stop');\n  };\n\n  const setInclude = useCallback(\n    (k: string, v: boolean) => {\n      if (!serverOptions.value || !body) {\n        return;\n      }\n      const exclude: Record<string, boolean> = {};\n      if (k === '*') {\n        if (!v) {\n          for (let exp of serverOptions.value.exporters) {\n            exclude[exp.key] = true;\n          }\n        }\n        setBody({ ...body, exclude });\n        return;\n      }\n\n      for (let exp of serverOptions.value.exporters) {\n        let val = body.exclude?.[exp.key];\n        if (k === exp.key) {\n          val = !v;\n        }\n        if (val) {\n          exclude[exp.key] = val;\n        }\n      }\n      setBody({ ...body, exclude });\n    },\n    [body, setBody, serverOptions]\n  );\n\n  useEffect(() => {\n    const subscription = getGrafanaLiveSrv()\n      .getStream<ExportStatusMessage>({\n        scope: LiveChannelScope.Grafana,\n        namespace: 'broadcast',\n        path: 'export',\n      })\n      .subscribe({\n        next: (evt) => {\n          if (isLiveChannelMessageEvent(evt)) {\n            setStatus(evt.message);\n          } else if (isLiveChannelStatusEvent(evt)) {\n            setStatus(evt.message);\n          }\n        },\n      });\n\n    return () => {\n      subscription.unsubscribe();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <div>\n      {status && (\n        <div>\n          <h3>Status</h3>\n          <pre>{JSON.stringify(status, null, 2)}</pre>\n          {status.running && (\n            <div>\n              <Button variant=\"secondary\" onClick={doStop}>\n                Stop\n              </Button>\n            </div>\n          )}\n        </div>\n      )}\n\n      {!Boolean(status?.running) && (\n        <div>\n          <h3>Export grafana instance</h3>\n          <Field label=\"Format\">\n            <Select\n              options={formats}\n              width={40}\n              value={formats.find((v) => v.value === body?.format)}\n              onChange={(v) => setBody({ ...body!, format: v.value! })}\n            />\n          </Field>\n          <Field label=\"Keep history\">\n            <Switch value={body?.history} onChange={(v) => setBody({ ...body!, history: v.currentTarget.checked })} />\n          </Field>\n\n          <Field label=\"Include\">\n            <>\n              <InlineFieldRow>\n                <InlineField label=\"Toggle all\" labelWidth={labelWith}>\n                  <InlineSwitch\n                    value={Object.keys(body?.exclude ?? {}).length === 0}\n                    onChange={(v) => setInclude('*', v.currentTarget.checked)}\n                  />\n                </InlineField>\n              </InlineFieldRow>\n              {serverOptions.value && (\n                <div>\n                  {serverOptions.value.exporters.map((ex) => (\n                    <InlineFieldRow key={ex.key}>\n                      <InlineField label={ex.name} labelWidth={labelWith} tooltip={ex.description}>\n                        <InlineSwitch\n                          value={body?.exclude?.[ex.key] !== true}\n                          onChange={(v) => setInclude(ex.key, v.currentTarget.checked)}\n                        />\n                      </InlineField>\n                    </InlineFieldRow>\n                  ))}\n                </div>\n              )}\n            </>\n          </Field>\n\n          <Field label=\"General folder\" description=\"Set the folder name for items without a real folder\">\n            <Input\n              width={40}\n              value={body?.generalFolderPath ?? ''}\n              onChange={(v) => setBody({ ...body!, generalFolderPath: v.currentTarget.value })}\n              placeholder=\"root folder path\"\n            />\n          </Field>\n\n          <HorizontalGroup>\n            <Button onClick={doStart} variant=\"primary\">\n              Export\n            </Button>\n            <LinkButton href=\"admin/storage/\" variant=\"secondary\">\n              Cancel\n            </LinkButton>\n          </HorizontalGroup>\n        </div>\n      )}\n      <br />\n      <br />\n\n      <Collapse label=\"Request details\" isOpen={details} onToggle={setDetails} collapsible={true}>\n        <CodeEditor\n          height={275}\n          value={JSON.stringify(body, null, 2) ?? ''}\n          showLineNumbers={false}\n          readOnly={false}\n          language=\"json\"\n          showMiniMap={false}\n          onBlur={(text: string) => {\n            setBody(JSON.parse(text)); // force JSON?\n          }}\n        />\n      </Collapse>\n    </div>\n  );\n};\n","import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport React, { useMemo } from 'react';\nimport SVG from 'react-inlinesvg';\nimport { useAsync } from 'react-use';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { DataFrame, GrafanaTheme2 } from '@grafana/data';\nimport { CodeEditor, useStyles2 } from '@grafana/ui';\n\nimport { getGrafanaStorage } from './storage';\nimport { StorageView } from './types';\n\ninterface FileDisplayInfo {\n  category?: 'svg' | 'image' | 'text';\n  language?: string; // match code editor\n}\n\ninterface Props {\n  listing: DataFrame;\n  path: string;\n  onPathChange: (p: string, view?: StorageView) => void;\n  view: StorageView;\n}\n\nexport function FileView({ listing, path, onPathChange, view }: Props) {\n  const styles = useStyles2(getStyles);\n  const info = useMemo(() => getFileDisplayInfo(path), [path]);\n  const body = useAsync(async () => {\n    if (info.category === 'text') {\n      const rsp = await getGrafanaStorage().get(path);\n      if (isString(rsp)) {\n        return rsp;\n      }\n      return JSON.stringify(rsp, null, 2);\n    }\n    return null;\n  }, [info, path]);\n\n  switch (view) {\n    case StorageView.Config:\n      return <div>CONFIGURE?</div>;\n    case StorageView.Perms:\n      return <div>Permissions</div>;\n    case StorageView.History:\n      return <div>TODO... history</div>;\n  }\n\n  let src = `api/storage/read/${path}`;\n  if (src.endsWith('/')) {\n    src = src.substring(0, src.length - 1);\n  }\n\n  switch (info.category) {\n    case 'svg':\n      return (\n        <div>\n          <SVG src={src} className={styles.icon} />\n        </div>\n      );\n    case 'image':\n      return (\n        <div>\n          <a target={'_self'} href={src}>\n            <img src={src} className={styles.img} />\n          </a>\n        </div>\n      );\n    case 'text':\n      return (\n        <div className={styles.tableWrapper}>\n          <AutoSizer>\n            {({ width, height }) => (\n              <CodeEditor\n                width={width}\n                height={height}\n                value={body.value ?? ''}\n                showLineNumbers={false}\n                readOnly={true}\n                language={info.language ?? 'text'}\n                showMiniMap={false}\n                onBlur={(text: string) => {\n                  console.log('CHANGED!', text);\n                }}\n              />\n            )}\n          </AutoSizer>\n        </div>\n      );\n  }\n\n  return (\n    <div>\n      FILE: <a href={src}>{path}</a>\n    </div>\n  );\n}\n\nfunction getFileDisplayInfo(path: string): FileDisplayInfo {\n  const idx = path.lastIndexOf('.');\n  if (idx < 0) {\n    return {};\n  }\n  const suffix = path.substring(idx + 1).toLowerCase();\n  switch (suffix) {\n    case 'svg':\n      return { category: 'svg' };\n    case 'jpg':\n    case 'jpeg':\n    case 'png':\n    case 'webp':\n    case 'gif':\n      return { category: 'image' };\n\n    case 'geojson':\n    case 'json':\n      return { category: 'text', language: 'json' };\n    case 'text':\n    case 'go':\n    case 'md':\n      return { category: 'text' };\n  }\n  return {};\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  // TODO: remove `height: 90%`\n  wrapper: css`\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n  `,\n  tableControlRowWrapper: css`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-bottom: ${theme.spacing(2)};\n  `,\n  // TODO: remove `height: 100%`\n  tableWrapper: css`\n    border: 1px solid ${theme.colors.border.medium};\n    height: 100%;\n  `,\n  uploadSpot: css`\n    margin-left: ${theme.spacing(2)};\n  `,\n  border: css`\n    border: 1px solid ${theme.colors.border.medium};\n    padding: ${theme.spacing(2)};\n  `,\n  img: css`\n    max-width: 100%;\n    // max-height: 147px;\n    // fill: ${theme.colors.text.primary};\n  `,\n  icon: css`\n    // max-width: 100%;\n    // max-height: 147px;\n    // fill: ${theme.colors.text.primary};\n  `,\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport AutoSizer from 'react-virtualized-auto-sizer';\n\nimport { DataFrame, GrafanaTheme2 } from '@grafana/data';\nimport { Table, useStyles2 } from '@grafana/ui';\n\nimport { StorageView } from './types';\n\ninterface Props {\n  listing: DataFrame;\n  view: StorageView;\n}\n\nexport function FolderView({ listing, view }: Props) {\n  const styles = useStyles2(getStyles);\n\n  switch (view) {\n    case StorageView.Config:\n      return <div>CONFIGURE?</div>;\n    case StorageView.Perms:\n      return <div>Permissions</div>;\n  }\n\n  return (\n    <div className={styles.tableWrapper}>\n      <AutoSizer>\n        {({ width, height }) => (\n          <div style={{ width: `${width}px`, height: `${height}px` }}>\n            <Table\n              height={height}\n              width={width}\n              data={listing}\n              noHeader={false}\n              showTypeIcons={false}\n              resizable={false}\n            />\n          </div>\n        )}\n      </AutoSizer>\n    </div>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  // TODO: remove `height: 90%`\n  wrapper: css`\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n  `,\n  tableControlRowWrapper: css`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-bottom: ${theme.spacing(2)};\n  `,\n  // TODO: remove `height: 100%`\n  tableWrapper: css`\n    border: 1px solid ${theme.colors.border.medium};\n    height: 100%;\n  `,\n  uploadSpot: css`\n    margin-left: ${theme.spacing(2)};\n  `,\n  border: css`\n    border: 1px solid ${theme.colors.border.medium};\n    padding: ${theme.spacing(2)};\n  `,\n});\n","import { css } from '@emotion/css';\nimport React, { useMemo, useState } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { DataFrame, GrafanaTheme2 } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport {\n  Alert,\n  Button,\n  Card,\n  FilterInput,\n  HorizontalGroup,\n  Icon,\n  IconName,\n  TagList,\n  useStyles2,\n  VerticalGroup,\n} from '@grafana/ui';\n\nimport { getGrafanaStorage } from './storage';\nimport { StorageInfo, StorageView } from './types';\n\ninterface Props {\n  root: DataFrame;\n  onPathChange: (p: string, v?: StorageView) => void;\n}\n\nexport function RootView({ root, onPathChange }: Props) {\n  const styles = useStyles2(getStyles);\n  const storage = useAsync(getGrafanaStorage().getConfig);\n  const [searchQuery, setSearchQuery] = useState<string>('');\n  let base = location.pathname;\n  if (!base.endsWith('/')) {\n    base += '/';\n  }\n\n  const roots = useMemo(() => {\n    const all = storage.value;\n    if (searchQuery?.length && all) {\n      const lower = searchQuery.toLowerCase();\n      return all.filter((r) => {\n        const v = r.config;\n        const isMatch = v.name.toLowerCase().indexOf(lower) >= 0 || v.description.toLowerCase().indexOf(lower) >= 0;\n        if (isMatch) {\n          return true;\n        }\n        return false;\n      });\n    }\n    return all ?? [];\n  }, [searchQuery, storage]);\n\n  return (\n    <div>\n      <div className=\"page-action-bar\">\n        <div className=\"gf-form gf-form--grow\">\n          <FilterInput placeholder=\"Search Storage\" value={searchQuery} onChange={setSearchQuery} />\n        </div>\n        <Button className=\"pull-right\" onClick={() => onPathChange('', StorageView.AddRoot)}>\n          Add Root\n        </Button>\n        {config.featureToggles.export && (\n          <Button className=\"pull-right\" onClick={() => onPathChange('', StorageView.Export)}>\n            Export\n          </Button>\n        )}\n      </div>\n      <VerticalGroup>\n        {roots.map((s) => {\n          const ok = s.ready;\n          return (\n            <Card key={s.config.prefix} href={ok ? `admin/storage/${s.config.prefix}/` : undefined}>\n              <Card.Heading>{s.config.name}</Card.Heading>\n              <Card.Meta className={styles.clickable}>\n                {s.config.description}\n                {s.config.git?.remote && <a href={s.config.git?.remote}>{s.config.git?.remote}</a>}\n              </Card.Meta>\n              {s.notice?.map((notice) => (\n                <Alert key={notice.text} severity={notice.severity} title={notice.text} />\n              ))}\n\n              <Card.Tags className={styles.clickable}>\n                <HorizontalGroup>\n                  <TagList tags={getTags(s)} />\n                </HorizontalGroup>\n              </Card.Tags>\n              <Card.Figure className={styles.clickable}>\n                <Icon name={getIconName(s.config.type)} size=\"xxxl\" className={styles.secondaryTextColor} />\n              </Card.Figure>\n            </Card>\n          );\n        })}\n      </VerticalGroup>\n    </div>\n  );\n}\n\nfunction getStyles(theme: GrafanaTheme2) {\n  return {\n    secondaryTextColor: css`\n      color: ${theme.colors.text.secondary};\n    `,\n    clickable: css`\n      pointer-events: none;\n    `,\n  };\n}\n\nfunction getTags(v: StorageInfo) {\n  const tags: string[] = [];\n  if (v.builtin) {\n    tags.push('Builtin');\n  }\n  if (!v.editable) {\n    tags.push('Read only');\n  }\n\n  // Error\n  if (!v.ready) {\n    tags.push('Not ready');\n  }\n  return tags;\n}\n\nexport function getIconName(type: string): IconName {\n  switch (type) {\n    case 'git':\n      return 'code-branch';\n    case 'disk':\n      return 'folder-open';\n    case 'sql':\n      return 'database';\n    default:\n      return 'folder-open';\n  }\n}\n","import { css } from '@emotion/css';\nimport React, { FormEvent, useEffect, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { ConfirmModal, FileUpload, useStyles2 } from '@grafana/ui';\n\nimport { filenameAlreadyExists, getGrafanaStorage } from './storage';\nimport { StorageView, UploadReponse } from './types';\n\ninterface Props {\n  setErrorMessages: (errors: string[]) => void;\n  setPath: (p: string, view?: StorageView) => void;\n  path: string;\n  fileNames: string[];\n}\n\nconst fileFormats = 'image/jpg, image/jpeg, image/png, image/gif, image/webp';\n\nexport function UploadButton({ setErrorMessages, setPath, path, fileNames }: Props) {\n  const styles = useStyles2(getStyles);\n\n  const [file, setFile] = useState<File | undefined>(undefined);\n  const [filenameExists, setFilenameExists] = useState(false);\n  const [fileUploadKey, setFileUploadKey] = useState(1);\n  const [isConfirmOpen, setIsConfirmOpen] = useState(true);\n\n  useEffect(() => {\n    setFileUploadKey((prev) => prev + 1);\n  }, [file]);\n\n  const onUpload = (rsp: UploadReponse) => {\n    console.log('Uploaded: ' + path);\n    if (rsp.path) {\n      setPath(rsp.path);\n    } else {\n      setPath(path); // back to data\n    }\n  };\n\n  const doUpload = async (fileToUpload: File, overwriteExistingFile: boolean) => {\n    if (!fileToUpload) {\n      setErrorMessages(['Please select a file.']);\n      return;\n    }\n\n    const rsp = await getGrafanaStorage().upload(path, fileToUpload, overwriteExistingFile);\n    if (rsp.status !== 200) {\n      setErrorMessages([rsp.message]);\n    } else {\n      onUpload(rsp);\n    }\n  };\n\n  const onFileUpload = (event: FormEvent<HTMLInputElement>) => {\n    setErrorMessages([]);\n\n    const fileToUpload =\n      event.currentTarget.files && event.currentTarget.files.length > 0 && event.currentTarget.files[0]\n        ? event.currentTarget.files[0]\n        : undefined;\n    if (fileToUpload) {\n      setFile(fileToUpload);\n\n      const fileExists = filenameAlreadyExists(fileToUpload.name, fileNames);\n      if (!fileExists) {\n        setFilenameExists(false);\n        doUpload(fileToUpload, false).then((r) => {});\n      } else {\n        setFilenameExists(true);\n        setIsConfirmOpen(true);\n      }\n    }\n  };\n\n  const onOverwriteConfirm = () => {\n    if (file) {\n      doUpload(file, true).then((r) => {});\n      setIsConfirmOpen(false);\n    }\n  };\n\n  const onOverwriteDismiss = () => {\n    setFile(undefined);\n    setFilenameExists(false);\n    setIsConfirmOpen(false);\n  };\n\n  return (\n    <>\n      <FileUpload accept={fileFormats} onFileUpload={onFileUpload} key={fileUploadKey} className={styles.uploadButton}>\n        Upload\n      </FileUpload>\n\n      {file && filenameExists && (\n        <ConfirmModal\n          isOpen={isConfirmOpen}\n          body={\n            <div>\n              <p>{file?.name}</p>\n              <p>A file with this name already exists.</p>\n              <p>What would you like to do?</p>\n            </div>\n          }\n          title={'This file already exists'}\n          confirmText={'Replace'}\n          onConfirm={onOverwriteConfirm}\n          onDismiss={onOverwriteDismiss}\n        />\n      )}\n    </>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  uploadButton: css`\n    margin-right: ${theme.spacing(2)};\n  `,\n});\n","import { css } from '@emotion/css';\nimport React, { useMemo, useState } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { DataFrame, GrafanaTheme2, isDataFrame, ValueLinkConfig } from '@grafana/data';\nimport { config, locationService } from '@grafana/runtime';\nimport { useStyles2, IconName, Spinner, TabsBar, Tab, Button, HorizontalGroup, LinkButton, Alert } from '@grafana/ui';\nimport appEvents from 'app/core/app_events';\nimport { Page } from 'app/core/components/Page/Page';\nimport { useNavModel } from 'app/core/hooks/useNavModel';\nimport { GrafanaRouteComponentProps } from 'app/core/navigation/types';\nimport { ShowConfirmModalEvent } from 'app/types/events';\n\nimport { AddRootView } from './AddRootView';\nimport { Breadcrumb } from './Breadcrumb';\nimport { CreateNewFolderModal } from './CreateNewFolderModal';\nimport { ExportView } from './ExportView';\nimport { FileView } from './FileView';\nimport { FolderView } from './FolderView';\nimport { RootView } from './RootView';\nimport { UploadButton } from './UploadButton';\nimport { getGrafanaStorage, filenameAlreadyExists } from './storage';\nimport { StorageView } from './types';\n\ninterface RouteParams {\n  path: string;\n}\n\ninterface QueryParams {\n  view: StorageView;\n}\n\nconst folderNameRegex = /^[a-z\\d!\\-_.*'() ]+$/;\nconst folderNameMaxLength = 256;\n\ninterface Props extends GrafanaRouteComponentProps<RouteParams, QueryParams> {}\n\nconst getParentPath = (path: string) => {\n  const lastSlashIdx = path.lastIndexOf('/');\n  if (lastSlashIdx < 1) {\n    return '';\n  }\n\n  return path.substring(0, lastSlashIdx);\n};\n\nexport default function StoragePage(props: Props) {\n  const styles = useStyles2(getStyles);\n  const navModel = useNavModel('storage');\n  const path = props.match.params.path ?? '';\n  const view = props.queryParams.view ?? StorageView.Data;\n  const setPath = (p: string, view?: StorageView) => {\n    let url = ('/admin/storage/' + p).replace('//', '/');\n    if (view && view !== StorageView.Data) {\n      url += '?view=' + view;\n    }\n    locationService.push(url);\n  };\n\n  const [isAddingNewFolder, setIsAddingNewFolder] = useState(false);\n  const [errorMessages, setErrorMessages] = useState<string[]>([]);\n\n  const listing = useAsync((): Promise<DataFrame | undefined> => {\n    return getGrafanaStorage()\n      .list(path)\n      .then((frame) => {\n        if (frame) {\n          const name = frame.fields[0];\n          frame.fields[0] = {\n            ...name,\n            getLinks: (cfg: ValueLinkConfig) => {\n              const n = name.values.get(cfg.valueRowIndex ?? 0);\n              const p = path + '/' + n;\n              return [\n                {\n                  title: `Open ${n}`,\n                  href: `/admin/storage/${p}`,\n                  target: '_self',\n                  origin: name,\n                  onClick: () => {\n                    setPath(p);\n                  },\n                },\n              ];\n            },\n          };\n        }\n        return frame;\n      });\n  }, [path]);\n\n  const isFolder = useMemo(() => {\n    let isFolder = path?.indexOf('/') < 0;\n    if (listing.value) {\n      const length = listing.value.length;\n      if (length === 1) {\n        const first = listing.value.fields[0].values.get(0) as string;\n        isFolder = !path.endsWith(first);\n      } else {\n        // TODO: handle files/folders which do not exist\n        isFolder = true;\n      }\n    }\n    return isFolder;\n  }, [path, listing]);\n\n  const fileNames = useMemo(() => {\n    return (\n      listing.value?.fields\n        ?.find((f) => f.name === 'name')\n        ?.values?.toArray()\n        ?.filter((v) => typeof v === 'string') ?? []\n    );\n  }, [listing]);\n\n  const renderView = () => {\n    const isRoot = !path?.length || path === '/';\n    switch (view) {\n      case StorageView.Export:\n        if (!isRoot) {\n          setPath('');\n          return <Spinner />;\n        }\n        return <ExportView onPathChange={setPath} />;\n\n      case StorageView.AddRoot:\n        if (!isRoot) {\n          setPath('');\n          return <Spinner />;\n        }\n        return <AddRootView onPathChange={setPath} />;\n    }\n\n    const frame = listing.value;\n    if (!isDataFrame(frame)) {\n      return <></>;\n    }\n\n    if (isRoot) {\n      return <RootView root={frame} onPathChange={setPath} />;\n    }\n\n    const opts = [{ what: StorageView.Data, text: 'Data' }];\n\n    // Root folders have a config page\n    if (path.indexOf('/') < 0) {\n      opts.push({ what: StorageView.Config, text: 'Configure' });\n    }\n\n    // Lets only apply permissions to folders (for now)\n    if (isFolder) {\n      opts.push({ what: StorageView.Perms, text: 'Permissions' });\n    } else {\n      // TODO: only if the file exists in a storage engine with\n      opts.push({ what: StorageView.History, text: 'History' });\n    }\n\n    const canAddFolder = isFolder && path.startsWith('resources');\n    const canDelete = path.startsWith('resources/');\n    const canViewDashboard = config.featureToggles.dashboardsFromStorage && (isFolder || path.endsWith('.json'));\n\n    const getErrorMessages = () => {\n      return (\n        <div className={styles.errorAlert}>\n          <Alert title=\"Upload failed\" severity=\"error\" onRemove={clearAlert}>\n            {errorMessages.map((error) => {\n              return <div key={error}>{error}</div>;\n            })}\n          </Alert>\n        </div>\n      );\n    };\n\n    const clearAlert = () => {\n      setErrorMessages([]);\n    };\n\n    return (\n      <div className={styles.wrapper}>\n        <HorizontalGroup width=\"100%\" justify=\"space-between\" spacing={'md'} height={25}>\n          <Breadcrumb pathName={path} onPathChange={setPath} rootIcon={navModel.node.icon as IconName} />\n          <HorizontalGroup>\n            {canViewDashboard && (\n              <LinkButton icon=\"dashboard\" href={`g/${path}`}>\n                Dashboard\n              </LinkButton>\n            )}\n\n            {canAddFolder && (\n              <>\n                <UploadButton path={path} setErrorMessages={setErrorMessages} fileNames={fileNames} setPath={setPath} />\n                <Button onClick={() => setIsAddingNewFolder(true)}>New Folder</Button>\n              </>\n            )}\n            {canDelete && (\n              <Button\n                variant=\"destructive\"\n                onClick={() => {\n                  const text = isFolder\n                    ? 'Are you sure you want to delete this folder and all its contents?'\n                    : 'Are you sure you want to delete this file?';\n\n                  const parentPath = getParentPath(path);\n                  appEvents.publish(\n                    new ShowConfirmModalEvent({\n                      title: `Delete ${isFolder ? 'folder' : 'file'}`,\n                      text,\n                      icon: 'trash-alt',\n                      yesText: 'Delete',\n                      onConfirm: () =>\n                        getGrafanaStorage()\n                          .delete({ path, isFolder })\n                          .then(() => {\n                            setPath(parentPath);\n                          }),\n                    })\n                  );\n                }}\n              >\n                Delete\n              </Button>\n            )}\n          </HorizontalGroup>\n        </HorizontalGroup>\n\n        {errorMessages.length > 0 && getErrorMessages()}\n\n        <TabsBar>\n          {opts.map((opt) => (\n            <Tab\n              key={opt.what}\n              label={opt.text}\n              active={opt.what === view}\n              onChangeTab={() => setPath(path, opt.what)}\n            />\n          ))}\n        </TabsBar>\n        {isFolder ? (\n          <FolderView listing={frame} view={view} />\n        ) : (\n          <FileView path={path} listing={frame} onPathChange={setPath} view={view} />\n        )}\n\n        {isAddingNewFolder && (\n          <CreateNewFolderModal\n            onSubmit={async ({ folderName }) => {\n              const folderPath = `${path}/${folderName}`;\n              const res = await getGrafanaStorage().createFolder(folderPath);\n              if (typeof res?.error !== 'string') {\n                setPath(folderPath);\n                setIsAddingNewFolder(false);\n              }\n            }}\n            onDismiss={() => {\n              setIsAddingNewFolder(false);\n            }}\n            validate={(folderName) => {\n              const lowerCase = folderName.toLowerCase();\n\n              if (filenameAlreadyExists(folderName, fileNames)) {\n                return 'A file or a folder with the same name already exists';\n              }\n\n              if (!folderNameRegex.test(lowerCase)) {\n                return 'Name contains illegal characters';\n              }\n\n              if (folderName.length > folderNameMaxLength) {\n                return `Name is too long, maximum length: ${folderNameMaxLength} characters`;\n              }\n\n              return true;\n            }}\n          />\n        )}\n      </div>\n    );\n  };\n\n  return (\n    <Page navModel={navModel}>\n      <Page.Contents isLoading={listing.loading}>{renderView()}</Page.Contents>\n    </Page>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  // TODO: remove `height: 90%`\n  wrapper: css`\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n  `,\n  tableControlRowWrapper: css`\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    margin-bottom: ${theme.spacing(2)};\n  `,\n  // TODO: remove `height: 100%`\n  tableWrapper: css`\n    border: 1px solid ${theme.colors.border.medium};\n    height: 100%;\n  `,\n  border: css`\n    border: 1px solid ${theme.colors.border.medium};\n    padding: ${theme.spacing(2)};\n  `,\n  errorAlert: css`\n    padding-top: 20px;\n  `,\n  uploadButton: css`\n    margin-right: ${theme.spacing(2)};\n  `,\n});\n"],"names":["useNavModel","id","navIndex","useSelector","state","getNavModel","AddRootView","onPathChange","Button","variant","onClick","Breadcrumb","pathName","rootIcon","styles","useStyles2","getStyles","paths","split","filter","Boolean","className","breadCrumb","Icon","name","map","path","index","url","slice","join","isLastBreadcrumb","length","undefined","uniqueId","theme","css","spacing","colors","text","link","secondary","initialFormModel","folderName","CreateNewFolderModal","validate","onDismiss","onSubmit","Modal","isOpen","title","Form","defaultValues","maxWidth","register","errors","Field","label","invalid","error","message","Input","required","type","defaultJob","format","generalFolderPath","history","exclude","git","formats","value","description","ExportView","status","setStatus","useState","body","setBody","useLocalStorage","details","setDetails","serverOptions","useAsync","getBackendSrv","get","setInclude","useCallback","k","v","exp","exporters","val","key","useEffect","subscription","getGrafanaLiveSrv","getStream","scope","LiveChannelScope","namespace","subscribe","next","evt","isLiveChannelMessageEvent","isLiveChannelStatusEvent","unsubscribe","JSON","stringify","running","post","Select","options","width","find","onChange","Switch","currentTarget","checked","InlineFieldRow","InlineField","labelWidth","InlineSwitch","Object","keys","ex","tooltip","placeholder","HorizontalGroup","then","cfg","LinkButton","href","Collapse","onToggle","collapsible","CodeEditor","height","showLineNumbers","readOnly","language","showMiniMap","onBlur","parse","FileView","listing","view","info","useMemo","idx","lastIndexOf","substring","toLowerCase","category","getFileDisplayInfo","async","rsp","getGrafanaStorage","isString","StorageView","src","endsWith","icon","target","img","tableWrapper","console","log","wrapper","tableControlRowWrapper","border","medium","uploadSpot","primary","FolderView","style","Table","data","noHeader","showTypeIcons","resizable","RootView","root","storage","getConfig","searchQuery","setSearchQuery","base","location","pathname","roots","all","lower","r","config","indexOf","FilterInput","VerticalGroup","s","ok","ready","Card","prefix","clickable","remote","notice","Alert","severity","TagList","tags","getTags","getIconName","size","secondaryTextColor","builtin","push","editable","UploadButton","setErrorMessages","setPath","fileNames","file","setFile","filenameExists","setFilenameExists","fileUploadKey","setFileUploadKey","isConfirmOpen","setIsConfirmOpen","prev","doUpload","fileToUpload","overwriteExistingFile","upload","onUpload","FileUpload","accept","onFileUpload","event","files","filenameAlreadyExists","uploadButton","ConfirmModal","confirmText","onConfirm","folderNameRegex","StoragePage","props","navModel","match","params","queryParams","p","replace","locationService","isAddingNewFolder","setIsAddingNewFolder","errorMessages","list","frame","fields","getLinks","n","values","valueRowIndex","origin","isFolder","first","f","toArray","Page","isLoading","loading","isRoot","Spinner","isDataFrame","opts","what","canAddFolder","startsWith","canDelete","canViewDashboard","clearAlert","justify","node","parentPath","lastSlashIdx","getParentPath","appEvents","ShowConfirmModalEvent","yesText","delete","errorAlert","onRemove","TabsBar","opt","Tab","active","onChangeTab","folderPath","res","createFolder","lowerCase","test","renderView"],"sourceRoot":""}