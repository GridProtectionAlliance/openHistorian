"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6359],{37811:(he,Q,l)=>{l.d(Q,{A:()=>e});function e(N){N.getRowProps.push(S=>[S,C()]),N.getHeaderGroupProps.push(S=>[S,C()]),N.getFooterGroupProps.push(S=>[S,C()]),N.getHeaderProps.push((S,{column:b})=>[S,r(b)]),N.getCellProps.push((S,{cell:b})=>[S,r(b.column)]),N.getFooterProps.push((S,{column:b})=>[S,r(b)])}e.pluginName="useCustomFlexLayout";function r(N){return{style:{flex:N.totalWidth===0?"0 0 auto":`${N.totalWidth} 0 0`}}}function C(){return{style:{display:"flex",flex:"1 0 auto"}}}},66359:(he,Q,l)=>{l.d(Q,{P:()=>ve});var e=l(74848),r=l(32196),C=l(96540),N=l(32885),S=l(91793),b=l(10022),ne=l(52622),X=l(40845),oe=l(49618),re=l(69770),ie=l(37811),de=l(97427),ce=l(68284),g=l(70255),H=l(11261),G=l(57875),W=l(28240),Z=l(83195),T=l(32264),J=l(19347),R=l(10880),$=l(14578),k=l(94753),U=l(56034),L=l(64149),K=l(28138),d=l(8484),F=l(84753),ee=l(66253),q=l(28444),se=l(40957),ye=l(25897),je=l(37390),Ce=l(40980),fe=l(32372),we=l(1819);const le=[{label:"Score",value:"score"},{label:"Fields",value:"fields"},{label:"Allowed actions",value:"allowed_actions"}];function De({name:s,explain:t,frame:u,row:i}){const[c,n]=(0,C.useState)(!0),[f,j]=(0,C.useState)("score"),p=(0,e.jsx)(ye.J,{title:s,icon:"info",tabs:le,activeTab:f,onChangeTab:o=>{j(o.value)}});return(0,e.jsx)(je.a,{title:p,isOpen:c,onDismiss:()=>n(!1),closeOnBackdropClick:!0,closeOnEscape:!0,children:(0,e.jsxs)(Ce.J,{children:[f===le[0].value&&(0,e.jsx)(fe.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!0,value:JSON.stringify(t,null,2),readOnly:!1}),f===le[1].value&&(0,e.jsx)("div",{children:(0,e.jsx)(we.e,{data:u,rowIndex:i})}),f===le[2].value&&(0,e.jsx)(fe.B,{width:"100%",height:"70vh",language:"json",showLineNumbers:!1,showMiniMap:!1,value:(()=>{const o=u.fields.find(D=>D.name==="allowed_actions")?.values?.[i],a=u.fields.find(D=>D.name==="ds_uid")?.values?.[i];return JSON.stringify({dsUids:a??[],allowedActions:o??[]},null,2)})(),readOnly:!1})]})})}const Pe=175,Se=200,Ie=200,Ee=(s,t,u,i,c,n,f,j,p)=>{const o=[],a=s.view.fields,D=a.uid,I=a.kind;let w=0;const E=a[s.view.dataFrame.meta?.custom?.sortBy];E&&(w=175,E.type===H.PU.time&&(w+=25),t-=w),a.explain&&a.score&&(t-=100);let x=50;u&&i&&(x=0,o.push({id:"column-checkbox",width:x,Header:()=>{const{view:m}=s,y=u("*","*"),h=m.every(M=>u(M.kind,M.uid));return(0,e.jsx)(R.S,{indeterminate:!h&&y,checked:h,disabled:!s,onChange:M=>{if(y)c();else for(let v=0;v<m.length;v++){const P=m.get(v);i(P.kind,P.uid)}}})},Cell:m=>{const y=D.values[m.row.index],h=I?I.values[m.row.index]:"dashboard",M=u(h,y),v=y!=null,{key:P,...te}=m.cellProps;return(0,e.jsx)("div",{...te,className:n.cell,children:(0,e.jsx)(R.S,{disabled:!v,value:M&&v,onChange:ge=>{i(h,y)}})},P)},field:D}),t-=x),x=Math.max(t*.2,300),o.push({Cell:m=>{let y=(0,r.cx)(n.nameCellStyle),h=a.name.values[m.row.index];const M=a.isDeleted?.values[m.row.index];h?.length||(h=m.row.index>=s.view.dataFrame.length?"Loading...":"Missing title",y+=" "+n.missingTitleText);const{key:v,...P}=m.cellProps;return(0,e.jsx)("div",{className:n.cell,...P,children:s.isItemLoaded(m.row.index)?M?(0,e.jsx)("span",{className:y,children:h}):(0,e.jsx)("a",{href:m.userProps.href,onClick:m.userProps.onClick,className:y,title:h,children:h}):(0,e.jsx)(g.A,{width:200})},v)},id:"column-name",field:a.name,Header:()=>(0,e.jsx)("div",{children:(0,d.t)("search.results-table.name-header","Name")}),width:x}),t-=x,s.view.fields.permanentlyDeleteDate&&xe(s.view.fields.permanentlyDeleteDate)&&a.permanentlyDeleteDate?(x=Se,o.push(Ne(s,a.permanentlyDeleteDate,x,n)),t-=x):(x=Pe,o.push(Le(s,a.kind,a.panel_type,x,n)),t-=x),a.ds_uid&&j&&(x=Math.min(t/2.5,Ie),o.push(Me(a.ds_uid,x,n.typeIcon,n.datasourceItem,n.invalidDatasourceItem,j)),t-=x);const Y=!p||xe(s.view.fields.tags),_=s.view.dataFrame.meta?.custom;if(_?.locationInfo&&t>0&&(x=Y?Math.max(t/1.75,300):t,t-=x,o.push({Cell:m=>{const y=(a.location?.values[m.row.index]??"").split("/"),{key:h,...M}=m.cellProps;return(0,e.jsx)("div",{...M,className:n.cell,children:s.isItemLoaded(m.row.index)?(0,e.jsx)("div",{className:n.locationContainer,children:y.map(v=>{let P=_.locationInfo[v];return!P&&v==="general"&&(P={kind:"folder",url:"/dashboards",name:"Dashboards"}),P?(0,e.jsxs)("a",{href:P.url,className:n.locationItem,children:[(0,e.jsx)($.I,{name:(0,se.TM)(P.kind)}),(0,e.jsx)(k.E,{variant:"body",truncate:!0,children:P.name})]},v):(0,e.jsx)("span",{children:v},v)})}):(0,e.jsx)(g.A,{width:150})},h)},id:"column-location",field:a.location??a.url,Header:(0,d.t)("search.results-table.location-header","Location"),width:x})),t>0&&Y&&o.push(Te(s,a.tags,t,n,f)),E&&w){const m=E.display??(0,G.J)({field:E,theme:T.$.theme2});o.push({Header:(0,W.Ct)(E),Cell:y=>{const{key:h,...M}=y.cellProps;return(0,e.jsx)("div",{...M,className:n.cell,children:Re({sortField:E,getDisplay:m,index:y.row.index,kind:a.kind})},h)},id:"column-sort-field",field:E,width:w})}if(a.explain&&a.score){const m=a.score.values,y=h=>{K.A.publish(new q.S8({component:De,props:{name:a.name.values[h],explain:a.explain.values[h],frame:s.view.dataFrame,row:h}}))};o.push({Header:()=>(0,e.jsx)("div",{className:n.sortedHeader,children:"Score"}),Cell:h=>{const{key:M,...v}=h.cellProps;return(0,e.jsx)("div",{...v,className:(0,r.cx)(n.cell,n.explainItem),onClick:()=>y(h.row.index),children:m[h.row.index]},M)},id:"column-score-field",field:a.score,width:100})}return o};function xe(s){for(let t=0;t<s.values.length;t++)if(s.values[t]!=null)return!0;return!1}function Me(s,t,u,i,c,n){const f=(0,J.l)();return{id:"column-datasource",field:s,Header:(0,d.t)("search.results-table.datasource-header","Data source"),Cell:j=>{const p=s.values[j.row.index];if(!p?.length)return null;const{key:o,...a}=j.cellProps;return(0,e.jsx)("div",{...a,className:(0,r.cx)(i),children:p.map((D,I)=>{const w=f.getInstanceSettings(D),E=w?.meta?.info?.logos?.small;return E?(0,e.jsxs)("span",{onClick:x=>{x.stopPropagation(),x.preventDefault(),n(w.uid)},children:[(0,e.jsx)("img",{src:E,alt:"",width:14,height:14,title:w.type,className:u}),w.name]},I):(0,e.jsx)("span",{className:c,children:D},I)})},o)},width:t}}function Ne(s,t,u,i){return{id:"column-delete-age",field:t,width:u,Header:(0,d.t)("search.results-table.deleted-remaining-header","Time remaining"),Cell:c=>{const n=c.row.index,f=t.values[n],{key:j,...p}=c.cellProps;if(!f||!s.isItemLoaded(c.row.index))return(0,e.jsx)("div",{...p,className:(0,r.cx)(i.cell,i.typeCell),children:(0,e.jsx)(g.A,{width:100})},j);const o=Oe(new Date,f),D=!Object.values(o).some(I=>I>0)?(0,d.t)("search.results-table.deleted-less-than-1-min","< 1 min"):(0,F.a)(o,{style:"long"});return(0,e.jsx)("div",{...p,className:(0,r.cx)(i.cell,i.typeCell),children:(0,e.jsx)(U.m,{content:(0,F.Y)(f,{dateStyle:"medium",timeStyle:"short"}),children:(0,e.jsx)("span",{children:D})})},j)}}}function Le(s,t,u,i,c){return{id:"column-type",field:t??u,Header:(0,d.t)("search.results-table.type-header","Type"),Cell:n=>{const f=n.row.index,j=t?.values[f]??"dashboard";let p="apps",o="Dashboard";if(j)switch(o=j,o){case"dashboard":o=(0,d.t)("search.results-table.type-dashboard","Dashboard");break;case"folder":p="folder",o=(0,d.t)("search.results-table.type-folder","Folder");break;case"panel":p=`${ee.Ip.panel}`;const I=u.values[f];if(I){o=I;const w=T.$.panels[o];if(w?.name)o=w.name;else switch(I){case"row":o="Row",p="bars";break;case"singlestat":o="Singlestat";break;default:p="question-circle"}}break}const{key:a,...D}=n.cellProps;return(0,e.jsx)("div",{...D,className:(0,r.cx)(c.cell,c.typeCell),children:s.isItemLoaded(n.row.index)?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)($.I,{name:p,size:"sm",title:o,className:c.typeIcon}),o]}):(0,e.jsx)(g.A,{width:100})},a)},width:i}}function Te(s,t,u,i,c){return{Cell:n=>{const f=t.values[n.row.index],{key:j,...p}=n.cellProps;return(0,e.jsx)("div",{...p,className:i.cell,children:s.isItemLoaded(n.row.index)?(0,e.jsx)(e.Fragment,{children:f?(0,e.jsx)(L.L,{className:i.tagList,tags:f,onClick:c}):null}):(0,e.jsx)(L.L.Skeleton,{})},j)},id:"column-tags",field:t,Header:(0,d.t)("search.results-table.tags-header","Tags"),width:u}}function Re({kind:s,sortField:t,index:u,getDisplay:i}){const c=t.values[u];return["folder","panel"].includes(s.values[u])&&c===0?"-":(0,Z.cN)(i(c))}function Oe(s,t){let{years:u=0,months:i=0,days:c=0,hours:n=0,minutes:f=0}=(0,ce.F)({start:s,end:t});return u>0?{years:u}:i>0?{months:i}:c>0?{days:c}:n>0?{hours:n}:{minutes:f}}const ue=36,ve=C.memo(({response:s,width:t,height:u,selection:i,selectionToggle:c,clearSelection:n,onTagSelected:f,onDatasourceChange:j,onClickItem:p,keyboardEvents:o})=>{const a=(0,X.of)(Ae),D=(0,X.of)(be),I=(0,re.k)((0,X.$j)(),ne.qM.Sm),w=(0,C.useRef)(null),[E,x]=(0,C.useState)(null),me=(0,de.n)(o,0,s),Y=(0,C.useMemo)(()=>s?.view?.dataFrame.fields.length?Array(s.totalRows).fill(0):[],[s]);(0,C.useEffect)(()=>{w.current&&w.current.resetloadMoreItemsCache(),E&&E.scrollTo(0)},[Y,E]);const _=(0,C.useMemo)(()=>Ee(s,t,i,c,n,D,f,j,s.view?.length>=s.totalRows),[s,t,D,i,c,n,f,j]),m=(0,C.useMemo)(()=>({columns:_,data:Y}),[_,Y]),{getTableProps:y,getTableBodyProps:h,headerGroups:M,rows:v,prepareRow:P}=(0,N.useTable)(m,ie.A),te=(0,C.useCallback)(async(O,z)=>{await s.loadMoreItems(O,z);const A=i?.("*","*");if(!(!c||!i||!A))for(let V=O;V<s.view.length;V++){const B=s.view.get(V);i(B.kind,B.uid)||c(B.kind,B.uid)}},[s,i,c]),ge=(0,C.useCallback)(({index:O,style:z})=>{const A=v[O];P(A);const V=s.view.fields.url?.values[O];let B=a.rowContainer;O===me.y&&(B+=" "+a.selectedRow);const{key:ae,...He}=A.getRowProps({style:z});return(0,e.jsx)("div",{...He,className:B,children:A.cells.map(($e,pe)=>(0,e.jsx)(oe.n,{tableStyles:I,cell:$e,columnIndex:pe,columnCount:A.cells.length,userProps:{href:V,onClick:p},frame:s.view.dataFrame},pe))},ae)},[v,P,s.view.fields.url?.values,me,a,I,p,s.view.dataFrame]);return v.length?(0,e.jsxs)("div",{...y(),"aria-label":"Search results table",role:"table",children:[M.map(O=>{const{key:z,...A}=O.getHeaderGroupProps({style:{width:t}});return(0,e.jsx)("div",{...A,className:a.headerRow,children:O.headers.map(V=>{const{key:B,...ae}=V.getHeaderProps();return(0,e.jsx)("div",{...ae,role:"columnheader",className:a.headerCell,children:V.render("Header")},B)})},z)}),(0,e.jsx)("div",{...h(),children:(0,e.jsx)(b.A,{ref:w,isItemLoaded:s.isItemLoaded,itemCount:v.length,loadMoreItems:te,children:({onItemsRendered:O,ref:z})=>(0,e.jsx)(S.Y1,{ref:A=>{z(A),x(A)},onItemsRendered:O,height:u-ue,itemCount:v.length,itemSize:I.rowHeight,width:t,style:{overflow:"hidden auto"},children:ge})})})]}):(0,e.jsx)("div",{className:a.noData,children:"No data"})});ve.displayName="SearchResultsTable";const Ae=s=>{const t=s.colors.emphasize(s.colors.background.primary,.03);return{noData:(0,r.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
    `,headerCell:(0,r.css)`
      align-items: center;
      display: flex;
      overflo: hidden;
      padding: ${s.spacing(1)};
    `,headerRow:(0,r.css)`
      background-color: ${s.colors.background.secondary};
      display: flex;
      gap: ${s.spacing(1)};
      height: ${ue}px;
    `,selectedRow:(0,r.css)`
      background-color: ${t};
      box-shadow: inset 3px 0px ${s.colors.primary.border};
    `,rowContainer:(0,r.css)`
      display: flex;
      gap: ${s.spacing(1)};
      height: ${ue}px;
      label: row;
      &:hover {
        background-color: ${t};
      }

      &:not(:hover) div[role='cell'] {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
      }
    `}},be=s=>({cell:(0,r.css)({padding:s.spacing(1),overflow:"hidden",display:"flex",alignItems:"center"}),nameCellStyle:(0,r.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      user-select: text;
      white-space: nowrap;
    `,typeCell:(0,r.css)({gap:s.spacing(.5)}),typeIcon:(0,r.css)`
      fill: ${s.colors.text.secondary};
    `,datasourceItem:(0,r.css)`
      span {
        &:hover {
          color: ${s.colors.text.link};
        }
      }
    `,missingTitleText:(0,r.css)`
      color: ${s.colors.text.disabled};
      font-style: italic;
    `,invalidDatasourceItem:(0,r.css)`
      color: ${s.colors.error.main};
      text-decoration: line-through;
    `,locationContainer:(0,r.css)({display:"flex",flexWrap:"nowrap",gap:s.spacing(1),overflow:"hidden"}),locationItem:(0,r.css)`
      align-items: center;
      color: ${s.colors.text.secondary};
      display: flex;
      flex-wrap: nowrap;
      gap: 4px;
      overflow: hidden;
    `,explainItem:(0,r.css)`
      cursor: pointer;
    `,tagList:(0,r.css)`
      justify-content: flex-start;
      flex-wrap: nowrap;
    `})},1819:(he,Q,l)=>{l.d(Q,{e:()=>de});var e=l(74848),r=l(32196),C=l(28240),N=l(83195),S=l(14588),b=l(52622),ne=l(40845),X=l(72109),oe=l(61994),re=l(74007);function ie(g,H,G,W,Z){const T=g.fields,J=G!=null?T[G]:null,R=T.filter(d=>!d.config.custom?.hideFrom?.tooltip),$=R.find(d=>d.name==="traceID")||T[0],k=[];if(R.filter(d=>$===d).length>0&&k.push($),k.push(...R.filter(d=>$!==d)),k.length===0)return null;const U=[],L=[],K=new Set;for(const d of k){if(Z===b.$N.Single&&d!==J)continue;const F=d.values[H],ee=d.display?d.display(F):{text:`${F}`,numeric:+F};d.getLinks&&d.getLinks({calculatedValue:ee,valueRowIndex:H}).forEach(q=>{const se=`${q.title}/${q.href}`;K.has(se)||(L.push(q),K.add(se))}),U.push({name:(0,C.Ct)(d,g),value:F,valueString:(0,N.cN)(ee),highlight:d===J})}return W&&W!==b.xB.None&&U.sort((d,F)=>S.sortValues(W)(d.value,F.value)),{displayValues:U,links:L}}const de=({data:g,rowIndex:H,columnIndex:G,sortOrder:W,mode:Z,header:T,padding:J=0})=>{const R=(0,ne.of)(ce,J);if(!g||H==null)return null;const $=ie(g,H,G,W,Z);if($==null)return null;const{displayValues:k,links:U}=$;return T==="Exemplar"?(0,e.jsx)(re.i,{displayValues:k,links:U,header:T}):(0,e.jsxs)("div",{className:R.wrapper,children:[T&&(0,e.jsx)("div",{className:R.header,children:(0,e.jsx)("span",{className:R.title,children:T})}),(0,e.jsx)("table",{className:R.infoWrap,children:(0,e.jsxs)("tbody",{children:[k.map((L,K)=>(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:L.name}),(0,e.jsx)("td",{children:(0,oe.A)(L.valueString)})]},`${K}/${H}`)),U.map((L,K)=>(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{children:"Link"}),(0,e.jsx)("td",{colSpan:2,children:(0,e.jsx)(X.Y,{href:L.href,external:L.target==="_blank",weight:"medium",inline:!1,children:L.title})})]},K))]})})]})},ce=(g,H=0)=>({wrapper:(0,r.css)({padding:`${H}px`,background:g.components.tooltip.background,borderRadius:g.shape.borderRadius(2)}),header:(0,r.css)({background:g.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:g.spacing(1)}),title:(0,r.css)({fontWeight:g.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,r.css)({padding:g.spacing(1),background:"transparent",border:"none",th:{fontWeight:g.typography.fontWeightMedium,padding:g.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${g.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,r.css)({color:g.colors.text.link})})}}]);

//# sourceMappingURL=6359.4b3bfe33c54801ccbe95.js.map