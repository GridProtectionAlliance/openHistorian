{"version":3,"sources":["webpack:///./public/app/features/alerting/AlertRuleList.tsx","webpack:///./public/app/features/alerting/AlertRuleItem.tsx","webpack:///./public/app/features/alerting/state/selectors.ts"],"names":["AlertRuleList","_super","_this","apply","this","arguments","stateFilters","text","value","onStateFilterChanged","evt","props","updateLocation","query","state","target","onOpenHowTo","app_core_app_events__WEBPACK_IMPORTED_MODULE_6__","emit","src","modalClass","model","onSearchQueryChange","setSearchQuery","onTogglePause","rule","togglePauseAlertRule","id","paused","alertStateFilterOption","_a","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","key","tslib__WEBPACK_IMPORTED_MODULE_0__","prototype","componentDidMount","fetchRules","componentDidUpdate","prevProps","stateFilter","getAlertRulesAsync","getStateFilter","sent","toString","render","navModel","alertRules","search","isLoading","app_core_components_Page_Page__WEBPACK_IMPORTED_MODULE_4__","Contents","className","app_core_components_FilterInput_FilterInput__WEBPACK_IMPORTED_MODULE_11__","labelClassName","inputClassName","placeholder","onChange","map","onClick","_AlertRuleItem__WEBPACK_IMPORTED_MODULE_5__","react__WEBPACK_IMPORTED_MODULE_1__","mapDispatchToProps","app_core_actions__WEBPACK_IMPORTED_MODULE_7__","_state_actions__WEBPACK_IMPORTED_MODULE_9__","__webpack_exports__","Object","react_hot_loader__WEBPACK_IMPORTED_MODULE_2__","module","react_redux__WEBPACK_IMPORTED_MODULE_3__","app_core_selectors_navModel__WEBPACK_IMPORTED_MODULE_8__","navIndex","_state_selectors__WEBPACK_IMPORTED_MODULE_10__","location","AlertRuleItem","renderText","react_highlight_words__WEBPACK_IMPORTED_MODULE_2___default","highlightClassName","textToHighlight","searchWords","iconClassName","classnames__WEBPACK_IMPORTED_MODULE_3___default","fa","fa-play","fa-pause","ruleUrl","url","panelId","stateClass","stateIcon","href","name","stateText","stateAge","info","title","__webpack_require__","d","getSearchQuery","getAlertRuleItems","searchQuery","regex","RegExp","items","filter","item","test"],"mappings":"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","file":"AlertRuleList.3932bda029d2299a9d96.js","sourcesContent":["import React, { PureComponent } from 'react';\nimport { hot } from 'react-hot-loader';\nimport { connect } from 'react-redux';\nimport Page from 'app/core/components/Page/Page';\nimport AlertRuleItem from './AlertRuleItem';\nimport appEvents from 'app/core/app_events';\nimport { updateLocation } from 'app/core/actions';\nimport { getNavModel } from 'app/core/selectors/navModel';\nimport { StoreState, AlertRule } from 'app/types';\nimport { getAlertRulesAsync, setSearchQuery, togglePauseAlertRule } from './state/actions';\nimport { getAlertRuleItems, getSearchQuery } from './state/selectors';\nimport { FilterInput } from 'app/core/components/FilterInput/FilterInput';\nimport { NavModel } from '@grafana/data';\n\nexport interface Props {\n  navModel: NavModel;\n  alertRules: AlertRule[];\n  updateLocation: typeof updateLocation;\n  getAlertRulesAsync: typeof getAlertRulesAsync;\n  setSearchQuery: typeof setSearchQuery;\n  togglePauseAlertRule: typeof togglePauseAlertRule;\n  stateFilter: string;\n  search: string;\n  isLoading: boolean;\n}\n\nexport class AlertRuleList extends PureComponent<Props, any> {\n  stateFilters = [\n    { text: 'All', value: 'all' },\n    { text: 'OK', value: 'ok' },\n    { text: 'Not OK', value: 'not_ok' },\n    { text: 'Alerting', value: 'alerting' },\n    { text: 'No Data', value: 'no_data' },\n    { text: 'Paused', value: 'paused' },\n    { text: 'Pending', value: 'pending' },\n  ];\n\n  componentDidMount() {\n    this.fetchRules();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (prevProps.stateFilter !== this.props.stateFilter) {\n      this.fetchRules();\n    }\n  }\n\n  async fetchRules() {\n    await this.props.getAlertRulesAsync({ state: this.getStateFilter() });\n  }\n\n  getStateFilter(): string {\n    const { stateFilter } = this.props;\n    if (stateFilter) {\n      return stateFilter.toString();\n    }\n    return 'all';\n  }\n\n  onStateFilterChanged = (evt: React.ChangeEvent<HTMLSelectElement>) => {\n    this.props.updateLocation({\n      query: { state: evt.target.value },\n    });\n  };\n\n  onOpenHowTo = () => {\n    appEvents.emit('show-modal', {\n      src: 'public/app/features/alerting/partials/alert_howto.html',\n      modalClass: 'confirm-modal',\n      model: {},\n    });\n  };\n\n  onSearchQueryChange = (value: string) => {\n    this.props.setSearchQuery(value);\n  };\n\n  onTogglePause = (rule: AlertRule) => {\n    this.props.togglePauseAlertRule(rule.id, { paused: rule.state !== 'paused' });\n  };\n\n  alertStateFilterOption = ({ text, value }: { text: string; value: string }) => {\n    return (\n      <option key={value} value={value}>\n        {text}\n      </option>\n    );\n  };\n\n  render() {\n    const { navModel, alertRules, search, isLoading } = this.props;\n\n    return (\n      <Page navModel={navModel}>\n        <Page.Contents isLoading={isLoading}>\n          <div className=\"page-action-bar\">\n            <div className=\"gf-form gf-form--grow\">\n              <FilterInput\n                labelClassName=\"gf-form--has-input-icon gf-form--grow\"\n                inputClassName=\"gf-form-input\"\n                placeholder=\"Search alerts\"\n                value={search}\n                onChange={this.onSearchQueryChange}\n              />\n            </div>\n            <div className=\"gf-form\">\n              <label className=\"gf-form-label\">States</label>\n\n              <div className=\"gf-form-select-wrapper width-13\">\n                <select className=\"gf-form-input\" onChange={this.onStateFilterChanged} value={this.getStateFilter()}>\n                  {this.stateFilters.map(this.alertStateFilterOption)}\n                </select>\n              </div>\n            </div>\n            <div className=\"page-action-bar__spacer\" />\n            <a className=\"btn btn-secondary\" onClick={this.onOpenHowTo}>\n              How to add an alert\n            </a>\n          </div>\n          <section>\n            <ol className=\"alert-rule-list\">\n              {alertRules.map(rule => (\n                <AlertRuleItem\n                  rule={rule}\n                  key={rule.id}\n                  search={search}\n                  onTogglePause={() => this.onTogglePause(rule)}\n                />\n              ))}\n            </ol>\n          </section>\n        </Page.Contents>\n      </Page>\n    );\n  }\n}\n\nconst mapStateToProps = (state: StoreState) => ({\n  navModel: getNavModel(state.navIndex, 'alert-list'),\n  alertRules: getAlertRuleItems(state.alertRules),\n  stateFilter: state.location.query.state,\n  search: getSearchQuery(state.alertRules),\n  isLoading: state.alertRules.isLoading,\n});\n\nconst mapDispatchToProps = {\n  updateLocation,\n  getAlertRulesAsync,\n  setSearchQuery,\n  togglePauseAlertRule,\n};\n\nexport default hot(module)(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(AlertRuleList)\n);\n","import React, { PureComponent } from 'react';\n// @ts-ignore\nimport Highlighter from 'react-highlight-words';\nimport classNames from 'classnames';\nimport { AlertRule } from '../../types';\n\nexport interface Props {\n  rule: AlertRule;\n  search: string;\n  onTogglePause: () => void;\n}\n\nclass AlertRuleItem extends PureComponent<Props> {\n  renderText(text: string) {\n    return (\n      <Highlighter\n        highlightClassName=\"highlight-search-match\"\n        textToHighlight={text}\n        searchWords={[this.props.search]}\n      />\n    );\n  }\n\n  render() {\n    const { rule, onTogglePause } = this.props;\n\n    const iconClassName = classNames({\n      fa: true,\n      'fa-play': rule.state === 'paused',\n      'fa-pause': rule.state !== 'paused',\n    });\n\n    const ruleUrl = `${rule.url}?panelId=${rule.panelId}&fullscreen&edit&tab=alert`;\n\n    return (\n      <li className=\"alert-rule-item\">\n        <span className={`alert-rule-item__icon ${rule.stateClass}`}>\n          <i className={rule.stateIcon} />\n        </span>\n        <div className=\"alert-rule-item__body\">\n          <div className=\"alert-rule-item__header\">\n            <div className=\"alert-rule-item__name\">\n              <a href={ruleUrl}>{this.renderText(rule.name)}</a>\n            </div>\n            <div className=\"alert-rule-item__text\">\n              <span className={`${rule.stateClass}`}>{this.renderText(rule.stateText)}</span>\n              <span className=\"alert-rule-item__time\"> for {rule.stateAge}</span>\n            </div>\n          </div>\n          {rule.info && <div className=\"small muted alert-rule-item__info\">{this.renderText(rule.info)}</div>}\n        </div>\n\n        <div className=\"alert-rule-item__actions\">\n          <button\n            className=\"btn btn-small btn-inverse alert-list__btn width-2\"\n            title=\"Pausing an alert rule prevents it from executing\"\n            onClick={onTogglePause}\n          >\n            <i className={iconClassName} />\n          </button>\n          <a className=\"btn btn-small btn-inverse alert-list__btn width-2\" href={ruleUrl} title=\"Edit alert rule\">\n            <i className=\"gicon gicon-cog\" />\n          </a>\n        </div>\n      </li>\n    );\n  }\n}\n\nexport default AlertRuleItem;\n","import { AlertRulesState } from 'app/types';\n\nexport const getSearchQuery = (state: AlertRulesState) => state.searchQuery;\n\nexport const getAlertRuleItems = (state: AlertRulesState) => {\n  const regex = new RegExp(state.searchQuery, 'i');\n\n  return state.items.filter(item => {\n    return regex.test(item.name) || regex.test(item.stateText) || regex.test(item.info);\n  });\n};\n"],"sourceRoot":""}