"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[9218],{59507:(e,t,s)=>{s.d(t,{Z:()=>n});var l=s(68404),a=s(3490),i=s(45916);class n extends l.PureComponent{render(){const{searchQuery:e,linkButton:t,setSearchQuery:s,target:l,placeholder:n="Search by name or type"}=this.props,r={href:null==t?void 0:t.href,disabled:null==t?void 0:t.disabled};return l&&(r.target=l),(0,i.jsxs)("div",{className:"page-action-bar",children:[(0,i.jsx)("div",{className:"gf-form gf-form--grow",children:(0,i.jsx)(a.FilterInput,{value:e,onChange:s,placeholder:n})}),t&&(0,i.jsx)(a.LinkButton,Object.assign({},r,{children:t.title}))]})}}},11168:(e,t,s)=>{s.r(t),s.d(t,{PlaylistPage:()=>C,default:()=>T});var l=s(68404),a=s(93368),i=s(3490),n=s(69371),r=s(59507),o=s(61959),d=s(28436),c=s(36636),u=s(45916);const p=()=>{const e=(0,i.useStyles2)(y);return(0,u.jsx)("div",{className:e.noResult,children:"No playlist found!"})},y=e=>({noResult:c.css`
      padding: ${e.spacing(2)};
      background: ${e.colors.secondary.main};
      font-style: italic;
      margin-top: ${e.spacing(2)};
    `});var h=s(16461),g=s(43215),x=s(58648);const v=e=>{let{playlistUid:t,onDismiss:s}=e;const[a,n]=(0,l.useState)(!1),[r,o]=(0,l.useState)(!1),d={};a&&(d.kiosk=a),r&&(d.autofitpanels=!0);const c=g.urlUtil.renderUrl(`${(0,x.OS)()}/play/${t}`,d);return(0,u.jsx)(i.Modal,{isOpen:!0,title:"Share playlist",onDismiss:s,children:(0,u.jsxs)(i.FieldSet,{children:[(0,u.jsx)(i.Field,{label:"Mode",children:(0,u.jsx)(i.RadioButtonGroup,{value:a,options:[{label:"Normal",value:!1},{label:"TV",value:"tv"},{label:"Kiosk",value:!0}],onChange:n})}),(0,u.jsx)(i.Field,{children:(0,u.jsx)(i.Checkbox,{label:"Autofit",description:"Panel heights will be adjusted to fit screen size",name:"autofix",value:r,onChange:e=>o(e.currentTarget.checked)})}),(0,u.jsx)(i.Field,{label:"Link URL",children:(0,u.jsx)(i.Input,{id:"link-url-input",value:c,readOnly:!0,addonAfter:(0,u.jsx)(i.ClipboardButton,{icon:"copy",variant:"primary",getText:()=>c,children:"Copy"})})})]})})},j=e=>{let{playlists:t,setStartPlaylist:s,setPlaylistToDelete:l}=e;const a=(0,i.useStyles2)(f);return(0,u.jsx)("ul",{className:a.list,children:t.map((e=>(0,u.jsx)("li",{className:a.listItem,children:(0,u.jsxs)(i.Card,{children:[(0,u.jsxs)(i.Card.Heading,{children:[e.name,(0,u.jsx)(i.ModalsController,{children:t=>{let{showModal:s,hideModal:l}=t;return(0,u.jsx)(h.u,{tooltip:"Share playlist",icon:"share-alt",iconSize:"lg",onClick:()=>{s(v,{playlistUid:e.uid,onDismiss:l})}})}},"button-share")]}),(0,u.jsxs)(i.Card.Actions,{children:[(0,u.jsx)(i.Button,{variant:"secondary",icon:"play",onClick:()=>s(e),children:"Start playlist"}),o.Vt.isEditor&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.LinkButton,{variant:"secondary",href:`/playlists/edit/${e.uid}`,icon:"cog",children:"Edit playlist"},"edit"),(0,u.jsx)(i.Button,{disabled:!1,onClick:()=>l({id:e.id,uid:e.uid,name:e.name}),icon:"trash-alt",variant:"destructive",children:"Delete playlist"})]})]})]})},e.uid)))})};function f(e){return{list:(0,c.css)({display:"grid"}),listItem:(0,c.css)({listStyle:"none"})}}var m=s(90923);const b=e=>{let{playlist:t,onDismiss:s}=e;const[a,n]=(0,l.useState)(!1),[r,o]=(0,l.useState)(!1);return(0,u.jsxs)(i.Modal,{isOpen:!0,icon:"play",title:"Start playlist",onDismiss:s,children:[(0,u.jsxs)(i.FieldSet,{children:[(0,u.jsx)(i.Field,{label:"Mode",children:(0,u.jsx)(i.RadioButtonGroup,{value:a,options:[{label:"Normal",value:!1},{label:"TV",value:"tv"},{label:"Kiosk",value:!0}],onChange:n})}),(0,u.jsx)(i.Checkbox,{label:"Autofit",description:"Panel heights will be adjusted to fit screen size",name:"autofix",value:r,onChange:e=>o(e.currentTarget.checked)})]}),(0,u.jsx)(i.Modal.ButtonRow,{children:(0,u.jsxs)(i.Button,{variant:"primary",onClick:()=>{const e={};a&&(e.kiosk=a),r&&(e.autofitpanels=!0),m.locationService.push(g.urlUtil.renderUrl(`/playlists/play/${t.uid}`,e))},children:["Start ",t.name]})})]})};var k,S=s(20607);const C=()=>{const[e,t]=(0,l.useState)(""),[s,c]=(0,l.useState)(e),[y,h]=(0,l.useState)(!1),[g,x]=(0,l.useState)(),[v,f]=(0,l.useState)(),[m,C]=(0,l.useState)(0),[T,w]=(0,l.useState)([]);(0,a.Z)((async()=>{const t=await(0,S.Dv)(e);y||h(!0),w(t),c(e)}),350,[m,e]);const B=T&&T.length>0,D=(0,u.jsx)(d.Z,{title:"There are no playlists created yet",buttonIcon:"plus",buttonLink:"playlists/new",buttonTitle:"Create Playlist",buttonDisabled:!o.Vt.isEditor,proTip:"You can use playlists to cycle dashboards on TVs without user control",proTipLink:"http://docs.grafana.org/reference/playlist/",proTipLinkTitle:"Learn more",proTipTarget:"_blank"}),$=T.length>0||e.length>0||s.length>0;return(0,u.jsx)(n.T,{navId:"dashboards/playlists",children:(0,u.jsxs)(n.T.Contents,{isLoading:!y,children:[$&&(0,u.jsx)(r.Z,{searchQuery:e,linkButton:o.Vt.isEditor&&{title:"New playlist",href:"/playlists/new"},setSearchQuery:t}),!B&&e?k||(k=(0,u.jsx)(p,{})):(0,u.jsx)(j,{playlists:T,setStartPlaylist:x,setPlaylistToDelete:f}),!$&&D,v&&(0,u.jsx)(i.ConfirmModal,{title:v.name,confirmText:"Delete",body:`Are you sure you want to delete '${v.name}' playlist?`,onConfirm:()=>{v&&(0,S.l8)(v.uid).finally((()=>{C(m+1),f(void 0)}))},isOpen:Boolean(v),onDismiss:()=>f(void 0)}),g&&(0,u.jsx)(b,{playlist:g,onDismiss:()=>x(void 0)})]})})},T=C},20607:(e,t,s)=>{s.d(t,{A5:()=>c,CE:()=>o,Dv:()=>u,cg:()=>r,l8:()=>d});var l=s(90923),a=s(36537),i=s(58257),n=s(56340);async function r(e){await p((()=>(0,l.getBackendSrv)().post("/api/playlists",e)))}async function o(e,t){await p((()=>(0,l.getBackendSrv)().put(`/api/playlists/${e}`,t)))}async function d(e){await p((()=>(0,l.getBackendSrv)().delete(`/api/playlists/${e}`)),"Playlist deleted")}async function c(e){return await(0,l.getBackendSrv)().get(`/api/playlists/${e}`)}async function u(e){return await(0,l.getBackendSrv)().get("/api/playlists/",{query:e})}async function p(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Playlist saved";try{await e(),(0,n.WI)((0,a.$l)((0,i.AT)(t)))}catch(e){e instanceof Error&&(0,n.WI)((0,a.$l)((0,i.t_)("Unable to save playlist",e)))}}}}]);
//# sourceMappingURL=PlaylistPage.b2cd095ca26265355c76.js.map