{"version":3,"file":"StorageFolderPage.ef7e0b25401041e37d19.js","mappings":"mSAaO,SAASA,EAAkBC,GAAc,MAC9C,MAAMC,EAAI,UAAGD,EAAME,MAAMC,OAAOF,YAAtB,QAA8B,GAClCG,GAAUC,EAAAA,EAAAA,IAAS,KAChBC,EAAAA,EAAAA,KAAoBC,KAAKN,IAC/B,CAACA,IAEEO,EAAYP,EAAKQ,OAAS,EAAK,KAAIR,KAAU,KAC7CS,EAAUC,EAAmBV,GA2B7BW,EA8BC,CAAEC,KAAM,CAAEC,KAAM,MAAQC,KAAM,CAAED,KAAM,UAAWE,IAAK,OA5B7D,OACE,UAAC,IAAD,CAAMJ,SAAUA,EAAUF,QAASA,EAAnC,WACIO,EAAAA,OAAAA,eAAAA,SAAD,OACC,0BACE,SAAC,EAAAC,MAAD,CAAOC,MAAM,mCAAb,kEA/Bc,MACpB,GAAIf,EAAQgB,MAAO,CAEjB,OADchB,EAAQgB,MAAMC,OAAO,GAAGC,OAAOC,UAChCC,KAAKC,IAChB,IAAIC,EAAOD,EACX,MAAME,EAAWD,EAAKE,QAAQ,KAAO,EAC/BC,GAAUF,GAAYD,EAAKI,SAAS,SACpCd,EAAO,GAAER,IAAYkB,IAE3B,OACE,UAAC,EAAAK,KAAD,CAAiBC,KAAML,GAAYE,EAASb,OAAMiB,EAAlD,WACE,SAAC,EAAAF,KAAA,QAAD,UAAeL,KACf,SAAC,EAAAK,KAAA,OAAD,WACE,SAAC,EAAAG,KAAD,CAAMR,KAAMC,EAAW,SAAWE,EAAS,UAAY,WAAYM,KAAK,WAHjET,MASjB,OAAItB,EAAQgC,QACH,IAAP,GAAO,SAAC,EAAAC,QAAD,KAEF,IAAP,GAAO,iCAYJC,MAKA,SAAS3B,EAAmBV,GACjC,MAAMsC,EAAQtC,EAAKuC,MAAM,KACzB,IAEIC,EAFAC,EAA2B,GAC3B1B,EAAM,IAGV,IAAK,IAAI2B,EAAI,EAAGA,EAAIJ,EAAM9B,OAAQkC,IAChC3B,GAAQ,IAAGuB,EAAMI,KACjBD,EAASE,KAAK,CAAE9B,KAAMyB,EAAMI,GAAI3B,IAAAA,EAAK6B,WAAYJ,IACjDA,EAAcC,EAASA,EAASjC,OAAS,GAG3C,OAAOgC,EAGF,SAASK,IACd,MAAO,CAAEjC,KAAM,CAAEC,KAAM,MAAQC,KAAM,CAAED,KAAM,UAAWE,IAAK,OAG/D","sources":["webpack://grafana/./public/app/features/storage/StorageFolderPage.tsx"],"sourcesContent":["import React from 'react';\nimport { useAsync } from 'react-use';\n\nimport { DataFrame, NavModel, NavModelItem } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Alert, Card, Icon, Spinner } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\nimport { GrafanaRouteComponentProps } from 'app/core/navigation/types';\n\nimport { getGrafanaStorage } from './storage';\n\nexport interface Props extends GrafanaRouteComponentProps<{ slug: string }> {}\n\nexport function StorageFolderPage(props: Props) {\n  const slug = props.match.params.slug ?? '';\n  const listing = useAsync((): Promise<DataFrame | undefined> => {\n    return getGrafanaStorage().list(slug);\n  }, [slug]);\n\n  const childRoot = slug.length > 0 ? `g/${slug}/` : 'g/';\n  const pageNav = getPageNavFromSlug(slug);\n\n  const renderListing = () => {\n    if (listing.value) {\n      const names = listing.value.fields[0].values.toArray();\n      return names.map((item: string) => {\n        let name = item;\n        const isFolder = name.indexOf('.') < 0;\n        const isDash = !isFolder && name.endsWith('.json');\n        const url = `${childRoot}${name}`;\n\n        return (\n          <Card key={name} href={isFolder || isDash ? url : undefined}>\n            <Card.Heading>{name}</Card.Heading>\n            <Card.Figure>\n              <Icon name={isFolder ? 'folder' : isDash ? 'gf-grid' : 'file-alt'} size=\"sm\" />\n            </Card.Figure>\n          </Card>\n        );\n      });\n    }\n    if (listing.loading) {\n      return <Spinner />;\n    }\n    return <div>?</div>;\n  };\n\n  const navModel = getRootContentNavModel();\n\n  return (\n    <Page navModel={navModel} pageNav={pageNav}>\n      {!config.featureToggles.topnav && (\n        <div>\n          <Alert title=\"Enable the topnav feature toggle\">This page is designed assuming topnav is enabled</Alert>\n        </div>\n      )}\n      {renderListing()}\n    </Page>\n  );\n}\n\nexport function getPageNavFromSlug(slug: string) {\n  const parts = slug.split('/');\n  let pageNavs: NavModelItem[] = [];\n  let url = 'g';\n  let lastPageNav: NavModelItem | undefined;\n\n  for (let i = 0; i < parts.length; i++) {\n    url += `/${parts[i]}`;\n    pageNavs.push({ text: parts[i], url, parentItem: lastPageNav });\n    lastPageNav = pageNavs[pageNavs.length - 1];\n  }\n\n  return lastPageNav;\n}\n\nexport function getRootContentNavModel(): NavModel {\n  return { main: { text: 'C:' }, node: { text: 'Content', url: '/g' } };\n}\n\nexport default StorageFolderPage;\n"],"names":["StorageFolderPage","props","slug","match","params","listing","useAsync","getGrafanaStorage","list","childRoot","length","pageNav","getPageNavFromSlug","navModel","main","text","node","url","config","Alert","title","value","fields","values","toArray","map","item","name","isFolder","indexOf","isDash","endsWith","Card","href","undefined","Icon","size","loading","Spinner","renderListing","parts","split","lastPageNav","pageNavs","i","push","parentItem","getRootContentNavModel"],"sourceRoot":""}