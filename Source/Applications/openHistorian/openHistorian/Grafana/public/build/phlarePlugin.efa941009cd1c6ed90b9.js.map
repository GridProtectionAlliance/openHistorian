{"version":3,"file":"phlarePlugin.efa941009cd1c6ed90b9.js","mappings":"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","sources":["webpack://grafana/./public/app/plugins/datasource/phlare/ConfigEditor.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/dataquery.gen.ts","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/Stack.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/EditorRow.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/EditorRows.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/phlareql/index.ts","webpack://grafana/./public/app/plugins/datasource/phlare/phlareql/phlareql.ts","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/autocomplete.ts","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/LabelsEditor.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/EditorField.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/QueryOptions.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/QueryEditor/QueryEditor.tsx","webpack://grafana/./public/app/plugins/datasource/phlare/datasource.ts","webpack://grafana/./public/app/plugins/datasource/phlare/module.ts","webpack://grafana/./.yarn/__virtual__/react-use-virtual-720cbd4f86/3/opt/drone/yarncache/react-use-npm-17.4.0-0ef4521544-0889da919b.zip/node_modules/react-use/esm/useLatest.js"],"sourcesContent":["import React from 'react';\n\nimport { DataSourcePluginOptionsEditorProps } from '@grafana/data';\nimport {\n  DataSourceHttpSettings,\n  EventsWithValidation,\n  LegacyForms,\n  regexValidation,\n  SecureSocksProxySettings,\n} from '@grafana/ui';\nimport { config } from 'app/core/config';\n\nimport { PhlareDataSourceOptions } from './types';\n\ninterface Props extends DataSourcePluginOptionsEditorProps<PhlareDataSourceOptions> {}\n\nexport const ConfigEditor = (props: Props) => {\n  const { options, onOptionsChange } = props;\n\n  return (\n    <>\n      <DataSourceHttpSettings\n        defaultUrl={'http://localhost:4100'}\n        dataSourceConfig={options}\n        showAccessOptions={false}\n        onChange={onOptionsChange}\n      />\n\n      {config.featureToggles.secureSocksDatasourceProxy && (\n        <SecureSocksProxySettings options={options} onOptionsChange={onOptionsChange} />\n      )}\n      <h3 className=\"page-heading\">Querying</h3>\n      <div className=\"gf-form-group\">\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <LegacyForms.FormField\n              label=\"Minimal step\"\n              labelWidth={13}\n              inputEl={\n                <LegacyForms.Input\n                  className=\"width-6\"\n                  value={options.jsonData.minStep}\n                  spellCheck={false}\n                  placeholder=\"15s\"\n                  onChange={(event) => {\n                    onOptionsChange({\n                      ...options,\n                      jsonData: {\n                        ...options.jsonData,\n                        minStep: event.currentTarget.value,\n                      },\n                    });\n                  }}\n                  validationEvents={{\n                    [EventsWithValidation.onBlur]: [\n                      regexValidation(\n                        /^$|^\\d+(ms|[Mwdhmsy])$/,\n                        'Value is not valid, you can use number with time unit specifier: y, M, w, d, h, m, s'\n                      ),\n                    ],\n                  }}\n                />\n              }\n              tooltip=\"Minimal step used for metric query. Should be the same or higher as the scrape interval setting in the Phlare database.\"\n            />\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTSTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as common from '@grafana/schema';\n\nexport const DataQueryModelVersion = Object.freeze([0, 0]);\n\nexport type PhlareQueryType = ('metrics' | 'profile' | 'both');\n\nexport const defaultPhlareQueryType: PhlareQueryType = 'both';\n\nexport interface Phlare extends common.DataQuery {\n  /**\n   * Allows to group the results.\n   */\n  groupBy: Array<string>;\n  /**\n   * Specifies the query label selectors.\n   */\n  labelSelector: string;\n  /**\n   * Specifies the type of profile to query.\n   */\n  profileTypeId: string;\n}\n\nexport const defaultPhlare: Partial<Phlare> = {\n  groupBy: [],\n  labelSelector: '{}',\n};\n","import { css } from '@emotion/css';\nimport React, { CSSProperties, useCallback } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\ninterface StackProps {\n  direction?: CSSProperties['flexDirection'];\n  alignItems?: CSSProperties['alignItems'];\n  wrap?: boolean;\n  gap?: number;\n  flexGrow?: CSSProperties['flexGrow'];\n  children: React.ReactNode;\n}\n\nexport function Stack(props: StackProps) {\n  const styles = useStyles2(useCallback((theme) => getStyles(theme, props), [props]));\n  return <div className={styles.root}>{props.children}</div>;\n}\n\nconst getStyles = (theme: GrafanaTheme2, props: StackProps) => ({\n  root: css({\n    display: 'flex',\n    flexDirection: props.direction ?? 'row',\n    flexWrap: props.wrap ?? true ? 'wrap' : undefined,\n    alignItems: props.alignItems,\n    gap: theme.spacing(props.gap ?? 2),\n    flexGrow: props.flexGrow,\n  }),\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { Stack } from './Stack';\n\ninterface EditorRowProps {\n  children: React.ReactNode;\n  stackProps?: Partial<React.ComponentProps<typeof Stack>>;\n}\n\nexport const EditorRow = ({ children, stackProps }: EditorRowProps) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.root}>\n      <Stack gap={2} {...stackProps}>\n        {children}\n      </Stack>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    root: css({\n      padding: theme.spacing(1),\n      backgroundColor: theme.colors.background.secondary,\n      borderRadius: theme.shape.borderRadius(1),\n    }),\n  };\n};\n","import React from 'react';\n\nimport { Stack } from './Stack';\n\ninterface EditorRowsProps {\n  children: React.ReactNode;\n}\n\nexport const EditorRows = ({ children }: EditorRowsProps) => {\n  return (\n    <Stack gap={0.5} direction=\"column\">\n      {children}\n    </Stack>\n  );\n};\n","import { language, languageConfiguration } from './phlareql';\n\nexport const languageDefinition = {\n  id: 'phlareql',\n  extensions: ['.phlareql'],\n  aliases: ['phlare', 'phlareql'],\n  mimetypes: [],\n  def: {\n    language,\n    languageConfiguration,\n  },\n};\n","import type { languages } from 'monaco-editor';\n\nexport const languageConfiguration: languages.LanguageConfiguration = {\n  // the default separators except `@$`\n  wordPattern: /(-?\\d*\\.\\d\\w*)|([^`~!#%^&*()\\-=+\\[{\\]}\\\\|;:'\",.<>\\/?\\s]+)/g,\n  brackets: [['{', '}']],\n  autoClosingPairs: [\n    { open: '{', close: '}' },\n    { open: '\"', close: '\"' },\n    { open: \"'\", close: \"'\" },\n  ],\n  surroundingPairs: [\n    { open: '{', close: '}' },\n    { open: '\"', close: '\"' },\n    { open: \"'\", close: \"'\" },\n  ],\n  folding: {},\n};\n\nexport const language: languages.IMonarchLanguage = {\n  ignoreCase: false,\n  defaultToken: '',\n  tokenPostfix: '.phlareql',\n\n  keywords: [],\n  operators: [],\n\n  // we include these common regular expressions\n  symbols: /[=><!~?:&|+\\-*\\/^%]+/,\n  escapes: /\\\\(?:[abfnrtv\\\\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,\n  digits: /\\d+(_+\\d+)*/,\n  octaldigits: /[0-7]+(_+[0-7]+)*/,\n  binarydigits: /[0-1]+(_+[0-1]+)*/,\n  hexdigits: /[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,\n  integersuffix: /(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,\n  floatsuffix: /[fFlL]?/,\n\n  tokenizer: {\n    root: [\n      // labels\n      [/[a-z_]\\w*(?=\\s*(=|!=|=~|!~))/, 'tag'],\n\n      // strings\n      [/\"([^\"\\\\]|\\\\.)*$/, 'string.invalid'], // non-teminated string\n      [/'([^'\\\\]|\\\\.)*$/, 'string.invalid'], // non-teminated string\n      [/\"/, 'string', '@string_double'],\n      [/'/, 'string', '@string_single'],\n\n      // whitespace\n      { include: '@whitespace' },\n\n      // delimiters and operators\n      [/[{}()\\[\\]]/, '@brackets'],\n      [/[<>](?!@symbols)/, '@brackets'],\n      [\n        /@symbols/,\n        {\n          cases: {\n            '@operators': 'delimiter',\n            '@default': '',\n          },\n        },\n      ],\n\n      // numbers\n      [/\\d+/, 'number'],\n      [/\\d*\\d+[eE]([\\-+]?\\d+)?(@floatsuffix)/, 'number.float'],\n      [/\\d*\\.\\d+([eE][\\-+]?\\d+)?(@floatsuffix)/, 'number.float'],\n      [/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/, 'number.hex'],\n      [/0[0-7']*[0-7](@integersuffix)/, 'number.octal'],\n      [/0[bB][0-1']*[0-1](@integersuffix)/, 'number.binary'],\n      [/\\d[\\d']*\\d(@integersuffix)/, 'number'],\n      [/\\d(@integersuffix)/, 'number'],\n    ],\n\n    string_double: [\n      [/[^\\\\\"]+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/\"/, 'string', '@pop'],\n    ],\n\n    string_single: [\n      [/[^\\\\']+/, 'string'],\n      [/@escapes/, 'string.escape'],\n      [/\\\\./, 'string.escape.invalid'],\n      [/'/, 'string', '@pop'],\n    ],\n\n    clauses: [\n      [/[^(,)]/, 'tag'],\n      [/\\)/, 'identifier', '@pop'],\n    ],\n\n    whitespace: [[/[ \\t\\r\\n]+/, 'white']],\n  },\n};\n","import { monacoTypes, Monaco } from '@grafana/ui';\n\nimport { SeriesMessage } from '../types';\n\n/**\n * Class that implements CompletionItemProvider interface and allows us to provide suggestion for the Monaco\n * autocomplete system.\n *\n * At this moment we just pass it all the labels/values we get from Phlare backend later on we may do something a bit\n * smarter if there will be lots of labels.\n */\nexport class CompletionProvider implements monacoTypes.languages.CompletionItemProvider {\n  triggerCharacters = ['{', ',', '[', '(', '=', '~', ' ', '\"'];\n\n  // We set these directly and ae required for the provider to function.\n  monaco: Monaco | undefined;\n  editor: monacoTypes.editor.IStandaloneCodeEditor | undefined;\n\n  private labels: { [label: string]: Set<string> } = {};\n\n  provideCompletionItems(\n    model: monacoTypes.editor.ITextModel,\n    position: monacoTypes.Position\n  ): monacoTypes.languages.ProviderResult<monacoTypes.languages.CompletionList> {\n    // Should not happen, this should not be called before it is initialized\n    if (!(this.monaco && this.editor)) {\n      throw new Error('provideCompletionItems called before CompletionProvider was initialized');\n    }\n\n    // if the model-id does not match, then this call is from a different editor-instance,\n    // not \"our instance\", so return nothing\n    if (this.editor.getModel()?.id !== model.id) {\n      return { suggestions: [] };\n    }\n\n    const { range, offset } = getRangeAndOffset(this.monaco, model, position);\n    const situation = getSituation(model.getValue(), offset);\n    const completionItems = this.getCompletions(situation);\n\n    // monaco by-default alphabetically orders the items.\n    // to stop it, we use a number-as-string sortkey,\n    // so that monaco keeps the order we use\n    const maxIndexDigits = completionItems.length.toString().length;\n    const suggestions: monacoTypes.languages.CompletionItem[] = completionItems.map((item, index) => ({\n      kind: getMonacoCompletionItemKind(item.type, this.monaco!),\n      label: item.label,\n      insertText: item.insertText,\n      sortText: index.toString().padStart(maxIndexDigits, '0'), // to force the order we have\n      range,\n    }));\n    return { suggestions };\n  }\n\n  /**\n   * We expect the data directly from the request and transform it here. We do some deduplication and turn them into\n   * object for quicker search as we usually need either a list of label names or values or particular label.\n   */\n  setSeries(series: SeriesMessage) {\n    this.labels = series.reduce<{ [label: string]: Set<string> }>((acc, serie) => {\n      const seriesLabels = serie.labels.reduce<{ [label: string]: Set<string> }>((acc, labelValue) => {\n        acc[labelValue.name] = acc[labelValue.name] || new Set();\n        acc[labelValue.name].add(labelValue.value);\n        return acc;\n      }, {});\n\n      for (const label of Object.keys(seriesLabels)) {\n        acc[label] = new Set([...(acc[label] || []), ...seriesLabels[label]]);\n      }\n      return acc;\n    }, {});\n  }\n\n  /**\n   * Get suggestion based on the situation we are in like whether we should suggest label names or values.\n   * @param situation\n   * @private\n   */\n  private getCompletions(situation: Situation): Completion[] {\n    if (!Object.keys(this.labels).length) {\n      return [];\n    }\n    switch (situation.type) {\n      // Not really sure what would make sense to suggest in this case so just leave it\n      case 'UNKNOWN': {\n        return [];\n      }\n      case 'EMPTY': {\n        return Object.keys(this.labels).map((key) => {\n          return {\n            label: key,\n            insertText: `{${key}=\"`,\n            type: 'LABEL_NAME',\n          };\n        });\n      }\n      case 'IN_LABEL_NAME':\n        return Object.keys(this.labels).map((key) => {\n          return {\n            label: key,\n            insertText: key,\n            type: 'LABEL_NAME',\n          };\n        });\n      case 'IN_LABEL_VALUE':\n        return Array.from(this.labels[situation.labelName].values()).map((key) => {\n          return {\n            label: key,\n            insertText: situation.betweenQuotes ? key : `\"${key}\"`,\n            type: 'LABEL_VALUE',\n          };\n        });\n      default:\n        throw new Error(`Unexpected situation ${situation}`);\n    }\n  }\n}\n\n/**\n * Get item kind which is used for icon next to the suggestion.\n * @param type\n * @param monaco\n */\nfunction getMonacoCompletionItemKind(type: CompletionType, monaco: Monaco): monacoTypes.languages.CompletionItemKind {\n  switch (type) {\n    case 'LABEL_NAME':\n      return monaco.languages.CompletionItemKind.Enum;\n    case 'LABEL_VALUE':\n      return monaco.languages.CompletionItemKind.EnumMember;\n    default:\n      throw new Error(`Unexpected CompletionType: ${type}`);\n  }\n}\n\nexport type CompletionType = 'LABEL_NAME' | 'LABEL_VALUE';\ntype Completion = {\n  type: CompletionType;\n  label: string;\n  insertText: string;\n};\n\nexport type Label = {\n  name: string;\n  value: string;\n};\n\nexport type Situation =\n  | {\n      type: 'UNKNOWN';\n    }\n  | {\n      type: 'EMPTY';\n    }\n  | {\n      type: 'IN_LABEL_NAME';\n      otherLabels: Label[];\n    }\n  | {\n      type: 'IN_LABEL_VALUE';\n      labelName: string;\n      betweenQuotes: boolean;\n      otherLabels: Label[];\n    };\n\nconst labelNameRegex = /[a-zA-Z_][a-zA-Z0-9_]*/;\nconst labelValueRegex = /[^\"]*/; // anything except a double quote\nconst labelPairsRegex = new RegExp(`(${labelNameRegex.source})=\"(${labelValueRegex.source})\"`, 'g');\nconst inLabelValueRegex = new RegExp(`(${labelNameRegex.source})=(\"?)${labelValueRegex.source}$`);\nconst inLabelNameRegex = new RegExp(/[{,]\\s*[a-zA-Z0-9_]*$/);\n\n/**\n * Figure out where is the cursor and what kind of suggestions are appropriate.\n * As currently Phlare handles just a simple {foo=\"bar\", baz=\"zyx\"} kind of values we can do with simple regex to figure\n * out where we are with the cursor.\n * @param text\n * @param offset\n */\nfunction getSituation(text: string, offset: number): Situation {\n  if (text === '') {\n    return {\n      type: 'EMPTY',\n    };\n  }\n\n  // Get all the labels so far in the query, so we can do some more filtering.\n  const matches = text.matchAll(labelPairsRegex);\n  const existingLabels = Array.from(matches).reduce<Label[]>((acc, match) => {\n    const [_, name, value] = match[1];\n    acc.push({ name, value });\n    return acc;\n  }, []);\n\n  // Check if we are editing a label value right now. If so also get name of the label\n  const matchLabelValue = text.substring(0, offset).match(inLabelValueRegex);\n  if (matchLabelValue) {\n    return {\n      type: 'IN_LABEL_VALUE',\n      labelName: matchLabelValue[1],\n      betweenQuotes: !!matchLabelValue[2],\n      otherLabels: existingLabels,\n    };\n  }\n\n  // Check if we are editing a label name\n  const matchLabelName = text.substring(0, offset).match(inLabelNameRegex);\n  if (matchLabelName) {\n    return {\n      type: 'IN_LABEL_NAME',\n      otherLabels: existingLabels,\n    };\n  }\n\n  // Will happen only if user writes something that isn't really a label selector\n  return {\n    type: 'UNKNOWN',\n  };\n}\n\nfunction getRangeAndOffset(monaco: Monaco, model: monacoTypes.editor.ITextModel, position: monacoTypes.Position) {\n  const word = model.getWordAtPosition(position);\n  const range =\n    word != null\n      ? monaco.Range.lift({\n          startLineNumber: position.lineNumber,\n          endLineNumber: position.lineNumber,\n          startColumn: word.startColumn,\n          endColumn: word.endColumn,\n        })\n      : monaco.Range.fromPositions(position);\n\n  // documentation says `position` will be \"adjusted\" in `getOffsetAt` so we clone it here just for sure.\n  const positionClone = {\n    column: position.column,\n    lineNumber: position.lineNumber,\n  };\n\n  const offset = model.getOffsetAt(positionClone);\n  return { offset, range };\n}\n","import { css } from '@emotion/css';\nimport React, { useEffect, useRef } from 'react';\nimport { useLatest } from 'react-use';\n\nimport { CodeEditor, Monaco, useStyles2, monacoTypes } from '@grafana/ui';\n\nimport { languageDefinition } from '../phlareql';\nimport { SeriesMessage } from '../types';\n\nimport { CompletionProvider } from './autocomplete';\n\ninterface Props {\n  value: string;\n  onChange: (val: string) => void;\n  onRunQuery: (value: string) => void;\n  series?: SeriesMessage;\n}\n\nexport function LabelsEditor(props: Props) {\n  const setupAutocompleteFn = useAutocomplete(props.series);\n  const styles = useStyles2(getStyles);\n\n  const onRunQueryRef = useLatest(props.onRunQuery);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  return (\n    <div\n      className={styles.wrapper}\n      // NOTE: we will be setting inline-style-width/height on this element\n      ref={containerRef}\n    >\n      <CodeEditor\n        value={props.value}\n        language={langId}\n        onBlur={props.onChange}\n        containerStyles={styles.queryField}\n        monacoOptions={{\n          folding: false,\n          fontSize: 14,\n          lineNumbers: 'off',\n          overviewRulerLanes: 0,\n          renderLineHighlight: 'none',\n          scrollbar: {\n            vertical: 'hidden',\n            verticalScrollbarSize: 8, // used as \"padding-right\"\n            horizontal: 'hidden',\n            horizontalScrollbarSize: 0,\n          },\n          scrollBeyondLastLine: false,\n          wordWrap: 'on',\n          padding: {\n            top: 5,\n            bottom: 6,\n          },\n        }}\n        onBeforeEditorMount={ensurePhlareQL}\n        onEditorDidMount={(editor, monaco) => {\n          setupAutocompleteFn(editor, monaco);\n\n          const updateElementHeight = () => {\n            const containerDiv = containerRef.current;\n            if (containerDiv !== null) {\n              const pixelHeight = editor.getContentHeight();\n              containerDiv.style.height = `${pixelHeight + EDITOR_HEIGHT_OFFSET}px`;\n              containerDiv.style.width = '100%';\n              const pixelWidth = containerDiv.clientWidth;\n              editor.layout({ width: pixelWidth, height: pixelHeight });\n            }\n          };\n\n          editor.onDidContentSizeChange(updateElementHeight);\n          updateElementHeight();\n\n          editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {\n            onRunQueryRef.current(editor.getValue());\n          });\n        }}\n      />\n    </div>\n  );\n}\n\n// this number was chosen by testing various values. it might be necessary\n// because of the width of the border, not sure.\n//it needs to do 2 things:\n// 1. when the editor is single-line, it should make the editor height be visually correct\n// 2. when the editor is multi-line, the editor should not be \"scrollable\" (meaning,\n//    you do a scroll-movement in the editor, and it will scroll the content by a couple pixels\n//    up & down. this we want to avoid)\nconst EDITOR_HEIGHT_OFFSET = 2;\n\n/**\n * Hook that returns function that will set up monaco autocomplete for the label selector\n */\nfunction useAutocomplete(series?: SeriesMessage) {\n  const providerRef = useRef<CompletionProvider>(new CompletionProvider());\n\n  useEffect(() => {\n    if (series) {\n      // When we have the value we will pass it to the CompletionProvider\n      providerRef.current.setSeries(series);\n    }\n  }, [series]);\n\n  const autocompleteDisposeFun = useRef<(() => void) | null>(null);\n  useEffect(() => {\n    // when we unmount, we unregister the autocomplete-function, if it was registered\n    return () => {\n      autocompleteDisposeFun.current?.();\n    };\n  }, []);\n\n  // This should be run in monaco onEditorDidMount\n  return (editor: monacoTypes.editor.IStandaloneCodeEditor, monaco: Monaco) => {\n    providerRef.current.editor = editor;\n    providerRef.current.monaco = monaco;\n\n    const { dispose } = monaco.languages.registerCompletionItemProvider(langId, providerRef.current);\n    autocompleteDisposeFun.current = dispose;\n  };\n}\n\n// we must only run the setup code once\nlet phlareqlSetupDone = false;\nconst langId = 'phlareql';\n\nfunction ensurePhlareQL(monaco: Monaco) {\n  if (phlareqlSetupDone === false) {\n    phlareqlSetupDone = true;\n    const { aliases, extensions, mimetypes, def } = languageDefinition;\n    monaco.languages.register({ id: langId, aliases, extensions, mimetypes });\n    monaco.languages.setMonarchTokensProvider(langId, def.language);\n    monaco.languages.setLanguageConfiguration(langId, def.languageConfiguration);\n  }\n}\n\nconst getStyles = () => {\n  return {\n    queryField: css`\n      flex: 1;\n      // Not exactly sure but without this the editor doe not shrink after resizing (so you can make it bigger but not\n      // smaller). At the same time this does not actually make the editor 100px because it has flex 1 so I assume\n      // this should sort of act as a flex-basis (but flex-basis does not work for this). So yeah CSS magic.\n      width: 100px;\n    `,\n    wrapper: css`\n      display: flex;\n      flex: 1;\n      border: 1px solid rgba(36, 41, 46, 0.3);\n      border-radius: 2px;\n    `,\n  };\n};\n","import { css } from '@emotion/css';\nimport React, { ComponentProps } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { Field, Icon, PopoverContent, ReactUtils, stylesFactory, Tooltip, useTheme2 } from '@grafana/ui';\n\ninterface EditorFieldProps extends ComponentProps<typeof Field> {\n  label: string;\n  children: React.ReactElement;\n  width?: number | string;\n  optional?: boolean;\n  tooltip?: PopoverContent;\n}\n\nexport const EditorField = (props: EditorFieldProps) => {\n  const { label, optional, tooltip, children, width, ...fieldProps } = props;\n\n  const theme = useTheme2();\n  const styles = getStyles(theme, width);\n\n  // Null check for backward compatibility\n  const childInputId = fieldProps?.htmlFor || ReactUtils?.getChildId(children);\n\n  const labelEl = (\n    <>\n      <label className={styles.label} htmlFor={childInputId}>\n        {label}\n        {optional && <span className={styles.optional}> - optional</span>}\n        {tooltip && (\n          <Tooltip placement=\"top\" content={tooltip} theme=\"info\">\n            <Icon name=\"info-circle\" size=\"sm\" className={styles.icon} />\n          </Tooltip>\n        )}\n      </label>\n      <span className={styles.space} />\n    </>\n  );\n\n  return (\n    <div className={styles.root}>\n      <Field className={styles.field} label={labelEl} {...fieldProps}>\n        {children}\n      </Field>\n    </div>\n  );\n};\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, width?: number | string) => {\n  return {\n    space: css({\n      paddingRight: theme.spacing(0),\n      paddingBottom: theme.spacing(0.5),\n    }),\n    root: css({\n      minWidth: theme.spacing(width ?? 0),\n    }),\n    label: css({\n      fontSize: 12,\n      fontWeight: theme.typography.fontWeightMedium,\n    }),\n    optional: css({\n      fontStyle: 'italic',\n      color: theme.colors.text.secondary,\n    }),\n    field: css({\n      marginBottom: 0, // GrafanaUI/Field has a bottom margin which we must remove\n    }),\n    icon: css({\n      color: theme.colors.text.secondary,\n      marginLeft: theme.spacing(1),\n      ':hover': {\n        color: theme.colors.text.primary,\n      },\n    }),\n  };\n});\n","import { css } from '@emotion/css';\nimport React from 'react';\nimport { useToggle } from 'react-use';\n\nimport { CoreApp, GrafanaTheme2, SelectableValue } from '@grafana/data';\nimport { Icon, useStyles2, RadioButtonGroup, MultiSelect } from '@grafana/ui';\n\nimport { Query, SeriesMessage } from '../types';\n\nimport { EditorField } from './EditorField';\nimport { Stack } from './Stack';\n\nexport interface Props {\n  query: Query;\n  onQueryChange: (query: Query) => void;\n  app?: CoreApp;\n  series?: SeriesMessage;\n}\n\nconst typeOptions: Array<{ value: Query['queryType']; label: string; description: string }> = [\n  { value: 'metrics', label: 'Metric', description: 'Return aggregated metrics' },\n  { value: 'profile', label: 'Profile', description: 'Return profile' },\n  { value: 'both', label: 'Both', description: 'Return both metric and profile data' },\n];\n\nfunction getTypeOptions(app?: CoreApp) {\n  if (app === CoreApp.Explore) {\n    return typeOptions;\n  }\n  return typeOptions.filter((option) => option.value !== 'both');\n}\n\nfunction getGroupByOptions(series?: SeriesMessage) {\n  let options: SelectableValue[] = [];\n  if (series) {\n    const labels = series.flatMap((val) => {\n      return val.labels.map((l) => l.name);\n    });\n    options = Array.from(new Set(labels)).map((l) => ({\n      label: l,\n      value: l,\n    }));\n  }\n  return options;\n}\n\n/**\n * Base on QueryOptionGroup component from grafana/ui but that is not available yet.\n */\nexport function QueryOptions({ query, onQueryChange, app, series }: Props) {\n  const [isOpen, toggleOpen] = useToggle(false);\n  const styles = useStyles2(getStyles);\n  const typeOptions = getTypeOptions(app);\n  const groupByOptions = getGroupByOptions(series);\n\n  return (\n    <Stack gap={0} direction=\"column\">\n      <div className={styles.header} onClick={toggleOpen} title=\"Click to edit options\">\n        <div className={styles.toggle}>\n          <Icon name={isOpen ? 'angle-down' : 'angle-right'} />\n        </div>\n        <h6 className={styles.title}>Options</h6>\n        {!isOpen && (\n          <div className={styles.description}>\n            {[`Type: ${query.queryType}`, query.groupBy?.length ? `Group by: ${query.groupBy.join(', ')}` : undefined]\n              .filter((v) => v)\n              .map((v, i) => (\n                <span key={i}>{v}</span>\n              ))}\n          </div>\n        )}\n      </div>\n      {isOpen && (\n        <div className={styles.body}>\n          <EditorField label={'Query Type'}>\n            <RadioButtonGroup\n              options={typeOptions}\n              value={query.queryType}\n              onChange={(value) => onQueryChange({ ...query, queryType: value })}\n            />\n          </EditorField>\n          <EditorField\n            label={'Group by'}\n            tooltip={\n              <>\n                Used to group the metric result by a specific label or set of labels. Does not apply to profile query.\n              </>\n            }\n          >\n            <MultiSelect\n              placeholder=\"Label\"\n              value={query.groupBy}\n              allowCustomValue\n              options={groupByOptions}\n              onChange={(change) => {\n                const changes = change.map((c: SelectableValue<string>) => {\n                  return c.value!;\n                });\n                onQueryChange({ ...query, groupBy: changes });\n              }}\n            />\n          </EditorField>\n        </div>\n      )}\n    </Stack>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => {\n  return {\n    switchLabel: css({\n      color: theme.colors.text.secondary,\n      cursor: 'pointer',\n      fontSize: theme.typography.bodySmall.fontSize,\n      '&:hover': {\n        color: theme.colors.text.primary,\n      },\n    }),\n    header: css({\n      display: 'flex',\n      cursor: 'pointer',\n      alignItems: 'baseline',\n      color: theme.colors.text.primary,\n      '&:hover': {\n        background: theme.colors.emphasize(theme.colors.background.primary, 0.03),\n      },\n    }),\n    title: css({\n      flexGrow: 1,\n      overflow: 'hidden',\n      fontSize: theme.typography.bodySmall.fontSize,\n      fontWeight: theme.typography.fontWeightMedium,\n      margin: 0,\n    }),\n    description: css({\n      color: theme.colors.text.secondary,\n      fontSize: theme.typography.bodySmall.fontSize,\n      paddingLeft: theme.spacing(2),\n      gap: theme.spacing(2),\n      display: 'flex',\n    }),\n    body: css({\n      display: 'flex',\n      paddingTop: theme.spacing(2),\n      gap: theme.spacing(2),\n      flexWrap: 'wrap',\n    }),\n    toggle: css({\n      color: theme.colors.text.secondary,\n      marginRight: `${theme.spacing(1)}`,\n    }),\n  };\n};\n","import { defaults } from 'lodash';\nimport React, { useEffect, useMemo, useState } from 'react';\nimport { useAsync } from 'react-use';\n\nimport { CoreApp, QueryEditorProps } from '@grafana/data';\nimport { ButtonCascader, CascaderOption } from '@grafana/ui';\n\nimport { defaultPhlare, defaultPhlareQueryType, Phlare } from '../dataquery.gen';\nimport { PhlareDataSource } from '../datasource';\nimport { PhlareDataSourceOptions, ProfileTypeMessage, Query } from '../types';\n\nimport { EditorRow } from './EditorRow';\nimport { EditorRows } from './EditorRows';\nimport { LabelsEditor } from './LabelsEditor';\nimport { QueryOptions } from './QueryOptions';\n\nexport type Props = QueryEditorProps<PhlareDataSource, Query, PhlareDataSourceOptions>;\n\nexport const defaultQuery: Partial<Phlare> = {\n  ...defaultPhlare,\n  queryType: defaultPhlareQueryType,\n};\n\nexport function QueryEditor(props: Props) {\n  const profileTypes = useProfileTypes(props.datasource);\n\n  function onProfileTypeChange(value: string[], selectedOptions: CascaderOption[]) {\n    if (selectedOptions.length === 0) {\n      return;\n    }\n\n    const id = selectedOptions[selectedOptions.length - 1].value;\n\n    if (typeof id !== 'string') {\n      throw new Error('id is not string');\n    }\n\n    props.onChange({ ...props.query, profileTypeId: id });\n  }\n\n  function onLabelSelectorChange(value: string) {\n    props.onChange({ ...props.query, labelSelector: value });\n  }\n\n  function handleRunQuery(value: string) {\n    props.onChange({ ...props.query, labelSelector: value });\n    props.onRunQuery();\n  }\n\n  const seriesResult = useAsync(() => {\n    return props.datasource.getSeries();\n  }, [props.datasource]);\n\n  const cascaderOptions = useCascaderOptions(profileTypes);\n  const selectedProfileName = useProfileName(profileTypes, props.query.profileTypeId);\n  let query = normalizeQuery(props.query, props.app);\n\n  return (\n    <EditorRows>\n      <EditorRow stackProps={{ wrap: false, gap: 1 }}>\n        <ButtonCascader onChange={onProfileTypeChange} options={cascaderOptions} buttonProps={{ variant: 'secondary' }}>\n          {selectedProfileName}\n        </ButtonCascader>\n        <LabelsEditor\n          value={query.labelSelector}\n          onChange={onLabelSelectorChange}\n          onRunQuery={handleRunQuery}\n          series={seriesResult.value}\n        />\n      </EditorRow>\n      <EditorRow>\n        <QueryOptions query={query} onQueryChange={props.onChange} app={props.app} series={seriesResult.value} />\n      </EditorRow>\n    </EditorRows>\n  );\n}\n\n// Turn profileTypes into cascader options\nfunction useCascaderOptions(profileTypes: ProfileTypeMessage[]) {\n  return useMemo(() => {\n    let mainTypes = new Map<string, CascaderOption>();\n    // Classify profile types by name then sample type.\n    for (let profileType of profileTypes) {\n      if (!mainTypes.has(profileType.name)) {\n        mainTypes.set(profileType.name, {\n          label: profileType.name,\n          value: profileType.ID,\n          children: [],\n        });\n      }\n      mainTypes.get(profileType.name)?.children?.push({\n        label: profileType.sample_type,\n        value: profileType.ID,\n      });\n    }\n    return Array.from(mainTypes.values());\n  }, [profileTypes]);\n}\n\nfunction useProfileTypes(datasource: PhlareDataSource) {\n  const [profileTypes, setProfileTypes] = useState<ProfileTypeMessage[]>([]);\n  useEffect(() => {\n    (async () => {\n      const profileTypes = await datasource.getProfileTypes();\n      setProfileTypes(profileTypes);\n    })();\n  }, [datasource]);\n  return profileTypes;\n}\n\nfunction useProfileName(profileTypes: ProfileTypeMessage[], profileTypeId: string) {\n  return useMemo(() => {\n    if (!profileTypes) {\n      return 'Loading';\n    }\n    const profile = profileTypes.find((type) => type.ID === profileTypeId);\n    if (!profile) {\n      return 'Select a profile type';\n    }\n\n    return profile.name + ' - ' + profile.sample_type;\n  }, [profileTypeId, profileTypes]);\n}\n\nexport function normalizeQuery(query: Query, app?: CoreApp | string) {\n  let normalized = defaults(query, defaultQuery);\n  if (app !== CoreApp.Explore && normalized.queryType === 'both') {\n    // In dashboards and other places, we can't show both types of graphs at the same time.\n    // This will also be a default when having 'both' query and adding it from explore to dashboard\n    normalized.queryType = 'profile';\n  }\n  return normalized;\n}\n","import Prism, { Grammar } from 'prismjs';\nimport { Observable, of } from 'rxjs';\n\nimport {\n  AbstractQuery,\n  DataQueryRequest,\n  DataQueryResponse,\n  DataSourceInstanceSettings,\n  ScopedVars,\n} from '@grafana/data';\nimport { DataSourceWithBackend, getTemplateSrv, TemplateSrv } from '@grafana/runtime';\n\nimport { extractLabelMatchers, toPromLikeExpr } from '../prometheus/language_utils';\n\nimport { normalizeQuery } from './QueryEditor/QueryEditor';\nimport { PhlareDataSourceOptions, Query, ProfileTypeMessage, SeriesMessage } from './types';\n\nexport class PhlareDataSource extends DataSourceWithBackend<Query, PhlareDataSourceOptions> {\n  constructor(\n    instanceSettings: DataSourceInstanceSettings<PhlareDataSourceOptions>,\n    private readonly templateSrv: TemplateSrv = getTemplateSrv()\n  ) {\n    super(instanceSettings);\n  }\n\n  query(request: DataQueryRequest<Query>): Observable<DataQueryResponse> {\n    const validTargets = request.targets\n      .filter((t) => t.profileTypeId)\n      .map((t) => {\n        // Empty string errors out but honestly seems like we can just normalize it this way\n        if (t.labelSelector === '') {\n          return {\n            ...t,\n            labelSelector: '{}',\n          };\n        }\n        return normalizeQuery(t, request.app);\n      });\n    if (!validTargets.length) {\n      return of({ data: [] });\n    }\n    return super.query({\n      ...request,\n      targets: validTargets,\n    });\n  }\n\n  async getProfileTypes(): Promise<ProfileTypeMessage[]> {\n    return await super.getResource('profileTypes');\n  }\n\n  async getSeries(): Promise<SeriesMessage> {\n    // For now, we send empty matcher to get all the series\n    return await super.getResource('series', { matchers: ['{}'] });\n  }\n\n  async getLabelNames(): Promise<string[]> {\n    return await super.getResource('labelNames');\n  }\n\n  applyTemplateVariables(query: Query, scopedVars: ScopedVars): Query {\n    return {\n      ...query,\n      labelSelector: this.templateSrv.replace(query.labelSelector ?? '', scopedVars),\n    };\n  }\n\n  async importFromAbstractQueries(abstractQueries: AbstractQuery[]): Promise<Query[]> {\n    return abstractQueries.map((abstractQuery) => this.importFromAbstractQuery(abstractQuery));\n  }\n\n  importFromAbstractQuery(labelBasedQuery: AbstractQuery): Query {\n    return {\n      refId: labelBasedQuery.refId,\n      labelSelector: toPromLikeExpr(labelBasedQuery),\n      queryType: 'both',\n      profileTypeId: '',\n      groupBy: [''],\n    };\n  }\n\n  async exportToAbstractQueries(queries: Query[]): Promise<AbstractQuery[]> {\n    return queries.map((query) => this.exportToAbstractQuery(query));\n  }\n\n  exportToAbstractQuery(query: Query): AbstractQuery {\n    const phlareQuery = query.labelSelector;\n    if (!phlareQuery || phlareQuery.length === 0) {\n      return { refId: query.refId, labelMatchers: [] };\n    }\n    const tokens = Prism.tokenize(phlareQuery, grammar);\n    return {\n      refId: query.refId,\n      labelMatchers: extractLabelMatchers(tokens),\n    };\n  }\n}\n\nconst grammar: Grammar = {\n  'context-labels': {\n    pattern: /\\{[^}]*(?=}?)/,\n    greedy: true,\n    inside: {\n      comment: {\n        pattern: /#.*/,\n      },\n      'label-key': {\n        pattern: /[a-zA-Z_]\\w*(?=\\s*(=|!=|=~|!~))/,\n        alias: 'attr-name',\n        greedy: true,\n      },\n      'label-value': {\n        pattern: /\"(?:\\\\.|[^\\\\\"])*\"/,\n        greedy: true,\n        alias: 'attr-value',\n      },\n      punctuation: /[{]/,\n    },\n  },\n  punctuation: /[{}(),.]/,\n};\n","import { DataSourcePlugin } from '@grafana/data';\n\nimport { ConfigEditor } from './ConfigEditor';\nimport { QueryEditor } from './QueryEditor/QueryEditor';\nimport { PhlareDataSource } from './datasource';\nimport { Query, PhlareDataSourceOptions } from './types';\n\nexport const plugin = new DataSourcePlugin<PhlareDataSource, Query, PhlareDataSourceOptions>(PhlareDataSource)\n  .setConfigEditor(ConfigEditor)\n  .setQueryEditor(QueryEditor);\n","import { useRef } from 'react';\nvar useLatest = function (value) {\n    var ref = useRef(value);\n    ref.current = value;\n    return ref;\n};\nexport default useLatest;\n"],"names":["ConfigEditor","props","options","onOptionsChange","DataSourceHttpSettings","config","SecureSocksProxySettings","event","DataQueryModelVersion","defaultPhlareQueryType","defaultPhlare","Stack","styles","theme","getStyles","EditorRow","children","stackProps","EditorRows","languageDefinition","CompletionProvider","model","position","range","offset","getRangeAndOffset","situation","getSituation","completionItems","maxIndexDigits","item","index","getMonacoCompletionItemKind","series","acc","serie","seriesLabels","labelValue","label","key","type","monaco","labelNameRegex","labelValueRegex","labelPairsRegex","inLabelValueRegex","inLabelNameRegex","text","matches","existingLabels","match","_","name","value","matchLabelValue","word","positionClone","LabelsEditor","setupAutocompleteFn","useAutocomplete","onRunQueryRef","useLatest","containerRef","CodeEditor","langId","ensurePhlareQL","editor","updateElementHeight","containerDiv","pixelHeight","EDITOR_HEIGHT_OFFSET","pixelWidth","providerRef","autocompleteDisposeFun","dispose","phlareqlSetupDone","aliases","extensions","mimetypes","def","EditorField","optional","tooltip","width","fieldProps","childInputId","labelEl","Tooltip","Icon","Field","stylesFactory","typeOptions","getTypeOptions","app","option","getGroupByOptions","labels","val","l","QueryOptions","query","onQueryChange","isOpen","toggleOpen","useToggle","groupByOptions","v","i","RadioButtonGroup","change","changes","c","defaultQuery","QueryEditor","profileTypes","useProfileTypes","onProfileTypeChange","selectedOptions","id","onLabelSelectorChange","handleRunQuery","seriesResult","useAsync","cascaderOptions","useCascaderOptions","selectedProfileName","useProfileName","normalizeQuery","ButtonCascader","mainTypes","profileType","datasource","setProfileTypes","profileTypeId","profile","normalized","PhlareDataSource","DataSourceWithBackend","instanceSettings","templateSrv","request","validTargets","t","of","scopedVars","abstractQueries","abstractQuery","labelBasedQuery","queries","phlareQuery","tokens","grammar","ref"],"sourceRoot":""}