"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[5436],{31084:(p,O,s)=>{s.d(O,{Y:()=>m});var e=s(74848),R=s(96540),d=s(41053),l=s(10096),_=s(31678),D=s(37425),i=s(85927);const m=({teamId:E,roleOptions:r,disabled:a,roles:n,onApplyRoles:c,pendingRoles:o,apply:t=!1,maxWidth:A,width:T,isLoading:v})=>{const[{loading:f,value:C=n||[]},M]=(0,d.A)(async()=>{try{if(n)return n;if(t&&o?.length)return o;if(l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesList)&&E>0)return await(0,i.xN)(E)}catch(P){console.error("Error loading options",P)}return[]},[E,o,n]);(0,R.useEffect)(()=>{M()},[M]);const I=async P=>{t?c&&c(P):(await(0,i.G3)(P,E),await M())},h=l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesAdd)&&l.TP.hasPermission(_.AccessControlAction.ActionTeamsRolesRemove);return(0,e.jsx)(D.n,{apply:t,onRolesChange:I,roleOptions:r,appliedRoles:C,isLoading:f||v,disabled:a,basicRoleDisabled:!0,canUpdateRoles:h,maxWidth:A,width:T})}},54939:(p,O,s)=>{s.d(O,{o:()=>m});var e=s(2543),R=s.n(e),d=s(96540),l=s(24705),_=s(10096),D=s(31678),i=s(85927);const m=r=>{const[a,n]=(0,d.useState)(r),{value:c=[]}=(0,l.A)(async()=>_.TP.licensedAccessControlEnabled()&&_.TP.hasPermission(D.AccessControlAction.ActionRolesList)?(0,i.RL)(a):Promise.resolve([]),[a]);return[{roleOptions:c},n]},E=r=>{const[a,n]=useState({});return useDeepCompareEffect(()=>{if(!contextSrv.licensedAccessControlEnabled()||!contextSrv.hasPermission(AccessControlAction.ActionRolesList))return;const c=Object.keys(a).map(t=>typeof t=="number"?t:parseInt(t,10)),o=difference(r,c);Promise.all(o.map(t=>fetchRoleOptions(t).then(A=>[t,A]))).then(t=>{n({...a,...Object.fromEntries(t)})})},[r]),a}},80011:(p,O,s)=>{s.r(O),s.d(O,{CreateTeam:()=>T,default:()=>v});var e=s(74848),R=s(96540),d=s(49785),l=s(17172),_=s(39601),D=s(84167),i=s(88575),m=s(10354),E=s(55852),r=s(21780),a=s(31084),n=s(85927),c=s(54939),o=s(10096),t=s(31678);const A={icon:"users-alt",id:"team-new",text:"New team",subTitle:"Create a new team. Teams let you grant permissions to a group of users."},T=()=>{const f=o.TP.user.orgId,[C,M]=(0,R.useState)([]),[{roleOptions:I}]=(0,c.o)(f),{handleSubmit:h,register:P,formState:{errors:L}}=(0,d.mN)(),U=o.TP.hasPermission(t.AccessControlAction.ActionUserRolesAdd)&&o.TP.hasPermission(t.AccessControlAction.ActionUserRolesRemove),W=async B=>{const u=await(0,l.AI)().post("/api/teams",B);if(u.teamId){try{await o.TP.fetchUserPermissions(),o.TP.licensedAccessControlEnabled()&&U&&await(0,n.G3)(C,u.teamId,u.orgId)}catch(g){console.error(g)}_.Ny.push(`/org/teams/edit/${u.uid}`)}};return(0,e.jsx)(r.YW,{navId:"teams",pageNav:A,children:(0,e.jsx)(r.YW.Contents,{children:(0,e.jsxs)("form",{onSubmit:h(W),style:{maxWidth:"600px"},children:[(0,e.jsxs)(D.n,{children:[(0,e.jsx)(i.D,{label:"Name",required:!0,invalid:!!L.name,error:"Team name is required",children:(0,e.jsx)(m.p,{...P("name",{required:!0}),id:"team-name"})}),o.TP.licensedAccessControlEnabled()&&(0,e.jsx)(i.D,{label:"Role",children:(0,e.jsx)(a.Y,{teamId:0,roleOptions:I,disabled:!1,apply:!0,onApplyRoles:M,pendingRoles:C,maxWidth:"100%"})}),(0,e.jsx)(i.D,{label:"Email",description:"This is optional and is primarily used for allowing custom team avatars.",children:(0,e.jsx)(m.p,{...P("email"),type:"email",id:"team-email",placeholder:"email@test.com"})})]}),(0,e.jsx)(E.$n,{type:"submit",variant:"primary",children:"Create"})]})})})},v=T}}]);

//# sourceMappingURL=CreateTeam.ee4bf19a6d0d37cb68d0.js.map