"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[6173],{61802:(se,w,n)=>{n.d(w,{l:()=>Rt});var s=n(68404),D=n(36635),H=n(32294),M=n(46732),Q=n(58252),V=n(56991);function c({children:r,width:e,height:a,onLoad:t,onChange:o}){const i=(0,V.L)(),[l,h]=(0,s.useState)(!1),[p,P]=(0,s.useState)(!1),W=(0,s.useRef)(null);return(0,Q.Z)(()=>{c.addCallback(i,q=>{!l&&q.isIntersecting&&(h(!0),t?.()),P(q.isIntersecting),o?.(q.isIntersecting)});const A=W.current;return A&&c.observer.observe(A),()=>{delete c.callbacks[i],A&&c.observer.unobserve(A),Object.keys(c.callbacks).length===0&&c.observer.disconnect()}}),s.createElement("div",{id:i,ref:W,style:{width:e,height:a}},l&&(typeof r=="function"?r({isInView:p}):r))}c.callbacks={},c.addCallback=(r,e)=>c.callbacks[r]=e,c.observer=new IntersectionObserver(r=>{for(const e of r)c.callbacks[e.target.id](e)},{rootMargin:"100px"});var R=n(9085),b=n.n(R),g=n(53376),d=n(49922),E=n(69311),u=n(68183),y=n(11484),O=n(37932),B=n(47694),S=n(84952),f=n(73952);function x(r){return/(d-solo|dashboard-solo)/.test(r?.toLowerCase())}function z(r,e){return Boolean(e.find(a=>a.id==="apps")?.children?.find(a=>a.id===`plugin-page-${r}`)?.children?.some(a=>a.url?.endsWith(`/a/${r}`)))}var N=n(19349),I=n(9892),K=n(72648),J=n(94437),U=n(39904),Y=n(69600),ee=n(53821),X=n(6554);const ie=({state:r,onClick:e})=>{const a=(0,K.wW)(ce);return r===d.Gu.Loading?s.createElement("div",{className:"panel-loading",onClick:e},s.createElement(X.u,{content:"Cancel query"},s.createElement(U.J,{className:"panel-loading__spinner spin-clockwise",name:"sync"}))):r===d.Gu.Streaming?s.createElement("div",{className:"panel-loading",onClick:e},s.createElement("div",{title:"Streaming (click to stop)",className:a.streamIndicator})):null};function ce(r){return{streamIndicator:I.css`
      width: 10px;
      height: 10px;
      background: ${r.colors.text.disabled};
      box-shadow: 0 0 2px ${r.colors.text.disabled};
      border-radius: 50%;
      position: relative;
      top: 6px;
      right: 1px;
    `}}function ue({children:r,...e}){const[a,t]=(0,s.useState)({x:0,y:0}),[o,i]=(0,s.useState)(!1),l=(0,s.useCallback)(p=>{Pe(a,me(p))&&i(!o)},[a,o,i]),h=(0,s.useCallback)(p=>{t(me(p))},[t]);return s.createElement("header",{...e,className:"panel-title-container",onClick:l,onMouseDown:h},r({panelMenuOpen:o,closeMenu:()=>i(!1)}))}function Pe(r,e,a=3.5){return Math.sqrt((r.x-e.x)**2+(r.y-e.y)**2)<=a}function me(r){return{x:r.clientX,y:r.clientY}}var C=n(38484),L=n(79860);class Z extends s.PureComponent{constructor(){super(...arguments),this.renderItems=(e,a=!1)=>s.createElement("ul",{className:b()("dropdown-menu","dropdown-menu--menu","panel-menu",this.props.itemsClassName),style:this.props.style,role:a?"":"menu"},e.map((t,o)=>s.createElement(L.u,{key:`${t.text}${o}`,type:t.type,text:t.text,iconClassName:t.iconClassName,onClick:t.onClick,shortcut:t.shortcut,href:t.href},t.subMenu&&this.renderItems(t.subMenu,!0))))}render(){return s.createElement("div",{className:b()("panel-menu-container","dropdown","open",this.props.className)},this.renderItems(this.props.items))}}function F({items:r}){const e=a=>a.map(t=>t.type==="divider"?s.createElement(C.v.Divider,{key:t.text}):s.createElement(C.v.Item,{key:t.text,label:t.text,icon:t.iconClassName,childItems:t.subMenu?e(t.subMenu):void 0,url:t.href,onClick:t.onClick,shortcut:t.shortcut,testId:u.wl.components.Panels.Panel.menuItems(t.text)}));return s.createElement(C.v,null,e(r))}var v=n(81168),_=n(21830),T=n(41818),ge=n(86647),Me=n(54665),ve=n(36032),k=n(35287),te=n(82002),ze=n(55935),ae=n(2476),de=n(39653),Ke=n(6297),Te=n(3153),$e=n(48197);function Qe(r,e,a){const t=m=>{m.preventDefault(),O.E1.partial({viewPanel:e.id}),(0,T.ff)("dashboards_panelheader_view_clicked")},o=m=>{m.preventDefault(),O.E1.partial({editPanel:e.id}),(0,T.ff)("dashboards_panelheader_edit_clicked")},i=m=>{m.preventDefault(),(0,ae.Po)(r,e),(0,T.ff)("dashboards_panelheader_share_clicked")},l=m=>{m.preventDefault(),(0,ae.Kq)(r,e),(0,T.ff)("dashboards_panelheader_createlibrarypanel_clicked")},h=m=>{m.preventDefault(),(0,ae.oe)(e),(0,T.ff)("dashboards_panelheader_unlinklibrarypanel_clicked")},p=m=>{O.E1.partial({inspect:e.id,inspectTab:m}),(0,T.ff)("dashboards_panelheader_inspect_clicked",{tab:m??de.q.Data})},P=m=>{m.preventDefault()},W=m=>{m.preventDefault(),(0,ae.jN)(r,e),(0,T.ff)("dashboards_panelheader_duplicate_clicked")},A=m=>{m.preventDefault(),(0,ae.bY)(e),(0,T.ff)("dashboards_panelheader_copy_clicked")},q=m=>{m.preventDefault(),(0,ae.WJ)(r,e,!0),(0,T.ff)("dashboards_panelheader_remove_clicked")},he=m=>{m.preventDefault();const j=m.ctrlKey||m.metaKey?oe=>window.open(`${B.ZP.appSubUrl}${oe}`):void 0;Te.h.dispatch((0,$e.m$)(e,{getDataSourceSrv:ge.F,getTimeSrv:N.$t,getExploreUrl:ze.H6,openInNewWindow:j})),(0,T.ff)("dashboards_panelheader_explore_clicked")},fe=m=>{m.preventDefault(),(0,ae.qw)(e),(0,T.ff)("dashboards_panelheader_togglelegend_clicked")},G=[];e.isEditing||G.push({text:(0,k.t)("panel.header-menu.view","View"),iconClassName:"eye",onClick:t,shortcut:"v"}),r.canEditPanel(e)&&!e.isEditing&&G.push({text:(0,k.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",onClick:o,shortcut:"e"}),G.push({text:(0,k.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:i,shortcut:"p s"}),te.Vt.hasAccessToExplore()&&!(e.plugin&&e.plugin.meta.skipDataQuery)&&G.push({text:(0,k.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",onClick:he,shortcut:"x"});const le=[];e.plugin&&!e.plugin.meta.skipDataQuery&&(le.push({text:(0,k.t)("panel.header-menu.inspect-data","Data"),onClick:m=>p(de.q.Data)}),r.meta.canEdit&&le.push({text:(0,k.t)("panel.header-menu.query","Query"),onClick:m=>p(de.q.Query)})),le.push({text:(0,k.t)("panel.header-menu.inspect-json","Panel JSON"),onClick:m=>p(de.q.JSON)}),G.push({type:"submenu",text:(0,k.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",onClick:m=>{const j=m.currentTarget,oe=m.target,ne=oe.closest('[role="menuitem"]');(oe===j||ne===j)&&p()},shortcut:"i",subMenu:le});const $=[],pe=r.canEditPanel(e);if(e.isViewing||e.isEditing||(pe?($.push({text:(0,k.t)("panel.header-menu.duplicate","Duplicate"),onClick:W,shortcut:"p d"}),$.push({text:(0,k.t)("panel.header-menu.copy","Copy"),onClick:A}),(0,Ke.V)(e)?$.push({text:(0,k.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),onClick:h}):$.push({text:(0,k.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:l})):te.Vt.isEditor&&$.push({text:(0,k.t)("panel.header-menu.copy","Copy"),onClick:A})),a){const m=a.getScope(),j=m.$$childHead.ctrl,oe=j.getExtendedMenu();for(const ne of oe){const Be={text:ne.text,href:ne.href,shortcut:ne.shortcut};ne.click&&(Be.onClick=()=>{m.$eval(ne.click,{ctrl:j})}),$.push(Be)}}e.options.legend&&$.push({text:e.options.legend.showLegend?(0,k.t)("panel.header-menu.hide-legend","Hide legend"):(0,k.t)("panel.header-menu.show-legend","Show legend"),onClick:fe,shortcut:"p l"}),e.isEditing&&($.length=0),pe&&e.plugin&&!e.plugin.meta.skipDataQuery&&$.push({text:(0,k.t)("panel.header-menu.get-help","Get help"),onClick:m=>p(de.q.Help)}),$.length&&G.push({type:"submenu",text:(0,k.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:$,onClick:P});const{extensions:re}=(0,Me.I)({extensionPointId:_.y.DashboardPanelMenu,context:Ze(e,r)});if(re.length>0&&!e.isEditing){const m=[];for(const j of re)if((0,ve.c)(j)){m.push({text:Je(j.title,25),href:j.path,onClick:j.onClick});continue}G.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:m})}return r.canEditPanel(e)&&!e.isEditing&&!e.isViewing&&(G.push({type:"divider",text:""}),G.push({text:(0,k.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:q,shortcut:"p r"})),G}function Je(r,e){return r.length<e?r:`${r.slice(0,e-3).trimEnd()}...`}function Ze(r,e){return{id:r.id,pluginId:r.type,title:r.title,timeRange:e.time,timeZone:e.timezone,dashboard:{uid:e.uid,title:e.title,tags:Array.from(e.tags)},targets:r.targets}}function Re({panel:r,dashboard:e,loadingState:a,children:t}){const[o,i]=(0,s.useState)([]),l=(0,v.useSelector)(h=>(0,f.i)(h,r)?.angularComponent);return(0,s.useEffect)(()=>{i(Qe(e,r,l))},[e,r,l,a,i]),t({items:o})}function Ge({panel:r,dashboard:e,loadingState:a,style:t,menuItemsClassName:o,menuWrapperClassName:i}){return s.createElement(Re,{panel:r,dashboard:e,loadingState:a},({items:l})=>s.createElement(Z,{className:i,itemsClassName:o,style:t,items:l}))}function je({style:r,panel:e,dashboard:a,loadingState:t}){return s.createElement(Re,{panel:e,dashboard:a,loadingState:t},({items:o})=>s.createElement(F,{style:r,items:o}))}var be=n(64319),Le=n(85419);const Ye=({notice:r,onClick:e})=>{const a=(0,K.wW)(Xe),t=r.severity==="error"||r.severity==="warning"?"exclamation-triangle":"info-circle";return r.inspect&&e?s.createElement(be.h,{className:a.notice,icon:t,iconSize:"md",key:r.severity,tooltip:r.text,onClick:o=>e(o,r.inspect)}):r.link?s.createElement("a",{className:a.notice,"aria-label":r.text,href:r.link,target:"_blank",rel:"noreferrer"},s.createElement(U.J,{name:t,style:{marginRight:"8px"},size:"md"})):s.createElement(X.u,{key:r.severity,content:r.text},s.createElement("span",{className:a.iconTooltip},s.createElement(U.J,{name:t,size:"md"})))},Xe=r=>({notice:(0,I.css)({background:"inherit",border:"none",borderRadius:r.shape.borderRadius()}),iconTooltip:(0,I.css)({color:`${r.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${r.shape.borderRadius()}`,padding:`${r.spacing(0,1)}`,height:` ${r.spacing(r.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,Le.getFocusStyles)(r),zIndex:1},"&: focus:not(:focus-visible)":(0,Le.getMouseFocusStyles)(r),"&:hover ":{boxShadow:`${r.shadows.z1}`,color:`${r.colors.text.primary}`,background:`${r.colors.background.secondary}`}})}),Ae=({frames:r,panelId:e})=>{const a=(0,s.useCallback)((o,i)=>{o.stopPropagation(),O.E1.partial({inspect:e,inspectTab:i})},[e]),t={};for(const o of r)if(!(!o.meta||!o.meta.notices))for(const i of o.meta.notices)t[i.severity]=i;return s.createElement(s.Fragment,null,Object.values(t).map(o=>s.createElement(Ye,{notice:o,onClick:a,key:o.severity})))};function Ne({panel:r,error:e,isViewing:a,isEditing:t,data:o,alertState:i,dashboard:l}){const h=()=>r.getQueryRunner().cancelQuery(),p=r.getDisplayTitle(),P=(0,I.cx)("panel-header",a||t?"":"grid-drag-handle"),W=(0,K.wW)(qe);return s.createElement(s.Fragment,null,s.createElement(ie,{state:o.state,onClick:h}),s.createElement(ee.Z,{panel:r,title:r.title,description:r.description,scopedVars:r.scopedVars,links:(0,Y.H)(r),error:e}),s.createElement("div",{className:P},s.createElement(ue,{"data-testid":u.wl.components.Panels.Panel.title(p)},({closeMenu:A,panelMenuOpen:q})=>s.createElement(J.L,{onClick:A,parent:document},s.createElement("div",{className:"panel-title"},s.createElement(Ae,{frames:o.series,panelId:r.id}),i?s.createElement(U.J,{name:i==="alerting"?"heart-break":"heart",className:"icon-gf panel-alert-icon",style:{marginRight:"4px"},size:"sm"}):null,s.createElement("h2",{className:W.titleText},p),!l.meta.publicDashboardAccessToken&&s.createElement("div",{"data-testid":"panel-dropdown"},s.createElement(U.J,{name:"angle-down",className:"panel-menu-toggle"}),q?s.createElement(Ge,{panel:r,dashboard:l}):null),o.request&&o.request.timeInfo&&s.createElement("span",{className:"panel-time-info"},s.createElement(U.J,{name:"clock-nine",size:"sm"})," ",o.request.timeInfo))))))}const qe=r=>({titleText:I.css`
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      max-width: calc(100% - 38px);
      cursor: pointer;
      font-weight: ${r.typography.fontWeightMedium};
      font-size: ${r.typography.body.fontSize};
      margin: 0;

      &:hover {
        color: ${r.colors.text.primary};
      }
      .panel-has-alert & {
        max-width: calc(100% - 54px);
      }
    `});class _e extends s.PureComponent{constructor(e){super(e),this.element=null,this.timeSrv=(0,N.$t)(),this.subs=new g.w0,this.state={data:{state:d.Gu.NotStarted,series:[],timeRange:(0,E.JK)()}}}componentDidMount(){const{panel:e}=this.props;this.loadAngularPanel();const a=e.getQueryRunner();this.subs.add(a.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:t=>this.onPanelDataUpdate(t)}))}onPanelDataUpdate(e){let a;if(e.state===d.Gu.Error){const{error:t}=e;t&&a!==t.message&&(a=t.message)}this.setState({data:e,errorMessage:a})}componentWillUnmount(){this.subs.unsubscribe(),this.props.angularComponent&&this.props.angularComponent?.destroy()}componentDidUpdate(e,a){const{plugin:t,height:o,width:i,panel:l}=this.props;e.plugin!==t&&this.loadAngularPanel(),(e.width!==i||e.height!==o)&&this.scopeProps&&(this.scopeProps.size.height=this.getInnerPanelHeight(),this.scopeProps.size.width=this.getInnerPanelWidth(),l.render())}getInnerPanelHeight(){const{plugin:e,height:a}=this.props,{theme:t}=B.ZP,o=this.hasOverlayHeader()?0:t.panelHeaderHeight,i=e.noPadding?0:t.panelPadding;return a-o-i*2-S.QO}getInnerPanelWidth(){const{plugin:e,width:a}=this.props,{theme:t}=B.ZP,o=e.noPadding?0:t.panelPadding;return a-o*2-S.QO}loadAngularPanel(){const{panel:e,dashboard:a,setPanelAngularComponent:t}=this.props;if(!this.element)return;const o=(0,y.w)(),i='<plugin-component type="panel" class="panel-height-helper"></plugin-component>';this.scopeProps={panel:e,dashboard:a,size:{width:this.getInnerPanelWidth(),height:this.getInnerPanelHeight()}},t({key:e.key,angularComponent:o.load(this.element,this.scopeProps,i)})}hasOverlayHeader(){const{panel:e}=this.props,{data:a}=this.state;return a.request&&a.request.timeInfo?!1:!e.hasTitle()}render(){const{dashboard:e,panel:a,isViewing:t,isEditing:o,plugin:i}=this.props,{errorMessage:l,data:h}=this.state,{transparent:p}=a,P=h.alertState?.state,W=b()({"panel-container":!0,"panel-container--absolute":x(O.E1.getLocation().pathname),"panel-container--transparent":p,"panel-container--no-title":this.hasOverlayHeader(),"panel-has-alert":a.alert!==void 0,[`panel-alert-state--${P}`]:P!==void 0}),A=b()({"panel-content":!0,"panel-content--no-padding":i.noPadding});return s.createElement("div",{className:W,"data-testid":u.wl.components.Panels.Panel.title(a.title),"aria-label":u.wl.components.Panels.Panel.containerByTitle(a.title)},s.createElement(Ne,{panel:a,dashboard:e,title:a.title,description:a.description,links:a.links,error:l,isViewing:t,isEditing:o,data:h,alertState:P}),s.createElement("div",{className:A},s.createElement("div",{ref:q=>this.element=q,className:"panel-height-helper"})))}}const et=(r,e)=>({angularComponent:(0,f.i)(r,e.panel)?.angularComponent}),tt={setPanelAngularComponent:M.o8},nt=(0,D.connect)(et,tt)(_e);var st=n(29431),Ce=n(55294),ke=n(46519),at=n(5916),rt=n(41959),ye=n(40400),ot=n(16911),it=n(20231),lt=n(20308),ct=n(82378),Ue=n(35645),Fe=n(60325),Ee=n(38208),we=n(53546),We=n(29494),dt=n(91162),ht=n(30002),He=n(85854),pt=n(66926);const ut=(r,e,a)=>{const{overrides:t}=a,o=a.overrides.findIndex(P=>P.matcher.id===He.mi.byName&&P.matcher.options===r);if(o<0)return{...a,overrides:[...a.overrides,mt(r,e)]};const i=Array.from(t),l=i[o],h=l.properties.findIndex(P=>P.id==="color");if(h<0)return i[o]={...l,properties:[...l.properties,De(e)]},{...a,overrides:i};const p=Array.from(l.properties);return p[h]=De(e),i[o]={...l,properties:p},{...a,overrides:i}},mt=(r,e)=>({matcher:{id:He.mi.byName,options:r},properties:[De(e)]}),De=r=>({id:"color",value:{mode:pt.S.Fixed,fixedColor:r}});var gt=n(45984),Se=n(70659),xe=n(87865),ft=n(57277),Ie=n(23309),vt=n(3630),Et=n(71698);function Pt({panelLinks:r,onShowPanelLinks:e}){const a=(0,K.wW)(Ct),t=()=>{const o=e();return s.createElement(C.v,null,o?.map((i,l)=>s.createElement(C.v.Item,{key:l,label:i.title,url:i.href,target:i.target,onClick:i.onClick})))};if(r.length===1){const o=e()[0];return s.createElement(Ee.fm.TitleItem,{href:o.href,onClick:o.onClick,target:o.target,title:o.title},s.createElement(U.J,{name:"external-link-alt",size:"md"}))}else return s.createElement(Et.L,{overlay:t},s.createElement(be.h,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links",className:a.menuTrigger}))}const Ct=r=>({menuTrigger:(0,I.css)({height:"100%",background:"inherit",border:"none",borderRadius:`${r.shape.borderRadius()}`,cursor:"context-menu"})});function yt(r){const{alertState:e,data:a,panelId:t,onShowPanelLinks:o,panelLinks:i}=r,l=(0,K.wW)(Dt),h=s.createElement(X.u,{content:`alerting is ${e}`},s.createElement(Ee.fm.TitleItem,{className:(0,I.cx)({[l.ok]:e===Ie.Z.OK,[l.pending]:e===Ie.Z.Pending,[l.alerting]:e===Ie.Z.Alerting})},s.createElement(U.J,{name:e==="alerting"?"heart-break":"heart",className:"panel-alert-icon",size:"md"}))),p=s.createElement(s.Fragment,null,a.request&&a.request.timeInfo&&s.createElement(X.u,{content:s.createElement(vt.IF,{timeRange:a.request?.range,timeZone:a.request?.timezone})},s.createElement(Ee.fm.TitleItem,{className:l.timeshift},s.createElement(U.J,{name:"clock-nine",size:"md"})," ",a.request?.timeInfo)));return s.createElement(s.Fragment,null,i&&i.length>0&&o&&s.createElement(Pt,{onShowPanelLinks:o,panelLinks:i}),s.createElement(Ae,{panelId:t,frames:a.series}),p,e&&h)}const Dt=r=>({ok:(0,I.css)({color:r.colors.success.text}),pending:(0,I.css)({color:r.colors.warning.text}),alerting:(0,I.css)({color:r.colors.error.text}),timeshift:(0,I.css)({color:r.colors.text.link,gap:r.spacing(.5),whiteSpace:"nowrap","&:hover":{color:r.colors.emphasize(r.colors.text.link,.03)}})});var St=n(91551),Oe=n(6911);const xt="Error in plugin";class It extends s.PureComponent{constructor(e){super(e),this.timeSrv=(0,N.$t)(),this.subs=new g.w0,this.eventFilter={onlyLocal:!0},this.descriptionInteractionReported=!1,this.getSync=()=>this.props.isEditing?st.m.Off:this.props.dashboard.graphTooltip,this.onInstanceStateChange=t=>{this.props.onInstanceStateChange(t),this.setState({context:{...this.state.context,instanceState:t}})},this.onSeriesColorChange=(t,o)=>{this.onFieldConfigChange(ut(t,o,this.props.panel.fieldConfig))},this.onSeriesVisibilityChange=(t,o)=>{this.onFieldConfigChange((0,St.N)(t,o,this.props.panel.fieldConfig,this.state.data.series))},this.onToggleLegendSort=t=>{const o=this.props.panel.options.legend;if(!o)return;let i=o.sortDesc,l=o.sortBy;t!==l&&(i=void 0),i===!1?(l=void 0,i=void 0):(i=!i,l=t),this.onOptionsChange({...this.props.panel.options,legend:{...o,sortBy:l,sortDesc:i}})},this.onRefresh=()=>{const{dashboard:t,panel:o,isInView:i,width:l}=this.props;if(!i){this.setState({refreshWhenInView:!0});return}const h=(0,ae.W1)(o,this.timeSrv.timeRange());if(this.wantsQueryExecution){if(l<0)return;this.state.refreshWhenInView&&this.setState({refreshWhenInView:!1}),o.runAllPanelQueries({dashboardId:t.id,dashboardUID:t.uid,dashboardTimezone:t.getTimezone(),publicDashboardAccessToken:t.meta.publicDashboardAccessToken,timeData:h,width:l})}else this.setState({data:{...this.state.data,timeRange:this.timeSrv.timeRange()},renderCounter:this.state.renderCounter+1,liveTime:void 0})},this.onRender=()=>{const t={renderCounter:this.state.renderCounter+1};this.setState(t)},this.onOptionsChange=t=>{this.props.panel.updateOptions(t)},this.onFieldConfigChange=t=>{this.props.panel.updateFieldConfig(t)},this.onPanelError=t=>{const o=t.message||xt;this.state.errorMessage!==o&&this.setState({errorMessage:o})},this.onPanelErrorRecover=()=>{this.setState({errorMessage:void 0})},this.onAnnotationCreate=async t=>{const o=t.from!==t.to,i={dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:o,time:t.from,timeEnd:o?t.to:0,tags:t.tags,text:t.description};await(0,Se.xD)(i),(0,xe.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1(i))},this.onAnnotationDelete=async t=>{await(0,Se.Dl)({id:t}),(0,xe.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1({id:t}))},this.onAnnotationUpdate=async t=>{const o=t.from!==t.to,i={id:t.id,dashboardUID:this.props.dashboard.uid,panelId:this.props.panel.id,isRegion:o,time:t.from,timeEnd:o?t.to:0,tags:t.tags,text:t.description};await(0,Se._E)(i),(0,xe.kt)().run({dashboard:this.props.dashboard,range:this.timeSrv.timeRange()}),this.state.context.eventBus.publish(new Ce.n1(i))},this.onChangeTimeRange=t=>{this.timeSrv.setTime({from:(0,ke.zh)(t.from),to:(0,ke.zh)(t.to)})},this.onAddAdHocFilter=t=>{const{key:o,value:i,operator:l}=t,h=(0,dt.ak)().getInstanceSettings(this.props.panel.datasource),p=h&&(0,at.iU)(h);p&&(0,Te.WI)((0,ht.m2)({datasource:p,key:o,operator:l,value:i}))},this.onShowPanelDescription=()=>{const{panel:t}=this.props,o=(0,lt.J)().replace(t.description,t.scopedVars),i=(0,rt.a)(o);return this.descriptionInteractionReported||((0,T.ff)("dashboards_panelheader_description_displayed"),this.descriptionInteractionReported=!0),i},this.onShowPanelLinks=()=>{const{panel:t}=this.props,o=(0,Y.H)(t);if(o){const i=o&&o.getLinks(t.replaceVariables);return i.map(l=>({...l,onClick:(...h)=>{(0,T.ff)("dashboards_panelheader_datalink_clicked",{has_multiple_links:i.length>1}),l.onClick?.(...h)}}))}return[]},this.onOpenInspector=(t,o)=>{t.stopPropagation(),O.E1.partial({inspect:this.props.panel.id,inspectTab:o})},this.onOpenErrorInspect=t=>{t.stopPropagation(),O.E1.partial({inspect:this.props.panel.id,inspectTab:de.q.Error}),(0,T.ff)("dashboards_panelheader_statusmessage_clicked")},this.onCancelQuery=()=>{this.props.panel.getQueryRunner().cancelQuery(),(0,T.ff)("dashboards_panelheader_cancelquery_clicked",{data_state:this.state.data.state})};const a=e.dashboard.events.newScopedBus(`panel:${e.panel.id}`,this.eventFilter);this.state={isFirstLoad:!0,renderCounter:0,refreshWhenInView:!1,context:{eventBus:a,app:this.getPanelContextApp(),sync:this.getSync,onSeriesColorChange:this.onSeriesColorChange,onToggleSeriesVisibility:this.onSeriesVisibilityChange,onAnnotationCreate:this.onAnnotationCreate,onAnnotationUpdate:this.onAnnotationUpdate,onAnnotationDelete:this.onAnnotationDelete,onInstanceStateChange:this.onInstanceStateChange,onToggleLegendSort:this.onToggleLegendSort,canAddAnnotations:e.dashboard.canAddAnnotations.bind(e.dashboard),canEditAnnotations:e.dashboard.canEditAnnotations.bind(e.dashboard),canDeleteAnnotations:e.dashboard.canDeleteAnnotations.bind(e.dashboard),onAddAdHocFilter:this.onAddAdHocFilter},data:this.getInitialPanelDataState()}}getPanelContextApp(){return this.props.isEditing?ye.zj.PanelEditor:this.props.isViewing?ye.zj.PanelViewer:ye.zj.Dashboard}getInitialPanelDataState(){return{state:d.Gu.NotStarted,series:[],timeRange:(0,E.JK)()}}componentDidMount(){const{panel:e,dashboard:a}=this.props;if(this.subs.add(e.events.subscribe(ct.U5,this.onRefresh)),this.subs.add(e.events.subscribe(gt._z,this.onRender)),a.panelInitialized(this.props.panel),this.hasPanelSnapshot){this.setState({data:(0,ft.y)(e,a),isFirstLoad:!1});return}this.wantsQueryExecution||this.setState({isFirstLoad:!1}),this.subs.add(e.getQueryRunner().getData({withTransforms:!0,withFieldConfig:!0}).subscribe({next:t=>this.onDataUpdate(t)})),Oe.A.listen(this)}componentWillUnmount(){this.subs.unsubscribe(),Oe.A.remove(this)}liveTimeChanged(e){const{data:a}=this.state;if(a.timeRange){const t=e.to.valueOf()-a.timeRange.to.valueOf();if(t<100){console.log("Skip tick render",this.props.panel.title,t);return}}this.setState({liveTime:e})}componentDidUpdate(e){const{isInView:a,width:t}=this.props,{context:o}=this.state,i=this.getPanelContextApp();o.app!==i&&this.setState({context:{...o,app:i}}),a!==e.isInView&&a&&this.state.refreshWhenInView&&this.onRefresh(),t!==e.width&&Oe.A.updateInterval(this)}onDataUpdate(e){const{dashboard:a,panel:t,plugin:o}=this.props;if(o.meta.skipDataQuery){this.setState({data:this.getInitialPanelDataState()});return}let{isFirstLoad:i}=this.state,l;switch(e.state){case d.Gu.Loading:if(this.state.data.state===d.Gu.Loading)return;break;case d.Gu.Error:const{error:h,errors:p}=e;p?.length?p.length===1?l=p[0].message:l="Multiple errors found. Click for more details":h&&l!==h.message&&(l=h.message);break;case d.Gu.Done:a.snapshot&&(t.snapshotData=e.series.map(P=>(0,ot.og)(P))),i&&(i=!1);break}this.setState({isFirstLoad:i,errorMessage:l,data:e,liveTime:void 0})}get hasPanelSnapshot(){const{panel:e}=this.props;return e.snapshotData&&e.snapshotData.length}get wantsQueryExecution(){return!(this.props.plugin.meta.skipDataQuery||this.hasPanelSnapshot)}shouldSignalRenderingCompleted(e,a){return e===d.Gu.Done||e===d.Gu.Error||a.skipDataQuery}skipFirstRender(e){const{isFirstLoad:a}=this.state;return this.wantsQueryExecution&&a&&(e===d.Gu.Loading||e===d.Gu.NotStarted)}renderPanelContent(e,a){const{panel:t,plugin:o,dashboard:i}=this.props,{renderCounter:l,data:h}=this.state,{state:p}=h;if(this.skipFirstRender(p))return null;this.shouldSignalRenderingCompleted(p,o.meta)&&We.r.renderingCompleted();const P=o.panel,W=this.state.liveTime??h.timeRange??this.timeSrv.timeRange(),A=t.getOptions();return this.eventFilter.onlyLocal=i.graphTooltip===0,s.createElement(s.Fragment,null,s.createElement(Fe._w,{value:this.state.context},s.createElement(P,{id:t.id,data:h,title:t.title,timeRange:W,timeZone:this.props.dashboard.getTimezone(),options:A,fieldConfig:t.fieldConfig,transparent:t.transparent,width:e,height:a,renderCounter:l,replaceVariables:t.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:i.events})))}renderPanel(e,a){const{panel:t,plugin:o,dashboard:i}=this.props,{renderCounter:l,data:h}=this.state,{theme:p}=Ue.v,{state:P}=h;if(this.skipFirstRender(P))return null;this.shouldSignalRenderingCompleted(P,o.meta)&&We.r.renderingCompleted();const W=o.panel,A=this.state.liveTime??h.timeRange??this.timeSrv.timeRange(),q=this.hasOverlayHeader()?0:p.panelHeaderHeight,he=o.noPadding?0:p.panelPadding,fe=e-he*2-S.QO,G=a-q-he*2-S.QO,le=b()({"panel-content":!0,"panel-content--no-padding":o.noPadding}),$=t.getOptions();this.eventFilter.onlyLocal=i.graphTooltip===0;const pe=this.props.timezone||this.props.dashboard.getTimezone();return s.createElement(s.Fragment,null,s.createElement("div",{className:le},s.createElement(it.b,{meta:o.meta},s.createElement(Fe._w,{value:this.state.context},s.createElement(W,{id:t.id,data:h,title:t.title,timeRange:A,timeZone:pe,options:$,fieldConfig:t.fieldConfig,transparent:t.transparent,width:fe,height:G,renderCounter:l,replaceVariables:t.replaceVariables,onOptionsChange:this.onOptionsChange,onFieldConfigChange:this.onFieldConfigChange,onChangeTimeRange:this.onChangeTimeRange,eventBus:i.events})))))}hasOverlayHeader(){const{panel:e}=this.props,{data:a}=this.state;return a.request&&a.request.timeInfo?!1:!e.hasTitle()}render(){const{dashboard:e,panel:a,isViewing:t,isEditing:o,width:i,height:l,plugin:h}=this.props,{errorMessage:p,data:P}=this.state,{transparent:W}=a,A=P.alertState?.state,q=this.hasOverlayHeader(),he=b()({"panel-container":!0,"panel-container--absolute":x(O.E1.getLocation().pathname),"panel-container--transparent":W,"panel-container--no-title":q,[`panel-alert-state--${A}`]:A!==void 0}),fe=a.getDisplayTitle(),G=h.noPadding?"none":"md",$=(a.links&&a.links.length>0&&this.onShowPanelLinks||P.series.length>0&&P.series.some(re=>(re.meta?.notices?.length??0)>0)||P.request&&P.request.timeInfo||A)&&s.createElement(yt,{key:"title-items",alertState:A,data:P,panelId:a.id,panelLinks:a.links,onShowPanelLinks:this.onShowPanelLinks}),pe=t||o?"":"grid-drag-handle";if(Ue.v.featureToggles.newPanelChromeUI){const re=(a.gridPos?.y??0)===0?-16:void 0,m=s.createElement("div",{"data-testid":"panel-dropdown"},s.createElement(je,{panel:a,dashboard:e,loadingState:P.state}));return s.createElement(Ee.fm,{width:i,height:l,title:fe,loadingState:P.state,statusMessage:p,statusMessageOnClick:this.onOpenErrorInspect,description:a.description?this.onShowPanelDescription:void 0,titleItems:$,menu:this.props.hideMenu?void 0:m,dragClass:pe,dragClassCancel:"grid-drag-cancel",padding:G,hoverHeaderOffset:re,hoverHeader:this.hasOverlayHeader(),displayMode:W?"transparent":"default",onCancelQuery:this.onCancelQuery},(j,oe)=>s.createElement(s.Fragment,null,s.createElement(we.SV,{dependencies:[P,h,a.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover},({error:ne})=>ne?null:this.renderPanelContent(j,oe))))}else return s.createElement("section",{className:he,"aria-label":u.wl.components.Panels.Panel.containerByTitle(a.title)},s.createElement(Ne,{panel:a,dashboard:e,title:a.title,description:a.description,links:a.links,error:p,isEditing:o,isViewing:t,alertState:A,data:P}),s.createElement(we.SV,{dependencies:[P,h,a.getOptions()],onError:this.onPanelError,onRecover:this.onPanelErrorRecover},({error:re})=>re?null:this.renderPanel(i,l)))}}const Ot=(r,e)=>{const a=r.panels[e.stateKey];return a?{plugin:a.plugin,instanceState:a.instanceState}:{plugin:null}},Mt={initPanelState:H.JI,setPanelInstanceState:M.pC},Tt=(0,D.connect)(Ot,Mt);class Ve extends s.PureComponent{constructor(){super(...arguments),this.onInstanceStateChange=e=>{this.props.setPanelInstanceState({key:this.props.stateKey,value:e})},this.onVisibilityChange=e=>{this.props.panel.isInView=e},this.onPanelLoad=()=>{this.props.plugin||this.props.initPanelState(this.props.panel)},this.renderPanel=e=>{const{dashboard:a,panel:t,isViewing:o,isEditing:i,width:l,height:h,plugin:p,timezone:P,hideMenu:W}=this.props;return p?p&&p.angularPanelCtrl?s.createElement(nt,{plugin:p,panel:t,dashboard:a,isViewing:o,isEditing:i,isInView:e,width:l,height:h}):s.createElement(It,{plugin:p,panel:t,dashboard:a,isViewing:o,isEditing:i,isInView:e,width:l,height:h,onInstanceStateChange:this.onInstanceStateChange,timezone:P,hideMenu:W}):null}}componentDidMount(){this.props.panel.isInView=!this.props.lazy,this.props.lazy||this.onPanelLoad()}render(){const{width:e,height:a,lazy:t}=this.props;return t?s.createElement(c,{width:e,height:a,onChange:this.onVisibilityChange,onLoad:this.onPanelLoad},this.renderPanel):this.renderPanel(!0)}}Ve.defaultProps={lazy:!0};const Rt=Tt(Ve)},53821:(se,w,n)=>{n.d(w,{Z:()=>d});var s=n(68404),D=n(41959),H=n(68183),M=n(20308),Q=n(37932),V=n(6554),c=n(19349),R=n(39653),b=(E=>(E.Error="Error",E.Info="Info",E.Links="Links",E))(b||{});class g extends s.Component{constructor(){super(...arguments),this.timeSrv=(0,c.$t)(),this.getInfoMode=()=>{const{panel:u,error:y}=this.props;if(y)return"Error";if(u.description)return"Info";if(u.links&&u.links.length)return"Links"},this.getInfoContent=()=>{const{panel:u}=this.props,y=u.description||"",O=(0,M.J)().replace(y,u.scopedVars),B=(0,D.a)(O),S=this.props.links&&this.props.links.getLinks(u.replaceVariables);return s.createElement("div",{className:"panel-info-content markdown-html"},s.createElement("div",{dangerouslySetInnerHTML:{__html:B}}),S&&S.length>0&&s.createElement("ul",{className:"panel-info-corner-links"},S.map((f,x)=>s.createElement("li",{key:x},s.createElement("a",{className:"panel-info-corner-links__item",href:f.href,target:f.target},f.title)))))},this.onClickError=()=>{Q.E1.partial({inspect:this.props.panel.id,inspectTab:R.q.Error})}}renderCornerType(u,y,O){const B=u==="Error"?"error":"info",S=`panel-info-corner panel-info-corner--${u.toLowerCase()}`,f=H.wl.components.Panels.Panel.headerCornerInfo(u.toLowerCase());return s.createElement(V.u,{content:y,placement:"top-start",theme:B,interactive:!0},s.createElement("button",{type:"button",className:S,onClick:O,"aria-label":f},s.createElement("i",{"aria-hidden":!0,className:"fa"}),s.createElement("span",{className:"panel-info-corner-inner"})))}render(){const{error:u}=this.props,y=this.getInfoMode();return y?y==="Error"&&u?this.renderCornerType(y,u,this.onClickError):y==="Info"||y==="Links"?this.renderCornerType(y,this.getInfoContent):null:null}}const d=g},91551:(se,w,n)=>{n.d(w,{N:()=>g});var s=n(68061),D=n(74188),H=n(85854),M=n(14582),Q=n(89890),V=n(3249),c=n(17882);const R="hideSeriesFrom",b=(0,s.Y4)(R);function g(S,f,x,z){const{overrides:N}=x,I=S,K=N.findIndex(b);if(K<0){if(f===c.R.ToggleSelection){const ie=d([I,...B(N,z)]);return{...x,overrides:[...x.overrides,ie]}}const ee=O(z,I),X=d(ee);return{...x,overrides:[...x.overrides,X]}}const J=Array.from(N),[U]=J.splice(K,1);if(f===c.R.ToggleSelection){let ee=u(U);const X=B(J,z);if(X.length>0&&(ee=ee.filter(ce=>X.indexOf(ce)<0)),ee[0]===I&&ee.length===1)return{...x,overrides:J};const ie=d([I,...X]);return{...x,overrides:[...J,ie]}}const Y=E(U,I);return y(Y,z)?{...x,overrides:J}:{...x,overrides:[...J,Y]}}function d(S,f=D.Ys.exclude,x){return x=x??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:R,matcher:{id:H.mi.byNames,options:{mode:f,names:S,prefix:f===D.Ys.exclude?"All except:":void 0,readOnly:!0}},properties:[{...x,value:{viz:!0,legend:!1,tooltip:!1}}]}}const E=(S,f,x=D.Ys.exclude)=>{const z=S.properties.find(K=>K.id==="custom.hideFrom"),N=u(S),I=N.findIndex(K=>K===f);return I<0?N.push(f):N.splice(I,1),d(N,x,z)},u=S=>{const f=S.matcher.options?.names;return Array.isArray(f)?[...f]:[]},y=(S,f)=>u(S).length===O(f).length,O=(S,f)=>{const x=new Set;for(const z of S)for(const N of z.fields){if(N.type!==M.fS.number)continue;const I=(0,Q.C)(N,z,S);I!==f&&x.add(I)}return Array.from(x)},B=(S,f)=>{let x=[];for(const z of S){const N=z.properties.find(I=>I.id==="custom.hideFrom");if(N!==void 0&&N.value?.legend===!0){const K=V.Ls.get(z.matcher.id).get(z.matcher.options);for(const J of f)for(const U of J.fields){if(U.type!==M.fS.number)continue;const Y=(0,Q.C)(U,J,f);K(U,J,f)&&x.push(Y)}}}return x}},6911:(se,w,n)=>{n.d(w,{A:()=>R});var s=n(924),D=n(46519),H=n(21053);const M=100;class Q{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new s.X(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const g=Date.now();this.budget=(g-this.lastUpdate)/M;const d=this.ok.getValue(),E=this.budget<=this.threshold;if(d!==E&&this.ok.next(E),this.lastUpdate=g,this.isLive&&this.ok.getValue()&&this.timeRange){let u;for(const y of this.listeners){if(!y.panel.props.isInView)continue;if(g-y.last>=y.intervalMs){if(!u){const{raw:B}=this.timeRange;u={raw:B,from:(0,D.CQ)(g-this.liveTimeOffset),to:(0,D.CQ)(g)}}y.panel.liveTimeChanged(u),y.last=g}}}}}setLiveTimeRange(g){if(this.timeRange=g,this.isLive=g?.raw?.to==="now",this.isLive){const d=H.parse(g.raw.from,!1)?.valueOf(),E=H.parse(g.raw.to,!0)?.valueOf();this.liveTimeOffset=E-d;for(const u of this.listeners)u.intervalMs=c(this.liveTimeOffset,u.panel.props.width)}}listen(g){this.listeners.push({last:this.lastUpdate,panel:g,intervalMs:c(6e4,g.props.width)})}remove(g){this.listeners=this.listeners.filter(d=>d.panel!==g)}updateInterval(g){if(!(!this.timeRange||!this.isLive)){for(const d of this.listeners)if(d.panel===g){d.intervalMs=c(this.liveTimeOffset,d.panel.props.width);return}}}}const V=5*60*1e3;function c(b,g){const d=Math.ceil(b/g/100)*100;return d>V?V:d}const R=new Q;setInterval(R.measure,M)},87464:(se,w,n)=>{n.d(w,{ZQ:()=>ce,mV:()=>ie,f1:()=>me,$M:()=>Pe});var s=n(83383),D=n(46519),H=n(55294),M=n(37932),Q=n(54899),V=n(35645),c=n(659),R=n(18271),b=n(60499),g=n(29930),d=n(58379),E=n(87449),u=n(9398),y=n(19349),O=n(30992),B=n(10079),S=n(92624),f=n(81168),x=n(87865),z=n(85803),N=n(87095),I=n(82302),K=n(75552),J=n(41818);function U(C){const L={dashboardId:C.id,dashboardName:C.title,dashboardUid:C.uid,folderName:C.meta.folderTitle,eventName:K.ct.DashboardView};(0,J.r_)(L)}var Y=n(58790);async function ee(C,L,Z){const F=d.Z.getObject(ue);if(F)return me(),F;try{switch(C.routeName){case f.DashboardRoutes.Home:{const v=await g.ae.get("/api/dashboards/home");if(v.redirectUri){const _=s.u.stripBaseFromUrl(v.redirectUri);return M.E1.replace(_),null}return v.meta.canSave=!1,v.meta.canShare=!1,v.meta.canStar=!1,v}case f.DashboardRoutes.Public:return await E.pD.loadDashboard("public",C.urlSlug,C.accessToken);case f.DashboardRoutes.Normal:{const v=await E.pD.loadDashboard(C.urlType,C.urlSlug,C.urlUid);if(C.fixUrl&&v.meta.url&&!B.r0.isPlaying){const _=s.u.stripBaseFromUrl(v.meta.url),T=M.E1.getLocation().pathname;_!==T&&(M.E1.replace({...M.E1.getLocation(),pathname:_}),console.log("not correct url correcting",_,T))}return v}case f.DashboardRoutes.New:return ce(C.urlFolderUid,C.panelType);case f.DashboardRoutes.Path:{const v=C.urlSlug??"";return await E.pD.loadDashboard(f.DashboardRoutes.Path,v,v)}default:throw{message:"Unknown route "+C.routeName}}}catch(v){return(0,Q.kW)(v)&&v.cancelled||(L((0,Y.jA)({message:"Failed to fetch dashboard",error:v})),console.error(v)),null}}const X=(C,L={})=>(C.forEach(Z=>{Z.panels?X(Z.panels,L):Z.targets&&Z.targets.forEach(F=>{F.datasource?.type&&(L[F.datasource.type]?L[F.datasource.type].push(F):L[F.datasource.type]=[F])})}),L);function ie(C){return async(L,Z)=>{L((0,Y.sf)());const F=await ee(C,L,Z);if(!F)return;L((0,Y.Nv)());let v;try{v=new I.f(F.dashboard,F.meta)}catch(te){L((0,Y.jA)({message:"Failed create dashboard model",error:te})),console.error(te);return}const _=Z(),T=M.E1.getSearchObject();T.orgId||M.E1.partial({orgId:_.user.orgId},!0);const ge=(0,y.$t)();(0,u.h4)().setCurrent(v),ge.init(v);const ve=(0,S.mn)(C.urlUid??v.uid);if(await L((0,z.LX)(ve,v)),(0,x.Tl)({dashboard:v,timeSrv:ge}).run({dashboard:v,range:ge.timeRange()}),(0,N.cp)(Z())===ve&&Z().dashboard.initPhase===f.DashboardInitPhase.Services){try{v.processRepeats(),T.autofitpanels&&v.autoFitPanels(window.innerHeight,T.kiosk),C.keybindingSrv.setupDashboardBindings(v)}catch(te){te instanceof Error&&L((0,c.$l)((0,b.t_)("Dashboard init failed",te))),console.error(te)}C.routeName!==f.DashboardRoutes.New?(U(v),O.H.watch(v.uid)):O.H.leave(),v.weekStart!==""?(0,D.Ls)(v.weekStart):(0,D.Ls)(V.v.bootData.user.weekStart),R.Z.publish(new H.Pl({dashboardId:v.uid,orgId:_.user.orgId,userId:_.user.user?.id,grafanaVersion:V.v.buildInfo.version,queries:X(v.panels)})),L((0,Y.dS)(v))}}}function ce(C,L){const Z=V.v.featureToggles.emptyDashboardPage?[]:[{type:L??"add-panel",gridPos:{x:0,y:0,w:12,h:9},title:"Panel Title"}],F={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{title:"New dashboard",panels:Z}};return C&&(F.meta.folderUid=C),F}const ue="DASHBOARD_FROM_LS_KEY";function Pe(C){d.Z.setObject(ue,C)}function me(){d.Z.delete(ue)}},57277:(se,w,n)=>{n.d(w,{y:()=>g});var s=n(16911),D=n(69311),H=n(71398),M=n(49922),Q=n(36998),V=n(47694),c=n(56422),R=n(19349),b=n(2476);function g(d,E){const u=(0,s.F9)(d.snapshotData),y=new c.g,O={dashboard:E,range:(0,D.JK)()},B=y.canWork(O)?y.getAnnotationsInSnapshot(E,d.id):[],S=[new H.i(B)];return{timeRange:(0,b.W1)(d,(0,R.$t)().timeRange()).timeRange,state:M.Gu.Done,series:(0,Q.SM)({data:u,fieldConfig:{defaults:{},overrides:[]},replaceVariables:d.replaceVariables,fieldConfigRegistry:d.plugin.fieldConfigRegistry,theme:V.vc.theme2,timeZone:E.getTimezone()}),annotations:S}}},39653:(se,w,n)=>{n.d(w,{q:()=>s});var s=(D=>(D.Data="data",D.Meta="meta",D.Error="error",D.Stats="stats",D.JSON="json",D.Query="query",D.Help="help",D))(s||{})},69600:(se,w,n)=>{n.d(w,{H:()=>V,n:()=>Q});var s=n(16911),D=n(20112),H=n(94847),M=n(64703);const Q=c=>{const R=c.field.links;if(!(!R||R.length===0))return{getLinks:b=>{const g={};if(c.view){const{dataFrame:E}=c.view;g.__series={value:{name:E.name,refId:E.refId},text:"Series"};const u=c.colIndex!==void 0?E.fields[c.colIndex]:void 0;if(u){if(g.__field={value:{name:u.name,labels:u.labels},text:"Field"},c.rowIndex!==void 0&&c.rowIndex>=0){const{timeField:y}=(0,s.sV)(E);g.__value={value:{raw:u.values.get(c.rowIndex),numeric:c.display.numeric,text:(0,D.zc)(c.display),time:y?y.values.get(c.rowIndex):void 0},text:"Value"}}c.view&&(g.__data={value:{name:E.name,refId:E.refId,fields:(0,H.z)({frame:E,rowIndex:c.rowIndex})},text:"Data"})}else g.__value={value:{raw:c.display.numeric,numeric:c.display.numeric,text:(0,D.zc)(c.display),calc:c.name},text:"Value"}}else console.log("VALUE",c);const d=(E,u,y)=>{const O={...g,...u};return b(E,O,y)};return R.map(E=>(0,M.Bq)().getDataLinkUIModel(E,d,c))}}},V=c=>{const R=c.links;if(!(!R||R.length===0))return{getLinks:()=>R.map(b=>(0,M.Bq)().getDataLinkUIModel(b,c.replaceVariables,c))}}},73952:(se,w,n)=>{n.d(w,{i:()=>s});function s(D,H){return D.panels[H.key]}}}]);

//# sourceMappingURL=6173.bcfd23ec2eaef56b8c90.js.map