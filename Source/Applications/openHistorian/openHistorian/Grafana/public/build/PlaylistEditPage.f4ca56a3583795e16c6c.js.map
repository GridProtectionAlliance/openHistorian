{"version":3,"file":"PlaylistEditPage.f4ca56a3583795e16c6c.js","mappings":"4PAoBO,MAAMA,EAA8B,IAAe,IAAd,MAAEC,GAAY,EACxD,MAAMC,GAASC,EAAAA,EAAAA,YAAWC,EAAAA,IACpB,SAAEC,EAAF,QAAYC,IAAYC,EAAAA,EAAAA,GAAYN,EAAMO,OAAOC,KAMvD,OACE,SAAC,IAAD,CAAMC,MAAM,uBAAZ,UACE,UAAC,aAAD,CAAeC,UAAWL,EAA1B,WACE,eAAIM,UAAWV,EAAOW,WAAtB,4BAEA,cAAGD,UAAWV,EAAOY,YAArB,kMAKA,SAAC,IAAD,CAAcC,SAfHC,MAAAA,UACTC,EAAAA,EAAAA,IAAehB,EAAMO,OAAOC,IAAKJ,GACvCa,EAAAA,gBAAAA,KAAqB,eAaiBb,SAAUA,UAMpD,K,0HCZO,MAAMc,EAAiC,IAUxC,IATJC,SAAUC,EADmC,MAE7CC,EAF6C,MAG7CC,EAH6C,YAI7CC,GAAc,EAJ+B,QAK7CC,EAL6C,SAM7CC,EAN6C,GAO7CC,EAP6C,YAQ7CC,EAAc,QAR+B,mBAS7CC,GACI,EACJ,MAAMC,EAAkBC,GAAAA,EAAUC,GAwBpChB,eACEgB,EACAC,EACAJ,GAEA,MACMK,SADeC,EAAAA,GAAAA,OAAkB,CAAEC,KAAM,UAAWJ,MAAAA,EAAOK,MAAO,OAC9CC,KAAI,IAA0C,IAAzC,GAAEX,EAAF,IAAMlB,EAAM,GAAZ,MAAgB8B,EAAhB,YAAuBC,GAAkB,EACtE,MAAMlB,EAA6B,CACjCK,GAAAA,EACAlB,IAAAA,EACA,CAACwB,GAAS,GAAEO,MAAAA,EAAAA,EAAe,aAAaD,KAG1C,MAAO,CAAEjB,MAAAA,EAAO,CAACW,GAAQX,EAAMW,OAGjC,GAAIJ,EACF,OAAOK,EAAWO,QAAO,QAAC,MAAEnB,GAAH,SAAgBO,EAAmBa,SAASpB,EAAMb,QAG7E,OAAOyB,EA5C6CS,CAAcX,GAAS,GAAIJ,EAAaC,IAAqB,KAC3Ge,EAAStB,EAAQ,CAAEA,MAAAA,EAAO,CAACM,GAAcN,EAAMM,SAAiBiB,EAKtE,OACE,SAAC,EAAAC,YAAD,CACEC,QAASpB,EACTJ,MAAOA,EACPC,YAAaA,EACbwB,gBAAgB,EAChBC,YAAanB,EACbV,SAXc8B,IAChB7B,EAAc6B,MAAAA,OAAD,EAACA,EAAM5B,QAWlB6B,YAAY,mBACZC,iBAAiB,sBACjB9B,MAAOsB,EACPnB,QAASA,EACTC,SAAUA,EACV2B,eAAiBT,GAAWA,EAAOhB,M,gDC1ClC,MAAM0B,EAA8C,IAA2D,IAA1D,KAAEJ,EAAF,SAAQK,EAAR,WAAkBC,EAAlB,SAA8BC,EAA9B,MAAwCC,EAAxC,KAA+CC,GAAW,EACpH,MAAMzD,GAAS0D,EAAAA,EAAAA,WAAUC,GAczB,OACE,gBAAI,aAAYC,EAAAA,GAAAA,MAAAA,aAAAA,QAAhB,UACiB,oBAAdZ,EAAKd,MACJ,gBAAIxB,WAAWmD,EAAAA,EAAAA,IAAG7D,EAAO8D,GAAI9D,EAAOgD,MAApC,WACE,SAAC,EAAAe,KAAD,CAAMC,KAAK,OAAO,aAAYJ,EAAAA,GAAAA,MAAAA,aAAAA,cAC9B,0BAAOZ,EAAKX,WAEZ,KACW,qBAAdW,EAAKd,MACJ,gBAAIxB,WAAWmD,EAAAA,EAAAA,IAAG7D,EAAO8D,GAAI9D,EAAOgD,MAApC,WACE,SAAC,EAAAe,KAAD,CAAMC,KAAK,UAAU,aAAYJ,EAAAA,GAAAA,MAAAA,aAAAA,eACjC,SAACK,EAAA,EAAD,CAAwBlC,MAAOiB,EAAKX,MAAO6B,YAAY,EAAOC,MAAO,GAAtDnB,EAAKvB,OAEpB,MACJ,gBAAIf,WAAWmD,EAAAA,EAAAA,IAAG7D,EAAO8D,GAAI9D,EAAOoE,UAApC,UACIZ,EAQE,MAPF,SAAC,EAAAa,WAAD,CACEL,KAAK,WACLM,KAAK,KACLC,QAxBaC,IACrBA,EAAMC,iBACNlB,EAASP,IAuBD,aAAYY,EAAAA,GAAAA,MAAAA,aAAAA,WACZ1B,KAAK,WAGPuB,EAQE,MAPF,SAAC,EAAAY,WAAD,CACEL,KAAK,aACLM,KAAK,KACLC,QArCeC,IACvBA,EAAMC,iBACNnB,EAAWN,IAoCH,aAAYY,EAAAA,GAAAA,MAAAA,aAAAA,aACZ1B,KAAK,YAGT,SAAC,EAAAmC,WAAD,CACEL,KAAK,QACLM,KAAK,KACLC,QAjDeC,IACrBA,EAAMC,iBACNpB,EAASL,IAgDH,aAAYY,EAAAA,GAAAA,MAAAA,aAAAA,WACZ1B,KAAK,gBArCgDc,EAAKX,QA4CpE,SAASsB,EAAUe,GACjB,MAAO,CACLZ,GAAIa,EAAAA,GAAI;;;;;;;MAQR3B,KAAM2B,EAAAA,GAAI;;;uBAGSD,EAAME,QAAQC;;MAGjCT,SAAUO,EAAAA,GAAI;;;aCpFX,MAAMG,EAAgD,IAA+C,IAA9C,MAAEC,EAAF,SAASxB,EAAT,WAAmBD,EAAnB,SAA+BD,GAAe,EAC1G,OAAqB,IAAjB0B,EAAMC,OACD,IAAP,GACE,yBACE,yBACE,2EAON,8BACGD,EAAM3C,KAAI,CAACY,EAAMiC,KAChB,MAAMzB,EAAkB,IAAVyB,EACRxB,EAAOwB,IAAUF,EAAMC,OAAS,EACtC,OACE,SAAC5B,EAAD,CACEI,MAAOA,EACPC,KAAMA,EACNT,KAAMA,EACNK,SAAUA,EACVC,WAAYA,EACZC,SAAUA,GACLP,EAAKX,a,MCxBf,MAAM6C,EAAwC,IAA+C,IAA9C,MAAEH,EAAF,SAASxB,EAAT,WAAmBD,EAAnB,SAA+BD,GAAe,EAClG,OACE,iBAAK3C,UAAU,gBAAf,iBACE,eAAIA,UAAU,iBAAd,0BAEA,kBAAOA,UAAU,eAAjB,UACE,4BACE,SAACoE,EAAD,CAAmBC,MAAOA,EAAOxB,SAAUA,EAAUD,WAAYA,EAAYD,SAAUA,Y,MCAjG,MAAM8B,EAAY,IAAIC,EAAAA,EAETC,EAAsC,IAA4B,YAA3B,SAAExE,EAAF,SAAYV,GAAe,EAC7E,MAAM,KAAE6D,EAAF,SAAQsB,EAAUP,MAAOQ,GAAcpF,GACvC,MAAE4E,EAAF,QAASS,EAAT,SAAkBC,EAAlB,WAA4BC,EAA5B,SAAwCC,EAAxC,OAAkDC,GCjBnD,SAA0BC,GAC/B,MAAOd,EAAOe,IAAYC,EAAAA,EAAAA,UAAyBF,MAAAA,EAAAA,EAAiB,IAE9DL,GAAUQ,EAAAA,EAAAA,cACbC,IACC,IAAKA,GAAalB,EAAMmB,MAAMlD,GAASA,EAAKvB,KAAOwE,EAAUxE,KAC3D,OAGF,MAAM0E,EAAwB,CAC5B1E,GAAIwE,EAAUxE,GACdY,MAAO4D,EAAUlE,MACjBG,KAAM,kBACNd,MAAO6E,EAAUxE,GAAG2E,SAAS,IAC7BC,MAAOtB,EAAMC,OAAS,GAExBc,EAAS,IAAIf,EAAOoB,MAEtB,CAACpB,IAGGU,GAAWO,EAAAA,EAAAA,cACdM,IACC,MAAMC,EAAMD,EAAK,GACjB,IAAKC,GAAOxB,EAAMmB,MAAMlD,GAASA,EAAK5B,QAAUmF,IAC9C,OAGF,MAAMJ,EAAwB,CAC5B9D,MAAOkE,EACPrE,KAAM,mBACNd,MAAOmF,EACPF,MAAOtB,EAAMC,OAAS,GAExBc,EAAS,IAAIf,EAAOoB,MAEtB,CAACpB,IAGGyB,GAAmBR,EAAAA,EAAAA,cACvB,CAAChD,EAAoByD,KACnB,MAAMC,EAAW,IAAI3B,GACf4B,EAAkBD,EAASE,QAAQ5D,GACnC6D,EAAcF,EAAkBF,EAElCI,GAAe,GAAKA,EAAcH,EAAS1B,SAC7C0B,EAASI,OAAOH,EAAiB,GACjCD,EAASI,OAAOD,EAAa,EAAG7D,IAElC8C,EAASY,KAEX,CAAC3B,IAGGa,GAASI,EAAAA,EAAAA,cACZhD,IACCwD,EAAiBxD,GAAO,KAE1B,CAACwD,IAGGb,GAAWK,EAAAA,EAAAA,cACdhD,IACCwD,EAAiBxD,EAAM,KAEzB,CAACwD,IAGGd,GAAaM,EAAAA,EAAAA,cAChBhD,IACC8C,EAASf,EAAMxC,QAAQwE,GAAMA,IAAM/D,OAErC,CAAC+B,IAGH,MAAO,CAAEA,MAAAA,EAAOS,QAAAA,EAASC,SAAAA,EAAUC,WAAAA,EAAYC,SAAAA,EAAUC,OAAAA,GD1DUoB,CAAiBzB,GACpF,OACE,0BACE,SAAC,EAAA0B,KAAD,CAAMpG,SAAWqG,GAAmBrG,EAAS,OAAD,UAAMqG,EAAN,CAAYnC,MAAAA,KAAUoC,WAAY,SAA9E,SACG,IAA0B,YAAzB,SAAEC,EAAF,OAAYC,GAAa,EACzB,MAAMC,EAA8B,IAAjBvC,EAAMC,QAAgBuC,OAAOC,KAAKH,GAAQrC,OAAS,EACtE,OACE,iCACE,SAAC,EAAAyC,MAAD,CAAO1F,MAAM,OAAOR,UAAW8F,EAAOrD,KAAM0D,MAAOL,MAAAA,GAAF,UAAEA,EAAQrD,YAAV,aAAE,EAAc2D,QAAjE,UACE,SAAC,EAAAC,MAAD,eACE1F,KAAK,QACDkF,EAAS,OAAQ,CAAES,SAAU,qBAFnC,CAGE5E,YAAY,OACZ6E,aAAc9D,EACd,aAAYJ,EAAAA,GAAAA,MAAAA,aAAAA,WAGhB,SAAC,EAAA6D,MAAD,CAAO1F,MAAM,WAAWR,UAAW8F,EAAO/B,SAAUoC,MAAOL,MAAAA,GAAF,UAAEA,EAAQ/B,gBAAV,aAAE,EAAkBqC,QAA7E,UACE,SAAC,EAAAC,MAAD,eACE1F,KAAK,QACDkF,EAAS,WAAY,CAAES,SAAU,yBAFvC,CAGE5E,YAAY,KACZ6E,aAAcxC,MAAAA,EAAAA,EAAY,KAC1B,aAAY1B,EAAAA,GAAAA,MAAAA,aAAAA,cAhBlB,OAoBE,SAACsB,EAAD,CAAeH,MAAOA,EAAOxB,SAAUqC,EAAQtC,WAAYqC,EAAUtC,SAAUqC,MAE/E,iBAAKhF,UAAU,gBAAf,iBACE,eAAIA,UAAU,iBAAd,6BADF,OAGE,SAAC,EAAA+G,MAAD,CAAO1F,MAAM,eAAb,UACE,SAACd,EAAD,CAAqBC,SAAUsE,EAAS/D,GAAG,mBAAmBH,aAAW,QAG3E,SAAC,EAAAmG,MAAD,CAAO1F,MAAM,aAAb,UACE,SAACgG,EAAA,EAAD,CACEzG,aAAW,EACXgF,KAAM,GACN0B,YAAU,EACVC,WAAY9C,EAAU+C,iBACtBhH,SAAUuE,EACVxC,YAAa,WAKnB,UAAC,EAAAkF,gBAAD,YACE,SAAC,EAAAC,OAAD,CAAQlG,KAAK,SAASmG,QAAQ,UAAU7G,SAAU8F,EAAlD,mBAGA,SAAC,EAAAgB,WAAD,CAAYD,QAAQ,YAAYE,KAAO,GAAEC,EAAAA,OAAAA,sBAAzC,iC,sHEnET1H,eAAe2H,EAAetI,SAC7BuI,GAAkB,KAAMC,EAAAA,EAAAA,iBAAgBC,KAAK,iBAAkBzI,KAGhEW,eAAeC,EAAeR,EAAaJ,SAC1CuI,GAAkB,KAAMC,EAAAA,EAAAA,iBAAgBE,IAAK,kBAAiBtI,IAAOJ,KAGtEW,eAAegI,EAAevI,SAC7BmI,GAAkB,KAAMC,EAAAA,EAAAA,iBAAgBI,OAAQ,kBAAiBxI,MAAQ,oBAG1EO,eAAekI,EAAYzI,GAEhC,aAD+BoI,EAAAA,EAAAA,iBAAgBM,IAAK,kBAAiB1I,KAIhEO,eAAeoI,EAAepH,GAEnC,aADoC6G,EAAAA,EAAAA,iBAAgBM,IAAI,kBAAmB,CAAEnH,MAAAA,IAI/EhB,eAAe4H,EAAkBS,GAA0D,IAA5BxB,EAA4B,uDAAlB,iBACvE,UACQwB,KACNC,EAAAA,EAAAA,KAASC,EAAAA,EAAAA,KAAUC,EAAAA,EAAAA,IAA0B3B,KAC7C,MAAO4B,GACHA,aAAaC,QACfJ,EAAAA,EAAAA,KAASC,EAAAA,EAAAA,KAAUI,EAAAA,EAAAA,IAAwB,0BAA2BF,Q,gDChCrE,SAASrJ,EAAkBwE,GAChC,MAAO,CACL9D,YAAa+D,EAAAA,GAAI;;;;MAKjBhE,WAAYgE,EAAAA,GAAI;;uBAEGD,EAAME,QAAQ;oECR9B,SAASvE,EAAYqJ,GAC1B,MAAOvJ,EAAUwJ,IAAe5D,EAAAA,EAAAA,UAAmB,CAAEhB,MAAO,GAAIO,SAAU,KAAMtB,KAAM,GAAIzD,IAAK,MACxFH,EAASwJ,IAAc7D,EAAAA,EAAAA,WAAkB,GAehD,OAbA8D,EAAAA,EAAAA,YAAU,KACa/I,WACnB,IAAK4I,EAEH,YADAE,GAAW,GAGb,MAAM1C,QAAa8B,EAAAA,EAAAA,IAAYU,GAC/BC,EAAYzC,GACZ0C,GAAW,IAEbE,KACC,CAACJ,IAEG,CAAEvJ,SAAAA,EAAUC,QAAAA","sources":["webpack://grafana/./public/app/features/playlist/PlaylistEditPage.tsx","webpack://grafana/./public/app/core/components/OptionsUI/DashboardPickerByID.tsx","webpack://grafana/./public/app/features/playlist/PlaylistTableRow.tsx","webpack://grafana/./public/app/features/playlist/PlaylistTableRows.tsx","webpack://grafana/./public/app/features/playlist/PlaylistTable.tsx","webpack://grafana/./public/app/features/playlist/PlaylistForm.tsx","webpack://grafana/./public/app/features/playlist/usePlaylistItems.tsx","webpack://grafana/./public/app/features/playlist/api.ts","webpack://grafana/./public/app/features/playlist/styles.ts","webpack://grafana/./public/app/features/playlist/usePlaylist.tsx"],"sourcesContent":["import React, { FC } from 'react';\n\nimport { locationService } from '@grafana/runtime';\nimport { useStyles2 } from '@grafana/ui';\nimport { Page } from 'app/core/components/Page/Page';\n\nimport { GrafanaRouteComponentProps } from '../../core/navigation/types';\n\nimport { PlaylistForm } from './PlaylistForm';\nimport { updatePlaylist } from './api';\nimport { getPlaylistStyles } from './styles';\nimport { Playlist } from './types';\nimport { usePlaylist } from './usePlaylist';\n\nexport interface RouteParams {\n  uid: string;\n}\n\ninterface Props extends GrafanaRouteComponentProps<RouteParams> {}\n\nexport const PlaylistEditPage: FC<Props> = ({ match }) => {\n  const styles = useStyles2(getPlaylistStyles);\n  const { playlist, loading } = usePlaylist(match.params.uid);\n  const onSubmit = async (playlist: Playlist) => {\n    await updatePlaylist(match.params.uid, playlist);\n    locationService.push('/playlists');\n  };\n\n  return (\n    <Page navId=\"dashboards/playlists\">\n      <Page.Contents isLoading={loading}>\n        <h3 className={styles.subHeading}>Edit playlist</h3>\n\n        <p className={styles.description}>\n          A playlist rotates through a pre-selected list of dashboards. A playlist can be a great way to build\n          situational awareness, or just show off your metrics to your team or visitors.\n        </p>\n\n        <PlaylistForm onSubmit={onSubmit} playlist={playlist} />\n      </Page.Contents>\n    </Page>\n  );\n};\n\nexport default PlaylistEditPage;\n","import debounce from 'debounce-promise';\nimport React, { FC } from 'react';\n\nimport { SelectableValue } from '@grafana/data';\nimport { AsyncSelect } from '@grafana/ui';\nimport { backendSrv } from 'app/core/services/backend_srv';\n\n/**\n * @deprecated prefer using dashboard uid rather than id\n */\nexport interface DashboardPickerItem {\n  id: number;\n  uid: string;\n  [key: string]: string | number;\n}\n\ninterface Props {\n  onChange: (dashboard?: DashboardPickerItem) => void;\n  value?: DashboardPickerItem;\n  width?: number;\n  isClearable?: boolean;\n  invalid?: boolean;\n  disabled?: boolean;\n  id?: string;\n  optionLabel?: string;\n  /** List of dashboard UIDs to be excluded from the select options */\n  excludedDashboards?: string[];\n}\n\n/**\n * @deprecated prefer using dashboard uid rather than id\n */\nexport const DashboardPickerByID: FC<Props> = ({\n  onChange: propsOnChange,\n  value,\n  width,\n  isClearable = false,\n  invalid,\n  disabled,\n  id,\n  optionLabel = 'label',\n  excludedDashboards,\n}) => {\n  const debouncedSearch = debounce((query: string) => getDashboards(query || '', optionLabel, excludedDashboards), 300);\n  const option = value ? { value, [optionLabel]: value[optionLabel] } : undefined;\n  const onChange = (item: SelectableValue<DashboardPickerItem>) => {\n    propsOnChange(item?.value);\n  };\n\n  return (\n    <AsyncSelect\n      inputId={id}\n      width={width}\n      isClearable={isClearable}\n      defaultOptions={true}\n      loadOptions={debouncedSearch}\n      onChange={onChange}\n      placeholder=\"Select dashboard\"\n      noOptionsMessage=\"No dashboards found\"\n      value={option}\n      invalid={invalid}\n      disabled={disabled}\n      getOptionLabel={(option) => option[optionLabel]}\n    />\n  );\n};\n\nasync function getDashboards(\n  query: string,\n  label: string,\n  excludedDashboards?: string[]\n): Promise<Array<SelectableValue<DashboardPickerItem>>> {\n  const result = await backendSrv.search({ type: 'dash-db', query, limit: 100 });\n  const dashboards = result.map(({ id, uid = '', title, folderTitle }) => {\n    const value: DashboardPickerItem = {\n      id,\n      uid,\n      [label]: `${folderTitle ?? 'General'}/${title}`,\n    };\n\n    return { value, [label]: value[label] };\n  });\n\n  if (excludedDashboards) {\n    return dashboards.filter(({ value }) => !excludedDashboards.includes(value.uid as string));\n  }\n\n  return dashboards;\n}\n","import { css, cx } from '@emotion/css';\nimport React, { FC, MouseEvent } from 'react';\n\nimport { GrafanaTheme } from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { Icon, IconButton, useStyles } from '@grafana/ui';\n\nimport { TagBadge } from '../../core/components/TagFilter/TagBadge';\n\nimport { PlaylistItem } from './types';\n\ninterface PlaylistTableRowProps {\n  first: boolean;\n  last: boolean;\n  item: PlaylistItem;\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTableRow: FC<PlaylistTableRowProps> = ({ item, onDelete, onMoveDown, onMoveUp, first, last }) => {\n  const styles = useStyles(getStyles);\n  const onDeleteClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onDelete(item);\n  };\n  const onMoveDownClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onMoveDown(item);\n  };\n  const onMoveUpClick = (event: MouseEvent) => {\n    event.preventDefault();\n    onMoveUp(item);\n  };\n\n  return (\n    <tr aria-label={selectors.pages.PlaylistForm.itemRow} key={item.title}>\n      {item.type === 'dashboard_by_id' ? (\n        <td className={cx(styles.td, styles.item)}>\n          <Icon name=\"apps\" aria-label={selectors.pages.PlaylistForm.itemIdType} />\n          <span>{item.title}</span>\n        </td>\n      ) : null}\n      {item.type === 'dashboard_by_tag' ? (\n        <td className={cx(styles.td, styles.item)}>\n          <Icon name=\"tag-alt\" aria-label={selectors.pages.PlaylistForm.itemTagType} />\n          <TagBadge key={item.id} label={item.title} removeIcon={false} count={0} />\n        </td>\n      ) : null}\n      <td className={cx(styles.td, styles.settings)}>\n        {!first ? (\n          <IconButton\n            name=\"arrow-up\"\n            size=\"md\"\n            onClick={onMoveUpClick}\n            aria-label={selectors.pages.PlaylistForm.itemMoveUp}\n            type=\"button\"\n          />\n        ) : null}\n        {!last ? (\n          <IconButton\n            name=\"arrow-down\"\n            size=\"md\"\n            onClick={onMoveDownClick}\n            aria-label={selectors.pages.PlaylistForm.itemMoveDown}\n            type=\"button\"\n          />\n        ) : null}\n        <IconButton\n          name=\"times\"\n          size=\"md\"\n          onClick={onDeleteClick}\n          aria-label={selectors.pages.PlaylistForm.itemDelete}\n          type=\"button\"\n        />\n      </td>\n    </tr>\n  );\n};\n\nfunction getStyles(theme: GrafanaTheme) {\n  return {\n    td: css`\n      label: td;\n      line-height: 28px;\n      max-width: 335px;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n      overflow: hidden;\n    `,\n    item: css`\n      label: item;\n      span {\n        margin-left: ${theme.spacing.xs};\n      }\n    `,\n    settings: css`\n      label: settings;\n      text-align: right;\n    `,\n  };\n}\n","import React, { FC } from 'react';\n\nimport { PlaylistTableRow } from './PlaylistTableRow';\nimport { PlaylistItem } from './types';\n\ninterface PlaylistTableRowsProps {\n  items: PlaylistItem[];\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTableRows: FC<PlaylistTableRowsProps> = ({ items, onMoveUp, onMoveDown, onDelete }) => {\n  if (items.length === 0) {\n    return (\n      <tr>\n        <td>\n          <em>Playlist is empty. Add dashboards below.</em>\n        </td>\n      </tr>\n    );\n  }\n\n  return (\n    <>\n      {items.map((item, index) => {\n        const first = index === 0;\n        const last = index === items.length - 1;\n        return (\n          <PlaylistTableRow\n            first={first}\n            last={last}\n            item={item}\n            onDelete={onDelete}\n            onMoveDown={onMoveDown}\n            onMoveUp={onMoveUp}\n            key={item.title}\n          />\n        );\n      })}\n    </>\n  );\n};\n","import React, { FC } from 'react';\n\nimport { PlaylistTableRows } from './PlaylistTableRows';\nimport { PlaylistItem } from './types';\n\ninterface PlaylistTableProps {\n  items: PlaylistItem[];\n  onMoveUp: (item: PlaylistItem) => void;\n  onMoveDown: (item: PlaylistItem) => void;\n  onDelete: (item: PlaylistItem) => void;\n}\n\nexport const PlaylistTable: FC<PlaylistTableProps> = ({ items, onMoveUp, onMoveDown, onDelete }) => {\n  return (\n    <div className=\"gf-form-group\">\n      <h3 className=\"page-headering\">Dashboards</h3>\n\n      <table className=\"filter-table\">\n        <tbody>\n          <PlaylistTableRows items={items} onMoveUp={onMoveUp} onMoveDown={onMoveDown} onDelete={onDelete} />\n        </tbody>\n      </table>\n    </div>\n  );\n};\n","import React, { FC } from 'react';\n\nimport { selectors } from '@grafana/e2e-selectors';\nimport { config } from '@grafana/runtime';\nimport { Button, Field, Form, HorizontalGroup, Input, LinkButton } from '@grafana/ui';\nimport { DashboardPickerByID } from 'app/core/components/OptionsUI/DashboardPickerByID';\n\nimport { TagFilter } from '../../core/components/TagFilter/TagFilter';\nimport { SearchSrv } from '../../core/services/search_srv';\n\nimport { PlaylistTable } from './PlaylistTable';\nimport { Playlist } from './types';\nimport { usePlaylistItems } from './usePlaylistItems';\n\ninterface PlaylistFormProps {\n  onSubmit: (playlist: Playlist) => void;\n  playlist: Playlist;\n}\n\nconst searchSrv = new SearchSrv();\n\nexport const PlaylistForm: FC<PlaylistFormProps> = ({ onSubmit, playlist }) => {\n  const { name, interval, items: propItems } = playlist;\n  const { items, addById, addByTag, deleteItem, moveDown, moveUp } = usePlaylistItems(propItems);\n  return (\n    <div>\n      <Form onSubmit={(list: Playlist) => onSubmit({ ...list, items })} validateOn={'onBlur'}>\n        {({ register, errors }) => {\n          const isDisabled = items.length === 0 || Object.keys(errors).length > 0;\n          return (\n            <>\n              <Field label=\"Name\" invalid={!!errors.name} error={errors?.name?.message}>\n                <Input\n                  type=\"text\"\n                  {...register('name', { required: 'Name is required' })}\n                  placeholder=\"Name\"\n                  defaultValue={name}\n                  aria-label={selectors.pages.PlaylistForm.name}\n                />\n              </Field>\n              <Field label=\"Interval\" invalid={!!errors.interval} error={errors?.interval?.message}>\n                <Input\n                  type=\"text\"\n                  {...register('interval', { required: 'Interval is required' })}\n                  placeholder=\"5m\"\n                  defaultValue={interval ?? '5m'}\n                  aria-label={selectors.pages.PlaylistForm.interval}\n                />\n              </Field>\n\n              <PlaylistTable items={items} onMoveUp={moveUp} onMoveDown={moveDown} onDelete={deleteItem} />\n\n              <div className=\"gf-form-group\">\n                <h3 className=\"page-headering\">Add dashboards</h3>\n\n                <Field label=\"Add by title\">\n                  <DashboardPickerByID onChange={addById} id=\"dashboard-picker\" isClearable />\n                </Field>\n\n                <Field label=\"Add by tag\">\n                  <TagFilter\n                    isClearable\n                    tags={[]}\n                    hideValues\n                    tagOptions={searchSrv.getDashboardTags}\n                    onChange={addByTag}\n                    placeholder={''}\n                  />\n                </Field>\n              </div>\n\n              <HorizontalGroup>\n                <Button type=\"submit\" variant=\"primary\" disabled={isDisabled}>\n                  Save\n                </Button>\n                <LinkButton variant=\"secondary\" href={`${config.appSubUrl}/playlists`}>\n                  Cancel\n                </LinkButton>\n              </HorizontalGroup>\n            </>\n          );\n        }}\n      </Form>\n    </div>\n  );\n};\n","import { useCallback, useState } from 'react';\n\nimport { DashboardPickerItem } from 'app/core/components/OptionsUI/DashboardPickerByID';\n\nimport { PlaylistItem } from './types';\n\nexport function usePlaylistItems(playlistItems?: PlaylistItem[]) {\n  const [items, setItems] = useState<PlaylistItem[]>(playlistItems ?? []);\n\n  const addById = useCallback(\n    (dashboard?: DashboardPickerItem) => {\n      if (!dashboard || items.find((item) => item.id === dashboard.id)) {\n        return;\n      }\n\n      const newItem: PlaylistItem = {\n        id: dashboard.id,\n        title: dashboard.label as string,\n        type: 'dashboard_by_id',\n        value: dashboard.id.toString(10),\n        order: items.length + 1,\n      };\n      setItems([...items, newItem]);\n    },\n    [items]\n  );\n\n  const addByTag = useCallback(\n    (tags: string[]) => {\n      const tag = tags[0];\n      if (!tag || items.find((item) => item.value === tag)) {\n        return;\n      }\n\n      const newItem: PlaylistItem = {\n        title: tag,\n        type: 'dashboard_by_tag',\n        value: tag,\n        order: items.length + 1,\n      };\n      setItems([...items, newItem]);\n    },\n    [items]\n  );\n\n  const movePlaylistItem = useCallback(\n    (item: PlaylistItem, offset: number) => {\n      const newItems = [...items];\n      const currentPosition = newItems.indexOf(item);\n      const newPosition = currentPosition + offset;\n\n      if (newPosition >= 0 && newPosition < newItems.length) {\n        newItems.splice(currentPosition, 1);\n        newItems.splice(newPosition, 0, item);\n      }\n      setItems(newItems);\n    },\n    [items]\n  );\n\n  const moveUp = useCallback(\n    (item: PlaylistItem) => {\n      movePlaylistItem(item, -1);\n    },\n    [movePlaylistItem]\n  );\n\n  const moveDown = useCallback(\n    (item: PlaylistItem) => {\n      movePlaylistItem(item, 1);\n    },\n    [movePlaylistItem]\n  );\n\n  const deleteItem = useCallback(\n    (item: PlaylistItem) => {\n      setItems(items.filter((i) => i !== item));\n    },\n    [items]\n  );\n\n  return { items, addById, addByTag, deleteItem, moveDown, moveUp };\n}\n","import { getBackendSrv } from '@grafana/runtime';\n\nimport { notifyApp } from '../../core/actions';\nimport { createErrorNotification, createSuccessNotification } from '../../core/copy/appNotification';\nimport { dispatch } from '../../store/store';\n\nimport { Playlist, PlaylistDTO } from './types';\n\nexport async function createPlaylist(playlist: Playlist) {\n  await withErrorHandling(() => getBackendSrv().post('/api/playlists', playlist));\n}\n\nexport async function updatePlaylist(uid: string, playlist: Playlist) {\n  await withErrorHandling(() => getBackendSrv().put(`/api/playlists/${uid}`, playlist));\n}\n\nexport async function deletePlaylist(uid: string) {\n  await withErrorHandling(() => getBackendSrv().delete(`/api/playlists/${uid}`), 'Playlist deleted');\n}\n\nexport async function getPlaylist(uid: string): Promise<Playlist> {\n  const result: Playlist = await getBackendSrv().get(`/api/playlists/${uid}`);\n  return result;\n}\n\nexport async function getAllPlaylist(query: string): Promise<PlaylistDTO[]> {\n  const result: PlaylistDTO[] = await getBackendSrv().get('/api/playlists/', { query });\n  return result;\n}\n\nasync function withErrorHandling(apiCall: () => Promise<void>, message = 'Playlist saved') {\n  try {\n    await apiCall();\n    dispatch(notifyApp(createSuccessNotification(message)));\n  } catch (e) {\n    if (e instanceof Error) {\n      dispatch(notifyApp(createErrorNotification('Unable to save playlist', e)));\n    }\n  }\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport function getPlaylistStyles(theme: GrafanaTheme2) {\n  return {\n    description: css`\n      label: description;\n      width: 555px;\n      margin-bottom: 20px;\n    `,\n    subHeading: css`\n      label: sub-heading;\n      margin-bottom: ${theme.spacing(2)};\n    `,\n  };\n}\n","import { useEffect, useState } from 'react';\n\nimport { getPlaylist } from './api';\nimport { Playlist } from './types';\n\nexport function usePlaylist(playlistUid?: string) {\n  const [playlist, setPlaylist] = useState<Playlist>({ items: [], interval: '5m', name: '', uid: '' });\n  const [loading, setLoading] = useState<boolean>(true);\n\n  useEffect(() => {\n    const initPlaylist = async () => {\n      if (!playlistUid) {\n        setLoading(false);\n        return;\n      }\n      const list = await getPlaylist(playlistUid);\n      setPlaylist(list);\n      setLoading(false);\n    };\n    initPlaylist();\n  }, [playlistUid]);\n\n  return { playlist, loading };\n}\n"],"names":["PlaylistEditPage","match","styles","useStyles2","getPlaylistStyles","playlist","loading","usePlaylist","params","uid","navId","isLoading","className","subHeading","description","onSubmit","async","updatePlaylist","locationService","DashboardPickerByID","onChange","propsOnChange","value","width","isClearable","invalid","disabled","id","optionLabel","excludedDashboards","debouncedSearch","debounce","query","label","dashboards","backendSrv","type","limit","map","title","folderTitle","filter","includes","getDashboards","option","undefined","AsyncSelect","inputId","defaultOptions","loadOptions","item","placeholder","noOptionsMessage","getOptionLabel","PlaylistTableRow","onDelete","onMoveDown","onMoveUp","first","last","useStyles","getStyles","selectors","cx","td","Icon","name","TagBadge","removeIcon","count","settings","IconButton","size","onClick","event","preventDefault","theme","css","spacing","xs","PlaylistTableRows","items","length","index","PlaylistTable","searchSrv","SearchSrv","PlaylistForm","interval","propItems","addById","addByTag","deleteItem","moveDown","moveUp","playlistItems","setItems","useState","useCallback","dashboard","find","newItem","toString","order","tags","tag","movePlaylistItem","offset","newItems","currentPosition","indexOf","newPosition","splice","i","usePlaylistItems","Form","list","validateOn","register","errors","isDisabled","Object","keys","Field","error","message","Input","required","defaultValue","TagFilter","hideValues","tagOptions","getDashboardTags","HorizontalGroup","Button","variant","LinkButton","href","config","createPlaylist","withErrorHandling","getBackendSrv","post","put","deletePlaylist","delete","getPlaylist","get","getAllPlaylist","apiCall","dispatch","notifyApp","createSuccessNotification","e","Error","createErrorNotification","playlistUid","setPlaylist","setLoading","useEffect","initPlaylist"],"sourceRoot":""}