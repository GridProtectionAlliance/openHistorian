"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[2770],{1819:(A,O,s)=>{s.d(O,{e:()=>w});var l=s(74848),t=s(32196),C=s(28240),I=s(83195),v=s(14588),y=s(52622),B=s(40845),M=s(72109),V=s(61994),T=s(74007);function S(o,c,j,m,b){const u=o.fields,E=j!=null?u[j]:null,p=u.filter(e=>!e.config.custom?.hideFrom?.tooltip),g=p.find(e=>e.name==="traceID")||u[0],a=[];if(p.filter(e=>g===e).length>0&&a.push(g),a.push(...p.filter(e=>g!==e)),a.length===0)return null;const f=[],h=[],i=new Set;for(const e of a){if(b===y.$N.Single&&e!==E)continue;const n=e.values[c],r=e.display?e.display(n):{text:`${n}`,numeric:+n};e.getLinks&&e.getLinks({calculatedValue:r,valueRowIndex:c}).forEach(d=>{const x=`${d.title}/${d.href}`;i.has(x)||(h.push(d),i.add(x))}),f.push({name:(0,C.Ct)(e,o),value:n,valueString:(0,I.cN)(r),highlight:e===E})}return m&&m!==y.xB.None&&f.sort((e,n)=>v.sortValues(m)(e.value,n.value)),{displayValues:f,links:h}}const w=({data:o,rowIndex:c,columnIndex:j,sortOrder:m,mode:b,header:u,padding:E=0})=>{const p=(0,B.of)(R,E);if(!o||c==null)return null;const g=S(o,c,j,m,b);if(g==null)return null;const{displayValues:a,links:f}=g;return u==="Exemplar"?(0,l.jsx)(T.i,{displayValues:a,links:f,header:u}):(0,l.jsxs)("div",{className:p.wrapper,children:[u&&(0,l.jsx)("div",{className:p.header,children:(0,l.jsx)("span",{className:p.title,children:u})}),(0,l.jsx)("table",{className:p.infoWrap,children:(0,l.jsxs)("tbody",{children:[a.map((h,i)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:h.name}),(0,l.jsx)("td",{children:(0,V.A)(h.valueString)})]},`${i}/${c}`)),f.map((h,i)=>(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Link"}),(0,l.jsx)("td",{colSpan:2,children:(0,l.jsx)(M.Y,{href:h.href,external:h.target==="_blank",weight:"medium",inline:!1,children:h.title})})]},i))]})})]})},R=(o,c=0)=>({wrapper:(0,t.css)({padding:`${c}px`,background:o.components.tooltip.background,borderRadius:o.shape.borderRadius(2)}),header:(0,t.css)({background:o.colors.background.secondary,alignItems:"center",alignContent:"center",display:"flex",paddingBottom:o.spacing(1)}),title:(0,t.css)({fontWeight:o.typography.fontWeightMedium,overflow:"hidden",display:"inline-block",whiteSpace:"nowrap",textOverflow:"ellipsis",flexGrow:1}),infoWrap:(0,t.css)({padding:o.spacing(1),background:"transparent",border:"none",th:{fontWeight:o.typography.fontWeightMedium,padding:o.spacing(.25,2,.25,0)},tr:{borderBottom:`1px solid ${o.colors.border.weak}`,"&:last-child":{borderBottom:"none"}}}),link:(0,t.css)({color:o.colors.text.link})})},73756:(A,O,s)=>{s.r(O),s.d(O,{plugin:()=>h});var l=s(65158),t=s(74848),C=s(96540),I=s(64423),v=s(69129),y=s(26272),B=s(40276),M=s(1819);class V extends C.Component{constructor(){super(...arguments),this.subscription=new I.yU,this.state={}}componentDidMount(){const{eventBus:e}=this.props;this.subscription.add(e.subscribe(v.b_,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(v.ql,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(y.kb,n=>{this.setState({event:n})})),this.subscription.add(e.subscribe(y.Tq,n=>{this.setState({event:n})}))}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{event:e}=this.state;if(!e)return(0,t.jsx)("div",{children:"no events yet"});const{type:n,payload:r,origin:d}=e;return(0,t.jsxs)(B.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:[(0,t.jsxs)("h3",{children:["Origin: ",d?.path]}),(0,t.jsxs)("span",{children:["Type: ",n]}),!!r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("pre",{children:JSON.stringify(r.point,null,"  ")}),r.data&&(0,t.jsx)(M.e,{data:r.data,rowIndex:r.rowIndex,columnIndex:r.columnIndex})]})]})}}var T=s(36120);let S=100;class w extends C.PureComponent{constructor(e){super(e),this.history=new T.$({capacity:40,append:"head"}),this.eventObserver={next:r=>{const d=r.origin;this.history.add({key:S++,type:r.type,path:d?.path,payload:r.payload}),this.setState({counter:S})}},this.state={counter:S};const n=[];n.push(e.eventBus.getStream(v.b_).subscribe(this.eventObserver)),n.push(e.eventBus.getStream(v.ql).subscribe(this.eventObserver)),n.push(e.eventBus.getStream(v.LO).subscribe(this.eventObserver)),this.subs=n}componentWillUnmount(){for(const e of this.subs)e.unsubscribe()}render(){return(0,t.jsx)(B.E,{autoHeightMin:"100%",autoHeightMax:"100%",children:this.history.map((e,n)=>(0,t.jsxs)("div",{children:[JSON.stringify(e.path)," ",e.type," / X:",JSON.stringify(e.payload.x)," / Y:",JSON.stringify(e.payload.y)]},e.key))})}}var R=s(21423),o=s(75059),c=s(28240),j=s(29158);class m extends C.Component{constructor(){super(...arguments),this.lastRender=Date.now(),this.counters={render:0,dataChanged:0,schemaChanged:0},this.resetCounters=()=>{this.counters={render:0,dataChanged:0,schemaChanged:0},this.forceUpdate()}}shouldComponentUpdate(e){const{data:n,options:r}=this.props;if(e.data!==n&&(this.counters.dataChanged++,r.counters?.schemaChanged)){const d=e.data?.series,x=n.series;x&&d&&((0,R.J3)(x,d,R.bW)||this.counters.schemaChanged++)}return!0}render(){const{data:e,options:n}=this.props,r=n.counters??{render:!1,dataChanged:!1,schemaChanged:!1};this.counters.render++;const d=Date.now(),x=d-this.lastRender;this.lastRender=d;const L=o.AS.get(o.gy.lastNotNull);return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(j.K,{name:"step-backward",title:"reset counters",onClick:this.resetCounters,tooltip:"Step back"}),(0,t.jsxs)("span",{children:[r.render&&(0,t.jsxs)("span",{children:["Render: ",this.counters.render,"\xA0"]}),r.dataChanged&&(0,t.jsxs)("span",{children:["Data: ",this.counters.dataChanged,"\xA0"]}),r.schemaChanged&&(0,t.jsxs)("span",{children:["Schema: ",this.counters.schemaChanged,"\xA0"]}),(0,t.jsxs)("span",{children:["TIME: ",x,"ms"]})]})]}),e.series&&e.series.map((D,W)=>(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{children:[(0,c.Ri)(D,W)," (",D.length,")"]}),(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:"Field"}),(0,t.jsx)("td",{children:"Type"}),(0,t.jsx)("td",{children:"Last"})]})}),(0,t.jsx)("tbody",{children:D.fields.map((P,U)=>{const N=L.reduce(P,!1,!1)[L.id];return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:(0,c.Ct)(P,D,e.series)}),(0,t.jsx)("td",{children:P.type}),(0,t.jsx)("td",{children:`${N}`})]},`${U}/${P.name}`)})})]})]},`${W}/${D.refId}`))]})}}var b=s(79041),u=s(88575),E=s(10354);function p(i){const e=(0,b.d2)(),n=r=>{e.onInstanceStateChange({name:r.currentTarget.value})};return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(u.D,{label:"State name",children:(0,t.jsx)(E.p,{value:e.instanceState?.name??"",onChange:n})})})}function g({value:i,context:e,onChange:n,item:r}){return(0,t.jsxs)("div",{children:["Current value: ",e.instanceState?.name," "]})}var a=(i=>(i.Cursor="cursor",i.Events="events",i.Render="render",i.State="State",i.ThrowError="ThrowError",i))(a||{});class f extends C.Component{render(){const{options:e}=this.props;switch(e.mode){case a.Events:return(0,t.jsx)(w,{eventBus:this.props.eventBus});case a.Cursor:return(0,t.jsx)(V,{eventBus:this.props.eventBus});case a.State:return(0,t.jsx)(p,{...this.props});case a.ThrowError:throw new Error("I failed you and for that i am deeply sorry");default:return(0,t.jsx)(m,{...this.props})}}}const h=new l.m(f).useFieldConfig().setPanelOptions(i=>{i.addSelect({path:"mode",name:"Mode",defaultValue:a.Render,settings:{options:[{label:"Render",value:a.Render},{label:"Events",value:a.Events},{label:"Cursor",value:a.Cursor},{label:"Cursor",value:a.Cursor},{label:"Share state",value:a.State},{label:"Throw error",value:a.ThrowError}]}}).addCustomEditor({id:"stateView",path:"stateView",name:"State view",defaultValue:"",showIf:({mode:e})=>e===a.State,editor:g}).addBooleanSwitch({path:"counters.render",name:"Render count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addBooleanSwitch({path:"counters.dataChanged",name:"Data changed count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addBooleanSwitch({path:"counters.schemaChanged",name:"Schema changed count",defaultValue:!0,showIf:({mode:e})=>e===a.Render}).addDashboardPicker({path:"dashboardUID",name:"Dashboard",settings:{placeholder:"Select dashboard",isClearable:!0}})})}}]);

//# sourceMappingURL=debugPanel.fd6073389b14ba349795.js.map