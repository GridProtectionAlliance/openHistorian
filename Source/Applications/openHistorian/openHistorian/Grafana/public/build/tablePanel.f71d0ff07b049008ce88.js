"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3525],{24310:(_,D,o)=>{o.d(D,{L:()=>A});var p=o(74848),L=o(32196),R=o(94624),P=o(28240),V=o(1173),H=o(97152),T=o(32264),i=o(40845),n=o(79041),M=o(77093),U=o(90182),w=o(65885);function A(s){const{data:l,height:d,width:f,options:c,fieldConfig:b,id:y,timeRange:h}=s,E=(0,i.$j)(),O=(0,n.d2)(),j=(0,w.gy)(l.series)?(0,w.S5)(l.series):l.series,K=j?.length,Y=j.some(x=>x.fields.length>0),G=W(j,c),Z=j[G];let z=d;if(!K||!Y)return(0,p.jsx)(H.a,{panelId:y,fieldConfig:b,data:l});if(K>1){const x=E.spacing.gridSize*E.components.height.md,B=E.spacing.gridSize;z=d-x-B}const k=O.sync&&O.sync()!==R.y.Off,$=(0,p.jsx)(M.X,{height:z,width:f,data:Z,noHeader:!c.showHeader,showTypeIcons:c.showTypeIcons,resizable:!0,initialSortBy:c.sortBy,onSortByChange:x=>C(x,s),onColumnResize:(x,B)=>F(x,B,s),onCellFilterAdded:O.onAddAdHocFilter,footerOptions:c.footer,enablePagination:c.footer?.enablePagination,cellHeight:c.cellHeight,timeRange:h,enableSharedCrosshair:T.$.featureToggles.tableSharedCrosshair&&k,fieldConfig:b});if(K===1)return $;const J=j.map((x,B)=>({label:(0,P.Ri)(x),value:B}));return(0,p.jsxs)("div",{className:e.wrapper,children:[$,(0,p.jsx)("div",{className:e.selectWrapper,children:(0,p.jsx)(U.l6,{options:J,value:J[G],onChange:x=>N(x,s)})})]})}function W(s,l){return l.frameIndex>0&&l.frameIndex<s.length?l.frameIndex:0}function F(s,l,d){const{fieldConfig:f}=d,{overrides:c}=f,b=V.Ct.byName,y="custom.width",h=c.find(E=>E.matcher.id===b&&E.matcher.options===s);if(h){const E=h.properties.find(O=>O.id===y);E?E.value=l:h.properties.push({id:y,value:l})}else c.push({matcher:{id:b,options:s},properties:[{id:y,value:l}]});d.onFieldConfigChange({...f,overrides:c})}function C(s,l){l.onOptionsChange({...l.options,sortBy:s})}function N(s,l){l.onOptionsChange({...l.options,frameIndex:s.value||0})}const e={wrapper:(0,L.css)`
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
  `,selectWrapper:(0,L.css)`
    padding: 8px 8px 0px 8px;
  `}},65885:(_,D,o)=>{o.d(D,{S5:()=>C,fq:()=>H,gy:()=>N,l1:()=>W});var p=o(2543),L=o.n(p),R=o(1173),P=o(50082),V=o(11261);const H=e=>(!e.pluginVersion&&"columns"in e&&console.log("Was angular table",e),e.options),T={timeseries_to_rows:"seriesToRows",timeseries_to_columns:"seriesToColumns",timeseries_aggregations:"reduce",table:"merge"},i={avg:"mean",min:"min",max:"max",total:"sum",current:"lastNotNull",count:"count"},n={cell:"color-background",row:"color-background",value:"color-text"},M=(e,s)=>[-1/0,...e].map((l,d)=>({color:s[d],value:(0,p.isNumber)(l)?l:parseInt(l,10)})),U=(e,s)=>{const l=e.transformations??[];if(Object.keys(T).includes(s.transform)){const d={reducers:[]};s.transform==="timeseries_aggregations"&&(d.includeTimeField=!1,d.reducers=s.columns.map(f=>i[f.value])),l.push({id:T[s.transform],options:d})}return l},w=e=>{const l={matcher:{id:/^\/.*\/$/.test(e.pattern)?R.Ct.byRegexp:R.Ct.byName,options:e.pattern},properties:[]};return e.alias&&l.properties.push({id:"displayName",value:e.alias}),e.unit&&l.properties.push({id:"unit",value:e.unit}),e.decimals&&l.properties.push({id:"decimals",value:e.decimals}),e.type==="date"&&l.properties.push({id:"unit",value:`time: ${e.dateFormat}`}),e.type==="hidden"&&l.properties.push({id:"custom.hidden",value:!0}),e.link&&l.properties.push({id:"links",value:[{title:(0,p.defaultTo)(e.linkTooltip,""),url:(0,p.defaultTo)(e.linkUrl,""),targetBlank:(0,p.defaultTo)(e.linkTargetBlank,!1)}]}),e.colorMode&&l.properties.push({id:"custom.cellOptions",value:{type:n[e.colorMode]}}),e.align&&l.properties.push({id:"custom.align",value:e.align==="auto"?null:e.align}),e.thresholds?.length&&l.properties.push({id:"thresholds",value:{mode:P.O.Absolute,steps:M(e.thresholds,e.colors)}}),l},A=e=>{let s={custom:{}};if(e){if(s=(0,p.omitBy)({unit:e.unit,decimals:e.decimals,displayName:e.alias,custom:{align:e.align==="auto"?null:e.align}},p.isNil),e.thresholds.length){const l={mode:P.O.Absolute,steps:M(e.thresholds,e.colors)};s.thresholds=l}e.colorMode&&(s.custom.cellOptions={type:n[e.colorMode]})}return s},W=(e,s,l)=>{if(s==="table-old"&&l.angular){const d=l.angular,f=U(e,d),c=d.styles.find(h=>h.pattern==="/.*/"),b=A(c),y=d.styles.filter(h=>h.pattern!=="/.*/").map(w);e.transformations=f,e.fieldConfig={defaults:b,overrides:y}}return{}},F=e=>e?.filter(s=>s.meta?.custom?.parentRowIndex===void 0)||[e?.[0]],C=e=>{const s=[];return F(e).filter(d=>!!d&&d.length!==0)?.forEach(d=>{const f=e?.filter(h=>d.refId===h.refId&&h.meta?.custom?.parentRowIndex!==void 0),c=(0,p.groupBy)(f,h=>h.meta?.custom?.parentRowIndex),b=Object.keys(c).map(h=>c[h]),y={...d};f&&f.length>0&&y.fields.push({name:"nested",type:V.PU.nestedFrames,config:{},values:b}),s.push(y)}),s},N=e=>e?.some(s=>s.meta?.custom?.parentRowIndex!==void 0)},55312:(_,D,o)=>{o.r(D),o.d(D,{plugin:()=>ie});var p=o(65158),L=o(27310),R=o(69550),P=o(75059),V=o(11261),H=o(28240),T=o(39651),i=o(52622),n=o(74848),M=o(15292);function U({onChange:t,value:a,context:r}){const g=u=>{u?.currentTarget.checked&&(r.options.footer.show=!1),t(u?.currentTarget.checked)};return(0,n.jsx)(M.d,{value:!!a,onChange:g})}var w=o(32196),A=o(2543),W=o(96540),F=o(40845),C=o(88575),N=o(90182),e=o(60029),s=o(39938);const l=({cellOptions:t,onChange:a})=>{const r=()=>{t.wrapText=!t.wrapText,a(t)},g=(0,n.jsxs)(e.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,n.jsx)(s.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(C.D,{label:g,children:(0,n.jsx)(M.d,{value:t.wrapText,onChange:r})})})};var d=o(67061),f=o(94354);function c({cellOptions:t,onChange:a}){const r=u=>{t.mode=u,a(t)},g=u=>{t.valueDisplayMode=u,a(t)};return(0,n.jsxs)(d.B,{direction:"column",gap:0,children:[(0,n.jsx)(C.D,{label:"Gauge display mode",children:(0,n.jsx)(f.z,{value:t?.mode??i.eX.Gradient,onChange:r,options:b})}),(0,n.jsx)(C.D,{label:"Value display",children:(0,n.jsx)(f.z,{value:t?.valueDisplayMode??i.$l.Text,onChange:g,options:y})})]})}const b=[{value:i.eX.Basic,label:"Basic"},{value:i.eX.Gradient,label:"Gradient"},{value:i.eX.Lcd,label:"Retro LCD"}],y=[{value:i.$l.Color,label:"Value color"},{value:i.$l.Text,label:"Text color"},{value:i.$l.Hidden,label:"Hidden"}],h=[{value:i.Wq.Basic,label:"Basic"},{value:i.Wq.Gradient,label:"Gradient"}],E=({cellOptions:t,onChange:a})=>{const r=m=>{t.mode=m,a(t)},g=()=>{t.applyToRow=!t.applyToRow,a(t)},u=()=>{t.wrapText=!t.wrapText,a(t)},v=(0,n.jsxs)(e.J,{description:"If selected text will be wrapped to the width of text in the configured column",children:["Wrap text ",(0,n.jsx)(s.E,{text:"Alpha",color:"blue",style:{fontSize:"11px",marginLeft:"5px",lineHeight:"1.2"}})]});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.D,{label:"Background display mode",children:(0,n.jsx)(f.z,{value:t?.mode??i.Wq.Gradient,onChange:r,options:h})}),(0,n.jsx)(C.D,{label:"Apply to entire row",description:"If selected the entire row will be colored as this cell would be.",children:(0,n.jsx)(M.d,{value:t.applyToRow,onChange:g})}),(0,n.jsx)(C.D,{label:v,children:(0,n.jsx)(M.d,{value:t.wrapText,onChange:u})})]})};var O=o(10354);const j=({cellOptions:t,onChange:a})=>{const r=u=>{t.alt=u.currentTarget.value,a(t)},g=u=>{t.title=u.currentTarget.value,a(t)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(C.D,{label:"Alt text",description:"Alternative text that will be displayed if an image can't be displayed or for users who use a screen reader",children:(0,n.jsx)(O.p,{onChange:r,defaultValue:t.alt})}),(0,n.jsx)(C.D,{label:"Title text",description:"Text that will be displayed when the image is hovered by a cursor",children:(0,n.jsx)(O.p,{onChange:g,defaultValue:t.title})})]})};var K=o(28528),Y=o(66864),G=o(30355),Z=o(41706);const z=["hideValue","drawStyle","lineInterpolation","barAlignment","lineWidth","fillOpacity","gradientMode","lineStyle","spanNulls","showPoints","pointSize"];function k(t){const a=(0,Z.V)(t);return{...a,useCustomConfig:r=>{a.useCustomConfig?.(r),r.addBooleanSwitch({path:"hideValue",name:"Hide value"})}}}const $=t=>{const{cellOptions:a,onChange:r}=t,g=(0,W.useMemo)(()=>{const m=k(G.t);return(0,K.O)(m,"ChartCell")},[]),u=(0,F.of)(x),v={...G.t,...a};return(0,n.jsx)(Y.gW,{children:g.list(z.map(m=>`custom.${m}`)).map(m=>{if(m.showIf&&!m.showIf(v))return null;const q=m.editor,I=m.path;return(0,n.jsx)(C.D,{label:m.name,className:u.field,children:(0,n.jsx)(q,{onChange:S=>r({...a,[I]:S}),value:(J(I,v)?v[I]:void 0)??m.defaultValue,item:m,context:{data:[]}})},m.id)})})};function J(t,a){return t in a}const x=()=>({field:(0,w.css)`
    width: 100%;

    // @TODO don't show "scheme" option for custom gradient mode.
    // it needs thresholds to work, which are not supported
    // for area chart cell right now
    [title='Use color scheme to define gradient'] {
      display: none;
    }
  `}),B=({value:t,onChange:a})=>{const r=t.type,g=(0,F.of)(ae),u=ee.find(S=>S.value.type===r);let[v,m]=(0,W.useState)({});const q=S=>{S.value!==void 0&&(t=S.value,v[t.type]!==void 0&&Object.keys(v[t.type]).length>1&&(t=(0,A.merge)(t,v[t.type])),a(t))},I=S=>{v[t.type]=(0,A.merge)(t,S),m(v),a(v[t.type])};return(0,n.jsxs)("div",{className:g.fixBottomMargin,children:[(0,n.jsx)(C.D,{children:(0,n.jsx)(N.l6,{options:ee,value:u,onChange:q})}),(r===i.ob.Auto||r===i.ob.ColorText)&&(0,n.jsx)(l,{cellOptions:t,onChange:I}),r===i.ob.Gauge&&(0,n.jsx)(c,{cellOptions:t,onChange:I}),r===i.ob.ColorBackground&&(0,n.jsx)(E,{cellOptions:t,onChange:I}),r===i.ob.Sparkline&&(0,n.jsx)($,{cellOptions:t,onChange:I}),r===i.ob.Image&&(0,n.jsx)(j,{cellOptions:t,onChange:I})]})},ee=[{value:{type:i.ob.Auto},label:"Auto"},{value:{type:i.ob.Sparkline},label:"Sparkline"},{value:{type:i.ob.ColorText},label:"Colored text"},{value:{type:i.ob.ColorBackground},label:"Colored background"},{value:{type:i.ob.Gauge},label:"Gauge"},{value:{type:i.ob.DataLinks},label:"Data links"},{value:{type:i.ob.JSONView},label:"JSON View"},{value:{type:i.ob.Image},label:"Image"}],ae=t=>({fixBottomMargin:(0,w.css)({marginBottom:t.spacing(-2)})});var ne=o(24310),te=o(65885);const X={cellHeight:i.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]};var le=o(38824);class se{getSuggestionsForData(a){const r=a.getListAppender({name:le.m.Table,pluginId:"table",options:{},fieldConfig:{defaults:{custom:{}},overrides:[]},cardOptions:{previewModifier:g=>{g.fieldConfig.defaults.custom.minWidth=50}}});a.dataSummary.fieldCount===0?r.append({cardOptions:{imgSrc:"public/app/plugins/panel/table/img/icn-table-panel.svg"}}):r.append({})}}const Q="Table footer",oe=["Cell options"],ie=new p.m(ne.L).setPanelChangeHandler(te.l1).setMigrationHandler(te.fq).useFieldConfig({useCustomConfig:t=>{t.addNumberInput({path:"minWidth",name:"Minimum column width",description:"The minimum width for column auto resizing",settings:{placeholder:"150",min:50,max:500},shouldApply:()=>!0,defaultValue:T.gB.minWidth}).addNumberInput({path:"width",name:"Column width",settings:{placeholder:"auto",min:20,max:300},shouldApply:()=>!0,defaultValue:T.gB.width}).addRadio({path:"align",name:"Column alignment",settings:{options:[{label:"Auto",value:"auto"},{label:"Left",value:"left"},{label:"Center",value:"center"},{label:"Right",value:"right"}]},defaultValue:T.gB.align}).addCustomEditor({id:"cellOptions",path:"cellOptions",name:"Cell type",editor:B,override:B,defaultValue:T.gB.cellOptions,process:L.hS,category:oe,shouldApply:()=>!0}).addBooleanSwitch({path:"inspect",name:"Cell value inspect",description:"Enable cell value inspection in a modal window",defaultValue:!1,category:oe,showIf:a=>a.cellOptions.type===i.ob.Auto||a.cellOptions.type===i.ob.JSONView||a.cellOptions.type===i.ob.ColorText||a.cellOptions.type===i.ob.ColorBackground}).addBooleanSwitch({path:"filterable",name:"Column filter",description:"Enables/disables field filters in table",defaultValue:T.gB.filterable}).addBooleanSwitch({path:"hidden",name:"Hide in table",defaultValue:void 0,hideFromDefaults:!0})}}).setPanelOptions(t=>{t.addBooleanSwitch({path:"showHeader",name:"Show table header",defaultValue:X.showHeader}).addRadio({path:"cellHeight",name:"Cell height",defaultValue:X.cellHeight,settings:{options:[{value:i.qM.Sm,label:"Small"},{value:i.qM.Md,label:"Medium"},{value:i.qM.Lg,label:"Large"}]}}).addBooleanSwitch({path:"footer.show",category:[Q],name:"Show table footer",defaultValue:X.footer?.show}).addCustomEditor({id:"footer.reducer",category:[Q],path:"footer.reducer",name:"Calculation",description:"Choose a reducer function / calculation",editor:R.D.get("stats-picker").editor,defaultValue:[P.gy.sum],showIf:a=>a.footer?.show}).addBooleanSwitch({path:"footer.countRows",category:[Q],name:"Count rows",description:"Display a single count for all data rows",defaultValue:X.footer?.countRows,showIf:a=>a.footer?.reducer?.length===1&&a.footer?.reducer[0]===P.gy.count}).addMultiSelect({path:"footer.fields",category:[Q],name:"Fields",description:"Select the fields that should be calculated",settings:{allowCustomValue:!1,options:[],placeholder:"All Numeric Fields",getOptions:async a=>{const r=[];if(a&&a.data&&a.data.length>0){const g=a.data[0];for(const u of g.fields)if(u.type===V.PU.number){const v=(0,H.Ct)(u,g,a.data),m=u.name;r.push({value:m,label:v})}}return r}},defaultValue:"",showIf:a=>a.footer?.show&&!a.footer?.countRows}).addCustomEditor({id:"footer.enablePagination",path:"footer.enablePagination",name:"Enable pagination",editor:U})}).setSuggestionsSupplier(new se)}}]);

//# sourceMappingURL=tablePanel.f71d0ff07b049008ce88.js.map