{"version":3,"file":"canvasPanel.0aecf24cc66f39c9144e.js","mappings":"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","sources":["webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipContent.tsx","webpack://grafana/./packages/grafana-ui/src/components/Actions/ActionButton.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipFooter.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipHeader.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipColorIndicator.tsx","webpack://grafana/./packages/grafana-ui/src/components/VizTooltip/VizTooltipRow.tsx","webpack://grafana/./public/app/core/components/Layers/AddLayerButton.tsx","webpack://grafana/./public/app/features/actions/utils.ts","webpack://grafana/./public/app/features/canvas/elements/notFound.tsx","webpack://grafana/./public/app/plugins/panel/canvas/types.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ParamsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/utils.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/APIEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ButtonStyleEditor.tsx","webpack://grafana/./public/app/features/canvas/element.ts","webpack://grafana/./public/app/features/canvas/types.ts","webpack://grafana/./public/app/features/canvas/elements/button.tsx","webpack://grafana/./public/app/features/canvas/elements/cloud.tsx","webpack://grafana/./public/app/features/canvas/elements/droneFront.tsx","webpack://grafana/./public/app/features/canvas/elements/droneSide.tsx","webpack://grafana/./public/app/features/canvas/elements/droneTop.tsx","webpack://grafana/./public/app/features/canvas/elements/ellipse.tsx","webpack://grafana/./public/app/features/canvas/elements/icon.tsx","webpack://grafana/./public/app/features/canvas/elements/metricValue.tsx","webpack://grafana/./public/app/features/canvas/elements/parallelogram.tsx","webpack://grafana/./public/app/features/canvas/elements/rectangle.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/database.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/single.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/stack.tsx","webpack://grafana/./public/app/features/canvas/elements/server/types/terminal.tsx","webpack://grafana/./public/app/features/canvas/elements/server/server.tsx","webpack://grafana/./public/app/features/canvas/elements/text.tsx","webpack://grafana/./public/app/features/canvas/elements/triangle.tsx","webpack://grafana/./public/app/features/canvas/elements/windTurbine.tsx","webpack://grafana/./public/app/features/canvas/registry.ts","webpack://grafana/./public/app/features/canvas/runtime/element.tsx","webpack://grafana/./public/app/plugins/panel/canvas/utils.ts","webpack://grafana/./node_modules/framework-utils/dist/utils.esm.js","webpack://grafana/./node_modules/@daybrush/utils/dist/utils.esm.js","webpack://grafana/./node_modules/@egjs/list-differ/dist/list-differ.esm.js","webpack://grafana/./node_modules/croact/dist/croact.esm.js","webpack://grafana/./node_modules/@egjs/agent/dist/agent.esm.js","webpack://grafana/./node_modules/@scena/matrix/dist/matrix.esm.js","webpack://grafana/./node_modules/css-to-mat/dist/css-to-mat.esm.js","webpack://grafana/./node_modules/@egjs/children-differ/dist/children-differ.esm.js","webpack://grafana/./node_modules/@scena/event-emitter/dist/event-emitter.esm.js","webpack://grafana/./node_modules/@scena/dragscroll/dist/dragscroll.esm.js","webpack://grafana/./node_modules/overlap-area/dist/overlap-area.esm.js","webpack://grafana/./node_modules/gesto/dist/gesto.esm.js","webpack://grafana/./node_modules/css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/croact-css-styled/dist/styled.esm.js","webpack://grafana/./node_modules/croact-moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/moveable/dist/moveable.esm.js","webpack://grafana/./node_modules/keycon/dist/keycon.esm.js","webpack://grafana/./node_modules/selecto/dist/selecto.esm.js","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionAnchors.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneElementManagement.ts","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/ConnectionSVG.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/connections/Connections.tsx","webpack://grafana/./public/app/features/canvas/runtime/ables.tsx","webpack://grafana/./public/app/features/canvas/runtime/sceneAbleManagement.ts","webpack://grafana/./public/app/features/canvas/runtime/frame.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasContextMenu.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/CanvasTooltip.tsx","webpack://grafana/./node_modules/react-zoom-pan-pinch/dist/index.esm.js","webpack://grafana/./public/app/features/canvas/runtime/SceneTransformWrapper.tsx","webpack://grafana/./public/app/features/canvas/runtime/root.tsx","webpack://grafana/./public/app/features/canvas/runtime/scene.tsx","webpack://grafana/./public/app/plugins/panel/canvas/components/SetBackground.tsx","webpack://grafana/./public/app/features/dimensions/editors/BackgroundSizeEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/LineStyleEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ActionsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/DataLinksEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/options.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/connectionEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/ConstraintSelectionBox.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/QuickPositioning.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/PlacementEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/element/elementEditor.tsx","webpack://grafana/./node_modules/rc-tree/es/contextTypes.js","webpack://grafana/./node_modules/rc-tree/es/DropIndicator.js","webpack://grafana/./node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty.js","webpack://grafana/./node_modules/rc-tree/es/Indent.js","webpack://grafana/./node_modules/rc-tree/es/TreeNode.js","webpack://grafana/./node_modules/rc-tree/es/useUnmount.js","webpack://grafana/./node_modules/rc-tree/es/MotionTreeNode.js","webpack://grafana/./node_modules/rc-tree/es/utils/diffUtil.js","webpack://grafana/./node_modules/rc-tree/es/NodeList.js","webpack://grafana/./node_modules/rc-tree/es/util.js","webpack://grafana/./node_modules/rc-tree/es/Tree.js","webpack://grafana/./node_modules/rc-tree/es/index.js","webpack://grafana/./public/app/plugins/panel/canvas/globalStyles.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNodeTitle.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/tree.ts","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/TreeNavigationEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/layer/layerEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/TabsEditor.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEditBody.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/inline/InlineEdit.tsx","webpack://grafana/./public/app/plugins/panel/canvas/CanvasPanel.tsx","webpack://grafana/./public/app/plugins/panel/canvas/editor/panZoomHelp.tsx","webpack://grafana/./public/app/plugins/panel/canvas/migrations.ts","webpack://grafana/./public/app/plugins/panel/canvas/module.tsx","webpack://grafana/./public/app/plugins/panel/canvas/panelcfg.gen.ts","webpack://grafana/./public/app/plugins/panel/status-history/utils.ts"],"sourcesContent":["import { css } from '@emotion/css';\nimport { CSSProperties, ReactNode } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface VizTooltipContentProps {\n  items: VizTooltipItem[];\n  children?: ReactNode;\n  scrollable?: boolean;\n  isPinned: boolean;\n  maxHeight?: number;\n}\n\nexport const VizTooltipContent = ({\n  items,\n  children,\n  isPinned,\n  scrollable = false,\n  maxHeight,\n}: VizTooltipContentProps) => {\n  const styles = useStyles2(getStyles);\n\n  const scrollableStyle: CSSProperties = scrollable\n    ? {\n        maxHeight: maxHeight,\n        overflowY: 'auto',\n      }\n    : {};\n\n  return (\n    <div className={styles.wrapper} style={scrollableStyle}>\n      {items.map(({ label, value, color, colorIndicator, colorPlacement, isActive, lineStyle }, i) => (\n        <VizTooltipRow\n          key={i}\n          label={label}\n          value={value}\n          color={color}\n          colorIndicator={colorIndicator}\n          colorPlacement={colorPlacement}\n          isActive={isActive}\n          justify={'space-between'}\n          isPinned={isPinned}\n          lineStyle={lineStyle}\n          showValueScroll={!scrollable}\n        />\n      ))}\n      {children}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    gap: 2,\n    borderTop: `1px solid ${theme.colors.border.medium}`,\n    padding: theme.spacing(1),\n  }),\n});\n","import { ActionModel, Field } from '@grafana/data';\n\nimport { Button, ButtonProps } from '../Button';\n\ntype ActionButtonProps = ButtonProps & {\n  action: ActionModel<Field>;\n};\n\n/**\n * @internal\n */\nexport function ActionButton({ action, ...buttonProps }: ActionButtonProps) {\n  return (\n    <Button variant=\"primary\" size=\"sm\" onClick={action.onClick} {...buttonProps}>\n      {action.title}\n    </Button>\n  );\n}\n","import { css } from '@emotion/css';\n\nimport { ActionModel, Field, GrafanaTheme2, LinkModel } from '@grafana/data';\n\nimport { Button, DataLinkButton, Stack } from '..';\nimport { useStyles2 } from '../../themes';\nimport { ActionButton } from '../Actions/ActionButton';\n\ninterface VizTooltipFooterProps {\n  dataLinks: Array<LinkModel<Field>>;\n  actions?: Array<ActionModel<Field>>;\n  annotate?: () => void;\n}\n\nexport const ADD_ANNOTATION_ID = 'add-annotation-button';\n\nconst renderDataLinks = (dataLinks: LinkModel[], styles: ReturnType<typeof getStyles>) => {\n  return (\n    <Stack direction=\"column\" justifyContent=\"flex-start\" gap={0.5}>\n      {dataLinks.map((link, i) => (\n        <DataLinkButton link={link} key={i} buttonProps={{ className: styles.dataLinkButton, fill: 'text' }} />\n      ))}\n    </Stack>\n  );\n};\n\nconst renderActions = (actions: ActionModel[]) => {\n  return (\n    <Stack direction=\"column\" justifyContent=\"flex-start\">\n      {actions.map((action, i) => (\n        <ActionButton key={i} action={action} variant=\"secondary\" />\n      ))}\n    </Stack>\n  );\n};\n\nexport const VizTooltipFooter = ({ dataLinks, actions, annotate }: VizTooltipFooterProps) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <div className={styles.wrapper}>\n      {dataLinks.length > 0 && <div className={styles.dataLinks}>{renderDataLinks(dataLinks, styles)}</div>}\n      {actions && actions.length > 0 && <div className={styles.dataLinks}>{renderActions(actions)}</div>}\n      {annotate != null && (\n        <div className={styles.addAnnotations}>\n          <Button icon=\"comment-alt\" variant=\"secondary\" size=\"sm\" id={ADD_ANNOTATION_ID} onClick={annotate}>\n            Add annotation\n          </Button>\n        </div>\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: theme.spacing(0),\n  }),\n  dataLinks: css({\n    borderTop: `1px solid ${theme.colors.border.medium}`,\n    padding: theme.spacing(1),\n  }),\n  addAnnotations: css({\n    borderTop: `1px solid ${theme.colors.border.medium}`,\n    padding: theme.spacing(1),\n  }),\n  dataLinkButton: css({\n    cursor: 'pointer',\n    '&:hover': {\n      textDecoration: 'underline',\n      background: 'none',\n    },\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes';\n\nimport { VizTooltipRow } from './VizTooltipRow';\nimport { VizTooltipItem } from './types';\n\ninterface Props {\n  item: VizTooltipItem;\n  isPinned: boolean;\n}\nexport const VizTooltipHeader = ({ item, isPinned }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const { label, value, color, colorIndicator } = item;\n\n  return (\n    <div className={styles.wrapper}>\n      <VizTooltipRow\n        label={label}\n        value={value}\n        color={color}\n        colorIndicator={colorIndicator}\n        marginRight={'22px'}\n        isPinned={isPinned}\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    display: 'flex',\n    flexDirection: 'column',\n    flex: 1,\n    padding: theme.spacing(1),\n    lineHeight: 1,\n  }),\n});\n","import { css, cx } from '@emotion/css';\n\nimport { FALLBACK_COLOR, GrafanaTheme2 } from '@grafana/data';\nimport { LineStyle } from '@grafana/schema';\n\nimport { useStyles2 } from '../../themes';\nimport { SeriesIcon } from '../VizLegend/SeriesIcon';\n\nimport { ColorIndicator, DEFAULT_COLOR_INDICATOR } from './types';\nimport { getColorIndicatorClass } from './utils';\n\nexport enum ColorIndicatorPosition {\n  Leading,\n  Trailing,\n}\n\ninterface Props {\n  color?: string;\n  colorIndicator?: ColorIndicator;\n  position?: ColorIndicatorPosition;\n  lineStyle?: LineStyle;\n}\n\nexport type ColorIndicatorStyles = ReturnType<typeof getStyles>;\n\nexport const VizTooltipColorIndicator = ({\n  color = FALLBACK_COLOR,\n  colorIndicator = DEFAULT_COLOR_INDICATOR,\n  position = ColorIndicatorPosition.Leading,\n  lineStyle,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  if (colorIndicator === ColorIndicator.series) {\n    return (\n      <SeriesIcon\n        color={color}\n        lineStyle={lineStyle}\n        className={position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing}\n      />\n    );\n  }\n\n  return (\n    <span\n      style={{ backgroundColor: color }}\n      className={cx(\n        position === ColorIndicatorPosition.Leading ? styles.leading : styles.trailing,\n        getColorIndicatorClass(colorIndicator, styles)\n      )}\n    />\n  );\n};\n\n// @TODO Update classes/add svgs\nconst getStyles = (theme: GrafanaTheme2) => ({\n  leading: css({\n    marginRight: theme.spacing(0.5),\n  }),\n  trailing: css({\n    marginLeft: theme.spacing(0.5),\n  }),\n  value: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.default,\n    fontWeight: 500,\n    minWidth: '12px',\n  }),\n  hexagon: css({}),\n  pie_1_4: css({}),\n  pie_2_4: css({}),\n  pie_3_4: css({}),\n  marker_sm: css({\n    width: '4px',\n    height: '4px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '4px',\n  }),\n  marker_md: css({\n    width: '8px',\n    height: '8px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '8px',\n  }),\n  marker_lg: css({\n    width: '12px',\n    height: '12px',\n    borderRadius: theme.shape.radius.circle,\n    minWidth: '12px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { CSSProperties, ReactNode, useEffect, useRef, useState } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nimport { useStyles2 } from '../../themes';\nimport { InlineToast } from '../InlineToast/InlineToast';\nimport { Tooltip } from '../Tooltip';\n\nimport { ColorIndicatorPosition, VizTooltipColorIndicator } from './VizTooltipColorIndicator';\nimport { ColorPlacement, VizTooltipItem } from './types';\n\ninterface VizTooltipRowProps extends Omit<VizTooltipItem, 'value'> {\n  value: string | number | null | ReactNode;\n  justify?: string;\n  isActive?: boolean; // for series list\n  marginRight?: string;\n  isPinned: boolean;\n  showValueScroll?: boolean;\n}\n\nenum LabelValueTypes {\n  label = 'label',\n  value = 'value',\n}\n\nconst SUCCESSFULLY_COPIED_TEXT = 'Copied to clipboard';\nconst SHOW_SUCCESS_DURATION = 2 * 1000;\nconst HORIZONTAL_PX_PER_CHAR = 7;\n\nexport const VizTooltipRow = ({\n  label,\n  value,\n  color,\n  colorIndicator,\n  colorPlacement = ColorPlacement.first,\n  justify = 'flex-start',\n  isActive = false,\n  marginRight = '0px',\n  isPinned,\n  lineStyle,\n  showValueScroll,\n}: VizTooltipRowProps) => {\n  const styles = useStyles2(getStyles, justify, marginRight);\n\n  const innerValueScrollStyle: CSSProperties = showValueScroll\n    ? {\n        maxHeight: 55,\n        whiteSpace: 'wrap',\n        wordBreak: 'break-word',\n        overflowY: 'auto',\n      }\n    : {\n        whiteSpace: 'wrap',\n        wordBreak: 'break-word',\n      };\n\n  const [showLabelTooltip, setShowLabelTooltip] = useState(false);\n\n  const [copiedText, setCopiedText] = useState<Record<string, string> | null>(null);\n  const [showCopySuccess, setShowCopySuccess] = useState(false);\n\n  const labelRef = useRef<null | HTMLDivElement>(null);\n  const valueRef = useRef<null | HTMLDivElement>(null);\n\n  useEffect(() => {\n    let timeoutId: ReturnType<typeof setTimeout>;\n\n    if (showCopySuccess) {\n      timeoutId = setTimeout(() => {\n        setShowCopySuccess(false);\n      }, SHOW_SUCCESS_DURATION);\n    }\n\n    return () => {\n      window.clearTimeout(timeoutId);\n    };\n  }, [showCopySuccess]);\n\n  const copyToClipboard = async (text: string, type: LabelValueTypes) => {\n    if (!(navigator?.clipboard && window.isSecureContext)) {\n      fallbackCopyToClipboard(text, type);\n      return;\n    }\n\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedText({ [`${type}`]: text });\n      setShowCopySuccess(true);\n    } catch (error) {\n      setCopiedText(null);\n    }\n  };\n\n  const fallbackCopyToClipboard = (text: string, type: LabelValueTypes) => {\n    // Use a fallback method for browsers/contexts that don't support the Clipboard API.\n    const textarea = document.createElement('textarea');\n    labelRef.current?.appendChild(textarea);\n    textarea.value = text;\n    textarea.focus();\n    textarea.select();\n    try {\n      const successful = document.execCommand('copy');\n      if (successful) {\n        setCopiedText({ [`${type}`]: text });\n        setShowCopySuccess(true);\n      }\n    } catch (err) {\n      console.error('Unable to copy to clipboard', err);\n    }\n\n    textarea.remove();\n  };\n\n  const onMouseEnterLabel = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (event.currentTarget.offsetWidth < event.currentTarget.scrollWidth) {\n      setShowLabelTooltip(true);\n    }\n  };\n\n  const onMouseLeaveLabel = () => setShowLabelTooltip(false);\n\n  // if label is > 50% window width, try to put label/value pairs on new lines\n  if (label.length * HORIZONTAL_PX_PER_CHAR > window.innerWidth / 2) {\n    label = label.replaceAll('{', '{\\n  ').replaceAll('}', '\\n}').replaceAll(', ', ',\\n  ');\n  }\n\n  return (\n    <div className={styles.contentWrapper}>\n      {(color || label) && (\n        <div className={styles.valueWrapper}>\n          {color && colorPlacement === ColorPlacement.first && (\n            <VizTooltipColorIndicator color={color} colorIndicator={colorIndicator} lineStyle={lineStyle} />\n          )}\n          {!isPinned ? (\n            <div className={cx(styles.label, isActive && styles.activeSeries)}>{label}</div>\n          ) : (\n            <>\n              <Tooltip content={label} interactive={false} show={showLabelTooltip}>\n                <>\n                  {showCopySuccess && copiedText?.label && (\n                    <InlineToast placement=\"top\" referenceElement={labelRef.current}>\n                      {SUCCESSFULLY_COPIED_TEXT}\n                    </InlineToast>\n                  )}\n                  {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n                  <div\n                    className={cx(styles.label, isActive && styles.activeSeries, navigator?.clipboard && styles.copy)}\n                    onMouseEnter={onMouseEnterLabel}\n                    onMouseLeave={onMouseLeaveLabel}\n                    onClick={() => copyToClipboard(label, LabelValueTypes.label)}\n                    ref={labelRef}\n                  >\n                    {label}\n                  </div>\n                </>\n              </Tooltip>\n            </>\n          )}\n        </div>\n      )}\n\n      <div className={styles.valueWrapper}>\n        {color && colorPlacement === ColorPlacement.leading && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Leading}\n            lineStyle={lineStyle}\n          />\n        )}\n\n        {!isPinned ? (\n          <div className={cx(styles.value, isActive)} style={innerValueScrollStyle}>\n            {value}\n          </div>\n        ) : (\n          <>\n            {showCopySuccess && copiedText?.value && (\n              <InlineToast placement=\"top\" referenceElement={valueRef.current}>\n                {SUCCESSFULLY_COPIED_TEXT}\n              </InlineToast>\n            )}\n            {/* eslint-disable-next-line jsx-a11y/click-events-have-key-events,jsx-a11y/no-static-element-interactions */}\n            <div\n              className={cx(styles.value, isActive, navigator?.clipboard && styles.copy)}\n              style={innerValueScrollStyle}\n              onClick={() => copyToClipboard(value ? value.toString() : '', LabelValueTypes.value)}\n              ref={valueRef}\n            >\n              {value}\n            </div>\n          </>\n        )}\n\n        {color && colorPlacement === ColorPlacement.trailing && (\n          <VizTooltipColorIndicator\n            color={color}\n            colorIndicator={colorIndicator}\n            position={ColorIndicatorPosition.Trailing}\n            lineStyle={lineStyle}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, justify: string, marginRight: string) => ({\n  contentWrapper: css({\n    display: 'flex',\n    alignItems: 'start',\n    justifyContent: justify,\n    marginRight: marginRight,\n  }),\n  label: css({\n    color: theme.colors.text.secondary,\n    fontWeight: 400,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    marginRight: theme.spacing(2),\n  }),\n  value: css({\n    fontWeight: 500,\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  }),\n  valueWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n  }),\n  activeSeries: css({\n    fontWeight: theme.typography.fontWeightBold,\n    color: theme.colors.text.maxContrast,\n  }),\n  copy: css({\n    cursor: 'pointer',\n  }),\n});\n","import { SelectableValue } from '@grafana/data';\nimport { ValuePicker } from '@grafana/ui';\n\nexport type AddLayerButtonProps = {\n  onChange: (sel: SelectableValue<string>) => void;\n  options: Array<SelectableValue<string>>;\n  label: string;\n};\n\nexport const AddLayerButton = ({ onChange, options, label }: AddLayerButtonProps) => {\n  return (\n    <ValuePicker\n      icon=\"plus\"\n      label={label}\n      variant=\"secondary\"\n      options={options}\n      onChange={onChange}\n      isFullWidth={true}\n    />\n  );\n};\n","import {\n  Action,\n  ActionModel,\n  AppEvents,\n  DataContextScopedVar,\n  DataFrame,\n  DataLink,\n  Field,\n  FieldType,\n  getFieldDataContextClone,\n  InterpolateFunction,\n  ScopedVars,\n  textUtil,\n  ValueLinkConfig,\n} from '@grafana/data';\nimport { BackendSrvRequest, getBackendSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\n\nimport { HttpRequestMethod } from '../../plugins/panel/canvas/panelcfg.gen';\nimport { createAbsoluteUrl, RelativeUrl } from '../alerting/unified/utils/url';\n\n/** @internal */\nexport const getActions = (\n  frame: DataFrame,\n  field: Field,\n  fieldScopedVars: ScopedVars,\n  replaceVariables: InterpolateFunction,\n  actions: Action[],\n  config: ValueLinkConfig\n): Array<ActionModel<Field>> => {\n  if (!actions || actions.length === 0) {\n    return [];\n  }\n\n  const actionModels = actions.map((action: Action) => {\n    const dataContext: DataContextScopedVar = getFieldDataContextClone(frame, field, fieldScopedVars);\n    const actionScopedVars = {\n      ...fieldScopedVars,\n      __dataContext: dataContext,\n    };\n\n    const boundReplaceVariables: InterpolateFunction = (value, scopedVars, format) => {\n      return replaceVariables(value, { ...actionScopedVars, ...scopedVars }, format);\n    };\n\n    // We are not displaying reduction result\n    if (config.valueRowIndex !== undefined && !isNaN(config.valueRowIndex)) {\n      dataContext.value.rowIndex = config.valueRowIndex;\n    } else {\n      dataContext.value.calculatedValue = config.calculatedValue;\n    }\n\n    let actionModel: ActionModel<Field> = { title: '', onClick: (e) => {} };\n\n    actionModel = {\n      title: replaceVariables(action.title || '', actionScopedVars),\n      onClick: (evt: MouseEvent, origin: Field) => {\n        buildActionOnClick(action, boundReplaceVariables);\n      },\n    };\n\n    return actionModel;\n  });\n\n  return actionModels.filter((action): action is ActionModel => !!action);\n};\n\n/** @internal */\nconst buildActionOnClick = (action: Action, replaceVariables: InterpolateFunction) => {\n  try {\n    const url = new URL(getUrl(replaceVariables(action.fetch.url)));\n\n    const requestHeaders: Record<string, string> = {};\n\n    let request: BackendSrvRequest = {\n      url: url.toString(),\n      method: action.fetch.method,\n      data: getData(action, replaceVariables),\n      headers: requestHeaders,\n    };\n\n    if (action.fetch.headers) {\n      action.fetch.headers.forEach(([name, value]) => {\n        requestHeaders[replaceVariables(name)] = replaceVariables(value);\n      });\n    }\n\n    if (action.fetch.queryParams) {\n      action.fetch.queryParams?.forEach(([name, value]) => {\n        url.searchParams.append(replaceVariables(name), replaceVariables(value));\n      });\n\n      request.url = url.toString();\n    }\n\n    requestHeaders['X-Grafana-Action'] = '1';\n    request.headers = requestHeaders;\n\n    getBackendSrv()\n      .fetch(request)\n      .subscribe({\n        error: (error) => {\n          appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n          console.error(error);\n        },\n        complete: () => {\n          appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n        },\n      });\n  } catch (error) {\n    appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n    console.error(error);\n    return;\n  }\n};\n\n/** @internal */\n// @TODO update return type\nexport const getActionsDefaultField = (dataLinks: DataLink[] = [], actions: Action[] = []) => {\n  return {\n    name: 'Default field',\n    type: FieldType.string,\n    config: { links: dataLinks, actions: actions },\n    values: [],\n  };\n};\n\n/** @internal */\nconst getUrl = (endpoint: string) => {\n  const isRelativeUrl = endpoint.startsWith('/');\n  if (isRelativeUrl) {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const sanitizedRelativeURL = textUtil.sanitizeUrl(endpoint) as RelativeUrl;\n    endpoint = createAbsoluteUrl(sanitizedRelativeURL, []);\n  }\n\n  return endpoint;\n};\n\n/** @internal */\nconst getData = (action: Action, replaceVariables: InterpolateFunction) => {\n  let data: string | undefined = action.fetch.body ? replaceVariables(action.fetch.body) : '{}';\n  if (action.fetch.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n","import { PureComponent } from 'react';\n\nimport { CanvasElementItem, CanvasElementProps } from '../element';\n\nclass NotFoundDisplay extends PureComponent<CanvasElementProps> {\n  render() {\n    const { config } = this.props;\n    return (\n      <div>\n        <h3>NOT FOUND:</h3>\n        <pre>{JSON.stringify(config, null, 2)}</pre>\n      </div>\n    );\n  }\n}\n\nexport const notFoundItem: CanvasElementItem = {\n  id: 'not-found',\n  name: 'Not found',\n  description: 'Display when element type is not found in the registry',\n\n  display: NotFoundDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n};\n","import { ElementState } from '../../../features/canvas/runtime/element';\n\nimport { CanvasConnection, ConnectionCoordinates } from './panelcfg.gen';\n\nexport enum LayerActionID {\n  Delete = 'delete',\n  Duplicate = 'duplicate',\n  MoveTop = 'move-top',\n  MoveBottom = 'move-bottom',\n}\n\nexport interface DragNode {\n  key: number;\n  dataRef: ElementState;\n}\n\nexport interface DropNode extends DragNode {\n  pos: string;\n}\n\nexport enum InlineEditTabs {\n  ElementManagement = 'element-management',\n  SelectedElement = 'selected-element',\n  SelectedConnection = 'selected-connection',\n}\n\nexport type AnchorPoint = {\n  x: number;\n  y: number;\n};\n\nexport interface CanvasTooltipPayload {\n  anchorPoint: AnchorPoint | undefined;\n  element: ElementState | undefined;\n  isOpen?: boolean;\n}\n\nexport interface ConnectionState {\n  index: number; // array index from the source\n  source: ElementState;\n  target: ElementState;\n  info: CanvasConnection;\n  vertices?: ConnectionCoordinates[];\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n}\n\nexport enum LineStyle {\n  Solid = 'solid',\n  Dashed = 'dashed',\n  Dotted = 'dotted',\n}\n\nexport enum StrokeDasharray {\n  Solid = '0',\n  Dashed = '8 8',\n  Dotted = '3',\n}\n","import { useState } from 'react';\nimport * as React from 'react';\n\nimport { IconButton, Input, Stack } from '@grafana/ui';\n\ninterface Props {\n  onChange: (v: Array<[string, string]>) => void;\n  value: Array<[string, string]>;\n}\n\nexport const ParamsEditor = ({ value, onChange }: Props) => {\n  const [paramName, setParamName] = useState('');\n  const [paramValue, setParamValue] = useState('');\n\n  const changeParamValue = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamValue(currentTarget.value);\n  };\n\n  const changeParamName = ({ currentTarget }: React.ChangeEvent<HTMLInputElement>) => {\n    setParamName(currentTarget.value);\n  };\n\n  const removeParam = (key: string) => () => {\n    const updatedParams = value.filter((param) => param[0] !== key);\n    onChange(updatedParams);\n  };\n\n  const addParam = () => {\n    const key = paramName;\n    let newParams: Array<[string, string]>;\n    if (value) {\n      newParams = value.filter((e) => e[0] !== key);\n    } else {\n      newParams = [];\n    }\n    newParams.push([key, paramValue]);\n    newParams.sort((a, b) => a[0].localeCompare(b[0]));\n\n    setParamName('');\n    setParamValue('');\n    onChange(newParams);\n  };\n\n  const isAddParamsDisabled = !paramName && !paramValue;\n\n  return (\n    <div>\n      <Stack direction=\"row\">\n        <Input placeholder=\"Key\" value={paramName} onChange={changeParamName} />\n        <Input placeholder=\"Value\" value={paramValue} onChange={changeParamValue} />\n        <IconButton aria-label=\"add\" name=\"plus-circle\" onClick={addParam} disabled={isAddParamsDisabled} />\n      </Stack>\n      <Stack direction=\"column\">\n        {Array.from(value || []).map((entry) => (\n          <Stack key={entry[0]} direction=\"row\">\n            <Input disabled value={entry[0]} />\n            <Input disabled value={entry[1]} />\n            <IconButton aria-label=\"delete\" onClick={removeParam(entry[0])} name=\"trash-alt\" />\n          </Stack>\n        ))}\n      </Stack>\n    </div>\n  );\n};\n","import { AppEvents, textUtil } from '@grafana/data';\nimport { BackendSrvRequest, getBackendSrv, getTemplateSrv } from '@grafana/runtime';\nimport { appEvents } from 'app/core/core';\nimport { createAbsoluteUrl, RelativeUrl } from 'app/features/alerting/unified/utils/url';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { APIEditorConfig } from './APIEditor';\n\ntype IsLoadingCallback = (loading: boolean) => void;\n\nexport const callApi = (api: APIEditorConfig, updateLoadingStateCallback?: IsLoadingCallback) => {\n  if (!api.endpoint) {\n    appEvents.emit(AppEvents.alertError, ['API endpoint is not defined.']);\n    return;\n  }\n\n  const request = getRequest(api);\n\n  getBackendSrv()\n    .fetch(request)\n    .subscribe({\n      error: (error) => {\n        appEvents.emit(AppEvents.alertError, ['An error has occurred. Check console output for more details.']);\n        console.error('API call error: ', error);\n        updateLoadingStateCallback && updateLoadingStateCallback(false);\n      },\n      complete: () => {\n        appEvents.emit(AppEvents.alertSuccess, ['API call was successful']);\n        updateLoadingStateCallback && updateLoadingStateCallback(false);\n      },\n    });\n};\n\nexport const interpolateVariables = (text: string) => {\n  const panel = getDashboardSrv().getCurrent()?.panelInEdit;\n  return getTemplateSrv().replace(text, panel?.scopedVars);\n};\n\nexport const getRequest = (api: APIEditorConfig) => {\n  const endpoint = getEndpoint(interpolateVariables(api.endpoint));\n  const url = new URL(endpoint);\n\n  const requestHeaders: Record<string, string> = {};\n\n  let request: BackendSrvRequest = {\n    url: url.toString(),\n    method: api.method,\n    data: getData(api),\n    headers: requestHeaders,\n  };\n\n  if (api.headerParams) {\n    api.headerParams.forEach(([name, value]) => {\n      requestHeaders[interpolateVariables(name)] = interpolateVariables(value);\n    });\n  }\n\n  if (api.queryParams) {\n    api.queryParams?.forEach(([name, value]) => {\n      url.searchParams.append(interpolateVariables(name), interpolateVariables(value));\n    });\n\n    request.url = url.toString();\n  }\n\n  if (api.method === HttpRequestMethod.POST) {\n    requestHeaders['Content-Type'] = api.contentType!;\n  }\n\n  requestHeaders['X-Grafana-Action'] = '1';\n  request.headers = requestHeaders;\n\n  return request;\n};\n\nconst getData = (api: APIEditorConfig) => {\n  let data: string | undefined = api.data ? interpolateVariables(api.data) : '{}';\n  if (api.method === HttpRequestMethod.GET) {\n    data = undefined;\n  }\n\n  return data;\n};\n\nconst getEndpoint = (endpoint: string) => {\n  const isRelativeUrl = endpoint.startsWith('/');\n  if (isRelativeUrl) {\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const sanitizedRelativeURL = textUtil.sanitizeUrl(endpoint) as RelativeUrl;\n    endpoint = createAbsoluteUrl(sanitizedRelativeURL, []);\n  }\n\n  return endpoint;\n};\n","import { useCallback } from 'react';\n\nimport {\n  StandardEditorProps,\n  StandardEditorsRegistryItem,\n  StringFieldConfigSettings,\n  SelectableValue,\n} from '@grafana/data';\nimport { Button, Field, InlineField, InlineFieldRow, JSONFormatter, RadioButtonGroup, Select } from '@grafana/ui';\nimport { StringValueEditor } from 'app/core/components/OptionsUI/string';\nimport { defaultApiConfig } from 'app/features/canvas/elements/button';\n\nimport { HttpRequestMethod } from '../../panelcfg.gen';\n\nimport { ParamsEditor } from './ParamsEditor';\nimport { callApi, interpolateVariables } from './utils';\n\nexport interface APIEditorConfig {\n  method: string;\n  endpoint: string;\n  data?: string;\n  contentType?: string;\n  queryParams?: Array<[string, string]>;\n  headerParams?: Array<[string, string]>;\n}\n\nconst dummyStringSettings: StandardEditorsRegistryItem<string, StringFieldConfigSettings> = {\n  id: '',\n  name: '',\n  description: '',\n  editor: StringValueEditor,\n  settings: {},\n};\n\ntype Props = StandardEditorProps<APIEditorConfig>;\n\nconst httpMethodOptions = [\n  { label: HttpRequestMethod.GET, value: HttpRequestMethod.GET },\n  { label: HttpRequestMethod.POST, value: HttpRequestMethod.POST },\n  { label: HttpRequestMethod.PUT, value: HttpRequestMethod.PUT },\n];\n\nconst contentTypeOptions: SelectableValue[] = [\n  { label: 'JSON', value: 'application/json' },\n  { label: 'Text', value: 'text/plain' },\n  { label: 'JavaScript', value: 'application/javascript' },\n  { label: 'HTML', value: 'text/html' },\n  { label: 'XML', value: 'application/XML' },\n  { label: 'x-www-form-urlencoded', value: 'application/x-www-form-urlencoded' },\n];\n\nexport function APIEditor({ value, context, onChange }: Props) {\n  const LABEL_WIDTH = 13;\n\n  if (!value) {\n    value = defaultApiConfig;\n  }\n\n  const onEndpointChange = useCallback(\n    (endpoint = '') => {\n      onChange({\n        ...value,\n        endpoint,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onDataChange = useCallback(\n    (data?: string) => {\n      onChange({\n        ...value,\n        data,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onMethodChange = useCallback(\n    (method: string) => {\n      onChange({\n        ...value,\n        method,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onContentTypeChange = useCallback(\n    (contentType: SelectableValue<string>) => {\n      onChange({\n        ...value,\n        contentType: contentType?.value,\n      });\n    },\n    [onChange, value]\n  );\n\n  const formatCreateLabel = (input: string) => {\n    return input;\n  };\n\n  const onQueryParamsChange = useCallback(\n    (queryParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        queryParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const onHeaderParamsChange = useCallback(\n    (headerParams: Array<[string, string]>) => {\n      onChange({\n        ...value,\n        headerParams,\n      });\n    },\n    [onChange, value]\n  );\n\n  const renderJSON = (data: string) => {\n    try {\n      const json = JSON.parse(interpolateVariables(data));\n      return <JSONFormatter json={json} />;\n    } catch (error) {\n      if (error instanceof Error) {\n        return `Invalid JSON provided: ${error.message}`;\n      } else {\n        return 'Invalid JSON provided';\n      }\n    }\n  };\n\n  const renderTestAPIButton = (api: APIEditorConfig) => {\n    if (api && api.endpoint) {\n      return (\n        <Button onClick={() => callApi(api)} title=\"Test API\">\n          Test API\n        </Button>\n      );\n    }\n\n    return;\n  };\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Endpoint\" labelWidth={LABEL_WIDTH} grow={true}>\n          <StringValueEditor\n            context={context}\n            value={value?.endpoint}\n            onChange={onEndpointChange}\n            item={dummyStringSettings}\n          />\n        </InlineField>\n      </InlineFieldRow>\n      <InlineFieldRow>\n        <InlineField label=\"Method\" labelWidth={LABEL_WIDTH} grow={true}>\n          <RadioButtonGroup value={value?.method} options={httpMethodOptions} onChange={onMethodChange} fullWidth />\n        </InlineField>\n      </InlineFieldRow>\n      {value?.method !== HttpRequestMethod.GET && (\n        <InlineFieldRow>\n          <InlineField label=\"Content-Type\" labelWidth={LABEL_WIDTH} grow={true}>\n            <Select\n              options={contentTypeOptions}\n              allowCustomValue={true}\n              formatCreateLabel={formatCreateLabel}\n              value={value?.contentType}\n              onChange={onContentTypeChange}\n            />\n          </InlineField>\n        </InlineFieldRow>\n      )}\n\n      <br />\n      <Field label=\"Query parameters\">\n        <ParamsEditor value={value?.queryParams ?? []} onChange={onQueryParamsChange} />\n      </Field>\n      <Field label=\"Header parameters\">\n        <ParamsEditor value={value?.headerParams ?? []} onChange={onHeaderParamsChange} />\n      </Field>\n      {value?.method !== HttpRequestMethod.GET && value?.contentType && (\n        <Field label=\"Payload\">\n          <StringValueEditor\n            context={context}\n            value={value?.data ?? '{}'}\n            onChange={onDataChange}\n            item={{ ...dummyStringSettings, settings: { useTextarea: true } }}\n          />\n        </Field>\n      )}\n      {renderTestAPIButton(value)}\n      <br />\n      {value?.method !== HttpRequestMethod.GET &&\n        value?.contentType === defaultApiConfig.contentType &&\n        renderJSON(value?.data ?? '{}')}\n    </>\n  );\n}\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { ButtonVariant, InlineField, InlineFieldRow, Select } from '@grafana/ui';\nimport { defaultStyleConfig } from 'app/features/canvas/elements/button';\n\nexport interface ButtonStyleConfig {\n  variant: ButtonVariant;\n}\n\ntype Props = StandardEditorProps<ButtonStyleConfig>;\n\nconst variantOptions: SelectableValue[] = [\n  { label: 'primary', value: 'primary' },\n  { label: 'secondary', value: 'secondary' },\n  { label: 'success', value: 'success' },\n  { label: 'destructive', value: 'destructive' },\n];\n\nexport const ButtonStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultStyleConfig;\n  }\n\n  const onVariantChange = useCallback(\n    (variant: SelectableValue<ButtonVariant>) => {\n      onChange({\n        ...value,\n        variant: variant?.value ?? defaultStyleConfig.variant,\n      });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <InlineFieldRow>\n        <InlineField label=\"Variant\" grow={true}>\n          <Select options={variantOptions} value={value?.variant} onChange={onVariantChange} />\n        </InlineField>\n      </InlineFieldRow>\n    </>\n  );\n};\n","import { ComponentType } from 'react';\n\nimport { DataLink, RegistryItem, OneClickMode, Action } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { ColorDimensionConfig, ScaleDimensionConfig } from '@grafana/schema';\nimport { config } from 'app/core/config';\nimport { BackgroundConfig, Constraint, LineConfig, Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { LineStyleConfig } from '../../plugins/panel/canvas/editor/LineStyleEditor';\nimport { DimensionContext } from '../dimensions';\n\nimport { StandardEditorConfig } from './types';\n\n/**\n * This gets saved in panel json\n *\n * depending on the type, it may have additional config\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementOptions<TConfig = any> {\n  name: string; // configured unique display name\n  type: string;\n\n  // Custom options depending on the type\n  config?: TConfig;\n\n  // Standard options available for all elements\n  constraint?: Constraint; // defaults vertical - top, horizontal - left\n  placement?: Placement;\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  connections?: CanvasConnection[];\n  links?: DataLink[];\n  actions?: Action[];\n  oneClickMode?: OneClickMode;\n}\n\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport enum ConnectionDirection {\n  Forward = 'forward',\n  Reverse = 'reverse',\n  Both = 'both',\n  None = 'none',\n}\n\nexport interface CanvasConnection {\n  source: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  path: ConnectionPath;\n  color?: ColorDimensionConfig;\n  size?: ScaleDimensionConfig;\n  lineStyle?: LineStyleConfig;\n  vertices?: ConnectionCoordinates[];\n  radius?: ScaleDimensionConfig;\n  direction?: ConnectionDirection;\n  sourceOriginal?: ConnectionCoordinates;\n  targetOriginal?: ConnectionCoordinates;\n  // See https://github.com/anseki/leader-line#options for more examples of more properties\n}\n\nexport interface CanvasElementProps<TConfig = unknown, TData = unknown> {\n  // Saved config\n  config: TConfig;\n\n  // Raw data\n  data?: TData;\n\n  // If the element is currently selected\n  isSelected?: boolean;\n}\n\n/**\n * Canvas item builder\n *\n * @alpha\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport interface CanvasElementItem<TConfig = any, TData = any> extends RegistryItem {\n  /** The default width/height to use when adding  */\n  defaultSize?: Placement;\n\n  prepareData?: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TConfig>) => TData;\n\n  /** Component used to draw */\n  display: ComponentType<CanvasElementProps<TConfig, TData>>;\n\n  getNewOptions: (options?: CanvasElementOptions) => Omit<CanvasElementOptions<TConfig>, 'type' | 'name'>;\n\n  /** Build the configuration UI */\n  registerOptionsUI?: PanelOptionsSupplier<CanvasElementOptions<TConfig>>;\n\n  /** If item has an edit mode */\n  hasEditMode?: boolean;\n\n  /** Optional config to customize what standard element editor options are available for the item */\n  standardEditorConfig?: StandardEditorConfig;\n\n  /** Custom connection anchor coordinates, like for svg elements such as triangle, cloud, etc */\n  customConnectionAnchors?: Array<{\n    x: number;\n    y: number;\n  }>;\n}\n\nexport const defaultBgColor = '#D9D9D9';\nexport const defaultTextColor = '#000000';\nexport const defaultLightTextColor = '#F0F4FD';\nexport const defaultThemeTextColor = config.theme2.colors.text.primary;\n","import { LinkModel } from '@grafana/data/src';\nimport { ColorDimensionConfig, ResourceDimensionConfig, TextDimensionConfig } from '@grafana/schema';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nexport enum QuickPlacement {\n  Top = 'top',\n  Bottom = 'bottom',\n  Left = 'left',\n  Right = 'right',\n  HorizontalCenter = 'hcenter',\n  VerticalCenter = 'vcenter',\n}\n\nexport enum Align {\n  Left = 'left',\n  Center = 'center',\n  Right = 'right',\n}\n\nexport enum VAlign {\n  Top = 'top',\n  Middle = 'middle',\n  Bottom = 'bottom',\n}\n\nexport interface TextData {\n  text?: string;\n  color?: string;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n  links?: LinkModel[];\n  field?: string;\n}\n\nexport interface TextConfig {\n  text?: TextDimensionConfig;\n  color?: ColorDimensionConfig;\n  size?: number; // 0 or missing will \"auto size\"\n  align: Align;\n  valign: VAlign;\n}\n\nexport interface CanvasElementConfig extends TextConfig {\n  backgroundColor?: ColorDimensionConfig;\n  backgroundImage?: ResourceDimensionConfig;\n  backgroundSize?: BackgroundImageSize;\n  borderColor?: ColorDimensionConfig;\n  borderWidth?: number;\n}\n\nexport interface CanvasElementData extends TextData {\n  backgroundColor?: string;\n  backgroundImage?: string;\n  backgroundSize?: string;\n  borderColor?: string;\n  borderWidth?: number;\n}\n\nexport interface StandardEditorConfig {\n  layout?: boolean;\n  background?: boolean;\n  border?: boolean;\n}\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { PluginState } from '@grafana/data/src';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { Button, Spinner, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\nimport { APIEditor, APIEditorConfig } from 'app/plugins/panel/canvas/editor/element/APIEditor';\nimport { ButtonStyleConfig, ButtonStyleEditor } from 'app/plugins/panel/canvas/editor/element/ButtonStyleEditor';\nimport { callApi } from 'app/plugins/panel/canvas/editor/element/utils';\nimport { HttpRequestMethod } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultLightTextColor } from '../element';\nimport { Align, TextConfig, TextData } from '../types';\n\ninterface ButtonData extends Omit<TextData, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\ninterface ButtonConfig extends Omit<TextConfig, 'valign'> {\n  api?: APIEditorConfig;\n  style?: ButtonStyleConfig;\n}\n\nexport const defaultApiConfig: APIEditorConfig = {\n  endpoint: '',\n  method: HttpRequestMethod.POST,\n  data: '{}',\n  contentType: 'application/json',\n  queryParams: [],\n  headerParams: [],\n};\n\nexport const defaultStyleConfig: ButtonStyleConfig = {\n  variant: 'primary',\n};\n\nconst ButtonDisplay = ({ data }: CanvasElementProps<ButtonConfig, ButtonData>) => {\n  const styles = useStyles2(getStyles, data);\n\n  const [isLoading, setIsLoading] = useState(false);\n\n  const updateLoadingStateCallback = (loading: boolean) => {\n    setIsLoading(loading);\n  };\n\n  const onClick = () => {\n    if (data?.api && data?.api?.endpoint) {\n      setIsLoading(true);\n      callApi(data.api, updateLoadingStateCallback);\n    }\n  };\n\n  return (\n    <Button type=\"submit\" variant={data?.style?.variant} onClick={onClick} className={styles.button}>\n      <span>\n        {isLoading && <Spinner inline={true} className={styles.buttonSpinner} />}\n        {data?.text}\n      </span>\n    </Button>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: ButtonData | undefined) => ({\n  button: css({\n    height: '100%',\n    width: '100%',\n    display: 'grid',\n\n    '> span': {\n      display: 'inline-grid',\n      gridAutoFlow: 'column',\n      textAlign: data?.align,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    },\n  }),\n  buttonSpinner: css({\n    marginRight: theme.spacing(0.5),\n  }),\n});\n\nexport const buttonItem: CanvasElementItem<ButtonConfig, ButtonData> = {\n  id: 'button',\n  name: 'Button',\n  description: 'Button',\n  state: PluginState.beta,\n\n  standardEditorConfig: {\n    background: false,\n  },\n\n  display: ButtonDisplay,\n\n  defaultSize: {\n    width: 150,\n    height: 45,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      text: {\n        mode: TextDimensionMode.Fixed,\n        fixed: 'Button',\n      },\n      align: Align.Center,\n      color: {\n        fixed: defaultLightTextColor,\n      },\n      size: 14,\n      api: defaultApiConfig,\n      style: defaultStyleConfig,\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 32,\n      height: options?.placement?.height ?? 78,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ButtonConfig>) => {\n    const buttonConfig = elementOptions.config;\n\n    const getAPIConfig = () => {\n      if (buttonConfig?.api) {\n        buttonConfig.api = {\n          ...buttonConfig.api,\n          method: buttonConfig.api.method ?? defaultApiConfig.method,\n          contentType: buttonConfig.api.contentType ?? defaultApiConfig.contentType,\n        };\n        return buttonConfig.api;\n      }\n\n      return undefined;\n    };\n\n    const data: ButtonData = {\n      text: buttonConfig?.text ? dimensionContext.getText(buttonConfig.text).value() : '',\n      align: buttonConfig?.align ?? Align.Center,\n      size: buttonConfig?.size ?? 14,\n      api: getAPIConfig(),\n      style: buttonConfig?.style ?? defaultStyleConfig,\n    };\n\n    if (buttonConfig?.color) {\n      data.color = dimensionContext.getColor(buttonConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Button'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'styleSelector',\n        path: 'config.style',\n        name: 'Style',\n        editor: ButtonStyleEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'apiSelector',\n        path: 'config.api',\n        name: 'API',\n        editor: APIEditor,\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Cloud = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 110 70\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"110\" height=\"70\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`cloudClip-${uniqueId}`}>\n            <path d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <path\n          d=\"M 23 13 C -1 13 -7 33 12.2 37 C -7 45.8 14.6 65 30.2 57 C 41 73 77 73 89 57 C 113 57 113 41 98 33 C 113 17 89 1 68 9 C 53 -3 29 -3 23 13 Z\"\n          clipPath={`url(#cloudClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const cloudItem: CanvasElementItem = {\n  id: 'cloud',\n  name: 'Cloud',\n  description: 'Cloud',\n\n  display: Cloud,\n\n  defaultSize: {\n    width: 110,\n    height: 70,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 110,\n      height: options?.placement?.height ?? 70,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Cloud'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.58, y: 0.63 }, // Top Left\n    { x: -0.22, y: 0.99 }, // Top Middle\n    { x: 0.235, y: 0.75 }, // Top Right\n\n    { x: 0.8, y: 0.6 }, // Right Top\n    { x: 0.785, y: 0.06 }, // Right Middle\n    { x: 0.91, y: -0.51 }, // Right Bottom\n\n    { x: 0.62, y: -0.635 }, // Bottom Right\n    { x: 0.05, y: -0.98 }, // Bottom Middle\n    { x: -0.45, y: -0.635 }, // Bottom Left\n\n    { x: -0.8, y: -0.58 }, // Left Bottom\n    { x: -0.78, y: -0.06 }, // Left Middle\n    { x: -0.9, y: 0.48 }, // Left Top\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneFrontData {\n  rollAngle?: number;\n}\n\ninterface DroneFrontConfig {\n  rollAngle?: ScalarDimensionConfig;\n}\n\nconst DroneFrontDisplay = ({ data }: CanvasElementProps<DroneFrontConfig, DroneFrontData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneFrontTransformStyle = `rotate(${data?.rollAngle ? data.rollAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneFront}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneFrontTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n        <circle cx=\"650\" cy=\"160\" r=\"40\" fill=\"none\" />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneFrontItem: CanvasElementItem = {\n  id: 'droneFront',\n  name: 'Drone Front',\n  description: 'Drone front',\n\n  display: DroneFrontDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneFrontConfig>) => {\n    const droneFrontConfig = elementOptions.config;\n\n    const data: DroneFrontData = {\n      rollAngle: droneFrontConfig?.rollAngle ? dimensionContext.getScalar(droneFrontConfig.rollAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Front'];\n    builder.addCustomEditor({\n      category,\n      id: 'rollAngle',\n      path: 'config.rollAngle',\n      name: 'Roll Angle',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneFront: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneSideData {\n  pitchAngle?: number;\n}\n\ninterface DroneSideConfig {\n  pitchAngle?: ScalarDimensionConfig;\n}\n\nconst DroneSideDisplay = ({ data }: CanvasElementProps<DroneSideConfig, DroneSideData>) => {\n  const styles = useStyles2(getStyles);\n\n  const droneSidePitchTransformStyle = `rotate(${data?.pitchAngle ? data.pitchAngle : 0}deg)`;\n\n  return (\n    <svg\n      className={styles.droneSide}\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"0 0 1300 290\"\n      style={{ transform: droneSidePitchTransformStyle, stroke: defaultBgColor }}\n    >\n      <g className=\"arms\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <line x1=\"510\" x2=\"320\" y1=\"100\" y2=\"150\" />\n        <line x1=\"510\" x2=\"320\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"190\" y2=\"210\" />\n        <line x1=\"790\" x2=\"980\" y1=\"100\" y2=\"150\" />\n      </g>\n      <g className=\"body\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          fill=\"none\"\n          d=\" M 510 130 C 510 124 510 110 510 100 C 510 90 530 71 540 70 C 640 61 670 60 760 70 C 770 71 790 90 790 100 Q 790 120 790 130 L 790 130 Q 790 177 790 196 C 790 207 770 225 760 226 C 670 236 640 236 540 226 C 530 226 510 206 510 196 Q 510 177 510 130 Q 510 133 510 130 Z \"\n        />\n      </g>\n      <g className=\"motors\" stroke={defaultBgColor} strokeWidth=\"28px\">\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 320 60 L 250 60 L 250 230 L 260 290 L 310 290 L 320 230 L 320 60 Z \"\n        />\n        <path\n          className=\"motor\"\n          fill=\"none\"\n          d=\" M 1050 60 L 980 60 L 980 230 L 990 290 L 1040 290 L 1050 230 L 1050 60 Z \"\n        />\n      </g>\n      <g className=\"propellers\" fill={defaultBgColor}>\n        <path\n          className=\"prop\"\n          d=\" M 270 60 L 300 60 L 300 20 Q 311 30 330 30 Q 349 30 570 10 L 300 10 Q 300 0 290 0 C 286 0 284 0 280 0 Q 270 0 270 10 L 0 10 Q 220 30 240 30 Q 260 30 270 20 L 270 60 Z \"\n        />\n        <path\n          className=\"prop\"\n          d=\" M 1000 60 L 1030 60 L 1030 20 Q 1041 30 1060 30 Q 1079 30 1300 10 L 1030 10 Q 1030 0 1020 0 C 1016 0 1014 0 1010 0 Q 1000 0 1000 10 L 730 10 Q 950 30 970 30 Q 990 30 1000 20 L 1000 60 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneSideItem: CanvasElementItem = {\n  id: 'droneSide',\n  name: 'Drone Side',\n  description: 'Drone Side',\n\n  display: DroneSideDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 26,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 26,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneSideConfig>) => {\n    const droneSideConfig = elementOptions.config;\n\n    const data: DroneSideData = {\n      pitchAngle: droneSideConfig?.pitchAngle ? dimensionContext.getScalar(droneSideConfig.pitchAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Side'];\n    builder.addCustomEditor({\n      category,\n      id: 'pitchAngle',\n      path: 'config.pitchAngle',\n      name: 'Pitch Angle',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  droneSide: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    transition: 'transform 0.4s',\n  }),\n});\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface DroneTopData {\n  bRightRotorRPM?: number;\n  bLeftRotorRPM?: number;\n  fRightRotorRPM?: number;\n  fLeftRotorRPM?: number;\n  yawAngle?: number;\n}\n\ninterface DroneTopConfig {\n  bRightRotorRPM?: ScalarDimensionConfig;\n  bLeftRotorRPM?: ScalarDimensionConfig;\n  fRightRotorRPM?: ScalarDimensionConfig;\n  fLeftRotorRPM?: ScalarDimensionConfig;\n  yawAngle?: ScalarDimensionConfig;\n}\n\nconst DroneTopDisplay = ({ data }: CanvasElementProps<DroneTopConfig, DroneTopData>) => {\n  const styles = useStyles2(getStyles);\n\n  const fRightRotorAnimation = `spin ${data?.fRightRotorRPM ? 60 / Math.abs(data.fRightRotorRPM) : 0}s linear infinite`;\n\n  const fLeftRotorAnimation = `spin ${data?.fLeftRotorRPM ? 60 / Math.abs(data.fLeftRotorRPM) : 0}s linear infinite`;\n\n  const bRightRotorAnimation = `spin ${data?.bRightRotorRPM ? 60 / Math.abs(data.bRightRotorRPM) : 0}s linear infinite`;\n\n  const bLeftRotorAnimation = `spin ${data?.bLeftRotorRPM ? 60 / Math.abs(data.bLeftRotorRPM) : 0}s linear infinite`;\n\n  const droneTopTransformStyle = `rotate(${data?.yawAngle ? data.yawAngle : 0}deg)`;\n\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n      viewBox=\"-43 -43 640 640\"\n      xmlSpace=\"preserve\"\n      style={{ transform: droneTopTransformStyle, fill: defaultBgColor }}\n    >\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 137.95 127.967 C 137.14 127.157 136.189 126.58 135.178 126.218 C 138.173 121.545 139.967 116.036 140.125 110.123 L 217.64 151.862 C 214.049 157.411 211.8 163.922 211.386 170.95 L 209.694 199.712 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 L 137.95 127.967 Z  M 134.268 426.981 C 130.211 421.314 124.328 417.045 117.482 415.041 L 201.999 330.523 L 201.385 340.955 C 200.67 353.107 202.829 364.914 207.563 375.673 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 L 134.268 426.981 Z  M 324.765 373.673 L 228.527 373.673 Q 215.374 358.611 216.361 341.835 L 226.361 171.832 C 226.825 163.94 231.012 157.096 237.146 152.957 L 316.146 152.957 C 322.28 157.096 326.466 163.94 326.931 171.832 L 336.931 341.835 Q 337.918 358.611 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 L 324.765 373.673 Z  M 435.81 415.041 C 428.964 417.045 423.081 421.314 419.024 426.981 L 345.727 375.673 C 350.461 364.914 352.62 353.107 351.905 340.955 L 351.291 330.523 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 L 435.81 415.041 Z  M 343.596 199.713 L 341.904 170.951 C 341.49 163.923 339.242 157.411 335.651 151.863 L 413.167 110.124 C 413.325 116.037 415.119 121.546 418.114 126.219 C 417.103 126.581 416.152 127.158 415.342 127.968 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 L 343.596 199.713 Z  M 444.646 92.771 C 453.744 92.771 461.146 100.172 461.146 109.271 C 461.146 118.369 453.744 125.771 444.646 125.771 C 435.548 125.771 428.146 118.369 428.146 109.271 C 428.146 100.172 435.548 92.771 444.646 92.771 L 444.646 92.771 L 444.646 92.771 L 444.646 92.771 Z  M 108.647 92.771 C 117.745 92.771 125.147 100.172 125.147 109.271 C 125.147 118.369 117.745 125.771 108.647 125.771 C 99.549 125.771 92.147 118.369 92.147 109.271 C 92.147 100.172 99.549 92.771 108.647 92.771 L 108.647 92.771 L 108.647 92.771 Z  M 108.647 461.771 C 99.549 461.771 92.147 454.369 92.147 445.271 C 92.147 436.172 99.549 428.771 108.647 428.771 C 117.745 428.771 125.147 436.172 125.147 445.271 C 125.147 454.369 117.745 461.771 108.647 461.771 L 108.647 461.771 Z  M 92.322 136.202 C 97.086 139.1 102.675 140.771 108.647 140.771 C 114.883 140.771 120.697 138.941 125.594 135.802 C 125.956 136.813 126.534 137.764 127.343 138.573 L 207.342 218.573 C 207.711 218.942 208.109 219.264 208.528 219.54 L 203.212 309.908 C 201.794 310.182 200.44 310.869 199.342 311.967 L 95.343 415.967 C 94.954 416.356 94.62 416.779 94.335 417.224 C 93.651 417.575 92.976 417.942 92.322 418.34 Q 84.615 424.182 81.716 428.946 C 78.817 433.71 77.147 439.299 77.147 445.271 C 77.147 462.64 91.278 476.771 108.647 476.771 C 114.619 476.771 120.208 475.1 124.972 472.202 C 129.736 469.304 132.678 466.36 135.577 461.596 C 138.476 456.832 140.147 451.243 140.147 445.271 C 140.147 443.943 140.055 442.637 139.895 441.352 L 214.997 388.78 C 217.05 391.677 336.242 391.678 338.295 388.78 L 413.398 441.352 C 413.238 442.637 413.146 443.943 413.146 445.271 C 413.146 451.243 414.817 456.832 417.715 461.596 C 420.613 466.36 423.557 469.304 428.321 472.202 C 433.085 475.1 438.674 476.771 444.646 476.771 C 462.015 476.771 476.146 462.64 476.146 445.271 C 476.146 439.299 474.475 433.71 471.577 428.946 C 468.679 424.182 459.642 417.575 458.958 417.224 C 458.672 416.779 458.339 416.356 457.95 415.967 L 353.95 311.967 C 352.852 310.869 351.498 310.182 350.08 309.908 L 344.764 219.54 C 345.183 219.264 345.581 218.942 345.95 218.573 L 425.95 138.573 C 426.76 137.763 427.337 136.812 427.699 135.802 C 432.596 138.941 438.409 140.771 444.646 140.771 C 450.618 140.771 456.207 139.1 460.971 136.202 C 465.735 133.304 468.679 130.36 471.577 125.596 C 474.475 120.832 476.146 115.243 476.146 109.271 C 476.146 91.903 462.015 77.772 444.646 77.772 C 438.674 77.772 433.085 79.442 428.321 82.34 L 416.215 91.446 L 324.765 140.688 C 318.402 136.324 310.718 133.771 302.473 133.771 L 250.819 133.771 C 242.574 133.771 234.89 136.324 228.527 140.688 L 137.078 91.446 L 124.972 82.34 C 120.208 79.442 114.619 77.772 108.647 77.772 C 91.278 77.772 77.147 91.903 77.147 109.271 C 77.147 115.243 78.818 120.832 81.716 125.595 C 84.614 130.358 87.558 133.304 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 L 92.322 136.202 Z  M 444.646 461.771 C 435.548 461.771 428.146 454.369 428.146 445.271 C 428.146 436.172 435.548 428.771 444.646 428.771 C 453.744 428.771 461.146 436.172 461.146 445.271 C 461.146 454.369 453.744 461.771 444.646 461.771 Z \"\n      />\n      <path\n        fillRule=\"evenodd\"\n        d=\" M 259.458 334.235 L 259.458 337.211 L 254.514 337.211 L 254.514 350.795 L 250.842 350.795 L 250.842 337.211 L 245.898 337.211 L 245.898 334.235 L 259.458 334.235 Z  M 266.226 347.939 L 272.586 347.939 L 272.754 350.627 L 272.754 350.627 Q 270.498 350.867 265.074 350.867 L 265.074 350.867 L 265.074 350.867 Q 263.418 350.867 262.434 349.967 L 262.434 349.967 L 262.434 349.967 Q 261.45 349.067 261.426 347.531 L 261.426 347.531 L 261.426 337.499 L 261.426 337.499 Q 261.45 335.963 262.434 335.063 L 262.434 335.063 L 262.434 335.063 Q 263.418 334.163 265.074 334.163 L 265.074 334.163 L 265.074 334.163 Q 270.498 334.163 272.754 334.403 L 272.754 334.403 L 272.586 337.115 L 266.226 337.115 L 266.226 337.115 Q 265.626 337.115 265.362 337.403 L 265.362 337.403 L 265.362 337.403 Q 265.098 337.691 265.098 338.339 L 265.098 338.339 L 265.098 340.859 L 271.698 340.859 L 271.698 343.499 L 265.098 343.499 L 265.098 346.691 L 265.098 346.691 Q 265.098 347.363 265.362 347.651 L 265.362 347.651 L 265.362 347.651 Q 265.626 347.939 266.226 347.939 L 266.226 347.939 Z  M 275.202 333.995 L 278.73 333.995 L 278.73 346.931 L 278.73 346.931 Q 278.73 348.131 280.074 348.131 L 280.074 348.131 L 281.034 348.131 L 281.442 350.603 L 281.442 350.603 Q 280.53 351.083 278.61 351.083 L 278.61 351.083 L 278.61 351.083 Q 277.026 351.083 276.114 350.231 L 276.114 350.231 L 276.114 350.231 Q 275.202 349.379 275.202 347.819 L 275.202 347.819 L 275.202 333.995 Z  M 283.05 333.995 L 286.578 333.995 L 286.578 346.931 L 286.578 346.931 Q 286.578 348.131 287.922 348.131 L 287.922 348.131 L 288.882 348.131 L 289.29 350.603 L 289.29 350.603 Q 288.378 351.083 286.458 351.083 L 286.458 351.083 L 286.458 351.083 Q 284.874 351.083 283.962 350.231 L 283.962 350.231 L 283.962 350.231 Q 283.05 349.379 283.05 347.819 L 283.05 347.819 L 283.05 333.995 Z  M 292.086 335.759 L 292.086 335.759 L 292.086 335.759 Q 293.634 333.923 297.618 333.923 L 297.618 333.923 L 297.618 333.923 Q 301.602 333.923 303.162 335.759 L 303.162 335.759 L 303.162 335.759 Q 304.722 337.595 304.722 342.515 L 304.722 342.515 L 304.722 342.515 Q 304.722 347.435 303.162 349.271 L 303.162 349.271 L 303.162 349.271 Q 301.602 351.107 297.618 351.107 L 297.618 351.107 L 297.618 351.107 Q 293.634 351.107 292.086 349.271 L 292.086 349.271 L 292.086 349.271 Q 290.538 347.435 290.538 342.515 L 290.538 342.515 L 290.538 342.515 Q 290.538 337.595 292.086 335.759 Z  M 300.174 338.051 L 300.174 338.051 L 300.174 338.051 Q 299.49 336.875 297.618 336.875 L 297.618 336.875 L 297.618 336.875 Q 295.746 336.875 295.062 338.051 L 295.062 338.051 L 295.062 338.051 Q 294.378 339.227 294.378 342.515 L 294.378 342.515 L 294.378 342.515 Q 294.378 345.803 295.062 346.979 L 295.062 346.979 L 295.062 346.979 Q 295.746 348.155 297.618 348.155 L 297.618 348.155 L 297.618 348.155 Q 299.49 348.155 300.174 346.979 L 300.174 346.979 L 300.174 346.979 Q 300.858 345.803 300.858 342.515 L 300.858 342.515 L 300.858 342.515 Q 300.858 339.227 300.174 338.051 Z \"\n      />\n      <g className=\"propeller-group\">\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: bRightRotorAnimation }}\n          d=\" M 461.563 418.77 L 463.992 416.34 Q 465.495 407.116 466.461 400.395 C 467.426 393.675 469.363 388.087 474.731 383.284 Q 533.862 341.514 538.196 338.859 C 542.529 336.203 548.345 334.299 551.492 338.29 C 554.639 342.282 553.481 346.02 549.419 350.082 L 471.147 428.354 L 461.563 418.77 Z  M 427.729 471.772 L 425.299 474.202 Q 423.797 483.426 422.831 490.146 C 421.866 496.867 419.929 502.454 414.561 507.257 Q 355.43 549.028 351.096 551.683 C 346.763 554.338 340.947 556.243 337.8 552.251 C 334.653 548.26 335.811 544.522 339.873 540.46 L 418.145 462.187 L 427.729 471.772 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: fRightRotorAnimation }}\n          d=\" M 461.563 135.773 L 463.992 138.203 Q 465.495 147.426 466.461 154.147 C 467.426 160.868 469.363 166.455 474.731 171.258 Q 533.862 213.028 538.196 215.684 C 542.529 218.339 548.345 220.244 551.492 216.252 C 554.639 212.26 553.481 208.523 549.419 204.46 L 471.147 126.188 L 461.563 135.773 Z  M 427.729 82.77 L 425.299 80.34 Q 423.797 71.117 422.831 64.396 C 421.866 57.675 419.929 52.088 414.561 47.285 Q 355.43 5.515 351.096 2.859 C 346.763 0.204 340.947 -1.701 337.8 2.291 C 334.653 6.282 335.811 10.02 339.873 14.082 L 418.145 92.355 L 427.729 82.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCCW}`}\n          style={{ animation: bLeftRotorAnimation }}\n          d=\" M 125.563 471.772 L 127.993 474.202 Q 129.496 483.426 130.461 490.146 C 131.427 496.867 133.363 502.454 138.731 507.257 Q 197.863 549.028 202.196 551.683 C 206.53 554.338 212.345 556.243 215.492 552.251 C 218.639 548.26 217.482 544.522 213.419 540.46 L 135.148 462.187 L 125.563 471.772 Z  M 91.73 418.77 L 89.3 416.34 Q 87.797 407.116 86.832 400.395 C 85.866 393.675 83.93 388.087 78.562 383.284 Q 19.431 341.514 15.097 338.859 C 10.763 336.203 4.948 334.299 1.801 338.29 C -1.346 342.282 -0.189 346.02 3.874 350.082 L 82.146 428.354 L 91.73 418.77 Z \"\n        />\n        <path\n          className={`${styles.propeller} ${styles.propellerCW}`}\n          style={{ animation: fLeftRotorAnimation }}\n          d=\" M 125.563 82.77 L 127.993 80.34 Q 129.496 71.117 130.461 64.396 C 131.427 57.675 133.363 52.088 138.731 47.285 Q 197.863 5.515 202.196 2.859 C 206.53 0.204 212.345 -1.701 215.492 2.291 C 218.639 6.282 217.482 10.02 213.419 14.083 L 135.147 92.355 L 125.563 82.77 Z  M 91.73 135.773 L 89.3 138.203 Q 87.797 147.426 86.832 154.147 C 85.866 160.868 83.93 166.455 78.562 171.258 Q 19.431 213.028 15.097 215.684 C 10.763 218.339 4.948 220.243 1.801 216.252 C -1.346 212.26 -0.189 208.523 3.874 204.46 L 82.146 126.188 L 91.73 135.773 Z \"\n        />\n      </g>\n    </svg>\n  );\n};\n\nexport const droneTopItem: CanvasElementItem = {\n  id: 'droneTop',\n  name: 'Drone Top',\n  description: 'Drone top',\n\n  display: DroneTopDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<DroneTopConfig>) => {\n    const droneTopConfig = elementOptions.config;\n\n    const data: DroneTopData = {\n      bRightRotorRPM: droneTopConfig?.bRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bRightRotorRPM).value()\n        : 0,\n      bLeftRotorRPM: droneTopConfig?.bLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.bLeftRotorRPM).value()\n        : 0,\n      fRightRotorRPM: droneTopConfig?.fRightRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fRightRotorRPM).value()\n        : 0,\n      fLeftRotorRPM: droneTopConfig?.fLeftRotorRPM\n        ? dimensionContext.getScalar(droneTopConfig.fLeftRotorRPM).value()\n        : 0,\n      yawAngle: droneTopConfig?.yawAngle ? dimensionContext.getScalar(droneTopConfig.yawAngle).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Drone Top'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'yawAngle',\n        path: 'config.yawAngle',\n        name: 'Yaw Angle',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fRightRotorRPM',\n        path: 'config.fRightRotorRPM',\n        name: 'Front Right Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'fLeftRotorRPM',\n        path: 'config.fLeftRotorRPM',\n        name: 'Front Left Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bRightRotorRPM',\n        path: 'config.bRightRotorRPM',\n        name: 'Back Right Rotor RPM',\n        editor: ScalarDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'bLeftRotorRPM',\n        path: 'config.bLeftRotorRPM',\n        name: 'Back Left Rotor RPM',\n        editor: ScalarDimensionEditor,\n      });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  propeller: css({\n    transformOrigin: '50% 50%',\n    transformBox: 'fill-box',\n    display: 'block',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n  propellerCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'normal',\n  }),\n  propellerCCW: css({\n    // TODO: figure out what styles to apply when prefers-reduced-motion is set\n    // eslint-disable-next-line @grafana/no-unreduced-motion\n    animationDirection: 'reverse',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Ellipse = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`ellipseClip-${uniqueId}`}>\n            <ellipse cx=\"50%\" cy=\"50%\" rx=\"50%\" ry=\"50%\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <ellipse\n          cx=\"50%\"\n          cy=\"50%\"\n          rx=\"50%\"\n          ry=\"50%\"\n          clipPath={`url(#ellipseClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const ellipseItem: CanvasElementItem<CanvasElementConfig, CanvasElementData> = {\n  id: 'ellipse',\n  name: 'Ellipse',\n  description: 'Ellipse',\n\n  display: Ellipse,\n\n  defaultSize: {\n    width: 160,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Ellipse'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: 0 }, // middle left\n    { x: -0.7, y: 0.7 },\n\n    // points along the top edge\n    { x: 0, y: 1 }, // top\n    { x: 0.7, y: 0.7 },\n\n    // points along the right edge\n    { x: 1, y: 0 }, // middle right\n    { x: 0.7, y: -0.7 },\n\n    // points along the bottom edge\n    { x: 0, y: -1 }, // bottom\n    { x: -0.7, y: -0.7 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { isString } from 'lodash';\nimport { CSSProperties } from 'react';\n\nimport { LinkModel, OneClickMode } from '@grafana/data';\nimport { ColorDimensionConfig, ResourceDimensionConfig, ResourceDimensionMode } from '@grafana/schema';\nimport { SanitizedSVG } from 'app/core/components/SVG/SanitizedSVG';\nimport { getPublicOrAbsoluteUrl } from 'app/features/dimensions';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor, ResourceDimensionEditor } from 'app/features/dimensions/editors';\nimport { LineConfig } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\nexport interface IconConfig {\n  path?: ResourceDimensionConfig;\n  fill?: ColorDimensionConfig;\n  stroke?: LineConfig;\n}\n\ninterface IconData {\n  path: string;\n  fill: string;\n  strokeColor?: string;\n  stroke?: number;\n  links?: LinkModel[];\n}\n\n// When a stoke is defined, we want the path to be in page units\nconst svgStrokePathClass = css({\n  path: {\n    vectorEffect: 'non-scaling-stroke',\n  },\n});\n\nexport function IconDisplay(props: CanvasElementProps<IconConfig, IconData>) {\n  const { data } = props;\n  if (!data?.path) {\n    return null;\n  }\n\n  const svgStyle: CSSProperties = {\n    fill: data?.fill,\n    stroke: data?.strokeColor,\n    strokeWidth: data?.stroke,\n    height: '100%',\n    width: '100%',\n  };\n\n  return (\n    <SanitizedSVG src={data.path} style={svgStyle} className={svgStyle.strokeWidth ? svgStrokePathClass : undefined} />\n  );\n}\n\nexport const iconItem: CanvasElementItem<IconConfig, IconData> = {\n  id: 'icon',\n  name: 'Icon',\n  description: 'SVG Icon display',\n\n  display: IconDisplay,\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      path: {\n        mode: ResourceDimensionMode.Fixed,\n        fixed: 'img/icons/unicons/question-circle.svg',\n      },\n      fill: { fixed: defaultBgColor },\n    },\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<IconConfig>) => {\n    const iconConfig = elementOptions.config;\n\n    let path: string | undefined = undefined;\n    if (iconConfig?.path) {\n      path = dimensionContext.getResource(iconConfig.path).value();\n    }\n    if (!path || !isString(path)) {\n      path = getPublicOrAbsoluteUrl('img/icons/unicons/question-circle.svg');\n    }\n\n    const data: IconData = {\n      path,\n      fill: iconConfig?.fill ? dimensionContext.getColor(iconConfig.fill).value() : defaultBgColor,\n    };\n\n    if (iconConfig?.stroke?.width && iconConfig?.stroke.color) {\n      if (iconConfig.stroke.width > 0) {\n        data.stroke = iconConfig.stroke?.width;\n        data.strokeColor = dimensionContext.getColor(iconConfig.stroke.color).value();\n      }\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Icon'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'iconSelector',\n        path: 'config.path',\n        name: 'SVG Path',\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'icon',\n          maxFiles: 2000,\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.fill',\n        path: 'config.fill',\n        name: 'Fill color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: 'grey',\n        },\n      });\n    // .addSliderInput({\n    //   category,\n    //   path: 'config.stroke.width',\n    //   name: 'Stroke',\n    //   defaultValue: 0,\n    //   settings: {\n    //     min: 0,\n    //     max: 10,\n    //   },\n    // })\n    // .addCustomEditor({\n    //   category,\n    //   id: 'config.stroke.color',\n    //   path: 'config.stroke.color',\n    //   name: 'Stroke color',\n    //   editor: ColorDimensionEditor,\n    //   settings: {},\n    //   defaultValue: {\n    //     // Configured values\n    //     fixed: 'grey',\n    //   },\n    //   showIf: (cfg) => Boolean(cfg?.config?.stroke?.width),\n    // })\n  },\n};\n","import { css } from '@emotion/css';\nimport { useCallback } from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport {\n  DataFrame,\n  FieldNamePickerConfigSettings,\n  GrafanaTheme2,\n  OneClickMode,\n  StandardEditorsRegistryItem,\n} from '@grafana/data';\nimport { TextDimensionMode } from '@grafana/schema';\nimport { usePanelContext, useStyles2 } from '@grafana/ui';\nimport { FieldNamePicker } from '@grafana/ui/src/components/MatchersUI/FieldNamePicker';\nimport { frameHasName, getFrameFieldsDisplayNames } from '@grafana/ui/src/components/MatchersUI/utils';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\n// eslint-disable-next-line\nconst dummyFieldSettings: StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings> = {\n  settings: {},\n} as StandardEditorsRegistryItem<string, FieldNamePickerConfigSettings>;\n\nconst MetricValueDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected, config } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  const getDisplayValue = () => {\n    if (panelData && config.text?.field && fieldNotFound()) {\n      return 'Field not found';\n    }\n\n    if (panelData && config.text?.field && !data?.text) {\n      return 'No data';\n    }\n\n    return data?.text ? data.text : 'Double click to set field';\n  };\n\n  const fieldNotFound = () => {\n    const fieldNames = getFrameFieldsDisplayNames(panelData);\n    return !frameHasName(config.text?.field, fieldNames);\n  };\n\n  if (isEditMode && isSelected) {\n    return <MetricValueEdit {...props} />;\n  }\n\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>{getDisplayValue()}</span>\n    </div>\n  );\n};\n\nconst MetricValueEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const onFieldChange = useCallback(\n    (field: string | undefined) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { fixed: '', field: field, mode: TextDimensionMode.Field },\n          },\n          background: {\n            color: { field: field, fixed: options.background?.color?.fixed ?? '' },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.editModeEnabled.next(false);\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && (\n        <FieldNamePicker\n          context={{ data: panelData }}\n          value={config.text?.field ?? ''}\n          onChange={onFieldChange}\n          item={dummyFieldSettings}\n        />\n      )}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const metricValueItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'metric-value',\n  name: 'Metric Value',\n  description: 'Display a field value',\n\n  display: MetricValueDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 260,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n      text: { mode: TextDimensionMode.Field, fixed: '', field: '' },\n      size: 20,\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width,\n      height: options?.placement?.height,\n      top: options?.placement?.top ?? 100,\n      left: options?.placement?.left ?? 100,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Metric value'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Parallelogram = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 250 150\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"250\" height=\"150\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"350\" height=\"200\"></image>\n          </pattern>\n          <clipPath id={`parallelogramClip-${uniqueId}`}>\n            <polygon points=\"0,150 50,0 250,0 200,150\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"0,150 50,0 250,0 200,150\"\n          clipPath={`url(#parallelogramClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const parallelogramItem: CanvasElementItem = {\n  id: 'parallelogram',\n  name: 'Parallelogram',\n  description: 'Parallelogram',\n\n  display: Parallelogram,\n\n  defaultSize: {\n    width: 250,\n    height: 150,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 250,\n      height: options?.placement?.height ?? 150,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Parallelogram'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    { x: -0.6, y: 1 }, // Angled Top Left\n    { x: -0.1, y: 1 }, // Top Middle\n    { x: 0.5, y: 1 }, // Angled Top Right\n    { x: 1, y: 1 }, // Top Right\n    { x: 0.925, y: 0.6 }, // Angled Right Top\n    { x: 0.84, y: 0.2 }, // Right Middle\n    { x: 0.76, y: -0.2 }, // Angled Right Bottom\n    { x: 0.675, y: -0.6 }, // Bottom Right\n    { x: -0.5, y: -1 }, // Angled Bottom Right\n    { x: 0.1, y: -1 }, // Bottom Middle\n    { x: 0.6, y: -1 }, // Angled Bottom Left\n    { x: -1, y: -1 }, // Bottom Left\n    { x: -0.925, y: -0.6 }, // Angled Left Bottom\n    { x: -0.84, y: -0.2 }, // Left Middle\n    { x: -0.76, y: 0.2 }, // Angled Left Top\n    { x: -0.675, y: 0.6 }, // Top Left 2\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\nimport { PureComponent } from 'react';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { stylesFactory } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementOptions,\n  CanvasElementProps,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nclass RectangleDisplay extends PureComponent<CanvasElementProps<TextConfig, TextData>> {\n  render() {\n    const { data } = this.props;\n    const styles = getStyles(config.theme2, data);\n\n    return (\n      <div className={styles.container}>\n        <span className={styles.span}>{data?.text}</span>\n      </div>\n    );\n  }\n}\n\nconst getStyles = stylesFactory((theme: GrafanaTheme2, data) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n}));\n\nexport const rectangleItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'rectangle',\n  name: 'Rectangle',\n  description: 'Rectangle',\n\n  display: RectangleDisplay,\n\n  defaultSize: {\n    width: 240,\n    height: 160,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  // Heatmap overlay options\n  registerOptionsUI: (builder) => {\n    const category = ['Rectangle'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerDatabase = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m2.6953 37.5v20.883c0 7.6725 15.592 13.922 34.805 13.922s34.805-6.2493 34.805-13.922v-20.883\" />\n        <path d=\"m2.6953 16.617v20.883c0 7.7035 15.592 13.922 34.805 13.922s34.805-6.2184 34.805-13.922v-20.883\" />\n        <path d=\"m37.5 30.539c19.212 0 34.805-6.2185 34.805-13.922 0-7.7034-15.592-13.922-34.805-13.922s-34.805 6.2184-34.805 13.922c0 7.7035 15.592 13.922 34.805 13.922z\" />\n      </g>\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -132.86 -110.58)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -122.04 -111.7)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.21 -114.77)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -52.337 -30.65)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -41.518 -31.769)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.688 -34.842)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerSingle = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g>\n      <g className={styles.outline} transform=\"matrix(1.01 0 0 1.01 -.375 -.375)\">\n        <g className={styles.server}>\n          <path d=\"m3.2812 55.659 9.125-52.377h50.188l9.125 52.377\" />\n          <path d=\"m3.2812 56.328c0-2.5246 2.0379-4.5625 4.5625-4.5625h59.313c2.5245 0 4.5625 2.0379 4.5625 4.5625v10.828c0 2.5245-2.038 4.5625-4.5625 4.5625h-59.313c-2.5246 0-4.5625-2.038-4.5625-4.5625z\" />\n        </g>\n        <path d=\"m12.406 61.742h30.69\" />\n        <path d=\"m52.8 51.765v19.953\" />\n        <path\n          className={styles.circleBack}\n          transform=\"matrix(2.7592 0 0 2.7592 -109.42 -108.61)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          className={styles.circle}\n          transform=\"matrix(1.4775 0 0 1.4775 -29.697 -29.479)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerStack = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline} transform=\"translate(.5 .49865)\">\n      <g className={styles.server}>\n        <path d=\"m3.4834 21.768 8.0783-19.456h50.875l8.0784 19.456\" />\n        <path d=\"m2.3125 24.852c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 42.031c0-2.5592 2.0658-4.6251 4.625-4.6251h60.125c2.5592 0 4.625 2.0659 4.625 4.6251v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n        <path d=\"m2.3125 59.172c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m11.562 28.797h31.111\" />\n      <path d=\"m52.508 20.227v17.143\" />\n      <path d=\"m11.562 63.117h31.111\" />\n      <path d=\"m52.508 54.547v17.143\" />\n      <path d=\"m11.562 45.977h31.111\" />\n      <path d=\"m52.508 37.406v17.143\" />\n      <g className={styles.circleBack}>\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -143.2)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -126.14)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(2.7868 0 0 2.7868 -111.31 -108.86)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n      <g className={styles.circle}>\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -63.277)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -46.209)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n        <path\n          transform=\"matrix(1.4922 0 0 1.4922 -30.794 -28.93)\"\n          d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n        />\n      </g>\n    </g>\n  );\n};\n","import { useStyles2 } from '@grafana/ui';\n\nimport { getServerStyles, ServerData } from '../server';\n\nexport const ServerTerminal = (data: ServerData) => {\n  const styles = useStyles2(getServerStyles(data));\n  return (\n    <g className={styles.outline}>\n      <g className={styles.server}>\n        <path d=\"m5.3125 9.6562c0-3.5621 2.8754-6.4375 6.4375-6.4375h51.5c3.5621 0 6.4375 2.8754 6.4375 6.4375v28.625c0 3.5621-2.8754 6.4375-6.4375 6.4375h-51.5c-3.5621 0-6.4375-2.8754-6.4375-6.4375z\" />\n        <path d=\"m2.8125 59.859c0-2.5592 2.0658-4.625 4.625-4.625h60.125c2.5592 0 4.625 2.0658 4.625 4.625v7.8933c0 2.5592-2.0658 4.625-4.625 4.625h-60.125c-2.5592 0-4.625-2.0658-4.625-4.625z\" />\n      </g>\n      <path d=\"m37.5 46.719v2.875\" />\n      <path d=\"m24.625 51.343h25.75\" />\n      <path d=\"m12.062 63.804h31.111\" />\n      <path d=\"m53.008 55.234v17.143\" />\n      <path\n        className={styles.circleBack}\n        transform=\"matrix(2.7868 0 0 2.7868 -110.81 -108.2)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n      <path\n        className={styles.circle}\n        transform=\"matrix(1.4922 0 0 1.4922 -30.294 -28.27)\"\n        d=\"m62.198 60.586c.6388 0 1.1558.5171 1.1558 1.1559 0 .6387-.517 1.1558-1.1558 1.1558-.6387 0-1.1558-.5171-1.1558-1.1558 0-.6388.5171-1.1559 1.1558-1.1559z\"\n      />\n    </g>\n  );\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel, OneClickMode } from '@grafana/data';\nimport { ColorDimensionConfig, ScalarDimensionConfig } from '@grafana/schema';\nimport config from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor, ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps } from '../../element';\n\nimport { ServerDatabase } from './types/database';\nimport { ServerSingle } from './types/single';\nimport { ServerStack } from './types/stack';\nimport { ServerTerminal } from './types/terminal';\n\ninterface ServerConfig {\n  blinkRate?: ScalarDimensionConfig;\n  statusColor?: ColorDimensionConfig;\n  bulbColor?: ColorDimensionConfig;\n  type: ServerType;\n}\n\nexport interface ServerData {\n  blinkRate?: number;\n  statusColor?: string;\n  bulbColor?: string;\n  type: ServerType;\n  links?: LinkModel[];\n}\n\nenum ServerType {\n  Single = 'Single',\n  Stack = 'Stack',\n  Database = 'Database',\n  Terminal = 'Terminal',\n}\n\ntype Props = CanvasElementProps<ServerConfig, ServerData>;\nconst outlineColor = config.theme2.colors.text.primary;\n\nconst ServerDisplay = ({ data }: Props) => {\n  return data ? (\n    <svg viewBox=\"0 0 75 75\">\n      {data.type === ServerType.Single ? (\n        <ServerSingle {...data} />\n      ) : data.type === ServerType.Stack ? (\n        <ServerStack {...data} />\n      ) : data.type === ServerType.Database ? (\n        <ServerDatabase {...data} />\n      ) : data.type === ServerType.Terminal ? (\n        <ServerTerminal {...data} />\n      ) : null}\n    </svg>\n  ) : null;\n};\n\nexport const serverItem: CanvasElementItem<ServerConfig, ServerData> = {\n  id: 'server',\n  name: 'Server',\n  description: 'Basic server with status',\n\n  display: ServerDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 100,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    config: {\n      type: ServerType.Single,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<ServerConfig>) => {\n    const serverConfig = elementOptions.config;\n\n    const data: ServerData = {\n      blinkRate: serverConfig?.blinkRate ? dimensionContext.getScalar(serverConfig.blinkRate).value() : 0,\n      statusColor: serverConfig?.statusColor\n        ? dimensionContext.getColor(serverConfig.statusColor).value()\n        : 'transparent',\n      bulbColor: serverConfig?.bulbColor ? dimensionContext.getColor(serverConfig.bulbColor).value() : 'green',\n      type: serverConfig?.type ?? ServerType.Single,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Server'];\n    builder\n      .addSelect({\n        category,\n        path: 'config.type',\n        name: 'Type',\n        settings: {\n          options: [\n            { value: ServerType.Single, label: ServerType.Single },\n            { value: ServerType.Stack, label: ServerType.Stack },\n            { value: ServerType.Database, label: ServerType.Database },\n            { value: ServerType.Terminal, label: ServerType.Terminal },\n          ],\n        },\n        defaultValue: ServerType.Single,\n      })\n      .addCustomEditor({\n        category,\n        id: 'statusColor',\n        path: 'config.statusColor',\n        name: 'Status color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'transparent',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'bulbColor',\n        path: 'config.bulbColor',\n        name: 'Bulb color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          fixed: 'green',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'blinkRate',\n        path: 'config.blinkRate',\n        name: 'Blink rate [hz] (0 = off)',\n        editor: ScalarDimensionEditor,\n        settings: { min: 0, max: 100 },\n      });\n  },\n};\n\nexport const getServerStyles = (data: ServerData | undefined) => (theme: GrafanaTheme2) => ({\n  bulb: css({\n    '@keyframes blink': {\n      '0%': {\n        fillOpacity: 0,\n      },\n      '50%': {\n        fillOpacity: 1,\n      },\n      '100%': {\n        fillOpacity: 0,\n      },\n    },\n  }),\n  server: css({\n    fill: data?.statusColor ?? 'transparent',\n  }),\n  circle: css({\n    [theme.transitions.handleMotion('no-preference', 'reduce')]: {\n      animation: `blink ${data?.blinkRate ? 1 / data.blinkRate : 0}s infinite step-end`,\n    },\n    fill: data?.bulbColor,\n    stroke: 'none',\n  }),\n  circleBack: css({\n    fill: outlineColor,\n    stroke: 'none',\n    opacity: 1,\n  }),\n  outline: css({\n    stroke: outlineColor,\n    strokeLinecap: 'round',\n    strokeLinejoin: 'round',\n    strokeWidth: '4px',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useRef } from 'react';\nimport * as React from 'react';\nimport { useObservable } from 'react-use';\nimport { of } from 'rxjs';\n\nimport { DataFrame, GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { Input, usePanelContext, useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions/context';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultThemeTextColor } from '../element';\nimport { ElementState } from '../runtime/element';\nimport { Align, TextConfig, TextData, VAlign } from '../types';\n\nconst TextDisplay = (props: CanvasElementProps<TextConfig, TextData>) => {\n  const { data, isSelected } = props;\n  const styles = useStyles2(getStyles(data));\n\n  const context = usePanelContext();\n  const scene = context.instanceState?.scene;\n\n  const isEditMode = useObservable<boolean>(scene?.editModeEnabled ?? of(false));\n\n  if (isEditMode && isSelected) {\n    return <TextEdit {...props} />;\n  }\n  return (\n    <div className={styles.container}>\n      <span className={styles.span}>{data?.text ? data.text : 'Double click to set text'}</span>\n    </div>\n  );\n};\n\nconst TextEdit = (props: CanvasElementProps<TextConfig, TextData>) => {\n  let { data, config } = props;\n  const context = usePanelContext();\n  let panelData: DataFrame[];\n  panelData = context.instanceState?.scene?.data.series;\n\n  const textRef = useRef<string>(config.text?.fixed ?? '');\n\n  // Save text on TextEdit unmount\n  useEffect(() => {\n    return () => {\n      saveText(textRef.current);\n    };\n  });\n\n  const onKeyDown = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n      const scene = context.instanceState?.scene;\n      if (scene) {\n        scene.editModeEnabled.next(false);\n      }\n    }\n  };\n\n  const onKeyUp = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    textRef.current = event.currentTarget.value;\n  };\n\n  const saveText = useCallback(\n    (textValue: string) => {\n      let selectedElement: ElementState;\n      selectedElement = context.instanceState?.selected[0];\n      if (selectedElement) {\n        const options = selectedElement.options;\n        selectedElement.onChange({\n          ...options,\n          config: {\n            ...options.config,\n            text: { ...selectedElement.options.config.text, fixed: textValue },\n          },\n        });\n\n        // Force a re-render (update scene data after config update)\n        const scene = context.instanceState?.scene;\n        if (scene) {\n          scene.updateData(scene.data);\n        }\n      }\n    },\n    [context.instanceState?.scene, context.instanceState?.selected]\n  );\n\n  const styles = useStyles2(getStyles(data));\n  return (\n    <div className={styles.inlineEditorContainer}>\n      {panelData && <Input defaultValue={config.text?.fixed ?? ''} onKeyDown={onKeyDown} onKeyUp={onKeyUp} autoFocus />}\n    </div>\n  );\n};\n\nconst getStyles = (data: TextData | undefined) => (theme: GrafanaTheme2) => ({\n  container: css({\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    display: 'table',\n  }),\n  inlineEditorContainer: css({\n    height: '100%',\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(1),\n  }),\n  span: css({\n    display: 'table-cell',\n    verticalAlign: data?.valign,\n    textAlign: data?.align,\n    fontSize: `${data?.size}px`,\n    color: data?.color,\n  }),\n});\n\nexport const textItem: CanvasElementItem<TextConfig, TextData> = {\n  id: 'text',\n  name: 'Text',\n  description: 'Display text',\n\n  display: TextDisplay,\n\n  hasEditMode: true,\n\n  defaultSize: {\n    width: 100,\n    height: 50,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultThemeTextColor,\n      },\n      size: 16,\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 100,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<TextConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: TextData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Text'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n};\n","import { css } from '@emotion/css';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { GrafanaTheme2, OneClickMode } from '@grafana/data';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ColorDimensionEditor } from 'app/features/dimensions/editors/ColorDimensionEditor';\nimport { TextDimensionEditor } from 'app/features/dimensions/editors/TextDimensionEditor';\n\nimport {\n  CanvasElementItem,\n  CanvasElementProps,\n  CanvasElementOptions,\n  defaultBgColor,\n  defaultTextColor,\n} from '../element';\nimport { Align, CanvasElementConfig, CanvasElementData, VAlign } from '../types';\n\nconst Triangle = (props: CanvasElementProps<CanvasElementConfig, CanvasElementData>) => {\n  const { data } = props;\n  const styles = getStyles(config.theme2, data);\n\n  // uuid needed to avoid id conflicts when multiple elements are rendered\n  const uniqueId = uuidv4();\n\n  return (\n    <div className={styles.container}>\n      <svg\n        xmlns=\"http://www.w3.org/2000/svg\"\n        viewBox=\"0 0 200 200\"\n        width=\"100%\"\n        height=\"100%\"\n        preserveAspectRatio=\"none\"\n      >\n        <defs>\n          <pattern id={`image-${uniqueId}`} patternUnits=\"userSpaceOnUse\" width=\"200\" height=\"200\">\n            <image xlinkHref={data?.backgroundImage} x=\"-50\" y=\"-50\" width=\"300\" height=\"300\"></image>\n          </pattern>\n          <clipPath id={`triangleClip-${uniqueId}`}>\n            <polygon points=\"100,0 200,200 0,200\" />\n          </clipPath>\n        </defs>\n        {/* Apply background image within the clipping area */}\n        <rect\n          x=\"0\"\n          y=\"0\"\n          width=\"100%\"\n          height=\"100%\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          style={{ fill: 'none' }}\n        />\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          style={{ fill: data?.backgroundImage ? `url(#image-${uniqueId})` : data?.backgroundColor }}\n        />\n\n        {/* Border */}\n        <polygon\n          points=\"100,0 200,200 0,200\"\n          clipPath={`url(#triangleClip-${uniqueId})`}\n          className={styles.elementBorder}\n        />\n      </svg>\n\n      <span className={styles.text}>{data?.text}</span>\n    </div>\n  );\n};\n\nexport const triangleItem: CanvasElementItem = {\n  id: 'triangle',\n  name: 'Triangle',\n  description: 'Triangle',\n\n  display: Triangle,\n\n  defaultSize: {\n    width: 160,\n    height: 138,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: defaultBgColor,\n      },\n    },\n    config: {\n      align: Align.Center,\n      valign: VAlign.Middle,\n      color: {\n        fixed: defaultTextColor,\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 160,\n      height: options?.placement?.height ?? 138,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<CanvasElementConfig>) => {\n    const textConfig = elementOptions.config;\n\n    const data: CanvasElementData = {\n      text: textConfig?.text ? dimensionContext.getText(textConfig.text).value() : '',\n      field: textConfig?.text?.field,\n      align: textConfig?.align ?? Align.Center,\n      valign: textConfig?.valign ?? VAlign.Middle,\n      size: textConfig?.size,\n    };\n\n    if (textConfig?.color) {\n      data.color = dimensionContext.getColor(textConfig.color).value();\n    }\n\n    const { background, border } = elementOptions;\n    data.backgroundColor = background?.color ? dimensionContext.getColor(background.color).value() : defaultBgColor;\n    data.borderColor = border?.color ? dimensionContext.getColor(border.color).value() : defaultBgColor;\n    data.borderWidth = border?.width ?? 0;\n\n    data.backgroundImage = background?.image ? dimensionContext.getResource(background.image).value() : undefined;\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Triangle'];\n    builder\n      .addCustomEditor({\n        category,\n        id: 'textSelector',\n        path: 'config.text',\n        name: 'Text',\n        editor: TextDimensionEditor,\n      })\n      .addCustomEditor({\n        category,\n        id: 'config.color',\n        path: 'config.color',\n        name: 'Text color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {},\n      })\n      .addRadio({\n        category,\n        path: 'config.align',\n        name: 'Align text',\n        settings: {\n          options: [\n            { value: Align.Left, label: 'Left' },\n            { value: Align.Center, label: 'Center' },\n            { value: Align.Right, label: 'Right' },\n          ],\n        },\n        defaultValue: Align.Left,\n      })\n      .addRadio({\n        category,\n        path: 'config.valign',\n        name: 'Vertical align',\n        settings: {\n          options: [\n            { value: VAlign.Top, label: 'Top' },\n            { value: VAlign.Middle, label: 'Middle' },\n            { value: VAlign.Bottom, label: 'Bottom' },\n          ],\n        },\n        defaultValue: VAlign.Middle,\n      })\n      .addNumberInput({\n        category,\n        path: 'config.size',\n        name: 'Text size',\n        settings: {\n          placeholder: 'Auto',\n        },\n      });\n  },\n\n  customConnectionAnchors: [\n    // points along the left edge\n    { x: -1, y: -1 }, // bottom left\n    { x: -0.8, y: -0.6 },\n    { x: -0.6, y: -0.2 },\n    { x: -0.4, y: 0.2 },\n    { x: -0.2, y: 0.6 },\n    { x: 0, y: 1 }, // top\n\n    // points along the right edge\n    { x: 0.2, y: 0.6 },\n    { x: 0.4, y: 0.2 },\n    { x: 0.6, y: -0.2 },\n    { x: 0.8, y: -0.6 },\n    { x: 1, y: -1 }, // bottom right\n\n    // points along the bottom edge\n    { x: 0.6, y: -1 },\n    { x: 0.2, y: -1 },\n    { x: -0.2, y: -1 },\n    { x: -0.6, y: -1 },\n  ],\n};\n\nconst getStyles = (theme: GrafanaTheme2, data: CanvasElementData | undefined) => {\n  const textTop = data?.valign === VAlign.Middle ? '50%' : data?.valign === VAlign.Top ? '10%' : '90%';\n  const textLeft = data?.align === Align.Center ? '50%' : data?.align === Align.Left ? '10%' : '90%';\n  const textTransform = `translate(${data?.align === Align.Center ? '-50%' : data?.align === Align.Left ? '10%' : '-90%'}, ${\n    data?.valign === VAlign.Middle ? '-50%' : data?.valign === VAlign.Top ? '10%' : '-90%'\n  })`;\n\n  return {\n    container: css({\n      height: '100%',\n      width: '100%',\n    }),\n    text: css({\n      position: 'absolute',\n      top: textTop,\n      left: textLeft,\n      transform: textTransform,\n      fontSize: `${data?.size}px`,\n      color: data?.color,\n    }),\n    elementBorder: css({\n      fill: 'none',\n      stroke: data?.borderColor ?? 'none',\n      strokeWidth: data?.borderWidth ?? 0,\n      strokeLinejoin: 'round',\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2, LinkModel, OneClickMode } from '@grafana/data';\nimport { ScalarDimensionConfig } from '@grafana/schema';\nimport { useStyles2 } from '@grafana/ui';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { ScalarDimensionEditor } from 'app/features/dimensions/editors';\n\nimport { CanvasElementItem, CanvasElementOptions, CanvasElementProps, defaultBgColor } from '../element';\n\ninterface WindTurbineData {\n  rpm?: number;\n  links?: LinkModel[];\n}\n\ninterface WindTurbineConfig {\n  rpm?: ScalarDimensionConfig;\n}\n\nconst WindTurbineDisplay = ({ data }: CanvasElementProps<WindTurbineConfig, WindTurbineData>) => {\n  const styles = useStyles2(getStyles);\n\n  const windTurbineAnimation = `spin ${data?.rpm ? 60 / Math.abs(data.rpm) : 0}s linear infinite`;\n\n  return (\n    <svg viewBox=\"0 0 189.326 283.989\" preserveAspectRatio=\"xMidYMid meet\" style={{ fill: defaultBgColor }}>\n      <symbol id=\"blade\">\n        <path\n          fill=\"#e6e6e6\"\n          id=\"blade-front\"\n          d=\"M14.6491879,1.85011601 C14.2684455,-0.0535962877 10.7150812,-0.815081206 9.06473318,3.37308585 L0.434338747,70.7658933 L8.93805104,91.9607889 L15.4106729,90.437819 L17.5684455,78.3807425 L14.5218097,1.97679814 L14.6491879,1.85011601 Z\"\n        />\n        <path\n          fill=\"#d0d6d7\"\n          id=\"blade-side\"\n          d=\"M11.0951276,0.581206497 C10.3336427,0.961948956 9.57215777,1.85011601 8.93735499,3.24640371 L0.306960557,70.6392111 L8.81067285,91.8341067 L3.35359629,70.0044084 L11.0951276,0.581206497 Z\"\n        />\n      </symbol>\n\n      <g>\n        <g id=\"structure\" transform=\"translate(58.123, 82.664)\" fillRule=\"nonzero\">\n          <polygon id=\"tower\" fill=\"#e6e6e6\" points=\"33.111,10.984 39.965,10.984 44.28,196.176 28.796,196.176\" />\n          <path\n            id=\"yaw\"\n            fill=\"rgba(0,0,0,0.25)\"\n            d=\"M40.3454756,23.2948956 L40.7262181,34.8445476 C38.8225058,35.0986079 35.7765661,35.0986079 32.349884,34.337123 L32.7306265,23.2955916 L40.3454756,23.2955916 L40.3454756,23.2948956 Z\"\n          />\n          <path\n            id=\"base\"\n            fill=\"#d0d6d7\"\n            transform=\"translate(0 42)\"\n            d=\"M26.3846868,150.591647 L46.5640371,150.591647 C48.8484919,150.591647 50.7522042,152.49536 50.7522042,154.779814 L50.7522042,158.967981 L22.0691415,158.967981 L22.0691415,154.779814 C22.0691415,152.49536 23.9728538,150.591647 26.2573086,150.591647 L26.3846868,150.591647 Z\"\n          />\n          <circle id=\"nacelle\" fill=\"#e6e6e6\" cx=\"36.54\" cy=\"12\" r=\"11.93\" />\n          <circle id=\"gearbox\" fill=\"none\" stroke=\"#d0d6d7\" strokeWidth=\"2.75\" cx=\"36.538\" cy=\"11.999\" r=\"5.8\" />\n        </g>\n        <g className={styles.blade} style={{ animation: windTurbineAnimation }}>\n          <use id=\"blade1\" href=\"#blade\" x=\"83.24\" y=\"0\" />\n          <use id=\"blade2\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(120 94.663 94.663)\" />\n          <use id=\"blade3\" href=\"#blade\" x=\"83.24\" y=\"0\" transform=\"rotate(-120 94.663 94.663)\" />\n        </g>\n      </g>\n    </svg>\n  );\n};\n\nexport const windTurbineItem: CanvasElementItem = {\n  id: 'windTurbine',\n  name: 'Wind Turbine',\n  description: 'Spinny spinny',\n\n  display: WindTurbineDisplay,\n\n  defaultSize: {\n    width: 100,\n    height: 155,\n  },\n\n  getNewOptions: (options) => ({\n    ...options,\n    background: {\n      color: {\n        fixed: 'transparent',\n      },\n    },\n    placement: {\n      width: options?.placement?.width ?? 100,\n      height: options?.placement?.height ?? 155,\n      top: options?.placement?.top,\n      left: options?.placement?.left,\n      rotation: options?.placement?.rotation ?? 0,\n    },\n    oneClickMode: options?.oneClickMode ?? OneClickMode.Off,\n    links: options?.links ?? [],\n  }),\n\n  // Called when data changes\n  prepareData: (dimensionContext: DimensionContext, elementOptions: CanvasElementOptions<WindTurbineConfig>) => {\n    const windTurbineConfig = elementOptions.config;\n\n    const data: WindTurbineData = {\n      rpm: windTurbineConfig?.rpm ? dimensionContext.getScalar(windTurbineConfig.rpm).value() : 0,\n    };\n\n    return data;\n  },\n\n  registerOptionsUI: (builder) => {\n    const category = ['Wind Turbine'];\n    builder.addCustomEditor({\n      category,\n      id: 'rpm',\n      path: 'config.rpm',\n      name: 'RPM',\n      editor: ScalarDimensionEditor,\n    });\n  },\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  blade: css({\n    transformOrigin: '94.663px 94.663px',\n    transform: 'rotate(15deg)',\n    '@keyframes spin': {\n      from: {\n        transform: 'rotate(0deg)',\n      },\n      to: {\n        transform: 'rotate(360deg)',\n      },\n    },\n  }),\n});\n","import { Registry } from '@grafana/data';\n\nimport { CanvasElementItem, CanvasElementOptions } from './element';\nimport { buttonItem } from './elements/button';\nimport { cloudItem } from './elements/cloud';\nimport { droneFrontItem } from './elements/droneFront';\nimport { droneSideItem } from './elements/droneSide';\nimport { droneTopItem } from './elements/droneTop';\nimport { ellipseItem } from './elements/ellipse';\nimport { iconItem } from './elements/icon';\nimport { metricValueItem } from './elements/metricValue';\nimport { parallelogramItem } from './elements/parallelogram';\nimport { rectangleItem } from './elements/rectangle';\nimport { serverItem } from './elements/server/server';\nimport { textItem } from './elements/text';\nimport { triangleItem } from './elements/triangle';\nimport { windTurbineItem } from './elements/windTurbine';\n\nexport const DEFAULT_CANVAS_ELEMENT_CONFIG: CanvasElementOptions = {\n  ...metricValueItem.getNewOptions(),\n  placement: { ...metricValueItem.getNewOptions().placement, ...metricValueItem.defaultSize },\n  type: metricValueItem.id,\n  name: `Element 1`,\n};\n\nexport const defaultElementItems = [\n  metricValueItem, // default for now\n  textItem,\n  ellipseItem,\n  rectangleItem,\n  iconItem,\n  serverItem,\n  triangleItem,\n  cloudItem,\n  parallelogramItem,\n];\n\nexport const advancedElementItems = [buttonItem, windTurbineItem, droneTopItem, droneFrontItem, droneSideItem];\n\nexport const canvasElementRegistry = new Registry<CanvasElementItem>(() => [\n  ...defaultElementItems,\n  ...advancedElementItems,\n]);\n","import * as React from 'react';\nimport { CSSProperties } from 'react';\nimport { OnDrag, OnResize, OnRotate } from 'react-moveable/declaration/types';\n\nimport { FieldType, getLinksSupplier, LinkModel, OneClickMode, ScopedVars, ValueLinkConfig } from '@grafana/data';\nimport { LayerElement } from 'app/core/components/Layers/types';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions';\nimport {\n  BackgroundImageSize,\n  Constraint,\n  HorizontalConstraint,\n  Placement,\n  VerticalConstraint,\n} from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { getConnectionsByTarget, getRowIndex, isConnectionTarget } from 'app/plugins/panel/canvas/utils';\n\nimport { getActions, getActionsDefaultField } from '../../actions/utils';\nimport { CanvasElementItem, CanvasElementOptions } from '../element';\nimport { canvasElementRegistry } from '../registry';\n\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\nlet counter = 0;\n\nexport const SVGElements = new Set<string>(['parallelogram', 'triangle', 'cloud', 'ellipse']);\n\nexport class ElementState implements LayerElement {\n  // UID necessary for moveable to work (for now)\n  readonly UID = counter++;\n  revId = 0;\n  sizeStyle: CSSProperties = {};\n  dataStyle: CSSProperties = {};\n\n  // Temp stored constraint for visualization purposes (switch to top / left constraint to simplify some functionality)\n  tempConstraint: Constraint | undefined;\n\n  // Filled in by ref\n  div?: HTMLDivElement;\n\n  // Calculated\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  data?: any; // depends on the type\n\n  getLinks?: (config: ValueLinkConfig) => LinkModel[];\n\n  constructor(\n    public item: CanvasElementItem,\n    public options: CanvasElementOptions,\n    public parent?: FrameState\n  ) {\n    const fallbackName = `Element ${Date.now()}`;\n    if (!options) {\n      this.options = { type: item.id, name: fallbackName };\n    }\n\n    options.constraint = options.constraint ?? {\n      vertical: VerticalConstraint.Top,\n      horizontal: HorizontalConstraint.Left,\n    };\n    options.placement = options.placement ?? { width: 100, height: 100, top: 0, left: 0, rotation: 0 };\n    options.background = options.background ?? { color: { fixed: 'transparent' } };\n    options.border = options.border ?? { color: { fixed: 'dark-green' } };\n    options.oneClickMode = options.oneClickMode ?? OneClickMode.Off;\n    const scene = this.getScene();\n    if (!options.name) {\n      const newName = scene?.getNextElementName();\n      options.name = newName ?? fallbackName;\n    }\n    scene?.byName.set(options.name, this);\n  }\n\n  private getScene(): Scene | undefined {\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        return trav.scene;\n      }\n      trav = trav.parent;\n    }\n\n    return undefined;\n  }\n\n  getName() {\n    return this.options.name;\n  }\n\n  /** Use the configured options to update CSS style properties directly on the wrapper div **/\n  applyLayoutStylesToDiv(disablePointerEvents?: boolean) {\n    if (this.isRoot()) {\n      // Root supersedes layout engine and is always 100% width + height of panel\n      return;\n    }\n\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n    const placement: Placement = this.options.placement ?? {};\n\n    const editingEnabled = this.getScene()?.isEditingEnabled;\n\n    const style: React.CSSProperties = {\n      cursor: editingEnabled ? 'grab' : 'auto',\n      pointerEvents: disablePointerEvents ? 'none' : 'auto',\n      position: 'absolute',\n      // Minimum element size is 10x10\n      minWidth: '10px',\n      minHeight: '10px',\n      rotate: `${placement.rotation ?? 0}deg`,\n    };\n\n    const translate = ['0px', '0px'];\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        style.top = `${placement.top}px`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = placement.bottom ?? 0;\n        placement.height = placement.height ?? 100;\n        style.bottom = `${placement.bottom}px`;\n        style.height = `${placement.height}px`;\n        delete placement.top;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}px`;\n        style.bottom = `${placement.bottom}px`;\n        delete placement.height;\n        style.height = '';\n        break;\n      case VerticalConstraint.Center:\n        placement.top = placement.top ?? 0;\n        placement.height = placement.height ?? 100;\n        translate[1] = '-50%';\n        style.top = `calc(50% - ${placement.top}px)`;\n        style.height = `${placement.height}px`;\n        delete placement.bottom;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = placement.top ?? 0;\n        placement.bottom = placement.bottom ?? 0;\n        style.top = `${placement.top}%`;\n        style.bottom = `${placement.bottom}%`;\n        delete placement.height;\n        style.height = '';\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        style.left = `${placement.left}px`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = placement.right ?? 0;\n        placement.width = placement.width ?? 100;\n        style.right = `${placement.right}px`;\n        style.width = `${placement.width}px`;\n        delete placement.left;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}px`;\n        style.right = `${placement.right}px`;\n        delete placement.width;\n        style.width = '';\n        break;\n      case HorizontalConstraint.Center:\n        placement.left = placement.left ?? 0;\n        placement.width = placement.width ?? 100;\n        translate[0] = '-50%';\n        style.left = `calc(50% - ${placement.left}px)`;\n        style.width = `${placement.width}px`;\n        delete placement.right;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = placement.left ?? 0;\n        placement.right = placement.right ?? 0;\n        style.left = `${placement.left}%`;\n        style.right = `${placement.right}%`;\n        delete placement.width;\n        style.width = '';\n        break;\n    }\n\n    style.transform = `translate(${translate[0]}, ${translate[1]})`;\n    this.options.placement = placement;\n    this.sizeStyle = style;\n\n    if (this.div) {\n      for (const key in this.sizeStyle) {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n        this.div.style[key as any] = (this.sizeStyle as any)[key];\n      }\n\n      // TODO: This is a hack, we should have a better way to handle this\n      const elementType = this.options.type;\n      if (!SVGElements.has(elementType)) {\n        // apply styles to div if it's not an SVG element\n        for (const key in this.dataStyle) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n          this.div.style[key as any] = (this.dataStyle as any)[key];\n        }\n      } else {\n        // ELEMENT IS SVG\n        // clean data styles from div if it's an SVG element; SVG elements have their own data styles;\n        // this is necessary for changing type of element cases;\n        // wrapper div element (this.div) doesn't re-render (has static `key` property),\n        // so we have to clean styles manually;\n        for (const key in this.dataStyle) {\n          // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n          this.div.style[key as any] = '';\n        }\n      }\n    }\n  }\n\n  setPlacementFromConstraint(elementContainer?: DOMRect, parentContainer?: DOMRect, transformScale = 1) {\n    const { constraint } = this.options;\n    const { vertical, horizontal } = constraint ?? {};\n\n    if (!elementContainer) {\n      elementContainer = this.div && this.div.getBoundingClientRect();\n    }\n    let parentBorderWidth = 0;\n    if (!parentContainer) {\n      parentContainer = this.div && this.div.parentElement?.getBoundingClientRect();\n      parentBorderWidth = this.parent?.isRoot()\n        ? 0\n        : parseFloat(getComputedStyle(this.div?.parentElement!).borderWidth);\n    }\n\n    // For elements with rotation, a delta needs to be applied to account for bounding box rotation\n    // TODO: Fix behavior for top+bottom, left+right, center, and scale constraints\n    let rotationTopOffset = 0;\n    let rotationLeftOffset = 0;\n    if (this.options.placement?.rotation && this.options.placement?.width && this.options.placement?.height) {\n      const rotationDegrees = this.options.placement.rotation;\n      const rotationRadians = (Math.PI / 180) * rotationDegrees;\n      let rotationOffset = rotationRadians;\n\n      switch (true) {\n        case rotationDegrees >= 0 && rotationDegrees < 90:\n          // no-op\n          break;\n        case rotationDegrees >= 90 && rotationDegrees < 180:\n          rotationOffset = Math.PI - rotationRadians;\n          break;\n        case rotationDegrees >= 180 && rotationDegrees < 270:\n          rotationOffset = Math.PI + rotationRadians;\n          break;\n        case rotationDegrees >= 270:\n          rotationOffset = -rotationRadians;\n          break;\n      }\n\n      const calculateDelta = (dimension1: number, dimension2: number) =>\n        (dimension1 / 2) * Math.sin(rotationOffset) + (dimension2 / 2) * (Math.cos(rotationOffset) - 1);\n\n      rotationTopOffset = calculateDelta(this.options.placement.width, this.options.placement.height);\n      rotationLeftOffset = calculateDelta(this.options.placement.height, this.options.placement.width);\n    }\n\n    const relativeTop =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.top - parentContainer.top - parentBorderWidth + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeBottom =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.bottom - parentBorderWidth - elementContainer.bottom + rotationTopOffset) /\n          transformScale\n        : 0;\n    const relativeLeft =\n      elementContainer && parentContainer\n        ? Math.round(elementContainer.left - parentContainer.left - parentBorderWidth + rotationLeftOffset) /\n          transformScale\n        : 0;\n    const relativeRight =\n      elementContainer && parentContainer\n        ? Math.round(parentContainer.right - parentBorderWidth - elementContainer.right + rotationLeftOffset) /\n          transformScale\n        : 0;\n\n    const placement: Placement = {};\n\n    const width = (elementContainer?.width ?? 100) / transformScale;\n    const height = (elementContainer?.height ?? 100) / transformScale;\n\n    switch (vertical) {\n      case VerticalConstraint.Top:\n        placement.top = relativeTop;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Bottom:\n        placement.bottom = relativeBottom;\n        placement.height = height;\n        break;\n      case VerticalConstraint.TopBottom:\n        placement.top = relativeTop;\n        placement.bottom = relativeBottom;\n        break;\n      case VerticalConstraint.Center:\n        const elementCenter = elementContainer ? relativeTop + height / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.height / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.top = distanceFromCenter;\n        placement.height = height;\n        break;\n      case VerticalConstraint.Scale:\n        placement.top = (relativeTop / (parentContainer?.height ?? height)) * 100;\n        placement.bottom = (relativeBottom / (parentContainer?.height ?? height)) * 100;\n        break;\n    }\n\n    switch (horizontal) {\n      case HorizontalConstraint.Left:\n        placement.left = relativeLeft;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Right:\n        placement.right = relativeRight;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.LeftRight:\n        placement.left = relativeLeft;\n        placement.right = relativeRight;\n        break;\n      case HorizontalConstraint.Center:\n        const elementCenter = elementContainer ? relativeLeft + width / 2 : 0;\n        const parentCenter = parentContainer ? parentContainer.width / 2 : 0;\n        const distanceFromCenter = parentCenter - elementCenter;\n        placement.left = distanceFromCenter;\n        placement.width = width;\n        break;\n      case HorizontalConstraint.Scale:\n        placement.left = (relativeLeft / (parentContainer?.width ?? width)) * 100;\n        placement.right = (relativeRight / (parentContainer?.width ?? width)) * 100;\n        break;\n    }\n\n    if (this.options.placement?.rotation) {\n      placement.rotation = this.options.placement.rotation;\n      placement.width = this.options.placement.width;\n      placement.height = this.options.placement.height;\n    }\n\n    this.options.placement = placement;\n\n    this.applyLayoutStylesToDiv();\n    this.revId++;\n\n    this.getScene()?.save();\n  }\n\n  updateData(ctx: DimensionContext) {\n    if (this.item.prepareData) {\n      this.data = this.item.prepareData(ctx, this.options);\n      this.revId++; // rerender\n    }\n\n    const scene = this.getScene();\n    const frames = scene?.data?.series;\n\n    this.options.links = this.options.links?.filter((link) => link !== null);\n\n    if (frames) {\n      const defaultField = {\n        name: 'Default field',\n        type: FieldType.string,\n        config: { links: this.options.links ?? [], actions: this.options.actions ?? [] },\n        values: [],\n      };\n\n      this.getLinks = getLinksSupplier(\n        frames[0],\n        defaultField,\n        {\n          __dataContext: {\n            value: {\n              data: frames,\n              field: defaultField,\n              frame: frames[0],\n              frameIndex: 0,\n            },\n          },\n        },\n        scene?.panel.props.replaceVariables!\n      );\n    }\n\n    const { background, border } = this.options;\n    const css: CSSProperties = {};\n    if (background) {\n      if (background.color) {\n        const color = ctx.getColor(background.color);\n        css.backgroundColor = color.value();\n      }\n      if (background.image) {\n        const image = ctx.getResource(background.image);\n        if (image) {\n          const v = image.value();\n          if (v) {\n            css.backgroundImage = `url(\"${v}\")`;\n            switch (background.size ?? BackgroundImageSize.Contain) {\n              case BackgroundImageSize.Contain:\n                css.backgroundSize = 'contain';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Cover:\n                css.backgroundSize = 'cover';\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Original:\n                css.backgroundRepeat = 'no-repeat';\n                break;\n              case BackgroundImageSize.Tile:\n                css.backgroundRepeat = 'repeat';\n                break;\n              case BackgroundImageSize.Fill:\n                css.backgroundSize = '100% 100%';\n                break;\n            }\n          } else {\n            css.backgroundImage = '';\n          }\n        }\n      }\n    }\n\n    if (border && border.color && border.width !== undefined) {\n      const color = ctx.getColor(border.color);\n      css.borderWidth = `${border.width}px`;\n      css.borderStyle = 'solid';\n      css.borderColor = color.value();\n\n      // Move the image to inside the border\n      if (css.backgroundImage) {\n        css.backgroundOrigin = 'padding-box';\n      }\n    }\n\n    if (border && border.radius !== undefined) {\n      css.borderRadius = `${border.radius}px`;\n    }\n\n    this.dataStyle = css;\n    this.applyLayoutStylesToDiv();\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    visitor(this);\n  }\n\n  onChange(options: CanvasElementOptions) {\n    if (this.item.id !== options.type) {\n      this.item = canvasElementRegistry.getIfExists(options.type) ?? notFoundItem;\n    }\n\n    // rename handling\n    const oldName = this.options.name;\n    const newName = options.name;\n\n    this.revId++;\n    this.options = { ...options };\n    let trav = this.parent;\n    while (trav) {\n      if (trav.isRoot()) {\n        trav.scene.save();\n        break;\n      }\n      trav.revId++;\n      trav = trav.parent;\n    }\n\n    const scene = this.getScene();\n    if (oldName !== newName && scene) {\n      if (isConnectionTarget(this, scene.byName)) {\n        getConnectionsByTarget(this, scene).forEach((connection) => {\n          connection.info.targetName = newName;\n        });\n      }\n\n      scene.byName.delete(oldName);\n      scene.byName.set(newName, this);\n    }\n  }\n\n  getSaveModel() {\n    return { ...this.options };\n  }\n\n  initElement = (target: HTMLDivElement) => {\n    this.div = target;\n    this.applyLayoutStylesToDiv();\n  };\n\n  applyDrag = (event: OnDrag) => {\n    const hasHorizontalCenterConstraint = this.options.constraint?.horizontal === HorizontalConstraint.Center;\n    const hasVerticalCenterConstraint = this.options.constraint?.vertical === VerticalConstraint.Center;\n    if (hasHorizontalCenterConstraint || hasVerticalCenterConstraint) {\n      const numberOfTargets = this.getScene()?.selecto?.getSelectedTargets().length ?? 0;\n      const isMultiSelection = numberOfTargets > 1;\n      if (!isMultiSelection) {\n        const elementContainer = this.div?.getBoundingClientRect();\n        const height = elementContainer?.height ?? 100;\n        const yOffset = hasVerticalCenterConstraint ? height / 4 : 0;\n        event.target.style.transform = `translate(${event.translate[0]}px, ${event.translate[1] - yOffset}px)`;\n        return;\n      }\n    }\n\n    event.target.style.transform = event.transform;\n  };\n\n  applyRotate = (event: OnRotate) => {\n    const rotationDelta = event.delta;\n    const placement = this.options.placement!;\n    const placementRotation = placement.rotation ?? 0;\n\n    const calculatedRotation = placementRotation + rotationDelta;\n\n    // Ensure rotation is between 0 and 360\n    placement.rotation = calculatedRotation - Math.floor(calculatedRotation / 360) * 360;\n    event.target.style.transform = event.transform;\n  };\n\n  // kinda like:\n  // https://github.com/grafana/grafana-edge-app/blob/main/src/panels/draw/WrapItem.tsx#L44\n  applyResize = (event: OnResize, transformScale = 1) => {\n    const placement = this.options.placement!;\n\n    const style = event.target.style;\n    let deltaX = event.delta[0] / transformScale;\n    let deltaY = event.delta[1] / transformScale;\n    let dirLR = event.direction[0];\n    let dirTB = event.direction[1];\n\n    // Handle case when element is rotated\n    if (placement.rotation) {\n      const rotation = placement.rotation ?? 0;\n      const rotationInRadians = (rotation * Math.PI) / 180;\n      const originalDirLR = dirLR;\n      const originalDirTB = dirTB;\n\n      dirLR = Math.sign(originalDirLR * Math.cos(rotationInRadians) - originalDirTB * Math.sin(rotationInRadians));\n      dirTB = Math.sign(originalDirLR * Math.sin(rotationInRadians) + originalDirTB * Math.cos(rotationInRadians));\n    }\n\n    if (dirLR === 1) {\n      placement.width = event.width;\n      style.width = `${placement.width}px`;\n    } else if (dirLR === -1) {\n      placement.left! -= deltaX;\n      placement.width = event.width;\n      style.left = `${placement.left}px`;\n      style.width = `${placement.width}px`;\n    }\n\n    if (dirTB === -1) {\n      placement.top! -= deltaY;\n      placement.height = event.height;\n      style.top = `${placement.top}px`;\n      style.height = `${placement.height}px`;\n    } else if (dirTB === 1) {\n      placement.height = event.height;\n      style.height = `${placement.height}px`;\n    }\n  };\n\n  handleMouseEnter = (event: React.MouseEvent, isSelected: boolean | undefined) => {\n    const scene = this.getScene();\n\n    const shouldHandleTooltip =\n      !scene?.isEditingEnabled && !scene?.tooltip?.isOpen && this.options.oneClickMode === OneClickMode.Off;\n    if (shouldHandleTooltip) {\n      this.handleTooltip(event);\n    } else if (!isSelected) {\n      scene?.connections.handleMouseEnter(event);\n    }\n\n    const shouldHandleOneClickLink =\n      this.options.oneClickMode === OneClickMode.Link && this.options.links && this.options.links.length > 0;\n\n    const shouldHandleOneClickAction =\n      this.options.oneClickMode === OneClickMode.Action && this.options.actions && this.options.actions.length > 0;\n\n    if (shouldHandleOneClickLink && this.div) {\n      const primaryDataLink = this.getPrimaryDataLink();\n      if (primaryDataLink) {\n        this.div.style.cursor = 'pointer';\n        this.div.title = `Navigate to ${primaryDataLink.title === '' ? 'data link' : primaryDataLink.title}`;\n      }\n    } else if (shouldHandleOneClickAction && this.div) {\n      const primaryAction = this.getPrimaryAction();\n      if (primaryAction) {\n        this.div.style.cursor = 'pointer';\n        this.div.title = primaryAction.title;\n      }\n    }\n  };\n\n  getPrimaryDataLink = () => {\n    if (this.getLinks) {\n      const links = this.getLinks({ valueRowIndex: getRowIndex(this.data.field, this.getScene()!) });\n      return links[0];\n    }\n\n    return undefined;\n  };\n\n  getPrimaryAction = () => {\n    const config: ValueLinkConfig = { valueRowIndex: getRowIndex(this.data.field, this.getScene()!) };\n    const actionsDefaultFieldConfig = { links: this.options.links ?? [], actions: this.options.actions ?? [] };\n    const frames = this.getScene()?.data?.series;\n\n    if (frames) {\n      const defaultField = getActionsDefaultField(actionsDefaultFieldConfig.links, actionsDefaultFieldConfig.actions);\n      const scopedVars: ScopedVars = {\n        __dataContext: {\n          value: {\n            data: frames,\n            field: defaultField,\n            frame: frames[0],\n            frameIndex: 0,\n          },\n        },\n      };\n\n      const actions = getActions(\n        frames[0],\n        defaultField,\n        scopedVars,\n        this.getScene()?.panel.props.replaceVariables!,\n        actionsDefaultFieldConfig.actions,\n        config\n      );\n      return actions[0];\n    }\n\n    return undefined;\n  };\n\n  handleTooltip = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback) {\n      const rect = this.div?.getBoundingClientRect();\n      scene.tooltipCallback({\n        anchorPoint: { x: rect?.right ?? event.pageX, y: rect?.top ?? event.pageY },\n        element: this,\n        isOpen: false,\n      });\n    }\n  };\n\n  handleMouseLeave = (event: React.MouseEvent) => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && !scene?.tooltip?.isOpen && this.options.oneClickMode === OneClickMode.Off) {\n      scene.tooltipCallback(undefined);\n    }\n\n    if (this.options.oneClickMode !== OneClickMode.Off && this.div) {\n      this.div.style.cursor = 'auto';\n      this.div.title = '';\n    }\n  };\n\n  onElementClick = (event: React.MouseEvent) => {\n    // If one-click access is enabled, open the primary link\n    if (this.options.oneClickMode === OneClickMode.Link) {\n      let primaryDataLink = this.getPrimaryDataLink();\n      if (primaryDataLink) {\n        window.open(primaryDataLink.href, primaryDataLink.target ?? '_self');\n      }\n    } else if (this.options.oneClickMode === OneClickMode.Action) {\n      let primaryAction = this.getPrimaryAction();\n      if (primaryAction && primaryAction.onClick) {\n        primaryAction.onClick(event);\n      }\n    } else {\n      this.handleTooltip(event);\n      this.onTooltipCallback();\n    }\n  };\n\n  onElementKeyDown = (event: React.KeyboardEvent) => {\n    if (\n      event.key === 'Enter' &&\n      (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n    ) {\n      const scene = this.getScene();\n      scene?.select({ targets: [event.currentTarget] });\n    }\n  };\n\n  onTooltipCallback = () => {\n    const scene = this.getScene();\n    if (scene?.tooltipCallback && scene.tooltip?.anchorPoint) {\n      scene.tooltipCallback({\n        anchorPoint: { x: scene.tooltip.anchorPoint.x, y: scene.tooltip.anchorPoint.y },\n        element: this,\n        isOpen: true,\n      });\n    }\n  };\n\n  render() {\n    const { item, div } = this;\n    const scene = this.getScene();\n    const isSelected = div && scene && scene.selecto && scene.selecto.getSelectedTargets().includes(div);\n\n    return (\n      <div\n        key={this.UID}\n        ref={this.initElement}\n        onMouseEnter={(e: React.MouseEvent) => this.handleMouseEnter(e, isSelected)}\n        onMouseLeave={!scene?.isEditingEnabled ? this.handleMouseLeave : undefined}\n        onClick={!scene?.isEditingEnabled ? this.onElementClick : undefined}\n        onKeyDown={!scene?.isEditingEnabled ? this.onElementKeyDown : undefined}\n        role=\"button\"\n        tabIndex={0}\n      >\n        <item.display\n          key={`${this.UID}/${this.revId}`}\n          config={this.options.config}\n          data={this.data}\n          isSelected={isSelected}\n        />\n      </div>\n    );\n  }\n}\n","import { isNumber, isString } from 'lodash';\n\nimport { AppEvents, getFieldDisplayName, PluginState, SelectableValue } from '@grafana/data';\nimport { DataFrame, Field } from '@grafana/data/';\nimport appEvents from 'app/core/app_events';\nimport { hasAlphaPanels, config } from 'app/core/config';\nimport {\n  CanvasConnection,\n  CanvasElementItem,\n  CanvasElementOptions,\n  ConnectionDirection,\n} from 'app/features/canvas/element';\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { advancedElementItems, canvasElementRegistry, defaultElementItems } from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene, SelectionParams } from 'app/features/canvas/runtime/scene';\n\nimport { AnchorPoint, ConnectionState, LineStyle, StrokeDasharray } from './types';\n\nexport function doSelect(scene: Scene, element: ElementState | FrameState) {\n  try {\n    let selection: SelectionParams = { targets: [] };\n    if (element instanceof FrameState) {\n      const targetElements: HTMLDivElement[] = [];\n      targetElements.push(element?.div!);\n      selection.targets = targetElements;\n      selection.frame = element;\n      scene.select(selection);\n    } else {\n      scene.currentLayer = element.parent;\n      selection.targets = [element?.div!];\n      scene.select(selection);\n    }\n  } catch (error) {\n    appEvents.emit(AppEvents.alertError, ['Unable to select element, try selecting element in panel instead']);\n  }\n}\n\nexport function getElementTypes(shouldShowAdvancedTypes: boolean | undefined, current?: string): RegistrySelectInfo {\n  if (shouldShowAdvancedTypes) {\n    return getElementTypesOptions([...defaultElementItems, ...advancedElementItems], current);\n  }\n\n  return getElementTypesOptions([...defaultElementItems], current);\n}\n\ninterface RegistrySelectInfo {\n  options: Array<SelectableValue<string>>;\n  current: Array<SelectableValue<string>>;\n}\n\nexport function getElementTypesOptions(items: CanvasElementItem[], current: string | undefined): RegistrySelectInfo {\n  const selectables: RegistrySelectInfo = { options: [], current: [] };\n  const alpha: Array<SelectableValue<string>> = [];\n\n  for (const item of items) {\n    const option: SelectableValue<string> = { label: item.name, value: item.id, description: item.description };\n    if (item.state === PluginState.alpha) {\n      if (!hasAlphaPanels) {\n        continue;\n      }\n      option.label = `${item.name} (Alpha)`;\n      alpha.push(option);\n    } else {\n      selectables.options.push(option);\n    }\n\n    if (item.id === current) {\n      selectables.current.push(option);\n    }\n  }\n\n  for (const a of alpha) {\n    selectables.options.push(a);\n  }\n\n  return selectables;\n}\n\nexport function onAddItem(sel: SelectableValue<string>, rootLayer: FrameState | undefined, anchorPoint?: AnchorPoint) {\n  const newItem = canvasElementRegistry.getIfExists(sel.value) ?? notFoundItem;\n  const newElementOptions: CanvasElementOptions = {\n    ...newItem.getNewOptions(),\n    type: newItem.id,\n    name: '',\n  };\n\n  if (anchorPoint) {\n    newElementOptions.placement = { ...newElementOptions.placement, top: anchorPoint.y, left: anchorPoint.x };\n  }\n\n  if (newItem.defaultSize) {\n    newElementOptions.placement = { ...newElementOptions.placement, ...newItem.defaultSize };\n  }\n\n  if (rootLayer) {\n    const newElement = new ElementState(newItem, newElementOptions, rootLayer);\n    newElement.updateData(rootLayer.scene.context);\n    rootLayer.elements.push(newElement);\n    rootLayer.scene.save();\n    rootLayer.reinitializeMoveable();\n\n    setTimeout(() => doSelect(rootLayer.scene, newElement));\n  }\n}\n\nexport function isConnectionSource(element: ElementState) {\n  return element.options.connections && element.options.connections.length > 0;\n}\nexport function isConnectionTarget(element: ElementState, sceneByName: Map<string, ElementState>) {\n  const connections = getConnections(sceneByName);\n  return connections.some((connection) => connection.target === element);\n}\n\nexport function getConnections(sceneByName: Map<string, ElementState>) {\n  const connections: ConnectionState[] = [];\n  for (let v of sceneByName.values()) {\n    if (v.options.connections) {\n      v.options.connections.forEach((c, index) => {\n        // @TODO Remove after v10.x\n        if (isString(c.color)) {\n          c.color = { fixed: c.color };\n        }\n\n        if (isNumber(c.size)) {\n          c.size = { fixed: 2, min: 1, max: 10 };\n        }\n\n        const target = c.targetName ? sceneByName.get(c.targetName) : v.parent;\n        if (target) {\n          connections.push({\n            index,\n            source: v,\n            target,\n            info: c,\n            vertices: c.vertices ?? undefined,\n            sourceOriginal: c.sourceOriginal ?? undefined,\n            targetOriginal: c.targetOriginal ?? undefined,\n          });\n        }\n      });\n    }\n  }\n\n  return connections;\n}\n\nexport function getConnectionsByTarget(element: ElementState, scene: Scene) {\n  return scene.connections.state.filter((connection) => connection.target === element);\n}\n\nexport function updateConnectionsForSource(element: ElementState, scene: Scene) {\n  const targetConnections = getConnectionsByTarget(element, scene);\n  targetConnections.forEach((connection) => {\n    const sourceConnections = connection.source.options.connections?.splice(0) ?? [];\n    const connections = sourceConnections.filter((con) => con.targetName !== element.getName());\n    connection.source.onChange({ ...connection.source.options, connections });\n  });\n\n  // Update scene connection state to clear out old connections\n  scene.connections.updateState();\n}\n\nexport const calculateCoordinates = (\n  sourceRect: DOMRect,\n  parentRect: DOMRect,\n  info: CanvasConnection,\n  target: ElementState,\n  transformScale: number\n) => {\n  const sourceHorizontalCenter = sourceRect.left - parentRect.left + sourceRect.width / 2;\n  const sourceVerticalCenter = sourceRect.top - parentRect.top + sourceRect.height / 2;\n\n  // Convert from connection coords to DOM coords\n  const x1 = (sourceHorizontalCenter + (info.source.x * sourceRect.width) / 2) / transformScale;\n  const y1 = (sourceVerticalCenter - (info.source.y * sourceRect.height) / 2) / transformScale;\n\n  let x2: number;\n  let y2: number;\n  const targetRect = target.div?.getBoundingClientRect();\n  if (info.targetName && targetRect) {\n    const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n    const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n\n    x2 = targetHorizontalCenter + (info.target.x * targetRect.width) / 2;\n    y2 = targetVerticalCenter - (info.target.y * targetRect.height) / 2;\n  } else {\n    const parentHorizontalCenter = parentRect.width / 2;\n    const parentVerticalCenter = parentRect.height / 2;\n\n    x2 = parentHorizontalCenter + (info.target.x * parentRect.width) / 2;\n    y2 = parentVerticalCenter - (info.target.y * parentRect.height) / 2;\n  }\n  x2 /= transformScale;\n  y2 /= transformScale;\n\n  // TODO look into a better way to avoid division by zero\n  if (x2 - x1 === 0) {\n    x2 += 1;\n  }\n  if (y2 - y1 === 0) {\n    y2 += 1;\n  }\n  return { x1, y1, x2, y2 };\n};\n\nexport const calculateMidpoint = (x1: number, y1: number, x2: number, y2: number) => {\n  return { x: (x1 + x2) / 2, y: (y1 + y2) / 2 };\n};\n\nexport const calculateAbsoluteCoords = (\n  x1: number,\n  y1: number,\n  x2: number,\n  y2: number,\n  valueX: number,\n  valueY: number,\n  deltaX: number,\n  deltaY: number\n) => {\n  return { x: valueX * deltaX + x1, y: valueY * deltaY + y1 };\n};\n\n// Calculate angle between two points and return angle in radians\nexport const calculateAngle = (x1: number, y1: number, x2: number, y2: number) => {\n  return Math.atan2(y2 - y1, x2 - x1);\n};\n\nexport const calculateDistance = (x1: number, y1: number, x2: number, y2: number) => {\n  //TODO add sqrt approx option\n  return Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);\n};\n\n// @TODO revisit, currently returning last row index for field\nexport const getRowIndex = (fieldName: string | undefined, scene: Scene) => {\n  if (fieldName) {\n    const series = scene.data?.series[0];\n    const field = series?.fields.find((field) => field.name === fieldName);\n    const data = field?.values;\n    return data ? data.length - 1 : 0;\n  }\n  return 0;\n};\n\nexport const getConnectionStyles = (\n  info: CanvasConnection,\n  scene: Scene,\n  defaultArrowSize: number,\n  defaultArrowDirection: ConnectionDirection\n) => {\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const lastRowIndex = getRowIndex(info.size?.field, scene);\n  const strokeColor = info.color ? scene.context.getColor(info.color).value() : defaultArrowColor;\n  const strokeWidth = info.size ? scene.context.getScale(info.size).get(lastRowIndex) : defaultArrowSize;\n  const strokeRadius = info.radius ? scene.context.getScale(info.radius).get(lastRowIndex) : 0;\n  const arrowDirection = info.direction ? info.direction : defaultArrowDirection;\n  const lineStyle = getLineStyle(info.lineStyle?.style);\n  const shouldAnimate = info.lineStyle?.animate;\n\n  return { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate };\n};\n\nconst getLineStyle = (lineStyle?: LineStyle) => {\n  switch (lineStyle) {\n    case LineStyle.Dashed:\n      return StrokeDasharray.Dashed;\n    case LineStyle.Dotted:\n      return StrokeDasharray.Dotted;\n    default:\n      return StrokeDasharray.Solid;\n  }\n};\n\nexport const getParentBoundingClientRect = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    const transformRef = scene.transformComponentRef?.current;\n    return transformRef?.instance.contentComponent?.getBoundingClientRect();\n  }\n\n  return scene.div?.getBoundingClientRect();\n};\n\nexport const getTransformInstance = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    return scene.transformComponentRef?.current?.instance;\n  }\n  return undefined;\n};\n\nexport const getParent = (scene: Scene) => {\n  if (config.featureToggles.canvasPanelPanZoom) {\n    return scene.transformComponentRef?.current?.instance.contentComponent;\n  }\n  return scene.div;\n};\n\nexport function getElementFields(frames: DataFrame[], opts: CanvasElementOptions) {\n  const fields = new Set<Field>();\n  const cfg = opts.config ?? {};\n\n  frames.forEach((frame) => {\n    frame.fields.forEach((field) => {\n      const name = getFieldDisplayName(field, frame, frames);\n\n      // (intentional fall-through)\n      switch (name) {\n        // General element config\n        case opts.background?.color?.field:\n        case opts.background?.image?.field:\n        case opts.border?.color?.field:\n        // Text config\n        case cfg.text?.field:\n        case cfg.color?.field:\n        // Icon config\n        case cfg.path?.field:\n        case cfg.fill?.field:\n        // Server config\n        case cfg.blinkRate?.field:\n        case cfg.statusColor?.field:\n        case cfg.bulbColor?.field:\n        // Wind turbine config (maybe remove / not support this?)\n        case cfg.rpm?.field:\n          fields.add(field);\n      }\n    });\n  });\n\n  return [...fields];\n}\n","/*\nCopyright (c) 2019 Daybrush\nname: framework-utils\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/framework-utils.git\nversion: 1.1.0\n*/\nfunction prefixNames(prefix) {\n  var classNames = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    classNames[_i - 1] = arguments[_i];\n  }\n\n  return classNames.map(function (className) {\n    return className.split(\" \").map(function (name) {\n      return name ? \"\" + prefix + name : \"\";\n    }).join(\" \");\n  }).join(\" \");\n}\nfunction prefixCSS(prefix, css) {\n  return css.replace(/([^}{]*){/gm, function (_, selector) {\n    return selector.replace(/\\.([^{,\\s\\d.]+)/g, \".\" + prefix + \"$1\") + \"{\";\n  });\n}\n/* react */\n\nfunction ref(target, name) {\n  return function (e) {\n    e && (target[name] = e);\n  };\n}\nfunction refs(target, name, i) {\n  return function (e) {\n    e && (target[name][i] = e);\n  };\n}\n/* Class Decorator */\n\nfunction Properties(properties, action) {\n  return function (component) {\n    var prototype = component.prototype;\n    properties.forEach(function (property) {\n      action(prototype, property);\n    });\n  };\n}\n/* Property Decorator */\n\nfunction withMethods(methods, duplicate) {\n  if (duplicate === void 0) {\n    duplicate = {};\n  }\n\n  return function (prototype, propertyName) {\n    methods.forEach(function (name) {\n      var methodName = duplicate[name] || name;\n\n      if (methodName in prototype) {\n        return;\n      }\n\n      prototype[methodName] = function () {\n        var _a;\n\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var result = (_a = this[propertyName])[name].apply(_a, args);\n\n        if (result === this[propertyName]) {\n          return this;\n        } else {\n          return result;\n        }\n      };\n    });\n  };\n}\n\nexport { Properties, prefixCSS, prefixNames, ref, refs, withMethods };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.13.0\n*/\n/**\n* @namespace\n* @name Consts\n*/\n/**\n* get string \"rgb\"\n* @memberof Color\n* @example\nimport {RGB} from \"@daybrush/utils\";\n\nconsole.log(RGB); // \"rgb\"\n*/\nvar RGB = \"rgb\";\n/**\n* get string \"rgba\"\n* @memberof Color\n* @example\nimport {RGBA} from \"@daybrush/utils\";\n\nconsole.log(RGBA); // \"rgba\"\n*/\nvar RGBA = \"rgba\";\n/**\n* get string \"hsl\"\n* @memberof Color\n* @example\nimport {HSL} from \"@daybrush/utils\";\n\nconsole.log(HSL); // \"hsl\"\n*/\nvar HSL = \"hsl\";\n/**\n* get string \"hsla\"\n* @memberof Color\n* @example\nimport {HSLA} from \"@daybrush/utils\";\n\nconsole.log(HSLA); // \"hsla\"\n*/\nvar HSLA = \"hsla\";\n/**\n* gets an array of color models.\n* @memberof Color\n* @example\nimport {COLOR_MODELS} from \"@daybrush/utils\";\n\nconsole.log(COLOR_MODELS); // [\"rgb\", \"rgba\", \"hsl\", \"hsla\"];\n*/\nvar COLOR_MODELS = [RGB, RGBA, HSL, HSLA];\n/**\n* get string \"function\"\n* @memberof Consts\n* @example\nimport {FUNCTION} from \"@daybrush/utils\";\n\nconsole.log(FUNCTION); // \"function\"\n*/\nvar FUNCTION = \"function\";\n/**\n* get string \"property\"\n* @memberof Consts\n* @example\nimport {PROPERTY} from \"@daybrush/utils\";\n\nconsole.log(PROPERTY); // \"property\"\n*/\nvar PROPERTY = \"property\";\n/**\n* get string \"array\"\n* @memberof Consts\n* @example\nimport {ARRAY} from \"@daybrush/utils\";\n\nconsole.log(ARRAY); // \"array\"\n*/\nvar ARRAY = \"array\";\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\nvar STRING = \"string\";\n/**\n* get string \"number\"\n* @memberof Consts\n* @example\nimport {NUMBER} from \"@daybrush/utils\";\n\nconsole.log(NUMBER); // \"number\"\n*/\nvar NUMBER = \"number\";\n/**\n* get string \"undefined\"\n* @memberof Consts\n* @example\nimport {UNDEFINED} from \"@daybrush/utils\";\n\nconsole.log(UNDEFINED); // \"undefined\"\n*/\nvar UNDEFINED = \"undefined\";\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar IS_WINDOW = typeof window !== UNDEFINED;\n/**\n* Check whether the environment is window or node.js.\n* @memberof Consts\n* @name document\n* @example\nimport {IS_WINDOW} from \"@daybrush/utils\";\n\nconsole.log(IS_WINDOW); // false in node.js\nconsole.log(IS_WINDOW); // true in browser\n*/\nvar doc = typeof document !== UNDEFINED && document; // FIXME: this type maybe false\nvar prefixes = [\"webkit\", \"ms\", \"moz\", \"o\"];\n/**\n * @namespace CrossBrowser\n */\n/**\n* Get a CSS property with a vendor prefix that supports cross browser.\n* @function\n* @param {string} property - A CSS property\n* @return {string} CSS property with cross-browser vendor prefix\n* @memberof CrossBrowser\n* @example\nimport {getCrossBrowserProperty} from \"@daybrush/utils\";\n\nconsole.log(getCrossBrowserProperty(\"transform\")); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\nconsole.log(getCrossBrowserProperty(\"filter\")); // \"filter\", \"-webkit-filter\"\n*/\nvar getCrossBrowserProperty = /*#__PURE__*/function (property) {\n  if (!doc) {\n    return \"\";\n  }\n  var styles = (doc.body || doc.documentElement).style;\n  var length = prefixes.length;\n  if (typeof styles[property] !== UNDEFINED) {\n    return property;\n  }\n  for (var i = 0; i < length; ++i) {\n    var name = \"-\" + prefixes[i] + \"-\" + property;\n    if (typeof styles[name] !== UNDEFINED) {\n      return name;\n    }\n  }\n  return \"\";\n};\n/**\n* get string \"transfrom\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {TRANSFORM} from \"@daybrush/utils\";\n\nconsole.log(TRANSFORM); // \"transform\", \"-ms-transform\", \"-webkit-transform\"\n*/\nvar TRANSFORM = /*#__PURE__*/getCrossBrowserProperty(\"transform\");\n/**\n* get string \"filter\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {FILTER} from \"@daybrush/utils\";\n\nconsole.log(FILTER); // \"filter\", \"-ms-filter\", \"-webkit-filter\"\n*/\nvar FILTER = /*#__PURE__*/getCrossBrowserProperty(\"filter\");\n/**\n* get string \"animation\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {ANIMATION} from \"@daybrush/utils\";\n\nconsole.log(ANIMATION); // \"animation\", \"-ms-animation\", \"-webkit-animation\"\n*/\nvar ANIMATION = /*#__PURE__*/getCrossBrowserProperty(\"animation\");\n/**\n* get string \"keyframes\" with the vendor prefix.\n* @memberof CrossBrowser\n* @example\nimport {KEYFRAMES} from \"@daybrush/utils\";\n\nconsole.log(KEYFRAMES); // \"keyframes\", \"-ms-keyframes\", \"-webkit-keyframes\"\n*/\nvar KEYFRAMES = /*#__PURE__*/ANIMATION.replace(\"animation\", \"keyframes\");\nvar OPEN_CLOSED_CHARACTERS = [{\n  open: \"(\",\n  close: \")\"\n}, {\n  open: \"\\\"\",\n  close: \"\\\"\"\n}, {\n  open: \"'\",\n  close: \"'\"\n}, {\n  open: \"\\\\\\\"\",\n  close: \"\\\\\\\"\"\n}, {\n  open: \"\\\\'\",\n  close: \"\\\\'\"\n}];\nvar TINY_NUM = 0.0000001;\nvar REVERSE_TINY_NUM = 1 / TINY_NUM;\nvar DEFAULT_UNIT_PRESETS = {\n  \"cm\": function (pos) {\n    return pos * 96 / 2.54;\n  },\n  \"mm\": function (pos) {\n    return pos * 96 / 254;\n  },\n  \"in\": function (pos) {\n    return pos * 96;\n  },\n  \"pt\": function (pos) {\n    return pos * 96 / 72;\n  },\n  \"pc\": function (pos) {\n    return pos * 96 / 6;\n  },\n  \"%\": function (pos, size) {\n    return pos * size / 100;\n  },\n  \"vw\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerWidth;\n    }\n    return pos / 100 * size;\n  },\n  \"vh\": function (pos, size) {\n    if (size === void 0) {\n      size = window.innerHeight;\n    }\n    return pos / 100 * size;\n  },\n  \"vmax\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.max(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  },\n  \"vmin\": function (pos, size) {\n    if (size === void 0) {\n      size = Math.min(window.innerWidth, window.innerHeight);\n    }\n    return pos / 100 * size;\n  }\n};\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n  return r;\n}\n\n/**\n* @namespace\n* @name Utils\n*/\n/**\n * Returns the inner product of two numbers(`a1`, `a2`) by two criteria(`b1`, `b2`).\n * @memberof Utils\n * @param - The first number\n * @param - The second number\n * @param - The first number to base on the inner product\n * @param - The second number to base on the inner product\n * @return - Returns the inner product\nimport { dot } from \"@daybrush/utils\";\n\nconsole.log(dot(0, 15, 2, 3)); // 6\nconsole.log(dot(5, 15, 2, 3)); // 9\nconsole.log(dot(5, 15, 1, 1)); // 10\n */\nfunction dot(a1, a2, b1, b2) {\n  return (a1 * b2 + a2 * b1) / (b1 + b2);\n}\n/**\n* Check the type that the value is undefined.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {boolean} true if the type is correct, false otherwise\n* @example\nimport {isUndefined} from \"@daybrush/utils\";\n\nconsole.log(isUndefined(undefined)); // true\nconsole.log(isUndefined(\"\")); // false\nconsole.log(isUndefined(1)); // false\nconsole.log(isUndefined(null)); // false\n*/\nfunction isUndefined(value) {\n  return typeof value === UNDEFINED;\n}\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\nfunction isString(value) {\n  return typeof value === STRING;\n}\nfunction isNumber(value) {\n  return typeof value === NUMBER;\n}\n/**\n* Check the type that the value is function.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isFunction} from \"@daybrush/utils\";\n\nconsole.log(isFunction(function a() {})); // true\nconsole.log(isFunction(() => {})); // true\nconsole.log(isFunction(\"1234\")); // false\nconsole.log(isFunction(1)); // false\nconsole.log(isFunction(null)); // false\n*/\nfunction isFunction(value) {\n  return typeof value === FUNCTION;\n}\nfunction isEqualSeparator(character, separator) {\n  var isCharacterSpace = character === \"\" || character == \" \";\n  var isSeparatorSpace = separator === \"\" || separator == \" \";\n  return isSeparatorSpace && isCharacterSpace || character === separator;\n}\nfunction findOpen(openCharacter, texts, index, length, openCloseCharacters) {\n  var isIgnore = findIgnore(openCharacter, texts, index);\n  if (!isIgnore) {\n    return findClose(openCharacter, texts, index + 1, length, openCloseCharacters);\n  }\n  return index;\n}\nfunction findIgnore(character, texts, index) {\n  if (!character.ignore) {\n    return null;\n  }\n  var otherText = texts.slice(Math.max(index - 3, 0), index + 3).join(\"\");\n  return new RegExp(character.ignore).exec(otherText);\n}\nfunction findClose(closeCharacter, texts, index, length, openCloseCharacters) {\n  var _loop_1 = function (i) {\n    var character = texts[i].trim();\n    if (character === closeCharacter.close && !findIgnore(closeCharacter, texts, i)) {\n      return {\n        value: i\n      };\n    }\n    var nextIndex = i;\n    // re open\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n    }\n    if (nextIndex === -1) {\n      return out_i_1 = i, \"break\";\n    }\n    i = nextIndex;\n    out_i_1 = i;\n  };\n  var out_i_1;\n  for (var i = index; i < length; ++i) {\n    var state_1 = _loop_1(i);\n    i = out_i_1;\n    if (typeof state_1 === \"object\") return state_1.value;\n    if (state_1 === \"break\") break;\n  }\n  return -1;\n}\nfunction splitText(text, splitOptions) {\n  var _a = isString(splitOptions) ? {\n      separator: splitOptions\n    } : splitOptions,\n    _b = _a.separator,\n    separator = _b === void 0 ? \",\" : _b,\n    isSeparateFirst = _a.isSeparateFirst,\n    isSeparateOnlyOpenClose = _a.isSeparateOnlyOpenClose,\n    _c = _a.isSeparateOpenClose,\n    isSeparateOpenClose = _c === void 0 ? isSeparateOnlyOpenClose : _c,\n    _d = _a.openCloseCharacters,\n    openCloseCharacters = _d === void 0 ? OPEN_CLOSED_CHARACTERS : _d;\n  var openClosedText = openCloseCharacters.map(function (_a) {\n    var open = _a.open,\n      close = _a.close;\n    if (open === close) {\n      return open;\n    }\n    return open + \"|\" + close;\n  }).join(\"|\");\n  var regexText = \"(\\\\s*\" + separator + \"\\\\s*|\" + openClosedText + \"|\\\\s+)\";\n  var regex = new RegExp(regexText, \"g\");\n  var texts = text.split(regex).filter(function (chr) {\n    return chr && chr !== \"undefined\";\n  });\n  var length = texts.length;\n  var values = [];\n  var tempValues = [];\n  function resetTemp() {\n    if (tempValues.length) {\n      values.push(tempValues.join(\"\"));\n      tempValues = [];\n      return true;\n    }\n    return false;\n  }\n  var _loop_2 = function (i) {\n    var character = texts[i].trim();\n    var nextIndex = i;\n    var openCharacter = find(openCloseCharacters, function (_a) {\n      var open = _a.open;\n      return open === character;\n    });\n    var closeCharacter = find(openCloseCharacters, function (_a) {\n      var close = _a.close;\n      return close === character;\n    });\n    if (openCharacter) {\n      nextIndex = findOpen(openCharacter, texts, i, length, openCloseCharacters);\n      if (nextIndex !== -1 && isSeparateOpenClose) {\n        if (resetTemp() && isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        values.push(texts.slice(i, nextIndex + 1).join(\"\"));\n        i = nextIndex;\n        if (isSeparateFirst) {\n          return out_i_2 = i, \"break\";\n        }\n        return out_i_2 = i, \"continue\";\n      }\n    } else if (closeCharacter && !findIgnore(closeCharacter, texts, i)) {\n      var nextOpenCloseCharacters = __spreadArrays(openCloseCharacters);\n      nextOpenCloseCharacters.splice(openCloseCharacters.indexOf(closeCharacter), 1);\n      return {\n        value: splitText(text, {\n          separator: separator,\n          isSeparateFirst: isSeparateFirst,\n          isSeparateOnlyOpenClose: isSeparateOnlyOpenClose,\n          isSeparateOpenClose: isSeparateOpenClose,\n          openCloseCharacters: nextOpenCloseCharacters\n        })\n      };\n    } else if (isEqualSeparator(character, separator) && !isSeparateOnlyOpenClose) {\n      resetTemp();\n      if (isSeparateFirst) {\n        return out_i_2 = i, \"break\";\n      }\n      return out_i_2 = i, \"continue\";\n    }\n    if (nextIndex === -1) {\n      nextIndex = length - 1;\n    }\n    tempValues.push(texts.slice(i, nextIndex + 1).join(\"\"));\n    i = nextIndex;\n    out_i_2 = i;\n  };\n  var out_i_2;\n  for (var i = 0; i < length; ++i) {\n    var state_2 = _loop_2(i);\n    i = out_i_2;\n    if (typeof state_2 === \"object\") return state_2.value;\n    if (state_2 === \"break\") break;\n  }\n  if (tempValues.length) {\n    values.push(tempValues.join(\"\"));\n  }\n  return values;\n}\n/**\n* divide text by space.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {spliceSpace} from \"@daybrush/utils\";\n\nconsole.log(splitSpace(\"a b c d e f g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitSpace(\"'a,b' c 'd,e' f g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitSpace(text) {\n  // divide comma(space)\n  return splitText(text, \"\");\n}\n/**\n* divide text by comma.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {Array} divided texts\n* @example\nimport {splitComma} from \"@daybrush/utils\";\n\nconsole.log(splitComma(\"a,b,c,d,e,f,g\"));\n// [\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\"]\nconsole.log(splitComma(\"'a,b',c,'d,e',f,g\"));\n// [\"'a,b'\", \"c\", \"'d,e'\", \"f\", \"g\"]\n*/\nfunction splitComma(text) {\n  // divide comma(,)\n  // \"[^\"]*\"|'[^']*'\n  return splitText(text, \",\");\n}\n/**\n* divide text by bracket \"(\", \")\".\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {object} divided texts\n* @example\nimport {splitBracket} from \"@daybrush/utils\";\n\nconsole.log(splitBracket(\"a(1, 2)\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"\"}\nconsole.log(splitBracket(\"a(1, 2)b\"));\n// {prefix: \"a\", value: \"1, 2\", suffix: \"b\"}\n*/\nfunction splitBracket(text) {\n  var matches = /([^(]*)\\(([\\s\\S]*)\\)([\\s\\S]*)/g.exec(text);\n  if (!matches || matches.length < 4) {\n    return {};\n  } else {\n    return {\n      prefix: matches[1],\n      value: matches[2],\n      suffix: matches[3]\n    };\n  }\n}\n/**\n* divide text by number and unit.\n* @memberof Utils\n* @param {string} text - text to divide\n* @return {} divided texts\n* @example\nimport {splitUnit} from \"@daybrush/utils\";\n\nconsole.log(splitUnit(\"10px\"));\n// {prefix: \"\", value: 10, unit: \"px\"}\nconsole.log(splitUnit(\"-10px\"));\n// {prefix: \"\", value: -10, unit: \"px\"}\nconsole.log(splitUnit(\"a10%\"));\n// {prefix: \"a\", value: 10, unit: \"%\"}\n*/\nfunction splitUnit(text) {\n  var matches = /^([^\\d|e|\\-|\\+]*)((?:\\d|\\.|-|e-|e\\+)+)(\\S*)$/g.exec(text);\n  if (!matches) {\n    return {\n      prefix: \"\",\n      unit: \"\",\n      value: NaN\n    };\n  }\n  var prefix = matches[1];\n  var value = matches[2];\n  var unit = matches[3];\n  return {\n    prefix: prefix,\n    unit: unit,\n    value: parseFloat(value)\n  };\n}\n/**\n* transform strings to camel-case\n* @memberof Utils\n* @param {String} text - string\n* @return {String} camel-case string\n* @example\nimport {camelize} from \"@daybrush/utils\";\n\nconsole.log(camelize(\"transform-origin\")); // transformOrigin\nconsole.log(camelize(\"abcd_efg\")); // abcdEfg\nconsole.log(camelize(\"abcd efg\")); // abcdEfg\n*/\nfunction camelize(str) {\n  return str.replace(/[\\s-_]+([^\\s-_])/g, function (all, letter) {\n    return letter.toUpperCase();\n  });\n}\n/**\n* transform a camelized string into a lowercased string.\n* @memberof Utils\n* @param {string} text - a camel-cased string\n* @param {string} [separator=\"-\"] - a separator\n* @return {string}  a lowercased string\n* @example\nimport {decamelize} from \"@daybrush/utils\";\n\nconsole.log(decamelize(\"transformOrigin\")); // transform-origin\nconsole.log(decamelize(\"abcdEfg\", \"_\")); // abcd_efg\n*/\nfunction decamelize(str, separator) {\n  if (separator === void 0) {\n    separator = \"-\";\n  }\n  return str.replace(/([a-z])([A-Z])/g, function (all, letter, letter2) {\n    return \"\" + letter + separator + letter2.toLowerCase();\n  });\n}\n/**\n* transforms something in an array into an array.\n* @memberof Utils\n* @param - Array form\n* @return an array\n* @example\nimport {toArray} from \"@daybrush/utils\";\n\nconst arr1 = toArray(document.querySelectorAll(\".a\")); // Element[]\nconst arr2 = toArray(document.querySelectorAll<HTMLElement>(\".a\")); // HTMLElement[]\n*/\nfunction toArray(value) {\n  return [].slice.call(value);\n}\n/**\n* Date.now() method\n* @memberof CrossBrowser\n* @return {number} milliseconds\n* @example\nimport {now} from \"@daybrush/utils\";\n\nconsole.log(now()); // 12121324241(milliseconds)\n*/\nfunction now() {\n  return Date.now ? Date.now() : new Date().getTime();\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the reverse direction index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLastIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findLastIndex } from \"@daybrush/utils\";\n\nfindLastIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\nfunction findLastIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n  var length = arr.length;\n  for (var i = length - 1; i >= 0; --i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n  return defaultIndex;\n}\n/**\n* Returns the value of the reverse direction element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findLast` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction findLast(arr, callback, defalutValue) {\n  var index = findLastIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* Returns the value of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `find` was called upon.\n* @param - A function to execute on each value in the array,\n* @param - Returns defalutValue if not found by the function.\n* @example\nimport { find } from \"@daybrush/utils\";\n\nfind([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // {a: 2}\n*/\nfunction find(arr, callback, defalutValue) {\n  var index = findIndex(arr, callback);\n  return index > -1 ? arr[index] : defalutValue;\n}\n/**\n* window.requestAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {FrameRequestCallback} callback - The function to call when it's time to update your animation for the next repaint.\n* @return {number} id\n* @example\nimport {requestAnimationFrame} from \"@daybrush/utils\";\n\nrequestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n*/\nvar requestAnimationFrame = /*#__PURE__*/function () {\n  var firstTime = now();\n  var raf = IS_WINDOW && (window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.msRequestAnimationFrame);\n  return raf ? raf.bind(window) : function (callback) {\n    var currTime = now();\n    var id = setTimeout(function () {\n      callback(currTime - firstTime);\n    }, 1000 / 60);\n    return id;\n  };\n}();\n/**\n* window.cancelAnimationFrame() method with cross browser.\n* @function\n* @memberof CrossBrowser\n* @param {number} handle - the id obtained through requestAnimationFrame method\n* @return {void}\n* @example\nimport { requestAnimationFrame, cancelAnimationFrame } from \"@daybrush/utils\";\n\nconst id = requestAnimationFrame((timestamp) => {\n  console.log(timestamp);\n});\n\ncancelAnimationFrame(id);\n*/\nvar cancelAnimationFrame = /*#__PURE__*/function () {\n  var caf = IS_WINDOW && (window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.msCancelAnimationFrame);\n  return caf ? caf.bind(window) : function (handle) {\n    clearTimeout(handle);\n  };\n}();\n/**\n* @function\n* @memberof Utils\n*/\nfunction getKeys(obj) {\n  return Object.keys(obj);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getValues(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return obj[key];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction getEntries(obj) {\n  var keys = getKeys(obj);\n  return keys.map(function (key) {\n    return [key, obj[key]];\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction sortOrders(keys, orders) {\n  if (orders === void 0) {\n    orders = [];\n  }\n  keys.sort(function (a, b) {\n    var index1 = orders.indexOf(a);\n    var index2 = orders.indexOf(b);\n    if (index2 === -1 && index1 === -1) {\n      return 0;\n    }\n    if (index1 === -1) {\n      return 1;\n    }\n    if (index2 === -1) {\n      return -1;\n    }\n    return index1 - index2;\n  });\n}\n/**\n* convert unit size to px size\n* @function\n* @memberof Utils\n*/\nfunction convertUnitSize(pos, size) {\n  var _a = splitUnit(pos),\n    value = _a.value,\n    unit = _a.unit;\n  if (isObject(size)) {\n    var sizeFunction = size[unit];\n    if (sizeFunction) {\n      if (isFunction(sizeFunction)) {\n        return sizeFunction(value);\n      } else if (DEFAULT_UNIT_PRESETS[unit]) {\n        return DEFAULT_UNIT_PRESETS[unit](value, sizeFunction);\n      }\n    }\n  } else if (unit === \"%\") {\n    return value * size / 100;\n  }\n  if (DEFAULT_UNIT_PRESETS[unit]) {\n    return DEFAULT_UNIT_PRESETS[unit](value);\n  }\n  return value;\n}\n/**\n* calculate between min, max\n* @function\n* @memberof Utils\n*/\nfunction between(value, min, max) {\n  return Math.max(min, Math.min(value, max));\n}\nfunction checkBoundSize(targetSize, compareSize, isMax, ratio) {\n  if (ratio === void 0) {\n    ratio = targetSize[0] / targetSize[1];\n  }\n  return [[throttle(compareSize[0], TINY_NUM), throttle(compareSize[0] / ratio, TINY_NUM)], [throttle(compareSize[1] * ratio, TINY_NUM), throttle(compareSize[1], TINY_NUM)]].filter(function (size) {\n    return size.every(function (value, i) {\n      var defaultSize = compareSize[i];\n      var throttledSize = throttle(defaultSize, TINY_NUM);\n      return isMax ? value <= defaultSize || value <= throttledSize : value >= defaultSize || value >= throttledSize;\n    });\n  })[0] || targetSize;\n}\n/**\n* calculate bound size\n* @function\n* @memberof Utils\n*/\nfunction calculateBoundSize(size, minSize, maxSize, keepRatio) {\n  if (!keepRatio) {\n    return size.map(function (value, i) {\n      return between(value, minSize[i], maxSize[i]);\n    });\n  }\n  var width = size[0],\n    height = size[1];\n  var ratio = keepRatio === true ? width / height : keepRatio;\n  // width : height = minWidth : minHeight;\n  var _a = checkBoundSize(size, minSize, false, ratio),\n    minWidth = _a[0],\n    minHeight = _a[1];\n  var _b = checkBoundSize(size, maxSize, true, ratio),\n    maxWidth = _b[0],\n    maxHeight = _b[1];\n  if (width < minWidth || height < minHeight) {\n    width = minWidth;\n    height = minHeight;\n  } else if (width > maxWidth || height > maxHeight) {\n    width = maxWidth;\n    height = maxHeight;\n  }\n  return [width, height];\n}\n/**\n* Add all the numbers.\n* @function\n* @memberof Utils\n*/\nfunction sum(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return total;\n}\n/**\n* Average all numbers.\n* @function\n* @memberof Utils\n*/\nfunction average(nums) {\n  var length = nums.length;\n  var total = 0;\n  for (var i = length - 1; i >= 0; --i) {\n    total += nums[i];\n  }\n  return length ? total / length : 0;\n}\n/**\n* Get the angle of two points. (0 <= rad < 359)\n* @function\n* @memberof Utils\n*/\nfunction getRad(pos1, pos2) {\n  var distX = pos2[0] - pos1[0];\n  var distY = pos2[1] - pos1[1];\n  var rad = Math.atan2(distY, distX);\n  return rad >= 0 ? rad : rad + Math.PI * 2;\n}\n/**\n* Get the average point of all points.\n* @function\n* @memberof Utils\n*/\nfunction getCenterPoint(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n/**\n* Gets the direction of the shape.\n* @function\n* @memberof Utils\n*/\nfunction getShapeDirection(points) {\n  var center = getCenterPoint(points);\n  var pos1Rad = getRad(center, points[0]);\n  var pos2Rad = getRad(center, points[1]);\n  return pos1Rad < pos2Rad && pos2Rad - pos1Rad < Math.PI || pos1Rad > pos2Rad && pos2Rad - pos1Rad < -Math.PI ? 1 : -1;\n}\n/**\n* Get the distance between two points.\n* @function\n* @memberof Utils\n*/\nfunction getDist(a, b) {\n  return Math.sqrt(Math.pow((b ? b[0] : 0) - a[0], 2) + Math.pow((b ? b[1] : 0) - a[1], 2));\n}\n/**\n* throttle number depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttle(num, unit) {\n  if (!unit) {\n    return num;\n  }\n  var reverseUnit = 1 / unit;\n  return Math.round(num / unit) / reverseUnit;\n}\n/**\n* throttle number array depending on the unit.\n* @function\n* @memberof Utils\n*/\nfunction throttleArray(nums, unit) {\n  nums.forEach(function (_, i) {\n    nums[i] = throttle(nums[i], unit);\n  });\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction counter(num) {\n  var nums = [];\n  for (var i = 0; i < num; ++i) {\n    nums.push(i);\n  }\n  return nums;\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction replaceOnce(text, fromText, toText) {\n  var isOnce = false;\n  return text.replace(fromText, function () {\n    var args = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n    if (isOnce) {\n      return args[0];\n    }\n    isOnce = true;\n    return isString(toText) ? toText : toText.apply(void 0, args);\n  });\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction flat(arr) {\n  return arr.reduce(function (prev, cur) {\n    return prev.concat(cur);\n  }, []);\n}\n/**\n* @function\n* @memberof Utils\n*/\nfunction deepFlat(arr) {\n  return arr.reduce(function (prev, cur) {\n    if (isArray(cur)) {\n      prev.push.apply(prev, deepFlat(cur));\n    } else {\n      prev.push(cur);\n    }\n    return prev;\n  }, []);\n}\n/**\n * @function\n * @memberof Utils\n */\nfunction pushSet(elements, element) {\n  if (elements.indexOf(element) === -1) {\n    elements.push(element);\n  }\n}\n\n/**\n* @namespace\n* @name Color\n*/\n/**\n* Remove the # from the hex color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} hex color\n* @example\nimport {cutHex} from \"@daybrush/utils\";\n\nconsole.log(cutHex(\"#000000\")) // \"000000\"\n*/\nfunction cutHex(hex) {\n  return hex.replace(\"#\", \"\");\n}\n/**\n* convert hex color to rgb color.\n* @memberof Color\n* @param {} hex - hex color\n* @return {} rgb color\n* @example\nimport {hexToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hexToRGBA(\"#00000005\"));\n// [0, 0, 0, 1]\nconsole.log(hexToRGBA(\"#201045\"));\n// [32, 16, 69, 1]\n*/\nfunction hexToRGBA(hex) {\n  var h = cutHex(hex);\n  var r = parseInt(h.substring(0, 2), 16);\n  var g = parseInt(h.substring(2, 4), 16);\n  var b = parseInt(h.substring(4, 6), 16);\n  var a = parseInt(h.substring(6, 8), 16) / 255;\n  if (isNaN(a)) {\n    a = 1;\n  }\n  return [r, g, b, a];\n}\n/**\n* convert 3(or 4)-digit hex color to 6(or 8)-digit hex color.\n* @memberof Color\n* @param {} hex - 3(or 4)-digit hex color\n* @return {} 6(or 8)-digit hex color\n* @example\nimport {toFullHex} from \"@daybrush/utils\";\n\nconsole.log(toFullHex(\"#123\")); // \"#112233\"\nconsole.log(toFullHex(\"#123a\")); // \"#112233aa\"\n*/\nfunction toFullHex(h) {\n  var r = h.charAt(1);\n  var g = h.charAt(2);\n  var b = h.charAt(3);\n  var a = h.charAt(4);\n  var arr = [\"#\", r, r, g, g, b, b, a, a];\n  return arr.join(\"\");\n}\n/**\n* convert hsl color to rgba color.\n* @memberof Color\n* @param {} hsl - hsl color(hue: 0 ~ 360, saturation: 0 ~ 1, lightness: 0 ~ 1, alpha: 0 ~ 1)\n* @return {} rgba color\n* @example\nimport {hslToRGBA} from \"@daybrush/utils\";\n\nconsole.log(hslToRGBA([150, 0.5, 0.4]));\n// [51, 153, 102, 1]\n*/\nfunction hslToRGBA(hsl) {\n  var _a;\n  var h = hsl[0];\n  var s = hsl[1];\n  var l = hsl[2];\n  if (h < 0) {\n    h += Math.floor((Math.abs(h) + 360) / 360) * 360;\n  }\n  h %= 360;\n  var c = (1 - Math.abs(2 * l - 1)) * s;\n  var x = c * (1 - Math.abs(h / 60 % 2 - 1));\n  var m = l - c / 2;\n  var rgb;\n  if (h < 60) {\n    rgb = [c, x, 0];\n  } else if (h < 120) {\n    rgb = [x, c, 0];\n  } else if (h < 180) {\n    rgb = [0, c, x];\n  } else if (h < 240) {\n    rgb = [0, x, c];\n  } else if (h < 300) {\n    rgb = [x, 0, c];\n  } else if (h < 360) {\n    rgb = [c, 0, x];\n  } else {\n    rgb = [0, 0, 0];\n  }\n  return [Math.round((rgb[0] + m) * 255), Math.round((rgb[1] + m) * 255), Math.round((rgb[2] + m) * 255), (_a = hsl[3]) !== null && _a !== void 0 ? _a : 1];\n}\n/**\n* convert string to rgba color.\n* @memberof Color\n* @param {} - 3-hex(#000), 4-hex(#0000) 6-hex(#000000), 8-hex(#00000000) or RGB(A), or HSL(A)\n* @return {} rgba color\n* @example\nimport {stringToRGBA} from \"@daybrush/utils\";\n\nconsole.log(stringToRGBA(\"#000000\")); // [0, 0, 0, 1]\nconsole.log(stringToRGBA(\"rgb(100, 100, 100)\")); // [100, 100, 100, 1]\nconsole.log(stringToRGBA(\"hsl(150, 0.5, 0.4)\")); // [51, 153, 102, 1]\n*/\nfunction stringToRGBA(color) {\n  if (color.charAt(0) === \"#\") {\n    if (color.length === 4 || color.length === 5) {\n      return hexToRGBA(toFullHex(color));\n    } else {\n      return hexToRGBA(color);\n    }\n  } else if (color.indexOf(\"(\") !== -1) {\n    // in bracket.\n    var _a = splitBracket(color),\n      prefix = _a.prefix,\n      value = _a.value;\n    if (!prefix || !value) {\n      return undefined;\n    }\n    var arr = splitComma(value);\n    var colorArr = [0, 0, 0, 1];\n    var length = arr.length;\n    switch (prefix) {\n      case RGB:\n      case RGBA:\n        for (var i = 0; i < length; ++i) {\n          colorArr[i] = parseFloat(arr[i]);\n        }\n        return colorArr;\n      case HSL:\n      case HSLA:\n        for (var i = 0; i < length; ++i) {\n          if (arr[i].indexOf(\"%\") !== -1) {\n            colorArr[i] = parseFloat(arr[i]) / 100;\n          } else {\n            colorArr[i] = parseFloat(arr[i]);\n          }\n        }\n        // hsl, hsla to rgba\n        return hslToRGBA(colorArr);\n    }\n  }\n  return undefined;\n}\n\n/**\n * Returns all element descendants of node that\n * match selectors.\n */\n/**\n * Checks if the specified class value exists in the element's class attribute.\n * @memberof DOM\n * @param - A DOMString containing one or more selectors to match\n * @param - If multi is true, a DOMString containing one or more selectors to match against.\n * @example\nimport {$} from \"@daybrush/utils\";\n\nconsole.log($(\"div\")); // div element\nconsole.log($(\"div\", true)); // [div, div] elements\n*/\nfunction $(selectors, multi) {\n  if (!doc) {\n    return multi ? [] : null;\n  }\n  return multi ? doc.querySelectorAll(selectors) : doc.querySelector(selectors);\n}\n/**\n* Checks if the specified class value exists in the element's class attribute.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to search\n* @return {boolean} return false if the class is not found.\n* @example\nimport {hasClass} from \"@daybrush/utils\";\n\nconsole.log(hasClass(element, \"start\")); // true or false\n*/\nfunction hasClass(element, className) {\n  if (element.classList) {\n    return element.classList.contains(className);\n  }\n  return !!element.className.match(new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\"));\n}\n/**\n* Add the specified class value. If these classe already exist in the element's class attribute they are ignored.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to add\n* @example\nimport {addClass} from \"@daybrush/utils\";\n\naddClass(element, \"start\");\n*/\nfunction addClass(element, className) {\n  if (element.classList) {\n    element.classList.add(className);\n  } else {\n    element.className += \" \" + className;\n  }\n}\n/**\n* Removes the specified class value.\n* @memberof DOM\n* @param element - target\n* @param className - the class name to remove\n* @example\nimport {removeClass} from \"@daybrush/utils\";\n\nremoveClass(element, \"start\");\n*/\nfunction removeClass(element, className) {\n  if (element.classList) {\n    element.classList.remove(className);\n  } else {\n    var reg = new RegExp(\"(\\\\s|^)\" + className + \"(\\\\s|$)\");\n    element.className = element.className.replace(reg, \" \");\n  }\n}\n/**\n* Gets the CSS properties from the element.\n* @memberof DOM\n* @param elements - elements\n* @param properites - the CSS properties\n* @return returns CSS properties and values.\n* @example\nimport {fromCSS} from \"@daybrush/utils\";\n\nconsole.log(fromCSS(element, [\"left\", \"opacity\", \"top\"])); // {\"left\": \"10px\", \"opacity\": 1, \"top\": \"10px\"}\n*/\nfunction fromCSS(elements, properties) {\n  if (!elements || !properties || !properties.length) {\n    return {};\n  }\n  var element;\n  if (elements instanceof Element) {\n    element = elements;\n  } else if (elements.length) {\n    element = elements[0];\n  } else {\n    return {};\n  }\n  var cssObject = {};\n  var styles = getWindow(element).getComputedStyle(element);\n  var length = properties.length;\n  for (var i = 0; i < length; ++i) {\n    cssObject[properties[i]] = styles[properties[i]];\n  }\n  return cssObject;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\nfunction getDocument(el) {\n  return (el === null || el === void 0 ? void 0 : el.ownerDocument) || doc;\n}\nfunction getDocumentElement(el) {\n  return getDocument(el).documentElement;\n}\nfunction getDocumentBody(el) {\n  return getDocument(el).body;\n}\nfunction getWindow(el) {\n  var _a;\n  return ((_a = el === null || el === void 0 ? void 0 : el.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) || window;\n}\nfunction isWindow(val) {\n  return val && \"postMessage\" in val && \"blur\" in val && \"self\" in val;\n}\nfunction isNode(el) {\n  return isObject(el) && el.nodeName && el.nodeType && \"ownerDocument\" in el;\n}\n\nexport { RGB, RGBA, HSL, HSLA, COLOR_MODELS, FUNCTION, PROPERTY, ARRAY, OBJECT, STRING, NUMBER, UNDEFINED, IS_WINDOW, doc as document, getCrossBrowserProperty, TRANSFORM, FILTER, ANIMATION, KEYFRAMES, OPEN_CLOSED_CHARACTERS, TINY_NUM, REVERSE_TINY_NUM, DEFAULT_UNIT_PRESETS, cutHex, hexToRGBA, toFullHex, hslToRGBA, stringToRGBA, dot, isUndefined, isObject, isArray, isString, isNumber, isFunction, splitText, splitSpace, splitComma, splitBracket, splitUnit, camelize, decamelize, toArray, now, findIndex, findLastIndex, findLast, find, requestAnimationFrame, cancelAnimationFrame, getKeys, getValues, getEntries, sortOrders, convertUnitSize, between, checkBoundSize, calculateBoundSize, sum, average, getRad, getCenterPoint, getShapeDirection, getDist, throttle, throttleArray, counter, replaceOnce, flat, deepFlat, pushSet, $, hasClass, addClass, removeClass, fromCSS, addEvent, removeEvent, getDocument, getDocumentElement, getDocumentBody, getWindow, isWindow, isNode };\n//# sourceMappingURL=utils.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/list-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-list-differ\nversion: 1.0.0\n*/\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar PolyMap =\n/*#__PURE__*/\nfunction () {\n  function PolyMap() {\n    this.keys = [];\n    this.values = [];\n  }\n\n  var __proto = PolyMap.prototype;\n\n  __proto.get = function (key) {\n    return this.values[this.keys.indexOf(key)];\n  };\n\n  __proto.set = function (key, value) {\n    var keys = this.keys;\n    var values = this.values;\n    var prevIndex = keys.indexOf(key);\n    var index = prevIndex === -1 ? keys.length : prevIndex;\n    keys[index] = key;\n    values[index] = value;\n  };\n\n  return PolyMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar HashMap =\n/*#__PURE__*/\nfunction () {\n  function HashMap() {\n    this.object = {};\n  }\n\n  var __proto = HashMap.prototype;\n\n  __proto.get = function (key) {\n    return this.object[key];\n  };\n\n  __proto.set = function (key, value) {\n    this.object[key] = value;\n  };\n\n  return HashMap;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar SUPPORT_MAP = typeof Map === \"function\";\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar Link =\n/*#__PURE__*/\nfunction () {\n  function Link() {}\n\n  var __proto = Link.prototype;\n\n  __proto.connect = function (prevLink, nextLink) {\n    this.prev = prevLink;\n    this.next = nextLink;\n    prevLink && (prevLink.next = this);\n    nextLink && (nextLink.prev = this);\n  };\n\n  __proto.disconnect = function () {\n    // In double linked list, diconnect the interconnected relationship.\n    var prevLink = this.prev;\n    var nextLink = this.next;\n    prevLink && (prevLink.next = nextLink);\n    nextLink && (nextLink.prev = prevLink);\n  };\n\n  __proto.getIndex = function () {\n    var link = this;\n    var index = -1;\n\n    while (link) {\n      link = link.prev;\n      ++index;\n    }\n\n    return index;\n  };\n\n  return Link;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nfunction orderChanged(changed, fixed) {\n  // It is roughly in the order of these examples.\n  // 4, 6, 0, 2, 1, 3, 5, 7\n  var fromLinks = []; // 0, 1, 2, 3, 4, 5, 6, 7\n\n  var toLinks = [];\n  changed.forEach(function (_a) {\n    var from = _a[0],\n        to = _a[1];\n    var link = new Link();\n    fromLinks[from] = link;\n    toLinks[to] = link;\n  }); // `fromLinks` are connected to each other by double linked list.\n\n  fromLinks.forEach(function (link, i) {\n    link.connect(fromLinks[i - 1]);\n  });\n  return changed.filter(function (_, i) {\n    return !fixed[i];\n  }).map(function (_a, i) {\n    var from = _a[0],\n        to = _a[1];\n\n    if (from === to) {\n      return [0, 0];\n    }\n\n    var fromLink = fromLinks[from];\n    var toLink = toLinks[to - 1];\n    var fromIndex = fromLink.getIndex(); // Disconnect the link connected to `fromLink`.\n\n    fromLink.disconnect(); // Connect `fromLink` to the right of `toLink`.\n\n    if (!toLink) {\n      fromLink.connect(undefined, fromLinks[0]);\n    } else {\n      fromLink.connect(toLink, toLink.next);\n    }\n\n    var toIndex = fromLink.getIndex();\n    return [fromIndex, toIndex];\n  });\n}\n\nvar Result =\n/*#__PURE__*/\nfunction () {\n  function Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed) {\n    this.prevList = prevList;\n    this.list = list;\n    this.added = added;\n    this.removed = removed;\n    this.changed = changed;\n    this.maintained = maintained;\n    this.changedBeforeAdded = changedBeforeAdded;\n    this.fixed = fixed;\n  }\n\n  var __proto = Result.prototype;\n  Object.defineProperty(__proto, \"ordered\", {\n    get: function () {\n      if (!this.cacheOrdered) {\n        this.caculateOrdered();\n      }\n\n      return this.cacheOrdered;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(__proto, \"pureChanged\", {\n    get: function () {\n      if (!this.cachePureChanged) {\n        this.caculateOrdered();\n      }\n\n      return this.cachePureChanged;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  __proto.caculateOrdered = function () {\n    var ordered = orderChanged(this.changedBeforeAdded, this.fixed);\n    var changed = this.changed;\n    var pureChanged = [];\n    this.cacheOrdered = ordered.filter(function (_a, i) {\n      var from = _a[0],\n          to = _a[1];\n      var _b = changed[i],\n          fromBefore = _b[0],\n          toBefore = _b[1];\n\n      if (from !== to) {\n        pureChanged.push([fromBefore, toBefore]);\n        return true;\n      }\n    });\n    this.cachePureChanged = pureChanged;\n  };\n\n  return Result;\n}();\n\n/**\n *\n * @memberof eg.ListDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @param - This callback function returns the key of the item. <ko>     .</ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/list-differ\";\n * // script => eg.ListDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1], e => e);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list, findKeyCallback) {\n  var mapClass = SUPPORT_MAP ? Map : findKeyCallback ? HashMap : PolyMap;\n\n  var callback = findKeyCallback || function (e) {\n    return e;\n  };\n\n  var added = [];\n  var removed = [];\n  var maintained = [];\n  var prevKeys = prevList.map(callback);\n  var keys = list.map(callback);\n  var prevKeyMap = new mapClass();\n  var keyMap = new mapClass();\n  var changedBeforeAdded = [];\n  var fixed = [];\n  var removedMap = {};\n  var changed = [];\n  var addedCount = 0;\n  var removedCount = 0; // Add prevKeys and keys to the hashmap.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    prevKeyMap.set(key, prevListIndex);\n  });\n  keys.forEach(function (key, listIndex) {\n    keyMap.set(key, listIndex);\n  }); // Compare `prevKeys` and `keys` and add them to `removed` if they are not in `keys`.\n\n  prevKeys.forEach(function (key, prevListIndex) {\n    var listIndex = keyMap.get(key); // In prevList, but not in list, it is removed.\n\n    if (typeof listIndex === \"undefined\") {\n      ++removedCount;\n      removed.push(prevListIndex);\n    } else {\n      removedMap[listIndex] = removedCount;\n    }\n  }); // Compare `prevKeys` and `keys` and add them to `added` if they are not in `prevKeys`.\n\n  keys.forEach(function (key, listIndex) {\n    var prevListIndex = prevKeyMap.get(key); // In list, but not in prevList, it is added.\n\n    if (typeof prevListIndex === \"undefined\") {\n      added.push(listIndex);\n      ++addedCount;\n    } else {\n      maintained.push([prevListIndex, listIndex]);\n      removedCount = removedMap[listIndex] || 0;\n      changedBeforeAdded.push([prevListIndex - removedCount, listIndex - addedCount]);\n      fixed.push(listIndex === prevListIndex);\n\n      if (prevListIndex !== listIndex) {\n        changed.push([prevListIndex, listIndex]);\n      }\n    }\n  }); // Sort by ascending order of 'to(list's index).\n\n  removed.reverse();\n  return new Result(prevList, list, added, removed, changed, maintained, changedBeforeAdded, fixed);\n}\n\n/**\n * A module that checks diff when values are added, removed, or changed in an array.\n * @ko          .\n * @memberof eg\n */\n\nvar ListDiffer =\n/*#__PURE__*/\nfunction () {\n  /**\n   * @param - Initializing Data Array. <ko>    .</ko>\n   * @param - This callback function returns the key of the item. <ko>     .</ko>\n   * @example\n   * import ListDiffer from \"@egjs/list-differ\";\n   * // script => eg.ListDiffer\n   * const differ = new ListDiffer([0, 1, 2, 3, 4, 5], e => e);\n   * const result = differ.update([7, 8, 0, 4, 3, 6, 2, 1]);\n   * // List before update\n   * // [1, 2, 3, 4, 5]\n   * console.log(result.prevList);\n   * // Updated list\n   * // [4, 3, 6, 2, 1]\n   * console.log(result.list);\n   * // Index array of values added to `list`.\n   * // [0, 1, 5]\n   * console.log(result.added);\n   * // Index array of values removed in `prevList`.\n   * // [5]\n   * console.log(result.removed);\n   * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.changed);\n   * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n   * // [[4, 3], [3, 4], [2, 6]]\n   * console.log(result.pureChanged);\n   * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n   * // [[4, 1], [4, 2], [4, 3]]\n   * console.log(result.ordered);\n   * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved.\n   * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n   * console.log(result.maintained);\n   */\n  function ListDiffer(list, findKeyCallback) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    this.findKeyCallback = findKeyCallback;\n    this.list = [].slice.call(list);\n  }\n  /**\n   * Update list.\n   * @ko   .\n   * @param - List to update <ko>   </ko>\n   * @return - Returns the results of an update from `prevList` to `list`.<ko> `prevList` `list`   . </ko>\n   */\n\n\n  var __proto = ListDiffer.prototype;\n\n  __proto.update = function (list) {\n    var newData = [].slice.call(list);\n    var result = diff(this.list, newData, this.findKeyCallback);\n    this.list = newData;\n    return result;\n  };\n\n  return ListDiffer;\n}();\n\n/*\negjs-list-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ListDiffer;\nexport { diff };\n//# sourceMappingURL=list-differ.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/croact.git\nversion: 1.0.4\n*/\nimport { isNode, isArray, isUndefined, getValues, find, isString, removeEvent, addEvent, getDocument, getKeys, decamelize, flat as flat$1, isNumber, pushSet, isFunction, getEntries } from '@daybrush/utils';\nimport { diff } from '@egjs/list-differ';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction fillKeys(keys) {\n  var index = 0;\n  return keys.map(function (key) {\n    return key == null ? \"$compat\".concat(++index) : \"\".concat(key);\n  });\n}\nfunction flat(arr) {\n  var arr2 = [];\n  arr.forEach(function (el) {\n    arr2 = arr2.concat(isArray(el) ? flat(el) : el);\n  });\n  return arr2;\n}\nfunction fillProps(props, defaultProps) {\n  if (!defaultProps) {\n    return props;\n  }\n  for (var name_1 in defaultProps) {\n    if (isUndefined(props[name_1])) {\n      props[name_1] = defaultProps[name_1];\n    }\n  }\n  return props;\n}\nfunction isDiff(a, b) {\n  if (a === b) {\n    return false;\n  }\n  for (var i in a) {\n    if (!(i in b)) {\n      return true;\n    }\n  }\n  for (var i in b) {\n    if (a[i] !== b[i]) {\n      return true;\n    }\n  }\n  return false;\n}\nfunction getAttributes(props) {\n  var className = props.className,\n    otherProps = __rest(props, [\"className\"]);\n  if (className != null) {\n    otherProps.class = className;\n  }\n  delete otherProps.style;\n  delete otherProps.children;\n  return otherProps;\n}\nfunction splitProps(props) {\n  var attributes = {};\n  var events = {};\n  for (var name_2 in props) {\n    if (name_2.indexOf(\"on\") === 0) {\n      events[name_2] = props[name_2];\n    } else {\n      attributes[name_2] = props[name_2];\n    }\n  }\n  return [attributes, events];\n}\nfunction findContainerNode(provider) {\n  if (!provider) {\n    return null;\n  }\n  var base = provider.b;\n  if (isNode(base)) {\n    return base;\n  }\n  return findContainerNode(provider.c);\n}\nfunction removeNode(node) {\n  var parentNode = node.parentNode;\n  if (parentNode) {\n    parentNode.removeChild(node);\n  }\n}\nfunction executeHooks(hooks) {\n  hooks.forEach(function (hook) {\n    hook();\n  });\n}\nfunction renderFunctionComponent() {\n  return this.constructor(this.props, this.context);\n}\n\nvar hooksIndex = 0;\nvar Provider = /*#__PURE__*/function () {\n  function Provider(\n  /**\n   * Type\n   */\n  t,\n  /**\n   * Depth\n   */\n  d,\n  /**\n   * Key\n   */\n  k,\n  /**\n   * index\n   */\n  i,\n  /**\n   * Container\n   */\n  c,\n  /**\n   * Ref\n   */\n  ref,\n  /**\n   * Props\n   */\n  ps) {\n    if (ps === void 0) {\n      ps = {};\n    }\n    this.t = t;\n    this.d = d;\n    this.k = k;\n    this.i = i;\n    this.c = c;\n    this.ref = ref;\n    this.ps = ps;\n    this.typ = \"prov\";\n    /**\n     * providers\n     */\n    this._ps = [];\n    /**\n     * Contexts\n     */\n    this._cs = {};\n    /**\n     * Whether to hydrate\n     */\n    this._hyd = null;\n    /**\n     * is self render\n     */\n    this._sel = false;\n  }\n  var __proto = Provider.prototype;\n  __proto.s = function () {\n    return true;\n  };\n  /**\n   * Update\n   */\n  __proto.u = function (hooks, contexts, nextElement, nextState, isForceUpdate) {\n    var self = this;\n    var currentDepth = self.d;\n    var scheduledContexts = getValues(contexts).filter(function (context) {\n      return context.$_req;\n    });\n    var scheduledSubs = flat(scheduledContexts.map(function (context) {\n      return context.$_subs;\n    }));\n    var isContextUpdate = find(scheduledSubs, function (provider) {\n      return provider.d === currentDepth;\n    });\n    if (self.b && !isString(nextElement) && !isForceUpdate && !self.s(nextElement.props, nextState) && !isContextUpdate) {\n      var nextChildSubs = scheduledSubs.reduce(function (childs, sub) {\n        var depth = sub.d;\n        if (childs[0]) {\n          if (childs[0].d === depth) {\n            childs.push(sub);\n          }\n        } else if (depth > currentDepth) {\n          childs.push(sub);\n        }\n        return childs;\n      }, []);\n      nextChildSubs.forEach(function (child) {\n        // provider.container!,\n        // [provider],\n        // [provider.original],\n        // hooks,\n        // provider._cs,\n        // { ...self.state, ...self.$_state },\n        // isForceUpdate,\n        renderProviders(child, child._ps, [child.o], hooks, contexts, true);\n      });\n      return false;\n    }\n    self.o = nextElement;\n    self.ss(nextState);\n    // render\n    var prevProps = self.ps;\n    if (!isString(nextElement)) {\n      self.ps = nextElement.props;\n      self.ref = nextElement.ref;\n    }\n    setCurrentInstance(this);\n    self.r(hooks, contexts, self.b ? prevProps : {}, nextState);\n    return true;\n  };\n  __proto.md = function () {\n    this.rr();\n  };\n  __proto.ss = function () {\n    return;\n  };\n  __proto.ud = function () {\n    this.rr();\n  };\n  /**\n   * register refs\n   */\n  __proto.rr = function () {\n    var self = this;\n    var ref = self.ref;\n    var fr = self.fr;\n    ref && ref(fr ? fr.current : self.b);\n  };\n  return Provider;\n}();\nfunction getCurrentInstance() {\n  return Object.__CROACT_CURRENT_INSTNACE__;\n}\nfunction getHooksIndex() {\n  return hooksIndex;\n}\nfunction setHooksInex(nextHooksIndex) {\n  hooksIndex = nextHooksIndex;\n}\nfunction setCurrentInstance(provider) {\n  Object.__CROACT_CURRENT_INSTNACE__ = provider;\n  hooksIndex = 0;\n  return provider;\n}\n\nvar Component = /*#__PURE__*/function () {\n  function Component(props, context) {\n    if (props === void 0) {\n      props = {};\n    }\n    this.props = props;\n    this.context = context;\n    this.state = {};\n    this.$_timer = 0;\n    this.$_state = {};\n    this.$_subs = [];\n    this.$_cs = {};\n  }\n  var __proto = Component.prototype;\n  __proto.render = function () {\n    return null;\n  };\n  __proto.shouldComponentUpdate = function (props, state) {\n    return this.props !== props || this.state !== state;\n  };\n  __proto.setState = function (state, callback, isForceUpdate) {\n    var self = this;\n    if (!self.$_timer) {\n      self.$_state = {};\n    }\n    clearTimeout(self.$_timer);\n    self.$_timer = 0;\n    self.$_state = __assign(__assign({}, self.$_state), state);\n    if (!isForceUpdate) {\n      self.$_timer = window.setTimeout(function () {\n        self.$_timer = 0;\n        self.$_setState(callback, isForceUpdate);\n      });\n    } else {\n      self.$_setState(callback, isForceUpdate);\n    }\n    return;\n  };\n  __proto.forceUpdate = function (callback) {\n    this.setState({}, callback, true);\n  };\n  __proto.componentDidMount = function () {};\n  __proto.componentDidUpdate = function (prevProps, prevState) {};\n  __proto.componentWillUnmount = function () {};\n  __proto.$_setState = function (callback, isForceUpdate) {\n    var hooks = [];\n    var provider = this.$_p;\n    var isUpdate = renderProviders(provider.c, [provider], [provider.o], hooks, provider._cs, __assign(__assign({}, this.state), this.$_state), isForceUpdate);\n    if (isUpdate) {\n      if (callback) {\n        hooks.push(callback);\n      }\n      executeHooks(hooks);\n      setCurrentInstance(null);\n    }\n  };\n  return Component;\n}();\nvar PureComponent = /*#__PURE__*/function (_super) {\n  __extends(PureComponent, _super);\n  function PureComponent() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = PureComponent.prototype;\n  __proto.shouldComponentUpdate = function (props, state) {\n    return isDiff(this.props, props) || isDiff(this.state, state);\n  };\n  return PureComponent;\n}(Component);\n\nfunction createRef(defaultValue) {\n  var refCallback = function (e) {\n    refCallback.current = e;\n  };\n  refCallback.current = defaultValue;\n  return refCallback;\n}\nfunction forwardRef(func) {\n  func._fr = true;\n  return func;\n}\n\nfunction createComponent(type, props, contextValue, self) {\n  var _a;\n  var base;\n  if ((_a = type === null || type === void 0 ? void 0 : type.prototype) === null || _a === void 0 ? void 0 : _a.render) {\n    base = new type(props, contextValue);\n  } else {\n    base = new Component(props, contextValue);\n    base.constructor = type;\n    if (type._fr) {\n      self.fr = createRef();\n      base.render = function () {\n        return this.constructor(this.props, self.fr);\n      };\n    } else {\n      base.render = renderFunctionComponent;\n    }\n  }\n  base.$_p = self;\n  return base;\n}\nvar ComponentProvider = /*#__PURE__*/function (_super) {\n  __extends(ComponentProvider, _super);\n  function ComponentProvider(type, depth, key, index, container, ref, props) {\n    if (props === void 0) {\n      props = {};\n    }\n    var _this = _super.call(this, type, depth, key, index, container, ref, fillProps(props, type.defaultProps)) || this;\n    _this.typ = \"comp\";\n    /**\n     * Update shift effects\n     */\n    _this._usefs = [];\n    /**\n     * Update effects\n     */\n    _this._uefs = [];\n    /**\n     * Destroy effects\n     */\n    _this._defs = [];\n    return _this;\n  }\n  var __proto = ComponentProvider.prototype;\n  __proto.s = function (nextProps, nextState) {\n    var base = this.b;\n    return base.shouldComponentUpdate(fillProps(nextProps, this.t.defaultProps), nextState || base.state) !== false;\n  };\n  __proto.r = function (hooks, contexts, prevProps) {\n    var _a, _b;\n    var self = this;\n    var type = self.t;\n    self.ps = fillProps(self.ps, self.t.defaultProps);\n    var props = self.ps;\n    var isMount = !self.b;\n    var contextType = type.contextType;\n    var base = self.b;\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(self);\n    self._cs = contexts;\n    if (isMount) {\n      base = createComponent(type, props, contextValue, self);\n      self.b = base;\n    } else {\n      base.props = props;\n      base.context = contextValue;\n    }\n    var prevState = base.state;\n    self._usefs = [];\n    self._uefs = [];\n    var template = base.render();\n    if (((_b = (_a = template === null || template === void 0 ? void 0 : template.props) === null || _a === void 0 ? void 0 : _a.children) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n      template.props.children = self.ps.children;\n    }\n    var nextContexts = __assign(__assign({}, contexts), base.$_cs);\n    renderProviders(self, self._ps, template ? [template] : [], hooks, nextContexts);\n    if (isMount) {\n      self._uefs.push(function () {\n        contextType === null || contextType === void 0 ? void 0 : contextType.register(self);\n        base.componentDidMount();\n      });\n    } else {\n      self._uefs.push(function () {\n        base.componentDidUpdate(prevProps, prevState);\n      });\n    }\n    hooks.push(function () {\n      self._usefs.forEach(function (ef) {\n        ef();\n      });\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n      self._defs = self._uefs.map(function (ef) {\n        return ef();\n      });\n    });\n  };\n  __proto.ss = function (nextState) {\n    var base = this.b;\n    if (!base || !nextState) {\n      return;\n    }\n    base.state = nextState;\n  };\n  __proto.un = function () {\n    var _a;\n    var self = this;\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    var type = self.t;\n    (_a = type.contextType) === null || _a === void 0 ? void 0 : _a.unregister(self);\n    clearTimeout(self.b.$_timer);\n    self._defs.forEach(function (def) {\n      def && def();\n    });\n    self.b.componentWillUnmount();\n  };\n  return ComponentProvider;\n}(Provider);\n\nfunction diffAttributes(attrs1, attrs2, el) {\n  var _a = diffObject(getAttributes(attrs1), getAttributes(attrs2)),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var name_1 in added) {\n    el.setAttribute(name_1, added[name_1]);\n  }\n  for (var name_2 in changed) {\n    el.setAttribute(name_2, changed[name_2][1]);\n  }\n  for (var name_3 in removed) {\n    el.removeAttribute(name_3);\n  }\n}\nfunction diffEvents(events1, events2, provier) {\n  var _a = diffObject(events1, events2),\n    added = _a.added,\n    removed = _a.removed;\n  for (var name_4 in removed) {\n    provier.e(name_4, true);\n  }\n  for (var name_5 in added) {\n    provier.e(name_5);\n  }\n}\nfunction diffObject(a, b) {\n  var keys1 = getKeys(a);\n  var keys2 = getKeys(b);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  var added = {};\n  var removed = {};\n  var changed = {};\n  result.added.forEach(function (index) {\n    var name = keys2[index];\n    added[name] = b[name];\n  });\n  result.removed.forEach(function (index) {\n    var name = keys1[index];\n    removed[name] = a[name];\n  });\n  result.maintained.forEach(function (_a) {\n    var index = _a[0];\n    var name = keys1[index];\n    var values = [a[name], b[name]];\n    if (a[name] !== b[name]) {\n      changed[name] = values;\n    }\n  });\n  return {\n    added: added,\n    removed: removed,\n    changed: changed\n  };\n}\nfunction diffStyle(style1, style2, el) {\n  var style = el.style;\n  var _a = diffObject(style1, style2),\n    added = _a.added,\n    removed = _a.removed,\n    changed = _a.changed;\n  for (var beforeName in added) {\n    var name_6 = decamelize(beforeName, \"-\");\n    style.setProperty(name_6, added[beforeName]);\n  }\n  for (var beforeName in changed) {\n    var name_7 = decamelize(beforeName, \"-\");\n    style.setProperty(name_7, changed[beforeName][1]);\n  }\n  for (var beforeName in removed) {\n    var name_8 = decamelize(beforeName, \"-\");\n    style.removeProperty(name_8);\n  }\n}\nfunction getNativeEventName(name) {\n  return name.replace(/^on/g, \"\").toLowerCase();\n}\nvar ElementProvider = /*#__PURE__*/function (_super) {\n  __extends(ElementProvider, _super);\n  function ElementProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"elem\";\n    /**\n     * Events\n     */\n    _this._es = {};\n    /**\n     * is svg\n     */\n    _this._svg = false;\n    return _this;\n  }\n  var __proto = ElementProvider.prototype;\n  __proto.e = function (name, isRemove) {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    var eventName = getNativeEventName(name);\n    if (isRemove) {\n      removeEvent(base, eventName, events[name]);\n      delete events[name];\n    } else {\n      events[name] = function (e) {\n        var _a, _b;\n        (_b = (_a = self.ps)[name]) === null || _b === void 0 ? void 0 : _b.call(_a, e);\n      };\n      addEvent(base, eventName, events[name]);\n    }\n  };\n  __proto.s = function (nextProps) {\n    return isDiff(this.ps, nextProps);\n  };\n  __proto.r = function (hooks, contextValues, prevProps) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    var nextProps = self.ps;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var isSVG = false;\n      if (self._svg || self.t === \"svg\") {\n        isSVG = true;\n      } else {\n        isSVG = containerNode && containerNode.ownerSVGElement;\n      }\n      self._svg = isSVG;\n      var element = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      var type = self.t;\n      if (element) {\n        self._hyd = [].slice.call(element.children || []);\n      } else {\n        var doc = getDocument(containerNode);\n        if (isSVG) {\n          element = doc.createElementNS(\"http://www.w3.org/2000/svg\", type);\n        } else {\n          element = doc.createElement(type);\n        }\n      }\n      self.b = element;\n    }\n    renderProviders(self, self._ps, nextProps.children, hooks, contextValues);\n    var base = self.b;\n    var _b = splitProps(prevProps),\n      prevAttributes = _b[0],\n      prevEvents = _b[1];\n    var _c = splitProps(nextProps),\n      nextAttributes = _c[0],\n      nextEvents = _c[1];\n    diffAttributes(prevAttributes, nextAttributes, base);\n    diffEvents(prevEvents, nextEvents, self);\n    diffStyle(prevProps.style || {}, nextProps.style || {}, base);\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    var self = this;\n    var events = self._es;\n    var base = self.b;\n    for (var name_9 in events) {\n      removeEvent(base, name_9, events[name_9]);\n    }\n    self._ps.forEach(function (provider) {\n      provider.un();\n    });\n    self._es = {};\n    if (!self._sel) {\n      removeNode(base);\n    }\n  };\n  return ElementProvider;\n}(Provider);\n\nfunction findDOMNode(comp) {\n  if (!comp || isNode(comp)) {\n    return comp;\n  }\n  var providers = comp.$_p._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findDOMNode(providers[0].b);\n}\nfunction findNodeProvider(provider) {\n  if (!provider) {\n    return;\n  }\n  if (provider.b && isNode(provider.b)) {\n    return provider;\n  }\n  var providers = provider._ps;\n  if (!providers.length) {\n    return null;\n  }\n  return findNodeProvider(providers[0]);\n}\nfunction createElement(type, props) {\n  var children = [];\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n  var _a = props || {},\n    key = _a.key,\n    ref = _a.ref,\n    otherProps = __rest(_a, [\"key\", \"ref\"]);\n  return {\n    type: type,\n    key: key,\n    ref: ref,\n    props: __assign(__assign({}, otherProps), {\n      children: flat$1(children).filter(function (child) {\n        return child != null && child !== false;\n      })\n    })\n  };\n}\n\nvar ContainerProvider = /*#__PURE__*/function (_super) {\n  __extends(ContainerProvider, _super);\n  function ContainerProvider(base, depth) {\n    if (depth === void 0) {\n      depth = 0;\n    }\n    var _this = _super.call(this, \"container\", depth, \"container\", 0, null) || this;\n    _this.typ = \"container\";\n    _this.b = base;\n    return _this;\n  }\n  var __proto = ContainerProvider.prototype;\n  __proto.r = function () {\n    return true;\n  };\n  __proto.un = function () {\n    return;\n  };\n  return ContainerProvider;\n}(Provider);\nvar TextProvider = /*#__PURE__*/function (_super) {\n  __extends(TextProvider, _super);\n  function TextProvider() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.typ = \"text\";\n    return _this;\n  }\n  var __proto = TextProvider.prototype;\n  __proto.r = function (hooks) {\n    var _a;\n    var self = this;\n    var isMount = !self.b;\n    if (isMount) {\n      var containerNode = findContainerNode(self.c);\n      var b = (_a = self._hyd) === null || _a === void 0 ? void 0 : _a.splice(0, 1)[0];\n      self.b = b || getDocument(containerNode).createTextNode(self.t.replace(\"text_\", \"\"));\n    }\n    hooks.push(function () {\n      if (isMount) {\n        self.md();\n      } else {\n        self.ud();\n      }\n    });\n    return true;\n  };\n  __proto.un = function () {\n    removeNode(this.b);\n  };\n  return TextProvider;\n}(Provider);\nfunction diffProviders(containerProvider, providers, children) {\n  var childrenKeys = children.map(function (p) {\n    return isString(p) ? null : p.key;\n  });\n  var keys1 = fillKeys(providers.map(function (p) {\n    return p.k;\n  }));\n  var keys2 = fillKeys(childrenKeys);\n  var result = diff(keys1, keys2, function (key) {\n    return key;\n  });\n  result.removed.forEach(function (index) {\n    providers.splice(index, 1)[0].un();\n  });\n  result.ordered.forEach(function (_a) {\n    var from = _a[0],\n      to = _a[1];\n    var childrenProvider = providers.splice(from, 1)[0];\n    providers.splice(to, 0, childrenProvider);\n    var el = findDOMNode(childrenProvider.b);\n    var next = findDOMNode(providers[to + 1] && providers[to + 1].b);\n    if (el) {\n      el.parentNode.insertBefore(el, next);\n    }\n  });\n  result.added.forEach(function (index) {\n    providers.splice(index, 0, createProvider(children[index], childrenKeys[index], index, containerProvider));\n  });\n  var changed = result.maintained.filter(function (_a) {\n    _a[0];\n      var to = _a[1];\n    var el = children[to];\n    var childProvider = providers[to];\n    var type = isString(el) ? \"text_\".concat(el) : el.type;\n    if (type !== childProvider.t) {\n      childProvider.un();\n      providers.splice(to, 1, createProvider(el, childrenKeys[to], to, containerProvider));\n      return true;\n    }\n    childProvider.i = to;\n    return false;\n  });\n  return __spreadArray(__spreadArray([], result.added, true), changed.map(function (_a) {\n    _a[0];\n      var to = _a[1];\n    return to;\n  }), true);\n}\n\nfunction getNextSibiling(provider, childProvider) {\n  var childProviders = provider._ps;\n  var length = childProviders.length;\n  for (var i = childProvider.i + 1; i < length; ++i) {\n    var el = findDOMNode(childProviders[i].b);\n    if (el) {\n      return el;\n    }\n  }\n  return null;\n}\nfunction createProvider(el, key, index, containerProvider) {\n  var depth = containerProvider.d + 1;\n  if (isString(el) || isNumber(el)) {\n    return new TextProvider(\"text_\".concat(el), depth, key, index, containerProvider, null, {});\n  }\n  var type = el.type;\n  var providerClass = typeof type === \"string\" ? ElementProvider : ComponentProvider;\n  return new providerClass(type, depth, key, index, containerProvider, el.ref, el.props);\n}\nfunction renderProviders(containerProvider, providers, children, updatedHooks, nextContexts, nextState, isForceUpdate) {\n  var result = diffProviders(containerProvider, providers, children);\n  var hyd = containerProvider._hyd;\n  var updated = providers.filter(function (childProvider, i) {\n    childProvider._hyd = hyd;\n    return childProvider.u(updatedHooks, nextContexts, children[i], nextState, isForceUpdate);\n  });\n  if (containerProvider.typ === \"container\" && containerProvider._sel) {\n    providers.forEach(function (provider) {\n      var nodeProvider = findNodeProvider(provider);\n      if (nodeProvider) {\n        nodeProvider._sel = true;\n      }\n    });\n  }\n  containerProvider._hyd = null;\n  var containerNode = findContainerNode(containerProvider);\n  if (containerNode) {\n    result.reverse().forEach(function (index) {\n      var childProvider = providers[index];\n      var el = findDOMNode(childProvider.b);\n      if (!el) {\n        return;\n      }\n      if (containerNode !== el && !el.parentNode) {\n        var nextElement = getNextSibiling(containerProvider, childProvider);\n        containerNode.insertBefore(el, nextElement);\n      }\n    });\n  }\n  return updated.length > 0;\n}\nfunction renderProvider(element, container, provider, contexts) {\n  if (provider === void 0) {\n    provider = container.__CROACT__;\n  }\n  if (contexts === void 0) {\n    contexts = {};\n  }\n  var isProvider = !!provider;\n  if (!provider) {\n    provider = new ContainerProvider(container);\n  }\n  var hooks = [];\n  renderProviders(provider, provider._ps, element ? [element] : [], hooks, contexts, undefined, undefined);\n  executeHooks(hooks);\n  setCurrentInstance(null);\n  if (!isProvider) {\n    container.__CROACT__ = provider;\n  }\n  return provider;\n}\nfunction render(element, container, callback) {\n  var provider = container.__CROACT__;\n  if (element && !provider) {\n    container.innerHTML = \"\";\n  }\n  renderProvider(element, container, provider);\n  callback && callback();\n}\nfunction renderSelf(element, self, containerProvider) {\n  if (!containerProvider && element) {\n    containerProvider = new ContainerProvider(self.parentElement);\n    containerProvider._hyd = [self];\n    containerProvider._sel = true;\n  }\n  renderProvider(element, self, containerProvider);\n  return containerProvider;\n}\n\nvar i  = 0;\nfunction createContext(defaultValue) {\n  var id = \"c\".concat(++i);\n  function Provider(props) {\n    var self = this;\n    if (!self.$_cs[id]) {\n      self.$_cs[id] = self;\n      var $_subs = [];\n      self.shouldComponentUpdate = function (nextProps) {\n        if (nextProps.value !== self.props.value) {\n          // request\n          self.$_req = true;\n        }\n      };\n      self.render = function () {\n        return self.props.children[0];\n      };\n      self.$_subs = $_subs;\n    }\n    return props.children[0];\n  }\n  function Consumer(props, contextValue) {\n    return props.children(contextValue);\n  }\n  function getContext(provider) {\n    return provider._cs[id];\n  }\n  var context = {\n    $_id: id,\n    $_dv: defaultValue,\n    Consumer: Consumer,\n    Provider: Provider,\n    get: function (provider) {\n      var _a, _b;\n      return (_b = (_a = getContext(provider)) === null || _a === void 0 ? void 0 : _a.props.value) !== null && _b !== void 0 ? _b : defaultValue;\n    },\n    register: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        pushSet(mainComponent.$_subs, provider);\n      }\n    },\n    unregister: function (provider) {\n      var mainComponent = getContext(provider);\n      if (mainComponent) {\n        var subs = mainComponent.$_subs;\n        var index = subs.indexOf(provider);\n        if (index > -1) {\n          subs.splice(index, 1);\n        }\n      }\n    }\n  };\n  Consumer.contextType = context;\n  return context;\n}\n\nvar Portal = /*#__PURE__*/function (_super) {\n  __extends(Portal, _super);\n  function Portal() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n  var __proto = Portal.prototype;\n  __proto.componentDidMount = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    var parentProvider = self.$_p;\n    self._pp = new ContainerProvider(container, parentProvider.d + 1);\n    renderProvider(element, container, self._pp, parentProvider._cs);\n  };\n  __proto.componentDidUpdate = function () {\n    var self = this;\n    var _a = self.props,\n      element = _a.element,\n      container = _a.container;\n    renderProvider(element, container, self._pp, self.$_p._cs);\n  };\n  __proto.componentWillUnmount = function () {\n    var self = this;\n    var container = self.props.container;\n    renderProvider(null, container, self._pp, self.$_p._cs);\n    this._pp = null;\n  };\n  return Portal;\n}(PureComponent);\nfunction createPortal(el, container) {\n  return createElement(Portal, {\n    element: el,\n    container: container\n  });\n}\n\nfunction _renderToString(node, parentContexts, self) {\n  if (node == null) {\n    return \"\";\n  }\n  if (isString(node) || isNumber(node) || isFunction(node)) {\n    return node;\n  }\n  var type = node.type,\n    props = node.props;\n  if (isString(type)) {\n    var stringProps_1 = {};\n    getEntries(props).forEach(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      if (name === \"style\") {\n        stringProps_1[name] = getEntries(value).map(function (_a) {\n          var styleName = _a[0],\n            styleValue = _a[1];\n          return \"\".concat(decamelize(styleName), \": \").concat(styleValue, \";\");\n        }).join(\"\");\n      } else if (name === \"children\") {\n        return;\n      } else if (!name.match(/^on[^a-z]/g)) {\n        stringProps_1[name] = \"\".concat(value);\n      }\n    });\n    var children = props.children.map(function (child) {\n      return _renderToString(child, parentContexts);\n    }).join(\"\");\n    if (self) {\n      return {\n        tagName: type,\n        props: stringProps_1,\n        children: children\n      };\n    }\n    var strings = __spreadArray([type], getEntries(stringProps_1).map(function (_a) {\n      var name = _a[0],\n        value = _a[1];\n      return \"\".concat(name, \"=\\\"\").concat(value.replace(/\"/g, \"\\\\\\\"\"), \"\\\"\");\n    }), true);\n    return \"<\".concat(strings.join(\" \"), \">\").concat(children, \"</\").concat(type, \">\");\n  } else if (isFunction(type)) {\n    var contextType = type.contextType;\n    var provider = {\n      b: null,\n      _hs: [],\n      _usefs: [],\n      _uefs: [],\n      _defs: [],\n      _cs: parentContexts\n    };\n    setCurrentInstance(provider);\n    var contextValue = contextType === null || contextType === void 0 ? void 0 : contextType.get(provider);\n    var base = createComponent(type, props, contextValue, {});\n    var nextContexts = __assign(__assign({}, parentContexts), base.$_cs);\n    provider.b = base;\n    return _renderToString(base.render(), nextContexts, self);\n  }\n  return \"\";\n}\nfunction renderToString(node) {\n  return _renderToString(node, {});\n}\nfunction renderSelfToString(node) {\n  return _renderToString(node, {}, true);\n}\n\nfunction checkHookInfo(info) {\n  var inst = getCurrentInstance();\n  var hooks = inst._hs || (inst._hs = []);\n  var index = getHooksIndex();\n  var prevHt = hooks[index];\n  setHooksInex(index + 1);\n  if (prevHt) {\n    if (!isDiff(prevHt.deps, info.deps)) {\n      prevHt.updated = false;\n      return prevHt;\n    }\n    hooks[index] = info;\n  } else {\n    hooks.push(info);\n  }\n  info.value = info.func();\n  info.updated = true;\n  return info;\n}\nfunction useMemo(defaultFunction, deps) {\n  var info = checkHookInfo({\n    func: defaultFunction,\n    deps: deps\n  });\n  return info.value;\n}\nfunction useRef(defaultValue) {\n  return useMemo(function () {\n    return createRef(defaultValue);\n  }, []);\n}\nfunction useContext(context) {\n  var inst = getCurrentInstance();\n  var contextId = context.$_id;\n  var contexts = inst._cs;\n  var providerComponent;\n  if (contextId in contexts) {\n    providerComponent = contexts[contextId];\n    providerComponent.props.value;\n  } else {\n    context.$_dv;\n  }\n  useEffect(function () {\n    context.register(inst);\n    return function () {\n      context.unregister(inst);\n    };\n  }, []);\n  return context.get(inst);\n}\nfunction useState(st) {\n  var inst = getCurrentInstance();\n  var index = getHooksIndex();\n  var comp = inst.b;\n  checkHookInfo({\n    func: function () {\n      comp.state[index] = isFunction(st) ? st() : st;\n    },\n    deps: []\n  });\n  return [comp.state[index], function (nextValue) {\n    var _a;\n    return comp.setState((_a = {}, _a[index] = nextValue, _a));\n  }];\n}\nfunction useEffect(effect, deps, unshift) {\n  var inst = getCurrentInstance();\n  var info = checkHookInfo({\n    func: function () {\n      return effect;\n    },\n    deps: deps\n  });\n  var effects = unshift ? inst._usefs : inst._uefs;\n  if (info.updated) {\n    effects.push(function () {\n      info.effect && info.effect();\n      info.effect = effect();\n      return info.effect;\n    });\n  } else {\n    effects.push(function () {\n      return info.effect;\n    });\n  }\n}\nfunction useImperativeHandle(ref, func, deps) {\n  useEffect(function () {\n    ref === null || ref === void 0 ? void 0 : ref(func());\n  }, deps, true);\n}\n\nvar version = \"simple-1.0.0\";\n\nexport { Component, ContainerProvider, PureComponent, createContext, createElement, createPortal, createRef, findDOMNode, findNodeProvider, forwardRef, render, renderSelf, renderSelfToString, renderToString, useContext, useEffect, useImperativeHandle, useMemo, useRef, useState, version };\n//# sourceMappingURL=croact.esm.js.map\n","/*\nCopyright (c) 2015 NAVER Corp.\nname: @egjs/agent\nlicense: MIT\nauthor: NAVER Corp.\nrepository: git+https://github.com/naver/agent.git\nversion: 2.3.0\n*/\nfunction some(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return true;\n    }\n  }\n\n  return false;\n}\nfunction find(arr, callback) {\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return arr[i];\n    }\n  }\n\n  return null;\n}\nfunction getUserAgent(agent) {\n  var userAgent = agent;\n\n  if (typeof userAgent === \"undefined\") {\n    if (typeof navigator === \"undefined\" || !navigator) {\n      return \"\";\n    }\n\n    userAgent = navigator.userAgent || \"\";\n  }\n\n  return userAgent.toLowerCase();\n}\nfunction execRegExp(pattern, text) {\n  try {\n    return new RegExp(pattern, \"g\").exec(text);\n  } catch (e) {\n    return null;\n  }\n}\nfunction hasUserAgentData() {\n  if (typeof navigator === \"undefined\" || !navigator || !navigator.userAgentData) {\n    return false;\n  }\n\n  var userAgentData = navigator.userAgentData;\n  var brands = userAgentData.brands || userAgentData.uaList;\n  return !!(brands && brands.length);\n}\nfunction findVersion(versionTest, userAgent) {\n  var result = execRegExp(\"(\" + versionTest + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))\", userAgent);\n  return result ? result[3] : \"\";\n}\nfunction convertVersion(text) {\n  return text.replace(/_/g, \".\");\n}\nfunction findPreset(presets, userAgent) {\n  var userPreset = null;\n  var version = \"-1\";\n  some(presets, function (preset) {\n    var result = execRegExp(\"(\" + preset.test + \")((?:\\\\/|\\\\s|:)([0-9|\\\\.|_]+))?\", userAgent);\n\n    if (!result || preset.brand) {\n      return false;\n    }\n\n    userPreset = preset;\n    version = result[3] || \"-1\";\n\n    if (preset.versionAlias) {\n      version = preset.versionAlias;\n    } else if (preset.versionTest) {\n      version = findVersion(preset.versionTest.toLowerCase(), userAgent) || version;\n    }\n\n    version = convertVersion(version);\n    return true;\n  });\n  return {\n    preset: userPreset,\n    version: version\n  };\n}\nfunction findPresetBrand(presets, brands) {\n  var brandInfo = {\n    brand: \"\",\n    version: \"-1\"\n  };\n  some(presets, function (preset) {\n    var result = findBrand(brands, preset);\n\n    if (!result) {\n      return false;\n    }\n\n    brandInfo.brand = preset.id;\n    brandInfo.version = preset.versionAlias || result.version;\n    return brandInfo.version !== \"-1\";\n  });\n  return brandInfo;\n}\nfunction findBrand(brands, preset) {\n  return find(brands, function (_a) {\n    var brand = _a.brand;\n    return execRegExp(\"\" + preset.test, brand.toLowerCase());\n  });\n}\n\nvar BROWSER_PRESETS = [{\n  test: \"phantomjs\",\n  id: \"phantomjs\"\n}, {\n  test: \"whale\",\n  id: \"whale\"\n}, {\n  test: \"edgios|edge|edg\",\n  id: \"edge\"\n}, {\n  test: \"msie|trident|windows phone\",\n  id: \"ie\",\n  versionTest: \"iemobile|msie|rv\"\n}, {\n  test: \"miuibrowser\",\n  id: \"miui browser\"\n}, {\n  test: \"samsungbrowser\",\n  id: \"samsung internet\"\n}, {\n  test: \"samsung\",\n  id: \"samsung internet\",\n  versionTest: \"version\"\n}, {\n  test: \"chrome|crios\",\n  id: \"chrome\"\n}, {\n  test: \"firefox|fxios\",\n  id: \"firefox\"\n}, {\n  test: \"android\",\n  id: \"android browser\",\n  versionTest: \"version\"\n}, {\n  test: \"safari|iphone|ipad|ipod\",\n  id: \"safari\",\n  versionTest: \"version\"\n}]; // chromium's engine(blink) is based on applewebkit 537.36.\n\nvar CHROMIUM_PRESETS = [{\n  test: \"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\\\schrome)\",\n  id: \"chrome\",\n  versionTest: \"chrome\"\n}, {\n  test: \"chromium\",\n  id: \"chrome\"\n}, {\n  test: \"whale\",\n  id: \"chrome\",\n  versionAlias: \"-1\",\n  brand: true\n}];\nvar WEBKIT_PRESETS = [{\n  test: \"applewebkit\",\n  id: \"webkit\",\n  versionTest: \"applewebkit|safari\"\n}];\nvar WEBVIEW_PRESETS = [{\n  test: \"(?=(iphone|ipad))(?!(.*version))\",\n  id: \"webview\"\n}, {\n  test: \"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))\",\n  id: \"webview\"\n}, {\n  // test webview\n  test: \"webview\",\n  id: \"webview\"\n}];\nvar OS_PRESETS = [{\n  test: \"windows phone\",\n  id: \"windows phone\"\n}, {\n  test: \"windows 2000\",\n  id: \"window\",\n  versionAlias: \"5.0\"\n}, {\n  test: \"windows nt\",\n  id: \"window\"\n}, {\n  test: \"iphone|ipad|ipod\",\n  id: \"ios\",\n  versionTest: \"iphone os|cpu os\"\n}, {\n  test: \"mac os x\",\n  id: \"mac\"\n}, {\n  test: \"android\",\n  id: \"android\"\n}, {\n  test: \"tizen\",\n  id: \"tizen\"\n}, {\n  test: \"webos|web0s\",\n  id: \"webos\"\n}];\n\nfunction parseUserAgentData(osData) {\n  var userAgentData = navigator.userAgentData;\n  var brands = (userAgentData.uaList || userAgentData.brands).slice();\n  var isMobile = userAgentData.mobile || false;\n  var firstBrand = brands[0];\n  var browser = {\n    name: firstBrand.brand,\n    version: firstBrand.version,\n    majorVersion: -1,\n    webkit: false,\n    webkitVersion: \"-1\",\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webview: !!findPresetBrand(WEBVIEW_PRESETS, brands).brand\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n  browser.webkit = !browser.chromium && some(WEBKIT_PRESETS, function (preset) {\n    return findBrand(brands, preset);\n  });\n  var chromiumBrand = findPresetBrand(CHROMIUM_PRESETS, brands);\n  browser.chromium = !!chromiumBrand.brand;\n  browser.chromiumVersion = chromiumBrand.version;\n\n  if (!browser.chromium) {\n    var webkitBrand = findPresetBrand(WEBKIT_PRESETS, brands);\n    browser.webkit = !!webkitBrand.brand;\n    browser.webkitVersion = webkitBrand.version;\n  }\n\n  if (osData) {\n    var platform_1 = osData.platform.toLowerCase();\n    var result = find(OS_PRESETS, function (preset) {\n      return new RegExp(\"\" + preset.test, \"g\").exec(platform_1);\n    });\n    os.name = result ? result.id : platform_1;\n    os.version = osData.platformVersion;\n  }\n\n  var browserBrand = findPresetBrand(BROWSER_PRESETS, brands);\n\n  if (browserBrand.brand) {\n    browser.name = browserBrand.brand;\n    browser.version = osData ? osData.uaFullVersion : browserBrand.version;\n  }\n\n  if (navigator.platform === \"Linux armv8l\") {\n    os.name = \"android\";\n  } else if (browser.webkit) {\n    os.name = isMobile ? \"ios\" : \"mac\";\n  }\n\n  if (os.name === \"ios\" && browser.webview) {\n    browser.version = \"-1\";\n  }\n\n  os.version = convertVersion(os.version);\n  browser.version = convertVersion(browser.version);\n  os.majorVersion = parseInt(os.version, 10);\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: true\n  };\n}\n\nfunction parseUserAgent(userAgent) {\n  var nextAgent = getUserAgent(userAgent);\n  var isMobile = !!/mobi/g.exec(nextAgent);\n  var browser = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1,\n    webview: !!findPreset(WEBVIEW_PRESETS, nextAgent).preset,\n    chromium: false,\n    chromiumVersion: \"-1\",\n    webkit: false,\n    webkitVersion: \"-1\"\n  };\n  var os = {\n    name: \"unknown\",\n    version: \"-1\",\n    majorVersion: -1\n  };\n\n  var _a = findPreset(BROWSER_PRESETS, nextAgent),\n      browserPreset = _a.preset,\n      browserVersion = _a.version;\n\n  var _b = findPreset(OS_PRESETS, nextAgent),\n      osPreset = _b.preset,\n      osVersion = _b.version;\n\n  var chromiumPreset = findPreset(CHROMIUM_PRESETS, nextAgent);\n  browser.chromium = !!chromiumPreset.preset;\n  browser.chromiumVersion = chromiumPreset.version;\n\n  if (!browser.chromium) {\n    var webkitPreset = findPreset(WEBKIT_PRESETS, nextAgent);\n    browser.webkit = !!webkitPreset.preset;\n    browser.webkitVersion = webkitPreset.version;\n  }\n\n  if (osPreset) {\n    os.name = osPreset.id;\n    os.version = osVersion;\n    os.majorVersion = parseInt(osVersion, 10);\n  }\n\n  if (browserPreset) {\n    browser.name = browserPreset.id;\n    browser.version = browserVersion;\n\n    if (browser.webview && os.name === \"ios\" && browser.name !== \"safari\") {\n      browser.webview = false;\n    }\n  }\n\n  browser.majorVersion = parseInt(browser.version, 10);\n  return {\n    browser: browser,\n    os: os,\n    isMobile: isMobile,\n    isHints: false\n  };\n}\n\n/**\n * @namespace eg.agent\n */\n\n/**\n* Extracts accuate browser and operating system information from the user agent string or client hints.\n* @ko     client hints     .\n* @function eg.agent#getAccurateAgent\n* @param - Callback function to get the accuate agent <ko>    callback </ko>\n* @return - get the accuate agent promise. If Promise are not supported, null is returned. <ko>   promise . Promise    , null . </ko>\n* @example\nimport { getAccurateAgent } from \"@egjs/agent\";\n// eg.agent.getAccurateAgent()\ngetAccurateAgent().then(agent => {\n   const { os, browser, isMobile } = agent;\n});\ngetAccurateAgent(agent => {\n    const { os, browser, isMobile } = agent;\n});\n*/\n\nfunction getAccurateAgent(callback) {\n  if (hasUserAgentData()) {\n    return navigator.userAgentData.getHighEntropyValues([\"architecture\", \"model\", \"platform\", \"platformVersion\", \"uaFullVersion\"]).then(function (info) {\n      var agentInfo = parseUserAgentData(info);\n      callback && callback(agentInfo);\n      return agentInfo;\n    });\n  }\n\n  callback && callback(agent());\n\n  if (typeof Promise === \"undefined\" || !Promise) {\n    return null;\n  }\n\n  return Promise.resolve(agent());\n}\n/**\n * Extracts browser and operating system information from the user agent string.\n * @ko       .\n * @function eg.agent#agent\n * @param - user agent string to parse <ko>  </ko>\n * @return - agent Info <ko>   </ko>\n * @example\nimport agent from \"@egjs/agent\";\n// eg.agent();\nconst { os, browser, isMobile } = agent();\n */\n\nfunction agent(userAgent) {\n  if (typeof userAgent === \"undefined\" && hasUserAgentData()) {\n    return parseUserAgentData();\n  } else {\n    return parseUserAgent(userAgent);\n  }\n}\n\nexport default agent;\nexport { getAccurateAgent };\n//# sourceMappingURL=agent.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: @scena/matrix\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/matrix\nversion: 1.1.1\n*/\nimport { throttle, TINY_NUM, average } from '@daybrush/utils';\n\nfunction add(matrix, inverseMatrix, startIndex, fromIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    matrix[x] += matrix[fromX] * k;\n    inverseMatrix[x] += inverseMatrix[fromX] * k;\n  }\n}\n\nfunction swap(matrix, inverseMatrix, startIndex, fromIndex, n) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    var fromX = fromIndex + i * n;\n    var v = matrix[x];\n    var iv = inverseMatrix[x];\n    matrix[x] = matrix[fromX];\n    matrix[fromX] = v;\n    inverseMatrix[x] = inverseMatrix[fromX];\n    inverseMatrix[fromX] = iv;\n  }\n}\n\nfunction divide(matrix, inverseMatrix, startIndex, n, k) {\n  for (var i = 0; i < n; ++i) {\n    var x = startIndex + i * n;\n    matrix[x] /= k;\n    inverseMatrix[x] /= k;\n  }\n}\n/**\n *\n * @namespace Matrix\n */\n\n/**\n * @memberof Matrix\n */\n\n\nfunction ignoreDimension(matrix, m, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n\n  for (var i = 0; i < n; ++i) {\n    newMatrix[i * n + m - 1] = 0;\n    newMatrix[(m - 1) * n + i] = 0;\n  }\n\n  newMatrix[(m - 1) * (n + 1)] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction invert(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = matrix.slice();\n  var inverseMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n; ++i) {\n    // diagonal\n    var identityIndex = n * i + i;\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // newMatrix[identityIndex] = 0;\n      for (var j = i + 1; j < n; ++j) {\n        if (newMatrix[n * i + j]) {\n          swap(newMatrix, inverseMatrix, i, j, n);\n          break;\n        }\n      }\n    }\n\n    if (!throttle(newMatrix[identityIndex], TINY_NUM)) {\n      // no inverse matrix\n      return [];\n    }\n\n    divide(newMatrix, inverseMatrix, i, n, newMatrix[identityIndex]);\n\n    for (var j = 0; j < n; ++j) {\n      var targetStartIndex = j;\n      var targetIndex = j + i * n;\n      var target = newMatrix[targetIndex];\n\n      if (!throttle(target, TINY_NUM) || i === j) {\n        continue;\n      }\n\n      add(newMatrix, inverseMatrix, targetStartIndex, i, n, -target);\n    }\n  }\n\n  return inverseMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction transpose(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = [];\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < n; ++j) {\n      newMatrix[j * n + i] = matrix[n * i + j];\n    }\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction getOrigin(matrix, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var originMatrix = [];\n  var w = matrix[n * n - 1];\n\n  for (var i = 0; i < n - 1; ++i) {\n    originMatrix[i] = matrix[n * (n - 1) + i] / w;\n  }\n\n  originMatrix[n - 1] = 0;\n  return originMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction fromTranslation(pos, n) {\n  var newMatrix = createIdentityMatrix(n);\n\n  for (var i = 0; i < n - 1; ++i) {\n    newMatrix[n * (n - 1) + i] = pos[i] || 0;\n  }\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertPositionMatrix(matrix, n) {\n  var newMatrix = matrix.slice();\n\n  for (var i = matrix.length; i < n - 1; ++i) {\n    newMatrix[i] = 0;\n  }\n\n  newMatrix[n - 1] = 1;\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertDimension(matrix, n, m) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  } // n < m\n\n\n  if (n === m) {\n    return matrix;\n  }\n\n  var newMatrix = createIdentityMatrix(m);\n  var length = Math.min(n, m);\n\n  for (var i = 0; i < length - 1; ++i) {\n    for (var j = 0; j < length - 1; ++j) {\n      newMatrix[i * m + j] = matrix[i * n + j];\n    }\n\n    newMatrix[(i + 1) * m - 1] = matrix[(i + 1) * n - 1];\n    newMatrix[(m - 1) * m + i] = matrix[(n - 1) * n + i];\n  }\n\n  newMatrix[m * m - 1] = matrix[n * n - 1];\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiplies(n) {\n  var matrixes = [];\n\n  for (var _i = 1; _i < arguments.length; _i++) {\n    matrixes[_i - 1] = arguments[_i];\n  }\n\n  var m = createIdentityMatrix(n);\n  matrixes.forEach(function (matrix) {\n    m = multiply(m, matrix, n);\n  });\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction multiply(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = Math.sqrt(matrix.length);\n  }\n\n  var newMatrix = []; // 1 y: n\n  // 1 x: m\n  // 2 x: m\n  // 2 y: k\n  // n * m X m * k\n\n  var m = matrix.length / n;\n  var k = matrix2.length / m;\n\n  if (!m) {\n    return matrix2;\n  } else if (!k) {\n    return matrix;\n  }\n\n  for (var i = 0; i < n; ++i) {\n    for (var j = 0; j < k; ++j) {\n      newMatrix[j * n + i] = 0;\n\n      for (var l = 0; l < m; ++l) {\n        // m1 x: m(l), y: n(i)\n        // m2 x: k(j):  y: m(l)\n        // nw x: n(i), y: k(j)\n        newMatrix[j * n + i] += matrix[l * n + i] * matrix2[j * m + l];\n      }\n    }\n  } // n * k\n\n\n  return newMatrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction plus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] + pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction minus(pos1, pos2) {\n  var length = Math.min(pos1.length, pos2.length);\n  var nextPos = pos1.slice();\n\n  for (var i = 0; i < length; ++i) {\n    nextPos[i] = nextPos[i] - pos2[i];\n  }\n\n  return nextPos;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertCSStoMatrix(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 6;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], 0, a[2], a[3], 0, a[4], a[5], 1];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction convertMatrixtoCSS(a, is2d) {\n  if (is2d === void 0) {\n    is2d = a.length === 9;\n  }\n\n  if (is2d) {\n    return [a[0], a[1], a[3], a[4], a[6], a[7]];\n  }\n\n  return a;\n}\n/**\n * @memberof Matrix\n */\n\nfunction calculate(matrix, matrix2, n) {\n  if (n === void 0) {\n    n = matrix2.length;\n  }\n\n  var result = multiply(matrix, matrix2, n);\n  var k = result[n - 1];\n  return result.map(function (v) {\n    return v / k;\n  });\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateX3d(matrix, rad) {\n  return multiply(matrix, [1, 0, 0, 0, 0, Math.cos(rad), Math.sin(rad), 0, 0, -Math.sin(rad), Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateY3d(matrix, rad) {\n  return multiply(matrix, [Math.cos(rad), 0, -Math.sin(rad), 0, 0, 1, 0, 0, Math.sin(rad), 0, Math.cos(rad), 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotateZ3d(matrix, rad) {\n  return multiply(matrix, createRotateMatrix(rad, 4));\n}\n/**\n * @memberof Matrix\n */\n\nfunction scale3d(matrix, _a) {\n  var _b = _a[0],\n      sx = _b === void 0 ? 1 : _b,\n      _c = _a[1],\n      sy = _c === void 0 ? 1 : _c,\n      _d = _a[2],\n      sz = _d === void 0 ? 1 : _d;\n  return multiply(matrix, [sx, 0, 0, 0, 0, sy, 0, 0, 0, 0, sz, 0, 0, 0, 0, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction rotate(pos, rad) {\n  return calculate(createRotateMatrix(rad, 3), convertPositionMatrix(pos, 3));\n}\n/**\n * @memberof Matrix\n */\n\nfunction translate3d(matrix, _a) {\n  var _b = _a[0],\n      tx = _b === void 0 ? 0 : _b,\n      _c = _a[1],\n      ty = _c === void 0 ? 0 : _c,\n      _d = _a[2],\n      tz = _d === void 0 ? 0 : _d;\n  return multiply(matrix, [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, tx, ty, tz, 1], 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction matrix3d(matrix1, matrix2) {\n  return multiply(matrix1, matrix2, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction createRotateMatrix(rad, n) {\n  var cos = Math.cos(rad);\n  var sin = Math.sin(rad);\n  var m = createIdentityMatrix(n); // cos -sin\n  // sin cos\n\n  m[0] = cos;\n  m[1] = sin;\n  m[n] = -sin;\n  m[n + 1] = cos;\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createIdentityMatrix(n) {\n  var length = n * n;\n  var matrix = [];\n\n  for (var i = 0; i < length; ++i) {\n    matrix[i] = i % (n + 1) ? 0 : 1;\n  }\n\n  return matrix;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createScaleMatrix(scale, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(scale.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[(n + 1) * i] = scale[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createOriginMatrix(origin, n) {\n  var m = createIdentityMatrix(n);\n  var length = Math.min(origin.length, n - 1);\n\n  for (var i = 0; i < length; ++i) {\n    m[n * (n - 1) + i] = origin[i];\n  }\n\n  return m;\n}\n/**\n * @memberof Matrix\n */\n\nfunction createWarpMatrix(pos0, pos1, pos2, pos3, nextPos0, nextPos1, nextPos2, nextPos3) {\n  var x0 = pos0[0],\n      y0 = pos0[1];\n  var x1 = pos1[0],\n      y1 = pos1[1];\n  var x2 = pos2[0],\n      y2 = pos2[1];\n  var x3 = pos3[0],\n      y3 = pos3[1];\n  var u0 = nextPos0[0],\n      v0 = nextPos0[1];\n  var u1 = nextPos1[0],\n      v1 = nextPos1[1];\n  var u2 = nextPos2[0],\n      v2 = nextPos2[1];\n  var u3 = nextPos3[0],\n      v3 = nextPos3[1];\n  var matrix = [x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, x0, 0, x1, 0, x2, 0, x3, 0, y0, 0, y1, 0, y2, 0, y3, 0, 1, 0, 1, 0, 1, 0, 1, -u0 * x0, -v0 * x0, -u1 * x1, -v1 * x1, -u2 * x2, -v2 * x2, -u3 * x3, -v3 * x3, -u0 * y0, -v0 * y0, -u1 * y1, -v1 * y1, -u2 * y2, -v2 * y2, -u3 * y3, -v3 * y3];\n  var inverseMatrix = invert(matrix, 8);\n\n  if (!inverseMatrix.length) {\n    return [];\n  }\n\n  var h = multiply(inverseMatrix, [u0, v0, u1, v1, u2, v2, u3, v3], 8);\n  h[8] = 1;\n  return convertDimension(transpose(h), 3, 4);\n}\n/**\n * @memberof Matrix\n */\n\nfunction getCenter(points) {\n  return [0, 1].map(function (i) {\n    return average(points.map(function (pos) {\n      return pos[i];\n    }));\n  });\n}\n\nexport { calculate, convertCSStoMatrix, convertDimension, convertMatrixtoCSS, convertPositionMatrix, createIdentityMatrix, createOriginMatrix, createRotateMatrix, createScaleMatrix, createWarpMatrix, fromTranslation, getCenter, getOrigin, ignoreDimension, invert, matrix3d, minus, multiplies, multiply, plus, rotate, rotateX3d, rotateY3d, rotateZ3d, scale3d, translate3d, transpose };\n//# sourceMappingURL=matrix.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: css-to-mat\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-to-mat.git\nversion: 1.1.0\n*/\nimport { isArray, splitSpace, splitBracket, isObject, splitComma, convertUnitSize, splitUnit } from '@daybrush/utils';\nimport { calculate, matrix3d, invert, translate3d, scale3d, rotateZ3d, rotateX3d, rotateY3d } from '@scena/matrix';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction createMatrix() {\n    return [\n        1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1,\n    ];\n}\nfunction parseMat(transform, size) {\n    if (size === void 0) { size = 0; }\n    return toMat(parse(transform, size));\n}\nfunction getElementMatrix(el) {\n    return parseMat(getComputedStyle(el).transform);\n}\nfunction calculateMatrixDist(matrix, pos) {\n    var res = calculate(matrix, [pos[0], pos[1] || 0, pos[2] || 0, 1], 4);\n    var w = res[3] || 1;\n    return [\n        res[0] / w,\n        res[1] / w,\n        res[2] / w,\n    ];\n}\nfunction getDistElementMatrix(el, container) {\n    if (container === void 0) { container = document.body; }\n    var target = el;\n    var matrix = createMatrix();\n    while (target) {\n        var transform = getComputedStyle(target).transform;\n        matrix = matrix3d(parseMat(transform), matrix);\n        if (target === container) {\n            break;\n        }\n        target = target.parentElement;\n    }\n    matrix = invert(matrix, 4);\n    matrix[12] = 0;\n    matrix[13] = 0;\n    matrix[14] = 0;\n    return matrix;\n}\nfunction toMat(matrixInfos) {\n    var target = createMatrix();\n    matrixInfos.forEach(function (info) {\n        var matrixFunction = info.matrixFunction, functionValue = info.functionValue;\n        if (!matrixFunction) {\n            return;\n        }\n        target = matrixFunction(target, functionValue);\n    });\n    return target;\n}\nfunction parse(transform, size) {\n    if (size === void 0) { size = 0; }\n    var transforms = isArray(transform) ? transform : splitSpace(transform);\n    return transforms.map(function (t) {\n        var _a = splitBracket(t), name = _a.prefix, value = _a.value;\n        var matrixFunction = null;\n        var functionName = name;\n        var functionValue = \"\";\n        if (name === \"translate\" || name === \"translateX\" || name === \"translate3d\") {\n            var nextSize_1 = isObject(size) ? __assign(__assign({}, size), { \"o%\": size[\"%\"] }) : {\n                \"%\": size,\n                \"o%\": size,\n            };\n            var _b = splitComma(value).map(function (v, i) {\n                if (i === 0 && \"x%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"x%\"];\n                }\n                else if (i === 1 && \"y%\" in nextSize_1) {\n                    nextSize_1[\"%\"] = size[\"y%\"];\n                }\n                else {\n                    nextSize_1[\"%\"] = size[\"o%\"];\n                }\n                return convertUnitSize(v, nextSize_1);\n            }), posX = _b[0], _c = _b[1], posY = _c === void 0 ? 0 : _c, _d = _b[2], posZ = _d === void 0 ? 0 : _d;\n            matrixFunction = translate3d;\n            functionValue = [posX, posY, posZ];\n        }\n        else if (name === \"translateY\") {\n            var nextSize = isObject(size) ? __assign({ \"%\": size[\"y%\"] }, size) : {\n                \"%\": size,\n            };\n            var posY = convertUnitSize(value, nextSize);\n            matrixFunction = translate3d;\n            functionValue = [0, posY, 0];\n        }\n        else if (name === \"translateZ\") {\n            var posZ = parseFloat(value);\n            matrixFunction = translate3d;\n            functionValue = [0, 0, posZ];\n        }\n        else if (name === \"scale\" || name === \"scale3d\") {\n            var _e = splitComma(value).map(function (v) { return parseFloat(v); }), sx = _e[0], _f = _e[1], sy = _f === void 0 ? sx : _f, _g = _e[2], sz = _g === void 0 ? 1 : _g;\n            matrixFunction = scale3d;\n            functionValue = [sx, sy, sz];\n        }\n        else if (name === \"scaleX\") {\n            var sx = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [sx, 1, 1];\n        }\n        else if (name === \"scaleY\") {\n            var sy = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, sy, 1];\n        }\n        else if (name === \"scaleZ\") {\n            var sz = parseFloat(value);\n            matrixFunction = scale3d;\n            functionValue = [1, 1, sz];\n        }\n        else if (name === \"rotate\" || name === \"rotateZ\" || name === \"rotateX\" || name === \"rotateY\") {\n            var _h = splitUnit(value), unit = _h.unit, unitValue = _h.value;\n            var rad = unit === \"rad\" ? unitValue : unitValue * Math.PI / 180;\n            if (name === \"rotate\" || name === \"rotateZ\") {\n                functionName = \"rotateZ\";\n                matrixFunction = rotateZ3d;\n            }\n            else if (name === \"rotateX\") {\n                matrixFunction = rotateX3d;\n            }\n            else if (name === \"rotateY\") {\n                matrixFunction = rotateY3d;\n            }\n            functionValue = rad;\n        }\n        else if (name === \"matrix3d\") {\n            matrixFunction = matrix3d;\n            functionValue = splitComma(value).map(function (v) { return parseFloat(v); });\n        }\n        else if (name === \"matrix\") {\n            var m = splitComma(value).map(function (v) { return parseFloat(v); });\n            matrixFunction = matrix3d;\n            functionValue = [\n                m[0], m[1], 0, 0,\n                m[2], m[3], 0, 0,\n                0, 0, 1, 0,\n                m[4], m[5], 0, 1,\n            ];\n        }\n        else {\n            functionName = \"\";\n        }\n        return {\n            name: name,\n            functionName: functionName,\n            value: value,\n            matrixFunction: matrixFunction,\n            functionValue: functionValue,\n        };\n    });\n}\n\nexport { calculateMatrixDist, createMatrix, getDistElementMatrix, getElementMatrix, parse, parseMat, toMat };\n//# sourceMappingURL=css-to-mat.esm.js.map\n","/*\nCopyright (c) 2019-present NAVER Corp.\nname: @egjs/children-differ\nlicense: MIT\nauthor: NAVER Corp.\nrepository: https://github.com/naver/egjs-children-differ\nversion: 1.0.1\n*/\nimport ListDiffer, { diff as diff$1 } from '@egjs/list-differ';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\nvar findKeyCallback = typeof Map === \"function\" ? undefined : function () {\n  var childrenCount = 0;\n  return function (el) {\n    return el.__DIFF_KEY__ || (el.__DIFF_KEY__ = ++childrenCount);\n  };\n}();\n\n/**\n * A module that checks diff when child are added, removed, or changed .\n * @ko           .\n * @memberof eg\n * @extends eg.ListDiffer\n */\n\nvar ChildrenDiffer =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(ChildrenDiffer, _super);\n  /**\n   * @param - Initializing Children <ko>    </ko>\n   */\n\n\n  function ChildrenDiffer(list) {\n    if (list === void 0) {\n      list = [];\n    }\n\n    return _super.call(this, list, findKeyCallback) || this;\n  }\n\n  return ChildrenDiffer;\n}(ListDiffer);\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n/**\n *\n * @memberof eg.ChildrenDiffer\n * @static\n * @function\n * @param - Previous List <ko>   </ko>\n * @param - List to Update <ko>    </ko>\n * @return - Returns the diff between `prevList` and `list` <ko> `prevList` `list`   .</ko>\n * @example\n * import { diff } from \"@egjs/children-differ\";\n * // script => eg.ChildrenDiffer.diff\n * const result = diff([0, 1, 2, 3, 4, 5], [7, 8, 0, 4, 3, 6, 2, 1]);\n * // List before update\n * // [1, 2, 3, 4, 5]\n * console.log(result.prevList);\n * // Updated list\n * // [4, 3, 6, 2, 1]\n * console.log(result.list);\n * // Index array of values added to `list`\n * // [0, 1, 5]\n * console.log(result.added);\n * // Index array of values removed in `prevList`\n * // [5]\n * console.log(result.removed);\n * // An array of index pairs of `prevList` and `list` with different indexes from `prevList` and `list`\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.changed);\n * // The subset of `changed` and an array of index pairs that moved data directly. Indicate an array of absolute index pairs of `ordered`.(Formatted by: Array<[index of prevList, index of list]>)\n * // [[4, 3], [3, 4], [2, 6]]\n * console.log(result.pureChanged);\n * // An array of index pairs to be `ordered` that can synchronize `list` before adding data. (Formatted by: Array<[prevIndex, nextIndex]>)\n * // [[4, 1], [4, 2], [4, 3]]\n * console.log(result.ordered);\n * // An array of index pairs of `prevList` and `list` that have not been added/removed so data is preserved\n * // [[0, 2], [4, 3], [3, 4], [2, 6], [1, 7]]\n * console.log(result.maintained);\n */\n\nfunction diff(prevList, list) {\n  return diff$1(prevList, list, findKeyCallback);\n}\n\n/*\negjs-children-differ\nCopyright (c) 2019-present NAVER Corp.\nMIT license\n*/\n\nexport default ChildrenDiffer;\nexport { diff };\n//# sourceMappingURL=children-differ.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\nimport { isObject, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nexport default EventEmitter;\n//# sourceMappingURL=event-emitter.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: @scena/dragscroll\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/dragscroll.git\nversion: 1.4.0\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { now, isString, isFunction } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\n\nfunction getDefaultScrollPosition(e) {\n  var container = e.container;\n  if (container === document.body) {\n    return [container.scrollLeft || document.documentElement.scrollLeft, container.scrollTop || document.documentElement.scrollTop];\n  }\n  return [container.scrollLeft, container.scrollTop];\n}\nfunction checkDefaultScrollEvent(container, callback) {\n  container.addEventListener(\"scroll\", callback);\n  return function () {\n    container.removeEventListener(\"scroll\", callback);\n  };\n}\nfunction getContainerElement(container) {\n  if (!container) {\n    return null;\n  } else if (isString(container)) {\n    return document.querySelector(container);\n  }\n  if (isFunction(container)) {\n    return container();\n  } else if (container instanceof Element) {\n    return container;\n  } else if (\"current\" in container) {\n    return container.current;\n  } else if (\"value\" in container) {\n    return container.value;\n  }\n}\n/**\n * @sort 1\n */\nvar DragScroll = /*#__PURE__*/function (_super) {\n  __extends(DragScroll, _super);\n  function DragScroll() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this._startRect = null;\n    _this._startPos = [];\n    _this._prevTime = 0;\n    _this._timer = 0;\n    _this._prevScrollPos = [0, 0];\n    _this._isWait = false;\n    _this._flag = false;\n    _this._currentOptions = null;\n    _this._lock = false;\n    _this._unregister = null;\n    _this._onScroll = function () {\n      var options = _this._currentOptions;\n      if (_this._lock || !options) {\n        return;\n      }\n      _this.emit(\"scrollDrag\", {\n        next: function (inputEvent) {\n          _this.checkScroll({\n            container: options.container,\n            inputEvent: inputEvent\n          });\n        }\n      });\n    };\n    return _this;\n  }\n  /**\n   */\n  var __proto = DragScroll.prototype;\n  __proto.dragStart = function (e, options) {\n    var container = getContainerElement(options.container);\n    if (!container) {\n      this._flag = false;\n      return;\n    }\n    var top = 0;\n    var left = 0;\n    var width = 0;\n    var height = 0;\n    if (container === document.body) {\n      width = window.innerWidth;\n      height = window.innerHeight;\n    } else {\n      var rect = container.getBoundingClientRect();\n      top = rect.top;\n      left = rect.left;\n      width = rect.width;\n      height = rect.height;\n    }\n    this._flag = true;\n    this._startPos = [e.clientX, e.clientY];\n    this._startRect = {\n      top: top,\n      left: left,\n      width: width,\n      height: height\n    };\n    this._prevScrollPos = this._getScrollPosition([0, 0], options);\n    this._currentOptions = options;\n    this._registerScrollEvent(options);\n  };\n  __proto.drag = function (e, options) {\n    clearTimeout(this._timer);\n    if (!this._flag) {\n      return;\n    }\n    var clientX = e.clientX,\n      clientY = e.clientY;\n    var _a = options.threshold,\n      threshold = _a === void 0 ? 0 : _a;\n    var _b = this,\n      _startRect = _b._startRect,\n      _startPos = _b._startPos;\n    this._currentOptions = options;\n    var direction = [0, 0];\n    if (_startRect.top > clientY - threshold) {\n      if (_startPos[1] > _startRect.top || clientY < _startPos[1]) {\n        direction[1] = -1;\n      }\n    } else if (_startRect.top + _startRect.height < clientY + threshold) {\n      if (_startPos[1] < _startRect.top + _startRect.height || clientY > _startPos[1]) {\n        direction[1] = 1;\n      }\n    }\n    if (_startRect.left > clientX - threshold) {\n      if (_startPos[0] > _startRect.left || clientX < _startPos[0]) {\n        direction[0] = -1;\n      }\n    } else if (_startRect.left + _startRect.width < clientX + threshold) {\n      if (_startPos[0] < _startRect.left + _startRect.width || clientX > _startPos[0]) {\n        direction[0] = 1;\n      }\n    }\n    if (!direction[0] && !direction[1]) {\n      return false;\n    }\n    return this._continueDrag(__assign(__assign({}, options), {\n      direction: direction,\n      inputEvent: e,\n      isDrag: true\n    }));\n  };\n  /**\n   */\n  __proto.checkScroll = function (options) {\n    var _this = this;\n    if (this._isWait) {\n      return false;\n    }\n    var _a = options.prevScrollPos,\n      prevScrollPos = _a === void 0 ? this._prevScrollPos : _a,\n      direction = options.direction,\n      _b = options.throttleTime,\n      throttleTime = _b === void 0 ? 0 : _b,\n      inputEvent = options.inputEvent,\n      isDrag = options.isDrag;\n    var nextScrollPos = this._getScrollPosition(direction || [0, 0], options);\n    var offsetX = nextScrollPos[0] - prevScrollPos[0];\n    var offsetY = nextScrollPos[1] - prevScrollPos[1];\n    var nextDirection = direction || [offsetX ? Math.abs(offsetX) / offsetX : 0, offsetY ? Math.abs(offsetY) / offsetY : 0];\n    this._prevScrollPos = nextScrollPos;\n    this._lock = false;\n    if (!offsetX && !offsetY) {\n      return false;\n    }\n    /**\n     * @event DragScroll#move\n     */\n    this.emit(\"move\", {\n      offsetX: nextDirection[0] ? offsetX : 0,\n      offsetY: nextDirection[1] ? offsetY : 0,\n      inputEvent: inputEvent\n    });\n    if (throttleTime && isDrag) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, throttleTime);\n    }\n    return true;\n  };\n  /**\n   *\n   */\n  __proto.dragEnd = function () {\n    this._flag = false;\n    this._lock = false;\n    clearTimeout(this._timer);\n    this._unregisterScrollEvent();\n  };\n  __proto._getScrollPosition = function (direction, options) {\n    var container = options.container,\n      _a = options.getScrollPosition,\n      getScrollPosition = _a === void 0 ? getDefaultScrollPosition : _a;\n    return getScrollPosition({\n      container: getContainerElement(container),\n      direction: direction\n    });\n  };\n  __proto._continueDrag = function (options) {\n    var _this = this;\n    var _a;\n    var container = options.container,\n      direction = options.direction,\n      throttleTime = options.throttleTime,\n      useScroll = options.useScroll,\n      isDrag = options.isDrag,\n      inputEvent = options.inputEvent;\n    if (!this._flag || isDrag && this._isWait) {\n      return;\n    }\n    var nowTime = now();\n    var distTime = Math.max(throttleTime + this._prevTime - nowTime, 0);\n    if (distTime > 0) {\n      clearTimeout(this._timer);\n      this._timer = window.setTimeout(function () {\n        _this._continueDrag(options);\n      }, distTime);\n      return false;\n    }\n    this._prevTime = nowTime;\n    var prevScrollPos = this._getScrollPosition(direction, options);\n    this._prevScrollPos = prevScrollPos;\n    if (isDrag) {\n      this._isWait = true;\n    }\n    // unregister native scroll event\n    if (!useScroll) {\n      this._lock = true;\n    }\n    var param = {\n      container: getContainerElement(container),\n      direction: direction,\n      inputEvent: inputEvent\n    };\n    (_a = options.requestScroll) === null || _a === void 0 ? void 0 : _a.call(options, param);\n    /**\n     * @event DragScroll#scroll\n     */\n    this.emit(\"scroll\", param);\n    this._isWait = false;\n    return useScroll || this.checkScroll(__assign(__assign({}, options), {\n      prevScrollPos: prevScrollPos,\n      direction: direction,\n      inputEvent: inputEvent\n    }));\n  };\n  __proto._registerScrollEvent = function (options) {\n    this._unregisterScrollEvent();\n    var checkScrollEvent = options.checkScrollEvent;\n    if (!checkScrollEvent) {\n      return;\n    }\n    var callback = checkScrollEvent === true ? checkDefaultScrollEvent : checkScrollEvent;\n    var container = getContainerElement(options.container);\n    if (checkScrollEvent === true && (container === document.body || container === document.documentElement)) {\n      this._unregister = checkDefaultScrollEvent(window, this._onScroll);\n    } else {\n      this._unregister = callback(container, this._onScroll);\n    }\n  };\n  __proto._unregisterScrollEvent = function () {\n    var _a;\n    (_a = this._unregister) === null || _a === void 0 ? void 0 : _a.call(this);\n    this._unregister = null;\n  };\n  return DragScroll;\n}(EventEmitter);\n\nexport default DragScroll;\n//# sourceMappingURL=dragscroll.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: overlap-area\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/overlap-area.git\nversion: 1.1.0\n*/\nimport { throttle, TINY_NUM, sum, find, getDist, getShapeDirection, findIndex } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\nfunction tinyThrottle(num) {\n  return throttle(num, TINY_NUM);\n}\nfunction isSameConstants(linearConstants1, linearConstants2) {\n  return linearConstants1.every(function (v, i) {\n    return tinyThrottle(v - linearConstants2[i]) === 0;\n  });\n}\nfunction isSamePoint(point1, point2) {\n  return !tinyThrottle(point1[0] - point2[0]) && !tinyThrottle(point1[1] - point2[1]);\n}\nfunction flat(arr) {\n  return arr.reduce(function (prev, current) {\n    prev.push.apply(prev, current);\n    return prev;\n  }, []);\n}\n\n/**\n * @namespace OverlapArea\n */\n\n/**\n * Gets the size of a shape (polygon) made of points.\n * @memberof OverlapArea\n */\n\nfunction getAreaSize(points) {\n  if (points.length < 3) {\n    return 0;\n  }\n\n  return Math.abs(sum(points.map(function (point, i) {\n    var nextPoint = points[i + 1] || points[0];\n    return point[0] * nextPoint[1] - nextPoint[0] * point[1];\n  }))) / 2;\n}\n/**\n * Get points that fit the rect,\n * @memberof OverlapArea\n */\n\nfunction fitPoints(points, rect) {\n  var width = rect.width,\n      height = rect.height,\n      left = rect.left,\n      top = rect.top;\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      minY = _a.minY,\n      maxX = _a.maxX,\n      maxY = _a.maxY;\n\n  var ratioX = width / (maxX - minX);\n  var ratioY = height / (maxY - minY);\n  return points.map(function (point) {\n    return [left + (point[0] - minX) * ratioX, top + (point[1] - minY) * ratioY];\n  });\n}\n/**\n * Get the minimum and maximum points of the points.\n * @memberof OverlapArea\n */\n\nfunction getMinMaxs(points) {\n  var xs = points.map(function (point) {\n    return point[0];\n  });\n  var ys = points.map(function (point) {\n    return point[1];\n  });\n  return {\n    minX: Math.min.apply(Math, xs),\n    minY: Math.min.apply(Math, ys),\n    maxX: Math.max.apply(Math, xs),\n    maxY: Math.max.apply(Math, ys)\n  };\n}\n/**\n * Whether the point is in shape\n * @param - point pos\n * @param - shape points\n * @param - whether to check except line\n * @memberof OverlapArea\n */\n\nfunction isInside(pos, points, excludeLine) {\n  var x = pos[0],\n      y = pos[1];\n\n  var _a = getMinMaxs(points),\n      minX = _a.minX,\n      maxX = _a.maxX;\n\n  var xLine = [[minX, y], [maxX, y]];\n  var xLinearConstants = getLinearConstants(xLine[0], xLine[1]);\n  var lines = convertLines(points);\n  var intersectionPosInfos = [];\n  lines.forEach(function (line) {\n    var linearConstants = getLinearConstants(line[0], line[1]);\n    var standardPoint = line[0];\n\n    if (isSameConstants(xLinearConstants, linearConstants)) {\n      intersectionPosInfos.push({\n        pos: pos,\n        line: line,\n        type: \"line\"\n      });\n    } else {\n      var xPoints = getPointsOnLines(getIntersectionPointsByConstants(xLinearConstants, linearConstants), [xLine, line]);\n      xPoints.forEach(function (point) {\n        if (line.some(function (linePoint) {\n          return isSamePoint(linePoint, point);\n        })) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"point\"\n          });\n        } else if (tinyThrottle(standardPoint[1] - y) !== 0) {\n          intersectionPosInfos.push({\n            pos: point,\n            line: line,\n            type: \"intersection\"\n          });\n        }\n      });\n    }\n  });\n\n  if (!excludeLine) {\n    // on line\n    if (find(intersectionPosInfos, function (p) {\n      return p[0] === x;\n    })) {\n      return true;\n    }\n  }\n\n  var intersectionCount = 0;\n  var xMap = {};\n  intersectionPosInfos.forEach(function (_a) {\n    var pos = _a.pos,\n        type = _a.type,\n        line = _a.line;\n\n    if (pos[0] > x) {\n      return;\n    }\n\n    if (type === \"intersection\") {\n      ++intersectionCount;\n    } else if (type === \"line\") {\n      return;\n    } else if (type === \"point\") {\n      var point = find(line, function (linePoint) {\n        return linePoint[1] !== y;\n      });\n      var prevValue = xMap[pos[0]];\n      var nextValue = point[1] > y ? 1 : -1;\n\n      if (!prevValue) {\n        xMap[pos[0]] = nextValue;\n      } else if (prevValue !== nextValue) {\n        ++intersectionCount;\n      }\n    }\n  });\n  return intersectionCount % 2 === 1;\n}\n/**\n * Get distance from point to constants. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getDistanceFromPointToConstants(_a, pos) {\n  var a = _a[0],\n      b = _a[1],\n      c = _a[2];\n  return (a * pos[0] + b * pos[1] + c) / (a * a + b * b);\n}\n/**\n * Get the coefficient of the linear function. [a, b, c] (ax + by + c = 0)\n * @return [a, b, c]\n * @memberof OverlapArea\n */\n\nfunction getLinearConstants(point1, point2) {\n  var x1 = point1[0],\n      y1 = point1[1];\n  var x2 = point2[0],\n      y2 = point2[1]; // ax + by + c = 0\n  // [a, b, c]\n\n  var dx = x2 - x1;\n  var dy = y2 - y1;\n\n  if (Math.abs(dx) < TINY_NUM) {\n    dx = 0;\n  }\n\n  if (Math.abs(dy) < TINY_NUM) {\n    dy = 0;\n  } // b > 0\n  // ax + by + c = 0\n\n\n  var a = 0;\n  var b = 0;\n  var c = 0;\n\n  if (!dx) {\n    if (dy) {\n      // -x + 1 = 0\n      a = -1;\n      c = x1;\n    }\n  } else if (!dy) {\n    // y - 1 = 0\n    b = 1;\n    c = -y1;\n  } else {\n    // y = -a(x - x1) + y1\n    // ax + y + a * x1 - y1 = 0\n    a = -dy / dx;\n    b = 1;\n    c = -a * x1 - y1;\n  }\n\n  return [a, b, c];\n}\n/**\n * Get intersection points with linear functions.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPointsByConstants(linearConstants1, linearConstants2) {\n  var a1 = linearConstants1[0],\n      b1 = linearConstants1[1],\n      c1 = linearConstants1[2];\n  var a2 = linearConstants2[0],\n      b2 = linearConstants2[1],\n      c2 = linearConstants2[2];\n  var isZeroA = a1 === 0 && a2 === 0;\n  var isZeroB = b1 === 0 && b2 === 0;\n  var results = [];\n\n  if (isZeroA && isZeroB) {\n    return [];\n  } else if (isZeroA) {\n    // b1 * y + c1 = 0\n    // b2 * y + c2 = 0\n    var y1 = -c1 / b1;\n    var y2 = -c2 / b2;\n\n    if (y1 !== y2) {\n      return [];\n    } else {\n      return [[-Infinity, y1], [Infinity, y1]];\n    }\n  } else if (isZeroB) {\n    // a1 * x + c1 = 0\n    // a2 * x + c2 = 0\n    var x1 = -c1 / a1;\n    var x2 = -c2 / a2;\n\n    if (x1 !== x2) {\n      return [];\n    } else {\n      return [[x1, -Infinity], [x1, Infinity]];\n    }\n  } else if (a1 === 0) {\n    // b1 * y + c1 = 0\n    // y = - c1 / b1;\n    // a2 * x + b2 * y + c2 = 0\n    var y = -c1 / b1;\n    var x = -(b2 * y + c2) / a2;\n    results = [[x, y]];\n  } else if (a2 === 0) {\n    // b2 * y + c2 = 0\n    // y = - c2 / b2;\n    // a1 * x + b1 * y + c1 = 0\n    var y = -c2 / b2;\n    var x = -(b1 * y + c1) / a1;\n    results = [[x, y]];\n  } else if (b1 === 0) {\n    // a1 * x + c1 = 0\n    // x = - c1 / a1;\n    // a2 * x + b2 * y + c2 = 0\n    var x = -c1 / a1;\n    var y = -(a2 * x + c2) / b2;\n    results = [[x, y]];\n  } else if (b2 === 0) {\n    // a2 * x + c2 = 0\n    // x = - c2 / a2;\n    // a1 * x + b1 * y + c1 = 0\n    var x = -c2 / a2;\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  } else {\n    // a1 * x + b1 * y + c1 = 0\n    // a2 * x + b2 * y + c2 = 0\n    // b2 * a1 * x + b2 * b1 * y + b2 * c1 = 0\n    // b1 * a2 * x + b1 * b2 * y + b1 * c2 = 0\n    // (b2 * a1 - b1 * a2)  * x = (b1 * c2 - b2 * c1)\n    var x = (b1 * c2 - b2 * c1) / (b2 * a1 - b1 * a2);\n    var y = -(a1 * x + c1) / b1;\n    results = [[x, y]];\n  }\n\n  return results.map(function (result) {\n    return [result[0], result[1]];\n  });\n}\n/**\n * Get intersection points to the two lines.\n * @memberof OverlapArea\n */\n\nfunction getIntersectionPoints(line1, line2, isLimit) {\n  var points = getIntersectionPointsByConstants(getLinearConstants(line1[0], line1[1]), getLinearConstants(line2[0], line2[1]));\n\n  if (isLimit) {\n    return getPointsOnLines(points, [line1, line2]);\n  }\n\n  return points;\n}\nfunction isPointOnLine(pos, line) {\n  var linearConstants = getLinearConstants(line[0], line[1]);\n  return tinyThrottle(getDistanceFromPointToConstants(linearConstants, pos)) === 0;\n}\n/**\n * Get the points on the lines (between two points).\n * @memberof OverlapArea\n */\n\nfunction getPointsOnLines(points, lines) {\n  var minMaxs = lines.map(function (line) {\n    return [0, 1].map(function (order) {\n      return [Math.min(line[0][order], line[1][order]), Math.max(line[0][order], line[1][order])];\n    });\n  });\n  var results = [];\n\n  if (points.length === 2) {\n    var _a = points[0],\n        x = _a[0],\n        y = _a[1];\n\n    if (!tinyThrottle(x - points[1][0])) {\n      /// Math.max(minY1, minY2)\n      var top = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var bottom = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[1][1];\n      }));\n\n      if (tinyThrottle(top - bottom) > 0) {\n        return [];\n      }\n\n      results = [[x, top], [x, bottom]];\n    } else if (!tinyThrottle(y - points[1][1])) {\n      /// Math.max(minY1, minY2)\n      var left = Math.max.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][0];\n      })); /// Math.min(maxY1, miax2)\n\n      var right = Math.min.apply(Math, minMaxs.map(function (minMax) {\n        return minMax[0][1];\n      }));\n\n      if (tinyThrottle(left - right) > 0) {\n        return [];\n      }\n\n      results = [[left, y], [right, y]];\n    }\n  }\n\n  if (!results.length) {\n    results = points.filter(function (point) {\n      var pointX = point[0],\n          pointY = point[1];\n      return minMaxs.every(function (minMax) {\n        return 0 <= tinyThrottle(pointX - minMax[0][0]) && 0 <= tinyThrottle(minMax[0][1] - pointX) && 0 <= tinyThrottle(pointY - minMax[1][0]) && 0 <= tinyThrottle(minMax[1][1] - pointY);\n      });\n    });\n  }\n\n  return results.map(function (result) {\n    return [tinyThrottle(result[0]), tinyThrottle(result[1])];\n  });\n}\n/**\n* Convert two points into lines.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction convertLines(points) {\n  return __spreadArrays(points.slice(1), [points[0]]).map(function (point, i) {\n    return [points[i], point];\n  });\n}\n\nfunction getOverlapPointInfos(points1, points2) {\n  var targetPoints1 = points1.slice();\n  var targetPoints2 = points2.slice();\n\n  if (getShapeDirection(targetPoints1) === -1) {\n    targetPoints1.reverse();\n  }\n\n  if (getShapeDirection(targetPoints2) === -1) {\n    targetPoints2.reverse();\n  }\n\n  var lines1 = convertLines(targetPoints1);\n  var lines2 = convertLines(targetPoints2);\n  var linearConstantsList1 = lines1.map(function (line1) {\n    return getLinearConstants(line1[0], line1[1]);\n  });\n  var linearConstantsList2 = lines2.map(function (line2) {\n    return getLinearConstants(line2[0], line2[1]);\n  });\n  var overlapInfos = [];\n  linearConstantsList1.forEach(function (linearConstants1, i) {\n    var line1 = lines1[i];\n    var linePointInfos = [];\n    linearConstantsList2.forEach(function (linearConstants2, j) {\n      var intersectionPoints = getIntersectionPointsByConstants(linearConstants1, linearConstants2);\n      var points = getPointsOnLines(intersectionPoints, [line1, lines2[j]]);\n      linePointInfos.push.apply(linePointInfos, points.map(function (pos) {\n        return {\n          index1: i,\n          index2: j,\n          pos: pos,\n          type: \"intersection\"\n        };\n      }));\n    });\n    linePointInfos.sort(function (a, b) {\n      return getDist(line1[0], a.pos) - getDist(line1[0], b.pos);\n    });\n    overlapInfos.push.apply(overlapInfos, linePointInfos);\n\n    if (isInside(line1[1], targetPoints2)) {\n      overlapInfos.push({\n        index1: i,\n        index2: -1,\n        pos: line1[1],\n        type: \"inside\"\n      });\n    }\n  });\n  lines2.forEach(function (line2, i) {\n    if (!isInside(line2[1], targetPoints1)) {\n      return;\n    }\n\n    var isNext = false;\n    var index = findIndex(overlapInfos, function (_a) {\n      var index2 = _a.index2;\n\n      if (index2 === i) {\n        isNext = true;\n        return false;\n      }\n\n      if (isNext) {\n        return true;\n      }\n\n      return false;\n    });\n\n    if (index === -1) {\n      isNext = false;\n      index = findIndex(overlapInfos, function (_a) {\n        var index1 = _a.index1,\n            index2 = _a.index2;\n\n        if (index1 === -1 && index2 + 1 === i) {\n          isNext = true;\n          return false;\n        }\n\n        if (isNext) {\n          return true;\n        }\n\n        return false;\n      });\n    }\n\n    if (index === -1) {\n      overlapInfos.push({\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    } else {\n      overlapInfos.splice(index, 0, {\n        index1: -1,\n        index2: i,\n        pos: line2[1],\n        type: \"inside\"\n      });\n    }\n  });\n  var pointMap = {};\n  return overlapInfos.filter(function (_a) {\n    var pos = _a.pos;\n    var key = pos[0] + \"x\" + pos[1];\n\n    if (pointMap[key]) {\n      return false;\n    }\n\n    pointMap[key] = true;\n    return true;\n  });\n}\n/**\n* Get the points of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapPoints(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  return infos.map(function (_a) {\n    var pos = _a.pos;\n    return pos;\n  });\n}\n\nfunction isConnectedLine(line) {\n  var _a = line[0],\n      prevIndex1 = _a.index1,\n      prevIndex2 = _a.index2,\n      _b = line[1],\n      nextIndex1 = _b.index1,\n      nextIndex2 = _b.index2;\n\n  if (prevIndex1 !== -1) {\n    // same line\n    if (prevIndex1 === nextIndex1) {\n      return true;\n    }\n\n    if (prevIndex1 + 1 === nextIndex1) {\n      return true;\n    }\n  }\n\n  if (prevIndex2 !== -1) {\n    // same line\n    if (prevIndex2 === nextIndex2) {\n      return true;\n    }\n\n    if (prevIndex2 + 1 === nextIndex2) {\n      return true;\n    }\n  }\n\n  return false;\n}\n/**\n* Get the areas of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\n\nfunction getOverlapAreas(points1, points2) {\n  var infos = getOverlapPointInfos(points1, points2);\n  var areas = [];\n  var area;\n  getOverlapPointInfos(points1, points2).forEach(function (info, i, arr) {\n    if (i === 0 || !isConnectedLine([arr[i - 1], info])) {\n      area = [info];\n      areas.push(area);\n    } else {\n      area.push(info);\n    }\n  });\n  return areas.map(function (area) {\n    return area.map(function (_a) {\n      var pos = _a.pos;\n      return pos;\n    });\n  });\n}\n\nfunction findReversedAreas(points1, points2, index, areas) {\n  if (index === void 0) {\n    index = 0;\n  }\n\n  if (areas === void 0) {\n    areas = [];\n  }\n\n  var isFirst = areas.length === 0;\n  var length = points1.length;\n  var nextIndex = points1[index] ? index : 0;\n\n  var nextPoints1 = __spreadArrays(points1.slice(nextIndex), points1.slice(0, nextIndex));\n\n  var _loop_1 = function (i) {\n    var point1 = nextPoints1[i];\n\n    if (find(points2, function (point2) {\n      return point2[0] === point1[0] && point2[1] === point1[1];\n    })) {\n      return \"continue\";\n    }\n\n    if (areas.some(function (nextArea) {\n      return find(nextArea, function (areaPoint) {\n        return areaPoint[0] === point1[0] && areaPoint[1] === point1[1];\n      });\n    })) {\n      if (isFirst) {\n        return \"continue\";\n      } else {\n        return \"break\";\n      }\n    }\n\n    var nextArea = void 0;\n\n    if (isFirst) {\n      nextArea = [];\n      areas.push(nextArea);\n    } else {\n      nextArea = areas[areas.length - 1];\n    }\n\n    nextArea.push(point1);\n    var line = [point1, points1[index + 1] || points1[0]];\n    var nextPoint2 = points2.filter(function (point2) {\n      return isPointOnLine(point2, line);\n    }).sort(function (a, b) {\n      return getDist(point1, a) - getDist(point1, b);\n    })[0];\n\n    if (!nextPoint2) {\n      findReversedAreas(nextPoints1, points2, i + 1, areas);\n      return \"break\";\n    } else {\n      var point2Index = points2.indexOf(nextPoint2);\n      findReversedAreas(points2, points1, point2Index, areas);\n\n      if (!isFirst) {\n        return \"break\";\n      }\n    }\n  };\n\n  for (var i = 0; i < length; ++i) {\n    var state_1 = _loop_1(i);\n\n    if (state_1 === \"break\") break;\n  }\n\n  return areas;\n}\n\nfunction findConnectedAreas(points1, points2) {\n  return findReversedAreas(points1, __spreadArrays(points2).reverse());\n}\n/**\n* Get non-overlapping areas of two shapes based on points1.\n* @memberof OverlapArea\n*/\n\nfunction getUnoverlapAreas(points1, points2) {\n  if (!points2.length) {\n    return [__spreadArrays(points1)];\n  }\n\n  var overlapAreas = getOverlapAreas(points1, points2);\n  var unoverlapAreas = [points1];\n  overlapAreas.forEach(function (overlapArea) {\n    var nextOverlapArea = __spreadArrays(overlapArea).reverse();\n\n    unoverlapAreas = flat(unoverlapAreas.map(function (area) {\n      var connectedAreas = findReversedAreas(area, nextOverlapArea);\n      var firstConnectedArea = connectedAreas[0];\n\n      if (connectedAreas.length === 1 && nextOverlapArea.every(function (point) {\n        return firstConnectedArea.indexOf(point) === -1;\n      })) {\n        var lastPoint_1 = firstConnectedArea[firstConnectedArea.length - 1];\n\n        var firstPoint = __spreadArrays(nextOverlapArea).sort(function (a, b) {\n          return getDist(lastPoint_1, a) - getDist(lastPoint_1, b);\n        })[0];\n\n        var firstIndex = nextOverlapArea.indexOf(firstPoint);\n        firstConnectedArea.push.apply(firstConnectedArea, __spreadArrays(nextOverlapArea.slice(firstIndex), nextOverlapArea.slice(0, firstIndex), [nextOverlapArea[firstIndex], lastPoint_1]));\n      }\n\n      return connectedAreas;\n    }));\n  });\n  return unoverlapAreas;\n}\n/**\n* Gets the size of the overlapped part of two shapes.\n* @function\n* @memberof OverlapArea\n*/\n\nfunction getOverlapSize(points1, points2) {\n  var points = getOverlapPoints(points1, points2);\n  return getAreaSize(points);\n}\n\nexport { convertLines, findConnectedAreas, fitPoints, getAreaSize, getDistanceFromPointToConstants, getIntersectionPoints, getIntersectionPointsByConstants, getLinearConstants, getMinMaxs, getOverlapAreas, getOverlapPoints, getOverlapSize, getPointsOnLines, getUnoverlapAreas, isInside, isPointOnLine };\n//# sourceMappingURL=overlap-area.esm.js.map\n","/*\nCopyright (c) 2019 Daybrush\nname: gesto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesto.git\nversion: 1.19.4\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport { removeEvent, addEvent, now, isWindow, getWindow } from '@daybrush/utils';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nfunction getRad(pos1, pos2) {\n    var distX = pos2[0] - pos1[0];\n    var distY = pos2[1] - pos1[1];\n    var rad = Math.atan2(distY, distX);\n    return rad >= 0 ? rad : rad + Math.PI * 2;\n}\nfunction getRotatiion(touches) {\n    return getRad([\n        touches[0].clientX,\n        touches[0].clientY,\n    ], [\n        touches[1].clientX,\n        touches[1].clientY,\n    ]) / Math.PI * 180;\n}\nfunction isMultiTouch(e) {\n    return e.touches && e.touches.length >= 2;\n}\nfunction getEventClients(e) {\n    if (!e) {\n        return [];\n    }\n    if (e.touches) {\n        return getClients(e.touches);\n    }\n    else {\n        return [getClient(e)];\n    }\n}\nfunction isMouseEvent(e) {\n    return e && (e.type.indexOf(\"mouse\") > -1 || \"button\" in e);\n}\nfunction getPosition(clients, prevClients, startClients) {\n    var length = startClients.length;\n    var _a = getAverageClient(clients, length), clientX = _a.clientX, clientY = _a.clientY, originalClientX = _a.originalClientX, originalClientY = _a.originalClientY;\n    var _b = getAverageClient(prevClients, length), prevX = _b.clientX, prevY = _b.clientY;\n    var _c = getAverageClient(startClients, length), startX = _c.clientX, startY = _c.clientY;\n    var deltaX = clientX - prevX;\n    var deltaY = clientY - prevY;\n    var distX = clientX - startX;\n    var distY = clientY - startY;\n    return {\n        clientX: originalClientX,\n        clientY: originalClientY,\n        deltaX: deltaX,\n        deltaY: deltaY,\n        distX: distX,\n        distY: distY,\n    };\n}\nfunction getDist(clients) {\n    return Math.sqrt(Math.pow(clients[0].clientX - clients[1].clientX, 2)\n        + Math.pow(clients[0].clientY - clients[1].clientY, 2));\n}\nfunction getClients(touches) {\n    var length = Math.min(touches.length, 2);\n    var clients = [];\n    for (var i = 0; i < length; ++i) {\n        clients.push(getClient(touches[i]));\n    }\n    return clients;\n}\nfunction getClient(e) {\n    return {\n        clientX: e.clientX,\n        clientY: e.clientY,\n    };\n}\nfunction getAverageClient(clients, length) {\n    if (length === void 0) { length = clients.length; }\n    var sumClient = {\n        clientX: 0,\n        clientY: 0,\n        originalClientX: 0,\n        originalClientY: 0,\n    };\n    var minLength = Math.min(clients.length, length);\n    for (var i = 0; i < minLength; ++i) {\n        var client = clients[i];\n        sumClient.originalClientX += \"originalClientX\" in client ? client.originalClientX : client.clientX;\n        sumClient.originalClientY += \"originalClientY\" in client ? client.originalClientY : client.clientY;\n        sumClient.clientX += client.clientX;\n        sumClient.clientY += client.clientY;\n    }\n    if (!length) {\n        return sumClient;\n    }\n    return {\n        clientX: sumClient.clientX / length,\n        clientY: sumClient.clientY / length,\n        originalClientX: sumClient.originalClientX / length,\n        originalClientY: sumClient.originalClientY / length,\n    };\n}\n\nvar ClientStore = /*#__PURE__*/ (function () {\n    function ClientStore(clients) {\n        this.prevClients = [];\n        this.startClients = [];\n        this.movement = 0;\n        this.length = 0;\n        this.startClients = clients;\n        this.prevClients = clients;\n        this.length = clients.length;\n    }\n    ClientStore.prototype.getAngle = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients);\n    };\n    ClientStore.prototype.getRotation = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getRotatiion(clients) - getRotatiion(this.startClients);\n    };\n    ClientStore.prototype.getPosition = function (clients, isAdd) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var position = getPosition(clients || this.prevClients, this.prevClients, this.startClients);\n        var deltaX = position.deltaX, deltaY = position.deltaY;\n        this.movement += Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n        this.prevClients = clients;\n        return position;\n    };\n    ClientStore.prototype.getPositions = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        var prevClients = this.prevClients;\n        var startClients = this.startClients;\n        var minLength = Math.min(this.length, prevClients.length);\n        var positions = [];\n        for (var i = 0; i < minLength; ++i) {\n            positions[i] = getPosition([clients[i]], [prevClients[i]], [startClients[i]]);\n        }\n        return positions;\n    };\n    ClientStore.prototype.getMovement = function (clients) {\n        var movement = this.movement;\n        if (!clients) {\n            return movement;\n        }\n        var currentClient = getAverageClient(clients, this.length);\n        var prevClient = getAverageClient(this.prevClients, this.length);\n        var deltaX = currentClient.clientX - prevClient.clientX;\n        var deltaY = currentClient.clientY - prevClient.clientY;\n        return Math.sqrt(deltaX * deltaX + deltaY * deltaY) + movement;\n    };\n    ClientStore.prototype.getDistance = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients);\n    };\n    ClientStore.prototype.getScale = function (clients) {\n        if (clients === void 0) { clients = this.prevClients; }\n        return getDist(clients) / getDist(this.startClients);\n    };\n    ClientStore.prototype.move = function (deltaX, deltaY) {\n        this.startClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n        this.prevClients.forEach(function (client) {\n            client.clientX -= deltaX;\n            client.clientY -= deltaY;\n        });\n    };\n    return ClientStore;\n}());\n\nvar INPUT_TAGNAMES = [\"textarea\", \"input\"];\n/**\n * You can set up drag, pinch events in any browser.\n */\nvar Gesto = /*#__PURE__*/ (function (_super) {\n    __extends(Gesto, _super);\n    /**\n     *\n     */\n    function Gesto(targets, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this) || this;\n        _this.options = {};\n        _this.flag = false;\n        _this.pinchFlag = false;\n        _this.data = {};\n        _this.isDrag = false;\n        _this.isPinch = false;\n        _this.clientStores = [];\n        _this.targets = [];\n        _this.prevTime = 0;\n        _this.doubleFlag = false;\n        _this._useMouse = false;\n        _this._useTouch = false;\n        _this._useDrag = false;\n        _this._dragFlag = false;\n        _this._isTrusted = false;\n        _this._isMouseEvent = false;\n        _this._isSecondaryButton = false;\n        _this._preventMouseEvent = false;\n        _this._prevInputEvent = null;\n        _this._isDragAPI = false;\n        _this._isIdle = true;\n        _this._preventMouseEventId = 0;\n        _this._window = window;\n        _this.onDragStart = function (e, isTrusted) {\n            if (isTrusted === void 0) { isTrusted = true; }\n            if (!_this.flag && e.cancelable === false) {\n                return;\n            }\n            var isDragAPI = e.type.indexOf(\"drag\") >= -1;\n            if (_this.flag && isDragAPI) {\n                return;\n            }\n            _this._isDragAPI = true;\n            var _a = _this.options, container = _a.container, pinchOutside = _a.pinchOutside, preventWheelClick = _a.preventWheelClick, preventRightClick = _a.preventRightClick, preventDefault = _a.preventDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var useTouch = _this._useTouch;\n            var isDragStart = !_this.flag;\n            _this._isSecondaryButton = e.which === 3 || e.button === 2;\n            if ((preventWheelClick && (e.which === 2 || e.button === 1))\n                || (preventRightClick && (e.which === 3 || e.button === 2))) {\n                _this.stop();\n                return false;\n            }\n            if (isDragStart) {\n                var activeElement = _this._window.document.activeElement;\n                var target = e.target;\n                if (target) {\n                    var tagName = target.tagName.toLowerCase();\n                    var hasInput = INPUT_TAGNAMES.indexOf(tagName) > -1;\n                    var hasContentEditable = target.isContentEditable;\n                    if (hasInput || hasContentEditable) {\n                        if (checkInput || (!dragFocusedInput && activeElement === target)) {\n                            // force false or already focused.\n                            return false;\n                        }\n                        // no focus\n                        if (activeElement && (activeElement === target\n                            || (hasContentEditable && activeElement.isContentEditable && activeElement.contains(target)))) {\n                            if (dragFocusedInput) {\n                                target.blur();\n                            }\n                            else {\n                                return false;\n                            }\n                        }\n                    }\n                    else if ((preventDefault || e.type === \"touchstart\") && activeElement) {\n                        var activeTagName = activeElement.tagName.toLowerCase();\n                        if (activeElement.isContentEditable || INPUT_TAGNAMES.indexOf(activeTagName) > -1) {\n                            activeElement.blur();\n                        }\n                    }\n                    if (preventClickEventOnDragStart || preventClickEventOnDrag || preventClickEventByCondition) {\n                        addEvent(_this._window, \"click\", _this._onClick, true);\n                    }\n                }\n                _this.clientStores = [new ClientStore(getEventClients(e))];\n                _this._isIdle = false;\n                _this.flag = true;\n                _this.isDrag = false;\n                _this._isTrusted = isTrusted;\n                _this._dragFlag = true;\n                _this._prevInputEvent = e;\n                _this.data = {};\n                _this.doubleFlag = now() - _this.prevTime < 200;\n                _this._isMouseEvent = isMouseEvent(e);\n                if (!_this._isMouseEvent && _this._preventMouseEvent) {\n                    _this._allowMouseEvent();\n                }\n                var result = _this._preventMouseEvent || _this.emit(\"dragStart\", __assign(__assign({ data: _this.data, datas: _this.data, inputEvent: e, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, isTrusted: isTrusted, isDouble: _this.doubleFlag }, _this.getCurrentStore().getPosition()), { preventDefault: function () {\n                        e.preventDefault();\n                    }, preventDrag: function () {\n                        _this._dragFlag = false;\n                    } }));\n                if (result === false) {\n                    _this.stop();\n                }\n                if (_this._isMouseEvent && _this.flag && preventDefault) {\n                    e.preventDefault();\n                }\n            }\n            if (!_this.flag) {\n                return false;\n            }\n            var timer = 0;\n            if (isDragStart) {\n                _this._attchDragEvent();\n                // wait pinch\n                if (useTouch && pinchOutside) {\n                    timer = setTimeout(function () {\n                        addEvent(container, \"touchstart\", _this.onDragStart, {\n                            passive: false\n                        });\n                    });\n                }\n            }\n            else if (useTouch && pinchOutside) {\n                // pinch is occured\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.flag && isMultiTouch(e)) {\n                clearTimeout(timer);\n                if (isDragStart && (e.touches.length !== e.changedTouches.length)) {\n                    return;\n                }\n                if (!_this.pinchFlag) {\n                    _this.onPinchStart(e);\n                }\n            }\n        };\n        _this.onDrag = function (e, isScroll) {\n            if (!_this.flag) {\n                return;\n            }\n            var preventDefault = _this.options.preventDefault;\n            if (!_this._isMouseEvent && preventDefault) {\n                e.preventDefault();\n            }\n            _this._prevInputEvent = e;\n            var clients = getEventClients(e);\n            var result = _this.moveClients(clients, e, false);\n            if (_this._dragFlag) {\n                if (_this.pinchFlag || result.deltaX || result.deltaY) {\n                    var dragResult = _this._preventMouseEvent || _this.emit(\"drag\", __assign(__assign({}, result), { isScroll: !!isScroll, inputEvent: e }));\n                    if (dragResult === false) {\n                        _this.stop();\n                        return;\n                    }\n                }\n                if (_this.pinchFlag) {\n                    _this.onPinch(e, clients);\n                }\n            }\n            _this.getCurrentStore().getPosition(clients, true);\n        };\n        _this.onDragEnd = function (e) {\n            if (!_this.flag) {\n                return;\n            }\n            var _a = _this.options, pinchOutside = _a.pinchOutside, container = _a.container, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickEventOnDragStart = _a.preventClickEventOnDragStart, preventClickEventByCondition = _a.preventClickEventByCondition;\n            var isDrag = _this.isDrag;\n            if (preventClickEventOnDrag || preventClickEventOnDragStart || preventClickEventByCondition) {\n                requestAnimationFrame(function () {\n                    _this._allowClickEvent();\n                });\n            }\n            if (!preventClickEventByCondition && !preventClickEventOnDragStart && preventClickEventOnDrag && !isDrag) {\n                _this._allowClickEvent();\n            }\n            if (_this._useTouch && pinchOutside) {\n                removeEvent(container, \"touchstart\", _this.onDragStart);\n            }\n            if (_this.pinchFlag) {\n                _this.onPinchEnd(e);\n            }\n            var clients = (e === null || e === void 0 ? void 0 : e.touches) ? getEventClients(e) : [];\n            var clientsLength = clients.length;\n            if (clientsLength === 0 || !_this.options.keepDragging) {\n                _this.flag = false;\n            }\n            else {\n                _this._addStore(new ClientStore(clients));\n            }\n            var position = _this._getPosition();\n            var currentTime = now();\n            var isDouble = !isDrag && _this.doubleFlag;\n            _this._prevInputEvent = null;\n            _this.prevTime = isDrag || isDouble ? 0 : currentTime;\n            if (!_this.flag) {\n                _this._dettachDragEvent();\n                _this._preventMouseEvent || _this.emit(\"dragEnd\", __assign({ data: _this.data, datas: _this.data, isDouble: isDouble, isDrag: isDrag, isClick: !isDrag, isMouseEvent: _this._isMouseEvent, isSecondaryButton: _this._isSecondaryButton, inputEvent: e, isTrusted: _this._isTrusted }, position));\n                _this.clientStores = [];\n                if (!_this._isMouseEvent) {\n                    _this._preventMouseEvent = true;\n                    // Prevent the problem of touch event and mouse event occurring simultaneously\n                    clearTimeout(_this._preventMouseEventId);\n                    _this._preventMouseEventId = setTimeout(function () {\n                        _this._preventMouseEvent = false;\n                    }, 200);\n                }\n                _this._isIdle = true;\n            }\n        };\n        _this.onBlur = function () {\n            _this.onDragEnd();\n        };\n        _this._allowClickEvent = function () {\n            removeEvent(_this._window, \"click\", _this._onClick, true);\n        };\n        _this._onClick = function (e) {\n            _this._allowClickEvent();\n            _this._allowMouseEvent();\n            var preventClickEventByCondition = _this.options.preventClickEventByCondition;\n            if (preventClickEventByCondition === null || preventClickEventByCondition === void 0 ? void 0 : preventClickEventByCondition(e)) {\n                return;\n            }\n            e.stopPropagation();\n            e.preventDefault();\n        };\n        _this._onContextMenu = function (e) {\n            var options = _this.options;\n            if (!options.preventRightClick) {\n                e.preventDefault();\n            }\n            else {\n                _this.onDragEnd(e);\n            }\n        };\n        _this._passCallback = function () { };\n        var elements = [].concat(targets);\n        var firstTarget = elements[0];\n        _this._window = isWindow(firstTarget) ? firstTarget : getWindow(firstTarget);\n        _this.options = __assign({ checkInput: false, container: firstTarget && !(\"document\" in firstTarget) ? getWindow(firstTarget) : firstTarget, preventRightClick: true, preventWheelClick: true, preventClickEventOnDragStart: false, preventClickEventOnDrag: false, preventClickEventByCondition: null, preventDefault: true, checkWindowBlur: false, keepDragging: false, pinchThreshold: 0, events: [\"touch\", \"mouse\"] }, options);\n        var _a = _this.options, container = _a.container, events = _a.events, checkWindowBlur = _a.checkWindowBlur;\n        _this._useDrag = events.indexOf(\"drag\") > -1;\n        _this._useTouch = events.indexOf(\"touch\") > -1;\n        _this._useMouse = events.indexOf(\"mouse\") > -1;\n        _this.targets = elements;\n        if (_this._useDrag) {\n            elements.forEach(function (el) {\n                addEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (_this._useMouse) {\n            elements.forEach(function (el) {\n                addEvent(el, \"mousedown\", _this.onDragStart);\n                addEvent(el, \"mousemove\", _this._passCallback);\n            });\n            addEvent(container, \"contextmenu\", _this._onContextMenu);\n        }\n        if (checkWindowBlur) {\n            addEvent(getWindow(), \"blur\", _this.onBlur);\n        }\n        if (_this._useTouch) {\n            var passive_1 = {\n                passive: false,\n            };\n            elements.forEach(function (el) {\n                addEvent(el, \"touchstart\", _this.onDragStart, passive_1);\n                addEvent(el, \"touchmove\", _this._passCallback, passive_1);\n            });\n        }\n        return _this;\n    }\n    /**\n     * Stop Gesto's drag events.\n     */\n    Gesto.prototype.stop = function () {\n        this.isDrag = false;\n        this.data = {};\n        this.clientStores = [];\n        this.pinchFlag = false;\n        this.doubleFlag = false;\n        this.prevTime = 0;\n        this.flag = false;\n        this._isIdle = true;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n        this._isDragAPI = false;\n    };\n    /**\n     * The total moved distance\n     */\n    Gesto.prototype.getMovement = function (clients) {\n        return this.getCurrentStore().getMovement(clients) + this.clientStores.slice(1).reduce(function (prev, cur) {\n            return prev + cur.movement;\n        }, 0);\n    };\n    /**\n     * Whether to drag\n     */\n    Gesto.prototype.isDragging = function () {\n        return this.isDrag;\n    };\n    /**\n     * Whether the operation of gesto is finished and is in idle state\n     */\n    Gesto.prototype.isIdle = function () {\n        return this._isIdle;\n    };\n    /**\n     * Whether to start drag\n     */\n    Gesto.prototype.isFlag = function () {\n        return this.flag;\n    };\n    /**\n     * Whether to start pinch\n     */\n    Gesto.prototype.isPinchFlag = function () {\n        return this.pinchFlag;\n    };\n    /**\n     * Whether to start double click\n     */\n    Gesto.prototype.isDoubleFlag = function () {\n        return this.doubleFlag;\n    };\n    /**\n     * Whether to pinch\n     */\n    Gesto.prototype.isPinching = function () {\n        return this.isPinch;\n    };\n    /**\n     * If a scroll event occurs, it is corrected by the scroll distance.\n     */\n    Gesto.prototype.scrollBy = function (deltaX, deltaY, e, isCallDrag) {\n        if (isCallDrag === void 0) { isCallDrag = true; }\n        if (!this.flag) {\n            return;\n        }\n        this.clientStores[0].move(deltaX, deltaY);\n        isCallDrag && this.onDrag(e, true);\n    };\n    /**\n     * Create a virtual drag event.\n     */\n    Gesto.prototype.move = function (_a, inputEvent) {\n        var deltaX = _a[0], deltaY = _a[1];\n        var store = this.getCurrentStore();\n        var nextClients = store.prevClients;\n        return this.moveClients(nextClients.map(function (_a) {\n            var clientX = _a.clientX, clientY = _a.clientY;\n            return {\n                clientX: clientX + deltaX,\n                clientY: clientY + deltaY,\n                originalClientX: clientX,\n                originalClientY: clientY,\n            };\n        }), inputEvent, true);\n    };\n    /**\n     * The dragStart event is triggered by an external event.\n     */\n    Gesto.prototype.triggerDragStart = function (e) {\n        this.onDragStart(e, false);\n    };\n    /**\n     * Set the event data while dragging.\n     */\n    Gesto.prototype.setEventData = function (data) {\n        var currentData = this.data;\n        for (var name_1 in data) {\n            currentData[name_1] = data[name_1];\n        }\n        return this;\n    };\n    /**\n     * Set the event data while dragging.\n     * Use `setEventData`\n     * @deprecated\n     */\n    Gesto.prototype.setEventDatas = function (data) {\n        return this.setEventData(data);\n    };\n    /**\n     * Get the current event state while dragging.\n     */\n    Gesto.prototype.getCurrentEvent = function (inputEvent) {\n        if (inputEvent === void 0) { inputEvent = this._prevInputEvent; }\n        return __assign(__assign({ data: this.data, datas: this.data }, this._getPosition()), { movement: this.getMovement(), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, inputEvent: inputEvent });\n    };\n    /**\n     * Get & Set the event data while dragging.\n     */\n    Gesto.prototype.getEventData = function () {\n        return this.data;\n    };\n    /**\n     * Get & Set the event data while dragging.\n     * Use getEventData method\n     * @depreacated\n     */\n    Gesto.prototype.getEventDatas = function () {\n        return this.data;\n    };\n    /**\n     * Unset Gesto\n     */\n    Gesto.prototype.unset = function () {\n        var _this = this;\n        var targets = this.targets;\n        var container = this.options.container;\n        this.off();\n        removeEvent(this._window, \"blur\", this.onBlur);\n        if (this._useDrag) {\n            targets.forEach(function (el) {\n                removeEvent(el, \"dragstart\", _this.onDragStart);\n            });\n        }\n        if (this._useMouse) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"mousedown\", _this.onDragStart);\n            });\n            removeEvent(container, \"contextmenu\", this._onContextMenu);\n        }\n        if (this._useTouch) {\n            targets.forEach(function (target) {\n                removeEvent(target, \"touchstart\", _this.onDragStart);\n            });\n            removeEvent(container, \"touchstart\", this.onDragStart);\n        }\n        this._prevInputEvent = null;\n        this._allowClickEvent();\n        this._dettachDragEvent();\n    };\n    Gesto.prototype.onPinchStart = function (e) {\n        var _this = this;\n        var pinchThreshold = this.options.pinchThreshold;\n        if (this.isDrag && this.getMovement() > pinchThreshold) {\n            return;\n        }\n        var store = new ClientStore(getEventClients(e));\n        this.pinchFlag = true;\n        this._addStore(store);\n        var result = this.emit(\"pinchStart\", __assign(__assign({ data: this.data, datas: this.data, angle: store.getAngle(), touches: this.getCurrentStore().getPositions() }, store.getPosition()), { inputEvent: e, isTrusted: this._isTrusted, preventDefault: function () {\n                e.preventDefault();\n            }, preventDrag: function () {\n                _this._dragFlag = false;\n            } }));\n        if (result === false) {\n            this.pinchFlag = false;\n        }\n    };\n    Gesto.prototype.onPinch = function (e, clients) {\n        if (!this.flag || !this.pinchFlag || clients.length < 2) {\n            return;\n        }\n        var store = this.getCurrentStore();\n        this.isPinch = true;\n        this.emit(\"pinch\", __assign(__assign({ data: this.data, datas: this.data, movement: this.getMovement(clients), angle: store.getAngle(clients), rotation: store.getRotation(clients), touches: store.getPositions(clients), scale: store.getScale(clients), distance: store.getDistance(clients) }, store.getPosition(clients)), { inputEvent: e, isTrusted: this._isTrusted }));\n    };\n    Gesto.prototype.onPinchEnd = function (e) {\n        if (!this.pinchFlag) {\n            return;\n        }\n        var isPinch = this.isPinch;\n        this.isPinch = false;\n        this.pinchFlag = false;\n        var store = this.getCurrentStore();\n        this.emit(\"pinchEnd\", __assign(__assign({ data: this.data, datas: this.data, isPinch: isPinch, touches: store.getPositions() }, store.getPosition()), { inputEvent: e }));\n    };\n    Gesto.prototype.getCurrentStore = function () {\n        return this.clientStores[0];\n    };\n    Gesto.prototype.moveClients = function (clients, inputEvent, isAdd) {\n        var position = this._getPosition(clients, isAdd);\n        var isPrevDrag = this.isDrag;\n        if (position.deltaX || position.deltaY) {\n            this.isDrag = true;\n        }\n        var isFirstDrag = false;\n        if (!isPrevDrag && this.isDrag) {\n            isFirstDrag = true;\n        }\n        return __assign(__assign({ data: this.data, datas: this.data }, position), { movement: this.getMovement(clients), isDrag: this.isDrag, isPinch: this.isPinch, isScroll: false, isMouseEvent: this._isMouseEvent, isSecondaryButton: this._isSecondaryButton, inputEvent: inputEvent, isTrusted: this._isTrusted, isFirstDrag: isFirstDrag });\n    };\n    Gesto.prototype._addStore = function (store) {\n        this.clientStores.splice(0, 0, store);\n    };\n    Gesto.prototype._getPosition = function (clients, isAdd) {\n        var store = this.getCurrentStore();\n        var position = store.getPosition(clients, isAdd);\n        var _a = this.clientStores.slice(1).reduce(function (prev, cur) {\n            var storePosition = cur.getPosition();\n            prev.distX += storePosition.distX;\n            prev.distY += storePosition.distY;\n            return prev;\n        }, position), distX = _a.distX, distY = _a.distY;\n        return __assign(__assign({}, position), { distX: distX, distY: distY });\n    };\n    Gesto.prototype._attchDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        var passive = {\n            passive: false\n        };\n        if (this._isDragAPI) {\n            addEvent(container, \"dragover\", this.onDrag, passive);\n            addEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            addEvent(container, \"mousemove\", this.onDrag);\n            addEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            addEvent(container, \"touchmove\", this.onDrag, passive);\n            addEvent(win, \"touchend\", this.onDragEnd, passive);\n            addEvent(win, \"touchcancel\", this.onDragEnd, passive);\n        }\n    };\n    Gesto.prototype._dettachDragEvent = function () {\n        var win = this._window;\n        var container = this.options.container;\n        if (this._isDragAPI) {\n            removeEvent(container, \"dragover\", this.onDrag);\n            removeEvent(win, \"dragend\", this.onDragEnd);\n        }\n        if (this._useMouse) {\n            removeEvent(container, \"mousemove\", this.onDrag);\n            removeEvent(win, \"mouseup\", this.onDragEnd);\n        }\n        if (this._useTouch) {\n            removeEvent(container, \"touchstart\", this.onDragStart);\n            removeEvent(container, \"touchmove\", this.onDrag);\n            removeEvent(win, \"touchend\", this.onDragEnd);\n            removeEvent(win, \"touchcancel\", this.onDragEnd);\n        }\n    };\n    Gesto.prototype._allowMouseEvent = function () {\n        this._preventMouseEvent = false;\n        clearTimeout(this._preventMouseEventId);\n    };\n    return Gesto;\n}(EventEmitter));\n\nexport { Gesto as default };\n//# sourceMappingURL=gesto.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.0.8\n*/\nimport { getDocument, splitComma } from '@daybrush/utils';\n\nfunction hash(str) {\n  var hash = 5381,\n      i    = str.length;\n\n  while(i) {\n    hash = (hash * 33) ^ str.charCodeAt(--i);\n  }\n\n  /* JavaScript does bitwise operations (like XOR, above) on 32-bit signed\n   * integers. Since we want the results to be always positive, convert the\n   * signed int to an unsigned by doing an unsigned bitshift. */\n  return hash >>> 0;\n}\n\nvar stringHash = hash;\n\nfunction getHash(str) {\n  return stringHash(str).toString(36);\n}\nfunction getShadowRoot(parentElement) {\n  if (parentElement && parentElement.getRootNode) {\n    var rootNode = parentElement.getRootNode();\n    if (rootNode.nodeType === 11) {\n      return rootNode;\n    }\n  }\n  return;\n}\nfunction replaceStyle(className, css, options) {\n  if (options.original) {\n    return css;\n  }\n  return css.replace(/([^};{\\s}][^};{]*|^\\s*){/mg, function (_, selector) {\n    var trimmedSelector = selector.trim();\n    return (trimmedSelector ? splitComma(trimmedSelector) : [\"\"]).map(function (subSelector) {\n      var trimmedSubSelector = subSelector.trim();\n      if (trimmedSubSelector.indexOf(\"@\") === 0) {\n        return trimmedSubSelector;\n      } else if (trimmedSubSelector.indexOf(\":global\") > -1) {\n        return trimmedSubSelector.replace(/\\:global/g, \"\");\n      } else if (trimmedSubSelector.indexOf(\":host\") > -1) {\n        return \"\".concat(trimmedSubSelector.replace(/\\:host/g, \".\".concat(className)));\n      } else if (trimmedSubSelector) {\n        return \".\".concat(className, \" \").concat(trimmedSubSelector);\n      } else {\n        return \".\".concat(className);\n      }\n    }).join(\", \") + \" {\";\n  });\n}\nfunction injectStyle(className, css, options, el, shadowRoot) {\n  var doc = getDocument(el);\n  var style = doc.createElement(\"style\");\n  style.setAttribute(\"type\", \"text/css\");\n  style.setAttribute(\"data-styled-id\", className);\n  style.setAttribute(\"data-styled-count\", \"1\");\n  if (options.nonce) {\n    style.setAttribute(\"nonce\", options.nonce);\n  }\n  style.innerHTML = replaceStyle(className, css, options);\n  (shadowRoot || doc.head || doc.body).appendChild(style);\n  return style;\n}\n\n/**\n * Create an styled object that can be defined and inserted into the css.\n * @param - css styles\n */\nfunction styled(css) {\n  var injectClassName = \"rCS\" + getHash(css);\n  return {\n    className: injectClassName,\n    inject: function (el, options) {\n      if (options === void 0) {\n        options = {};\n      }\n      var shadowRoot = getShadowRoot(el);\n      var styleElement = (shadowRoot || el.ownerDocument || document).querySelector(\"style[data-styled-id=\\\"\".concat(injectClassName, \"\\\"]\"));\n      if (!styleElement) {\n        styleElement = injectStyle(injectClassName, css, options, el, shadowRoot);\n      } else {\n        var count = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n        styleElement.setAttribute(\"data-styled-count\", \"\".concat(count + 1));\n      }\n      return {\n        destroy: function () {\n          var _a;\n          var injectCount = parseFloat(styleElement.getAttribute(\"data-styled-count\")) || 0;\n          if (injectCount <= 1) {\n            if (styleElement.remove) {\n              styleElement.remove();\n            } else {\n              (_a = styleElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(styleElement);\n            }\n            styleElement = null;\n          } else {\n            styleElement.setAttribute(\"data-styled-count\", \"\".concat(injectCount - 1));\n          }\n        }\n      };\n    }\n  };\n}\n\nexport default styled;\n//# sourceMappingURL=styled.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: croact-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/css-styled.git\nversion: 1.1.9\n*/\nimport cssStyled from 'css-styled';\nimport { version, createElement, forwardRef, useRef, useImperativeHandle, useEffect, Component } from 'croact';\nimport { ref } from 'framework-utils';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-css-styled\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/css-styled/tree/master/packages/react-css-styled\nversion: 1.1.9\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n/* global Reflect, Promise */\n\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n  return extendStatics(d, b);\n};\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() {\n    this.constructor = d;\n  }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nvar StyledElement = /*#__PURE__*/function (_super) {\n  __extends(StyledElement, _super);\n  function StyledElement() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.injectResult = null;\n    _this.tag = \"div\";\n    return _this;\n  }\n  var __proto = StyledElement.prototype;\n  __proto.render = function () {\n    var _a = this.props,\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      cspNonce = _a.cspNonce,\n      portalContainer = _a.portalContainer,\n      attributes = __rest(_a, [\"className\", \"cspNonce\", \"portalContainer\"]);\n    var cssId = this.injector.className;\n    var Tag = this.tag;\n    var portalAttributes = {};\n    if ((version || \"\").indexOf(\"simple\") > -1 && portalContainer) {\n      portalAttributes = {\n        portalContainer: portalContainer\n      };\n    }\n    return createElement(Tag, __assign(__assign({\n      \"ref\": ref(this, \"element\"),\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, portalAttributes), attributes));\n  };\n  __proto.componentDidMount = function () {\n    this.injectResult = this.injector.inject(this.element, {\n      nonce: this.props.cspNonce\n    });\n  };\n  __proto.componentWillUnmount = function () {\n    this.injectResult.destroy();\n    this.injectResult = null;\n  };\n  __proto.getElement = function () {\n    return this.element;\n  };\n  return StyledElement;\n}(Component);\nfunction defaultStyled(tag, css) {\n  var injector = cssStyled(css);\n  return /*#__PURE__*/function (_super) {\n    __extends(Styled, _super);\n    function Styled() {\n      var _this = _super !== null && _super.apply(this, arguments) || this;\n      _this.injector = injector;\n      _this.tag = tag;\n      return _this;\n    }\n    return Styled;\n  }(StyledElement);\n}\nfunction styled(Tag, css) {\n  var injector = cssStyled(css);\n  var cssId = injector.className;\n  return forwardRef(function (props, ref) {\n    var _a = props.className,\n      className = _a === void 0 ? \"\" : _a,\n      cspNonce = props.cspNonce,\n      attributes = __rest(props, [\"className\", \"cspNonce\"]);\n    var targetRef = useRef();\n    useImperativeHandle(ref, function () {\n      return targetRef.current;\n    }, []);\n    useEffect(function () {\n      var injectResult = injector.inject(targetRef.current, {\n        nonce: props.cspNonce\n      });\n      return function () {\n        injectResult.destroy();\n      };\n    }, []);\n    return createElement(Tag, __assign({\n      \"ref\": targetRef,\n      \"data-styled-id\": cssId,\n      \"className\": \"\".concat(className, \" \").concat(cssId)\n    }, attributes));\n  });\n}\n\nexport default defaultStyled;\nexport { StyledElement, styled };\n","/*\nCopyright (c) 2019 Daybrush\nname: croact-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/croact-moveable\nversion: 0.9.0\n*/\nimport getAgent from '@egjs/agent';\nimport { prefixNames, prefixCSS, ref, withMethods, refs } from 'framework-utils';\nimport { getRad, throttle, throttleArray, isString, calculateBoundSize, getKeys, isArray, hasClass, getDist as getDist$1, isObject, decamelize, convertUnitSize, pushSet, find, findIndex, splitSpace, isNumber, isNode, isFunction, isWindow, counter, dot, addClass, requestAnimationFrame, splitBracket, splitComma, splitUnit, cancelAnimationFrame, removeClass, getWindow, TINY_NUM as TINY_NUM$1, flat as flat$1, isUndefined, getDocumentBody, between, getDocumentElement, average } from '@daybrush/utils';\nimport { plus, minus, convertDimension, calculate, convertPositionMatrix, ignoreDimension, invert, createIdentityMatrix, createWarpMatrix, multiply, fromTranslation, createRotateMatrix, getOrigin, rotate, multiplies, createOriginMatrix, convertMatrixtoCSS, createScaleMatrix, convertCSStoMatrix } from '@scena/matrix';\nimport { parseMat, parse, toMat, calculateMatrixDist } from 'css-to-mat';\nimport ChildrenDiffer, { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport { getMinMaxs, fitPoints, getOverlapSize, getAreaSize, isInside, getIntersectionPointsByConstants } from 'overlap-area';\nimport * as React from 'croact';\nimport { createElement } from 'croact';\nimport Gesto from 'gesto';\nimport { styled } from 'croact-css-styled';\nimport EventEmitter from '@scena/event-emitter';\nimport { diff as diff$1 } from '@egjs/list-differ';\n\n/*\nCopyright (c) 2019 Daybrush\nname: react-moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/react-moveable\nversion: 0.56.0\n*/\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nfunction makeAble(name, able) {\r\n    return __assign({ events: [], props: [], name: name }, able);\r\n}\n\nvar DIRECTIONS4 = [\"n\", \"w\", \"s\", \"e\"];\r\nvar DIRECTIONS = [\"n\", \"w\", \"s\", \"e\", \"nw\", \"ne\", \"sw\", \"se\"];\r\nfunction getSVGCursor(scale, degree) {\r\n    return \"data:image/svg+xml;utf8,<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"\".concat(32 * scale, \"px\\\" height=\\\"\").concat(32 * scale, \"px\\\" viewBox=\\\"0 0 32 32\\\" ><path d=\\\"M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z\\\" stroke-linejoin=\\\"round\\\" stroke-width=\\\"1.2\\\" fill=\\\"black\\\" stroke=\\\"white\\\" style=\\\"transform:rotate(\").concat(degree, \"deg);transform-origin: 16px 16px\\\"></path></svg>\");\r\n}\r\nfunction getCursorCSS(degree) {\r\n    var x1 = getSVGCursor(1, degree);\r\n    // const x2 = getSVGCursor(2, degree);\r\n    var degree45 = (Math.round(degree / 45) * 45) % 180;\r\n    var defaultCursor = \"ns-resize\";\r\n    if (degree45 === 135) {\r\n        defaultCursor = \"nwse-resize\";\r\n    }\r\n    else if (degree45 === 45) {\r\n        defaultCursor = \"nesw-resize\";\r\n    }\r\n    else if (degree45 === 90) {\r\n        defaultCursor = \"ew-resize\";\r\n    }\r\n    // tslint:disable-next-line: max-line-length\r\n    return \"cursor:\".concat(defaultCursor, \";cursor: url('\").concat(x1, \"') 16 16, \").concat(defaultCursor, \";\");\r\n}\r\nvar agent = getAgent();\r\nvar IS_WEBKIT = agent.browser.webkit;\r\nvar IS_WEBKIT605 = IS_WEBKIT && (function () {\r\n    var navi = typeof window === \"undefined\" ? { userAgent: \"\" } : window.navigator;\r\n    var res = /applewebkit\\/([^\\s]+)/g.exec(navi.userAgent.toLowerCase());\r\n    return res ? parseFloat(res[1]) < 605 : false;\r\n})();\r\nvar browserName = agent.browser.name;\r\nvar browserVersion = parseInt(agent.browser.version, 10);\r\nvar IS_CHROME = browserName === \"chrome\";\r\nvar IS_CHROMIUM = agent.browser.chromium;\r\nvar chromiumVersion = parseInt(agent.browser.chromiumVersion, 10) || 0;\r\nvar IS_CHROMIUM109 = (IS_CHROME && browserVersion >= 109)\r\n    || (IS_CHROMIUM && chromiumVersion >= 109);\r\nvar IS_FIREFOX = browserName === \"firefox\";\r\nvar IS_SAFARI_ABOVE15 = parseInt(agent.browser.webkitVersion, 10) >= 612\r\n    || browserVersion >= 15;\r\nvar PREFIX = \"moveable-\";\r\nvar directionCSS = DIRECTIONS.map(function (dir) {\r\n    var top = \"\";\r\n    var left = \"\";\r\n    var originX = \"center\";\r\n    var originY = \"center\";\r\n    var offset = \"calc(var(--moveable-control-padding, 20) * -1px)\";\r\n    if (dir.indexOf(\"n\") > -1) {\r\n        top = \"top: \".concat(offset, \";\");\r\n        originY = \"bottom\";\r\n    }\r\n    if (dir.indexOf(\"s\") > -1) {\r\n        top = \"top: 0px;\";\r\n        originY = \"top\";\r\n    }\r\n    if (dir.indexOf(\"w\") > -1) {\r\n        left = \"left: \".concat(offset, \";\");\r\n        originX = \"right\";\r\n    }\r\n    if (dir.indexOf(\"e\") > -1) {\r\n        left = \"left: 0px;\";\r\n        originX = \"left\";\r\n    }\r\n    return \".around-control[data-direction*=\\\"\".concat(dir, \"\\\"] {\\n        \").concat(left).concat(top, \"\\n        transform-origin: \").concat(originX, \" \").concat(originY, \";\\n    }\");\r\n}).join(\"\\n\");\r\nvar MOVEABLE_CSS = \"\\n{\\nposition: absolute;\\nwidth: 1px;\\nheight: 1px;\\nleft: 0;\\ntop: 0;\\nz-index: 3000;\\n--moveable-color: #4af;\\n--zoom: 1;\\n--zoompx: 1px;\\n--moveable-line-padding: 0;\\n--moveable-control-padding: 0;\\nwill-change: transform;\\noutline: 1px solid transparent;\\n}\\n.control-box {\\nz-index: 0;\\n}\\n.line, .control {\\nposition: absolute;\\nleft: 0;\\ntop: 0;\\nwill-change: transform;\\n}\\n.control {\\nwidth: 14px;\\nheight: 14px;\\nborder-radius: 50%;\\nborder: 2px solid #fff;\\nbox-sizing: border-box;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\nmargin-top: -7px;\\nmargin-left: -7px;\\nborder: 2px solid #fff;\\nz-index: 10;\\n}\\n.around-control {\\nposition: absolute;\\nwill-change: transform;\\nwidth: calc(var(--moveable-control-padding, 20) * 1px);\\nheight: calc(var(--moveable-control-padding, 20) * 1px);\\nleft: calc(var(--moveable-control-padding, 20) * -0.5px);\\ntop: calc(var(--moveable-control-padding, 20) * -0.5px);\\nbox-sizing: border-box;\\nbackground: transparent;\\nz-index: 8;\\ncursor: alias;\\ntransform-origin: center center;\\n}\\n\".concat(directionCSS, \"\\n.padding {\\nposition: absolute;\\ntop: 0px;\\nleft: 0px;\\nwidth: 100px;\\nheight: 100px;\\ntransform-origin: 0 0;\\n}\\n.line {\\nwidth: 1px;\\nheight: 1px;\\nbackground: #4af;\\nbackground: var(--moveable-color);\\ntransform-origin: 0px 50%;\\n}\\n.line.edge {\\nz-index: 1;\\nbackground: transparent;\\n}\\n.line.dashed {\\nbox-sizing: border-box;\\nbackground: transparent;\\n}\\n.line.dashed.horizontal {\\nborder-top: 1px dashed #4af;\\nborder-top-color: #4af;\\nborder-top-color: var(--moveable-color);\\n}\\n.line.dashed.vertical {\\nborder-left: 1px dashed #4af;\\nborder-left-color: #4af;\\nborder-left-color: var(--moveable-color);\\n}\\n.line.vertical {\\ntransform: translateX(-50%);\\n}\\n.line.horizontal {\\ntransform: translateY(-50%);\\n}\\n.line.vertical.bold {\\nwidth: 2px;\\n}\\n.line.horizontal.bold {\\nheight: 2px;\\n}\\n\\n.control.origin {\\nborder-color: #f55;\\nbackground: #fff;\\nwidth: 12px;\\nheight: 12px;\\nmargin-top: -6px;\\nmargin-left: -6px;\\npointer-events: none;\\n}\\n\").concat([0, 15, 30, 45, 60, 75, 90, 105, 120, 135, 150, 165].map(function (degree) { return \"\\n.direction[data-rotation=\\\"\".concat(degree, \"\\\"], :global .view-control-rotation\").concat(degree, \" {\\n\").concat(getCursorCSS(degree), \"\\n}\\n\"); }).join(\"\\n\"), \"\\n\\n.line.direction:before {\\ncontent: \\\"\\\";\\nposition: absolute;\\nwidth: 100%;\\nheight: calc(var(--moveable-line-padding, 0) * 1px);\\nbottom: 0;\\nleft: 0;\\n}\\n.group {\\nz-index: -1;\\n}\\n.area {\\nposition: absolute;\\n}\\n.area-pieces {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\ndisplay: none;\\n}\\n.area.avoid, .area.pass {\\npointer-events: none;\\n}\\n.area.avoid+.area-pieces {\\ndisplay: block;\\n}\\n.area-piece {\\nposition: absolute;\\n}\\n\\n\").concat(IS_WEBKIT605 ? \":global svg *:before {\\ncontent:\\\"\\\";\\ntransform-origin: inherit;\\n}\" : \"\", \"\\n\");\r\nvar NEARBY_POS = [\r\n    [0, 1, 2],\r\n    [1, 0, 3],\r\n    [2, 0, 3],\r\n    [3, 1, 2],\r\n];\r\nvar FLOAT_POINT_NUM = 0.0001;\r\nvar TINY_NUM = 0.0000001;\r\nvar MIN_SCALE = 0.000000001;\r\nvar MAX_NUM = Math.pow(10, 10);\r\nvar MIN_NUM = -MAX_NUM;\r\nvar DIRECTION_REGION_TO_DIRECTION = {\r\n    n: [0, -1],\r\n    e: [1, 0],\r\n    s: [0, 1],\r\n    w: [-1, 0],\r\n    nw: [-1, -1],\r\n    ne: [1, -1],\r\n    sw: [-1, 1],\r\n    se: [1, 1],\r\n};\r\nvar DIRECTION_INDEXES = {\r\n    n: [0, 1],\r\n    e: [1, 3],\r\n    s: [3, 2],\r\n    w: [2, 0],\r\n    nw: [0],\r\n    ne: [1],\r\n    sw: [2],\r\n    se: [3],\r\n};\r\nvar DIRECTION_ROTATIONS = {\r\n    n: 0,\r\n    s: 180,\r\n    w: 270,\r\n    e: 90,\r\n    nw: 315,\r\n    ne: 45,\r\n    sw: 225,\r\n    se: 135,\r\n};\r\nvar MOVEABLE_METHODS = [\r\n    \"isMoveableElement\",\r\n    \"updateRect\",\r\n    \"updateTarget\",\r\n    \"destroy\",\r\n    \"dragStart\",\r\n    \"isInside\",\r\n    \"hitTest\",\r\n    \"setState\",\r\n    \"getRect\",\r\n    \"request\",\r\n    \"isDragging\",\r\n    \"getManager\",\r\n    \"forceUpdate\",\r\n    \"waitToChangeTarget\",\r\n    \"updateSelectors\",\r\n    \"getTargets\",\r\n    \"stopDrag\",\r\n    \"getControlBoxElement\",\r\n    \"getMoveables\",\r\n    \"getDragElement\",\r\n];\n\nfunction setCustomDrag(e, state, delta, isPinch, isConvert, ableName) {\r\n    var _a, _b;\r\n    if (ableName === void 0) { ableName = \"draggable\"; }\r\n    var result = (_b = (_a = state.gestos[ableName]) === null || _a === void 0 ? void 0 : _a.move(delta, e.inputEvent)) !== null && _b !== void 0 ? _b : {};\r\n    var datas = result.originalDatas || result.datas;\r\n    var ableDatas = datas[ableName] || (datas[ableName] = {});\r\n    return __assign(__assign({}, (isConvert ? convertDragDist(state, result) : result)), { isPinch: !!isPinch, parentEvent: true, datas: ableDatas, originalDatas: e.originalDatas });\r\n}\r\nvar CustomGesto = /*#__PURE__*/ (function () {\r\n    function CustomGesto(ableName) {\r\n        var _a;\r\n        if (ableName === void 0) { ableName = \"draggable\"; }\r\n        this.ableName = ableName;\r\n        this.prevX = 0;\r\n        this.prevY = 0;\r\n        this.startX = 0;\r\n        this.startY = 0;\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        this.datas = {\r\n            draggable: {},\r\n        };\r\n        this.datas = (_a = {},\r\n            _a[ableName] = {},\r\n            _a);\r\n    }\r\n    CustomGesto.prototype.dragStart = function (client, e) {\r\n        this.isDrag = false;\r\n        this.isFlag = false;\r\n        var originalDatas = e.originalDatas;\r\n        this.datas = originalDatas;\r\n        if (!originalDatas[this.ableName]) {\r\n            originalDatas[this.ableName] = {};\r\n        }\r\n        return __assign(__assign({}, this.move(client, e.inputEvent)), { type: \"dragstart\" });\r\n    };\r\n    CustomGesto.prototype.drag = function (client, inputEvent) {\r\n        return this.move([\r\n            client[0] - this.prevX,\r\n            client[1] - this.prevY,\r\n        ], inputEvent);\r\n    };\r\n    CustomGesto.prototype.move = function (delta, inputEvent) {\r\n        var clientX;\r\n        var clientY;\r\n        var isFirstDrag = false;\r\n        if (!this.isFlag) {\r\n            this.prevX = delta[0];\r\n            this.prevY = delta[1];\r\n            this.startX = delta[0];\r\n            this.startY = delta[1];\r\n            clientX = delta[0];\r\n            clientY = delta[1];\r\n            this.isFlag = true;\r\n        }\r\n        else {\r\n            var isPrevDrag = this.isDrag;\r\n            clientX = this.prevX + delta[0];\r\n            clientY = this.prevY + delta[1];\r\n            if (delta[0] || delta[1]) {\r\n                this.isDrag = true;\r\n            }\r\n            if (!isPrevDrag && this.isDrag) {\r\n                isFirstDrag = true;\r\n            }\r\n        }\r\n        this.prevX = clientX;\r\n        this.prevY = clientY;\r\n        return {\r\n            type: \"drag\",\r\n            clientX: clientX,\r\n            clientY: clientY,\r\n            inputEvent: inputEvent,\r\n            isFirstDrag: isFirstDrag,\r\n            isDrag: this.isDrag,\r\n            distX: clientX - this.startX,\r\n            distY: clientY - this.startY,\r\n            deltaX: delta[0],\r\n            deltaY: delta[1],\r\n            datas: this.datas[this.ableName],\r\n            originalDatas: this.datas,\r\n            parentEvent: true,\r\n            parentGesto: this,\r\n        };\r\n    };\r\n    return CustomGesto;\r\n}());\n\nfunction calculateElementPosition(matrix, origin, width, height) {\r\n    var is3d = matrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var _a = __read(poses, 4), _b = __read(_a[0], 2), x1 = _b[0], y1 = _b[1], _c = __read(_a[1], 2), x2 = _c[0], y2 = _c[1], _d = __read(_a[2], 2), x3 = _d[0], y3 = _d[1], _e = __read(_a[3], 2), x4 = _e[0], y4 = _e[1];\r\n    var _f = __read(calculatePosition(matrix, origin, n), 2), originX = _f[0], originY = _f[1];\r\n    var left = Math.min(x1, x2, x3, x4);\r\n    var top = Math.min(y1, y2, y3, y4);\r\n    var right = Math.max(x1, x2, x3, x4);\r\n    var bottom = Math.max(y1, y2, y3, y4);\r\n    x1 = (x1 - left) || 0;\r\n    x2 = (x2 - left) || 0;\r\n    x3 = (x3 - left) || 0;\r\n    x4 = (x4 - left) || 0;\r\n    y1 = (y1 - top) || 0;\r\n    y2 = (y2 - top) || 0;\r\n    y3 = (y3 - top) || 0;\r\n    y4 = (y4 - top) || 0;\r\n    originX = (originX - left) || 0;\r\n    originY = (originY - top) || 0;\r\n    var sx = matrix[0];\r\n    var sy = matrix[n + 1];\r\n    var direction = sign(sx * sy);\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        origin: [originX, originY],\r\n        pos1: [x1, y1],\r\n        pos2: [x2, y2],\r\n        pos3: [x3, y3],\r\n        pos4: [x4, y4],\r\n        direction: direction,\r\n    };\r\n}\n\nfunction calculatePointerDist(moveable, e) {\r\n    var clientX = e.clientX, clientY = e.clientY, datas = e.datas;\r\n    var _a = moveable.state, moveableClientRect = _a.moveableClientRect, rootMatrix = _a.rootMatrix, is3d = _a.is3d, pos1 = _a.pos1;\r\n    var left = moveableClientRect.left, top = moveableClientRect.top;\r\n    var n = is3d ? 4 : 3;\r\n    var _b = __read(minus(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), pos1), 2), posX = _b[0], posY = _b[1];\r\n    var _c = __read(getDragDist({ datas: datas, distX: posX, distY: posY }), 2), distX = _c[0], distY = _c[1];\r\n    return [distX, distY];\r\n}\r\nfunction setDragStart(moveable, _a) {\r\n    var datas = _a.datas;\r\n    var _b = moveable.state, allMatrix = _b.allMatrix, beforeMatrix = _b.beforeMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, origin = _b.origin, offsetMatrix = _b.offsetMatrix, targetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    datas.is3d = is3d;\r\n    datas.matrix = allMatrix;\r\n    datas.targetMatrix = targetMatrix;\r\n    datas.beforeMatrix = beforeMatrix;\r\n    datas.offsetMatrix = offsetMatrix;\r\n    datas.transformOrigin = transformOrigin;\r\n    datas.inverseMatrix = invert(allMatrix, n);\r\n    datas.inverseBeforeMatrix = invert(beforeMatrix, n);\r\n    datas.absoluteOrigin = convertPositionMatrix(plus([left, top], origin), n);\r\n    datas.startDragBeforeDist = calculate(datas.inverseBeforeMatrix, datas.absoluteOrigin, n);\r\n    datas.startDragDist = calculate(datas.inverseMatrix, datas.absoluteOrigin, n);\r\n}\r\nfunction getTransformDirection(e) {\r\n    return calculateElementPosition(e.datas.beforeTransform, [50, 50], 100, 100).direction;\r\n}\r\nfunction resolveTransformEvent(moveable, event, functionName) {\r\n    var datas = event.datas, originalDatas = event.originalDatas.beforeRenderable;\r\n    var index = datas.transformIndex;\r\n    var nextTransforms = originalDatas.nextTransforms;\r\n    var length = nextTransforms.length;\r\n    var nextTransformAppendedIndexes = originalDatas.nextTransformAppendedIndexes;\r\n    var nextIndex = -1;\r\n    if (index === -1) {\r\n        // translate => rotate => scale\r\n        if (functionName === \"translate\") {\r\n            nextIndex = 0;\r\n        }\r\n        else if (functionName === \"rotate\") {\r\n            nextIndex = findIndex(nextTransforms, function (text) { return text.match(/scale\\(/g); });\r\n        }\r\n        if (nextIndex === -1) {\r\n            nextIndex = nextTransforms.length;\r\n        }\r\n        datas.transformIndex = nextIndex;\r\n    }\r\n    else if (find(nextTransformAppendedIndexes, function (info) { return info.index === index && info.functionName === functionName; })) {\r\n        nextIndex = index;\r\n    }\r\n    else {\r\n        nextIndex = index + nextTransformAppendedIndexes.filter(function (info) { return info.index < index; }).length;\r\n    }\r\n    var result = convertTransformInfo(nextTransforms, moveable.state, nextIndex);\r\n    var targetFunction = result.targetFunction;\r\n    var matFunctionName = functionName === \"rotate\" ? \"rotateZ\" : functionName;\r\n    datas.beforeFunctionTexts = result.beforeFunctionTexts;\r\n    datas.afterFunctionTexts = result.afterFunctionTexts;\r\n    datas.beforeTransform = result.beforeFunctionMatrix;\r\n    datas.beforeTransform2 = result.beforeFunctionMatrix2;\r\n    datas.targetTansform = result.targetFunctionMatrix;\r\n    datas.afterTransform = result.afterFunctionMatrix;\r\n    datas.afterTransform2 = result.afterFunctionMatrix2;\r\n    datas.targetAllTransform = result.allFunctionMatrix;\r\n    if (targetFunction.functionName === matFunctionName) {\r\n        datas.afterFunctionTexts.splice(0, 1);\r\n        datas.isAppendTransform = false;\r\n    }\r\n    else if (length > nextIndex) {\r\n        datas.isAppendTransform = true;\r\n        originalDatas.nextTransformAppendedIndexes = __spreadArray(__spreadArray([], __read(nextTransformAppendedIndexes), false), [{\r\n                functionName: functionName,\r\n                index: nextIndex,\r\n                isAppend: true,\r\n            }], false);\r\n    }\r\n}\r\nfunction convertTransformFormat(datas, value, dist) {\r\n    return \"\".concat(datas.beforeFunctionTexts.join(\" \"), \" \").concat(datas.isAppendTransform ? dist : value, \" \").concat(datas.afterFunctionTexts.join(\" \"));\r\n}\r\nfunction getTransformDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var _b = __read(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), 2), bx = _b[0], by = _b[1];\r\n    // B * [tx, ty] * A = [bx, by] * targetMatrix;\r\n    // [tx, ty] = B-1 * [bx, by] * targetMatrix * A-1 * [0, 0];\r\n    var res = getTransfromMatrix(datas, fromTranslation([bx, by], 4));\r\n    return calculate(res, convertPositionMatrix([0, 0, 0], 4), 4);\r\n}\r\nfunction getTransfromMatrix(datas, targetMatrix, isAfter) {\r\n    var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform, beforeTransform2 = datas.beforeTransform2, afterTransform2 = datas.afterTransform2, targetAllTransform = datas.targetAllTransform;\r\n    // B * afterTargetMatrix * A = (targetMatrix * targetAllTransform)\r\n    // afterTargetMatrix = B-1 * targetMatrix * targetAllTransform * A-1\r\n    // nextTargetMatrix = (targetMatrix * targetAllTransform)\r\n    var nextTargetMatrix = isAfter\r\n        ? multiply(targetAllTransform, targetMatrix, 4)\r\n        : multiply(targetMatrix, targetAllTransform, 4);\r\n    // res1 = B-1 * nextTargetMatrix\r\n    var res1 = multiply(invert(isAfter ? beforeTransform2 : beforeTransform, 4), nextTargetMatrix, 4);\r\n    // res3 = res2 * A-1\r\n    var afterTargetMatrix = multiply(res1, invert(isAfter ? afterTransform2 : afterTransform, 4), 4);\r\n    return afterTargetMatrix;\r\n}\r\nfunction getBeforeDragDist(_a) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    // TT = BT\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    // ABS_ORIGIN * [distX, distY] = BM * (ORIGIN + [tx, ty])\r\n    // BM -1 * ABS_ORIGIN * [distX, distY] - ORIGIN = [tx, ty]\r\n    return minus(calculate(inverseBeforeMatrix, plus(absoluteOrigin, [distX, distY]), n), startDragBeforeDist);\r\n}\r\nfunction getDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var inverseBeforeMatrix = datas.inverseBeforeMatrix, inverseMatrix = datas.inverseMatrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? inverseBeforeMatrix : inverseMatrix, plus(absoluteOrigin, [distX, distY]), n), isBefore ? startDragBeforeDist : startDragDist);\r\n}\r\nfunction getInverseDragDist(_a, isBefore) {\r\n    var datas = _a.datas, distX = _a.distX, distY = _a.distY;\r\n    var beforeMatrix = datas.beforeMatrix, matrix = datas.matrix, is3d = datas.is3d, startDragBeforeDist = datas.startDragBeforeDist, startDragDist = datas.startDragDist, absoluteOrigin = datas.absoluteOrigin;\r\n    var n = is3d ? 4 : 3;\r\n    return minus(calculate(isBefore ? beforeMatrix : matrix, plus(isBefore ? startDragBeforeDist : startDragDist, [distX, distY]), n), absoluteOrigin);\r\n}\r\nfunction calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin) {\r\n    if (prevWidth === void 0) { prevWidth = width; }\r\n    if (prevHeight === void 0) { prevHeight = height; }\r\n    if (prevOrigin === void 0) { prevOrigin = [0, 0]; }\r\n    if (!transformOrigin) {\r\n        return prevOrigin;\r\n    }\r\n    return transformOrigin.map(function (pos, i) {\r\n        var _a = splitUnit(pos), value = _a.value, unit = _a.unit;\r\n        var prevSize = (i ? prevHeight : prevWidth);\r\n        var size = (i ? height : width);\r\n        if (pos === \"%\" || isNaN(value)) {\r\n            // no value but %\r\n            var measureRatio = prevSize ? prevOrigin[i] / prevSize : 0;\r\n            return size * measureRatio;\r\n        }\r\n        else if (unit !== \"%\") {\r\n            return value;\r\n        }\r\n        return size * value / 100;\r\n    });\r\n}\r\nfunction getPosIndexesByDirection(direction) {\r\n    var indexes = [];\r\n    if (direction[1] >= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(3);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(2);\r\n        }\r\n    }\r\n    if (direction[1] <= 0) {\r\n        if (direction[0] >= 0) {\r\n            indexes.push(1);\r\n        }\r\n        if (direction[0] <= 0) {\r\n            indexes.push(0);\r\n        }\r\n    }\r\n    return indexes;\r\n}\r\nfunction getPosesByDirection(poses, direction) {\r\n    /*\r\n    [-1, -1](pos1)       [0, -1](pos1,pos2)       [1, -1](pos2)\r\n    [-1, 0](pos1, pos3)                           [1, 0](pos2, pos4)\r\n    [-1, 1](pos3)        [0, 1](pos3, pos4)       [1, 1](pos4)\r\n    */\r\n    return getPosIndexesByDirection(direction).map(function (index) { return poses[index]; });\r\n}\r\nfunction getPosBySingleDirection(poses, direction) {\r\n    var ratio = (direction + 1) / 2;\r\n    return [\r\n        dot(poses[0][0], poses[1][0], ratio, 1 - ratio),\r\n        dot(poses[0][1], poses[1][1], ratio, 1 - ratio),\r\n    ];\r\n}\r\nfunction getPosByDirection(poses, direction) {\r\n    var top = getPosBySingleDirection([poses[0], poses[1]], direction[0]);\r\n    var bottom = getPosBySingleDirection([poses[2], poses[3]], direction[0]);\r\n    return getPosBySingleDirection([top, bottom], direction[1]);\r\n}\r\nfunction getDist(startPos, matrix, width, height, n, fixedDirection) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    var fixedPos = getPosByDirection(poses, fixedDirection);\r\n    var distX = startPos[0] - fixedPos[0];\r\n    var distY = startPos[1] - fixedPos[1];\r\n    return [distX, distY];\r\n}\r\nfunction getNextMatrix(offsetMatrix, targetMatrix, origin, n) {\r\n    return multiply(offsetMatrix, getAbsoluteMatrix(targetMatrix, n, origin), n);\r\n}\r\nfunction getNextTransformMatrix(state, datas, transform, isAllTransform) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var targetTransform;\r\n    if (isString(transform)) {\r\n        var beforeTransform = datas.beforeTransform, afterTransform = datas.afterTransform;\r\n        if (isAllTransform) {\r\n            targetTransform = convertDimension(parseMat(transform), 4, n);\r\n        }\r\n        else {\r\n            targetTransform = convertDimension(multiply(multiply(beforeTransform, parseMat([transform]), 4), afterTransform, 4), 4, n);\r\n        }\r\n    }\r\n    else {\r\n        targetTransform = transform;\r\n    }\r\n    return getNextMatrix(offsetMatrix, targetTransform, transformOrigin, n);\r\n}\r\nfunction scaleMatrix(state, scale) {\r\n    var transformOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, targetMatrix = state.targetMatrix, targetAllTransform = state.targetAllTransform;\r\n    var n = is3d ? 4 : 3;\r\n    return getNextMatrix(offsetMatrix, multiply(targetAllTransform || targetMatrix, createScaleMatrix(scale, n), n), transformOrigin, n);\r\n}\r\nfunction fillTransformStartEvent(moveable, e) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    return {\r\n        setTransform: function (transform, index) {\r\n            if (index === void 0) { index = -1; }\r\n            originalDatas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n        setTransformIndex: function (index) {\r\n            setTransformIndex(moveable, e, index);\r\n        },\r\n    };\r\n}\r\nfunction setDefaultTransformIndex(moveable, e, property) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var startTransforms = originalDatas.startTransforms;\r\n    setTransformIndex(moveable, e, findIndex(startTransforms, function (func) { return func.indexOf(\"\".concat(property, \"(\")) === 0; }));\r\n}\r\nfunction setTransformIndex(moveable, e, index) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    var datas = e.datas;\r\n    datas.transformIndex = index;\r\n    if (index === -1) {\r\n        return;\r\n    }\r\n    var transform = originalDatas.startTransforms[index];\r\n    if (!transform) {\r\n        return;\r\n    }\r\n    var state = moveable.state;\r\n    var info = parse([transform], {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    datas.startValue = info[0].functionValue;\r\n}\r\nfunction fillOriginalTransform(e, transform) {\r\n    var originalDatas = getBeforeRenderableDatas(e);\r\n    originalDatas.nextTransforms = splitSpace(transform);\r\n    // originalDatas.nextTargetMatrix = parseMat(transform);\r\n}\r\nfunction getBeforeRenderableDatas(e) {\r\n    return e.originalDatas.beforeRenderable;\r\n}\r\nfunction getNextTransforms(e) {\r\n    var originalDatas = e.originalDatas.beforeRenderable;\r\n    return originalDatas.nextTransforms;\r\n}\r\nfunction getNextTransformText(e) {\r\n    return (getNextTransforms(e) || []).join(\" \");\r\n}\r\nfunction getNextStyle(e) {\r\n    return getBeforeRenderableDatas(e).nextStyle;\r\n}\r\nfunction fillTransformEvent(moveable, nextTransform, delta, isPinch, e) {\r\n    fillOriginalTransform(e, nextTransform);\r\n    var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, delta, isPinch, false));\r\n    var afterTransform = drag ? drag.transform : nextTransform;\r\n    return __assign(__assign({ transform: nextTransform, drag: drag }, fillCSSObject({\r\n        transform: afterTransform,\r\n    }, e)), { afterTransform: afterTransform });\r\n}\r\nfunction getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform) {\r\n    var nextMatrix = getNextTransformMatrix(moveable.state, datas, transform, isAllTransform);\r\n    var nextFixedPosition = getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix);\r\n    return nextFixedPosition;\r\n}\r\nfunction getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var nextFixedPosition = getTranslateFixedPosition(moveable, transform, fixedDirection, fixedOffset, datas, isAllTransform);\r\n    var state = moveable.state;\r\n    var left = state.left, top = state.top;\r\n    var groupable = moveable.props.groupable;\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var dist = minus(fixedPosition, nextFixedPosition);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getScaleDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform) {\r\n    var dist = getTranslateDist(moveable, transform, fixedDirection, fixedPosition, fixedOffset, datas, isAllTransform);\r\n    return dist;\r\n}\r\nfunction getDirectionByPos(pos, width, height) {\r\n    return [\r\n        width ? -1 + pos[0] / (width / 2) : 0,\r\n        height ? -1 + pos[1] / (height / 2) : 0,\r\n    ];\r\n}\r\nfunction getDirectionOffset(moveable, fixedDirection, fixedOffset, nextMatrix) {\r\n    if (nextMatrix === void 0) { nextMatrix = moveable.state.allMatrix; }\r\n    var _a = moveable.state, width = _a.width, height = _a.height, is3d = _a.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedOffsetPosition = [\r\n        width / 2 * (1 + fixedDirection[0]) + fixedOffset[0],\r\n        height / 2 * (1 + fixedDirection[1]) + fixedOffset[1],\r\n    ];\r\n    return calculatePosition(nextMatrix, fixedOffsetPosition, n);\r\n}\r\nfunction getRotateDist(moveable, rotateDist, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var fixedPosition = datas.fixedPosition;\r\n    var fixedOffset = datas.fixedOffset;\r\n    return getTranslateDist(moveable, \"rotate(\".concat(rotateDist, \"deg)\"), fixedDirection, fixedPosition, fixedOffset, datas);\r\n}\r\nfunction getResizeDist(moveable, width, height, fixedPosition, transformOrigin, datas) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var prevOrigin = state.transformOrigin, offsetMatrix = state.offsetMatrix, is3d = state.is3d, prevWidth = state.width, prevHeight = state.height, left = state.left, top = state.top;\r\n    var fixedDirection = datas.fixedDirection;\r\n    var targetMatrix = datas.nextTargetMatrix || state.targetMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    var nextOrigin = calculateTransformOrigin(transformOrigin, width, height, prevWidth, prevHeight, prevOrigin);\r\n    var groupLeft = groupable ? left : 0;\r\n    var groupTop = groupable ? top : 0;\r\n    var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, nextOrigin, n);\r\n    var dist = getDist(fixedPosition, nextMatrix, width, height, n, fixedDirection);\r\n    return minus(dist, [groupLeft, groupTop]);\r\n}\r\nfunction getAbsolutePosition(moveable, direction) {\r\n    return getPosByDirection(getAbsolutePosesByState(moveable.state), direction);\r\n}\n\nfunction getGestoData(moveable, ableName) {\r\n    var targetGesto = moveable.targetGesto;\r\n    var controlGesto = moveable.controlGesto;\r\n    var data;\r\n    if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n        data = targetGesto.getEventData()[ableName];\r\n    }\r\n    if (!data && (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())) {\r\n        data = controlGesto.getEventData()[ableName];\r\n    }\r\n    return data || {};\r\n}\n\nfunction getShadowRoot(parentElement) {\r\n    if (parentElement && parentElement.getRootNode) {\r\n        var rootNode = parentElement.getRootNode();\r\n        if (rootNode.nodeType === 11) {\r\n            return rootNode;\r\n        }\r\n    }\r\n    return;\r\n}\r\nfunction getIndividualTransforms(getStyle) {\r\n    var scale = getStyle(\"scale\");\r\n    var rotate = getStyle(\"rotate\");\r\n    var translate = getStyle(\"translate\");\r\n    var individualTransforms = [];\r\n    if (translate && translate !== \"0px\" && translate !== \"none\") {\r\n        individualTransforms.push(\"translate(\".concat(translate.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    if (rotate && rotate !== \"1\" && rotate !== \"none\") {\r\n        individualTransforms.push(\"rotate(\".concat(rotate, \")\"));\r\n    }\r\n    if (scale && scale !== \"1\" && scale !== \"none\") {\r\n        individualTransforms.push(\"scale(\".concat(scale.split(/\\s+/).join(\",\"), \")\"));\r\n    }\r\n    return individualTransforms;\r\n}\r\nfunction getMatrixStackInfo(target, container, checkContainer) {\r\n    var el = target;\r\n    var matrixes = [];\r\n    var documentElement = getDocumentElement(target) || getDocumentBody(target);\r\n    var requestEnd = !checkContainer && target === container || target === documentElement;\r\n    var isEnd = requestEnd;\r\n    var is3d = false;\r\n    var n = 3;\r\n    var transformOrigin;\r\n    var targetTransformOrigin;\r\n    var targetMatrix;\r\n    var hasFixed = false;\r\n    var offsetContainer = getOffsetInfo(container, container, true).offsetParent;\r\n    var zoom = 1;\r\n    while (el && !isEnd) {\r\n        isEnd = requestEnd;\r\n        var getStyle = getCachedStyle(el);\r\n        var position = getStyle(\"position\");\r\n        var transform = getElementTransform(el);\r\n        var isFixed = position === \"fixed\";\r\n        var individualTransforms = getIndividualTransforms(getStyle);\r\n        var matrix = convertCSStoMatrix(getTransformMatrix(transform));\r\n        var offsetParent = void 0;\r\n        var isOffsetEnd = false;\r\n        var isStatic = false;\r\n        var parentClientLeft = 0;\r\n        var parentClientTop = 0;\r\n        var fixedClientLeft = 0;\r\n        var fixedClientTop = 0;\r\n        var fixedInfo = {\r\n            hasTransform: false,\r\n            fixedContainer: null,\r\n        };\r\n        if (isFixed) {\r\n            hasFixed = true;\r\n            fixedInfo = getPositionFixedInfo(el);\r\n            offsetContainer = fixedInfo.fixedContainer;\r\n        }\r\n        // convert 3 to 4\r\n        var length_1 = matrix.length;\r\n        if (!is3d && (length_1 === 16 || individualTransforms.length)) {\r\n            is3d = true;\r\n            n = 4;\r\n            convert3DMatrixes(matrixes);\r\n            if (targetMatrix) {\r\n                targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n            }\r\n        }\r\n        if (is3d && length_1 === 9) {\r\n            matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n        var _a = getOffsetPosInfo(el, target), tagName = _a.tagName, hasOffset = _a.hasOffset, isSVG = _a.isSVG, origin_1 = _a.origin, targetOrigin = _a.targetOrigin, offsetPos = _a.offset;\r\n        var _b = __read(offsetPos, 2), offsetLeft = _b[0], offsetTop = _b[1];\r\n        // no target with svg\r\n        if (tagName === \"svg\" && !el.ownerSVGElement && targetMatrix) {\r\n            // scale matrix for svg's SVGElements.\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getSVGMatrix(el, n),\r\n            });\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n        }\r\n        var targetZoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        if (isFixed) {\r\n            offsetParent = fixedInfo.fixedContainer;\r\n            isOffsetEnd = true;\r\n        }\r\n        else {\r\n            var offsetInfo = getOffsetInfo(el, container, false, true, getStyle);\r\n            var offsetZoom = offsetInfo.offsetZoom;\r\n            offsetParent = offsetInfo.offsetParent;\r\n            isOffsetEnd = offsetInfo.isEnd;\r\n            isStatic = offsetInfo.isStatic;\r\n            zoom *= offsetZoom;\r\n            if ((offsetInfo.isCustomElement || offsetZoom !== 1) && isStatic) {\r\n                offsetLeft -= offsetParent.offsetLeft;\r\n                offsetTop -= offsetParent.offsetTop;\r\n            }\r\n            else if (IS_FIREFOX || IS_CHROMIUM109) {\r\n                var parentSlotElement = offsetInfo.parentSlotElement;\r\n                if (parentSlotElement) {\r\n                    var customOffsetParent = offsetParent;\r\n                    var customOffsetLeft = 0;\r\n                    var customOffsetTop = 0;\r\n                    while (customOffsetParent) {\r\n                        if (!getShadowRoot(customOffsetParent)) {\r\n                            break;\r\n                        }\r\n                        customOffsetLeft += customOffsetParent.offsetLeft;\r\n                        customOffsetTop += customOffsetParent.offsetTop;\r\n                        customOffsetParent = customOffsetParent.offsetParent;\r\n                    }\r\n                    offsetLeft -= customOffsetLeft;\r\n                    offsetTop -= customOffsetTop;\r\n                }\r\n            }\r\n        }\r\n        if (IS_WEBKIT && !IS_SAFARI_ABOVE15\r\n            && hasOffset && !isSVG && isStatic\r\n            && (position === \"relative\" || position === \"static\")) {\r\n            offsetLeft -= offsetParent.offsetLeft;\r\n            offsetTop -= offsetParent.offsetTop;\r\n            requestEnd = requestEnd || isOffsetEnd;\r\n        }\r\n        if (isFixed) {\r\n            if (hasOffset && fixedInfo.hasTransform) {\r\n                // border\r\n                fixedClientLeft = offsetParent.clientLeft;\r\n                fixedClientTop = offsetParent.clientTop;\r\n            }\r\n        }\r\n        else {\r\n            if (hasOffset && offsetContainer !== offsetParent) {\r\n                // border\r\n                parentClientLeft = offsetParent.clientLeft;\r\n                parentClientTop = offsetParent.clientTop;\r\n            }\r\n            if (hasOffset && offsetParent === documentElement) {\r\n                var margin = getBodyOffset(el, false);\r\n                offsetLeft += margin[0];\r\n                offsetTop += margin[1];\r\n            }\r\n        }\r\n        matrixes.push({\r\n            type: \"target\",\r\n            target: el,\r\n            matrix: getAbsoluteMatrix(matrix, n, origin_1),\r\n        });\r\n        if (individualTransforms.length) {\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createIdentityMatrix(n),\r\n            });\r\n            matrixes.push({\r\n                type: \"target\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(parseMat(individualTransforms), n, origin_1),\r\n            });\r\n        }\r\n        if (hasOffset) {\r\n            var isElementTarget = el === target;\r\n            var scrollLeft = isElementTarget ? 0 : el.scrollLeft;\r\n            var scrollTop = isElementTarget ? 0 : el.scrollTop;\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                matrix: createOriginMatrix([\r\n                    offsetLeft - scrollLeft + parentClientLeft - fixedClientLeft,\r\n                    offsetTop - scrollTop + parentClientTop - fixedClientTop,\r\n                ], n),\r\n            });\r\n        }\r\n        else {\r\n            // svg\r\n            matrixes.push({\r\n                type: \"offset\",\r\n                target: el,\r\n                origin: origin_1,\r\n            });\r\n        }\r\n        // transform   zoom  (0, 0)   matrix .\r\n        if (targetZoom !== 1) {\r\n            matrixes.push({\r\n                type: \"zoom\",\r\n                target: el,\r\n                matrix: getAbsoluteMatrix(createScaleMatrix([targetZoom, targetZoom], n), n, [0, 0]),\r\n            });\r\n        }\r\n        if (!targetMatrix) {\r\n            targetMatrix = matrix;\r\n        }\r\n        if (!transformOrigin) {\r\n            transformOrigin = origin_1;\r\n        }\r\n        if (!targetTransformOrigin) {\r\n            targetTransformOrigin = targetOrigin;\r\n        }\r\n        if (isEnd || isFixed) {\r\n            break;\r\n        }\r\n        else {\r\n            el = offsetParent;\r\n            requestEnd = isOffsetEnd;\r\n        }\r\n        if (!checkContainer || el === documentElement) {\r\n            isEnd = requestEnd;\r\n        }\r\n    }\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(n);\r\n    }\r\n    if (!transformOrigin) {\r\n        transformOrigin = [0, 0];\r\n    }\r\n    if (!targetTransformOrigin) {\r\n        targetTransformOrigin = [0, 0];\r\n    }\r\n    return {\r\n        zoom: zoom,\r\n        offsetContainer: offsetContainer,\r\n        matrixes: matrixes,\r\n        targetMatrix: targetMatrix,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetTransformOrigin,\r\n        is3d: is3d,\r\n        hasFixed: hasFixed,\r\n    };\r\n}\n\nvar cacheStyleMap = null;\r\nvar clientRectStyleMap = null;\r\nvar matrixContainerInfos = null;\r\nfunction setStoreCache(useCache) {\r\n    if (useCache) {\r\n        if (window.Map) {\r\n            cacheStyleMap = new Map();\r\n            clientRectStyleMap = new Map();\r\n        }\r\n        matrixContainerInfos = [];\r\n    }\r\n    else {\r\n        cacheStyleMap = null;\r\n        matrixContainerInfos = null;\r\n        clientRectStyleMap = null;\r\n    }\r\n}\r\nfunction getCachedClientRect(el) {\r\n    var clientRect = clientRectStyleMap === null || clientRectStyleMap === void 0 ? void 0 : clientRectStyleMap.get(el);\r\n    if (clientRect) {\r\n        return clientRect;\r\n    }\r\n    var nextClientRect = getClientRect(el, true);\r\n    if (clientRectStyleMap) {\r\n        clientRectStyleMap.set(el, nextClientRect);\r\n    }\r\n    return nextClientRect;\r\n}\r\nfunction getCachedMatrixContainerInfo(target, container) {\r\n    if (matrixContainerInfos) {\r\n        var result_1 = find(matrixContainerInfos, function (info) { return info[0][0] == target && info[0][1] == container; });\r\n        if (result_1) {\r\n            return result_1[1];\r\n        }\r\n    }\r\n    var result = getMatrixStackInfo(target, container, true);\r\n    if (matrixContainerInfos) {\r\n        matrixContainerInfos.push([[target, container], result]);\r\n    }\r\n    return result;\r\n}\r\nfunction getCachedStyle(element) {\r\n    var cache = cacheStyleMap === null || cacheStyleMap === void 0 ? void 0 : cacheStyleMap.get(element);\r\n    if (!cache) {\r\n        var nextStyle_1 = getWindow(element).getComputedStyle(element);\r\n        if (!cacheStyleMap) {\r\n            return function (property) {\r\n                return nextStyle_1[property];\r\n            };\r\n        }\r\n        cache = {\r\n            style: nextStyle_1,\r\n            cached: {},\r\n        };\r\n        cacheStyleMap.set(element, cache);\r\n    }\r\n    var cached = cache.cached;\r\n    var style = cache.style;\r\n    return function (property) {\r\n        if (!(property in cached)) {\r\n            cached[property] = style[property];\r\n        }\r\n        return cached[property];\r\n    };\r\n}\n\nfunction fillChildEvents(moveable, name, e) {\r\n    var datas = e.originalDatas;\r\n    datas.groupable = datas.groupable || {};\r\n    var groupableDatas = datas.groupable;\r\n    groupableDatas.childDatas = groupableDatas.childDatas || [];\r\n    var childDatas = groupableDatas.childDatas;\r\n    return moveable.moveables.map(function (_, i) {\r\n        childDatas[i] = childDatas[i] || {};\r\n        childDatas[i][name] = childDatas[i][name] || {};\r\n        return __assign(__assign({}, e), { isRequestChild: true, datas: childDatas[i][name], originalDatas: childDatas[i] });\r\n    });\r\n}\r\nfunction triggerChildGesto(moveable, able, type, delta, e, isConvert, ableName) {\r\n    var isStart = !!type.match(/Start$/g);\r\n    var isEnd = !!type.match(/End$/g);\r\n    var isPinch = e.isPinch;\r\n    var datas = e.datas;\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childEvents = [];\r\n    var eventParams = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var state = childMoveable.state;\r\n        var gestos = state.gestos;\r\n        var childEvent = ev;\r\n        if (isStart) {\r\n            childEvent = new CustomGesto(ableName).dragStart(delta, ev);\r\n            childEvents.push(childEvent);\r\n        }\r\n        else {\r\n            if (!gestos[ableName]) {\r\n                gestos[ableName] = datas.childGestos[i];\r\n            }\r\n            if (!gestos[ableName]) {\r\n                return;\r\n            }\r\n            childEvent = setCustomDrag(ev, state, delta, isPinch, isConvert, ableName);\r\n            childEvents.push(childEvent);\r\n        }\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        if (isEnd) {\r\n            gestos[ableName] = null;\r\n        }\r\n        return result;\r\n    });\r\n    if (isStart) {\r\n        datas.childGestos = moveables.map(function (child) { return child.state.gestos[ableName]; });\r\n    }\r\n    return {\r\n        eventParams: eventParams,\r\n        childEvents: childEvents,\r\n    };\r\n}\r\nfunction triggerChildAbles(moveable, able, type, e, eachEvent, callback) {\r\n    if (eachEvent === void 0) { eachEvent = function (_, ev) { return ev; }; }\r\n    var isEnd = !!type.match(/End$/g);\r\n    var events = fillChildEvents(moveable, able.name, e);\r\n    var moveables = moveable.moveables;\r\n    var childs = events.map(function (ev, i) {\r\n        var childMoveable = moveables[i];\r\n        var childEvent = ev;\r\n        childEvent = eachEvent(childMoveable, ev);\r\n        var result = able[type](childMoveable, __assign(__assign({}, childEvent), { parentFlag: true }));\r\n        result && callback && callback(childMoveable, ev, result, i);\r\n        if (isEnd) {\r\n            childMoveable.state.gestos = {};\r\n        }\r\n        return result;\r\n    });\r\n    return childs;\r\n}\r\nfunction startChildDist(moveable, child, parentDatas, childEvent) {\r\n    var fixedDirection = parentDatas.fixedDirection;\r\n    var fixedPosition = parentDatas.fixedPosition;\r\n    var startPositions = childEvent.datas.startPositions || getAbsolutePosesByState(child.state);\r\n    var pos = getPosByDirection(startPositions, fixedDirection);\r\n    var _a = __read(calculate(createRotateMatrix(-moveable.rotation / 180 * Math.PI, 3), [pos[0] - fixedPosition[0], pos[1] - fixedPosition[1], 1], 3), 2), originalX = _a[0], originalY = _a[1];\r\n    childEvent.datas.originalX = originalX;\r\n    childEvent.datas.originalY = originalY;\r\n    return childEvent;\r\n}\n\nfunction renderDirectionControlsByInfos(moveable, ableName, renderDirections, React) {\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var zoom = getProps(moveable.props, ableName).zoom;\r\n    var degRotation = absDegree(rotationRad / Math.PI * 180);\r\n    var directionMap = {};\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    renderDirections.forEach(function (_a) {\r\n        var dir = _a.dir;\r\n        directionMap[dir] = true;\r\n    });\r\n    var directionSign = sign(direction);\r\n    return renderDirections.map(function (_a) {\r\n        var data = _a.data, classNames = _a.classNames, dir = _a.dir;\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes || !directionMap[dir]) {\r\n            return null;\r\n        }\r\n        renderDirectionMap[dir] = true;\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var dataAttrs = {};\r\n        getKeys(data).forEach(function (name) {\r\n            dataAttrs[\"data-\".concat(name)] = data[name];\r\n        });\r\n        return (React.createElement(\"div\", __assign({ className: prefix.apply(void 0, __spreadArray([\"control\", \"direction\", dir, ableName], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir }, dataAttrs, { key: \"direction-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) })));\r\n    });\r\n}\r\nfunction renderDirectionControls(moveable, defaultDirections, ableName, React) {\r\n    var _a = getProps(moveable.props, ableName), _b = _a.renderDirections, directions = _b === void 0 ? defaultDirections : _b, displayAroundControls = _a.displayAroundControls;\r\n    if (!directions) {\r\n        return [];\r\n    }\r\n    var renderDirections = directions === true ? DIRECTIONS : directions;\r\n    return __spreadArray(__spreadArray([], __read((displayAroundControls ? renderAroundControls(moveable, React, ableName, renderDirections) : [])), false), __read(renderDirectionControlsByInfos(moveable, ableName, renderDirections.map(function (dir) {\r\n        return {\r\n            data: {},\r\n            classNames: [],\r\n            dir: dir,\r\n        };\r\n    }), React)), false);\r\n}\r\nfunction renderLine(React, direction, pos1, pos2, zoom, key) {\r\n    var classNames = [];\r\n    for (var _i = 6; _i < arguments.length; _i++) {\r\n        classNames[_i - 6] = arguments[_i];\r\n    }\r\n    var rad = getRad(pos1, pos2);\r\n    var rotation = direction ? (throttle(rad / Math.PI * 180, 15)) % 180 : -1;\r\n    return React.createElement(\"div\", { key: \"line-\".concat(key), className: prefix.apply(void 0, __spreadArray([\"line\", \"direction\", direction ? \"edge\" : \"\", direction], __read(classNames), false)), \"data-rotation\": rotation, \"data-line-key\": key, \"data-direction\": direction, style: getLineStyle(pos1, pos2, zoom, rad) });\r\n}\r\nfunction renderEdgeLines(React, ableName, edge, poses, zoom) {\r\n    var directions = edge === true ? DIRECTIONS4 : edge;\r\n    return directions.map(function (direction, i) {\r\n        var _a = __read(DIRECTION_INDEXES[direction], 2), index1 = _a[0], index2 = _a[1];\r\n        if (index2 == null) {\r\n            return;\r\n        }\r\n        return renderLine(React, direction, poses[index1], poses[index2], zoom, \"\".concat(ableName, \"Edge\").concat(i), ableName);\r\n    }).filter(Boolean);\r\n}\r\nfunction getRenderDirections(ableName) {\r\n    return function (moveable, React) {\r\n        var edge = getProps(moveable.props, ableName).edge;\r\n        if (edge && (edge === true || edge.length)) {\r\n            return __spreadArray(__spreadArray([], __read(renderEdgeLines(React, ableName, edge, moveable.getState().renderPoses, moveable.props.zoom)), false), __read(renderDiagonalDirections(moveable, ableName, React)), false);\r\n        }\r\n        return renderAllDirections(moveable, ableName, React);\r\n    };\r\n}\r\nfunction renderAllDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, DIRECTIONS, ableName, React);\r\n}\r\nfunction renderDiagonalDirections(moveable, ableName, React) {\r\n    return renderDirectionControls(moveable, [\"nw\", \"ne\", \"sw\", \"se\"], ableName, React);\r\n}\r\nfunction renderAroundControls(moveable, React, ableName, renderDirections) {\r\n    var renderState = moveable.renderState;\r\n    if (!renderState.renderDirectionMap) {\r\n        renderState.renderDirectionMap = {};\r\n    }\r\n    var _a = moveable.getState(), renderPoses = _a.renderPoses, rotationRad = _a.rotation, direction = _a.direction;\r\n    var renderDirectionMap = renderState.renderDirectionMap;\r\n    var zoom = moveable.props.zoom;\r\n    var directionSign = sign(direction);\r\n    var degRotation = rotationRad / Math.PI * 180;\r\n    return (renderDirections || getKeys(renderDirectionMap)).map(function (dir) {\r\n        var indexes = DIRECTION_INDEXES[dir];\r\n        if (!indexes) {\r\n            return null;\r\n        }\r\n        var directionRotation = (throttle(degRotation, 15) + directionSign * DIRECTION_ROTATIONS[dir] + 720) % 180;\r\n        var classNames = [\"around-control\"];\r\n        if (ableName) {\r\n            classNames.push(\"direction\", ableName);\r\n        }\r\n        return (React.createElement(\"div\", { className: prefix.apply(void 0, __spreadArray([], __read(classNames), false)), \"data-rotation\": directionRotation, \"data-direction\": dir, key: \"direction-around-\".concat(dir), style: getControlTransform.apply(void 0, __spreadArray([rotationRad, zoom], __read(indexes.map(function (index) { return renderPoses[index]; })), false)) }));\r\n    });\r\n}\n\nfunction checkBoundPoses(bounds, verticalPoses, horizontalPoses) {\r\n    var _a = bounds || {}, _b = _a.position, position = _b === void 0 ? \"client\" : _b, _c = _a.left, left = _c === void 0 ? -Infinity : _c, _d = _a.top, top = _d === void 0 ? -Infinity : _d, _e = _a.right, right = _e === void 0 ? Infinity : _e, _f = _a.bottom, bottom = _f === void 0 ? Infinity : _f;\r\n    var nextBounds = {\r\n        position: position,\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n    };\r\n    return {\r\n        vertical: checkBounds(nextBounds, verticalPoses, true),\r\n        horizontal: checkBounds(nextBounds, horizontalPoses, false),\r\n    };\r\n}\r\nfunction getBounds(moveable, externalBounds) {\r\n    var _a = moveable.state, _b = _a.containerClientRect, containerHeight = _b.clientHeight, containerWidth = _b.clientWidth, clientLeft = _b.clientLeft, clientTop = _b.clientTop, _c = _a.snapOffset, snapOffsetLeft = _c.left, snapOffsetTop = _c.top, snapOffsetRight = _c.right, snapOffsetBottom = _c.bottom;\r\n    var bounds = externalBounds || moveable.props.bounds || {};\r\n    var position = bounds.position || \"client\";\r\n    var isCSS = position === \"css\";\r\n    var _d = bounds.left, left = _d === void 0 ? -Infinity : _d, _e = bounds.top, top = _e === void 0 ? -Infinity : _e;\r\n    var _f = bounds.right, right = _f === void 0 ? isCSS ? -Infinity : Infinity : _f, _g = bounds.bottom, bottom = _g === void 0 ? isCSS ? -Infinity : Infinity : _g;\r\n    if (isCSS) {\r\n        right = containerWidth + snapOffsetRight - snapOffsetLeft - right;\r\n        bottom = containerHeight + snapOffsetBottom - snapOffsetTop - bottom;\r\n    }\r\n    return {\r\n        left: left + snapOffsetLeft - clientLeft,\r\n        right: right + snapOffsetLeft - clientLeft,\r\n        top: top + snapOffsetTop - clientTop,\r\n        bottom: bottom + snapOffsetTop - clientTop,\r\n    };\r\n}\r\nfunction checkBoundKeepRatio(moveable, startPos, endPos) {\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var _b = __read(endPos, 2), endX = _b[0], endY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    var verticalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isBound: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    else if (dx === 0) {\r\n        if (isBottom) {\r\n            if (bottom < endY) {\r\n                horizontalInfo.pos = bottom;\r\n                horizontalInfo.offset = endY - bottom;\r\n            }\r\n        }\r\n        else {\r\n            if (top > endY) {\r\n                horizontalInfo.pos = top;\r\n                horizontalInfo.offset = endY - top;\r\n            }\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isRight) {\r\n            if (right < endX) {\r\n                verticalInfo.pos = right;\r\n                verticalInfo.offset = endX - right;\r\n            }\r\n        }\r\n        else {\r\n            if (left > endX) {\r\n                verticalInfo.pos = left;\r\n                verticalInfo.offset = endX - left;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isBound = false;\r\n        if (isRight && right <= endX) {\r\n            y = a * right + b;\r\n            x = right;\r\n            isBound = true;\r\n        }\r\n        else if (!isRight && endX <= left) {\r\n            y = a * left + b;\r\n            x = left;\r\n            isBound = true;\r\n        }\r\n        if (isBound) {\r\n            if (y < top || y > bottom) {\r\n                isBound = false;\r\n            }\r\n        }\r\n        if (!isBound) {\r\n            if (isBottom && bottom <= endY) {\r\n                y = bottom;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n            else if (!isBottom && endY <= top) {\r\n                y = top;\r\n                x = (y - b) / a;\r\n                isBound = true;\r\n            }\r\n        }\r\n        if (isBound) {\r\n            verticalInfo.isBound = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isBound = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction checkBounds(bounds, poses, isVertical) {\r\n    // 0   [100 - 200]  300\r\n    var startBoundPos = bounds[isVertical ? \"left\" : \"top\"];\r\n    var endBoundPos = bounds[isVertical ? \"right\" : \"bottom\"];\r\n    // 450\r\n    var minPos = Math.min.apply(Math, __spreadArray([], __read(poses), false));\r\n    var maxPos = Math.max.apply(Math, __spreadArray([], __read(poses), false));\r\n    var boundInfos = [];\r\n    if (startBoundPos + 1 > minPos) {\r\n        boundInfos.push({\r\n            direction: \"start\",\r\n            isBound: true,\r\n            offset: minPos - startBoundPos,\r\n            pos: startBoundPos,\r\n        });\r\n    }\r\n    if (endBoundPos - 1 < maxPos) {\r\n        boundInfos.push({\r\n            direction: \"end\",\r\n            isBound: true,\r\n            offset: maxPos - endBoundPos,\r\n            pos: endBoundPos,\r\n        });\r\n    }\r\n    if (!boundInfos.length) {\r\n        boundInfos.push({\r\n            isBound: false,\r\n            offset: 0,\r\n            pos: 0,\r\n        });\r\n    }\r\n    return boundInfos.sort(function (a, b) { return abs(b.offset) - abs(a.offset); });\r\n}\r\nfunction isBoundRotate$1(relativePoses, boundRect, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return nextPoses.some(function (pos) {\r\n        return (pos[0] < boundRect.left && abs(pos[0] - boundRect.left) > 0.1)\r\n            || (pos[0] > boundRect.right && abs(pos[0] - boundRect.right) > 0.1)\r\n            || (pos[1] < boundRect.top && abs(pos[1] - boundRect.top) > 0.1)\r\n            || (pos[1] > boundRect.bottom && abs(pos[1] - boundRect.bottom) > 0.1);\r\n    });\r\n}\r\nfunction boundRotate(vec, boundPos, index) {\r\n    var r = getDistSize(vec);\r\n    var nextPos = Math.sqrt(r * r - boundPos * boundPos) || 0;\r\n    return [nextPos, -nextPos].sort(function (a, b) {\r\n        return abs(a - vec[index ? 0 : 1]) - abs(b - vec[index ? 0 : 1]);\r\n    }).map(function (pos) {\r\n        return getRad([0, 0], index ? [pos, boundPos] : [boundPos, pos]);\r\n    });\r\n}\r\nfunction checkRotateBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    if (!moveable.props.bounds) {\r\n        return [];\r\n    }\r\n    var rad = rotation * Math.PI / 180;\r\n    var _a = getBounds(moveable), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = right - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = bottom - origin[1];\r\n    var boundRect = {\r\n        left: relativeLeft,\r\n        top: relativeTop,\r\n        right: relativeRight,\r\n        bottom: relativeBottom,\r\n    };\r\n    if (!isBoundRotate$1(nextPoses, boundRect, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    [\r\n        [relativeLeft, 0],\r\n        [relativeRight, 0],\r\n        [relativeTop, 1],\r\n        [relativeBottom, 1],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 2), boundPos = _b[0], index = _b[1];\r\n        nextPoses.forEach(function (nextPos) {\r\n            var relativeRad1 = getRad([0, 0], nextPos);\r\n            result.push.apply(result, __spreadArray([], __read(boundRotate(nextPos, boundPos, index)\r\n                .map(function (relativeRad2) { return rad + relativeRad2 - relativeRad1; })\r\n                .filter(function (nextRad) { return !isBoundRotate$1(prevPoses, boundRect, nextRad); })\r\n                .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n        });\r\n    });\r\n    return result;\r\n}\n\nvar VERTICAL_NAMES = [\"left\", \"right\", \"center\"];\r\nvar HORIZONTAL_NAMES = [\"top\", \"bottom\", \"middle\"];\r\nvar SNAP_SKIP_NAMES_MAP = {\r\n    \"left\": \"start\",\r\n    \"right\": \"end\",\r\n    \"center\": \"center\",\r\n    \"top\": \"start\",\r\n    \"bottom\": \"end\",\r\n    \"middle\": \"center\",\r\n};\r\nvar VERTICAL_NAMES_MAP = {\r\n    start: \"left\",\r\n    end: \"right\",\r\n    center: \"center\",\r\n};\r\nvar HORIZONTAL_NAMES_MAP = {\r\n    start: \"top\",\r\n    end: \"bottom\",\r\n    center: \"middle\",\r\n};\r\nfunction getInitialBounds() {\r\n    return {\r\n        left: false,\r\n        top: false,\r\n        right: false,\r\n        bottom: false,\r\n    };\r\n}\r\nfunction hasGuidelines(moveable, ableName) {\r\n    var _a = moveable.props, snappable = _a.snappable, bounds = _a.bounds, innerBounds = _a.innerBounds, verticalGuidelines = _a.verticalGuidelines, horizontalGuidelines = _a.horizontalGuidelines, snapGridWidth = _a.snapGridWidth, snapGridHeight = _a.snapGridHeight, _b = moveable.state, guidelines = _b.guidelines, enableSnap = _b.enableSnap;\r\n    if (!snappable ||\r\n        !enableSnap ||\r\n        (ableName && snappable !== true && snappable.indexOf(ableName) < 0)) {\r\n        return false;\r\n    }\r\n    if (snapGridWidth ||\r\n        snapGridHeight ||\r\n        bounds ||\r\n        innerBounds ||\r\n        (guidelines && guidelines.length) ||\r\n        (verticalGuidelines && verticalGuidelines.length) ||\r\n        (horizontalGuidelines && horizontalGuidelines.length)) {\r\n        return true;\r\n    }\r\n    return false;\r\n}\r\nfunction getSnapDirections(snapDirections) {\r\n    if (snapDirections === false) {\r\n        return {};\r\n    }\r\n    else if (snapDirections === true || !snapDirections) {\r\n        return { left: true, right: true, top: true, bottom: true };\r\n    }\r\n    return snapDirections;\r\n}\r\nfunction mapSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapDirections = getSnapDirections(snapDirections);\r\n    var nextSnapPoses = {};\r\n    for (var name_1 in nextSnapDirections) {\r\n        if (name_1 in snapPoses && nextSnapDirections[name_1]) {\r\n            nextSnapPoses[name_1] = snapPoses[name_1];\r\n        }\r\n    }\r\n    return nextSnapPoses;\r\n}\r\nfunction splitSnapDirectionPoses(snapDirections, snapPoses) {\r\n    var nextSnapPoses = mapSnapDirectionPoses(snapDirections, snapPoses);\r\n    var horizontalNames = HORIZONTAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    var verticalNames = VERTICAL_NAMES.filter(function (name) { return name in nextSnapPoses; });\r\n    return {\r\n        horizontalNames: horizontalNames,\r\n        verticalNames: verticalNames,\r\n        horizontal: horizontalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n        vertical: verticalNames.map(function (name) { return nextSnapPoses[name]; }),\r\n    };\r\n}\r\nfunction calculateContainerPos(rootMatrix, containerRect, n) {\r\n    var clientPos = calculatePosition(rootMatrix, [containerRect.clientLeft, containerRect.clientTop], n);\r\n    return [\r\n        containerRect.left + clientPos[0],\r\n        containerRect.top + clientPos[1],\r\n    ];\r\n}\r\nfunction solveLineConstants(_a) {\r\n    var _b = __read(_a, 2), point1 = _b[0], point2 = _b[1];\r\n    var dx = point2[0] - point1[0];\r\n    var dy = point2[1] - point1[1];\r\n    if (Math.abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (Math.abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    // b > 0\r\n    // ax + by + c = 0\r\n    var a = 0;\r\n    var b = 0;\r\n    var c = 0;\r\n    if (!dx) {\r\n        // -x + 1 = 0\r\n        a = -1;\r\n        c = point1[0];\r\n    }\r\n    else if (!dy) {\r\n        // y - 1 = 0\r\n        b = 1;\r\n        c = -point1[1];\r\n    }\r\n    else {\r\n        // y = -a(x - x1) + y1\r\n        // ax + y + a * x1 - y1 = 0\r\n        a = -dy / dx;\r\n        b = 1;\r\n        c = a * point1[0] - point1[1];\r\n    }\r\n    return [a, b, c].map(function (v) { return throttle(v, TINY_NUM$1); });\r\n}\n\nvar NAME_snapRotationThreshold = \"snapRotationThreshold\";\r\nvar NAME_snapRotationDegrees = \"snapRotationDegrees\";\r\nvar NAME_snapHorizontalThreshold = \"snapHorizontalThreshold\";\r\nvar NAME_snapVerticalThreshold = \"snapVerticalThreshold\";\n\nfunction checkMoveableSnapPoses(moveable, posesX, posesY, dirXs, dirYs, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var _a;\r\n    if (dirXs === void 0) { dirXs = []; }\r\n    if (dirYs === void 0) { dirYs = []; }\r\n    var props = moveable.props;\r\n    var snapThresholdMultiples = ((_a = moveable.state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) || [1, 1];\r\n    var snapHorizontalThreshold = selectValue(customSnapHorizontalThreshold, props[NAME_snapHorizontalThreshold], 5);\r\n    var snapVerticalThreshold = selectValue(customSnapVerticalThreshold, props[NAME_snapVerticalThreshold], 5);\r\n    return checkSnapPoses(moveable.state.guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, snapThresholdMultiples);\r\n}\r\nfunction checkSnapPoses(guidelines, posesX, posesY, dirXs, dirYs, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    return {\r\n        vertical: checkSnap(guidelines, \"vertical\", posesX, snapVerticalThreshold * multiples[0], dirXs),\r\n        horizontal: checkSnap(guidelines, \"horizontal\", posesY, snapHorizontalThreshold * multiples[1], dirYs),\r\n    };\r\n}\r\nfunction checkSnapKeepRatio(moveable, startPos, endPos) {\r\n    var _a = __read(endPos, 2), endX = _a[0], endY = _a[1];\r\n    var _b = __read(startPos, 2), startX = _b[0], startY = _b[1];\r\n    var _c = __read(minus(endPos, startPos), 2), dx = _c[0], dy = _c[1];\r\n    var isBottom = dy > 0;\r\n    var isRight = dx > 0;\r\n    dx = getTinyDist(dx);\r\n    dy = getTinyDist(dy);\r\n    var verticalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    var horizontalInfo = {\r\n        isSnap: false,\r\n        offset: 0,\r\n        pos: 0,\r\n    };\r\n    if (dx === 0 && dy === 0) {\r\n        return {\r\n            vertical: verticalInfo,\r\n            horizontal: horizontalInfo,\r\n        };\r\n    }\r\n    var _d = checkMoveableSnapPoses(moveable, dx ? [endX] : [], dy ? [endY] : [], [], [], undefined, undefined), verticalSnapInfo = _d.vertical, horizontalSnapInfo = _d.horizontal;\r\n    verticalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isRight ? pos >= startX : pos <= startX;\r\n    });\r\n    horizontalSnapInfo.posInfos.filter(function (_a) {\r\n        var pos = _a.pos;\r\n        return isBottom ? pos >= startY : pos <= startY;\r\n    });\r\n    verticalSnapInfo.isSnap = verticalSnapInfo.posInfos.length > 0;\r\n    horizontalSnapInfo.isSnap = horizontalSnapInfo.posInfos.length > 0;\r\n    var _e = getNearestSnapGuidelineInfo(verticalSnapInfo), isVerticalSnap = _e.isSnap, verticalGuideline = _e.guideline;\r\n    var _f = getNearestSnapGuidelineInfo(horizontalSnapInfo), isHorizontalSnap = _f.isSnap, horizontalGuideline = _f.guideline;\r\n    var horizontalPos = isHorizontalSnap ? horizontalGuideline.pos[1] : 0;\r\n    var verticalPos = isVerticalSnap ? verticalGuideline.pos[0] : 0;\r\n    if (dx === 0) {\r\n        if (isHorizontalSnap) {\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = horizontalGuideline.pos[1];\r\n            horizontalInfo.offset = endY - horizontalInfo.pos;\r\n        }\r\n    }\r\n    else if (dy === 0) {\r\n        if (isVerticalSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = verticalPos;\r\n            verticalInfo.offset = endX - verticalPos;\r\n        }\r\n    }\r\n    else {\r\n        // y - y1 = a * (x - x1)\r\n        var a = dy / dx;\r\n        var b = endPos[1] - a * endX;\r\n        var y = 0;\r\n        var x = 0;\r\n        var isSnap = false;\r\n        if (isVerticalSnap) {\r\n            x = verticalPos;\r\n            y = a * x + b;\r\n            isSnap = true;\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            y = horizontalPos;\r\n            x = (y - b) / a;\r\n            isSnap = true;\r\n        }\r\n        if (isSnap) {\r\n            verticalInfo.isSnap = true;\r\n            verticalInfo.pos = x;\r\n            verticalInfo.offset = endX - x;\r\n            horizontalInfo.isSnap = true;\r\n            horizontalInfo.pos = y;\r\n            horizontalInfo.offset = endY - y;\r\n        }\r\n    }\r\n    return {\r\n        vertical: verticalInfo,\r\n        horizontal: horizontalInfo,\r\n    };\r\n}\r\nfunction getStringDirection(dir) {\r\n    var stringDirection = \"\";\r\n    if (dir === -1 || dir === \"top\" || dir === \"left\") {\r\n        stringDirection = \"start\";\r\n    }\r\n    else if (dir === 0 || dir === \"center\" || dir === \"middle\") {\r\n        stringDirection = \"center\";\r\n    }\r\n    else if (dir === 1 || dir === \"right\" || dir === \"bottom\") {\r\n        stringDirection = \"end\";\r\n    }\r\n    return stringDirection;\r\n}\r\nfunction checkSnaps(moveable, rect, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var poses = splitSnapDirectionPoses(moveable.props.snapDirections, rect);\r\n    var result = checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, poses.verticalNames.map(function (name) { return getStringDirection(name); }), poses.horizontalNames.map(function (name) { return getStringDirection(name); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var horizontalDirection = getStringDirection(poses.horizontalNames[result.horizontal.index]);\r\n    var verticalDirection = getStringDirection(poses.verticalNames[result.vertical.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction getNearestSnapGuidelineInfo(snapInfo) {\r\n    var isSnap = snapInfo.isSnap;\r\n    if (!isSnap) {\r\n        return {\r\n            isSnap: false,\r\n            offset: 0,\r\n            dist: -1,\r\n            pos: 0,\r\n            guideline: null,\r\n        };\r\n    }\r\n    var posInfo = snapInfo.posInfos[0];\r\n    var guidelineInfo = posInfo.guidelineInfos[0];\r\n    var offset = guidelineInfo.offset;\r\n    var dist = guidelineInfo.dist;\r\n    var guideline = guidelineInfo.guideline;\r\n    return {\r\n        isSnap: isSnap,\r\n        offset: offset,\r\n        dist: dist,\r\n        pos: posInfo.pos,\r\n        guideline: guideline,\r\n    };\r\n}\r\nfunction checkSnap(guidelines, targetType, targetPoses, snapThreshold, dirs) {\r\n    var _a, _b;\r\n    if (dirs === void 0) { dirs = []; }\r\n    if (!guidelines || !guidelines.length) {\r\n        return {\r\n            isSnap: false,\r\n            index: -1,\r\n            direction: \"\",\r\n            posInfos: [],\r\n        };\r\n    }\r\n    var isVertical = targetType === \"vertical\";\r\n    var posType = isVertical ? 0 : 1;\r\n    var snapPosInfos = targetPoses.map(function (targetPos, index) {\r\n        var direction = dirs[index] || \"\";\r\n        var guidelineInfos = guidelines.map(function (guideline) {\r\n            var pos = guideline.pos;\r\n            var offset = targetPos - pos[posType];\r\n            return {\r\n                offset: offset,\r\n                dist: abs(offset),\r\n                guideline: guideline,\r\n                direction: direction,\r\n            };\r\n        }).filter(function (_a) {\r\n            var guideline = _a.guideline, dist = _a.dist;\r\n            var type = guideline.type;\r\n            if (type !== targetType\r\n                || dist > snapThreshold) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }).sort(function (a, b) { return a.dist - b.dist; });\r\n        return {\r\n            pos: targetPos,\r\n            index: index,\r\n            guidelineInfos: guidelineInfos,\r\n            direction: direction,\r\n        };\r\n    }).filter(function (snapPosInfo) {\r\n        return snapPosInfo.guidelineInfos.length > 0;\r\n    }).sort(function (a, b) {\r\n        return a.guidelineInfos[0].dist - b.guidelineInfos[0].dist;\r\n    });\r\n    var isSnap = snapPosInfos.length > 0;\r\n    return {\r\n        isSnap: isSnap,\r\n        index: isSnap ? snapPosInfos[0].index : -1,\r\n        direction: (_b = (_a = snapPosInfos[0]) === null || _a === void 0 ? void 0 : _a.direction) !== null && _b !== void 0 ? _b : \"\",\r\n        posInfos: snapPosInfos,\r\n    };\r\n}\r\nfunction getSnapInfosByDirection(moveable, \r\n// pos1 pos2 pos3 pos4\r\nposes, snapDirection, customSnapVerticalThreshold, customSnapHorizontalThreshold) {\r\n    var dirs = [];\r\n    if (snapDirection[0] && snapDirection[1]) {\r\n        dirs = [\r\n            snapDirection,\r\n            [-snapDirection[0], snapDirection[1]],\r\n            [snapDirection[0], -snapDirection[1]],\r\n        ];\r\n    }\r\n    else if (!snapDirection[0] && !snapDirection[1]) {\r\n        [\r\n            [-1, -1],\r\n            [1, -1],\r\n            [1, 1],\r\n            [-1, 1],\r\n        ].forEach(function (dir, i, arr) {\r\n            var nextDir = (arr[i + 1] || arr[0]);\r\n            dirs.push(dir);\r\n            dirs.push([\r\n                (dir[0] + nextDir[0]) / 2,\r\n                (dir[1] + nextDir[1]) / 2,\r\n            ]);\r\n        });\r\n    }\r\n    else {\r\n        if (moveable.props.keepRatio) {\r\n            dirs.push([-1, -1], [-1, 1], [1, -1], [1, 1], snapDirection);\r\n        }\r\n        else {\r\n            dirs.push.apply(dirs, __spreadArray([], __read(getPosesByDirection([\r\n                [-1, -1],\r\n                [1, -1],\r\n                [-1, -1],\r\n                [1, 1],\r\n            ], snapDirection)), false));\r\n            if (dirs.length > 1) {\r\n                dirs.push([\r\n                    (dirs[0][0] + dirs[1][0]) / 2,\r\n                    (dirs[0][1] + dirs[1][1]) / 2,\r\n                ]);\r\n            }\r\n        }\r\n    }\r\n    var nextPoses = dirs.map(function (dir) { return getPosByDirection(poses, dir); });\r\n    var xs = nextPoses.map(function (pos) { return pos[0]; });\r\n    var ys = nextPoses.map(function (pos) { return pos[1]; });\r\n    var result = checkMoveableSnapPoses(moveable, xs, ys, dirs.map(function (dir) { return getStringDirection(dir[0]); }), dirs.map(function (dir) { return getStringDirection(dir[1]); }), customSnapVerticalThreshold, customSnapHorizontalThreshold);\r\n    var verticalDirection = getStringDirection(dirs.map(function (dir) { return dir[0]; })[result.vertical.index]);\r\n    var horizontalDirection = getStringDirection(dirs.map(function (dir) { return dir[1]; })[result.horizontal.index]);\r\n    return {\r\n        vertical: __assign(__assign({}, result.vertical), { direction: verticalDirection }),\r\n        horizontal: __assign(__assign({}, result.horizontal), { direction: horizontalDirection }),\r\n    };\r\n}\r\nfunction checkSnapBoundPriority(a, b) {\r\n    var aDist = abs(a.offset);\r\n    var bDist = abs(b.offset);\r\n    if (a.isBound && b.isBound) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isBound) {\r\n        return -1;\r\n    }\r\n    else if (b.isBound) {\r\n        return 1;\r\n    }\r\n    else if (a.isSnap && b.isSnap) {\r\n        return bDist - aDist;\r\n    }\r\n    else if (a.isSnap) {\r\n        return -1;\r\n    }\r\n    else if (b.isSnap) {\r\n        return 1;\r\n    }\r\n    else if (aDist < TINY_NUM) {\r\n        return 1;\r\n    }\r\n    else if (bDist < TINY_NUM) {\r\n        return -1;\r\n    }\r\n    return aDist - bDist;\r\n}\r\nfunction getNearOffsetInfo(offsets, index) {\r\n    return offsets.slice().sort(function (a, b) {\r\n        var aSign = a.sign[index];\r\n        var bSign = b.sign[index];\r\n        var aOffset = a.offset[index];\r\n        var bOffset = b.offset[index];\r\n        // -1 The positions of a and b do not change.\r\n        // 1 The positions of a and b are reversed.\r\n        if (!aSign) {\r\n            return 1;\r\n        }\r\n        else if (!bSign) {\r\n            return -1;\r\n        }\r\n        return checkSnapBoundPriority({ isBound: a.isBound, isSnap: a.isSnap, offset: aOffset }, { isBound: b.isBound, isSnap: b.isSnap, offset: bOffset });\r\n    })[0];\r\n}\r\nfunction getCheckSnapDirections(direction, fixedDirection, keepRatio) {\r\n    var directions = [];\r\n    // const fixedDirection = [-direction[0], -direction[1]];\r\n    if (keepRatio) {\r\n        if (abs(fixedDirection[0]) !== 1 || abs(fixedDirection[1]) !== 1) {\r\n            directions.push([fixedDirection, [-1, -1]], [fixedDirection, [-1, 1]], [fixedDirection, [1, -1]], [fixedDirection, [1, 1]]);\r\n        }\r\n        else {\r\n            directions.push([fixedDirection, [direction[0], -direction[1]]], [fixedDirection, [-direction[0], direction[1]]]);\r\n        }\r\n        directions.push([fixedDirection, direction]);\r\n    }\r\n    else {\r\n        if ((direction[0] && direction[1]) || (!direction[0] && !direction[1])) {\r\n            var endDirection_1 = direction[0] ? direction : [1, 1];\r\n            [1, -1].forEach(function (signX) {\r\n                [1, -1].forEach(function (signY) {\r\n                    var nextDirection = [signX * endDirection_1[0], signY * endDirection_1[1]];\r\n                    if (fixedDirection[0] === nextDirection[0]\r\n                        && fixedDirection[1] === nextDirection[1]) {\r\n                        return;\r\n                    }\r\n                    directions.push([fixedDirection, nextDirection]);\r\n                });\r\n            });\r\n        }\r\n        else if (direction[0]) {\r\n            var signs = abs(fixedDirection[0]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [fixedDirection[0], -1],\r\n                    [sign * direction[0], -1],\r\n                ], [\r\n                    [fixedDirection[0], 0],\r\n                    [sign * direction[0], 0],\r\n                ], [\r\n                    [fixedDirection[0], 1],\r\n                    [sign * direction[0], 1],\r\n                ]);\r\n            });\r\n        }\r\n        else if (direction[1]) {\r\n            var signs = abs(fixedDirection[1]) === 1 ? [1] : [1, -1];\r\n            signs.forEach(function (sign) {\r\n                directions.push([\r\n                    [-1, fixedDirection[1]],\r\n                    [-1, sign * direction[1]],\r\n                ], [\r\n                    [0, fixedDirection[1]],\r\n                    [0, sign * direction[1]],\r\n                ], [\r\n                    [1, fixedDirection[1]],\r\n                    [1, sign * direction[1]],\r\n                ]);\r\n            });\r\n        }\r\n    }\r\n    return directions;\r\n}\n\nfunction isStartLine(dot, line) {\r\n    // l    o     => true\r\n    // o    l    => false\r\n    var cx = average([line[0][0], line[1][0]]);\r\n    var cy = average([line[0][1], line[1][1]]);\r\n    return {\r\n        vertical: cx <= dot[0],\r\n        horizontal: cy <= dot[1],\r\n    };\r\n}\r\nfunction hitTestLine(dot, _a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM) {\r\n        dy = 0;\r\n    }\r\n    var test1;\r\n    var test2;\r\n    if (!dx) {\r\n        test1 = pos1[0];\r\n        test2 = dot[0];\r\n    }\r\n    else if (!dy) {\r\n        test1 = pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    else {\r\n        var a = dy / dx;\r\n        // y = a * (x - pos1) + pos1\r\n        test1 = a * (dot[0] - pos1[0]) + pos1[1];\r\n        test2 = dot[1];\r\n    }\r\n    return test1 - test2;\r\n}\r\nfunction isSameStartLine(dots, line, centerSign, error) {\r\n    if (error === void 0) { error = TINY_NUM; }\r\n    return dots.every(function (dot) {\r\n        var value = hitTestLine(dot, line);\r\n        var sign = value <= 0;\r\n        return sign === centerSign || abs(value) <= error;\r\n    });\r\n}\r\nfunction checkInnerBoundDot(pos, start, end, isStart, threshold) {\r\n    if (threshold === void 0) { threshold = 0; }\r\n    if ((isStart && start - threshold <= pos)\r\n        || (!isStart && pos <= end + threshold)) {\r\n        // false 402 565 602 => 37 ([0, 37])\r\n        // true 400 524.9712603540036 600 => 124 ([124, 0])\r\n        // true 400 410 600 => 10 ([10, 0])\r\n        return {\r\n            isBound: true,\r\n            offset: isStart ? start - pos : end - pos,\r\n        };\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction checkInnerBound(moveable, _a) {\r\n    var line = _a.line, centerSign = _a.centerSign, verticalSign = _a.verticalSign, horizontalSign = _a.horizontalSign, lineConstants = _a.lineConstants;\r\n    var bounds = moveable.props.innerBounds;\r\n    if (!bounds) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    if (isSameStartLine([\r\n        [left, top],\r\n        [left + width, top],\r\n        [left, top + height],\r\n        [left + width, top + height],\r\n    ], line, centerSign)) {\r\n        return {\r\n            isAllBound: false,\r\n            isBound: false,\r\n            isVerticalBound: false,\r\n            isHorizontalBound: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    // test vertical\r\n    var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, verticalSign);\r\n    var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, verticalSign);\r\n    // test horizontal\r\n    var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, horizontalSign);\r\n    var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, horizontalSign);\r\n    var isAllVerticalBound = topBoundInfo.isBound && bottomBoundInfo.isBound;\r\n    var isVerticalBound = topBoundInfo.isBound || bottomBoundInfo.isBound;\r\n    var isAllHorizontalBound = leftBoundInfo.isBound && rightBoundInfo.isBound;\r\n    var isHorizontalBound = leftBoundInfo.isBound || rightBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(topBoundInfo.offset, bottomBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(leftBoundInfo.offset, rightBoundInfo.offset);\r\n    var offset = [0, 0];\r\n    var isBound = false;\r\n    var isAllBound = false;\r\n    if (abs(horizontalOffset) < abs(verticalOffset)) {\r\n        offset = [verticalOffset, 0];\r\n        isBound = isVerticalBound;\r\n        isAllBound = isAllVerticalBound;\r\n    }\r\n    else {\r\n        offset = [0, horizontalOffset];\r\n        isBound = isHorizontalBound;\r\n        isAllBound = isAllHorizontalBound;\r\n    }\r\n    return {\r\n        isAllBound: isAllBound,\r\n        isVerticalBound: isVerticalBound,\r\n        isHorizontalBound: isHorizontalBound,\r\n        isBound: isBound,\r\n        offset: offset,\r\n    };\r\n}\r\nfunction checkLineBoundCollision(line, _a, boundLine, isStart, threshold, isRender) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    var dot1 = line[0];\r\n    // const dot2 = line[1];\r\n    var boundDot1 = boundLine[0];\r\n    var boundDot2 = boundLine[1];\r\n    // const dy1 = getTinyDist(dot2[1] - dot1[1]);\r\n    // const dx1 = getTinyDist(dot2[0] - dot1[0]);\r\n    var dy2 = getTinyDist(boundDot2[1] - boundDot1[1]);\r\n    var dx2 = getTinyDist(boundDot2[0] - boundDot1[0]);\r\n    var hasDx = b;\r\n    var hasDy = a;\r\n    var slope = -a / b;\r\n    // lineConstants\r\n    // ax + by + c = 0\r\n    // dx2 or dy2 is zero\r\n    if (!dx2) {\r\n        // vertical\r\n        // by + c = 0\r\n        if (isRender && !hasDy) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDx) {\r\n            // ax + by + c = 0\r\n            // const y = dy1 ? dy1 / dx1 * (boundDot1[0] - dot1[0]) + dot1[1] : dot1[1];\r\n            var y = slope * (boundDot1[0] - dot1[0]) + dot1[1];\r\n            // boundDot1[1] <= y  <= boundDot2[1]\r\n            return checkInnerBoundDot(y, boundDot1[1], boundDot2[1], isStart, threshold);\r\n        }\r\n        else {\r\n            // ax + c = 0\r\n            var offset = boundDot1[0] - dot1[0];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    else if (!dy2) {\r\n        // horizontal\r\n        if (isRender && !hasDx) {\r\n            // 90deg\r\n            return {\r\n                isBound: false,\r\n                offset: 0,\r\n            };\r\n        }\r\n        else if (hasDy) {\r\n            // y = a * (x - x1) + y1\r\n            // x = (y - y1) / a + x1\r\n            // const a = dy1 / dx1;\r\n            // const x = dx1 ? (boundDot1[1] - dot1[1]) / a + dot1[0] : dot1[0];\r\n            var x = (boundDot1[1] - dot1[1]) / slope + dot1[0];\r\n            // boundDot1[0] <= x && x <= boundDot2[0]\r\n            return checkInnerBoundDot(x, boundDot1[0], boundDot2[0], isStart, threshold);\r\n        }\r\n        else {\r\n            var offset = boundDot1[1] - dot1[1];\r\n            var isBound = abs(offset) <= (threshold || 0);\r\n            return {\r\n                isBound: isBound,\r\n                offset: isBound ? offset : 0,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isBound: false,\r\n        offset: 0,\r\n    };\r\n}\r\nfunction getInnerBoundInfo(moveable, lineInfos, datas) {\r\n    return lineInfos.map(function (info) {\r\n        var _a = checkInnerBound(moveable, info), isBound = _a.isBound, offset = _a.offset, isVerticalBound = _a.isVerticalBound, isHorizontalBound = _a.isHorizontalBound;\r\n        var multiple = info.multiple;\r\n        var sizeOffset = getDragDist({\r\n            datas: datas,\r\n            distX: offset[0],\r\n            distY: offset[1],\r\n        }).map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isBound,\r\n            isVerticalBound: isVerticalBound,\r\n            isHorizontalBound: isHorizontalBound,\r\n            isSnap: false,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getInnerBoundDragInfo(moveable, poses, datas) {\r\n    var _a;\r\n    var lines = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false).map(function (info) {\r\n        return __assign(__assign({}, info), { multiple: info.multiple.map(function (dir) { return abs(dir) * 2; }) });\r\n    });\r\n    var innerBoundInfo = getInnerBoundInfo(moveable, lines, datas);\r\n    var widthOffsetInfo = getNearOffsetInfo(innerBoundInfo, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(innerBoundInfo, 1);\r\n    var verticalOffset = 0;\r\n    var horizontalOffset = 0;\r\n    var isVerticalBound = widthOffsetInfo.isVerticalBound || heightOffsetInfo.isVerticalBound;\r\n    var isHorizontalBound = widthOffsetInfo.isHorizontalBound || heightOffsetInfo.isHorizontalBound;\r\n    if (isVerticalBound || isHorizontalBound) {\r\n        _a = __read(getInverseDragDist({\r\n            datas: datas,\r\n            distX: -widthOffsetInfo.offset[0],\r\n            distY: -heightOffsetInfo.offset[1],\r\n        }), 2), verticalOffset = _a[0], horizontalOffset = _a[1];\r\n    }\r\n    return {\r\n        vertical: {\r\n            isBound: isVerticalBound,\r\n            offset: verticalOffset,\r\n        },\r\n        horizontal: {\r\n            isBound: isHorizontalBound,\r\n            offset: horizontalOffset,\r\n        },\r\n    };\r\n}\r\nfunction getCheckSnapLineDirections(direction, keepRatio) {\r\n    var lineDirections = [];\r\n    var x = direction[0];\r\n    var y = direction[1];\r\n    if (x && y) {\r\n        lineDirections.push([[0, y * 2], direction, [-x, y]], [[x * 2, 0], direction, [x, -y]]);\r\n    }\r\n    else if (x) {\r\n        // vertcal\r\n        lineDirections.push([[x * 2, 0], [x, 1], [x, -1]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[0, -1], [x, -1], [-x, -1]], [[0, 1], [x, 1], [-x, 1]]);\r\n        }\r\n    }\r\n    else if (y) {\r\n        // horizontal\r\n        lineDirections.push([[0, y * 2], [1, y], [-1, y]]);\r\n        if (keepRatio) {\r\n            lineDirections.push([[-1, 0], [-1, y], [-1, -y]], [[1, 0], [1, y], [1, -y]]);\r\n        }\r\n    }\r\n    else {\r\n        // [0, 0] to all direction\r\n        lineDirections.push([[-1, 0], [-1, -1], [-1, 1]], [[1, 0], [1, -1], [1, 1]], [[0, -1], [-1, -1], [1, -1]], [[0, 1], [-1, 1], [1, 1]]);\r\n    }\r\n    return lineDirections;\r\n}\r\nfunction getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio) {\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    var virtualPoses = calculatePoses(allMatrix, 100, 100, is3d ? 4 : 3);\r\n    var center = getPosByDirection(virtualPoses, [0, 0]);\r\n    return getCheckSnapLineDirections(direction, keepRatio).map(function (_a) {\r\n        var _b = __read(_a, 3), multiple = _b[0], dir1 = _b[1], dir2 = _b[2];\r\n        var virtualLine = [\r\n            getPosByDirection(virtualPoses, dir1),\r\n            getPosByDirection(virtualPoses, dir2),\r\n        ];\r\n        var lineConstants = solveLineConstants(virtualLine);\r\n        var _c = isStartLine(center, virtualLine), verticalSign = _c.vertical, horizontalSign = _c.horizontal;\r\n        var centerSign = hitTestLine(center, virtualLine) <= 0;\r\n        return {\r\n            multiple: multiple,\r\n            centerSign: centerSign,\r\n            verticalSign: verticalSign,\r\n            horizontalSign: horizontalSign,\r\n            lineConstants: lineConstants,\r\n            line: [\r\n                getPosByDirection(poses, dir1),\r\n                getPosByDirection(poses, dir2),\r\n            ],\r\n        };\r\n    });\r\n}\r\nfunction isBoundRotate(relativePoses, boundDots, center, rad) {\r\n    var nextPoses = rad ? relativePoses.map(function (pos) { return rotate(pos, rad); }) : relativePoses;\r\n    return [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].some(function (line) {\r\n        var centerSign = hitTestLine(center, line) <= 0;\r\n        return !isSameStartLine(boundDots, line, centerSign);\r\n    });\r\n}\r\nfunction getDistPointLine(_a) {\r\n    // x = 0, y = 0\r\n    // d = (ax + by + c) / root(a2 + b2)\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return abs(pos1[0]);\r\n    }\r\n    if (!dy) {\r\n        return abs(pos1[1]);\r\n    }\r\n    // y - y1 = a(x - x1)\r\n    // 0 = ax -y + -a * x1 + y1\r\n    var a = dy / dx;\r\n    return abs((-a * pos1[0] + pos1[1]) / Math.sqrt(Math.pow(a, 2) + 1));\r\n}\r\nfunction solveReverseLine(_a) {\r\n    var _b = __read(_a, 2), pos1 = _b[0], pos2 = _b[1];\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (!dx) {\r\n        return [pos1[0], 0];\r\n    }\r\n    if (!dy) {\r\n        return [0, pos1[1]];\r\n    }\r\n    var a = dy / dx;\r\n    // y - y1 = a (x  - x1)\r\n    // y = ax - a * x1 + y1\r\n    var b = -a * pos1[0] + pos1[1];\r\n    // y = ax + b = -1/a x\r\n    // x = -b / (a + 1 / a)\r\n    // y = b / (1 + 1 / a^2)\r\n    return [\r\n        -b / (a + 1 / a),\r\n        b / ((a * a) + 1),\r\n    ];\r\n}\r\nfunction checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin, rotation) {\r\n    var bounds = moveable.props.innerBounds;\r\n    var rad = rotation * Math.PI / 180;\r\n    if (!bounds) {\r\n        return [];\r\n    }\r\n    var left = bounds.left, top = bounds.top, width = bounds.width, height = bounds.height;\r\n    var relativeLeft = left - origin[0];\r\n    var relativeRight = left + width - origin[0];\r\n    var relativeTop = top - origin[1];\r\n    var relativeBottom = top + height - origin[1];\r\n    var dots = [\r\n        [relativeLeft, relativeTop],\r\n        [relativeRight, relativeTop],\r\n        [relativeLeft, relativeBottom],\r\n        [relativeRight, relativeBottom],\r\n    ];\r\n    var center = getPosByDirection(nextPoses, [0, 0]);\r\n    if (!isBoundRotate(nextPoses, dots, center, 0)) {\r\n        return [];\r\n    }\r\n    var result = [];\r\n    var dotInfos = dots.map(function (dot) { return [\r\n        getDistSize(dot),\r\n        getRad([0, 0], dot),\r\n    ]; });\r\n    [\r\n        [nextPoses[0], nextPoses[1]],\r\n        [nextPoses[1], nextPoses[3]],\r\n        [nextPoses[3], nextPoses[2]],\r\n        [nextPoses[2], nextPoses[0]],\r\n    ].forEach(function (line) {\r\n        var lineRad = getRad([0, 0], solveReverseLine(line));\r\n        var lineDist = getDistPointLine(line);\r\n        result.push.apply(result, __spreadArray([], __read(dotInfos\r\n            .filter(function (_a) {\r\n            var _b = __read(_a, 1), dotDist = _b[0];\r\n            return dotDist && lineDist <= dotDist;\r\n        })\r\n            .map(function (_a) {\r\n            var _b = __read(_a, 2), dotDist = _b[0], dotRad = _b[1];\r\n            var distRad = Math.acos(dotDist ? lineDist / dotDist : 0);\r\n            var nextRad1 = dotRad + distRad;\r\n            var nextRad2 = dotRad - distRad;\r\n            return [\r\n                rad + nextRad1 - lineRad,\r\n                rad + nextRad2 - lineRad,\r\n            ];\r\n        })\r\n            .reduce(function (prev, cur) {\r\n            prev.push.apply(prev, __spreadArray([], __read(cur), false));\r\n            return prev;\r\n        }, [])\r\n            .filter(function (nextRad) { return !isBoundRotate(prevPoses, dots, center, nextRad); })\r\n            .map(function (nextRad) { return throttle(nextRad * 180 / Math.PI, TINY_NUM); })), false));\r\n    });\r\n    return result;\r\n}\r\nfunction checkInnerBoundPoses(moveable) {\r\n    var innerBounds = moveable.props.innerBounds;\r\n    var boundMap = getInitialBounds();\r\n    if (!innerBounds) {\r\n        return {\r\n            boundMap: boundMap,\r\n            vertical: [],\r\n            horizontal: [],\r\n        };\r\n    }\r\n    var _a = moveable.getRect(), pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    var poses = [pos1, pos2, pos3, pos4];\r\n    var center = getPosByDirection(poses, [0, 0]);\r\n    var left = innerBounds.left, top = innerBounds.top, width = innerBounds.width, height = innerBounds.height;\r\n    var leftLine = [[left, top], [left, top + height]];\r\n    var topLine = [[left, top], [left + width, top]];\r\n    var rightLine = [[left + width, top], [left + width, top + height]];\r\n    var bottomLine = [[left, top + height], [left + width, top + height]];\r\n    var lineInfos = getCheckInnerBoundLineInfos(moveable, poses, [0, 0], false);\r\n    var horizontalPoses = [];\r\n    var verticalPoses = [];\r\n    lineInfos.forEach(function (lineInfo) {\r\n        var line = lineInfo.line, lineConstants = lineInfo.lineConstants;\r\n        var _a = isStartLine(center, line), isHorizontalStart = _a.horizontal, isVerticalStart = _a.vertical;\r\n        // test vertical\r\n        var topBoundInfo = checkLineBoundCollision(line, lineConstants, topLine, isVerticalStart, 1, true);\r\n        var bottomBoundInfo = checkLineBoundCollision(line, lineConstants, bottomLine, isVerticalStart, 1, true);\r\n        // test horizontal\r\n        var leftBoundInfo = checkLineBoundCollision(line, lineConstants, leftLine, isHorizontalStart, 1, true);\r\n        var rightBoundInfo = checkLineBoundCollision(line, lineConstants, rightLine, isHorizontalStart, 1, true);\r\n        if (topBoundInfo.isBound && !boundMap.top) {\r\n            horizontalPoses.push(top);\r\n            boundMap.top = true;\r\n        }\r\n        if (bottomBoundInfo.isBound && !boundMap.bottom) {\r\n            horizontalPoses.push(top + height);\r\n            boundMap.bottom = true;\r\n        }\r\n        if (leftBoundInfo.isBound && !boundMap.left) {\r\n            verticalPoses.push(left);\r\n            boundMap.left = true;\r\n        }\r\n        if (rightBoundInfo.isBound && !boundMap.right) {\r\n            verticalPoses.push(left + width);\r\n            boundMap.right = true;\r\n        }\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        horizontal: horizontalPoses,\r\n        vertical: verticalPoses,\r\n    };\r\n}\n\nfunction solveEquation(pos1, pos2, snapOffset, isVertical) {\r\n    var dx = pos2[0] - pos1[0];\r\n    var dy = pos2[1] - pos1[1];\r\n    if (abs(dx) < TINY_NUM$1) {\r\n        dx = 0;\r\n    }\r\n    if (abs(dy) < TINY_NUM$1) {\r\n        dy = 0;\r\n    }\r\n    if (!dx) {\r\n        // y = 0 * x + b\r\n        // only horizontal\r\n        if (!isVertical) {\r\n            return [0, snapOffset];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    if (!dy) {\r\n        // only vertical\r\n        if (isVertical) {\r\n            return [snapOffset, 0];\r\n        }\r\n        return [0, 0];\r\n    }\r\n    // y = ax + b\r\n    var a = dy / dx;\r\n    var b = pos1[1] - a * pos1[0];\r\n    if (isVertical) {\r\n        // y = a * x + b\r\n        var y = a * (pos2[0] + snapOffset) + b;\r\n        return [snapOffset, y - pos2[1]];\r\n    }\r\n    else {\r\n        // x = (y - b) / a\r\n        var x = (pos2[1] + snapOffset - b) / a;\r\n        return [x - pos2[0], snapOffset];\r\n    }\r\n}\r\nfunction solveNextOffset(pos1, pos2, offset, isVertical, datas) {\r\n    var sizeOffset = solveEquation(pos1, pos2, offset, isVertical);\r\n    if (!sizeOffset) {\r\n        return {\r\n            isOutside: false,\r\n            offset: [0, 0],\r\n        };\r\n    }\r\n    var size = getDist$1(pos1, pos2);\r\n    var dist1 = getDist$1(sizeOffset, pos1);\r\n    var dist2 = getDist$1(sizeOffset, pos2);\r\n    var isOutside = dist1 > size || dist2 > size;\r\n    var _a = __read(getDragDist({\r\n        datas: datas,\r\n        distX: sizeOffset[0],\r\n        distY: sizeOffset[1],\r\n    }), 2), widthOffset = _a[0], heightOffset = _a[1];\r\n    return {\r\n        offset: [widthOffset, heightOffset],\r\n        isOutside: isOutside,\r\n    };\r\n}\r\nfunction getSnapBound(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return getNearestSnapGuidelineInfo(snapInfo).offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkThrottleDragRotate(throttleDragRotate, _a, _b, _c, _d) {\r\n    var _e = __read(_a, 2), distX = _e[0], distY = _e[1];\r\n    var _f = __read(_b, 2), isVerticalBound = _f[0], isHorizontalBound = _f[1];\r\n    var _g = __read(_c, 2), isVerticalSnap = _g[0], isHorizontalSnap = _g[1];\r\n    var _h = __read(_d, 2), verticalOffset = _h[0], horizontalOffset = _h[1];\r\n    var offsetX = -verticalOffset;\r\n    var offsetY = -horizontalOffset;\r\n    if (throttleDragRotate && distX && distY) {\r\n        offsetX = 0;\r\n        offsetY = 0;\r\n        var adjustPoses = [];\r\n        if (isVerticalBound && isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalBound) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalBound) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        else if (isVerticalSnap && isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset], [verticalOffset, 0]);\r\n        }\r\n        else if (isVerticalSnap) {\r\n            adjustPoses.push([verticalOffset, 0]);\r\n        }\r\n        else if (isHorizontalSnap) {\r\n            adjustPoses.push([0, horizontalOffset]);\r\n        }\r\n        if (adjustPoses.length) {\r\n            adjustPoses.sort(function (a, b) {\r\n                return (getDistSize(minus([distX, distY], a)) -\r\n                    getDistSize(minus([distX, distY], b)));\r\n            });\r\n            var adjustPos = adjustPoses[0];\r\n            if (adjustPos[0] && abs(distX) > TINY_NUM$1) {\r\n                offsetX = -adjustPos[0];\r\n                offsetY =\r\n                    (distY * abs(distX + offsetX)) / abs(distX) -\r\n                        distY;\r\n            }\r\n            else if (adjustPos[1] && abs(distY) > TINY_NUM$1) {\r\n                var prevDistY = distY;\r\n                offsetY = -adjustPos[1];\r\n                offsetX =\r\n                    (distX * abs(distY + offsetY)) / abs(prevDistY) -\r\n                        distX;\r\n            }\r\n            if (throttleDragRotate && isHorizontalBound && isVerticalBound) {\r\n                if (abs(offsetX) > TINY_NUM$1 &&\r\n                    abs(offsetX) < abs(verticalOffset)) {\r\n                    var scale = abs(verticalOffset) / abs(offsetX);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else if (abs(offsetY) > TINY_NUM$1 &&\r\n                    abs(offsetY) < abs(horizontalOffset)) {\r\n                    var scale = abs(horizontalOffset) / abs(offsetY);\r\n                    offsetX *= scale;\r\n                    offsetY *= scale;\r\n                }\r\n                else {\r\n                    offsetX = maxOffset(-verticalOffset, offsetX);\r\n                    offsetY = maxOffset(-horizontalOffset, offsetY);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        offsetX = distX || isVerticalBound ? -verticalOffset : 0;\r\n        offsetY = distY || isHorizontalBound ? -horizontalOffset : 0;\r\n    }\r\n    return [offsetX, offsetY];\r\n}\r\nfunction checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, ignoreSnap, datas) {\r\n    if (!hasGuidelines(moveable, \"draggable\")) {\r\n        return [\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n            {\r\n                isSnap: false,\r\n                isBound: false,\r\n                offset: 0,\r\n            },\r\n        ];\r\n    }\r\n    var poses = getAbsolutePoses(datas.absolutePoses, [distX, distY]);\r\n    var _a = getRect(poses), left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n    var boundPoses = {\r\n        horizontal: poses.map(function (pos) { return pos[1]; }),\r\n        vertical: poses.map(function (pos) { return pos[0]; }),\r\n    };\r\n    var snapDirections = getSnapDirections(moveable.props.snapDirections);\r\n    var snapPoses = splitSnapDirectionPoses(snapDirections, {\r\n        left: left,\r\n        right: right,\r\n        top: top,\r\n        bottom: bottom,\r\n        center: (left + right) / 2,\r\n        middle: (top + bottom) / 2,\r\n    });\r\n    var _b = checkMoveableSnapBounds(moveable, ignoreSnap, snapPoses, boundPoses), verticalSnapBoundInfo = _b.vertical, horizontalSnapBoundInfo = _b.horizontal;\r\n    var _c = getInnerBoundDragInfo(moveable, poses, datas), verticalInnerBoundInfo = _c.vertical, horizontalInnerBoundInfo = _c.horizontal;\r\n    var isVerticalSnap = verticalSnapBoundInfo.isSnap;\r\n    var isHorizontalSnap = horizontalSnapBoundInfo.isSnap;\r\n    var isVerticalBound = verticalSnapBoundInfo.isBound || verticalInnerBoundInfo.isBound;\r\n    var isHorizontalBound = horizontalSnapBoundInfo.isBound || horizontalInnerBoundInfo.isBound;\r\n    var verticalOffset = maxOffset(verticalSnapBoundInfo.offset, verticalInnerBoundInfo.offset);\r\n    var horizontalOffset = maxOffset(horizontalSnapBoundInfo.offset, horizontalInnerBoundInfo.offset);\r\n    var _d = __read(checkThrottleDragRotate(throttleDragRotate, [distX, distY], [isVerticalBound, isHorizontalBound], [isVerticalSnap, isHorizontalSnap], [verticalOffset, horizontalOffset]), 2), offsetX = _d[0], offsetY = _d[1];\r\n    return [\r\n        {\r\n            isBound: isVerticalBound,\r\n            isSnap: isVerticalSnap,\r\n            offset: offsetX,\r\n        },\r\n        {\r\n            isBound: isHorizontalBound,\r\n            isSnap: isHorizontalSnap,\r\n            offset: offsetY,\r\n        },\r\n    ];\r\n}\r\nfunction checkMoveableSnapBounds(moveable, ignoreSnap, poses, boundPoses) {\r\n    if (boundPoses === void 0) { boundPoses = poses; }\r\n    var _a = checkBoundPoses(getBounds(moveable), boundPoses.vertical, boundPoses.horizontal), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    var _b = ignoreSnap ? {\r\n        horizontal: { isSnap: false, index: -1 },\r\n        vertical: { isSnap: false, index: -1 },\r\n    } : checkMoveableSnapPoses(moveable, poses.vertical, poses.horizontal, undefined, undefined, undefined, undefined), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapBounds(guideines, bounds, posesX, posesY, snapHorizontalThreshold, snapVerticalThreshold, multiples) {\r\n    if (multiples === void 0) { multiples = [1, 1]; }\r\n    var _a = checkBoundPoses(bounds, posesX, posesY), horizontalBoundInfos = _a.horizontal, verticalBoundInfos = _a.vertical;\r\n    // options.isRequest ? {\r\n    //     horizontal: { isSnap: false, index: -1 } as SnapInfo,\r\n    //     vertical: { isSnap: false, index: -1 } as SnapInfo,\r\n    // } :\r\n    var _b = checkSnapPoses(guideines, posesX, posesY, [], [], snapHorizontalThreshold, snapVerticalThreshold, multiples), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBound(horizontalBoundInfos[0], horizontalSnapInfo);\r\n    var verticalOffset = getSnapBound(verticalBoundInfos[0], verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfos[0].isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            snapIndex: horizontalSnapInfo.index,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n            bounds: horizontalBoundInfos,\r\n            snap: horizontalSnapInfo,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfos[0].isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            snapIndex: verticalSnapInfo.index,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n            bounds: verticalBoundInfos,\r\n            snap: verticalSnapInfo,\r\n        },\r\n    };\r\n}\r\nfunction checkSnapRightLine(startPos, endPos, snapBoundInfo, keepRatio) {\r\n    var rad = (getRad(startPos, endPos) / Math.PI) * 180;\r\n    var _a = snapBoundInfo.vertical, isVerticalBound = _a.isBound, isVerticalSnap = _a.isSnap, verticalDist = _a.dist, _b = snapBoundInfo.horizontal, isHorizontalBound = _b.isBound, isHorizontalSnap = _b.isSnap, horizontalDist = _b.dist;\r\n    var rad180 = rad % 180;\r\n    var isHorizontalLine = rad180 < 3 || rad180 > 177;\r\n    var isVerticalLine = rad180 > 87 && rad180 < 93;\r\n    if (horizontalDist < verticalDist) {\r\n        if (isVerticalBound ||\r\n            (isVerticalSnap &&\r\n                !isVerticalLine &&\r\n                (!keepRatio || !isHorizontalLine))) {\r\n            return \"vertical\";\r\n        }\r\n    }\r\n    if (isHorizontalBound ||\r\n        (isHorizontalSnap &&\r\n            !isHorizontalLine &&\r\n            (!keepRatio || !isVerticalLine))) {\r\n        return \"horizontal\";\r\n    }\r\n    return \"\";\r\n}\r\nfunction getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas) {\r\n    return directions.map(function (_a) {\r\n        var _b = __read(_a, 2), startDirection = _b[0], endDirection = _b[1];\r\n        var otherStartPos = getPosByDirection(poses, startDirection);\r\n        var otherEndPos = getPosByDirection(poses, endDirection);\r\n        var snapBoundInfo = keepRatio\r\n            ? checkSnapBoundsKeepRatio(moveable, otherStartPos, otherEndPos, isRequest)\r\n            : checkMoveableSnapBounds(moveable, isRequest, {\r\n                vertical: [otherEndPos[0]],\r\n                horizontal: [otherEndPos[1]],\r\n            });\r\n        var _c = snapBoundInfo.horizontal, \r\n        // dist: otherHorizontalDist,\r\n        otherHorizontalOffset = _c.offset, isOtherHorizontalBound = _c.isBound, isOtherHorizontalSnap = _c.isSnap, _d = snapBoundInfo.vertical, \r\n        // dist: otherVerticalDist,\r\n        otherVerticalOffset = _d.offset, isOtherVerticalBound = _d.isBound, isOtherVerticalSnap = _d.isSnap;\r\n        var multiple = minus(endDirection, startDirection);\r\n        if (!otherVerticalOffset && !otherHorizontalOffset) {\r\n            return {\r\n                isBound: isOtherVerticalBound || isOtherHorizontalBound,\r\n                isSnap: isOtherVerticalSnap || isOtherHorizontalSnap,\r\n                sign: multiple,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var snapLine = checkSnapRightLine(otherStartPos, otherEndPos, snapBoundInfo, keepRatio);\r\n        if (!snapLine) {\r\n            return {\r\n                sign: multiple,\r\n                isBound: false,\r\n                isSnap: false,\r\n                offset: [0, 0],\r\n            };\r\n        }\r\n        var isVertical = snapLine === \"vertical\";\r\n        var sizeOffset = [0, 0];\r\n        if (!keepRatio\r\n            && abs(endDirection[0]) === 1\r\n            && abs(endDirection[1]) === 1\r\n            && startDirection[0] !== endDirection[0]\r\n            && startDirection[1] !== endDirection[1]) {\r\n            sizeOffset = getDragDist({\r\n                datas: datas,\r\n                distX: -otherVerticalOffset,\r\n                distY: -otherHorizontalOffset,\r\n            });\r\n        }\r\n        else {\r\n            sizeOffset = solveNextOffset(otherStartPos, otherEndPos, -(isVertical ? otherVerticalOffset : otherHorizontalOffset), isVertical, datas).offset;\r\n        }\r\n        sizeOffset = sizeOffset.map(function (size, i) { return size * (multiple[i] ? 2 / multiple[i] : 0); });\r\n        return {\r\n            sign: multiple,\r\n            isBound: isVertical ? isOtherVerticalBound : isOtherHorizontalBound,\r\n            isSnap: isVertical ? isOtherVerticalSnap : isOtherHorizontalSnap,\r\n            offset: sizeOffset,\r\n        };\r\n    });\r\n}\r\nfunction getSnapBoundOffset(boundInfo, snapInfo) {\r\n    if (boundInfo.isBound) {\r\n        return boundInfo.offset;\r\n    }\r\n    else if (snapInfo.isSnap) {\r\n        return snapInfo.offset;\r\n    }\r\n    return 0;\r\n}\r\nfunction checkSnapBoundsKeepRatio(moveable, startPos, endPos, isRequest) {\r\n    var _a = checkBoundKeepRatio(moveable, startPos, endPos), horizontalBoundInfo = _a.horizontal, verticalBoundInfo = _a.vertical;\r\n    var _b = isRequest ? {\r\n        horizontal: { isSnap: false },\r\n        vertical: { isSnap: false },\r\n    } : checkSnapKeepRatio(moveable, startPos, endPos), horizontalSnapInfo = _b.horizontal, verticalSnapInfo = _b.vertical;\r\n    var horizontalOffset = getSnapBoundOffset(horizontalBoundInfo, horizontalSnapInfo);\r\n    var verticalOffset = getSnapBoundOffset(verticalBoundInfo, verticalSnapInfo);\r\n    var horizontalDist = abs(horizontalOffset);\r\n    var verticalDist = abs(verticalOffset);\r\n    return {\r\n        horizontal: {\r\n            isBound: horizontalBoundInfo.isBound,\r\n            isSnap: horizontalSnapInfo.isSnap,\r\n            offset: horizontalOffset,\r\n            dist: horizontalDist,\r\n        },\r\n        vertical: {\r\n            isBound: verticalBoundInfo.isBound,\r\n            isSnap: verticalSnapInfo.isSnap,\r\n            offset: verticalOffset,\r\n            dist: verticalDist,\r\n        },\r\n    };\r\n}\r\nfunction checkMaxBounds(moveable, poses, direction, fixedPosition, datas) {\r\n    var fixedDirection = [-direction[0], -direction[1]];\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var bounds = moveable.props.bounds;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    if (bounds) {\r\n        var directions = [\r\n            [direction[0], -direction[1]],\r\n            [-direction[0], direction[1]],\r\n        ];\r\n        var _b = bounds.left, left_1 = _b === void 0 ? -Infinity : _b, _c = bounds.top, top_1 = _c === void 0 ? -Infinity : _c, _d = bounds.right, right_1 = _d === void 0 ? Infinity : _d, _e = bounds.bottom, bottom_1 = _e === void 0 ? Infinity : _e;\r\n        directions.forEach(function (otherDirection) {\r\n            var isCheckVertical = otherDirection[0] !== fixedDirection[0];\r\n            var isCheckHorizontal = otherDirection[1] !== fixedDirection[1];\r\n            var otherPos = getPosByDirection(poses, otherDirection);\r\n            var deg = (getRad(fixedPosition, otherPos) * 360) / Math.PI;\r\n            if (isCheckHorizontal) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 360) < 2 || abs(deg - 180) < 2) {\r\n                    nextOtherPos[1] = fixedPosition[1];\r\n                }\r\n                var _a = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[1] < otherPos[1] ? bottom_1 : top_1) -\r\n                    otherPos[1], false, datas), _b = __read(_a.offset, 2), heightOffset = _b[1], isHeightOutside = _a.isOutside;\r\n                if (!isNaN(heightOffset)) {\r\n                    maxHeight = height + (isHeightOutside ? 1 : -1) * abs(heightOffset);\r\n                }\r\n            }\r\n            if (isCheckVertical) {\r\n                var nextOtherPos = otherPos.slice();\r\n                if (abs(deg - 90) < 2 || abs(deg - 270) < 2) {\r\n                    nextOtherPos[0] = fixedPosition[0];\r\n                }\r\n                var _c = solveNextOffset(fixedPosition, nextOtherPos, (fixedPosition[0] < otherPos[0] ? right_1 : left_1) - otherPos[0], true, datas), _d = __read(_c.offset, 1), widthOffset = _d[0], isWidthOutside = _c.isOutside;\r\n                if (!isNaN(widthOffset)) {\r\n                    maxWidth = width + (isWidthOutside ? 1 : -1) * abs(widthOffset);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return {\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n    };\r\n}\n\n/**\r\n * @namespace Draggable\r\n * @memberof Moveable\r\n * @description Draggable refers to the ability to drag and move targets.\r\n */\r\nvar Draggable = {\r\n    name: \"draggable\",\r\n    props: [\r\n        \"draggable\",\r\n        \"throttleDrag\",\r\n        \"throttleDragRotate\",\r\n        \"hideThrottleDragRotateLine\",\r\n        \"startDragRotate\",\r\n        \"edgeDraggable\",\r\n    ],\r\n    events: [\r\n        \"dragStart\",\r\n        \"drag\",\r\n        \"dragEnd\",\r\n        \"dragGroupStart\",\r\n        \"dragGroup\",\r\n        \"dragGroupEnd\",\r\n    ],\r\n    requestStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"left\", \"top\", \"right\", \"bottom\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, hideThrottleDragRotateLine = _a.hideThrottleDragRotateLine, throttleDragRotate = _a.throttleDragRotate, zoom = _a.zoom;\r\n        var _b = moveable.getState(), dragInfo = _b.dragInfo, beforeOrigin = _b.beforeOrigin;\r\n        if (hideThrottleDragRotateLine || !throttleDragRotate || !dragInfo) {\r\n            return [];\r\n        }\r\n        var dist = dragInfo.dist;\r\n        if (!dist[0] && !dist[1]) {\r\n            return [];\r\n        }\r\n        var width = getDistSize(dist);\r\n        var rad = getRad(dist, [0, 0]);\r\n        return [React.createElement(\"div\", { className: prefix(\"line\", \"horizontal\", \"dragline\", \"dashed\"), key: \"dragRotateGuideline\", style: {\r\n                    width: \"\".concat(width, \"px\"),\r\n                    transform: \"translate(\".concat(beforeOrigin[0], \"px, \").concat(beforeOrigin[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                } })];\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentGesto = e.parentGesto;\r\n        var state = moveable.state;\r\n        var gestos = state.gestos, style = state.style;\r\n        if (gestos.draggable) {\r\n            return false;\r\n        }\r\n        gestos.draggable = parentGesto || moveable.targetGesto;\r\n        datas.datas = {};\r\n        datas.left = parseFloat(style.left || \"\") || 0;\r\n        datas.top = parseFloat(style.top || \"\") || 0;\r\n        datas.bottom = parseFloat(style.bottom || \"\") || 0;\r\n        datas.right = parseFloat(style.right || \"\") || 0;\r\n        datas.startValue = [0, 0];\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"translate\");\r\n        startCheckSnapDrag(moveable, datas);\r\n        datas.prevDist = [0, 0];\r\n        datas.prevBeforeDist = [0, 0];\r\n        datas.isDrag = false;\r\n        datas.deltaOffset = [0, 0];\r\n        var params = fillParams(moveable, e, __assign({ set: function (translate) {\r\n                datas.startValue = translate;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = parentEvent || triggerEvent(moveable, \"onDragStart\", params);\r\n        if (result !== false) {\r\n            datas.isDrag = true;\r\n            moveable.state.dragInfo = {\r\n                startRect: moveable.getRect(),\r\n                dist: [0, 0],\r\n            };\r\n        }\r\n        else {\r\n            gestos.draggable = null;\r\n            datas.isPinch = false;\r\n        }\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"translate\");\r\n        var datas = e.datas, parentEvent = e.parentEvent, parentFlag = e.parentFlag, isPinch = e.isPinch, deltaOffset = e.deltaOffset, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentThrottleDrag = e.parentThrottleDrag;\r\n        var distX = e.distX, distY = e.distY;\r\n        var isDrag = datas.isDrag, prevDist = datas.prevDist, prevBeforeDist = datas.prevBeforeDist, startValue = datas.startValue;\r\n        if (!isDrag) {\r\n            return;\r\n        }\r\n        if (deltaOffset) {\r\n            distX += deltaOffset[0];\r\n            distY += deltaOffset[1];\r\n        }\r\n        var props = moveable.props;\r\n        var parentMoveable = props.parentMoveable;\r\n        var throttleDrag = isGroup ? 0 : (props.throttleDrag || parentThrottleDrag || 0);\r\n        var throttleDragRotate = parentEvent ? 0 : (props.throttleDragRotate || 0);\r\n        var dragRotateRad = 0;\r\n        var isVerticalSnap = false;\r\n        var isVerticalBound = false;\r\n        var isHorizontalSnap = false;\r\n        var isHorizontalBound = false;\r\n        if (!parentEvent && throttleDragRotate > 0 && (distX || distY)) {\r\n            var startDragRotate = props.startDragRotate || 0;\r\n            var deg = throttle(startDragRotate + getRad([0, 0], [distX, distY]) * 180 / Math.PI, throttleDragRotate)\r\n                - startDragRotate;\r\n            var ry = distY * Math.abs(Math.cos((deg - 90) / 180 * Math.PI));\r\n            var rx = distX * Math.abs(Math.cos(deg / 180 * Math.PI));\r\n            var r = getDistSize([rx, ry]);\r\n            dragRotateRad = deg * Math.PI / 180;\r\n            distX = r * Math.cos(dragRotateRad);\r\n            distY = r * Math.sin(dragRotateRad);\r\n        }\r\n        if (!isPinch && !parentEvent && !parentFlag) {\r\n            var _a = __read(checkSnapBoundsDrag(moveable, distX, distY, throttleDragRotate, (!useSnap && isRequest) || deltaOffset, datas), 2), verticalInfo = _a[0], horizontalInfo = _a[1];\r\n            isVerticalSnap = verticalInfo.isSnap;\r\n            isVerticalBound = verticalInfo.isBound;\r\n            isHorizontalSnap = horizontalInfo.isSnap;\r\n            isHorizontalBound = horizontalInfo.isBound;\r\n            var verticalOffset = verticalInfo.offset;\r\n            var horizontalOffset = horizontalInfo.offset;\r\n            distX += verticalOffset;\r\n            distY += horizontalOffset;\r\n        }\r\n        var beforeTranslate = plus(getBeforeDragDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        var translate = plus(getTransformDist({ datas: datas, distX: distX, distY: distY }), startValue);\r\n        throttleArray(translate, TINY_NUM);\r\n        throttleArray(beforeTranslate, TINY_NUM);\r\n        if (!throttleDragRotate) {\r\n            if (!isVerticalSnap && !isVerticalBound) {\r\n                translate[0] = throttle(translate[0], throttleDrag);\r\n                beforeTranslate[0] = throttle(beforeTranslate[0], throttleDrag);\r\n            }\r\n            if (!isHorizontalSnap && !isHorizontalBound) {\r\n                translate[1] = throttle(translate[1], throttleDrag);\r\n                beforeTranslate[1] = throttle(beforeTranslate[1], throttleDrag);\r\n            }\r\n        }\r\n        var beforeDist = minus(beforeTranslate, startValue);\r\n        var dist = minus(translate, startValue);\r\n        var delta = minus(dist, prevDist);\r\n        var beforeDelta = minus(beforeDist, prevBeforeDist);\r\n        datas.prevDist = dist;\r\n        datas.prevBeforeDist = beforeDist;\r\n        datas.passDelta = delta; //distX - (datas.passDistX || 0);\r\n        // datas.passDeltaY = distY - (datas.passDistY || 0);\r\n        datas.passDist = dist; //distX;\r\n        // datas.passDistY = distY;\r\n        var left = datas.left + beforeDist[0];\r\n        var top = datas.top + beforeDist[1];\r\n        var right = datas.right - beforeDist[0];\r\n        var bottom = datas.bottom - beforeDist[1];\r\n        var nextTransform = convertTransformFormat(datas, \"translate(\".concat(translate[0], \"px, \").concat(translate[1], \"px)\"), \"translate(\".concat(dist[0], \"px, \").concat(dist[1], \"px)\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        moveable.state.dragInfo.dist = parentEvent ? [0, 0] : dist;\r\n        if (!parentEvent && !parentMoveable && delta.every(function (num) { return !num; }) && beforeDelta.some(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var _b = moveable.state, width = _b.width, height = _b.height;\r\n        var params = fillParams(moveable, e, __assign({ transform: nextTransform, dist: dist, delta: delta, translate: translate, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeTranslate: beforeTranslate, left: left, top: top, right: right, bottom: bottom, width: width, height: height, isPinch: isPinch }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onDrag\", params);\r\n        return params;\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var deltaOffset = datas.deltaOffset;\r\n        if (deltaOffset[0] || deltaOffset[1]) {\r\n            datas.deltaOffset = [0, 0];\r\n            return this.drag(moveable, __assign(__assign({}, e), { deltaOffset: deltaOffset }));\r\n        }\r\n        return false;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var parentEvent = e.parentEvent, datas = e.datas;\r\n        moveable.state.dragInfo = null;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        datas.isDrag = false;\r\n        var param = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onDragEnd\", param);\r\n        return param;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _a, _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY;\r\n        var params = this.dragStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var _c = triggerChildGesto(moveable, this, \"dragStart\", [\r\n            clientX || 0,\r\n            clientY || 0,\r\n        ], e, false, \"draggable\"), childEvents = _c.childEvents, eventParams = _c.eventParams;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: eventParams });\r\n        var result = triggerEvent(moveable, \"onDragGroupStart\", nextParams);\r\n        datas.isDrag = result !== false;\r\n        // find data.startValue and based on first child moveable\r\n        var startValue = (_b = (_a = childEvents[0]) === null || _a === void 0 ? void 0 : _a.datas.startValue) !== null && _b !== void 0 ? _b : [0, 0];\r\n        datas.throttleOffset = [startValue[0] % 1, startValue[1] % 1];\r\n        return datas.isDrag ? params : false;\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        var params = this.drag(moveable, __assign(__assign({}, e), { parentThrottleDrag: moveable.props.throttleDrag }));\r\n        var passDelta = e.datas.passDelta;\r\n        var eventParams = triggerChildGesto(moveable, this, \"drag\", passDelta, e, false, \"draggable\").eventParams;\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: eventParams }, params);\r\n        triggerEvent(moveable, \"onDragGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isDrag) {\r\n            return;\r\n        }\r\n        this.dragEnd(moveable, e);\r\n        var eventParams = triggerChildGesto(moveable, this, \"dragEnd\", [0, 0], e, false, \"draggable\").eventParams;\r\n        triggerEvent(moveable, \"onDragGroupEnd\", fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: eventParams,\r\n        }));\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Draggable#request\r\n     * @param {object} [e] - the draggable's request parameter\r\n     * @param {number} [e.x] - x position\r\n     * @param {number} [e.y] - y position\r\n     * @param {number} [e.deltaX] - X number to move\r\n     * @param {number} [e.deltaY] - Y number to move\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"draggable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * // Use Absolute Value\r\n     * moveable.request(\"draggable\", { x: 200, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 220, y: 100 });\r\n     * moveable.request(\"draggable\", { x: 240, y: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: false,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return { datas: datas, useSnap: useSnap };\r\n            },\r\n            request: function (e) {\r\n                if (\"x\" in e) {\r\n                    distX = e.x - rect.left;\r\n                }\r\n                else if (\"deltaX\" in e) {\r\n                    distX += e.deltaX;\r\n                }\r\n                if (\"y\" in e) {\r\n                    distY = e.y - rect.top;\r\n                }\r\n                else if (\"deltaY\" in e) {\r\n                    distY += e.deltaY;\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, useSnap: useSnap };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.draggable = null;\r\n        moveable.state.dragInfo = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be dragged. (default: false)\r\n * @name Moveable.Draggable#draggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.draggable = true;\r\n */\r\n/**\r\n * throttle of x, y when drag.\r\n * @name Moveable.Draggable#throttleDrag\r\n * @default 0\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleDrag = 1;\r\n */\r\n/**\r\n* throttle of angle of x, y when drag.\r\n* @name Moveable.Draggable#throttleDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* moveable.throttleDragRotate = 45;\r\n*/\r\n/**\r\n* start angle of throttleDragRotate of x, y when drag.\r\n* @name Moveable.Draggable#startDragRotate\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body);\r\n*\r\n* // 45, 135, 225, 315\r\n* moveable.throttleDragRotate = 90;\r\n* moveable.startDragRotate = 45;\r\n*/\r\n/**\r\n * When the drag starts, the dragStart event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragStart\r\n * @param {Moveable.Draggable.OnDragStart} - Parameters for the dragStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When dragging, the drag event is called.\r\n * @memberof Moveable.Draggable\r\n * @event drag\r\n * @param {Moveable.Draggable.OnDrag} - Parameters for the drag event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"drag\", ({ target, transform }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the drag finishes, the dragEnd event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragEnd\r\n * @param {Moveable.Draggable.OnDragEnd} - Parameters for the dragEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { draggable: true });\r\n * moveable.on(\"dragEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group drag starts, the `dragGroupStart` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroupStart\r\n* @param {Moveable.Draggable.OnDragGroupStart} - Parameters for the `dragGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroupStart\", ({ targets }) => {\r\n*     console.log(\"onDragGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group drag, the `dragGroup` event is called.\r\n* @memberof Moveable.Draggable\r\n* @event dragGroup\r\n* @param {Moveable.Draggable.OnDragGroup} - Parameters for the `dragGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     draggable: true\r\n* });\r\n* moveable.on(\"dragGroup\", ({ targets, events }) => {\r\n*     console.log(\"onDragGroup\", targets);\r\n*     events.forEach(ev => {\r\n*          // drag event\r\n*          console.log(\"onDrag left, top\", ev.left, ev.top);\r\n*          // ev.target!.style.left = `${ev.left}px`;\r\n*          // ev.target!.style.top = `${ev.top}px`;\r\n*          console.log(\"onDrag translate\", ev.dist);\r\n*          ev.target!.style.transform = ev.transform;)\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group drag finishes, the `dragGroupEnd` event is called.\r\n * @memberof Moveable.Draggable\r\n * @event dragGroupEnd\r\n * @param {Moveable.Draggable.OnDragGroupEnd} - Parameters for the `dragGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     draggable: true\r\n * });\r\n * moveable.on(\"dragGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onDragGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getFixedDirectionInfo(startPositions, fixedDirection) {\r\n    var fixedPosition = getPosByDirection(startPositions, fixedDirection);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedDirectionInfo(state, fixedDirection) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var nextFixedOffset = [\r\n        width / 2 * (1 + fixedDirection[0]),\r\n        height / 2 * (1 + fixedDirection[1]),\r\n    ];\r\n    var fixedPosition = calculatePosition(allMatrix, nextFixedOffset, n);\r\n    var fixedOffset = [0, 0];\r\n    return {\r\n        fixedPosition: fixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\r\nfunction getOffsetFixedPositionInfo(state, offsetFixedPosition) {\r\n    // for start\r\n    var allMatrix = state.allMatrix, is3d = state.is3d, width = state.width, height = state.height;\r\n    var n = is3d ? 4 : 3;\r\n    var fixedDirection = getDirectionByPos(offsetFixedPosition, width, height);\r\n    var nextFixedPosition = calculatePosition(allMatrix, offsetFixedPosition, n);\r\n    var fixedOffset = [\r\n        width ? 0 : offsetFixedPosition[0],\r\n        height ? 0 : offsetFixedPosition[1],\r\n    ];\r\n    return {\r\n        fixedPosition: nextFixedPosition,\r\n        fixedDirection: fixedDirection,\r\n        fixedOffset: fixedOffset,\r\n    };\r\n}\n\n/**\r\n * @namespace Resizable\r\n * @memberof Moveable\r\n * @description Resizable indicates whether the target's width and height can be increased or decreased.\r\n */\r\nvar directionCondition$2 = getDirectionCondition(\"resizable\");\r\nvar Resizable = {\r\n    name: \"resizable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"resizable\",\r\n        \"throttleResize\",\r\n        \"renderDirections\",\r\n        \"displayAroundControls\",\r\n        \"keepRatio\",\r\n        \"resizeFormat\",\r\n        \"keepRatioFinally\",\r\n        \"edge\",\r\n        \"checkResizableError\",\r\n    ],\r\n    events: [\r\n        \"resizeStart\",\r\n        \"beforeResize\",\r\n        \"resize\",\r\n        \"resizeEnd\",\r\n        \"resizeGroupStart\",\r\n        \"beforeResizeGroup\",\r\n        \"resizeGroup\",\r\n        \"resizeGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"resizable\"),\r\n    dragControlCondition: directionCondition$2,\r\n    viewClassName: getDirectionViewClassName(\"resizable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var inputEvent = e.inputEvent, isPinch = e.isPinch, isGroup = e.isGroup, parentDirection = e.parentDirection, parentGesto = e.parentGesto, datas = e.datas, parentFixedDirection = e.parentFixedDirection, parentEvent = e.parentEvent;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var state = moveable.state;\r\n        var target = state.target, width = state.width, height = state.height, gestos = state.gestos;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (gestos.resizable) {\r\n            return false;\r\n        }\r\n        gestos.resizable = parentGesto || moveable.controlGesto;\r\n        !isPinch && setDragStart(moveable, e);\r\n        datas.datas = {};\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.prevWidth = 0;\r\n        datas.prevHeight = 0;\r\n        datas.minSize = [0, 0];\r\n        datas.startWidth = state.inlineCSSWidth || state.cssWidth;\r\n        datas.startHeight = state.inlineCSSHeight || state.cssHeight;\r\n        datas.maxSize = [Infinity, Infinity];\r\n        if (!isGroup) {\r\n            datas.minSize = [\r\n                state.minOffsetWidth,\r\n                state.minOffsetHeight,\r\n            ];\r\n            datas.maxSize = [\r\n                state.maxOffsetWidth,\r\n                state.maxOffsetHeight,\r\n            ];\r\n        }\r\n        var transformOrigin = moveable.props.transformOrigin || \"% %\";\r\n        datas.transformOrigin = transformOrigin && isString(transformOrigin)\r\n            ? transformOrigin.split(\" \")\r\n            : transformOrigin;\r\n        datas.startOffsetMatrix = state.offsetMatrix;\r\n        datas.startTransformOrigin = state.transformOrigin;\r\n        datas.isWidth = (_a = e === null || e === void 0 ? void 0 : e.parentIsWidth) !== null && _a !== void 0 ? _a : ((!direction[0] && !direction[1]) || direction[0] || !direction[1]);\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setFixedPosition(fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        function setMin(minSize) {\r\n            datas.minSize = [\r\n                convertUnitSize(\"\".concat(minSize[0]), 0) || 0,\r\n                convertUnitSize(\"\".concat(minSize[1]), 0) || 0,\r\n            ];\r\n        }\r\n        function setMax(maxSize) {\r\n            var nextMaxSize = [\r\n                maxSize[0] || Infinity,\r\n                maxSize[1] || Infinity,\r\n            ];\r\n            if (!isNumber(nextMaxSize[0]) || isFinite(nextMaxSize[0])) {\r\n                nextMaxSize[0] = convertUnitSize(\"\".concat(nextMaxSize[0]), 0) || Infinity;\r\n            }\r\n            if (!isNumber(nextMaxSize[1]) || isFinite(nextMaxSize[1])) {\r\n                nextMaxSize[1] = convertUnitSize(\"\".concat(nextMaxSize[1]), 0) || Infinity;\r\n            }\r\n            datas.maxSize = nextMaxSize;\r\n        }\r\n        setRatio(width / height);\r\n        setFixedDirection(parentFixedDirection || [-direction[0], -direction[1]]);\r\n        datas.setFixedDirection = setFixedDirection;\r\n        datas.setFixedPosition = setFixedPosition;\r\n        datas.setMin = setMin;\r\n        datas.setMax = setMax;\r\n        var params = fillParams(moveable, e, {\r\n            direction: direction,\r\n            startRatio: datas.ratio,\r\n            set: function (_a) {\r\n                var _b = __read(_a, 2), startWidth = _b[0], startHeight = _b[1];\r\n                datas.startWidth = startWidth;\r\n                datas.startHeight = startHeight;\r\n            },\r\n            setMin: setMin,\r\n            setMax: setMax,\r\n            setRatio: setRatio,\r\n            setFixedDirection: setFixedDirection,\r\n            setFixedPosition: setFixedPosition,\r\n            setOrigin: function (origin) {\r\n                datas.transformOrigin = origin;\r\n            },\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = parentEvent || triggerEvent(moveable, \"onResizeStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        datas.startFixedPosition = datas.fixedPosition;\r\n        if (result !== false) {\r\n            datas.isResize = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a;\r\n        var datas = e.datas, parentFlag = e.parentFlag, isPinch = e.isPinch, parentKeepRatio = e.parentKeepRatio, dragClient = e.dragClient, parentDist = e.parentDist, useSnap = e.useSnap, isRequest = e.isRequest, isGroup = e.isGroup, parentEvent = e.parentEvent, resolveMatrix = e.resolveMatrix;\r\n        var isResize = datas.isResize, transformOrigin = datas.transformOrigin, startWidth = datas.startWidth, startHeight = datas.startHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight, minSize = datas.minSize, maxSize = datas.maxSize, ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isWidth = datas.isWidth;\r\n        if (!isResize) {\r\n            return;\r\n        }\r\n        if (resolveMatrix) {\r\n            var is3d = moveable.state.is3d;\r\n            var startOffsetMatrix = datas.startOffsetMatrix, startTransformOrigin = datas.startTransformOrigin;\r\n            var n = is3d ? 4 : 3;\r\n            var targetMatrix = parseMat(getNextTransforms(e));\r\n            var targetN = Math.sqrt(targetMatrix.length);\r\n            if (n !== targetN) {\r\n                targetMatrix = convertDimension(targetMatrix, targetN, n);\r\n            }\r\n            var nextAllMatrix = getNextMatrix(startOffsetMatrix, targetMatrix, startTransformOrigin, n);\r\n            var poses = calculatePoses(nextAllMatrix, startOffsetWidth, startOffsetHeight, n);\r\n            datas.startPositions = poses;\r\n            datas.nextTargetMatrix = targetMatrix;\r\n            datas.nextAllMatrix = nextAllMatrix;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        var resizeFormat = props.resizeFormat, _b = props.throttleResize, throttleResize = _b === void 0 ? parentFlag ? 0 : 1 : _b, parentMoveable = props.parentMoveable, keepRatioFinally = props.keepRatioFinally;\r\n        var direction = datas.direction;\r\n        var sizeDirection = direction;\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        function getNextBoundingSize() {\r\n            var fixedDirection = datas.fixedDirection;\r\n            var nextSize = getOffsetSizeDist(sizeDirection, keepRatio, datas, e);\r\n            distWidth = nextSize.distWidth;\r\n            distHeight = nextSize.distHeight;\r\n            var nextWidth = (sizeDirection[0] - fixedDirection[0]) || keepRatio\r\n                ? Math.max(startOffsetWidth + distWidth, TINY_NUM) : startOffsetWidth;\r\n            var nextHeight = (sizeDirection[1] - fixedDirection[1]) || keepRatio\r\n                ? Math.max(startOffsetHeight + distHeight, TINY_NUM) : startOffsetHeight;\r\n            if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n                // startOffsetWidth : startOffsetHeight = nextWidth : nextHeight\r\n                if (isWidth) {\r\n                    nextHeight = nextWidth / ratio;\r\n                }\r\n                else {\r\n                    nextWidth = nextHeight * ratio;\r\n                }\r\n            }\r\n            return [nextWidth, nextHeight];\r\n        }\r\n        var _c = __read(getNextBoundingSize(), 2), boundingWidth = _c[0], boundingHeight = _c[1];\r\n        if (!parentEvent) {\r\n            datas.setFixedDirection(datas.fixedDirection);\r\n            triggerEvent(moveable, \"onBeforeResize\", fillParams(moveable, e, {\r\n                startFixedDirection: datas.startFixedDirection,\r\n                startFixedPosition: datas.startFixedPosition,\r\n                setFixedDirection: function (nextFixedDirection) {\r\n                    var _a;\r\n                    datas.setFixedDirection(nextFixedDirection);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                setFixedPosition: function (nextFixedPosition) {\r\n                    var _a;\r\n                    datas.setFixedPosition(nextFixedPosition);\r\n                    _a = __read(getNextBoundingSize(), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                    return [boundingWidth, boundingHeight];\r\n                },\r\n                boundingWidth: boundingWidth,\r\n                boundingHeight: boundingHeight,\r\n                setSize: function (size) {\r\n                    var _a;\r\n                    _a = __read(size, 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n                },\r\n            }, true));\r\n        }\r\n        var fixedPosition = dragClient;\r\n        if (!dragClient) {\r\n            if (!parentFlag && isPinch) {\r\n                fixedPosition = getAbsolutePosition(moveable, [0, 0]);\r\n            }\r\n            else {\r\n                fixedPosition = datas.fixedPosition;\r\n            }\r\n        }\r\n        var snapDist = [0, 0];\r\n        if (!isPinch) {\r\n            snapDist = checkSnapResize(moveable, boundingWidth, boundingHeight, direction, fixedPosition, !useSnap && isRequest, datas);\r\n        }\r\n        if (parentDist) {\r\n            !parentDist[0] && (snapDist[0] = 0);\r\n            !parentDist[1] && (snapDist[1] = 0);\r\n        }\r\n        function computeSize() {\r\n            var _a;\r\n            if (resizeFormat) {\r\n                _a = __read(resizeFormat([boundingWidth, boundingHeight]), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n            }\r\n            boundingWidth = throttle(boundingWidth, throttleResize);\r\n            boundingHeight = throttle(boundingHeight, throttleResize);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (abs(snapDist[0]) > abs(snapDist[1])) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // pre-compute before maintaining the ratio\r\n                computeSize();\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                boundingWidth += snapDist[0];\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                boundingHeight += snapDist[1];\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        else {\r\n            boundingWidth += snapDist[0];\r\n            boundingHeight += snapDist[1];\r\n            boundingWidth = Math.max(0, boundingWidth);\r\n            boundingHeight = Math.max(0, boundingHeight);\r\n        }\r\n        _a = __read(calculateBoundSize([boundingWidth, boundingHeight], minSize, maxSize, keepRatio ? ratio : false), 2), boundingWidth = _a[0], boundingHeight = _a[1];\r\n        computeSize();\r\n        if (keepRatio && (isGroup || keepRatioFinally)) {\r\n            if (isWidth) {\r\n                boundingHeight = boundingWidth / ratio;\r\n            }\r\n            else {\r\n                boundingWidth = boundingHeight * ratio;\r\n            }\r\n        }\r\n        distWidth = boundingWidth - startOffsetWidth;\r\n        distHeight = boundingHeight - startOffsetHeight;\r\n        var delta = [distWidth - prevWidth, distHeight - prevHeight];\r\n        datas.prevWidth = distWidth;\r\n        datas.prevHeight = distHeight;\r\n        var inverseDelta = getResizeDist(moveable, boundingWidth, boundingHeight, fixedPosition, transformOrigin, datas);\r\n        if (!parentMoveable && delta.every(function (num) { return !num; }) && inverseDelta.every(function (num) { return !num; })) {\r\n            return;\r\n        }\r\n        var drag = Draggable.drag(moveable, setCustomDrag(e, moveable.state, inverseDelta, !!isPinch, false, \"draggable\"));\r\n        var transform = drag.transform;\r\n        var nextWidth = startWidth + distWidth;\r\n        var nextHeight = startHeight + distHeight;\r\n        var params = fillParams(moveable, e, __assign({ width: nextWidth, height: nextHeight, offsetWidth: Math.round(boundingWidth), offsetHeight: Math.round(boundingHeight), startRatio: ratio, boundingWidth: boundingWidth, boundingHeight: boundingHeight, direction: direction, dist: [distWidth, distHeight], delta: delta, isPinch: !!isPinch, drag: drag }, fillAfterTransform({\r\n            style: {\r\n                width: \"\".concat(nextWidth, \"px\"),\r\n                height: \"\".concat(nextHeight, \"px\"),\r\n            },\r\n            transform: transform,\r\n        }, drag, e)));\r\n        !parentEvent && triggerEvent(moveable, \"onResize\", params);\r\n        return params;\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var isResize = datas.isResize, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, prevWidth = datas.prevWidth, prevHeight = datas.prevHeight;\r\n        if (!isResize || moveable.props.checkResizableError === false) {\r\n            return;\r\n        }\r\n        var _a = moveable.state, width = _a.width, height = _a.height;\r\n        var errorWidth = width - (startOffsetWidth + prevWidth);\r\n        var errorHeight = height - (startOffsetHeight + prevHeight);\r\n        var isErrorWidth = abs(errorWidth) > 3;\r\n        var isErrorHeight = abs(errorHeight) > 3;\r\n        if (isErrorWidth) {\r\n            datas.startWidth += errorWidth;\r\n            datas.startOffsetWidth += errorWidth;\r\n            datas.prevWidth += errorWidth;\r\n        }\r\n        if (isErrorHeight) {\r\n            datas.startHeight += errorHeight;\r\n            datas.startOffsetHeight += errorHeight;\r\n            datas.prevHeight += errorHeight;\r\n        }\r\n        if (isErrorWidth || isErrorHeight) {\r\n            return this.dragControl(moveable, e);\r\n        }\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, parentEvent = e.parentEvent;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        datas.isResize = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        !parentEvent && triggerEvent(moveable, \"onResizeEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: directionCondition$2,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        var parentStartOffsetWidth = datas.startOffsetWidth, parentStartOffsetHeight = datas.startOffsetHeight;\r\n        function updateGroupMin() {\r\n            var originalMinSize = datas.minSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMinSize = _a.minSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMinWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMinSize[0] / childStartOffsetWidth : 0);\r\n                var parentMinHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMinSize[1] / childStartOffsetHeight : 0);\r\n                originalMinSize[0] = Math.max(originalMinSize[0], parentMinWidth);\r\n                originalMinSize[1] = Math.max(originalMinSize[1], parentMinHeight);\r\n            });\r\n        }\r\n        function updateGroupMax() {\r\n            var originalMaxSize = datas.maxSize;\r\n            originalEvents.forEach(function (ev) {\r\n                var _a = ev.datas, childMaxSize = _a.maxSize, childStartOffsetWidth = _a.startOffsetWidth, childStartOffsetHeight = _a.startOffsetHeight;\r\n                var parentMaxWidth = parentStartOffsetWidth\r\n                    * (childStartOffsetWidth ? childMaxSize[0] / childStartOffsetWidth : 0);\r\n                var parentMaxHeight = parentStartOffsetHeight\r\n                    * (childStartOffsetHeight ? childMaxSize[1] / childStartOffsetHeight : 0);\r\n                originalMaxSize[0] = Math.min(originalMaxSize[0], parentMaxWidth);\r\n                originalMaxSize[1] = Math.min(originalMaxSize[1], parentMaxHeight);\r\n            });\r\n        }\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        updateGroupMin();\r\n        updateGroupMax();\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events.map(function (ev) {\r\n                return __assign(__assign({}, ev), { setMin: function (minSize) {\r\n                        ev.setMin(minSize);\r\n                        updateGroupMin();\r\n                    }, setMax: function (maxSize) {\r\n                        ev.setMax(maxSize);\r\n                        updateGroupMax();\r\n                    } });\r\n            }), setFixedDirection: setFixedDirection, setMin: function (minSize) {\r\n                params.setMin(minSize);\r\n                updateGroupMin();\r\n            }, setMax: function (maxSize) {\r\n                params.setMax(maxSize);\r\n                updateGroupMax();\r\n            } });\r\n        var result = triggerEvent(moveable, \"onResizeGroupStart\", nextParams);\r\n        datas.isResize = result !== false;\r\n        return datas.isResize ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        var props = getProps(moveable.props, \"resizable\");\r\n        catchEvent(moveable, \"onBeforeResize\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeResizeGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, __assign(__assign({}, e), { isGroup: true }));\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var boundingWidth = params.boundingWidth, boundingHeight = params.boundingHeight, dist = params.dist;\r\n        var keepRatio = props.keepRatio;\r\n        var parentScale = [\r\n            boundingWidth / (boundingWidth - dist[0]),\r\n            boundingHeight / (boundingHeight - dist[1]),\r\n        ];\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * parentScale[0],\r\n                ev.datas.originalY * parentScale[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: parentScale, dragClient: plus(fixedPosition, [clientX, clientY]), parentKeepRatio: keepRatio });\r\n        });\r\n        var nextParams = __assign({ targets: props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onResizeGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isResize) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onResizeGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Resizable#request\r\n     * @param {Moveable.Resizable.ResizableRequestParam} e - the Resizable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * // Use Relative Value\r\n     * moveable.request(\"resizable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"resizable\");\r\n     *\r\n     * // request\r\n     * // Use Relative Value\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // Use Absolute Value\r\n     * moveable.request(\"resizable\", { offsetWidth: 100, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 110, offsetHeight: 100 });\r\n     * moveable.request(\"resizable\", { offsetWidth: 120, offsetHeight: 100 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        var rect = moveable.getRect();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                var _a;\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    parentIsWidth: (_a = e === null || e === void 0 ? void 0 : e.horizontal) !== null && _a !== void 0 ? _a : true,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                if (\"offsetWidth\" in e) {\r\n                    distWidth = e.offsetWidth - rect.offsetWidth;\r\n                }\r\n                else if (\"deltaWidth\" in e) {\r\n                    distWidth += e.deltaWidth;\r\n                }\r\n                if (\"offsetHeight\" in e) {\r\n                    distHeight = e.offsetHeight - rect.offsetHeight;\r\n                }\r\n                else if (\"deltaHeight\" in e) {\r\n                    distHeight += e.deltaHeight;\r\n                }\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.gestos.resizable = null;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be resized.\r\n * @name Moveable.Resizable#resizable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     resizable: false,\r\n * });\r\n *\r\n * moveable.resizable = true;\r\n */\r\n/**\r\n * throttle of width, height when resize. If throttleResize is set to less than 1, the target may shake.\r\n * @name Moveable.Resizable#throttleResize\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   throttleResize: 1,\r\n * });\r\n *\r\n * moveable.throttleResize = 0;\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height.\r\n * @name Moveable.Resizable#keepRatio\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * Set directions to show the control box.\r\n * @name Moveable.Resizable#renderDirections\r\n * @default [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"]\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * Function to convert size for resize\r\n * @name Moveable.Resizable#resizeFormat\r\n * @default oneself\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   resizable: true,\r\n *   resizeFormat: v => v,\r\n * });\r\n *\r\n * moveable.resizeFormat = (size: number[]) => ([Math.trunc(size[0]), Math.trunc(size[1])];\r\n */\r\n/**\r\n * When the resize starts, the resizeStart event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeStart\r\n * @param {Moveable.Resizable.OnResizeStart} - Parameters for the resizeStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When resizing, `beforeResize` is called before `resize` occurs. In `beforeResize`, you can get and set the pre-value before resizing.\r\n * @memberof Moveable.Resizable\r\n * @event beforeResize\r\n * @param {Moveable.Resizable.OnBeforeResize} - Parameters for the `beforeResize` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"beforeResize\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"resize\", ({ target, width, height, drag }) => {\r\n *     target.style.width = `${width}px`;\r\n *     target.style.height = `${height}px`;\r\n *     target.style.transform = drag.transform;\r\n * });\r\n */\r\n/**\r\n * When resizing, the resize event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resize\r\n * @param {Moveable.Resizable.OnResize} - Parameters for the resize event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resize\", ({ target, width, height }) => {\r\n *     target.style.width = `${e.width}px`;\r\n *     target.style.height = `${e.height}px`;\r\n * });\r\n */\r\n/**\r\n * When the resize finishes, the resizeEnd event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeEnd\r\n * @param {Moveable.Resizable.OnResizeEnd} - Parameters for the resizeEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { resizable: true });\r\n * moveable.on(\"resizeEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group resize starts, the `resizeGroupStart` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroupStart\r\n* @param {Moveable.Resizable.OnResizeGroupStart} - Parameters for the `resizeGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroupStart\", ({ targets }) => {\r\n*     console.log(\"onResizeGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group resize, the `resizeGroup` event is called.\r\n* @memberof Moveable.Resizable\r\n* @event resizeGroup\r\n* @param {Moveable.Resizable.onResizeGroup} - Parameters for the `resizeGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     resizable: true\r\n* });\r\n* moveable.on(\"resizeGroup\", ({ targets, events }) => {\r\n*     console.log(\"onResizeGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const offset = [\r\n*             direction[0] < 0 ? -ev.delta[0] : 0,\r\n*             direction[1] < 0 ? -ev.delta[1] : 0,\r\n*         ];\r\n*         // ev.drag is a drag event that occurs when the group resize.\r\n*         const left = offset[0] + ev.drag.beforeDist[0];\r\n*         const top = offset[1] + ev.drag.beforeDist[1];\r\n*         const width = ev.width;\r\n*         const top = ev.top;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group resize finishes, the `resizeGroupEnd` event is called.\r\n * @memberof Moveable.Resizable\r\n * @event resizeGroupEnd\r\n * @param {Moveable.Resizable.OnResizeGroupEnd} - Parameters for the `resizeGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     resizable: true\r\n * });\r\n * moveable.on(\"resizeGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onResizeGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\n/**\r\n * @namespace Rotatable\r\n * @memberof Moveable\r\n * @description Rotatable indicates whether the target can be rotated.\r\n */\r\nfunction setRotateStartInfo(moveable, datas, clientX, clientY, rect) {\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var n = state.is3d ? 4 : 3;\r\n    var origin = datas.origin;\r\n    var nextOrigin = calculatePosition(moveable.state.rootMatrix, \r\n    // TO-DO #710\r\n    minus([origin[0], origin[1]], groupable ? [0, 0] : [state.left, state.top]), n);\r\n    var startAbsoluteOrigin = plus([rect.left, rect.top], nextOrigin);\r\n    datas.startAbsoluteOrigin = startAbsoluteOrigin;\r\n    datas.prevDeg = getRad(startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180;\r\n    datas.defaultDeg = datas.prevDeg;\r\n    datas.prevSnapDeg = 0;\r\n    datas.loop = 0;\r\n    datas.startDist = getDist$1(startAbsoluteOrigin, [clientX, clientY]);\r\n}\r\nfunction getAbsoluteDist(deg, direction, datas) {\r\n    var defaultDeg = datas.defaultDeg, prevDeg = datas.prevDeg;\r\n    var normalizedPrevDeg = prevDeg % 360;\r\n    var loop = Math.floor(prevDeg / 360);\r\n    if (normalizedPrevDeg < 0) {\r\n        normalizedPrevDeg += 360;\r\n    }\r\n    if (normalizedPrevDeg > deg && normalizedPrevDeg > 270 && deg < 90) {\r\n        // 360 => 0\r\n        ++loop;\r\n    }\r\n    else if (normalizedPrevDeg < deg && normalizedPrevDeg < 90 && deg > 270) {\r\n        // 0 => 360\r\n        --loop;\r\n    }\r\n    var dist = direction * (loop * 360 + deg - defaultDeg);\r\n    datas.prevDeg = defaultDeg + dist;\r\n    return dist;\r\n}\r\nfunction getAbsoluteDistByClient(clientX, clientY, direction, datas) {\r\n    return getAbsoluteDist(getRad(datas.startAbsoluteOrigin, [clientX, clientY]) / Math.PI * 180, direction, datas);\r\n}\r\nfunction getRotateInfo(moveable, moveableRect, datas, dist, startValue, checkSnap) {\r\n    var _a = moveable.props.throttleRotate, throttleRotate = _a === void 0 ? 0 : _a;\r\n    var prevSnapDeg = datas.prevSnapDeg;\r\n    var snapRotation = 0;\r\n    var isSnap = false;\r\n    if (checkSnap) {\r\n        var result = checkSnapRotate(moveable, moveableRect, dist, startValue + dist);\r\n        isSnap = result.isSnap;\r\n        snapRotation = startValue + result.dist;\r\n    }\r\n    if (!isSnap) {\r\n        snapRotation = throttle(startValue + dist, throttleRotate);\r\n    }\r\n    var snapDeg = snapRotation - startValue;\r\n    datas.prevSnapDeg = snapDeg;\r\n    return [snapDeg - prevSnapDeg, snapDeg, snapRotation];\r\n}\r\nfunction getRotationPositions(rotationPosition, _a, direction) {\r\n    var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n    if (rotationPosition === \"none\") {\r\n        return [];\r\n    }\r\n    if (isArray(rotationPosition)) {\r\n        return rotationPosition.map(function (child) { return getRotationPositions(child, [pos1, pos2, pos3, pos4], direction)[0]; });\r\n    }\r\n    var _c = __read((rotationPosition || \"top\").split(\"-\"), 2), dir1 = _c[0], dir2 = _c[1];\r\n    var radPoses = [pos1, pos2];\r\n    if (dir1 === \"left\") {\r\n        radPoses = [pos3, pos1];\r\n    }\r\n    else if (dir1 === \"right\") {\r\n        radPoses = [pos2, pos4];\r\n    }\r\n    else if (dir1 === \"bottom\") {\r\n        radPoses = [pos4, pos3];\r\n    }\r\n    var pos = [\r\n        (radPoses[0][0] + radPoses[1][0]) / 2,\r\n        (radPoses[0][1] + radPoses[1][1]) / 2,\r\n    ];\r\n    var rad = getRotationRad(radPoses, direction);\r\n    if (dir2) {\r\n        var isStart = dir2 === \"top\" || dir2 === \"left\";\r\n        var isReverse = dir1 === \"bottom\" || dir1 === \"left\";\r\n        pos = radPoses[(isStart && !isReverse) || (!isStart && isReverse) ? 0 : 1];\r\n    }\r\n    return [[pos, rad]];\r\n}\r\nfunction dragControlCondition(moveable, e) {\r\n    if (e.isRequest) {\r\n        return e.requestAble === \"rotatable\";\r\n    }\r\n    var target = e.inputEvent.target;\r\n    if (hasClass(target, prefix(\"rotation-control\"))\r\n        || (moveable.props.rotateAroundControls && hasClass(target, prefix(\"around-control\")))\r\n        || (hasClass(target, prefix(\"control\")) && hasClass(target, prefix(\"rotatable\")))) {\r\n        return true;\r\n    }\r\n    var rotationTarget = moveable.props.rotationTarget;\r\n    if (rotationTarget) {\r\n        return getRefTargets(rotationTarget, true).some(function (element) {\r\n            if (!element) {\r\n                return false;\r\n            }\r\n            return target === element || target.contains(element);\r\n        });\r\n    }\r\n    return false;\r\n}\r\nvar css = \".rotation {\\nposition: absolute;\\nheight: 40px;\\nwidth: 1px;\\ntransform-origin: 50% 100%;\\nheight: calc(40px * var(--zoom));\\ntop: auto;\\nleft: 0;\\nbottom: 100%;\\nwill-change: transform;\\n}\\n.rotation .rotation-line {\\ndisplay: block;\\nwidth: 100%;\\nheight: 100%;\\ntransform-origin: 50% 50%;\\n}\\n.rotation .rotation-control {\\nborder-color: #4af;\\nborder-color: var(--moveable-color);\\nbackground:#fff;\\ncursor: alias;\\n}\\n:global .view-rotation-dragging, .rotatable.direction.control {\\ncursor: alias;\\n}\\n.rotatable.direction.control.move {\\ncursor: move;\\n}\\n\";\r\nvar Rotatable = {\r\n    name: \"rotatable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"rotatable\",\r\n        \"rotationPosition\",\r\n        \"throttleRotate\",\r\n        \"renderDirections\",\r\n        \"rotationTarget\",\r\n        \"rotateAroundControls\",\r\n        \"edge\",\r\n        \"resolveAblesWithRotatable\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"rotateStart\",\r\n        \"beforeRotate\",\r\n        \"rotate\",\r\n        \"rotateEnd\",\r\n        \"rotateGroupStart\",\r\n        \"beforeRotateGroup\",\r\n        \"rotateGroup\",\r\n        \"rotateGroupEnd\",\r\n    ],\r\n    css: [css],\r\n    viewClassName: function (moveable) {\r\n        if (!moveable.isDragging(\"rotatable\")) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-rotation-dragging\");\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = getProps(moveable.props, \"rotatable\"), rotatable = _a.rotatable, rotationPosition = _a.rotationPosition, zoom = _a.zoom, renderDirections = _a.renderDirections, rotateAroundControls = _a.rotateAroundControls, resolveAblesWithRotatable = _a.resolveAblesWithRotatable;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, direction = _b.direction;\r\n        if (!rotatable) {\r\n            return null;\r\n        }\r\n        var positions = getRotationPositions(rotationPosition, renderPoses, direction);\r\n        var jsxs = [];\r\n        positions.forEach(function (_a, i) {\r\n            var _b = __read(_a, 2), pos = _b[0], rad = _b[1];\r\n            jsxs.push(React.createElement(\"div\", { key: \"rotation\".concat(i), className: prefix(\"rotation\"), style: {\r\n                    // tslint:disable-next-line: max-line-length\r\n                    transform: \"translate(-50%) translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rad, \"rad)\"),\r\n                } },\r\n                React.createElement(\"div\", { className: prefix(\"line rotation-line\"), style: {\r\n                        transform: \"scaleX(\".concat(zoom, \")\"),\r\n                    } }),\r\n                React.createElement(\"div\", { className: prefix(\"control rotation-control\"), style: {\r\n                        transform: \"translate(0.5px) scale(\".concat(zoom, \")\"),\r\n                    } })));\r\n        });\r\n        if (renderDirections) {\r\n            var ables = getKeys(resolveAblesWithRotatable || {});\r\n            var resolveMap_1 = {};\r\n            ables.forEach(function (name) {\r\n                resolveAblesWithRotatable[name].forEach(function (direction) {\r\n                    resolveMap_1[direction] = name;\r\n                });\r\n            });\r\n            var directionControlInfos = [];\r\n            if (isArray(renderDirections)) {\r\n                directionControlInfos = renderDirections.map(function (dir) {\r\n                    var able = resolveMap_1[dir];\r\n                    return {\r\n                        data: able ? { resolve: able } : {},\r\n                        classNames: able ? [\"move\"] : [],\r\n                        dir: dir,\r\n                    };\r\n                });\r\n            }\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderDirectionControlsByInfos(moveable, \"rotatable\", directionControlInfos, React)), false));\r\n        }\r\n        if (rotateAroundControls) {\r\n            jsxs.push.apply(jsxs, __spreadArray([], __read(renderAroundControls(moveable, React)), false));\r\n        }\r\n        return jsxs;\r\n    },\r\n    dragControlCondition: dragControlCondition,\r\n    dragControlStart: function (moveable, e) {\r\n        var _a;\r\n        var _b;\r\n        var datas = e.datas, clientX = e.clientX, clientY = e.clientY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        var state = moveable.state;\r\n        var target = state.target, left = state.left, top = state.top, direction = state.direction, beforeDirection = state.beforeDirection, targetTransform = state.targetTransform, moveableClientRect = state.moveableClientRect, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, allMatrix = state.allMatrix, width = state.width, height = state.height;\r\n        if (!isRequest && !target) {\r\n            return false;\r\n        }\r\n        var rect = moveable.getRect();\r\n        datas.rect = rect;\r\n        datas.transform = targetTransform;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        var setFixedPosition = function (fixedPosition) {\r\n            var result = getOffsetFixedPositionInfo(moveable.state, fixedPosition);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedPosition(fixedPosition);\r\n            }\r\n        };\r\n        var setFixedDirection = function (fixedDirection) {\r\n            var result = getOffsetFixedDirectionInfo(moveable.state, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedOffset = result.fixedOffset;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            if (resizeStart) {\r\n                resizeStart.setFixedDirection(fixedDirection);\r\n            }\r\n        };\r\n        var startClientX = clientX;\r\n        var startClientY = clientY;\r\n        if (isRequest || isPinch || parentFlag) {\r\n            var externalRotate = parentRotate || 0;\r\n            datas.beforeInfo = {\r\n                origin: rect.beforeOrigin,\r\n                prevDeg: externalRotate,\r\n                defaultDeg: externalRotate,\r\n                prevSnapDeg: 0,\r\n                startDist: 0,\r\n            };\r\n            datas.afterInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin });\r\n            datas.absoluteInfo = __assign(__assign({}, datas.beforeInfo), { origin: rect.origin, startValue: externalRotate });\r\n        }\r\n        else {\r\n            var inputTarget = (_b = e.inputEvent) === null || _b === void 0 ? void 0 : _b.target;\r\n            if (inputTarget) {\r\n                var regionDirection = inputTarget.getAttribute(\"data-direction\") || \"\";\r\n                var controlDirection = DIRECTION_REGION_TO_DIRECTION[regionDirection];\r\n                if (controlDirection) {\r\n                    datas.isControl = true;\r\n                    datas.isAroundControl = hasClass(inputTarget, prefix(\"around-control\"));\r\n                    datas.controlDirection = controlDirection;\r\n                    var resolve = inputTarget.getAttribute(\"data-resolve\");\r\n                    if (resolve) {\r\n                        datas.resolveAble = resolve;\r\n                    }\r\n                    var clientPoses = calculateMoveableClientPositions(state.rootMatrix, state.renderPoses, moveableClientRect);\r\n                    _a = __read(getPosByDirection(clientPoses, controlDirection), 2), startClientX = _a[0], startClientY = _a[1];\r\n                }\r\n            }\r\n            datas.beforeInfo = { origin: rect.beforeOrigin };\r\n            datas.afterInfo = { origin: rect.origin };\r\n            datas.absoluteInfo = {\r\n                origin: rect.origin,\r\n                startValue: rect.rotation,\r\n            };\r\n            var originalFixedPosition_1 = setFixedPosition;\r\n            setFixedPosition = function (fixedPosition) {\r\n                var n = state.is3d ? 4 : 3;\r\n                var _a = __read(plus(getOrigin(targetMatrix, n), fixedPosition), 2), originX = _a[0], originY = _a[1];\r\n                var fixedBeforeOrigin = calculate(offsetMatrix, convertPositionMatrix([originX, originY], n));\r\n                var fixedAfterOrigin = calculate(allMatrix, convertPositionMatrix([fixedPosition[0], fixedPosition[1]], n));\r\n                originalFixedPosition_1(fixedPosition);\r\n                var posDelta = state.posDelta;\r\n                datas.beforeInfo.origin = minus(fixedBeforeOrigin, posDelta);\r\n                datas.afterInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                datas.absoluteInfo.origin = minus(fixedAfterOrigin, posDelta);\r\n                setRotateStartInfo(moveable, datas.beforeInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.afterInfo, startClientX, startClientY, moveableClientRect);\r\n                setRotateStartInfo(moveable, datas.absoluteInfo, startClientX, startClientY, moveableClientRect);\r\n            };\r\n            setFixedDirection = function (fixedDirection) {\r\n                var fixedPosition = getPosByDirection([\r\n                    [0, 0],\r\n                    [width, 0],\r\n                    [0, height],\r\n                    [width, height],\r\n                ], fixedDirection);\r\n                setFixedPosition(fixedPosition);\r\n            };\r\n        }\r\n        datas.startClientX = startClientX;\r\n        datas.startClientY = startClientY;\r\n        datas.direction = direction;\r\n        datas.beforeDirection = beforeDirection;\r\n        datas.startValue = 0;\r\n        datas.datas = {};\r\n        setDefaultTransformIndex(moveable, e, \"rotate\");\r\n        var dragStart = false;\r\n        var resizeStart = false;\r\n        if (datas.isControl && datas.resolveAble) {\r\n            var resolveAble = datas.resolveAble;\r\n            if (resolveAble === \"resizable\") {\r\n                resizeStart = Resizable.dragControlStart(moveable, __assign(__assign({}, (new CustomGesto(\"resizable\").dragStart([0, 0], e))), { parentPosition: datas.controlPosition, parentFixedPosition: datas.fixedPosition }));\r\n            }\r\n        }\r\n        if (!resizeStart) {\r\n            dragStart = Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e));\r\n        }\r\n        setFixedPosition(getTotalOrigin(moveable));\r\n        var params = fillParams(moveable, e, __assign(__assign({ set: function (rotatation) {\r\n                datas.startValue = rotatation * Math.PI / 180;\r\n            }, setFixedDirection: setFixedDirection, setFixedPosition: setFixedPosition }, fillTransformStartEvent(moveable, e)), { dragStart: dragStart, resizeStart: resizeStart }));\r\n        var result = triggerEvent(moveable, \"onRotateStart\", params);\r\n        datas.isRotate = result !== false;\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n        };\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, clientDistX = e.clientDistX, clientDistY = e.clientDistY, parentRotate = e.parentRotate, parentFlag = e.parentFlag, isPinch = e.isPinch, groupDelta = e.groupDelta, resolveMatrix = e.resolveMatrix;\r\n        var beforeDirection = datas.beforeDirection, beforeInfo = datas.beforeInfo, afterInfo = datas.afterInfo, absoluteInfo = datas.absoluteInfo, isRotate = datas.isRotate, startValue = datas.startValue, rect = datas.rect, startClientX = datas.startClientX, startClientY = datas.startClientY;\r\n        if (!isRotate) {\r\n            return;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"rotate\");\r\n        var targetDirection = getTransformDirection(e);\r\n        var direction = beforeDirection * targetDirection;\r\n        var parentMoveable = moveable.props.parentMoveable;\r\n        var beforeDelta = 0;\r\n        var beforeDist;\r\n        var beforeRotation;\r\n        var delta = 0;\r\n        var dist;\r\n        var rotation;\r\n        var absoluteDelta = 0;\r\n        var absoluteDist;\r\n        var absoluteRotation;\r\n        var startRotation = 180 / Math.PI * startValue;\r\n        var absoluteStartRotation = absoluteInfo.startValue;\r\n        var isSnap = false;\r\n        var nextClientX = startClientX + clientDistX;\r\n        var nextClientY = startClientY + clientDistY;\r\n        if (!parentFlag && \"parentDist\" in e) {\r\n            var parentDist = e.parentDist;\r\n            beforeDist = parentDist;\r\n            dist = parentDist;\r\n            absoluteDist = parentDist;\r\n        }\r\n        else if (isPinch || parentFlag) {\r\n            beforeDist = getAbsoluteDist(parentRotate, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDist(parentRotate, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDist(parentRotate, direction, absoluteInfo);\r\n        }\r\n        else {\r\n            beforeDist = getAbsoluteDistByClient(nextClientX, nextClientY, beforeDirection, beforeInfo);\r\n            dist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, afterInfo);\r\n            absoluteDist = getAbsoluteDistByClient(nextClientX, nextClientY, direction, absoluteInfo);\r\n            isSnap = true;\r\n        }\r\n        beforeRotation = startRotation + beforeDist;\r\n        rotation = startRotation + dist;\r\n        absoluteRotation = absoluteStartRotation + absoluteDist;\r\n        triggerEvent(moveable, \"onBeforeRotate\", fillParams(moveable, e, {\r\n            beforeRotation: beforeRotation,\r\n            rotation: rotation,\r\n            absoluteRotation: absoluteRotation,\r\n            setRotation: function (nextRotation) {\r\n                dist = nextRotation - startRotation;\r\n                beforeDist = dist;\r\n                absoluteDist = dist;\r\n            },\r\n        }, true));\r\n        _a = __read(getRotateInfo(moveable, rect, beforeInfo, beforeDist, startRotation, isSnap), 3), beforeDelta = _a[0], beforeDist = _a[1], beforeRotation = _a[2];\r\n        _b = __read(getRotateInfo(moveable, rect, afterInfo, dist, startRotation, isSnap), 3), delta = _b[0], dist = _b[1], rotation = _b[2];\r\n        _c = __read(getRotateInfo(moveable, rect, absoluteInfo, absoluteDist, absoluteStartRotation, isSnap), 3), absoluteDelta = _c[0], absoluteDist = _c[1], absoluteRotation = _c[2];\r\n        if (!absoluteDelta && !delta && !beforeDelta && !parentMoveable && !resolveMatrix) {\r\n            return;\r\n        }\r\n        var nextTransform = convertTransformFormat(datas, \"rotate(\".concat(rotation, \"deg)\"), \"rotate(\".concat(dist, \"deg)\"));\r\n        if (resolveMatrix) {\r\n            datas.fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, datas.fixedDirection, datas.fixedOffset, datas);\r\n        }\r\n        var inverseDist = getRotateDist(moveable, dist, datas);\r\n        var inverseDelta = minus(plus(groupDelta || [0, 0], inverseDist), datas.prevInverseDist || [0, 0]);\r\n        datas.prevInverseDist = inverseDist;\r\n        datas.requestValue = null;\r\n        var dragEvent = fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e);\r\n        var transformEvent = dragEvent;\r\n        var parentDistance = getDist$1([nextClientX, nextClientY], absoluteInfo.startAbsoluteOrigin) - absoluteInfo.startDist;\r\n        var resize = undefined;\r\n        if (datas.resolveAble === \"resizable\") {\r\n            var resizeEvent = Resizable.dragControl(moveable, __assign(__assign({}, setCustomDrag(e, moveable.state, [e.deltaX, e.deltaY], !!isPinch, false, \"resizable\")), { resolveMatrix: true, parentDistance: parentDistance }));\r\n            if (resizeEvent) {\r\n                resize = resizeEvent;\r\n                transformEvent = fillAfterTransform(transformEvent, resizeEvent, e);\r\n            }\r\n        }\r\n        var params = fillParams(moveable, e, __assign(__assign({ delta: delta, dist: dist, rotate: rotation, rotation: rotation, beforeDist: beforeDist, beforeDelta: beforeDelta, beforeRotate: beforeRotation, beforeRotation: beforeRotation, absoluteDist: absoluteDist, absoluteDelta: absoluteDelta, absoluteRotate: absoluteRotation, absoluteRotation: absoluteRotation, isPinch: !!isPinch, resize: resize }, dragEvent), transformEvent));\r\n        triggerEvent(moveable, \"onRotate\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        datas.isRotate = false;\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRotateEnd\", params);\r\n        return params;\r\n    },\r\n    dragGroupControlCondition: dragControlCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var _a = moveable.state, parentLeft = _a.left, parentTop = _a.top, parentBeforeOrigin = _a.beforeOrigin;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        params.set(datas.beforeDirection * moveable.rotation);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            var _a = child.state, left = _a.left, top = _a.top, beforeOrigin = _a.beforeOrigin;\r\n            var childClient = plus(minus([left, top], [parentLeft, parentTop]), minus(beforeOrigin, parentBeforeOrigin));\r\n            ev.datas.startGroupClient = childClient;\r\n            ev.datas.groupClient = childClient;\r\n            return __assign(__assign({}, ev), { parentRotate: 0 });\r\n        });\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events });\r\n        var result = triggerEvent(moveable, \"onRotateGroupStart\", nextParams);\r\n        datas.isRotate = result !== false;\r\n        return datas.isRotate ? params : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeRotate\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeRotateGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var direction = datas.beforeDirection;\r\n        var parentRotate = params.beforeDist;\r\n        var rad = parentRotate / 180 * Math.PI;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var startGroupClient = ev.datas.startGroupClient;\r\n            var _a = __read(ev.datas.groupClient, 2), prevClientX = _a[0], prevClientY = _a[1];\r\n            var _b = __read(rotate(startGroupClient, rad * direction), 2), clientX = _b[0], clientY = _b[1];\r\n            var delta = [clientX - prevClientX, clientY - prevClientY];\r\n            ev.datas.groupClient = [clientX, clientY];\r\n            return __assign(__assign({}, ev), { parentRotate: parentRotate, groupDelta: delta });\r\n        });\r\n        moveable.rotation = direction * params.beforeRotation;\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events, set: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            }, setGroupRotation: function (rotation) {\r\n                moveable.rotation = rotation;\r\n            } }, params);\r\n        triggerEvent(moveable, \"onRotateGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isRotate) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onRotateGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Rotatable#request\r\n     * @param {object} [e] - the Resizable's request parameter\r\n     * @param {number} [e.deltaRotate=0] -  delta number of rotation\r\n     * @param {number} [e.rotate=0] - absolute number of moveable's rotation\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"rotatable\", { deltaRotate: 10 }, true);\r\n     *\r\n     * * moveable.request(\"rotatable\", { rotate: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"rotatable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     * requester.request({ deltaRotate: 10 });\r\n     *\r\n     * requester.request({ rotate: 10 });\r\n     * requester.request({ rotate: 20 });\r\n     * requester.request({ rotate: 30 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var distRotate = 0;\r\n        var startRotation = moveable.getRotation();\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaRotate\" in e) {\r\n                    distRotate += e.deltaRotate;\r\n                }\r\n                else if (\"rotate\" in e) {\r\n                    distRotate = e.rotate - startRotation;\r\n                }\r\n                return { datas: datas, parentDist: distRotate };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be rotated. (default: false)\r\n * @name Moveable.Rotatable#rotatable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.rotatable = true;\r\n */\r\n/**\r\n * You can specify the position of the rotation. (default: \"top\")\r\n * @name Moveable.Rotatable#rotationPosition\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   rotationPosition: \"top\",\r\n * });\r\n *\r\n * moveable.rotationPosition = \"bottom\"\r\n */\r\n/**\r\n * throttle of angle(degree) when rotate.\r\n * @name Moveable.Rotatable#throttleRotate\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleRotate = 1;\r\n */\r\n/**\r\n * When the rotate starts, the rotateStart event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateStart\r\n * @param {Moveable.Rotatable.OnRotateStart} - Parameters for the rotateStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n* When rotating, the rotate event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotate\r\n* @param {Moveable.Rotatable.OnRotate} - Parameters for the rotate event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { rotatable: true });\r\n* moveable.on(\"rotate\", ({ target, transform, dist }) => {\r\n*     target.style.transform = transform;\r\n* });\r\n*/\r\n/**\r\n * When the rotate finishes, the rotateEnd event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateEnd\r\n * @param {Moveable.Rotatable.OnRotateEnd} - Parameters for the rotateEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { rotatable: true });\r\n * moveable.on(\"rotateEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n * When the group rotate starts, the `rotateGroupStart` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupStart\r\n * @param {Moveable.Rotatable.OnRotateGroupStart} - Parameters for the `rotateGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRotateGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n* When the group rotate, the `rotateGroup` event is called.\r\n* @memberof Moveable.Rotatable\r\n* @event rotateGroup\r\n* @param {Moveable.Rotatable.OnRotateGroup} - Parameters for the `rotateGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     rotatable: true\r\n* });\r\n* moveable.on(\"rotateGroup\", ({ targets, events }) => {\r\n*     console.log(\"onRotateGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group rotate.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const deg = ev.beforeDist;\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group rotate finishes, the `rotateGroupEnd` event is called.\r\n * @memberof Moveable.Rotatable\r\n * @event rotateGroupEnd\r\n * @param {Moveable.Rotatable.OnRotateGroupEnd} - Parameters for the `rotateGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     rotatable: true\r\n * });\r\n * moveable.on(\"rotateGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onRotateGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction renderGuideline(info, React) {\r\n    var _a;\r\n    var direction = info.direction, classNames = info.classNames, size = info.size, pos = info.pos, zoom = info.zoom, key = info.key;\r\n    var isHorizontal = direction === \"horizontal\";\r\n    var scaleType = isHorizontal ? \"Y\" : \"X\";\r\n    // const scaleType2 = isHorizontal ? \"Y\" : \"X\";\r\n    return React.createElement(\"div\", {\r\n        key: key,\r\n        className: classNames.join(\" \"),\r\n        style: (_a = {},\r\n            _a[isHorizontal ? \"width\" : \"height\"] = \"\".concat(size),\r\n            _a.transform = \"translate(\".concat(pos[0], \", \").concat(pos[1], \") translate\").concat(scaleType, \"(-50%) scale\").concat(scaleType, \"(\").concat(zoom, \")\"),\r\n            _a),\r\n    });\r\n}\r\nfunction renderInnerGuideline(info, React) {\r\n    return renderGuideline(__assign(__assign({}, info), { classNames: __spreadArray([\r\n            prefix(\"line\", \"guideline\", info.direction)\r\n        ], __read(info.classNames), false).filter(function (className) { return className; }), size: info.size || \"\".concat(info.sizeValue, \"px\"), pos: info.pos || info.posValue.map(function (v) { return \"\".concat(throttle(v, 0.1), \"px\"); }) }), React);\r\n}\r\nfunction renderSnapPoses(moveable, direction, snapPoses, minPos, targetPos, size, index, React) {\r\n    var zoom = moveable.props.zoom;\r\n    return snapPoses.map(function (_a, i) {\r\n        var type = _a.type, pos = _a.pos;\r\n        var renderPos = [0, 0];\r\n        renderPos[index] = minPos;\r\n        renderPos[index ? 0 : 1] = -targetPos + pos;\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(direction, \"TargetGuideline\").concat(i),\r\n            classNames: [prefix(\"target\", \"bold\", type)],\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n            direction: direction,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderGuidelines(moveable, type, guidelines, targetPos, targetRect, React) {\r\n    var _a = moveable.props, zoom = _a.zoom, isDisplayInnerSnapDigit = _a.isDisplayInnerSnapDigit;\r\n    var mainNames = type === \"horizontal\" ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[mainNames.start];\r\n    var targetEnd = targetRect[mainNames.end];\r\n    return guidelines.filter(function (_a) {\r\n        var hide = _a.hide, elementRect = _a.elementRect;\r\n        if (hide) {\r\n            return false;\r\n        }\r\n        if (isDisplayInnerSnapDigit && elementRect) {\r\n            // inner\r\n            var rect = elementRect.rect;\r\n            if (rect[mainNames.start] <= targetStart && targetEnd <= rect[mainNames.end]) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }).map(function (guideline, i) {\r\n        var pos = guideline.pos, size = guideline.size, element = guideline.element, className = guideline.className;\r\n        var renderPos = [\r\n            -targetPos[0] + pos[0],\r\n            -targetPos[1] + pos[1],\r\n        ];\r\n        return renderInnerGuideline({\r\n            key: \"\".concat(type, \"-default-guideline-\").concat(i),\r\n            classNames: element ? [prefix(\"bold\"), className] : [prefix(\"normal\"), className],\r\n            direction: type,\r\n            posValue: renderPos,\r\n            sizeValue: size,\r\n            zoom: zoom,\r\n        }, React);\r\n    });\r\n}\r\nfunction renderDigitLine(moveable, type, lineType, index, gap, renderPos, className, React) {\r\n    var _a;\r\n    var _b = moveable.props, _c = _b.snapDigit, snapDigit = _c === void 0 ? 0 : _c, _d = _b.isDisplaySnapDigit, isDisplaySnapDigit = _d === void 0 ? true : _d, _e = _b.snapDistFormat, snapDistFormat = _e === void 0 ? function (v, type) {\r\n        // Type can be used render different values.\r\n        if (type === 'vertical') {\r\n            return v;\r\n        }\r\n        return v;\r\n    } : _e, zoom = _b.zoom;\r\n    var scaleType = type === \"horizontal\" ? \"X\" : \"Y\";\r\n    var sizeName = type === \"vertical\" ? \"height\" : \"width\";\r\n    var absGap = Math.abs(gap);\r\n    var snapSize = isDisplaySnapDigit\r\n        ? parseFloat(absGap.toFixed(snapDigit))\r\n        : 0;\r\n    return React.createElement(\"div\", { key: \"\".concat(type, \"-\").concat(lineType, \"-guideline-\").concat(index), className: prefix(\"guideline-group\", type), style: (_a = {\r\n                left: \"\".concat(renderPos[0], \"px\"),\r\n                top: \"\".concat(renderPos[1], \"px\")\r\n            },\r\n            _a[sizeName] = \"\".concat(absGap, \"px\"),\r\n            _a) },\r\n        renderInnerGuideline({\r\n            direction: type,\r\n            classNames: [prefix(lineType), className],\r\n            size: \"100%\",\r\n            posValue: [0, 0],\r\n            sizeValue: absGap,\r\n            zoom: zoom,\r\n        }, React),\r\n        React.createElement(\"div\", { className: prefix(\"size-value\", \"gap\"), style: {\r\n                transform: \"translate\".concat(scaleType, \"(-50%) scale(\").concat(zoom, \")\"),\r\n            } }, snapSize > 0 ? snapDistFormat(snapSize, type) : \"\"));\r\n}\r\nfunction groupByElementGuidelines(type, guidelines, targetRect, isDisplayInnerSnapDigit) {\r\n    var index = type === \"vertical\" ? 0 : 1;\r\n    var otherIndex = type === \"vertical\" ? 1 : 0;\r\n    var names = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n    var targetStart = targetRect[names.start];\r\n    var targetEnd = targetRect[names.end];\r\n    return groupBy(guidelines, function (guideline) {\r\n        return guideline.pos[index];\r\n    }).map(function (nextGuidelines) {\r\n        var start = [];\r\n        var end = [];\r\n        var inner = [];\r\n        nextGuidelines.forEach(function (guideline) {\r\n            var _a, _b;\r\n            var element = guideline.element;\r\n            var rect = guideline.elementRect.rect;\r\n            if (rect[names.end] < targetStart) {\r\n                start.push(guideline);\r\n            }\r\n            else if (targetEnd < rect[names.start]) {\r\n                end.push(guideline);\r\n            }\r\n            else if (rect[names.start] <= targetStart && targetEnd <= rect[names.end] && isDisplayInnerSnapDigit) {\r\n                var pos = guideline.pos;\r\n                var elementRect1 = { element: element, rect: __assign(__assign({}, rect), (_a = {}, _a[names.end] = rect[names.start], _a)) };\r\n                var elementRect2 = { element: element, rect: __assign(__assign({}, rect), (_b = {}, _b[names.start] = rect[names.end], _b)) };\r\n                var nextPos1 = [0, 0];\r\n                var nextPos2 = [0, 0];\r\n                nextPos1[index] = pos[index];\r\n                nextPos1[otherIndex] = pos[otherIndex];\r\n                nextPos2[index] = pos[index];\r\n                nextPos2[otherIndex] = pos[otherIndex] + guideline.size;\r\n                start.push({\r\n                    type: type,\r\n                    pos: nextPos1,\r\n                    size: 0,\r\n                    elementRect: elementRect1,\r\n                    direction: \"\",\r\n                    elementDirection: \"end\",\r\n                });\r\n                end.push({\r\n                    type: type,\r\n                    pos: nextPos2,\r\n                    size: 0,\r\n                    elementRect: elementRect2,\r\n                    direction: \"\",\r\n                    elementDirection: \"start\",\r\n                });\r\n                // inner.push(guideline);\r\n            }\r\n        });\r\n        start.sort(function (a, b) {\r\n            return b.pos[otherIndex] - a.pos[otherIndex];\r\n        });\r\n        end.sort(function (a, b) {\r\n            return a.pos[otherIndex] - b.pos[otherIndex];\r\n        });\r\n        return {\r\n            total: nextGuidelines,\r\n            start: start,\r\n            end: end,\r\n            inner: inner,\r\n        };\r\n    });\r\n}\r\nfunction renderDashedGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var isDisplayInnerSnapDigit = moveable.props.isDisplayInnerSnapDigit;\r\n    var rendered = [];\r\n    [\"vertical\", \"horizontal\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; });\r\n        var index = type === \"vertical\" ? 1 : 0;\r\n        var otherIndex = index ? 0 : 1;\r\n        var groups = groupByElementGuidelines(type, nextGuidelines, targetRect, isDisplayInnerSnapDigit);\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        groups.forEach(function (_a) {\r\n            var total = _a.total, start = _a.start, end = _a.end, inner = _a.inner;\r\n            var sidePos = targetPos[otherIndex] + total[0].pos[otherIndex] - targetRect[sideNames.start];\r\n            var prevRect = targetRect;\r\n            start.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = prevRect[mainNames.start] - nextRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.start] - targetStart - size;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            prevRect = targetRect;\r\n            end.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size = nextRect[mainNames.start] - prevRect[mainNames.end];\r\n                if (size > 0) {\r\n                    var renderPos = [0, 0];\r\n                    renderPos[index] = targetPos[index] + prevRect[mainNames.end] - targetStart;\r\n                    renderPos[otherIndex] = sidePos;\r\n                    rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size, renderPos, guideline.className, React));\r\n                }\r\n                prevRect = nextRect;\r\n            });\r\n            inner.forEach(function (guideline) {\r\n                var nextRect = guideline.elementRect.rect;\r\n                var size1 = targetStart - nextRect[mainNames.start];\r\n                var size2 = nextRect[mainNames.end] - targetEnd;\r\n                var renderPos1 = [0, 0];\r\n                var renderPos2 = [0, 0];\r\n                renderPos1[index] = targetPos[index] - size1;\r\n                renderPos1[otherIndex] = sidePos;\r\n                renderPos2[index] = targetPos[index] + targetEnd - targetStart;\r\n                renderPos2[otherIndex] = sidePos;\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size1, renderPos1, guideline.className, React));\r\n                rendered.push(renderDigitLine(moveable, type, \"dashed\", rendered.length, size2, renderPos2, guideline.className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\r\nfunction renderGapGuidelines(moveable, guidelines, targetPos, targetRect, React) {\r\n    var rendered = [];\r\n    [\"horizontal\", \"vertical\"].forEach(function (type) {\r\n        var nextGuidelines = guidelines.filter(function (guideline) { return guideline.type === type; }).slice(0, 1);\r\n        var index = type === \"vertical\" ? 0 : 1;\r\n        var otherIndex = index ? 0 : 1;\r\n        var mainNames = index ? HORIZONTAL_NAMES_MAP : VERTICAL_NAMES_MAP;\r\n        var sideNames = index ? VERTICAL_NAMES_MAP : HORIZONTAL_NAMES_MAP;\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetSideStart = targetRect[sideNames.start];\r\n        var targetSideEnd = targetRect[sideNames.end];\r\n        nextGuidelines.forEach(function (_a) {\r\n            var gap = _a.gap, gapRects = _a.gapRects;\r\n            var sideStartPos = Math.max.apply(Math, __spreadArray([targetSideStart], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.start];\r\n            })), false));\r\n            var sideEndPos = Math.min.apply(Math, __spreadArray([targetSideEnd], __read(gapRects.map(function (_a) {\r\n                var rect = _a.rect;\r\n                return rect[sideNames.end];\r\n            })), false));\r\n            var sideCenterPos = (sideStartPos + sideEndPos) / 2;\r\n            if (sideStartPos === sideEndPos || sideCenterPos === (targetSideStart + targetSideEnd) / 2) {\r\n                return;\r\n            }\r\n            gapRects.forEach(function (_a) {\r\n                var rect = _a.rect, className = _a.className;\r\n                var renderPos = [targetPos[0], targetPos[1]];\r\n                if (rect[mainNames.end] < targetStart) {\r\n                    renderPos[index] += rect[mainNames.end] - targetStart;\r\n                }\r\n                else if (targetEnd < rect[mainNames.start]) {\r\n                    renderPos[index] += rect[mainNames.start] - targetStart - gap;\r\n                }\r\n                else {\r\n                    return;\r\n                }\r\n                renderPos[otherIndex] += sideCenterPos - targetSideStart;\r\n                rendered.push(renderDigitLine(moveable, index ? \"vertical\" : \"horizontal\", \"gap\", rendered.length, gap, renderPos, className, React));\r\n            });\r\n        });\r\n    });\r\n    return rendered;\r\n}\n\nfunction getTotalGuidelines(moveable) {\r\n    var _a, _b;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, hasFixed = state.hasFixed;\r\n    var overflow = containerClientRect.overflow, containerHeight = containerClientRect.scrollHeight, containerWidth = containerClientRect.scrollWidth, containerClientHeight = containerClientRect.clientHeight, containerClientWidth = containerClientRect.clientWidth, clientLeft = containerClientRect.clientLeft, clientTop = containerClientRect.clientTop;\r\n    var _c = moveable.props, _d = _c.snapGap, snapGap = _d === void 0 ? true : _d, verticalGuidelines = _c.verticalGuidelines, horizontalGuidelines = _c.horizontalGuidelines, _e = _c.snapThreshold, snapThreshold = _e === void 0 ? 5 : _e, _f = _c.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _f === void 0 ? Infinity : _f, isDisplayGridGuidelines = _c.isDisplayGridGuidelines;\r\n    var _g = getRect(getAbsolutePosesByState(moveable.state)), top = _g.top, left = _g.left, bottom = _g.bottom, right = _g.right;\r\n    var targetRect = { top: top, left: left, bottom: bottom, right: right, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n    var elementGuidelines = getElementGuidelines(moveable);\r\n    var totalGuidelines = __spreadArray([], __read(elementGuidelines), false);\r\n    var snapThresholdMultiples = ((_b = (_a = state.snapThresholdInfo) === null || _a === void 0 ? void 0 : _a.multiples) !== null && _b !== void 0 ? _b : [1, 1]).map(function (n) { return n * snapThreshold; });\r\n    if (snapGap) {\r\n        totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGapGuidelines(moveable, targetRect, snapThresholdMultiples)), false));\r\n    }\r\n    var snapOffset = __assign({}, (state.snapOffset || {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    }));\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getGridGuidelines(moveable, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines)), false));\r\n    if (hasFixed) {\r\n        var left_1 = containerClientRect.left, top_1 = containerClientRect.top;\r\n        snapOffset.left += left_1;\r\n        snapOffset.top += top_1;\r\n        snapOffset.right += left_1;\r\n        snapOffset.bottom += top_1;\r\n    }\r\n    totalGuidelines.push.apply(totalGuidelines, __spreadArray([], __read(getDefaultGuidelines(horizontalGuidelines || false, verticalGuidelines || false, overflow ? containerWidth : containerClientWidth, overflow ? containerHeight : containerClientHeight, clientLeft, clientTop, snapOffset)), false));\r\n    totalGuidelines = totalGuidelines.filter(function (_a) {\r\n        var element = _a.element, elementRect = _a.elementRect, type = _a.type;\r\n        if (!element || !elementRect) {\r\n            return true;\r\n        }\r\n        var rect = elementRect.rect;\r\n        return checkBetweenRects(targetRect, rect, type, maxSnapElementGuidelineDistance);\r\n    });\r\n    return totalGuidelines;\r\n}\r\nfunction getGapGuidelines(moveable, targetRect, snapThresholds) {\r\n    var _a = moveable.props, _b = _a.maxSnapElementGuidelineDistance, maxSnapElementGuidelineDistance = _b === void 0 ? Infinity : _b, _c = _a.maxSnapElementGapDistance, maxSnapElementGapDistance = _c === void 0 ? Infinity : _c;\r\n    var elementRects = moveable.state.elementRects;\r\n    var gapGuidelines = [];\r\n    [\r\n        [\"vertical\", VERTICAL_NAMES_MAP, HORIZONTAL_NAMES_MAP],\r\n        [\"horizontal\", HORIZONTAL_NAMES_MAP, VERTICAL_NAMES_MAP],\r\n    ].forEach(function (_a) {\r\n        var _b = __read(_a, 3), type = _b[0], mainNames = _b[1], sideNames = _b[2];\r\n        var targetStart = targetRect[mainNames.start];\r\n        var targetEnd = targetRect[mainNames.end];\r\n        var targetCenter = targetRect[mainNames.center];\r\n        var targetStart2 = targetRect[sideNames.start];\r\n        var targetEnd2 = targetRect[sideNames.end];\r\n        // element : moveable\r\n        var snapThresholdMap = {\r\n            left: snapThresholds[0],\r\n            top: snapThresholds[1],\r\n        };\r\n        function getDist(elementRect) {\r\n            var rect = elementRect.rect;\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            if (rect[mainNames.end] < targetStart + snapThreshold) {\r\n                return targetStart - rect[mainNames.end];\r\n            }\r\n            else if (targetEnd - snapThreshold < rect[mainNames.start]) {\r\n                return rect[mainNames.start] - targetEnd;\r\n            }\r\n            else {\r\n                return -1;\r\n            }\r\n        }\r\n        var nextElementRects = elementRects.filter(function (elementRect) {\r\n            var rect = elementRect.rect;\r\n            if (rect[sideNames.start] > targetEnd2 || rect[sideNames.end] < targetStart2) {\r\n                return false;\r\n            }\r\n            return getDist(elementRect) > 0;\r\n        }).sort(function (a, b) {\r\n            return getDist(a) - getDist(b);\r\n        });\r\n        var groups = [];\r\n        nextElementRects.forEach(function (snapRect1) {\r\n            nextElementRects.forEach(function (snapRect2) {\r\n                if (snapRect1 === snapRect2) {\r\n                    return;\r\n                }\r\n                var rect1 = snapRect1.rect;\r\n                var rect2 = snapRect2.rect;\r\n                var rect1Start = rect1[sideNames.start];\r\n                var rect1End = rect1[sideNames.end];\r\n                var rect2Start = rect2[sideNames.start];\r\n                var rect2End = rect2[sideNames.end];\r\n                if (rect1Start > rect2End || rect2Start > rect1End) {\r\n                    return;\r\n                }\r\n                groups.push([snapRect1, snapRect2]);\r\n            });\r\n        });\r\n        groups.forEach(function (_a) {\r\n            var _b = __read(_a, 2), snapRect1 = _b[0], snapRect2 = _b[1];\r\n            var rect1 = snapRect1.rect;\r\n            var rect2 = snapRect2.rect;\r\n            var rect1Start = rect1[mainNames.start];\r\n            var rect1End = rect1[mainNames.end];\r\n            var rect2Start = rect2[mainNames.start];\r\n            var rect2End = rect2[mainNames.end];\r\n            var snapThreshold = snapThresholdMap[mainNames.start];\r\n            var gap = 0;\r\n            var pos = 0;\r\n            var isStart = false;\r\n            var isCenter = false;\r\n            var isEnd = false;\r\n            if (rect1End <= targetStart && targetEnd <= rect2Start) {\r\n                // (l)element1(r) : (l)target(r) : (l)element2(r)\r\n                isCenter = true;\r\n                gap = ((rect2Start - rect1End) - (targetEnd - targetStart)) / 2;\r\n                pos = rect1End + gap + (targetEnd - targetStart) / 2;\r\n                if (abs(pos - targetCenter) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && rect2End < targetStart + snapThreshold) {\r\n                // (l)element1(r) : (l)element2(r) : (l)target\r\n                isStart = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect2End + gap;\r\n                if (abs(pos - targetStart) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else if (rect1End < rect2Start && targetEnd - snapThreshold < rect1Start) {\r\n                // target(r) : (l)element1(r) : (l)element2(r)\r\n                isEnd = true;\r\n                gap = rect2Start - rect1End;\r\n                pos = rect1Start - gap;\r\n                if (abs(pos - targetEnd) > snapThreshold) {\r\n                    return;\r\n                }\r\n            }\r\n            else {\r\n                return;\r\n            }\r\n            if (!gap) {\r\n                return;\r\n            }\r\n            if (!checkBetweenRects(targetRect, rect2, type, maxSnapElementGuidelineDistance)) {\r\n                return;\r\n            }\r\n            if (gap > maxSnapElementGapDistance) {\r\n                return;\r\n            }\r\n            gapGuidelines.push({\r\n                type: type,\r\n                pos: type === \"vertical\" ? [pos, 0] : [0, pos],\r\n                element: snapRect2.element,\r\n                size: 0,\r\n                className: snapRect2.className,\r\n                isStart: isStart,\r\n                isCenter: isCenter,\r\n                isEnd: isEnd,\r\n                gap: gap,\r\n                hide: true,\r\n                gapRects: [snapRect1, snapRect2],\r\n                direction: \"\",\r\n                elementDirection: \"\",\r\n            });\r\n        });\r\n    });\r\n    return gapGuidelines;\r\n}\r\nfunction startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset) {\r\n    var _a, _b;\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var snapGridAll = props.snapGridAll;\r\n    var _c = props.snapGridWidth, snapGridWidth = _c === void 0 ? 0 : _c, _d = props.snapGridHeight, snapGridHeight = _d === void 0 ? 0 : _d;\r\n    var snapRenderInfo = state.snapRenderInfo;\r\n    var hasDirection = snapRenderInfo && (((_a = snapRenderInfo.direction) === null || _a === void 0 ? void 0 : _a[0]) || ((_b = snapRenderInfo.direction) === null || _b === void 0 ? void 0 : _b[1]));\r\n    var moveables = moveable.moveables;\r\n    // snap group's all child to grid.\r\n    if (snapGridAll\r\n        && moveables\r\n        && hasDirection\r\n        && (snapGridWidth || snapGridHeight)) {\r\n        if (state.snapThresholdInfo) {\r\n            return;\r\n        }\r\n        state.snapThresholdInfo = {\r\n            multiples: [1, 1],\r\n            offset: [0, 0],\r\n        };\r\n        var rect_1 = moveable.getRect();\r\n        var children_1 = rect_1.children;\r\n        var direction = snapRenderInfo.direction;\r\n        if (children_1) {\r\n            var result = direction.map(function (dir, i) {\r\n                var _a = i === 0 ? {\r\n                    snapSize: snapGridWidth,\r\n                    posName: \"left\",\r\n                    sizeName: \"width\",\r\n                    clientOffset: snapOffset.left - clientLeft,\r\n                } : {\r\n                    snapSize: snapGridHeight,\r\n                    posName: \"top\",\r\n                    sizeName: \"height\",\r\n                    clientOffset: snapOffset.top - clientTop,\r\n                }, snapSize = _a.snapSize, posName = _a.posName, sizeName = _a.sizeName, clientOffset = _a.clientOffset;\r\n                if (!snapSize) {\r\n                    return {\r\n                        dir: dir,\r\n                        multiple: 1,\r\n                        snapSize: snapSize,\r\n                        snapOffset: 0,\r\n                    };\r\n                }\r\n                var rectSize = rect_1[sizeName];\r\n                var rectPos = rect_1[posName];\r\n                //     ?\r\n                var childSizes = flat$1(children_1.map(function (child) {\r\n                    return [\r\n                        (child[posName] - rectPos),\r\n                        (child[sizeName]),\r\n                        (rectSize - child[sizeName] - child[posName] + rectPos),\r\n                    ];\r\n                })).filter(function (v) { return v; }).sort(function (a, b) {\r\n                    return a - b;\r\n                });\r\n                var firstChildSize = childSizes[0];\r\n                var childSnapSizes = childSizes.map(function (size) { return throttle(size / firstChildSize, 0.1) * snapSize; });\r\n                var n = 1;\r\n                var rectRatio = throttle(rectSize / firstChildSize, 0.1);\r\n                for (n = 1; n <= 10; ++n) {\r\n                    if (childSnapSizes.every(function (childSize) {\r\n                        return childSize * n % 1 === 0;\r\n                    })) {\r\n                        break;\r\n                    }\r\n                }\r\n                // dir 1 (fixed -1)\r\n                // dir 0 (fixed 0)\r\n                // dir -1 (fixed 1)\r\n                var ratio = (-dir + 1) / 2;\r\n                var offsetPos = dot(rectPos - clientOffset, rectPos - clientOffset + rectSize, ratio, 1 - ratio);\r\n                return {\r\n                    multiple: rectRatio * n,\r\n                    dir: dir,\r\n                    snapSize: snapSize,\r\n                    snapOffset: Math.round(offsetPos / snapSize),\r\n                };\r\n            });\r\n            var multiples = result.map(function (r) { return r.multiple || 1; });\r\n            state.snapThresholdInfo.multiples = multiples;\r\n            state.snapThresholdInfo.offset = result.map(function (r) { return r.snapOffset; });\r\n            result.forEach(function (r, i) {\r\n                if (r.snapSize) ;\r\n            });\r\n        }\r\n    }\r\n    else {\r\n        state.snapThresholdInfo = null;\r\n    }\r\n}\r\nfunction getGridGuidelines(moveable, containerWidth, containerHeight, clientLeft, clientTop, snapOffset, isDisplayGridGuidelines) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    var props = moveable.props;\r\n    var state = moveable.state;\r\n    var _a = props.snapGridWidth, snapGridWidth = _a === void 0 ? 0 : _a, _b = props.snapGridHeight, snapGridHeight = _b === void 0 ? 0 : _b;\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top;\r\n    var startOffset = [0, 0];\r\n    startGridGroupGuidelines(moveable, clientLeft, clientTop, snapOffset);\r\n    var snapThresholdInfo = state.snapThresholdInfo;\r\n    var defaultSnapGridWidth = snapGridWidth;\r\n    var defaultSnapGridHeight = snapGridHeight;\r\n    if (snapThresholdInfo) {\r\n        snapGridWidth *= snapThresholdInfo.multiples[0] || 1;\r\n        snapGridHeight *= snapThresholdInfo.multiples[1] || 1;\r\n        startOffset = snapThresholdInfo.offset;\r\n    }\r\n    if (snapGridHeight) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"horizontal\",\r\n                pos: [\r\n                    snapOffsetLeft,\r\n                    throttle(startOffset[1] * defaultSnapGridHeight + pos - clientTop + snapOffsetTop, 0.1),\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerWidth,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerHeight * 2; pos += snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridHeight; pos >= -containerHeight; pos -= snapGridHeight) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    if (snapGridWidth) {\r\n        var pushGuideline = function (pos) {\r\n            guidelines.push({\r\n                type: \"vertical\",\r\n                pos: [\r\n                    throttle(startOffset[0] * defaultSnapGridWidth + pos - clientLeft + snapOffsetLeft, 0.1),\r\n                    snapOffsetTop,\r\n                ],\r\n                className: prefix(\"grid-guideline\"),\r\n                size: containerHeight,\r\n                hide: !isDisplayGridGuidelines,\r\n                direction: \"\",\r\n                grid: true,\r\n            });\r\n        };\r\n        for (var pos = 0; pos <= containerWidth * 2; pos += snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n        for (var pos = -snapGridWidth; pos >= -containerWidth; pos -= snapGridWidth) {\r\n            pushGuideline(pos);\r\n        }\r\n    }\r\n    return guidelines;\r\n}\r\nfunction checkBetweenRects(rect1, rect2, type, distance) {\r\n    if (type === \"horizontal\") {\r\n        return abs(rect1.right - rect2.left) <= distance\r\n            || abs(rect1.left - rect2.right) <= distance\r\n            || rect1.left <= rect2.right && rect2.left <= rect1.right;\r\n    }\r\n    else if (type === \"vertical\") {\r\n        return abs(rect1.bottom - rect2.top) <= distance\r\n            || abs(rect1.top - rect2.bottom) <= distance\r\n            || rect1.top <= rect2.bottom && rect2.top <= rect1.bottom;\r\n    }\r\n    return true;\r\n}\r\nfunction getElementGuidelines(moveable) {\r\n    var state = moveable.state;\r\n    var _a = moveable.props.elementGuidelines, elementGuidelines = _a === void 0 ? [] : _a;\r\n    if (!elementGuidelines.length) {\r\n        state.elementRects = [];\r\n        return [];\r\n    }\r\n    var prevValues = (state.elementRects || []).filter(function (snapRect) { return !snapRect.refresh; });\r\n    var nextElementGuidelines = elementGuidelines.map(function (el) {\r\n        if (isObject(el) && \"element\" in el) {\r\n            return __assign(__assign({}, el), { element: getRefTarget(el.element, true) });\r\n        }\r\n        return {\r\n            element: getRefTarget(el, true),\r\n        };\r\n    }).filter(function (value) {\r\n        return value.element;\r\n    });\r\n    var _b = diff(prevValues.map(function (v) { return v.element; }), nextElementGuidelines.map(function (v) { return v.element; })), maintained = _b.maintained, added = _b.added;\r\n    var nextValues = [];\r\n    maintained.forEach(function (_a) {\r\n        var _b = __read(_a, 2), prevIndex = _b[0], nextIndex = _b[1];\r\n        nextValues[nextIndex] = prevValues[prevIndex];\r\n    });\r\n    getSnapElementRects(moveable, added.map(function (index) { return nextElementGuidelines[index]; })).map(function (rect, i) {\r\n        nextValues[added[i]] = rect;\r\n    });\r\n    state.elementRects = nextValues;\r\n    var elementSnapDirections = getSnapDirections(moveable.props.elementSnapDirections);\r\n    var nextGuidelines = [];\r\n    nextValues.forEach(function (snapRect) {\r\n        var element = snapRect.element, _a = snapRect.top, topValue = _a === void 0 ? elementSnapDirections.top : _a, _b = snapRect.left, leftValue = _b === void 0 ? elementSnapDirections.left : _b, _c = snapRect.right, rightValue = _c === void 0 ? elementSnapDirections.right : _c, _d = snapRect.bottom, bottomValue = _d === void 0 ? elementSnapDirections.bottom : _d, _e = snapRect.center, centerValue = _e === void 0 ? elementSnapDirections.center : _e, _f = snapRect.middle, middleValue = _f === void 0 ? elementSnapDirections.middle : _f, className = snapRect.className, rect = snapRect.rect;\r\n        var _g = splitSnapDirectionPoses({\r\n            top: topValue,\r\n            right: rightValue,\r\n            left: leftValue,\r\n            bottom: bottomValue,\r\n            center: centerValue,\r\n            middle: middleValue,\r\n        }, rect), horizontal = _g.horizontal, vertical = _g.vertical, horizontalNames = _g.horizontalNames, verticalNames = _g.verticalNames;\r\n        var rectTop = rect.top;\r\n        var rectLeft = rect.left;\r\n        var width = rect.right - rectLeft;\r\n        var height = rect.bottom - rectTop;\r\n        var sizes = [width, height];\r\n        vertical.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"vertical\",\r\n                element: element,\r\n                pos: [\r\n                    throttle(pos, 0.1),\r\n                    rectTop,\r\n                ], size: height,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[verticalNames[i]] || verticalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n        horizontal.forEach(function (pos, i) {\r\n            nextGuidelines.push({\r\n                type: \"horizontal\",\r\n                element: element,\r\n                pos: [\r\n                    rectLeft,\r\n                    throttle(pos, 0.1),\r\n                ],\r\n                size: width,\r\n                sizes: sizes,\r\n                className: className,\r\n                elementRect: snapRect,\r\n                elementDirection: SNAP_SKIP_NAMES_MAP[horizontalNames[i]] || horizontalNames[i],\r\n                direction: \"\",\r\n            });\r\n        });\r\n    });\r\n    return nextGuidelines;\r\n}\r\nfunction getObjectGuidelines(guidelines, containerSize) {\r\n    return guidelines ? guidelines.map(function (info) {\r\n        var posGuideline = isObject(info) ? info : { pos: info };\r\n        var pos = posGuideline.pos;\r\n        if (isNumber(pos)) {\r\n            return posGuideline;\r\n        }\r\n        else {\r\n            return __assign(__assign({}, posGuideline), { pos: convertUnitSize(pos, containerSize) });\r\n        }\r\n    }) : [];\r\n}\r\nfunction getDefaultGuidelines(horizontalGuidelines, verticalGuidelines, width, height, clientLeft, clientTop, snapOffset) {\r\n    if (clientLeft === void 0) { clientLeft = 0; }\r\n    if (clientTop === void 0) { clientTop = 0; }\r\n    if (snapOffset === void 0) { snapOffset = { left: 0, top: 0, right: 0, bottom: 0 }; }\r\n    var guidelines = [];\r\n    var snapOffsetLeft = snapOffset.left, snapOffsetTop = snapOffset.top, snapOffsetBottom = snapOffset.bottom, snapOffsetRight = snapOffset.right;\r\n    var snapWidth = width + snapOffsetRight - snapOffsetLeft;\r\n    var snapHeight = height + snapOffsetBottom - snapOffsetTop;\r\n    getObjectGuidelines(horizontalGuidelines, snapHeight).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"horizontal\",\r\n            pos: [\r\n                snapOffsetLeft,\r\n                throttle(posInfo.pos - clientTop + snapOffsetTop, 0.1),\r\n            ],\r\n            size: snapWidth,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    getObjectGuidelines(verticalGuidelines, snapWidth).forEach(function (posInfo) {\r\n        guidelines.push({\r\n            type: \"vertical\",\r\n            pos: [\r\n                throttle(posInfo.pos - clientLeft + snapOffsetLeft, 0.1),\r\n                snapOffsetTop,\r\n            ],\r\n            size: snapHeight,\r\n            className: posInfo.className,\r\n            direction: \"\",\r\n        });\r\n    });\r\n    return guidelines;\r\n}\r\nfunction getSnapElementRects(moveable, values) {\r\n    if (!values.length) {\r\n        return [];\r\n    }\r\n    var groupable = moveable.props.groupable;\r\n    var state = moveable.state;\r\n    var containerClientRect = state.containerClientRect, \r\n    // targetClientRect: {\r\n    //     top: clientTop,\r\n    //     left: clientLeft,\r\n    // },\r\n    rootMatrix = state.rootMatrix, is3d = state.is3d, offsetDelta = state.offsetDelta;\r\n    var n = is3d ? 4 : 3;\r\n    var _a = __read(calculateContainerPos(rootMatrix, containerClientRect, n), 2), containerLeft = _a[0], containerTop = _a[1];\r\n    // const poses = getAbsolutePosesByState(state);\r\n    // const {\r\n    //     minX: targetLeft,\r\n    //     minY: targetTop,\r\n    // } = getMinMaxs(poses);\r\n    // const [distLeft, distTop] = minus([targetLeft, targetTop], calculateInversePosition(rootMatrix, [\r\n    //     clientLeft - containerLeft,\r\n    //     clientTop - containerTop,\r\n    // ], n)).map(pos => roundSign(pos));\r\n    var offsetLeft = groupable ? 0 : offsetDelta[0];\r\n    var offsetTop = groupable ? 0 : offsetDelta[1];\r\n    return values.map(function (value) {\r\n        var rect = value.element.getBoundingClientRect();\r\n        var left = rect.left - containerLeft - offsetLeft;\r\n        var top = rect.top - containerTop - offsetTop;\r\n        var bottom = top + rect.height;\r\n        var right = left + rect.width;\r\n        var _a = __read(calculateInversePosition(rootMatrix, [left, top], n), 2), elementLeft = _a[0], elementTop = _a[1];\r\n        var _b = __read(calculateInversePosition(rootMatrix, [right, bottom], n), 2), elementRight = _b[0], elementBottom = _b[1];\r\n        return __assign(__assign({}, value), { rect: {\r\n                left: elementLeft,\r\n                right: elementRight,\r\n                top: elementTop,\r\n                bottom: elementBottom,\r\n                center: (elementLeft + elementRight) / 2,\r\n                middle: (elementTop + elementBottom) / 2,\r\n            } });\r\n    });\r\n}\n\nfunction checkSnapInfo(moveable) {\r\n    var state = moveable.state;\r\n    var container = state.container;\r\n    var snapContainer = moveable.props.snapContainer || container;\r\n    if (state.snapContainer === snapContainer && state.guidelines && state.guidelines.length) {\r\n        return false;\r\n    }\r\n    var containerClientRect = state.containerClientRect;\r\n    var snapOffset = {\r\n        left: 0,\r\n        top: 0,\r\n        bottom: 0,\r\n        right: 0,\r\n    };\r\n    if (container !== snapContainer) {\r\n        var snapContainerTarget = getRefTarget(snapContainer, true);\r\n        if (snapContainerTarget) {\r\n            var snapContainerRect = getClientRect(snapContainerTarget);\r\n            var offset1 = getDragDistByState(state, [\r\n                snapContainerRect.left - containerClientRect.left,\r\n                snapContainerRect.top - containerClientRect.top,\r\n            ]);\r\n            var offset2 = getDragDistByState(state, [\r\n                snapContainerRect.right - containerClientRect.right,\r\n                snapContainerRect.bottom - containerClientRect.bottom,\r\n            ]);\r\n            snapOffset.left = throttle(offset1[0], 0.00001);\r\n            snapOffset.top = throttle(offset1[1], 0.00001);\r\n            snapOffset.right = throttle(offset2[0], 0.00001);\r\n            snapOffset.bottom = throttle(offset2[1], 0.00001);\r\n        }\r\n    }\r\n    state.snapContainer = snapContainer;\r\n    state.snapOffset = snapOffset;\r\n    state.guidelines = getTotalGuidelines(moveable);\r\n    state.enableSnap = true;\r\n    return true;\r\n}\r\nfunction getNextFixedPoses(matrix, width, height, fixedDirection, fixedPos, is3d) {\r\n    var nextPoses = calculatePoses(matrix, width, height, is3d ? 4 : 3);\r\n    var nextFixedPos = getPosByDirection(nextPoses, fixedDirection);\r\n    return getAbsolutePoses(nextPoses, minus(fixedPos, nextFixedPos));\r\n}\r\nfunction normalized(value) {\r\n    return value ? value / abs(value) : 0;\r\n}\r\nfunction getSizeOffsetInfo(moveable, poses, direction, keepRatio, isRequest, datas) {\r\n    var fixedDirection = datas.fixedDirection;\r\n    var directions = getCheckSnapDirections(direction, fixedDirection, keepRatio);\r\n    var innerBoundLineInfos = getCheckInnerBoundLineInfos(moveable, poses, direction, keepRatio);\r\n    var offsets = __spreadArray(__spreadArray([], __read(getSnapBoundInfo(moveable, poses, directions, keepRatio, isRequest, datas)), false), __read(getInnerBoundInfo(moveable, innerBoundLineInfos, datas)), false);\r\n    var widthOffsetInfo = getNearOffsetInfo(offsets, 0);\r\n    var heightOffsetInfo = getNearOffsetInfo(offsets, 1);\r\n    return {\r\n        width: {\r\n            isBound: widthOffsetInfo.isBound,\r\n            offset: widthOffsetInfo.offset[0],\r\n        },\r\n        height: {\r\n            isBound: heightOffsetInfo.isBound,\r\n            offset: heightOffsetInfo.offset[1],\r\n        },\r\n    };\r\n}\r\nfunction recheckSizeByTwoDirection(moveable, poses, width, height, maxWidth, maxHeight, direction, isRequest, datas) {\r\n    var snapPos = getPosByDirection(poses, direction);\r\n    var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n        vertical: [snapPos[0]],\r\n        horizontal: [snapPos[1]],\r\n    }), horizontalOffset = _a.horizontal.offset, verticalOffset = _a.vertical.offset;\r\n    if (throttle(verticalOffset, FLOAT_POINT_NUM) || throttle(horizontalOffset, FLOAT_POINT_NUM)) {\r\n        var _b = __read(getDragDist({\r\n            datas: datas,\r\n            distX: -verticalOffset,\r\n            distY: -horizontalOffset,\r\n        }), 2), nextWidthOffset = _b[0], nextHeightOffset = _b[1];\r\n        var nextWidth = Math.min(maxWidth || Infinity, width + direction[0] * nextWidthOffset);\r\n        var nextHeight = Math.min(maxHeight || Infinity, height + direction[1] * nextHeightOffset);\r\n        return [nextWidth - width, nextHeight - height];\r\n    }\r\n    return [0, 0];\r\n}\r\nfunction checkSizeDist(moveable, getNextPoses, width, height, direction, fixedPosition, isRequest, datas) {\r\n    var poses = getAbsolutePosesByState(moveable.state);\r\n    var keepRatio = moveable.props.keepRatio;\r\n    var widthOffset = 0;\r\n    var heightOffset = 0;\r\n    for (var i = 0; i < 2; ++i) {\r\n        var nextPoses = getNextPoses(widthOffset, heightOffset);\r\n        var _a = getSizeOffsetInfo(moveable, nextPoses, direction, keepRatio, isRequest, datas), widthOffsetInfo = _a.width, heightOffsetInfo = _a.height;\r\n        var isWidthBound = widthOffsetInfo.isBound;\r\n        var isHeightBound = heightOffsetInfo.isBound;\r\n        var nextWidthOffset = widthOffsetInfo.offset;\r\n        var nextHeightOffset = heightOffsetInfo.offset;\r\n        if (i === 1) {\r\n            if (!isWidthBound) {\r\n                nextWidthOffset = 0;\r\n            }\r\n            if (!isHeightBound) {\r\n                nextHeightOffset = 0;\r\n            }\r\n        }\r\n        if (i === 0 && isRequest && !isWidthBound && !isHeightBound) {\r\n            return [0, 0];\r\n        }\r\n        if (keepRatio) {\r\n            var widthDist = abs(nextWidthOffset) * (width ? 1 / width : 1);\r\n            var heightDist = abs(nextHeightOffset) * (height ? 1 / height : 1);\r\n            var isGetWidthOffset = isWidthBound && isHeightBound\r\n                ? widthDist < heightDist\r\n                : isHeightBound ||\r\n                    (!isWidthBound && widthDist < heightDist);\r\n            if (isGetWidthOffset) {\r\n                // width : height = ? : heightOffset\r\n                nextWidthOffset = (width * nextHeightOffset) / height;\r\n            }\r\n            else {\r\n                // width : height = widthOffset : ?\r\n                nextHeightOffset = (height * nextWidthOffset) / width;\r\n            }\r\n        }\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    if (!keepRatio && direction[0] && direction[1]) {\r\n        var _b = checkMaxBounds(moveable, poses, direction, fixedPosition, datas), maxWidth = _b.maxWidth, maxHeight = _b.maxHeight;\r\n        var _c = __read(recheckSizeByTwoDirection(moveable, getNextPoses(widthOffset, heightOffset).map(function (pos) { return pos.map(function (p) { return throttle(p, FLOAT_POINT_NUM); }); }), width + widthOffset, height + heightOffset, maxWidth, maxHeight, direction, isRequest, datas), 2), nextWidthOffset = _c[0], nextHeightOffset = _c[1];\r\n        widthOffset += nextWidthOffset;\r\n        heightOffset += nextHeightOffset;\r\n    }\r\n    return [widthOffset, heightOffset];\r\n}\r\nfunction absDegree(deg) {\r\n    if (deg < 0) {\r\n        deg = deg % 360 + 360;\r\n    }\r\n    deg %= 360;\r\n    return deg;\r\n}\r\nfunction bumpDegree(baseDeg, snapDeg) {\r\n    // baseDeg -80\r\n    // snapDeg 270\r\n    // return -90\r\n    snapDeg = absDegree(snapDeg);\r\n    var count = Math.floor(baseDeg / 360);\r\n    var deg1 = count * 360 + 360 - snapDeg;\r\n    var deg2 = count * 360 + snapDeg;\r\n    return abs(baseDeg - deg1) < abs(baseDeg - deg2) ? deg1 : deg2;\r\n}\r\nfunction getMinDegreeDistance(deg1, deg2) {\r\n    deg1 = absDegree(deg1);\r\n    deg2 = absDegree(deg2);\r\n    var deg3 = absDegree(deg1 - deg2);\r\n    return Math.min(deg3, 360 - deg3);\r\n}\r\nfunction checkSnapRotate(moveable, rect, dist, rotation) {\r\n    var _a;\r\n    var props = moveable.props;\r\n    var snapRotationThreshold = (_a = props[NAME_snapRotationThreshold]) !== null && _a !== void 0 ? _a : 5;\r\n    var snapRotationDegrees = props[NAME_snapRotationDegrees];\r\n    if (hasGuidelines(moveable, \"rotatable\")) {\r\n        var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4, origin2_1 = rect.origin;\r\n        var rad_1 = (dist * Math.PI) / 180;\r\n        var prevPoses = [pos1, pos2, pos3, pos4].map(function (pos) { return minus(pos, origin2_1); });\r\n        var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad_1); });\r\n        // console.log(moveable.state.left, moveable.state.top, moveable.state.origin);\r\n        // console.log(pos1, pos2, pos3, pos4, origin, rad, prevPoses, nextPoses);\r\n        var result = __spreadArray(__spreadArray([], __read(checkRotateBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false), __read(checkRotateInnerBounds(moveable, prevPoses, nextPoses, origin2_1, dist)), false);\r\n        result.sort(function (a, b) { return abs(a - dist) - abs(b - dist); });\r\n        var isSnap = result.length > 0;\r\n        if (isSnap) {\r\n            return {\r\n                isSnap: isSnap,\r\n                dist: isSnap ? result[0] : dist,\r\n            };\r\n        }\r\n    }\r\n    if ((snapRotationDegrees === null || snapRotationDegrees === void 0 ? void 0 : snapRotationDegrees.length) && snapRotationThreshold) {\r\n        var sorted = snapRotationDegrees.slice().sort(function (a, b) {\r\n            return getMinDegreeDistance(a, rotation) - getMinDegreeDistance(b, rotation);\r\n        });\r\n        var firstDegree = sorted[0];\r\n        if (getMinDegreeDistance(firstDegree, rotation) <= snapRotationThreshold) {\r\n            return {\r\n                isSnap: true,\r\n                dist: dist + bumpDegree(rotation, firstDegree) - rotation,\r\n            };\r\n        }\r\n    }\r\n    return {\r\n        isSnap: false,\r\n        dist: dist,\r\n    };\r\n}\r\nfunction checkSnapResize(moveable, width, height, direction, fixedPosition, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"resizable\")) {\r\n        return [0, 0];\r\n    }\r\n    var fixedDirection = datas.fixedDirection, nextAllMatrix = datas.nextAllMatrix;\r\n    var _a = moveable.state, allMatrix = _a.allMatrix, is3d = _a.is3d;\r\n    return checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(nextAllMatrix || allMatrix, width + widthOffset, height + heightOffset, fixedDirection, fixedPosition, is3d);\r\n    }, width, height, direction, fixedPosition, isRequest, datas);\r\n}\r\nfunction checkSnapScale(moveable, scale, direction, isRequest, datas) {\r\n    if (!hasGuidelines(moveable, \"scalable\")) {\r\n        return [0, 0];\r\n    }\r\n    var startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, fixedPosition = datas.fixedPosition, fixedDirection = datas.fixedDirection, is3d = datas.is3d;\r\n    var sizeDist = checkSizeDist(moveable, function (widthOffset, heightOffset) {\r\n        return getNextFixedPoses(scaleMatrix(datas, plus(scale, [widthOffset / startOffsetWidth, heightOffset / startOffsetHeight])), startOffsetWidth, startOffsetHeight, fixedDirection, fixedPosition, is3d);\r\n    }, startOffsetWidth, startOffsetHeight, direction, fixedPosition, isRequest, datas);\r\n    return [sizeDist[0] / startOffsetWidth, sizeDist[1] / startOffsetHeight];\r\n}\r\nfunction startCheckSnapDrag(moveable, datas) {\r\n    datas.absolutePoses = getAbsolutePosesByState(moveable.state);\r\n}\r\nfunction getSnapGuidelines(posInfos) {\r\n    var guidelines = [];\r\n    posInfos.forEach(function (posInfo) {\r\n        posInfo.guidelineInfos.forEach(function (_a) {\r\n            var guideline = _a.guideline;\r\n            if (find(guidelines, function (info) { return info.guideline === guideline; })) {\r\n                return;\r\n            }\r\n            guideline.direction = \"\";\r\n            guidelines.push({ guideline: guideline, posInfo: posInfo });\r\n        });\r\n    });\r\n    return guidelines.map(function (_a) {\r\n        var guideline = _a.guideline, posInfo = _a.posInfo;\r\n        return __assign(__assign({}, guideline), { direction: posInfo.direction });\r\n    });\r\n}\r\nfunction addBoundGuidelines(moveable, verticalPoses, horizontalPoses, verticalSnapPoses, horizontalSnapPoses, externalBounds) {\r\n    var _a = checkBoundPoses(getBounds(moveable, externalBounds), verticalPoses, horizontalPoses), verticalBoundInfos = _a.vertical, horizontalBoundInfos = _a.horizontal;\r\n    var boundMap = getInitialBounds();\r\n    verticalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.left = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.right = true;\r\n            }\r\n            verticalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    horizontalBoundInfos.forEach(function (info) {\r\n        if (info.isBound) {\r\n            if (info.direction === \"start\") {\r\n                boundMap.top = true;\r\n            }\r\n            if (info.direction === \"end\") {\r\n                boundMap.bottom = true;\r\n            }\r\n            horizontalSnapPoses.push({\r\n                type: \"bounds\",\r\n                pos: info.pos,\r\n            });\r\n        }\r\n    });\r\n    var _b = checkInnerBoundPoses(moveable), innerBoundMap = _b.boundMap, verticalInnerBoundPoses = _b.vertical, horizontalInnerBoundPoses = _b.horizontal;\r\n    verticalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(verticalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        verticalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    horizontalInnerBoundPoses.forEach(function (innerPos) {\r\n        if (findIndex(horizontalSnapPoses, function (_a) {\r\n            var type = _a.type, pos = _a.pos;\r\n            return type === \"bounds\" && pos === innerPos;\r\n        }) >= 0) {\r\n            return;\r\n        }\r\n        horizontalSnapPoses.push({\r\n            type: \"bounds\",\r\n            pos: innerPos,\r\n        });\r\n    });\r\n    return {\r\n        boundMap: boundMap,\r\n        innerBoundMap: innerBoundMap,\r\n    };\r\n}\r\nvar directionCondition$1 = getDirectionCondition(\"\", [\"resizable\", \"scalable\"]);\r\n/**\r\n * @namespace Moveable.Snappable\r\n * @description Whether or not target can be snapped to the guideline. (default: false)\r\n * @sort 2\r\n */\r\nvar Snappable = {\r\n    name: \"snappable\",\r\n    dragRelation: \"strong\",\r\n    props: [\r\n        \"snappable\",\r\n        \"snapContainer\",\r\n        \"snapDirections\",\r\n        \"elementSnapDirections\",\r\n        \"snapGap\",\r\n        \"snapGridWidth\",\r\n        \"snapGridHeight\",\r\n        \"isDisplaySnapDigit\",\r\n        \"isDisplayInnerSnapDigit\",\r\n        \"isDisplayGridGuidelines\",\r\n        \"snapDigit\",\r\n        \"snapThreshold\",\r\n        \"snapRenderThreshold\",\r\n        \"snapGridAll\",\r\n        NAME_snapRotationThreshold,\r\n        NAME_snapRotationDegrees,\r\n        NAME_snapHorizontalThreshold,\r\n        NAME_snapVerticalThreshold,\r\n        \"horizontalGuidelines\",\r\n        \"verticalGuidelines\",\r\n        \"elementGuidelines\",\r\n        \"bounds\",\r\n        \"innerBounds\",\r\n        \"snapDistFormat\",\r\n        \"maxSnapElementGuidelineDistance\",\r\n        \"maxSnapElementGapDistance\",\r\n    ],\r\n    events: [\"snap\", \"bound\"],\r\n    css: [\r\n        \":host {\\n--bounds-color: #d66;\\n}\\n.guideline {\\npointer-events: none;\\nz-index: 2;\\n}\\n.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\\n.guideline-group {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.guideline-group .size-value {\\nposition: absolute;\\ncolor: #f55;\\nfont-size: 12px;\\nfont-size: calc(12px * var(--zoom));\\nfont-weight: bold;\\n}\\n.guideline-group.horizontal .size-value {\\ntransform-origin: 50% 100%;\\ntransform: translateX(-50%);\\nleft: 50%;\\nbottom: 5px;\\nbottom: calc(2px + 3px * var(--zoom));\\n}\\n.guideline-group.vertical .size-value {\\ntransform-origin: 0% 50%;\\ntop: 50%;\\ntransform: translateY(-50%);\\nleft: 5px;\\nleft: calc(2px + 3px * var(--zoom));\\n}\\n.guideline.gap {\\nbackground: #f55;\\n}\\n.size-value.gap {\\ncolor: #f55;\\n}\\n\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var state = moveable.state;\r\n        var targetTop = state.top, targetLeft = state.left, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, snapRenderInfo = state.snapRenderInfo;\r\n        var _a = moveable.props.snapRenderThreshold, snapRenderThreshold = _a === void 0 ? 1 : _a;\r\n        if (!snapRenderInfo || !snapRenderInfo.render || !hasGuidelines(moveable, \"\")) {\r\n            // reset store\r\n            watchValue(moveable, \"boundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            watchValue(moveable, \"innerBoundMap\", getInitialBounds(), function (v) { return JSON.stringify(v); });\r\n            return [];\r\n        }\r\n        state.guidelines = getTotalGuidelines(moveable);\r\n        var minLeft = Math.min(pos1[0], pos2[0], pos3[0], pos4[0]);\r\n        var minTop = Math.min(pos1[1], pos2[1], pos3[1], pos4[1]);\r\n        var externalPoses = snapRenderInfo.externalPoses || [];\r\n        var poses = getAbsolutePosesByState(moveable.state);\r\n        var verticalSnapPoses = [];\r\n        var horizontalSnapPoses = [];\r\n        var verticalGuidelines = [];\r\n        var horizontalGuidelines = [];\r\n        var snapInfos = [];\r\n        var _b = getRect(poses), width = _b.width, height = _b.height, top = _b.top, left = _b.left, bottom = _b.bottom, right = _b.right;\r\n        var targetRect = { left: left, right: right, top: top, bottom: bottom, center: (left + right) / 2, middle: (top + bottom) / 2 };\r\n        var hasExternalPoses = externalPoses.length > 0;\r\n        var externalRect = hasExternalPoses\r\n            ? getRect(externalPoses)\r\n            : {};\r\n        if (!snapRenderInfo.request) {\r\n            if (snapRenderInfo.direction) {\r\n                snapInfos.push(getSnapInfosByDirection(moveable, poses, snapRenderInfo.direction, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (snapRenderInfo.snap) {\r\n                var rect = getRect(poses);\r\n                if (snapRenderInfo.center) {\r\n                    rect.middle = (rect.top + rect.bottom) / 2;\r\n                    rect.center = (rect.left + rect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, rect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            if (hasExternalPoses) {\r\n                if (snapRenderInfo.center) {\r\n                    externalRect.middle =\r\n                        (externalRect.top + externalRect.bottom) / 2;\r\n                    externalRect.center =\r\n                        (externalRect.left + externalRect.right) / 2;\r\n                }\r\n                snapInfos.push(checkSnaps(moveable, externalRect, snapRenderThreshold, snapRenderThreshold));\r\n            }\r\n            snapInfos.forEach(function (snapInfo) {\r\n                var verticalPosInfos = snapInfo.vertical.posInfos, horizontalPosInfos = snapInfo.horizontal.posInfos;\r\n                verticalSnapPoses.push.apply(verticalSnapPoses, __spreadArray([], __read(verticalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                horizontalSnapPoses.push.apply(horizontalSnapPoses, __spreadArray([], __read(horizontalPosInfos.filter(function (_a) {\r\n                    var guidelineInfos = _a.guidelineInfos;\r\n                    return guidelineInfos.some(function (_a) {\r\n                        var guideline = _a.guideline;\r\n                        return !guideline.hide;\r\n                    });\r\n                }).map(function (posInfo) { return ({\r\n                    type: \"snap\",\r\n                    pos: posInfo.pos,\r\n                }); })), false));\r\n                verticalGuidelines.push.apply(verticalGuidelines, __spreadArray([], __read(getSnapGuidelines(verticalPosInfos)), false));\r\n                horizontalGuidelines.push.apply(horizontalGuidelines, __spreadArray([], __read(getSnapGuidelines(horizontalPosInfos)), false));\r\n            });\r\n        }\r\n        var _c = addBoundGuidelines(moveable, [left, right], [top, bottom], verticalSnapPoses, horizontalSnapPoses), boundMap = _c.boundMap, innerBoundMap = _c.innerBoundMap;\r\n        if (hasExternalPoses) {\r\n            addBoundGuidelines(moveable, [externalRect.left, externalRect.right], [externalRect.top, externalRect.bottom], verticalSnapPoses, horizontalSnapPoses, snapRenderInfo.externalBounds);\r\n        }\r\n        var allGuidelines = __spreadArray(__spreadArray([], __read(verticalGuidelines), false), __read(horizontalGuidelines), false);\r\n        var elementGuidelines = allGuidelines.filter(function (guideline) { return guideline.element && !guideline.gapRects; });\r\n        var gapGuidelines = allGuidelines.filter(function (guideline) { return guideline.gapRects; }).sort(function (a, b) {\r\n            return a.gap - b.gap;\r\n        });\r\n        triggerEvent(moveable, \"onSnap\", {\r\n            guidelines: allGuidelines.filter(function (_a) {\r\n                var element = _a.element;\r\n                return !element;\r\n            }),\r\n            elements: elementGuidelines,\r\n            gaps: gapGuidelines,\r\n        }, true);\r\n        var nextBoundMap = watchValue(moveable, \"boundMap\", boundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        var nextInnerBoundMap = watchValue(moveable, \"innerBoundMap\", innerBoundMap, function (v) { return JSON.stringify(v); }, getInitialBounds());\r\n        if (boundMap === nextBoundMap || innerBoundMap === nextInnerBoundMap) {\r\n            triggerEvent(moveable, \"onBound\", {\r\n                bounds: boundMap,\r\n                innerBounds: innerBoundMap,\r\n            }, true);\r\n        }\r\n        // verticalSnapPoses.\r\n        return __spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(renderDashedGuidelines(moveable, elementGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGapGuidelines(moveable, gapGuidelines, [minLeft, minTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"horizontal\", horizontalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderGuidelines(moveable, \"vertical\", verticalGuidelines, [targetLeft, targetTop], targetRect, React)), false), __read(renderSnapPoses(moveable, \"horizontal\", horizontalSnapPoses, minLeft, targetTop, width, 0, React)), false), __read(renderSnapPoses(moveable, \"vertical\", verticalSnapPoses, minTop, targetLeft, height, 1, React)), false);\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            snap: true,\r\n            center: true,\r\n        };\r\n        checkSnapInfo(moveable);\r\n    },\r\n    drag: function (moveable) {\r\n        var state = moveable.state;\r\n        if (!checkSnapInfo(moveable)) {\r\n            state.guidelines = getTotalGuidelines(moveable);\r\n        }\r\n        if (state.snapRenderInfo) {\r\n            state.snapRenderInfo.render = true;\r\n        }\r\n    },\r\n    pinchStart: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (directionCondition$1(moveable, e) || dragControlCondition(moveable, e)) {\r\n            return true;\r\n        }\r\n        if (!e.isRequest && e.inputEvent) {\r\n            return hasClass(e.inputEvent.target, prefix(\"snap-control\"));\r\n        }\r\n    },\r\n    dragControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    dragGroupControlStart: function (moveable) {\r\n        moveable.state.snapRenderInfo = null;\r\n        checkSnapInfo(moveable);\r\n    },\r\n    dragGroupControl: function (moveable) {\r\n        this.drag(moveable);\r\n    },\r\n    dragGroupControlEnd: function (moveable) {\r\n        this.unset(moveable);\r\n    },\r\n    unset: function (moveable) {\r\n        var state = moveable.state;\r\n        state.enableSnap = false;\r\n        state.guidelines = [];\r\n        state.snapRenderInfo = null;\r\n        state.elementRects = [];\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be snapped to the guideline. (default: false)\r\n * @name Moveable.Snappable#snappable\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snappable = true;\r\n */\r\n/**\r\n *  A snap container that is the basis for snap, bounds, and innerBounds. (default: null = container)\r\n * @name Moveable.Snappable#snapContainer\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.querySelector(\".container\"));\r\n *\r\n * moveable.snapContainer = document.body;\r\n */\r\n/**\r\n * You can specify the directions to snap to the target. (default: { left: true, top: true, right: true, bottom: true })\r\n * @name Moveable.Snappable#snapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.snapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * You can specify the snap directions of elements. (default: { left: true, ftrue, right: true, bottom: true })\r\n * @name Moveable.Snappable#elementSnapDirections\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   elementSnapDirections: true,\r\n * });\r\n * // snap center\r\n * moveable.elementSnapDirections = { left: true, top: true, right: true, bottom: true, center: true, middle: true };\r\n */\r\n/**\r\n * When you drag, make the gap snap in the element guidelines. (default: true)\r\n * @name Moveable.Snappable#snapGap\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   snappable: true,\r\n *   snapElement: true,\r\n *   snapGap: true,\r\n * });\r\n *\r\n * moveable.snapGap = false;\r\n */\r\n/**\r\n * Distance value that can snap to guidelines. (default: 5)\r\n * @name Moveable.Snappable#snapThreshold\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapThreshold = 5;\r\n */\r\n/**\r\n * Add guidelines in the horizontal direction. (default: [])\r\n * @name Moveable.Snappable#horizontalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.horizontalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines in the vertical direction. (default: [])\r\n * @name Moveable.Snappable#verticalGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.verticalGuidelines = [100, 200, 500];\r\n */\r\n/**\r\n * Add guidelines for the element. (default: [])\r\n * @name Moveable.Snappable#elementGuidelines\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.elementGuidelines = [\r\n *   document.querySelector(\".element\"),\r\n * ];\r\n */\r\n/**\r\n * You can set up boundaries.\r\n * @name Moveable.Snappable#bounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.bounds = { left: 0, right: 1000, top: 0, bottom: 1000};\r\n */\r\n/**\r\n * You can set up inner boundaries.\r\n * @name Moveable.Snappable#innerBounds\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.innerBounds = { left: 500, top: 500, width: 100, height: 100};\r\n */\r\n/**\r\n * snap distance digits (default: 0)\r\n * @name Moveable.Snappable#snapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapDigit = 0\r\n */\r\n/**\r\n * If width size is greater than 0, you can vertical snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridWidth\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridWidth = 5;\r\n */\r\n/**\r\n * If height size is greater than 0, you can horizontal snap to the grid. (default: 0)\r\n * @name Moveable.Snappable#snapGridHeight\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.snapGridHeight = 5;\r\n */\r\n/**\r\n * Whether to show snap distance (default: true)\r\n * @name Moveable.Snappable#isDisplaySnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplaySnapDigit = true;\r\n */\r\n/**\r\n * Whether to show element inner snap distance (default: false)\r\n * @name Moveable.Snappable#isDisplayInnerSnapDigit\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.isDisplayInnerSnapDigit = true;\r\n */\r\n/**\r\n * You can set the text format of the distance shown in the guidelines. (default: self)\r\n * @name Moveable.Snappable#snapDistFormat\r\n * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Snappable.html#.SnappableOptions}\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  snappable: true,\r\n *  snapDistFormat: (v, type) => v,\r\n * });\r\n * moveable.snapDistFormat = (v, type) => `${v}px`;\r\n */\r\n/**\r\n * When you drag or dragControl, the `snap` event is called.\r\n * @memberof Moveable.Snappable\r\n * @event snap\r\n * @param {Moveable.Snappable.OnSnap} - Parameters for the `snap` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     snappable: true\r\n * });\r\n * moveable.on(\"snap\", e => {\r\n *     console.log(\"onSnap\", e);\r\n * });\r\n */\n\nfunction multiply2(pos1, pos2) {\r\n    return [\r\n        pos1[0] * pos2[0],\r\n        pos1[1] * pos2[1],\r\n    ];\r\n}\r\nfunction prefix() {\r\n    var classNames = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        classNames[_i] = arguments[_i];\r\n    }\r\n    return prefixNames.apply(void 0, __spreadArray([PREFIX], __read(classNames), false));\r\n}\r\nfunction defaultSync(fn) {\r\n    fn();\r\n}\r\nfunction getTransformMatrix(transform) {\r\n    if (!transform || transform === \"none\") {\r\n        return [1, 0, 0, 1, 0, 0];\r\n    }\r\n    if (isObject(transform)) {\r\n        return transform;\r\n    }\r\n    return parseMat(transform);\r\n}\r\nfunction getAbsoluteMatrix(matrix, n, origin) {\r\n    return multiplies(n, createOriginMatrix(origin, n), matrix, createOriginMatrix(origin.map(function (a) { return -a; }), n));\r\n}\r\nfunction measureSVGSize(el, unit, isHorizontal) {\r\n    if (unit === \"%\") {\r\n        var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n        return viewBox[isHorizontal ? \"width\" : \"height\"] / 100;\r\n    }\r\n    return 1;\r\n}\r\nfunction getBeforeTransformOrigin(el) {\r\n    var relativeOrigin = getTransformOrigin(getComputedStyle(el, \":before\"));\r\n    return relativeOrigin.map(function (o, i) {\r\n        var _a = splitUnit(o), value = _a.value, unit = _a.unit;\r\n        return value * measureSVGSize(el, unit, i === 0);\r\n    });\r\n}\r\nfunction getTransformOriginArray(transformOrigin) {\r\n    return transformOrigin ? transformOrigin.split(\" \") : [\"0\", \"0\"];\r\n}\r\nfunction getTransformOrigin(style) {\r\n    return getTransformOriginArray(style.transformOrigin);\r\n}\r\nfunction getElementTransform(target) {\r\n    var getStyle = getCachedStyle(target);\r\n    var computedTransform = getStyle(\"transform\");\r\n    if (computedTransform && computedTransform !== \"none\") {\r\n        return computedTransform;\r\n    }\r\n    if (\"transform\" in target) {\r\n        var list = target.transform;\r\n        var baseVal = list.baseVal;\r\n        if (!baseVal) {\r\n            return \"\";\r\n        }\r\n        var length_1 = baseVal.length;\r\n        if (!length_1) {\r\n            return \"\";\r\n        }\r\n        var matrixes = [];\r\n        var _loop_1 = function (i) {\r\n            var matrix = baseVal[i].matrix;\r\n            matrixes.push(\"matrix(\".concat([\"a\", \"b\", \"c\", \"d\", \"e\", \"f\"].map(function (chr) { return matrix[chr]; }).join(\", \"), \")\"));\r\n        };\r\n        for (var i = 0; i < length_1; ++i) {\r\n            _loop_1(i);\r\n        }\r\n        return matrixes.join(\" \");\r\n    }\r\n    return \"\";\r\n}\r\nfunction getOffsetInfo(el, lastParent, isParent, checkZoom, getTargetStyle) {\r\n    var _a, _b;\r\n    var documentElement = getDocumentElement(el) || getDocumentBody(el);\r\n    var hasSlot = false;\r\n    var target;\r\n    var parentSlotElement;\r\n    if (!el || isParent) {\r\n        target = el;\r\n    }\r\n    else {\r\n        var assignedSlotParentElement = (_a = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _a === void 0 ? void 0 : _a.parentElement;\r\n        var parentElement = el.parentElement;\r\n        if (assignedSlotParentElement) {\r\n            hasSlot = true;\r\n            parentSlotElement = parentElement;\r\n            target = assignedSlotParentElement;\r\n        }\r\n        else {\r\n            target = parentElement;\r\n        }\r\n    }\r\n    var isCustomElement = false;\r\n    var isEnd = el === lastParent || target === lastParent;\r\n    var position = \"relative\";\r\n    var offsetZoom = 1;\r\n    var targetZoom = parseFloat(getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"zoom\")) || 1;\r\n    var targetPosition = getTargetStyle === null || getTargetStyle === void 0 ? void 0 : getTargetStyle(\"position\");\r\n    while (target && target !== documentElement) {\r\n        if (lastParent === target) {\r\n            isEnd = true;\r\n        }\r\n        var getStyle = getCachedStyle(target);\r\n        var tagName = target.tagName.toLowerCase();\r\n        var transform = getElementTransform(target);\r\n        var willChange = getStyle(\"willChange\");\r\n        var zoom = parseFloat(getStyle(\"zoom\")) || 1;\r\n        position = getStyle(\"position\");\r\n        if (checkZoom && zoom !== 1) {\r\n            offsetZoom = zoom;\r\n            break;\r\n        }\r\n        if (\r\n        // offsetParent is the parentElement if the target's zoom is not 1 and not absolute.\r\n        !isParent && checkZoom && targetZoom !== 1 && targetPosition && targetPosition !== \"absolute\"\r\n            || tagName === \"svg\"\r\n            || tagName === \"foreignobject\"\r\n            || position !== \"static\"\r\n            || (transform && transform !== \"none\")\r\n            || willChange === \"transform\") {\r\n            break;\r\n        }\r\n        var slotParentNode = (_b = el === null || el === void 0 ? void 0 : el.assignedSlot) === null || _b === void 0 ? void 0 : _b.parentNode;\r\n        var targetParentNode = target.parentNode;\r\n        if (slotParentNode) {\r\n            hasSlot = true;\r\n            parentSlotElement = targetParentNode;\r\n        }\r\n        var parentNode = targetParentNode;\r\n        if (parentNode && parentNode.nodeType === 11) {\r\n            // Shadow Root\r\n            target = parentNode.host;\r\n            isCustomElement = true;\r\n            position = getCachedStyle(target)(\"position\");\r\n            break;\r\n        }\r\n        target = parentNode;\r\n        position = \"relative\";\r\n    }\r\n    return {\r\n        offsetZoom: offsetZoom,\r\n        hasSlot: hasSlot,\r\n        parentSlotElement: parentSlotElement,\r\n        isCustomElement: isCustomElement,\r\n        isStatic: position === \"static\",\r\n        isEnd: isEnd || !target || target === documentElement,\r\n        offsetParent: target || documentElement,\r\n    };\r\n}\r\nfunction getOffsetPosInfo(el, target) {\r\n    var _a;\r\n    var tagName = el.tagName.toLowerCase();\r\n    var offsetLeft = el.offsetLeft;\r\n    var offsetTop = el.offsetTop;\r\n    var getStyle = getCachedStyle(el);\r\n    // svg\r\n    var isSVG = isUndefined(offsetLeft);\r\n    var hasOffset = !isSVG;\r\n    var origin;\r\n    var targetOrigin;\r\n    // inner svg element\r\n    if (!hasOffset && (tagName !== \"svg\" || el.ownerSVGElement)) {\r\n        origin = IS_WEBKIT605\r\n            ? getBeforeTransformOrigin(el)\r\n            : getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        hasOffset = true;\r\n        if (tagName === \"svg\") {\r\n            offsetLeft = 0;\r\n            offsetTop = 0;\r\n        }\r\n        else {\r\n            _a = __read(getSVGGraphicsOffset(el, origin, el === target && target.tagName.toLowerCase() === \"g\"), 4), offsetLeft = _a[0], offsetTop = _a[1], origin[0] = _a[2], origin[1] = _a[3];\r\n        }\r\n    }\r\n    else {\r\n        origin = getTransformOriginArray(getStyle(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); });\r\n        targetOrigin = origin.slice();\r\n        // console.log(getStyle(\"transformOrigin\"), targetOrigin);\r\n    }\r\n    return {\r\n        tagName: tagName,\r\n        isSVG: isSVG,\r\n        hasOffset: hasOffset,\r\n        offset: [offsetLeft || 0, offsetTop || 0],\r\n        origin: origin,\r\n        targetOrigin: targetOrigin,\r\n    };\r\n}\r\nfunction getBodyOffset(el, isSVG) {\r\n    var getStyle = getCachedStyle(el);\r\n    var getBodyStyle = getCachedStyle(getDocumentBody(el));\r\n    var bodyPosition = getBodyStyle(\"position\");\r\n    if (!isSVG && (!bodyPosition || bodyPosition === \"static\")) {\r\n        return [0, 0];\r\n    }\r\n    var marginLeft = parseInt(getBodyStyle(\"marginLeft\"), 10);\r\n    var marginTop = parseInt(getBodyStyle(\"marginTop\"), 10);\r\n    if (getStyle(\"position\") === \"absolute\") {\r\n        if (getStyle(\"top\") !== \"auto\" || getStyle(\"bottom\") !== \"auto\") {\r\n            marginTop = 0;\r\n        }\r\n        if (getStyle(\"left\") !== \"auto\" || getStyle(\"right\") !== \"auto\") {\r\n            marginLeft = 0;\r\n        }\r\n    }\r\n    return [marginLeft, marginTop];\r\n}\r\nfunction convert3DMatrixes(matrixes) {\r\n    matrixes.forEach(function (info) {\r\n        var matrix = info.matrix;\r\n        if (matrix) {\r\n            info.matrix = convertDimension(matrix, 3, 4);\r\n        }\r\n    });\r\n}\r\nfunction getPositionFixedInfo(el) {\r\n    var fixedContainer = el.parentElement;\r\n    var hasTransform = false;\r\n    var body = getDocumentBody(el);\r\n    while (fixedContainer) {\r\n        var transform = getComputedStyle(fixedContainer).transform;\r\n        if (transform && transform !== \"none\") {\r\n            hasTransform = true;\r\n            break;\r\n        }\r\n        if (fixedContainer === body) {\r\n            break;\r\n        }\r\n        fixedContainer = fixedContainer.parentElement;\r\n    }\r\n    return {\r\n        fixedContainer: fixedContainer || body,\r\n        hasTransform: hasTransform,\r\n    };\r\n}\r\nfunction makeMatrixCSS(matrix, is3d) {\r\n    if (is3d === void 0) { is3d = matrix.length > 9; }\r\n    return \"\".concat(is3d ? \"matrix3d\" : \"matrix\", \"(\").concat(convertMatrixtoCSS(matrix, !is3d).join(\",\"), \")\");\r\n}\r\nfunction getSVGViewBox(el) {\r\n    var clientWidth = el.clientWidth;\r\n    var clientHeight = el.clientHeight;\r\n    if (!el) {\r\n        return { x: 0, y: 0, width: 0, height: 0, clientWidth: clientWidth, clientHeight: clientHeight };\r\n    }\r\n    var viewBox = el.viewBox;\r\n    var baseVal = (viewBox && viewBox.baseVal) || { x: 0, y: 0, width: 0, height: 0 };\r\n    return {\r\n        x: baseVal.x,\r\n        y: baseVal.y,\r\n        width: baseVal.width || clientWidth,\r\n        height: baseVal.height || clientHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n    };\r\n}\r\nfunction getSVGMatrix(el, n) {\r\n    var _a;\r\n    var _b = getSVGViewBox(el), viewBoxWidth = _b.width, viewBoxHeight = _b.height, clientWidth = _b.clientWidth, clientHeight = _b.clientHeight;\r\n    var scaleX = clientWidth / viewBoxWidth;\r\n    var scaleY = clientHeight / viewBoxHeight;\r\n    var preserveAspectRatio = el.preserveAspectRatio.baseVal;\r\n    // https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/preserveAspectRatio\r\n    var align = preserveAspectRatio.align;\r\n    // 1 : meet 2: slice\r\n    var meetOrSlice = preserveAspectRatio.meetOrSlice;\r\n    var svgOrigin = [0, 0];\r\n    var scale = [scaleX, scaleY];\r\n    var translate = [0, 0];\r\n    if (align !== 1) {\r\n        var xAlign = (align - 2) % 3;\r\n        var yAlign = Math.floor((align - 2) / 3);\r\n        svgOrigin[0] = viewBoxWidth * xAlign / 2;\r\n        svgOrigin[1] = viewBoxHeight * yAlign / 2;\r\n        var scaleDimension = meetOrSlice === 2 ? Math.max(scaleY, scaleX) : Math.min(scaleX, scaleY);\r\n        scale[0] = scaleDimension;\r\n        scale[1] = scaleDimension;\r\n        translate[0] = (clientWidth - viewBoxWidth) / 2 * xAlign;\r\n        translate[1] = (clientHeight - viewBoxHeight) / 2 * yAlign;\r\n    }\r\n    var scaleMatrix = createScaleMatrix(scale, n);\r\n    _a = __read(translate, 2), scaleMatrix[n * (n - 1)] = _a[0], scaleMatrix[n * (n - 1) + 1] = _a[1];\r\n    return getAbsoluteMatrix(scaleMatrix, n, svgOrigin);\r\n}\r\nfunction getSVGGraphicsOffset(el, origin, isGTarget) {\r\n    var tagName = el.tagName.toLowerCase();\r\n    if (!el.getBBox || !isGTarget && tagName === \"g\") {\r\n        return [0, 0, 0, 0];\r\n    }\r\n    var getStyle = getCachedStyle(el);\r\n    var isFillBox = getStyle(\"transform-box\") === \"fill-box\";\r\n    var bbox = el.getBBox();\r\n    var viewBox = getSVGViewBox(el.ownerSVGElement);\r\n    var x = bbox.x;\r\n    var y = bbox.y;\r\n    // x, y 0  \r\n    if (tagName === \"foreignobject\" && (!x && !y)) {\r\n        x = parseFloat(el.getAttribute(\"x\")) || 0;\r\n        y = parseFloat(el.getAttribute(\"y\")) || 0;\r\n    }\r\n    var left = x - viewBox.x;\r\n    var top = y - viewBox.y;\r\n    var originX = isFillBox ? origin[0] : origin[0] - left;\r\n    var originY = isFillBox ? origin[1] : origin[1] - top;\r\n    // if (isFillBox) {\r\n    //     const bbox = (el as SVGGraphicsElement).getBBox();\r\n    //     const x = parseFloat(getStyle(\"x\")) || bbox.x;\r\n    //     const y = parseFloat(getStyle(\"y\")) || bbox.y;\r\n    //     const xScale = bbox.x / x;\r\n    //     const yScale = bbox.y / y;\r\n    //     console.log(x, y);\r\n    //     originX *= xScale;\r\n    //     originY *= yScale;\r\n    // }\r\n    return [left, top, originX, originY];\r\n}\r\nfunction calculatePosition(matrix, pos, n) {\r\n    return calculate(matrix, convertPositionMatrix(pos, n), n);\r\n}\r\nfunction calculatePoses(matrix, width, height, n) {\r\n    return [[0, 0], [width, 0], [0, height], [width, height]].map(function (pos) { return calculatePosition(matrix, pos, n); });\r\n}\r\nfunction getRect(poses) {\r\n    var posesX = poses.map(function (pos) { return pos[0]; });\r\n    var posesY = poses.map(function (pos) { return pos[1]; });\r\n    var left = Math.min.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var top = Math.min.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var right = Math.max.apply(Math, __spreadArray([], __read(posesX), false));\r\n    var bottom = Math.max.apply(Math, __spreadArray([], __read(posesY), false));\r\n    var rectWidth = right - left;\r\n    var rectHeight = bottom - top;\r\n    return {\r\n        left: left,\r\n        top: top,\r\n        right: right,\r\n        bottom: bottom,\r\n        width: rectWidth,\r\n        height: rectHeight,\r\n    };\r\n}\r\nfunction calculateRect(matrix, width, height, n) {\r\n    var poses = calculatePoses(matrix, width, height, n);\r\n    return getRect(poses);\r\n}\r\nfunction getSVGOffset(offsetInfo, targetInfo, container, n, beforeMatrix) {\r\n    var _a;\r\n    var target = offsetInfo.target;\r\n    var origin = offsetInfo.origin;\r\n    var targetMatrix = targetInfo.matrix;\r\n    var _b = getSize(target), width = _b.offsetWidth, height = _b.offsetHeight;\r\n    var containerClientRect = container.getBoundingClientRect();\r\n    var margin = [0, 0];\r\n    if (container === getDocumentBody(container)) {\r\n        margin = getBodyOffset(target, true);\r\n    }\r\n    var rect = target.getBoundingClientRect();\r\n    var rectLeft = rect.left - containerClientRect.left + container.scrollLeft\r\n        - (container.clientLeft || 0) + margin[0];\r\n    var rectTop = rect.top - containerClientRect.top + container.scrollTop\r\n        - (container.clientTop || 0) + margin[1];\r\n    var rectWidth = rect.width;\r\n    var rectHeight = rect.height;\r\n    var mat = multiplies(n, beforeMatrix, targetMatrix);\r\n    var _c = calculateRect(mat, width, height, n), prevLeft = _c.left, prevTop = _c.top, prevWidth = _c.width, prevHeight = _c.height;\r\n    var posOrigin = calculatePosition(mat, origin, n);\r\n    var prevOrigin = minus(posOrigin, [prevLeft, prevTop]);\r\n    var rectOrigin = [\r\n        rectLeft + prevOrigin[0] * rectWidth / prevWidth,\r\n        rectTop + prevOrigin[1] * rectHeight / prevHeight,\r\n    ];\r\n    var offset = [0, 0];\r\n    var count = 0;\r\n    while (++count < 10) {\r\n        var inverseBeforeMatrix = invert(beforeMatrix, n);\r\n        _a = __read(minus(calculatePosition(inverseBeforeMatrix, rectOrigin, n), calculatePosition(inverseBeforeMatrix, posOrigin, n)), 2), offset[0] = _a[0], offset[1] = _a[1];\r\n        var mat2 = multiplies(n, beforeMatrix, createOriginMatrix(offset, n), targetMatrix);\r\n        var _d = calculateRect(mat2, width, height, n), nextLeft = _d.left, nextTop = _d.top;\r\n        var distLeft = nextLeft - rectLeft;\r\n        var distTop = nextTop - rectTop;\r\n        if (abs(distLeft) < 2 && abs(distTop) < 2) {\r\n            break;\r\n        }\r\n        rectOrigin[0] -= distLeft;\r\n        rectOrigin[1] -= distTop;\r\n    }\r\n    return offset.map(function (p) { return Math.round(p); });\r\n}\r\nfunction calculateMoveableClientPositions(rootMatrix, poses, rootClientRect) {\r\n    var is3d = rootMatrix.length === 16;\r\n    var n = is3d ? 4 : 3;\r\n    var rootPoses = poses.map(function (pos) { return calculatePosition(rootMatrix, pos, n); });\r\n    var left = rootClientRect.left, top = rootClientRect.top;\r\n    return rootPoses.map(function (pos) {\r\n        return [pos[0] + left, pos[1] + top];\r\n    });\r\n}\r\nfunction getDistSize(vec) {\r\n    return Math.sqrt(vec[0] * vec[0] + vec[1] * vec[1]);\r\n}\r\nfunction getDiagonalSize(pos1, pos2) {\r\n    return getDistSize([\r\n        pos2[0] - pos1[0],\r\n        pos2[1] - pos1[1],\r\n    ]);\r\n}\r\nfunction getLineStyle(pos1, pos2, zoom, rad) {\r\n    if (zoom === void 0) { zoom = 1; }\r\n    if (rad === void 0) { rad = getRad(pos1, pos2); }\r\n    var width = getDiagonalSize(pos1, pos2);\r\n    return {\r\n        transform: \"translateY(-50%) translate(\".concat(pos1[0], \"px, \").concat(pos1[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n        width: \"\".concat(width, \"px\"),\r\n    };\r\n}\r\nfunction getControlTransform(rotation, zoom) {\r\n    var poses = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        poses[_i - 2] = arguments[_i];\r\n    }\r\n    var length = poses.length;\r\n    var x = poses.reduce(function (prev, pos) { return prev + pos[0]; }, 0) / length;\r\n    var y = poses.reduce(function (prev, pos) { return prev + pos[1]; }, 0) / length;\r\n    return {\r\n        transform: \"translateZ(0px) translate(\".concat(x, \"px, \").concat(y, \"px) rotate(\").concat(rotation, \"rad) scale(\").concat(zoom, \")\"),\r\n    };\r\n}\r\nfunction getProps(props, ableName) {\r\n    var self = props[ableName];\r\n    if (isObject(self)) {\r\n        return __assign(__assign({}, props), self);\r\n    }\r\n    return props;\r\n}\r\nfunction getSize(target) {\r\n    var hasOffset = target && !isUndefined(target.offsetWidth);\r\n    var offsetWidth = 0;\r\n    var offsetHeight = 0;\r\n    var clientWidth = 0;\r\n    var clientHeight = 0;\r\n    var cssWidth = 0;\r\n    var cssHeight = 0;\r\n    var contentWidth = 0;\r\n    var contentHeight = 0;\r\n    var minWidth = 0;\r\n    var minHeight = 0;\r\n    var minOffsetWidth = 0;\r\n    var minOffsetHeight = 0;\r\n    var maxWidth = Infinity;\r\n    var maxHeight = Infinity;\r\n    var maxOffsetWidth = Infinity;\r\n    var maxOffsetHeight = Infinity;\r\n    var inlineCSSWidth = 0;\r\n    var inlineCSSHeight = 0;\r\n    var svg = false;\r\n    if (target) {\r\n        if (!hasOffset && target.ownerSVGElement) {\r\n            // check svg elements\r\n            var bbox = target.getBBox();\r\n            svg = true;\r\n            offsetWidth = bbox.width;\r\n            offsetHeight = bbox.height;\r\n            cssWidth = offsetWidth;\r\n            cssHeight = offsetHeight;\r\n            contentWidth = offsetWidth;\r\n            contentHeight = offsetHeight;\r\n            clientWidth = offsetWidth;\r\n            clientHeight = offsetHeight;\r\n        }\r\n        else {\r\n            // check html elements\r\n            var getStyle = getCachedStyle(target);\r\n            var targetStyle = target.style;\r\n            var boxSizing = getStyle(\"boxSizing\") === \"border-box\";\r\n            var borderLeft = parseFloat(getStyle(\"borderLeftWidth\")) || 0;\r\n            var borderRight = parseFloat(getStyle(\"borderRightWidth\")) || 0;\r\n            var borderTop = parseFloat(getStyle(\"borderTopWidth\")) || 0;\r\n            var borderBottom = parseFloat(getStyle(\"borderBottomWidth\")) || 0;\r\n            var paddingLeft = parseFloat(getStyle(\"paddingLeft\")) || 0;\r\n            var paddingRight = parseFloat(getStyle(\"paddingRight\")) || 0;\r\n            var paddingTop = parseFloat(getStyle(\"paddingTop\")) || 0;\r\n            var paddingBottom = parseFloat(getStyle(\"paddingBottom\")) || 0;\r\n            var horizontalPadding = paddingLeft + paddingRight;\r\n            var verticalPadding = paddingTop + paddingBottom;\r\n            var horizontalBorder = borderLeft + borderRight;\r\n            var verticalBorder = borderTop + borderBottom;\r\n            var horizontalOffset = horizontalPadding + horizontalBorder;\r\n            var verticalOffset = verticalPadding + verticalBorder;\r\n            var position = getStyle(\"position\");\r\n            var containerWidth = 0;\r\n            var containerHeight = 0;\r\n            // SVGSVGElement, HTMLElement\r\n            if (\"clientLeft\" in target) {\r\n                var parentElement = null;\r\n                if (position === \"absolute\") {\r\n                    var offsetInfo = getOffsetInfo(target, getDocumentBody(target));\r\n                    parentElement = offsetInfo.offsetParent;\r\n                }\r\n                else {\r\n                    parentElement = target.parentElement;\r\n                }\r\n                if (parentElement) {\r\n                    var getParentStyle = getCachedStyle(parentElement);\r\n                    containerWidth = parseFloat(getParentStyle(\"width\"));\r\n                    containerHeight = parseFloat(getParentStyle(\"height\"));\r\n                }\r\n            }\r\n            minWidth = Math.max(horizontalPadding, convertUnitSize(getStyle(\"minWidth\"), containerWidth) || 0);\r\n            minHeight = Math.max(verticalPadding, convertUnitSize(getStyle(\"minHeight\"), containerHeight) || 0);\r\n            maxWidth = convertUnitSize(getStyle(\"maxWidth\"), containerWidth);\r\n            maxHeight = convertUnitSize(getStyle(\"maxHeight\"), containerHeight);\r\n            if (isNaN(maxWidth)) {\r\n                maxWidth = Infinity;\r\n            }\r\n            if (isNaN(maxHeight)) {\r\n                maxHeight = Infinity;\r\n            }\r\n            inlineCSSWidth = convertUnitSize(targetStyle.width, 0) || 0;\r\n            inlineCSSHeight = convertUnitSize(targetStyle.height, 0) || 0;\r\n            cssWidth = parseFloat(getStyle(\"width\")) || 0;\r\n            cssHeight = parseFloat(getStyle(\"height\")) || 0;\r\n            contentWidth = abs(cssWidth - inlineCSSWidth) < 1\r\n                ? between(minWidth, inlineCSSWidth || cssWidth, maxWidth)\r\n                : cssWidth;\r\n            contentHeight = abs(cssHeight - inlineCSSHeight) < 1\r\n                ? between(minHeight, inlineCSSHeight || cssHeight, maxHeight)\r\n                : cssHeight;\r\n            offsetWidth = contentWidth;\r\n            offsetHeight = contentHeight;\r\n            clientWidth = contentWidth;\r\n            clientHeight = contentHeight;\r\n            if (boxSizing) {\r\n                maxOffsetWidth = maxWidth;\r\n                maxOffsetHeight = maxHeight;\r\n                minOffsetWidth = minWidth;\r\n                minOffsetHeight = minHeight;\r\n                contentWidth = offsetWidth - horizontalOffset;\r\n                contentHeight = offsetHeight - verticalOffset;\r\n            }\r\n            else {\r\n                maxOffsetWidth = maxWidth + horizontalOffset;\r\n                maxOffsetHeight = maxHeight + verticalOffset;\r\n                minOffsetWidth = minWidth + horizontalOffset;\r\n                minOffsetHeight = minHeight + verticalOffset;\r\n                offsetWidth = contentWidth + horizontalOffset;\r\n                offsetHeight = contentHeight + verticalOffset;\r\n            }\r\n            clientWidth = contentWidth + horizontalPadding;\r\n            clientHeight = contentHeight + verticalPadding;\r\n        }\r\n    }\r\n    return {\r\n        svg: svg,\r\n        offsetWidth: offsetWidth,\r\n        offsetHeight: offsetHeight,\r\n        clientWidth: clientWidth,\r\n        clientHeight: clientHeight,\r\n        contentWidth: contentWidth,\r\n        contentHeight: contentHeight,\r\n        inlineCSSWidth: inlineCSSWidth,\r\n        inlineCSSHeight: inlineCSSHeight,\r\n        cssWidth: cssWidth,\r\n        cssHeight: cssHeight,\r\n        minWidth: minWidth,\r\n        minHeight: minHeight,\r\n        maxWidth: maxWidth,\r\n        maxHeight: maxHeight,\r\n        minOffsetWidth: minOffsetWidth,\r\n        minOffsetHeight: minOffsetHeight,\r\n        maxOffsetWidth: maxOffsetWidth,\r\n        maxOffsetHeight: maxOffsetHeight,\r\n    };\r\n}\r\nfunction getRotationRad(poses, direction) {\r\n    return getRad(direction > 0 ? poses[0] : poses[1], direction > 0 ? poses[1] : poses[0]);\r\n}\r\nfunction resetClientRect() {\r\n    return {\r\n        left: 0, top: 0,\r\n        width: 0, height: 0,\r\n        right: 0,\r\n        bottom: 0,\r\n        clientLeft: 0, clientTop: 0,\r\n        clientWidth: 0, clientHeight: 0,\r\n        scrollWidth: 0, scrollHeight: 0,\r\n    };\r\n}\r\nfunction getExtendsRect(el, rect) {\r\n    var isRoot = el === getDocumentBody(el) || el === getDocumentElement(el);\r\n    var extendsRect = {\r\n        clientLeft: el.clientLeft,\r\n        clientTop: el.clientTop,\r\n        clientWidth: el.clientWidth,\r\n        clientHeight: el.clientHeight,\r\n        scrollWidth: el.scrollWidth,\r\n        scrollHeight: el.scrollHeight,\r\n        overflow: false,\r\n    };\r\n    if (isRoot) {\r\n        extendsRect.clientHeight = Math.max(rect.height, extendsRect.clientHeight);\r\n        extendsRect.scrollHeight = Math.max(rect.height, extendsRect.scrollHeight);\r\n    }\r\n    extendsRect.overflow = getCachedStyle(el)(\"overflow\") !== \"visible\";\r\n    return __assign(__assign({}, rect), extendsRect);\r\n}\r\nfunction getClientRectByPosition(position, base, el, isExtends) {\r\n    var left = position.left, right = position.right, top = position.top, bottom = position.bottom;\r\n    var baseTop = base.top;\r\n    var baseLeft = base.left;\r\n    var rect = {\r\n        left: baseLeft + left,\r\n        top: baseTop + top,\r\n        right: baseLeft + right,\r\n        bottom: baseTop + bottom,\r\n        width: right - left,\r\n        height: bottom - top,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getClientRect(el, isExtends) {\r\n    var left = 0;\r\n    var top = 0;\r\n    var width = 0;\r\n    var height = 0;\r\n    // let isRoot = false;\r\n    if (el) {\r\n        var clientRect = el.getBoundingClientRect();\r\n        left = clientRect.left;\r\n        top = clientRect.top;\r\n        width = clientRect.width;\r\n        height = clientRect.height;\r\n    }\r\n    var rect = {\r\n        left: left,\r\n        top: top,\r\n        width: width,\r\n        height: height,\r\n        right: left + width,\r\n        bottom: top + height,\r\n    };\r\n    if (el && isExtends) {\r\n        return getExtendsRect(el, rect);\r\n    }\r\n    return rect;\r\n}\r\nfunction getTotalOrigin(moveable) {\r\n    var _a = moveable.props, groupable = _a.groupable, svgOrigin = _a.svgOrigin;\r\n    var _b = moveable.getState(), offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight, svg = _b.svg, transformOrigin = _b.transformOrigin;\r\n    if (!groupable && svg && svgOrigin) {\r\n        return convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight);\r\n    }\r\n    return transformOrigin;\r\n}\r\nfunction getTotalDirection(parentDirection, isPinch, inputEvent, datas) {\r\n    var direction;\r\n    if (parentDirection) {\r\n        direction = parentDirection;\r\n    }\r\n    else if (isPinch) {\r\n        direction = [0, 0];\r\n    }\r\n    else {\r\n        var target = inputEvent.target;\r\n        direction = getDirection(target, datas);\r\n    }\r\n    return direction;\r\n}\r\nfunction getDirection(target, datas) {\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var deg = target.getAttribute(\"data-rotation\") || \"\";\r\n    var direciton = target.getAttribute(\"data-direction\");\r\n    datas.deg = deg;\r\n    if (!direciton) {\r\n        return;\r\n    }\r\n    var dir = [0, 0];\r\n    (direciton.indexOf(\"w\") > -1) && (dir[0] = -1);\r\n    (direciton.indexOf(\"e\") > -1) && (dir[0] = 1);\r\n    (direciton.indexOf(\"n\") > -1) && (dir[1] = -1);\r\n    (direciton.indexOf(\"s\") > -1) && (dir[1] = 1);\r\n    return dir;\r\n}\r\nfunction getAbsolutePoses(poses, dist) {\r\n    return [\r\n        plus(dist, poses[0]),\r\n        plus(dist, poses[1]),\r\n        plus(dist, poses[2]),\r\n        plus(dist, poses[3]),\r\n    ];\r\n}\r\nfunction getAbsolutePosesByState(_a) {\r\n    var left = _a.left, top = _a.top, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n    return getAbsolutePoses([pos1, pos2, pos3, pos4], [left, top]);\r\n}\r\nfunction unsetAbles(self, isControl) {\r\n    self[isControl ? \"controlAbles\" : \"targetAbles\"].forEach(function (able) {\r\n        able.unset && able.unset(self);\r\n    });\r\n}\r\nfunction unsetGesto(self, isControl) {\r\n    var gestoName = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var gesto = self[gestoName];\r\n    if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n        unsetAbles(self, isControl);\r\n    }\r\n    gesto === null || gesto === void 0 ? void 0 : gesto.unset();\r\n    self[gestoName] = null;\r\n}\r\nfunction fillCSSObject(style, resolvedEvent) {\r\n    if (resolvedEvent) {\r\n        var originalDatas = getBeforeRenderableDatas(resolvedEvent);\r\n        originalDatas.nextStyle = __assign(__assign({}, originalDatas.nextStyle), style);\r\n    }\r\n    return {\r\n        style: style,\r\n        cssText: getKeys(style).map(function (name) { return \"\".concat(decamelize(name, \"-\"), \": \").concat(style[name], \";\"); }).join(\"\"),\r\n    };\r\n}\r\nfunction fillAfterTransform(prevEvent, nextEvent, resolvedEvent) {\r\n    var afterTransform = nextEvent.afterTransform || nextEvent.transform;\r\n    return __assign(__assign({}, fillCSSObject(__assign(__assign(__assign({}, prevEvent.style), nextEvent.style), { transform: afterTransform }), resolvedEvent)), { afterTransform: afterTransform, transform: prevEvent.transform });\r\n}\r\nfunction fillParams(moveable, e, params, isBeforeEvent) {\r\n    var datas = e.datas;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    var nextParams = __assign(__assign({}, params), { target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, moveable: moveable, datas: datas.datas, isRequest: e.isRequest, isRequestChild: e.isRequestChild, isFirstDrag: !!e.isFirstDrag, isTrusted: e.isTrusted !== false, stopAble: function () {\r\n            datas.isEventStart = false;\r\n        }, stopDrag: function () {\r\n            var _a;\r\n            (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n        } });\r\n    if (!datas.isStartEvent) {\r\n        datas.isStartEvent = true;\r\n    }\r\n    else if (!isBeforeEvent) {\r\n        datas.lastEvent = nextParams;\r\n    }\r\n    return nextParams;\r\n}\r\nfunction fillEndParams(moveable, e, params) {\r\n    var datas = e.datas;\r\n    var isDrag = \"isDrag\" in params ? params.isDrag : e.isDrag;\r\n    if (!datas.datas) {\r\n        datas.datas = {};\r\n    }\r\n    return __assign(__assign({ isDrag: isDrag }, params), { moveable: moveable, target: moveable.state.target, clientX: e.clientX, clientY: e.clientY, inputEvent: e.inputEvent, currentTarget: moveable, lastEvent: datas.lastEvent, isDouble: e.isDouble, datas: datas.datas, isFirstDrag: !!e.isFirstDrag });\r\n}\r\nfunction catchEvent(moveable, name, callback) {\r\n    moveable._emitter.on(name, callback);\r\n}\r\nfunction triggerEvent(moveable, name, params, isManager, isRequest) {\r\n    return moveable.triggerEvent(name, params, isManager, isRequest);\r\n}\r\nfunction getComputedStyle(el, pseudoElt) {\r\n    return getWindow(el).getComputedStyle(el, pseudoElt);\r\n}\r\nfunction filterAbles(ables, methods, triggerAblesSimultaneously) {\r\n    var enabledAbles = {};\r\n    var ableGroups = {};\r\n    return ables.filter(function (able) {\r\n        var name = able.name;\r\n        if (enabledAbles[name] || !methods.some(function (method) { return able[method]; })) {\r\n            return false;\r\n        }\r\n        if (!triggerAblesSimultaneously && able.ableGroup) {\r\n            if (ableGroups[able.ableGroup]) {\r\n                return false;\r\n            }\r\n            ableGroups[able.ableGroup] = true;\r\n        }\r\n        enabledAbles[name] = true;\r\n        return true;\r\n    });\r\n}\r\nfunction equals(a1, a2) {\r\n    return a1 === a2 || (a1 == null && a2 == null);\r\n}\r\nfunction selectValue() {\r\n    var values = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        values[_i] = arguments[_i];\r\n    }\r\n    var length = values.length - 1;\r\n    for (var i = 0; i < length; ++i) {\r\n        var value = values[i];\r\n        if (!isUndefined(value)) {\r\n            return value;\r\n        }\r\n    }\r\n    return values[length];\r\n}\r\nfunction groupBy(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = [];\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var keyIndex = groupKeys.indexOf(groupKey);\r\n        var group = groups[keyIndex] || [];\r\n        if (keyIndex === -1) {\r\n            groupKeys.push(groupKey);\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction groupByMap(arr, func) {\r\n    var groups = [];\r\n    var groupKeys = {};\r\n    arr.forEach(function (el, index) {\r\n        var groupKey = func(el, index, arr);\r\n        var group = groupKeys[groupKey];\r\n        if (!group) {\r\n            group = [];\r\n            groupKeys[groupKey] = group;\r\n            groups.push(group);\r\n        }\r\n        group.push(el);\r\n    });\r\n    return groups;\r\n}\r\nfunction flat(arr) {\r\n    return arr.reduce(function (prev, cur) {\r\n        return prev.concat(cur);\r\n    }, []);\r\n}\r\nfunction maxOffset() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    args.sort(function (a, b) { return abs(b) - abs(a); });\r\n    return args[0];\r\n}\r\nfunction calculateInversePosition(matrix, pos, n) {\r\n    return calculate(invert(matrix, n), convertPositionMatrix(pos, n), n);\r\n}\r\nfunction convertDragDist(state, e) {\r\n    var _a;\r\n    var is3d = state.is3d, rootMatrix = state.rootMatrix;\r\n    var n = is3d ? 4 : 3;\r\n    _a = __read(calculateInversePosition(rootMatrix, [e.distX, e.distY], n), 2), e.distX = _a[0], e.distY = _a[1];\r\n    return e;\r\n}\r\nfunction calculatePadding(matrix, pos, added, n) {\r\n    if (!added[0] && !added[1]) {\r\n        return pos;\r\n    }\r\n    var xAdded = calculatePosition(matrix, [normalized(added[0] || 1), 0], n);\r\n    var yAdded = calculatePosition(matrix, [0, normalized(added[1] || 1)], n);\r\n    var nextAdded = calculatePosition(matrix, [\r\n        added[0] / getDistSize(xAdded),\r\n        added[1] / getDistSize(yAdded),\r\n    ], n);\r\n    return plus(pos, nextAdded);\r\n}\r\nfunction convertCSSSize(value, size, isRelative) {\r\n    return isRelative ? \"\".concat(value / size * 100, \"%\") : \"\".concat(value, \"px\");\r\n}\r\nfunction getTinyDist(v) {\r\n    return abs(v) <= TINY_NUM ? 0 : v;\r\n}\r\nfunction getDirectionViewClassName(ableName) {\r\n    return function (moveable) {\r\n        if (!moveable.isDragging(ableName)) {\r\n            return \"\";\r\n        }\r\n        var data = getGestoData(moveable, ableName);\r\n        var deg = data.deg;\r\n        if (!deg) {\r\n            return \"\";\r\n        }\r\n        return prefix(\"view-control-rotation\".concat(deg));\r\n    };\r\n}\r\nfunction getDirectionCondition(ableName, checkAbles) {\r\n    if (checkAbles === void 0) { checkAbles = [ableName]; }\r\n    return function (moveable, e) {\r\n        if (e.isRequest) {\r\n            if (checkAbles.some(function (name) { return e.requestAble === name; })) {\r\n                return e.parentDirection;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && (!ableName || hasClass(target, prefix(ableName)));\r\n    };\r\n}\r\nfunction convertTransformInfo(transforms, state, index) {\r\n    var _a;\r\n    var matrixInfos = parse(transforms, {\r\n        \"x%\": function (v) { return v / 100 * state.offsetWidth; },\r\n        \"y%\": function (v) { return v / 100 * state.offsetHeight; },\r\n    });\r\n    var beforeFunctionTexts = transforms.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctionTexts2 = transforms.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunctionText = transforms[index] || \"\";\r\n    var afterFunctionTexts = index < 0 ? [] : transforms.slice(index);\r\n    var afterFunctionTexts2 = index < 0 ? [] : transforms.slice(index + 1);\r\n    var beforeFunctions = matrixInfos.slice(0, index < 0 ? undefined : index);\r\n    var beforeFunctions2 = matrixInfos.slice(0, index < 0 ? undefined : index + 1);\r\n    var targetFunction = (_a = matrixInfos[index]) !== null && _a !== void 0 ? _a : parse([\"\"])[0];\r\n    var afterFunctions = index < 0 ? [] : matrixInfos.slice(index);\r\n    var afterFunctions2 = index < 0 ? [] : matrixInfos.slice(index + 1);\r\n    var targetFunctions = targetFunction ? [targetFunction] : [];\r\n    var beforeFunctionMatrix = toMat(beforeFunctions);\r\n    var beforeFunctionMatrix2 = toMat(beforeFunctions2);\r\n    var afterFunctionMatrix = toMat(afterFunctions);\r\n    var afterFunctionMatrix2 = toMat(afterFunctions2);\r\n    var allFunctionMatrix = multiply(beforeFunctionMatrix, afterFunctionMatrix, 4);\r\n    return {\r\n        transforms: transforms,\r\n        beforeFunctionMatrix: beforeFunctionMatrix,\r\n        beforeFunctionMatrix2: beforeFunctionMatrix2,\r\n        targetFunctionMatrix: toMat(targetFunctions),\r\n        afterFunctionMatrix: afterFunctionMatrix,\r\n        afterFunctionMatrix2: afterFunctionMatrix2,\r\n        allFunctionMatrix: allFunctionMatrix,\r\n        beforeFunctions: beforeFunctions,\r\n        beforeFunctions2: beforeFunctions2,\r\n        targetFunction: targetFunctions[0],\r\n        afterFunctions: afterFunctions,\r\n        afterFunctions2: afterFunctions2,\r\n        beforeFunctionTexts: beforeFunctionTexts,\r\n        beforeFunctionTexts2: beforeFunctionTexts2,\r\n        targetFunctionText: targetFunctionText,\r\n        afterFunctionTexts: afterFunctionTexts,\r\n        afterFunctionTexts2: afterFunctionTexts2,\r\n    };\r\n}\r\nfunction isArrayFormat(arr) {\r\n    if (!arr || !isObject(arr)) {\r\n        return false;\r\n    }\r\n    if (isNode(arr)) {\r\n        return false;\r\n    }\r\n    return isArray(arr) || \"length\" in arr;\r\n}\r\nfunction getRefTarget(target, isSelector) {\r\n    if (!target) {\r\n        return null;\r\n    }\r\n    if (isNode(target)) {\r\n        return target;\r\n    }\r\n    if (isString(target)) {\r\n        if (isSelector) {\r\n            return document.querySelector(target);\r\n        }\r\n        return target;\r\n    }\r\n    if (isFunction(target)) {\r\n        return target();\r\n    }\r\n    if (isWindow(target)) {\r\n        return target;\r\n    }\r\n    if (\"current\" in target) {\r\n        return target.current;\r\n    }\r\n    return target;\r\n}\r\nfunction getRefTargets(targets, isSelector) {\r\n    if (!targets) {\r\n        return [];\r\n    }\r\n    var userTargets = isArrayFormat(targets) ? [].slice.call(targets) : [targets];\r\n    return userTargets.reduce(function (prev, target) {\r\n        if (isString(target) && isSelector) {\r\n            return __spreadArray(__spreadArray([], __read(prev), false), __read([].slice.call(document.querySelectorAll(target))), false);\r\n        }\r\n        if (isArray(target)) {\r\n            prev.push(getRefTargets(target, isSelector));\r\n        }\r\n        else {\r\n            prev.push(getRefTarget(target, isSelector));\r\n        }\r\n        return prev;\r\n    }, []);\r\n}\r\nfunction getAbsoluteRotation(pos1, pos2, direction) {\r\n    var deg = getRad(pos1, pos2) / Math.PI * 180;\r\n    deg = direction >= 0 ? deg : 180 - deg;\r\n    deg = deg >= 0 ? deg : 360 + deg;\r\n    return deg;\r\n}\r\nfunction getDragDistByState(state, dist) {\r\n    var rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n    var n = is3d ? 4 : 3;\r\n    var inverseMatrix = invert(rootMatrix, n);\r\n    if (!is3d) {\r\n        inverseMatrix = convertDimension(inverseMatrix, 3, 4);\r\n    }\r\n    inverseMatrix[12] = 0;\r\n    inverseMatrix[13] = 0;\r\n    inverseMatrix[14] = 0;\r\n    return calculateMatrixDist(inverseMatrix, dist);\r\n}\r\nfunction getSizeDistByDist(startSize, dist, ratio, direction, keepRatio) {\r\n    var _a = __read(startSize, 2), startOffsetWidth = _a[0], startOffsetHeight = _a[1];\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    if (keepRatio && startOffsetWidth && startOffsetHeight) {\r\n        var rad = getRad([0, 0], dist);\r\n        var standardRad = getRad([0, 0], direction);\r\n        var size = getDistSize(dist);\r\n        var signSize = Math.cos(rad - standardRad) * size;\r\n        if (!direction[0]) {\r\n            // top, bottom\r\n            distHeight = signSize;\r\n            distWidth = distHeight * ratio;\r\n        }\r\n        else if (!direction[1]) {\r\n            // left, right\r\n            distWidth = signSize;\r\n            distHeight = distWidth / ratio;\r\n        }\r\n        else {\r\n            // two-way\r\n            var startWidthSize = direction[0] * startOffsetWidth;\r\n            var startHeightSize = direction[1] * startOffsetHeight;\r\n            var secondRad = Math.atan2(startWidthSize + dist[0], startHeightSize + dist[1]);\r\n            var firstRad = Math.atan2(startWidthSize, startHeightSize);\r\n            if (secondRad < 0) {\r\n                secondRad += Math.PI * 2;\r\n            }\r\n            if (firstRad < 0) {\r\n                firstRad += Math.PI * 2;\r\n            }\r\n            var rad_1 = 0;\r\n            if (abs(secondRad - firstRad) < Math.PI / 2 || abs(secondRad - firstRad) > Math.PI / 2 * 3) {\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            else {\r\n                firstRad += Math.PI;\r\n                rad_1 = secondRad - firstRad;\r\n            }\r\n            if (rad_1 > Math.PI * 2) {\r\n                rad_1 -= Math.PI * 2;\r\n            }\r\n            else if (rad_1 > Math.PI) {\r\n                rad_1 = 2 * Math.PI - rad_1;\r\n            }\r\n            else if (rad_1 < -Math.PI) {\r\n                rad_1 = -2 * Math.PI - rad_1;\r\n            }\r\n            //       180\r\n            // -1, -1,  // 1, -1\r\n            // 270            90\r\n            // -1, 1    // 1, 1\r\n            //       0\r\n            var distSize = getDistSize([startWidthSize + dist[0], startHeightSize + dist[1]]) * Math.cos(rad_1);\r\n            distWidth = distSize * Math.sin(firstRad) - startWidthSize;\r\n            distHeight = distSize * Math.cos(firstRad) - startHeightSize;\r\n            if (direction[0] < 0) {\r\n                distWidth *= -1;\r\n            }\r\n            if (direction[1] < 0) {\r\n                distHeight *= -1;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        distWidth = direction[0] * dist[0];\r\n        distHeight = direction[1] * dist[1];\r\n    }\r\n    return [distWidth, distHeight];\r\n}\r\nfunction getOffsetSizeDist(sizeDirection, keepRatio, datas, e) {\r\n    var _a;\r\n    var ratio = datas.ratio, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight;\r\n    var distWidth = 0;\r\n    var distHeight = 0;\r\n    var distX = e.distX, distY = e.distY, pinchScale = e.pinchScale, parentDistance = e.parentDistance, parentDist = e.parentDist, parentScale = e.parentScale;\r\n    var startFixedDirection = datas.fixedDirection;\r\n    var directionsDists = [0, 1].map(function (index) {\r\n        return abs(sizeDirection[index] - startFixedDirection[index]);\r\n    });\r\n    var directionRatios = [0, 1].map(function (index) {\r\n        var dist = directionsDists[index];\r\n        if (dist !== 0) {\r\n            dist = 2 / dist;\r\n        }\r\n        return dist;\r\n    });\r\n    if (parentDist) {\r\n        distWidth = parentDist[0];\r\n        distHeight = parentDist[1];\r\n        if (keepRatio) {\r\n            if (!distWidth) {\r\n                distWidth = distHeight * ratio;\r\n            }\r\n            else if (!distHeight) {\r\n                distHeight = distWidth / ratio;\r\n            }\r\n        }\r\n    }\r\n    else if (isNumber(pinchScale)) {\r\n        distWidth = (pinchScale - 1) * startOffsetWidth;\r\n        distHeight = (pinchScale - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentScale) {\r\n        distWidth = (parentScale[0] - 1) * startOffsetWidth;\r\n        distHeight = (parentScale[1] - 1) * startOffsetHeight;\r\n    }\r\n    else if (parentDistance) {\r\n        var scaleX = startOffsetWidth * directionsDists[0];\r\n        var scaleY = startOffsetHeight * directionsDists[1];\r\n        var ratioDistance = getDistSize([scaleX, scaleY]);\r\n        distWidth = parentDistance / ratioDistance * scaleX * directionRatios[0];\r\n        distHeight = parentDistance / ratioDistance * scaleY * directionRatios[1];\r\n    }\r\n    else {\r\n        var dist_1 = getDragDist({ datas: datas, distX: distX, distY: distY });\r\n        dist_1 = directionRatios.map(function (ratio, i) {\r\n            return dist_1[i] * ratio;\r\n        });\r\n        _a = __read(getSizeDistByDist([startOffsetWidth, startOffsetHeight], dist_1, ratio, sizeDirection, keepRatio), 2), distWidth = _a[0], distHeight = _a[1];\r\n    }\r\n    return {\r\n        // direction,\r\n        // sizeDirection,\r\n        distWidth: distWidth,\r\n        distHeight: distHeight,\r\n    };\r\n}\r\nfunction convertTransformUnit(origin, xy) {\r\n    if (xy) {\r\n        if (origin === \"left\") {\r\n            return { x: \"0%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"top\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"center\") {\r\n            return { x: \"50%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"right\") {\r\n            return { x: \"100%\", y: \"50%\" };\r\n        }\r\n        else if (origin === \"bottom\") {\r\n            return { x: \"50%\", y: \"100%\" };\r\n        }\r\n        var _a = __read(origin.split(\" \"), 2), left = _a[0], right = _a[1];\r\n        var leftOrigin = convertTransformUnit(left || \"\");\r\n        var rightOrigin = convertTransformUnit(right || \"\");\r\n        var originObject = __assign(__assign({}, leftOrigin), rightOrigin);\r\n        var nextOriginObject = {\r\n            x: \"50%\",\r\n            y: \"50%\",\r\n        };\r\n        if (originObject.x) {\r\n            nextOriginObject.x = originObject.x;\r\n        }\r\n        if (originObject.y) {\r\n            nextOriginObject.y = originObject.y;\r\n        }\r\n        if (originObject.value) {\r\n            if (originObject.x && !originObject.y) {\r\n                nextOriginObject.y = originObject.value;\r\n            }\r\n            if (!originObject.x && originObject.y) {\r\n                nextOriginObject.x = originObject.value;\r\n            }\r\n        }\r\n        return nextOriginObject;\r\n    }\r\n    if (origin === \"left\") {\r\n        return { x: \"0%\" };\r\n    }\r\n    if (origin === \"right\") {\r\n        return { x: \"100%\" };\r\n    }\r\n    if (origin === \"top\") {\r\n        return { y: \"0%\" };\r\n    }\r\n    if (origin === \"bottom\") {\r\n        return { y: \"100%\" };\r\n    }\r\n    if (!origin) {\r\n        return {};\r\n    }\r\n    if (origin === \"center\") {\r\n        return { value: \"50%\" };\r\n    }\r\n    return { value: origin };\r\n}\r\nfunction convertTransformOriginArray(transformOrigin, width, height) {\r\n    var _a = convertTransformUnit(transformOrigin, true), x = _a.x, y = _a.y;\r\n    return [\r\n        convertUnitSize(x, width) || 0,\r\n        convertUnitSize(y, height) || 0,\r\n    ];\r\n}\r\nfunction rotatePosesInfo(poses, origin, rad) {\r\n    var prevPoses = poses.map(function (pos) { return minus(pos, origin); });\r\n    var nextPoses = prevPoses.map(function (pos) { return rotate(pos, rad); });\r\n    return {\r\n        prev: prevPoses,\r\n        next: nextPoses,\r\n        result: nextPoses.map(function (pos) { return plus(pos, origin); }),\r\n    };\r\n}\r\nfunction isDeepArrayEquals(arr1, arr2) {\r\n    return arr1.length === arr2.length && arr1.every(function (value1, i) {\r\n        var value2 = arr2[i];\r\n        var isArray1 = isArray(value1);\r\n        var isArray2 = isArray(value2);\r\n        if (isArray1 && isArray2) {\r\n            return isDeepArrayEquals(value1, value2);\r\n        }\r\n        else if (!isArray1 && !isArray2) {\r\n            return value1 === value2;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nfunction watchValue(moveable, property, nextValue, valueKey, defaultValue) {\r\n    var store = moveable._store;\r\n    var prevValue = store[property];\r\n    if (!(property in store)) {\r\n        if (defaultValue != null) {\r\n            store[property] = defaultValue;\r\n            prevValue = defaultValue;\r\n        }\r\n        else {\r\n            store[property] = nextValue;\r\n            return nextValue;\r\n        }\r\n    }\r\n    if (prevValue === nextValue || valueKey(prevValue) === valueKey(nextValue)) {\r\n        return prevValue;\r\n    }\r\n    store[property] = nextValue;\r\n    return nextValue;\r\n}\r\nfunction sign(value) {\r\n    return value >= 0 ? 1 : -1;\r\n}\r\nfunction abs(value) {\r\n    return Math.abs(value);\r\n}\r\nfunction countEach(count, callback) {\r\n    return counter(count).map(function (index) { return callback(index); });\r\n}\r\nfunction getPaddingBox(padding) {\r\n    if (isNumber(padding)) {\r\n        return {\r\n            top: padding,\r\n            left: padding,\r\n            right: padding,\r\n            bottom: padding,\r\n        };\r\n    }\r\n    return {\r\n        left: padding.left || 0,\r\n        top: padding.top || 0,\r\n        right: padding.right || 0,\r\n        bottom: padding.bottom || 0,\r\n    };\r\n}\n\n/**\r\n * @namespace Moveable.Pinchable\r\n * @description Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n */\r\nvar Pinchable = makeAble(\"pinchable\", {\r\n    props: [\r\n        \"pinchable\",\r\n    ],\r\n    events: [\r\n        \"pinchStart\",\r\n        \"pinch\",\r\n        \"pinchEnd\",\r\n        \"pinchGroupStart\",\r\n        \"pinchGroup\",\r\n        \"pinchGroupEnd\",\r\n    ],\r\n    dragStart: function () {\r\n        return true;\r\n    },\r\n    pinchStart: function (moveable, e) {\r\n        var datas = e.datas, targets = e.targets, angle = e.angle, originalDatas = e.originalDatas;\r\n        var _a = moveable.props, pinchable = _a.pinchable, ables = _a.ables;\r\n        if (!pinchable) {\r\n            return false;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"Start\");\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlStart\");\r\n        var pinchAbles = (pinchable === true ? moveable.controlAbles : ables.filter(function (able) {\r\n            return pinchable.indexOf(able.name) > -1;\r\n        })).filter(function (able) { return able.canPinch && able[controlEventName]; });\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var result = triggerEvent(moveable, eventName, params);\r\n        datas.isPinch = result !== false;\r\n        datas.ables = pinchAbles;\r\n        var isPinch = datas.isPinch;\r\n        if (!isPinch) {\r\n            return false;\r\n        }\r\n        pinchAbles.forEach(function (able) {\r\n            originalDatas[able.name] = originalDatas[able.name] || {};\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            var ableEvent = __assign(__assign({}, e), { datas: originalDatas[able.name], parentRotate: angle, isPinch: true });\r\n            able[controlEventName](moveable, ableEvent);\r\n        });\r\n        moveable.state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: [0, 0],\r\n        };\r\n        return isPinch;\r\n    },\r\n    pinch: function (moveable, e) {\r\n        var datas = e.datas, pinchScale = e.scale, distance = e.distance, originalDatas = e.originalDatas, inputEvent = e.inputEvent, targets = e.targets, angle = e.angle;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var parentDistance = distance * (1 - 1 / pinchScale);\r\n        var params = fillParams(moveable, e, {});\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\");\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"Control\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { datas: originalDatas[able.name], inputEvent: inputEvent, resolveMatrix: true, pinchScale: pinchScale, parentDistance: parentDistance, parentRotate: angle, isPinch: true }));\r\n        });\r\n        return params;\r\n    },\r\n    pinchEnd: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, targets = e.targets, originalDatas = e.originalDatas;\r\n        if (!datas.isPinch) {\r\n            return;\r\n        }\r\n        var eventName = \"onPinch\".concat(targets ? \"Group\" : \"\", \"End\");\r\n        var params = fillEndParams(moveable, e, { isDrag: isPinch });\r\n        if (targets) {\r\n            params.targets = targets;\r\n        }\r\n        triggerEvent(moveable, eventName, params);\r\n        var ables = datas.ables;\r\n        var controlEventName = \"drag\".concat(targets ? \"Group\" : \"\", \"ControlEnd\");\r\n        ables.forEach(function (able) {\r\n            if (!able[controlEventName]) {\r\n                return;\r\n            }\r\n            able[controlEventName](moveable, __assign(__assign({}, e), { isDrag: isPinch, datas: originalDatas[able.name], inputEvent: inputEvent, isPinch: true }));\r\n        });\r\n        return isPinch;\r\n    },\r\n    pinchGroupStart: function (moveable, e) {\r\n        return this.pinchStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroup: function (moveable, e) {\r\n        return this.pinch(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    pinchGroupEnd: function (moveable, e) {\r\n        return this.pinchEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n});\r\n/**\r\n * Whether or not target can be pinched with draggable, resizable, scalable, rotatable (default: false)\r\n * @name Moveable.Pinchable#pinchable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.pinchable = true;\r\n */\r\n/**\r\n * When the pinch starts, the pinchStart event is called with part of scaleStart, rotateStart, resizeStart\r\n * @memberof Moveable.Pinchable\r\n * @event pinchStart\r\n * @param {Moveable.Pinchable.OnPinchStart} - Parameters for the pinchStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When pinching, the pinch event is called with part of scale, rotate, resize\r\n * @memberof Moveable.Pinchable\r\n * @event pinch\r\n * @param {Moveable.Pinchable.OnPinch} - Parameters for the pinch event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinch\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotate\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scale\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the pinch finishes, the pinchEnd event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchEnd\r\n * @param {Moveable.Pinchable.OnPinchEnd} - Parameters for the pinchEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     rotatable: true,\r\n *     scalable: true,\r\n *     pinchable: true, // [\"rotatable\", \"scalable\"]\r\n * });\r\n * moveable.on(\"pinchEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"rotateEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n * moveable.on(\"scaleEnd\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When the group pinch starts, the `pinchGroupStart` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupStart\r\n * @param {Moveable.Pinchable.OnPinchGroupStart} - Parameters for the `pinchGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupStart\", ({ targets }) => {\r\n *     console.log(\"onPinchGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch, the `pinchGroup` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroup\r\n * @param {Moveable.Pinchable.OnPinchGroup} - Parameters for the `pinchGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroup\", ({ targets, events }) => {\r\n *     console.log(\"onPinchGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * When the group pinch finishes, the `pinchGroupEnd` event is called.\r\n * @memberof Moveable.Pinchable\r\n * @event pinchGroupEnd\r\n * @param {Moveable.Pinchable.OnPinchGroupEnd} - Parameters for the `pinchGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     pinchable: true\r\n * });\r\n * moveable.on(\"pinchGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onPinchGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nvar directionCondition = getDirectionCondition(\"scalable\");\r\n/**\r\n * @namespace Scalable\r\n * @memberof Moveable\r\n * @description Scalable indicates whether the target's x and y can be scale of transform.\r\n */\r\nvar Scalable = {\r\n    name: \"scalable\",\r\n    ableGroup: \"size\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scalable\",\r\n        \"throttleScale\",\r\n        \"renderDirections\",\r\n        \"keepRatio\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"scaleStart\",\r\n        \"beforeScale\",\r\n        \"scale\",\r\n        \"scaleEnd\",\r\n        \"scaleGroupStart\",\r\n        \"beforeScaleGroup\",\r\n        \"scaleGroup\",\r\n        \"scaleGroupEnd\",\r\n    ],\r\n    render: getRenderDirections(\"scalable\"),\r\n    dragControlCondition: directionCondition,\r\n    viewClassName: getDirectionViewClassName(\"scalable\"),\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, inputEvent = e.inputEvent, parentDirection = e.parentDirection;\r\n        var direction = getTotalDirection(parentDirection, isPinch, inputEvent, datas);\r\n        var _a = moveable.state, width = _a.width, height = _a.height, targetTransform = _a.targetTransform, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos4 = _a.pos4;\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        if (!isPinch) {\r\n            setDragStart(moveable, e);\r\n        }\r\n        datas.datas = {};\r\n        datas.transform = targetTransform;\r\n        datas.prevDist = [1, 1];\r\n        datas.direction = direction;\r\n        datas.startOffsetWidth = width;\r\n        datas.startOffsetHeight = height;\r\n        datas.startValue = [1, 1];\r\n        // const scaleWidth = getDist(pos1, pos2);\r\n        // const scaleHeight = getDist(pos2, pos4);\r\n        var isWidth = (!direction[0] && !direction[1]) || direction[0] || !direction[1];\r\n        // datas.scaleWidth = scaleWidth;\r\n        // datas.scaleHeight = scaleHeight;\r\n        // datas.scaleXRatio = scaleWidth / width;\r\n        // datas.scaleYRatio = scaleHeight / height;\r\n        setDefaultTransformIndex(moveable, e, \"scale\");\r\n        datas.isWidth = isWidth;\r\n        function setRatio(ratio) {\r\n            datas.ratio = ratio && isFinite(ratio) ? ratio : 0;\r\n        }\r\n        datas.startPositions = getAbsolutePosesByState(moveable.state);\r\n        function setFixedDirection(fixedDirection) {\r\n            var result = getFixedDirectionInfo(datas.startPositions, fixedDirection);\r\n            datas.fixedDirection = result.fixedDirection;\r\n            datas.fixedPosition = result.fixedPosition;\r\n            datas.fixedOffset = result.fixedOffset;\r\n        }\r\n        datas.setFixedDirection = setFixedDirection;\r\n        setRatio(getDist$1(pos1, pos2) / getDist$1(pos2, pos4));\r\n        setFixedDirection([-direction[0], -direction[1]]);\r\n        var setMinScaleSize = function (min) {\r\n            datas.minScaleSize = min;\r\n        };\r\n        var setMaxScaleSize = function (max) {\r\n            datas.maxScaleSize = max;\r\n        };\r\n        // const setMinScale = (min: number[]) => {\r\n        // };\r\n        // const setMaxScale = (max: number[]) => {\r\n        // };\r\n        setMinScaleSize([-Infinity, -Infinity]);\r\n        setMaxScaleSize([Infinity, Infinity]);\r\n        var params = fillParams(moveable, e, __assign(__assign({ direction: direction, set: function (scale) {\r\n                datas.startValue = scale;\r\n            }, setRatio: setRatio, setFixedDirection: setFixedDirection, setMinScaleSize: setMinScaleSize, setMaxScaleSize: setMaxScaleSize }, fillTransformStartEvent(moveable, e)), { dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)) }));\r\n        var result = triggerEvent(moveable, \"onScaleStart\", params);\r\n        datas.startFixedDirection = datas.fixedDirection;\r\n        if (result !== false) {\r\n            datas.isScale = true;\r\n            moveable.state.snapRenderInfo = {\r\n                request: e.isRequest,\r\n                direction: direction,\r\n            };\r\n        }\r\n        return datas.isScale ? params : false;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        resolveTransformEvent(moveable, e, \"scale\");\r\n        var datas = e.datas, parentKeepRatio = e.parentKeepRatio, parentFlag = e.parentFlag, isPinch = e.isPinch, dragClient = e.dragClient, isRequest = e.isRequest, useSnap = e.useSnap, resolveMatrix = e.resolveMatrix;\r\n        var prevDist = datas.prevDist, direction = datas.direction, startOffsetWidth = datas.startOffsetWidth, startOffsetHeight = datas.startOffsetHeight, isScale = datas.isScale, startValue = datas.startValue, isWidth = datas.isWidth, ratio = datas.ratio;\r\n        if (!isScale) {\r\n            return false;\r\n        }\r\n        var props = moveable.props;\r\n        var throttleScale = props.throttleScale, parentMoveable = props.parentMoveable;\r\n        var sizeDirection = direction;\r\n        if (!direction[0] && !direction[1]) {\r\n            sizeDirection = [1, 1];\r\n        }\r\n        var keepRatio = (ratio && (parentKeepRatio != null ? parentKeepRatio : props.keepRatio)) || false;\r\n        var state = moveable.state;\r\n        var tempScaleValue = [\r\n            startValue[0],\r\n            startValue[1],\r\n        ];\r\n        function getNextScale() {\r\n            var _a = getOffsetSizeDist(sizeDirection, keepRatio, datas, e), distWidth = _a.distWidth, distHeight = _a.distHeight;\r\n            var distX = startOffsetWidth ? (startOffsetWidth + distWidth) / startOffsetWidth : 1;\r\n            var distY = startOffsetHeight ? (startOffsetHeight + distHeight) / startOffsetHeight : 1;\r\n            if (!startValue[0]) {\r\n                tempScaleValue[0] = distWidth / startOffsetWidth;\r\n            }\r\n            if (!startValue[1]) {\r\n                tempScaleValue[1] = distHeight / startOffsetHeight;\r\n            }\r\n            var scaleX = (sizeDirection[0] || keepRatio ? distX : 1) * tempScaleValue[0];\r\n            var scaleY = (sizeDirection[1] || keepRatio ? distY : 1) * tempScaleValue[1];\r\n            if (scaleX === 0) {\r\n                scaleX = sign(prevDist[0]) * MIN_SCALE;\r\n            }\r\n            if (scaleY === 0) {\r\n                scaleY = sign(prevDist[1]) * MIN_SCALE;\r\n            }\r\n            return [scaleX, scaleY];\r\n        }\r\n        var scale = getNextScale();\r\n        if (!isPinch && moveable.props.groupable) {\r\n            var snapRenderInfo = state.snapRenderInfo || {};\r\n            var stateDirection = snapRenderInfo.direction;\r\n            if (isArray(stateDirection) && (stateDirection[0] || stateDirection[1])) {\r\n                state.snapRenderInfo = { direction: direction, request: e.isRequest };\r\n            }\r\n        }\r\n        triggerEvent(moveable, \"onBeforeScale\", fillParams(moveable, e, {\r\n            scale: scale,\r\n            setFixedDirection: function (nextFixedDirection) {\r\n                datas.setFixedDirection(nextFixedDirection);\r\n                scale = getNextScale();\r\n                return scale;\r\n            },\r\n            startFixedDirection: datas.startFixedDirection,\r\n            setScale: function (nextScale) {\r\n                scale = nextScale;\r\n            },\r\n        }, true));\r\n        var dist = [\r\n            scale[0] / tempScaleValue[0],\r\n            scale[1] / tempScaleValue[1],\r\n        ];\r\n        var fixedPosition = dragClient;\r\n        var snapDist = [0, 0];\r\n        var distSign = sign(dist[0] * dist[1]);\r\n        var isSelfPinch = !dragClient && !parentFlag && isPinch;\r\n        if (isSelfPinch || resolveMatrix) {\r\n            fixedPosition = getTranslateFixedPosition(moveable, datas.targetAllTransform, [0, 0], [0, 0], datas);\r\n        }\r\n        else if (!dragClient) {\r\n            fixedPosition = datas.fixedPosition;\r\n        }\r\n        if (!isPinch) {\r\n            snapDist = checkSnapScale(moveable, dist, direction, !useSnap && isRequest, datas);\r\n        }\r\n        if (keepRatio) {\r\n            if (sizeDirection[0] && sizeDirection[1] && snapDist[0] && snapDist[1]) {\r\n                if (Math.abs(snapDist[0] * startOffsetWidth) > Math.abs(snapDist[1] * startOffsetHeight)) {\r\n                    snapDist[1] = 0;\r\n                }\r\n                else {\r\n                    snapDist[0] = 0;\r\n                }\r\n            }\r\n            var isNoSnap = !snapDist[0] && !snapDist[1];\r\n            if (isNoSnap) {\r\n                // throttle scale value (not absolute scale size)\r\n                if (isWidth) {\r\n                    dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n                }\r\n                else {\r\n                    dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n                }\r\n            }\r\n            if ((sizeDirection[0] && !sizeDirection[1])\r\n                || (snapDist[0] && !snapDist[1])\r\n                || (isNoSnap && isWidth)) {\r\n                dist[0] += snapDist[0];\r\n                var snapHeight = startOffsetWidth * dist[0] * tempScaleValue[0] / ratio;\r\n                dist[1] = sign(distSign * dist[0]) * abs(snapHeight / startOffsetHeight / tempScaleValue[1]);\r\n            }\r\n            else if ((!sizeDirection[0] && sizeDirection[1])\r\n                || (!snapDist[0] && snapDist[1])\r\n                || (isNoSnap && !isWidth)) {\r\n                dist[1] += snapDist[1];\r\n                var snapWidth = startOffsetHeight * dist[1] * tempScaleValue[1] * ratio;\r\n                dist[0] = sign(distSign * dist[1]) * abs(snapWidth / startOffsetWidth / tempScaleValue[0]);\r\n            }\r\n        }\r\n        else {\r\n            dist[0] += snapDist[0];\r\n            dist[1] += snapDist[1];\r\n            if (!snapDist[0]) {\r\n                dist[0] = throttle(dist[0] * tempScaleValue[0], throttleScale) / tempScaleValue[0];\r\n            }\r\n            if (!snapDist[1]) {\r\n                dist[1] = throttle(dist[1] * tempScaleValue[1], throttleScale) / tempScaleValue[1];\r\n            }\r\n        }\r\n        if (dist[0] === 0) {\r\n            dist[0] = sign(prevDist[0]) * MIN_SCALE;\r\n        }\r\n        if (dist[1] === 0) {\r\n            dist[1] = sign(prevDist[1]) * MIN_SCALE;\r\n        }\r\n        scale = multiply2(dist, [tempScaleValue[0], tempScaleValue[1]]);\r\n        var startOffsetSize = [\r\n            startOffsetWidth,\r\n            startOffsetHeight,\r\n        ];\r\n        var scaleSize = [\r\n            startOffsetWidth * scale[0],\r\n            startOffsetHeight * scale[1],\r\n        ];\r\n        scaleSize = calculateBoundSize(scaleSize, datas.minScaleSize, datas.maxScaleSize, keepRatio ? ratio : false);\r\n        // if (keepRatio && (isGroup || keepRatioFinally)) {\r\n        //     if (isWidth) {\r\n        //         boundingHeight = boundingWidth / ratio;\r\n        //     } else {\r\n        //         boundingWidth = boundingHeight * ratio;\r\n        //     }\r\n        // }\r\n        scale = countEach(2, function (i) {\r\n            return startOffsetSize[i] ? scaleSize[i] / startOffsetSize[i] : scaleSize[i];\r\n        });\r\n        dist = countEach(2, function (i) {\r\n            return scale[i] / tempScaleValue[i];\r\n        });\r\n        var delta = countEach(2, function (i) { return prevDist[i] ? dist[i] / prevDist[i] : dist[i]; });\r\n        var distText = \"scale(\".concat(dist.join(\", \"), \")\");\r\n        var scaleText = \"scale(\".concat(scale.join(\", \"), \")\");\r\n        var nextTransform = convertTransformFormat(datas, scaleText, distText);\r\n        var isZeroScale = !startValue[0] || !startValue[1];\r\n        var inverseDist = getScaleDist(moveable, isZeroScale ? scaleText : distText, datas.fixedDirection, fixedPosition, datas.fixedOffset, datas, isZeroScale);\r\n        var inverseDelta = isSelfPinch ? inverseDist : minus(inverseDist, datas.prevInverseDist || [0, 0]);\r\n        datas.prevDist = dist;\r\n        datas.prevInverseDist = inverseDist;\r\n        if (scale[0] === prevDist[0] && scale[1] === prevDist[1]\r\n            && inverseDelta.every(function (num) { return !num; })\r\n            && !parentMoveable\r\n            && !isSelfPinch) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, __assign({ offsetWidth: startOffsetWidth, offsetHeight: startOffsetHeight, direction: direction, scale: scale, dist: dist, delta: delta, isPinch: !!isPinch }, fillTransformEvent(moveable, nextTransform, inverseDelta, isPinch, e)));\r\n        triggerEvent(moveable, \"onScale\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return false;\r\n        }\r\n        datas.isScale = false;\r\n        var scaleEndParam = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onScaleEnd\", scaleEndParam);\r\n        return scaleEndParam;\r\n    },\r\n    dragGroupControlCondition: directionCondition,\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        var originalEvents = fillChildEvents(moveable, \"resizable\", e);\r\n        datas.moveableScale = moveable.scale;\r\n        var events = triggerChildAbles(moveable, this, \"dragControlStart\", e, function (child, ev) {\r\n            return startChildDist(moveable, child, datas, ev);\r\n        });\r\n        var setFixedDirection = function (fixedDirection) {\r\n            params.setFixedDirection(fixedDirection);\r\n            events.forEach(function (ev, i) {\r\n                ev.setFixedDirection(fixedDirection);\r\n                startChildDist(moveable, ev.moveable, datas, originalEvents[i]);\r\n            });\r\n        };\r\n        datas.setFixedDirection = setFixedDirection;\r\n        var nextParams = __assign(__assign({}, params), { targets: moveable.props.targets, events: events, setFixedDirection: setFixedDirection });\r\n        var result = triggerEvent(moveable, \"onScaleGroupStart\", nextParams);\r\n        datas.isScale = result !== false;\r\n        return datas.isScale ? nextParams : false;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        catchEvent(moveable, \"onBeforeScale\", function (parentEvent) {\r\n            triggerEvent(moveable, \"onBeforeScaleGroup\", fillParams(moveable, e, __assign(__assign({}, parentEvent), { targets: moveable.props.targets }), true));\r\n        });\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return;\r\n        }\r\n        var dist = params.dist;\r\n        var moveableScale = datas.moveableScale;\r\n        moveable.scale = [\r\n            dist[0] * moveableScale[0],\r\n            dist[1] * moveableScale[1],\r\n        ];\r\n        var keepRatio = moveable.props.keepRatio;\r\n        var fixedPosition = datas.fixedPosition;\r\n        var events = triggerChildAbles(moveable, this, \"dragControl\", e, function (_, ev) {\r\n            var _a = __read(calculate(createRotateMatrix(moveable.rotation / 180 * Math.PI, 3), [\r\n                ev.datas.originalX * dist[0],\r\n                ev.datas.originalY * dist[1],\r\n                1,\r\n            ], 3), 2), clientX = _a[0], clientY = _a[1];\r\n            return __assign(__assign({}, ev), { parentDist: null, parentScale: dist, parentKeepRatio: keepRatio, \r\n                // recalculate child fixed position for parent group's dragging.\r\n                dragClient: plus(fixedPosition, [clientX, clientY]) });\r\n        });\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events }, params);\r\n        triggerEvent(moveable, \"onScaleGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var isDrag = e.isDrag, datas = e.datas;\r\n        if (!datas.isScale) {\r\n            return;\r\n        }\r\n        this.dragControlEnd(moveable, e);\r\n        var events = triggerChildAbles(moveable, this, \"dragControlEnd\", e);\r\n        var nextParams = fillEndParams(moveable, e, {\r\n            targets: moveable.props.targets,\r\n            events: events,\r\n        });\r\n        triggerEvent(moveable, \"onScaleGroupEnd\", nextParams);\r\n        return isDrag;\r\n    },\r\n    /**\r\n     * @method Moveable.Scalable#request\r\n     * @param {Moveable.Scalable.ScalableRequestParam} e - the Scalable's request parameter\r\n     * @return {Moveable.Requester} Moveable Requester\r\n     * @example\r\n\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"scalable\", { deltaWidth: 10, deltaHeight: 10 }, true);\r\n     *\r\n     * // requestStart\r\n     * const requester = moveable.request(\"scalable\");\r\n     *\r\n     * // request\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     * requester.request({ deltaWidth: 10, deltaHeight: 10 });\r\n     *\r\n     * // requestEnd\r\n     * requester.requestEnd();\r\n     */\r\n    request: function () {\r\n        var datas = {};\r\n        var distWidth = 0;\r\n        var distHeight = 0;\r\n        var useSnap = false;\r\n        return {\r\n            isControl: true,\r\n            requestStart: function (e) {\r\n                useSnap = e.useSnap;\r\n                return {\r\n                    datas: datas,\r\n                    parentDirection: e.direction || [1, 1],\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            request: function (e) {\r\n                distWidth += e.deltaWidth;\r\n                distHeight += e.deltaHeight;\r\n                return {\r\n                    datas: datas,\r\n                    parentDist: [distWidth, distHeight],\r\n                    parentKeepRatio: e.keepRatio,\r\n                    useSnap: useSnap,\r\n                };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true, useSnap: useSnap };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether or not target can scaled.\r\n *\r\n * @name Moveable.Scalable#scalable\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.scalable = true;\r\n */\r\n/**\r\n * throttle of scaleX, scaleY when scale.\r\n * @name Moveable.Scalable#throttleScale\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.throttleScale = 0.1;\r\n */\r\n/**\r\n * Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n * @name Moveable.Scalable#renderDirections\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n *   renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n * });\r\n *\r\n * moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n */\r\n/**\r\n * When resize or scale, keeps a ratio of the width, height. (default: false)\r\n * @name Moveable.Scalable#keepRatio\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     scalable: true,\r\n * });\r\n *\r\n * moveable.keepRatio = true;\r\n */\r\n/**\r\n * When the scale starts, the scaleStart event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleStart\r\n * @param {Moveable.Scalable.OnScaleStart} - Parameters for the scaleStart event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleStart\", ({ target }) => {\r\n *     console.log(target);\r\n * });\r\n */\r\n/**\r\n * When scaling, `beforeScale` is called before `scale` occurs. In `beforeScale`, you can get and set the pre-value before scaling.\r\n * @memberof Moveable.Scalable\r\n * @event beforeScale\r\n * @param {Moveable.Scalable.OnBeforeScale} - Parameters for the `beforeScale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"beforeScale\", ({ setFixedDirection }) => {\r\n *     if (shiftKey) {\r\n *        setFixedDirection([0, 0]);\r\n *     }\r\n * });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When scaling, the `scale` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scale\r\n * @param {Moveable.Scalable.OnScale} - Parameters for the `scale` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scale\", ({ target, transform, dist }) => {\r\n *     target.style.transform = transform;\r\n * });\r\n */\r\n/**\r\n * When the scale finishes, the `scaleEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleEnd\r\n * @param {Moveable.Scalable.OnScaleEnd} - Parameters for the `scaleEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { scalable: true });\r\n * moveable.on(\"scaleEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\r\n/**\r\n* When the group scale starts, the `scaleGroupStart` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroupStart\r\n* @param {Moveable.Scalable.OnScaleGroupStart} - Parameters for the `scaleGroupStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroupStart\", ({ targets }) => {\r\n*     console.log(\"onScaleGroupStart\", targets);\r\n* });\r\n*/\r\n/**\r\n* When the group scale, the `scaleGroup` event is called.\r\n* @memberof Moveable.Scalable\r\n* @event scaleGroup\r\n* @param {Moveable.Scalable.OnScaleGroup} - Parameters for the `scaleGroup` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n*     scalable: true\r\n* });\r\n* moveable.on(\"scaleGroup\", ({ targets, events }) => {\r\n*     console.log(\"onScaleGroup\", targets);\r\n*     events.forEach(ev => {\r\n*         const target = ev.target;\r\n*         // ev.drag is a drag event that occurs when the group scale.\r\n*         const left = ev.drag.beforeDist[0];\r\n*         const top = ev.drag.beforeDist[1];\r\n*         const scaleX = ev.scale[0];\r\n*         const scaleY = ev.scale[1];\r\n*     });\r\n* });\r\n*/\r\n/**\r\n * When the group scale finishes, the `scaleGroupEnd` event is called.\r\n * @memberof Moveable.Scalable\r\n * @event scaleGroupEnd\r\n * @param {Moveable.Scalable.OnScaleGroupEnd} - Parameters for the `scaleGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n *     scalable: true\r\n * });\r\n * moveable.on(\"scaleGroupEnd\", ({ targets, isDrag }) => {\r\n *     console.log(\"onScaleGroupEnd\", targets, isDrag);\r\n * });\r\n */\n\nfunction getMiddleLinePos(pos1, pos2) {\r\n    return pos1.map(function (pos, i) { return dot(pos, pos2[i], 1, 2); });\r\n}\r\nfunction getTriangleRad(pos1, pos2, pos3) {\r\n    // pos1 Rad\r\n    var rad1 = getRad(pos1, pos2);\r\n    var rad2 = getRad(pos1, pos3);\r\n    var rad = rad2 - rad1;\r\n    return rad >= 0 ? rad : rad + 2 * Math.PI;\r\n}\r\nfunction isValidPos(poses1, poses2) {\r\n    var rad1 = getTriangleRad(poses1[0], poses1[1], poses1[2]);\r\n    var rad2 = getTriangleRad(poses2[0], poses2[1], poses2[2]);\r\n    var pi = Math.PI;\r\n    if ((rad1 >= pi && rad2 <= pi) || (rad1 <= pi && rad2 >= pi)) {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\n/**\r\n * @namespace Moveable.Warpable\r\n * @description Warpable indicates whether the target can be warped(distorted, bented).\r\n */\r\nvar Warpable = {\r\n    name: \"warpable\",\r\n    ableGroup: \"size\",\r\n    props: [\r\n        \"warpable\",\r\n        \"renderDirections\",\r\n        \"edge\",\r\n        \"displayAroundControls\",\r\n    ],\r\n    events: [\r\n        \"warpStart\",\r\n        \"warp\",\r\n        \"warpEnd\",\r\n    ],\r\n    viewClassName: getDirectionViewClassName(\"warpable\"),\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, resizable = _a.resizable, scalable = _a.scalable, warpable = _a.warpable, zoom = _a.zoom;\r\n        if (resizable || scalable || !warpable) {\r\n            return [];\r\n        }\r\n        var _b = moveable.state, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var linePosFrom1 = getMiddleLinePos(pos1, pos2);\r\n        var linePosFrom2 = getMiddleLinePos(pos2, pos1);\r\n        var linePosFrom3 = getMiddleLinePos(pos1, pos3);\r\n        var linePosFrom4 = getMiddleLinePos(pos3, pos1);\r\n        var linePosTo1 = getMiddleLinePos(pos3, pos4);\r\n        var linePosTo2 = getMiddleLinePos(pos4, pos3);\r\n        var linePosTo3 = getMiddleLinePos(pos2, pos4);\r\n        var linePosTo4 = getMiddleLinePos(pos4, pos2);\r\n        return __spreadArray([\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine1\", style: getLineStyle(linePosFrom1, linePosTo1, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine2\", style: getLineStyle(linePosFrom2, linePosTo2, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine3\", style: getLineStyle(linePosFrom3, linePosTo3, zoom) }),\r\n            React.createElement(\"div\", { className: prefix(\"line\"), key: \"middeLine4\", style: getLineStyle(linePosFrom4, linePosTo4, zoom) })\r\n        ], __read(renderAllDirections(moveable, \"warpable\", React)), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (e.isRequest) {\r\n            return false;\r\n        }\r\n        var target = e.inputEvent.target;\r\n        return hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"warpable\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas, inputEvent = e.inputEvent;\r\n        var target = moveable.props.target;\r\n        var inputTarget = inputEvent.target;\r\n        var direction = getDirection(inputTarget, datas);\r\n        if (!direction || !target) {\r\n            return false;\r\n        }\r\n        var state = moveable.state;\r\n        var transformOrigin = state.transformOrigin, is3d = state.is3d, targetTransform = state.targetTransform, targetMatrix = state.targetMatrix, width = state.width, height = state.height, left = state.left, top = state.top;\r\n        datas.datas = {};\r\n        datas.targetTransform = targetTransform;\r\n        datas.warpTargetMatrix = is3d ? targetMatrix : convertDimension(targetMatrix, 3, 4);\r\n        datas.targetInverseMatrix = ignoreDimension(invert(datas.warpTargetMatrix, 4), 3, 4);\r\n        datas.direction = direction;\r\n        datas.left = left;\r\n        datas.top = top;\r\n        datas.poses = [\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ].map(function (p) { return minus(p, transformOrigin); });\r\n        datas.nextPoses = datas.poses.map(function (_a) {\r\n            var _b = __read(_a, 2), x = _b[0], y = _b[1];\r\n            return calculate(datas.warpTargetMatrix, [x, y, 0, 1], 4);\r\n        });\r\n        datas.startValue = createIdentityMatrix(4);\r\n        datas.prevMatrix = createIdentityMatrix(4);\r\n        datas.absolutePoses = getAbsolutePosesByState(state);\r\n        datas.posIndexes = getPosIndexesByDirection(direction);\r\n        setDragStart(moveable, e);\r\n        setDefaultTransformIndex(moveable, e, \"matrix3d\");\r\n        state.snapRenderInfo = {\r\n            request: e.isRequest,\r\n            direction: direction,\r\n        };\r\n        var params = fillParams(moveable, e, __assign({ set: function (matrix) {\r\n                datas.startValue = matrix;\r\n            } }, fillTransformStartEvent(moveable, e)));\r\n        var result = triggerEvent(moveable, \"onWarpStart\", params);\r\n        if (result !== false) {\r\n            datas.isWarp = true;\r\n        }\r\n        return datas.isWarp;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isRequest = e.isRequest;\r\n        var distX = e.distX, distY = e.distY;\r\n        var targetInverseMatrix = datas.targetInverseMatrix, prevMatrix = datas.prevMatrix, isWarp = datas.isWarp, startValue = datas.startValue, poses = datas.poses, posIndexes = datas.posIndexes, absolutePoses = datas.absolutePoses;\r\n        if (!isWarp) {\r\n            return false;\r\n        }\r\n        resolveTransformEvent(moveable, e, \"matrix3d\");\r\n        if (hasGuidelines(moveable, \"warpable\")) {\r\n            var selectedPoses = posIndexes.map(function (index) { return absolutePoses[index]; });\r\n            if (selectedPoses.length > 1) {\r\n                selectedPoses.push([\r\n                    (selectedPoses[0][0] + selectedPoses[1][0]) / 2,\r\n                    (selectedPoses[0][1] + selectedPoses[1][1]) / 2,\r\n                ]);\r\n            }\r\n            var _a = checkMoveableSnapBounds(moveable, isRequest, {\r\n                horizontal: selectedPoses.map(function (pos) { return pos[1] + distY; }),\r\n                vertical: selectedPoses.map(function (pos) { return pos[0] + distX; }),\r\n            }), horizontalSnapInfo = _a.horizontal, verticalSnapInfo = _a.vertical;\r\n            distY -= horizontalSnapInfo.offset;\r\n            distX -= verticalSnapInfo.offset;\r\n        }\r\n        var dist = getDragDist({ datas: datas, distX: distX, distY: distY }, true);\r\n        var nextPoses = datas.nextPoses.slice();\r\n        posIndexes.forEach(function (index) {\r\n            nextPoses[index] = plus(nextPoses[index], dist);\r\n        });\r\n        if (!NEARBY_POS.every(function (nearByPoses) { return isValidPos(nearByPoses.map(function (i) { return poses[i]; }), nearByPoses.map(function (i) { return nextPoses[i]; })); })) {\r\n            return false;\r\n        }\r\n        var h = createWarpMatrix(poses[0], poses[2], poses[1], poses[3], nextPoses[0], nextPoses[2], nextPoses[1], nextPoses[3]);\r\n        if (!h.length) {\r\n            return false;\r\n        }\r\n        // B * A * M\r\n        var afterMatrix = multiply(targetInverseMatrix, h, 4);\r\n        // B * M * A\r\n        var matrix = getTransfromMatrix(datas, afterMatrix, true);\r\n        var delta = multiply(invert(prevMatrix, 4), matrix, 4);\r\n        datas.prevMatrix = matrix;\r\n        var totalMatrix = multiply(startValue, matrix, 4);\r\n        var nextTransform = convertTransformFormat(datas, \"matrix3d(\".concat(totalMatrix.join(\", \"), \")\"), \"matrix3d(\".concat(matrix.join(\", \"), \")\"));\r\n        fillOriginalTransform(e, nextTransform);\r\n        triggerEvent(moveable, \"onWarp\", fillParams(moveable, e, __assign({ delta: delta, matrix: totalMatrix, dist: matrix, multiply: multiply, transform: nextTransform }, fillCSSObject({\r\n            transform: nextTransform,\r\n        }, e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas, isDrag = e.isDrag;\r\n        if (!datas.isWarp) {\r\n            return false;\r\n        }\r\n        datas.isWarp = false;\r\n        triggerEvent(moveable, \"onWarpEnd\", fillEndParams(moveable, e, {}));\r\n        return isDrag;\r\n    },\r\n};\r\n/**\r\n * Whether or not target can be warped. (default: false)\r\n * @name Moveable.Warpable#warpable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.warpable = true;\r\n */\r\n/**\r\n* Set directions to show the control box. (default: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"])\r\n* @name Moveable.Warpable#renderDirections\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     warpable: true,\r\n*     renderDirections: [\"n\", \"nw\", \"ne\", \"s\", \"se\", \"sw\", \"e\", \"w\"],\r\n* });\r\n*\r\n* moveable.renderDirections = [\"nw\", \"ne\", \"sw\", \"se\"];\r\n*/\r\n/**\r\n* When the warp starts, the warpStart event is called.\r\n* @memberof Moveable.Warpable\r\n* @event warpStart\r\n* @param {Moveable.Warpable.OnWarpStart} - Parameters for the warpStart event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, { warpable: true });\r\n* moveable.on(\"warpStart\", ({ target }) => {\r\n*     console.log(target);\r\n* });\r\n*/\r\n/**\r\n * When warping, the warp event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warp\r\n * @param {Moveable.Warpable.OnWarp} - Parameters for the warp event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n * let matrix = [\r\n *  1, 0, 0, 0,\r\n *  0, 1, 0, 0,\r\n *  0, 0, 1, 0,\r\n *  0, 0, 0, 1,\r\n * ];\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warp\", ({ target, transform, delta, multiply }) => {\r\n *    // target.style.transform = transform;\r\n *    matrix = multiply(matrix, delta);\r\n *    target.style.transform = `matrix3d(${matrix.join(\",\")})`;\r\n * });\r\n */\r\n/**\r\n * When the warp finishes, the warpEnd event is called.\r\n * @memberof Moveable.Warpable\r\n * @event warpEnd\r\n * @param {Moveable.Warpable.OnWarpEnd} - Parameters for the warpEnd event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, { warpable: true });\r\n * moveable.on(\"warpEnd\", ({ target, isDrag }) => {\r\n *     console.log(target, isDrag);\r\n * });\r\n */\n\nvar AREA_PIECES = /*#__PURE__*/ prefix(\"area-pieces\");\r\nvar AREA_PIECE = /*#__PURE__*/ prefix(\"area-piece\");\r\nvar AVOID = /*#__PURE__*/ prefix(\"avoid\");\r\nvar VIEW_DRAGGING = prefix(\"view-dragging\");\n\nfunction restoreStyle(moveable) {\r\n    var el = moveable.areaElement;\r\n    if (!el) {\r\n        return;\r\n    }\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    removeClass(el, AVOID);\r\n    el.style.cssText += \"left: 0px; top: 0px; width: \".concat(width, \"px; height: \").concat(height, \"px\");\r\n}\r\nfunction renderPieces(React) {\r\n    return (React.createElement(\"div\", { key: \"area_pieces\", className: AREA_PIECES },\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE }),\r\n        React.createElement(\"div\", { className: AREA_PIECE })));\r\n}\r\nvar DragArea = {\r\n    name: \"dragArea\",\r\n    props: [\r\n        \"dragArea\",\r\n        \"passDragArea\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, target = _a.target, dragArea = _a.dragArea, groupable = _a.groupable, passDragArea = _a.passDragArea;\r\n        var _b = moveable.getState(), width = _b.width, height = _b.height, renderPoses = _b.renderPoses;\r\n        var className = passDragArea ? prefix(\"area\", \"pass\") : prefix(\"area\");\r\n        if (groupable) {\r\n            return [\r\n                React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className }),\r\n                renderPieces(React),\r\n            ];\r\n        }\r\n        if (!target || !dragArea) {\r\n            return [];\r\n        }\r\n        var h = createWarpMatrix([0, 0], [width, 0], [0, height], [width, height], renderPoses[0], renderPoses[1], renderPoses[2], renderPoses[3]);\r\n        var transform = h.length ? makeMatrixCSS(h, true) : \"none\";\r\n        return [\r\n            React.createElement(\"div\", { key: \"area\", ref: ref(moveable, \"areaElement\"), className: className, style: {\r\n                    top: \"0px\",\r\n                    left: \"0px\",\r\n                    width: \"\".concat(width, \"px\"),\r\n                    height: \"\".concat(height, \"px\"),\r\n                    transformOrigin: \"0 0\",\r\n                    transform: transform,\r\n                } }),\r\n            renderPieces(React),\r\n        ];\r\n    },\r\n    dragStart: function (moveable, _a) {\r\n        var datas = _a.datas, clientX = _a.clientX, clientY = _a.clientY, inputEvent = _a.inputEvent;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        datas.isDragArea = false;\r\n        var areaElement = moveable.areaElement;\r\n        var state = moveable.state;\r\n        var moveableClientRect = state.moveableClientRect, renderPoses = state.renderPoses, rootMatrix = state.rootMatrix, is3d = state.is3d;\r\n        var left = moveableClientRect.left, top = moveableClientRect.top;\r\n        var _b = getRect(renderPoses), relativeLeft = _b.left, relativeTop = _b.top, width = _b.width, height = _b.height;\r\n        var n = is3d ? 4 : 3;\r\n        var _c = __read(calculateInversePosition(rootMatrix, [clientX - left, clientY - top], n), 2), posX = _c[0], posY = _c[1];\r\n        posX -= relativeLeft;\r\n        posY -= relativeTop;\r\n        var rects = [\r\n            { left: relativeLeft, top: relativeTop, width: width, height: posY - 10 },\r\n            { left: relativeLeft, top: relativeTop, width: posX - 10, height: height },\r\n            { left: relativeLeft, top: relativeTop + posY + 10, width: width, height: height - posY - 10 },\r\n            { left: relativeLeft + posX + 10, top: relativeTop, width: width - posX - 10, height: height },\r\n        ];\r\n        var children = [].slice.call(areaElement.nextElementSibling.children);\r\n        rects.forEach(function (rect, i) {\r\n            children[i].style.cssText\r\n                = \"left: \".concat(rect.left, \"px;top: \").concat(rect.top, \"px; width: \").concat(rect.width, \"px; height: \").concat(rect.height, \"px;\");\r\n        });\r\n        addClass(areaElement, AVOID);\r\n        state.disableNativeEvent = true;\r\n        return;\r\n    },\r\n    drag: function (moveable, _a) {\r\n        var datas = _a.datas, inputEvent = _a.inputEvent;\r\n        this.enableNativeEvent(moveable);\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            datas.isDragArea = true;\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        this.enableNativeEvent(moveable);\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        if (!inputEvent) {\r\n            return false;\r\n        }\r\n        if (!datas.isDragArea) {\r\n            restoreStyle(moveable);\r\n        }\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    unset: function (moveable) {\r\n        restoreStyle(moveable);\r\n        moveable.state.disableNativeEvent = false;\r\n    },\r\n    enableNativeEvent: function (moveable) {\r\n        var state = moveable.state;\r\n        if (state.disableNativeEvent) {\r\n            requestAnimationFrame(function () {\r\n                state.disableNativeEvent = false;\r\n            });\r\n        }\r\n    },\r\n};\r\n/**\r\n * Add an event to the moveable area instead of the target for stopPropagation. (default: false, true in group)\r\n * @name Moveable#dragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\r\n/**\r\n * Set `pointerEvents: none;` css to pass events in dragArea. (default: false)\r\n * @name Moveable#passDragArea\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  dragArea: false,\r\n * });\r\n */\n\nvar Origin = makeAble(\"origin\", {\r\n    props: [\"origin\", \"svgOrigin\"],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, zoom = _a.zoom, svgOrigin = _a.svgOrigin, groupable = _a.groupable;\r\n        var _b = moveable.getState(), beforeOrigin = _b.beforeOrigin, rotation = _b.rotation, svg = _b.svg, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\r\n        var originStyle;\r\n        if (!groupable && svg && svgOrigin) {\r\n            var _c = __read(convertTransformOriginArray(svgOrigin, offsetWidth, offsetHeight), 2), originX = _c[0], originY = _c[1];\r\n            var n = is3d ? 4 : 3;\r\n            var result = calculatePosition(allMatrix, [originX, originY], n);\r\n            originStyle = getControlTransform(rotation, zoom, minus(result, [left, top]));\r\n        }\r\n        else {\r\n            originStyle = getControlTransform(rotation, zoom, beforeOrigin);\r\n        }\r\n        return [\r\n            React.createElement(\"div\", { className: prefix(\"control\", \"origin\"), style: originStyle, key: \"beforeOrigin\" }),\r\n        ];\r\n    },\r\n});\r\n/**\r\n * Whether or not the origin controlbox will be visible or not (default: true)\r\n * @name Moveable#origin\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n *\r\n * moveable.origin = true;\r\n */\n\nfunction getDefaultScrollPosition(e) {\r\n    var scrollContainer = e.scrollContainer;\r\n    return [\r\n        scrollContainer.scrollLeft,\r\n        scrollContainer.scrollTop,\r\n    ];\r\n}\r\n/**\r\n * @namespace Moveable.Scrollable\r\n * @description Whether or not target can be scrolled to the scroll container (default: false)\r\n */\r\nvar Scrollable = {\r\n    name: \"scrollable\",\r\n    canPinch: true,\r\n    props: [\r\n        \"scrollable\",\r\n        \"scrollContainer\",\r\n        \"scrollThreshold\",\r\n        \"scrollThrottleTime\",\r\n        \"getScrollPosition\",\r\n        \"scrollOptions\",\r\n    ],\r\n    events: [\r\n        \"scroll\",\r\n        \"scrollGroup\",\r\n    ],\r\n    dragRelation: \"strong\",\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.scrollContainer, scrollContainer = _a === void 0 ? moveable.getContainer() : _a, scrollOptions = props.scrollOptions;\r\n        var dragScroll = new DragScroll();\r\n        var scrollContainerElement = getRefTarget(scrollContainer, true);\r\n        e.datas.dragScroll = dragScroll;\r\n        moveable.state.dragScroll = dragScroll;\r\n        var gestoName = e.isControl ? \"controlGesto\" : \"targetGesto\";\r\n        var targets = e.targets;\r\n        dragScroll.on(\"scroll\", function (_a) {\r\n            var container = _a.container, direction = _a.direction;\r\n            var params = fillParams(moveable, e, {\r\n                scrollContainer: container,\r\n                direction: direction,\r\n            });\r\n            var eventName = targets ? \"onScrollGroup\" : \"onScroll\";\r\n            if (targets) {\r\n                params.targets = targets;\r\n            }\r\n            triggerEvent(moveable, eventName, params);\r\n        }).on(\"move\", function (_a) {\r\n            var offsetX = _a.offsetX, offsetY = _a.offsetY, inputEvent = _a.inputEvent;\r\n            moveable[gestoName].scrollBy(offsetX, offsetY, inputEvent.inputEvent, false);\r\n        }).on(\"scrollDrag\", function (_a) {\r\n            var next = _a.next;\r\n            next(moveable[gestoName].getCurrentEvent());\r\n        });\r\n        dragScroll.dragStart(e, __assign({ container: scrollContainerElement }, scrollOptions));\r\n    },\r\n    checkScroll: function (moveable, e) {\r\n        var dragScroll = e.datas.dragScroll;\r\n        if (!dragScroll) {\r\n            return;\r\n        }\r\n        var _a = moveable.props, _b = _a.scrollContainer, scrollContainer = _b === void 0 ? moveable.getContainer() : _b, _c = _a.scrollThreshold, scrollThreshold = _c === void 0 ? 0 : _c, _d = _a.scrollThrottleTime, scrollThrottleTime = _d === void 0 ? 0 : _d, _e = _a.getScrollPosition, getScrollPosition = _e === void 0 ? getDefaultScrollPosition : _e, scrollOptions = _a.scrollOptions;\r\n        dragScroll.drag(e, __assign({ container: scrollContainer, threshold: scrollThreshold, throttleTime: scrollThrottleTime, getScrollPosition: function (ev) {\r\n                return getScrollPosition({ scrollContainer: ev.container, direction: ev.direction });\r\n            } }, scrollOptions));\r\n        return true;\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.checkScroll(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        e.datas.dragScroll.dragEnd();\r\n        e.datas.dragScroll = null;\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { isControl: true }));\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, __assign(__assign({}, e), { targets: moveable.props.targets, isControl: true }));\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.drag(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    dragGroupControEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, __assign(__assign({}, e), { targets: moveable.props.targets }));\r\n    },\r\n    unset: function (moveable) {\r\n        var _a;\r\n        var state = moveable.state;\r\n        (_a = state.dragScroll) === null || _a === void 0 ? void 0 : _a.dragEnd();\r\n        state.dragScroll = null;\r\n    },\r\n};\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scroll` event occur to scroll.\r\n * @memberof Moveable.Scrollable\r\n * @event scroll\r\n * @param {Moveable.Scrollable.OnScroll} - Parameters for the `scroll` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\r\n/**\r\n * When the drag cursor leaves the scrollContainer, the `scrollGroup` event occur to scroll in group.\r\n * @memberof Moveable.Scrollable\r\n * @event scrollGroup\r\n * @param {Moveable.Scrollable.OnScrollGroup} - Parameters for the `scrollGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"scroll\", ({ scrollContainer, direction }) => {\r\n *   scrollContainer.scrollLeft += direction[0] * 10;\r\n *   scrollContainer.scrollTop += direction[1] * 10;\r\n * });\r\n */\n\nvar Default = {\r\n    name: \"\",\r\n    props: [\r\n        \"target\",\r\n        \"dragTargetSelf\",\r\n        \"dragTarget\",\r\n        \"dragContainer\",\r\n        \"container\",\r\n        \"warpSelf\",\r\n        \"rootContainer\",\r\n        \"useResizeObserver\",\r\n        \"useMutationObserver\",\r\n        \"zoom\",\r\n        \"dragFocusedInput\",\r\n        \"transformOrigin\",\r\n        \"ables\",\r\n        \"className\",\r\n        \"pinchThreshold\",\r\n        \"pinchOutside\",\r\n        \"triggerAblesSimultaneously\",\r\n        \"checkInput\",\r\n        \"cspNonce\",\r\n        \"translateZ\",\r\n        \"hideDefaultLines\",\r\n        \"props\",\r\n        \"flushSync\",\r\n        \"stopPropagation\",\r\n        \"preventClickEventOnDrag\",\r\n        \"preventClickDefault\",\r\n        \"viewContainer\",\r\n        \"persistData\",\r\n        \"useAccuratePosition\",\r\n        \"firstRenderState\",\r\n        \"linePadding\",\r\n        \"controlPadding\",\r\n        \"preventDefault\",\r\n        \"preventRightClick\",\r\n        \"preventWheelClick\",\r\n        \"requestStyles\",\r\n    ],\r\n    events: [\r\n        \"changeTargets\",\r\n    ],\r\n};\n\nvar Padding = makeAble(\"padding\", {\r\n    props: [\"padding\"],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        if (props.dragArea) {\r\n            return [];\r\n        }\r\n        var _a = getPaddingBox(props.padding || {}), left = _a.left, top = _a.top, right = _a.right, bottom = _a.bottom;\r\n        var _b = moveable.getState(), renderPoses = _b.renderPoses, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4;\r\n        var poses = [pos1, pos2, pos3, pos4];\r\n        var paddingDirections = [];\r\n        if (left > 0) {\r\n            paddingDirections.push([0, 2]);\r\n        }\r\n        if (top > 0) {\r\n            paddingDirections.push([0, 1]);\r\n        }\r\n        if (right > 0) {\r\n            paddingDirections.push([1, 3]);\r\n        }\r\n        if (bottom > 0) {\r\n            paddingDirections.push([2, 3]);\r\n        }\r\n        return paddingDirections.map(function (_a, i) {\r\n            var _b = __read(_a, 2), dir1 = _b[0], dir2 = _b[1];\r\n            var paddingPos1 = poses[dir1];\r\n            var paddingPos2 = poses[dir2];\r\n            var paddingPos3 = renderPoses[dir1];\r\n            var paddingPos4 = renderPoses[dir2];\r\n            var h = createWarpMatrix([0, 0], [100, 0], [0, 100], [100, 100], paddingPos1, paddingPos2, paddingPos3, paddingPos4);\r\n            if (!h.length) {\r\n                return undefined;\r\n            }\r\n            return (React.createElement(\"div\", { key: \"padding\".concat(i), className: prefix(\"padding\"), style: {\r\n                    transform: makeMatrixCSS(h, true),\r\n                } }));\r\n        });\r\n    },\r\n});\r\n/**\r\n * Add padding around the target to increase the drag area.\r\n * @name Moveable#padding\r\n * @default null\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  target: document.querySelector(\".target\"),\r\n *  padding: { left: 0, top: 0, right: 0, bottom: 0 },\r\n * });\r\n * moveable.padding = { left: 10, top: 10, right: 10, bottom: 10 },\r\n * moveable.updateRect();\r\n */\n\nvar RADIUS_DIRECTIONS = [\"nw\", \"ne\", \"se\", \"sw\"];\r\nfunction calculateRatio(values, size) {\r\n    var sumSize = values[0] + values[1];\r\n    var sumRatio = sumSize > size ? size / sumSize : 1;\r\n    values[0] *= sumRatio;\r\n    values[1] = size - values[1] * sumRatio;\r\n    return values;\r\n}\r\nvar HORIZONTAL_RADIUS_ORDER = [1, 2, 5, 6];\r\nvar VERTICAL_RADIUS_ORDER = [0, 3, 4, 7];\r\nvar HORIZONTAL_RADIUS_DIRECTIONS = [1, -1, -1, 1];\r\nvar VERTICAL_RADIUS_DIRECTIONS = [1, 1, -1, -1];\r\nfunction getRadiusStyles(nextPoses, isRelative, width, height, left, top, right, bottom) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    if (right === void 0) { right = width; }\r\n    if (bottom === void 0) { bottom = height; }\r\n    var clipStyles = [];\r\n    var isVertical = false;\r\n    var radiusPoses = nextPoses.filter(function (pos) { return !pos.virtual; });\r\n    var raws = radiusPoses.map(function (posInfo) {\r\n        var horizontal = posInfo.horizontal, vertical = posInfo.vertical, pos = posInfo.pos;\r\n        if (vertical && !isVertical) {\r\n            isVertical = true;\r\n            clipStyles.push(\"/\");\r\n        }\r\n        if (isVertical) {\r\n            var rawPos = Math.max(0, vertical === 1 ? pos[1] - top : bottom - pos[1]);\r\n            clipStyles.push(convertCSSSize(rawPos, height, isRelative));\r\n            return rawPos;\r\n        }\r\n        else {\r\n            var rawPos = Math.max(0, horizontal === 1 ? pos[0] - left : right - pos[0]);\r\n            clipStyles.push(convertCSSSize(rawPos, width, isRelative));\r\n            return rawPos;\r\n        }\r\n    });\r\n    return {\r\n        radiusPoses: radiusPoses,\r\n        styles: clipStyles,\r\n        raws: raws,\r\n    };\r\n}\r\nfunction getRadiusRange(controlPoses) {\r\n    // [start, length]\r\n    var horizontalRange = [0, 0];\r\n    var verticalRange = [0, 0];\r\n    var length = controlPoses.length;\r\n    for (var i = 0; i < length; ++i) {\r\n        var clipPose = controlPoses[i];\r\n        if (!clipPose.sub) {\r\n            continue;\r\n        }\r\n        if (clipPose.horizontal) {\r\n            if (horizontalRange[1] === 0) {\r\n                horizontalRange[0] = i;\r\n            }\r\n            horizontalRange[1] = i - horizontalRange[0] + 1;\r\n            verticalRange[0] = i + 1;\r\n        }\r\n        if (clipPose.vertical) {\r\n            if (verticalRange[1] === 0) {\r\n                verticalRange[0] = i;\r\n            }\r\n            verticalRange[1] = i - verticalRange[0] + 1;\r\n        }\r\n    }\r\n    return {\r\n        horizontalRange: horizontalRange,\r\n        verticalRange: verticalRange,\r\n    };\r\n}\r\nfunction getRadiusValues(values, width, height, left, top, minCounts, full) {\r\n    var _a, _b, _c, _d;\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    if (full === void 0) { full = false; }\r\n    var splitIndex = values.indexOf(\"/\");\r\n    var splitLength = (splitIndex > -1 ? values.slice(0, splitIndex) : values).length;\r\n    var horizontalValues = values.slice(0, splitLength);\r\n    var verticalValues = values.slice(splitLength + 1);\r\n    var horizontalValuesLength = horizontalValues.length;\r\n    var verticalValuesLength = verticalValues.length;\r\n    var hasVerticalValues = verticalValuesLength > 0;\r\n    var _e = __read(horizontalValues, 4), _f = _e[0], nwValue = _f === void 0 ? \"0px\" : _f, _g = _e[1], neValue = _g === void 0 ? nwValue : _g, _h = _e[2], seValue = _h === void 0 ? nwValue : _h, _j = _e[3], swValue = _j === void 0 ? neValue : _j;\r\n    var _k = __read(verticalValues, 4), _l = _k[0], wnValue = _l === void 0 ? nwValue : _l, _m = _k[1], enValue = _m === void 0 ? hasVerticalValues ? wnValue : neValue : _m, _o = _k[2], esValue = _o === void 0 ? hasVerticalValues ? wnValue : seValue : _o, _p = _k[3], wsValue = _p === void 0 ? hasVerticalValues ? enValue : swValue : _p;\r\n    var horizontalRawPoses = [nwValue, neValue, seValue, swValue].map(function (pos) { return convertUnitSize(pos, width); });\r\n    var verticalRawPoses = [wnValue, enValue, esValue, wsValue].map(function (pos) { return convertUnitSize(pos, height); });\r\n    var horizontalPoses = horizontalRawPoses.slice();\r\n    var verticalPoses = verticalRawPoses.slice();\r\n    _a = __read(calculateRatio([horizontalPoses[0], horizontalPoses[1]], width), 2), horizontalPoses[0] = _a[0], horizontalPoses[1] = _a[1];\r\n    _b = __read(calculateRatio([horizontalPoses[3], horizontalPoses[2]], width), 2), horizontalPoses[3] = _b[0], horizontalPoses[2] = _b[1];\r\n    _c = __read(calculateRatio([verticalPoses[0], verticalPoses[3]], height), 2), verticalPoses[0] = _c[0], verticalPoses[3] = _c[1];\r\n    _d = __read(calculateRatio([verticalPoses[1], verticalPoses[2]], height), 2), verticalPoses[1] = _d[0], verticalPoses[2] = _d[1];\r\n    var nextHorizontalPoses = full\r\n        ? horizontalPoses\r\n        : horizontalPoses.slice(0, Math.max(minCounts[0], horizontalValuesLength));\r\n    var nextVerticalPoses = full\r\n        ? verticalPoses\r\n        : verticalPoses.slice(0, Math.max(minCounts[1], verticalValuesLength));\r\n    return __spreadArray(__spreadArray([], __read(nextHorizontalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= horizontalValuesLength,\r\n            horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n            vertical: 0,\r\n            pos: [left + pos, top + (VERTICAL_RADIUS_DIRECTIONS[i] === -1 ? height : 0)],\r\n            sub: true,\r\n            raw: horizontalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false), __read(nextVerticalPoses.map(function (pos, i) {\r\n        var direction = RADIUS_DIRECTIONS[i];\r\n        return {\r\n            virtual: i >= verticalValuesLength,\r\n            horizontal: 0,\r\n            vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n            pos: [left + (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1 ? width : 0), top + pos],\r\n            sub: true,\r\n            raw: verticalRawPoses[i],\r\n            direction: direction,\r\n        };\r\n    })), false);\r\n}\r\nfunction removeRadiusPos(controlPoses, poses, index, startIndex, length) {\r\n    if (length === void 0) { length = poses.length; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    var radiuslIndex = index - startIndex;\r\n    var deleteCount = 0;\r\n    if (radiuslIndex === 0) {\r\n        deleteCount = length;\r\n    }\r\n    else if (radiuslIndex > 0 && radiuslIndex < horizontalRange[1]) {\r\n        deleteCount = horizontalRange[1] - radiuslIndex;\r\n    }\r\n    else if (radiuslIndex >= verticalRange[0]) {\r\n        deleteCount = verticalRange[0] + verticalRange[1] - radiuslIndex;\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    controlPoses.splice(index, deleteCount);\r\n    poses.splice(index, deleteCount);\r\n}\r\nfunction addRadiusPos(controlPoses, poses, startIndex, horizontalIndex, verticalIndex, distX, distY, right, bottom, left, top) {\r\n    if (left === void 0) { left = 0; }\r\n    if (top === void 0) { top = 0; }\r\n    var _a = getRadiusRange(controlPoses.slice(startIndex)), horizontalRange = _a.horizontalRange, verticalRange = _a.verticalRange;\r\n    if (horizontalIndex > -1) {\r\n        var radiusX = HORIZONTAL_RADIUS_DIRECTIONS[horizontalIndex] === 1\r\n            ? distX - left\r\n            : right - distX;\r\n        for (var i = horizontalRange[1]; i <= horizontalIndex; ++i) {\r\n            var y = VERTICAL_RADIUS_DIRECTIONS[i] === 1 ? top : bottom;\r\n            var x = 0;\r\n            if (horizontalIndex === i) {\r\n                x = distX;\r\n            }\r\n            else if (i === 0) {\r\n                x = left + radiusX;\r\n            }\r\n            else if (HORIZONTAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                x = right - (poses[startIndex][0] - left);\r\n            }\r\n            controlPoses.splice(startIndex + i, 0, {\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[i],\r\n                vertical: 0,\r\n                pos: [x, y],\r\n            });\r\n            poses.splice(startIndex + i, 0, [x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    else if (verticalIndex > -1) {\r\n        var radiusY = VERTICAL_RADIUS_DIRECTIONS[verticalIndex] === 1\r\n            ? distY - top\r\n            : bottom - distY;\r\n        if (horizontalRange[1] === 0 && verticalRange[1] === 0) {\r\n            var pos = [\r\n                left + radiusY,\r\n                top,\r\n            ];\r\n            controlPoses.push({\r\n                horizontal: HORIZONTAL_RADIUS_DIRECTIONS[0],\r\n                vertical: 0,\r\n                pos: pos,\r\n            });\r\n            poses.push(pos);\r\n        }\r\n        var startVerticalIndex = verticalRange[0];\r\n        for (var i = verticalRange[1]; i <= verticalIndex; ++i) {\r\n            var x = HORIZONTAL_RADIUS_DIRECTIONS[i] === 1 ? left : right;\r\n            var y = 0;\r\n            if (verticalIndex === i) {\r\n                y = distY;\r\n            }\r\n            else if (i === 0) {\r\n                y = top + radiusY;\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === 1) {\r\n                y = poses[startIndex + startVerticalIndex][1];\r\n            }\r\n            else if (VERTICAL_RADIUS_DIRECTIONS[i] === -1) {\r\n                y = bottom - (poses[startIndex + startVerticalIndex][1] - top);\r\n            }\r\n            controlPoses.push({\r\n                horizontal: 0,\r\n                vertical: VERTICAL_RADIUS_DIRECTIONS[i],\r\n                pos: [x, y],\r\n            });\r\n            poses.push([x, y]);\r\n            if (i === 0) {\r\n                break;\r\n            }\r\n        }\r\n    }\r\n}\r\nfunction splitRadiusPoses(controlPoses, raws) {\r\n    if (raws === void 0) { raws = controlPoses.map(function (pos) { return pos.raw; }); }\r\n    var horizontals = controlPoses\r\n        .map(function (pos, i) { return pos.horizontal ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    var verticals = controlPoses\r\n        .map(function (pos, i) { return pos.vertical ? raws[i] : null; }).filter(function (pos) { return pos != null; });\r\n    return {\r\n        horizontals: horizontals,\r\n        verticals: verticals,\r\n    };\r\n}\n\nvar CLIP_DIRECTIONS = [\r\n    [0, -1, \"n\"],\r\n    [1, 0, \"e\"],\r\n];\r\nvar CLIP_RECT_DIRECTIONS = [\r\n    [-1, -1, \"nw\"],\r\n    [0, -1, \"n\"],\r\n    [1, -1, \"ne\"],\r\n    [1, 0, \"e\"],\r\n    [1, 1, \"se\"],\r\n    [0, 1, \"s\"],\r\n    [-1, 1, \"sw\"],\r\n    [-1, 0, \"w\"],\r\n];\r\n// 1 2 5 6 0 3 4 7\r\n// 0 1 2 3 4 5 6 7\r\nfunction getClipStyles(moveable, clipPath, poses) {\r\n    var clipRelative = moveable.props.clipRelative;\r\n    var _a = moveable.state, width = _a.width, height = _a.height;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses;\r\n    var isRect = clipType === \"rect\";\r\n    var isCircle = clipType === \"circle\";\r\n    if (clipType === \"polygon\") {\r\n        return poses.map(function (pos) { return \"\".concat(convertCSSSize(pos[0], width, clipRelative), \" \").concat(convertCSSSize(pos[1], height, clipRelative)); });\r\n    }\r\n    else if (isRect || clipType === \"inset\") {\r\n        var top_1 = poses[1][1];\r\n        var right = poses[3][0];\r\n        var left = poses[7][0];\r\n        var bottom = poses[5][1];\r\n        if (isRect) {\r\n            return [\r\n                top_1,\r\n                right,\r\n                bottom,\r\n                left,\r\n            ].map(function (pos) { return \"\".concat(pos, \"px\"); });\r\n        }\r\n        var clipStyles = [top_1, width - right, height - bottom, left]\r\n            .map(function (pos, i) { return convertCSSSize(pos, i % 2 ? width : height, clipRelative); });\r\n        if (poses.length > 8) {\r\n            var _c = __read(minus(poses[4], poses[0]), 2), subWidth = _c[0], subHeight = _c[1];\r\n            clipStyles.push.apply(clipStyles, __spreadArray([\"round\"], __read(getRadiusStyles(clipPoses.slice(8).map(function (info, i) {\r\n                return __assign(__assign({}, info), { pos: poses[i] });\r\n            }), clipRelative, subWidth, subHeight, left, top_1, right, bottom).styles), false));\r\n        }\r\n        return clipStyles;\r\n    }\r\n    else if (isCircle || clipType === \"ellipse\") {\r\n        var center = poses[0];\r\n        var ry = convertCSSSize(abs(poses[1][1] - center[1]), isCircle ? Math.sqrt((width * width + height * height) / 2) : height, clipRelative);\r\n        var clipStyles = isCircle ? [ry]\r\n            : [convertCSSSize(abs(poses[2][0] - center[0]), width, clipRelative), ry];\r\n        clipStyles.push(\"at\", convertCSSSize(center[0], width, clipRelative), convertCSSSize(center[1], height, clipRelative));\r\n        return clipStyles;\r\n    }\r\n}\r\nfunction getRectPoses(top, right, bottom, left) {\r\n    var xs = [left, (left + right) / 2, right];\r\n    var ys = [top, (top + bottom) / 2, bottom];\r\n    return CLIP_RECT_DIRECTIONS.map(function (_a) {\r\n        var _b = __read(_a, 3), dirx = _b[0], diry = _b[1], dir = _b[2];\r\n        var x = xs[dirx + 1];\r\n        var y = ys[diry + 1];\r\n        return {\r\n            vertical: abs(diry),\r\n            horizontal: abs(dirx),\r\n            direction: dir,\r\n            pos: [x, y],\r\n        };\r\n    });\r\n}\r\nfunction getControlSize(controlPoses) {\r\n    var xRange = [Infinity, -Infinity];\r\n    var yRange = [Infinity, -Infinity];\r\n    controlPoses.forEach(function (_a) {\r\n        var pos = _a.pos;\r\n        xRange[0] = Math.min(xRange[0], pos[0]);\r\n        xRange[1] = Math.max(xRange[1], pos[0]);\r\n        yRange[0] = Math.min(yRange[0], pos[1]);\r\n        yRange[1] = Math.max(yRange[1], pos[1]);\r\n    });\r\n    return [\r\n        abs(xRange[1] - xRange[0]),\r\n        abs(yRange[1] - yRange[0]),\r\n    ];\r\n}\r\nfunction getClipPath(target, width, height, defaultClip, customClip) {\r\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\r\n    if (!target) {\r\n        return;\r\n    }\r\n    var clipText = customClip;\r\n    if (!clipText) {\r\n        var getStyle = getCachedStyle(target);\r\n        var clipPath = getStyle(\"clipPath\");\r\n        clipText = clipPath !== \"none\" ? clipPath : getStyle(\"clip\");\r\n    }\r\n    if (!clipText || clipText === \"none\" || clipText === \"auto\") {\r\n        clipText = defaultClip;\r\n        if (!clipText) {\r\n            return;\r\n        }\r\n    }\r\n    var _k = splitBracket(clipText), _l = _k.prefix, clipPrefix = _l === void 0 ? clipText : _l, _m = _k.value, value = _m === void 0 ? \"\" : _m;\r\n    var isCircle = clipPrefix === \"circle\";\r\n    var splitter = \" \";\r\n    if (clipPrefix === \"polygon\") {\r\n        var values = splitComma(value || \"0% 0%, 100% 0%, 100% 100%, 0% 100%\");\r\n        splitter = \",\";\r\n        var poses = values.map(function (pos) {\r\n            var _a = __read(pos.split(\" \"), 2), xPos = _a[0], yPos = _a[1];\r\n            return {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: [\r\n                    convertUnitSize(xPos, width),\r\n                    convertUnitSize(yPos, height),\r\n                ],\r\n            };\r\n        });\r\n        var minMaxs = getMinMaxs(poses.map(function (pos) { return pos.pos; }));\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            poses: poses,\r\n            splitter: splitter,\r\n            left: minMaxs.minX,\r\n            right: minMaxs.maxX,\r\n            top: minMaxs.minY,\r\n            bottom: minMaxs.maxY,\r\n        };\r\n    }\r\n    else if (isCircle || clipPrefix === \"ellipse\") {\r\n        var xPos = \"\";\r\n        var yPos = \"\";\r\n        var radiusX_1 = 0;\r\n        var radiusY_1 = 0;\r\n        var values = splitSpace(value);\r\n        if (isCircle) {\r\n            var radius = \"\";\r\n            _a = __read(values, 4), _b = _a[0], radius = _b === void 0 ? \"50%\" : _b, _c = _a[2], xPos = _c === void 0 ? \"50%\" : _c, _d = _a[3], yPos = _d === void 0 ? \"50%\" : _d;\r\n            radiusX_1 = convertUnitSize(radius, Math.sqrt((width * width + height * height) / 2));\r\n            radiusY_1 = radiusX_1;\r\n        }\r\n        else {\r\n            var xRadius = \"\";\r\n            var yRadius = \"\";\r\n            _e = __read(values, 5), _f = _e[0], xRadius = _f === void 0 ? \"50%\" : _f, _g = _e[1], yRadius = _g === void 0 ? \"50%\" : _g, _h = _e[3], xPos = _h === void 0 ? \"50%\" : _h, _j = _e[4], yPos = _j === void 0 ? \"50%\" : _j;\r\n            radiusX_1 = convertUnitSize(xRadius, width);\r\n            radiusY_1 = convertUnitSize(yRadius, height);\r\n        }\r\n        var centerPos_1 = [\r\n            convertUnitSize(xPos, width),\r\n            convertUnitSize(yPos, height),\r\n        ];\r\n        var poses = __spreadArray([\r\n            {\r\n                vertical: 1,\r\n                horizontal: 1,\r\n                pos: centerPos_1,\r\n                direction: \"nesw\",\r\n            }\r\n        ], __read(CLIP_DIRECTIONS.slice(0, isCircle ? 1 : 2).map(function (dir) { return ({\r\n            vertical: abs(dir[1]),\r\n            horizontal: dir[0],\r\n            direction: dir[2],\r\n            sub: true,\r\n            pos: [\r\n                centerPos_1[0] + dir[0] * radiusX_1,\r\n                centerPos_1[1] + dir[1] * radiusY_1,\r\n            ],\r\n        }); })), false);\r\n        return {\r\n            type: clipPrefix,\r\n            clipText: clipText,\r\n            radiusX: radiusX_1,\r\n            radiusY: radiusY_1,\r\n            left: centerPos_1[0] - radiusX_1,\r\n            top: centerPos_1[1] - radiusY_1,\r\n            right: centerPos_1[0] + radiusX_1,\r\n            bottom: centerPos_1[1] + radiusY_1,\r\n            poses: poses,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"inset\") {\r\n        var values = splitSpace(value || \"0 0 0 0\");\r\n        var roundIndex = values.indexOf(\"round\");\r\n        var rectLength = (roundIndex > -1 ? values.slice(0, roundIndex) : values).length;\r\n        var radiusValues = values.slice(rectLength + 1);\r\n        var _o = __read(values.slice(0, rectLength), 4), topValue = _o[0], _p = _o[1], rightValue = _p === void 0 ? topValue : _p, _q = _o[2], bottomValue = _q === void 0 ? topValue : _q, _r = _o[3], leftValue = _r === void 0 ? rightValue : _r;\r\n        var _s = __read([topValue, bottomValue].map(function (pos) { return convertUnitSize(pos, height); }), 2), top_2 = _s[0], bottom = _s[1];\r\n        var _t = __read([leftValue, rightValue].map(function (pos) { return convertUnitSize(pos, width); }), 2), left = _t[0], right = _t[1];\r\n        var nextRight = width - right;\r\n        var nextBottom = height - bottom;\r\n        var radiusPoses = getRadiusValues(radiusValues, nextRight - left, nextBottom - top_2, left, top_2);\r\n        var poses = __spreadArray(__spreadArray([], __read(getRectPoses(top_2, nextRight, nextBottom, left)), false), __read(radiusPoses), false);\r\n        return {\r\n            type: \"inset\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_2,\r\n            left: left,\r\n            right: nextRight,\r\n            bottom: nextBottom,\r\n            radius: radiusValues,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    else if (clipPrefix === \"rect\") {\r\n        // top right bottom left\r\n        var values = splitComma(value || \"0px, \".concat(width, \"px, \").concat(height, \"px, 0px\"));\r\n        splitter = \",\";\r\n        var _u = __read(values.map(function (pos) {\r\n            var posValue = splitUnit(pos).value;\r\n            return posValue;\r\n        }), 4), top_3 = _u[0], right = _u[1], bottom = _u[2], left = _u[3];\r\n        var poses = getRectPoses(top_3, right, bottom, left);\r\n        return {\r\n            type: \"rect\",\r\n            clipText: clipText,\r\n            poses: poses,\r\n            top: top_3,\r\n            right: right,\r\n            bottom: bottom,\r\n            left: left,\r\n            values: values,\r\n            splitter: splitter,\r\n        };\r\n    }\r\n    return;\r\n}\n\nfunction moveControlPos(controlPoses, index, dist, isRect, keepRatio) {\r\n    var _a = controlPoses[index], direction = _a.direction, sub = _a.sub;\r\n    var dists = controlPoses.map(function () { return [0, 0]; });\r\n    var directions = direction ? direction.split(\"\") : [];\r\n    if (isRect && index < 8) {\r\n        var verticalDirections = directions.filter(function (dir) { return dir === \"w\" || dir === \"e\"; });\r\n        var horizontalDirections = directions.filter(function (dir) { return dir === \"n\" || dir === \"s\"; });\r\n        var verticalDirection_1 = verticalDirections[0];\r\n        var horizontalDirection_1 = horizontalDirections[0];\r\n        dists[index] = dist;\r\n        var _b = __read(getControlSize(controlPoses), 2), width = _b[0], height = _b[1];\r\n        var ratio = width && height ? width / height : 0;\r\n        if (ratio && keepRatio) {\r\n            // 0 1 2\r\n            // 7   3\r\n            // 6 5 4\r\n            var fixedIndex = (index + 4) % 8;\r\n            var fixedPosition = controlPoses[fixedIndex].pos;\r\n            var sizeDirection = [0, 0];\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                sizeDirection[0] = -1;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                sizeDirection[0] = 1;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                sizeDirection[1] = -1;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                sizeDirection[1] = 1;\r\n            }\r\n            var nextDist = getSizeDistByDist([width, height], dist, ratio, sizeDirection, true);\r\n            var nextWidth = width + nextDist[0];\r\n            var nextHeight = height + nextDist[1];\r\n            var top_1 = fixedPosition[1];\r\n            var bottom = fixedPosition[1];\r\n            var left = fixedPosition[0];\r\n            var right = fixedPosition[0];\r\n            if (sizeDirection[0] === -1) {\r\n                left = right - nextWidth;\r\n            }\r\n            else if (sizeDirection[0] === 1) {\r\n                right = left + nextWidth;\r\n            }\r\n            else {\r\n                left = left - nextWidth / 2;\r\n                right = right + nextWidth / 2;\r\n            }\r\n            if (sizeDirection[1] === -1) {\r\n                top_1 = bottom - nextHeight;\r\n            }\r\n            else if (sizeDirection[1] === 1) {\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            else {\r\n                top_1 = bottom - nextHeight / 2;\r\n                bottom = top_1 + nextHeight;\r\n            }\r\n            var nextControlPoses_1 = getRectPoses(top_1, right, bottom, left);\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                dists[i][0] = nextControlPoses_1[i].pos[0] - controlPose.pos[0];\r\n                dists[i][1] = nextControlPoses_1[i].pos[1] - controlPose.pos[1];\r\n            });\r\n        }\r\n        else {\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var controlDir = controlPose.direction;\r\n                if (!controlDir) {\r\n                    return;\r\n                }\r\n                if (controlDir.indexOf(verticalDirection_1) > -1) {\r\n                    dists[i][0] = dist[0];\r\n                }\r\n                if (controlDir.indexOf(horizontalDirection_1) > -1) {\r\n                    dists[i][1] = dist[1];\r\n                }\r\n            });\r\n            if (verticalDirection_1) {\r\n                dists[1][0] = dist[0] / 2;\r\n                dists[5][0] = dist[0] / 2;\r\n            }\r\n            if (horizontalDirection_1) {\r\n                dists[3][1] = dist[1] / 2;\r\n                dists[7][1] = dist[1] / 2;\r\n            }\r\n        }\r\n    }\r\n    else if (direction && !sub) {\r\n        directions.forEach(function (dir) {\r\n            var isVertical = dir === \"n\" || dir === \"s\";\r\n            controlPoses.forEach(function (controlPose, i) {\r\n                var dirDir = controlPose.direction, dirHorizontal = controlPose.horizontal, dirVertical = controlPose.vertical;\r\n                if (!dirDir || dirDir.indexOf(dir) === -1) {\r\n                    return;\r\n                }\r\n                dists[i] = [\r\n                    isVertical || !dirHorizontal ? 0 : dist[0],\r\n                    !isVertical || !dirVertical ? 0 : dist[1],\r\n                ];\r\n            });\r\n        });\r\n    }\r\n    else {\r\n        dists[index] = dist;\r\n    }\r\n    return dists;\r\n}\r\nfunction addClipPath(moveable, e) {\r\n    var _a = __read(calculatePointerDist(moveable, e), 2), distX = _a[0], distY = _a[1];\r\n    var _b = e.datas, clipPath = _b.clipPath, clipIndex = _b.clipIndex;\r\n    var _c = clipPath, clipType = _c.type, clipPoses = _c.poses, splitter = _c.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    if (clipType === \"polygon\") {\r\n        poses.splice(clipIndex, 0, [distX, distY]);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        var horizontalIndex = HORIZONTAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var verticalIndex = VERTICAL_RADIUS_ORDER.indexOf(clipIndex);\r\n        var length_1 = clipPoses.length;\r\n        addRadiusPos(clipPoses, poses, 8, horizontalIndex, verticalIndex, distX, distY, poses[4][0], poses[4][1], poses[0][0], poses[0][1]);\r\n        if (length_1 === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"added\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\nfunction removeClipPath(moveable, e) {\r\n    var _a = e.datas, clipPath = _a.clipPath, clipIndex = _a.clipIndex;\r\n    var _b = clipPath, clipType = _b.type, clipPoses = _b.poses, splitter = _b.splitter;\r\n    var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n    var length = poses.length;\r\n    if (clipType === \"polygon\") {\r\n        clipPoses.splice(clipIndex, 1);\r\n        poses.splice(clipIndex, 1);\r\n    }\r\n    else if (clipType === \"inset\") {\r\n        if (clipIndex < 8) {\r\n            return;\r\n        }\r\n        removeRadiusPos(clipPoses, poses, clipIndex, 8, length);\r\n        if (length === clipPoses.length) {\r\n            return;\r\n        }\r\n    }\r\n    else {\r\n        return;\r\n    }\r\n    var clipStyles = getClipStyles(moveable, clipPath, poses);\r\n    var clipStyle = \"\".concat(clipType, \"(\").concat(clipStyles.join(splitter), \")\");\r\n    triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"removed\", clipType: clipType, poses: poses, clipStyles: clipStyles, clipStyle: clipStyle, distX: 0, distY: 0 }, fillCSSObject({\r\n        clipPath: clipStyle,\r\n    }, e))));\r\n}\r\n/**\r\n * @namespace Moveable.Clippable\r\n * @description Whether to clip the target.\r\n */\r\nvar Clippable = {\r\n    name: \"clippable\",\r\n    props: [\r\n        \"clippable\",\r\n        \"defaultClipPath\",\r\n        \"customClipPath\",\r\n        \"keepRatio\",\r\n        \"clipRelative\",\r\n        \"clipArea\",\r\n        \"dragWithClip\",\r\n        \"clipTargetBounds\",\r\n        \"clipVerticalGuidelines\",\r\n        \"clipHorizontalGuidelines\",\r\n        \"clipSnapThreshold\",\r\n    ],\r\n    events: [\r\n        \"clipStart\",\r\n        \"clip\",\r\n        \"clipEnd\",\r\n    ],\r\n    css: [\r\n        \".control.clip-control {\\nbackground: #6d6;\\ncursor: pointer;\\n}\\n.control.clip-control.clip-radius {\\nbackground: #d66;\\n}\\n.line.clip-line {\\nbackground: #6e6;\\ncursor: move;\\nz-index: 1;\\n}\\n.clip-area {\\nposition: absolute;\\ntop: 0;\\nleft: 0;\\n}\\n.clip-ellipse {\\nposition: absolute;\\ncursor: move;\\nborder: 1px solid #6d6;\\nborder: var(--zoompx) solid #6d6;\\nborder-radius: 50%;\\ntransform-origin: 0px 0px;\\n}\",\r\n        \":host {\\n--bounds-color: #d66;\\n}\",\r\n        \".guideline {\\npointer-events: none;\\nz-index: 2;\\n}\",\r\n        \".line.guideline.bounds {\\nbackground: #d66;\\nbackground: var(--bounds-color);\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var _a = moveable.props, customClipPath = _a.customClipPath, defaultClipPath = _a.defaultClipPath, clipArea = _a.clipArea, zoom = _a.zoom, groupable = _a.groupable;\r\n        var _b = moveable.getState(), target = _b.target, width = _b.width, height = _b.height, allMatrix = _b.allMatrix, is3d = _b.is3d, left = _b.left, top = _b.top, pos1 = _b.pos1, pos2 = _b.pos2, pos3 = _b.pos3, pos4 = _b.pos4, clipPathState = _b.clipPathState, snapBoundInfos = _b.snapBoundInfos, rotationRad = _b.rotation;\r\n        if (!target || groupable) {\r\n            return [];\r\n        }\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", clipPathState || customClipPath);\r\n        if (!clipPath) {\r\n            return [];\r\n        }\r\n        var n = is3d ? 4 : 3;\r\n        var type = clipPath.type;\r\n        var clipPoses = clipPath.poses;\r\n        var poses = clipPoses.map(function (pos) {\r\n            // return [x, y];\r\n            var calculatedPos = calculatePosition(allMatrix, pos.pos, n);\r\n            return [\r\n                calculatedPos[0] - left,\r\n                calculatedPos[1] - top,\r\n            ];\r\n        });\r\n        var controls = [];\r\n        var lines = [];\r\n        var isRect = type === \"rect\";\r\n        var isInset = type === \"inset\";\r\n        var isPolygon = type === \"polygon\";\r\n        if (isRect || isInset || isPolygon) {\r\n            var linePoses_1 = isInset ? poses.slice(0, 8) : poses;\r\n            lines = linePoses_1.map(function (to, i) {\r\n                var from = i === 0 ? linePoses_1[linePoses_1.length - 1] : linePoses_1[i - 1];\r\n                var rad = getRad(from, to);\r\n                var dist = getDiagonalSize(from, to);\r\n                return React.createElement(\"div\", { key: \"clipLine\".concat(i), className: prefix(\"line\", \"clip-line\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                        width: \"\".concat(dist, \"px\"),\r\n                        transform: \"translate(\".concat(from[0], \"px, \").concat(from[1], \"px) rotate(\").concat(rad, \"rad) scaleY(\").concat(zoom, \")\"),\r\n                    } });\r\n            });\r\n        }\r\n        controls = poses.map(function (pos, i) {\r\n            return React.createElement(\"div\", { key: \"clipControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"snap-control\"), \"data-clip-index\": i, style: {\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n        if (isInset) {\r\n            controls.push.apply(controls, __spreadArray([], __read(poses.slice(8).map(function (pos, i) {\r\n                return React.createElement(\"div\", { key: \"clipRadiusControl\".concat(i), className: prefix(\"control\", \"clip-control\", \"clip-radius\", \"snap-control\"), \"data-clip-index\": 8 + i, style: {\r\n                        transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) rotate(\").concat(rotationRad, \"rad) scale(\").concat(zoom, \")\"),\r\n                    } });\r\n            })), false));\r\n        }\r\n        if (type === \"circle\" || type === \"ellipse\") {\r\n            var clipLeft = clipPath.left, clipTop = clipPath.top, radiusX = clipPath.radiusX, radiusY = clipPath.radiusY;\r\n            var _c = __read(minus(calculatePosition(allMatrix, [clipLeft, clipTop], n), calculatePosition(allMatrix, [0, 0], n)), 2), distLeft = _c[0], distTop = _c[1];\r\n            var ellipseClipPath = \"none\";\r\n            if (!clipArea) {\r\n                var piece = Math.max(10, radiusX / 5, radiusY / 5);\r\n                var areaPoses = [];\r\n                for (var i = 0; i <= piece; ++i) {\r\n                    var rad = Math.PI * 2 / piece * i;\r\n                    areaPoses.push([\r\n                        radiusX + (radiusX - zoom) * Math.cos(rad),\r\n                        radiusY + (radiusY - zoom) * Math.sin(rad),\r\n                    ]);\r\n                }\r\n                areaPoses.push([radiusX, -2]);\r\n                areaPoses.push([-2, -2]);\r\n                areaPoses.push([-2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, radiusY * 2 + 2]);\r\n                areaPoses.push([radiusX * 2 + 2, -2]);\r\n                areaPoses.push([radiusX, -2]);\r\n                ellipseClipPath = \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0], \"px \").concat(pos[1], \"px\"); }).join(\", \"), \")\");\r\n            }\r\n            controls.push(React.createElement(\"div\", { key: \"clipEllipse\", className: prefix(\"clip-ellipse\", \"snap-control\"), style: {\r\n                    width: \"\".concat(radiusX * 2, \"px\"),\r\n                    height: \"\".concat(radiusY * 2, \"px\"),\r\n                    clipPath: ellipseClipPath,\r\n                    transform: \"translate(\".concat(-left + distLeft, \"px, \").concat(-top + distTop, \"px) \").concat(makeMatrixCSS(allMatrix)),\r\n                } }));\r\n        }\r\n        if (clipArea) {\r\n            var _d = getRect(__spreadArray([pos1, pos2, pos3, pos4], __read(poses), false)), allWidth = _d.width, allHeight = _d.height, allLeft_1 = _d.left, allTop_1 = _d.top;\r\n            if (isPolygon || isRect || isInset) {\r\n                var areaPoses = isInset ? poses.slice(0, 8) : poses;\r\n                controls.push(React.createElement(\"div\", { key: \"clipArea\", className: prefix(\"clip-area\", \"snap-control\"), style: {\r\n                        width: \"\".concat(allWidth, \"px\"),\r\n                        height: \"\".concat(allHeight, \"px\"),\r\n                        transform: \"translate(\".concat(allLeft_1, \"px, \").concat(allTop_1, \"px)\"),\r\n                        clipPath: \"polygon(\".concat(areaPoses.map(function (pos) { return \"\".concat(pos[0] - allLeft_1, \"px \").concat(pos[1] - allTop_1, \"px\"); }).join(\", \"), \")\"),\r\n                    } }));\r\n            }\r\n        }\r\n        if (snapBoundInfos) {\r\n            [\"vertical\", \"horizontal\"].forEach(function (directionType) {\r\n                var info = snapBoundInfos[directionType];\r\n                var isHorizontal = directionType === \"horizontal\";\r\n                if (info.isSnap) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.snap.posInfos.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"snap\").concat(i), \"guideline\");\r\n                    })), false));\r\n                }\r\n                if (info.isBound) {\r\n                    lines.push.apply(lines, __spreadArray([], __read(info.bounds.map(function (_a, i) {\r\n                        var pos = _a.pos;\r\n                        var snapPos1 = minus(calculatePosition(allMatrix, isHorizontal ? [0, pos] : [pos, 0], n), [left, top]);\r\n                        var snapPos2 = minus(calculatePosition(allMatrix, isHorizontal ? [width, pos] : [pos, height], n), [left, top]);\r\n                        return renderLine(React, \"\", snapPos1, snapPos2, zoom, \"clip\".concat(directionType, \"bounds\").concat(i), \"guideline\", \"bounds\", \"bold\");\r\n                    })), false));\r\n                }\r\n            });\r\n        }\r\n        return __spreadArray(__spreadArray([], __read(controls), false), __read(lines), false);\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        return e.inputEvent && (e.inputEvent.target.getAttribute(\"class\") || \"\").indexOf(\"clip\") > -1;\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        var props = moveable.props;\r\n        var _a = props.dragWithClip, dragWithClip = _a === void 0 ? true : _a;\r\n        if (dragWithClip) {\r\n            return false;\r\n        }\r\n        return this.dragControlStart(moveable, e);\r\n    },\r\n    drag: function (moveable, e) {\r\n        return this.dragControl(moveable, __assign(__assign({}, e), { isDragTarget: true }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return this.dragControlEnd(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var state = moveable.state;\r\n        var _a = moveable.props, defaultClipPath = _a.defaultClipPath, customClipPath = _a.customClipPath;\r\n        var target = state.target, width = state.width, height = state.height;\r\n        var inputTarget = e.inputEvent ? e.inputEvent.target : null;\r\n        var className = (inputTarget && inputTarget.getAttribute(\"class\")) || \"\";\r\n        var datas = e.datas;\r\n        var clipPath = getClipPath(target, width, height, defaultClipPath || \"inset\", customClipPath);\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var clipText = clipPath.clipText, type = clipPath.type, poses = clipPath.poses;\r\n        var result = triggerEvent(moveable, \"onClipStart\", fillParams(moveable, e, {\r\n            clipType: type,\r\n            clipStyle: clipText,\r\n            poses: poses.map(function (pos) { return pos.pos; }),\r\n        }));\r\n        if (result === false) {\r\n            datas.isClipStart = false;\r\n            return false;\r\n        }\r\n        datas.isControl = className && className.indexOf(\"clip-control\") > -1;\r\n        datas.isLine = className.indexOf(\"clip-line\") > -1;\r\n        datas.isArea = className.indexOf(\"clip-area\") > -1 || className.indexOf(\"clip-ellipse\") > -1;\r\n        datas.clipIndex = inputTarget ? parseInt(inputTarget.getAttribute(\"data-clip-index\"), 10) : -1;\r\n        datas.clipPath = clipPath;\r\n        datas.isClipStart = true;\r\n        state.clipPathState = clipText;\r\n        setDragStart(moveable, e);\r\n        return true;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var _a, _b, _c;\r\n        var datas = e.datas, originalDatas = e.originalDatas, isDragTarget = e.isDragTarget;\r\n        if (!datas.isClipStart) {\r\n            return false;\r\n        }\r\n        var _d = datas, isControl = _d.isControl, isLine = _d.isLine, isArea = _d.isArea, clipIndex = _d.clipIndex, clipPath = _d.clipPath;\r\n        if (!clipPath) {\r\n            return false;\r\n        }\r\n        var props = getProps(moveable.props, \"clippable\");\r\n        var keepRatio = props.keepRatio;\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var originalDraggable = originalDatas.draggable;\r\n        var originalDist = getDragDist(e);\r\n        if (isDragTarget && originalDraggable) {\r\n            _a = __read(originalDraggable.prevBeforeDist, 2), distX = _a[0], distY = _a[1];\r\n        }\r\n        else {\r\n            _b = __read(originalDist, 2), distX = _b[0], distY = _b[1];\r\n        }\r\n        var firstDist = [distX, distY];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        var isDragWithTarget = !isArea && !isControl && !isLine;\r\n        var clipType = clipPath.type, clipPoses = clipPath.poses, splitter = clipPath.splitter;\r\n        var poses = clipPoses.map(function (pos) { return pos.pos; });\r\n        if (isDragWithTarget) {\r\n            distX = -distX;\r\n            distY = -distY;\r\n        }\r\n        var isAll = !isControl || clipPoses[clipIndex].direction === \"nesw\";\r\n        var isRect = clipType === \"inset\" || clipType === \"rect\";\r\n        var dists = clipPoses.map(function () { return [0, 0]; });\r\n        if (isControl && !isAll) {\r\n            var _e = clipPoses[clipIndex], horizontal = _e.horizontal, vertical = _e.vertical;\r\n            var dist = [\r\n                distX * abs(horizontal),\r\n                distY * abs(vertical),\r\n            ];\r\n            dists = moveControlPos(clipPoses, clipIndex, dist, isRect, keepRatio);\r\n        }\r\n        else if (isAll) {\r\n            dists = poses.map(function () { return [distX, distY]; });\r\n        }\r\n        var nextPoses = poses.map(function (pos, i) { return plus(pos, dists[i]); });\r\n        var guidePoses = __spreadArray([], __read(nextPoses), false);\r\n        state.snapBoundInfos = null;\r\n        var isCircle = clipPath.type === \"circle\";\r\n        var isEllipse = clipPath.type === \"ellipse\";\r\n        if (isCircle || isEllipse) {\r\n            var guideRect = getRect(nextPoses);\r\n            var ry = abs(guideRect.bottom - guideRect.top);\r\n            var rx = abs(isEllipse ? guideRect.right - guideRect.left : ry);\r\n            var bottom = nextPoses[0][1] + ry;\r\n            var left = nextPoses[0][0] - rx;\r\n            var right = nextPoses[0][0] + rx;\r\n            // right\r\n            if (isCircle) {\r\n                guidePoses.push([right, guideRect.bottom]);\r\n                dists.push([1, 0]);\r\n            }\r\n            // bottom\r\n            guidePoses.push([guideRect.left, bottom]);\r\n            dists.push([0, 1]);\r\n            // left\r\n            guidePoses.push([left, guideRect.bottom]);\r\n            dists.push([1, 0]);\r\n        }\r\n        var guidelines = getDefaultGuidelines((props.clipHorizontalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), height); }), (props.clipVerticalGuidelines || []).map(function (v) { return convertUnitSize(\"\".concat(v), width); }), width, height);\r\n        var guideXPoses = [];\r\n        var guideYPoses = [];\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            var rectDists_1 = [dists[0], dists[2], dists[4], dists[6]];\r\n            guideXPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.filter(function (_, i) { return rectDists_1[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.filter(function (_, i) { return dists[i][0]; }).map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.filter(function (_, i) { return dists[i][1]; }).map(function (pos) { return pos[1]; });\r\n        }\r\n        var boundDelta = [0, 0];\r\n        var _f = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 5, 5), horizontalSnapInfo = _f.horizontal, verticalSnapInfo = _f.vertical;\r\n        var snapOffsetY = horizontalSnapInfo.offset;\r\n        var snapOffsetX = verticalSnapInfo.offset;\r\n        if (horizontalSnapInfo.isBound) {\r\n            boundDelta[1] += snapOffsetY;\r\n        }\r\n        if (verticalSnapInfo.isBound) {\r\n            boundDelta[0] += snapOffsetX;\r\n        }\r\n        if ((isEllipse || isCircle) && dists[0][0] === 0 && dists[0][1] === 0) {\r\n            var guideRect = getRect(nextPoses);\r\n            var cy = guideRect.bottom - guideRect.top;\r\n            var cx = isEllipse ? guideRect.right - guideRect.left : cy;\r\n            var distSnapX = verticalSnapInfo.isBound\r\n                ? abs(snapOffsetX)\r\n                : (verticalSnapInfo.snapIndex === 0 ? -snapOffsetX : snapOffsetX);\r\n            var distSnapY = horizontalSnapInfo.isBound\r\n                ? abs(snapOffsetY)\r\n                : (horizontalSnapInfo.snapIndex === 0 ? -snapOffsetY : snapOffsetY);\r\n            cx -= distSnapX;\r\n            cy -= distSnapY;\r\n            if (isCircle) {\r\n                cy = checkSnapBoundPriority(verticalSnapInfo, horizontalSnapInfo) > 0 ? cy : cx;\r\n                cx = cy;\r\n            }\r\n            var center = guidePoses[0];\r\n            guidePoses[1][1] = center[1] - cy;\r\n            guidePoses[2][0] = center[0] + cx;\r\n            guidePoses[3][1] = center[1] + cy;\r\n            guidePoses[4][0] = center[0] - cx;\r\n        }\r\n        else if (isRect && keepRatio && isControl) {\r\n            var _g = __read(getControlSize(clipPoses), 2), width_1 = _g[0], height_1 = _g[1];\r\n            var ratio = width_1 && height_1 ? width_1 / height_1 : 0;\r\n            var clipPose = clipPoses[clipIndex];\r\n            var direction = clipPose.direction || \"\";\r\n            var top_2 = guidePoses[1][1];\r\n            var bottom = guidePoses[5][1];\r\n            var left = guidePoses[7][0];\r\n            var right = guidePoses[3][0];\r\n            if (abs(snapOffsetY) <= abs(snapOffsetX)) {\r\n                snapOffsetY = sign(snapOffsetY) * abs(snapOffsetX) / ratio;\r\n            }\r\n            else {\r\n                snapOffsetX = sign(snapOffsetX) * abs(snapOffsetY) * ratio;\r\n            }\r\n            if (direction.indexOf(\"w\") > -1) {\r\n                left -= snapOffsetX;\r\n            }\r\n            else if (direction.indexOf(\"e\") > -1) {\r\n                right -= snapOffsetX;\r\n            }\r\n            else {\r\n                left += snapOffsetX / 2;\r\n                right -= snapOffsetX / 2;\r\n            }\r\n            if (direction.indexOf(\"n\") > -1) {\r\n                top_2 -= snapOffsetY;\r\n            }\r\n            else if (direction.indexOf(\"s\") > -1) {\r\n                bottom -= snapOffsetY;\r\n            }\r\n            else {\r\n                top_2 += snapOffsetY / 2;\r\n                bottom -= snapOffsetY / 2;\r\n            }\r\n            var nextControlPoses_2 = getRectPoses(top_2, right, bottom, left);\r\n            guidePoses.forEach(function (pos, i) {\r\n                var _a;\r\n                _a = __read(nextControlPoses_2[i].pos, 2), pos[0] = _a[0], pos[1] = _a[1];\r\n            });\r\n        }\r\n        else {\r\n            guidePoses.forEach(function (pos, j) {\r\n                var dist = dists[j];\r\n                if (dist[0]) {\r\n                    pos[0] -= snapOffsetX;\r\n                }\r\n                if (dist[1]) {\r\n                    pos[1] -= snapOffsetY;\r\n                }\r\n            });\r\n        }\r\n        var nextClipStyles = getClipStyles(moveable, clipPath, nextPoses);\r\n        var clipStyle = \"\".concat(clipType, \"(\").concat(nextClipStyles.join(splitter), \")\");\r\n        state.clipPathState = clipStyle;\r\n        if (isCircle || isEllipse) {\r\n            guideXPoses = [guidePoses[4][0], guidePoses[2][0]];\r\n            guideYPoses = [guidePoses[1][1], guidePoses[3][1]];\r\n        }\r\n        else if (isRect) {\r\n            var rectPoses = [guidePoses[0], guidePoses[2], guidePoses[4], guidePoses[6]];\r\n            guideXPoses = rectPoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = rectPoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        else {\r\n            guideXPoses = guidePoses.map(function (pos) { return pos[0]; });\r\n            guideYPoses = guidePoses.map(function (pos) { return pos[1]; });\r\n        }\r\n        state.snapBoundInfos = checkSnapBounds(guidelines, props.clipTargetBounds && { left: 0, top: 0, right: width, bottom: height }, guideXPoses, guideYPoses, 1, 1);\r\n        if (originalDraggable) {\r\n            var is3d = state.is3d, allMatrix = state.allMatrix;\r\n            var n = is3d ? 4 : 3;\r\n            var dragDist = boundDelta;\r\n            if (isDragTarget) {\r\n                dragDist = [\r\n                    firstDist[0] + boundDelta[0] - originalDist[0],\r\n                    firstDist[1] + boundDelta[1] - originalDist[1],\r\n                ];\r\n            }\r\n            originalDraggable.deltaOffset = multiply(allMatrix, [dragDist[0], dragDist[1], 0, 0], n);\r\n        }\r\n        triggerEvent(moveable, \"onClip\", fillParams(moveable, e, __assign({ clipEventType: \"changed\", clipType: clipType, poses: nextPoses, clipStyle: clipStyle, clipStyles: nextClipStyles, distX: distX, distY: distY }, fillCSSObject((_c = {},\r\n            _c[clipType === \"rect\" ? \"clip\" : \"clipPath\"] = clipStyle,\r\n            _c), e))));\r\n        return true;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.unset(moveable);\r\n        var isDrag = e.isDrag, datas = e.datas, isDouble = e.isDouble;\r\n        var isLine = datas.isLine, isClipStart = datas.isClipStart, isControl = datas.isControl;\r\n        if (!isClipStart) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onClipEnd\", fillEndParams(moveable, e, {}));\r\n        if (isDouble) {\r\n            if (isControl) {\r\n                removeClipPath(moveable, e);\r\n            }\r\n            else if (isLine) {\r\n                // add\r\n                addClipPath(moveable, e);\r\n            }\r\n        }\r\n        return isDouble || isDrag;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.clipPathState = \"\";\r\n        moveable.state.snapBoundInfos = null;\r\n    },\r\n};\r\n/**\r\n * Whether to clip the target. (default: false)\r\n * @name Moveable.Clippable#clippable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n *  If clippath is not set, the default value can be set. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#defaultClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (`rect` not possible) (default: false)\r\n * @name Moveable.Clippable#clipRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can force the custom clipPath. (defaultClipPath < style < customClipPath < dragging clipPath)\r\n * @name Moveable.Clippable#customClipPath\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When dragging the target, the clip also moves. (default: true)\r\n * @name Moveable.Clippable#dragWithClip\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * You can drag the clip by setting clipArea.\r\n * @name Moveable.Clippable#clipArea\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n* Whether the clip is bound to the target.\r\n* @name Moveable.Clippable#clipTargetBounds\r\n* @default false\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipTargetBounds: true,\r\n* });\r\n* moveable.on(\"clipStart\", e => {\r\n*     console.log(e);\r\n* }).on(\"clip\", e => {\r\n*     if (e.clipType === \"rect\") {\r\n*         e.target.style.clip = e.clipStyle;\r\n*     } else {\r\n*         e.target.style.clipPath = e.clipStyle;\r\n*     }\r\n* }).on(\"clipEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n * Add clip guidelines in the vertical direction.\r\n * @name Moveable.Clippable#clipVerticalGuidelines\r\n * @default 0\r\n * @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* Add clip guidelines in the horizontal direction.\r\n* @name Moveable.Clippable#clipHorizontalGuidelines\r\n* @default []\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n* istance value that can snap to clip guidelines.\r\n* @name Moveable.Clippable#clipSnapThreshold\r\n* @default 5\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     clippable: true,\r\n*     defaultClipPath: \"inset\",\r\n*     customClipPath: \"\",\r\n*     clipRelative: false,\r\n*     clipArea: false,\r\n*     dragWithClip: true,\r\n*     clipVerticalGuidelines: [0, 100, 200],\r\n*     clipHorizontalGuidelines: [0, 100, 200],\r\n*     clipSnapThreshold: 5,\r\n* });\r\n*/\r\n/**\r\n * When drag start the clip area or controls, the `clipStart` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipStart\r\n * @param {Moveable.Clippable.OnClipStart} - Parameters for the `clipStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag the clip area or controls, the `clip` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clip\r\n * @param {Moveable.Clippable.OnClip} - Parameters for the `clip` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the clip area or controls, the `clipEnd` event is called.\r\n * @memberof Moveable.Clippable\r\n * @event clipEnd\r\n * @param {Moveable.Clippable.OnClipEnd} - Parameters for the `clipEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     clippable: true,\r\n *     defaultClipPath: \"inset\",\r\n *     customClipPath: \"\",\r\n *     clipRelative: false,\r\n *     clipArea: false,\r\n *     dragWithClip: true,\r\n * });\r\n * moveable.on(\"clipStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"clip\", e => {\r\n *     if (e.clipType === \"rect\") {\r\n *         e.target.style.clip = e.clipStyle;\r\n *     } else {\r\n *         e.target.style.clipPath = e.clipStyle;\r\n *     }\r\n * }).on(\"clipEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\n/**\r\n * @namespace OriginDraggable\r\n * @memberof Moveable\r\n * @description Whether to drag origin (default: false)\r\n */\r\nvar OriginDraggable = {\r\n    name: \"originDraggable\",\r\n    props: [\r\n        \"originDraggable\",\r\n        \"originRelative\",\r\n    ],\r\n    events: [\r\n        \"dragOriginStart\",\r\n        \"dragOrigin\",\r\n        \"dragOriginEnd\",\r\n    ],\r\n    css: [\r\n        \":host[data-able-origindraggable] .control.origin {\\npointer-events: auto;\\n}\",\r\n    ],\r\n    dragControlCondition: function (_, e) {\r\n        if (e.isRequest) {\r\n            return e.requestAble === \"originDraggable\";\r\n        }\r\n        return hasClass(e.inputEvent.target, prefix(\"origin\"));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var datas = e.datas;\r\n        setDragStart(moveable, e);\r\n        var params = fillParams(moveable, e, {\r\n            dragStart: Draggable.dragStart(moveable, new CustomGesto().dragStart([0, 0], e)),\r\n        });\r\n        var result = triggerEvent(moveable, \"onDragOriginStart\", params);\r\n        datas.startOrigin = moveable.state.transformOrigin;\r\n        datas.startTargetOrigin = moveable.state.targetOrigin;\r\n        datas.prevOrigin = [0, 0];\r\n        datas.isDragOrigin = true;\r\n        if (result === false) {\r\n            datas.isDragOrigin = false;\r\n            return false;\r\n        }\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas, isPinch = e.isPinch, isRequest = e.isRequest;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height, offsetMatrix = state.offsetMatrix, targetMatrix = state.targetMatrix, is3d = state.is3d;\r\n        var _b = moveable.props.originRelative, originRelative = _b === void 0 ? true : _b;\r\n        var n = is3d ? 4 : 3;\r\n        var dist = [distX, distY];\r\n        if (isRequest) {\r\n            var distOrigin = e.distOrigin;\r\n            if (distOrigin[0] || distOrigin[1]) {\r\n                dist = distOrigin;\r\n            }\r\n        }\r\n        var origin = plus(datas.startOrigin, dist);\r\n        var targetOrigin = plus(datas.startTargetOrigin, dist);\r\n        var delta = minus(dist, datas.prevOrigin);\r\n        var nextMatrix = getNextMatrix(offsetMatrix, targetMatrix, origin, n);\r\n        var rect = moveable.getRect();\r\n        var nextRect = getRect(calculatePoses(nextMatrix, width, height, n));\r\n        var dragDelta = [\r\n            rect.left - nextRect.left,\r\n            rect.top - nextRect.top,\r\n        ];\r\n        datas.prevOrigin = dist;\r\n        var transformOrigin = [\r\n            convertCSSSize(targetOrigin[0], width, originRelative),\r\n            convertCSSSize(targetOrigin[1], height, originRelative),\r\n        ].join(\" \");\r\n        var result = Draggable.drag(moveable, setCustomDrag(e, moveable.state, dragDelta, !!isPinch, false));\r\n        var params = fillParams(moveable, e, __assign(__assign({ width: width, height: height, origin: origin, dist: dist, delta: delta, transformOrigin: transformOrigin, drag: result }, fillCSSObject({\r\n            transformOrigin: transformOrigin,\r\n            transform: result.transform,\r\n        }, e)), { afterTransform: result.transform }));\r\n        triggerEvent(moveable, \"onDragOrigin\", params);\r\n        return params;\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var datas = e.datas;\r\n        if (!datas.isDragOrigin) {\r\n            return false;\r\n        }\r\n        triggerEvent(moveable, \"onDragOriginEnd\", fillEndParams(moveable, e, {}));\r\n        return true;\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var params = this.dragControlStart(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var params = this.dragControl(moveable, e);\r\n        if (!params) {\r\n            return false;\r\n        }\r\n        moveable.transformOrigin = params.transformOrigin;\r\n        return true;\r\n    },\r\n    /**\r\n    * @method Moveable.OriginDraggable#request\r\n    * @param {object} e - the OriginDraggable's request parameter\r\n    * @param {number} [e.x] - x position\r\n    * @param {number} [e.y] - y position\r\n    * @param {number} [e.deltaX] - x number to move\r\n    * @param {number} [e.deltaY] - y number to move\r\n    * @param {array} [e.deltaOrigin] - left, top number to move transform-origin\r\n    * @param {array} [e.origin] - transform-origin position\r\n    * @param {number} [e.isInstant] - Whether to execute the request instantly\r\n    * @return {Moveable.Requester} Moveable Requester\r\n    * @example\r\n\n    * // Instantly Request (requestStart - request - requestEnd)\r\n    * // Use Relative Value\r\n    * moveable.request(\"originDraggable\", { deltaX: 10, deltaY: 10 }, true);\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 }, true);\r\n    * // Use Transform Value\r\n    * moveable.request(\"originDraggable\", { deltaOrigin: [10, 0] }, true);\r\n    * moveable.request(\"originDraggable\", { origin: [100, 0] }, true);\r\n    * // requestStart\r\n    * const requester = moveable.request(\"originDraggable\");\r\n    *\r\n    * // request\r\n    * // Use Relative Value\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * requester.request({ deltaX: 10, deltaY: 10 });\r\n    * // Use Absolute Value\r\n    * moveable.request(\"originDraggable\", { x: 200, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 220, y: 100 });\r\n    * moveable.request(\"originDraggable\", { x: 240, y: 100 });\r\n    *\r\n    * // requestEnd\r\n    * requester.requestEnd();\r\n    */\r\n    request: function (moveable) {\r\n        var datas = {};\r\n        var rect = moveable.getRect();\r\n        var distX = 0;\r\n        var distY = 0;\r\n        var transformOrigin = rect.transformOrigin;\r\n        var distOrigin = [0, 0];\r\n        return {\r\n            isControl: true,\r\n            requestStart: function () {\r\n                return { datas: datas };\r\n            },\r\n            request: function (e) {\r\n                if (\"deltaOrigin\" in e) {\r\n                    distOrigin[0] += e.deltaOrigin[0];\r\n                    distOrigin[1] += e.deltaOrigin[1];\r\n                }\r\n                else if (\"origin\" in e) {\r\n                    distOrigin[0] = e.origin[0] - transformOrigin[0];\r\n                    distOrigin[1] = e.origin[1] - transformOrigin[1];\r\n                }\r\n                else {\r\n                    if (\"x\" in e) {\r\n                        distX = e.x - rect.left;\r\n                    }\r\n                    else if (\"deltaX\" in e) {\r\n                        distX += e.deltaX;\r\n                    }\r\n                    if (\"y\" in e) {\r\n                        distY = e.y - rect.top;\r\n                    }\r\n                    else if (\"deltaY\" in e) {\r\n                        distY += e.deltaY;\r\n                    }\r\n                }\r\n                return { datas: datas, distX: distX, distY: distY, distOrigin: distOrigin };\r\n            },\r\n            requestEnd: function () {\r\n                return { datas: datas, isDrag: true };\r\n            },\r\n        };\r\n    },\r\n};\r\n/**\r\n * Whether to drag origin (default: false)\r\n * @name Moveable.OriginDraggable#originDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n * });\r\n * let translate = [0, 0];\r\n * moveable.on(\"dragOriginStart\", e => {\r\n *     e.dragStart && e.dragStart.set(translate);\r\n * }).on(\"dragOrigin\", e => {\r\n *     translate = e.drag.beforeTranslate;\r\n *     e.target.style.cssText\r\n *         = `transform-origin: ${e.transformOrigin};`\r\n *         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n * }).on(\"dragOriginEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px (default: true)\r\n * @name Moveable.OriginDraggable#originRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     originDraggable: true,\r\n *     originRelative: false,\r\n * });\r\n * moveable.originRelative = true;\r\n */\r\n/**\r\n* When drag start the origin, the `dragOriginStart` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginStart\r\n* @param {Moveable.OriginDraggable.OnDragOriginStart} - Parameters for the `dragOriginStart` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag the origin, the `dragOrigin` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOrigin\r\n* @param {Moveable.OriginDraggable.OnDragOrigin} - Parameters for the `dragOrigin` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\r\n/**\r\n* When drag end the origin, the `dragOriginEnd` event is called.\r\n* @memberof Moveable.OriginDraggable\r\n* @event dragOriginEnd\r\n* @param {Moveable.OriginDraggable.OnDragOriginEnd} - Parameters for the `dragOriginEnd` event\r\n* @example\r\n* import Moveable from \"moveable\";\r\n*\r\n* const moveable = new Moveable(document.body, {\r\n*     originDraggable: true,\r\n* });\r\n* let translate = [0, 0];\r\n* moveable.on(\"dragOriginStart\", e => {\r\n*     e.dragStart && e.dragStart.set(translate);\r\n* }).on(\"dragOrigin\", e => {\r\n*     translate = e.drag.beforeTranslate;\r\n*     e.target.style.cssText\r\n*         = `transform-origin: ${e.transformOrigin};`\r\n*         + `transform: translate(${translate[0]}px, ${translate[1]}px)`;\r\n* }).on(\"dragOriginEnd\", e => {\r\n*     console.log(e);\r\n* });\r\n*/\n\nfunction addBorderRadiusByLine(controlPoses, lineIndex, distX, distY) {\r\n    // lineIndex\r\n    // 0 top\r\n    // 1 right\r\n    // 2 bottom\r\n    // 3 left\r\n    var horizontalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, horizontal = _a.horizontal;\r\n        return horizontal && !virtual;\r\n    }).length;\r\n    var verticalsLength = controlPoses.filter(function (_a) {\r\n        var virtual = _a.virtual, vertical = _a.vertical;\r\n        return vertical && !virtual;\r\n    }).length;\r\n    var controlIndex = -1;\r\n    //top\r\n    if (lineIndex === 0) {\r\n        if (horizontalsLength === 0) {\r\n            controlIndex = 0;\r\n        }\r\n        else if (horizontalsLength === 1) {\r\n            controlIndex = 1;\r\n        }\r\n    }\r\n    // bottom\r\n    if (lineIndex === 2) {\r\n        if (horizontalsLength <= 2) {\r\n            controlIndex = 2;\r\n        }\r\n        else if (horizontalsLength <= 3) {\r\n            controlIndex = 3;\r\n        }\r\n    }\r\n    // left\r\n    if (lineIndex === 3) {\r\n        if (verticalsLength === 0) {\r\n            controlIndex = 4;\r\n        }\r\n        else if (verticalsLength < 4) {\r\n            controlIndex = 7;\r\n        }\r\n    }\r\n    // right\r\n    if (lineIndex === 1) {\r\n        if (verticalsLength <= 1) {\r\n            controlIndex = 5;\r\n        }\r\n        else if (verticalsLength <= 2) {\r\n            controlIndex = 6;\r\n        }\r\n    }\r\n    if (controlIndex === -1 || !controlPoses[controlIndex].virtual) {\r\n        return;\r\n    }\r\n    var controlPoseInfo = controlPoses[controlIndex];\r\n    addBorderRadius(controlPoses, controlIndex);\r\n    if (controlIndex < 4) {\r\n        controlPoseInfo.pos[0] = distX;\r\n    }\r\n    else {\r\n        controlPoseInfo.pos[1] = distY;\r\n    }\r\n}\r\nfunction addBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(0, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n    else {\r\n        if (controlPoses[0].virtual) {\r\n            controlPoses[0].virtual = false;\r\n        }\r\n        controlPoses.slice(4, index + 1).forEach(function (info) {\r\n            info.virtual = false;\r\n        });\r\n    }\r\n}\r\nfunction removeBorderRadius(controlPoses, index) {\r\n    if (index < 4) {\r\n        controlPoses.slice(index, 4).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n    else {\r\n        controlPoses.slice(index).forEach(function (info) {\r\n            info.virtual = true;\r\n        });\r\n    }\r\n}\r\nfunction getBorderRadius(borderRadius, width, height, minCounts, full) {\r\n    if (minCounts === void 0) { minCounts = [0, 0]; }\r\n    var values = [];\r\n    if (!borderRadius || borderRadius === \"0px\") {\r\n        values = [];\r\n    }\r\n    else {\r\n        values = splitSpace(borderRadius);\r\n    }\r\n    return getRadiusValues(values, width, height, 0, 0, minCounts, full);\r\n}\r\nfunction triggerRoundEvent(moveable, e, dist, delta, nextPoses) {\r\n    var state = moveable.state;\r\n    var width = state.width, height = state.height;\r\n    var _a = getRadiusStyles(nextPoses, moveable.props.roundRelative, width, height), raws = _a.raws, styles = _a.styles, radiusPoses = _a.radiusPoses;\r\n    var _b = splitRadiusPoses(radiusPoses, raws), horizontals = _b.horizontals, verticals = _b.verticals;\r\n    var borderRadius = styles.join(\" \");\r\n    state.borderRadiusState = borderRadius;\r\n    var params = fillParams(moveable, e, __assign({ horizontals: horizontals, verticals: verticals, borderRadius: borderRadius, width: width, height: height, delta: delta, dist: dist }, fillCSSObject({\r\n        borderRadius: borderRadius,\r\n    }, e)));\r\n    triggerEvent(moveable, \"onRound\", params);\r\n    return params;\r\n}\r\nfunction getStyleBorderRadius(moveable) {\r\n    var _a, _b;\r\n    var style = moveable.getState().style;\r\n    var borderRadius = style.borderRadius || \"\";\r\n    if (!borderRadius && moveable.props.groupable) {\r\n        var firstMoveable = moveable.moveables[0];\r\n        var firstTarget = moveable.getTargets()[0];\r\n        if (firstTarget) {\r\n            if ((firstMoveable === null || firstMoveable === void 0 ? void 0 : firstMoveable.props.target) === firstTarget) {\r\n                borderRadius = (_b = (_a = moveable.moveables[0]) === null || _a === void 0 ? void 0 : _a.state.style.borderRadius) !== null && _b !== void 0 ? _b : \"\";\r\n                style.borderRadius = borderRadius;\r\n            }\r\n            else {\r\n                borderRadius = getComputedStyle(firstTarget).borderRadius;\r\n                style.borderRadius = borderRadius;\r\n            }\r\n        }\r\n    }\r\n    return borderRadius;\r\n}\r\n/**\r\n * @namespace Moveable.Roundable\r\n * @description Whether to show and drag or double click border-radius\r\n */\r\nvar Roundable = {\r\n    name: \"roundable\",\r\n    props: [\r\n        \"roundable\",\r\n        \"roundRelative\",\r\n        \"minRoundControls\",\r\n        \"maxRoundControls\",\r\n        \"roundClickable\",\r\n        \"roundPadding\",\r\n        \"isDisplayShadowRoundControls\",\r\n    ],\r\n    events: [\r\n        \"roundStart\",\r\n        \"round\",\r\n        \"roundEnd\",\r\n        \"roundGroupStart\",\r\n        \"roundGroup\",\r\n        \"roundGroupEnd\",\r\n    ],\r\n    css: [\r\n        \".control.border-radius {\\nbackground: #d66;\\ncursor: pointer;\\nz-index: 3;\\n}\",\r\n        \".control.border-radius.vertical {\\nbackground: #d6d;\\nz-index: 2;\\n}\",\r\n        \".control.border-radius.virtual {\\nopacity: 0.5;\\nz-index: 1;\\n}\",\r\n        \":host.round-line-clickable .line.direction {\\ncursor: pointer;\\n}\",\r\n    ],\r\n    className: function (moveable) {\r\n        var roundClickable = moveable.props.roundClickable;\r\n        return roundClickable === true || roundClickable === \"line\" ? prefix(\"round-line-clickable\") : \"\";\r\n    },\r\n    requestStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    requestChildStyle: function () {\r\n        return [\"borderRadius\"];\r\n    },\r\n    render: function (moveable, React) {\r\n        var _a = moveable.getState(), target = _a.target, width = _a.width, height = _a.height, allMatrix = _a.allMatrix, is3d = _a.is3d, left = _a.left, top = _a.top, borderRadiusState = _a.borderRadiusState;\r\n        var _b = moveable.props, _c = _b.minRoundControls, minRoundControls = _c === void 0 ? [0, 0] : _c, _d = _b.maxRoundControls, maxRoundControls = _d === void 0 ? [4, 4] : _d, zoom = _b.zoom, _e = _b.roundPadding, roundPadding = _e === void 0 ? 0 : _e, isDisplayShadowRoundControls = _b.isDisplayShadowRoundControls, groupable = _b.groupable;\r\n        if (!target) {\r\n            return null;\r\n        }\r\n        var borderRadius = borderRadiusState || getStyleBorderRadius(moveable);\r\n        var n = is3d ? 4 : 3;\r\n        var radiusValues = getBorderRadius(borderRadius, width, height, minRoundControls, true);\r\n        if (!radiusValues) {\r\n            return null;\r\n        }\r\n        var verticalCount = 0;\r\n        var horizontalCount = 0;\r\n        var basePos = groupable ? [0, 0] : [left, top];\r\n        return radiusValues.map(function (v, i) {\r\n            var horizontal = v.horizontal;\r\n            var vertical = v.vertical;\r\n            var direction = v.direction || \"\";\r\n            var originalPos = __spreadArray([], __read(v.pos), false);\r\n            horizontalCount += Math.abs(horizontal);\r\n            verticalCount += Math.abs(vertical);\r\n            if (horizontal && direction.indexOf(\"n\") > -1) {\r\n                originalPos[1] -= roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"w\") > -1) {\r\n                originalPos[0] -= roundPadding;\r\n            }\r\n            if (horizontal && direction.indexOf(\"s\") > -1) {\r\n                originalPos[1] += roundPadding;\r\n            }\r\n            if (vertical && direction.indexOf(\"e\") > -1) {\r\n                originalPos[0] += roundPadding;\r\n            }\r\n            var pos = minus(calculatePosition(allMatrix, originalPos, n), basePos);\r\n            var isDisplayVerticalShadow = isDisplayShadowRoundControls\r\n                && isDisplayShadowRoundControls !== \"horizontal\";\r\n            var isDisplay = v.vertical\r\n                ? verticalCount <= maxRoundControls[1] && (isDisplayVerticalShadow || !v.virtual)\r\n                : horizontalCount <= maxRoundControls[0] && (isDisplayShadowRoundControls || !v.virtual);\r\n            return React.createElement(\"div\", { key: \"borderRadiusControl\".concat(i), className: prefix(\"control\", \"border-radius\", v.vertical ? \"vertical\" : \"\", v.virtual ? \"virtual\" : \"\"), \"data-radius-index\": i, style: {\r\n                    display: isDisplay ? \"block\" : \"none\",\r\n                    transform: \"translate(\".concat(pos[0], \"px, \").concat(pos[1], \"px) scale(\").concat(zoom, \")\"),\r\n                } });\r\n        });\r\n    },\r\n    dragControlCondition: function (moveable, e) {\r\n        if (!e.inputEvent || e.isRequest) {\r\n            return false;\r\n        }\r\n        var className = (e.inputEvent.target.getAttribute(\"class\") || \"\");\r\n        return className.indexOf(\"border-radius\") > -1\r\n            || (className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1);\r\n    },\r\n    dragGroupControlCondition: function (moveable, e) {\r\n        return this.dragControlCondition(moveable, e);\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        var inputEvent = e.inputEvent, datas = e.datas;\r\n        var inputTarget = inputEvent.target;\r\n        var className = (inputTarget.getAttribute(\"class\") || \"\");\r\n        var isControl = className.indexOf(\"border-radius\") > -1;\r\n        var isLine = className.indexOf(\"moveable-line\") > -1 && className.indexOf(\"moveable-direction\") > -1;\r\n        var controlIndex = isControl ? parseInt(inputTarget.getAttribute(\"data-radius-index\"), 10) : -1;\r\n        var lineIndex = -1;\r\n        if (isLine) {\r\n            var indexAttr = inputTarget.getAttribute(\"data-line-key\") || \"\";\r\n            if (indexAttr) {\r\n                lineIndex = parseInt(indexAttr.replace(/render-line-/g, \"\"), 10);\r\n                if (isNaN(lineIndex)) {\r\n                    lineIndex = -1;\r\n                }\r\n            }\r\n        }\r\n        if (!isControl && !isLine) {\r\n            return false;\r\n        }\r\n        var params = fillParams(moveable, e, {});\r\n        var result = triggerEvent(moveable, \"onRoundStart\", params);\r\n        if (result === false) {\r\n            return false;\r\n        }\r\n        datas.lineIndex = lineIndex;\r\n        datas.controlIndex = controlIndex;\r\n        datas.isControl = isControl;\r\n        datas.isLine = isLine;\r\n        setDragStart(moveable, e);\r\n        var _a = moveable.props, roundRelative = _a.roundRelative, _b = _a.minRoundControls, minRoundControls = _b === void 0 ? [0, 0] : _b;\r\n        var state = moveable.state;\r\n        var width = state.width, height = state.height;\r\n        datas.isRound = true;\r\n        datas.prevDist = [0, 0];\r\n        var borderRadius = getStyleBorderRadius(moveable);\r\n        var controlPoses = getBorderRadius(borderRadius || \"\", width, height, minRoundControls, true) || [];\r\n        datas.controlPoses = controlPoses;\r\n        state.borderRadiusState = getRadiusStyles(controlPoses, roundRelative, width, height).styles.join(\" \");\r\n        return params;\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        var datas = e.datas;\r\n        var controlPoses = datas.controlPoses;\r\n        if (!datas.isRound || !datas.isControl || !controlPoses.length) {\r\n            return false;\r\n        }\r\n        var index = datas.controlIndex;\r\n        var _a = __read(getDragDist(e), 2), distX = _a[0], distY = _a[1];\r\n        var dist = [distX, distY];\r\n        var delta = minus(dist, datas.prevDist);\r\n        var _b = moveable.props.maxRoundControls, maxRoundControls = _b === void 0 ? [4, 4] : _b;\r\n        var _c = moveable.state, width = _c.width, height = _c.height;\r\n        var selectedControlPose = controlPoses[index];\r\n        var selectedVertical = selectedControlPose.vertical;\r\n        var selectedHorizontal = selectedControlPose.horizontal;\r\n        // 0: [0, 1, 2, 3] maxCount === 1\r\n        // 0: [0, 2] maxCount === 2\r\n        // 1: [1, 3] maxCount === 2\r\n        // 0: [0] maxCount === 3\r\n        // 1: [1, 3] maxCount === 3\r\n        var dists = controlPoses.map(function (pose) {\r\n            var horizontal = pose.horizontal, vertical = pose.vertical;\r\n            var poseDist = [\r\n                horizontal * selectedHorizontal * dist[0],\r\n                vertical * selectedVertical * dist[1],\r\n            ];\r\n            if (horizontal) {\r\n                if (maxRoundControls[0] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[0] < 4 && horizontal !== selectedHorizontal) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            else if (maxRoundControls[1] === 0) {\r\n                poseDist[1] = vertical * selectedHorizontal * dist[0] / width * height;\r\n                return poseDist;\r\n            }\r\n            else if (selectedVertical) {\r\n                if (maxRoundControls[1] === 1) {\r\n                    return poseDist;\r\n                }\r\n                else if (maxRoundControls[1] < 4 && vertical !== selectedVertical) {\r\n                    return poseDist;\r\n                }\r\n            }\r\n            return [0, 0];\r\n        });\r\n        dists[index] = dist;\r\n        var nextPoses = controlPoses.map(function (info, i) {\r\n            return __assign(__assign({}, info), { pos: plus(info.pos, dists[i]) });\r\n        });\r\n        if (index < 4) {\r\n            nextPoses.slice(0, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        else {\r\n            nextPoses.slice(4, index + 1).forEach(function (info) {\r\n                info.virtual = false;\r\n            });\r\n        }\r\n        datas.prevDist = [distX, distY];\r\n        return triggerRoundEvent(moveable, e, dist, delta, nextPoses);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        var state = moveable.state;\r\n        state.borderRadiusState = \"\";\r\n        var datas = e.datas, isDouble = e.isDouble;\r\n        if (!datas.isRound) {\r\n            return false;\r\n        }\r\n        var isControl = datas.isControl, controlIndex = datas.controlIndex, isLine = datas.isLine, lineIndex = datas.lineIndex;\r\n        var controlPoses = datas.controlPoses;\r\n        var length = controlPoses.filter(function (_a) {\r\n            var virtual = _a.virtual;\r\n            return virtual;\r\n        }).length;\r\n        var _a = moveable.props.roundClickable, roundClickable = _a === void 0 ? true : _a;\r\n        if (isDouble && roundClickable) {\r\n            if (isControl && (roundClickable === true || roundClickable === \"control\")) {\r\n                removeBorderRadius(controlPoses, controlIndex);\r\n            }\r\n            else if (isLine && (roundClickable === true || roundClickable === \"line\")) {\r\n                var _b = __read(calculatePointerDist(moveable, e), 2), distX = _b[0], distY = _b[1];\r\n                addBorderRadiusByLine(controlPoses, lineIndex, distX, distY);\r\n            }\r\n            if (length !== controlPoses.filter(function (_a) {\r\n                var virtual = _a.virtual;\r\n                return virtual;\r\n            }).length) {\r\n                triggerRoundEvent(moveable, e, [0, 0], [0, 0], controlPoses);\r\n            }\r\n        }\r\n        var params = fillEndParams(moveable, e, {});\r\n        triggerEvent(moveable, \"onRoundEnd\", params);\r\n        state.borderRadiusState = \"\";\r\n        return params;\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        var result = this.dragControlStart(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupStart\", nextParams);\r\n        return result;\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        var result = this.dragControl(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                    borderRadius: result.borderRadius,\r\n                }, ev));\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        return nextParams;\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        var moveables = moveable.moveables;\r\n        var targets = moveable.props.targets;\r\n        var events = fillChildEvents(moveable, \"roundable\", e);\r\n        catchEvent(moveable, \"onRound\", function (parentEvent) {\r\n            var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                    return __assign(__assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i] }), fillCSSObject({\r\n                        borderRadius: parentEvent.borderRadius,\r\n                    }, ev));\r\n                }) }, parentEvent);\r\n            triggerEvent(moveable, \"onRoundGroup\", nextParams);\r\n        });\r\n        var result = this.dragControlEnd(moveable, e);\r\n        if (!result) {\r\n            return false;\r\n        }\r\n        var nextParams = __assign({ targets: moveable.props.targets, events: events.map(function (ev, i) {\r\n                var _a;\r\n                return __assign(__assign({}, ev), { target: targets[i], moveable: moveables[i], currentTarget: moveables[i], lastEvent: (_a = ev.datas) === null || _a === void 0 ? void 0 : _a.lastEvent });\r\n            }) }, result);\r\n        triggerEvent(moveable, \"onRoundGroupEnd\", nextParams);\r\n        return nextParams;\r\n    },\r\n    unset: function (moveable) {\r\n        moveable.state.borderRadiusState = \"\";\r\n    },\r\n};\r\n/**\r\n * Whether to show and drag or double click border-radius, (default: false)\r\n * @name Moveable.Roundable#roundable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * % Can be used instead of the absolute px\r\n * @name Moveable.Roundable#roundRelative\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * Minimum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [0, 0])\r\n * @name Moveable.Roundable#minRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     minRoundControls: [0, 0],\r\n * });\r\n * moveable.minRoundControls = [1, 0];\r\n */\r\n/**\r\n * Maximum number of round controls. It moves in proportion by control. [horizontal, vertical] (default: [4, 4])\r\n * @name Moveable.Roundable#maxRoundControls\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     maxRoundControls: [4, 4],\r\n * });\r\n * moveable.maxRoundControls = [1, 0];\r\n */\r\n/**\r\n * Whether you can add/delete round controls by double-clicking a line or control.\r\n * @name Moveable.Roundable#roundClickable\r\n * @default true\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n *     roundClickable: true,\r\n * });\r\n * moveable.roundClickable = false;\r\n */\r\n/**\r\n * Whether to show a round control that does not actually exist as a shadow\r\n * @name Moveable.Roundable#isDisplayShadowRoundControls\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     isDisplayShadowRoundControls: false,\r\n * });\r\n * moveable.isDisplayShadowRoundControls = true;\r\n */\r\n/**\r\n * The padding value of the position of the round control\r\n * @name Moveable.Roundable#roundPadding\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundPadding: 0,\r\n * });\r\n * moveable.roundPadding = 15;\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundStart\r\n * @param {Moveable.Roundable.OnRoundStart} - Parameters for the `roundStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `round` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event round\r\n * @param {Moveable.Roundable.OnRound} - Parameters for the `round` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundEnd\r\n * @param {Moveable.Roundable.onRoundEnd} - Parameters for the `roundEnd` event\r\n * @example\r\n  * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     roundable: true,\r\n *     roundRelative: false,\r\n * });\r\n * moveable.on(\"roundStart\", e => {\r\n *     console.log(e);\r\n * }).on(\"round\", e => {\r\n *     e.target.style.borderRadius = e.borderRadius;\r\n * }).on(\"roundEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag start the clip area or controls, the `roundGroupStart` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupStart\r\n * @param {Moveable.Roundable.OnRoundGroupStart} - Parameters for the `roundGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag or double click the border area or controls, the `roundGroup` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroup\r\n * @param {Moveable.Roundable.OnRoundGroup} - Parameters for the `roundGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *   e.events.forEach(ev => {\r\n *       ev.target.style.cssText += ev.cssText;\r\n *   });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\r\n/**\r\n * When drag end the border area or controls, the `roundGroupEnd` event is called.\r\n * @memberof Moveable.Roundable\r\n * @event roundGroupEnd\r\n * @param {Moveable.Roundable.onRoundGroupEnd} - Parameters for the `roundGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     targets: [target1, target2, target3],\r\n *     roundable: true,\r\n * });\r\n * moveable.on(\"roundGroupStart\", e => {\r\n *     console.log(e.targets);\r\n * }).on(\"roundGroup\", e => {\r\n *     e.events.forEach(ev => {\r\n *         ev.target.style.cssText += ev.cssText;\r\n *     });\r\n * }).on(\"roundGroupEnd\", e => {\r\n *     console.log(e);\r\n * });\r\n */\n\nfunction isIdentityMatrix(matrix, is3d) {\r\n    var n = is3d ? 4 : 3;\r\n    var identityMatrix = createIdentityMatrix(n);\r\n    var value = \"matrix\".concat(is3d ? \"3d\" : \"\", \"(\").concat(identityMatrix.join(\",\"), \")\");\r\n    return matrix === value || matrix === \"matrix(1,0,0,1,0,0)\";\r\n}\r\nvar BeforeRenderable = {\r\n    isPinch: true,\r\n    name: \"beforeRenderable\",\r\n    props: [],\r\n    events: [\r\n        \"beforeRenderStart\",\r\n        \"beforeRender\",\r\n        \"beforeRenderEnd\",\r\n        \"beforeRenderGroupStart\",\r\n        \"beforeRenderGroup\",\r\n        \"beforeRenderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    setTransform: function (moveable, e) {\r\n        var _a = moveable.state, is3d = _a.is3d, targetMatrix = _a.targetMatrix, inlineTransform = _a.inlineTransform;\r\n        var cssMatrix = is3d\r\n            ? \"matrix3d(\".concat(targetMatrix.join(\",\"), \")\")\r\n            : \"matrix(\".concat(convertMatrixtoCSS(targetMatrix, true), \")\");\r\n        var startTransform = !inlineTransform || inlineTransform === \"none\" ? cssMatrix : inlineTransform;\r\n        e.datas.startTransforms = isIdentityMatrix(startTransform, is3d) ? [] : splitSpace(startTransform);\r\n    },\r\n    resetStyle: function (e) {\r\n        var datas = e.datas;\r\n        datas.nextStyle = {};\r\n        datas.nextTransforms = e.datas.startTransforms;\r\n        datas.nextTransformAppendedIndexes = [];\r\n    },\r\n    fillDragStartParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            setTransform: function (transform) {\r\n                e.datas.startTransforms = isArray(transform) ? transform : splitSpace(transform);\r\n            },\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        return fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        });\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        this.setTransform(moveable, e);\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRenderStart\", this.fillDragStartParams(moveable, e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n        }\r\n        this.resetStyle(e);\r\n        triggerEvent(moveable, \"onBeforeRender\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        if (!e.datas.startTransforms) {\r\n            this.setTransform(moveable, e);\r\n            this.resetStyle(e);\r\n        }\r\n        triggerEvent(moveable, \"onBeforeRenderEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n        }));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        var _this = this;\r\n        this.dragStart(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.setTransform(childMoveable, childEvent);\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragStartParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            setTransform: function () { },\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        this.drag(moveable, e);\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            _this.resetStyle(childEvent);\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onBeforeRenderGroup\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n            events: params,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n        triggerEvent(moveable, \"onBeforeRenderGroupEnd\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            isDrag: e.isDrag,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n};\n\nvar Renderable = {\r\n    name: \"renderable\",\r\n    props: [],\r\n    events: [\r\n        \"renderStart\",\r\n        \"render\",\r\n        \"renderEnd\",\r\n        \"renderGroupStart\",\r\n        \"renderGroup\",\r\n        \"renderGroupEnd\",\r\n    ],\r\n    dragRelation: \"weak\",\r\n    dragStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n        }));\r\n    },\r\n    drag: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRender\", this.fillDragParams(moveable, e));\r\n    },\r\n    dragAfter: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderEnd\", this.fillDragEndParams(moveable, e));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        triggerEvent(moveable, \"onRenderGroupStart\", fillParams(moveable, e, {\r\n            isPinch: !!e.isPinch,\r\n            targets: moveable.props.targets,\r\n        }));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroup\", fillParams(moveable, e, __assign(__assign({ isPinch: !!e.isPinch, targets: moveable.props.targets, transform: getNextTransformText(e), transformObject: {} }, fillCSSObject(getNextStyle(e))), { events: params })));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var _this = this;\r\n        var events = fillChildEvents(moveable, \"beforeRenderable\", e);\r\n        var moveables = moveable.moveables;\r\n        var params = events.map(function (childEvent, i) {\r\n            var childMoveable = moveables[i];\r\n            return _this.fillDragEndParams(childMoveable, childEvent);\r\n        });\r\n        triggerEvent(moveable, \"onRenderGroupEnd\", fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, targets: moveable.props.targets, events: params, transformObject: {}, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e)))));\r\n    },\r\n    dragControlStart: function (moveable, e) {\r\n        return this.dragStart(moveable, e);\r\n    },\r\n    dragControl: function (moveable, e) {\r\n        return this.drag(moveable, e);\r\n    },\r\n    dragControlAfter: function (moveable, e) {\r\n        return this.dragAfter(moveable, e);\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        return this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlStart: function (moveable, e) {\r\n        return this.dragGroupStart(moveable, e);\r\n    },\r\n    dragGroupControl: function (moveable, e) {\r\n        return this.dragGroup(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        return this.dragGroupEnd(moveable, e);\r\n    },\r\n    fillDragParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n    fillDragEndParams: function (moveable, e) {\r\n        var transformObject = {};\r\n        parse(getNextTransforms(e) || []).forEach(function (matrixInfo) {\r\n            transformObject[matrixInfo.name] = matrixInfo.functionValue;\r\n        });\r\n        return fillParams(moveable, e, __assign({ isPinch: !!e.isPinch, isDrag: e.isDrag, transformObject: transformObject, transform: getNextTransformText(e) }, fillCSSObject(getNextStyle(e))));\r\n    },\r\n};\n\nfunction triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e, requestInstant) {\r\n    // pre setting\r\n    e.clientDistX = e.distX;\r\n    e.clientDistY = e.distY;\r\n    var isStart = eventType === \"Start\";\r\n    var isEnd = eventType === \"End\";\r\n    var isAfter = eventType === \"After\";\r\n    var target = moveable.state.target;\r\n    var isRequest = e.isRequest;\r\n    var isControl = eventAffix.indexOf(\"Control\") > -1;\r\n    if (!target\r\n        || (isStart && isControl && !isRequest && moveable.areaElement === e.inputEvent.target)) {\r\n        return false;\r\n    }\r\n    var ables = __spreadArray([], __read(moveableAbles), false);\r\n    if (isRequest) {\r\n        var requestAble_1 = e.requestAble;\r\n        if (!ables.some(function (able) { return able.name === requestAble_1; })) {\r\n            ables.push.apply(ables, __spreadArray([], __read(moveable.props.ables.filter(function (able) { return able.name === requestAble_1; })), false));\r\n        }\r\n    }\r\n    if (!ables.length || ables.every(function (able) { return able.dragRelation; })) {\r\n        return false;\r\n    }\r\n    // \"drag\" \"Control\" \"After\"\r\n    var inputEvent = e.inputEvent;\r\n    var inputTarget;\r\n    if (isEnd && inputEvent) {\r\n        inputTarget = document.elementFromPoint(e.clientX, e.clientY) || inputEvent.target;\r\n    }\r\n    var isDragStop = false;\r\n    var stop = function () {\r\n        var _a;\r\n        isDragStop = true;\r\n        (_a = e.stop) === null || _a === void 0 ? void 0 : _a.call(e);\r\n    };\r\n    var isFirstStart = isStart && (!moveable.targetGesto || !moveable.controlGesto\r\n        || (!moveable.targetGesto.isFlag() || !moveable.controlGesto.isFlag()));\r\n    if (isFirstStart) {\r\n        moveable.updateRect(eventType, true, false);\r\n    }\r\n    // trigger ables\r\n    var datas = e.datas;\r\n    var gestoType = isControl ? \"controlGesto\" : \"targetGesto\";\r\n    var prevGesto = moveable[gestoType];\r\n    var trigger = function (able, eventName, conditionName) {\r\n        if (!(eventName in able) || prevGesto !== moveable[gestoType]) {\r\n            return false;\r\n        }\r\n        var ableName = able.name;\r\n        var nextDatas = datas[ableName] || (datas[ableName] = {});\r\n        if (isStart) {\r\n            nextDatas.isEventStart = !conditionName\r\n                || !able[conditionName] || able[conditionName](moveable, e);\r\n        }\r\n        if (!nextDatas.isEventStart) {\r\n            return false;\r\n        }\r\n        var result = able[eventName](moveable, __assign(__assign({}, e), { stop: stop, datas: nextDatas, originalDatas: datas, inputTarget: inputTarget }));\r\n        moveable._emitter.off();\r\n        if (isStart && result === false) {\r\n            nextDatas.isEventStart = false;\r\n        }\r\n        return result;\r\n    };\r\n    // unset ables for first drag start\r\n    if (isFirstStart) {\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    // BeforeRenderable\r\n    trigger(BeforeRenderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    var forceEndedCount = 0;\r\n    var updatedCount = 0;\r\n    eventOperations.forEach(function (eventOperation) {\r\n        if (isDragStop) {\r\n            return false;\r\n        }\r\n        var eventName = \"\".concat(eventOperation).concat(eventAffix).concat(eventType);\r\n        var conditionName = \"\".concat(eventOperation).concat(eventAffix, \"Condition\");\r\n        if (eventType === \"\" && !isRequest) {\r\n            // Convert distX, distY\r\n            convertDragDist(moveable.state, e);\r\n        }\r\n        // const isGroup = eventAffix.indexOf(\"Group\") > -1;\r\n        var eventAbles = ables.filter(function (able) { return able[eventName]; });\r\n        eventAbles = eventAbles.filter(function (able, i) {\r\n            return able.name && eventAbles.indexOf(able) === i;\r\n        });\r\n        var results = eventAbles.filter(function (able) { return trigger(able, eventName, conditionName); });\r\n        var isUpdate = results.length;\r\n        // end ables\r\n        if (isDragStop) {\r\n            ++forceEndedCount;\r\n        }\r\n        if (isUpdate) {\r\n            ++updatedCount;\r\n        }\r\n        if (!isDragStop && isStart && eventAbles.length && !isUpdate) {\r\n            forceEndedCount += eventAbles.filter(function (able) {\r\n                var ableName = able.name;\r\n                var nextDatas = datas[ableName];\r\n                if (nextDatas.isEventStart) {\r\n                    if (able.dragRelation === \"strong\") {\r\n                        return false;\r\n                    }\r\n                    // stop drag\r\n                    return true;\r\n                }\r\n                // pre stop drag\r\n                return false;\r\n            }).length ? 1 : 0;\r\n        }\r\n    });\r\n    if (!isAfter || updatedCount) {\r\n        trigger(Renderable, \"drag\".concat(eventAffix).concat(eventType));\r\n    }\r\n    // stop gesto condition\r\n    var isForceEnd = prevGesto !== moveable[gestoType] || forceEndedCount === eventOperations.length;\r\n    if (isEnd || isDragStop || isForceEnd) {\r\n        moveable.state.gestos = {};\r\n        if (moveable.moveables) {\r\n            moveable.moveables.forEach(function (childMoveable) {\r\n                childMoveable.state.gestos = {};\r\n            });\r\n        }\r\n        ables.forEach(function (able) {\r\n            able.unset && able.unset(moveable);\r\n        });\r\n    }\r\n    if (isStart && !isForceEnd && !isRequest && updatedCount && moveable.props.preventDefault) {\r\n        e === null || e === void 0 ? void 0 : e.preventDefault();\r\n    }\r\n    if (moveable.isUnmounted || isForceEnd) {\r\n        return false;\r\n    }\r\n    if ((!isStart && updatedCount && !requestInstant) || isEnd) {\r\n        var flushSync = moveable.props.flushSync || defaultSync;\r\n        flushSync(function () {\r\n            moveable.updateRect(isEnd ? eventType : \"\", true, false);\r\n            moveable.forceUpdate();\r\n        });\r\n    }\r\n    if (!isStart && !isEnd && !isAfter && updatedCount && !requestInstant) {\r\n        triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType + \"After\", e);\r\n    }\r\n    return true;\r\n}\r\nfunction checkMoveableTarget(moveable, isControl) {\r\n    return function (e, target) {\r\n        var _a;\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        var eventTarget = target;\r\n        var areaElement = moveable.areaElement;\r\n        var dragTargetElement = moveable._dragTarget;\r\n        if (!dragTargetElement || (!isControl && ((_a = moveable.controlGesto) === null || _a === void 0 ? void 0 : _a.isFlag()))) {\r\n            return false;\r\n        }\r\n        return eventTarget === dragTargetElement\r\n            || dragTargetElement.contains(eventTarget)\r\n            || eventTarget === areaElement\r\n            || (!moveable.isMoveableElement(eventTarget) && !moveable.controlBox.contains(eventTarget))\r\n            || hasClass(eventTarget, \"moveable-area\")\r\n            || hasClass(eventTarget, \"moveable-padding\")\r\n            || hasClass(eventTarget, \"moveable-edgeDraggable\");\r\n    };\r\n}\r\nfunction getTargetAbleGesto(moveable, moveableTarget, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    var props = moveable.props;\r\n    var dragArea = props.dragArea;\r\n    var target = moveable.state.target;\r\n    var dragTarget = props.dragTarget;\r\n    targets.push(controlBox);\r\n    if (!dragArea || dragTarget) {\r\n        targets.push(moveableTarget);\r\n    }\r\n    if (!dragArea && dragTarget && target && moveableTarget !== target && props.dragTargetSelf) {\r\n        targets.push(target);\r\n    }\r\n    var checkTarget = checkMoveableTarget(moveable);\r\n    return getAbleGesto(moveable, targets, \"targetAbles\", eventAffix, {\r\n        dragStart: checkTarget,\r\n        pinchStart: checkTarget,\r\n    });\r\n}\r\nfunction getControlAbleGesto(moveable, eventAffix) {\r\n    var controlBox = moveable.controlBox;\r\n    var targets = [];\r\n    targets.push(controlBox);\r\n    var checkTarget = checkMoveableTarget(moveable, true);\r\n    var checkControlTarget = function (e, target) {\r\n        if (target === void 0) { target = e.inputEvent.target; }\r\n        if (target === controlBox) {\r\n            return true;\r\n        }\r\n        var result = checkTarget(e, target);\r\n        return !result;\r\n    };\r\n    return getAbleGesto(moveable, targets, \"controlAbles\", eventAffix, {\r\n        dragStart: checkControlTarget,\r\n        pinchStart: checkControlTarget,\r\n    });\r\n}\r\nfunction getAbleGesto(moveable, target, ableType, eventAffix, conditionFunctions) {\r\n    if (conditionFunctions === void 0) { conditionFunctions = {}; }\r\n    var isTargetAbles = ableType === \"targetAbles\";\r\n    var _a = moveable.props, pinchOutside = _a.pinchOutside, pinchThreshold = _a.pinchThreshold, preventClickEventOnDrag = _a.preventClickEventOnDrag, preventClickDefault = _a.preventClickDefault, checkInput = _a.checkInput, dragFocusedInput = _a.dragFocusedInput, _b = _a.preventDefault, preventDefault = _b === void 0 ? true : _b, _c = _a.preventRightClick, preventRightClick = _c === void 0 ? true : _c, _d = _a.preventWheelClick, preventWheelClick = _d === void 0 ? true : _d, dragContaienrOption = _a.dragContainer;\r\n    var dragContainer = getRefTarget(dragContaienrOption, true);\r\n    var options = {\r\n        preventDefault: preventDefault,\r\n        preventRightClick: preventRightClick,\r\n        preventWheelClick: preventWheelClick,\r\n        container: dragContainer || getWindow(moveable.getControlBoxElement()),\r\n        pinchThreshold: pinchThreshold,\r\n        pinchOutside: pinchOutside,\r\n        preventClickEventOnDrag: isTargetAbles ? preventClickEventOnDrag : false,\r\n        preventClickEventOnDragStart: isTargetAbles ? preventClickDefault : false,\r\n        preventClickEventByCondition: isTargetAbles ? null : function (e) {\r\n            return moveable.controlBox.contains(e.target);\r\n        },\r\n        checkInput: isTargetAbles ? checkInput : false,\r\n        dragFocusedInput: dragFocusedInput,\r\n    };\r\n    var gesto = new Gesto(target, options);\r\n    var isControl = eventAffix === \"Control\";\r\n    [\"drag\", \"pinch\"].forEach(function (eventOperation) {\r\n        [\"Start\", \"\", \"End\"].forEach(function (eventType) {\r\n            gesto.on(\"\".concat(eventOperation).concat(eventType), function (e) {\r\n                var _a;\r\n                var eventName = e.eventType;\r\n                var isPinchScheduled = eventOperation === \"drag\" && e.isPinch;\r\n                if (conditionFunctions[eventName] && !conditionFunctions[eventName](e)) {\r\n                    e.stop();\r\n                    return;\r\n                }\r\n                if (isPinchScheduled) {\r\n                    return;\r\n                }\r\n                var eventOperations = eventOperation === \"drag\" ? [eventOperation] : [\"drag\", eventOperation];\r\n                var moveableAbles = __spreadArray([], __read(moveable[ableType]), false);\r\n                var result = triggerAble(moveable, moveableAbles, eventOperations, eventAffix, eventType, e);\r\n                if (!result) {\r\n                    e.stop();\r\n                }\r\n                else if (moveable.props.stopPropagation || (eventType === \"Start\" && isControl)) {\r\n                    (_a = e === null || e === void 0 ? void 0 : e.inputEvent) === null || _a === void 0 ? void 0 : _a.stopPropagation();\r\n                }\r\n            });\r\n        });\r\n    });\r\n    return gesto;\r\n}\n\nvar EventManager = /*#__PURE__*/ (function () {\r\n    function EventManager(target, moveable, eventName) {\r\n        var _this = this;\r\n        this.target = target;\r\n        this.moveable = moveable;\r\n        this.eventName = eventName;\r\n        this.ables = [];\r\n        this._onEvent = function (e) {\r\n            var eventName = _this.eventName;\r\n            var moveable = _this.moveable;\r\n            if (moveable.state.disableNativeEvent) {\r\n                return;\r\n            }\r\n            _this.ables.forEach(function (able) {\r\n                able[eventName](moveable, {\r\n                    inputEvent: e,\r\n                });\r\n            });\r\n        };\r\n        target.addEventListener(eventName.toLowerCase(), this._onEvent);\r\n    }\r\n    EventManager.prototype.setAbles = function (ables) {\r\n        this.ables = ables;\r\n    };\r\n    EventManager.prototype.destroy = function () {\r\n        this.target.removeEventListener(this.eventName.toLowerCase(), this._onEvent);\r\n        this.target = null;\r\n        this.moveable = null;\r\n    };\r\n    return EventManager;\r\n}());\n\nfunction calculateMatrixStack(target, container, rootContainer, isAbsolute3d) {\r\n    var _a;\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var _b = getMatrixStackInfo(target, container), matrixes = _b.matrixes, is3d = _b.is3d, prevTargetMatrix = _b.targetMatrix, transformOrigin = _b.transformOrigin, targetOrigin = _b.targetOrigin, offsetContainer = _b.offsetContainer, hasFixed = _b.hasFixed, containerZoom = _b.zoom; // prevMatrix\r\n    var _c = getCachedMatrixContainerInfo(offsetContainer, rootContainer), rootMatrixes = _c.matrixes, isRoot3d = _c.is3d, offsetRootContainer = _c.offsetContainer, rootZoom = _c.zoom; // prevRootMatrix\r\n    // if (rootContainer === document.body) {\r\n    //     console.log(offsetContainer, rootContainer, rootMatrixes);\r\n    // }\r\n    var isNext3d = isAbsolute3d || isRoot3d || is3d;\r\n    var n = isNext3d ? 4 : 3;\r\n    var isSVGGraphicElement = target.tagName.toLowerCase() !== \"svg\" && \"ownerSVGElement\" in target;\r\n    var targetMatrix = prevTargetMatrix;\r\n    // let allMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let rootMatrix = prevRootMatrix ? convertDimension(prevRootMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    // let beforeMatrix = prevMatrix ? convertDimension(prevMatrix, prevN!, n) : createIdentityMatrix(n);\r\n    var allMatrix = createIdentityMatrix(n);\r\n    var rootMatrix = createIdentityMatrix(n);\r\n    var beforeMatrix = createIdentityMatrix(n);\r\n    var offsetMatrix = createIdentityMatrix(n);\r\n    var length = matrixes.length;\r\n    var nextRootMatrixes = rootMatrixes.map(function (info) {\r\n        return __assign(__assign({}, info), { matrix: info.matrix ? __spreadArray([], __read(info.matrix), false) : undefined });\r\n    }).reverse();\r\n    matrixes.reverse();\r\n    if (!is3d && isNext3d) {\r\n        targetMatrix = convertDimension(targetMatrix, 3, 4);\r\n        convert3DMatrixes(matrixes);\r\n    }\r\n    if (!isRoot3d && isNext3d) {\r\n        convert3DMatrixes(nextRootMatrixes);\r\n    }\r\n    // rootMatrix = (...) -> container -> offset -> absolute -> offset -> absolute(targetMatrix)\r\n    // rootMatrixBeforeOffset = lastOffsetMatrix -> (...) -> container\r\n    // beforeMatrix = (... -> container -> offset -> absolute) -> offset -> absolute(targetMatrix)\r\n    // offsetMatrix = (... -> container -> offset -> absolute -> offset) -> absolute(targetMatrix)\r\n    nextRootMatrixes.forEach(function (info) {\r\n        rootMatrix = multiply(rootMatrix, info.matrix, n);\r\n    });\r\n    var originalRootContainer = rootContainer || getDocumentBody(target);\r\n    var endContainer = ((_a = nextRootMatrixes[0]) === null || _a === void 0 ? void 0 : _a.target)\r\n        || getOffsetInfo(originalRootContainer, originalRootContainer, true).offsetParent;\r\n    var rootMatrixBeforeOffset = nextRootMatrixes.slice(1).reduce(function (matrix, info) {\r\n        return multiply(matrix, info.matrix, n);\r\n    }, createIdentityMatrix(n));\r\n    matrixes.forEach(function (info, i) {\r\n        if (length - 2 === i) {\r\n            // length - 3\r\n            beforeMatrix = allMatrix.slice();\r\n        }\r\n        if (length - 1 === i) {\r\n            // length - 2\r\n            offsetMatrix = allMatrix.slice();\r\n        }\r\n        // calculate for SVGElement\r\n        if (!info.matrix) {\r\n            var nextInfo = matrixes[i + 1];\r\n            var offset = getSVGOffset(info, nextInfo, endContainer, n, multiply(rootMatrixBeforeOffset, allMatrix, n));\r\n            info.matrix = createOriginMatrix(offset, n);\r\n        }\r\n        allMatrix = multiply(allMatrix, info.matrix, n);\r\n    });\r\n    var isMatrix3d = !isSVGGraphicElement && is3d;\r\n    if (!targetMatrix) {\r\n        targetMatrix = createIdentityMatrix(isMatrix3d ? 4 : 3);\r\n    }\r\n    var targetTransform = makeMatrixCSS(isSVGGraphicElement && targetMatrix.length === 16\r\n        ? convertDimension(targetMatrix, 4, 3) : targetMatrix, isMatrix3d);\r\n    var originalRootMatrix = rootMatrix;\r\n    rootMatrix = ignoreDimension(rootMatrix, n, n);\r\n    return {\r\n        hasZoom: containerZoom !== 1 || rootZoom !== 1,\r\n        hasFixed: hasFixed,\r\n        matrixes: matrixes,\r\n        rootMatrix: rootMatrix,\r\n        originalRootMatrix: originalRootMatrix,\r\n        beforeMatrix: beforeMatrix,\r\n        offsetMatrix: offsetMatrix,\r\n        allMatrix: allMatrix,\r\n        targetMatrix: targetMatrix,\r\n        targetTransform: targetTransform,\r\n        inlineTransform: target.style.transform,\r\n        transformOrigin: transformOrigin,\r\n        targetOrigin: targetOrigin,\r\n        is3d: isNext3d,\r\n        offsetContainer: offsetContainer,\r\n        offsetRootContainer: offsetRootContainer,\r\n    };\r\n}\n\nfunction calculateElementInfo(target, container, rootContainer, isAbsolute3d) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    var width = 0;\r\n    var height = 0;\r\n    var rotation = 0;\r\n    var allResult = {};\r\n    var sizes = getSize(target);\r\n    if (target) {\r\n        width = sizes.offsetWidth;\r\n        height = sizes.offsetHeight;\r\n    }\r\n    if (target) {\r\n        var result = calculateMatrixStack(target, container, rootContainer, isAbsolute3d);\r\n        var position = calculateElementPosition(result.allMatrix, result.transformOrigin, width, height);\r\n        allResult = __assign(__assign({}, result), position);\r\n        var rotationPosition = calculateElementPosition(result.allMatrix, [50, 50], 100, 100);\r\n        rotation = getRotationRad([rotationPosition.pos1, rotationPosition.pos2], rotationPosition.direction);\r\n    }\r\n    var n = isAbsolute3d ? 4 : 3;\r\n    return __assign(__assign(__assign({ hasZoom: false, width: width, height: height, rotation: rotation }, sizes), { originalRootMatrix: createIdentityMatrix(n), rootMatrix: createIdentityMatrix(n), beforeMatrix: createIdentityMatrix(n), offsetMatrix: createIdentityMatrix(n), allMatrix: createIdentityMatrix(n), targetMatrix: createIdentityMatrix(n), targetTransform: \"\", inlineTransform: \"\", transformOrigin: [0, 0], targetOrigin: [0, 0], is3d: !!isAbsolute3d, left: 0, top: 0, right: 0, bottom: 0, origin: [0, 0], pos1: [0, 0], pos2: [0, 0], pos3: [0, 0], pos4: [0, 0], direction: 1, hasFixed: false, offsetContainer: null, offsetRootContainer: null, matrixes: [] }), allResult);\r\n}\r\nfunction getElementInfo(target, container, rootContainer) {\r\n    if (rootContainer === void 0) { rootContainer = container; }\r\n    return calculateElementInfo(target, container, rootContainer, true);\r\n}\n\nfunction getMoveableTargetInfo(moveableElement, target, container, parentContainer, rootContainer, requestStyles) {\r\n    if (requestStyles === void 0) { requestStyles = []; }\r\n    var beforeDirection = 1;\r\n    var beforeOrigin = [0, 0];\r\n    var targetClientRect = resetClientRect();\r\n    var moveableClientRect = resetClientRect();\r\n    var containerClientRect = resetClientRect();\r\n    var rootContainerClientRect = resetClientRect();\r\n    var offsetDelta = [0, 0];\r\n    var style = {};\r\n    var result = calculateElementInfo(target, container, rootContainer, true);\r\n    if (target) {\r\n        var getStyle_1 = getCachedStyle(target);\r\n        requestStyles.forEach(function (name) {\r\n            style[name] = getStyle_1(name);\r\n        });\r\n        var n = result.is3d ? 4 : 3;\r\n        var beforePosition = calculateElementPosition(result.offsetMatrix, plus(result.transformOrigin, getOrigin(result.targetMatrix, n)), result.width, result.height);\r\n        beforeDirection = beforePosition.direction;\r\n        beforeOrigin = plus(beforePosition.origin, [beforePosition.left - result.left, beforePosition.top - result.top]);\r\n        rootContainerClientRect = getClientRect(result.offsetRootContainer);\r\n        var offsetContainer = getOffsetInfo(parentContainer, parentContainer, true).offsetParent\r\n            || result.offsetRootContainer;\r\n        if (result.hasZoom) {\r\n            var absoluteTargetPosition = calculateElementPosition(multiply(result.originalRootMatrix, result.allMatrix), result.transformOrigin, result.width, result.height);\r\n            var absoluteContainerPosition = calculateElementPosition(result.originalRootMatrix, getTransformOriginArray(getCachedStyle(offsetContainer)(\"transformOrigin\")).map(function (pos) { return parseFloat(pos); }), offsetContainer.offsetWidth, offsetContainer.offsetHeight);\r\n            targetClientRect = getClientRectByPosition(absoluteTargetPosition, rootContainerClientRect);\r\n            containerClientRect = getClientRectByPosition(absoluteContainerPosition, rootContainerClientRect, offsetContainer, true);\r\n            if (moveableElement) {\r\n                var left = absoluteTargetPosition.left;\r\n                var top_1 = absoluteTargetPosition.top;\r\n                moveableClientRect = getClientRectByPosition({\r\n                    left: left,\r\n                    top: top_1,\r\n                    bottom: top_1,\r\n                    right: top_1,\r\n                }, rootContainerClientRect);\r\n            }\r\n        }\r\n        else {\r\n            targetClientRect = getClientRect(target);\r\n            containerClientRect = getCachedClientRect(offsetContainer);\r\n            if (moveableElement) {\r\n                moveableClientRect = getClientRect(moveableElement);\r\n            }\r\n            var containerClientRectLeft = containerClientRect.left, containerClientRectTop = containerClientRect.top, containterClientLeft = containerClientRect.clientLeft, containerClientTop = containerClientRect.clientTop;\r\n            var clientDelta = [\r\n                targetClientRect.left - containerClientRectLeft,\r\n                targetClientRect.top - containerClientRectTop,\r\n            ];\r\n            offsetDelta = minus(calculateInversePosition(result.rootMatrix, clientDelta, 4), [containterClientLeft + result.left, containerClientTop + result.top]);\r\n        }\r\n    }\r\n    return __assign({ targetClientRect: targetClientRect, containerClientRect: containerClientRect, moveableClientRect: moveableClientRect, rootContainerClientRect: rootContainerClientRect, beforeDirection: beforeDirection, beforeOrigin: beforeOrigin, originalBeforeOrigin: beforeOrigin, target: target, style: style, offsetDelta: offsetDelta }, result);\r\n}\n\nfunction getPersistState(rect) {\r\n    var pos1 = rect.pos1, pos2 = rect.pos2, pos3 = rect.pos3, pos4 = rect.pos4;\r\n    if (!pos1 || !pos2 || !pos3 || !pos4) {\r\n        return null;\r\n    }\r\n    var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n    var posDelta = [minPos.minX, minPos.minY];\r\n    var origin = minus(rect.origin, posDelta);\r\n    pos1 = minus(pos1, posDelta);\r\n    pos2 = minus(pos2, posDelta);\r\n    pos3 = minus(pos3, posDelta);\r\n    pos4 = minus(pos4, posDelta);\r\n    return __assign(__assign({}, rect), { left: rect.left, top: rect.top, posDelta: posDelta, pos1: pos1, pos2: pos2, pos3: pos3, pos4: pos4, origin: origin, beforeOrigin: origin, \r\n        // originalBeforeOrigin: origin,\r\n        isPersisted: true });\r\n}\n\nvar MoveableManager = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableManager, _super);\r\n    function MoveableManager() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.state = __assign({ container: null, gestos: {}, renderLines: [\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n                [[0, 0], [0, 0]],\r\n            ], renderPoses: [[0, 0], [0, 0], [0, 0], [0, 0]], disableNativeEvent: false, posDelta: [0, 0] }, getMoveableTargetInfo(null));\r\n        _this.renderState = {};\r\n        _this.enabledAbles = [];\r\n        _this.targetAbles = [];\r\n        _this.controlAbles = [];\r\n        _this.rotation = 0;\r\n        _this.scale = [1, 1];\r\n        _this.isMoveableMounted = false;\r\n        _this.isUnmounted = false;\r\n        _this.events = {\r\n            \"mouseEnter\": null,\r\n            \"mouseLeave\": null,\r\n        };\r\n        _this._emitter = new EventEmitter();\r\n        _this._prevOriginalDragTarget = null;\r\n        _this._originalDragTarget = null;\r\n        _this._prevDragTarget = null;\r\n        _this._dragTarget = null;\r\n        _this._prevPropTarget = null;\r\n        _this._propTarget = null;\r\n        _this._prevDragArea = false;\r\n        _this._isPropTargetChanged = false;\r\n        _this._hasFirstTarget = false;\r\n        _this._reiszeObserver = null;\r\n        _this._observerId = 0;\r\n        _this._mutationObserver = null;\r\n        _this._rootContainer = null;\r\n        _this._viewContainer = null;\r\n        _this._viewClassNames = [];\r\n        _this._store = {};\r\n        _this.checkUpdateRect = function () {\r\n            if (_this.isDragging()) {\r\n                return;\r\n            }\r\n            var parentMoveable = _this.props.parentMoveable;\r\n            if (parentMoveable) {\r\n                parentMoveable.checkUpdateRect();\r\n                return;\r\n            }\r\n            cancelAnimationFrame(_this._observerId);\r\n            _this._observerId = requestAnimationFrame(function () {\r\n                if (_this.isDragging()) {\r\n                    return;\r\n                }\r\n                _this.updateRect();\r\n            });\r\n        };\r\n        _this._onPreventClick = function (e) {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            // removeEvent(window, \"click\", this._onPreventClick, true);\r\n        };\r\n        return _this;\r\n    }\r\n    MoveableManager.prototype.render = function () {\r\n        var props = this.props;\r\n        var state = this.getState();\r\n        var parentPosition = props.parentPosition, className = props.className, propsTarget = props.target, zoom = props.zoom, cspNonce = props.cspNonce, translateZ = props.translateZ, ControlBoxElement = props.cssStyled, groupable = props.groupable, linePadding = props.linePadding, controlPadding = props.controlPadding;\r\n        this._checkUpdateRootContainer();\r\n        this.checkUpdate();\r\n        this.updateRenderPoses();\r\n        var _a = __read(parentPosition || [0, 0], 2), parentLeft = _a[0], parentTop = _a[1];\r\n        var left = state.left, top = state.top, stateTarget = state.target, direction = state.direction, hasFixed = state.hasFixed, offsetDelta = state.offsetDelta;\r\n        var groupTargets = props.targets;\r\n        var isDragging = this.isDragging();\r\n        var ableAttributes = {};\r\n        this.getEnabledAbles().forEach(function (able) {\r\n            ableAttributes[\"data-able-\".concat(able.name.toLowerCase())] = true;\r\n        });\r\n        var ableClassName = this._getAbleClassName();\r\n        var isDisplay = (groupTargets && groupTargets.length && (stateTarget || groupable))\r\n            || propsTarget\r\n            || (!this._hasFirstTarget && this.state.isPersisted);\r\n        var isVisible = this.controlBox || this.props.firstRenderState || this.props.persistData;\r\n        var translate = [left - parentLeft, top - parentTop];\r\n        if (!groupable && props.useAccuratePosition) {\r\n            translate[0] += offsetDelta[0];\r\n            translate[1] += offsetDelta[1];\r\n        }\r\n        var style = {\r\n            \"position\": hasFixed ? \"fixed\" : \"absolute\",\r\n            \"display\": isDisplay ? \"block\" : \"none\",\r\n            \"visibility\": isVisible ? \"visible\" : \"hidden\",\r\n            \"transform\": \"translate3d(\".concat(translate[0], \"px, \").concat(translate[1], \"px, \").concat(translateZ, \")\"),\r\n            \"--zoom\": zoom,\r\n            \"--zoompx\": \"\".concat(zoom, \"px\"),\r\n        };\r\n        if (linePadding) {\r\n            style[\"--moveable-line-padding\"] = linePadding;\r\n        }\r\n        if (controlPadding) {\r\n            style[\"--moveable-control-padding\"] = controlPadding;\r\n        }\r\n        return (React.createElement(ControlBoxElement, __assign({ cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: \"\".concat(prefix(\"control-box\", direction === -1 ? \"reverse\" : \"\", isDragging ? \"dragging\" : \"\"), \" \").concat(ableClassName, \" \").concat(className) }, ableAttributes, { onClick: this._onPreventClick, style: style }),\r\n            this.renderAbles(),\r\n            this._renderLines()));\r\n    };\r\n    MoveableManager.prototype.componentDidMount = function () {\r\n        this.isMoveableMounted = true;\r\n        this.isUnmounted = false;\r\n        var props = this.props;\r\n        var parentMoveable = props.parentMoveable, container = props.container;\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateTargets();\r\n        this._updateNativeEvents();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(this.props);\r\n        if (!container && !parentMoveable && !this.state.isPersisted) {\r\n            this.updateRect(\"\", false, false);\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    MoveableManager.prototype.componentDidUpdate = function (prevProps) {\r\n        this._checkUpdateRootContainer();\r\n        this._checkUpdateViewContainer();\r\n        this._updateNativeEvents();\r\n        this._updateTargets();\r\n        this._updateEvents();\r\n        this.updateCheckInput();\r\n        this._updateObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype.componentWillUnmount = function () {\r\n        var _a, _b;\r\n        this.isMoveableMounted = false;\r\n        this.isUnmounted = true;\r\n        this._emitter.off();\r\n        (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n        (_b = this._mutationObserver) === null || _b === void 0 ? void 0 : _b.disconnect();\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames([]);\r\n        }\r\n        unsetGesto(this, false);\r\n        unsetGesto(this, true);\r\n        var events = this.events;\r\n        for (var name_1 in events) {\r\n            var manager = events[name_1];\r\n            manager && manager.destroy();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getTargets = function () {\r\n        var target = this.props.target;\r\n        return target ? [target] : [];\r\n    };\r\n    /**\r\n     * Get the able used in MoveableManager.\r\n     * @method Moveable#getAble\r\n     * @param - able name\r\n     */\r\n    MoveableManager.prototype.getAble = function (ableName) {\r\n        var ables = this.props.ables || [];\r\n        return find(ables, function (able) { return able.name === ableName; });\r\n    };\r\n    MoveableManager.prototype.getContainer = function () {\r\n        var _a = this.props, parentMoveable = _a.parentMoveable, wrapperMoveable = _a.wrapperMoveable, container = _a.container;\r\n        return container\r\n            || (wrapperMoveable && wrapperMoveable.getContainer())\r\n            || (parentMoveable && parentMoveable.getContainer())\r\n            || this.controlBox.parentElement;\r\n    };\r\n    /**\r\n     * Returns the element of the control box.\r\n     * @method Moveable#getControlBoxElement\r\n     */\r\n    MoveableManager.prototype.getControlBoxElement = function () {\r\n        return this.controlBox;\r\n    };\r\n    /**\r\n     * Target element to be dragged in moveable\r\n     * @method Moveable#getDragElement\r\n     */\r\n    MoveableManager.prototype.getDragElement = function () {\r\n        return this._dragTarget;\r\n    };\r\n    /**\r\n     * Check if the target is an element included in the moveable.\r\n     * @method Moveable#isMoveableElement\r\n     * @param - the target\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"click\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *         moveable.target = e.target;\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isMoveableElement = function (target) {\r\n        var _a;\r\n        return target && (((_a = target.getAttribute) === null || _a === void 0 ? void 0 : _a.call(target, \"class\")) || \"\").indexOf(PREFIX) > -1;\r\n    };\r\n    /**\r\n     * You can drag start the Moveable through the external `MouseEvent`or `TouchEvent`. (Angular: ngDragStart)\r\n     * @method Moveable#dragStart\r\n     * @param - external `MouseEvent`or `TouchEvent`\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (!moveable.isMoveableElement(e.target)) {\r\n     *          moveable.dragStart(e);\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto && checkMoveableTarget(this)({ inputEvent: e }, target)) {\r\n            if (!targetGesto.isFlag()) {\r\n                targetGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        else if (controlGesto && this.isMoveableElement(target)) {\r\n            if (!controlGesto.isFlag()) {\r\n                controlGesto.triggerDragStart(e);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * Hit test an element or rect on a moveable target.\r\n     * (100% = 100)\r\n     * @method Moveable#hitTest\r\n     * @param - element or rect to test\r\n     * @return - Get hit test rate (rate > 0 is hitted)\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.hitTest(e.target) > 0) {\r\n     *          console.log(\"hiited\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.hitTest = function (el) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return 0;\r\n        }\r\n        var rect;\r\n        if (isNode(el)) {\r\n            var clientRect = el.getBoundingClientRect();\r\n            rect = {\r\n                left: clientRect.left,\r\n                top: clientRect.top,\r\n                width: clientRect.width,\r\n                height: clientRect.height,\r\n            };\r\n        }\r\n        else {\r\n            rect = __assign({ width: 0, height: 0 }, el);\r\n        }\r\n        var rectLeft = rect.left, rectTop = rect.top, rectWidth = rect.width, rectHeight = rect.height;\r\n        var points = fitPoints([pos1, pos2, pos4, pos3], targetClientRect);\r\n        var size = getOverlapSize(points, [\r\n            [rectLeft, rectTop],\r\n            [rectLeft + rectWidth, rectTop],\r\n            [rectLeft + rectWidth, rectTop + rectHeight],\r\n            [rectLeft, rectTop + rectHeight],\r\n        ]);\r\n        var totalSize = getAreaSize(points);\r\n        if (!size || !totalSize) {\r\n            return 0;\r\n        }\r\n        return Math.min(100, size / totalSize * 100);\r\n    };\r\n    /**\r\n     * Whether the coordinates are inside Moveable\r\n     * @method Moveable#isInside\r\n     * @param - x coordinate\r\n     * @param - y coordinate\r\n     * @return - True if the coordinate is in moveable or false\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * document.body.addEventListener(\"mousedown\", e => {\r\n     *     if (moveable.isInside(e.clientX, e.clientY)) {\r\n     *          console.log(\"inside\");\r\n     *     }\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isInside = function (clientX, clientY) {\r\n        var _a = this.state, target = _a.target, pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4, targetClientRect = _a.targetClientRect;\r\n        if (!target) {\r\n            return false;\r\n        }\r\n        return isInside([clientX, clientY], fitPoints([pos1, pos2, pos4, pos3], targetClientRect));\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of all elements change, update the shape of the moveable.\r\n     * @method Moveable#updateRect\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * window.addEventListener(\"resize\", e => {\r\n     *     moveable.updateRect();\r\n     * });\r\n     */\r\n    MoveableManager.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var props = this.props;\r\n        var isSingle = !props.parentPosition && !props.wrapperMoveable;\r\n        if (isSingle) {\r\n            setStoreCache(true);\r\n        }\r\n        var parentMoveable = props.parentMoveable;\r\n        var state = this.state;\r\n        var target = (state.target || props.target);\r\n        var container = this.getContainer();\r\n        var rootContainer = parentMoveable\r\n            ? parentMoveable._rootContainer\r\n            : this._rootContainer;\r\n        var nextState = getMoveableTargetInfo(this.controlBox, target, container, container, rootContainer || container, this._getRequestStyles());\r\n        if (!target && this._hasFirstTarget && props.persistData) {\r\n            var persistState = getPersistState(props.persistData);\r\n            for (var name_2 in persistState) {\r\n                nextState[name_2] = persistState[name_2];\r\n            }\r\n        }\r\n        if (isSingle) {\r\n            setStoreCache();\r\n        }\r\n        this.updateState(nextState, parentMoveable ? false : isSetState);\r\n    };\r\n    /**\r\n     * Check if the moveable state is being dragged.\r\n     * @method Moveable#isDragging\r\n     * @param - If you want to check if able is dragging, specify ableName.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // false\r\n     * console.log(moveable.isDragging());\r\n     *\r\n     * moveable.on(\"drag\", () => {\r\n     *   // true\r\n     *   console.log(moveable.isDragging());\r\n     * });\r\n     */\r\n    MoveableManager.prototype.isDragging = function (ableName) {\r\n        var _a, _b;\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        if (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = targetGesto.getEventData();\r\n            return !!((_a = data[ableName]) === null || _a === void 0 ? void 0 : _a.isEventStart);\r\n        }\r\n        if (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag()) {\r\n            if (!ableName) {\r\n                return true;\r\n            }\r\n            var data = controlGesto.getEventData();\r\n            return !!((_b = data[ableName]) === null || _b === void 0 ? void 0 : _b.isEventStart);\r\n        }\r\n        return false;\r\n    };\r\n    /**\r\n     * If the width, height, left, and top of the only target change, update the shape of the moveable.\r\n     * Use `.updateRect()` method\r\n     * @method Moveable#updateTarget\r\n     * @deprecated\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.updateTarget();\r\n     */\r\n    MoveableManager.prototype.updateTarget = function (type) {\r\n        this.updateRect(type, true);\r\n    };\r\n    /**\r\n     * You can get the vertex information, position and offset size information of the target based on the container.\r\n     * @method Moveable#getRect\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const rectInfo = moveable.getRect();\r\n     */\r\n    MoveableManager.prototype.getRect = function () {\r\n        var state = this.state;\r\n        var poses = getAbsolutePosesByState(this.state);\r\n        var _a = __read(poses, 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        var rect = getRect(poses);\r\n        var offsetWidth = state.width, offsetHeight = state.height;\r\n        var width = rect.width, height = rect.height, left = rect.left, top = rect.top;\r\n        var statePos = [state.left, state.top];\r\n        var origin = plus(statePos, state.origin);\r\n        var beforeOrigin = plus(statePos, state.beforeOrigin);\r\n        var transformOrigin = state.transformOrigin;\r\n        return {\r\n            width: width,\r\n            height: height,\r\n            left: left,\r\n            top: top,\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            offsetWidth: offsetWidth,\r\n            offsetHeight: offsetHeight,\r\n            beforeOrigin: beforeOrigin,\r\n            origin: origin,\r\n            transformOrigin: transformOrigin,\r\n            rotation: this.getRotation(),\r\n        };\r\n    };\r\n    /**\r\n     * Get a manager that manages the moveable's state and props.\r\n     * @method Moveable#getManager\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * const manager = moveable.getManager(); // real moveable class instance\r\n     */\r\n    MoveableManager.prototype.getManager = function () {\r\n        return this;\r\n    };\r\n    /**\r\n     * You can stop the dragging currently in progress through a method from outside.\r\n     * @method Moveable#stopDrag\r\n     * @return - The Rect Info\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.stopDrag();\r\n     */\r\n    MoveableManager.prototype.stopDrag = function (type) {\r\n        if (!type || type === \"target\") {\r\n            var gesto = this.targetGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, false);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n        if (!type || type === \"control\") {\r\n            var gesto = this.controlGesto;\r\n            if ((gesto === null || gesto === void 0 ? void 0 : gesto.isIdle()) === false) {\r\n                unsetAbles(this, true);\r\n            }\r\n            gesto === null || gesto === void 0 ? void 0 : gesto.stop();\r\n        }\r\n    };\r\n    MoveableManager.prototype.getRotation = function () {\r\n        var _a = this.state, pos1 = _a.pos1, pos2 = _a.pos2, direction = _a.direction;\r\n        return getAbsoluteRotation(pos1, pos2, direction);\r\n    };\r\n    /**\r\n     * Request able through a method rather than an event.\r\n     * At the moment of execution, requestStart is executed,\r\n     * and then request and requestEnd can be executed through Requester.\r\n     * @method Moveable#request\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Draggable.html#request|Draggable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Resizable.html#request|Resizable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Scalable.html#request|Scalable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.Rotatable.html#request|Rotatable Requester}\r\n     * @see {@link https://daybrush.com/moveable/release/latest/doc/Moveable.OriginDraggable.html#request|OriginDraggable Requester}\r\n     * @param - ableName\r\n     * @param - request to be able params.\r\n     * @param - If isInstant is true, request and requestEnd are executed immediately.\r\n     * @return - Able Requester. If there is no request in able, nothing will work.\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * // Instantly Request (requestStart - request - requestEnd)\r\n     * moveable.request(\"draggable\", { deltaX: 10, deltaY: 10 }, true);\r\n     *\r\n     * // Start move\r\n     * const requester = moveable.request(\"draggable\");\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.request({ deltaX: 10, deltaY: 10 });\r\n     * requester.requestEnd();\r\n     */\r\n    MoveableManager.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var self = this;\r\n        var props = self.props;\r\n        var manager = props.parentMoveable || props.wrapperMoveable || self;\r\n        var allAbles = manager.props.ables;\r\n        var groupable = props.groupable;\r\n        var requsetAble = find(allAbles, function (able) { return able.name === ableName; });\r\n        if (this.isDragging() || !requsetAble || !requsetAble.request) {\r\n            return {\r\n                request: function () {\r\n                    return this;\r\n                },\r\n                requestEnd: function () {\r\n                    return this;\r\n                },\r\n            };\r\n        }\r\n        var ableRequester = requsetAble.request(self);\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var ableType = ableRequester.isControl ? \"controlAbles\" : \"targetAbles\";\r\n        var eventAffix = \"\".concat((groupable ? \"Group\" : \"\")).concat(ableRequester.isControl ? \"Control\" : \"\");\r\n        var moveableAbles = __spreadArray([], __read(manager[ableType]), false);\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"\", __assign(__assign({}, ableRequester.request(ableParam)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n            requestEnd: function () {\r\n                triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"End\", __assign(__assign({}, ableRequester.requestEnd()), { requestAble: ableName, isRequest: true }), requestInstant);\r\n                return requester;\r\n            },\r\n        };\r\n        triggerAble(self, moveableAbles, [\"drag\"], eventAffix, \"Start\", __assign(__assign({}, ableRequester.requestStart(param)), { requestAble: ableName, isRequest: true }), requestInstant);\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    /**\r\n     * moveable is the top level that manages targets\r\n     * `Single`: MoveableManager instance\r\n     * `Group`: MoveableGroup instance\r\n     * `IndividualGroup`: MoveableIndividaulGroup instance\r\n     * Returns leaf target MoveableManagers.\r\n     */\r\n    MoveableManager.prototype.getMoveables = function () {\r\n        return [this];\r\n    };\r\n    /**\r\n     * Remove the Moveable object and the events.\r\n     * @method Moveable#destroy\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body);\r\n     *\r\n     * moveable.destroy();\r\n     */\r\n    MoveableManager.prototype.destroy = function () {\r\n        this.componentWillUnmount();\r\n    };\r\n    MoveableManager.prototype.updateRenderPoses = function () {\r\n        var state = this.getState();\r\n        var props = this.props;\r\n        var padding = props.padding;\r\n        var originalBeforeOrigin = state.originalBeforeOrigin, transformOrigin = state.transformOrigin, allMatrix = state.allMatrix, is3d = state.is3d, pos1 = state.pos1, pos2 = state.pos2, pos3 = state.pos3, pos4 = state.pos4, stateLeft = state.left, stateTop = state.top, isPersisted = state.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        if (!padding && zoom <= 1) {\r\n            state.renderPoses = [\r\n                pos1,\r\n                pos2,\r\n                pos3,\r\n                pos4,\r\n            ];\r\n            state.renderLines = [\r\n                [pos1, pos2],\r\n                [pos2, pos4],\r\n                [pos4, pos3],\r\n                [pos3, pos1],\r\n            ];\r\n            return;\r\n        }\r\n        var _a = getPaddingBox(padding || {}), left = _a.left, top = _a.top, bottom = _a.bottom, right = _a.right;\r\n        var n = is3d ? 4 : 3;\r\n        // const clipPathInfo = getClipPath(\r\n        //     props.target,\r\n        //     offsetWidth,\r\n        //     offsetHeight,\r\n        // );\r\n        // if (clipPathInfo) {\r\n        //     left -= Math.max(0, clipPathInfo.left);\r\n        //     top -= Math.max(0, clipPathInfo.top);\r\n        //     bottom -= Math.max(0, offsetHeight - clipPathInfo.bottom);\r\n        //     right -= Math.max(0, offsetWidth - clipPathInfo.right);\r\n        // }\r\n        var absoluteOrigin = [];\r\n        if (isPersisted) {\r\n            absoluteOrigin = transformOrigin;\r\n        }\r\n        else if (this.controlBox && props.groupable) {\r\n            absoluteOrigin = originalBeforeOrigin;\r\n        }\r\n        else {\r\n            absoluteOrigin = plus(originalBeforeOrigin, [stateLeft, stateTop]);\r\n        }\r\n        var nextMatrix = multiplies(n, createOriginMatrix(absoluteOrigin.map(function (v) { return -v; }), n), allMatrix, createOriginMatrix(transformOrigin, n));\r\n        var renderPos1 = calculatePadding(nextMatrix, pos1, [-left, -top], n);\r\n        var renderPos2 = calculatePadding(nextMatrix, pos2, [right, -top], n);\r\n        var renderPos3 = calculatePadding(nextMatrix, pos3, [-left, bottom], n);\r\n        var renderPos4 = calculatePadding(nextMatrix, pos4, [right, bottom], n);\r\n        state.renderPoses = [\r\n            renderPos1,\r\n            renderPos2,\r\n            renderPos3,\r\n            renderPos4,\r\n        ];\r\n        state.renderLines = [\r\n            [renderPos1, renderPos2],\r\n            [renderPos2, renderPos4],\r\n            [renderPos4, renderPos3],\r\n            [renderPos3, renderPos1],\r\n        ];\r\n        if (zoom) {\r\n            var zoomOffset = zoom / 2;\r\n            state.renderLines = [\r\n                [\r\n                    calculatePadding(nextMatrix, pos1, [-left - zoomOffset, -top], n),\r\n                    calculatePadding(nextMatrix, pos2, [right + zoomOffset, -top], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos2, [right, -top - zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos4, [right, bottom + zoomOffset], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos4, [right + zoomOffset, bottom], n),\r\n                    calculatePadding(nextMatrix, pos3, [-left - zoomOffset, bottom], n),\r\n                ],\r\n                [\r\n                    calculatePadding(nextMatrix, pos3, [-left, bottom + zoomOffset], n),\r\n                    calculatePadding(nextMatrix, pos1, [-left, -top - zoomOffset], n),\r\n                ],\r\n            ];\r\n        }\r\n    };\r\n    MoveableManager.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        var _a = this.props, target = _a.target, container = _a.container, parentMoveable = _a.parentMoveable;\r\n        var _b = this.state, stateTarget = _b.target, stateContainer = _b.container;\r\n        if (!stateTarget && !target) {\r\n            return;\r\n        }\r\n        this.updateAbles();\r\n        var isTargetChanged = !equals(stateTarget, target);\r\n        var isChanged = isTargetChanged || !equals(stateContainer, container);\r\n        if (!isChanged) {\r\n            return;\r\n        }\r\n        var moveableContainer = container || this.controlBox;\r\n        if (moveableContainer) {\r\n            this.unsetAbles();\r\n        }\r\n        this.updateState({ target: target, container: container });\r\n        if (!parentMoveable && moveableContainer) {\r\n            this.updateRect(\"End\", false, false);\r\n        }\r\n        this._isPropTargetChanged = isTargetChanged;\r\n    };\r\n    MoveableManager.prototype.waitToChangeTarget = function () {\r\n        return new Promise(function () { });\r\n    };\r\n    MoveableManager.prototype.triggerEvent = function (name, e) {\r\n        var props = this.props;\r\n        this._emitter.trigger(name, e);\r\n        if (props.parentMoveable && e.isRequest && !e.isRequestChild) {\r\n            return props.parentMoveable.triggerEvent(name, e, true);\r\n        }\r\n        var callback = props[name];\r\n        return callback && callback(e);\r\n    };\r\n    MoveableManager.prototype.useCSS = function (tag, css) {\r\n        var customStyleMap = this.props.customStyledMap;\r\n        var key = tag + css;\r\n        if (!customStyleMap[key]) {\r\n            customStyleMap[key] = styled(tag, css);\r\n        }\r\n        return customStyleMap[key];\r\n    };\r\n    MoveableManager.prototype.getState = function () {\r\n        var _a;\r\n        var props = this.props;\r\n        if (props.target || ((_a = props.targets) === null || _a === void 0 ? void 0 : _a.length)) {\r\n            this._hasFirstTarget = true;\r\n        }\r\n        var hasControlBox = this.controlBox;\r\n        var persistData = props.persistData;\r\n        var firstRenderState = props.firstRenderState;\r\n        if (firstRenderState && !hasControlBox) {\r\n            return firstRenderState;\r\n        }\r\n        if (!this._hasFirstTarget && persistData) {\r\n            var persistState = getPersistState(persistData);\r\n            if (persistState) {\r\n                this.updateState(persistState, false);\r\n                return this.state;\r\n            }\r\n        }\r\n        this.state.isPersisted = false;\r\n        return this.state;\r\n    };\r\n    MoveableManager.prototype.updateSelectors = function () { };\r\n    MoveableManager.prototype.unsetAbles = function () {\r\n        var _this = this;\r\n        this.targetAbles.forEach(function (able) {\r\n            if (able.unset) {\r\n                able.unset(_this);\r\n            }\r\n        });\r\n    };\r\n    MoveableManager.prototype.updateAbles = function (ables, eventAffix) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        if (eventAffix === void 0) { eventAffix = \"\"; }\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var enabledAbles = this.getEnabledAbles(ables);\r\n        var dragStart = \"drag\".concat(eventAffix, \"Start\");\r\n        var pinchStart = \"pinch\".concat(eventAffix, \"Start\");\r\n        var dragControlStart = \"drag\".concat(eventAffix, \"ControlStart\");\r\n        var targetAbles = filterAbles(enabledAbles, [dragStart, pinchStart], triggerAblesSimultaneously);\r\n        var controlAbles = filterAbles(enabledAbles, [dragControlStart], triggerAblesSimultaneously);\r\n        this.enabledAbles = enabledAbles;\r\n        this.targetAbles = targetAbles;\r\n        this.controlAbles = controlAbles;\r\n    };\r\n    MoveableManager.prototype.updateState = function (nextState, isSetState) {\r\n        if (isSetState) {\r\n            if (this.isUnmounted) {\r\n                return;\r\n            }\r\n            this.setState(nextState);\r\n        }\r\n        else {\r\n            var state = this.state;\r\n            for (var name_3 in nextState) {\r\n                state[name_3] = nextState[name_3];\r\n            }\r\n        }\r\n    };\r\n    MoveableManager.prototype.getEnabledAbles = function (ables) {\r\n        if (ables === void 0) { ables = this.props.ables; }\r\n        var props = this.props;\r\n        return ables.filter(function (able) { return able && ((able.always && props[able.name] !== false)\r\n            || props[able.name]); });\r\n    };\r\n    MoveableManager.prototype.renderAbles = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var triggerAblesSimultaneously = props.triggerAblesSimultaneously;\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        this.renderState = {};\r\n        return groupByMap(flat(filterAbles(this.getEnabledAbles(), [\"render\"], triggerAblesSimultaneously).map(function (_a) {\r\n            var render = _a.render;\r\n            return render(_this, Renderer) || [];\r\n        })).filter(function (el) { return el; }), function (_a) {\r\n            var key = _a.key;\r\n            return key;\r\n        }).map(function (group) { return group[0]; });\r\n    };\r\n    MoveableManager.prototype.updateCheckInput = function () {\r\n        this.targetGesto && (this.targetGesto.options.checkInput = this.props.checkInput);\r\n    };\r\n    MoveableManager.prototype._getRequestStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, __spreadArray([], __read((this.props.requestStyles || [])), false));\r\n        return styleNames;\r\n    };\r\n    MoveableManager.prototype._updateObserver = function (prevProps) {\r\n        this._updateResizeObserver(prevProps);\r\n        this._updateMutationObserver(prevProps);\r\n    };\r\n    MoveableManager.prototype._updateEvents = function () {\r\n        var hasTargetAble = this.targetAbles.length;\r\n        var hasControlAble = this.controlAbles.length;\r\n        var target = this._dragTarget;\r\n        var isUnset = (!hasTargetAble && this.targetGesto)\r\n            || this._isTargetChanged(true);\r\n        if (isUnset) {\r\n            unsetGesto(this, false);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (!hasControlAble) {\r\n            unsetGesto(this, true);\r\n        }\r\n        if (target && hasTargetAble && !this.targetGesto) {\r\n            this.targetGesto = getTargetAbleGesto(this, target, \"\");\r\n        }\r\n        if (!this.controlGesto && hasControlAble) {\r\n            this.controlGesto = getControlAbleGesto(this, \"Control\");\r\n        }\r\n    };\r\n    MoveableManager.prototype._updateTargets = function () {\r\n        var props = this.props;\r\n        this._prevPropTarget = this._propTarget;\r\n        this._prevDragTarget = this._dragTarget;\r\n        this._prevOriginalDragTarget = this._originalDragTarget;\r\n        this._prevDragArea = props.dragArea;\r\n        this._propTarget = props.target;\r\n        this._originalDragTarget = props.dragTarget || props.target;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableManager.prototype._renderLines = function () {\r\n        var props = this.props;\r\n        var _a = props, zoom = _a.zoom, hideDefaultLines = _a.hideDefaultLines, hideChildMoveableDefaultLines = _a.hideChildMoveableDefaultLines, parentMoveable = _a.parentMoveable;\r\n        if (hideDefaultLines || (parentMoveable && hideChildMoveableDefaultLines)) {\r\n            return [];\r\n        }\r\n        var state = this.getState();\r\n        var Renderer = {\r\n            createElement: createElement,\r\n        };\r\n        return state.renderLines.map(function (line, i) {\r\n            return renderLine(Renderer, \"\", line[0], line[1], zoom, \"render-line-\".concat(i));\r\n        });\r\n    };\r\n    MoveableManager.prototype._isTargetChanged = function (useDragArea) {\r\n        var props = this.props;\r\n        var nextTarget = props.dragTarget || props.target;\r\n        var prevTarget = this._prevOriginalDragTarget;\r\n        var prevDragArea = this._prevDragArea;\r\n        var dragArea = props.dragArea;\r\n        // check target without dragArea\r\n        var isDragTargetChanged = !dragArea && prevTarget !== nextTarget;\r\n        var isDragAreaChanged = (useDragArea || dragArea) && prevDragArea !== dragArea;\r\n        return isDragTargetChanged || isDragAreaChanged || this._prevPropTarget != this._propTarget;\r\n    };\r\n    MoveableManager.prototype._updateNativeEvents = function () {\r\n        var _this = this;\r\n        var props = this.props;\r\n        var target = props.dragArea ? this.areaElement : this.state.target;\r\n        var events = this.events;\r\n        var eventKeys = getKeys(events);\r\n        if (this._isTargetChanged()) {\r\n            for (var eventName in events) {\r\n                var manager = events[eventName];\r\n                manager && manager.destroy();\r\n                events[eventName] = null;\r\n            }\r\n        }\r\n        if (!target) {\r\n            return;\r\n        }\r\n        var enabledAbles = this.enabledAbles;\r\n        eventKeys.forEach(function (eventName) {\r\n            var ables = filterAbles(enabledAbles, [eventName]);\r\n            var hasAbles = ables.length > 0;\r\n            var manager = events[eventName];\r\n            if (!hasAbles) {\r\n                if (manager) {\r\n                    manager.destroy();\r\n                    events[eventName] = null;\r\n                }\r\n                return;\r\n            }\r\n            if (!manager) {\r\n                manager = new EventManager(target, _this, eventName);\r\n                events[eventName] = manager;\r\n            }\r\n            manager.setAbles(ables);\r\n        });\r\n    };\r\n    MoveableManager.prototype._checkUpdateRootContainer = function () {\r\n        var rootContainer = this.props.rootContainer;\r\n        if (!this._rootContainer && rootContainer) {\r\n            this._rootContainer = getRefTarget(rootContainer, true);\r\n        }\r\n    };\r\n    MoveableManager.prototype._checkUpdateViewContainer = function () {\r\n        var viewContainerOption = this.props.viewContainer;\r\n        if (!this._viewContainer && viewContainerOption) {\r\n            this._viewContainer = getRefTarget(viewContainerOption, true);\r\n        }\r\n        var viewContainer = this._viewContainer;\r\n        if (viewContainer) {\r\n            this._changeAbleViewClassNames(__spreadArray(__spreadArray([], __read(this._getAbleViewClassNames()), false), [\r\n                this.isDragging() ? VIEW_DRAGGING : \"\",\r\n            ], false));\r\n        }\r\n    };\r\n    MoveableManager.prototype._changeAbleViewClassNames = function (classNames) {\r\n        var viewContainer = this._viewContainer;\r\n        var nextClassNames = groupBy(classNames.filter(Boolean), function (el) { return el; }).map(function (_a) {\r\n            var _b = __read(_a, 1), className = _b[0];\r\n            return className;\r\n        });\r\n        var prevClassNames = this._viewClassNames;\r\n        var _a = diff$1(prevClassNames, nextClassNames), removed = _a.removed, added = _a.added;\r\n        removed.forEach(function (index) {\r\n            removeClass(viewContainer, prevClassNames[index]);\r\n        });\r\n        added.forEach(function (index) {\r\n            addClass(viewContainer, nextClassNames[index]);\r\n        });\r\n        this._viewClassNames = nextClassNames;\r\n    };\r\n    MoveableManager.prototype._getAbleViewClassNames = function () {\r\n        var _this = this;\r\n        return (this.getEnabledAbles().map(function (able) {\r\n            var _a;\r\n            return (((_a = able.viewClassName) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\");\r\n        }).join(\" \") + \" \".concat(this._getAbleClassName(\"-view\"))).split(/\\s+/g);\r\n    };\r\n    MoveableManager.prototype._getAbleClassName = function (classPrefix) {\r\n        var _this = this;\r\n        if (classPrefix === void 0) { classPrefix = \"\"; }\r\n        var ables = this.getEnabledAbles();\r\n        var targetGesto = this.targetGesto;\r\n        var controlGesto = this.controlGesto;\r\n        var targetGestoData = (targetGesto === null || targetGesto === void 0 ? void 0 : targetGesto.isFlag())\r\n            ? targetGesto.getEventData() : {};\r\n        var controlGestoData = (controlGesto === null || controlGesto === void 0 ? void 0 : controlGesto.isFlag())\r\n            ? controlGesto.getEventData() : {};\r\n        return ables.map(function (able) {\r\n            var _a, _b, _c;\r\n            var name = able.name;\r\n            var className = ((_a = able.className) === null || _a === void 0 ? void 0 : _a.call(able, _this)) || \"\";\r\n            if (((_b = targetGestoData[name]) === null || _b === void 0 ? void 0 : _b.isEventStart)\r\n                || ((_c = controlGestoData[name]) === null || _c === void 0 ? void 0 : _c.isEventStart)) {\r\n                className += \" \".concat(prefix(\"\".concat(name).concat(classPrefix, \"-dragging\")));\r\n            }\r\n            return className.trim();\r\n        }).filter(Boolean).join(\" \");\r\n    };\r\n    MoveableManager.prototype._updateResizeObserver = function (prevProps) {\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.ResizeObserver || !target || !props.useResizeObserver) {\r\n            (_a = this._reiszeObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._reiszeObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.ResizeObserver(this.checkUpdateRect);\r\n        observer.observe(target, {\r\n            box: \"border-box\",\r\n        });\r\n        this._reiszeObserver = observer;\r\n    };\r\n    MoveableManager.prototype._updateMutationObserver = function (prevProps) {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var target = props.target;\r\n        var win = getWindow(this.getControlBoxElement());\r\n        if (!win.MutationObserver || !target || !props.useMutationObserver) {\r\n            (_a = this._mutationObserver) === null || _a === void 0 ? void 0 : _a.disconnect();\r\n            return;\r\n        }\r\n        if (prevProps.target === target && this._mutationObserver) {\r\n            return;\r\n        }\r\n        var observer = new win.MutationObserver(function (records) {\r\n            var e_1, _a;\r\n            try {\r\n                for (var records_1 = __values(records), records_1_1 = records_1.next(); !records_1_1.done; records_1_1 = records_1.next()) {\r\n                    var mutation = records_1_1.value;\r\n                    if (mutation.type === \"attributes\" && mutation.attributeName === \"style\") {\r\n                        _this.checkUpdateRect();\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (records_1_1 && !records_1_1.done && (_a = records_1.return)) _a.call(records_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        });\r\n        observer.observe(target, {\r\n            attributes: true,\r\n        });\r\n        this._mutationObserver = observer;\r\n    };\r\n    MoveableManager.defaultProps = {\r\n        dragTargetSelf: false,\r\n        target: null,\r\n        dragTarget: null,\r\n        container: null,\r\n        rootContainer: null,\r\n        origin: true,\r\n        parentMoveable: null,\r\n        wrapperMoveable: null,\r\n        isWrapperMounted: false,\r\n        parentPosition: null,\r\n        warpSelf: false,\r\n        svgOrigin: \"\",\r\n        dragContainer: null,\r\n        useResizeObserver: false,\r\n        useMutationObserver: false,\r\n        preventDefault: true,\r\n        preventRightClick: true,\r\n        preventWheelClick: true,\r\n        linePadding: 0,\r\n        controlPadding: 0,\r\n        ables: [],\r\n        pinchThreshold: 20,\r\n        dragArea: false,\r\n        passDragArea: false,\r\n        transformOrigin: \"\",\r\n        className: \"\",\r\n        zoom: 1,\r\n        triggerAblesSimultaneously: false,\r\n        padding: {},\r\n        pinchOutside: true,\r\n        checkInput: false,\r\n        dragFocusedInput: false,\r\n        groupable: false,\r\n        hideDefaultLines: false,\r\n        cspNonce: \"\",\r\n        translateZ: 0,\r\n        cssStyled: null,\r\n        customStyledMap: {},\r\n        props: {},\r\n        stopPropagation: false,\r\n        preventClickDefault: false,\r\n        preventClickEventOnDrag: true,\r\n        flushSync: defaultSync,\r\n        firstRenderState: null,\r\n        persistData: null,\r\n        viewContainer: null,\r\n        requestStyles: [],\r\n        useAccuratePosition: false,\r\n    };\r\n    return MoveableManager;\r\n}(React.PureComponent));\r\n/**\r\n * The target to indicate Moveable Control Box.\r\n * @name Moveable#target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n */\r\n/**\r\n * Zooms in the elements of a moveable.\r\n * @name Moveable#zoom\r\n * @default 1\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.zoom = 2;\r\n */\r\n/**\r\n * Whether the target size is detected and updated whenever it changes.\r\n * @name Moveable#useResizeObserver\r\n * @default false\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.useResizeObserver = true;\r\n */\r\n/**\r\n * Resize, Scale Events at edges\r\n * @name Moveable#edge\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.edge = true;\r\n */\r\n/**\r\n * You can specify the className of the moveable controlbox.\r\n * @name Moveable#className\r\n * @default \"\"\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *   className: \"\",\r\n * });\r\n *\r\n * moveable.className = \"moveable1\";\r\n */\r\n/**\r\n * The target(s) to drag Moveable target(s)\r\n * @name Moveable#dragTarget\r\n * @default target\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body);\r\n * moveable.target = document.querySelector(\".target\");\r\n * moveable.dragTarget = document.querySelector(\".dragTarget\");\r\n */\r\n/**\r\n * `renderStart` event occurs at the first start of all events.\r\n * @memberof Moveable\r\n * @event renderStart\r\n * @param {Moveable.OnRenderStart} - Parameters for the `renderStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderStart\", ({ target }) => {\r\n *     console.log(\"onRenderStart\", target);\r\n * });\r\n */\r\n/**\r\n * `render` event occurs before the target is drawn on the screen.\r\n * @memberof Moveable\r\n * @event render\r\n * @param {Moveable.OnRender} - Parameters for the `render` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"render\", ({ target }) => {\r\n *     console.log(\"onRender\", target);\r\n * });\r\n */\r\n/**\r\n * `renderEnd` event occurs at the end of all events.\r\n * @memberof Moveable\r\n * @event renderEnd\r\n * @param {Moveable.OnRenderEnd} - Parameters for the `renderEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"renderEnd\", ({ target }) => {\r\n *     console.log(\"onRenderEnd\", target);\r\n * });\r\n */\r\n/**\r\n * `renderGroupStart` event occurs at the first start of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupStart\r\n * @param {Moveable.OnRenderGroupStart} - Parameters for the `renderGroupStart` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupStart\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupStart\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroup` event occurs before the target is drawn on the screen in group.\r\n * @memberof Moveable\r\n * @event renderGroup\r\n * @param {Moveable.OnRenderGroup} - Parameters for the `renderGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroup\", ({ targets }) => {\r\n *     console.log(\"onRenderGroup\", targets);\r\n * });\r\n */\r\n/**\r\n * `renderGroupEnd` event occurs at the end of all events in group.\r\n * @memberof Moveable\r\n * @event renderGroupEnd\r\n * @param {Moveable.OnRenderGroupEnd} - Parameters for the `renderGroupEnd` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"renderGroupEnd\", ({ targets }) => {\r\n *     console.log(\"onRenderGroupEnd\", targets);\r\n * });\r\n */\n\nvar Groupable = {\r\n    name: \"groupable\",\r\n    props: [\r\n        \"defaultGroupRotate\",\r\n        \"useDefaultGroupRotate\",\r\n        \"defaultGroupOrigin\",\r\n        \"groupable\",\r\n        \"groupableProps\",\r\n        \"targetGroups\",\r\n        \"hideChildMoveableDefaultLines\",\r\n    ],\r\n    events: [],\r\n    render: function (moveable, React) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var targets = props.targets || [];\r\n        var _b = moveable.getState(), left = _b.left, top = _b.top, isPersisted = _b.isPersisted;\r\n        var zoom = props.zoom || 1;\r\n        var renderGroupRects = moveable.renderGroupRects;\r\n        var persistDatChildren = ((_a = props.persistData) === null || _a === void 0 ? void 0 : _a.children) || [];\r\n        if (isPersisted) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else {\r\n            persistDatChildren = [];\r\n        }\r\n        var parentPosition = watchValue(moveable, \"parentPosition\", [left, top], function (styles) { return styles.join(\",\"); });\r\n        var requestStyles = watchValue(moveable, \"requestStyles\", moveable.getRequestChildStyles(), function (styles) { return styles.join(\",\"); });\r\n        moveable.moveables = moveable.moveables.slice(0, targets.length);\r\n        return __spreadArray(__spreadArray([], __read(targets.map(function (target, i) {\r\n            return React.createElement(MoveableManager, { key: \"moveable\" + i, ref: refs(moveable, \"moveables\", i), target: target, origin: false, requestStyles: requestStyles, cssStyled: props.cssStyled, customStyledMap: props.customStyledMap, useResizeObserver: props.useResizeObserver, useMutationObserver: props.useMutationObserver, hideChildMoveableDefaultLines: props.hideChildMoveableDefaultLines, parentMoveable: moveable, parentPosition: [left, top], persistData: persistDatChildren[i], zoom: zoom });\r\n        })), false), __read(flat(renderGroupRects.map(function (_a, i) {\r\n            var pos1 = _a.pos1, pos2 = _a.pos2, pos3 = _a.pos3, pos4 = _a.pos4;\r\n            var poses = [pos1, pos2, pos3, pos4];\r\n            return [\r\n                [0, 1],\r\n                [1, 3],\r\n                [3, 2],\r\n                [2, 0],\r\n            ].map(function (_a, j) {\r\n                var _b = __read(_a, 2), from = _b[0], to = _b[1];\r\n                return renderLine(React, \"\", minus(poses[from], parentPosition), minus(poses[to], parentPosition), zoom, \"group-rect-\".concat(i, \"-\").concat(j));\r\n            });\r\n        }))), false);\r\n    },\r\n};\n\nvar Clickable = makeAble(\"clickable\", {\r\n    props: [\r\n        \"clickable\",\r\n    ],\r\n    events: [\r\n        \"click\",\r\n        \"clickGroup\",\r\n    ],\r\n    always: true,\r\n    dragRelation: \"weak\",\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    dragStart: function () {\r\n        return;\r\n    },\r\n    dragControlStart: function () {\r\n        return;\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        e.datas.inputTarget = e.inputEvent && e.inputEvent.target;\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        var target = moveable.props.target;\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        var isMoveableElement = moveable.isMoveableElement(inputTarget);\r\n        var containsElement = !isMoveableElement && moveable.controlBox.contains(inputTarget);\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            || containsElement\r\n        // External event duplicate target or dragAreaElement\r\n        ) {\r\n            return;\r\n        }\r\n        var containsTarget = target.contains(inputTarget);\r\n        triggerEvent(moveable, \"onClick\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            inputTarget: inputTarget,\r\n            isTarget: target === inputTarget,\r\n            moveableTarget: moveable.props.target,\r\n            containsTarget: containsTarget,\r\n        }));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        var inputEvent = e.inputEvent;\r\n        var inputTarget = e.inputTarget;\r\n        if (!inputEvent || !inputTarget || e.isDrag\r\n            || moveable.isMoveableElement(inputTarget)\r\n            // External event duplicate target or dragAreaElement\r\n            || e.datas.inputTarget === inputTarget) {\r\n            return;\r\n        }\r\n        var targets = moveable.props.targets;\r\n        var targetIndex = targets.indexOf(inputTarget);\r\n        var isTarget = targetIndex > -1;\r\n        var containsTarget = false;\r\n        if (targetIndex === -1) {\r\n            targetIndex = findIndex(targets, function (parentTarget) { return parentTarget.contains(inputTarget); });\r\n            containsTarget = targetIndex > -1;\r\n        }\r\n        triggerEvent(moveable, \"onClickGroup\", fillParams(moveable, e, {\r\n            isDouble: e.isDouble,\r\n            targets: targets,\r\n            inputTarget: inputTarget,\r\n            targetIndex: targetIndex,\r\n            isTarget: isTarget,\r\n            containsTarget: containsTarget,\r\n            moveableTarget: targets[targetIndex],\r\n        }));\r\n    },\r\n    dragControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n    dragGroupControlEnd: function (moveable, e) {\r\n        this.dragEnd(moveable, e);\r\n    },\r\n});\r\n/**\r\n * When you click on the element, the `click` event is called.\r\n * @memberof Moveable\r\n * @event click\r\n * @param {Moveable.OnClick} - Parameters for the `click` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: document.querySelector(\".target\"),\r\n * });\r\n * moveable.on(\"click\", ({ hasTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", target, hasTarget, containsTarget, targetIndex);\r\n * });\r\n */\r\n/**\r\n * When you click on the element inside the group, the `clickGroup` event is called.\r\n * @memberof Moveable\r\n * @event clickGroup\r\n * @param {Moveable.OnClickGroup} - Parameters for the `clickGroup` event\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *     target: [].slice.call(document.querySelectorAll(\".target\")),\r\n * });\r\n * moveable.on(\"clickGroup\", ({ inputTarget, isTarget, containsTarget, targetIndex }) => {\r\n *     // If you click on an element other than the target and not included in the target, index is -1.\r\n *     console.log(\"onClickGroup\", inputTarget, isTarget, containsTarget, targetIndex);\r\n * });\r\n */\n\nfunction getDraggableEvent(e) {\r\n    var datas = e.originalDatas.draggable;\r\n    if (!datas) {\r\n        e.originalDatas.draggable = {};\r\n        datas = e.originalDatas.draggable;\r\n    }\r\n    return __assign(__assign({}, e), { datas: datas });\r\n}\r\nvar edgeDraggable = makeAble(\"edgeDraggable\", {\r\n    css: [\r\n        \".edge.edgeDraggable.line {\\ncursor: move;\\n}\",\r\n    ],\r\n    render: function (moveable, React) {\r\n        var props = moveable.props;\r\n        var edge = props.edgeDraggable;\r\n        if (!edge) {\r\n            return [];\r\n        }\r\n        return renderEdgeLines(React, \"edgeDraggable\", edge, moveable.getState().renderPoses, props.zoom);\r\n    },\r\n    dragCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable\r\n            && hasClass(target, prefix(\"direction\"))\r\n            && hasClass(target, prefix(\"edge\"))\r\n            && hasClass(target, prefix(\"edgeDraggable\"));\r\n    },\r\n    dragStart: function (moveable, e) {\r\n        return Draggable.dragStart(moveable, getDraggableEvent(e));\r\n    },\r\n    drag: function (moveable, e) {\r\n        return Draggable.drag(moveable, getDraggableEvent(e));\r\n    },\r\n    dragEnd: function (moveable, e) {\r\n        return Draggable.dragEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupCondition: function (moveable, e) {\r\n        var _a;\r\n        var props = moveable.props;\r\n        var target = (_a = e.inputEvent) === null || _a === void 0 ? void 0 : _a.target;\r\n        if (!props.edgeDraggable || !target) {\r\n            return false;\r\n        }\r\n        return !props.draggable && hasClass(target, prefix(\"direction\")) && hasClass(target, prefix(\"line\"));\r\n    },\r\n    dragGroupStart: function (moveable, e) {\r\n        return Draggable.dragGroupStart(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroup: function (moveable, e) {\r\n        return Draggable.dragGroup(moveable, getDraggableEvent(e));\r\n    },\r\n    dragGroupEnd: function (moveable, e) {\r\n        return Draggable.dragGroupEnd(moveable, getDraggableEvent(e));\r\n    },\r\n    unset: function (moveable) {\r\n        return Draggable.unset(moveable);\r\n    },\r\n});\r\n/**\r\n * Whether to move by dragging the edge line (default: false)\r\n * @name Moveable.Draggable#edgeDraggable\r\n * @example\r\n * import Moveable from \"moveable\";\r\n *\r\n * const moveable = new Moveable(document.body, {\r\n *  draggable: true,\r\n *  edgeDraggable: false,\r\n * });\r\n *\r\n * moveable.edgeDraggable = true;\r\n */\n\nvar IndividualGroupable = {\r\n    name: \"individualGroupable\",\r\n    props: [\r\n        \"individualGroupable\",\r\n        \"individualGroupableProps\",\r\n    ],\r\n    events: [],\r\n};\n\nvar MOVEABLE_ABLES =  [\r\n    BeforeRenderable,\r\n    Default, Snappable, Pinchable,\r\n    Draggable, edgeDraggable,\r\n    Resizable, Scalable, Warpable, Rotatable,\r\n    Scrollable, Padding, Origin,\r\n    OriginDraggable,\r\n    Clippable, Roundable, Groupable, IndividualGroupable,\r\n    Clickable,\r\n    DragArea,\r\n    Renderable,\r\n];\r\nvar MOVEABLE_EVENTS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.events || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\r\nvar MOVEABLE_PROPS = /*#__PURE__*/ MOVEABLE_ABLES.reduce(function (current, able) {\r\n    (able.props || []).forEach(function (name) {\r\n        pushSet(current, name);\r\n    });\r\n    return current;\r\n}, []);\n\nfunction solveConstantsDistance(_a, pos) {\r\n    var _b = __read(_a, 3), a = _b[0], b = _b[1], c = _b[2];\r\n    return (a * pos[0] + b * pos[1] + c) / Math.sqrt(a * a + b * b);\r\n}\r\nfunction solveC(_a, pos) {\r\n    var _b = __read(_a, 2), a = _b[0], b = _b[1];\r\n    // ax + by + c = 0\r\n    // -ax -by;\r\n    return -a * pos[0] - b * pos[1];\r\n}\n\nfunction getMaxPos(poses, index) {\r\n    return Math.max.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.max(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getMinPos(poses, index) {\r\n    return Math.min.apply(Math, __spreadArray([], __read(poses.map(function (_a) {\r\n        var _b = __read(_a, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n        return Math.min(pos1[index], pos2[index], pos3[index], pos4[index]);\r\n    })), false));\r\n}\r\nfunction getGroupRect(parentPoses, rotation) {\r\n    var _a, _b, _c;\r\n    var pos1 = [0, 0];\r\n    var pos2 = [0, 0];\r\n    var pos3 = [0, 0];\r\n    var pos4 = [0, 0];\r\n    var width = 0;\r\n    var height = 0;\r\n    if (!parentPoses.length) {\r\n        return {\r\n            pos1: pos1,\r\n            pos2: pos2,\r\n            pos3: pos3,\r\n            pos4: pos4,\r\n            minX: 0,\r\n            minY: 0,\r\n            maxX: 0,\r\n            maxY: 0,\r\n            width: width,\r\n            height: height,\r\n            rotation: rotation,\r\n        };\r\n    }\r\n    var fixedRotation = throttle(rotation, TINY_NUM);\r\n    if (fixedRotation % 90) {\r\n        var rad = fixedRotation / 180 * Math.PI;\r\n        var a1_1 = Math.tan(rad);\r\n        var a2_1 = -1 / a1_1;\r\n        // ax = y  // -ax + y = 0 // 0 => 1\r\n        // -ax = y // ax + y = 0  // 0 => 3\r\n        var a1MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a1MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        var a2MinMax_1 = [MAX_NUM, MIN_NUM];\r\n        var a2MinMaxPos_1 = [[0, 0], [0, 0]];\r\n        parentPoses.forEach(function (poses) {\r\n            poses.forEach(function (pos) {\r\n                // const b1 = pos[1] - a1 * pos[0];\r\n                // const b2 = pos[1] - a2 * pos[0];\r\n                var a1Dist = solveConstantsDistance([-a1_1, 1, 0], pos);\r\n                var a2Dist = solveConstantsDistance([-a2_1, 1, 0], pos);\r\n                if (a1MinMax_1[0] > a1Dist) {\r\n                    a1MinMaxPos_1[0] = pos;\r\n                    a1MinMax_1[0] = a1Dist;\r\n                }\r\n                if (a1MinMax_1[1] < a1Dist) {\r\n                    a1MinMaxPos_1[1] = pos;\r\n                    a1MinMax_1[1] = a1Dist;\r\n                }\r\n                if (a2MinMax_1[0] > a2Dist) {\r\n                    a2MinMaxPos_1[0] = pos;\r\n                    a2MinMax_1[0] = a2Dist;\r\n                }\r\n                if (a2MinMax_1[1] < a2Dist) {\r\n                    a2MinMaxPos_1[1] = pos;\r\n                    a2MinMax_1[1] = a2Dist;\r\n                }\r\n            });\r\n        });\r\n        var _d = __read(a1MinMaxPos_1, 2), a1MinPos = _d[0], a1MaxPos = _d[1];\r\n        var _e = __read(a2MinMaxPos_1, 2), a2MinPos = _e[0], a2MaxPos = _e[1];\r\n        var minHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MinPos)];\r\n        var maxHorizontalLine = [-a1_1, 1, solveC([-a1_1, 1], a1MaxPos)];\r\n        var minVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MinPos)];\r\n        var maxVerticalLine = [-a2_1, 1, solveC([-a2_1, 1], a2MaxPos)];\r\n        _a = __read([\r\n            [minHorizontalLine, minVerticalLine],\r\n            [minHorizontalLine, maxVerticalLine],\r\n            [maxHorizontalLine, minVerticalLine],\r\n            [maxHorizontalLine, maxVerticalLine],\r\n        ].map(function (_a) {\r\n            var _b = __read(_a, 2), line1 = _b[0], line2 = _b[1];\r\n            return getIntersectionPointsByConstants(line1, line2)[0];\r\n        }), 4), pos1 = _a[0], pos2 = _a[1], pos3 = _a[2], pos4 = _a[3];\r\n        width = a2MinMax_1[1] - a2MinMax_1[0];\r\n        height = a1MinMax_1[1] - a1MinMax_1[0];\r\n    }\r\n    else {\r\n        var minX_1 = getMinPos(parentPoses, 0);\r\n        var minY_1 = getMinPos(parentPoses, 1);\r\n        var maxX_1 = getMaxPos(parentPoses, 0);\r\n        var maxY_1 = getMaxPos(parentPoses, 1);\r\n        pos1 = [minX_1, minY_1];\r\n        pos2 = [maxX_1, minY_1];\r\n        pos3 = [minX_1, maxY_1];\r\n        pos4 = [maxX_1, maxY_1];\r\n        width = maxX_1 - minX_1;\r\n        height = maxY_1 - minY_1;\r\n        if (fixedRotation % 180) {\r\n            // 0\r\n            // 1 2\r\n            // 3 4\r\n            // 90\r\n            // 3 1\r\n            // 4 2\r\n            // 180\r\n            // 4 3\r\n            // 2 1\r\n            // 270\r\n            // 2 4\r\n            // 1 3\r\n            // 1, 2, 3,4 = 3 1 4 2\r\n            var changedX = [pos3, pos1, pos4, pos2];\r\n            _b = __read(changedX, 4), pos1 = _b[0], pos2 = _b[1], pos3 = _b[2], pos4 = _b[3];\r\n            width = maxY_1 - minY_1;\r\n            height = maxX_1 - minX_1;\r\n        }\r\n    }\r\n    if (fixedRotation % 360 > 180) {\r\n        // 1 2   4 3\r\n        // 3 4   2 1\r\n        var changedX = [pos4, pos3, pos2, pos1];\r\n        _c = __read(changedX, 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3];\r\n    }\r\n    var _f = getMinMaxs([pos1, pos2, pos3, pos4]), minX = _f.minX, minY = _f.minY, maxX = _f.maxX, maxY = _f.maxY;\r\n    return {\r\n        pos1: pos1,\r\n        pos2: pos2,\r\n        pos3: pos3,\r\n        pos4: pos4,\r\n        width: width,\r\n        height: height,\r\n        minX: minX,\r\n        minY: minY,\r\n        maxX: maxX,\r\n        maxY: maxY,\r\n        rotation: rotation,\r\n    };\r\n}\r\nfunction findMoveableGroups(moveables, childTargetGroups) {\r\n    var groups = childTargetGroups.map(function (targetGroup) {\r\n        if (isArray(targetGroup)) {\r\n            var childMoveableGroups = findMoveableGroups(moveables, targetGroup);\r\n            var length_1 = childMoveableGroups.length;\r\n            if (length_1 > 1) {\r\n                return childMoveableGroups;\r\n            }\r\n            else if (length_1 === 1) {\r\n                return childMoveableGroups[0];\r\n            }\r\n            else {\r\n                return null;\r\n            }\r\n        }\r\n        else {\r\n            var checked = find(moveables, function (_a) {\r\n                var manager = _a.manager;\r\n                return manager.props.target === targetGroup;\r\n            });\r\n            if (checked) {\r\n                checked.finded = true;\r\n                return checked.manager;\r\n            }\r\n            return null;\r\n        }\r\n    }).filter(Boolean);\r\n    if (groups.length === 1 && isArray(groups[0])) {\r\n        return groups[0];\r\n    }\r\n    return groups;\r\n}\r\n/**\r\n * @namespace Moveable.Group\r\n * @description You can make targets moveable.\r\n */\r\nvar MoveableGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableGroup, _super);\r\n    function MoveableGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.differ = new ChildrenDiffer();\r\n        _this.moveables = [];\r\n        _this.transformOrigin = \"50% 50%\";\r\n        _this.renderGroupRects = [];\r\n        _this._targetGroups = [];\r\n        _this._hasFirstTargets = false;\r\n        return _this;\r\n    }\r\n    MoveableGroup.prototype.componentDidMount = function () {\r\n        _super.prototype.componentDidMount.call(this);\r\n    };\r\n    MoveableGroup.prototype.checkUpdate = function () {\r\n        this._isPropTargetChanged = false;\r\n        this.updateAbles();\r\n    };\r\n    MoveableGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        var _a;\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        var state = this.state;\r\n        if (!this.controlBox || state.isPersisted) {\r\n            return;\r\n        }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, false, false);\r\n        });\r\n        var props = this.props;\r\n        var moveables = this.moveables;\r\n        var target = state.target || props.target;\r\n        var checkeds = moveables.map(function (moveable) { return ({ finded: false, manager: moveable }); });\r\n        var targetGroups = this.props.targetGroups || [];\r\n        var moveableGroups = findMoveableGroups(checkeds, targetGroups);\r\n        var useDefaultGroupRotate = props.useDefaultGroupRotate;\r\n        moveableGroups.push.apply(moveableGroups, __spreadArray([], __read(checkeds.filter(function (_a) {\r\n            var finded = _a.finded;\r\n            return !finded;\r\n        }).map(function (_a) {\r\n            var manager = _a.manager;\r\n            return manager;\r\n        })), false));\r\n        var renderGroupRects = [];\r\n        var isReset = !isTarget || (type !== \"\" && props.updateGroup);\r\n        var defaultGroupRotate = props.defaultGroupRotate || 0;\r\n        if (!this._hasFirstTargets) {\r\n            var persistedRoatation = (_a = props.persistData) === null || _a === void 0 ? void 0 : _a.rotation;\r\n            if (persistedRoatation != null) {\r\n                defaultGroupRotate = persistedRoatation;\r\n            }\r\n        }\r\n        function getMoveableGroupRect(group, parentRotation, isRoot) {\r\n            var posesRotations = group.map(function (moveable) {\r\n                if (isArray(moveable)) {\r\n                    var rect = getMoveableGroupRect(moveable, parentRotation);\r\n                    var poses = [rect.pos1, rect.pos2, rect.pos3, rect.pos4];\r\n                    renderGroupRects.push(rect);\r\n                    return { poses: poses, rotation: rect.rotation };\r\n                }\r\n                else {\r\n                    return {\r\n                        poses: getAbsolutePosesByState(moveable.state),\r\n                        rotation: moveable.getRotation(),\r\n                    };\r\n                }\r\n            });\r\n            var rotations = posesRotations.map(function (_a) {\r\n                var rotation = _a.rotation;\r\n                return rotation;\r\n            });\r\n            var groupRotation = 0;\r\n            var firstRotation = rotations[0];\r\n            var isSameRotation = rotations.every(function (nextRotation) {\r\n                return Math.abs(firstRotation - nextRotation) < 0.1;\r\n            });\r\n            if (isReset) {\r\n                groupRotation = !useDefaultGroupRotate && isSameRotation ? firstRotation : defaultGroupRotate;\r\n            }\r\n            else {\r\n                groupRotation = !useDefaultGroupRotate && !isRoot && isSameRotation ? firstRotation : parentRotation;\r\n            }\r\n            var groupPoses = posesRotations.map(function (_a) {\r\n                var poses = _a.poses;\r\n                return poses;\r\n            });\r\n            var groupRect = getGroupRect(groupPoses, groupRotation);\r\n            return groupRect;\r\n        }\r\n        var rootGroupRect = getMoveableGroupRect(moveableGroups, this.rotation, true);\r\n        if (isReset) {\r\n            // reset rotataion\r\n            this.rotation = rootGroupRect.rotation;\r\n            this.transformOrigin = props.defaultGroupOrigin || \"50% 50%\";\r\n            this.scale = [1, 1];\r\n        }\r\n        this._targetGroups = targetGroups;\r\n        this.renderGroupRects = renderGroupRects;\r\n        var transformOrigin = this.transformOrigin;\r\n        var rotation = this.rotation;\r\n        var scale = this.scale;\r\n        var width = rootGroupRect.width, height = rootGroupRect.height, minX = rootGroupRect.minX, minY = rootGroupRect.minY;\r\n        var posesInfo = rotatePosesInfo([\r\n            [0, 0],\r\n            [width, 0],\r\n            [0, height],\r\n            [width, height],\r\n        ], convertTransformOriginArray(transformOrigin, width, height), this.rotation / 180 * Math.PI);\r\n        var _b = getMinMaxs(posesInfo.result), deltaX = _b.minX, deltaY = _b.minY;\r\n        var rotateScale = \" rotate(\".concat(rotation, \"deg)\")\r\n            + \" scale(\".concat(sign(scale[0]), \", \").concat(sign(scale[1]), \")\");\r\n        var transform = \"translate(\".concat(-deltaX, \"px, \").concat(-deltaY, \"px)\").concat(rotateScale);\r\n        this.controlBox.style.transform\r\n            = \"translate3d(\".concat(minX, \"px, \").concat(minY, \"px, \").concat(this.props.translateZ || 0, \")\");\r\n        target.style.cssText += \"left:0px;top:0px;\"\r\n            + \"transform-origin:\".concat(transformOrigin, \";\")\r\n            + \"width:\".concat(width, \"px;height:\").concat(height, \"px;\")\r\n            + \"transform: \".concat(transform);\r\n        state.width = width;\r\n        state.height = height;\r\n        var container = this.getContainer();\r\n        var info = getMoveableTargetInfo(this.controlBox, target, this.controlBox, this.getContainer(), this._rootContainer || container, []);\r\n        var pos = [info.left, info.top];\r\n        var _c = __read(getAbsolutePosesByState(info), 4), pos1 = _c[0], pos2 = _c[1], pos3 = _c[2], pos4 = _c[3]; // info.left + info.pos(1 ~ 4)\r\n        var minPos = getMinMaxs([pos1, pos2, pos3, pos4]);\r\n        var delta = [minPos.minX, minPos.minY];\r\n        var direction = sign(scale[0] * scale[1]);\r\n        info.pos1 = minus(pos1, delta);\r\n        info.pos2 = minus(pos2, delta);\r\n        info.pos3 = minus(pos3, delta);\r\n        info.pos4 = minus(pos4, delta);\r\n        // info.left = info.left + delta[0];\r\n        // info.top = info.top + delta[1];\r\n        info.left = minX - info.left + delta[0];\r\n        info.top = minY - info.top + delta[1];\r\n        info.origin = minus(plus(pos, info.origin), delta);\r\n        info.beforeOrigin = minus(plus(pos, info.beforeOrigin), delta);\r\n        info.originalBeforeOrigin = plus(pos, info.originalBeforeOrigin);\r\n        info.transformOrigin = minus(plus(pos, info.transformOrigin), delta);\r\n        target.style.transform\r\n            = \"translate(\".concat(-deltaX - delta[0], \"px, \").concat(-deltaY - delta[1], \"px)\")\r\n                + rotateScale;\r\n        setStoreCache();\r\n        this.updateState(__assign(__assign({}, info), { posDelta: delta, direction: direction, beforeDirection: direction }), isSetState);\r\n    };\r\n    MoveableGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableGroup.prototype.triggerEvent = function (name, e, isManager) {\r\n        if (isManager || name.indexOf(\"Group\") > -1) {\r\n            return _super.prototype.triggerEvent.call(this, name, e);\r\n        }\r\n        else {\r\n            this._emitter.trigger(name, e);\r\n        }\r\n    };\r\n    MoveableGroup.prototype.getRequestChildStyles = function () {\r\n        var styleNames = this.getEnabledAbles().reduce(function (names, able) {\r\n            var _a, _b;\r\n            var ableStyleNames = ((_b = (_a = able.requestChildStyle) === null || _a === void 0 ? void 0 : _a.call(able)) !== null && _b !== void 0 ? _b : []);\r\n            return __spreadArray(__spreadArray([], __read(names), false), __read(ableStyleNames), false);\r\n        }, []);\r\n        return styleNames;\r\n    };\r\n    MoveableGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableGroup.prototype.updateAbles = function () {\r\n        _super.prototype.updateAbles.call(this, __spreadArray(__spreadArray([], __read(this.props.ables), false), [Groupable], false), \"Group\");\r\n    };\r\n    MoveableGroup.prototype._updateTargets = function () {\r\n        _super.prototype._updateTargets.call(this);\r\n        this._originalDragTarget = this.props.dragTarget || this.areaElement;\r\n        this._dragTarget = getRefTarget(this._originalDragTarget, true);\r\n    };\r\n    MoveableGroup.prototype._updateEvents = function () {\r\n        var state = this.state;\r\n        var props = this.props;\r\n        var prevTarget = this._prevDragTarget;\r\n        var nextTarget = props.dragTarget || this.areaElement;\r\n        var targets = props.targets;\r\n        var _a = this.differ.update(targets), added = _a.added, changed = _a.changed, removed = _a.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged || this._prevOriginalDragTarget !== this._originalDragTarget) {\r\n            unsetGesto(this, false);\r\n            unsetGesto(this, true);\r\n            this.updateState({ gestos: {} });\r\n        }\r\n        if (prevTarget !== nextTarget) {\r\n            state.target = null;\r\n        }\r\n        if (!state.target) {\r\n            state.target = this.areaElement;\r\n            this.controlBox.style.display = \"block\";\r\n        }\r\n        if (state.target) {\r\n            if (!this.targetGesto) {\r\n                this.targetGesto = getTargetAbleGesto(this, this._dragTarget, \"Group\");\r\n            }\r\n            if (!this.controlGesto) {\r\n                this.controlGesto = getControlAbleGesto(this, \"GroupControl\");\r\n            }\r\n        }\r\n        var isContainerChanged = !equals(state.container, props.container);\r\n        if (isContainerChanged) {\r\n            state.container = props.container;\r\n        }\r\n        if (isContainerChanged\r\n            || isTargetChanged\r\n            || this.transformOrigin !== (props.defaultGroupOrigin || \"50% 50%\")\r\n            || changed.length\r\n            || targets.length && !isDeepArrayEquals(this._targetGroups, props.targetGroups || [])) {\r\n            this.updateRect();\r\n            this._hasFirstTargets = true;\r\n        }\r\n        this._isPropTargetChanged = !!isTargetChanged;\r\n    };\r\n    MoveableGroup.prototype._updateObserver = function () { };\r\n    MoveableGroup.defaultProps = __assign(__assign({}, MoveableManager.defaultProps), { transformOrigin: [\"50%\", \"50%\"], groupable: true, dragArea: true, keepRatio: true, targets: [], defaultGroupRotate: 0, defaultGroupOrigin: \"50% 50%\" });\r\n    return MoveableGroup;\r\n}(MoveableManager));\n\n/**\r\n * @namespace Moveable.IndividualGroup\r\n * @description Create targets individually, not as a group.Create targets individually, not as a group.\r\n */\r\nvar MoveableIndividualGroup = /*#__PURE__*/ (function (_super) {\r\n    __extends(MoveableIndividualGroup, _super);\r\n    function MoveableIndividualGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.moveables = [];\r\n        return _this;\r\n    }\r\n    MoveableIndividualGroup.prototype.render = function () {\r\n        var _this = this;\r\n        var _a;\r\n        var props = this.props;\r\n        var cspNonce = props.cspNonce, ControlBoxElement = props.cssStyled, persistData = props.persistData;\r\n        var targets = props.targets || [];\r\n        var length = targets.length;\r\n        var canPersist = this.isUnmounted || !length;\r\n        var persistDatChildren = (_a = persistData === null || persistData === void 0 ? void 0 : persistData.children) !== null && _a !== void 0 ? _a : [];\r\n        if (canPersist && !length && persistDatChildren.length) {\r\n            targets = persistDatChildren.map(function () { return null; });\r\n        }\r\n        else if (!canPersist) {\r\n            persistDatChildren = [];\r\n        }\r\n        return React.createElement(ControlBoxElement, { cspNonce: cspNonce, ref: ref(this, \"controlBox\"), className: prefix(\"control-box\") }, targets.map(function (target, i) {\r\n            var _a, _b;\r\n            var individualProps = (_b = (_a = props.individualGroupableProps) === null || _a === void 0 ? void 0 : _a.call(props, target, i)) !== null && _b !== void 0 ? _b : {};\r\n            return React.createElement(MoveableManager, __assign({ key: \"moveable\" + i, ref: refs(_this, \"moveables\", i) }, props, individualProps, { target: target, wrapperMoveable: _this, isWrapperMounted: _this.isMoveableMounted, persistData: persistDatChildren[i] }));\r\n        }));\r\n    };\r\n    MoveableIndividualGroup.prototype.componentDidMount = function () { };\r\n    MoveableIndividualGroup.prototype.componentDidUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.getTargets = function () {\r\n        return this.props.targets;\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRect = function (type, isTarget, isSetState) {\r\n        if (isSetState === void 0) { isSetState = true; }\r\n        setStoreCache(true);\r\n        this.moveables.forEach(function (moveable) {\r\n            moveable.updateRect(type, isTarget, isSetState);\r\n        });\r\n        setStoreCache();\r\n    };\r\n    MoveableIndividualGroup.prototype.getRect = function () {\r\n        return __assign(__assign({}, _super.prototype.getRect.call(this)), { children: this.moveables.map(function (child) { return child.getRect(); }) });\r\n    };\r\n    MoveableIndividualGroup.prototype.request = function (ableName, param, isInstant) {\r\n        if (param === void 0) { param = {}; }\r\n        var results = this.moveables.map(function (m) { return m.request(ableName, __assign(__assign({}, param), { isInstant: false }), false); });\r\n        var requestInstant = isInstant || param.isInstant;\r\n        var requester = {\r\n            request: function (ableParam) {\r\n                results.forEach(function (r) { return r.request(ableParam); });\r\n                return this;\r\n            },\r\n            requestEnd: function () {\r\n                results.forEach(function (r) { return r.requestEnd(); });\r\n                return this;\r\n            },\r\n        };\r\n        return requestInstant ? requester.request(param).requestEnd() : requester;\r\n    };\r\n    MoveableIndividualGroup.prototype.dragStart = function (e, target) {\r\n        if (target === void 0) { target = e.target; }\r\n        var inputTarget = target;\r\n        var childMoveable = find(this.moveables, function (child) {\r\n            var target = child.getTargets()[0];\r\n            var controlBoxElement = child.getControlBoxElement();\r\n            var dragElement = child.getDragElement();\r\n            if (!target || !dragElement) {\r\n                return false;\r\n            }\r\n            return dragElement === inputTarget || dragElement.contains(inputTarget)\r\n                || (dragElement !== target && target === inputTarget || target.contains(inputTarget))\r\n                || controlBoxElement === inputTarget || controlBoxElement.contains(inputTarget);\r\n        });\r\n        if (childMoveable) {\r\n            childMoveable.dragStart(e, target);\r\n        }\r\n        return this;\r\n    };\r\n    MoveableIndividualGroup.prototype.hitTest = function () {\r\n        return 0;\r\n    };\r\n    MoveableIndividualGroup.prototype.isInside = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.isDragging = function () {\r\n        return false;\r\n    };\r\n    MoveableIndividualGroup.prototype.getDragElement = function () {\r\n        return null;\r\n    };\r\n    MoveableIndividualGroup.prototype.getMoveables = function () {\r\n        return __spreadArray([], __read(this.moveables), false);\r\n    };\r\n    MoveableIndividualGroup.prototype.updateRenderPoses = function () { };\r\n    MoveableIndividualGroup.prototype.checkUpdate = function () { };\r\n    MoveableIndividualGroup.prototype.triggerEvent = function () { };\r\n    MoveableIndividualGroup.prototype.updateAbles = function () { };\r\n    MoveableIndividualGroup.prototype._updateEvents = function () { };\r\n    MoveableIndividualGroup.prototype._updateObserver = function () { };\r\n    return MoveableIndividualGroup;\r\n}(MoveableManager));\n\nfunction getElementTargets(refTargets, selectorMap) {\r\n    var elementTargets = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                elementTargets.push.apply(elementTargets, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            elementTargets.push.apply(elementTargets, __spreadArray([], __read(getElementTargets(target, selectorMap)), false));\r\n        }\r\n        else {\r\n            elementTargets.push(target);\r\n        }\r\n    });\r\n    return elementTargets;\r\n}\r\nfunction getTargetGroups(refTargets, selectorMap) {\r\n    var targetGroups = [];\r\n    refTargets.forEach(function (target) {\r\n        if (!target) {\r\n            return;\r\n        }\r\n        if (isString(target)) {\r\n            if (selectorMap[target]) {\r\n                targetGroups.push.apply(targetGroups, __spreadArray([], __read(selectorMap[target]), false));\r\n            }\r\n            return;\r\n        }\r\n        if (isArray(target)) {\r\n            targetGroups.push(getTargetGroups(target, selectorMap));\r\n        }\r\n        else {\r\n            targetGroups.push(target);\r\n        }\r\n    });\r\n    return targetGroups;\r\n}\r\nfunction compareRefTargets(prevRefTargets, nextRefTargets) {\r\n    return (prevRefTargets.length !== nextRefTargets.length) || prevRefTargets.some(function (target, i) {\r\n        var nextTarget = nextRefTargets[i];\r\n        if (!target && !nextTarget) {\r\n            return false;\r\n        }\r\n        else if (target != nextTarget) {\r\n            if (isArray(target) && isArray(nextTarget)) {\r\n                return compareRefTargets(target, nextTarget);\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n}\r\nvar InitialMoveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(InitialMoveable, _super);\r\n    function InitialMoveable() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.refTargets = [];\r\n        _this.selectorMap = {};\r\n        _this._differ = new ChildrenDiffer();\r\n        _this._elementTargets = [];\r\n        _this._tmpRefTargets = [];\r\n        _this._tmpSelectorMap = {};\r\n        _this._onChangeTargets = null;\r\n        return _this;\r\n    }\r\n    InitialMoveable.makeStyled = function () {\r\n        var cssMap = {};\r\n        var ables = this.getTotalAbles();\r\n        ables.forEach(function (_a) {\r\n            var css = _a.css;\r\n            if (!css) {\r\n                return;\r\n            }\r\n            css.forEach(function (text) {\r\n                cssMap[text] = true;\r\n            });\r\n        });\r\n        var style = getKeys(cssMap).join(\"\\n\");\r\n        this.defaultStyled = styled(\"div\", prefixCSS(PREFIX, MOVEABLE_CSS + style));\r\n    };\r\n    InitialMoveable.getTotalAbles = function () {\r\n        return __spreadArray([Default, Groupable, IndividualGroupable, DragArea], __read(this.defaultAbles), false);\r\n    };\r\n    InitialMoveable.prototype.render = function () {\r\n        var _a;\r\n        var moveableContructor = this.constructor;\r\n        if (!moveableContructor.defaultStyled) {\r\n            moveableContructor.makeStyled();\r\n        }\r\n        var _b = this.props, userAbles = _b.ables, userProps = _b.props, props = __rest(_b, [\"ables\", \"props\"]);\r\n        var _c = __read(this._updateRefs(true), 2), refTargets = _c[0], nextSelectorMap = _c[1];\r\n        var elementTargets = getElementTargets(refTargets, nextSelectorMap);\r\n        var isGroup = elementTargets.length > 1;\r\n        var totalAbles = moveableContructor.getTotalAbles();\r\n        var ables = __spreadArray(__spreadArray([], __read(totalAbles), false), __read((userAbles || [])), false);\r\n        var nextProps = __assign(__assign(__assign({}, props), (userProps || {})), { ables: ables, cssStyled: moveableContructor.defaultStyled, customStyledMap: moveableContructor.customStyledMap });\r\n        this._elementTargets = elementTargets;\r\n        var firstRenderState = null;\r\n        var prevMoveable = this.moveable;\r\n        var persistData = props.persistData;\r\n        if (persistData === null || persistData === void 0 ? void 0 : persistData.children) {\r\n            isGroup = true;\r\n        }\r\n        // Even one child is treated as a group if individualGroupable is enabled. #867\r\n        if (props.individualGroupable) {\r\n            return React.createElement(MoveableIndividualGroup, __assign({ key: \"individual-group\", ref: ref(this, \"moveable\") }, nextProps, { target: null, targets: elementTargets }));\r\n        }\r\n        if (isGroup) {\r\n            var targetGroups = getTargetGroups(refTargets, nextSelectorMap);\r\n            // manager\r\n            if (prevMoveable && !prevMoveable.props.groupable && !prevMoveable.props.individualGroupable) {\r\n                var target = prevMoveable.props.target;\r\n                if (target && elementTargets.indexOf(target) > -1) {\r\n                    firstRenderState = __assign({}, prevMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableGroup, __assign({ key: \"group\", ref: ref(this, \"moveable\") }, nextProps, (_a = props.groupableProps) !== null && _a !== void 0 ? _a : {}, { target: null, targets: elementTargets, targetGroups: targetGroups, firstRenderState: firstRenderState }));\r\n        }\r\n        else {\r\n            var target_1 = elementTargets[0];\r\n            // manager\r\n            if (prevMoveable && (prevMoveable.props.groupable || prevMoveable.props.individualGroupable)) {\r\n                var moveables = prevMoveable.moveables || [];\r\n                var prevTargetMoveable = find(moveables, function (mv) { return mv.props.target === target_1; });\r\n                if (prevTargetMoveable) {\r\n                    firstRenderState = __assign({}, prevTargetMoveable.state);\r\n                }\r\n            }\r\n            return React.createElement(MoveableManager, __assign({ key: \"single\", ref: ref(this, \"moveable\") }, nextProps, { target: target_1, firstRenderState: firstRenderState }));\r\n        }\r\n    };\r\n    InitialMoveable.prototype.componentDidMount = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentDidUpdate = function () {\r\n        this._checkChangeTargets();\r\n    };\r\n    InitialMoveable.prototype.componentWillUnmount = function () {\r\n        this.selectorMap = {};\r\n        this.refTargets = [];\r\n    };\r\n    /**\r\n     * Get targets set in moveable through target or targets of props.\r\n     * @method Moveable#getTargets\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: [targetRef, \".target\", document.querySelectorAll(\".target\")],\r\n     * });\r\n     *\r\n     * console.log(moveable.getTargets());\r\n     */\r\n    InitialMoveable.prototype.getTargets = function () {\r\n        var _a, _b;\r\n        return (_b = (_a = this.moveable) === null || _a === void 0 ? void 0 : _a.getTargets()) !== null && _b !== void 0 ? _b : [];\r\n    };\r\n    /**\r\n     * If the element list corresponding to the selector among the targets is changed, it is updated.\r\n     * @method Moveable#updateSelectors\r\n     * @example\r\n     * import Moveable from \"moveable\";\r\n     *\r\n     * const moveable = new Moveable(document.body, {\r\n     *    target: \".target\",\r\n     * });\r\n     *\r\n     * moveable.updateSelectors();\r\n     */\r\n    InitialMoveable.prototype.updateSelectors = function () {\r\n        this.selectorMap = {};\r\n        this._updateRefs();\r\n        this.forceUpdate();\r\n    };\r\n    /**\r\n     * User changes target and waits for target to change.\r\n     * @method Moveable#waitToChangeTarget\r\n     * @story combination-with-other-components--components-selecto\r\n     * @example\r\n     * document.querySelector(\".target\").addEventListener(\"mousedown\", e => {\r\n     *   moveable.waitToChangeTarget().then(() => {\r\n     *      moveable.dragStart(e, e.currentTarget);\r\n     *   });\r\n     *   moveable.target = e.currentTarget;\r\n     * });\r\n     */\r\n    InitialMoveable.prototype.waitToChangeTarget = function () {\r\n        // let resolvePromise: (e: OnChangeTarget) => void;\r\n        var _this = this;\r\n        // this._onChangeTargets = () => {\r\n        //     this._onChangeTargets = null;\r\n        //     resolvePromise({\r\n        //         moveable: this.getManager(),\r\n        //         targets: this._elementTargets,\r\n        //     });\r\n        // };\r\n        // return new Promise<OnChangeTarget>(resolve => {\r\n        //     resolvePromise = resolve;\r\n        // });\r\n        var resolvePromise;\r\n        this._onChangeTargets = function () {\r\n            _this._onChangeTargets = null;\r\n            resolvePromise();\r\n        };\r\n        return new Promise(function (resolve) {\r\n            resolvePromise = resolve;\r\n        });\r\n    };\r\n    InitialMoveable.prototype.waitToChangeTargets = function () {\r\n        return this.waitToChangeTarget();\r\n    };\r\n    InitialMoveable.prototype.getManager = function () {\r\n        return this.moveable;\r\n    };\r\n    InitialMoveable.prototype.getMoveables = function () {\r\n        return this.moveable.getMoveables();\r\n    };\r\n    InitialMoveable.prototype.getDragElement = function () {\r\n        return this.moveable.getDragElement();\r\n    };\r\n    InitialMoveable.prototype._updateRefs = function (isRender) {\r\n        var prevRefTargets = this.refTargets;\r\n        var nextRefTargets = getRefTargets((this.props.target || this.props.targets));\r\n        var isBrowser = typeof document !== \"undefined\";\r\n        var isUpdate = compareRefTargets(prevRefTargets, nextRefTargets);\r\n        var selectorMap = this.selectorMap;\r\n        var nextSelectorMap = {};\r\n        this.refTargets.forEach(function updateSelectorMap(target) {\r\n            if (isString(target)) {\r\n                var selectorTarget = selectorMap[target];\r\n                if (selectorTarget) {\r\n                    nextSelectorMap[target] = selectorMap[target];\r\n                }\r\n                else if (isBrowser) {\r\n                    isUpdate = true;\r\n                    nextSelectorMap[target] = [].slice.call(document.querySelectorAll(target));\r\n                }\r\n            }\r\n            else if (isArray(target)) {\r\n                target.forEach(updateSelectorMap);\r\n            }\r\n        });\r\n        this._tmpRefTargets = nextRefTargets;\r\n        this._tmpSelectorMap = nextSelectorMap;\r\n        return [\r\n            nextRefTargets,\r\n            nextSelectorMap,\r\n            !isRender && isUpdate,\r\n        ];\r\n    };\r\n    InitialMoveable.prototype._checkChangeTargets = function () {\r\n        var _a, _b, _c;\r\n        this.refTargets = this._tmpRefTargets;\r\n        this.selectorMap = this._tmpSelectorMap;\r\n        var _d = this._differ.update(this._elementTargets), added = _d.added, removed = _d.removed;\r\n        var isTargetChanged = added.length || removed.length;\r\n        if (isTargetChanged) {\r\n            (_b = (_a = this.props).onChangeTargets) === null || _b === void 0 ? void 0 : _b.call(_a, {\r\n                moveable: this.moveable,\r\n                targets: this._elementTargets,\r\n            });\r\n            (_c = this._onChangeTargets) === null || _c === void 0 ? void 0 : _c.call(this);\r\n        }\r\n        var _e = __read(this._updateRefs(), 3), refTargets = _e[0], selectorMap = _e[1], isUpdate = _e[2];\r\n        this.refTargets = refTargets;\r\n        this.selectorMap = selectorMap;\r\n        if (isUpdate) {\r\n            this.forceUpdate();\r\n        }\r\n    };\r\n    InitialMoveable.defaultAbles = [];\r\n    InitialMoveable.customStyledMap = {};\r\n    InitialMoveable.defaultStyled = null;\r\n    __decorate([\r\n        withMethods(MOVEABLE_METHODS)\r\n    ], InitialMoveable.prototype, \"moveable\", void 0);\r\n    return InitialMoveable;\r\n}(React.PureComponent));\n\nvar Moveable = /*#__PURE__*/ (function (_super) {\r\n    __extends(Moveable, _super);\r\n    function Moveable() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Moveable.defaultAbles = MOVEABLE_ABLES;\r\n    return Moveable;\r\n}(InitialMoveable));\n\nfunction makeMoveable(ables) {\r\n    var _a;\r\n    return _a = /*#__PURE__*/ (function (_super) {\r\n            __extends(Moveable, _super);\r\n            function Moveable() {\r\n                return _super !== null && _super.apply(this, arguments) || this;\r\n            }\r\n            return Moveable;\r\n        }(InitialMoveable)),\r\n        _a.defaultAbles = ables,\r\n        _a;\r\n}\n\nexport { Clippable, DIRECTIONS, Draggable, edgeDraggable as EdgeDraggable, InitialMoveable, MOVEABLE_ABLES, MOVEABLE_EVENTS, MOVEABLE_METHODS, MOVEABLE_PROPS, Pinchable, Resizable, Rotatable, Roundable, Scalable, Snappable, Warpable, calculateElementPosition, Moveable as default, getElementInfo, makeAble, makeMoveable };\n","/*\nCopyright (c) 2019 Daybrush\nname: moveable\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/moveable/blob/master/packages/moveable\nversion: 0.53.0\n*/\nimport { ref, Properties } from 'framework-utils';\nimport * as React from 'croact';\nimport { renderSelf } from 'croact';\nimport Moveable$1, { MOVEABLE_PROPS, MOVEABLE_METHODS, MOVEABLE_EVENTS, getElementInfo as getElementInfo$1, makeAble as makeAble$1 } from 'croact-moveable';\nimport { camelize, getDocument, isArray } from '@daybrush/utils';\nimport EventEmitter from '@scena/event-emitter';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\n\nvar InnerMoveable = /*#__PURE__*/function (_super) {\n  __extends(InnerMoveable, _super);\n\n  function InnerMoveable(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {};\n    _this.state = _this.props;\n    return _this;\n  }\n\n  var __proto = InnerMoveable.prototype;\n\n  __proto.render = function () {\n    return React.createElement(Moveable$1, __assign({\n      ref: ref(this, \"moveable\")\n    }, this.state));\n  };\n\n  return InnerMoveable;\n}(React.Component);\n\nvar PROPERTIES = MOVEABLE_PROPS;\nvar METHODS = MOVEABLE_METHODS;\nvar EVENTS = MOVEABLE_EVENTS;\n\n/**\r\n * Moveable is Draggable! Resizable! Scalable! Rotatable!\r\n * @sort 1\r\n * @alias Moveable\r\n * @extends EventEmitter\r\n */\n\nvar MoveableManager = /*#__PURE__*/function (_super) {\n  __extends(MoveableManager, _super);\n  /**\r\n   *\r\n   */\n\n\n  function MoveableManager(parentElement, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.containerProvider = null;\n    _this.selfElement = null;\n    _this._warp = false;\n\n    var nextOptions = __assign({}, options);\n\n    var events = {};\n    EVENTS.forEach(function (name) {\n      events[camelize(\"on \".concat(name))] = function (e) {\n        return _this.trigger(name, e);\n      };\n    });\n    var selfElement;\n\n    if (options.warpSelf) {\n      delete options.warpSelf;\n      _this._warp = true;\n      selfElement = parentElement;\n    } else {\n      selfElement = getDocument(parentElement).createElement(\"div\");\n      parentElement.appendChild(selfElement);\n    }\n\n    _this.containerProvider = renderSelf(React.createElement(InnerMoveable, __assign({\n      ref: ref(_this, \"innerMoveable\")\n    }, nextOptions, events)), selfElement);\n    _this.selfElement = selfElement;\n    var target = nextOptions.target;\n\n    if (isArray(target) && target.length > 1) {\n      _this.updateRect();\n    }\n\n    return _this;\n  }\n\n  var __proto = MoveableManager.prototype;\n\n  __proto.setState = function (state, callback) {\n    this.innerMoveable.setState(state, callback);\n  };\n\n  __proto.forceUpdate = function (callback) {\n    this.innerMoveable.forceUpdate(callback);\n  };\n\n  __proto.dragStart = function (e, target) {\n    if (target === void 0) {\n      target = e.target;\n    }\n\n    var innerMoveable = this.innerMoveable;\n\n    if (innerMoveable.$_timer) {\n      this.forceUpdate();\n    }\n\n    this.getMoveable().dragStart(e, target);\n  };\n\n  __proto.destroy = function () {\n    var _a;\n\n    var selfElement = this.selfElement;\n    renderSelf(null, selfElement, this.containerProvider);\n\n    if (!this._warp) {\n      (_a = selfElement === null || selfElement === void 0 ? void 0 : selfElement.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(selfElement);\n    }\n\n    this.containerProvider = null;\n    this.off();\n    this.selfElement = null;\n    this.innerMoveable = null;\n  };\n\n  __proto.getMoveable = function () {\n    return this.innerMoveable.moveable;\n  };\n\n  MoveableManager = __decorate([Properties(METHODS, function (prototype, property) {\n    if (prototype[property]) {\n      return;\n    }\n\n    prototype[property] = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var self = this.getMoveable();\n\n      if (!self || !self[property]) {\n        return;\n      }\n\n      return self[property].apply(self, args);\n    };\n  }), Properties(PROPERTIES, function (prototype, property) {\n    Object.defineProperty(prototype, property, {\n      get: function () {\n        return this.getMoveable().props[property];\n      },\n      set: function (value) {\n        var _a;\n\n        this.setState((_a = {}, _a[property] = value, _a));\n      },\n      enumerable: true,\n      configurable: true\n    });\n  })], MoveableManager);\n  return MoveableManager;\n}(EventEmitter);\n\nvar Moveable = /*#__PURE__*/function (_super) {\n  __extends(Moveable, _super);\n\n  function Moveable() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Moveable;\n}(MoveableManager);\n\nfunction getElementInfo(target, container, rootContainer) {\n  return getElementInfo$1(target, container, rootContainer);\n}\nfunction makeAble(name, able) {\n  return makeAble$1(name, able);\n}\n\nexport { EVENTS, METHODS, PROPERTIES, Moveable as default, getElementInfo, makeAble };\n//# sourceMappingURL=moveable.esm.js.map\n","/*\nCopyright (c) Daybrush\nname: keycon\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/keycon.git\nversion: 1.2.2\n*/\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\n/*\nCopyright (c) 2018 Daybrush\n@name: @daybrush/utils\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/utils\n@version 1.7.1\n*/\n/**\n* get string \"object\"\n* @memberof Consts\n* @example\nimport {OBJECT} from \"@daybrush/utils\";\n\nconsole.log(OBJECT); // \"object\"\n*/\n\nvar OBJECT = \"object\";\n/**\n* get string \"string\"\n* @memberof Consts\n* @example\nimport {STRING} from \"@daybrush/utils\";\n\nconsole.log(STRING); // \"string\"\n*/\n\nvar STRING = \"string\";\n/**\n* Check the type that the value is object.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isObject} from \"@daybrush/utils\";\n\nconsole.log(isObject({})); // true\nconsole.log(isObject(undefined)); // false\nconsole.log(isObject(\"\")); // false\nconsole.log(isObject(null)); // false\n*/\n\nfunction isObject(value) {\n  return value && typeof value === OBJECT;\n}\n/**\n* Check the type that the value is isArray.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isArray} from \"@daybrush/utils\";\n\nconsole.log(isArray([])); // true\nconsole.log(isArray({})); // false\nconsole.log(isArray(undefined)); // false\nconsole.log(isArray(null)); // false\n*/\n\nfunction isArray(value) {\n  return Array.isArray(value);\n}\n/**\n* Check the type that the value is string.\n* @memberof Utils\n* @param {string} value - Value to check the type\n* @return {} true if the type is correct, false otherwise\n* @example\nimport {isString} from \"@daybrush/utils\";\n\nconsole.log(isString(\"1234\")); // true\nconsole.log(isString(undefined)); // false\nconsole.log(isString(1)); // false\nconsole.log(isString(null)); // false\n*/\n\nfunction isString(value) {\n  return typeof value === STRING;\n}\n/**\n* Returns the index of the first element in the array that satisfies the provided testing function.\n* @function\n* @memberof CrossBrowser\n* @param - The array `findIndex` was called upon.\n* @param - A function to execute on each value in the array until the function returns true, indicating that the satisfying element was found.\n* @param - Returns defaultIndex if not found by the function.\n* @example\nimport { findIndex } from \"@daybrush/utils\";\n\nfindIndex([{a: 1}, {a: 2}, {a: 3}, {a: 4}], ({ a }) => a === 2); // 1\n*/\n\nfunction findIndex(arr, callback, defaultIndex) {\n  if (defaultIndex === void 0) {\n    defaultIndex = -1;\n  }\n\n  var length = arr.length;\n\n  for (var i = 0; i < length; ++i) {\n    if (callback(arr[i], i, arr)) {\n      return i;\n    }\n  }\n\n  return defaultIndex;\n}\n/**\n* Sets up a function that will be called whenever the specified event is delivered to the target\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The object which receives a notification (an object that implements the Event interface) when an event of the specified type occurs\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent} from \"@daybrush/utils\";\n\naddEvent(el, \"click\", e => {\n  console.log(e);\n});\n*/\n\nfunction addEvent(el, type, listener, options) {\n  el.addEventListener(type, listener, options);\n}\n/**\n* removes from the EventTarget an event listener previously registered with EventTarget.addEventListener()\n* @memberof DOM\n* @param - event target\n* @param - A case-sensitive string representing the event type to listen for.\n* @param - The EventListener function of the event handler to remove from the event target.\n* @param - An options object that specifies characteristics about the event listener.\n* @example\nimport {addEvent, removeEvent} from \"@daybrush/utils\";\nconst listener = e => {\n  console.log(e);\n};\naddEvent(el, \"click\", listener);\nremoveEvent(el, \"click\", listener);\n*/\n\nfunction removeEvent(el, type, listener, options) {\n  el.removeEventListener(type, listener, options);\n}\n\n/*\nCopyright (c) 2019 Daybrush\nname: @scena/event-emitter\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/gesture.git\nversion: 1.0.5\n*/\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\n/**\n * Implement EventEmitter on object or component.\n */\n\nvar EventEmitter =\n/*#__PURE__*/\nfunction () {\n  function EventEmitter() {\n    this._events = {};\n  }\n  /**\n   * Add a listener to the registered event.\n   * @param - Name of the event to be added\n   * @param - listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add listener in \"a\" event\n   * emitter.on(\"a\", () => {\n   * });\n   * // Add listeners\n   * emitter.on({\n   *  a: () => {},\n   *  b: () => {},\n   * });\n   */\n\n\n  var __proto = EventEmitter.prototype;\n\n  __proto.on = function (eventName, listener) {\n    if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.on(name, eventName[name]);\n      }\n    } else {\n      this._addEvent(eventName, listener, {});\n    }\n\n    return this;\n  };\n  /**\n   * Remove listeners registered in the event target.\n   * @param - Name of the event to be removed\n   * @param - listener function of the event to be removed\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Remove all listeners.\n   * emitter.off();\n   *\n   * // Remove all listeners in \"A\" event.\n   * emitter.off(\"a\");\n   *\n   *\n   * // Remove \"listener\" listener in \"a\" event.\n   * emitter.off(\"a\", listener);\n   */\n\n\n  __proto.off = function (eventName, listener) {\n    if (!eventName) {\n      this._events = {};\n    } else if (isObject(eventName)) {\n      for (var name in eventName) {\n        this.off(name);\n      }\n    } else if (!listener) {\n      this._events[eventName] = [];\n    } else {\n      var events = this._events[eventName];\n\n      if (events) {\n        var index = findIndex(events, function (e) {\n          return e.listener === listener;\n        });\n\n        if (index > -1) {\n          events.splice(index, 1);\n        }\n      }\n    }\n\n    return this;\n  };\n  /**\n   * Add a disposable listener and Use promise to the registered event.\n   * @param - Name of the event to be added\n   * @param - disposable listener function of the event to be added\n   * @example\n   * import EventEmitter from \"@scena/event-emitter\";\n   * cosnt emitter = new EventEmitter();\n   *\n   * // Add a disposable listener in \"a\" event\n   * emitter.once(\"a\", () => {\n   * });\n   *\n   * // Use Promise\n   * emitter.once(\"a\").then(e => {\n   * });\n   */\n\n\n  __proto.once = function (eventName, listener) {\n    var _this = this;\n\n    if (listener) {\n      this._addEvent(eventName, listener, {\n        once: true\n      });\n    }\n\n    return new Promise(function (resolve) {\n      _this._addEvent(eventName, resolve, {\n        once: true\n      });\n    });\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n\n  __proto.emit = function (eventName, param) {\n    var _this = this;\n\n    if (param === void 0) {\n      param = {};\n    }\n\n    var events = this._events[eventName];\n\n    if (!eventName || !events) {\n      return true;\n    }\n\n    var isStop = false;\n    param.eventType = eventName;\n\n    param.stop = function () {\n      isStop = true;\n    };\n\n    param.currentTarget = this;\n\n    __spreadArrays(events).forEach(function (info) {\n      info.listener(param);\n\n      if (info.once) {\n        _this.off(eventName, info.listener);\n      }\n    });\n\n    return !isStop;\n  };\n  /**\n   * Fires an event to call listeners.\n   * @param - Event name\n   * @param - Event parameter\n   * @return If false, stop the event.\n   * @example\n   *\n   * import EventEmitter from \"@scena/event-emitter\";\n   *\n   *\n   * const emitter = new EventEmitter();\n   *\n   * emitter.on(\"a\", e => {\n   * });\n   *\n   *\n   * emitter.emit(\"a\", {\n   *   a: 1,\n   * });\n   */\n\n  /**\n  * Fires an event to call listeners.\n  * @param - Event name\n  * @param - Event parameter\n  * @return If false, stop the event.\n  * @example\n  *\n  * import EventEmitter from \"@scena/event-emitter\";\n  *\n  *\n  * const emitter = new EventEmitter();\n  *\n  * emitter.on(\"a\", e => {\n  * });\n  *\n  * // emit\n  * emitter.trigger(\"a\", {\n  *   a: 1,\n  * });\n  */\n\n\n  __proto.trigger = function (eventName, param) {\n    if (param === void 0) {\n      param = {};\n    }\n\n    return this.emit(eventName, param);\n  };\n\n  __proto._addEvent = function (eventName, listener, options) {\n    var events = this._events;\n    events[eventName] = events[eventName] || [];\n    var listeners = events[eventName];\n    listeners.push(__assign({\n      listener: listener\n    }, options));\n  };\n\n  return EventEmitter;\n}();\n\nfunction createCommonjsModule(fn, module) {\n  return module = {\n    exports: {}\n  }, fn(module, module.exports), module.exports;\n}\n\nvar keycode = createCommonjsModule(function (module, exports) {\n// Source: http://jsfiddle.net/vWx8V/\n// http://stackoverflow.com/questions/5603195/full-list-of-javascript-keycodes\n\n/**\n * Conenience method returns corresponding value for given keyName or keyCode.\n *\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Mixed}\n * @api public\n */\n\nfunction keyCode(searchInput) {\n  // Keyboard Events\n  if (searchInput && 'object' === typeof searchInput) {\n    var hasKeyCode = searchInput.which || searchInput.keyCode || searchInput.charCode;\n    if (hasKeyCode) searchInput = hasKeyCode;\n  }\n\n  // Numbers\n  if ('number' === typeof searchInput) return names[searchInput]\n\n  // Everything else (cast to string)\n  var search = String(searchInput);\n\n  // check codes\n  var foundNamedKey = codes[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // check aliases\n  var foundNamedKey = aliases[search.toLowerCase()];\n  if (foundNamedKey) return foundNamedKey\n\n  // weird character?\n  if (search.length === 1) return search.charCodeAt(0)\n\n  return undefined\n}\n\n/**\n * Compares a keyboard event with a given keyCode or keyName.\n *\n * @param {Event} event Keyboard event that should be tested\n * @param {Mixed} keyCode {Number} or keyName {String}\n * @return {Boolean}\n * @api public\n */\nkeyCode.isEventKey = function isEventKey(event, nameOrCode) {\n  if (event && 'object' === typeof event) {\n    var keyCode = event.which || event.keyCode || event.charCode;\n    if (keyCode === null || keyCode === undefined) { return false; }\n    if (typeof nameOrCode === 'string') {\n      // check codes\n      var foundNamedKey = codes[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    \n      // check aliases\n      var foundNamedKey = aliases[nameOrCode.toLowerCase()];\n      if (foundNamedKey) { return foundNamedKey === keyCode; }\n    } else if (typeof nameOrCode === 'number') {\n      return nameOrCode === keyCode;\n    }\n    return false;\n  }\n};\n\nexports = module.exports = keyCode;\n\n/**\n * Get by name\n *\n *   exports.code['enter'] // => 13\n */\n\nvar codes = exports.code = exports.codes = {\n  'backspace': 8,\n  'tab': 9,\n  'enter': 13,\n  'shift': 16,\n  'ctrl': 17,\n  'alt': 18,\n  'pause/break': 19,\n  'caps lock': 20,\n  'esc': 27,\n  'space': 32,\n  'page up': 33,\n  'page down': 34,\n  'end': 35,\n  'home': 36,\n  'left': 37,\n  'up': 38,\n  'right': 39,\n  'down': 40,\n  'insert': 45,\n  'delete': 46,\n  'command': 91,\n  'left command': 91,\n  'right command': 93,\n  'numpad *': 106,\n  'numpad +': 107,\n  'numpad -': 109,\n  'numpad .': 110,\n  'numpad /': 111,\n  'num lock': 144,\n  'scroll lock': 145,\n  'my computer': 182,\n  'my calculator': 183,\n  ';': 186,\n  '=': 187,\n  ',': 188,\n  '-': 189,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '[': 219,\n  '\\\\': 220,\n  ']': 221,\n  \"'\": 222\n};\n\n// Helper aliases\n\nvar aliases = exports.aliases = {\n  'windows': 91,\n  '': 16,\n  '': 18,\n  '': 17,\n  '': 91,\n  'ctl': 17,\n  'control': 17,\n  'option': 18,\n  'pause': 19,\n  'break': 19,\n  'caps': 20,\n  'return': 13,\n  'escape': 27,\n  'spc': 32,\n  'spacebar': 32,\n  'pgup': 33,\n  'pgdn': 34,\n  'ins': 45,\n  'del': 46,\n  'cmd': 91\n};\n\n/*!\n * Programatically add the following\n */\n\n// lower case chars\nfor (i = 97; i < 123; i++) codes[String.fromCharCode(i)] = i - 32;\n\n// numbers\nfor (var i = 48; i < 58; i++) codes[i - 48] = i;\n\n// function keys\nfor (i = 1; i < 13; i++) codes['f'+i] = i + 111;\n\n// numpad keys\nfor (i = 0; i < 10; i++) codes['numpad '+i] = i + 96;\n\n/**\n * Get by code\n *\n *   exports.name[13] // => 'Enter'\n */\n\nvar names = exports.names = exports.title = {}; // title for backward compat\n\n// Create reverse mapping\nfor (i in codes) names[codes[i]] = i;\n\n// Add aliases\nfor (var alias in aliases) {\n  codes[alias] = aliases[alias];\n}\n});\nvar keycode_1 = keycode.code;\nvar keycode_2 = keycode.codes;\nvar keycode_3 = keycode.aliases;\nvar keycode_4 = keycode.names;\nvar keycode_5 = keycode.title;\n\nvar codeData = {\n  \"+\": \"plus\",\n  \"left command\": \"meta\",\n  \"right command\": \"meta\"\n};\nvar keysSort = {\n  shift: 1,\n  ctrl: 2,\n  alt: 3,\n  meta: 4\n};\n/**\n * @memberof KeyController\n */\n\nfunction getKey(keyCode, keyName) {\n  var key = (keycode_4[keyCode] || keyName || \"\").toLowerCase();\n\n  for (var name in codeData) {\n    key = key.replace(name, codeData[name]);\n  }\n\n  return key.replace(/\\s/g, \"\");\n}\n/**\n * @memberof KeyController\n */\n\nfunction getCombi(e, key) {\n  if (key === void 0) {\n    key = getKey(e.keyCode, e.key);\n  }\n\n  var keys = getModifierCombi(e);\n  keys.indexOf(key) === -1 && keys.push(key);\n  return keys.filter(Boolean);\n}\n/**\n * @memberof KeyController\n */\n\nfunction getModifierCombi(e) {\n  var keys = [e.shiftKey && \"shift\", e.ctrlKey && \"ctrl\", e.altKey && \"alt\", e.metaKey && \"meta\"];\n  return keys.filter(Boolean);\n}\n\nfunction getArrangeCombi(keys) {\n  var arrangeKeys = keys.slice();\n  arrangeKeys.sort(function (prev, next) {\n    var prevScore = keysSort[prev] || 5;\n    var nextScore = keysSort[next] || 5;\n    return prevScore - nextScore;\n  });\n  return arrangeKeys;\n}\n\nvar globalKeyController;\n/**\n */\n\nvar KeyController =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(KeyController, _super);\n  /**\n   *\n   */\n\n\n  function KeyController(container) {\n    if (container === void 0) {\n      container = window;\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.container = container;\n    /**\n     */\n\n    _this.ctrlKey = false;\n    /**\n     */\n\n    _this.altKey = false;\n    /**\n     *\n     */\n\n    _this.shiftKey = false;\n    /**\n     *\n     */\n\n    _this.metaKey = false;\n\n    _this.clear = function () {\n      _this.ctrlKey = false;\n      _this.altKey = false;\n      _this.shiftKey = false;\n      _this.metaKey = false;\n      return _this;\n    };\n\n    _this.keydownEvent = function (e) {\n      _this.triggerEvent(\"keydown\", e);\n    };\n\n    _this.keyupEvent = function (e) {\n      _this.triggerEvent(\"keyup\", e);\n    };\n\n    _this.blur = function () {\n      _this.clear();\n\n      _this.trigger(\"blur\");\n    };\n\n    addEvent(container, \"blur\", _this.blur);\n    addEvent(container, \"keydown\", _this.keydownEvent);\n    addEvent(container, \"keyup\", _this.keyupEvent);\n    return _this;\n  }\n\n  var __proto = KeyController.prototype;\n  Object.defineProperty(KeyController, \"global\", {\n    /**\n     */\n    get: function () {\n      return globalKeyController || (globalKeyController = new KeyController());\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  KeyController.setGlobal = function () {\n    return this.global;\n  };\n  /**\n   *\n   */\n\n\n  __proto.destroy = function () {\n    var container = this.container;\n    this.clear();\n    this.off();\n    removeEvent(container, \"blur\", this.blur);\n    removeEvent(container, \"keydown\", this.keydownEvent);\n    removeEvent(container, \"keyup\", this.keyupEvent);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keydown = function (comb, callback) {\n    return this.addEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeydown = function (comb, callback) {\n    return this.removeEvent(\"keydown\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.offKeyup = function (comb, callback) {\n    return this.removeEvent(\"keyup\", comb, callback);\n  };\n  /**\n   *\n   */\n\n\n  __proto.keyup = function (comb, callback) {\n    return this.addEvent(\"keyup\", comb, callback);\n  };\n\n  __proto.addEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.on(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.on(type + \".\" + comb, callback);\n    } else {\n      this.on(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.removeEvent = function (type, comb, callback) {\n    if (isArray(comb)) {\n      this.off(type + \".\" + getArrangeCombi(comb).join(\".\"), callback);\n    } else if (isString(comb)) {\n      this.off(type + \".\" + comb, callback);\n    } else {\n      this.off(type, comb);\n    }\n\n    return this;\n  };\n\n  __proto.triggerEvent = function (type, e) {\n    this.ctrlKey = e.ctrlKey;\n    this.shiftKey = e.shiftKey;\n    this.altKey = e.altKey;\n    this.metaKey = e.metaKey;\n    var key = getKey(e.keyCode, e.key);\n    var isToggle = key === \"ctrl\" || key === \"shift\" || key === \"meta\" || key === \"alt\";\n    var param = {\n      key: key,\n      isToggle: isToggle,\n      inputEvent: e,\n      keyCode: e.keyCode,\n      ctrlKey: e.ctrlKey,\n      altKey: e.altKey,\n      shiftKey: e.shiftKey,\n      metaKey: e.metaKey\n    };\n    this.trigger(type, param);\n    this.trigger(type + \".\" + key, param);\n    var combi = getCombi(e, key);\n    combi.length > 1 && this.trigger(type + \".\" + combi.join(\".\"), param);\n  };\n\n  return KeyController;\n}(EventEmitter);\n\nexport default KeyController;\nexport { getCombi, getKey, getModifierCombi };\n//# sourceMappingURL=keycon.esm.js.map\n","/*\nCopyright (c) 2020 Daybrush\nname: selecto\nlicense: MIT\nauthor: Daybrush\nrepository: git+https://github.com/daybrush/selecto.git\nversion: 1.26.3\n*/\nimport EventEmitter from '@scena/event-emitter';\nimport Gesto from 'gesto';\nimport { Properties } from 'framework-utils';\nimport { getDocument, hasClass, addClass, calculateBoundSize, getDist, getWindow, isObject, isString, isNode, removeEvent, isFunction, addEvent, isArray, camelize, splitUnit, between } from '@daybrush/utils';\nimport { diff } from '@egjs/children-differ';\nimport DragScroll from '@scena/dragscroll';\nimport KeyController, { getCombi } from 'keycon';\nimport { fitPoints, getOverlapPoints, isInside, getAreaSize } from 'overlap-area';\nimport { createMatrix, getDistElementMatrix, calculateMatrixDist } from 'css-to-mat';\nimport styled from 'css-styled';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\nfunction __rest(s, e) {\n  var t = {};\n\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n}\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\nfunction __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nfunction getClient(e) {\n  if (\"touches\" in e) {\n    var touch = e.touches[0] || e.changedTouches[0];\n    return {\n      clientX: touch.clientX,\n      clientY: touch.clientY\n    };\n  } else {\n    return {\n      clientX: e.clientX,\n      clientY: e.clientY\n    };\n  }\n}\nfunction filterDuplicated(arr) {\n  if (typeof Map === \"undefined\") {\n    return arr.filter(function (value, index) {\n      return arr.indexOf(value) === index;\n    });\n  }\n\n  var map = new Map();\n  return arr.filter(function (value) {\n    if (map.has(value)) {\n      return false;\n    }\n\n    map.set(value, true);\n    return true;\n  });\n}\nfunction elementFromPoint(baseNode, clientX, clientY) {\n  var doc = getDocument(baseNode);\n  return doc.elementFromPoint && doc.elementFromPoint(clientX, clientY) || null;\n}\nfunction createElement(jsx, prevTarget, container) {\n  var tag = jsx.tag,\n      children = jsx.children,\n      attributes = jsx.attributes,\n      className = jsx.className,\n      style = jsx.style;\n  var el = prevTarget || getDocument(container).createElement(tag);\n\n  for (var name in attributes) {\n    el.setAttribute(name, attributes[name]);\n  }\n\n  var elChildren = el.children;\n  children.forEach(function (child, i) {\n    createElement(child, elChildren[i], el);\n  });\n\n  if (className) {\n    className.split(/\\s+/g).forEach(function (name) {\n      if (name && !hasClass(el, name)) {\n        addClass(el, name);\n      }\n    });\n  }\n\n  if (style) {\n    var elStyle = el.style;\n\n    for (var name in style) {\n      elStyle[name] = style[name];\n    }\n  }\n\n  if (!prevTarget && container) {\n    container.appendChild(el);\n  }\n\n  return el;\n}\nfunction h(tag, attrs) {\n  var children = [];\n\n  for (var _i = 2; _i < arguments.length; _i++) {\n    children[_i - 2] = arguments[_i];\n  }\n\n  var _a = attrs || {},\n      _b = _a.className,\n      className = _b === void 0 ? \"\" : _b,\n      _c = _a.style,\n      style = _c === void 0 ? {} : _c,\n      attributes = __rest(_a, [\"className\", \"style\"]);\n\n  return {\n    tag: tag,\n    className: className,\n    style: style,\n    attributes: attributes,\n    children: children\n  };\n}\nfunction diffValue(prev, cur, func) {\n  if (prev !== cur) {\n    func(prev, cur);\n  }\n}\nfunction getRect(e, ratio, boundArea) {\n  var _a;\n\n  if (boundArea === void 0) {\n    boundArea = e.data.boundArea;\n  }\n\n  var _b = e.distX,\n      distX = _b === void 0 ? 0 : _b,\n      _c = e.distY,\n      distY = _c === void 0 ? 0 : _c;\n  var _d = e.data,\n      startX = _d.startX,\n      startY = _d.startY;\n\n  if (ratio > 0) {\n    var nextHeight = Math.sqrt((distX * distX + distY * distY) / (1 + ratio * ratio));\n    var nextWidth = ratio * nextHeight;\n    distX = (distX >= 0 ? 1 : -1) * nextWidth;\n    distY = (distY >= 0 ? 1 : -1) * nextHeight;\n  }\n\n  var width = Math.abs(distX);\n  var height = Math.abs(distY);\n  var maxWidth = distX < 0 ? startX - boundArea.left : boundArea.right - startX;\n  var maxHeight = distY < 0 ? startY - boundArea.top : boundArea.bottom - startY;\n  _a = calculateBoundSize([width, height], [0, 0], [maxWidth, maxHeight], !!ratio), width = _a[0], height = _a[1];\n  distX = (distX >= 0 ? 1 : -1) * width;\n  distY = (distY >= 0 ? 1 : -1) * height;\n  var tx = Math.min(0, distX);\n  var ty = Math.min(0, distY);\n  var left = startX + tx;\n  var top = startY + ty;\n  return {\n    left: left,\n    top: top,\n    right: left + width,\n    bottom: top + height,\n    width: width,\n    height: height\n  };\n}\nfunction getDefaultElementRect(el) {\n  var rect = el.getBoundingClientRect();\n  var left = rect.left,\n      top = rect.top,\n      width = rect.width,\n      height = rect.height;\n  return {\n    pos1: [left, top],\n    pos2: [left + width, top],\n    pos3: [left, top + height],\n    pos4: [left + width, top + height]\n  };\n}\nfunction passTargets(beforeTargets, afterTargets, continueSelectWithoutDeselect) {\n  var _a = diff(beforeTargets, afterTargets),\n      list = _a.list,\n      prevList = _a.prevList,\n      added = _a.added,\n      removed = _a.removed,\n      maintained = _a.maintained;\n\n  return __spreadArray(__spreadArray(__spreadArray([], added.map(function (index) {\n    return list[index];\n  }), true), removed.map(function (index) {\n    return prevList[index];\n  }), true), continueSelectWithoutDeselect ? maintained.map(function (_a) {\n    var nextIndex = _a[1];\n    return list[nextIndex];\n  }) : [], true);\n}\nfunction getLineSize(points) {\n  var size = 0;\n  var length = points.length;\n\n  for (var i = 1; i < length; ++i) {\n    size = Math.max(getDist(points[i], points[i - 1]), size);\n  }\n\n  return size;\n}\n\nvar injector = styled(\"\\n:host {\\n    position: fixed;\\n    display: none;\\n    border: 1px solid #4af;\\n    background: rgba(68, 170, 255, 0.5);\\n    pointer-events: none;\\n    will-change: transform;\\n    z-index: 100;\\n}\\n\");\n/**\n * @memberof Selecto\n */\n\nvar CLASS_NAME = \"selecto-selection \".concat(injector.className);\nvar PROPERTIES = [\"className\", \"boundContainer\", \"selectableTargets\", \"selectByClick\", \"selectFromInside\", \"continueSelect\", \"continueSelectWithoutDeselect\", \"toggleContinueSelect\", \"toggleContinueSelectWithoutDeselect\", \"keyContainer\", \"hitRate\", \"scrollOptions\", \"checkInput\", \"preventDefault\", \"ratio\", \"getElementRect\", \"preventDragFromInside\", \"rootContainer\", \"dragCondition\", \"clickBySelectEnd\", \"checkOverflow\", \"innerScrollOptions\"];\n/**\n * @memberof Selecto\n */\n\nvar OPTIONS = __spreadArray([// ignore target, container,\n\"dragContainer\", \"cspNonce\", \"preventClickEventOnDrag\", \"preventClickEventOnDragStart\", \"preventRightClick\"], PROPERTIES, true);\nvar OPTION_TYPES = {\n  className: String,\n  boundContainer: null,\n  portalContainer: null,\n  container: null,\n  dragContainer: null,\n  selectableTargets: Array,\n  selectByClick: Boolean,\n  selectFromInside: Boolean,\n  continueSelect: Boolean,\n  toggleContinueSelect: Array,\n  toggleContinueSelectWithoutDeselect: Array,\n  keyContainer: null,\n  hitRate: Number,\n  scrollOptions: Object,\n  checkInput: Boolean,\n  preventDefault: Boolean,\n  cspNonce: String,\n  ratio: Number,\n  getElementRect: Function,\n  preventDragFromInside: Boolean,\n  rootContainer: Object,\n  dragCondition: Function,\n  clickBySelectEnd: Boolean,\n  continueSelectWithoutDeselect: Boolean,\n  preventClickEventOnDragStart: Boolean,\n  preventClickEventOnDrag: Boolean,\n  checkOverflow: Boolean,\n  innerScrollOptions: Object\n};\n/**\n * @memberof Selecto\n */\n\nvar EVENTS = [\"dragStart\", \"drag\", \"dragEnd\", \"selectStart\", \"select\", \"selectEnd\", \"keydown\", \"keyup\", \"scroll\", \"innerScroll\"];\n/**\n * @memberof Selecto\n */\n\nvar METHODS = [\"clickTarget\", \"getSelectableElements\", \"setSelectedTargets\", \"getElementPoints\", \"getSelectedTargets\", \"findSelectableTargets\", \"triggerDragStart\", \"checkScroll\", \"selectTargetsByPoints\", \"setSelectedTargetsByPoints\"];\n\n/**\n * Selecto.js is a component that allows you to select elements in the drag area using the mouse or touch.\n * @sort 1\n * @extends EventEmitter\n */\n\nvar Selecto =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n  /**\n   *\n   */\n\n\n  function Selecto(options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    var _this = _super.call(this) || this;\n\n    _this.selectedTargets = [];\n    _this.dragScroll = new DragScroll();\n\n    _this._onDragStart = function (e, clickedTarget) {\n      var data = e.data,\n          clientX = e.clientX,\n          clientY = e.clientY,\n          inputEvent = e.inputEvent;\n      var _a = _this.options,\n          selectFromInside = _a.selectFromInside,\n          selectByClick = _a.selectByClick,\n          rootContainer = _a.rootContainer,\n          boundContainer = _a.boundContainer,\n          _b = _a.preventDragFromInside,\n          preventDragFromInside = _b === void 0 ? true : _b,\n          clickBySelectEnd = _a.clickBySelectEnd,\n          dragCondition = _a.dragCondition;\n\n      if (dragCondition && !dragCondition(e)) {\n        e.stop();\n        return;\n      }\n\n      data.data = {};\n      var win = getWindow(_this.container);\n      data.innerWidth = win.innerWidth;\n      data.innerHeight = win.innerHeight;\n\n      _this.findSelectableTargets(data);\n\n      data.startSelectedTargets = _this.selectedTargets;\n      data.scaleMatrix = createMatrix();\n      data.containerX = 0;\n      data.containerY = 0;\n      var container = _this.container;\n      var boundArea = {\n        left: -Infinity,\n        top: -Infinity,\n        right: Infinity,\n        bottom: Infinity\n      };\n\n      if (rootContainer) {\n        var containerRect = _this.container.getBoundingClientRect();\n\n        data.containerX = containerRect.left;\n        data.containerY = containerRect.top;\n        data.scaleMatrix = getDistElementMatrix(_this.container, rootContainer);\n      }\n\n      if (boundContainer) {\n        var boundInfo = isObject(boundContainer) && \"element\" in boundContainer ? __assign({\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        }, boundContainer) : {\n          element: boundContainer,\n          left: true,\n          top: true,\n          bottom: true,\n          right: true\n        };\n        var boundElement = boundInfo.element;\n        var rectElement = void 0;\n\n        if (boundElement) {\n          if (isString(boundElement)) {\n            rectElement = getDocument(container).querySelector(boundElement);\n          } else if (boundElement === true) {\n            rectElement = _this.container;\n          } else {\n            rectElement = boundElement;\n          }\n\n          var rect = rectElement.getBoundingClientRect();\n\n          if (boundInfo.left) {\n            boundArea.left = rect.left;\n          }\n\n          if (boundInfo.top) {\n            boundArea.top = rect.top;\n          }\n\n          if (boundInfo.right) {\n            boundArea.right = rect.right;\n          }\n\n          if (boundInfo.bottom) {\n            boundArea.bottom = rect.bottom;\n          }\n        }\n      }\n\n      data.boundArea = boundArea;\n      var hitRect = {\n        left: clientX,\n        top: clientY,\n        right: clientX,\n        bottom: clientY,\n        width: 0,\n        height: 0\n      };\n      var firstPassedTargets = []; // allow click on select\n\n      var allowClickBySelectEnd = selectByClick && !clickBySelectEnd;\n      var hasInsideTargets = false;\n\n      if (!selectFromInside || allowClickBySelectEnd) {\n        var pointTarget = _this._findElement(clickedTarget || inputEvent.target, // elementFromPoint(clientX, clientY),\n        data.selectableTargets);\n\n        hasInsideTargets = !!pointTarget;\n\n        if (allowClickBySelectEnd) {\n          firstPassedTargets = pointTarget ? [pointTarget] : [];\n        }\n      }\n\n      var isPreventSelect = !selectFromInside && hasInsideTargets; // prevent drag from inside when selectByClick is false\n\n      if (isPreventSelect && !selectByClick) {\n        e.stop();\n        return false;\n      }\n\n      var type = inputEvent.type;\n      var isTrusted = type === \"mousedown\" || type === \"touchstart\";\n      /**\n       * When the drag starts (triggers on mousedown or touchstart), the dragStart event is called.\n       * Call the stop () function if you have a specific element or don't want to raise a select\n       * @memberof Selecto\n       * @event dragStart\n       * @param {OnDragStart} - Parameters for the dragStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"dragStart\", e => {\n       *   if (e.inputEvent.target.tagName === \"SPAN\") {\n       *     e.stop();\n       *   }\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n      var result = !e.isClick && isTrusted ? _this.emit(\"dragStart\", __assign(__assign({}, e), {\n        data: data.data\n      })) : true;\n\n      if (!result) {\n        e.stop();\n        return false;\n      }\n\n      if (_this.continueSelect) {\n        firstPassedTargets = passTargets(_this.selectedTargets, firstPassedTargets, _this.continueSelectWithoutDeselect);\n        data.startPassedTargets = _this.selectedTargets;\n      } else {\n        data.startPassedTargets = [];\n      }\n\n      _this._select(firstPassedTargets, hitRect, e, true, isPreventSelect && selectByClick && !clickBySelectEnd && preventDragFromInside);\n\n      data.startX = clientX;\n      data.startY = clientY;\n      data.selectFlag = false;\n      data.preventDragFromInside = false;\n\n      if (inputEvent.target) {\n        var offsetPos = calculateMatrixDist(data.scaleMatrix, [clientX - data.containerX, clientY - data.containerY]);\n        _this.target.style.cssText += \"position: \".concat(rootContainer ? \"absolute\" : \"fixed\", \";\") + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px)\");\n      }\n\n      if (isPreventSelect && selectByClick && !clickBySelectEnd) {\n        inputEvent.preventDefault(); // prevent drag from inside when selectByClick is true and force call `selectEnd`\n\n        if (preventDragFromInside) {\n          _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, hitRect, e, true);\n\n          data.preventDragFromInside = true;\n        }\n      } else {\n        data.selectFlag = true; // why?\n        // if (type === \"touchstart\") {\n        //     inputEvent.preventDefault();\n        // }\n\n        var _c = _this.options,\n            scrollOptions = _c.scrollOptions,\n            innerScrollOptions = _c.innerScrollOptions;\n        var isInnerScroll = false;\n\n        if (innerScrollOptions) {\n          var inputEvent_1 = e.inputEvent;\n          var target = inputEvent_1.target;\n          var innerScrollElement = null;\n          var parentElement = target;\n\n          while (parentElement && parentElement !== getDocument(container).body) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              innerScrollElement = parentElement;\n              break;\n            }\n\n            parentElement = parentElement.parentElement;\n          }\n\n          if (innerScrollElement) {\n            data.innerScrollOptions = __assign({\n              container: innerScrollElement,\n              checkScrollEvent: true\n            }, innerScrollOptions === true ? {} : innerScrollOptions);\n\n            _this.dragScroll.dragStart(e, data.innerScrollOptions);\n\n            isInnerScroll = true;\n          }\n        }\n\n        if (!isInnerScroll && scrollOptions && scrollOptions.container) {\n          _this.dragScroll.dragStart(e, scrollOptions);\n        }\n\n        if (isPreventSelect && selectByClick && clickBySelectEnd) {\n          data.selectFlag = false;\n          e.preventDrag();\n        }\n      }\n\n      return true;\n    };\n\n    _this._onDrag = function (e) {\n      if (e.data.selectFlag) {\n        var scrollOptions = _this.scrollOptions;\n        var innerScrollOptions = e.data.innerScrollOptions;\n        var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n        if (hasScrollOptions && !e.isScroll && _this.dragScroll.drag(e, innerScrollOptions || scrollOptions)) {\n          return;\n        }\n      }\n\n      _this._checkSelected(e);\n    };\n\n    _this._onDragEnd = function (e) {\n      var data = e.data,\n          inputEvent = e.inputEvent;\n      var rect = getRect(e, _this.options.ratio);\n      var selectFlag = data.selectFlag;\n      var container = _this.container;\n      /**\n       * When the drag ends (triggers on mouseup or touchend after drag), the dragEnd event is called.\n       * @memberof Selecto\n       * @event dragEnd\n       * @param {OnDragEnd} - Parameters for the dragEnd event\n       */\n\n      if (inputEvent) {\n        _this.emit(\"dragEnd\", __assign(__assign({\n          isDouble: !!e.isDouble,\n          isClick: !!e.isClick,\n          isDrag: false,\n          isSelect: selectFlag\n        }, e), {\n          data: data.data,\n          rect: rect\n        }));\n      }\n\n      _this.target.style.cssText += \"display: none;\";\n\n      if (selectFlag) {\n        data.selectFlag = false;\n\n        _this.dragScroll.dragEnd();\n      } else if (_this.selectByClick && _this.clickBySelectEnd) {\n        // only clickBySelectEnd\n        var pointTarget = _this._findElement((inputEvent === null || inputEvent === void 0 ? void 0 : inputEvent.target) || elementFromPoint(container, e.clientX, e.clientY), data.selectableTargets);\n\n        _this._select(pointTarget ? [pointTarget] : [], rect, e);\n      }\n\n      if (!data.preventDragFromInside) {\n        _this._selectEnd(data.startSelectedTargets, data.startPassedTargets, rect, e);\n      }\n    };\n\n    _this._onKeyDown = function (e) {\n      var options = _this.options;\n      var isKeyDown = false;\n\n      if (!_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect);\n\n        _this._keydownContinueSelect = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect);\n\n        _this._keydownContinueSelectWithoutDeselection = result;\n        isKeyDown || (isKeyDown = result);\n      }\n\n      if (!isKeyDown) {\n        return;\n      }\n      /**\n       * When you keydown the key you specified in toggleContinueSelect, the keydown event is called.\n       * @memberof Selecto\n       * @event keydown\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keydown\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onKeyUp = function (e) {\n      var options = _this.options;\n      var isKeyUp = false;\n\n      if (_this._keydownContinueSelect) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelect, true);\n\n        _this._keydownContinueSelect = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (_this._keydownContinueSelectWithoutDeselection) {\n        var result = _this._sameCombiKey(e, options.toggleContinueSelectWithoutDeselect, true);\n\n        _this._keydownContinueSelectWithoutDeselection = !result;\n        isKeyUp || (isKeyUp = result);\n      }\n\n      if (!isKeyUp) {\n        return;\n      }\n      /**\n       * When you keyup the key you specified in toggleContinueSelect, the keyup event is called.\n       * @memberof Selecto\n       * @event keyup\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   toggleContinueSelect: \"shift\";\n       *   keyContainer: window,\n       * });\n       *\n       * selecto.on(\"keydown\", () => {\n       *   document.querySelector(\".button\").classList.add(\"selected\");\n       * }).on(\"keyup\", () => {\n       *   document.querySelector(\".button\").classList.remove(\"selected\");\n       * }).on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n\n\n      _this.emit(\"keyup\", {\n        keydownContinueSelect: _this._keydownContinueSelect,\n        keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n      });\n    };\n\n    _this._onBlur = function () {\n      if (_this._keydownContinueSelect || _this._keydownContinueSelectWithoutDeselection) {\n        _this._keydownContinueSelect = false;\n        _this._keydownContinueSelectWithoutDeselection = false;\n\n        _this.emit(\"keyup\", {\n          keydownContinueSelect: _this._keydownContinueSelect,\n          keydownContinueSelectWithoutDeselection: _this._keydownContinueSelectWithoutDeselection\n        });\n      }\n    };\n\n    _this._onDocumentSelectStart = function (e) {\n      var doc = getDocument(_this.container);\n\n      if (!_this.gesto.isFlag()) {\n        return;\n      }\n\n      var dragContainer = _this.dragContainer;\n\n      if (dragContainer === getWindow(_this.container)) {\n        dragContainer = doc.documentElement;\n      }\n\n      var containers = isNode(dragContainer) ? [dragContainer] : [].slice.call(dragContainer);\n      var target = e.target;\n      containers.some(function (container) {\n        if (container === target || container.contains(target)) {\n          e.preventDefault();\n          return true;\n        }\n      });\n    };\n\n    _this.target = options.portalContainer;\n    var container = options.container;\n    _this.options = __assign({\n      className: \"\",\n      portalContainer: null,\n      container: null,\n      dragContainer: null,\n      selectableTargets: [],\n      selectByClick: true,\n      selectFromInside: true,\n      clickBySelectEnd: false,\n      hitRate: 100,\n      continueSelect: false,\n      continueSelectWithoutDeselect: false,\n      toggleContinueSelect: null,\n      toggleContinueSelectWithoutDeselect: null,\n      keyContainer: null,\n      scrollOptions: null,\n      checkInput: false,\n      preventDefault: false,\n      boundContainer: false,\n      preventDragFromInside: true,\n      dragCondition: null,\n      rootContainer: null,\n      checkOverflow: false,\n      innerScrollOptions: false,\n      getElementRect: getDefaultElementRect,\n      cspNonce: \"\",\n      ratio: 0\n    }, options);\n    var portalContainer = _this.options.portalContainer;\n\n    if (portalContainer) {\n      container = portalContainer.parentElement;\n    }\n\n    _this.container = container || document.body;\n\n    _this.initElement();\n\n    _this.initDragScroll();\n\n    _this.setKeyController();\n\n    return _this;\n  }\n  /**\n   * You can set the currently selected targets.\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  var __proto = Selecto.prototype;\n\n  __proto.setSelectedTargets = function (selectedTargets) {\n    var beforeSelected = this.selectedTargets;\n\n    var _a = diff(beforeSelected, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    this.selectedTargets = selectedTargets;\n    return {\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      beforeSelected: beforeSelected,\n      selected: selectedTargets\n    };\n  };\n  /**\n   * You can set the currently selected targets by points\n   * selectByClick, continueSelect, and continueSelectWithoutDeselect are not applied.\n   */\n\n\n  __proto.setSelectedTargetsByPoints = function (point1, point2) {\n    var left = Math.min(point1[0], point2[0]);\n    var top = Math.min(point1[1], point2[1]);\n    var right = Math.max(point1[0], point2[0]);\n    var bottom = Math.max(point1[1], point2[1]);\n    var rect = {\n      left: left,\n      top: top,\n      right: right,\n      bottom: bottom,\n      width: right - left,\n      height: bottom - top\n    };\n    var data = {\n      ignoreClick: true\n    };\n    this.findSelectableTargets(data);\n    var selectedElements = this.hitTest(rect, data, true, null);\n    var result = this.setSelectedTargets(selectedElements);\n    return __assign(__assign({}, result), {\n      rect: rect\n    });\n  };\n  /**\n   * Select target by virtual drag from startPoint to endPoint.\n   * The target of inputEvent is null.\n   */\n\n\n  __proto.selectTargetsByPoints = function (startPoint, endPoint) {\n    var mousedown = new MouseEvent(\"mousedown\", {\n      clientX: startPoint[0],\n      clientY: startPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mousemove = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var mouseup = new MouseEvent(\"mousemove\", {\n      clientX: endPoint[0],\n      clientY: endPoint[1],\n      cancelable: true,\n      bubbles: true\n    });\n    var gesto = this.gesto;\n    var result = gesto.onDragStart(mousedown);\n\n    if (result !== false) {\n      gesto.onDrag(mousemove);\n      gesto.onDragEnd(mouseup);\n    }\n  };\n  /**\n   * You can get the currently selected targets.\n   */\n\n\n  __proto.getSelectedTargets = function () {\n    return this.selectedTargets;\n  };\n  /**\n   * `OnDragStart` is triggered by an external event.\n   * @param - external event\n   * @example\n   * import Selecto from \"selecto\";\n   *\n   * const selecto = new Selecto();\n   *\n   * window.addEventListener(\"mousedown\", e => {\n   *   selecto.triggerDragStart(e);\n   * });\n   */\n\n\n  __proto.triggerDragStart = function (e) {\n    this.gesto.triggerDragStart(e);\n    return this;\n  };\n  /**\n   * Destroy elements, properties, and events.\n   */\n\n\n  __proto.destroy = function () {\n    var _a;\n\n    this.off();\n    this.keycon && this.keycon.destroy();\n    this.gesto.unset();\n    this.injectResult.destroy();\n    this.dragScroll.dragEnd();\n    removeEvent(document, \"selectstart\", this._onDocumentSelectStart);\n\n    if (!this.options.portalContainer) {\n      (_a = this.target.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.target);\n    }\n\n    this.keycon = null;\n    this.gesto = null;\n    this.injectResult = null;\n    this.target = null;\n    this.container = null;\n    this.options = null;\n  };\n\n  __proto.getElementPoints = function (target) {\n    var getElementRect = this.getElementRect || getDefaultElementRect;\n    var info = getElementRect(target);\n    var points = [info.pos1, info.pos2, info.pos4, info.pos3];\n\n    if (getElementRect !== getDefaultElementRect) {\n      var rect = target.getBoundingClientRect();\n      return fitPoints(points, rect);\n    }\n\n    return points;\n  };\n  /**\n   * Get all elements set in `selectableTargets`.\n   */\n\n\n  __proto.getSelectableElements = function () {\n    var container = this.container;\n    var selectableElements = [];\n    this.options.selectableTargets.forEach(function (target) {\n      if (isFunction(target)) {\n        var result = target();\n\n        if (result) {\n          selectableElements.push.apply(selectableElements, [].slice.call(result));\n        }\n      } else if (isNode(target)) {\n        selectableElements.push(target);\n      } else if (isObject(target)) {\n        selectableElements.push(target.value || target.current);\n      } else {\n        var elements = [].slice.call(getDocument(container).querySelectorAll(target));\n        selectableElements.push.apply(selectableElements, elements);\n      }\n    });\n    return selectableElements;\n  };\n  /**\n   * If scroll occurs during dragging, you can manually call this method to check the position again.\n   */\n\n\n  __proto.checkScroll = function () {\n    if (!this.gesto.isFlag()) {\n      return;\n    }\n\n    var scrollOptions = this.scrollOptions;\n    var innerScrollOptions = this.gesto.getEventData().innerScrollOptions;\n    var hasScrollOptions = innerScrollOptions || (scrollOptions === null || scrollOptions === void 0 ? void 0 : scrollOptions.container); // If it is a scrolling position, pass drag\n\n    if (hasScrollOptions) {\n      this.dragScroll.checkScroll(__assign({\n        inputEvent: this.gesto.getCurrentEvent()\n      }, innerScrollOptions || scrollOptions));\n    }\n  };\n  /**\n   * Find for selectableTargets again during drag event\n   * You can update selectable targets during an event.\n   */\n\n\n  __proto.findSelectableTargets = function (data) {\n    var _this = this;\n\n    if (data === void 0) {\n      data = this.gesto.getEventData();\n    }\n\n    var selectableTargets = this.getSelectableElements();\n    var selectablePoints = selectableTargets.map(function (target) {\n      return _this.getElementPoints(target);\n    });\n    data.selectableTargets = selectableTargets;\n    data.selectablePoints = selectablePoints;\n    data.selectableParentMap = null;\n    var options = this.options;\n    var hasIndexesMap = options.checkOverflow || options.innerScrollOptions;\n    var doc = getDocument(this.container);\n\n    if (hasIndexesMap) {\n      var parentMap_1 = new Map();\n      data.selectableInnerScrollParentMap = parentMap_1;\n      data.selectableInnerScrollPathsList = selectableTargets.map(function (target, index) {\n        var parentElement = target.parentElement;\n        var parents = [];\n        var paths = [];\n\n        var _loop_1 = function () {\n          var info = parentMap_1.get(parentElement);\n\n          if (!info) {\n            var overflow = getComputedStyle(parentElement).overflow !== \"visible\";\n\n            if (overflow) {\n              var rect = getDefaultElementRect(parentElement);\n              info = {\n                parentElement: parentElement,\n                indexes: [],\n                points: [rect.pos1, rect.pos2, rect.pos4, rect.pos3],\n                paths: __spreadArray([], paths, true)\n              };\n              parents.push(parentElement);\n              parents.forEach(function (prevParentElement) {\n                parentMap_1.set(prevParentElement, info);\n              });\n              parents = [];\n            }\n          }\n\n          if (info) {\n            parentElement = info.parentElement;\n            parentMap_1.get(parentElement).indexes.push(index);\n            paths.push(parentElement);\n          } else {\n            parents.push(parentElement);\n          }\n\n          parentElement = parentElement.parentElement;\n        };\n\n        while (parentElement && parentElement !== doc.body) {\n          _loop_1();\n        }\n\n        return paths;\n      });\n    }\n\n    if (!options.checkOverflow) {\n      data.selectableInners = selectableTargets.map(function () {\n        return true;\n      });\n    }\n\n    this._refreshGroups(data);\n\n    return selectableTargets;\n  };\n  /**\n   * External click or mouse events can be applied to the selecto.\n   * @params - Extenal click or mouse event\n   * @params - Specify the clicked target directly.\n   */\n\n\n  __proto.clickTarget = function (e, clickedTarget) {\n    var _a = getClient(e),\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n\n    var dragEvent = {\n      data: {\n        selectFlag: false\n      },\n      clientX: clientX,\n      clientY: clientY,\n      inputEvent: e,\n      isClick: true,\n      isTrusted: false,\n      stop: function () {\n        return false;\n      }\n    };\n\n    if (this._onDragStart(dragEvent, clickedTarget)) {\n      this._onDragEnd(dragEvent);\n    }\n\n    return this;\n  };\n\n  __proto.setKeyController = function () {\n    var _a = this.options,\n        keyContainer = _a.keyContainer,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (this.keycon) {\n      this.keycon.destroy();\n      this.keycon = null;\n    }\n\n    if (toggleContinueSelect || toggleContinueSelectWithoutDeselect) {\n      this.keycon = new KeyController(keyContainer || getWindow(this.container));\n      this.keycon.keydown(this._onKeyDown).keyup(this._onKeyUp).on(\"blur\", this._onBlur);\n    }\n  };\n\n  __proto.setClassName = function (nextClassName) {\n    this.options.className = nextClassName;\n    this.target.setAttribute(\"class\", \"\".concat(CLASS_NAME, \" \").concat(nextClassName || \"\"));\n  };\n\n  __proto.setKeyEvent = function () {\n    var _a = this.options,\n        toggleContinueSelect = _a.toggleContinueSelect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelect && !toggleContinueSelectWithoutDeselect || this.keycon) {\n      return;\n    }\n\n    this.setKeyController();\n  }; // with getter, setter property\n\n\n  __proto.setKeyContainer = function (keyContainer) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.keyContainer, keyContainer, function () {\n      options.keyContainer = keyContainer;\n\n      _this.setKeyController();\n    });\n  };\n\n  __proto.getContinueSelect = function () {\n    var _a = this.options,\n        continueSelect = _a.continueSelect,\n        toggleContinueSelect = _a.toggleContinueSelect;\n\n    if (!toggleContinueSelect || !this._keydownContinueSelect) {\n      return continueSelect;\n    }\n\n    return !continueSelect;\n  };\n\n  __proto.getContinueSelectWithoutDeselect = function () {\n    var _a = this.options,\n        continueSelectWithoutDeselect = _a.continueSelectWithoutDeselect,\n        toggleContinueSelectWithoutDeselect = _a.toggleContinueSelectWithoutDeselect;\n\n    if (!toggleContinueSelectWithoutDeselect || !this._keydownContinueSelectWithoutDeselection) {\n      return continueSelectWithoutDeselect;\n    }\n\n    return !continueSelectWithoutDeselect;\n  };\n\n  __proto.setToggleContinueSelect = function (toggleContinueSelect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelect, toggleContinueSelect, function () {\n      options.toggleContinueSelect = toggleContinueSelect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setToggleContinueSelectWithoutDeselect = function (toggleContinueSelectWithoutDeselect) {\n    var _this = this;\n\n    var options = this.options;\n    diffValue(options.toggleContinueSelectWithoutDeselect, toggleContinueSelectWithoutDeselect, function () {\n      options.toggleContinueSelectWithoutDeselect = toggleContinueSelectWithoutDeselect;\n\n      _this.setKeyEvent();\n    });\n  };\n\n  __proto.setPreventDefault = function (value) {\n    this.gesto.options.preventDefault = value;\n  };\n\n  __proto.setCheckInput = function (value) {\n    this.gesto.options.checkInput = value;\n  };\n\n  __proto.initElement = function () {\n    var _a = this.options,\n        dragContainer = _a.dragContainer,\n        checkInput = _a.checkInput,\n        preventDefault = _a.preventDefault,\n        preventClickEventOnDragStart = _a.preventClickEventOnDragStart,\n        preventClickEventOnDrag = _a.preventClickEventOnDrag,\n        preventClickEventByCondition = _a.preventClickEventByCondition,\n        _b = _a.preventRightClick,\n        preventRightClick = _b === void 0 ? true : _b,\n        className = _a.className;\n    var container = this.container;\n    this.target = createElement(h(\"div\", {\n      className: \"\".concat(CLASS_NAME, \" \").concat(className || \"\")\n    }), this.target, container);\n    var target = this.target;\n    this.dragContainer = typeof dragContainer === \"string\" ? [].slice.call(getDocument(container).querySelectorAll(dragContainer)) : dragContainer || this.target.parentNode;\n    this.gesto = new Gesto(this.dragContainer, {\n      checkWindowBlur: true,\n      container: getWindow(container),\n      checkInput: checkInput,\n      preventDefault: preventDefault,\n      preventClickEventOnDragStart: preventClickEventOnDragStart,\n      preventClickEventOnDrag: preventClickEventOnDrag,\n      preventClickEventByCondition: preventClickEventByCondition,\n      preventRightClick: preventRightClick\n    }).on({\n      dragStart: this._onDragStart,\n      drag: this._onDrag,\n      dragEnd: this._onDragEnd\n    });\n    addEvent(document, \"selectstart\", this._onDocumentSelectStart);\n    this.injectResult = injector.inject(target, {\n      nonce: this.options.cspNonce\n    });\n  };\n\n  __proto.hitTest = function (selectRect, data, isDrag, gestoEvent) {\n    var _a = this.options,\n        hitRate = _a.hitRate,\n        selectByClick = _a.selectByClick;\n    var left = selectRect.left,\n        top = selectRect.top,\n        right = selectRect.right,\n        bottom = selectRect.bottom;\n    var innerGroups = data.innerGroups;\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var clientX = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientX;\n    var clientY = gestoEvent === null || gestoEvent === void 0 ? void 0 : gestoEvent.clientY;\n    var ignoreClick = data.ignoreClick;\n    var rectPoints = [[left, top], [right, top], [right, bottom], [left, bottom]];\n\n    var isHit = function (points, el) {\n      var hitRateValue = typeof hitRate === \"function\" ? splitUnit(\"\".concat(hitRate(el))) : splitUnit(\"\".concat(hitRate));\n      var inArea = ignoreClick ? false : isInside([clientX, clientY], points);\n\n      if (!isDrag && selectByClick && inArea) {\n        return true;\n      }\n\n      var overlapPoints = getOverlapPoints(rectPoints, points);\n\n      if (!overlapPoints.length) {\n        return false;\n      }\n\n      var overlapSize = getAreaSize(overlapPoints); // Line\n\n      var targetSize = 0;\n\n      if (overlapSize === 0 && getAreaSize(points) === 0) {\n        targetSize = getLineSize(points);\n        overlapSize = getLineSize(overlapPoints);\n      } else {\n        targetSize = getAreaSize(points);\n      }\n\n      if (hitRateValue.unit === \"px\") {\n        return overlapSize >= hitRateValue.value;\n      } else {\n        var rate = between(Math.round(overlapSize / targetSize * 100), 0, 100);\n        return rate >= Math.min(100, hitRateValue.value);\n      }\n    };\n\n    var selectableTargets = data.selectableTargets;\n    var selectablePoints = data.selectablePoints;\n    var selectableInners = data.selectableInners;\n\n    if (!innerGroups) {\n      return selectableTargets.filter(function (_, i) {\n        if (!selectableInners[i]) {\n          return false;\n        }\n\n        return isHit(selectablePoints[i], selectableTargets[i]);\n      });\n    }\n\n    var selectedTargets = [];\n    var minX = Math.floor(left / innerWidth);\n    var maxX = Math.floor(right / innerWidth);\n    var minY = Math.floor(top / innerHeight);\n    var maxY = Math.floor(bottom / innerHeight);\n\n    for (var x = minX; x <= maxX; ++x) {\n      var yGroups = innerGroups[x];\n\n      if (!yGroups) {\n        continue;\n      }\n\n      for (var y = minY; y <= maxY; ++y) {\n        var group = yGroups[y];\n\n        if (!group) {\n          continue;\n        }\n\n        group.forEach(function (index) {\n          var points = selectablePoints[index];\n          var inner = selectableInners[index];\n          var target = selectableTargets[index];\n\n          if (inner && isHit(points, target)) {\n            selectedTargets.push(target);\n          }\n        });\n      }\n    }\n\n    return filterDuplicated(selectedTargets);\n  };\n\n  __proto.initDragScroll = function () {\n    var _this = this;\n\n    this.dragScroll.on(\"scrollDrag\", function (_a) {\n      var next = _a.next;\n      next(_this.gesto.getCurrentEvent());\n    }).on(\"scroll\", function (_a) {\n      var container = _a.container,\n          direction = _a.direction;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      if (innerScrollOptions) {\n        _this.emit(\"innerScroll\", {\n          container: container,\n          direction: direction\n        });\n      } else {\n        _this.emit(\"scroll\", {\n          container: container,\n          direction: direction\n        });\n      }\n    }).on(\"move\", function (_a) {\n      var offsetX = _a.offsetX,\n          offsetY = _a.offsetY,\n          inputEvent = _a.inputEvent;\n      var gesto = _this.gesto;\n\n      if (!gesto || !gesto.isFlag()) {\n        return;\n      }\n\n      var data = _this.gesto.getEventData();\n\n      var boundArea = data.boundArea;\n      data.startX -= offsetX;\n      data.startY -= offsetY;\n\n      var innerScrollOptions = _this.gesto.getEventData().innerScrollOptions;\n\n      var container = innerScrollOptions === null || innerScrollOptions === void 0 ? void 0 : innerScrollOptions.container;\n      var isMoveInnerScroll = false;\n\n      if (container) {\n        var parentMap_2 = data.selectableInnerScrollParentMap;\n        var parentInfo = parentMap_2.get(container);\n\n        if (parentInfo) {\n          parentInfo.paths.forEach(function (scrollContainer) {\n            var containerInfo = parentMap_2.get(scrollContainer);\n            containerInfo.points.forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          parentInfo.indexes.forEach(function (index) {\n            data.selectablePoints[index].forEach(function (pos) {\n              pos[0] -= offsetX;\n              pos[1] -= offsetY;\n            });\n          });\n          isMoveInnerScroll = true;\n        }\n      }\n\n      if (!isMoveInnerScroll) {\n        data.selectablePoints.forEach(function (points) {\n          points.forEach(function (pos) {\n            pos[0] -= offsetX;\n            pos[1] -= offsetY;\n          });\n        });\n      }\n\n      _this._refreshGroups(data);\n\n      boundArea.left -= offsetX;\n      boundArea.right -= offsetX;\n      boundArea.top -= offsetY;\n      boundArea.bottom -= offsetY;\n\n      _this.gesto.scrollBy(offsetX, offsetY, inputEvent.inputEvent);\n\n      _this._checkSelected(_this.gesto.getCurrentEvent());\n    });\n  };\n\n  __proto._select = function (selectedTargets, rect, e, isStart, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent;\n    var data = e.data;\n    var result = this.setSelectedTargets(selectedTargets);\n\n    var _a = diff(data.startSelectedTargets, selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var startResult = {\n      startSelected: prevList,\n      startAdded: added.map(function (i) {\n        return list[i];\n      }),\n      startRemoved: removed.map(function (i) {\n        return prevList[i];\n      })\n    };\n\n    if (isStart) {\n      /**\n       * When the select(drag) starts, the selectStart event is called.\n       * @memberof Selecto\n       * @event selectStart\n       * @param {Selecto.OnSelect} - Parameters for the selectStart event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"selectStart\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * }).on(\"selectEnd\", e => {\n       *   e.afterAdded.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.afterRemoved.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"selectStart\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n\n    if (result.added.length || result.removed.length) {\n      /**\n       * When the select in real time, the select event is called.\n       * @memberof Selecto\n       * @event select\n       * @param {Selecto.OnSelect} - Parameters for the select event\n       * @example\n       * import Selecto from \"selecto\";\n       *\n       * const selecto = new Selecto({\n       *   container: document.body,\n       *   selectByClick: true,\n       *   selectFromInside: false,\n       * });\n       *\n       * selecto.on(\"select\", e => {\n       *   e.added.forEach(el => {\n       *     el.classList.add(\"selected\");\n       *   });\n       *   e.removed.forEach(el => {\n       *     el.classList.remove(\"selected\");\n       *   });\n       * });\n       */\n      this.emit(\"select\", __assign(__assign(__assign({}, result), startResult), {\n        rect: rect,\n        inputEvent: inputEvent,\n        data: data.data,\n        isTrusted: e.isTrusted,\n        isDragStartEnd: isDragStartEnd\n      }));\n    }\n  };\n\n  __proto._selectEnd = function (startSelectedTargets, startPassedTargets, rect, e, isDragStartEnd) {\n    if (isDragStartEnd === void 0) {\n      isDragStartEnd = false;\n    }\n\n    var inputEvent = e.inputEvent,\n        isDouble = e.isDouble,\n        data = e.data;\n    var type = inputEvent && inputEvent.type;\n    var isDragStart = type === \"mousedown\" || type === \"touchstart\";\n\n    var _a = diff(startSelectedTargets, this.selectedTargets),\n        added = _a.added,\n        removed = _a.removed,\n        prevList = _a.prevList,\n        list = _a.list;\n\n    var _b = diff(startPassedTargets, this.selectedTargets),\n        afterAdded = _b.added,\n        afterRemoved = _b.removed,\n        afterPrevList = _b.prevList,\n        afterList = _b.list;\n    /**\n     * When the select(dragEnd or click) ends, the selectEnd event is called.\n     * @memberof Selecto\n     * @event selectEnd\n     * @param {Selecto.OnSelectEnd} - Parameters for the selectEnd event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"selectStart\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * }).on(\"selectEnd\", e => {\n     *   e.afterAdded.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.afterRemoved.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    this.emit(\"selectEnd\", {\n      startSelected: startSelectedTargets,\n      beforeSelected: startPassedTargets,\n      selected: this.selectedTargets,\n      added: added.map(function (index) {\n        return list[index];\n      }),\n      removed: removed.map(function (index) {\n        return prevList[index];\n      }),\n      afterAdded: afterAdded.map(function (index) {\n        return afterList[index];\n      }),\n      afterRemoved: afterRemoved.map(function (index) {\n        return afterPrevList[index];\n      }),\n      isDragStart: isDragStart && isDragStartEnd,\n      isDragStartEnd: isDragStart && isDragStartEnd,\n      isClick: !!e.isClick,\n      isDouble: !!isDouble,\n      rect: rect,\n      inputEvent: inputEvent,\n      data: data.data,\n      isTrusted: e.isTrusted\n    });\n  };\n\n  __proto._checkSelected = function (e, rect) {\n    if (rect === void 0) {\n      rect = getRect(e, this.options.ratio);\n    }\n\n    var data = e.data;\n    var top = rect.top,\n        left = rect.left,\n        width = rect.width,\n        height = rect.height;\n    var selectFlag = data.selectFlag;\n    var containerX = data.containerX,\n        containerY = data.containerY,\n        scaleMatrix = data.scaleMatrix;\n    var offsetPos = calculateMatrixDist(scaleMatrix, [left - containerX, top - containerY]);\n    var offsetSize = calculateMatrixDist(scaleMatrix, [width, height]);\n    var selectedTargets = [];\n\n    if (selectFlag) {\n      this.target.style.cssText += \"display: block;\" + \"left:0px;top:0px;\" + \"transform: translate(\".concat(offsetPos[0], \"px, \").concat(offsetPos[1], \"px);\") + \"width:\".concat(offsetSize[0], \"px;height:\").concat(offsetSize[1], \"px;\");\n      var passedTargets = this.hitTest(rect, data, true, e);\n      selectedTargets = passTargets(data.startPassedTargets, passedTargets, this.continueSelect && this.continueSelectWithoutDeselect);\n    }\n    /**\n     * When the drag, the drag event is called.\n     * Call the stop () function if you have a specific element or don't want to raise a select\n     * @memberof Selecto\n     * @event drag\n     * @param {OnDrag} - Parameters for the drag event\n     * @example\n     * import Selecto from \"selecto\";\n     *\n     * const selecto = new Selecto({\n     *   container: document.body,\n     *   selectByClick: true,\n     *   selectFromInside: false,\n     * });\n     *\n     * selecto.on(\"drag\", e => {\n     *   e.stop();\n     * }).on(\"select\", e => {\n     *   e.added.forEach(el => {\n     *     el.classList.add(\"selected\");\n     *   });\n     *   e.removed.forEach(el => {\n     *     el.classList.remove(\"selected\");\n     *   });\n     * });\n     */\n\n\n    var result = this.emit(\"drag\", __assign(__assign({}, e), {\n      data: data.data,\n      isSelect: selectFlag,\n      rect: rect\n    }));\n\n    if (result === false) {\n      this.target.style.cssText += \"display: none;\";\n      e.stop();\n      return;\n    }\n\n    if (selectFlag) {\n      this._select(selectedTargets, rect, e);\n    }\n  };\n\n  __proto._sameCombiKey = function (e, keys, isKeyup) {\n    if (!keys) {\n      return false;\n    }\n\n    var combi = getCombi(e.inputEvent, e.key);\n    var nextKeys = [].concat(keys);\n    var toggleKeys = isArray(nextKeys[0]) ? nextKeys : [nextKeys];\n\n    if (isKeyup) {\n      var singleKey_1 = e.key;\n      return toggleKeys.some(function (keys) {\n        return keys.some(function (key) {\n          return key === singleKey_1;\n        });\n      });\n    }\n\n    return toggleKeys.some(function (keys) {\n      return keys.every(function (key) {\n        return combi.indexOf(key) > -1;\n      });\n    });\n  };\n\n  __proto._findElement = function (clickedTarget, selectableTargets) {\n    var pointTarget = clickedTarget;\n\n    while (pointTarget) {\n      if (selectableTargets.indexOf(pointTarget) > -1) {\n        break;\n      }\n\n      pointTarget = pointTarget.parentElement;\n    }\n\n    return pointTarget;\n  };\n\n  __proto._refreshGroups = function (data) {\n    var _a;\n\n    var innerWidth = data.innerWidth;\n    var innerHeight = data.innerHeight;\n    var selectablePoints = data.selectablePoints;\n\n    if (this.options.checkOverflow) {\n      var innerScrollContainer_1 = (_a = this.gesto.getEventData().innerScrollOptions) === null || _a === void 0 ? void 0 : _a.container;\n      var parentMap_3 = data.selectableInnerScrollParentMap;\n      var innerScrollPathsList = data.selectableInnerScrollPathsList;\n      data.selectableInners = innerScrollPathsList.map(function (innerScrollPaths, i) {\n        var isAlwaysTrue = false;\n        return innerScrollPaths.every(function (target) {\n          if (isAlwaysTrue) {\n            return true;\n          }\n\n          if (target === innerScrollContainer_1) {\n            isAlwaysTrue = true;\n            return true;\n          }\n\n          var rect = parentMap_3.get(target);\n\n          if (rect) {\n            var points1 = selectablePoints[i];\n            var points2 = rect.points;\n            var overlapPoints = getOverlapPoints(points1, points2);\n\n            if (!overlapPoints.length) {\n              return false;\n            }\n          }\n\n          return true;\n        });\n      });\n    }\n\n    if (!innerWidth || !innerHeight) {\n      data.innerGroups = null;\n    } else {\n      var selectablePoints_1 = data.selectablePoints;\n      var groups_1 = {};\n      selectablePoints_1.forEach(function (points, i) {\n        var minX = Infinity;\n        var maxX = -Infinity;\n        var minY = Infinity;\n        var maxY = -Infinity;\n        points.forEach(function (pos) {\n          var x = Math.floor(pos[0] / innerWidth);\n          var y = Math.floor(pos[1] / innerHeight);\n          minX = Math.min(x, minX);\n          maxX = Math.max(x, maxX);\n          minY = Math.min(y, minY);\n          maxY = Math.max(y, maxY);\n        });\n\n        for (var x = minX; x <= maxX; ++x) {\n          for (var y = minY; y <= maxY; ++y) {\n            groups_1[x] = groups_1[x] || {};\n            groups_1[x][y] = groups_1[x][y] || [];\n            groups_1[x][y].push(i);\n          }\n        }\n      });\n      data.innerGroups = groups_1;\n    }\n  };\n\n  Selecto = __decorate([Properties(PROPERTIES, function (prototype, property) {\n    var attributes = {\n      enumerable: true,\n      configurable: true,\n      get: function () {\n        return this.options[property];\n      }\n    };\n    var getter = camelize(\"get \".concat(property));\n\n    if (prototype[getter]) {\n      attributes.get = function () {\n        return this[getter]();\n      };\n    } else {\n      attributes.get = function () {\n        return this.options[property];\n      };\n    }\n\n    var setter = camelize(\"set \".concat(property));\n\n    if (prototype[setter]) {\n      attributes.set = function (value) {\n        this[setter](value);\n      };\n    } else {\n      attributes.set = function (value) {\n        this.options[property] = value;\n      };\n    }\n\n    Object.defineProperty(prototype, property, attributes);\n  })], Selecto);\n  return Selecto;\n}(EventEmitter);\n\nvar Selecto$1 =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Selecto, _super);\n\n  function Selecto() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  return Selecto;\n}(Selecto);\n\nexport default Selecto$1;\nexport { CLASS_NAME, EVENTS, METHODS, OPTIONS, OPTION_TYPES, PROPERTIES };\n//# sourceMappingURL=selecto.esm.js.map\n","import { css } from '@emotion/css';\nimport { useRef } from 'react';\nimport * as React from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { ConnectionCoordinates } from 'app/features/canvas/element';\n\ntype Props = {\n  setRef: (anchorElement: HTMLDivElement) => void;\n  setAnchorsRef: (anchorsElement: HTMLDivElement) => void;\n  handleMouseLeave: (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => boolean;\n};\n\nexport const CONNECTION_ANCHOR_DIV_ID = 'connectionControl';\nexport const CONNECTION_ANCHOR_ALT = 'connection anchor';\nexport const CONNECTION_ANCHOR_HIGHLIGHT_OFFSET = 8;\n// Unit is percentage from the middle of the element\n// 0, 0 middle; -1, -1 bottom left; 1, 1 top right\nexport const ANCHORS = [\n  { x: -1, y: 1 },\n  { x: -0.5, y: 1 },\n  { x: 0, y: 1 },\n  { x: 0.5, y: 1 },\n  { x: 1, y: 1 },\n  { x: 1, y: 0.5 },\n  { x: 1, y: 0 },\n  { x: 1, y: -0.5 },\n  { x: 1, y: -1 },\n  { x: 0.5, y: -1 },\n  { x: 0, y: -1 },\n  { x: -0.5, y: -1 },\n  { x: -1, y: -1 },\n  { x: -1, y: -0.5 },\n  { x: -1, y: 0 },\n  { x: -1, y: 0.5 },\n];\n\nexport const ANCHOR_PADDING = 3;\nexport const HALF_SIZE = 2.5;\n\nexport const ConnectionAnchors = ({ setRef, setAnchorsRef, handleMouseLeave }: Props) => {\n  const highlightEllipseRef = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const halfSizeHighlightEllipse = 5.5;\n  const anchorImage =\n    'data:image/svg+xml;base64,PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHdpZHRoPSI1cHgiIGhlaWdodD0iNXB4IiB2ZXJzaW9uPSIxLjEiPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2Utd2lkdGg9IjIiIHN0eWxlPSJzdHJva2Utb3BhY2l0eTowLjQiIHN0cm9rZT0iI2ZmZmZmZiIvPjxwYXRoIGQ9Im0gMCAwIEwgNSA1IE0gMCA1IEwgNSAwIiBzdHJva2U9IiMyOWI2ZjIiLz48L3N2Zz4=';\n\n  const onMouseEnterAnchor = (event: React.MouseEvent) => {\n    if (!(event.target instanceof HTMLImageElement)) {\n      return;\n    }\n\n    if (highlightEllipseRef.current && event.target.style) {\n      highlightEllipseRef.current.style.display = 'block';\n      highlightEllipseRef.current.style.top = `calc(${event.target.style.top} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n      highlightEllipseRef.current.style.left = `calc(${event.target.style.left} - ${halfSizeHighlightEllipse}px + ${ANCHOR_PADDING}px)`;\n    }\n  };\n\n  const onMouseLeaveHighlightElement = () => {\n    if (highlightEllipseRef.current) {\n      highlightEllipseRef.current.style.display = 'none';\n    }\n  };\n\n  const handleMouseLeaveAnchors = (\n    event: React.MouseEvent<Element, MouseEvent> | React.FocusEvent<HTMLDivElement, Element>\n  ) => {\n    const didHideAnchors = handleMouseLeave(event);\n\n    if (didHideAnchors) {\n      onMouseLeaveHighlightElement();\n    }\n  };\n\n  const generateAnchors = (anchors: ConnectionCoordinates[] = ANCHORS) => {\n    return anchors.map((anchor) => {\n      const id = `${anchor.x},${anchor.y}`;\n\n      // Convert anchor coords to relative percentage\n      const style = {\n        top: `calc(${-anchor.y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n        left: `calc(${anchor.x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`,\n      };\n\n      return (\n        <img\n          id={id}\n          ref={(element) => {\n            if (element) {\n              // After React 15+, inline styles no longer support !important\n              element.style.setProperty('pointer-events', 'auto', 'important');\n            }\n          }}\n          key={id}\n          alt={CONNECTION_ANCHOR_ALT}\n          className={styles.anchor}\n          style={style}\n          src={anchorImage}\n          onMouseEnter={onMouseEnterAnchor}\n        />\n      );\n    });\n  };\n\n  return (\n    <div className={styles.root} ref={setRef}>\n      <div className={styles.mouseoutDiv} onMouseOut={handleMouseLeaveAnchors} onBlur={handleMouseLeaveAnchors} />\n      <div\n        id={CONNECTION_ANCHOR_DIV_ID}\n        ref={highlightEllipseRef}\n        className={styles.highlightElement}\n        onMouseLeave={onMouseLeaveHighlightElement}\n      />\n      <div ref={setAnchorsRef}>{generateAnchors()}</div>\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  root: css({\n    position: 'absolute',\n    display: 'none',\n  }),\n  mouseoutDiv: css({\n    position: 'absolute',\n    margin: '-30px',\n    width: 'calc(100% + 60px)',\n    height: 'calc(100% + 60px)',\n  }),\n  anchor: css({\n    padding: `${ANCHOR_PADDING}px`,\n    position: 'absolute',\n    cursor: 'cursor',\n    width: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    height: `calc(5px + 2 * ${ANCHOR_PADDING}px)`,\n    zIndex: 100,\n  }),\n  highlightElement: css({\n    backgroundColor: '#00ff00',\n    opacity: 0.3,\n    position: 'absolute',\n    cursor: 'cursor',\n    pointerEvents: 'auto',\n    width: '16px',\n    height: '16px',\n    borderRadius: theme.shape.radius.circle,\n    display: 'none',\n    zIndex: 110,\n  }),\n});\n","import { first } from 'rxjs/operators';\n\nimport { Placement } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\n\n// TODO: Consider whether or not reorderElements + updateElements should be moved to TreeNavigationEditor\n// Reorder elements in the DOM when rearranging them in the tree navigation editor\nexport const reorderElements = (src: ElementState, dest: ElementState, dragToGap: boolean, destPosition: number) => {\n  switch (dragToGap) {\n    case true:\n      switch (destPosition) {\n        case -1:\n          // top of the tree\n          if (src.parent instanceof FrameState) {\n            // move outside the frame\n            if (dest.parent) {\n              updateElements(src, dest.parent, dest.parent.elements.length);\n              src.updateData(dest.parent.scene.context);\n            }\n          } else {\n            dest.parent?.reorderTree(src, dest, true);\n          }\n          break;\n        default:\n          if (dest.parent) {\n            updateElements(src, dest.parent, dest.parent.elements.indexOf(dest));\n            src.updateData(dest.parent.scene.context);\n          }\n          break;\n      }\n      break;\n    case false:\n      if (dest instanceof FrameState) {\n        if (src.parent === dest) {\n          // same frame parent\n          src.parent?.reorderTree(src, dest, true);\n        } else {\n          updateElements(src, dest);\n          src.updateData(dest.scene.context);\n        }\n      } else if (src.parent === dest.parent) {\n        src.parent?.reorderTree(src, dest);\n      } else {\n        if (dest.parent) {\n          updateElements(src, dest.parent);\n          src.updateData(dest.parent.scene.context);\n        }\n      }\n      break;\n  }\n};\n\n// Reorders canvas elements\nconst updateElements = (src: ElementState, dest: FrameState | RootElement, idx: number | null = null) => {\n  src.parent?.doAction(LayerActionID.Delete, src);\n  src.parent = dest;\n\n  const elementContainer = src.div?.getBoundingClientRect();\n  src.setPlacementFromConstraint(elementContainer, dest.div?.getBoundingClientRect());\n\n  const destIndex = idx ?? dest.elements.length - 1;\n  dest.elements.splice(destIndex, 0, src);\n  dest.scene.save();\n\n  dest.reinitializeMoveable();\n};\n\n// Finds the element state if it exists for a given DOM element\nexport const findElementByTarget = (target: Element, sceneElements: ElementState[]): ElementState | undefined => {\n  // We will probably want to add memoization to this as we are calling on drag / resize\n\n  const stack = [...sceneElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div && currentElement.div === target) {\n      return currentElement;\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return undefined;\n};\n\n// Nest selected elements into a frame object\nexport const frameSelection = (scene: Scene) => {\n  scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n    const currentLayer = currentSelectedElements[0].parent!;\n\n    const newLayer = new FrameState(\n      {\n        type: 'frame',\n        name: scene.getNextElementName(true),\n        elements: [],\n      },\n      scene,\n      currentSelectedElements[0].parent\n    );\n\n    const framePlacement = generateFrameContainer(currentSelectedElements);\n\n    newLayer.options.placement = framePlacement;\n\n    currentSelectedElements.forEach((element: ElementState) => {\n      const elementContainer = element.div?.getBoundingClientRect();\n\n      // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n      element.setPlacementFromConstraint(elementContainer, framePlacement as DOMRect);\n      currentLayer.doAction(LayerActionID.Delete, element);\n      newLayer.doAction(LayerActionID.Duplicate, element, false, false);\n    });\n\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    newLayer.setPlacementFromConstraint(framePlacement as DOMRect, currentLayer.div?.getBoundingClientRect());\n\n    currentLayer.elements.push(newLayer);\n\n    scene.byName.set(newLayer.getName(), newLayer);\n\n    scene.save();\n  });\n};\n\n// Helper function to generate the a frame object based on the selected elements' dimensions\nconst generateFrameContainer = (elements: ElementState[]): Placement => {\n  let minTop = Infinity;\n  let minLeft = Infinity;\n  let maxRight = 0;\n  let maxBottom = 0;\n\n  elements.forEach((element: ElementState) => {\n    const elementContainer = element.div?.getBoundingClientRect();\n\n    if (!elementContainer) {\n      return;\n    }\n\n    if (minTop > elementContainer.top) {\n      minTop = elementContainer.top;\n    }\n\n    if (minLeft > elementContainer.left) {\n      minLeft = elementContainer.left;\n    }\n\n    if (maxRight < elementContainer.right) {\n      maxRight = elementContainer.right;\n    }\n\n    if (maxBottom < elementContainer.bottom) {\n      maxBottom = elementContainer.bottom;\n    }\n  });\n\n  return {\n    top: minTop,\n    left: minLeft,\n    width: maxRight - minLeft,\n    height: maxBottom - minTop,\n  };\n};\n","import { css } from '@emotion/css';\nimport { useEffect, useMemo, useRef, useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { ConnectionDirection } from 'app/features/canvas/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { ConnectionCoordinates } from '../../panelcfg.gen';\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  calculateDistance,\n  calculateMidpoint,\n  getConnectionStyles,\n  getParentBoundingClientRect,\n} from '../../utils';\n\nimport { CONNECTION_VERTEX_ADD_ID, CONNECTION_VERTEX_ID } from './Connections';\n\ntype Props = {\n  setSVGRef: (anchorElement: SVGSVGElement) => void;\n  setLineRef: (anchorElement: SVGLineElement) => void;\n  setSVGVertexRef: (anchorElement: SVGSVGElement) => void;\n  setVertexPathRef: (anchorElement: SVGPathElement) => void;\n  setVertexRef: (anchorElement: SVGCircleElement) => void;\n  scene: Scene;\n};\n\nlet idCounter = 0;\nconst htmlElementTypes = ['input', 'textarea'];\n\nexport const ConnectionSVG = ({\n  setSVGRef,\n  setLineRef,\n  setSVGVertexRef,\n  setVertexPathRef,\n  setVertexRef,\n  scene,\n}: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const headId = Date.now() + '_' + idCounter++;\n  const CONNECTION_LINE_ID = useMemo(() => `connectionLineId-${headId}`, [headId]);\n  const EDITOR_HEAD_ID = useMemo(() => `editorHead-${headId}`, [headId]);\n  const defaultArrowColor = config.theme2.colors.text.primary;\n  const defaultArrowSize = 2;\n  const defaultArrowDirection = ConnectionDirection.Forward;\n  const maximumVertices = 10;\n\n  const [selectedConnection, setSelectedConnection] = useState<ConnectionState | undefined>(undefined);\n\n  // Need to use ref to ensure state is not stale in event handler\n  const selectedConnectionRef = useRef(selectedConnection);\n  useEffect(() => {\n    selectedConnectionRef.current = selectedConnection;\n  });\n\n  useEffect(() => {\n    if (scene.panel.context.instanceState?.selectedConnection) {\n      setSelectedConnection(scene.panel.context.instanceState?.selectedConnection);\n    }\n  }, [scene.panel.context.instanceState?.selectedConnection]);\n\n  const onKeyUp = (e: KeyboardEvent) => {\n    const target = e.target;\n\n    if (!(target instanceof HTMLElement)) {\n      return;\n    }\n\n    if (htmlElementTypes.indexOf(target.nodeName.toLowerCase()) > -1) {\n      return;\n    }\n\n    // Backspace (8) or delete (46)\n    if (e.keyCode === 8 || e.keyCode === 46) {\n      if (selectedConnectionRef.current && selectedConnectionRef.current.source) {\n        selectedConnectionRef.current.source.options.connections =\n          selectedConnectionRef.current.source.options.connections?.filter(\n            (connection) => connection !== selectedConnectionRef.current?.info\n          );\n        selectedConnectionRef.current.source.onChange(selectedConnectionRef.current.source.options);\n\n        setSelectedConnection(undefined);\n        scene.connections.select(undefined);\n        scene.connections.updateState();\n        scene.save();\n      }\n    } else {\n      // Prevent removing event listener if key is not delete\n      return;\n    }\n\n    document.removeEventListener('keyup', onKeyUp);\n    scene.selecto!.rootContainer!.removeEventListener('click', clearSelectedConnection);\n  };\n\n  const clearSelectedConnection = (event: MouseEvent) => {\n    const eventTarget = event.target;\n\n    const shouldResetSelectedConnection = !(\n      eventTarget instanceof SVGLineElement && eventTarget.id === CONNECTION_LINE_ID\n    );\n\n    if (shouldResetSelectedConnection) {\n      setSelectedConnection(undefined);\n      scene.connections.select(undefined);\n    }\n  };\n\n  const selectConnection = (connection: ConnectionState) => {\n    if (scene.isEditingEnabled) {\n      setSelectedConnection(connection);\n      scene.connections.select(connection);\n\n      document.addEventListener('keyup', onKeyUp);\n      scene.selecto!.rootContainer!.addEventListener('click', clearSelectedConnection);\n    }\n  };\n\n  // Figure out target and then target's relative coordinates drawing (if no target do parent)\n  const renderConnections = () => {\n    return (\n      scene.connections.state\n        // Render selected connection last, ensuring it is above other connections\n        .sort((_a, b) => (selectedConnection === b && scene.panel.context.instanceState.selectedConnection ? -1 : 0))\n        .map((v, idx) => {\n          const { source, target, info, vertices, index } = v;\n          const sourceRect = source.div?.getBoundingClientRect();\n          const parent = source.div?.parentElement;\n          const transformScale = scene.scale;\n          const parentRect = getParentBoundingClientRect(scene);\n\n          if (!sourceRect || !parent || !parentRect) {\n            return;\n          }\n\n          const { x1, y1, x2, y2 } = calculateCoordinates(sourceRect, parentRect, info, target, transformScale);\n\n          let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n          if (v.sourceOriginal && v.targetOriginal) {\n            xStart = v.sourceOriginal.x;\n            yStart = v.sourceOriginal.y;\n            xEnd = v.targetOriginal.x;\n            yEnd = v.targetOriginal.y;\n          } else if (source.options.connections) {\n            // If original source or target coordinates are not set for the current connection, set them\n            if (\n              !source.options.connections[index].sourceOriginal ||\n              !source.options.connections[index].targetOriginal\n            ) {\n              source.options.connections[index].sourceOriginal = { x: x1, y: y1 };\n              source.options.connections[index].targetOriginal = { x: x2, y: y2 };\n            }\n          }\n\n          const midpoint = calculateMidpoint(x1, y1, x2, y2);\n          const xDist = xEnd - xStart;\n          const yDist = yEnd - yStart;\n\n          const { strokeColor, strokeWidth, strokeRadius, arrowDirection, lineStyle, shouldAnimate } =\n            getConnectionStyles(info, scene, defaultArrowSize, defaultArrowDirection);\n\n          const isSelected = selectedConnection === v && scene.panel.context.instanceState.selectedConnection;\n\n          const connectionCursorStyle = scene.isEditingEnabled ? 'grab' : '';\n          const selectedStyles = { stroke: '#44aaff', strokeOpacity: 0.6, strokeWidth: strokeWidth + 5 };\n\n          const CONNECTION_HEAD_ID_START = `connectionHeadStart-${headId + Math.random()}`;\n          const CONNECTION_HEAD_ID_END = `connectionHeadEnd-${headId + Math.random()}`;\n\n          const radius = strokeRadius;\n          // Create vertex path and populate array of add vertex controls\n          const addVertices: ConnectionCoordinates[] = [];\n          let pathString = `M${x1} ${y1} `;\n          if (vertices?.length) {\n            vertices.map((vertex, index) => {\n              const x = vertex.x;\n              const y = vertex.y;\n\n              // Convert vertex relative coordinates to scene coordinates\n              const X = x * xDist + xStart;\n              const Y = y * yDist + yStart;\n\n              // Initialize coordinates for first arc control point\n              let xa = X;\n              let ya = Y;\n\n              // Initialize coordinates for second arc control point\n              let xb = X;\n              let yb = Y;\n\n              // Initialize half arc distance and segment angles\n              let lHalfArc = 0;\n              let angle1 = 0;\n              let angle2 = 0;\n\n              // Only calculate arcs if there is a radius\n              if (radius) {\n                if (index < vertices.length - 1) {\n                  const Xn = vertices[index + 1].x * xDist + xStart;\n                  const Yn = vertices[index + 1].y * yDist + yStart;\n                  if (index === 0) {\n                    // First vertex\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  } else {\n                    // All vertices\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                    angle2 = calculateAngle(X, Y, Xn, Yn);\n                  }\n                } else {\n                  // Last vertex\n                  if (index > 0) {\n                    // Not also the first vertex\n                    const previousVertex = vertices[index - 1];\n                    const Xp = previousVertex.x * xDist + xStart;\n                    const Yp = previousVertex.y * yDist + yStart;\n                    angle1 = calculateAngle(Xp, Yp, X, Y);\n                  } else {\n                    angle1 = calculateAngle(x1, y1, X, Y);\n                  }\n                  angle2 = calculateAngle(X, Y, x2, y2);\n                }\n\n                // Calculate angle between two segments where arc will be placed\n                const theta = angle2 - angle1; //radians\n                // Attempt to determine if arc is counter clockwise (ccw)\n                const ccw = theta < 0;\n                // Half arc is used for arc control points\n                lHalfArc = radius * Math.tan(theta / 2);\n                if (ccw) {\n                  lHalfArc *= -1;\n                }\n              }\n\n              if (index === 0) {\n                // For first vertex\n                addVertices.push(\n                  calculateMidpoint((x1 - xStart) / (xEnd - xStart), (y1 - yStart) / (yEnd - yStart), x, y)\n                );\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, x1, y1);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + x1);\n                  ya = Math.round(lDelta * Math.sin(angle1) + y1);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > x1) || (xa < X && xa < x1)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + x1;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + y1;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              } else {\n                // For all other vertices\n                const previousVertex = vertices[index - 1];\n                addVertices.push(calculateMidpoint(previousVertex.x, previousVertex.y, x, y));\n\n                // Only calculate arcs if there is a radius\n                if (radius) {\n                  // Convert previous vertex relative coorindates to scene coordinates\n                  const Xp = previousVertex.x * xDist + xStart;\n                  const Yp = previousVertex.y * yDist + yStart;\n\n                  // Length of segment\n                  const lSegment = calculateDistance(X, Y, Xp, Yp);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegment)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegment;\n                  }\n                  // Default next point to last point\n                  let Xn = x2;\n                  let Yn = y2;\n                  if (index < vertices.length - 1) {\n                    // Not also the last point\n                    const nextVertex = vertices[index + 1];\n                    Xn = nextVertex.x * xDist + xStart;\n                    Yn = nextVertex.y * yDist + yStart;\n                  }\n\n                  // Length of next segment\n                  const lSegmentNext = calculateDistance(X, Y, Xn, Yn);\n                  if (Math.abs(lHalfArc) > 0.5 * Math.abs(lSegmentNext)) {\n                    // Limit curve control points to mid segment\n                    lHalfArc = 0.5 * lSegmentNext;\n                  }\n\n                  // Calculate arc control points\n                  const lDelta = lSegment - lHalfArc;\n                  xa = Math.round(lDelta * Math.cos(angle1) + Xp);\n                  ya = Math.round(lDelta * Math.sin(angle1) + Yp);\n                  xb = Math.round(lHalfArc * Math.cos(angle2) + X);\n                  yb = Math.round(lHalfArc * Math.sin(angle2) + Y);\n\n                  // Check if arc control points are inside of segment, otherwise swap sign\n                  if ((xa > X && xa > Xp) || (xa < X && xa < Xp)) {\n                    xa = (lDelta + 2 * lHalfArc) * Math.cos(angle1) + Xp;\n                    ya = (lDelta + 2 * lHalfArc) * Math.sin(angle1) + Yp;\n                    xb = -lHalfArc * Math.cos(angle2) + X;\n                    yb = -lHalfArc * Math.sin(angle2) + Y;\n                  }\n                }\n              }\n              if (index === vertices.length - 1) {\n                // For last vertex only\n                addVertices.push(\n                  calculateMidpoint((x2 - xStart) / (xEnd - xStart), (y2 - yStart) / (yEnd - yStart), x, y)\n                );\n              }\n              // Add segment to path\n              pathString += `L${xa} ${ya} `;\n\n              if (lHalfArc !== 0) {\n                // Add arc if applicable\n                pathString += `Q ${X} ${Y} ${xb} ${yb} `;\n              }\n            });\n            // Add last segment\n            pathString += `L${x2} ${y2}`;\n          }\n\n          const markerStart =\n            arrowDirection === ConnectionDirection.Reverse || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_START})`\n              : undefined;\n\n          const markerEnd =\n            arrowDirection === ConnectionDirection.Forward || arrowDirection === ConnectionDirection.Both\n              ? `url(#${CONNECTION_HEAD_ID_END})`\n              : undefined;\n\n          const getAnimationDirection = () => {\n            let values = '100;0';\n\n            if (arrowDirection === ConnectionDirection.Reverse) {\n              values = '0;100';\n            }\n\n            return values;\n          };\n\n          return (\n            <svg className={styles.connection} key={idx}>\n              <g onClick={() => selectConnection(v)}>\n                <defs>\n                  <marker\n                    id={CONNECTION_HEAD_ID_START}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"0\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"10 0, 0 3.5, 10 7\" fill={strokeColor} />\n                  </marker>\n                  <marker\n                    id={CONNECTION_HEAD_ID_END}\n                    markerWidth=\"10\"\n                    markerHeight=\"7\"\n                    refX=\"10\"\n                    refY=\"3.5\"\n                    orient=\"auto\"\n                    stroke={strokeColor}\n                  >\n                    <polygon points=\"0 0, 10 3.5, 0 7\" fill={strokeColor} />\n                  </marker>\n                </defs>\n                {vertices?.length ? (\n                  <g>\n                    <path\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      d={pathString}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      fill={'none'}\n                      style={isSelected ? selectedStyles : {}}\n                    />\n                    <path\n                      d={pathString}\n                      stroke={strokeColor}\n                      strokeWidth={strokeWidth}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      fill={'none'}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </path>\n                    {isSelected && (\n                      <g>\n                        {vertices.map((value, index) => {\n                          return (\n                            <circle\n                              id={CONNECTION_VERTEX_ID}\n                              data-index={index}\n                              key={`${CONNECTION_VERTEX_ID}${index}_${idx}`}\n                              cx={value.x * xDist + xStart}\n                              cy={value.y * yDist + yStart}\n                              r={5}\n                              stroke={strokeColor}\n                              className={styles.vertex}\n                              cursor={'crosshair'}\n                              pointerEvents=\"auto\"\n                            />\n                          );\n                        })}\n                        {vertices.length < maximumVertices &&\n                          addVertices.map((value, index) => {\n                            return (\n                              <circle\n                                id={CONNECTION_VERTEX_ADD_ID}\n                                data-index={index}\n                                key={`${CONNECTION_VERTEX_ADD_ID}${index}_${idx}`}\n                                cx={value.x * xDist + xStart}\n                                cy={value.y * yDist + yStart}\n                                r={4}\n                                stroke={strokeColor}\n                                className={styles.addVertex}\n                                cursor={'crosshair'}\n                                pointerEvents=\"auto\"\n                              />\n                            );\n                          })}\n                      </g>\n                    )}\n                  </g>\n                ) : (\n                  <g>\n                    <line\n                      id={`${CONNECTION_LINE_ID}_transparent`}\n                      cursor={connectionCursorStyle}\n                      pointerEvents=\"auto\"\n                      stroke=\"transparent\"\n                      strokeWidth={15}\n                      style={isSelected ? selectedStyles : {}}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                    />\n                    <line\n                      id={CONNECTION_LINE_ID}\n                      stroke={strokeColor}\n                      pointerEvents=\"auto\"\n                      strokeWidth={strokeWidth}\n                      markerEnd={markerEnd}\n                      markerStart={markerStart}\n                      strokeDasharray={lineStyle}\n                      strokeDashoffset={1}\n                      x1={x1}\n                      y1={y1}\n                      x2={x2}\n                      y2={y2}\n                      cursor={connectionCursorStyle}\n                    >\n                      {shouldAnimate && (\n                        <animate\n                          attributeName=\"stroke-dashoffset\"\n                          values={getAnimationDirection()}\n                          dur=\"5s\"\n                          calcMode=\"linear\"\n                          repeatCount=\"indefinite\"\n                          fill={'freeze'}\n                        />\n                      )}\n                    </line>\n                    {isSelected && (\n                      <circle\n                        id={CONNECTION_VERTEX_ADD_ID}\n                        data-index={0}\n                        cx={midpoint.x}\n                        cy={midpoint.y}\n                        r={4}\n                        stroke={strokeColor}\n                        className={styles.addVertex}\n                        cursor={'crosshair'}\n                        pointerEvents=\"auto\"\n                      />\n                    )}\n                  </g>\n                )}\n              </g>\n            </svg>\n          );\n        })\n    );\n  };\n\n  return (\n    <>\n      <svg ref={setSVGRef} className={styles.editorSVG}>\n        <defs>\n          <marker\n            id={EDITOR_HEAD_ID}\n            markerWidth=\"10\"\n            markerHeight=\"7\"\n            refX=\"10\"\n            refY=\"3.5\"\n            orient=\"auto\"\n            stroke={defaultArrowColor}\n          >\n            <polygon points=\"0 0, 10 3.5, 0 7\" fill={defaultArrowColor} />\n          </marker>\n        </defs>\n        <line ref={setLineRef} stroke={defaultArrowColor} strokeWidth={2} markerEnd={`url(#${EDITOR_HEAD_ID})`} />\n      </svg>\n      <svg ref={setSVGVertexRef} className={styles.editorSVG}>\n        <path\n          ref={setVertexPathRef}\n          stroke={defaultArrowColor}\n          strokeWidth={2}\n          strokeDasharray={'5, 5'}\n          fill={'none'}\n        />\n        <circle ref={setVertexRef} stroke={defaultArrowColor} r={4} className={styles.vertex} />\n      </svg>\n      {renderConnections()}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  editorSVG: css({\n    position: 'absolute',\n    pointerEvents: 'none',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    display: 'none',\n  }),\n  connection: css({\n    position: 'absolute',\n    width: '100%',\n    height: '100%',\n    zIndex: 1000,\n    pointerEvents: 'none',\n  }),\n  vertex: css({\n    fill: '#44aaff',\n    strokeWidth: 2,\n  }),\n  addVertex: css({\n    fill: '#44aaff',\n    opacity: 0.5,\n    strokeWidth: 1,\n  }),\n});\n","import * as React from 'react';\nimport { BehaviorSubject } from 'rxjs';\n\nimport { config } from '@grafana/runtime';\nimport { CanvasConnection, ConnectionCoordinates, ConnectionPath } from 'app/features/canvas/element';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { ConnectionState } from '../../types';\nimport {\n  calculateAngle,\n  calculateCoordinates,\n  getConnections,\n  getParentBoundingClientRect,\n  isConnectionSource,\n  isConnectionTarget,\n} from '../../utils';\n\nimport {\n  CONNECTION_ANCHOR_ALT,\n  ConnectionAnchors,\n  CONNECTION_ANCHOR_HIGHLIGHT_OFFSET,\n  ANCHORS,\n  ANCHOR_PADDING,\n  HALF_SIZE,\n} from './ConnectionAnchors';\nimport { ConnectionSVG } from './ConnectionSVG';\n\nexport const CONNECTION_VERTEX_ID = 'vertex';\nexport const CONNECTION_VERTEX_ADD_ID = 'vertexAdd';\nconst CONNECTION_VERTEX_ORTHO_TOLERANCE = 0.05; // Cartesian ratio against vertical or horizontal tolerance\nconst CONNECTION_VERTEX_SNAP_TOLERANCE = (5 / 180) * Math.PI; // Multi-segment snapping angle in radians to trigger vertex removal\n\nexport class Connections {\n  scene: Scene;\n  connectionAnchorDiv?: HTMLDivElement;\n  anchorsDiv?: HTMLDivElement;\n  connectionSVG?: SVGElement;\n  connectionLine?: SVGLineElement;\n  connectionSVGVertex?: SVGElement;\n  connectionVertexPath?: SVGPathElement;\n  connectionVertex?: SVGCircleElement;\n  connectionSource?: ElementState;\n  connectionTarget?: ElementState;\n  isDrawingConnection?: boolean;\n  selectedVertexIndex?: number;\n  didConnectionLeaveHighlight?: boolean;\n  state: ConnectionState[] = [];\n  readonly selection = new BehaviorSubject<ConnectionState | undefined>(undefined);\n\n  constructor(scene: Scene) {\n    this.scene = scene;\n    this.updateState();\n  }\n\n  select = (connection: ConnectionState | undefined) => {\n    if (connection === this.selection.value) {\n      return;\n    }\n    this.selection.next(connection);\n  };\n\n  updateState = () => {\n    const s = this.selection.value;\n    this.state = getConnections(this.scene.byName);\n\n    if (s) {\n      for (let c of this.state) {\n        if (c.source === s.source && c.index === s.index) {\n          this.selection.next(c);\n          break;\n        }\n      }\n    }\n  };\n\n  setConnectionAnchorRef = (anchorElement: HTMLDivElement) => {\n    this.connectionAnchorDiv = anchorElement;\n  };\n\n  setAnchorsRef = (anchorsElement: HTMLDivElement) => {\n    this.anchorsDiv = anchorsElement;\n  };\n\n  setConnectionSVGRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVG = connectionSVG;\n  };\n\n  setConnectionLineRef = (connectionLine: SVGLineElement) => {\n    this.connectionLine = connectionLine;\n  };\n\n  setConnectionSVGVertexRef = (connectionSVG: SVGSVGElement) => {\n    this.connectionSVGVertex = connectionSVG;\n  };\n\n  setConnectionVertexRef = (connectionVertex: SVGCircleElement) => {\n    this.connectionVertex = connectionVertex;\n  };\n\n  setConnectionVertexPathRef = (connectionVertexPath: SVGPathElement) => {\n    this.connectionVertexPath = connectionVertexPath;\n  };\n\n  // Recursively find the first parent that is a canvas element\n  findElementTarget = (element: Element): ElementState | undefined => {\n    let elementTarget = undefined;\n\n    // Cap recursion at the scene level\n    if (element === this.scene.div) {\n      return undefined;\n    }\n\n    elementTarget = findElementByTarget(element, this.scene.root.elements);\n\n    if (!elementTarget && element.parentElement) {\n      elementTarget = this.findElementTarget(element.parentElement);\n    }\n\n    return elementTarget;\n  };\n\n  handleMouseEnter = (event: React.MouseEvent) => {\n    if (!(event.target instanceof Element) || !this.scene.isEditingEnabled) {\n      return;\n    }\n\n    let element: ElementState | undefined = this.findElementTarget(event.target);\n\n    if (!element) {\n      console.log('no element');\n      return;\n    }\n\n    if (this.isDrawingConnection) {\n      this.connectionTarget = element;\n    } else {\n      this.connectionSource = element;\n      if (!this.connectionSource) {\n        console.log('no connection source');\n        return;\n      }\n    }\n\n    const customElementAnchors = element?.item.customConnectionAnchors || ANCHORS;\n    // This type cast is necessary as TS doesn't understand that `Element` is an `HTMLElement`\n    // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n    const anchors = Array.from(this.anchorsDiv?.children as HTMLCollectionOf<HTMLElement>);\n    const anchorsAmount = customElementAnchors.length;\n\n    // re-calculate the position of the existing anchors on hover\n    // and hide the rest of the anchors if there are more than the custom ones\n    anchors.forEach((anchor, index) => {\n      if (index >= anchorsAmount) {\n        anchor.style.display = 'none';\n      } else {\n        const { x, y } = customElementAnchors[index];\n        anchor.style.top = `calc(${-y * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.left = `calc(${x * 50 + 50}% - ${HALF_SIZE}px - ${ANCHOR_PADDING}px)`;\n        anchor.style.display = 'block';\n      }\n    });\n\n    const elementBoundingRect = element.div!.getBoundingClientRect();\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    const relativeTop = elementBoundingRect.top - (parentBoundingRect?.top ?? 0);\n    const relativeLeft = elementBoundingRect.left - (parentBoundingRect?.left ?? 0);\n\n    if (this.connectionAnchorDiv) {\n      this.connectionAnchorDiv.style.display = 'none';\n      this.connectionAnchorDiv.style.display = 'block';\n      this.connectionAnchorDiv.style.top = `${relativeTop / transformScale}px`;\n      this.connectionAnchorDiv.style.left = `${relativeLeft / transformScale}px`;\n      this.connectionAnchorDiv.style.height = `${elementBoundingRect.height / transformScale}px`;\n      this.connectionAnchorDiv.style.width = `${elementBoundingRect.width / transformScale}px`;\n    }\n  };\n\n  // Return boolean indicates if connection anchors were hidden or not\n  handleMouseLeave = (event: React.MouseEvent | React.FocusEvent): boolean => {\n    // If mouse is leaving INTO the anchor image, don't remove div\n    if (\n      event.relatedTarget instanceof HTMLImageElement &&\n      event.relatedTarget.getAttribute('alt') === CONNECTION_ANCHOR_ALT\n    ) {\n      return false;\n    }\n\n    this.connectionTarget = undefined;\n    this.connectionAnchorDiv!.style.display = 'none';\n    return true;\n  };\n\n  connectionListener = (event: MouseEvent) => {\n    event.preventDefault();\n\n    if (!(this.connectionLine && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = event.pageX - parentBoundingRect.x ?? 0;\n    const y = event.pageY - parentBoundingRect.y ?? 0;\n\n    this.connectionLine.setAttribute('x2', `${x / transformScale}`);\n    this.connectionLine.setAttribute('y2', `${y / transformScale}`);\n\n    const connectionLineX1 = this.connectionLine.x1.baseVal.value;\n    const connectionLineY1 = this.connectionLine.y1.baseVal.value;\n    if (!this.didConnectionLeaveHighlight) {\n      const connectionLength = Math.hypot(x - connectionLineX1, y - connectionLineY1);\n      if (connectionLength > CONNECTION_ANCHOR_HIGHLIGHT_OFFSET && this.connectionSVG) {\n        this.didConnectionLeaveHighlight = true;\n        this.connectionSVG.style.display = 'block';\n        this.isDrawingConnection = true;\n      }\n    }\n\n    if (!event.buttons) {\n      if (this.connectionSource && this.connectionSource.div && this.connectionSource.div.parentElement) {\n        const sourceRect = this.connectionSource.div.getBoundingClientRect();\n\n        const transformScale = this.scene.scale;\n        const parentRect = getParentBoundingClientRect(this.scene);\n\n        if (!parentRect) {\n          return;\n        }\n\n        const sourceVerticalCenter = (sourceRect.top - parentRect.top + sourceRect.height / 2) / transformScale;\n        const sourceHorizontalCenter = (sourceRect.left - parentRect.left + sourceRect.width / 2) / transformScale;\n\n        // Convert from DOM coords to connection coords\n        // TODO: Break this out into util function and add tests\n        const sourceX = (connectionLineX1 - sourceHorizontalCenter) / (sourceRect.width / 2 / transformScale);\n        const sourceY = (sourceVerticalCenter - connectionLineY1) / (sourceRect.height / 2 / transformScale);\n\n        let targetX;\n        let targetY;\n        let targetName;\n\n        if (this.connectionTarget && this.connectionTarget.div) {\n          const targetRect = this.connectionTarget.div.getBoundingClientRect();\n\n          const targetVerticalCenter = targetRect.top - parentRect.top + targetRect.height / 2;\n          const targetHorizontalCenter = targetRect.left - parentRect.left + targetRect.width / 2;\n\n          targetX = (x - targetHorizontalCenter) / (targetRect.width / 2);\n          targetY = (targetVerticalCenter - y) / (targetRect.height / 2);\n          targetName = this.connectionTarget.options.name;\n        } else {\n          const parentVerticalCenter = parentRect.height / 2;\n          const parentHorizontalCenter = parentRect.width / 2;\n\n          targetX = (x - parentHorizontalCenter) / (parentRect.width / 2);\n          targetY = (parentVerticalCenter - y) / (parentRect.height / 2);\n        }\n\n        const connection = {\n          source: {\n            x: sourceX,\n            y: sourceY,\n          },\n          target: {\n            x: targetX,\n            y: targetY,\n          },\n          targetName: targetName,\n          color: {\n            fixed: config.theme2.colors.text.primary,\n          },\n          size: {\n            fixed: 2,\n            min: 1,\n            max: 10,\n          },\n          path: ConnectionPath.Straight,\n        };\n\n        const { options } = this.connectionSource;\n        if (!options.connections) {\n          options.connections = [];\n        }\n        if (this.didConnectionLeaveHighlight) {\n          this.connectionSource.options.connections = [...options.connections, connection];\n          this.connectionSource.onChange(this.connectionSource.options);\n        }\n      }\n\n      if (this.connectionSVG) {\n        this.connectionSVG.style.display = 'none';\n      }\n\n      if (this.scene.selecto && this.scene.selecto.rootContainer) {\n        this.scene.selecto.rootContainer.style.cursor = 'default';\n        this.scene.selecto.rootContainer.removeEventListener('mousemove', this.connectionListener);\n      }\n\n      this.isDrawingConnection = false;\n      this.updateState();\n      this.scene.save();\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging an existing vertex\n  vertexListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale ?? 0;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale ?? 0;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length - 1) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex + 1].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex + 1].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    let deleteVertex = false;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n\n      const angleOverall = calculateAngle(vx1, vy1, vx2, vy2);\n      const angleBefore = calculateAngle(vx1, vy1, x, y);\n      deleteVertex = Math.abs(angleBefore - angleOverall) < CONNECTION_VERTEX_SNAP_TOLERANCE;\n    }\n\n    if (deleteVertex) {\n      // Display temporary vertex removal\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'none';\n    } else {\n      // Display temporary vertex during drag\n      this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n      this.connectionSVGVertex!.style.display = 'block';\n      this.connectionVertex.style.display = 'block';\n    }\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and update appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n\n            // TODO for vertex removal, clear out originals?\n            if (deleteVertex) {\n              currentVertices.splice(vertexIndex, 1);\n            } else {\n              const currentVertex = { ...currentVertices[vertexIndex] };\n\n              currentVertex.x = (xSnap - xStart) / xDist;\n              currentVertex.y = (ySnap - yStart) / yDist;\n\n              currentVertices[vertexIndex] = currentVertex;\n            }\n\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n\n            // Update save model\n            currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n            this.updateState();\n            this.scene.save();\n          }\n        }\n      }\n    }\n  };\n\n  // Handles mousemove and mouseup events when dragging a new vertex\n  vertexAddListener = (event: MouseEvent) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n\n    event.preventDefault();\n\n    if (!(this.connectionVertex && this.scene.div && this.scene.div.parentElement)) {\n      return;\n    }\n\n    const transformScale = this.scene.scale;\n    const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n    if (!parentBoundingRect) {\n      return;\n    }\n\n    const x = (event.pageX - parentBoundingRect.x) / transformScale ?? 0;\n    const y = (event.pageY - parentBoundingRect.y) / transformScale ?? 0;\n\n    this.connectionVertex?.setAttribute('cx', `${x}`);\n    this.connectionVertex?.setAttribute('cy', `${y}`);\n\n    const selectedValue = this.selection.value;\n    const sourceRect = selectedValue!.source.div!.getBoundingClientRect();\n\n    // calculate relative coordinates based on source and target coorindates of connection\n    const { x1, y1, x2, y2 } = calculateCoordinates(\n      sourceRect,\n      parentBoundingRect,\n      selectedValue?.info!,\n      selectedValue!.target,\n      transformScale\n    );\n\n    let { xStart, yStart, xEnd, yEnd } = { xStart: x1, yStart: y1, xEnd: x2, yEnd: y2 };\n    if (selectedValue?.sourceOriginal && selectedValue.targetOriginal) {\n      xStart = selectedValue.sourceOriginal.x;\n      yStart = selectedValue.sourceOriginal.y;\n      xEnd = selectedValue.targetOriginal.x;\n      yEnd = selectedValue.targetOriginal.y;\n    }\n\n    const xDist = xEnd - xStart;\n    const yDist = yEnd - yStart;\n\n    let vx1 = x1;\n    let vy1 = y1;\n    let vx2 = x2;\n    let vy2 = y2;\n    if (selectedValue && selectedValue.vertices) {\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex > 0) {\n        vx1 = selectedValue.vertices[this.selectedVertexIndex - 1].x * xDist + xStart;\n        vy1 = selectedValue.vertices[this.selectedVertexIndex - 1].y * yDist + yStart;\n      }\n      if (this.selectedVertexIndex !== undefined && this.selectedVertexIndex < selectedValue.vertices.length) {\n        vx2 = selectedValue.vertices[this.selectedVertexIndex].x * xDist + xStart;\n        vy2 = selectedValue.vertices[this.selectedVertexIndex].y * yDist + yStart;\n      }\n    }\n\n    // Check if slope before vertex and after vertex is within snapping tolerance\n    let xSnap = x;\n    let ySnap = y;\n    // Ignore if control key being held\n    if (!event.ctrlKey) {\n      // Check if segment before and after vertex are close to vertical or horizontal\n      const verticalBefore = Math.abs((x - vx1) / (y - vy1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const verticalAfter = Math.abs((x - vx2) / (y - vy2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalBefore = Math.abs((y - vy1) / (x - vx1)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n      const horizontalAfter = Math.abs((y - vy2) / (x - vx2)) < CONNECTION_VERTEX_ORTHO_TOLERANCE;\n\n      if (verticalBefore) {\n        xSnap = vx1;\n      } else if (verticalAfter) {\n        xSnap = vx2;\n      }\n      if (horizontalBefore) {\n        ySnap = vy1;\n      } else if (horizontalAfter) {\n        ySnap = vy2;\n      }\n\n      if ((verticalBefore || verticalAfter) && (horizontalBefore || horizontalAfter)) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'move';\n      } else if (verticalBefore || verticalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'col-resize';\n      } else if (horizontalBefore || horizontalAfter) {\n        this.scene.selecto!.rootContainer!.style.cursor = 'row-resize';\n      }\n    }\n\n    this.connectionVertexPath?.setAttribute('d', `M${vx1} ${vy1} L${xSnap} ${ySnap} L${vx2} ${vy2}`);\n    this.connectionSVGVertex!.style.display = 'block';\n    this.connectionVertex.style.display = 'block';\n\n    // Handle mouseup\n    if (!event.buttons) {\n      // Remove existing event listener\n      this.scene.selecto?.rootContainer?.removeEventListener('mousemove', this.vertexAddListener);\n      this.scene.selecto?.rootContainer?.removeEventListener('mouseup', this.vertexAddListener);\n      this.scene.selecto!.rootContainer!.style.cursor = 'auto';\n      this.connectionSVGVertex!.style.display = 'none';\n\n      // call onChange here and insert new vertex at appropriate index of connection vertices array\n      const connectionIndex = selectedValue?.index;\n      const vertexIndex = this.selectedVertexIndex;\n\n      if (connectionIndex !== undefined && vertexIndex !== undefined) {\n        const currentSource = selectedValue!.source;\n        if (currentSource.options.connections) {\n          const currentConnections = [...currentSource.options.connections];\n          const newVertex = { x: (x - xStart) / xDist, y: (y - yStart) / yDist };\n          if (currentConnections[connectionIndex].vertices) {\n            const currentVertices = [...currentConnections[connectionIndex].vertices!];\n            currentVertices.splice(vertexIndex, 0, newVertex);\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          } else {\n            // For first vertex creation\n            const currentVertices: ConnectionCoordinates[] = [newVertex];\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              vertices: currentVertices,\n            };\n          }\n\n          // Check for original state\n          if (\n            !currentConnections[connectionIndex].sourceOriginal ||\n            !currentConnections[connectionIndex].targetOriginal\n          ) {\n            currentConnections[connectionIndex] = {\n              ...currentConnections[connectionIndex],\n              sourceOriginal: { x: x1, y: y1 },\n              targetOriginal: { x: x2, y: y2 },\n            };\n          }\n          // Update save model\n          currentSource.onChange({ ...currentSource.options, connections: currentConnections });\n          this.updateState();\n          this.scene.save();\n        }\n      }\n    }\n  };\n\n  handleConnectionDragStart = (selectedTarget: HTMLElement, clientX: number, clientY: number) => {\n    this.scene.selecto!.rootContainer!.style.cursor = 'crosshair';\n    if (this.connectionSVG && this.connectionLine && this.scene.div && this.scene.div.parentElement) {\n      const connectionStartTargetBox = selectedTarget.getBoundingClientRect();\n\n      const transformScale = this.scene.scale;\n      const parentBoundingRect = getParentBoundingClientRect(this.scene);\n\n      if (!parentBoundingRect) {\n        return;\n      }\n\n      // Multiply by transform scale to calculate the correct scaled offset\n      const connectionAnchorOffsetX = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n      const connectionAnchorOffsetY = CONNECTION_ANCHOR_HIGHLIGHT_OFFSET * transformScale;\n\n      const x = (connectionStartTargetBox.x - parentBoundingRect.x + connectionAnchorOffsetX) / transformScale;\n      const y = (connectionStartTargetBox.y - parentBoundingRect.y + connectionAnchorOffsetY) / transformScale;\n\n      const mouseX = clientX - parentBoundingRect.x;\n      const mouseY = clientY - parentBoundingRect.y;\n\n      this.connectionLine.setAttribute('x1', `${x}`);\n      this.connectionLine.setAttribute('y1', `${y}`);\n      this.connectionLine.setAttribute('x2', `${mouseX}`);\n      this.connectionLine.setAttribute('y2', `${mouseY}`);\n      this.didConnectionLeaveHighlight = false;\n    }\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.connectionListener);\n  };\n\n  // Add event listener at root container during existing vertex drag\n  handleVertexDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexListener);\n  };\n\n  // Add event listener at root container during creation of new vertex\n  handleVertexAddDragStart = (selectedTarget: HTMLElement) => {\n    // Get vertex index from selected target data\n    this.selectedVertexIndex = Number(selectedTarget.getAttribute('data-index'));\n\n    this.scene.selecto?.rootContainer?.addEventListener('mousemove', this.vertexAddListener);\n    this.scene.selecto?.rootContainer?.addEventListener('mouseup', this.vertexAddListener);\n  };\n\n  onChange = (current: ConnectionState, update: CanvasConnection) => {\n    const connections = current.source.options.connections?.splice(0) ?? [];\n    connections[current.index] = update;\n    current.source.onChange({ ...current.source.options, connections });\n    this.updateState();\n  };\n\n  // used for moveable actions\n  connectionsNeedUpdate = (element: ElementState): boolean => {\n    return isConnectionSource(element) || isConnectionTarget(element, this.scene.byName);\n  };\n\n  render() {\n    return (\n      <>\n        <ConnectionAnchors\n          setRef={this.setConnectionAnchorRef}\n          setAnchorsRef={this.setAnchorsRef}\n          handleMouseLeave={this.handleMouseLeave}\n        />\n        <ConnectionSVG\n          setSVGRef={this.setConnectionSVGRef}\n          setLineRef={this.setConnectionLineRef}\n          setSVGVertexRef={this.setConnectionSVGVertexRef}\n          setVertexPathRef={this.setConnectionVertexPathRef}\n          setVertexRef={this.setConnectionVertexRef}\n          scene={this.scene}\n        />\n      </>\n    );\n  }\n}\n","import { MoveableManagerInterface, Renderer } from 'moveable';\n\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport const settingsViewable = (scene: Scene) => ({\n  name: 'settingsViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    // If selection is more than 1 element don't display settings button\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    const openSettings = (x: number, y: number) => {\n      const container = moveable.getContainer();\n      const evt = new PointerEvent('contextmenu', { clientX: x, clientY: y });\n      container.dispatchEvent(evt);\n    };\n\n    const onClick = (event: React.MouseEvent) => {\n      openSettings(event.clientX, event.clientY);\n    };\n\n    const onKeyPress = (event: React.KeyboardEvent) => {\n      if (event.key === 'Enter') {\n        const rect = event.currentTarget.getBoundingClientRect();\n        openSettings(rect.x, rect.y);\n      }\n    };\n\n    const rect = moveable.getRect();\n    return (\n      <div\n        key={'settings-viewable'}\n        className={'moveable-settings'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width + 18}px`,\n          top: '0px',\n          color: 'white',\n          fontSize: '18px',\n          cursor: 'pointer',\n          userSelect: 'none',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n        onClick={onClick}\n        onKeyDown={onKeyPress}\n        role=\"button\"\n        tabIndex={0}\n      >\n        {``}\n        \n        {``}\n      </div>\n    );\n  },\n});\n\nexport const dimensionViewable = {\n  name: 'dimensionViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    return (\n      <div\n        key={'dimension-viewable'}\n        className={'moveable-dimension'}\n        style={{\n          position: 'absolute',\n          left: `${rect.width / 2}px`,\n          top: `${rect.height + 20}px`,\n          background: '#4af',\n          borderRadius: '2px',\n          padding: '2px 4px',\n          color: 'white',\n          fontSize: '13px',\n          whiteSpace: 'nowrap',\n          fontWeight: 'bold',\n          willChange: 'transform',\n          transform: 'translate(-50%, 0px)',\n          zIndex: 100,\n        }}\n      >\n        {Math.round(rect.offsetWidth)} x {Math.round(rect.offsetHeight)}\n      </div>\n    );\n  },\n};\n\nexport const constraintViewable = (scene: Scene) => ({\n  name: 'constraintViewable',\n  props: [],\n  events: [],\n  render(moveable: MoveableManagerInterface<unknown, unknown>, React: Renderer) {\n    const rect = moveable.getRect();\n    const targetElement = findElementByTarget(moveable.state.target!, scene.root.elements);\n\n    // If selection is more than 1 element don't display constraint visualizations\n    if (scene.selecto?.getSelectedTargets() && scene.selecto?.getSelectedTargets().length > 1) {\n      return;\n    }\n\n    let verticalConstraintVisualization = null;\n    let horizontalConstraintVisualization = null;\n\n    const constraint = targetElement?.tempConstraint ?? targetElement?.options.constraint ?? {};\n\n    const borderStyle = '1px dashed #4af';\n\n    const centerIndicatorLineOne = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(45deg)',\n      },\n    });\n\n    const centerIndicatorLineTwo = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 2 - rect.height / 16}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 8}px`,\n        transform: 'rotate(-45deg)',\n      },\n    });\n\n    const centerIndicator = React.createElement('div', {}, [centerIndicatorLineOne, centerIndicatorLineTwo]);\n\n    const verticalConstraintTop = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        bottom: '0px',\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintBottom = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height}px`,\n        borderLeft: borderStyle,\n        height: '100vh',\n      },\n    });\n\n    const verticalConstraintTopBottom = React.createElement('div', {}, [\n      verticalConstraintTop,\n      verticalConstraintBottom,\n    ]);\n\n    const verticalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 2}px`,\n        top: `${rect.height / 4}px`,\n        borderLeft: borderStyle,\n        height: `${rect.height / 2}px`,\n      },\n    });\n\n    const verticalConstraintCenter = React.createElement('div', {}, [verticalConstraintCenterLine, centerIndicator]);\n\n    switch (constraint.vertical) {\n      case VerticalConstraint.Top:\n        verticalConstraintVisualization = verticalConstraintTop;\n        break;\n      case VerticalConstraint.Bottom:\n        verticalConstraintVisualization = verticalConstraintBottom;\n        break;\n      case VerticalConstraint.TopBottom:\n        verticalConstraintVisualization = verticalConstraintTopBottom;\n        break;\n      case VerticalConstraint.Center:\n        verticalConstraintVisualization = verticalConstraintCenter;\n        break;\n    }\n\n    const horizontalConstraintLeft = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        right: '0px',\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintRight = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: '100vw',\n      },\n    });\n\n    const horizontalConstraintLeftRight = React.createElement('div', {}, [\n      horizontalConstraintLeft,\n      horizontalConstraintRight,\n    ]);\n\n    const horizontalConstraintCenterLine = React.createElement('div', {\n      style: {\n        position: 'absolute',\n        left: `${rect.width / 4}px`,\n        top: `${rect.height / 2}px`,\n        borderTop: borderStyle,\n        width: `${rect.width / 2}px`,\n      },\n    });\n\n    const horizontalConstraintCenter = React.createElement('div', {}, [\n      horizontalConstraintCenterLine,\n      centerIndicator,\n    ]);\n\n    switch (constraint.horizontal) {\n      case HorizontalConstraint.Left:\n        horizontalConstraintVisualization = horizontalConstraintLeft;\n        break;\n      case HorizontalConstraint.Right:\n        horizontalConstraintVisualization = horizontalConstraintRight;\n        break;\n      case HorizontalConstraint.LeftRight:\n        horizontalConstraintVisualization = horizontalConstraintLeftRight;\n        break;\n      case HorizontalConstraint.Center:\n        horizontalConstraintVisualization = horizontalConstraintCenter;\n        break;\n    }\n\n    const constraintVisualization = React.createElement('div', {}, [\n      verticalConstraintVisualization,\n      horizontalConstraintVisualization,\n    ]);\n\n    return constraintVisualization;\n  },\n});\n","import Moveable from 'moveable';\nimport Selecto from 'selecto';\n\nimport { CONNECTION_ANCHOR_DIV_ID } from 'app/plugins/panel/canvas/components/connections/ConnectionAnchors';\nimport {\n  CONNECTION_VERTEX_ID,\n  CONNECTION_VERTEX_ADD_ID,\n} from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { VerticalConstraint, HorizontalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { getParent } from 'app/plugins/panel/canvas/utils';\n\nimport { dimensionViewable, constraintViewable, settingsViewable } from './ables';\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\nimport { findElementByTarget } from './sceneElementManagement';\n\n// Helper function that disables custom able functionality\nconst disableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: false,\n    constraintViewable: false,\n    settingsViewable: false,\n  };\n};\n\n// Helper function that enables custom able functionality\nconst enableCustomables = (moveable: Moveable) => {\n  moveable!.props = {\n    dimensionViewable: true,\n    constraintViewable: true,\n    settingsViewable: true,\n  };\n};\n\n/* \n  Helper function that determines if the selected DOM target is currently selected in selecto state.\n\n  For context canvas elements each have a different level of nesting.\n  Given this, we need to traverse up the DOM tree from the selected target to find\n  the element's registered selecto div to determine if the selected target is already selected in selecto state.\n  See `initMoveable` and `generateTargetElements` for more context.\n*/\nconst isTargetAlreadySelected = (selectedTarget: HTMLElement, scene: Scene) => {\n  let selectedTargetParent = selectedTarget.parentElement;\n  let isTargetAlreadySelected = false;\n\n  // Traverse up the DOM tree to check if the selected target is already selected\n  while (selectedTargetParent) {\n    // If the selected target is the scene's root element div, break the loop\n    if (selectedTargetParent === scene.root.div) {\n      break;\n    }\n\n    // Check if the selected target is already selected\n    isTargetAlreadySelected = scene.selecto?.getSelectedTargets().includes(selectedTargetParent) ?? false;\n    if (isTargetAlreadySelected) {\n      break;\n    }\n\n    // Move up the DOM tree to the next parent element to check\n    selectedTargetParent = selectedTargetParent.parentElement;\n  }\n\n  return isTargetAlreadySelected;\n};\n\n// Generate HTML element divs for every canvas element to configure selecto / moveable\nconst generateTargetElements = (rootElements: ElementState[]): HTMLDivElement[] => {\n  let targetElements: HTMLDivElement[] = [];\n\n  const stack = [...rootElements];\n  while (stack.length > 0) {\n    const currentElement = stack.shift();\n\n    if (currentElement && currentElement.div) {\n      targetElements.push(currentElement.div);\n    }\n\n    const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n    for (const nestedElement of nestedElements) {\n      stack.unshift(nestedElement);\n    }\n  }\n\n  return targetElements;\n};\n\n// Main entry point for initializing / updating moveable and selecto configuration\nexport const initMoveable = (destroySelecto = false, allowChanges = true, scene: Scene) => {\n  const targetElements = generateTargetElements(scene.root.elements);\n\n  if (destroySelecto && scene.selecto) {\n    scene.selecto.destroy();\n  }\n\n  scene.selecto = new Selecto({\n    container: scene.div,\n    rootContainer: getParent(scene),\n    selectableTargets: targetElements,\n    toggleContinueSelect: 'shift',\n    selectFromInside: false,\n    hitRate: 0,\n  });\n\n  const snapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n  const elementSnapDirections = { top: true, left: true, bottom: true, right: true, center: true, middle: true };\n\n  scene.moveable = new Moveable(scene.div!, {\n    draggable: allowChanges && !scene.editModeEnabled.getValue(),\n    resizable: allowChanges,\n\n    // Setup rotatable\n    rotatable: allowChanges,\n    throttleRotate: 5,\n    rotationPosition: ['top', 'right'],\n\n    // Setup snappable\n    snappable: allowChanges,\n    snapDirections: snapDirections,\n    elementSnapDirections: elementSnapDirections,\n    elementGuidelines: targetElements,\n\n    ables: [dimensionViewable, constraintViewable(scene), settingsViewable(scene)],\n    props: {\n      dimensionViewable: allowChanges,\n      constraintViewable: allowChanges,\n      settingsViewable: allowChanges,\n    },\n    origin: false,\n  })\n    .on('rotateStart', () => {\n      disableCustomables(scene.moveable!);\n    })\n    .on('rotate', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        targetedElement.applyRotate(event);\n      }\n    })\n    .on('rotateGroup', (e) => {\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyRotate(event);\n        }\n      }\n    })\n    .on('rotateEnd', () => {\n      enableCustomables(scene.moveable!);\n      // Update the editor with the new rotation\n      scene.moved.next(Date.now());\n    })\n    .on('click', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      let elementSupportsEditing = false;\n      if (targetedElement) {\n        elementSupportsEditing = targetedElement.item.hasEditMode ?? false;\n      }\n\n      if (event.isDouble && allowChanges && !scene.editModeEnabled.getValue() && elementSupportsEditing) {\n        scene.editModeEnabled.next(true);\n      }\n    })\n    .on('clickGroup', (event) => {\n      scene.selecto!.clickTarget(event.inputEvent, event.inputTarget);\n    })\n    .on('dragStart', (event) => {\n      scene.ignoreDataUpdate = true;\n      scene.setNonTargetPointerEvents(event.target, true);\n\n      // Remove the selected element from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n        if (targetIndex > -1) {\n          scene.moveable.elementGuidelines.splice(targetIndex, 1);\n        }\n      }\n    })\n    .on('dragGroupStart', (e) => {\n      scene.ignoreDataUpdate = true;\n\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n    })\n    .on('drag', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyDrag(event);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n    })\n    .on('dragGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyDrag(event);\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n    })\n    .on('dragGroupEnd', (e) => {\n      e.events.forEach((event) => {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          if (targetedElement) {\n            targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n          }\n\n          // re-add the selected elements to the snappable guidelines\n          if (scene.moveable && scene.moveable.elementGuidelines) {\n            scene.moveable.elementGuidelines.push(event.target);\n          }\n        }\n      });\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n    })\n    .on('dragEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n\n      scene.moved.next(Date.now());\n      scene.ignoreDataUpdate = false;\n      scene.setNonTargetPointerEvents(event.target, false);\n\n      // re-add the selected element to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        scene.moveable.elementGuidelines.push(event.target);\n      }\n    })\n    .on('resizeStart', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        // Remove the selected element from the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n\n        targetedElement.tempConstraint = { ...targetedElement.options.constraint };\n        targetedElement.options.constraint = {\n          vertical: VerticalConstraint.Top,\n          horizontal: HorizontalConstraint.Left,\n        };\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n      }\n    })\n    .on('resizeGroupStart', (e) => {\n      // Remove the selected elements from the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          const targetIndex = scene.moveable.elementGuidelines.indexOf(event.target);\n          if (targetIndex > -1) {\n            scene.moveable.elementGuidelines.splice(targetIndex, 1);\n          }\n        }\n      }\n    })\n    .on('resize', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n      if (targetedElement) {\n        targetedElement.applyResize(event, scene.scale);\n\n        if (scene.connections.connectionsNeedUpdate(targetedElement) && scene.moveableActionCallback) {\n          scene.moveableActionCallback(true);\n        }\n      }\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeGroup', (e) => {\n      let needsUpdate = false;\n      for (let event of e.events) {\n        const targetedElement = findElementByTarget(event.target, scene.root.elements);\n        if (targetedElement) {\n          targetedElement.applyResize(event);\n\n          if (!needsUpdate) {\n            needsUpdate = scene.connections.connectionsNeedUpdate(targetedElement);\n          }\n        }\n      }\n\n      if (needsUpdate && scene.moveableActionCallback) {\n        scene.moveableActionCallback(true);\n      }\n\n      scene.moved.next(Date.now()); // TODO only on end\n    })\n    .on('resizeEnd', (event) => {\n      const targetedElement = findElementByTarget(event.target, scene.root.elements);\n\n      if (targetedElement) {\n        if (targetedElement.tempConstraint) {\n          targetedElement.options.constraint = targetedElement.tempConstraint;\n          targetedElement.tempConstraint = undefined;\n        }\n\n        targetedElement.setPlacementFromConstraint(undefined, undefined, scene.scale);\n\n        // re-add the selected element to the snappable guidelines\n        if (scene.moveable && scene.moveable.elementGuidelines) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    })\n    .on('resizeGroupEnd', (e) => {\n      // re-add the selected elements to the snappable guidelines\n      if (scene.moveable && scene.moveable.elementGuidelines) {\n        for (let event of e.events) {\n          scene.moveable.elementGuidelines.push(event.target);\n        }\n      }\n    });\n\n  let targets: Array<HTMLElement | SVGElement> = [];\n  scene\n    .selecto!.on('dragStart', (event) => {\n      const selectedTarget = event.inputEvent.target;\n\n      // If selected target is a connection control, eject to handle connection event\n      if (selectedTarget.id === CONNECTION_ANCHOR_DIV_ID) {\n        scene.connections.handleConnectionDragStart(selectedTarget, event.inputEvent.clientX, event.inputEvent.clientY);\n        event.stop();\n        return;\n      }\n\n      // If selected target is a vertex, eject to handle vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ID) {\n        scene.connections.handleVertexDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      // If selected target is an add vertex point, eject to handle add vertex event\n      if (selectedTarget.id === CONNECTION_VERTEX_ADD_ID) {\n        scene.connections.handleVertexAddDragStart(selectedTarget);\n        event.stop();\n        return;\n      }\n\n      const isTargetMoveableElement =\n        scene.moveable!.isMoveableElement(selectedTarget) ||\n        targets.some((target) => target === selectedTarget || target.contains(selectedTarget));\n\n      const isElementSelected = isTargetAlreadySelected(selectedTarget, scene);\n\n      // Apply grabbing cursor while dragging, applyLayoutStylesToDiv() resets it to grab when done\n      if (\n        scene.isEditingEnabled &&\n        !scene.editModeEnabled.getValue() &&\n        isTargetMoveableElement &&\n        scene.selecto?.getSelectedTargets().length\n      ) {\n        scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n      }\n\n      if (isTargetMoveableElement || isElementSelected || !scene.isEditingEnabled) {\n        // Prevent drawing selection box when selected target is a moveable element or already selected\n        event.stop();\n      }\n    })\n    .on('select', () => {\n      scene.editModeEnabled.next(false);\n\n      // Hide connection anchors on select\n      if (scene.connections.connectionAnchorDiv) {\n        scene.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    })\n    .on('selectEnd', (event) => {\n      targets = event.selected;\n      scene.updateSelection({ targets });\n\n      if (event.isDragStart) {\n        if (scene.isEditingEnabled && !scene.editModeEnabled.getValue() && scene.selecto?.getSelectedTargets().length) {\n          scene.selecto.getSelectedTargets()[0].style.cursor = 'grabbing';\n        }\n        event.inputEvent.preventDefault();\n        event.data.timer = setTimeout(() => {\n          scene.moveable!.dragStart(event.inputEvent);\n        });\n      }\n    })\n    .on('dragEnd', (event) => {\n      clearTimeout(event.data.timer);\n    });\n};\n","import { cloneDeep } from 'lodash';\n\nimport { notFoundItem } from 'app/features/canvas/elements/notFound';\nimport { DimensionContext } from 'app/features/dimensions';\nimport { HorizontalConstraint, Placement, VerticalConstraint } from 'app/plugins/panel/canvas/panelcfg.gen';\nimport { LayerActionID } from 'app/plugins/panel/canvas/types';\n\nimport { updateConnectionsForSource } from '../../../plugins/panel/canvas/utils';\nimport { CanvasElementItem } from '../element';\nimport { CanvasFrameOptions } from '../frame';\nimport { canvasElementRegistry } from '../registry';\n\nimport { ElementState } from './element';\nimport { RootElement } from './root';\nimport { Scene } from './scene';\nimport { initMoveable } from './sceneAbleManagement';\n\nconst DEFAULT_OFFSET = 10;\nconst HORIZONTAL_OFFSET = 50;\n\nexport const frameItemDummy: CanvasElementItem = {\n  id: 'frame',\n  name: 'Frame',\n  description: 'Frame',\n\n  getNewOptions: () => ({\n    config: {},\n  }),\n\n  display: () => {\n    return <div>FRAME!</div>;\n  },\n};\n\nexport class FrameState extends ElementState {\n  elements: ElementState[] = [];\n  scene: Scene;\n\n  constructor(\n    public options: CanvasFrameOptions,\n    scene: Scene,\n    public parent?: FrameState\n  ) {\n    super(frameItemDummy, options, parent);\n\n    this.scene = scene;\n\n    // mutate options object\n    let { elements } = this.options;\n    if (!elements) {\n      this.options.elements = elements = [];\n    }\n\n    for (const element of elements) {\n      if (element.type === 'frame') {\n        // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n        this.elements.push(new FrameState(element as CanvasFrameOptions, scene, this));\n      } else {\n        const item = canvasElementRegistry.getIfExists(element.type) ?? notFoundItem;\n        this.elements.push(new ElementState(item, element, this));\n      }\n    }\n  }\n\n  isRoot(): this is RootElement {\n    return false;\n  }\n\n  updateData(ctx: DimensionContext) {\n    super.updateData(ctx);\n    for (const elem of this.elements) {\n      elem.updateData(ctx);\n    }\n  }\n\n  // used in the layer editor\n  reorder(startIndex: number, endIndex: number) {\n    const result = Array.from(this.elements);\n    const [removed] = result.splice(startIndex, 1);\n    result.splice(endIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  // used for tree view\n  reorderTree(src: ElementState, dest: ElementState, firstPosition = false) {\n    const result = Array.from(this.elements);\n    const srcIndex = this.elements.indexOf(src);\n    const destIndex = firstPosition ? this.elements.length - 1 : this.elements.indexOf(dest);\n\n    const [removed] = result.splice(srcIndex, 1);\n    result.splice(destIndex, 0, removed);\n    this.elements = result;\n\n    this.reinitializeMoveable();\n  }\n\n  doMove(child: ElementState, action: LayerActionID) {\n    const vals = this.elements.filter((v) => v !== child);\n    if (action === LayerActionID.MoveBottom) {\n      vals.unshift(child);\n    } else {\n      vals.push(child);\n    }\n    this.elements = vals;\n    this.scene.save();\n    this.reinitializeMoveable();\n  }\n\n  reinitializeMoveable() {\n    // Need to first clear current selection and then re-init moveable with slight delay\n    this.scene.clearCurrentSelection();\n    setTimeout(() => initMoveable(true, this.scene.isEditingEnabled, this.scene));\n  }\n\n  // ??? or should this be on the element directly?\n  // are actions scoped to layers?\n  doAction = (action: LayerActionID, element: ElementState, updateName = true, shiftItemsOnDuplicate = true) => {\n    switch (action) {\n      case LayerActionID.Delete:\n        this.elements = this.elements.filter((e) => e !== element);\n        updateConnectionsForSource(element, this.scene);\n        this.scene.byName.delete(element.options.name);\n        this.scene.save();\n        this.reinitializeMoveable();\n        break;\n      case LayerActionID.Duplicate:\n        if (element.item.id === 'frame') {\n          console.log('Can not duplicate frames (yet)', action, element);\n          return;\n        }\n        const opts = cloneDeep(element.options);\n\n        if (shiftItemsOnDuplicate) {\n          const { constraint, placement: oldPlacement } = element.options;\n          const { vertical, horizontal } = constraint ?? {};\n          const placement: Placement = { ...oldPlacement } ?? {};\n\n          switch (vertical) {\n            case VerticalConstraint.Top:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Bottom:\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.TopBottom:\n              if (placement.top == null) {\n                placement.top = 25;\n              } else {\n                placement.top += DEFAULT_OFFSET;\n              }\n\n              if (placement.bottom == null) {\n                placement.bottom = 100;\n              } else {\n                placement.bottom -= DEFAULT_OFFSET;\n              }\n              break;\n            case VerticalConstraint.Center:\n              if (placement.top != null) {\n                placement.top -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          switch (horizontal) {\n            case HorizontalConstraint.Left:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Right:\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.LeftRight:\n              if (placement.left == null) {\n                placement.left = HORIZONTAL_OFFSET;\n              } else {\n                placement.left += DEFAULT_OFFSET;\n              }\n\n              if (placement.right == null) {\n                placement.right = HORIZONTAL_OFFSET;\n              } else {\n                placement.right -= DEFAULT_OFFSET;\n              }\n              break;\n            case HorizontalConstraint.Center:\n              if (placement.left != null) {\n                placement.left -= DEFAULT_OFFSET;\n              }\n              break;\n          }\n\n          opts.placement = placement;\n        }\n\n        // Clear connections on duplicate\n        opts.connections = undefined;\n\n        const copy = new ElementState(element.item, opts, this);\n        copy.updateData(this.scene.context);\n        if (updateName) {\n          copy.options.name = this.scene.getNextElementName();\n        }\n        this.elements.push(copy);\n        this.scene.byName.set(copy.options.name, copy);\n\n        // Update scene byName map for original element (to avoid stale references (e.g. for connections))\n        this.scene.byName.set(element.options.name, element);\n\n        this.scene.save();\n        this.reinitializeMoveable();\n\n        setTimeout(() => {\n          this.scene.targetsToSelect.add(copy.div!);\n        });\n        break;\n      case LayerActionID.MoveTop:\n      case LayerActionID.MoveBottom:\n        element.parent?.doMove(element, action);\n        break;\n\n      default:\n        console.log('DO action', action, element);\n        return;\n    }\n  };\n\n  render() {\n    return (\n      <div key={this.UID} ref={this.initElement}>\n        {this.elements.map((v) => v.render())}\n      </div>\n    );\n  }\n\n  /** Recursively visit all nodes */\n  visit(visitor: (v: ElementState) => void) {\n    super.visit(visitor);\n    for (const e of this.elements) {\n      visitor(e);\n    }\n  }\n\n  getSaveModel() {\n    return {\n      ...this.options,\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n}\n","import { css } from '@emotion/css';\nimport { useCallback, useEffect, useState } from 'react';\nimport * as React from 'react';\nimport { first } from 'rxjs/operators';\n\nimport { SelectableValue } from '@grafana/data';\nimport { ContextMenu, MenuItem, MenuItemProps } from '@grafana/ui';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { findElementByTarget } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { CanvasPanel } from '../CanvasPanel';\nimport { AnchorPoint, LayerActionID } from '../types';\nimport { getElementTypes, onAddItem } from '../utils';\n\ntype Props = {\n  scene: Scene;\n  panel: CanvasPanel;\n  onVisibilityChange: (v: boolean) => void;\n};\n\nexport const CanvasContextMenu = ({ scene, panel, onVisibilityChange }: Props) => {\n  const inlineEditorOpen = panel.state.openInlineEdit;\n  const [isMenuVisible, setIsMenuVisible] = useState<boolean>(false);\n  const [anchorPoint, setAnchorPoint] = useState<AnchorPoint>({ x: 0, y: 0 });\n\n  const styles = getStyles();\n\n  const selectedElements = scene.selecto?.getSelectedTargets();\n  const rootLayer: FrameState | undefined = panel.context?.instanceState?.layer;\n\n  const handleContextMenu = useCallback(\n    (event: Event) => {\n      if (!(event instanceof MouseEvent) || event.ctrlKey) {\n        return;\n      }\n\n      event.preventDefault();\n      panel.setActivePanel();\n\n      const shouldSelectElement = event.currentTarget !== scene.div;\n      if (\n        shouldSelectElement &&\n        (event.currentTarget instanceof HTMLElement || event.currentTarget instanceof SVGElement)\n      ) {\n        scene.select({ targets: [event.currentTarget] });\n      }\n      setAnchorPoint({ x: event.pageX, y: event.pageY });\n      setIsMenuVisible(true);\n      onVisibilityChange(true);\n    },\n    [scene, panel, onVisibilityChange]\n  );\n\n  useEffect(() => {\n    if (scene.selecto) {\n      scene.selecto.getSelectableElements().forEach((element) => {\n        element.addEventListener('contextmenu', handleContextMenu);\n      });\n    }\n  }, [handleContextMenu, scene.selecto]);\n\n  useEffect(() => {\n    if (scene.div) {\n      scene.div.addEventListener('contextmenu', handleContextMenu);\n    }\n  }, [handleContextMenu, scene.div]);\n\n  const closeContextMenu = () => {\n    setIsMenuVisible(false);\n    onVisibilityChange(false);\n  };\n\n  const renderMenuItems = () => {\n    // This is disabled when panel is in edit mode because opening inline editor over panel editor is not ideal UX\n    const openCloseEditorMenuItem = !scene.isPanelEditing && (\n      <MenuItem\n        label={inlineEditorOpen ? 'Close Editor' : 'Open Editor'}\n        onClick={() => {\n          if (scene.inlineEditingCallback) {\n            if (inlineEditorOpen) {\n              panel.closeInlineEdit();\n            } else {\n              scene.inlineEditingCallback();\n            }\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    const editElementMenuItem = () => {\n      if (selectedElements?.length === 1) {\n        const onClickEditElementMenuItem = () => {\n          scene.editModeEnabled.next(true);\n          closeContextMenu();\n        };\n\n        const element = findElementByTarget(selectedElements[0], scene.root.elements);\n        return (\n          element &&\n          element.item.hasEditMode && (\n            <MenuItem label=\"Edit\" onClick={onClickEditElementMenuItem} className={styles.menuItem} />\n          )\n        );\n      }\n      return null;\n    };\n\n    const typeOptions = getElementTypes(scene.shouldShowAdvancedTypes).options;\n\n    const getTypeOptionsSubmenu = () => {\n      const submenuItems: Array<\n        React.ReactElement<MenuItemProps<unknown>, string | React.JSXElementConstructor<unknown>>\n      > = [];\n\n      const onClickItem = (option: SelectableValue<string>) => {\n        let offsetY = anchorPoint.y;\n        let offsetX = anchorPoint.x;\n        if (scene.div) {\n          const transformScale = scene.scale;\n          const sceneContainerDimensions = scene.div.getBoundingClientRect();\n          offsetY = (offsetY - sceneContainerDimensions.top) / transformScale;\n          offsetX = (offsetX - sceneContainerDimensions.left) / transformScale;\n        }\n\n        onAddItem(option, rootLayer, {\n          ...anchorPoint,\n          y: offsetY,\n          x: offsetX,\n        });\n      };\n\n      typeOptions.map((option) => {\n        submenuItems.push(\n          <MenuItem key={option.value} label={option.label ?? 'Canvas item'} onClick={() => onClickItem(option)} />\n        );\n      });\n\n      return submenuItems;\n    };\n\n    const addItemMenuItem = (\n      <MenuItem\n        label=\"Add item\"\n        className={styles.menuItem}\n        childItems={getTypeOptionsSubmenu()}\n        customSubMenuContainerStyles={{ maxHeight: '150px', overflowY: 'auto' }}\n      />\n    );\n\n    const setBackgroundMenuItem = (\n      <MenuItem\n        label={'Set background'}\n        onClick={() => {\n          if (scene.setBackgroundCallback) {\n            scene.setBackgroundCallback(anchorPoint);\n          }\n          closeContextMenu();\n        }}\n        className={styles.menuItem}\n      />\n    );\n\n    if (selectedElements && selectedElements.length >= 1) {\n      return (\n        <>\n          {editElementMenuItem()}\n          <MenuItem\n            label=\"Delete\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.Delete);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Duplicate\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.Duplicate);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Bring to front\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveTop);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          <MenuItem\n            label=\"Send to back\"\n            onClick={() => {\n              contextMenuAction(LayerActionID.MoveBottom);\n              closeContextMenu();\n            }}\n            className={styles.menuItem}\n          />\n          {openCloseEditorMenuItem}\n        </>\n      );\n    } else {\n      return (\n        <>\n          {openCloseEditorMenuItem}\n          {setBackgroundMenuItem}\n          {addItemMenuItem}\n        </>\n      );\n    }\n  };\n\n  const contextMenuAction = (actionType: LayerActionID) => {\n    scene.selection.pipe(first()).subscribe((currentSelectedElements) => {\n      const currentLayer = currentSelectedElements[0].parent!;\n      currentSelectedElements.forEach((currentSelectedElement: ElementState) => {\n        currentLayer.doAction(actionType, currentSelectedElement);\n      });\n    });\n\n    setTimeout(() => {\n      scene.addToSelection();\n      scene.targetsToSelect.clear();\n    });\n  };\n\n  if (isMenuVisible) {\n    return (\n      <div\n        onContextMenu={(event) => {\n          event.preventDefault();\n          closeContextMenu();\n        }}\n      >\n        <ContextMenu\n          x={anchorPoint.x}\n          y={anchorPoint.y}\n          onClose={closeContextMenu}\n          renderMenuItems={renderMenuItems}\n          focusOnOpen={false}\n        />\n      </div>\n    );\n  }\n\n  return <></>;\n};\n\nconst getStyles = () => ({\n  menuItem: css({\n    maxWidth: '200px',\n  }),\n});\n","import { css, cx } from '@emotion/css';\nimport { useDialog } from '@react-aria/dialog';\nimport { useOverlay } from '@react-aria/overlays';\nimport { createRef } from 'react';\n\nimport {\n  Field,\n  LinkModel,\n  FieldType,\n  GrafanaTheme2,\n  formattedValueToString,\n  getFieldDisplayName,\n  ScopedVars,\n  ValueLinkConfig,\n} from '@grafana/data/src';\nimport { ActionModel } from '@grafana/data/src/types/action';\nimport { Portal, useStyles2, VizTooltipContainer } from '@grafana/ui';\nimport { VizTooltipContent } from '@grafana/ui/src/components/VizTooltip/VizTooltipContent';\nimport { VizTooltipFooter } from '@grafana/ui/src/components/VizTooltip/VizTooltipFooter';\nimport { VizTooltipHeader } from '@grafana/ui/src/components/VizTooltip/VizTooltipHeader';\nimport { VizTooltipItem } from '@grafana/ui/src/components/VizTooltip/types';\nimport { CloseButton } from '@grafana/ui/src/components/uPlot/plugins/CloseButton';\nimport { getActions, getActionsDefaultField } from 'app/features/actions/utils';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { getDataLinks } from '../../status-history/utils';\nimport { getElementFields, getRowIndex } from '../utils';\n\ninterface Props {\n  scene: Scene;\n}\n\nexport const CanvasTooltip = ({ scene }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const onClose = () => {\n    if (scene?.tooltipCallback && scene.tooltip) {\n      scene.tooltipCallback(undefined);\n    }\n  };\n\n  const ref = createRef<HTMLElement>();\n  const { overlayProps } = useOverlay({ onClose: onClose, isDismissable: true }, ref);\n  const { dialogProps } = useDialog({}, ref);\n\n  const element = scene.tooltip?.element;\n  if (!element) {\n    return <></>;\n  }\n\n  // Retrieve timestamp of the last data point if available\n  const timeField = scene.data?.series[0].fields?.find((field) => field.type === FieldType.time);\n  const lastTimeValue = timeField?.values[timeField.values.length - 1];\n  const shouldDisplayTimeContentItem =\n    timeField && lastTimeValue && element.data.field && getFieldDisplayName(timeField) !== element.data.field;\n\n  const headerItem: VizTooltipItem | null = {\n    label: element.getName(),\n    value: '',\n  };\n\n  const contentItems: VizTooltipItem[] = [\n    {\n      label: element.data.field ?? 'Fixed',\n      value: element.data.text,\n    },\n    ...(shouldDisplayTimeContentItem\n      ? [\n          {\n            label: 'Time',\n            value: formattedValueToString(timeField?.display!(lastTimeValue)),\n          },\n        ]\n      : []),\n  ];\n\n  // NOTE: almost identical to getDataLinks() helper\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((element.options.links?.length ?? 0) > 0 && element.getLinks) {\n    const linkLookup = new Set<string>();\n\n    element.getLinks({ valueRowIndex: getRowIndex(element.data.field, scene) }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n  // ---------\n\n  if (scene.data?.series) {\n    getElementFields(scene.data?.series, element.options).forEach((field) => {\n      links.push(...getDataLinks(field, getRowIndex(element.data.field, scene)));\n    });\n  }\n\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const elementHasActions = (element.options.actions?.length ?? 0) > 0;\n  const frames = scene.data?.series;\n\n  if (elementHasActions && frames) {\n    const defaultField = getActionsDefaultField(element.options.links ?? [], element.options.actions ?? []);\n    const scopedVars: ScopedVars = {\n      __dataContext: {\n        value: {\n          data: frames,\n          field: defaultField,\n          frame: frames[0],\n          frameIndex: 0,\n        },\n      },\n    };\n\n    const config: ValueLinkConfig = { valueRowIndex: getRowIndex(element.data.field, scene) };\n\n    const actionsModel = getActions(\n      frames[0],\n      defaultField,\n      scopedVars,\n      scene.panel.props.replaceVariables!,\n      element.options.actions ?? [],\n      config\n    );\n\n    actionsModel.forEach((action) => {\n      const key = `${action.title}/${Math.random()}`;\n      if (!actionLookup.has(key)) {\n        actions.push(action);\n        actionLookup.add(key);\n      }\n    });\n  }\n\n  return (\n    <>\n      {scene.tooltip?.element && scene.tooltip.anchorPoint && (\n        <Portal>\n          <VizTooltipContainer\n            className={cx(styles.tooltipWrapper, scene.tooltip.isOpen && styles.pinned)}\n            position={{ x: scene.tooltip.anchorPoint.x, y: scene.tooltip.anchorPoint.y }}\n            offset={{ x: 5, y: 0 }}\n            allowPointerEvents={scene.tooltip.isOpen}\n          >\n            <section ref={ref} {...overlayProps} {...dialogProps}>\n              {scene.tooltip.isOpen && <CloseButton style={{ zIndex: 1 }} onClick={onClose} />}\n              <VizTooltipHeader item={headerItem} isPinned={scene.tooltip.isOpen!} />\n              {element.data.text && <VizTooltipContent items={contentItems} isPinned={scene.tooltip.isOpen!} />}\n              {(links.length > 0 || actions.length > 0) && <VizTooltipFooter dataLinks={links} actions={actions} />}\n            </section>\n          </VizTooltipContainer>\n        </Portal>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  wrapper: css({\n    marginTop: '20px',\n    background: theme.colors.background.primary,\n  }),\n  tooltipWrapper: css({\n    top: 0,\n    left: 0,\n    zIndex: theme.zIndex.portal,\n    whiteSpace: 'pre',\n    borderRadius: theme.shape.radius.default,\n    position: 'fixed',\n    background: theme.colors.background.primary,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z2,\n    userSelect: 'text',\n    padding: 0,\n    fontSize: theme.typography.bodySmall.fontSize,\n  }),\n  pinned: css({\n    boxShadow: theme.shadows.z3,\n  }),\n});\n","import React, { useRef, useImperativeHandle, useEffect, useContext, useLayoutEffect, useState, useCallback, useMemo } from 'react';\n\n/**\n * Rounds number to given decimal\n * eg. roundNumber(2.34343, 1) => 2.3\n */\nvar roundNumber = function (num, decimal) {\n    return Number(num.toFixed(decimal));\n};\n/**\n * Checks if value is number, if not it returns default value\n * 1# eg. checkIsNumber(2, 30) => 2\n * 2# eg. checkIsNumber(null, 30) => 30\n */\nvar checkIsNumber = function (num, defaultValue) {\n    return typeof num === \"number\" ? num : defaultValue;\n};\n\nvar handleCallback = function (context, event, callback) {\n    if (callback && typeof callback === \"function\") {\n        callback(context, event);\n    }\n};\n\n/* eslint-disable no-plusplus */\n/* eslint-disable no-param-reassign */\n/**\n * Functions should return denominator of the target value, which is the next animation step.\n * t is a value from 0 to 1, reflecting the percentage of animation status.\n */\nvar easeOut = function (t) {\n    return -Math.cos(t * Math.PI) / 2 + 0.5;\n};\n// linear\nvar linear = function (t) {\n    return t;\n};\n// accelerating from zero velocity\nvar easeInQuad = function (t) {\n    return t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuad = function (t) {\n    return t * (2 - t);\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuad = function (t) {\n    return t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n};\n// accelerating from zero velocity\nvar easeInCubic = function (t) {\n    return t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutCubic = function (t) {\n    return --t * t * t + 1;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutCubic = function (t) {\n    return t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;\n};\n// accelerating from zero velocity\nvar easeInQuart = function (t) {\n    return t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuart = function (t) {\n    return 1 - --t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuart = function (t) {\n    return t < 0.5 ? 8 * t * t * t * t : 1 - 8 * --t * t * t * t;\n};\n// accelerating from zero velocity\nvar easeInQuint = function (t) {\n    return t * t * t * t * t;\n};\n// decelerating to zero velocity\nvar easeOutQuint = function (t) {\n    return 1 + --t * t * t * t * t;\n};\n// acceleration until halfway, then deceleration\nvar easeInOutQuint = function (t) {\n    return t < 0.5 ? 16 * t * t * t * t * t : 1 + 16 * --t * t * t * t * t;\n};\nvar animations = {\n    easeOut: easeOut,\n    linear: linear,\n    easeInQuad: easeInQuad,\n    easeOutQuad: easeOutQuad,\n    easeInOutQuad: easeInOutQuad,\n    easeInCubic: easeInCubic,\n    easeOutCubic: easeOutCubic,\n    easeInOutCubic: easeInOutCubic,\n    easeInQuart: easeInQuart,\n    easeOutQuart: easeOutQuart,\n    easeInOutQuart: easeInOutQuart,\n    easeInQuint: easeInQuint,\n    easeOutQuint: easeOutQuint,\n    easeInOutQuint: easeInOutQuint,\n};\n\n/* eslint-disable no-param-reassign */\nvar handleCancelAnimationFrame = function (animation) {\n    if (typeof animation === \"number\") {\n        cancelAnimationFrame(animation);\n    }\n};\nvar handleCancelAnimation = function (contextInstance) {\n    if (!contextInstance.mounted)\n        return;\n    handleCancelAnimationFrame(contextInstance.animation);\n    // Clear animation state\n    contextInstance.animate = false;\n    contextInstance.animation = null;\n    contextInstance.velocity = null;\n};\nfunction handleSetupAnimation(contextInstance, animationName, animationTime, callback) {\n    if (!contextInstance.mounted)\n        return;\n    var startTime = new Date().getTime();\n    var lastStep = 1;\n    // if another animation is active\n    handleCancelAnimation(contextInstance);\n    // new animation\n    contextInstance.animation = function () {\n        if (!contextInstance.mounted) {\n            return handleCancelAnimationFrame(contextInstance.animation);\n        }\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / animationTime;\n        var animationType = animations[animationName];\n        var step = animationType(animationProgress);\n        if (frameTime >= animationTime) {\n            callback(lastStep);\n            contextInstance.animation = null;\n        }\n        else if (contextInstance.animation) {\n            callback(step);\n            requestAnimationFrame(contextInstance.animation);\n        }\n    };\n    requestAnimationFrame(contextInstance.animation);\n}\nfunction isValidTargetState(targetState) {\n    var scale = targetState.scale, positionX = targetState.positionX, positionY = targetState.positionY;\n    if (Number.isNaN(scale) ||\n        Number.isNaN(positionX) ||\n        Number.isNaN(positionY)) {\n        return false;\n    }\n    return true;\n}\nfunction animate(contextInstance, targetState, animationTime, animationName) {\n    var isValid = isValidTargetState(targetState);\n    if (!contextInstance.mounted || !isValid)\n        return;\n    var setTransformState = contextInstance.setTransformState;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDiff = targetState.scale - scale;\n    var positionXDiff = targetState.positionX - positionX;\n    var positionYDiff = targetState.positionY - positionY;\n    if (animationTime === 0) {\n        setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n    }\n    else {\n        // animation start timestamp\n        handleSetupAnimation(contextInstance, animationName, animationTime, function (step) {\n            var newScale = scale + scaleDiff * step;\n            var newPositionX = positionX + positionXDiff * step;\n            var newPositionY = positionY + positionYDiff * step;\n            setTransformState(newScale, newPositionX, newPositionY);\n        });\n    }\n}\n\n/* eslint-disable no-param-reassign */\nfunction getComponentsSizes(wrapperComponent, contentComponent, newScale) {\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var contentWidth = contentComponent.offsetWidth;\n    var contentHeight = contentComponent.offsetHeight;\n    var newContentWidth = contentWidth * newScale;\n    var newContentHeight = contentHeight * newScale;\n    var newDiffWidth = wrapperWidth - newContentWidth;\n    var newDiffHeight = wrapperHeight - newContentHeight;\n    return {\n        wrapperWidth: wrapperWidth,\n        wrapperHeight: wrapperHeight,\n        newContentWidth: newContentWidth,\n        newDiffWidth: newDiffWidth,\n        newContentHeight: newContentHeight,\n        newDiffHeight: newDiffHeight,\n    };\n}\nvar getBounds = function (wrapperWidth, newContentWidth, diffWidth, wrapperHeight, newContentHeight, diffHeight, centerZoomedOut) {\n    var scaleWidthFactor = wrapperWidth > newContentWidth\n        ? diffWidth * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var scaleHeightFactor = wrapperHeight > newContentHeight\n        ? diffHeight * (centerZoomedOut ? 1 : 0.5)\n        : 0;\n    var minPositionX = wrapperWidth - newContentWidth - scaleWidthFactor;\n    var maxPositionX = scaleWidthFactor;\n    var minPositionY = wrapperHeight - newContentHeight - scaleHeightFactor;\n    var maxPositionY = scaleHeightFactor;\n    return { minPositionX: minPositionX, maxPositionX: maxPositionX, minPositionY: minPositionY, maxPositionY: maxPositionY };\n};\nvar calculateBounds = function (contextInstance, newScale) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n    var centerZoomedOut = contextInstance.setup.centerZoomedOut;\n    if (!wrapperComponent || !contentComponent) {\n        throw new Error(\"Components are not mounted\");\n    }\n    var _a = getComponentsSizes(wrapperComponent, contentComponent, newScale), wrapperWidth = _a.wrapperWidth, wrapperHeight = _a.wrapperHeight, newContentWidth = _a.newContentWidth, newDiffWidth = _a.newDiffWidth, newContentHeight = _a.newContentHeight, newDiffHeight = _a.newDiffHeight;\n    var bounds = getBounds(wrapperWidth, newContentWidth, newDiffWidth, wrapperHeight, newContentHeight, newDiffHeight, Boolean(centerZoomedOut));\n    return bounds;\n};\n/**\n * Keeps value between given bounds, used for limiting view to given boundaries\n * 1# eg. boundLimiter(2, 0, 3, true) => 2\n * 2# eg. boundLimiter(4, 0, 3, true) => 3\n * 3# eg. boundLimiter(-2, 0, 3, true) => 0\n * 4# eg. boundLimiter(10, 0, 3, false) => 10\n */\nvar boundLimiter = function (value, minBound, maxBound, isActive) {\n    if (!isActive)\n        return roundNumber(value, 2);\n    if (value < minBound)\n        return roundNumber(minBound, 2);\n    if (value > maxBound)\n        return roundNumber(maxBound, 2);\n    return roundNumber(value, 2);\n};\nvar handleCalculateBounds = function (contextInstance, newScale) {\n    var bounds = calculateBounds(contextInstance, newScale);\n    // Save bounds\n    contextInstance.bounds = bounds;\n    return bounds;\n};\nfunction getMouseBoundedPosition(positionX, positionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent) {\n    var minPositionX = bounds.minPositionX, minPositionY = bounds.minPositionY, maxPositionX = bounds.maxPositionX, maxPositionY = bounds.maxPositionY;\n    var paddingX = 0;\n    var paddingY = 0;\n    if (wrapperComponent) {\n        paddingX = paddingValueX;\n        paddingY = paddingValueY;\n    }\n    var x = boundLimiter(positionX, minPositionX - paddingX, maxPositionX + paddingX, limitToBounds);\n    var y = boundLimiter(positionY, minPositionY - paddingY, maxPositionY + paddingY, limitToBounds);\n    return { x: x, y: y };\n}\n\nfunction handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds) {\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    var scaleDifference = newScale - scale;\n    if (typeof mouseX !== \"number\" || typeof mouseY !== \"number\") {\n        console.error(\"Mouse X and Y position were not provided!\");\n        return { x: positionX, y: positionY };\n    }\n    var calculatedPositionX = positionX - mouseX * scaleDifference;\n    var calculatedPositionY = positionY - mouseY * scaleDifference;\n    // do not limit to bounds when there is padding animation,\n    // it causes animation strange behaviour\n    var newPositions = getMouseBoundedPosition(calculatedPositionX, calculatedPositionY, bounds, limitToBounds, 0, 0, null);\n    return newPositions;\n}\nfunction checkZoomBounds(zoom, minScale, maxScale, zoomPadding, enablePadding) {\n    var scalePadding = enablePadding ? zoomPadding : 0;\n    var minScaleWithPadding = minScale - scalePadding;\n    if (!Number.isNaN(maxScale) && zoom >= maxScale)\n        return maxScale;\n    if (!Number.isNaN(minScale) && zoom <= minScaleWithPadding)\n        return minScaleWithPadding;\n    return zoom;\n}\n\nvar isPanningStartAllowed = function (contextInstance, event) {\n    var excluded = contextInstance.setup.panning.excluded;\n    var isInitialized = contextInstance.isInitialized, wrapperComponent = contextInstance.wrapperComponent;\n    var target = event.target;\n    var targetIsShadowDom = \"shadowRoot\" in target && \"composedPath\" in event;\n    var isWrapperChild = targetIsShadowDom\n        ? event.composedPath().some(function (el) {\n            if (!(el instanceof Element)) {\n                return false;\n            }\n            return wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(el);\n        })\n        : wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPanningAllowed = function (contextInstance) {\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning, setup = contextInstance.setup;\n    var disabled = setup.panning.disabled;\n    var isAllowed = isInitialized && isPanning && !disabled;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar handlePanningSetup = function (contextInstance, event) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with mouse\n    var x = event.clientX;\n    var y = event.clientY;\n    contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n};\nvar handleTouchPanningSetup = function (contextInstance, event) {\n    var touches = event.touches;\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY;\n    contextInstance.isPanning = true;\n    // Panning with touch\n    var oneFingerTouch = touches.length === 1;\n    if (oneFingerTouch) {\n        var x = touches[0].clientX;\n        var y = touches[0].clientY;\n        contextInstance.startCoords = { x: x - positionX, y: y - positionY };\n    }\n};\nfunction handlePanToBounds(contextInstance) {\n    var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n    var _b = contextInstance.setup, disabled = _b.disabled, limitToBounds = _b.limitToBounds, centerZoomedOut = _b.centerZoomedOut;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    if (disabled || !wrapperComponent || !contextInstance.bounds)\n        return;\n    var _c = contextInstance.bounds, maxPositionX = _c.maxPositionX, minPositionX = _c.minPositionX, maxPositionY = _c.maxPositionY, minPositionY = _c.minPositionY;\n    var xChanged = positionX > maxPositionX || positionX < minPositionX;\n    var yChanged = positionY > maxPositionY || positionY < minPositionY;\n    var mousePosX = positionX > maxPositionX\n        ? wrapperComponent.offsetWidth\n        : contextInstance.setup.minPositionX || 0;\n    var mousePosY = positionY > maxPositionY\n        ? wrapperComponent.offsetHeight\n        : contextInstance.setup.minPositionY || 0;\n    var _d = handleCalculateZoomPositions(contextInstance, mousePosX, mousePosY, scale, contextInstance.bounds, limitToBounds || centerZoomedOut), x = _d.x, y = _d.y;\n    return {\n        scale: scale,\n        positionX: xChanged ? x : positionX,\n        positionY: yChanged ? y : positionY,\n    };\n}\nfunction handleNewPosition(contextInstance, newPositionX, newPositionY, paddingValueX, paddingValueY) {\n    var limitToBounds = contextInstance.setup.limitToBounds;\n    var wrapperComponent = contextInstance.wrapperComponent, bounds = contextInstance.bounds;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (wrapperComponent === null ||\n        bounds === null ||\n        (newPositionX === positionX && newPositionY === positionY)) {\n        return;\n    }\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), x = _b.x, y = _b.y;\n    contextInstance.setTransformState(scale, x, y);\n}\nvar getPanningClientPosition = function (contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, transformState = contextInstance.transformState;\n    var panning = contextInstance.setup.panning;\n    var lockAxisX = panning.lockAxisX, lockAxisY = panning.lockAxisY;\n    var positionX = transformState.positionX, positionY = transformState.positionY;\n    if (!startCoords) {\n        return { x: positionX, y: positionY };\n    }\n    var mouseX = clientX - startCoords.x;\n    var mouseY = clientY - startCoords.y;\n    var newPositionX = lockAxisX ? positionX : mouseX;\n    var newPositionY = lockAxisY ? positionY : mouseY;\n    return { x: newPositionX, y: newPositionY };\n};\nvar getPaddingValue = function (contextInstance, size) {\n    var setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var minScale = setup.minScale, disablePadding = setup.disablePadding;\n    if (size > 0 && scale >= minScale && !disablePadding) {\n        return size;\n    }\n    return 0;\n};\n\nvar isVelocityCalculationAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar isVelocityAllowed = function (contextInstance) {\n    var mounted = contextInstance.mounted, velocity = contextInstance.velocity, bounds = contextInstance.bounds;\n    var _a = contextInstance.setup, disabled = _a.disabled, velocityAnimation = _a.velocityAnimation;\n    var scale = contextInstance.transformState.scale;\n    var disabledVelocity = velocityAnimation.disabled;\n    var isAllowed = !disabledVelocity || scale > 1 || !disabled || mounted;\n    if (!isAllowed)\n        return false;\n    if (!velocity || !bounds)\n        return false;\n    return true;\n};\nfunction getVelocityMoveTime(contextInstance, velocity) {\n    var velocityAnimation = contextInstance.setup.velocityAnimation;\n    var equalToMove = velocityAnimation.equalToMove, animationTime = velocityAnimation.animationTime, sensitivity = velocityAnimation.sensitivity;\n    if (equalToMove) {\n        return animationTime * velocity * sensitivity;\n    }\n    return animationTime;\n}\nfunction getVelocityPosition(newPosition, startPosition, currentPosition, isLocked, limitToBounds, minPosition, maxPosition, minTarget, maxTarget, step) {\n    if (limitToBounds) {\n        if (startPosition > maxPosition && currentPosition > maxPosition) {\n            var calculatedPosition = maxPosition + (newPosition - maxPosition) * step;\n            if (calculatedPosition > maxTarget)\n                return maxTarget;\n            if (calculatedPosition < maxPosition)\n                return maxPosition;\n            return calculatedPosition;\n        }\n        if (startPosition < minPosition && currentPosition < minPosition) {\n            var calculatedPosition = minPosition + (newPosition - minPosition) * step;\n            if (calculatedPosition < minTarget)\n                return minTarget;\n            if (calculatedPosition > minPosition)\n                return minPosition;\n            return calculatedPosition;\n        }\n    }\n    if (isLocked)\n        return startPosition;\n    return boundLimiter(newPosition, minPosition, maxPosition, limitToBounds);\n}\n\nfunction getSizeMultiplier(wrapperComponent, equalToMove) {\n    var defaultMultiplier = 1;\n    if (equalToMove) {\n        return Math.min(defaultMultiplier, wrapperComponent.offsetWidth / window.innerWidth);\n    }\n    return defaultMultiplier;\n}\nfunction handleCalculateVelocity(contextInstance, position) {\n    var isAllowed = isVelocityCalculationAllowed(contextInstance);\n    if (!isAllowed) {\n        return;\n    }\n    var lastMousePosition = contextInstance.lastMousePosition, velocityTime = contextInstance.velocityTime, setup = contextInstance.setup;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var equalToMove = setup.velocityAnimation.equalToMove;\n    var now = Date.now();\n    if (lastMousePosition && velocityTime && wrapperComponent) {\n        var sizeMultiplier = getSizeMultiplier(wrapperComponent, equalToMove);\n        var distanceX = position.x - lastMousePosition.x;\n        var distanceY = position.y - lastMousePosition.y;\n        var velocityX = distanceX / sizeMultiplier;\n        var velocityY = distanceY / sizeMultiplier;\n        var interval = now - velocityTime;\n        var speed = distanceX * distanceX + distanceY * distanceY;\n        var velocity = Math.sqrt(speed) / interval;\n        contextInstance.velocity = { velocityX: velocityX, velocityY: velocityY, total: velocity };\n    }\n    contextInstance.lastMousePosition = position;\n    contextInstance.velocityTime = now;\n}\nfunction handleVelocityPanning(contextInstance) {\n    var velocity = contextInstance.velocity, bounds = contextInstance.bounds, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var isAllowed = isVelocityAllowed(contextInstance);\n    if (!isAllowed || !velocity || !bounds || !wrapperComponent) {\n        return;\n    }\n    var velocityX = velocity.velocityX, velocityY = velocity.velocityY, total = velocity.total;\n    var maxPositionX = bounds.maxPositionX, minPositionX = bounds.minPositionX, maxPositionY = bounds.maxPositionY, minPositionY = bounds.minPositionY;\n    var limitToBounds = setup.limitToBounds, alignmentAnimation = setup.alignmentAnimation;\n    var zoomAnimation = setup.zoomAnimation, panning = setup.panning;\n    var lockAxisY = panning.lockAxisY, lockAxisX = panning.lockAxisX;\n    var animationType = zoomAnimation.animationType;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, velocityAlignmentTime = alignmentAnimation.velocityAlignmentTime;\n    var alignAnimationTime = velocityAlignmentTime;\n    var moveAnimationTime = getVelocityMoveTime(contextInstance, total);\n    var finalAnimationTime = Math.max(moveAnimationTime, alignAnimationTime);\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var paddingX = (paddingValueX * wrapperComponent.offsetWidth) / 100;\n    var paddingY = (paddingValueY * wrapperComponent.offsetHeight) / 100;\n    var maxTargetX = maxPositionX + paddingX;\n    var minTargetX = minPositionX - paddingX;\n    var maxTargetY = maxPositionY + paddingY;\n    var minTargetY = minPositionY - paddingY;\n    var startState = contextInstance.transformState;\n    var startTime = new Date().getTime();\n    handleSetupAnimation(contextInstance, animationType, finalAnimationTime, function (step) {\n        var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n        var frameTime = new Date().getTime() - startTime;\n        var animationProgress = frameTime / alignAnimationTime;\n        var alignAnimation = animations[alignmentAnimation.animationType];\n        var alignStep = 1 - alignAnimation(Math.min(1, animationProgress));\n        var customStep = 1 - step;\n        var newPositionX = positionX + velocityX * customStep;\n        var newPositionY = positionY + velocityY * customStep;\n        var currentPositionX = getVelocityPosition(newPositionX, startState.positionX, positionX, lockAxisX, limitToBounds, minPositionX, maxPositionX, minTargetX, maxTargetX, alignStep);\n        var currentPositionY = getVelocityPosition(newPositionY, startState.positionY, positionY, lockAxisY, limitToBounds, minPositionY, maxPositionY, minTargetY, maxTargetY, alignStep);\n        if (positionX !== newPositionX || positionY !== newPositionY) {\n            contextInstance.setTransformState(scale, currentPositionX, currentPositionY);\n        }\n    });\n}\n\nfunction handlePanningStart(contextInstance, event) {\n    var scale = contextInstance.transformState.scale;\n    handleCancelAnimation(contextInstance);\n    handleCalculateBounds(contextInstance, scale);\n    if (window.TouchEvent !== undefined && event instanceof TouchEvent) {\n        handleTouchPanningSetup(contextInstance, event);\n    }\n    else {\n        handlePanningSetup(contextInstance, event);\n    }\n}\nfunction handleAlignToBounds(contextInstance) {\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, minScale = _a.minScale, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = alignmentAnimation.disabled, sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY, animationTime = alignmentAnimation.animationTime, animationType = alignmentAnimation.animationType;\n    var isDisabled = disabled || scale < minScale || (!sizeX && !sizeY);\n    if (isDisabled)\n        return;\n    var targetState = handlePanToBounds(contextInstance);\n    if (targetState) {\n        animate(contextInstance, targetState, animationTime, animationType);\n    }\n}\nfunction handlePanning(contextInstance, clientX, clientY) {\n    var startCoords = contextInstance.startCoords, setup = contextInstance.setup;\n    var _a = setup.alignmentAnimation, sizeX = _a.sizeX, sizeY = _a.sizeY;\n    if (!startCoords)\n        return;\n    var _b = getPanningClientPosition(contextInstance, clientX, clientY), x = _b.x, y = _b.y;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    handleCalculateVelocity(contextInstance, { x: x, y: y });\n    handleNewPosition(contextInstance, x, y, paddingValueX, paddingValueY);\n}\nfunction handlePanningEnd(contextInstance) {\n    if (contextInstance.isPanning) {\n        var velocityDisabled = contextInstance.setup.panning.velocityDisabled;\n        var velocity = contextInstance.velocity, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        contextInstance.isPanning = false;\n        contextInstance.animate = false;\n        contextInstance.animation = null;\n        var wrapperRect = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.getBoundingClientRect();\n        var contentRect = contentComponent === null || contentComponent === void 0 ? void 0 : contentComponent.getBoundingClientRect();\n        var wrapperWidth = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.width) || 0;\n        var wrapperHeight = (wrapperRect === null || wrapperRect === void 0 ? void 0 : wrapperRect.height) || 0;\n        var contentWidth = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.width) || 0;\n        var contentHeight = (contentRect === null || contentRect === void 0 ? void 0 : contentRect.height) || 0;\n        var isZoomed = wrapperWidth < contentWidth || wrapperHeight < contentHeight;\n        var shouldAnimate = !velocityDisabled && velocity && (velocity === null || velocity === void 0 ? void 0 : velocity.total) > 0.1 && isZoomed;\n        if (shouldAnimate) {\n            handleVelocityPanning(contextInstance);\n        }\n        else {\n            handleAlignToBounds(contextInstance);\n        }\n    }\n}\n\nfunction handleZoomToPoint(contextInstance, scale, mouseX, mouseY) {\n    var _a = contextInstance.setup, minScale = _a.minScale, maxScale = _a.maxScale, limitToBounds = _a.limitToBounds;\n    var newScale = checkZoomBounds(roundNumber(scale, 2), minScale, maxScale, 0, false);\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var _b = handleCalculateZoomPositions(contextInstance, mouseX, mouseY, newScale, bounds, limitToBounds), x = _b.x, y = _b.y;\n    return { scale: newScale, positionX: x, positionY: y };\n}\nfunction handleAlignToScaleBounds(contextInstance, mousePositionX, mousePositionY) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.setup, minScale = _a.minScale, limitToBounds = _a.limitToBounds, zoomAnimation = _a.zoomAnimation;\n    var disabled = zoomAnimation.disabled, animationTime = zoomAnimation.animationTime, animationType = zoomAnimation.animationType;\n    var isDisabled = disabled || scale >= minScale;\n    if (scale >= 1 || limitToBounds) {\n        // fire fit to bounds animation\n        handleAlignToBounds(contextInstance);\n    }\n    if (isDisabled || !wrapperComponent || !contextInstance.mounted)\n        return;\n    var mouseX = mousePositionX || wrapperComponent.offsetWidth / 2;\n    var mouseY = mousePositionY || wrapperComponent.offsetHeight / 2;\n    var targetState = handleZoomToPoint(contextInstance, minScale, mouseX, mouseY);\n    if (targetState) {\n        animate(contextInstance, targetState, animationTime, animationType);\n    }\n}\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\n\nvar initialState = {\n    previousScale: 1,\n    scale: 1,\n    positionX: 0,\n    positionY: 0,\n};\nvar initialSetup = {\n    disabled: false,\n    minPositionX: null,\n    maxPositionX: null,\n    minPositionY: null,\n    maxPositionY: null,\n    minScale: 1,\n    maxScale: 8,\n    limitToBounds: true,\n    centerZoomedOut: false,\n    centerOnInit: false,\n    disablePadding: false,\n    smooth: true,\n    wheel: {\n        step: 0.2,\n        disabled: false,\n        smoothStep: 0.001,\n        wheelDisabled: false,\n        touchPadDisabled: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    panning: {\n        disabled: false,\n        velocityDisabled: false,\n        lockAxisX: false,\n        lockAxisY: false,\n        allowLeftClickPan: true,\n        allowMiddleClickPan: true,\n        allowRightClickPan: true,\n        wheelPanning: false,\n        activationKeys: [],\n        excluded: [],\n    },\n    pinch: {\n        step: 5,\n        disabled: false,\n        excluded: [],\n    },\n    doubleClick: {\n        disabled: false,\n        step: 0.7,\n        mode: \"zoomIn\",\n        animationType: \"easeOut\",\n        animationTime: 200,\n        excluded: [],\n    },\n    zoomAnimation: {\n        disabled: false,\n        size: 0.4,\n        animationTime: 200,\n        animationType: \"easeOut\",\n    },\n    alignmentAnimation: {\n        disabled: false,\n        sizeX: 100,\n        sizeY: 100,\n        animationTime: 200,\n        velocityAlignmentTime: 400,\n        animationType: \"easeOut\",\n    },\n    velocityAnimation: {\n        disabled: false,\n        sensitivity: 1,\n        animationTime: 400,\n        animationType: \"easeOut\",\n        equalToMove: true,\n    },\n};\nvar baseClasses = {\n    wrapperClass: \"react-transform-wrapper\",\n    contentClass: \"react-transform-component\",\n};\n\nvar createState = function (props) {\n    var _a, _b, _c, _d;\n    return {\n        previousScale: (_a = props.initialScale) !== null && _a !== void 0 ? _a : initialState.scale,\n        scale: (_b = props.initialScale) !== null && _b !== void 0 ? _b : initialState.scale,\n        positionX: (_c = props.initialPositionX) !== null && _c !== void 0 ? _c : initialState.positionX,\n        positionY: (_d = props.initialPositionY) !== null && _d !== void 0 ? _d : initialState.positionY,\n    };\n};\nvar createSetup = function (props) {\n    var newSetup = __assign({}, initialSetup);\n    Object.keys(props).forEach(function (key) {\n        var validValue = typeof props[key] !== \"undefined\";\n        var validParameter = typeof initialSetup[key] !== \"undefined\";\n        if (validParameter && validValue) {\n            var dataType = Object.prototype.toString.call(initialSetup[key]);\n            var isObject = dataType === \"[object Object]\";\n            var isArray = dataType === \"[object Array]\";\n            if (isObject) {\n                newSetup[key] = __assign(__assign({}, initialSetup[key]), props[key]);\n            }\n            else if (isArray) {\n                newSetup[key] = __spreadArray(__spreadArray([], initialSetup[key], true), props[key], true);\n            }\n            else {\n                newSetup[key] = props[key];\n            }\n        }\n    });\n    return newSetup;\n};\n\nvar handleCalculateButtonZoom = function (contextInstance, delta, step) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, smooth = setup.smooth;\n    var size = zoomAnimation.size;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = smooth\n        ? scale * Math.exp(delta * step)\n        : scale + delta * step;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, false);\n    return newScale;\n};\nfunction handleZoomToViewCenter(contextInstance, delta, step, animationTime, animationType) {\n    var wrapperComponent = contextInstance.wrapperComponent;\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return console.error(\"No WrapperComponent found\");\n    var wrapperWidth = wrapperComponent.offsetWidth;\n    var wrapperHeight = wrapperComponent.offsetHeight;\n    var mouseX = (wrapperWidth / 2 - positionX) / scale;\n    var mouseY = (wrapperHeight / 2 - positionY) / scale;\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mouseX, mouseY);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    animate(contextInstance, targetState, animationTime, animationType);\n}\nfunction resetTransformations(contextInstance, animationTime, animationType, onResetTransformation) {\n    var setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var limitToBounds = setup.limitToBounds;\n    var initialTransformation = createState(contextInstance.props);\n    var _a = contextInstance.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n    if (!wrapperComponent)\n        return;\n    var newBounds = calculateBounds(contextInstance, initialTransformation.scale);\n    var boundedPositions = getMouseBoundedPosition(initialTransformation.positionX, initialTransformation.positionY, newBounds, limitToBounds, 0, 0, wrapperComponent);\n    var newState = {\n        scale: initialTransformation.scale,\n        positionX: boundedPositions.x,\n        positionY: boundedPositions.y,\n    };\n    if (scale === initialTransformation.scale &&\n        positionX === initialTransformation.positionX &&\n        positionY === initialTransformation.positionY) {\n        return;\n    }\n    onResetTransformation === null || onResetTransformation === void 0 ? void 0 : onResetTransformation();\n    animate(contextInstance, newState, animationTime, animationType);\n}\nfunction getOffset(element, wrapper, content, state) {\n    var offset = element.getBoundingClientRect();\n    var wrapperOffset = wrapper.getBoundingClientRect();\n    var contentOffset = content.getBoundingClientRect();\n    var xOff = wrapperOffset.x * state.scale;\n    var yOff = wrapperOffset.y * state.scale;\n    return {\n        x: (offset.x - contentOffset.x + xOff) / state.scale,\n        y: (offset.y - contentOffset.y + yOff) / state.scale,\n    };\n}\nfunction calculateZoomToNode(contextInstance, node, customZoom) {\n    var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent, transformState = contextInstance.transformState;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, minScale = _a.minScale, maxScale = _a.maxScale;\n    if (!wrapperComponent || !contentComponent)\n        return transformState;\n    var wrapperRect = wrapperComponent.getBoundingClientRect();\n    var nodeRect = node.getBoundingClientRect();\n    var nodeOffset = getOffset(node, wrapperComponent, contentComponent, transformState);\n    var nodeLeft = nodeOffset.x;\n    var nodeTop = nodeOffset.y;\n    var nodeWidth = nodeRect.width / transformState.scale;\n    var nodeHeight = nodeRect.height / transformState.scale;\n    var scaleX = wrapperComponent.offsetWidth / nodeWidth;\n    var scaleY = wrapperComponent.offsetHeight / nodeHeight;\n    var newScale = checkZoomBounds(customZoom || Math.min(scaleX, scaleY), minScale, maxScale, 0, false);\n    var offsetX = (wrapperRect.width - nodeWidth * newScale) / 2;\n    var offsetY = (wrapperRect.height - nodeHeight * newScale) / 2;\n    var newPositionX = (wrapperRect.left - nodeLeft) * newScale + offsetX;\n    var newPositionY = (wrapperRect.top - nodeTop) * newScale + offsetY;\n    var bounds = calculateBounds(contextInstance, newScale);\n    var _b = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, 0, 0, wrapperComponent), x = _b.x, y = _b.y;\n    return { positionX: x, positionY: y, scale: newScale };\n}\n\nvar zoomIn = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, 1, step, animationTime, animationType);\n    };\n};\nvar zoomOut = function (contextInstance) {\n    return function (step, animationTime, animationType) {\n        if (step === void 0) { step = 0.5; }\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleZoomToViewCenter(contextInstance, -1, step, animationTime, animationType);\n    };\n};\nvar setTransform = function (contextInstance) {\n    return function (newPositionX, newPositionY, newScale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 300; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var _a = contextInstance.transformState, positionX = _a.positionX, positionY = _a.positionY, scale = _a.scale;\n        var wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        var disabled = contextInstance.setup.disabled;\n        if (disabled || !wrapperComponent || !contentComponent)\n            return;\n        var targetState = {\n            positionX: Number.isNaN(newPositionX) ? positionX : newPositionX,\n            positionY: Number.isNaN(newPositionY) ? positionY : newPositionY,\n            scale: Number.isNaN(newScale) ? scale : newScale,\n        };\n        animate(contextInstance, targetState, animationTime, animationType);\n    };\n};\nvar resetTransform = function (contextInstance) {\n    return function (animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        resetTransformations(contextInstance, animationTime, animationType);\n    };\n};\nvar centerView = function (contextInstance) {\n    return function (scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 200; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        var transformState = contextInstance.transformState, wrapperComponent = contextInstance.wrapperComponent, contentComponent = contextInstance.contentComponent;\n        if (wrapperComponent && contentComponent) {\n            var targetState = getCenterPosition(scale || transformState.scale, wrapperComponent, contentComponent);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\nvar zoomToElement = function (contextInstance) {\n    return function (node, scale, animationTime, animationType) {\n        if (animationTime === void 0) { animationTime = 600; }\n        if (animationType === void 0) { animationType = \"easeOut\"; }\n        handleCancelAnimation(contextInstance);\n        var wrapperComponent = contextInstance.wrapperComponent;\n        var target = typeof node === \"string\" ? document.getElementById(node) : node;\n        if (wrapperComponent && target && wrapperComponent.contains(target)) {\n            var targetState = calculateZoomToNode(contextInstance, target, scale);\n            animate(contextInstance, targetState, animationTime, animationType);\n        }\n    };\n};\n\nvar getControls = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        zoomIn: zoomIn(contextInstance),\n        zoomOut: zoomOut(contextInstance),\n        setTransform: setTransform(contextInstance),\n        resetTransform: resetTransform(contextInstance),\n        centerView: centerView(contextInstance),\n        zoomToElement: zoomToElement(contextInstance),\n    };\n};\nvar getState = function (contextInstance) {\n    return {\n        instance: contextInstance,\n        state: contextInstance.transformState,\n    };\n};\nvar getContext = function (contextInstance) {\n    var ref = {};\n    Object.assign(ref, getState(contextInstance));\n    Object.assign(ref, getControls(contextInstance));\n    return ref;\n};\n\n// We want to make event listeners non-passive, and to do so have to check\n// that browsers support EventListenerOptions in the first place.\n// https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener#Safely_detecting_option_support\nvar passiveSupported = false;\nfunction makePassiveEventOption() {\n    try {\n        var options = {\n            get passive() {\n                // This function will be called when the browser\n                //   attempts to access the passive property.\n                passiveSupported = true;\n                return false;\n            },\n        };\n        return options;\n    }\n    catch (err) {\n        passiveSupported = false;\n        return passiveSupported;\n    }\n}\n\nvar matchPrefix = \".\".concat(baseClasses.wrapperClass);\nvar isExcludedNode = function (node, excluded) {\n    return excluded.some(function (exclude) {\n        return node.matches(\"\".concat(matchPrefix, \" \").concat(exclude, \", \").concat(matchPrefix, \" .\").concat(exclude, \", \").concat(matchPrefix, \" \").concat(exclude, \" *, \").concat(matchPrefix, \" .\").concat(exclude, \" *\"));\n    });\n};\nvar cancelTimeout = function (timeout) {\n    if (timeout) {\n        clearTimeout(timeout);\n    }\n};\n\nvar getTransformStyles = function (x, y, scale) {\n    // Standard translate prevents blurry svg on the safari\n    return \"translate(\".concat(x, \"px, \").concat(y, \"px) scale(\").concat(scale, \")\");\n};\nvar getMatrixTransformStyles = function (x, y, scale) {\n    // The shorthand for matrix does not work for Safari hence the need to explicitly use matrix3d\n    // Refer to https://developer.mozilla.org/en-US/docs/Web/CSS/transform-function/matrix\n    var a = scale;\n    var b = 0;\n    var c = 0;\n    var d = scale;\n    var tx = x;\n    var ty = y;\n    return \"matrix3d(\".concat(a, \", \").concat(b, \", 0, 0, \").concat(c, \", \").concat(d, \", 0, 0, 0, 0, 1, 0, \").concat(tx, \", \").concat(ty, \", 0, 1)\");\n};\nvar getCenterPosition = function (scale, wrapperComponent, contentComponent) {\n    var contentWidth = contentComponent.offsetWidth * scale;\n    var contentHeight = contentComponent.offsetHeight * scale;\n    var centerPositionX = (wrapperComponent.offsetWidth - contentWidth) / 2;\n    var centerPositionY = (wrapperComponent.offsetHeight - contentHeight) / 2;\n    return {\n        scale: scale,\n        positionX: centerPositionX,\n        positionY: centerPositionY,\n    };\n};\n\nfunction mergeRefs(refs) {\n    return function (value) {\n        refs.forEach(function (ref) {\n            if (typeof ref === \"function\") {\n                ref(value);\n            }\n            else if (ref != null) {\n                ref.current = value;\n            }\n        });\n    };\n}\n\nvar isWheelAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.wheel, disabled = _a.disabled, wheelDisabled = _a.wheelDisabled, touchPadDisabled = _a.touchPadDisabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized, isPanning = contextInstance.isPanning;\n    var target = event.target;\n    var isAllowed = isInitialized && !isPanning && !disabled && target;\n    if (!isAllowed)\n        return false;\n    // Event ctrlKey detects if touchpad action is executing wheel or pinch gesture\n    if (wheelDisabled && !event.ctrlKey)\n        return false;\n    if (touchPadDisabled && event.ctrlKey)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar getDeltaY = function (event) {\n    if (event) {\n        return event.deltaY < 0 ? 1 : -1;\n    }\n    return 0;\n};\nfunction getDelta(event, customDelta) {\n    var deltaY = getDeltaY(event);\n    var delta = checkIsNumber(customDelta, deltaY);\n    return delta;\n}\nfunction getMousePosition(event, contentComponent, scale) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var mouseX = 0;\n    var mouseY = 0;\n    if (\"clientX\" in event) {\n        // mouse position x, y over wrapper component\n        mouseX = (event.clientX - contentRect.left) / scale;\n        mouseY = (event.clientY - contentRect.top) / scale;\n    }\n    else {\n        var touch = event.touches[0];\n        mouseX = (touch.clientX - contentRect.left) / scale;\n        mouseY = (touch.clientY - contentRect.top) / scale;\n    }\n    if (Number.isNaN(mouseX) || Number.isNaN(mouseY))\n        console.error(\"No mouse or touch offset found\");\n    return {\n        x: mouseX,\n        y: mouseY,\n    };\n}\nvar handleCalculateWheelZoom = function (contextInstance, delta, step, disable, getTarget) {\n    var scale = contextInstance.transformState.scale;\n    var wrapperComponent = contextInstance.wrapperComponent, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!wrapperComponent) {\n        throw new Error(\"Wrapper is not mounted\");\n    }\n    var targetScale = scale + delta * step;\n    if (getTarget)\n        return targetScale;\n    var paddingEnabled = disable ? false : !disabled;\n    var newScale = checkZoomBounds(roundNumber(targetScale, 3), minScale, maxScale, size, paddingEnabled && !disablePadding);\n    return newScale;\n};\nvar handleWheelZoomStop = function (contextInstance, event) {\n    var previousWheelEvent = contextInstance.previousWheelEvent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, maxScale = _a.maxScale, minScale = _a.minScale;\n    if (!previousWheelEvent)\n        return false;\n    if (scale < maxScale || scale > minScale)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    if (previousWheelEvent.deltaY > 0 && previousWheelEvent.deltaY < event.deltaY)\n        return true;\n    if (previousWheelEvent.deltaY < 0 && previousWheelEvent.deltaY > event.deltaY)\n        return true;\n    if (Math.sign(previousWheelEvent.deltaY) !== Math.sign(event.deltaY))\n        return true;\n    return false;\n};\n\nvar isPinchStartAllowed = function (contextInstance, event) {\n    var _a = contextInstance.setup.pinch, disabled = _a.disabled, excluded = _a.excluded;\n    var isInitialized = contextInstance.isInitialized;\n    var target = event.target;\n    var isAllowed = isInitialized && !disabled && target;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\nvar isPinchAllowed = function (contextInstance) {\n    var disabled = contextInstance.setup.pinch.disabled;\n    var isInitialized = contextInstance.isInitialized, pinchStartDistance = contextInstance.pinchStartDistance;\n    var isAllowed = isInitialized && !disabled && pinchStartDistance;\n    if (!isAllowed)\n        return false;\n    return true;\n};\nvar calculateTouchMidPoint = function (event, scale, contentComponent) {\n    var contentRect = contentComponent.getBoundingClientRect();\n    var touches = event.touches;\n    var firstPointX = roundNumber(touches[0].clientX - contentRect.left, 5);\n    var firstPointY = roundNumber(touches[0].clientY - contentRect.top, 5);\n    var secondPointX = roundNumber(touches[1].clientX - contentRect.left, 5);\n    var secondPointY = roundNumber(touches[1].clientY - contentRect.top, 5);\n    return {\n        x: (firstPointX + secondPointX) / 2 / scale,\n        y: (firstPointY + secondPointY) / 2 / scale,\n    };\n};\nvar getTouchDistance = function (event) {\n    return Math.sqrt(Math.pow((event.touches[0].pageX - event.touches[1].pageX), 2) +\n        Math.pow((event.touches[0].pageY - event.touches[1].pageY), 2));\n};\nvar calculatePinchZoom = function (contextInstance, currentDistance) {\n    var pinchStartScale = contextInstance.pinchStartScale, pinchStartDistance = contextInstance.pinchStartDistance, setup = contextInstance.setup;\n    var maxScale = setup.maxScale, minScale = setup.minScale, zoomAnimation = setup.zoomAnimation, disablePadding = setup.disablePadding;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    if (!pinchStartScale || pinchStartDistance === null || !currentDistance) {\n        throw new Error(\"Pinch touches distance was not provided\");\n    }\n    if (currentDistance < 0) {\n        return contextInstance.transformState.scale;\n    }\n    var touchProportion = currentDistance / pinchStartDistance;\n    var scaleDifference = touchProportion * pinchStartScale;\n    return checkZoomBounds(roundNumber(scaleDifference, 2), minScale, maxScale, size, !disabled && !disablePadding);\n};\n\nvar wheelStopEventTime = 160;\nvar wheelAnimationTime = 100;\nvar handleWheelStart = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStart = _a.onWheelStart, onZoomStart = _a.onZoomStart;\n    if (!contextInstance.wheelStopEventTimer) {\n        handleCancelAnimation(contextInstance);\n        handleCallback(getContext(contextInstance), event, onWheelStart);\n        handleCallback(getContext(contextInstance), event, onZoomStart);\n    }\n};\nvar handleWheelZoom = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheel = _a.onWheel, onZoom = _a.onZoom;\n    var contentComponent = contextInstance.contentComponent, setup = contextInstance.setup, transformState = contextInstance.transformState;\n    var scale = transformState.scale;\n    var limitToBounds = setup.limitToBounds, centerZoomedOut = setup.centerZoomedOut, zoomAnimation = setup.zoomAnimation, wheel = setup.wheel, disablePadding = setup.disablePadding, smooth = setup.smooth;\n    var size = zoomAnimation.size, disabled = zoomAnimation.disabled;\n    var step = wheel.step, smoothStep = wheel.smoothStep;\n    if (!contentComponent) {\n        throw new Error(\"Component not mounted\");\n    }\n    event.preventDefault();\n    event.stopPropagation();\n    var delta = getDelta(event, null);\n    var zoomStep = smooth ? smoothStep * Math.abs(event.deltaY) : step;\n    var newScale = handleCalculateWheelZoom(contextInstance, delta, zoomStep, !event.ctrlKey);\n    // if scale not change\n    if (scale === newScale)\n        return;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut || disablePadding;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, mousePosition.x, mousePosition.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.previousWheelEvent = event;\n    contextInstance.setTransformState(newScale, x, y);\n    handleCallback(getContext(contextInstance), event, onWheel);\n    handleCallback(getContext(contextInstance), event, onZoom);\n};\nvar handleWheelStop = function (contextInstance, event) {\n    var _a = contextInstance.props, onWheelStop = _a.onWheelStop, onZoomStop = _a.onZoomStop;\n    // fire animation\n    cancelTimeout(contextInstance.wheelAnimationTimer);\n    contextInstance.wheelAnimationTimer = setTimeout(function () {\n        if (!contextInstance.mounted)\n            return;\n        handleAlignToScaleBounds(contextInstance, event.x, event.y);\n        contextInstance.wheelAnimationTimer = null;\n    }, wheelAnimationTime);\n    // Wheel stop event\n    var hasStoppedZooming = handleWheelZoomStop(contextInstance, event);\n    if (hasStoppedZooming) {\n        cancelTimeout(contextInstance.wheelStopEventTimer);\n        contextInstance.wheelStopEventTimer = setTimeout(function () {\n            if (!contextInstance.mounted)\n                return;\n            contextInstance.wheelStopEventTimer = null;\n            handleCallback(getContext(contextInstance), event, onWheelStop);\n            handleCallback(getContext(contextInstance), event, onZoomStop);\n        }, wheelStopEventTime);\n    }\n};\n\nvar getTouchCenter = function (event) {\n    var totalX = 0;\n    var totalY = 0;\n    // Sum up the positions of all touches\n    for (var i = 0; i < 2; i += 1) {\n        totalX += event.touches[i].clientX;\n        totalY += event.touches[i].clientY;\n    }\n    // Calculate the average position\n    var x = totalX / 2;\n    var y = totalY / 2;\n    return { x: x, y: y };\n};\nvar handlePinchStart = function (contextInstance, event) {\n    var distance = getTouchDistance(event);\n    contextInstance.pinchStartDistance = distance;\n    contextInstance.lastDistance = distance;\n    contextInstance.pinchStartScale = contextInstance.transformState.scale;\n    contextInstance.isPanning = false;\n    var center = getTouchCenter(event);\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    handleCancelAnimation(contextInstance);\n};\nvar handlePinchZoom = function (contextInstance, event) {\n    var contentComponent = contextInstance.contentComponent, pinchStartDistance = contextInstance.pinchStartDistance, wrapperComponent = contextInstance.wrapperComponent;\n    var scale = contextInstance.transformState.scale;\n    var _a = contextInstance.setup, limitToBounds = _a.limitToBounds, centerZoomedOut = _a.centerZoomedOut, zoomAnimation = _a.zoomAnimation, alignmentAnimation = _a.alignmentAnimation;\n    var disabled = zoomAnimation.disabled, size = zoomAnimation.size;\n    // if one finger starts from outside of wrapper\n    if (pinchStartDistance === null || !contentComponent)\n        return;\n    var midPoint = calculateTouchMidPoint(event, scale, contentComponent);\n    // if touches goes off of the wrapper element\n    if (!Number.isFinite(midPoint.x) || !Number.isFinite(midPoint.y))\n        return;\n    var currentDistance = getTouchDistance(event);\n    var newScale = calculatePinchZoom(contextInstance, currentDistance);\n    var center = getTouchCenter(event);\n    // pan should be scale invariant.\n    var panX = center.x - (contextInstance.pinchLastCenterX || 0);\n    var panY = center.y - (contextInstance.pinchLastCenterY || 0);\n    if (newScale === scale && panX === 0 && panY === 0)\n        return;\n    contextInstance.pinchLastCenterX = center.x;\n    contextInstance.pinchLastCenterY = center.y;\n    var bounds = handleCalculateBounds(contextInstance, newScale);\n    var isPaddingDisabled = disabled || size === 0 || centerZoomedOut;\n    var isLimitedToBounds = limitToBounds && isPaddingDisabled;\n    var _b = handleCalculateZoomPositions(contextInstance, midPoint.x, midPoint.y, newScale, bounds, isLimitedToBounds), x = _b.x, y = _b.y;\n    contextInstance.pinchMidpoint = midPoint;\n    contextInstance.lastDistance = currentDistance;\n    var sizeX = alignmentAnimation.sizeX, sizeY = alignmentAnimation.sizeY;\n    var paddingValueX = getPaddingValue(contextInstance, sizeX);\n    var paddingValueY = getPaddingValue(contextInstance, sizeY);\n    var newPositionX = x + panX;\n    var newPositionY = y + panY;\n    var _c = getMouseBoundedPosition(newPositionX, newPositionY, bounds, limitToBounds, paddingValueX, paddingValueY, wrapperComponent), finalX = _c.x, finalY = _c.y;\n    contextInstance.setTransformState(newScale, finalX, finalY);\n};\nvar handlePinchStop = function (contextInstance) {\n    var pinchMidpoint = contextInstance.pinchMidpoint;\n    contextInstance.velocity = null;\n    contextInstance.lastDistance = null;\n    contextInstance.pinchMidpoint = null;\n    contextInstance.pinchStartScale = null;\n    contextInstance.pinchStartDistance = null;\n    handleAlignToScaleBounds(contextInstance, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.x, pinchMidpoint === null || pinchMidpoint === void 0 ? void 0 : pinchMidpoint.y);\n};\n\nvar handleDoubleClickStop = function (contextInstance, event) {\n    var onZoomStop = contextInstance.props.onZoomStop;\n    var animationTime = contextInstance.setup.doubleClick.animationTime;\n    cancelTimeout(contextInstance.doubleClickStopEventTimer);\n    contextInstance.doubleClickStopEventTimer = setTimeout(function () {\n        contextInstance.doubleClickStopEventTimer = null;\n        handleCallback(getContext(contextInstance), event, onZoomStop);\n    }, animationTime);\n};\nvar handleDoubleClickResetMode = function (contextInstance, event) {\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = contextInstance.setup.doubleClick, animationTime = _b.animationTime, animationType = _b.animationType;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    resetTransformations(contextInstance, animationTime, animationType, function () {\n        return handleCallback(getContext(contextInstance), event, onZoom);\n    });\n    handleDoubleClickStop(contextInstance, event);\n};\nfunction getDoubleClickScale(mode, scale) {\n    if (mode === \"toggle\") {\n        return scale === 1 ? 1 : -1;\n    }\n    return mode === \"zoomOut\" ? -1 : 1;\n}\nfunction handleDoubleClick(contextInstance, event) {\n    var setup = contextInstance.setup, doubleClickStopEventTimer = contextInstance.doubleClickStopEventTimer, transformState = contextInstance.transformState, contentComponent = contextInstance.contentComponent;\n    var scale = transformState.scale;\n    var _a = contextInstance.props, onZoomStart = _a.onZoomStart, onZoom = _a.onZoom;\n    var _b = setup.doubleClick, disabled = _b.disabled, mode = _b.mode, step = _b.step, animationTime = _b.animationTime, animationType = _b.animationType;\n    if (disabled)\n        return;\n    if (doubleClickStopEventTimer)\n        return;\n    if (mode === \"reset\") {\n        return handleDoubleClickResetMode(contextInstance, event);\n    }\n    if (!contentComponent)\n        return console.error(\"No ContentComponent found\");\n    var delta = getDoubleClickScale(mode, contextInstance.transformState.scale);\n    var newScale = handleCalculateButtonZoom(contextInstance, delta, step);\n    // stop execution when scale didn't change\n    if (scale === newScale)\n        return;\n    handleCallback(getContext(contextInstance), event, onZoomStart);\n    var mousePosition = getMousePosition(event, contentComponent, scale);\n    var targetState = handleZoomToPoint(contextInstance, newScale, mousePosition.x, mousePosition.y);\n    if (!targetState) {\n        return console.error(\"Error during zoom event. New transformation state was not calculated.\");\n    }\n    handleCallback(getContext(contextInstance), event, onZoom);\n    animate(contextInstance, targetState, animationTime, animationType);\n    handleDoubleClickStop(contextInstance, event);\n}\nvar isDoubleClickAllowed = function (contextInstance, event) {\n    var isInitialized = contextInstance.isInitialized, setup = contextInstance.setup, wrapperComponent = contextInstance.wrapperComponent;\n    var _a = setup.doubleClick, disabled = _a.disabled, excluded = _a.excluded;\n    var target = event.target;\n    var isWrapperChild = wrapperComponent === null || wrapperComponent === void 0 ? void 0 : wrapperComponent.contains(target);\n    var isAllowed = isInitialized && target && isWrapperChild && !disabled;\n    if (!isAllowed)\n        return false;\n    var isExcluded = isExcludedNode(target, excluded);\n    if (isExcluded)\n        return false;\n    return true;\n};\n\nvar ZoomPanPinch = /** @class */ (function () {\n    function ZoomPanPinch(props) {\n        var _this = this;\n        this.mounted = true;\n        this.pinchLastCenterX = null;\n        this.pinchLastCenterY = null;\n        this.onChangeCallbacks = new Set();\n        this.onInitCallbacks = new Set();\n        // Components\n        this.wrapperComponent = null;\n        this.contentComponent = null;\n        // Initialization\n        this.isInitialized = false;\n        this.bounds = null;\n        // wheel helpers\n        this.previousWheelEvent = null;\n        this.wheelStopEventTimer = null;\n        this.wheelAnimationTimer = null;\n        // panning helpers\n        this.isPanning = false;\n        this.isWheelPanning = false;\n        this.startCoords = null;\n        this.lastTouch = null;\n        // pinch helpers\n        this.distance = null;\n        this.lastDistance = null;\n        this.pinchStartDistance = null;\n        this.pinchStartScale = null;\n        this.pinchMidpoint = null;\n        // double click helpers\n        this.doubleClickStopEventTimer = null;\n        // velocity helpers\n        this.velocity = null;\n        this.velocityTime = null;\n        this.lastMousePosition = null;\n        // animations helpers\n        this.animate = false;\n        this.animation = null;\n        this.maxBounds = null;\n        // key press\n        this.pressedKeys = {};\n        this.mount = function () {\n            _this.initializeWindowEvents();\n        };\n        this.unmount = function () {\n            _this.cleanupWindowEvents();\n        };\n        this.update = function (newProps) {\n            _this.props = newProps;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.setup = createSetup(newProps);\n        };\n        this.initializeWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            (_b = _this.wrapperComponent) === null || _b === void 0 ? void 0 : _b.addEventListener(\"wheel\", _this.onWheelPanning, passive);\n            // Panning on window to allow panning when mouse is out of component wrapper\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.addEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.addEventListener(\"keydown\", _this.setKeyPressed, passive);\n        };\n        this.cleanupWindowEvents = function () {\n            var _a, _b;\n            var passive = makePassiveEventOption();\n            var currentDocument = (_a = _this.wrapperComponent) === null || _a === void 0 ? void 0 : _a.ownerDocument;\n            var currentWindow = currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.defaultView;\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousedown\", _this.onPanningStart, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mousemove\", _this.onPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"mouseup\", _this.onPanningStop, passive);\n            currentDocument === null || currentDocument === void 0 ? void 0 : currentDocument.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keyup\", _this.setKeyUnPressed, passive);\n            currentWindow === null || currentWindow === void 0 ? void 0 : currentWindow.removeEventListener(\"keydown\", _this.setKeyPressed, passive);\n            document.removeEventListener(\"mouseleave\", _this.clearPanning, passive);\n            handleCancelAnimation(_this);\n            (_b = _this.observer) === null || _b === void 0 ? void 0 : _b.disconnect();\n        };\n        this.handleInitializeWrapperEvents = function (wrapper) {\n            // Zooming events on wrapper\n            var passive = makePassiveEventOption();\n            wrapper.addEventListener(\"wheel\", _this.onWheelZoom, passive);\n            wrapper.addEventListener(\"dblclick\", _this.onDoubleClick, passive);\n            wrapper.addEventListener(\"touchstart\", _this.onTouchPanningStart, passive);\n            wrapper.addEventListener(\"touchmove\", _this.onTouchPanning, passive);\n            wrapper.addEventListener(\"touchend\", _this.onTouchPanningStop, passive);\n        };\n        this.handleInitialize = function (contentComponent) {\n            var centerOnInit = _this.setup.centerOnInit;\n            _this.applyTransformation();\n            _this.onInitCallbacks.forEach(function (callback) { return callback(getContext(_this)); });\n            if (centerOnInit) {\n                _this.setCenter();\n                _this.observer = new ResizeObserver(function () {\n                    var _a;\n                    var currentWidth = contentComponent.offsetWidth;\n                    var currentHeight = contentComponent.offsetHeight;\n                    if (currentWidth > 0 || currentHeight > 0) {\n                        _this.onInitCallbacks.forEach(function (callback) {\n                            return callback(getContext(_this));\n                        });\n                        _this.setCenter();\n                        (_a = _this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n                    }\n                });\n                // if nothing about the contentComponent has changed after 5 seconds, disconnect the observer\n                setTimeout(function () {\n                    var _a;\n                    (_a = _this.observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n                }, 5000);\n                // Start observing the target node for configured mutations\n                _this.observer.observe(contentComponent);\n            }\n        };\n        /// ///////\n        // Zoom\n        /// ///////\n        this.onWheelZoom = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isWheelAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.wheel.activationKeys);\n            if (!keysPressed)\n                return;\n            handleWheelStart(_this, event);\n            handleWheelZoom(_this, event);\n            handleWheelStop(_this, event);\n        };\n        /// ///////\n        // Pan\n        /// ///////\n        this.onWheelPanning = function (event) {\n            var _a = _this.setup, disabled = _a.disabled, wheel = _a.wheel, panning = _a.panning;\n            if (!_this.wrapperComponent ||\n                !_this.contentComponent ||\n                disabled ||\n                !wheel.wheelDisabled ||\n                panning.disabled ||\n                !panning.wheelPanning ||\n                event.ctrlKey) {\n                return;\n            }\n            event.preventDefault();\n            event.stopPropagation();\n            var _b = _this.transformState, positionX = _b.positionX, positionY = _b.positionY;\n            var mouseX = positionX - event.deltaX;\n            var mouseY = positionY - event.deltaY;\n            var newPositionX = panning.lockAxisX ? positionX : mouseX;\n            var newPositionY = panning.lockAxisY ? positionY : mouseY;\n            var _c = _this.setup.alignmentAnimation, sizeX = _c.sizeX, sizeY = _c.sizeY;\n            var paddingValueX = getPaddingValue(_this, sizeX);\n            var paddingValueY = getPaddingValue(_this, sizeY);\n            if (newPositionX === positionX && newPositionY === positionY)\n                return;\n            handleNewPosition(_this, newPositionX, newPositionY, paddingValueX, paddingValueY);\n        };\n        this.onPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            if (event.button === 0 && !_this.setup.panning.allowLeftClickPan)\n                return;\n            if (event.button === 1 && !_this.setup.panning.allowMiddleClickPan)\n                return;\n            if (event.button === 2 && !_this.setup.panning.allowRightClickPan)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handleCancelAnimation(_this);\n            handlePanningStart(_this, event);\n            handleCallback(getContext(_this), event, onPanningStart);\n        };\n        this.onPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (disabled)\n                return;\n            var isAllowed = isPanningAllowed(_this);\n            if (!isAllowed)\n                return;\n            var keysPressed = _this.isPressingKeys(_this.setup.panning.activationKeys);\n            if (!keysPressed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePanning(_this, event.clientX, event.clientY);\n            handleCallback(getContext(_this), event, onPanning);\n        };\n        this.onPanningStop = function (event) {\n            var onPanningStop = _this.props.onPanningStop;\n            if (_this.isPanning) {\n                handlePanningEnd(_this);\n                handleCallback(getContext(_this), event, onPanningStop);\n            }\n        };\n        /// ///////\n        // Pinch\n        /// ///////\n        this.onPinchStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinchingStart = _a.onPinchingStart, onZoomStart = _a.onZoomStart;\n            if (disabled)\n                return;\n            var isAllowed = isPinchStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handlePinchStart(_this, event);\n            handleCancelAnimation(_this);\n            handleCallback(getContext(_this), event, onPinchingStart);\n            handleCallback(getContext(_this), event, onZoomStart);\n        };\n        this.onPinch = function (event) {\n            var disabled = _this.setup.disabled;\n            var _a = _this.props, onPinching = _a.onPinching, onZoom = _a.onZoom;\n            if (disabled)\n                return;\n            var isAllowed = isPinchAllowed(_this);\n            if (!isAllowed)\n                return;\n            event.preventDefault();\n            event.stopPropagation();\n            handlePinchZoom(_this, event);\n            handleCallback(getContext(_this), event, onPinching);\n            handleCallback(getContext(_this), event, onZoom);\n        };\n        this.onPinchStop = function (event) {\n            var _a = _this.props, onPinchingStop = _a.onPinchingStop, onZoomStop = _a.onZoomStop;\n            if (_this.pinchStartScale) {\n                handlePinchStop(_this);\n                handleCallback(getContext(_this), event, onPinchingStop);\n                handleCallback(getContext(_this), event, onZoomStop);\n            }\n        };\n        /// ///////\n        // Touch\n        /// ///////\n        this.onTouchPanningStart = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanningStart = _this.props.onPanningStart;\n            if (disabled)\n                return;\n            var isAllowed = isPanningStartAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            var isDoubleTap = _this.lastTouch && +new Date() - _this.lastTouch < 200;\n            if (!isDoubleTap) {\n                _this.lastTouch = +new Date();\n                handleCancelAnimation(_this);\n                var touches = event.touches;\n                var isPanningAction = touches.length === 1;\n                var isPinchAction = touches.length === 2;\n                if (isPanningAction) {\n                    handleCancelAnimation(_this);\n                    handlePanningStart(_this, event);\n                    handleCallback(getContext(_this), event, onPanningStart);\n                }\n                if (isPinchAction) {\n                    _this.onPinchStart(event);\n                }\n            }\n        };\n        this.onTouchPanning = function (event) {\n            var disabled = _this.setup.disabled;\n            var onPanning = _this.props.onPanning;\n            if (_this.isPanning && event.touches.length === 1) {\n                if (disabled)\n                    return;\n                var isAllowed = isPanningAllowed(_this);\n                if (!isAllowed)\n                    return;\n                event.preventDefault();\n                event.stopPropagation();\n                var touch = event.touches[0];\n                handlePanning(_this, touch.clientX, touch.clientY);\n                handleCallback(getContext(_this), event, onPanning);\n            }\n            else if (event.touches.length > 1) {\n                _this.onPinch(event);\n            }\n        };\n        this.onTouchPanningStop = function (event) {\n            _this.onPanningStop(event);\n            _this.onPinchStop(event);\n        };\n        /// ///////\n        // Double Click\n        /// ///////\n        this.onDoubleClick = function (event) {\n            var disabled = _this.setup.disabled;\n            if (disabled)\n                return;\n            var isAllowed = isDoubleClickAllowed(_this, event);\n            if (!isAllowed)\n                return;\n            handleDoubleClick(_this, event);\n        };\n        /// ///////\n        // Helpers\n        /// ///////\n        this.clearPanning = function (event) {\n            if (_this.isPanning) {\n                _this.onPanningStop(event);\n            }\n        };\n        this.setKeyPressed = function (e) {\n            _this.pressedKeys[e.key] = true;\n        };\n        this.setKeyUnPressed = function (e) {\n            _this.pressedKeys[e.key] = false;\n        };\n        this.isPressingKeys = function (keys) {\n            if (!keys.length) {\n                return true;\n            }\n            return Boolean(keys.find(function (key) { return _this.pressedKeys[key]; }));\n        };\n        this.setTransformState = function (scale, positionX, positionY) {\n            var onTransformed = _this.props.onTransformed;\n            if (!Number.isNaN(scale) &&\n                !Number.isNaN(positionX) &&\n                !Number.isNaN(positionY)) {\n                if (scale !== _this.transformState.scale) {\n                    _this.transformState.previousScale = _this.transformState.scale;\n                    _this.transformState.scale = scale;\n                }\n                _this.transformState.positionX = positionX;\n                _this.transformState.positionY = positionY;\n                _this.applyTransformation();\n                var ctx_1 = getContext(_this);\n                _this.onChangeCallbacks.forEach(function (callback) { return callback(ctx_1); });\n                handleCallback(ctx_1, { scale: scale, positionX: positionX, positionY: positionY }, onTransformed);\n            }\n            else {\n                console.error(\"Detected NaN set state values\");\n            }\n        };\n        this.setCenter = function () {\n            if (_this.wrapperComponent && _this.contentComponent) {\n                var targetState = getCenterPosition(_this.transformState.scale, _this.wrapperComponent, _this.contentComponent);\n                _this.setTransformState(targetState.scale, targetState.positionX, targetState.positionY);\n            }\n        };\n        this.handleTransformStyles = function (x, y, scale) {\n            if (_this.props.customTransform) {\n                return _this.props.customTransform(x, y, scale);\n            }\n            return getTransformStyles(x, y, scale);\n        };\n        this.applyTransformation = function () {\n            if (!_this.mounted || !_this.contentComponent)\n                return;\n            var _a = _this.transformState, scale = _a.scale, positionX = _a.positionX, positionY = _a.positionY;\n            var transform = _this.handleTransformStyles(positionX, positionY, scale);\n            _this.contentComponent.style.transform = transform;\n        };\n        this.getContext = function () {\n            return getContext(_this);\n        };\n        /**\n         * Hooks\n         */\n        this.onChange = function (callback) {\n            if (!_this.onChangeCallbacks.has(callback)) {\n                _this.onChangeCallbacks.add(callback);\n            }\n            return function () {\n                _this.onChangeCallbacks.delete(callback);\n            };\n        };\n        this.onInit = function (callback) {\n            if (!_this.onInitCallbacks.has(callback)) {\n                _this.onInitCallbacks.add(callback);\n            }\n            return function () {\n                _this.onInitCallbacks.delete(callback);\n            };\n        };\n        /**\n         * Initialization\n         */\n        this.init = function (wrapperComponent, contentComponent) {\n            _this.cleanupWindowEvents();\n            _this.wrapperComponent = wrapperComponent;\n            _this.contentComponent = contentComponent;\n            handleCalculateBounds(_this, _this.transformState.scale);\n            _this.handleInitializeWrapperEvents(wrapperComponent);\n            _this.handleInitialize(contentComponent);\n            _this.initializeWindowEvents();\n            _this.isInitialized = true;\n            var ctx = getContext(_this);\n            handleCallback(ctx, undefined, _this.props.onInit);\n        };\n        this.props = props;\n        this.setup = createSetup(this.props);\n        this.transformState = createState(this.props);\n    }\n    return ZoomPanPinch;\n}());\n\nvar Context = React.createContext(null);\nvar getContent = function (children, ctx) {\n    if (typeof children === \"function\") {\n        return children(ctx);\n    }\n    return children;\n};\nvar TransformWrapper = React.forwardRef(function (props, ref) {\n    var instance = useRef(new ZoomPanPinch(props)).current;\n    var content = getContent(props.children, getControls(instance));\n    useImperativeHandle(ref, function () { return getControls(instance); }, [instance]);\n    useEffect(function () {\n        instance.update(props);\n    }, [instance, props]);\n    return React.createElement(Context.Provider, { value: instance }, content);\n});\n\nvar KeepScale = React.forwardRef(function (props, ref) {\n    var localRef = useRef(null);\n    var instance = useContext(Context);\n    useEffect(function () {\n        return instance.onChange(function (ctx) {\n            if (localRef.current) {\n                var positionX = 0;\n                var positionY = 0;\n                localRef.current.style.transform = instance.handleTransformStyles(positionX, positionY, 1 / ctx.instance.transformState.scale);\n            }\n        });\n    }, [instance]);\n    return React.createElement(\"div\", __assign({}, props, { ref: mergeRefs([localRef, ref]) }));\n});\n\nvar initialElementRect = {\n    width: 0,\n    height: 0,\n    y: 0,\n    x: 0,\n    top: 0,\n    bottom: 0,\n    left: 0,\n    right: 0,\n};\nvar useResize = function (ref, onResize, dependencies) {\n    var resizeObserverRef = useRef();\n    var rectRef = useRef(initialElementRect);\n    var didUnmount = useRef(false);\n    useLayoutEffect(function () {\n        var _a;\n        didUnmount.current = false;\n        if (!(\"ResizeObserver\" in window)) {\n            return;\n        }\n        if (ref) {\n            resizeObserverRef.current = new ResizeObserver(function (entries) {\n                var newSize = ref.getBoundingClientRect();\n                if (!Array.isArray(entries) ||\n                    !entries.length ||\n                    didUnmount.current ||\n                    (newSize.width === rectRef.current.width &&\n                        newSize.height === rectRef.current.height))\n                    return;\n                onResize(newSize, ref);\n                rectRef.current = newSize;\n            });\n            (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.observe(ref);\n        }\n        return function () {\n            var _a;\n            didUnmount.current = true;\n            if (ref) {\n                (_a = resizeObserverRef.current) === null || _a === void 0 ? void 0 : _a.unobserve(ref);\n            }\n        };\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, __spreadArray([onResize, ref], dependencies, true));\n};\n\nvar previewStyles = {\n    position: \"absolute\",\n    zIndex: 2,\n    top: \"0px\",\n    left: \"0px\",\n    boxSizing: \"border-box\",\n    border: \"3px solid red\",\n    transformOrigin: \"0% 0%\",\n    boxShadow: \"rgba(0,0,0,0.2) 0 0 0 10000000px\",\n};\nvar MiniMap = function (_a) {\n    var _b = _a.width, width = _b === void 0 ? 200 : _b, _c = _a.height, height = _c === void 0 ? 200 : _c, _d = _a.borderColor, borderColor = _d === void 0 ? \"red\" : _d, children = _a.children, rest = __rest(_a, [\"width\", \"height\", \"borderColor\", \"children\"]);\n    var _e = useState(false), initialized = _e[0], setInitialized = _e[1];\n    var instance = useTransformContext();\n    var miniMapInstance = useRef(null);\n    var mainRef = useRef(null);\n    var wrapperRef = useRef(null);\n    var previewRef = useRef(null);\n    var getViewportSize = useCallback(function () {\n        if (instance.wrapperComponent) {\n            var rect = instance.wrapperComponent.getBoundingClientRect();\n            return {\n                width: rect.width,\n                height: rect.height\n            };\n        }\n        return {\n            width: 0,\n            height: 0\n        };\n    }, [instance.wrapperComponent]);\n    var getContentSize = useCallback(function () {\n        if (instance.contentComponent) {\n            var rect = instance.contentComponent.getBoundingClientRect();\n            return {\n                width: rect.width / instance.transformState.scale,\n                height: rect.height / instance.transformState.scale,\n            };\n        }\n        return {\n            width: 0,\n            height: 0,\n        };\n    }, [instance.contentComponent, instance.transformState.scale]);\n    var computeMiniMapScale = useCallback(function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        var scale = scaleY > scaleX ? scaleX : scaleY;\n        return scale;\n    }, [getContentSize, height, width]);\n    var computeMiniMapSize = function () {\n        var contentSize = getContentSize();\n        var scaleX = width / contentSize.width;\n        var scaleY = height / contentSize.height;\n        if (scaleY > scaleX) {\n            return { width: width, height: contentSize.height * scaleX };\n        }\n        return { width: contentSize.width * scaleY, height: height };\n    };\n    var computeMiniMapStyle = function () {\n        var scale = computeMiniMapScale();\n        var style = {\n            transform: \"scale(\".concat(scale || 1, \")\"),\n            transformOrigin: \"0% 0%\",\n            position: \"absolute\",\n            boxSizing: \"border-box\",\n            zIndex: 1,\n            overflow: \"hidden\",\n        };\n        Object.keys(style).forEach(function (key) {\n            if (wrapperRef.current) {\n                wrapperRef.current.style[key] = style[key];\n            }\n        });\n    };\n    var transformMiniMap = function () {\n        computeMiniMapStyle();\n        var miniSize = computeMiniMapSize();\n        var wrapSize = getContentSize();\n        if (wrapperRef.current) {\n            wrapperRef.current.style.width = \"\".concat(wrapSize.width, \"px\");\n            wrapperRef.current.style.height = \"\".concat(wrapSize.height, \"px\");\n        }\n        if (mainRef.current) {\n            mainRef.current.style.width = \"\".concat(miniSize.width, \"px\");\n            mainRef.current.style.height = \"\".concat(miniSize.height, \"px\");\n        }\n        if (previewRef.current) {\n            var size = getViewportSize();\n            var scale = computeMiniMapScale();\n            var previewScale = scale * (1 / instance.transformState.scale);\n            var transform = instance.handleTransformStyles(-instance.transformState.positionX * previewScale, -instance.transformState.positionY * previewScale, 1);\n            previewRef.current.style.transform = transform;\n            previewRef.current.style.width = \"\".concat(size.width * previewScale, \"px\");\n            previewRef.current.style.height = \"\".concat(size.height * previewScale, \"px\");\n        }\n    };\n    var initialize = function () {\n        transformMiniMap();\n    };\n    useTransformEffect(function () {\n        transformMiniMap();\n    });\n    useTransformInit(function () {\n        initialize();\n        setInitialized(true);\n    });\n    useResize(instance.contentComponent, initialize, [initialized]);\n    useEffect(function () {\n        return instance.onChange(function (zpp) {\n            var scale = computeMiniMapScale();\n            if (miniMapInstance.current) {\n                miniMapInstance.current.instance.transformState.scale =\n                    zpp.instance.transformState.scale;\n                miniMapInstance.current.instance.transformState.positionX =\n                    zpp.instance.transformState.positionX * scale;\n                miniMapInstance.current.instance.transformState.positionY =\n                    zpp.instance.transformState.positionY * scale;\n            }\n        });\n    }, [computeMiniMapScale, instance, miniMapInstance]);\n    var wrapperStyle = useMemo(function () {\n        return {\n            position: \"relative\",\n            zIndex: 2,\n            overflow: \"hidden\",\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, rest, { ref: mainRef, style: wrapperStyle, className: \"rzpp-mini-map \".concat(rest.className || \"\") }),\n        React.createElement(\"div\", __assign({}, rest, { ref: wrapperRef, className: \"rzpp-wrapper\" }), children),\n        React.createElement(\"div\", { className: \"rzpp-preview\", ref: previewRef, style: __assign(__assign({}, previewStyles), { borderColor: borderColor }) })));\n};\n\nfunction styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".transform-component-module_wrapper__SPB86 {\\n  position: relative;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  overflow: hidden;\\n  -webkit-touch-callout: none; /* iOS Safari */\\n  -webkit-user-select: none; /* Safari */\\n  -khtml-user-select: none; /* Konqueror HTML */\\n  -moz-user-select: none; /* Firefox */\\n  -ms-user-select: none; /* Internet Explorer/Edge */\\n  user-select: none;\\n  margin: 0;\\n  padding: 0;\\n}\\n.transform-component-module_content__FBWxo {\\n  display: flex;\\n  flex-wrap: wrap;\\n  width: -moz-fit-content;\\n  width: fit-content;\\n  height: -moz-fit-content;\\n  height: fit-content;\\n  margin: 0;\\n  padding: 0;\\n  transform-origin: 0% 0%;\\n}\\n.transform-component-module_content__FBWxo img {\\n  pointer-events: none;\\n}\\n\";\nvar styles = {\"wrapper\":\"transform-component-module_wrapper__SPB86\",\"content\":\"transform-component-module_content__FBWxo\"};\nstyleInject(css_248z);\n\nvar TransformComponent = function (_a) {\n    var children = _a.children, _b = _a.wrapperClass, wrapperClass = _b === void 0 ? \"\" : _b, _c = _a.contentClass, contentClass = _c === void 0 ? \"\" : _c, wrapperStyle = _a.wrapperStyle, contentStyle = _a.contentStyle, _d = _a.wrapperProps, wrapperProps = _d === void 0 ? {} : _d, _e = _a.contentProps, contentProps = _e === void 0 ? {} : _e;\n    var _f = useContext(Context), init = _f.init, cleanupWindowEvents = _f.cleanupWindowEvents;\n    var wrapperRef = useRef(null);\n    var contentRef = useRef(null);\n    useEffect(function () {\n        var wrapper = wrapperRef.current;\n        var content = contentRef.current;\n        if (wrapper !== null && content !== null && init) {\n            init === null || init === void 0 ? void 0 : init(wrapper, content);\n        }\n        // eslint-disable-next-line react-hooks/exhaustive-deps\n        return function () {\n            cleanupWindowEvents === null || cleanupWindowEvents === void 0 ? void 0 : cleanupWindowEvents();\n        };\n    }, []);\n    return (React.createElement(\"div\", __assign({}, wrapperProps, { ref: wrapperRef, className: \"\".concat(baseClasses.wrapperClass, \" \").concat(styles.wrapper, \" \").concat(wrapperClass), style: wrapperStyle }),\n        React.createElement(\"div\", __assign({}, contentProps, { ref: contentRef, className: \"\".concat(baseClasses.contentClass, \" \").concat(styles.content, \" \").concat(contentClass), style: contentStyle }), children)));\n};\n\nvar useTransformContext = function () {\n    var libraryContext = useContext(Context);\n    if (!libraryContext) {\n        throw new Error(\"Transform context must be placed inside TransformWrapper\");\n    }\n    return libraryContext;\n};\n\nvar useControls = function () {\n    var libraryContext = useTransformContext();\n    return getControls(libraryContext);\n};\n\nvar useTransformInit = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount;\n        if (libraryContext.contentComponent && libraryContext.wrapperComponent) {\n            unmountCallback = callback(getState(libraryContext));\n        }\n        else {\n            unmount = libraryContext.onInit(function (ref) {\n                unmountCallback = callback(getState(ref.instance));\n            });\n        }\n        return function () {\n            unmount === null || unmount === void 0 ? void 0 : unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, []);\n};\n\nvar useTransformEffect = function (callback) {\n    var libraryContext = useTransformContext();\n    useEffect(function () {\n        var unmountCallback;\n        var unmount = libraryContext.onChange(function (ref) {\n            unmountCallback = callback(getState(ref.instance));\n        });\n        return function () {\n            unmount();\n            unmountCallback === null || unmountCallback === void 0 ? void 0 : unmountCallback();\n        };\n    }, [callback, libraryContext]);\n};\n\nfunction useTransformComponent(callback) {\n    var libraryContext = useTransformContext();\n    var _a = useState(callback(getState(libraryContext))), transformRender = _a[0], setTransformRender = _a[1];\n    useEffect(function () {\n        var mounted = true;\n        var unmount = libraryContext.onChange(function (ref) {\n            if (mounted) {\n                setTransformRender(callback(getState(ref.instance)));\n            }\n        });\n        return function () {\n            unmount();\n            mounted = false;\n        };\n    }, [callback, libraryContext]);\n    return transformRender;\n}\n\nexport { Context, KeepScale, MiniMap, TransformComponent, TransformWrapper, getCenterPosition, getMatrixTransformStyles, getTransformStyles, useControls, useTransformComponent, useTransformContext, useTransformEffect, useTransformInit };\n//# sourceMappingURL=index.esm.js.map\n","import * as React from 'react';\nimport { TransformWrapper, TransformComponent, ReactZoomPanPinchRef } from 'react-zoom-pan-pinch';\n\nimport { config } from '@grafana/runtime';\n\nimport { Scene } from './scene';\n\ntype SceneTransformWrapperProps = {\n  scene: Scene;\n  children: React.ReactNode;\n};\n\nexport const SceneTransformWrapper = ({ scene, children: sceneDiv }: SceneTransformWrapperProps) => {\n  const onZoom = (zoomPanPinchRef: ReactZoomPanPinchRef) => {\n    const scale = zoomPanPinchRef.state.scale;\n    scene.scale = scale;\n\n    if (scene.shouldInfinitePan) {\n      const isScaleZoomedOut = scale < 1;\n\n      if (isScaleZoomedOut) {\n        scene.updateSize(scene.width / scale, scene.height / scale);\n        scene.panel.forceUpdate();\n      }\n    }\n  };\n\n  const onZoomStop = (zoomPanPinchRef: ReactZoomPanPinchRef) => {\n    const scale = zoomPanPinchRef.state.scale;\n    scene.scale = scale;\n    updateMoveable(scale);\n  };\n\n  const onTransformed = (\n    _: ReactZoomPanPinchRef,\n    state: {\n      scale: number;\n      positionX: number;\n      positionY: number;\n    }\n  ) => {\n    const scale = state.scale;\n    scene.scale = scale;\n    updateMoveable(scale);\n  };\n\n  const updateMoveable = (scale: number) => {\n    if (scene.moveable && scale > 0) {\n      scene.moveable.zoom = 1 / scale;\n      if (scale === 1) {\n        scene.moveable.snappable = true;\n      } else {\n        scene.moveable.snappable = false;\n      }\n    }\n  };\n\n  const onPanning = (_: ReactZoomPanPinchRef, event: MouseEvent | TouchEvent) => {\n    if (scene.shouldInfinitePan && event instanceof MouseEvent) {\n      // Get deltaX and deltaY from pan event and add it to current canvas dimensions\n      let deltaX = event.movementX;\n      let deltaY = event.movementY;\n      if (deltaX > 0) {\n        deltaX = 0;\n      }\n      if (deltaY > 0) {\n        deltaY = 0;\n      }\n\n      // TODO: Consider bounding to the scene elements instead of allowing \"infinite\" panning\n      // TODO: Consider making scene grow in all directions vs just down to the right / bottom\n      scene.updateSize(scene.width - deltaX, scene.height - deltaY);\n      scene.panel.forceUpdate();\n    }\n  };\n\n  const onSceneContainerMouseDown = (e: React.MouseEvent<HTMLDivElement, MouseEvent>) => {\n    // If pan and zoom is disabled or context menu is visible, don't pan\n    if ((!scene.shouldPanZoom || scene.contextMenuVisible) && (e.button === 1 || (e.button === 2 && e.ctrlKey))) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n\n    // If context menu is hidden, ignore left mouse or non-ctrl right mouse for pan\n    if (!scene.contextMenuVisible && !scene.isPanelEditing && e.button === 2 && !e.ctrlKey) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  // Set panel content overflow to hidden to prevent canvas content from overflowing\n  scene.div?.parentElement?.parentElement?.parentElement?.parentElement?.setAttribute('style', `overflow: hidden`);\n\n  return (\n    <TransformWrapper\n      doubleClick={{ mode: 'reset' }}\n      ref={scene.transformComponentRef}\n      onZoom={onZoom}\n      onZoomStop={onZoomStop}\n      onTransformed={onTransformed}\n      disabled={!config.featureToggles.canvasPanelPanZoom || !scene.shouldPanZoom}\n      panning={{ allowLeftClickPan: false }}\n      limitToBounds={!scene.shouldInfinitePan}\n      minScale={scene.shouldInfinitePan ? 0.1 : undefined}\n      onPanning={onPanning}\n    >\n      <TransformComponent>\n        {/* The <div> element has child elements that allow for mouse events, so we need to disable the linter rule */}\n        {/* eslint-disable-next-line jsx-a11y/no-static-element-interactions */}\n        <div onMouseDown={onSceneContainerMouseDown}>{sceneDiv}</div>\n      </TransformComponent>\n    </TransformWrapper>\n  );\n};\n","import { CanvasFrameOptions } from '../frame';\n\nimport { FrameState } from './frame';\nimport { Scene } from './scene';\n\nexport class RootElement extends FrameState {\n  constructor(\n    public options: CanvasFrameOptions,\n    public scene: Scene,\n    private changeCallback: () => void\n  ) {\n    super(options, scene);\n\n    this.sizeStyle = {\n      height: '100%',\n      width: '100%',\n    };\n  }\n\n  isRoot(): this is RootElement {\n    return true;\n  }\n\n  // root type can not change\n  onChange(options: CanvasFrameOptions) {\n    this.revId++;\n    this.options = { ...options };\n    this.changeCallback();\n  }\n\n  getSaveModel(): CanvasFrameOptions {\n    const { placement, constraint, ...rest } = this.options;\n\n    return {\n      ...rest, // everything except placement & constraint\n      elements: this.elements.map((v) => v.getSaveModel()),\n    };\n  }\n\n  setRootRef = (target: HTMLDivElement) => {\n    this.div = target;\n  };\n\n  render() {\n    return (\n      <div\n        onContextMenu={(event) => event.preventDefault()}\n        key={this.UID}\n        ref={this.setRootRef}\n        style={{ ...this.sizeStyle, ...this.dataStyle }}\n      >\n        {this.elements.map((v) => v.render())}\n      </div>\n    );\n  }\n}\n","import { css } from '@emotion/css';\nimport Moveable from 'moveable';\nimport { createRef, CSSProperties, RefObject } from 'react';\nimport { ReactZoomPanPinchContentRef } from 'react-zoom-pan-pinch';\nimport { BehaviorSubject, ReplaySubject, Subject, Subscription } from 'rxjs';\nimport Selecto from 'selecto';\n\nimport { AppEvents, PanelData } from '@grafana/data';\nimport { locationService } from '@grafana/runtime/src';\nimport {\n  ColorDimensionConfig,\n  ResourceDimensionConfig,\n  ScalarDimensionConfig,\n  ScaleDimensionConfig,\n  TextDimensionConfig,\n} from '@grafana/schema';\nimport { Portal } from '@grafana/ui';\nimport { config } from 'app/core/config';\nimport { DimensionContext } from 'app/features/dimensions';\nimport {\n  getColorDimensionFromData,\n  getResourceDimensionFromData,\n  getScalarDimensionFromData,\n  getScaleDimensionFromData,\n  getTextDimensionFromData,\n} from 'app/features/dimensions/utils';\nimport { CanvasContextMenu } from 'app/plugins/panel/canvas/components/CanvasContextMenu';\nimport { CanvasTooltip } from 'app/plugins/panel/canvas/components/CanvasTooltip';\nimport { Connections } from 'app/plugins/panel/canvas/components/connections/Connections';\nimport { AnchorPoint, CanvasTooltipPayload } from 'app/plugins/panel/canvas/types';\nimport { getTransformInstance } from 'app/plugins/panel/canvas/utils';\n\nimport appEvents from '../../../core/app_events';\nimport { CanvasPanel } from '../../../plugins/panel/canvas/CanvasPanel';\nimport { CanvasFrameOptions } from '../frame';\nimport { DEFAULT_CANVAS_ELEMENT_CONFIG } from '../registry';\n\nimport { SceneTransformWrapper } from './SceneTransformWrapper';\nimport { ElementState } from './element';\nimport { FrameState } from './frame';\nimport { RootElement } from './root';\nimport { initMoveable } from './sceneAbleManagement';\nimport { findElementByTarget } from './sceneElementManagement';\n\nexport interface SelectionParams {\n  targets: Array<HTMLElement | SVGElement>;\n  frame?: FrameState;\n}\n\nexport class Scene {\n  styles = getStyles();\n  readonly selection = new ReplaySubject<ElementState[]>(1);\n  readonly moved = new Subject<number>(); // called after resize/drag for editor updates\n  readonly byName = new Map<string, ElementState>();\n\n  root: RootElement;\n\n  revId = 0;\n\n  width = 0;\n  height = 0;\n  scale = 1;\n  style: CSSProperties = {};\n  data?: PanelData;\n  selecto?: Selecto;\n  moveable?: Moveable;\n  div?: HTMLDivElement;\n  connections: Connections;\n  currentLayer?: FrameState;\n  isEditingEnabled?: boolean;\n  shouldShowAdvancedTypes?: boolean;\n  shouldPanZoom?: boolean;\n  shouldInfinitePan?: boolean;\n  skipNextSelectionBroadcast = false;\n  ignoreDataUpdate = false;\n  panel: CanvasPanel;\n  contextMenuVisible?: boolean;\n  contextMenuOnVisibilityChange = (visible: boolean) => {\n    this.contextMenuVisible = visible;\n    const transformInstance = getTransformInstance(this);\n    if (transformInstance) {\n      if (visible) {\n        transformInstance.setup.disabled = true;\n      } else {\n        transformInstance.setup.disabled = false;\n      }\n    }\n  };\n\n  isPanelEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  inlineEditingCallback?: () => void;\n  setBackgroundCallback?: (anchorPoint: AnchorPoint) => void;\n\n  tooltipCallback?: (tooltip: CanvasTooltipPayload | undefined) => void;\n  tooltip?: CanvasTooltipPayload;\n\n  moveableActionCallback?: (moved: boolean) => void;\n\n  readonly editModeEnabled = new BehaviorSubject<boolean>(false);\n  subscription: Subscription;\n\n  targetsToSelect = new Set<HTMLDivElement>();\n  transformComponentRef: RefObject<ReactZoomPanPinchContentRef> | undefined;\n\n  constructor(\n    cfg: CanvasFrameOptions,\n    enableEditing: boolean,\n    showAdvancedTypes: boolean,\n    panZoom: boolean,\n    infinitePan: boolean,\n    public onSave: (cfg: CanvasFrameOptions) => void,\n    panel: CanvasPanel\n  ) {\n    this.root = this.load(cfg, enableEditing, showAdvancedTypes, panZoom, infinitePan);\n\n    this.subscription = this.editModeEnabled.subscribe((open) => {\n      if (!this.moveable || !this.isEditingEnabled) {\n        return;\n      }\n      this.moveable.draggable = !open;\n    });\n\n    this.panel = panel;\n    this.connections = new Connections(this);\n    this.transformComponentRef = createRef();\n  }\n\n  getNextElementName = (isFrame = false) => {\n    const label = isFrame ? 'Frame' : 'Element';\n    let idx = this.byName.size + 1;\n\n    const max = idx + 100;\n    while (true && idx < max) {\n      const name = `${label} ${idx++}`;\n      if (!this.byName.has(name)) {\n        return name;\n      }\n    }\n\n    return `${label} ${Date.now()}`;\n  };\n\n  canRename = (v: string) => {\n    return !this.byName.has(v);\n  };\n\n  load(\n    cfg: CanvasFrameOptions,\n    enableEditing: boolean,\n    showAdvancedTypes: boolean,\n    panZoom: boolean,\n    infinitePan: boolean\n  ) {\n    this.root = new RootElement(\n      cfg ?? {\n        type: 'frame',\n        elements: [DEFAULT_CANVAS_ELEMENT_CONFIG],\n      },\n      this,\n      this.save // callback when changes are made\n    );\n\n    this.isEditingEnabled = enableEditing;\n    this.shouldShowAdvancedTypes = showAdvancedTypes;\n    this.shouldPanZoom = panZoom;\n    this.shouldInfinitePan = infinitePan;\n\n    setTimeout(() => {\n      if (this.div) {\n        // If editing is enabled, clear selecto instance\n        const destroySelecto = enableEditing;\n        initMoveable(destroySelecto, enableEditing, this);\n        this.currentLayer = this.root;\n        this.selection.next([]);\n        this.connections.select(undefined);\n        this.connections.updateState();\n      }\n    });\n    return this.root;\n  }\n\n  context: DimensionContext = {\n    getColor: (color: ColorDimensionConfig) => getColorDimensionFromData(this.data, color),\n    getScale: (scale: ScaleDimensionConfig) => getScaleDimensionFromData(this.data, scale),\n    getScalar: (scalar: ScalarDimensionConfig) => getScalarDimensionFromData(this.data, scalar),\n    getText: (text: TextDimensionConfig) => getTextDimensionFromData(this.data, text),\n    getResource: (res: ResourceDimensionConfig) => getResourceDimensionFromData(this.data, res),\n    getPanelData: () => this.data,\n  };\n\n  updateData(data: PanelData) {\n    this.data = data;\n    this.root.updateData(this.context);\n  }\n\n  updateSize(width: number, height: number) {\n    this.width = width;\n    this.height = height;\n    this.style = { width, height };\n\n    if (this.selecto?.getSelectedTargets().length) {\n      this.clearCurrentSelection();\n    }\n  }\n\n  clearCurrentSelection(skipNextSelectionBroadcast = false) {\n    this.skipNextSelectionBroadcast = skipNextSelectionBroadcast;\n    let event: MouseEvent = new MouseEvent('click');\n    this.selecto?.clickTarget(event, this.div);\n  }\n\n  save = (updateMoveable = false) => {\n    this.onSave(this.root.getSaveModel());\n\n    if (updateMoveable) {\n      setTimeout(() => {\n        if (this.div) {\n          initMoveable(true, this.isEditingEnabled, this);\n        }\n      });\n    }\n  };\n\n  setNonTargetPointerEvents = (target: Element, disablePointerEvents: boolean) => {\n    const stack = [...this.root.elements];\n    while (stack.length > 0) {\n      const currentElement = stack.shift();\n\n      if (currentElement && currentElement.div && currentElement.div !== target) {\n        currentElement.applyLayoutStylesToDiv(disablePointerEvents);\n      }\n\n      const nestedElements = currentElement instanceof FrameState ? currentElement.elements : [];\n      for (const nestedElement of nestedElements) {\n        stack.unshift(nestedElement);\n      }\n    }\n  };\n\n  setRef = (sceneContainer: HTMLDivElement) => {\n    this.div = sceneContainer;\n  };\n\n  select = (selection: SelectionParams) => {\n    if (this.selecto) {\n      this.selecto.setSelectedTargets(selection.targets);\n      this.updateSelection(selection);\n      this.editModeEnabled.next(false);\n\n      // Hide connection anchors on programmatic select\n      if (this.connections.connectionAnchorDiv) {\n        this.connections.connectionAnchorDiv.style.display = 'none';\n      }\n    }\n  };\n\n  updateSelection = (selection: SelectionParams) => {\n    this.moveable!.target = selection.targets;\n    if (this.skipNextSelectionBroadcast) {\n      this.skipNextSelectionBroadcast = false;\n      return;\n    }\n\n    if (selection.frame) {\n      this.selection.next([selection.frame]);\n    } else {\n      const s = selection.targets.map((t) => findElementByTarget(t, this.root.elements)!);\n      this.selection.next(s);\n    }\n  };\n\n  addToSelection = () => {\n    try {\n      let selection: SelectionParams = { targets: [] };\n      selection.targets = [...this.targetsToSelect];\n      this.select(selection);\n    } catch (error) {\n      appEvents.emit(AppEvents.alertError, ['Unable to add to selection']);\n    }\n  };\n\n  render() {\n    const hasDataLinks = this.tooltip?.element?.getLinks && this.tooltip.element.getLinks({}).length > 0;\n    const hasActions = this.tooltip?.element?.options.actions && this.tooltip.element.options.actions.length > 0;\n\n    const isTooltipValid = hasDataLinks || hasActions || this.tooltip?.element?.data?.field;\n    const canShowElementTooltip = !this.isEditingEnabled && isTooltipValid;\n\n    const sceneDiv = (\n      <div key={this.revId} className={this.styles.wrap} style={this.style} ref={this.setRef}>\n        {this.connections.render()}\n        {this.root.render()}\n        {this.isEditingEnabled && (\n          <Portal>\n            <CanvasContextMenu\n              scene={this}\n              panel={this.panel}\n              onVisibilityChange={this.contextMenuOnVisibilityChange}\n            />\n          </Portal>\n        )}\n        {canShowElementTooltip && (\n          <Portal>\n            <CanvasTooltip scene={this} />\n          </Portal>\n        )}\n      </div>\n    );\n\n    return config.featureToggles.canvasPanelPanZoom ? (\n      <SceneTransformWrapper scene={this}>{sceneDiv}</SceneTransformWrapper>\n    ) : (\n      sceneDiv\n    );\n  }\n}\n\nconst getStyles = () => ({\n  wrap: css({\n    overflow: 'hidden',\n    position: 'relative',\n  }),\n});\n","import { css } from '@emotion/css';\nimport { useState } from 'react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { ResourceDimensionMode } from '@grafana/schema';\nimport { Portal, useTheme2 } from '@grafana/ui';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { MediaType, ResourceFolderName } from 'app/features/dimensions';\nimport { ResourcePickerPopover } from 'app/features/dimensions/editors/ResourcePickerPopover';\n\nimport { AnchorPoint } from '../types';\n\ntype Props = {\n  onClose: () => void;\n  scene: Scene;\n  anchorPoint: AnchorPoint;\n};\n\nexport function SetBackground({ onClose, scene, anchorPoint }: Props) {\n  const defaultValue = scene.root.options.background?.image?.fixed ?? '';\n\n  const [bgImage, setBgImage] = useState(defaultValue);\n  const theme = useTheme2();\n  const styles = getStyles(theme, anchorPoint);\n\n  const onChange = (value: string | undefined) => {\n    if (value) {\n      setBgImage(value);\n      if (scene.root) {\n        scene.root.options.background = {\n          ...scene.root.options.background,\n          image: { mode: ResourceDimensionMode.Fixed, fixed: value },\n        };\n        scene.revId++;\n        scene.save();\n\n        scene.root.reinitializeMoveable();\n      }\n\n      // Force a re-render (update scene data after config update)\n      if (scene) {\n        scene.updateData(scene.data!);\n      }\n    }\n\n    onClose();\n  };\n\n  return (\n    <Portal className={styles.portalWrapper}>\n      <ResourcePickerPopover\n        onChange={onChange}\n        value={bgImage}\n        mediaType={MediaType.Image}\n        folderName={ResourceFolderName.IOT}\n      />\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2, anchorPoint: AnchorPoint) => ({\n  portalWrapper: css({\n    width: '315px',\n    height: '445px',\n    transform: `translate(${anchorPoint.x}px, ${anchorPoint.y - 200}px)`,\n  }),\n});\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { InlineField, InlineFieldRow, RadioButtonGroup } from '@grafana/ui/src';\nimport { BackgroundImageSize } from 'app/plugins/panel/canvas/panelcfg.gen';\n\nconst options: Array<SelectableValue<BackgroundImageSize>> = [\n  { value: BackgroundImageSize.Original, label: 'Original' },\n  { value: BackgroundImageSize.Contain, label: 'Contain' },\n  { value: BackgroundImageSize.Cover, label: 'Cover' },\n  { value: BackgroundImageSize.Fill, label: 'Fill' },\n  { value: BackgroundImageSize.Tile, label: 'Tile' },\n];\n\nexport const BackgroundSizeEditor = ({ value, onChange }: StandardEditorProps<string, undefined, undefined>) => {\n  const imageSize = value ?? BackgroundImageSize.Cover;\n\n  const onImageSizeChange = useCallback(\n    (size: string) => {\n      onChange(size);\n    },\n    [onChange]\n  );\n\n  return (\n    <InlineFieldRow>\n      <InlineField grow={true}>\n        <RadioButtonGroup value={imageSize} options={options} onChange={onImageSizeChange} fullWidth />\n      </InlineField>\n    </InlineFieldRow>\n  );\n};\n","import { useCallback } from 'react';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { Field, RadioButtonGroup, Switch } from '@grafana/ui/src';\n\nimport { LineStyle } from '../types';\n\nconst options: Array<SelectableValue<LineStyle>> = [\n  { value: LineStyle.Solid, label: 'Solid' },\n  { value: LineStyle.Dashed, label: 'Dashed' },\n  { value: LineStyle.Dotted, label: 'Dotted' },\n];\n\nexport interface LineStyleConfig {\n  style: LineStyle;\n  animate?: boolean;\n}\n\ntype Props = StandardEditorProps<LineStyleConfig>;\n\nexport const defaultLineStyleConfig: LineStyleConfig = {\n  style: LineStyle.Solid,\n  animate: false,\n};\n\nexport const LineStyleEditor = ({ value, onChange }: Props) => {\n  if (!value) {\n    value = defaultLineStyleConfig;\n  } else if (typeof value !== 'object') {\n    value = {\n      style: value,\n      animate: false,\n    };\n  }\n\n  const onLineStyleChange = useCallback(\n    (lineStyle: LineStyle) => {\n      onChange({ ...value, style: lineStyle });\n    },\n    [onChange, value]\n  );\n\n  const onAnimateChange = useCallback(\n    (animate: boolean) => {\n      onChange({ ...value, animate });\n    },\n    [onChange, value]\n  );\n\n  return (\n    <>\n      <RadioButtonGroup value={value.style} options={options} onChange={onLineStyleChange} fullWidth />\n      {value.style !== LineStyle.Solid && (\n        <>\n          <br />\n          <Field label=\"Animate\">\n            <Switch value={value.animate} onChange={(e) => onAnimateChange(e.currentTarget.checked)} />\n          </Field>\n        </>\n      )}\n    </>\n  );\n};\n","import { StandardEditorProps, OneClickMode, Action, VariableSuggestionsScope } from '@grafana/data';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\nimport { ActionsInlineEditor } from '../../../../../features/actions/ActionsInlineEditor';\n\ntype Props = StandardEditorProps<Action[], CanvasElementOptions>;\n\nexport function ActionsEditor({ value, onChange, item, context }: Props) {\n  const oneClickMode = item.settings?.oneClickMode;\n\n  return (\n    <ActionsInlineEditor\n      actions={value}\n      onChange={onChange}\n      getSuggestions={() => (context.getSuggestions ? context.getSuggestions(VariableSuggestionsScope.Values) : [])}\n      data={[]}\n      showOneClick={oneClickMode === OneClickMode.Action}\n    />\n  );\n}\n","import { StandardEditorProps, DataLink, VariableSuggestionsScope, OneClickMode } from '@grafana/data';\nimport { DataLinksInlineEditor } from '@grafana/ui';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\n\ntype Props = StandardEditorProps<DataLink[], CanvasElementOptions>;\n\nexport function DataLinksEditor({ value, onChange, item, context }: Props) {\n  const oneClickMode = item.settings?.oneClickMode;\n\n  return (\n    <DataLinksInlineEditor\n      links={value}\n      onChange={onChange}\n      getSuggestions={() => (context.getSuggestions ? context.getSuggestions(VariableSuggestionsScope.Values) : [])}\n      data={[]}\n      showOneClick={oneClickMode === OneClickMode.Link}\n    />\n  );\n}\n","import { capitalize } from 'lodash';\n\nimport { FieldType } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { config } from '@grafana/runtime';\nimport { ConnectionDirection } from 'app/features/canvas/element';\nimport { SVGElements } from 'app/features/canvas/runtime/element';\nimport { ColorDimensionEditor, ResourceDimensionEditor, ScaleDimensionEditor } from 'app/features/dimensions/editors';\nimport { BackgroundSizeEditor } from 'app/features/dimensions/editors/BackgroundSizeEditor';\n\nimport { CanvasConnection, CanvasElementOptions } from '../panelcfg.gen';\nimport { LineStyle } from '../types';\n\nimport { LineStyleEditor } from './LineStyleEditor';\nimport { ActionsEditor } from './element/ActionsEditor';\nimport { DataLinksEditor } from './element/DataLinksEditor';\n\ninterface OptionSuppliers {\n  addBackground: PanelOptionsSupplier<CanvasElementOptions>;\n  addBorder: PanelOptionsSupplier<CanvasElementOptions>;\n  addDataLinks: PanelOptionsSupplier<CanvasElementOptions>;\n  addActions: PanelOptionsSupplier<CanvasElementOptions>;\n  addColor: PanelOptionsSupplier<CanvasConnection>;\n  addSize: PanelOptionsSupplier<CanvasConnection>;\n  addRadius: PanelOptionsSupplier<CanvasConnection>;\n  addDirection: PanelOptionsSupplier<CanvasConnection>;\n  addLineStyle: PanelOptionsSupplier<CanvasConnection>;\n}\n\nconst getCategoryName = (str: string, type: string | undefined) => {\n  if (type !== 'frame' && type !== undefined) {\n    return [str + ` (${type})`];\n  }\n  return [str];\n};\n\nexport const optionBuilder: OptionSuppliers = {\n  addBackground: (builder, context) => {\n    const category = getCategoryName('Background', context.options?.type);\n    builder\n      .addCustomEditor({\n        category,\n        id: 'background.color',\n        path: 'background.color',\n        name: 'Color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.image',\n        path: 'background.image',\n        name: 'Image',\n        editor: ResourceDimensionEditor,\n        settings: {\n          resourceType: 'image',\n        },\n      })\n      .addCustomEditor({\n        category,\n        id: 'background.size',\n        path: 'background.size',\n        name: 'Image size',\n        editor: BackgroundSizeEditor,\n        settings: {\n          resourceType: 'image',\n        },\n        showIf: () => {\n          // Do not show image size editor for SVG based elements\n          // See https://github.com/grafana/grafana/issues/84843#issuecomment-2010921066 for additional context\n          if (context.options?.type) {\n            return !SVGElements.has(context.options.type);\n          }\n\n          return true;\n        },\n      });\n  },\n\n  addBorder: (builder, context) => {\n    const category = getCategoryName('Border', context.options?.type);\n    builder.addSliderInput({\n      category,\n      path: 'border.width',\n      name: 'Width',\n      defaultValue: 2,\n      settings: {\n        min: 0,\n        max: 20,\n      },\n    });\n\n    if (context.options?.border?.width) {\n      builder.addCustomEditor({\n        category,\n        id: 'border.color',\n        path: 'border.color',\n        name: 'Color',\n        editor: ColorDimensionEditor,\n        settings: {},\n        defaultValue: {\n          // Configured values\n          fixed: '',\n        },\n      });\n    }\n\n    builder.addSliderInput({\n      category,\n      path: 'border.radius',\n      name: 'Radius',\n      defaultValue: 0,\n      settings: {\n        min: 0,\n        max: 60,\n      },\n    });\n  },\n\n  addColor: (builder, context) => {\n    const category = ['Color'];\n    builder.addCustomEditor({\n      category,\n      id: 'color',\n      path: 'color',\n      name: 'Color',\n      editor: ColorDimensionEditor,\n      settings: {},\n      defaultValue: {\n        // Configured values\n        fixed: '',\n      },\n    });\n  },\n\n  addSize: (builder, context) => {\n    const category = ['Size'];\n    builder.addCustomEditor({\n      category,\n      id: 'size',\n      path: 'size',\n      name: 'Size',\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 1,\n        max: 10,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 2,\n        min: 1,\n        max: 10,\n      },\n    });\n  },\n\n  addRadius: (builder, context) => {\n    const category = ['Radius'];\n    builder.addCustomEditor({\n      category,\n      id: 'radius',\n      path: 'radius',\n      name: 'Radius',\n      editor: ScaleDimensionEditor,\n      settings: {\n        min: 0,\n        max: 200,\n        filteredFieldType: FieldType.number,\n      },\n      defaultValue: {\n        // Configured values\n        fixed: 0,\n        min: 0,\n        max: 100,\n      },\n    });\n  },\n\n  addDirection: (builder, context) => {\n    const category = ['Arrow Direction'];\n    builder.addRadio({\n      category,\n      path: 'direction',\n      name: 'Direction',\n      settings: {\n        options: [\n          { value: undefined, label: capitalize(ConnectionDirection.Forward) },\n          { value: ConnectionDirection.Reverse, label: capitalize(ConnectionDirection.Reverse) },\n          { value: ConnectionDirection.Both, label: capitalize(ConnectionDirection.Both) },\n          { value: ConnectionDirection.None, label: capitalize(ConnectionDirection.None) },\n        ],\n      },\n      defaultValue: ConnectionDirection.Forward,\n    });\n  },\n\n  addLineStyle: (builder, context) => {\n    const category = ['Line style'];\n    builder.addCustomEditor({\n      category,\n      id: 'lineStyle',\n      path: 'lineStyle',\n      name: 'Line style',\n      editor: LineStyleEditor,\n      settings: {},\n      defaultValue: { value: LineStyle.Solid, label: 'Solid' },\n    });\n  },\n\n  addDataLinks: (builder, context) => {\n    builder.addCustomEditor({\n      category: config.featureToggles.vizActions ? ['Data links and actions'] : ['Data links'],\n      id: 'dataLinks',\n      path: 'links',\n      name: 'Links',\n      editor: DataLinksEditor,\n      settings: context.options,\n    });\n  },\n\n  addActions: (builder, context) => {\n    builder.addCustomEditor({\n      category: ['Data links and actions'],\n      id: 'actions',\n      path: 'actions',\n      name: 'Actions',\n      editor: ActionsEditor,\n      settings: context.options,\n      showIf: () => config.featureToggles.vizActions,\n    });\n  },\n};\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { CanvasConnection } from '../panelcfg.gen';\nimport { ConnectionState } from '../types';\n\nimport { optionBuilder } from './options';\n\nexport interface CanvasConnectionEditorOptions {\n  connection: ConnectionState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport function getConnectionEditor(opts: CanvasConnectionEditorOptions): NestedPanelOptions<CanvasConnection> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path: string) => {\n        return lodashGet(opts.connection.info, path);\n      },\n      // TODO: Fix this unknown (maybe a dimension supplier?)\n      onChange: (path: string, value: unknown) => {\n        let options = opts.connection.info;\n        options = setOptionImmutably(options, path, value);\n        opts.scene.connections.onChange(opts.connection, options);\n      },\n    }),\n\n    build: (builder, context) => {\n      const ctx = { ...context, options: opts.connection.info };\n      optionBuilder.addColor(builder, ctx);\n      optionBuilder.addSize(builder, ctx);\n      optionBuilder.addRadius(builder, ctx);\n      optionBuilder.addDirection(builder, ctx);\n      optionBuilder.addLineStyle(builder, ctx);\n    },\n  };\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { useStyles2 } from '@grafana/ui';\n\nimport { VerticalConstraint, HorizontalConstraint, Constraint } from '../../panelcfg.gen';\n\ninterface Props {\n  onVerticalConstraintChange: (v: VerticalConstraint) => void;\n  onHorizontalConstraintChange: (h: HorizontalConstraint) => void;\n  currentConstraints: Constraint;\n}\n\nexport const ConstraintSelectionBox = ({\n  onVerticalConstraintChange,\n  onHorizontalConstraintChange,\n  currentConstraints,\n}: Props) => {\n  const styles = useStyles2(getStyles(currentConstraints));\n\n  const onClickTopConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Top);\n  };\n\n  const onClickBottomConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Bottom);\n  };\n\n  const onClickVerticalCenterConstraint = () => {\n    onVerticalConstraintChange(VerticalConstraint.Center);\n  };\n\n  const onClickLeftConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Left);\n  };\n\n  const onClickRightConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Right);\n  };\n\n  const onClickHorizontalCenterConstraint = () => {\n    onHorizontalConstraintChange(HorizontalConstraint.Center);\n  };\n\n  return (\n    <svg\n      version=\"1.0\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"75.000000pt\"\n      height=\"75.000000pt\"\n      viewBox=\"0 0 228.000000 228.000000\"\n      preserveAspectRatio=\"xMidYMid meet\"\n      style={{ marginBottom: '4.8px' }}\n    >\n      <g transform=\"translate(0.000000,228.000000) scale(0.100000,-0.100000)\" fill=\"#000000\" stroke=\"none\">\n        <path\n          fill=\"#e5e5e5\"\n          d=\"M198 2028 l-28 -32 0 -912 0 -912 31 -31 31 -31 915 0 915 0 29 29\n29 29 0 917 0 917 -27 29 -28 29 -920 0 -920 0 -27 -32z m1876 -17 c15 -16 16\n-98 16 -927 0 -860 -1 -909 -18 -926 -17 -17 -66 -18 -927 -18 -862 0 -910 1\n-927 18 -17 17 -18 65 -18 926 0 832 1 911 16 927 16 18 45 19 468 21 248 2\n659 2 912 0 431 -2 462 -4 478 -21z\"\n        />\n        <rect className={styles.topConstraint} height=\"228\" width=\"46\" y=\"1735\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickTopConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"1680\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.bottomConstraint} height=\"228\" width=\"46\" y=\"210\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickBottomConstraint}\n          height=\"350\"\n          width=\"300\"\n          y=\"135\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.leftConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"265\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickLeftConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"200\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.rightConstraint} height=\"46\" width=\"228\" y=\"1060\" x=\"1795\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickRightConstraint}\n          height=\"300\"\n          width=\"350\"\n          y=\"925\"\n          x=\"1730\"\n          fill=\"transparent\"\n        />\n        <path\n          className={styles.box}\n          d=\"M568 1669 c-17 -9 -18 -48 -18 -584 0 -558 1 -575 19 -585 27 -14\n1125 -14 1152 0 18 10 19 27 19 580 0 504 -2 570 -16 584 -14 14 -80 16 -577\n16 -363 -1 -568 -4 -579 -11z m1119 -42 c4 -5 4 -1079 0 -1084 -5 -4 -1079 -4\n-1084 0 -5 6 -4 1077 1 1085 4 7 1076 6 1083 -1z\"\n        />\n        <rect className={styles.verticalCenterConstraint} height=\"456\" width=\"46\" y=\"855\" x=\"1123\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickVerticalCenterConstraint}\n          height=\"660\"\n          width=\"300\"\n          y=\"750\"\n          x=\"995\"\n          fill=\"transparent\"\n        />\n        <rect className={styles.horizontalCenterConstraint} height=\"46\" width=\"456\" y=\"1060\" x=\"918\" />\n        <rect\n          className={styles.constraintHover}\n          onClick={onClickHorizontalCenterConstraint}\n          height=\"300\"\n          width=\"660\"\n          y=\"925\"\n          x=\"815\"\n          fill=\"transparent\"\n        />\n      </g>\n    </svg>\n  );\n};\n\nconst getStyles = (currentConstraints: Constraint) => (theme: GrafanaTheme2) => {\n  const HOVER_COLOR = '#daebf7';\n  const HOVER_OPACITY = '0.6';\n  const SELECTED_COLOR = '#0d99ff';\n\n  const selectionBoxColor = theme.isDark ? '#ffffff' : '#000000';\n\n  return {\n    constraintHover: css({\n      '&:hover': {\n        fill: HOVER_COLOR,\n        fillOpacity: HOVER_OPACITY,\n      },\n    }),\n    topConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Top ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    bottomConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Bottom ||\n      currentConstraints.vertical === VerticalConstraint.TopBottom\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    leftConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Left ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    rightConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Right ||\n      currentConstraints.horizontal === HorizontalConstraint.LeftRight\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    horizontalCenterConstraint: css({\n      ...(currentConstraints.horizontal === HorizontalConstraint.Center\n        ? {\n            height: '92pt',\n            y: '1014',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    verticalCenterConstraint: css({\n      ...(currentConstraints.vertical === VerticalConstraint.Center\n        ? {\n            width: '92pt',\n            x: '1085',\n            fill: SELECTED_COLOR,\n          }\n        : {\n            fill: selectionBoxColor,\n          }),\n    }),\n    box: css({\n      fill: selectionBoxColor,\n    }),\n  };\n};\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data/src';\nimport { IconButton, useStyles2 } from '@grafana/ui/src';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { QuickPlacement } from 'app/features/canvas/types';\n\nimport { HorizontalConstraint, VerticalConstraint, Placement } from '../../panelcfg.gen';\n\nimport { CanvasEditorOptions } from './elementEditor';\n\ntype Props = {\n  onPositionChange: (value: number | undefined, placement: keyof Placement) => void;\n  element: ElementState;\n  settings: CanvasEditorOptions;\n};\n\nexport const QuickPositioning = ({ onPositionChange, element, settings }: Props) => {\n  const styles = useStyles2(getStyles);\n\n  const onQuickPositioningChange = (position: QuickPlacement) => {\n    const defaultConstraint = { vertical: VerticalConstraint.Top, horizontal: HorizontalConstraint.Left };\n    const originalConstraint = { ...element.options.constraint };\n\n    element.options.constraint = defaultConstraint;\n    element.setPlacementFromConstraint();\n\n    switch (position) {\n      case QuickPlacement.Top:\n        onPositionChange(0, 'top');\n        break;\n      case QuickPlacement.Bottom:\n        onPositionChange(getRightBottomPosition(element.options.placement?.height ?? 0, 'bottom'), 'top');\n        break;\n      case QuickPlacement.VerticalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.height ?? 0, 'v'), 'top');\n        break;\n      case QuickPlacement.Left:\n        onPositionChange(0, 'left');\n        break;\n      case QuickPlacement.Right:\n        onPositionChange(getRightBottomPosition(element.options.placement?.width ?? 0, 'right'), 'left');\n        break;\n      case QuickPlacement.HorizontalCenter:\n        onPositionChange(getCenterPosition(element.options.placement?.width ?? 0, 'h'), 'left');\n        break;\n    }\n\n    element.options.constraint = originalConstraint;\n    element.setPlacementFromConstraint();\n  };\n\n  // Basing this on scene will mean that center is based on root for the time being\n  const getCenterPosition = (elementSize: number, align: 'h' | 'v') => {\n    const sceneSize = align === 'h' ? settings.scene.width : settings.scene.height;\n\n    return (sceneSize - elementSize) / 2;\n  };\n\n  const getRightBottomPosition = (elementSize: number, align: 'right' | 'bottom') => {\n    const sceneSize = align === 'right' ? settings.scene.width : settings.scene.height;\n\n    return sceneSize - elementSize;\n  };\n\n  return (\n    <div className={styles.buttonGroup}>\n      <IconButton\n        name=\"horizontal-align-left\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Left)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align left\"\n      />\n      <IconButton\n        name=\"horizontal-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.HorizontalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align horizontal centers\"\n      />\n      <IconButton\n        name=\"horizontal-align-right\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Right)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align right\"\n      />\n      <IconButton\n        name=\"vertical-align-top\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Top)}\n        size=\"lg\"\n        tooltip=\"Align top\"\n      />\n      <IconButton\n        name=\"vertical-align-center\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.VerticalCenter)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align vertical centers\"\n      />\n      <IconButton\n        name=\"vertical-align-bottom\"\n        onClick={() => onQuickPositioningChange(QuickPlacement.Bottom)}\n        className={styles.button}\n        size=\"lg\"\n        tooltip=\"Align bottom\"\n      />\n    </div>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  buttonGroup: css({\n    display: 'flex',\n    flexWrap: 'wrap',\n    padding: '12px 0 12px 0',\n  }),\n  button: css({\n    marginLeft: '5px',\n    marginRight: '5px',\n  }),\n});\n","import { useObservable } from 'react-use';\nimport { Subject } from 'rxjs';\n\nimport { SelectableValue, StandardEditorProps } from '@grafana/data';\nimport { Field, Icon, InlineField, InlineFieldRow, Select, Stack } from '@grafana/ui';\nimport { NumberInput } from 'app/core/components/OptionsUI/NumberInput';\n\nimport { HorizontalConstraint, Options, Placement, VerticalConstraint } from '../../panelcfg.gen';\n\nimport { ConstraintSelectionBox } from './ConstraintSelectionBox';\nimport { QuickPositioning } from './QuickPositioning';\nimport { CanvasEditorOptions } from './elementEditor';\n\nconst places: Array<keyof Placement> = ['top', 'left', 'bottom', 'right', 'width', 'height', 'rotation'];\n\nconst horizontalOptions: Array<SelectableValue<HorizontalConstraint>> = [\n  { label: 'Left', value: HorizontalConstraint.Left },\n  { label: 'Right', value: HorizontalConstraint.Right },\n  { label: 'Left & right', value: HorizontalConstraint.LeftRight },\n  { label: 'Center', value: HorizontalConstraint.Center },\n  { label: 'Scale', value: HorizontalConstraint.Scale },\n];\n\nconst verticalOptions: Array<SelectableValue<VerticalConstraint>> = [\n  { label: 'Top', value: VerticalConstraint.Top },\n  { label: 'Bottom', value: VerticalConstraint.Bottom },\n  { label: 'Top & bottom', value: VerticalConstraint.TopBottom },\n  { label: 'Center', value: VerticalConstraint.Center },\n  { label: 'Scale', value: VerticalConstraint.Scale },\n];\n\ntype Props = StandardEditorProps<unknown, CanvasEditorOptions, Options>;\n\nexport function PlacementEditor({ item }: Props) {\n  const settings = item.settings;\n\n  // Will force a rerender whenever the subject changes\n  useObservable(settings?.scene ? settings.scene.moved : new Subject());\n\n  if (!settings) {\n    return <div>Loading...</div>;\n  }\n\n  const element = settings.element;\n  if (!element) {\n    return <div>???</div>;\n  }\n  const { options } = element;\n  const { placement, constraint: layout } = options;\n\n  if (placement) {\n    placement.rotation = placement?.rotation ?? 0;\n  }\n\n  const reselectElementAfterChange = () => {\n    setTimeout(() => {\n      settings.scene.select({ targets: [element.div!] });\n    });\n  };\n\n  const onHorizontalConstraintSelect = (h: SelectableValue<HorizontalConstraint>) => {\n    onHorizontalConstraintChange(h.value!);\n  };\n\n  const onHorizontalConstraintChange = (h: HorizontalConstraint) => {\n    element.options.constraint!.horizontal = h;\n    element.setPlacementFromConstraint();\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onVerticalConstraintSelect = (v: SelectableValue<VerticalConstraint>) => {\n    onVerticalConstraintChange(v.value!);\n  };\n\n  const onVerticalConstraintChange = (v: VerticalConstraint) => {\n    element.options.constraint!.vertical = v;\n    element.setPlacementFromConstraint();\n    settings.scene.revId++;\n    settings.scene.save(true);\n    reselectElementAfterChange();\n  };\n\n  const onPositionChange = (value: number | undefined, placement: keyof Placement) => {\n    element.options.placement![placement] = value ?? element.options.placement![placement];\n    element.applyLayoutStylesToDiv();\n    settings.scene.clearCurrentSelection(true);\n    reselectElementAfterChange();\n  };\n\n  const constraint = element.tempConstraint ?? layout ?? {};\n\n  return (\n    <div>\n      <QuickPositioning onPositionChange={onPositionChange} settings={settings} element={element} />\n      <br />\n      <Field label=\"Constraints\">\n        <Stack direction=\"row\">\n          <ConstraintSelectionBox\n            onVerticalConstraintChange={onVerticalConstraintChange}\n            onHorizontalConstraintChange={onHorizontalConstraintChange}\n            currentConstraints={constraint}\n          />\n          <Stack direction=\"column\">\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-h\" />\n              <Select\n                options={horizontalOptions}\n                onChange={onHorizontalConstraintSelect}\n                value={constraint.horizontal}\n              />\n            </Stack>\n            <Stack direction=\"row\">\n              <Icon name=\"arrows-v\" />\n              <Select options={verticalOptions} onChange={onVerticalConstraintSelect} value={constraint.vertical} />\n            </Stack>\n          </Stack>\n        </Stack>\n      </Field>\n\n      <br />\n\n      <Field label=\"Position\">\n        <>\n          {places.map((p) => {\n            const v = placement![p];\n            if (v == null) {\n              return null;\n            }\n\n            // Need to set explicit min/max for rotation as logic only can handle 0-360\n            const min = p === 'rotation' ? 0 : undefined;\n            const max = p === 'rotation' ? 360 : undefined;\n\n            return (\n              <InlineFieldRow key={p}>\n                <InlineField label={p} labelWidth={8} grow={true}>\n                  <NumberInput min={min} max={max} value={v} onChange={(v) => onPositionChange(v, p)} />\n                </InlineField>\n              </InlineFieldRow>\n            );\n          })}\n        </>\n      </Field>\n    </div>\n  );\n}\n","import { capitalize, get as lodashGet } from 'lodash';\n\nimport { OneClickMode } from '@grafana/data';\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { config } from '@grafana/runtime';\nimport { CanvasElementOptions } from 'app/features/canvas/element';\nimport {\n  canvasElementRegistry,\n  DEFAULT_CANVAS_ELEMENT_CONFIG,\n  defaultElementItems,\n} from 'app/features/canvas/registry';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { getElementTypes } from '../../utils';\nimport { optionBuilder } from '../options';\n\nimport { PlacementEditor } from './PlacementEditor';\n\nexport interface CanvasEditorOptions {\n  element: ElementState;\n  scene: Scene;\n  category?: string[];\n}\n\nexport interface TreeViewEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getElementEditor(opts: CanvasEditorOptions): NestedPanelOptions<CanvasElementOptions> {\n  return {\n    category: opts.category,\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(opts.element.options, path);\n      },\n      onChange: (path, value) => {\n        let options = opts.element.options;\n        if (path === 'type' && value) {\n          const layer = canvasElementRegistry.getIfExists(value);\n          if (!layer) {\n            console.warn('layer does not exist', value);\n            return;\n          }\n          options = {\n            ...options,\n            ...layer.getNewOptions(options),\n            type: layer.id,\n          };\n        } else {\n          options = setOptionImmutably(options, path, value);\n        }\n        opts.element.onChange(options);\n        opts.element.updateData(opts.scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const { options } = opts.element;\n      const current = options?.type ? options.type : DEFAULT_CANVAS_ELEMENT_CONFIG.type;\n      const layerTypes = getElementTypes(opts.scene.shouldShowAdvancedTypes, current).options;\n\n      const actionsEnabled = config.featureToggles.vizActions;\n\n      const isUnsupported =\n        !opts.scene.shouldShowAdvancedTypes && !defaultElementItems.filter((item) => item.id === options?.type).length;\n\n      builder.addSelect({\n        path: 'type',\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n        name: undefined as any, // required, but hide space\n        settings: {\n          options: layerTypes,\n        },\n        description: isUnsupported\n          ? 'Selected element type is not supported by current settings. Please enable advanced element types.'\n          : '',\n      });\n\n      // force clean layer configuration\n      const layer = canvasElementRegistry.getIfExists(options?.type ?? DEFAULT_CANVAS_ELEMENT_CONFIG.type)!;\n      let currentOptions = options;\n      if (!currentOptions) {\n        currentOptions = {\n          ...layer.getNewOptions(options),\n          type: layer.id,\n          name: `Element ${Date.now()}.${Math.floor(Math.random() * 100)}`,\n        };\n      }\n      const ctx = { ...context, options: currentOptions };\n\n      if (layer?.registerOptionsUI) {\n        layer.registerOptionsUI(builder, ctx);\n      }\n\n      const shouldAddLayoutEditor = opts.element.item.standardEditorConfig?.layout ?? true;\n      if (shouldAddLayoutEditor) {\n        builder.addCustomEditor({\n          category: ['Layout'],\n          id: 'content',\n          path: '__', // not used\n          name: 'Quick placement',\n          editor: PlacementEditor,\n          settings: opts,\n        });\n      }\n\n      const shouldAddBackgroundEditor = opts.element.item.standardEditorConfig?.background ?? true;\n      if (shouldAddBackgroundEditor) {\n        optionBuilder.addBackground(builder, ctx);\n      }\n\n      const shouldAddBorderEditor = opts.element.item.standardEditorConfig?.border ?? true;\n      if (shouldAddBorderEditor) {\n        optionBuilder.addBorder(builder, ctx);\n      }\n\n      const oneClickModeOptions = [\n        { value: OneClickMode.Off, label: capitalize(OneClickMode.Off) },\n        { value: OneClickMode.Link, label: capitalize(OneClickMode.Link) },\n      ];\n\n      let oneClickCategory = 'Data links';\n      let oneClickDescription = 'When enabled, a single click opens the first link';\n\n      if (actionsEnabled) {\n        oneClickModeOptions.push({ value: OneClickMode.Action, label: capitalize(OneClickMode.Action) });\n        oneClickCategory += ' and actions';\n        oneClickDescription += ' or action';\n      }\n\n      builder.addRadio({\n        category: [oneClickCategory],\n        path: 'oneClickMode',\n        name: 'One-click',\n        description: oneClickDescription,\n        settings: {\n          options: oneClickModeOptions,\n        },\n        defaultValue: OneClickMode.Off,\n      });\n\n      optionBuilder.addDataLinks(builder, ctx);\n      optionBuilder.addActions(builder, ctx);\n    },\n  };\n}\n","/**\n * Webpack has bug for import loop, which is not the same behavior as ES module.\n * When util.js imports the TreeNode for tree generate will cause treeContextTypes be empty.\n */\nimport * as React from 'react';\nexport var TreeContext = /*#__PURE__*/React.createContext(null);","import * as React from 'react';\nexport default function DropIndicator(_ref) {\n  var dropPosition = _ref.dropPosition,\n    dropLevelOffset = _ref.dropLevelOffset,\n    indent = _ref.indent;\n  var style = {\n    pointerEvents: 'none',\n    position: 'absolute',\n    right: 0,\n    backgroundColor: 'red',\n    height: 2\n  };\n  switch (dropPosition) {\n    case -1:\n      style.top = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 1:\n      style.bottom = 0;\n      style.left = -dropLevelOffset * indent;\n      break;\n    case 0:\n      style.bottom = 0;\n      style.left = indent;\n      break;\n  }\n  return /*#__PURE__*/React.createElement(\"div\", {\n    style: style\n  });\n}","function _objectDestructuringEmpty(t) {\n  if (null == t) throw new TypeError(\"Cannot destructure \" + t);\n}\nexport { _objectDestructuringEmpty as default };","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport classNames from 'classnames';\nimport * as React from 'react';\nvar Indent = function Indent(_ref) {\n  var prefixCls = _ref.prefixCls,\n    level = _ref.level,\n    isStart = _ref.isStart,\n    isEnd = _ref.isEnd;\n  var baseClassName = \"\".concat(prefixCls, \"-indent-unit\");\n  var list = [];\n  for (var i = 0; i < level; i += 1) {\n    list.push( /*#__PURE__*/React.createElement(\"span\", {\n      key: i,\n      className: classNames(baseClassName, _defineProperty(_defineProperty({}, \"\".concat(baseClassName, \"-start\"), isStart[i]), \"\".concat(baseClassName, \"-end\"), isEnd[i]))\n    }));\n  }\n  return /*#__PURE__*/React.createElement(\"span\", {\n    \"aria-hidden\": \"true\",\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, list);\n};\nexport default /*#__PURE__*/React.memo(Indent);","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _excluded = [\"eventKey\", \"className\", \"style\", \"dragOver\", \"dragOverGapTop\", \"dragOverGapBottom\", \"isLeaf\", \"isStart\", \"isEnd\", \"expanded\", \"selected\", \"checked\", \"halfChecked\", \"loading\", \"domRef\", \"active\", \"data\", \"onMouseMove\", \"selectable\"];\nimport classNames from 'classnames';\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport * as React from 'react';\n// @ts-ignore\nimport { TreeContext } from \"./contextTypes\";\nimport Indent from \"./Indent\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertNodePropsToEventData } from \"./utils/treeUtil\";\nvar ICON_OPEN = 'open';\nvar ICON_CLOSE = 'close';\nvar defaultTitle = '---';\nvar InternalTreeNode = /*#__PURE__*/function (_React$Component) {\n  _inherits(InternalTreeNode, _React$Component);\n  var _super = _createSuper(InternalTreeNode);\n  function InternalTreeNode() {\n    var _this;\n    _classCallCheck(this, InternalTreeNode);\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(args));\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      dragNodeHighlight: false\n    });\n    _defineProperty(_assertThisInitialized(_this), \"selectHandle\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"cacheIndent\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"onSelectorClick\", function (e) {\n      // Click trigger before select/check operation\n      var onNodeClick = _this.props.context.onNodeClick;\n      onNodeClick(e, convertNodePropsToEventData(_this.props));\n      if (_this.isSelectable()) {\n        _this.onSelect(e);\n      } else {\n        _this.onCheck(e);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onSelectorDoubleClick\", function (e) {\n      var onNodeDoubleClick = _this.props.context.onNodeDoubleClick;\n      onNodeDoubleClick(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onSelect\", function (e) {\n      if (_this.isDisabled()) return;\n      var onNodeSelect = _this.props.context.onNodeSelect;\n      onNodeSelect(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onCheck\", function (e) {\n      if (_this.isDisabled()) return;\n      var _this$props = _this.props,\n        disableCheckbox = _this$props.disableCheckbox,\n        checked = _this$props.checked;\n      var onNodeCheck = _this.props.context.onNodeCheck;\n      if (!_this.isCheckable() || disableCheckbox) return;\n      var targetChecked = !checked;\n      onNodeCheck(e, convertNodePropsToEventData(_this.props), targetChecked);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onMouseEnter\", function (e) {\n      var onNodeMouseEnter = _this.props.context.onNodeMouseEnter;\n      onNodeMouseEnter(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onMouseLeave\", function (e) {\n      var onNodeMouseLeave = _this.props.context.onNodeMouseLeave;\n      onNodeMouseLeave(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onContextMenu\", function (e) {\n      var onNodeContextMenu = _this.props.context.onNodeContextMenu;\n      onNodeContextMenu(e, convertNodePropsToEventData(_this.props));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragStart\", function (e) {\n      var onNodeDragStart = _this.props.context.onNodeDragStart;\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: true\n      });\n      onNodeDragStart(e, _assertThisInitialized(_this));\n      try {\n        // ie throw error\n        // firefox-need-it\n        e.dataTransfer.setData('text/plain', '');\n      } catch (error) {\n        // empty\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragEnter\", function (e) {\n      var onNodeDragEnter = _this.props.context.onNodeDragEnter;\n      e.preventDefault();\n      e.stopPropagation();\n      onNodeDragEnter(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragOver\", function (e) {\n      var onNodeDragOver = _this.props.context.onNodeDragOver;\n      e.preventDefault();\n      e.stopPropagation();\n      onNodeDragOver(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragLeave\", function (e) {\n      var onNodeDragLeave = _this.props.context.onNodeDragLeave;\n      e.stopPropagation();\n      onNodeDragLeave(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDragEnd\", function (e) {\n      var onNodeDragEnd = _this.props.context.onNodeDragEnd;\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: false\n      });\n      onNodeDragEnd(e, _assertThisInitialized(_this));\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onDrop\", function (e) {\n      var onNodeDrop = _this.props.context.onNodeDrop;\n      e.preventDefault();\n      e.stopPropagation();\n      _this.setState({\n        dragNodeHighlight: false\n      });\n      onNodeDrop(e, _assertThisInitialized(_this));\n    });\n    // Disabled item still can be switch\n    _defineProperty(_assertThisInitialized(_this), \"onExpand\", function (e) {\n      var _this$props2 = _this.props,\n        loading = _this$props2.loading,\n        onNodeExpand = _this$props2.context.onNodeExpand;\n      if (loading) return;\n      onNodeExpand(e, convertNodePropsToEventData(_this.props));\n    });\n    // Drag usage\n    _defineProperty(_assertThisInitialized(_this), \"setSelectHandle\", function (node) {\n      _this.selectHandle = node;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getNodeState\", function () {\n      var expanded = _this.props.expanded;\n      if (_this.isLeaf()) {\n        return null;\n      }\n      return expanded ? ICON_OPEN : ICON_CLOSE;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"hasChildren\", function () {\n      var eventKey = _this.props.eventKey;\n      var keyEntities = _this.props.context.keyEntities;\n      var _ref = getEntity(keyEntities, eventKey) || {},\n        children = _ref.children;\n      return !!(children || []).length;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isLeaf\", function () {\n      var _this$props3 = _this.props,\n        isLeaf = _this$props3.isLeaf,\n        loaded = _this$props3.loaded;\n      var loadData = _this.props.context.loadData;\n      var hasChildren = _this.hasChildren();\n      if (isLeaf === false) {\n        return false;\n      }\n      return isLeaf || !loadData && !hasChildren || loadData && loaded && !hasChildren;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isDisabled\", function () {\n      var disabled = _this.props.disabled;\n      var treeDisabled = _this.props.context.disabled;\n      return !!(treeDisabled || disabled);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isCheckable\", function () {\n      var checkable = _this.props.checkable;\n      var treeCheckable = _this.props.context.checkable;\n\n      // Return false if tree or treeNode is not checkable\n      if (!treeCheckable || checkable === false) return false;\n      return treeCheckable;\n    });\n    // Load data to avoid default expanded tree without data\n    _defineProperty(_assertThisInitialized(_this), \"syncLoadData\", function (props) {\n      var expanded = props.expanded,\n        loading = props.loading,\n        loaded = props.loaded;\n      var _this$props$context = _this.props.context,\n        loadData = _this$props$context.loadData,\n        onNodeLoad = _this$props$context.onNodeLoad;\n      if (loading) {\n        return;\n      }\n\n      // read from state to avoid loadData at same time\n      if (loadData && expanded && !_this.isLeaf() && !loaded) {\n        // We needn't reload data when has children in sync logic\n        // It's only needed in node expanded\n        onNodeLoad(convertNodePropsToEventData(_this.props));\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"isDraggable\", function () {\n      var _this$props4 = _this.props,\n        data = _this$props4.data,\n        draggable = _this$props4.context.draggable;\n      return !!(draggable && (!draggable.nodeDraggable || draggable.nodeDraggable(data)));\n    });\n    // ==================== Render: Drag Handler ====================\n    _defineProperty(_assertThisInitialized(_this), \"renderDragHandler\", function () {\n      var _this$props$context2 = _this.props.context,\n        draggable = _this$props$context2.draggable,\n        prefixCls = _this$props$context2.prefixCls;\n      return draggable !== null && draggable !== void 0 && draggable.icon ? /*#__PURE__*/React.createElement(\"span\", {\n        className: \"\".concat(prefixCls, \"-draggable-icon\")\n      }, draggable.icon) : null;\n    });\n    // ====================== Render: Switcher ======================\n    _defineProperty(_assertThisInitialized(_this), \"renderSwitcherIconDom\", function (isLeaf) {\n      var switcherIconFromProps = _this.props.switcherIcon;\n      var switcherIconFromCtx = _this.props.context.switcherIcon;\n      var switcherIcon = switcherIconFromProps || switcherIconFromCtx;\n      // if switcherIconDom is null, no render switcher span\n      if (typeof switcherIcon === 'function') {\n        return switcherIcon(_objectSpread(_objectSpread({}, _this.props), {}, {\n          isLeaf: isLeaf\n        }));\n      }\n      return switcherIcon;\n    });\n    // Switcher\n    _defineProperty(_assertThisInitialized(_this), \"renderSwitcher\", function () {\n      var expanded = _this.props.expanded;\n      var prefixCls = _this.props.context.prefixCls;\n      if (_this.isLeaf()) {\n        // if switcherIconDom is null, no render switcher span\n        var _switcherIconDom = _this.renderSwitcherIconDom(true);\n        return _switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n          className: classNames(\"\".concat(prefixCls, \"-switcher\"), \"\".concat(prefixCls, \"-switcher-noop\"))\n        }, _switcherIconDom) : null;\n      }\n      var switcherCls = classNames(\"\".concat(prefixCls, \"-switcher\"), \"\".concat(prefixCls, \"-switcher_\").concat(expanded ? ICON_OPEN : ICON_CLOSE));\n      var switcherIconDom = _this.renderSwitcherIconDom(false);\n      return switcherIconDom !== false ? /*#__PURE__*/React.createElement(\"span\", {\n        onClick: _this.onExpand,\n        className: switcherCls\n      }, switcherIconDom) : null;\n    });\n    // ====================== Render: Checkbox ======================\n    // Checkbox\n    _defineProperty(_assertThisInitialized(_this), \"renderCheckbox\", function () {\n      var _this$props5 = _this.props,\n        checked = _this$props5.checked,\n        halfChecked = _this$props5.halfChecked,\n        disableCheckbox = _this$props5.disableCheckbox;\n      var prefixCls = _this.props.context.prefixCls;\n      var disabled = _this.isDisabled();\n      var checkable = _this.isCheckable();\n      if (!checkable) return null;\n\n      // [Legacy] Custom element should be separate with `checkable` in future\n      var $custom = typeof checkable !== 'boolean' ? checkable : null;\n      return /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(prefixCls, \"-checkbox\"), checked && \"\".concat(prefixCls, \"-checkbox-checked\"), !checked && halfChecked && \"\".concat(prefixCls, \"-checkbox-indeterminate\"), (disabled || disableCheckbox) && \"\".concat(prefixCls, \"-checkbox-disabled\")),\n        onClick: _this.onCheck\n      }, $custom);\n    });\n    // ==================== Render: Title + Icon ====================\n    _defineProperty(_assertThisInitialized(_this), \"renderIcon\", function () {\n      var loading = _this.props.loading;\n      var prefixCls = _this.props.context.prefixCls;\n      return /*#__PURE__*/React.createElement(\"span\", {\n        className: classNames(\"\".concat(prefixCls, \"-iconEle\"), \"\".concat(prefixCls, \"-icon__\").concat(_this.getNodeState() || 'docu'), loading && \"\".concat(prefixCls, \"-icon_loading\"))\n      });\n    });\n    // Icon + Title\n    _defineProperty(_assertThisInitialized(_this), \"renderSelector\", function () {\n      var dragNodeHighlight = _this.state.dragNodeHighlight;\n      var _this$props6 = _this.props,\n        _this$props6$title = _this$props6.title,\n        title = _this$props6$title === void 0 ? defaultTitle : _this$props6$title,\n        selected = _this$props6.selected,\n        icon = _this$props6.icon,\n        loading = _this$props6.loading,\n        data = _this$props6.data;\n      var _this$props$context3 = _this.props.context,\n        prefixCls = _this$props$context3.prefixCls,\n        showIcon = _this$props$context3.showIcon,\n        treeIcon = _this$props$context3.icon,\n        loadData = _this$props$context3.loadData,\n        titleRender = _this$props$context3.titleRender;\n      var disabled = _this.isDisabled();\n      var wrapClass = \"\".concat(prefixCls, \"-node-content-wrapper\");\n\n      // Icon - Still show loading icon when loading without showIcon\n      var $icon;\n      if (showIcon) {\n        var currentIcon = icon || treeIcon;\n        $icon = currentIcon ? /*#__PURE__*/React.createElement(\"span\", {\n          className: classNames(\"\".concat(prefixCls, \"-iconEle\"), \"\".concat(prefixCls, \"-icon__customize\"))\n        }, typeof currentIcon === 'function' ? currentIcon(_this.props) : currentIcon) : _this.renderIcon();\n      } else if (loadData && loading) {\n        $icon = _this.renderIcon();\n      }\n\n      // Title\n      var titleNode;\n      if (typeof title === 'function') {\n        titleNode = title(data);\n      } else if (titleRender) {\n        titleNode = titleRender(data);\n      } else {\n        titleNode = title;\n      }\n      var $title = /*#__PURE__*/React.createElement(\"span\", {\n        className: \"\".concat(prefixCls, \"-title\")\n      }, titleNode);\n      return /*#__PURE__*/React.createElement(\"span\", {\n        ref: _this.setSelectHandle,\n        title: typeof title === 'string' ? title : '',\n        className: classNames(\"\".concat(wrapClass), \"\".concat(wrapClass, \"-\").concat(_this.getNodeState() || 'normal'), !disabled && (selected || dragNodeHighlight) && \"\".concat(prefixCls, \"-node-selected\")),\n        onMouseEnter: _this.onMouseEnter,\n        onMouseLeave: _this.onMouseLeave,\n        onContextMenu: _this.onContextMenu,\n        onClick: _this.onSelectorClick,\n        onDoubleClick: _this.onSelectorDoubleClick\n      }, $icon, $title, _this.renderDropIndicator());\n    });\n    // =================== Render: Drop Indicator ===================\n    _defineProperty(_assertThisInitialized(_this), \"renderDropIndicator\", function () {\n      var _this$props7 = _this.props,\n        disabled = _this$props7.disabled,\n        eventKey = _this$props7.eventKey;\n      var _this$props$context4 = _this.props.context,\n        draggable = _this$props$context4.draggable,\n        dropLevelOffset = _this$props$context4.dropLevelOffset,\n        dropPosition = _this$props$context4.dropPosition,\n        prefixCls = _this$props$context4.prefixCls,\n        indent = _this$props$context4.indent,\n        dropIndicatorRender = _this$props$context4.dropIndicatorRender,\n        dragOverNodeKey = _this$props$context4.dragOverNodeKey,\n        direction = _this$props$context4.direction;\n      var rootDraggable = !!draggable;\n      // allowDrop is calculated in Tree.tsx, there is no need for calc it here\n      var showIndicator = !disabled && rootDraggable && dragOverNodeKey === eventKey;\n\n      // This is a hot fix which is already fixed in\n      // https://github.com/react-component/tree/pull/743/files\n      // But some case need break point so we hack on this\n      // ref https://github.com/ant-design/ant-design/issues/43493\n      var mergedIndent = indent !== null && indent !== void 0 ? indent : _this.cacheIndent;\n      _this.cacheIndent = indent;\n      return showIndicator ? dropIndicatorRender({\n        dropPosition: dropPosition,\n        dropLevelOffset: dropLevelOffset,\n        indent: mergedIndent,\n        prefixCls: prefixCls,\n        direction: direction\n      }) : null;\n    });\n    return _this;\n  }\n  _createClass(InternalTreeNode, [{\n    key: \"componentDidMount\",\n    value:\n    // Isomorphic needn't load data in server side\n    function componentDidMount() {\n      this.syncLoadData(this.props);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.syncLoadData(this.props);\n    }\n  }, {\n    key: \"isSelectable\",\n    value: function isSelectable() {\n      var selectable = this.props.selectable;\n      var treeSelectable = this.props.context.selectable;\n\n      // Ignore when selectable is undefined or null\n      if (typeof selectable === 'boolean') {\n        return selectable;\n      }\n      return treeSelectable;\n    }\n  }, {\n    key: \"render\",\n    value:\n    // =========================== Render ===========================\n    function render() {\n      var _classNames;\n      var _this$props8 = this.props,\n        eventKey = _this$props8.eventKey,\n        className = _this$props8.className,\n        style = _this$props8.style,\n        dragOver = _this$props8.dragOver,\n        dragOverGapTop = _this$props8.dragOverGapTop,\n        dragOverGapBottom = _this$props8.dragOverGapBottom,\n        isLeaf = _this$props8.isLeaf,\n        isStart = _this$props8.isStart,\n        isEnd = _this$props8.isEnd,\n        expanded = _this$props8.expanded,\n        selected = _this$props8.selected,\n        checked = _this$props8.checked,\n        halfChecked = _this$props8.halfChecked,\n        loading = _this$props8.loading,\n        domRef = _this$props8.domRef,\n        active = _this$props8.active,\n        data = _this$props8.data,\n        onMouseMove = _this$props8.onMouseMove,\n        selectable = _this$props8.selectable,\n        otherProps = _objectWithoutProperties(_this$props8, _excluded);\n      var _this$props$context5 = this.props.context,\n        prefixCls = _this$props$context5.prefixCls,\n        filterTreeNode = _this$props$context5.filterTreeNode,\n        keyEntities = _this$props$context5.keyEntities,\n        dropContainerKey = _this$props$context5.dropContainerKey,\n        dropTargetKey = _this$props$context5.dropTargetKey,\n        draggingNodeKey = _this$props$context5.draggingNodeKey;\n      var disabled = this.isDisabled();\n      var dataOrAriaAttributeProps = pickAttrs(otherProps, {\n        aria: true,\n        data: true\n      });\n      var _ref2 = getEntity(keyEntities, eventKey) || {},\n        level = _ref2.level;\n      var isEndNode = isEnd[isEnd.length - 1];\n      var mergedDraggable = this.isDraggable();\n      var draggableWithoutDisabled = !disabled && mergedDraggable;\n      var dragging = draggingNodeKey === eventKey;\n      var ariaSelected = selectable !== undefined ? {\n        'aria-selected': !!selectable\n      } : undefined;\n      return /*#__PURE__*/React.createElement(\"div\", _extends({\n        ref: domRef,\n        className: classNames(className, \"\".concat(prefixCls, \"-treenode\"), (_classNames = {}, _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames, \"\".concat(prefixCls, \"-treenode-disabled\"), disabled), \"\".concat(prefixCls, \"-treenode-switcher-\").concat(expanded ? 'open' : 'close'), !isLeaf), \"\".concat(prefixCls, \"-treenode-checkbox-checked\"), checked), \"\".concat(prefixCls, \"-treenode-checkbox-indeterminate\"), halfChecked), \"\".concat(prefixCls, \"-treenode-selected\"), selected), \"\".concat(prefixCls, \"-treenode-loading\"), loading), \"\".concat(prefixCls, \"-treenode-active\"), active), \"\".concat(prefixCls, \"-treenode-leaf-last\"), isEndNode), \"\".concat(prefixCls, \"-treenode-draggable\"), mergedDraggable), \"dragging\", dragging), _defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_classNames, 'drop-target', dropTargetKey === eventKey), 'drop-container', dropContainerKey === eventKey), 'drag-over', !disabled && dragOver), 'drag-over-gap-top', !disabled && dragOverGapTop), 'drag-over-gap-bottom', !disabled && dragOverGapBottom), 'filter-node', filterTreeNode && filterTreeNode(convertNodePropsToEventData(this.props))))),\n        style: style\n        // Draggable config\n        ,\n        draggable: draggableWithoutDisabled,\n        \"aria-grabbed\": dragging,\n        onDragStart: draggableWithoutDisabled ? this.onDragStart : undefined\n        // Drop config\n        ,\n        onDragEnter: mergedDraggable ? this.onDragEnter : undefined,\n        onDragOver: mergedDraggable ? this.onDragOver : undefined,\n        onDragLeave: mergedDraggable ? this.onDragLeave : undefined,\n        onDrop: mergedDraggable ? this.onDrop : undefined,\n        onDragEnd: mergedDraggable ? this.onDragEnd : undefined,\n        onMouseMove: onMouseMove\n      }, ariaSelected, dataOrAriaAttributeProps), /*#__PURE__*/React.createElement(Indent, {\n        prefixCls: prefixCls,\n        level: level,\n        isStart: isStart,\n        isEnd: isEnd\n      }), this.renderDragHandler(), this.renderSwitcher(), this.renderCheckbox(), this.renderSelector());\n    }\n  }]);\n  return InternalTreeNode;\n}(React.Component);\nvar ContextTreeNode = function ContextTreeNode(props) {\n  return /*#__PURE__*/React.createElement(TreeContext.Consumer, null, function (context) {\n    return /*#__PURE__*/React.createElement(InternalTreeNode, _extends({}, props, {\n      context: context\n    }));\n  });\n};\nContextTreeNode.displayName = 'TreeNode';\nContextTreeNode.isTreeNode = 1;\nexport default ContextTreeNode;","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\n\n/**\n * Trigger only when component unmount\n */\nexport default function useUnmount(triggerStart, triggerEnd) {\n  var _React$useState = React.useState(false),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    firstMount = _React$useState2[0],\n    setFirstMount = _React$useState2[1];\n  useLayoutEffect(function () {\n    if (firstMount) {\n      triggerStart();\n      return function () {\n        triggerEnd();\n      };\n    }\n  }, [firstMount]);\n  useLayoutEffect(function () {\n    setFirstMount(true);\n    return function () {\n      setFirstMount(false);\n    };\n  }, []);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"className\", \"style\", \"motion\", \"motionNodes\", \"motionType\", \"onMotionStart\", \"onMotionEnd\", \"active\", \"treeNodeRequiredProps\"];\nimport classNames from 'classnames';\nimport CSSMotion from 'rc-motion';\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport TreeNode from \"./TreeNode\";\nimport useUnmount from \"./useUnmount\";\nimport { getTreeNodeProps } from \"./utils/treeUtil\";\nvar MotionTreeNode = function MotionTreeNode(_ref, ref) {\n  var className = _ref.className,\n    style = _ref.style,\n    motion = _ref.motion,\n    motionNodes = _ref.motionNodes,\n    motionType = _ref.motionType,\n    onOriginMotionStart = _ref.onMotionStart,\n    onOriginMotionEnd = _ref.onMotionEnd,\n    active = _ref.active,\n    treeNodeRequiredProps = _ref.treeNodeRequiredProps,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _React$useState = React.useState(true),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    visible = _React$useState2[0],\n    setVisible = _React$useState2[1];\n  var _React$useContext = React.useContext(TreeContext),\n    prefixCls = _React$useContext.prefixCls;\n\n  // Calculate target visible here.\n  // And apply in effect to make `leave` motion work.\n  var targetVisible = motionNodes && motionType !== 'hide';\n  useLayoutEffect(function () {\n    if (motionNodes) {\n      if (targetVisible !== visible) {\n        setVisible(targetVisible);\n      }\n    }\n  }, [motionNodes]);\n  var triggerMotionStart = function triggerMotionStart() {\n    if (motionNodes) {\n      onOriginMotionStart();\n    }\n  };\n\n  // Should only trigger once\n  var triggerMotionEndRef = React.useRef(false);\n  var triggerMotionEnd = function triggerMotionEnd() {\n    if (motionNodes && !triggerMotionEndRef.current) {\n      triggerMotionEndRef.current = true;\n      onOriginMotionEnd();\n    }\n  };\n\n  // Effect if unmount\n  useUnmount(triggerMotionStart, triggerMotionEnd);\n\n  // Motion end event\n  var onVisibleChanged = function onVisibleChanged(nextVisible) {\n    if (targetVisible === nextVisible) {\n      triggerMotionEnd();\n    }\n  };\n  if (motionNodes) {\n    return /*#__PURE__*/React.createElement(CSSMotion, _extends({\n      ref: ref,\n      visible: visible\n    }, motion, {\n      motionAppear: motionType === 'show',\n      onVisibleChanged: onVisibleChanged\n    }), function (_ref2, motionRef) {\n      var motionClassName = _ref2.className,\n        motionStyle = _ref2.style;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        ref: motionRef,\n        className: classNames(\"\".concat(prefixCls, \"-treenode-motion\"), motionClassName),\n        style: motionStyle\n      }, motionNodes.map(function (treeNode) {\n        var restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n          title = treeNode.title,\n          key = treeNode.key,\n          isStart = treeNode.isStart,\n          isEnd = treeNode.isEnd;\n        delete restProps.children;\n        var treeNodeProps = getTreeNodeProps(key, treeNodeRequiredProps);\n        return /*#__PURE__*/React.createElement(TreeNode, _extends({}, restProps, treeNodeProps, {\n          title: title,\n          active: active,\n          data: treeNode.data,\n          key: key,\n          isStart: isStart,\n          isEnd: isEnd\n        }));\n      }));\n    });\n  }\n  return /*#__PURE__*/React.createElement(TreeNode, _extends({\n    domRef: ref,\n    className: className,\n    style: style\n  }, props, {\n    active: active\n  }));\n};\nMotionTreeNode.displayName = 'MotionTreeNode';\nvar RefMotionTreeNode = /*#__PURE__*/React.forwardRef(MotionTreeNode);\nexport default RefMotionTreeNode;","export function findExpandedKeys() {\n  var prev = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var next = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var prevLen = prev.length;\n  var nextLen = next.length;\n  if (Math.abs(prevLen - nextLen) !== 1) {\n    return {\n      add: false,\n      key: null\n    };\n  }\n  function find(shorter, longer) {\n    var cache = new Map();\n    shorter.forEach(function (key) {\n      cache.set(key, true);\n    });\n    var keys = longer.filter(function (key) {\n      return !cache.has(key);\n    });\n    return keys.length === 1 ? keys[0] : null;\n  }\n  if (prevLen < nextLen) {\n    return {\n      add: true,\n      key: find(prev, next)\n    };\n  }\n  return {\n    add: false,\n    key: find(next, prev)\n  };\n}\nexport function getExpandRange(shorter, longer, key) {\n  var shorterStartIndex = shorter.findIndex(function (data) {\n    return data.key === key;\n  });\n  var shorterEndNode = shorter[shorterStartIndex + 1];\n  var longerStartIndex = longer.findIndex(function (data) {\n    return data.key === key;\n  });\n  if (shorterEndNode) {\n    var longerEndIndex = longer.findIndex(function (data) {\n      return data.key === shorterEndNode.key;\n    });\n    return longer.slice(longerStartIndex + 1, longerEndIndex);\n  }\n  return longer.slice(longerStartIndex + 1);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectDestructuringEmpty from \"@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"prefixCls\", \"data\", \"selectable\", \"checkable\", \"expandedKeys\", \"selectedKeys\", \"checkedKeys\", \"loadedKeys\", \"loadingKeys\", \"halfCheckedKeys\", \"keyEntities\", \"disabled\", \"dragging\", \"dragOverNodeKey\", \"dropPosition\", \"motion\", \"height\", \"itemHeight\", \"virtual\", \"focusable\", \"activeItem\", \"focused\", \"tabIndex\", \"onKeyDown\", \"onFocus\", \"onBlur\", \"onActiveChange\", \"onListChangeStart\", \"onListChangeEnd\"];\n/**\n * Handle virtual list of the TreeNodes.\n */\n\nimport useLayoutEffect from \"rc-util/es/hooks/useLayoutEffect\";\nimport VirtualList from 'rc-virtual-list';\nimport * as React from 'react';\nimport MotionTreeNode from \"./MotionTreeNode\";\nimport { findExpandedKeys, getExpandRange } from \"./utils/diffUtil\";\nimport { getKey, getTreeNodeProps } from \"./utils/treeUtil\";\nvar HIDDEN_STYLE = {\n  width: 0,\n  height: 0,\n  display: 'flex',\n  overflow: 'hidden',\n  opacity: 0,\n  border: 0,\n  padding: 0,\n  margin: 0\n};\nvar noop = function noop() {};\nexport var MOTION_KEY = \"RC_TREE_MOTION_\".concat(Math.random());\nvar MotionNode = {\n  key: MOTION_KEY\n};\nexport var MotionEntity = {\n  key: MOTION_KEY,\n  level: 0,\n  index: 0,\n  pos: '0',\n  node: MotionNode,\n  nodes: [MotionNode]\n};\nvar MotionFlattenData = {\n  parent: null,\n  children: [],\n  pos: MotionEntity.pos,\n  data: MotionNode,\n  title: null,\n  key: MOTION_KEY,\n  /** Hold empty list here since we do not use it */\n  isStart: [],\n  isEnd: []\n};\n/**\n * We only need get visible content items to play the animation.\n */\nexport function getMinimumRangeTransitionRange(list, virtual, height, itemHeight) {\n  if (virtual === false || !height) {\n    return list;\n  }\n  return list.slice(0, Math.ceil(height / itemHeight) + 1);\n}\nfunction itemKey(item) {\n  var key = item.key,\n    pos = item.pos;\n  return getKey(key, pos);\n}\nfunction getAccessibilityPath(item) {\n  var path = String(item.data.key);\n  var current = item;\n  while (current.parent) {\n    current = current.parent;\n    path = \"\".concat(current.data.key, \" > \").concat(path);\n  }\n  return path;\n}\nvar NodeList = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var prefixCls = props.prefixCls,\n    data = props.data,\n    selectable = props.selectable,\n    checkable = props.checkable,\n    expandedKeys = props.expandedKeys,\n    selectedKeys = props.selectedKeys,\n    checkedKeys = props.checkedKeys,\n    loadedKeys = props.loadedKeys,\n    loadingKeys = props.loadingKeys,\n    halfCheckedKeys = props.halfCheckedKeys,\n    keyEntities = props.keyEntities,\n    disabled = props.disabled,\n    dragging = props.dragging,\n    dragOverNodeKey = props.dragOverNodeKey,\n    dropPosition = props.dropPosition,\n    motion = props.motion,\n    height = props.height,\n    itemHeight = props.itemHeight,\n    virtual = props.virtual,\n    focusable = props.focusable,\n    activeItem = props.activeItem,\n    focused = props.focused,\n    tabIndex = props.tabIndex,\n    onKeyDown = props.onKeyDown,\n    onFocus = props.onFocus,\n    onBlur = props.onBlur,\n    onActiveChange = props.onActiveChange,\n    onListChangeStart = props.onListChangeStart,\n    onListChangeEnd = props.onListChangeEnd,\n    domProps = _objectWithoutProperties(props, _excluded);\n\n  // =============================== Ref ================================\n  var listRef = React.useRef(null);\n  var indentMeasurerRef = React.useRef(null);\n  React.useImperativeHandle(ref, function () {\n    return {\n      scrollTo: function scrollTo(scroll) {\n        listRef.current.scrollTo(scroll);\n      },\n      getIndentWidth: function getIndentWidth() {\n        return indentMeasurerRef.current.offsetWidth;\n      }\n    };\n  });\n\n  // ============================== Motion ==============================\n  var _React$useState = React.useState(expandedKeys),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    prevExpandedKeys = _React$useState2[0],\n    setPrevExpandedKeys = _React$useState2[1];\n  var _React$useState3 = React.useState(data),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    prevData = _React$useState4[0],\n    setPrevData = _React$useState4[1];\n  var _React$useState5 = React.useState(data),\n    _React$useState6 = _slicedToArray(_React$useState5, 2),\n    transitionData = _React$useState6[0],\n    setTransitionData = _React$useState6[1];\n  var _React$useState7 = React.useState([]),\n    _React$useState8 = _slicedToArray(_React$useState7, 2),\n    transitionRange = _React$useState8[0],\n    setTransitionRange = _React$useState8[1];\n  var _React$useState9 = React.useState(null),\n    _React$useState10 = _slicedToArray(_React$useState9, 2),\n    motionType = _React$useState10[0],\n    setMotionType = _React$useState10[1];\n\n  // When motion end but data change, this will makes data back to previous one\n  var dataRef = React.useRef(data);\n  dataRef.current = data;\n  function onMotionEnd() {\n    var latestData = dataRef.current;\n    setPrevData(latestData);\n    setTransitionData(latestData);\n    setTransitionRange([]);\n    setMotionType(null);\n    onListChangeEnd();\n  }\n\n  // Do animation if expanded keys changed\n  // layoutEffect here to avoid blink of node removing\n  useLayoutEffect(function () {\n    setPrevExpandedKeys(expandedKeys);\n    var diffExpanded = findExpandedKeys(prevExpandedKeys, expandedKeys);\n    if (diffExpanded.key !== null) {\n      if (diffExpanded.add) {\n        var keyIndex = prevData.findIndex(function (_ref) {\n          var key = _ref.key;\n          return key === diffExpanded.key;\n        });\n        var rangeNodes = getMinimumRangeTransitionRange(getExpandRange(prevData, data, diffExpanded.key), virtual, height, itemHeight);\n        var newTransitionData = prevData.slice();\n        newTransitionData.splice(keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(newTransitionData);\n        setTransitionRange(rangeNodes);\n        setMotionType('show');\n      } else {\n        var _keyIndex = data.findIndex(function (_ref2) {\n          var key = _ref2.key;\n          return key === diffExpanded.key;\n        });\n        var _rangeNodes = getMinimumRangeTransitionRange(getExpandRange(data, prevData, diffExpanded.key), virtual, height, itemHeight);\n        var _newTransitionData = data.slice();\n        _newTransitionData.splice(_keyIndex + 1, 0, MotionFlattenData);\n        setTransitionData(_newTransitionData);\n        setTransitionRange(_rangeNodes);\n        setMotionType('hide');\n      }\n    } else if (prevData !== data) {\n      // If whole data changed, we just refresh the list\n      setPrevData(data);\n      setTransitionData(data);\n    }\n  }, [expandedKeys, data]);\n\n  // We should clean up motion if is changed by dragging\n  React.useEffect(function () {\n    if (!dragging) {\n      onMotionEnd();\n    }\n  }, [dragging]);\n  var mergedData = motion ? transitionData : data;\n  var treeNodeRequiredProps = {\n    expandedKeys: expandedKeys,\n    selectedKeys: selectedKeys,\n    loadedKeys: loadedKeys,\n    loadingKeys: loadingKeys,\n    checkedKeys: checkedKeys,\n    halfCheckedKeys: halfCheckedKeys,\n    dragOverNodeKey: dragOverNodeKey,\n    dropPosition: dropPosition,\n    keyEntities: keyEntities\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, focused && activeItem && /*#__PURE__*/React.createElement(\"span\", {\n    style: HIDDEN_STYLE,\n    \"aria-live\": \"assertive\"\n  }, getAccessibilityPath(activeItem)), /*#__PURE__*/React.createElement(\"div\", null, /*#__PURE__*/React.createElement(\"input\", {\n    style: HIDDEN_STYLE,\n    disabled: focusable === false || disabled,\n    tabIndex: focusable !== false ? tabIndex : null,\n    onKeyDown: onKeyDown,\n    onFocus: onFocus,\n    onBlur: onBlur,\n    value: \"\",\n    onChange: noop,\n    \"aria-label\": \"for screen reader\"\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-treenode\"),\n    \"aria-hidden\": true,\n    style: {\n      position: 'absolute',\n      pointerEvents: 'none',\n      visibility: 'hidden',\n      height: 0,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-indent\")\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    ref: indentMeasurerRef,\n    className: \"\".concat(prefixCls, \"-indent-unit\")\n  }))), /*#__PURE__*/React.createElement(VirtualList, _extends({}, domProps, {\n    data: mergedData,\n    itemKey: itemKey,\n    height: height,\n    fullHeight: false,\n    virtual: virtual,\n    itemHeight: itemHeight,\n    prefixCls: \"\".concat(prefixCls, \"-list\"),\n    ref: listRef,\n    onVisibleChange: function onVisibleChange(originList) {\n      // The best match is using `fullList` - `originList` = `restList`\n      // and check the `restList` to see if has the MOTION_KEY node\n      // but this will cause performance issue for long list compare\n      // we just check `originList` and repeat trigger `onMotionEnd`\n      if (originList.every(function (item) {\n        return itemKey(item) !== MOTION_KEY;\n      })) {\n        onMotionEnd();\n      }\n    }\n  }), function (treeNode) {\n    var pos = treeNode.pos,\n      restProps = Object.assign({}, (_objectDestructuringEmpty(treeNode.data), treeNode.data)),\n      title = treeNode.title,\n      key = treeNode.key,\n      isStart = treeNode.isStart,\n      isEnd = treeNode.isEnd;\n    var mergedKey = getKey(key, pos);\n    delete restProps.key;\n    delete restProps.children;\n    var treeNodeProps = getTreeNodeProps(mergedKey, treeNodeRequiredProps);\n    return /*#__PURE__*/React.createElement(MotionTreeNode, _extends({}, restProps, treeNodeProps, {\n      title: title,\n      active: !!activeItem && key === activeItem.key,\n      pos: pos,\n      data: treeNode.data,\n      isStart: isStart,\n      isEnd: isEnd,\n      motion: motion,\n      motionNodes: key === MOTION_KEY ? transitionRange : null,\n      motionType: motionType,\n      onMotionStart: onListChangeStart,\n      onMotionEnd: onMotionEnd,\n      treeNodeRequiredProps: treeNodeRequiredProps,\n      onMouseMove: function onMouseMove() {\n        onActiveChange(null);\n      }\n    }));\n  }));\n});\nNodeList.displayName = 'NodeList';\nexport default NodeList;","import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"children\"];\n/* eslint-disable no-lonely-if */\n/**\n * Legacy code. Should avoid to use if you are new to import these code.\n */\n\nimport warning from \"rc-util/es/warning\";\nimport React from 'react';\nimport TreeNode from \"./TreeNode\";\nimport getEntity from \"./utils/keyUtil\";\nexport { getPosition, isTreeNode } from \"./utils/treeUtil\";\nexport function arrDel(list, value) {\n  if (!list) return [];\n  var clone = list.slice();\n  var index = clone.indexOf(value);\n  if (index >= 0) {\n    clone.splice(index, 1);\n  }\n  return clone;\n}\nexport function arrAdd(list, value) {\n  var clone = (list || []).slice();\n  if (clone.indexOf(value) === -1) {\n    clone.push(value);\n  }\n  return clone;\n}\nexport function posToArr(pos) {\n  return pos.split('-');\n}\nexport function getDragChildrenKeys(dragNodeKey, keyEntities) {\n  // not contains self\n  // self for left or right drag\n  var dragChildrenKeys = [];\n  var entity = getEntity(keyEntities, dragNodeKey);\n  function dig() {\n    var list = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    list.forEach(function (_ref) {\n      var key = _ref.key,\n        children = _ref.children;\n      dragChildrenKeys.push(key);\n      dig(children);\n    });\n  }\n  dig(entity.children);\n  return dragChildrenKeys;\n}\nexport function isLastChild(treeNodeEntity) {\n  if (treeNodeEntity.parent) {\n    var posArr = posToArr(treeNodeEntity.pos);\n    return Number(posArr[posArr.length - 1]) === treeNodeEntity.parent.children.length - 1;\n  }\n  return false;\n}\nexport function isFirstChild(treeNodeEntity) {\n  var posArr = posToArr(treeNodeEntity.pos);\n  return Number(posArr[posArr.length - 1]) === 0;\n}\n\n// Only used when drag, not affect SSR.\nexport function calcDropPosition(event, dragNode, targetNode, indent, startMousePosition, allowDrop, flattenedNodes, keyEntities, expandKeys, direction) {\n  var _abstractDropNodeEnti;\n  var clientX = event.clientX,\n    clientY = event.clientY;\n  var _getBoundingClientRec = event.target.getBoundingClientRect(),\n    top = _getBoundingClientRec.top,\n    height = _getBoundingClientRec.height;\n  // optional chain for testing\n  var horizontalMouseOffset = (direction === 'rtl' ? -1 : 1) * (((startMousePosition === null || startMousePosition === void 0 ? void 0 : startMousePosition.x) || 0) - clientX);\n  var rawDropLevelOffset = (horizontalMouseOffset - 12) / indent;\n\n  // Filter the expanded keys to exclude the node that not has children currently (like async nodes).\n  var filteredExpandKeys = expandKeys.filter(function (key) {\n    var _keyEntities$key;\n    return (_keyEntities$key = keyEntities[key]) === null || _keyEntities$key === void 0 || (_keyEntities$key = _keyEntities$key.children) === null || _keyEntities$key === void 0 ? void 0 : _keyEntities$key.length;\n  });\n\n  // find abstract drop node by horizontal offset\n  var abstractDropNodeEntity = getEntity(keyEntities, targetNode.props.eventKey);\n  if (clientY < top + height / 2) {\n    // first half, set abstract drop node to previous node\n    var nodeIndex = flattenedNodes.findIndex(function (flattenedNode) {\n      return flattenedNode.key === abstractDropNodeEntity.key;\n    });\n    var prevNodeIndex = nodeIndex <= 0 ? 0 : nodeIndex - 1;\n    var prevNodeKey = flattenedNodes[prevNodeIndex].key;\n    abstractDropNodeEntity = getEntity(keyEntities, prevNodeKey);\n  }\n  var initialAbstractDropNodeKey = abstractDropNodeEntity.key;\n  var abstractDragOverEntity = abstractDropNodeEntity;\n  var dragOverNodeKey = abstractDropNodeEntity.key;\n  var dropPosition = 0;\n  var dropLevelOffset = 0;\n\n  // Only allow cross level drop when dragging on a non-expanded node\n  if (!filteredExpandKeys.includes(initialAbstractDropNodeKey)) {\n    for (var i = 0; i < rawDropLevelOffset; i += 1) {\n      if (isLastChild(abstractDropNodeEntity)) {\n        abstractDropNodeEntity = abstractDropNodeEntity.parent;\n        dropLevelOffset += 1;\n      } else {\n        break;\n      }\n    }\n  }\n  var abstractDragDataNode = dragNode.props.data;\n  var abstractDropDataNode = abstractDropNodeEntity.node;\n  var dropAllowed = true;\n  if (isFirstChild(abstractDropNodeEntity) && abstractDropNodeEntity.level === 0 && clientY < top + height / 2 && allowDrop({\n    dragNode: abstractDragDataNode,\n    dropNode: abstractDropDataNode,\n    dropPosition: -1\n  }) && abstractDropNodeEntity.key === targetNode.props.eventKey) {\n    // first half of first node in first level\n    dropPosition = -1;\n  } else if ((abstractDragOverEntity.children || []).length && filteredExpandKeys.includes(dragOverNodeKey)) {\n    // drop on expanded node\n    // only allow drop inside\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 0\n    })) {\n      dropPosition = 0;\n    } else {\n      dropAllowed = false;\n    }\n  } else if (dropLevelOffset === 0) {\n    if (rawDropLevelOffset > -1.5) {\n      // | Node     | <- abstractDropNode\n      // | -^-===== | <- mousePosition\n      // 1. try drop after\n      // 2. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    } else {\n      // | Node     | <- abstractDropNode\n      // | ---==^== | <- mousePosition\n      // whether it has children or doesn't has children\n      // always\n      // 1. try drop inside\n      // 2. try drop after\n      // 3. do not allow drop\n      if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 0\n      })) {\n        dropPosition = 0;\n      } else if (allowDrop({\n        dragNode: abstractDragDataNode,\n        dropNode: abstractDropDataNode,\n        dropPosition: 1\n      })) {\n        dropPosition = 1;\n      } else {\n        dropAllowed = false;\n      }\n    }\n  } else {\n    // | Node1 | <- abstractDropNode\n    //      |  Node2  |\n    // --^--|----=====| <- mousePosition\n    // 1. try insert after Node1\n    // 2. do not allow drop\n    if (allowDrop({\n      dragNode: abstractDragDataNode,\n      dropNode: abstractDropDataNode,\n      dropPosition: 1\n    })) {\n      dropPosition = 1;\n    } else {\n      dropAllowed = false;\n    }\n  }\n  return {\n    dropPosition: dropPosition,\n    dropLevelOffset: dropLevelOffset,\n    dropTargetKey: abstractDropNodeEntity.key,\n    dropTargetPos: abstractDropNodeEntity.pos,\n    dragOverNodeKey: dragOverNodeKey,\n    dropContainerKey: dropPosition === 0 ? null : ((_abstractDropNodeEnti = abstractDropNodeEntity.parent) === null || _abstractDropNodeEnti === void 0 ? void 0 : _abstractDropNodeEnti.key) || null,\n    dropAllowed: dropAllowed\n  };\n}\n\n/**\n * Return selectedKeys according with multiple prop\n * @param selectedKeys\n * @param props\n * @returns [string]\n */\nexport function calcSelectedKeys(selectedKeys, props) {\n  if (!selectedKeys) return undefined;\n  var multiple = props.multiple;\n  if (multiple) {\n    return selectedKeys.slice();\n  }\n  if (selectedKeys.length) {\n    return [selectedKeys[0]];\n  }\n  return selectedKeys;\n}\nvar internalProcessProps = function internalProcessProps(props) {\n  return props;\n};\nexport function convertDataToTree(treeData, processor) {\n  if (!treeData) return [];\n  var _ref2 = processor || {},\n    _ref2$processProps = _ref2.processProps,\n    processProps = _ref2$processProps === void 0 ? internalProcessProps : _ref2$processProps;\n  var list = Array.isArray(treeData) ? treeData : [treeData];\n  return list.map(function (_ref3) {\n    var children = _ref3.children,\n      props = _objectWithoutProperties(_ref3, _excluded);\n    var childrenNodes = convertDataToTree(children, processor);\n    return /*#__PURE__*/React.createElement(TreeNode, _extends({\n      key: props.key\n    }, processProps(props)), childrenNodes);\n  });\n}\n\n/**\n * Parse `checkedKeys` to { checkedKeys, halfCheckedKeys } style\n */\nexport function parseCheckedKeys(keys) {\n  if (!keys) {\n    return null;\n  }\n\n  // Convert keys to object format\n  var keyProps;\n  if (Array.isArray(keys)) {\n    // [Legacy] Follow the api doc\n    keyProps = {\n      checkedKeys: keys,\n      halfCheckedKeys: undefined\n    };\n  } else if (_typeof(keys) === 'object') {\n    keyProps = {\n      checkedKeys: keys.checked || undefined,\n      halfCheckedKeys: keys.halfChecked || undefined\n    };\n  } else {\n    warning(false, '`checkedKeys` is not an array or an object');\n    return null;\n  }\n  return keyProps;\n}\n\n/**\n * If user use `autoExpandParent` we should get the list of parent node\n * @param keyList\n * @param keyEntities\n */\nexport function conductExpandParent(keyList, keyEntities) {\n  var expandedKeys = new Set();\n  function conductUp(key) {\n    if (expandedKeys.has(key)) return;\n    var entity = getEntity(keyEntities, key);\n    if (!entity) return;\n    expandedKeys.add(key);\n    var parent = entity.parent,\n      node = entity.node;\n    if (node.disabled) return;\n    if (parent) {\n      conductUp(parent.key);\n    }\n  }\n  (keyList || []).forEach(function (key) {\n    conductUp(key);\n  });\n  return _toConsumableArray(expandedKeys);\n}","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n// TODO: https://www.w3.org/TR/2017/NOTE-wai-aria-practices-1.1-20171214/examples/treeview/treeview-2/treeview-2a.html\n// Fully accessibility support\n\nimport classNames from 'classnames';\nimport KeyCode from \"rc-util/es/KeyCode\";\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport warning from \"rc-util/es/warning\";\nimport * as React from 'react';\nimport { TreeContext } from \"./contextTypes\";\nimport DropIndicator from \"./DropIndicator\";\nimport NodeList, { MOTION_KEY, MotionEntity } from \"./NodeList\";\nimport TreeNode from \"./TreeNode\";\nimport { arrAdd, arrDel, calcDropPosition, calcSelectedKeys, conductExpandParent, getDragChildrenKeys, parseCheckedKeys, posToArr } from \"./util\";\nimport { conductCheck } from \"./utils/conductUtil\";\nimport getEntity from \"./utils/keyUtil\";\nimport { convertDataToEntities, convertNodePropsToEventData, convertTreeToData, fillFieldNames, flattenTreeData, getTreeNodeProps, warningWithoutKey } from \"./utils/treeUtil\";\nvar MAX_RETRY_TIMES = 10;\nvar Tree = /*#__PURE__*/function (_React$Component) {\n  _inherits(Tree, _React$Component);\n  var _super = _createSuper(Tree);\n  function Tree() {\n    var _this;\n    _classCallCheck(this, Tree);\n    for (var _len = arguments.length, _args = new Array(_len), _key = 0; _key < _len; _key++) {\n      _args[_key] = arguments[_key];\n    }\n    _this = _super.call.apply(_super, [this].concat(_args));\n    _defineProperty(_assertThisInitialized(_this), \"destroyed\", false);\n    _defineProperty(_assertThisInitialized(_this), \"delayedDragEnterLogic\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"loadingRetryTimes\", {});\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      keyEntities: {},\n      indent: null,\n      selectedKeys: [],\n      checkedKeys: [],\n      halfCheckedKeys: [],\n      loadedKeys: [],\n      loadingKeys: [],\n      expandedKeys: [],\n      draggingNodeKey: null,\n      dragChildrenKeys: [],\n      // dropTargetKey is the key of abstract-drop-node\n      // the abstract-drop-node is the real drop node when drag and drop\n      // not the DOM drag over node\n      dropTargetKey: null,\n      dropPosition: null,\n      // the drop position of abstract-drop-node, inside 0, top -1, bottom 1\n      dropContainerKey: null,\n      // the container key of abstract-drop-node if dropPosition is -1 or 1\n      dropLevelOffset: null,\n      // the drop level offset of abstract-drag-over-node\n      dropTargetPos: null,\n      // the pos of abstract-drop-node\n      dropAllowed: true,\n      // if drop to abstract-drop-node is allowed\n      // the abstract-drag-over-node\n      // if mouse is on the bottom of top dom node or no the top of the bottom dom node\n      // abstract-drag-over-node is the top node\n      dragOverNodeKey: null,\n      treeData: [],\n      flattenNodes: [],\n      focused: false,\n      activeKey: null,\n      listChanging: false,\n      prevProps: null,\n      fieldNames: fillFieldNames()\n    });\n    _defineProperty(_assertThisInitialized(_this), \"dragStartMousePosition\", null);\n    _defineProperty(_assertThisInitialized(_this), \"dragNode\", void 0);\n    _defineProperty(_assertThisInitialized(_this), \"currentMouseOverDroppableNodeKey\", null);\n    _defineProperty(_assertThisInitialized(_this), \"listRef\", /*#__PURE__*/React.createRef());\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragStart\", function (event, node) {\n      var _this$state = _this.state,\n        expandedKeys = _this$state.expandedKeys,\n        keyEntities = _this$state.keyEntities;\n      var onDragStart = _this.props.onDragStart;\n      var eventKey = node.props.eventKey;\n      _this.dragNode = node;\n      _this.dragStartMousePosition = {\n        x: event.clientX,\n        y: event.clientY\n      };\n      var newExpandedKeys = arrDel(expandedKeys, eventKey);\n      _this.setState({\n        draggingNodeKey: eventKey,\n        dragChildrenKeys: getDragChildrenKeys(eventKey, keyEntities),\n        indent: _this.listRef.current.getIndentWidth()\n      });\n      _this.setExpandedKeys(newExpandedKeys);\n      window.addEventListener('dragend', _this.onWindowDragEnd);\n      onDragStart === null || onDragStart === void 0 || onDragStart({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    /**\n     * [Legacy] Select handler is smaller than node,\n     * so that this will trigger when drag enter node or select handler.\n     * This is a little tricky if customize css without padding.\n     * Better for use mouse move event to refresh drag state.\n     * But let's just keep it to avoid event trigger logic change.\n     */\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnter\", function (event, node) {\n      var _this$state2 = _this.state,\n        expandedKeys = _this$state2.expandedKeys,\n        keyEntities = _this$state2.keyEntities,\n        dragChildrenKeys = _this$state2.dragChildrenKeys,\n        flattenNodes = _this$state2.flattenNodes,\n        indent = _this$state2.indent;\n      var _this$props = _this.props,\n        onDragEnter = _this$props.onDragEnter,\n        onExpand = _this$props.onExpand,\n        allowDrop = _this$props.allowDrop,\n        direction = _this$props.direction;\n      var _node$props = node.props,\n        pos = _node$props.pos,\n        eventKey = _node$props.eventKey;\n      var _assertThisInitialize = _assertThisInitialized(_this),\n        dragNode = _assertThisInitialize.dragNode;\n\n      // record the key of node which is latest entered, used in dragleave event.\n      if (_this.currentMouseOverDroppableNodeKey !== eventKey) {\n        _this.currentMouseOverDroppableNodeKey = eventKey;\n      }\n      if (!dragNode) {\n        _this.resetDragState();\n        return;\n      }\n      var _calcDropPosition = calcDropPosition(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition.dropPosition,\n        dropLevelOffset = _calcDropPosition.dropLevelOffset,\n        dropTargetKey = _calcDropPosition.dropTargetKey,\n        dropContainerKey = _calcDropPosition.dropContainerKey,\n        dropTargetPos = _calcDropPosition.dropTargetPos,\n        dropAllowed = _calcDropPosition.dropAllowed,\n        dragOverNodeKey = _calcDropPosition.dragOverNodeKey;\n      if (\n      // don't allow drop inside its children\n      dragChildrenKeys.indexOf(dropTargetKey) !== -1 ||\n      // don't allow drop when drop is not allowed caculated by calcDropPosition\n      !dropAllowed) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Side effect for delay drag\n      if (!_this.delayedDragEnterLogic) {\n        _this.delayedDragEnterLogic = {};\n      }\n      Object.keys(_this.delayedDragEnterLogic).forEach(function (key) {\n        clearTimeout(_this.delayedDragEnterLogic[key]);\n      });\n      if (dragNode.props.eventKey !== node.props.eventKey) {\n        // hoist expand logic here\n        // since if logic is on the bottom\n        // it will be blocked by abstract dragover node check\n        //   => if you dragenter from top, you mouse will still be consider as in the top node\n        event.persist();\n        _this.delayedDragEnterLogic[pos] = window.setTimeout(function () {\n          if (_this.state.draggingNodeKey === null) return;\n          var newExpandedKeys = _toConsumableArray(expandedKeys);\n          var entity = getEntity(keyEntities, node.props.eventKey);\n          if (entity && (entity.children || []).length) {\n            newExpandedKeys = arrAdd(expandedKeys, node.props.eventKey);\n          }\n          if (!('expandedKeys' in _this.props)) {\n            _this.setExpandedKeys(newExpandedKeys);\n          }\n          onExpand === null || onExpand === void 0 || onExpand(newExpandedKeys, {\n            node: convertNodePropsToEventData(node.props),\n            expanded: true,\n            nativeEvent: event.nativeEvent\n          });\n        }, 800);\n      }\n\n      // Skip if drag node is self\n      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        _this.resetDragState();\n        return;\n      }\n\n      // Update drag over node and drag state\n      _this.setState({\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        dropLevelOffset: dropLevelOffset,\n        dropTargetKey: dropTargetKey,\n        dropContainerKey: dropContainerKey,\n        dropTargetPos: dropTargetPos,\n        dropAllowed: dropAllowed\n      });\n      onDragEnter === null || onDragEnter === void 0 || onDragEnter({\n        event: event,\n        node: convertNodePropsToEventData(node.props),\n        expandedKeys: expandedKeys\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragOver\", function (event, node) {\n      var _this$state3 = _this.state,\n        dragChildrenKeys = _this$state3.dragChildrenKeys,\n        flattenNodes = _this$state3.flattenNodes,\n        keyEntities = _this$state3.keyEntities,\n        expandedKeys = _this$state3.expandedKeys,\n        indent = _this$state3.indent;\n      var _this$props2 = _this.props,\n        onDragOver = _this$props2.onDragOver,\n        allowDrop = _this$props2.allowDrop,\n        direction = _this$props2.direction;\n      var _assertThisInitialize2 = _assertThisInitialized(_this),\n        dragNode = _assertThisInitialize2.dragNode;\n      if (!dragNode) {\n        return;\n      }\n      var _calcDropPosition2 = calcDropPosition(event, dragNode, node, indent, _this.dragStartMousePosition, allowDrop, flattenNodes, keyEntities, expandedKeys, direction),\n        dropPosition = _calcDropPosition2.dropPosition,\n        dropLevelOffset = _calcDropPosition2.dropLevelOffset,\n        dropTargetKey = _calcDropPosition2.dropTargetKey,\n        dropContainerKey = _calcDropPosition2.dropContainerKey,\n        dropAllowed = _calcDropPosition2.dropAllowed,\n        dropTargetPos = _calcDropPosition2.dropTargetPos,\n        dragOverNodeKey = _calcDropPosition2.dragOverNodeKey;\n      if (dragChildrenKeys.indexOf(dropTargetKey) !== -1 || !dropAllowed) {\n        // don't allow drop inside its children\n        // don't allow drop when drop is not allowed calculated by calcDropPosition\n        return;\n      }\n\n      // Update drag position\n\n      if (dragNode.props.eventKey === dropTargetKey && dropLevelOffset === 0) {\n        if (!(_this.state.dropPosition === null && _this.state.dropLevelOffset === null && _this.state.dropTargetKey === null && _this.state.dropContainerKey === null && _this.state.dropTargetPos === null && _this.state.dropAllowed === false && _this.state.dragOverNodeKey === null)) {\n          _this.resetDragState();\n        }\n      } else if (!(dropPosition === _this.state.dropPosition && dropLevelOffset === _this.state.dropLevelOffset && dropTargetKey === _this.state.dropTargetKey && dropContainerKey === _this.state.dropContainerKey && dropTargetPos === _this.state.dropTargetPos && dropAllowed === _this.state.dropAllowed && dragOverNodeKey === _this.state.dragOverNodeKey)) {\n        _this.setState({\n          dropPosition: dropPosition,\n          dropLevelOffset: dropLevelOffset,\n          dropTargetKey: dropTargetKey,\n          dropContainerKey: dropContainerKey,\n          dropTargetPos: dropTargetPos,\n          dropAllowed: dropAllowed,\n          dragOverNodeKey: dragOverNodeKey\n        });\n      }\n      onDragOver === null || onDragOver === void 0 || onDragOver({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragLeave\", function (event, node) {\n      // if it is outside the droppable area\n      // currentMouseOverDroppableNodeKey will be updated in dragenter event when into another droppable receiver.\n      if (_this.currentMouseOverDroppableNodeKey === node.props.eventKey && !event.currentTarget.contains(event.relatedTarget)) {\n        _this.resetDragState();\n        _this.currentMouseOverDroppableNodeKey = null;\n      }\n      var onDragLeave = _this.props.onDragLeave;\n      onDragLeave === null || onDragLeave === void 0 || onDragLeave({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n    });\n    // since stopPropagation() is called in treeNode\n    // if onWindowDrag is called, whice means state is keeped, drag state should be cleared\n    _defineProperty(_assertThisInitialized(_this), \"onWindowDragEnd\", function (event) {\n      _this.onNodeDragEnd(event, null, true);\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    // if onNodeDragEnd is called, onWindowDragEnd won't be called since stopPropagation() is called\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDragEnd\", function (event, node) {\n      var onDragEnd = _this.props.onDragEnd;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      onDragEnd === null || onDragEnd === void 0 || onDragEnd({\n        event: event,\n        node: convertNodePropsToEventData(node.props)\n      });\n      _this.dragNode = null;\n      window.removeEventListener('dragend', _this.onWindowDragEnd);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDrop\", function (event, node) {\n      var _this$getActiveItem;\n      var outsideTree = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var _this$state4 = _this.state,\n        dragChildrenKeys = _this$state4.dragChildrenKeys,\n        dropPosition = _this$state4.dropPosition,\n        dropTargetKey = _this$state4.dropTargetKey,\n        dropTargetPos = _this$state4.dropTargetPos,\n        dropAllowed = _this$state4.dropAllowed;\n      if (!dropAllowed) return;\n      var onDrop = _this.props.onDrop;\n      _this.setState({\n        dragOverNodeKey: null\n      });\n      _this.cleanDragState();\n      if (dropTargetKey === null) return;\n      var abstractDropNodeProps = _objectSpread(_objectSpread({}, getTreeNodeProps(dropTargetKey, _this.getTreeNodeRequiredProps())), {}, {\n        active: ((_this$getActiveItem = _this.getActiveItem()) === null || _this$getActiveItem === void 0 ? void 0 : _this$getActiveItem.key) === dropTargetKey,\n        data: getEntity(_this.state.keyEntities, dropTargetKey).node\n      });\n      var dropToChild = dragChildrenKeys.indexOf(dropTargetKey) !== -1;\n      warning(!dropToChild, \"Can not drop to dragNode's children node. This is a bug of rc-tree. Please report an issue.\");\n      var posArr = posToArr(dropTargetPos);\n      var dropResult = {\n        event: event,\n        node: convertNodePropsToEventData(abstractDropNodeProps),\n        dragNode: _this.dragNode ? convertNodePropsToEventData(_this.dragNode.props) : null,\n        dragNodesKeys: [_this.dragNode.props.eventKey].concat(dragChildrenKeys),\n        dropToGap: dropPosition !== 0,\n        dropPosition: dropPosition + Number(posArr[posArr.length - 1])\n      };\n      if (!outsideTree) {\n        onDrop === null || onDrop === void 0 || onDrop(dropResult);\n      }\n      _this.dragNode = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"cleanDragState\", function () {\n      var draggingNodeKey = _this.state.draggingNodeKey;\n      if (draggingNodeKey !== null) {\n        _this.setState({\n          draggingNodeKey: null,\n          dropPosition: null,\n          dropContainerKey: null,\n          dropTargetKey: null,\n          dropLevelOffset: null,\n          dropAllowed: true,\n          dragOverNodeKey: null\n        });\n      }\n      _this.dragStartMousePosition = null;\n      _this.currentMouseOverDroppableNodeKey = null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"triggerExpandActionExpand\", function (e, treeNode) {\n      var _this$state5 = _this.state,\n        expandedKeys = _this$state5.expandedKeys,\n        flattenNodes = _this$state5.flattenNodes;\n      var expanded = treeNode.expanded,\n        key = treeNode.key,\n        isLeaf = treeNode.isLeaf;\n      if (isLeaf || e.shiftKey || e.metaKey || e.ctrlKey) {\n        return;\n      }\n      var node = flattenNodes.filter(function (nodeItem) {\n        return nodeItem.key === key;\n      })[0];\n      var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(key, _this.getTreeNodeRequiredProps())), {}, {\n        data: node.data\n      }));\n      _this.setExpandedKeys(expanded ? arrDel(expandedKeys, key) : arrAdd(expandedKeys, key));\n      _this.onNodeExpand(e, eventNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeClick\", function (e, treeNode) {\n      var _this$props3 = _this.props,\n        onClick = _this$props3.onClick,\n        expandAction = _this$props3.expandAction;\n      if (expandAction === 'click') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onClick === null || onClick === void 0 || onClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeDoubleClick\", function (e, treeNode) {\n      var _this$props4 = _this.props,\n        onDoubleClick = _this$props4.onDoubleClick,\n        expandAction = _this$props4.expandAction;\n      if (expandAction === 'doubleClick') {\n        _this.triggerExpandActionExpand(e, treeNode);\n      }\n      onDoubleClick === null || onDoubleClick === void 0 || onDoubleClick(e, treeNode);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeSelect\", function (e, treeNode) {\n      var selectedKeys = _this.state.selectedKeys;\n      var _this$state6 = _this.state,\n        keyEntities = _this$state6.keyEntities,\n        fieldNames = _this$state6.fieldNames;\n      var _this$props5 = _this.props,\n        onSelect = _this$props5.onSelect,\n        multiple = _this$props5.multiple;\n      var selected = treeNode.selected;\n      var key = treeNode[fieldNames.key];\n      var targetSelected = !selected;\n\n      // Update selected keys\n      if (!targetSelected) {\n        selectedKeys = arrDel(selectedKeys, key);\n      } else if (!multiple) {\n        selectedKeys = [key];\n      } else {\n        selectedKeys = arrAdd(selectedKeys, key);\n      }\n\n      // [Legacy] Not found related usage in doc or upper libs\n      var selectedNodes = selectedKeys.map(function (selectedKey) {\n        var entity = getEntity(keyEntities, selectedKey);\n        if (!entity) return null;\n        return entity.node;\n      }).filter(function (node) {\n        return node;\n      });\n      _this.setUncontrolledState({\n        selectedKeys: selectedKeys\n      });\n      onSelect === null || onSelect === void 0 || onSelect(selectedKeys, {\n        event: 'select',\n        selected: targetSelected,\n        node: treeNode,\n        selectedNodes: selectedNodes,\n        nativeEvent: e.nativeEvent\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeCheck\", function (e, treeNode, checked) {\n      var _this$state7 = _this.state,\n        keyEntities = _this$state7.keyEntities,\n        oriCheckedKeys = _this$state7.checkedKeys,\n        oriHalfCheckedKeys = _this$state7.halfCheckedKeys;\n      var _this$props6 = _this.props,\n        checkStrictly = _this$props6.checkStrictly,\n        onCheck = _this$props6.onCheck;\n      var key = treeNode.key;\n\n      // Prepare trigger arguments\n      var checkedObj;\n      var eventObj = {\n        event: 'check',\n        node: treeNode,\n        checked: checked,\n        nativeEvent: e.nativeEvent\n      };\n      if (checkStrictly) {\n        var checkedKeys = checked ? arrAdd(oriCheckedKeys, key) : arrDel(oriCheckedKeys, key);\n        var halfCheckedKeys = arrDel(oriHalfCheckedKeys, key);\n        checkedObj = {\n          checked: checkedKeys,\n          halfChecked: halfCheckedKeys\n        };\n        eventObj.checkedNodes = checkedKeys.map(function (checkedKey) {\n          return getEntity(keyEntities, checkedKey);\n        }).filter(function (entity) {\n          return entity;\n        }).map(function (entity) {\n          return entity.node;\n        });\n        _this.setUncontrolledState({\n          checkedKeys: checkedKeys\n        });\n      } else {\n        // Always fill first\n        var _conductCheck = conductCheck([].concat(_toConsumableArray(oriCheckedKeys), [key]), true, keyEntities),\n          _checkedKeys = _conductCheck.checkedKeys,\n          _halfCheckedKeys = _conductCheck.halfCheckedKeys;\n\n        // If remove, we do it again to correction\n        if (!checked) {\n          var keySet = new Set(_checkedKeys);\n          keySet.delete(key);\n          var _conductCheck2 = conductCheck(Array.from(keySet), {\n            checked: false,\n            halfCheckedKeys: _halfCheckedKeys\n          }, keyEntities);\n          _checkedKeys = _conductCheck2.checkedKeys;\n          _halfCheckedKeys = _conductCheck2.halfCheckedKeys;\n        }\n        checkedObj = _checkedKeys;\n\n        // [Legacy] This is used for `rc-tree-select`\n        eventObj.checkedNodes = [];\n        eventObj.checkedNodesPositions = [];\n        eventObj.halfCheckedKeys = _halfCheckedKeys;\n        _checkedKeys.forEach(function (checkedKey) {\n          var entity = getEntity(keyEntities, checkedKey);\n          if (!entity) return;\n          var node = entity.node,\n            pos = entity.pos;\n          eventObj.checkedNodes.push(node);\n          eventObj.checkedNodesPositions.push({\n            node: node,\n            pos: pos\n          });\n        });\n        _this.setUncontrolledState({\n          checkedKeys: _checkedKeys\n        }, false, {\n          halfCheckedKeys: _halfCheckedKeys\n        });\n      }\n      onCheck === null || onCheck === void 0 || onCheck(checkedObj, eventObj);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeLoad\", function (treeNode) {\n      var _entity$children;\n      var key = treeNode.key;\n      var keyEntities = _this.state.keyEntities;\n\n      // Skip if has children already\n      var entity = getEntity(keyEntities, key);\n      if (entity !== null && entity !== void 0 && (_entity$children = entity.children) !== null && _entity$children !== void 0 && _entity$children.length) {\n        return;\n      }\n      var loadPromise = new Promise(function (resolve, reject) {\n        // We need to get the latest state of loading/loaded keys\n        _this.setState(function (_ref) {\n          var _ref$loadedKeys = _ref.loadedKeys,\n            loadedKeys = _ref$loadedKeys === void 0 ? [] : _ref$loadedKeys,\n            _ref$loadingKeys = _ref.loadingKeys,\n            loadingKeys = _ref$loadingKeys === void 0 ? [] : _ref$loadingKeys;\n          var _this$props7 = _this.props,\n            loadData = _this$props7.loadData,\n            onLoad = _this$props7.onLoad;\n          if (!loadData || loadedKeys.indexOf(key) !== -1 || loadingKeys.indexOf(key) !== -1) {\n            return null;\n          }\n\n          // Process load data\n          var promise = loadData(treeNode);\n          promise.then(function () {\n            var currentLoadedKeys = _this.state.loadedKeys;\n            var newLoadedKeys = arrAdd(currentLoadedKeys, key);\n\n            // onLoad should trigger before internal setState to avoid `loadData` trigger twice.\n            // https://github.com/ant-design/ant-design/issues/12464\n            onLoad === null || onLoad === void 0 || onLoad(newLoadedKeys, {\n              event: 'load',\n              node: treeNode\n            });\n            _this.setUncontrolledState({\n              loadedKeys: newLoadedKeys\n            });\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n            resolve();\n          }).catch(function (e) {\n            _this.setState(function (prevState) {\n              return {\n                loadingKeys: arrDel(prevState.loadingKeys, key)\n              };\n            });\n\n            // If exceed max retry times, we give up retry\n            _this.loadingRetryTimes[key] = (_this.loadingRetryTimes[key] || 0) + 1;\n            if (_this.loadingRetryTimes[key] >= MAX_RETRY_TIMES) {\n              var currentLoadedKeys = _this.state.loadedKeys;\n              warning(false, 'Retry for `loadData` many times but still failed. No more retry.');\n              _this.setUncontrolledState({\n                loadedKeys: arrAdd(currentLoadedKeys, key)\n              });\n              resolve();\n            }\n            reject(e);\n          });\n          return {\n            loadingKeys: arrAdd(loadingKeys, key)\n          };\n        });\n      });\n\n      // Not care warning if we ignore this\n      loadPromise.catch(function () {});\n      return loadPromise;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseEnter\", function (event, node) {\n      var onMouseEnter = _this.props.onMouseEnter;\n      onMouseEnter === null || onMouseEnter === void 0 || onMouseEnter({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeMouseLeave\", function (event, node) {\n      var onMouseLeave = _this.props.onMouseLeave;\n      onMouseLeave === null || onMouseLeave === void 0 || onMouseLeave({\n        event: event,\n        node: node\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeContextMenu\", function (event, node) {\n      var onRightClick = _this.props.onRightClick;\n      if (onRightClick) {\n        event.preventDefault();\n        onRightClick({\n          event: event,\n          node: node\n        });\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onFocus\", function () {\n      var onFocus = _this.props.onFocus;\n      _this.setState({\n        focused: true\n      });\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      onFocus === null || onFocus === void 0 || onFocus.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onBlur\", function () {\n      var onBlur = _this.props.onBlur;\n      _this.setState({\n        focused: false\n      });\n      _this.onActiveChange(null);\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      onBlur === null || onBlur === void 0 || onBlur.apply(void 0, args);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getTreeNodeRequiredProps\", function () {\n      var _this$state8 = _this.state,\n        expandedKeys = _this$state8.expandedKeys,\n        selectedKeys = _this$state8.selectedKeys,\n        loadedKeys = _this$state8.loadedKeys,\n        loadingKeys = _this$state8.loadingKeys,\n        checkedKeys = _this$state8.checkedKeys,\n        halfCheckedKeys = _this$state8.halfCheckedKeys,\n        dragOverNodeKey = _this$state8.dragOverNodeKey,\n        dropPosition = _this$state8.dropPosition,\n        keyEntities = _this$state8.keyEntities;\n      return {\n        expandedKeys: expandedKeys || [],\n        selectedKeys: selectedKeys || [],\n        loadedKeys: loadedKeys || [],\n        loadingKeys: loadingKeys || [],\n        checkedKeys: checkedKeys || [],\n        halfCheckedKeys: halfCheckedKeys || [],\n        dragOverNodeKey: dragOverNodeKey,\n        dropPosition: dropPosition,\n        keyEntities: keyEntities\n      };\n    });\n    // =========================== Expanded ===========================\n    /** Set uncontrolled `expandedKeys`. This will also auto update `flattenNodes`. */\n    _defineProperty(_assertThisInitialized(_this), \"setExpandedKeys\", function (expandedKeys) {\n      var _this$state9 = _this.state,\n        treeData = _this$state9.treeData,\n        fieldNames = _this$state9.fieldNames;\n      var flattenNodes = flattenTreeData(treeData, expandedKeys, fieldNames);\n      _this.setUncontrolledState({\n        expandedKeys: expandedKeys,\n        flattenNodes: flattenNodes\n      }, true);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onNodeExpand\", function (e, treeNode) {\n      var expandedKeys = _this.state.expandedKeys;\n      var _this$state10 = _this.state,\n        listChanging = _this$state10.listChanging,\n        fieldNames = _this$state10.fieldNames;\n      var _this$props8 = _this.props,\n        onExpand = _this$props8.onExpand,\n        loadData = _this$props8.loadData;\n      var expanded = treeNode.expanded;\n      var key = treeNode[fieldNames.key];\n\n      // Do nothing when motion is in progress\n      if (listChanging) {\n        return;\n      }\n\n      // Update selected keys\n      var index = expandedKeys.indexOf(key);\n      var targetExpanded = !expanded;\n      warning(expanded && index !== -1 || !expanded && index === -1, 'Expand state not sync with index check');\n      if (targetExpanded) {\n        expandedKeys = arrAdd(expandedKeys, key);\n      } else {\n        expandedKeys = arrDel(expandedKeys, key);\n      }\n      _this.setExpandedKeys(expandedKeys);\n      onExpand === null || onExpand === void 0 || onExpand(expandedKeys, {\n        node: treeNode,\n        expanded: targetExpanded,\n        nativeEvent: e.nativeEvent\n      });\n\n      // Async Load data\n      if (targetExpanded && loadData) {\n        var loadPromise = _this.onNodeLoad(treeNode);\n        if (loadPromise) {\n          loadPromise.then(function () {\n            // [Legacy] Refresh logic\n            var newFlattenTreeData = flattenTreeData(_this.state.treeData, expandedKeys, fieldNames);\n            _this.setUncontrolledState({\n              flattenNodes: newFlattenTreeData\n            });\n          }).catch(function () {\n            var currentExpandedKeys = _this.state.expandedKeys;\n            var expandedKeysToRestore = arrDel(currentExpandedKeys, key);\n            _this.setExpandedKeys(expandedKeysToRestore);\n          });\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeStart\", function () {\n      _this.setUncontrolledState({\n        listChanging: true\n      });\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onListChangeEnd\", function () {\n      setTimeout(function () {\n        _this.setUncontrolledState({\n          listChanging: false\n        });\n      });\n    });\n    // =========================== Keyboard ===========================\n    _defineProperty(_assertThisInitialized(_this), \"onActiveChange\", function (newActiveKey) {\n      var activeKey = _this.state.activeKey;\n      var _this$props9 = _this.props,\n        onActiveChange = _this$props9.onActiveChange,\n        _this$props9$itemScro = _this$props9.itemScrollOffset,\n        itemScrollOffset = _this$props9$itemScro === void 0 ? 0 : _this$props9$itemScro;\n      if (activeKey === newActiveKey) {\n        return;\n      }\n      _this.setState({\n        activeKey: newActiveKey\n      });\n      if (newActiveKey !== null) {\n        _this.scrollTo({\n          key: newActiveKey,\n          offset: itemScrollOffset\n        });\n      }\n      onActiveChange === null || onActiveChange === void 0 || onActiveChange(newActiveKey);\n    });\n    _defineProperty(_assertThisInitialized(_this), \"getActiveItem\", function () {\n      var _this$state11 = _this.state,\n        activeKey = _this$state11.activeKey,\n        flattenNodes = _this$state11.flattenNodes;\n      if (activeKey === null) {\n        return null;\n      }\n      return flattenNodes.find(function (_ref2) {\n        var key = _ref2.key;\n        return key === activeKey;\n      }) || null;\n    });\n    _defineProperty(_assertThisInitialized(_this), \"offsetActiveKey\", function (offset) {\n      var _this$state12 = _this.state,\n        flattenNodes = _this$state12.flattenNodes,\n        activeKey = _this$state12.activeKey;\n      var index = flattenNodes.findIndex(function (_ref3) {\n        var key = _ref3.key;\n        return key === activeKey;\n      });\n\n      // Align with index\n      if (index === -1 && offset < 0) {\n        index = flattenNodes.length;\n      }\n      index = (index + offset + flattenNodes.length) % flattenNodes.length;\n      var item = flattenNodes[index];\n      if (item) {\n        var _key4 = item.key;\n        _this.onActiveChange(_key4);\n      } else {\n        _this.onActiveChange(null);\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onKeyDown\", function (event) {\n      var _this$state13 = _this.state,\n        activeKey = _this$state13.activeKey,\n        expandedKeys = _this$state13.expandedKeys,\n        checkedKeys = _this$state13.checkedKeys,\n        fieldNames = _this$state13.fieldNames;\n      var _this$props10 = _this.props,\n        onKeyDown = _this$props10.onKeyDown,\n        checkable = _this$props10.checkable,\n        selectable = _this$props10.selectable;\n\n      // >>>>>>>>>> Direction\n      switch (event.which) {\n        case KeyCode.UP:\n          {\n            _this.offsetActiveKey(-1);\n            event.preventDefault();\n            break;\n          }\n        case KeyCode.DOWN:\n          {\n            _this.offsetActiveKey(1);\n            event.preventDefault();\n            break;\n          }\n      }\n\n      // >>>>>>>>>> Expand & Selection\n      var activeItem = _this.getActiveItem();\n      if (activeItem && activeItem.data) {\n        var treeNodeRequiredProps = _this.getTreeNodeRequiredProps();\n        var expandable = activeItem.data.isLeaf === false || !!(activeItem.data[fieldNames.children] || []).length;\n        var eventNode = convertNodePropsToEventData(_objectSpread(_objectSpread({}, getTreeNodeProps(activeKey, treeNodeRequiredProps)), {}, {\n          data: activeItem.data,\n          active: true\n        }));\n        switch (event.which) {\n          // >>> Expand\n          case KeyCode.LEFT:\n            {\n              // Collapse if possible\n              if (expandable && expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.parent) {\n                _this.onActiveChange(activeItem.parent.key);\n              }\n              event.preventDefault();\n              break;\n            }\n          case KeyCode.RIGHT:\n            {\n              // Expand if possible\n              if (expandable && !expandedKeys.includes(activeKey)) {\n                _this.onNodeExpand({}, eventNode);\n              } else if (activeItem.children && activeItem.children.length) {\n                _this.onActiveChange(activeItem.children[0].key);\n              }\n              event.preventDefault();\n              break;\n            }\n\n          // Selection\n          case KeyCode.ENTER:\n          case KeyCode.SPACE:\n            {\n              if (checkable && !eventNode.disabled && eventNode.checkable !== false && !eventNode.disableCheckbox) {\n                _this.onNodeCheck({}, eventNode, !checkedKeys.includes(activeKey));\n              } else if (!checkable && selectable && !eventNode.disabled && eventNode.selectable !== false) {\n                _this.onNodeSelect({}, eventNode);\n              }\n              break;\n            }\n        }\n      }\n      onKeyDown === null || onKeyDown === void 0 || onKeyDown(event);\n    });\n    /**\n     * Only update the value which is not in props\n     */\n    _defineProperty(_assertThisInitialized(_this), \"setUncontrolledState\", function (state) {\n      var atomic = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var forceState = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n      if (!_this.destroyed) {\n        var needSync = false;\n        var allPassed = true;\n        var newState = {};\n        Object.keys(state).forEach(function (name) {\n          if (name in _this.props) {\n            allPassed = false;\n            return;\n          }\n          needSync = true;\n          newState[name] = state[name];\n        });\n        if (needSync && (!atomic || allPassed)) {\n          _this.setState(_objectSpread(_objectSpread({}, newState), forceState));\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"scrollTo\", function (scroll) {\n      _this.listRef.current.scrollTo(scroll);\n    });\n    return _this;\n  }\n  _createClass(Tree, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.destroyed = false;\n      this.onUpdated();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {\n      this.onUpdated();\n    }\n  }, {\n    key: \"onUpdated\",\n    value: function onUpdated() {\n      var _this$props11 = this.props,\n        activeKey = _this$props11.activeKey,\n        _this$props11$itemScr = _this$props11.itemScrollOffset,\n        itemScrollOffset = _this$props11$itemScr === void 0 ? 0 : _this$props11$itemScr;\n      if (activeKey !== undefined && activeKey !== this.state.activeKey) {\n        this.setState({\n          activeKey: activeKey\n        });\n        if (activeKey !== null) {\n          this.scrollTo({\n            key: activeKey,\n            offset: itemScrollOffset\n          });\n        }\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('dragend', this.onWindowDragEnd);\n      this.destroyed = true;\n    }\n  }, {\n    key: \"resetDragState\",\n    value: function resetDragState() {\n      this.setState({\n        dragOverNodeKey: null,\n        dropPosition: null,\n        dropLevelOffset: null,\n        dropTargetKey: null,\n        dropContainerKey: null,\n        dropTargetPos: null,\n        dropAllowed: false\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state14 = this.state,\n        focused = _this$state14.focused,\n        flattenNodes = _this$state14.flattenNodes,\n        keyEntities = _this$state14.keyEntities,\n        draggingNodeKey = _this$state14.draggingNodeKey,\n        activeKey = _this$state14.activeKey,\n        dropLevelOffset = _this$state14.dropLevelOffset,\n        dropContainerKey = _this$state14.dropContainerKey,\n        dropTargetKey = _this$state14.dropTargetKey,\n        dropPosition = _this$state14.dropPosition,\n        dragOverNodeKey = _this$state14.dragOverNodeKey,\n        indent = _this$state14.indent;\n      var _this$props12 = this.props,\n        prefixCls = _this$props12.prefixCls,\n        className = _this$props12.className,\n        style = _this$props12.style,\n        showLine = _this$props12.showLine,\n        focusable = _this$props12.focusable,\n        _this$props12$tabInde = _this$props12.tabIndex,\n        tabIndex = _this$props12$tabInde === void 0 ? 0 : _this$props12$tabInde,\n        selectable = _this$props12.selectable,\n        showIcon = _this$props12.showIcon,\n        icon = _this$props12.icon,\n        switcherIcon = _this$props12.switcherIcon,\n        draggable = _this$props12.draggable,\n        checkable = _this$props12.checkable,\n        checkStrictly = _this$props12.checkStrictly,\n        disabled = _this$props12.disabled,\n        motion = _this$props12.motion,\n        loadData = _this$props12.loadData,\n        filterTreeNode = _this$props12.filterTreeNode,\n        height = _this$props12.height,\n        itemHeight = _this$props12.itemHeight,\n        virtual = _this$props12.virtual,\n        titleRender = _this$props12.titleRender,\n        dropIndicatorRender = _this$props12.dropIndicatorRender,\n        onContextMenu = _this$props12.onContextMenu,\n        onScroll = _this$props12.onScroll,\n        direction = _this$props12.direction,\n        rootClassName = _this$props12.rootClassName,\n        rootStyle = _this$props12.rootStyle;\n      var domProps = pickAttrs(this.props, {\n        aria: true,\n        data: true\n      });\n\n      // It's better move to hooks but we just simply keep here\n      var draggableConfig;\n      if (draggable) {\n        if (_typeof(draggable) === 'object') {\n          draggableConfig = draggable;\n        } else if (typeof draggable === 'function') {\n          draggableConfig = {\n            nodeDraggable: draggable\n          };\n        } else {\n          draggableConfig = {};\n        }\n      }\n      return /*#__PURE__*/React.createElement(TreeContext.Provider, {\n        value: {\n          prefixCls: prefixCls,\n          selectable: selectable,\n          showIcon: showIcon,\n          icon: icon,\n          switcherIcon: switcherIcon,\n          draggable: draggableConfig,\n          draggingNodeKey: draggingNodeKey,\n          checkable: checkable,\n          checkStrictly: checkStrictly,\n          disabled: disabled,\n          keyEntities: keyEntities,\n          dropLevelOffset: dropLevelOffset,\n          dropContainerKey: dropContainerKey,\n          dropTargetKey: dropTargetKey,\n          dropPosition: dropPosition,\n          dragOverNodeKey: dragOverNodeKey,\n          indent: indent,\n          direction: direction,\n          dropIndicatorRender: dropIndicatorRender,\n          loadData: loadData,\n          filterTreeNode: filterTreeNode,\n          titleRender: titleRender,\n          onNodeClick: this.onNodeClick,\n          onNodeDoubleClick: this.onNodeDoubleClick,\n          onNodeExpand: this.onNodeExpand,\n          onNodeSelect: this.onNodeSelect,\n          onNodeCheck: this.onNodeCheck,\n          onNodeLoad: this.onNodeLoad,\n          onNodeMouseEnter: this.onNodeMouseEnter,\n          onNodeMouseLeave: this.onNodeMouseLeave,\n          onNodeContextMenu: this.onNodeContextMenu,\n          onNodeDragStart: this.onNodeDragStart,\n          onNodeDragEnter: this.onNodeDragEnter,\n          onNodeDragOver: this.onNodeDragOver,\n          onNodeDragLeave: this.onNodeDragLeave,\n          onNodeDragEnd: this.onNodeDragEnd,\n          onNodeDrop: this.onNodeDrop\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        role: \"tree\",\n        className: classNames(prefixCls, className, rootClassName, _defineProperty(_defineProperty(_defineProperty({}, \"\".concat(prefixCls, \"-show-line\"), showLine), \"\".concat(prefixCls, \"-focused\"), focused), \"\".concat(prefixCls, \"-active-focused\"), activeKey !== null)),\n        style: rootStyle\n      }, /*#__PURE__*/React.createElement(NodeList, _extends({\n        ref: this.listRef,\n        prefixCls: prefixCls,\n        style: style,\n        data: flattenNodes,\n        disabled: disabled,\n        selectable: selectable,\n        checkable: !!checkable,\n        motion: motion,\n        dragging: draggingNodeKey !== null,\n        height: height,\n        itemHeight: itemHeight,\n        virtual: virtual,\n        focusable: focusable,\n        focused: focused,\n        tabIndex: tabIndex,\n        activeItem: this.getActiveItem(),\n        onFocus: this.onFocus,\n        onBlur: this.onBlur,\n        onKeyDown: this.onKeyDown,\n        onActiveChange: this.onActiveChange,\n        onListChangeStart: this.onListChangeStart,\n        onListChangeEnd: this.onListChangeEnd,\n        onContextMenu: onContextMenu,\n        onScroll: onScroll\n      }, this.getTreeNodeRequiredProps(), domProps))));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, prevState) {\n      var prevProps = prevState.prevProps;\n      var newState = {\n        prevProps: props\n      };\n      function needSync(name) {\n        return !prevProps && name in props || prevProps && prevProps[name] !== props[name];\n      }\n\n      // ================== Tree Node ==================\n      var treeData;\n\n      // fieldNames\n      var fieldNames = prevState.fieldNames;\n      if (needSync('fieldNames')) {\n        fieldNames = fillFieldNames(props.fieldNames);\n        newState.fieldNames = fieldNames;\n      }\n\n      // Check if `treeData` or `children` changed and save into the state.\n      if (needSync('treeData')) {\n        treeData = props.treeData;\n      } else if (needSync('children')) {\n        warning(false, '`children` of Tree is deprecated. Please use `treeData` instead.');\n        treeData = convertTreeToData(props.children);\n      }\n\n      // Save flatten nodes info and convert `treeData` into keyEntities\n      if (treeData) {\n        newState.treeData = treeData;\n        var entitiesMap = convertDataToEntities(treeData, {\n          fieldNames: fieldNames\n        });\n        newState.keyEntities = _objectSpread(_defineProperty({}, MOTION_KEY, MotionEntity), entitiesMap.keyEntities);\n\n        // Warning if treeNode not provide key\n        if (process.env.NODE_ENV !== 'production') {\n          warningWithoutKey(treeData, fieldNames);\n        }\n      }\n      var keyEntities = newState.keyEntities || prevState.keyEntities;\n\n      // ================ expandedKeys =================\n      if (needSync('expandedKeys') || prevProps && needSync('autoExpandParent')) {\n        newState.expandedKeys = props.autoExpandParent || !prevProps && props.defaultExpandParent ? conductExpandParent(props.expandedKeys, keyEntities) : props.expandedKeys;\n      } else if (!prevProps && props.defaultExpandAll) {\n        var cloneKeyEntities = _objectSpread({}, keyEntities);\n        delete cloneKeyEntities[MOTION_KEY];\n\n        // Only take the key who has the children to enhance the performance\n        var nextExpandedKeys = [];\n        Object.keys(cloneKeyEntities).forEach(function (key) {\n          var entity = cloneKeyEntities[key];\n          if (entity.children && entity.children.length) {\n            nextExpandedKeys.push(entity.key);\n          }\n        });\n        newState.expandedKeys = nextExpandedKeys;\n      } else if (!prevProps && props.defaultExpandedKeys) {\n        newState.expandedKeys = props.autoExpandParent || props.defaultExpandParent ? conductExpandParent(props.defaultExpandedKeys, keyEntities) : props.defaultExpandedKeys;\n      }\n      if (!newState.expandedKeys) {\n        delete newState.expandedKeys;\n      }\n\n      // ================ flattenNodes =================\n      if (treeData || newState.expandedKeys) {\n        var flattenNodes = flattenTreeData(treeData || prevState.treeData, newState.expandedKeys || prevState.expandedKeys, fieldNames);\n        newState.flattenNodes = flattenNodes;\n      }\n\n      // ================ selectedKeys =================\n      if (props.selectable) {\n        if (needSync('selectedKeys')) {\n          newState.selectedKeys = calcSelectedKeys(props.selectedKeys, props);\n        } else if (!prevProps && props.defaultSelectedKeys) {\n          newState.selectedKeys = calcSelectedKeys(props.defaultSelectedKeys, props);\n        }\n      }\n\n      // ================= checkedKeys =================\n      if (props.checkable) {\n        var checkedKeyEntity;\n        if (needSync('checkedKeys')) {\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {};\n        } else if (!prevProps && props.defaultCheckedKeys) {\n          checkedKeyEntity = parseCheckedKeys(props.defaultCheckedKeys) || {};\n        } else if (treeData) {\n          // If `treeData` changed, we also need check it\n          checkedKeyEntity = parseCheckedKeys(props.checkedKeys) || {\n            checkedKeys: prevState.checkedKeys,\n            halfCheckedKeys: prevState.halfCheckedKeys\n          };\n        }\n        if (checkedKeyEntity) {\n          var _checkedKeyEntity = checkedKeyEntity,\n            _checkedKeyEntity$che = _checkedKeyEntity.checkedKeys,\n            checkedKeys = _checkedKeyEntity$che === void 0 ? [] : _checkedKeyEntity$che,\n            _checkedKeyEntity$hal = _checkedKeyEntity.halfCheckedKeys,\n            halfCheckedKeys = _checkedKeyEntity$hal === void 0 ? [] : _checkedKeyEntity$hal;\n          if (!props.checkStrictly) {\n            var conductKeys = conductCheck(checkedKeys, true, keyEntities);\n            checkedKeys = conductKeys.checkedKeys;\n            halfCheckedKeys = conductKeys.halfCheckedKeys;\n          }\n          newState.checkedKeys = checkedKeys;\n          newState.halfCheckedKeys = halfCheckedKeys;\n        }\n      }\n\n      // ================= loadedKeys ==================\n      if (needSync('loadedKeys')) {\n        newState.loadedKeys = props.loadedKeys;\n      }\n      return newState;\n    }\n  }]);\n  return Tree;\n}(React.Component);\n_defineProperty(Tree, \"defaultProps\", {\n  prefixCls: 'rc-tree',\n  showLine: false,\n  showIcon: true,\n  selectable: true,\n  multiple: false,\n  checkable: false,\n  disabled: false,\n  checkStrictly: false,\n  draggable: false,\n  defaultExpandParent: true,\n  autoExpandParent: false,\n  defaultExpandAll: false,\n  defaultExpandedKeys: [],\n  defaultCheckedKeys: [],\n  defaultSelectedKeys: [],\n  dropIndicatorRender: DropIndicator,\n  allowDrop: function allowDrop() {\n    return true;\n  },\n  expandAction: false\n});\n_defineProperty(Tree, \"TreeNode\", TreeNode);\nexport default Tree;","import Tree from \"./Tree\";\nimport TreeNode from \"./TreeNode\";\nexport { TreeNode };\nexport default Tree;","import { css } from '@emotion/react';\n\nimport { GrafanaTheme2 } from '@grafana/data';\n\nexport function getGlobalStyles(theme: GrafanaTheme2) {\n  return css({\n    '.moveable-control-box': {\n      zIndex: 999,\n    },\n    '.rc-tree': {\n      margin: 0,\n      marginBottom: '15px',\n      border: '1px solid transparent',\n      '&-focused:not(&-active-focused)': {\n        borderColor: 'cyan',\n      },\n      '.rc-tree-title': {\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between',\n        width: '100%',\n      },\n      '.rc-tree-treenode': {\n        margin: 0,\n        padding: '1px',\n        lineHeight: '24px',\n        whiteSpace: 'nowrap',\n        listStyle: 'none',\n        outline: 0,\n        display: 'flex',\n        marginBottom: '3px',\n        cursor: 'pointer',\n        '.draggable': {\n          color: '#333',\n          MozUserSelect: 'none',\n          KhtmlUserSelect: 'none',\n          WebkitUserSelect: 'none',\n          userSelect: 'none',\n        },\n        '&.drop-container': {\n          '> .draggable::after': {\n            position: 'absolute',\n            top: 0,\n            right: 0,\n            bottom: 0,\n            left: 0,\n            boxShadow: 'inset 0 0 0 2px blue',\n            content: '\"\"',\n          },\n          '& ~ .rc-tree-treenode': {\n            borderLeft: `2px solid ${theme.components.input.borderColor}`,\n          },\n        },\n        '&.drop-target': {\n          '& ~ .rc-tree-treenode': {\n            borderLeft: 'none',\n          },\n        },\n        '&.filter-node': {\n          '> .rc-tree-node-content-wrapper': {\n            color: '#a60000 !important',\n            fontWeight: 'bold !important',\n          },\n        },\n        ul: {\n          margin: 0,\n          padding: '0 0 0 18px',\n        },\n        '.rc-tree-node-content-wrapper': {\n          position: 'relative',\n          display: 'inline-block',\n          height: '24px',\n          margin: 0,\n          padding: 0,\n          textDecoration: 'none',\n          verticalAlign: 'top',\n          cursor: 'grab',\n          flexGrow: 1,\n          border: `1px solid ${theme.components.input.borderColor}`,\n          borderRadius: `${theme.shape.radius.default}`,\n          background: `${theme.colors.background.secondary}`,\n          minHeight: `${theme.spacing.gridSize * 4}px`,\n          '&:hover': {\n            border: `1px solid ${theme.components.input.borderHover}`,\n          },\n          '&.rc-tree-node-selected': {\n            border: `1px solid ${theme.colors.primary.border}`,\n            opacity: 1,\n          },\n        },\n        span: {\n          height: '100%',\n          '&.rc-tree-checkbox, &.rc-tree-iconEle': {\n            display: 'inline-block',\n            width: '16px',\n            height: '16px',\n            marginRight: '2px',\n            lineHeight: '16px',\n            verticalAlign: '-0.125em',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n          },\n          '&.rc-tree-switcher': {\n            display: 'flex',\n            alignItems: 'center',\n            width: '16px',\n            height: 'auto',\n            backgroundColor: 'transparent',\n            backgroundRepeat: 'no-repeat',\n            backgroundAttachment: 'scroll',\n            border: '0 none',\n            outline: 'none',\n            cursor: 'pointer',\n            '&.rc-tree-icon__customize': {\n              backgroundImage: 'none',\n            },\n            '&.rc-tree-switcher-noop': {\n              cursor: 'auto',\n            },\n            '&.rc-tree-switcher_open': {\n              backgroundPosition: '-93px -56px',\n            },\n            '&.rc-tree-switcher_close': {\n              backgroundPosition: '-75px -56px',\n            },\n          },\n          '&.rc-tree-icon_loading': {\n            marginRight: '2px',\n            verticalAlign: 'top',\n            background:\n              \"url('data:image/gif;base64,R0lGODlhEAAQAKIGAMLY8YSx5HOm4Mjc88/g9Ofw+v///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgAGACwAAAAAEAAQAAADMGi6RbUwGjKIXCAA016PgRBElAVlG/RdLOO0X9nK61W39qvqiwz5Ls/rRqrggsdkAgAh+QQFCgAGACwCAAAABwAFAAADD2hqELAmiFBIYY4MAutdCQAh+QQFCgAGACwGAAAABwAFAAADD1hU1kaDOKMYCGAGEeYFCQAh+QQFCgAGACwKAAIABQAHAAADEFhUZjSkKdZqBQG0IELDQAIAIfkEBQoABgAsCgAGAAUABwAAAxBoVlRKgyjmlAIBqCDCzUoCACH5BAUKAAYALAYACgAHAAUAAAMPaGpFtYYMAgJgLogA610JACH5BAUKAAYALAIACgAHAAUAAAMPCAHWFiI4o1ghZZJB5i0JACH5BAUKAAYALAAABgAFAAcAAAMQCAFmIaEp1motpDQySMNFAgA7') no-repeat scroll 0 0 transparent\",\n          },\n          '&.rc-tree-checkbox': {\n            width: '13px',\n            height: '13px',\n            margin: '0 3px',\n            backgroundPosition: '0 0',\n            '&-checked': {\n              backgroundPosition: '-14px 0',\n            },\n            '&-indeterminate': {\n              backgroundPosition: '-14px -28px',\n            },\n            '&-disabled': {\n              backgroundPosition: '0 -56px',\n            },\n            '&.rc-tree-checkbox-checked.rc-tree-checkbox-disabled': {\n              backgroundPosition: '-14px -56px',\n            },\n            '&.rc-tree-checkbox-indeterminate.rc-tree-checkbox-disabled': {\n              position: 'relative',\n              background: '#ccc',\n              borderRadius: '3px',\n              '&::after': {\n                position: 'absolute',\n                top: '5px',\n                left: '3px',\n                width: '5px',\n                height: 0,\n                border: '2px solid #fff',\n                borderTop: 0,\n                borderLeft: 0,\n                WebkitTransform: 'scale(1)',\n                transform: 'scale(1)',\n                content: '\" \"',\n              },\n            },\n          },\n        },\n      },\n      '&:not(.rc-tree-show-line)': {\n        '.rc-tree-treenode': {\n          '.rc-tree-switcher-noop': {\n            background: 'none',\n          },\n        },\n      },\n      '&.rc-tree-show-line': {\n        '.rc-tree-treenode:not(:last-child)': {\n          '> ul': {\n            background:\n              \"url('data:image/gif;base64,R0lGODlhCQACAIAAAMzMzP///yH5BAEAAAEALAAAAAAJAAIAAAIEjI9pUAA7') 0 0 repeat-y\",\n          },\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -18px',\n          },\n        },\n        '.rc-tree-treenode:last-child': {\n          '> .rc-tree-switcher-noop': {\n            backgroundPosition: '-56px -36px',\n          },\n        },\n      },\n      '&-child-tree': {\n        display: 'none',\n        '&-open': {\n          display: 'block',\n        },\n      },\n      '&-treenode-disabled': {\n        '> span:not(.rc-tree-switcher), > a, > a span': {\n          color: '#767676',\n          cursor: 'not-allowed',\n        },\n      },\n      '&-treenode-active': {\n        background: 'rgba(0, 0, 0, 0.1)',\n      },\n      '&-node-selected': {\n        opacity: 0.8,\n      },\n      '&-icon__open': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -16px',\n      },\n      '&-icon__close': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px 0',\n      },\n      '&-icon__docu': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n        backgroundPosition: '-110px -32px',\n      },\n      '&-icon__customize': {\n        marginRight: '2px',\n        verticalAlign: 'top',\n      },\n      '&-title': {\n        display: 'inline-block',\n      },\n      '&-indent': {\n        display: 'inline-block',\n        height: 0,\n        verticalAlign: 'bottom',\n      },\n      '&-indent-unit': {\n        display: 'inline-block',\n        width: '16px',\n      },\n      '&-draggable-icon': {\n        display: 'inline-flex',\n        justifyContent: 'center',\n        width: '16px',\n      },\n    },\n  });\n}\n","import { css } from '@emotion/css';\n\nimport { GrafanaTheme2 } from '@grafana/data';\nimport { IconButton, useStyles2 } from '@grafana/ui';\nimport { LayerName } from 'app/core/components/Layers/LayerName';\nimport { ElementState } from 'app/features/canvas/runtime/element';\n\nimport { LayerActionID } from '../../types';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeElement } from './tree';\n\ninterface Props {\n  settings: TreeViewEditorProps;\n  nodeData: TreeElement;\n  setAllowSelection: (allow: boolean) => void;\n}\n\nexport const TreeNodeTitle = ({ settings, nodeData, setAllowSelection }: Props) => {\n  const element = nodeData.dataRef;\n  const name = nodeData.dataRef.getName();\n\n  const styles = useStyles2(getStyles);\n\n  const layer = settings.layer;\n\n  const getScene = () => {\n    if (!settings?.layer) {\n      return;\n    }\n\n    return settings.layer.scene;\n  };\n\n  const onDelete = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Delete, element);\n    setAllowSelection(false);\n  };\n\n  const onDuplicate = (element: ElementState) => {\n    const elLayer = element.parent ?? layer;\n    elLayer.doAction(LayerActionID.Duplicate, element);\n    setAllowSelection(false);\n  };\n\n  const onNameChange = (element: ElementState, name: string) => {\n    element.onChange({ ...element.options, name });\n  };\n\n  const verifyLayerNameUniqueness = (nameToVerify: string) => {\n    const scene = getScene();\n\n    return Boolean(scene?.canRename(nameToVerify));\n  };\n\n  const getLayerInfo = (element: ElementState) => {\n    return element.options.type;\n  };\n\n  return (\n    <>\n      <LayerName\n        name={name}\n        onChange={(v) => onNameChange(element, v)}\n        verifyLayerNameUniqueness={verifyLayerNameUniqueness ?? undefined}\n      />\n\n      <div className={styles.textWrapper}>&nbsp; {getLayerInfo(element)}</div>\n\n      {!nodeData.children && (\n        <div className={styles.actionButtonsWrapper}>\n          <IconButton\n            name=\"copy\"\n            title=\"Duplicate\"\n            className={styles.actionIcon}\n            onClick={() => onDuplicate(element)}\n            tooltip=\"Duplicate\"\n          />\n          <IconButton\n            name=\"trash-alt\"\n            title=\"remove\"\n            className={styles.actionIcon}\n            onClick={() => onDelete(element)}\n            tooltip=\"Remove\"\n          />\n        </div>\n      )}\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  actionButtonsWrapper: css({\n    display: 'flex',\n    alignItems: 'flex-end',\n  }),\n  actionIcon: css({\n    color: theme.colors.text.secondary,\n    cursor: 'pointer',\n    '&:hover': {\n      color: theme.colors.text.primary,\n    },\n  }),\n  textWrapper: css({\n    display: 'flex',\n    alignItems: 'center',\n    flexGrow: 1,\n    overflow: 'hidden',\n    marginRight: theme.spacing(1),\n  }),\n  layerName: css({\n    fontWeight: theme.typography.fontWeightMedium,\n    color: theme.colors.primary.text,\n    cursor: 'pointer',\n    overflow: 'hidden',\n    marginLeft: theme.spacing(0.5),\n  }),\n});\n","import { CSSProperties } from 'react';\n\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { RootElement } from 'app/features/canvas/runtime/root';\n\nimport { DragNode, DropNode } from '../../types';\n\nexport interface TreeElement {\n  key: number;\n  title: string;\n  selectable?: boolean;\n  children?: TreeElement[];\n  dataRef: ElementState | FrameState;\n  style?: CSSProperties;\n}\n\nexport function getTreeData(root?: RootElement | FrameState, selection?: string[], selectedColor?: string) {\n  let elements: TreeElement[] = [];\n  if (root) {\n    for (let i = root.elements.length; i--; i >= 0) {\n      const item = root.elements[i];\n      const element: TreeElement = {\n        key: item.UID,\n        title: item.getName(),\n        selectable: true,\n        dataRef: item,\n      };\n\n      if (item instanceof FrameState) {\n        element.children = getTreeData(item, selection, selectedColor);\n      }\n      elements.push(element);\n    }\n  }\n\n  return elements;\n}\n\nexport function onNodeDrop(\n  info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean },\n  treeData: TreeElement[]\n) {\n  const destKey = info.node.key;\n  const srcKey = info.dragNode.key;\n  const destPos = info.node.pos.split('-');\n  const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n  const loop = (\n    data: TreeElement[],\n    key: number,\n    callback: { (item: TreeElement, index: number, arr: TreeElement[]): void }\n  ) => {\n    data.forEach((item, index, arr) => {\n      if (item.key === key) {\n        callback(item, index, arr);\n        return;\n      }\n      if (item.children) {\n        loop(item.children, key, callback);\n      }\n    });\n  };\n  const data = [...treeData];\n\n  // Find dragObject\n  let srcElement: TreeElement | undefined = undefined;\n  loop(data, srcKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n    arr.splice(index, 1);\n    srcElement = item;\n  });\n\n  if (destPosition === 0) {\n    // Drop on the content\n    loop(data, destKey, (item: TreeElement) => {\n      item.children = item.children || [];\n      item.children.unshift(srcElement!);\n    });\n  } else {\n    // Drop on the gap (insert before or insert after)\n    let ar: TreeElement[] = [];\n    let i = 0;\n    loop(data, destKey, (item: TreeElement, index: number, arr: TreeElement[]) => {\n      ar = arr;\n      i = index;\n    });\n\n    if (destPosition === -1) {\n      ar.splice(i, 0, srcElement!);\n    } else {\n      ar.splice(i + 1, 0, srcElement!);\n    }\n  }\n\n  return data;\n}\n","import { css } from '@emotion/css';\nimport { Global } from '@emotion/react';\nimport Tree, { TreeNodeProps } from 'rc-tree';\nimport { Key, useEffect, useMemo, useState } from 'react';\n\nimport { GrafanaTheme2, StandardEditorProps } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { Button, Icon, Stack, useStyles2, useTheme2 } from '@grafana/ui';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { frameSelection, reorderElements } from 'app/features/canvas/runtime/sceneElementManagement';\n\nimport { getGlobalStyles } from '../../globalStyles';\nimport { Options } from '../../panelcfg.gen';\nimport { DragNode, DropNode } from '../../types';\nimport { doSelect, getElementTypes, onAddItem } from '../../utils';\nimport { TreeViewEditorProps } from '../element/elementEditor';\n\nimport { TreeNodeTitle } from './TreeNodeTitle';\nimport { getTreeData, onNodeDrop, TreeElement } from './tree';\n\nlet allowSelection = true;\n\nexport const TreeNavigationEditor = ({ item }: StandardEditorProps<unknown, TreeViewEditorProps, Options>) => {\n  const [treeData, setTreeData] = useState(getTreeData(item?.settings?.scene.root));\n  const [autoExpandParent, setAutoExpandParent] = useState(true);\n  const [expandedKeys, setExpandedKeys] = useState<Key[]>([]);\n  const [selectedKeys, setSelectedKeys] = useState<Key[]>([]);\n\n  const theme = useTheme2();\n  const globalCSS = getGlobalStyles(theme);\n  const styles = useStyles2(getStyles);\n\n  const selectedBgColor = theme.colors.primary.border;\n  const { settings } = item;\n  const selection = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.getName()) : []),\n    [settings?.selected]\n  );\n\n  const selectionByUID = useMemo(\n    () => (settings?.selected ? settings.selected.map((v) => v?.UID) : []),\n    [settings?.selected]\n  );\n\n  useEffect(() => {\n    setTreeData(getTreeData(item?.settings?.scene.root, selection, selectedBgColor));\n    setSelectedKeys(selectionByUID);\n    setAllowSelection();\n  }, [item?.settings?.scene.root, selectedBgColor, selection, selectionByUID]);\n\n  if (!settings) {\n    return <div>No settings</div>;\n  }\n\n  const layer = settings.layer;\n  if (!layer) {\n    return <div>Missing layer?</div>;\n  }\n\n  const onSelect = (selectedKeys: Key[], info: { node: { dataRef: ElementState } }) => {\n    if (allowSelection && item.settings?.scene) {\n      doSelect(item.settings.scene, info.node.dataRef);\n    }\n  };\n\n  const allowDrop = () => {\n    return true;\n  };\n\n  const onDrop = (info: { node: DropNode; dragNode: DragNode; dropPosition: number; dropToGap: boolean }) => {\n    const destPos = info.node.pos.split('-');\n    const destPosition = info.dropPosition - Number(destPos[destPos.length - 1]);\n\n    const srcEl = info.dragNode.dataRef;\n    const destEl = info.node.dataRef;\n\n    const data = onNodeDrop(info, treeData);\n\n    setTreeData(data);\n    reorderElements(srcEl, destEl, info.dropToGap, destPosition);\n  };\n\n  const onExpand = (expandedKeys: Key[]) => {\n    setExpandedKeys(expandedKeys);\n    setAutoExpandParent(false);\n  };\n\n  const switcherIcon = (obj: TreeNodeProps) => {\n    if (obj.isLeaf) {\n      // TODO: Implement element specific icons\n      return <></>;\n    }\n\n    return (\n      <Icon\n        name=\"angle-right\"\n        title={'Node Icon'}\n        style={{\n          transform: `rotate(${obj.expanded ? 90 : 0}deg)`,\n          fill: theme.colors.text.primary,\n        }}\n      />\n    );\n  };\n\n  const setAllowSelection = (allow = true) => {\n    allowSelection = allow;\n  };\n\n  const onClearSelection = () => {\n    layer.scene.clearCurrentSelection();\n  };\n\n  const onTitleRender = (nodeData: TreeElement) => {\n    return <TreeNodeTitle nodeData={nodeData} setAllowSelection={setAllowSelection} settings={settings} />;\n  };\n\n  // TODO: This functionality is currently kinda broken / no way to decouple / delete created frames at this time\n  const onFrameSelection = () => {\n    if (layer.scene) {\n      frameSelection(layer.scene);\n    } else {\n      console.warn('no scene!');\n    }\n  };\n\n  const typeOptions = getElementTypes(settings.scene.shouldShowAdvancedTypes).options;\n\n  return (\n    <>\n      <Global styles={globalCSS} />\n      <Tree\n        selectable={true}\n        onSelect={onSelect}\n        draggable={true}\n        defaultExpandAll={true}\n        autoExpandParent={autoExpandParent}\n        showIcon={false}\n        allowDrop={allowDrop}\n        onDrop={onDrop}\n        expandedKeys={expandedKeys}\n        onExpand={onExpand}\n        treeData={treeData}\n        titleRender={onTitleRender}\n        switcherIcon={switcherIcon}\n        selectedKeys={selectedKeys}\n        multiple={true}\n      />\n\n      <Stack justifyContent=\"space-between\" direction=\"row\">\n        <div className={styles.addLayerButton}>\n          <AddLayerButton onChange={(sel) => onAddItem(sel, layer)} options={typeOptions} label={'Add item'} />\n        </div>\n        {selection.length > 0 && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onClearSelection}>\n            Clear selection\n          </Button>\n        )}\n        {selection.length > 1 && config.featureToggles.canvasPanelNesting && (\n          <Button size=\"sm\" variant=\"secondary\" onClick={onFrameSelection}>\n            Frame selection\n          </Button>\n        )}\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  addLayerButton: css({\n    marginLeft: '18px',\n    minWidth: '150px',\n  }),\n});\n","import { get as lodashGet } from 'lodash';\n\nimport { NestedPanelOptions, NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { InstanceState } from '../../CanvasPanel';\nimport { PlacementEditor } from '../element/PlacementEditor';\nimport { optionBuilder } from '../options';\n\nimport { TreeNavigationEditor } from './TreeNavigationEditor';\n\nexport interface LayerEditorProps {\n  scene: Scene;\n  layer: FrameState;\n  selected: ElementState[];\n}\n\nexport function getLayerEditor(opts: InstanceState): NestedPanelOptions<LayerEditorProps> {\n  const { selected, scene } = opts;\n\n  if (!scene.currentLayer) {\n    scene.currentLayer = scene.root;\n  }\n\n  if (selected) {\n    for (const element of selected) {\n      if (element instanceof FrameState) {\n        scene.currentLayer = element;\n        break;\n      }\n\n      if (element && element.parent) {\n        scene.currentLayer = element.parent;\n        break;\n      }\n    }\n  }\n\n  const options = scene.currentLayer.options || { elements: [] };\n\n  return {\n    category: ['Layer'],\n    path: '--', // not used!\n\n    // Note that canvas editor writes things to the scene!\n    values: (parent: NestedValueAccess) => ({\n      getValue: (path) => {\n        return lodashGet(options, path);\n      },\n      onChange: (path, value) => {\n        if (path === 'type' && value) {\n          console.warn('unable to change layer type');\n          return;\n        }\n        const c = setOptionImmutably(options, path, value);\n        scene.currentLayer?.onChange(c);\n        scene.currentLayer?.updateData(scene.context);\n      },\n    }),\n\n    // Dynamically fill the selected element\n    build: (builder, context) => {\n      const currentLayer = scene.currentLayer;\n      if (currentLayer && !currentLayer.isRoot()) {\n        // TODO: the non-root nav option\n      }\n\n      builder.addCustomEditor({\n        id: 'content',\n        path: 'root',\n        name: 'Elements',\n        editor: TreeNavigationEditor,\n        settings: { scene, layer: scene.currentLayer, selected },\n      });\n\n      const ctx = { ...context, options };\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBackground(builder as any, ctx);\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any, @typescript-eslint/consistent-type-assertions\n      optionBuilder.addBorder(builder as any, ctx);\n\n      if (currentLayer && !currentLayer.isRoot()) {\n        builder.addCustomEditor({\n          category: ['Layout'],\n          id: 'content',\n          path: '__', // not used\n          name: 'Constraints',\n          editor: PlacementEditor,\n          settings: {\n            scene: opts.scene,\n            element: currentLayer,\n          },\n        });\n      }\n    },\n  };\n}\n","import { useState } from 'react';\n\nimport { Tab, TabsBar } from '@grafana/ui/src';\n\nimport { InlineEditTabs } from '../../types';\n\ntype Props = {\n  onTabChange: (v: string) => void;\n};\n\nexport const TabsEditor = ({ onTabChange }: Props) => {\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const tabs = [\n    { label: 'Selected Element', value: InlineEditTabs.SelectedElement },\n    { label: 'Element Management', value: InlineEditTabs.ElementManagement },\n  ];\n\n  const onCurrentTabChange = (value: string) => {\n    onTabChange(value);\n    setActiveTab(value);\n  };\n\n  return (\n    <>\n      <TabsBar>\n        {tabs.map((t, index) => (\n          <Tab\n            key={`${t.value}-${index}`}\n            label={t.label}\n            active={t.value === activeTab}\n            onChangeTab={() => onCurrentTabChange(t.value!)}\n          />\n        ))}\n      </TabsBar>\n    </>\n  );\n};\n","import { css } from '@emotion/css';\nimport { get as lodashGet } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { useObservable } from 'react-use';\n\nimport { DataFrame, GrafanaTheme2, PanelOptionsEditorBuilder, StandardEditorContext } from '@grafana/data';\nimport { PanelOptionsSupplier } from '@grafana/data/src/panel/PanelPlugin';\nimport { NestedValueAccess } from '@grafana/data/src/utils/OptionsUIBuilders';\nimport { useStyles2 } from '@grafana/ui/src';\nimport { AddLayerButton } from 'app/core/components/Layers/AddLayerButton';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\nimport { OptionsPaneCategory } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategory';\nimport { OptionsPaneCategoryDescriptor } from 'app/features/dashboard/components/PanelEditor/OptionsPaneCategoryDescriptor';\nimport { fillOptionsPaneItems } from 'app/features/dashboard/components/PanelEditor/getVisualizationOptions';\nimport { setOptionImmutably } from 'app/features/dashboard/components/PanelEditor/utils';\n\nimport { activePanelSubject, InstanceState } from '../../CanvasPanel';\nimport { addStandardCanvasEditorOptions } from '../../module';\nimport { Options } from '../../panelcfg.gen';\nimport { InlineEditTabs } from '../../types';\nimport { getElementTypes, onAddItem } from '../../utils';\nimport { getConnectionEditor } from '../connectionEditor';\nimport { getElementEditor } from '../element/elementEditor';\nimport { getLayerEditor } from '../layer/layerEditor';\n\nimport { TabsEditor } from './TabsEditor';\n\nexport function InlineEditBody() {\n  const activePanel = useObservable(activePanelSubject);\n  const instanceState = activePanel?.panel.context?.instanceState;\n  const styles = useStyles2(getStyles);\n\n  const [activeTab, setActiveTab] = useState<string>(InlineEditTabs.SelectedElement);\n\n  const pane = useMemo(() => {\n    const p = activePanel?.panel;\n    const state: InstanceState = instanceState;\n    if (!(state && state.scene) || !p) {\n      return new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n    }\n\n    const supplier = (builder: PanelOptionsEditorBuilder<Options>) => {\n      if (activeTab === InlineEditTabs.ElementManagement) {\n        builder.addNestedOptions(getLayerEditor(instanceState));\n      }\n\n      const selectedConnection = state.selectedConnection;\n      if (selectedConnection && activeTab === InlineEditTabs.SelectedElement) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: [`Selected connection`],\n            connection: selectedConnection,\n            scene: state.scene,\n          })\n        );\n      }\n\n      const selection = state.selected;\n      if (selection?.length === 1 && activeTab === InlineEditTabs.SelectedElement) {\n        const element = selection[0];\n        if (element && !(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [`Selected element (${element.options.name})`],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      addStandardCanvasEditorOptions(builder);\n    };\n\n    return getOptionsPaneCategoryDescriptor(\n      {\n        options: p.props.options,\n        onChange: p.props.onOptionsChange,\n        data: p.props.data?.series,\n      },\n      supplier\n    );\n  }, [instanceState, activePanel, activeTab]);\n\n  const topLevelItemsContainerStyle = {\n    marginLeft: 15,\n    marginTop: 10,\n  };\n\n  const onTabChange = (tab: string) => {\n    setActiveTab(tab);\n  };\n\n  const typeOptions = getElementTypes(instanceState?.scene.shouldShowAdvancedTypes).options;\n  const rootLayer: FrameState | undefined = instanceState?.layer;\n\n  const noElementSelected =\n    instanceState &&\n    activeTab === InlineEditTabs.SelectedElement &&\n    instanceState.selected.length === 0 &&\n    instanceState.selectedConnection === undefined;\n\n  return (\n    <>\n      <div style={topLevelItemsContainerStyle}>{pane.items.map((item) => item.render())}</div>\n      <div style={topLevelItemsContainerStyle}>\n        <AddLayerButton onChange={(sel) => onAddItem(sel, rootLayer)} options={typeOptions} label={'Add item'} />\n      </div>\n      <div style={topLevelItemsContainerStyle}>\n        <TabsEditor onTabChange={onTabChange} />\n        {pane.categories.map((p) => renderOptionsPaneCategoryDescriptor(p))}\n        {noElementSelected && <div className={styles.selectElement}>Please select an element</div>}\n      </div>\n    </>\n  );\n}\n\n// Recursively render options\nfunction renderOptionsPaneCategoryDescriptor(pane: OptionsPaneCategoryDescriptor) {\n  return (\n    <OptionsPaneCategory {...pane.props} key={pane.props.id}>\n      <div>{pane.items.map((v) => v.render())}</div>\n      {pane.categories.map((c) => renderOptionsPaneCategoryDescriptor(c))}\n    </OptionsPaneCategory>\n  );\n}\n\ninterface EditorProps<T> {\n  onChange: (v: T) => void;\n  options: T;\n  data?: DataFrame[];\n}\n\nfunction getOptionsPaneCategoryDescriptor<T extends object>(\n  props: EditorProps<T>,\n  supplier: PanelOptionsSupplier<T>\n): OptionsPaneCategoryDescriptor {\n  const context: StandardEditorContext<unknown, unknown> = {\n    data: props.data ?? [],\n    options: props.options,\n  };\n\n  const root = new OptionsPaneCategoryDescriptor({ id: 'root', title: 'root' });\n  const getOptionsPaneCategory = (categoryNames?: string[]): OptionsPaneCategoryDescriptor => {\n    if (categoryNames?.length) {\n      const key = categoryNames[0];\n      let sub = root.categories.find((v) => v.props.id === key);\n      if (!sub) {\n        sub = new OptionsPaneCategoryDescriptor({ id: key, title: key });\n        root.categories.push(sub);\n      }\n      return sub;\n    }\n    return root;\n  };\n\n  const access: NestedValueAccess = {\n    getValue: (path) => lodashGet(props.options, path),\n    onChange: (path, value) => {\n      props.onChange(setOptionImmutably<T>(props.options, path, value));\n    },\n  };\n\n  // Use the panel options loader\n  fillOptionsPaneItems(supplier, access, getOptionsPaneCategory, context);\n  return root;\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  selectElement: css({\n    color: theme.colors.text.secondary,\n    padding: theme.spacing(2),\n  }),\n});\n","import { css } from '@emotion/css';\nimport { SyntheticEvent, useEffect, useRef, useState } from 'react';\nimport Draggable, { DraggableEventHandler } from 'react-draggable';\nimport { Resizable, ResizeCallbackData } from 'react-resizable';\n\nimport { Dimensions2D, GrafanaTheme2 } from '@grafana/data';\nimport { IconButton, Portal, useStyles2 } from '@grafana/ui';\nimport store from 'app/core/store';\nimport { Scene } from 'app/features/canvas/runtime/scene';\n\nimport { InlineEditBody } from './InlineEditBody';\n\ntype Props = {\n  onClose?: () => void;\n  id: number;\n  scene: Scene;\n};\n\nconst OFFSET_X = 10;\nconst OFFSET_Y = 32;\n\nexport function InlineEdit({ onClose, id, scene }: Props) {\n  const root = scene.root.div?.getBoundingClientRect();\n  const windowHeight = window.innerHeight;\n  const windowWidth = window.innerWidth;\n  const ref = useRef<HTMLDivElement>(null);\n  const styles = useStyles2(getStyles);\n  const inlineEditKey = 'inlineEditPanel' + id.toString();\n\n  const defaultMeasurements = { width: 400, height: 400 };\n  const widthOffset = root?.width ?? defaultMeasurements.width + OFFSET_X * 2;\n  const defaultX = root?.x ?? 0 + widthOffset - defaultMeasurements.width - OFFSET_X;\n  const defaultY = root?.y ?? 0 + OFFSET_Y;\n\n  const savedPlacement = store.getObject(inlineEditKey, {\n    x: defaultX,\n    y: defaultY,\n    w: defaultMeasurements.width,\n    h: defaultMeasurements.height,\n  });\n  const [measurements, setMeasurements] = useState<Dimensions2D>({ width: savedPlacement.w, height: savedPlacement.h });\n  const [placement, setPlacement] = useState({ x: savedPlacement.x, y: savedPlacement.y });\n\n  // Checks that placement is within browser window\n  useEffect(() => {\n    const minX = windowWidth - measurements.width - OFFSET_X;\n    const minY = windowHeight - measurements.height - OFFSET_Y;\n    if (minX < placement.x && minX > 0) {\n      setPlacement({ ...placement, x: minX });\n    }\n    if (minY < placement.y && minY > 0) {\n      setPlacement({ ...placement, y: minY });\n    }\n  }, [windowHeight, windowWidth, placement, measurements]);\n\n  const onDragStop: DraggableEventHandler = (event, dragElement) => {\n    let x = dragElement.x < 0 ? 0 : dragElement.x;\n    let y = dragElement.y < 0 ? 0 : dragElement.y;\n\n    setPlacement({ x: x, y: y });\n    saveToStore(x, y, measurements.width, measurements.height);\n  };\n\n  const onResizeStop = (event: SyntheticEvent<Element, Event>, data: ResizeCallbackData) => {\n    const { size } = data;\n    setMeasurements({ width: size.width, height: size.height });\n    saveToStore(placement.x, placement.y, size.width, size.height);\n  };\n\n  const saveToStore = (x: number, y: number, width: number, height: number) => {\n    store.setObject(inlineEditKey, { x: x, y: y, w: width, h: height });\n  };\n\n  return (\n    <Portal>\n      <div className={styles.draggableWrapper}>\n        <Draggable handle=\"strong\" onStop={onDragStop} position={{ x: placement.x, y: placement.y }}>\n          <Resizable height={measurements.height} width={measurements.width} onResize={onResizeStop}>\n            <div\n              className={styles.inlineEditorContainer}\n              style={{ height: `${measurements.height}px`, width: `${measurements.width}px` }}\n              ref={ref}\n            >\n              <strong className={styles.inlineEditorHeader}>\n                <div className={styles.placeholder} />\n                <div>Canvas Inline Editor</div>\n                <IconButton\n                  name=\"times\"\n                  size=\"xl\"\n                  className={styles.inlineEditorClose}\n                  onClick={onClose}\n                  tooltip=\"Close inline editor\"\n                />\n              </strong>\n              <div className={styles.inlineEditorContentWrapper}>\n                <div className={styles.inlineEditorContent}>\n                  <InlineEditBody />\n                </div>\n              </div>\n            </div>\n          </Resizable>\n        </Draggable>\n      </div>\n    </Portal>\n  );\n}\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  inlineEditorContainer: css({\n    display: 'flex',\n    flexDirection: 'column',\n    background: theme.components.panel.background,\n    border: `1px solid ${theme.colors.border.weak}`,\n    boxShadow: theme.shadows.z3,\n    zIndex: 1000,\n    opacity: 1,\n    minWidth: '400px',\n  }),\n  draggableWrapper: css({\n    width: 0,\n    height: 0,\n  }),\n  inlineEditorHeader: css({\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    background: theme.colors.background.canvas,\n    borderBottom: `1px solid ${theme.colors.border.weak}`,\n    height: '40px',\n    cursor: 'move',\n  }),\n  inlineEditorContent: css({\n    whiteSpace: 'pre-wrap',\n    padding: '10px',\n  }),\n  inlineEditorClose: css({\n    marginLeft: 'auto',\n  }),\n  placeholder: css({\n    width: '24px',\n    height: '24px',\n    visibility: 'hidden',\n    marginRight: 'auto',\n  }),\n  inlineEditorContentWrapper: css({\n    overflow: 'scroll',\n  }),\n});\n","import { Component } from 'react';\nimport * as React from 'react';\nimport { ReplaySubject, Subscription } from 'rxjs';\n\nimport { PanelProps } from '@grafana/data';\nimport { locationService } from '@grafana/runtime/src';\nimport { PanelContext, PanelContextRoot } from '@grafana/ui';\nimport { CanvasFrameOptions } from 'app/features/canvas/frame';\nimport { ElementState } from 'app/features/canvas/runtime/element';\nimport { Scene } from 'app/features/canvas/runtime/scene';\nimport { getDashboardSrv } from 'app/features/dashboard/services/DashboardSrv';\nimport { PanelEditEnteredEvent, PanelEditExitedEvent } from 'app/types/events';\n\nimport { SetBackground } from './components/SetBackground';\nimport { InlineEdit } from './editor/inline/InlineEdit';\nimport { Options } from './panelcfg.gen';\nimport { AnchorPoint, CanvasTooltipPayload, ConnectionState } from './types';\n\ninterface Props extends PanelProps<Options> {}\n\ninterface State {\n  refresh: number;\n  openInlineEdit: boolean;\n  openSetBackground: boolean;\n  contextMenuAnchorPoint: AnchorPoint;\n  moveableAction: boolean;\n}\n\nexport interface InstanceState {\n  scene: Scene;\n  selected: ElementState[];\n  selectedConnection?: ConnectionState;\n}\n\nexport interface SelectionAction {\n  panel: CanvasPanel;\n}\n\nlet canvasInstances: CanvasPanel[] = [];\nlet activeCanvasPanel: CanvasPanel | undefined = undefined;\nlet isInlineEditOpen = false;\nlet isSetBackgroundOpen = false;\n\nexport const activePanelSubject = new ReplaySubject<SelectionAction>(1);\n\nexport class CanvasPanel extends Component<Props, State> {\n  declare context: React.ContextType<typeof PanelContextRoot>;\n  static contextType = PanelContextRoot;\n  panelContext: PanelContext | undefined;\n\n  readonly scene: Scene;\n  private subs = new Subscription();\n  needsReload = false;\n  isEditing = locationService.getSearchObject().editPanel !== undefined;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      refresh: 0,\n      openInlineEdit: false,\n      openSetBackground: false,\n      contextMenuAnchorPoint: { x: 0, y: 0 },\n      moveableAction: false,\n    };\n\n    // TODO: Will need to update this approach for dashboard scenes\n    // migration (new dashboard edit experience)\n    const dashboard = getDashboardSrv().getCurrent();\n    const allowEditing = this.props.options.inlineEditing && dashboard?.editable;\n\n    // Only the initial options are ever used.\n    // later changes are all controlled by the scene\n    this.scene = new Scene(\n      this.props.options.root,\n      allowEditing,\n      this.props.options.showAdvancedTypes,\n      this.props.options.panZoom,\n      this.props.options.infinitePan,\n      this.onUpdateScene,\n      this\n    );\n    this.scene.updateSize(props.width, props.height);\n    this.scene.updateData(props.data);\n    this.scene.inlineEditingCallback = this.openInlineEdit;\n    this.scene.setBackgroundCallback = this.openSetBackground;\n    this.scene.tooltipCallback = this.tooltipCallback;\n    this.scene.moveableActionCallback = this.moveableActionCallback;\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditEnteredEvent, (evt: PanelEditEnteredEvent) => {\n        // Remove current selection when entering edit mode for any panel in dashboard\n        this.scene.clearCurrentSelection();\n        this.closeInlineEdit();\n      })\n    );\n\n    this.subs.add(\n      this.props.eventBus.subscribe(PanelEditExitedEvent, (evt: PanelEditExitedEvent) => {\n        if (this.props.id === evt.payload) {\n          this.needsReload = true;\n          this.scene.clearCurrentSelection();\n        }\n      })\n    );\n  }\n\n  componentDidMount() {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n\n    this.panelContext = this.context;\n    if (this.panelContext.onInstanceStateChange) {\n      this.panelContext.onInstanceStateChange({\n        scene: this.scene,\n        layer: this.scene.root,\n      });\n\n      this.subs.add(\n        this.scene.selection.subscribe({\n          next: (v) => {\n            if (v.length) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            this.panelContext?.onInstanceStateChange!({\n              scene: this.scene,\n              selected: v,\n              layer: this.scene.root,\n            });\n          },\n        })\n      );\n\n      this.subs.add(\n        this.scene.connections.selection.subscribe({\n          next: (v) => {\n            if (!this.context.instanceState) {\n              return;\n            }\n\n            this.panelContext?.onInstanceStateChange!({\n              scene: this.scene,\n              selected: this.context.instanceState.selected,\n              selectedConnection: v,\n              layer: this.scene.root,\n            });\n\n            if (v) {\n              activeCanvasPanel = this;\n              activePanelSubject.next({ panel: this });\n            }\n\n            canvasInstances.forEach((canvasInstance) => {\n              if (canvasInstance !== activeCanvasPanel) {\n                canvasInstance.scene.clearCurrentSelection(true);\n                canvasInstance.scene.connections.select(undefined);\n              }\n            });\n\n            setTimeout(() => {\n              this.forceUpdate();\n            });\n          },\n        })\n      );\n    }\n\n    canvasInstances.push(this);\n  }\n\n  componentWillUnmount() {\n    this.scene.subscription.unsubscribe();\n    this.subs.unsubscribe();\n    isInlineEditOpen = false;\n    isSetBackgroundOpen = false;\n    canvasInstances = canvasInstances.filter((ci) => ci.props.id !== activeCanvasPanel?.props.id);\n  }\n\n  // NOTE, all changes to the scene flow through this function\n  // even the editor gets current state from the same scene instance!\n  onUpdateScene = (root: CanvasFrameOptions) => {\n    const { onOptionsChange, options } = this.props;\n    onOptionsChange({\n      ...options,\n      root,\n    });\n\n    this.setState({ refresh: this.state.refresh + 1 });\n    activePanelSubject.next({ panel: this });\n  };\n\n  shouldComponentUpdate(nextProps: Props, nextState: State) {\n    const { width, height, data, options } = this.props;\n    let changed = false;\n\n    if (width !== nextProps.width || height !== nextProps.height) {\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      changed = true;\n    }\n\n    if (data !== nextProps.data && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (options !== nextProps.options && !this.scene.ignoreDataUpdate) {\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    if (this.state.refresh !== nextState.refresh) {\n      changed = true;\n    }\n\n    if (this.state.openInlineEdit !== nextState.openInlineEdit) {\n      changed = true;\n    }\n\n    if (this.state.openSetBackground !== nextState.openSetBackground) {\n      changed = true;\n    }\n\n    if (this.state.moveableAction !== nextState.moveableAction) {\n      changed = true;\n    }\n\n    // After editing, the options are valid, but the scene was in a different panel or inline editing mode has changed\n    const inlineEditingSwitched = this.props.options.inlineEditing !== nextProps.options.inlineEditing;\n    const shouldShowAdvancedTypesSwitched =\n      this.props.options.showAdvancedTypes !== nextProps.options.showAdvancedTypes;\n    const panZoomSwitched = this.props.options.panZoom !== nextProps.options.panZoom;\n    const infinitePanSwitched = this.props.options.infinitePan !== nextProps.options.infinitePan;\n    if (\n      this.needsReload ||\n      inlineEditingSwitched ||\n      shouldShowAdvancedTypesSwitched ||\n      panZoomSwitched ||\n      infinitePanSwitched\n    ) {\n      if (inlineEditingSwitched) {\n        // Replace scene div to prevent selecto instance leaks\n        this.scene.revId++;\n      }\n\n      this.needsReload = false;\n      this.scene.load(\n        nextProps.options.root,\n        nextProps.options.inlineEditing,\n        nextProps.options.showAdvancedTypes,\n        nextProps.options.panZoom,\n        nextProps.options.infinitePan\n      );\n      this.scene.updateSize(nextProps.width, nextProps.height);\n      this.scene.updateData(nextProps.data);\n      changed = true;\n    }\n\n    return changed;\n  }\n\n  openInlineEdit = () => {\n    if (isInlineEditOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openInlineEdit: true });\n    isInlineEditOpen = true;\n  };\n\n  openSetBackground = (anchorPoint: AnchorPoint) => {\n    if (isSetBackgroundOpen) {\n      this.forceUpdate();\n      this.setActivePanel();\n      return;\n    }\n\n    this.setActivePanel();\n    this.setState({ openSetBackground: true });\n    this.setState({ contextMenuAnchorPoint: anchorPoint });\n\n    isSetBackgroundOpen = true;\n  };\n\n  tooltipCallback = (tooltip: CanvasTooltipPayload | undefined) => {\n    this.scene.tooltip = tooltip;\n    this.forceUpdate();\n  };\n\n  moveableActionCallback = (updated: boolean) => {\n    this.setState({ moveableAction: updated });\n    this.forceUpdate();\n  };\n\n  closeInlineEdit = () => {\n    this.setState({ openInlineEdit: false });\n    isInlineEditOpen = false;\n  };\n\n  closeSetBackground = () => {\n    this.setState({ openSetBackground: false });\n    isSetBackgroundOpen = false;\n  };\n\n  setActivePanel = () => {\n    activeCanvasPanel = this;\n    activePanelSubject.next({ panel: this });\n  };\n\n  renderInlineEdit = () => {\n    return <InlineEdit onClose={() => this.closeInlineEdit()} id={this.props.id} scene={this.scene} />;\n  };\n\n  renderSetBackground = () => {\n    return (\n      <SetBackground\n        onClose={() => this.closeSetBackground()}\n        scene={this.scene}\n        anchorPoint={this.state.contextMenuAnchorPoint}\n      />\n    );\n  };\n\n  render() {\n    return (\n      <>\n        {this.scene.render()}\n        {this.state.openInlineEdit && this.renderInlineEdit()}\n        {this.state.openSetBackground && this.renderSetBackground()}\n      </>\n    );\n  }\n}\n","import { css } from '@emotion/css';\n\nimport { StandardEditorProps, GrafanaTheme2 } from '@grafana/data';\nimport { Alert, Icon, Stack, useStyles2 } from '@grafana/ui';\n\nconst helpUrl = 'https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/canvas/';\n\nexport const PanZoomHelp = ({}: StandardEditorProps<string, unknown, unknown, unknown>) => {\n  const styles = useStyles2(getStyles);\n\n  return (\n    <>\n      <Stack direction=\"row\">\n        <Alert\n          title=\"Pan and zoom controls\"\n          severity=\"info\"\n          buttonContent={<Icon name=\"question-circle\" size=\"xl\" />}\n          className={styles.alert}\n          onRemove={() => {\n            const newWindow = window.open(helpUrl, '_blank', 'noopener,noreferrer');\n            if (newWindow) {\n              newWindow.opener = null;\n            }\n          }}\n        >\n          <Stack direction=\"column\">\n            <ul>\n              <li>\n                Pan:\n                <ul>\n                  <li>Middle mouse</li>\n                  <li>CTRL + right mouse</li>\n                </ul>\n              </li>\n              <li>Zoom: Scroll wheel</li>\n              <li>Reset: Double click</li>\n            </ul>\n          </Stack>\n        </Alert>\n      </Stack>\n    </>\n  );\n};\n\nconst getStyles = (theme: GrafanaTheme2) => ({\n  alert: css({\n    '& div': { padding: '4px', alignItems: 'start' },\n    marginBottom: '0px',\n    marginTop: '5px',\n    padding: '2px',\n    'ul > li': { marginLeft: '10px' },\n  }),\n});\n","import { PanelModel, OneClickMode } from '@grafana/data';\n\nimport { Options } from './panelcfg.gen';\n\nexport const canvasMigrationHandler = (panel: PanelModel): Partial<Options> => {\n  const pluginVersion = panel?.pluginVersion ?? '';\n\n  // Rename text-box to rectangle\n  // Initial plugin version is empty string for first migration\n  if (pluginVersion === '') {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'text-box') {\n          element.type = 'rectangle';\n        }\n      }\n    }\n  }\n\n  if (pluginVersion.startsWith('11.0')) {\n    // Migration for v11.0 for ellipse element refactor: https://github.com/grafana/grafana/pull/84205\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        if (element.type === 'ellipse') {\n          // Take existing ellipse specific background and border config and apply it to the element's general background and border config\n          if (element.config.backgroundColor) {\n            element.background = element.config.backgroundColor;\n            delete element.config.backgroundColor;\n          }\n          if (element.config.borderColor) {\n            element.border.color = element.config.borderColor;\n            delete element.config.borderColor;\n          }\n          if (element.config.width) {\n            element.border.width = element.config.width;\n            delete element.config.width;\n          }\n        }\n      }\n    }\n  }\n\n  if (parseFloat(pluginVersion) <= 11.3) {\n    const root = panel.options?.root;\n    if (root?.elements) {\n      for (const element of root.elements) {\n        // migrate oneClickLinks to oneClickMode\n        if (element.oneClickLinks) {\n          element.oneClickMode = OneClickMode.Link;\n          delete element.oneClickLinks;\n        }\n\n        // migrate action options to new format (fetch)\n        if (element.actions) {\n          for (const action of element.actions) {\n            if (action.options) {\n              action.fetch = { ...action.options };\n              delete action.options;\n            }\n          }\n        }\n      }\n    }\n  }\n\n  return panel.options;\n};\n","import { FieldConfigProperty, PanelOptionsEditorBuilder, PanelPlugin } from '@grafana/data';\nimport { config } from '@grafana/runtime';\nimport { FrameState } from 'app/features/canvas/runtime/frame';\n\nimport { CanvasPanel, InstanceState } from './CanvasPanel';\nimport { getConnectionEditor } from './editor/connectionEditor';\nimport { getElementEditor } from './editor/element/elementEditor';\nimport { getLayerEditor } from './editor/layer/layerEditor';\nimport { PanZoomHelp } from './editor/panZoomHelp';\nimport { canvasMigrationHandler } from './migrations';\nimport { Options } from './panelcfg.gen';\n\nexport const addStandardCanvasEditorOptions = (builder: PanelOptionsEditorBuilder<Options>) => {\n  builder.addBooleanSwitch({\n    path: 'inlineEditing',\n    name: 'Inline editing',\n    description: 'Enable editing the panel directly',\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'showAdvancedTypes',\n    name: 'Experimental element types',\n    description: 'Enable selection of experimental element types',\n    defaultValue: true,\n  });\n\n  builder.addBooleanSwitch({\n    path: 'panZoom',\n    name: 'Pan and zoom',\n    description: 'Enable pan and zoom',\n    defaultValue: false,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom,\n  });\n  builder.addCustomEditor({\n    id: 'panZoomHelp',\n    path: 'panZoomHelp',\n    name: '',\n    editor: PanZoomHelp,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom && opts.panZoom,\n  });\n  builder.addBooleanSwitch({\n    path: 'infinitePan',\n    name: 'Infinite panning',\n    description:\n      'Enable infinite panning - useful for expansive canvases. Warning: this is an experimental feature and currently only works well with elements that are top / left constrained',\n    defaultValue: false,\n    showIf: (opts) => config.featureToggles.canvasPanelPanZoom && opts.panZoom,\n  });\n};\n\nexport const plugin = new PanelPlugin<Options>(CanvasPanel)\n  .setNoPadding() // extend to panel edges\n  .useFieldConfig({\n    standardOptions: {\n      [FieldConfigProperty.Mappings]: {\n        settings: {\n          icon: true,\n        },\n      },\n      [FieldConfigProperty.Links]: {\n        hideFromDefaults: true,\n      },\n    },\n  })\n  .setMigrationHandler(canvasMigrationHandler)\n  .setPanelOptions((builder, context) => {\n    const state: InstanceState = context.instanceState;\n\n    addStandardCanvasEditorOptions(builder);\n\n    if (state && state.scene) {\n      builder.addNestedOptions(getLayerEditor(state));\n\n      const selection = state.selected;\n      const connectionSelection = state.selectedConnection;\n\n      if (selection?.length === 1) {\n        const element = selection[0];\n        if (!(element instanceof FrameState)) {\n          builder.addNestedOptions(\n            getElementEditor({\n              category: [`Selected element (${element.options.name})`],\n              element,\n              scene: state.scene,\n            })\n          );\n        }\n      }\n\n      if (connectionSelection) {\n        builder.addNestedOptions(\n          getConnectionEditor({\n            category: ['Selected connection'],\n            connection: connectionSelection,\n            scene: state.scene,\n          })\n        );\n      }\n    }\n  });\n","// Code generated - EDITING IS FUTILE. DO NOT EDIT.\n//\n// Generated by:\n//     public/app/plugins/gen.go\n// Using jennies:\n//     TSTypesJenny\n//     PluginTsTypesJenny\n//\n// Run 'make gen-cue' from repository root to regenerate.\n\nimport * as ui from '@grafana/schema';\n\nexport enum HorizontalConstraint {\n  Center = 'center',\n  Left = 'left',\n  LeftRight = 'leftright',\n  Right = 'right',\n  Scale = 'scale',\n}\n\nexport enum VerticalConstraint {\n  Bottom = 'bottom',\n  Center = 'center',\n  Scale = 'scale',\n  Top = 'top',\n  TopBottom = 'topbottom',\n}\n\nexport interface Constraint {\n  horizontal?: HorizontalConstraint;\n  vertical?: VerticalConstraint;\n}\n\nexport interface Placement {\n  bottom?: number;\n  height?: number;\n  left?: number;\n  right?: number;\n  rotation?: number;\n  top?: number;\n  width?: number;\n}\n\nexport enum BackgroundImageSize {\n  Contain = 'contain',\n  Cover = 'cover',\n  Fill = 'fill',\n  Original = 'original',\n  Tile = 'tile',\n}\n\nexport interface BackgroundConfig {\n  color?: ui.ColorDimensionConfig;\n  image?: ui.ResourceDimensionConfig;\n  size?: BackgroundImageSize;\n}\n\nexport interface LineConfig {\n  color?: ui.ColorDimensionConfig;\n  radius?: number;\n  width?: number;\n}\n\nexport enum HttpRequestMethod {\n  GET = 'GET',\n  POST = 'POST',\n  PUT = 'PUT',\n}\n\nexport interface ConnectionCoordinates {\n  x: number;\n  y: number;\n}\n\nexport enum ConnectionPath {\n  Straight = 'straight',\n}\n\nexport interface CanvasConnection {\n  color?: ui.ColorDimensionConfig;\n  path: ConnectionPath;\n  size?: ui.ScaleDimensionConfig;\n  source: ConnectionCoordinates;\n  sourceOriginal?: ConnectionCoordinates;\n  target: ConnectionCoordinates;\n  targetName?: string;\n  targetOriginal?: ConnectionCoordinates;\n  vertices?: Array<ConnectionCoordinates>;\n}\n\nexport const defaultCanvasConnection: Partial<CanvasConnection> = {\n  vertices: [],\n};\n\nexport interface CanvasElementOptions {\n  background?: BackgroundConfig;\n  border?: LineConfig;\n  /**\n   * TODO: figure out how to define this (element config(s))\n   */\n  config?: unknown;\n  connections?: Array<CanvasConnection>;\n  constraint?: Constraint;\n  name: string;\n  placement?: Placement;\n  type: string;\n}\n\nexport const defaultCanvasElementOptions: Partial<CanvasElementOptions> = {\n  connections: [],\n};\n\nexport interface Options {\n  /**\n   * Enable infinite pan\n   */\n  infinitePan: boolean;\n  /**\n   * Enable inline editing\n   */\n  inlineEditing: boolean;\n  /**\n   * Enable pan and zoom\n   */\n  panZoom: boolean;\n  /**\n   * The root element of canvas (frame), where all canvas elements are nested\n   * TODO: Figure out how to define a default value for this\n   */\n  root: {\n    /**\n     * Name of the root element\n     */\n    name: string;\n    /**\n     * Type of root element (frame)\n     */\n    type: 'frame';\n    /**\n     * The list of canvas elements attached to the root element\n     */\n    elements: Array<CanvasElementOptions>;\n  };\n  /**\n   * Show all available element types\n   */\n  showAdvancedTypes: boolean;\n}\n\nexport const defaultOptions: Partial<Options> = {\n  infinitePan: true,\n  inlineEditing: true,\n  panZoom: true,\n  showAdvancedTypes: true,\n};\n","import { ActionModel, Field, InterpolateFunction, LinkModel } from '@grafana/data';\nimport { DataFrame } from '@grafana/data/';\nimport { config } from '@grafana/runtime';\nimport { getActions } from 'app/features/actions/utils';\n\nexport const getDataLinks = (field: Field, rowIdx: number) => {\n  const links: Array<LinkModel<Field>> = [];\n\n  if ((field.config.links?.length ?? 0) > 0 && field.getLinks != null) {\n    const v = field.values[rowIdx];\n    const disp = field.display ? field.display(v) : { text: `${v}`, numeric: +v };\n\n    const linkLookup = new Set<string>();\n\n    field.getLinks({ calculatedValue: disp, valueRowIndex: rowIdx }).forEach((link) => {\n      const key = `${link.title}/${link.href}`;\n      if (!linkLookup.has(key)) {\n        links.push(link);\n        linkLookup.add(key);\n      }\n    });\n  }\n\n  return links;\n};\n\nexport const getFieldActions = (\n  dataFrame: DataFrame,\n  field: Field,\n  replaceVars: InterpolateFunction,\n  rowIndex: number\n) => {\n  if (!config.featureToggles?.vizActions) {\n    return [];\n  }\n\n  const actions: Array<ActionModel<Field>> = [];\n  const actionLookup = new Set<string>();\n\n  const actionsModel = getActions(dataFrame, field, field.state!.scopedVars!, replaceVars, field.config.actions ?? [], {\n    valueRowIndex: rowIndex,\n  });\n\n  actionsModel.forEach((action) => {\n    const key = `${action.title}`;\n    if (!actionLookup.has(key)) {\n      actions.push(action);\n      actionLookup.add(key);\n    }\n  });\n\n  return actions;\n};\n"],"names":["VizTooltipContent","items","children","isPinned","scrollable","maxHeight","styles","getStyles","scrollableStyle","label","value","color","colorIndicator","colorPlacement","isActive","lineStyle","i","theme","ActionButton","action","buttonProps","Button","ADD_ANNOTATION_ID","renderDataLinks","dataLinks","Stack","link","DataLinkButton","renderActions","actions","VizTooltipFooter","annotate","VizTooltipHeader","item","ColorIndicatorPosition","VizTooltipColorIndicator","position","SeriesIcon","LabelValueTypes","SUCCESSFULLY_COPIED_TEXT","SHOW_SUCCESS_DURATION","HORIZONTAL_PX_PER_CHAR","VizTooltipRow","justify","marginRight","showValueScroll","innerValueScrollStyle","showLabelTooltip","setShowLabelTooltip","copiedText","setCopiedText","showCopySuccess","setShowCopySuccess","labelRef","valueRef","timeoutId","copyToClipboard","text","type","fallbackCopyToClipboard","textarea","err","onMouseEnterLabel","event","onMouseLeaveLabel","Tooltip","InlineToast","AddLayerButton","onChange","options","getActions","frame","field","fieldScopedVars","replaceVariables","config","dataContext","actionScopedVars","boundReplaceVariables","scopedVars","format","actionModel","e","evt","origin","buildActionOnClick","url","getUrl","requestHeaders","request","getData","name","error","getActionsDefaultField","endpoint","sanitizedRelativeURL","data","NotFoundDisplay","notFoundItem","LayerActionID","InlineEditTabs","LineStyle","StrokeDasharray","ParamsEditor","paramName","setParamName","paramValue","setParamValue","changeParamValue","currentTarget","changeParamName","removeParam","key","updatedParams","param","addParam","newParams","a","b","isAddParamsDisabled","Input","IconButton","entry","callApi","api","updateLoadingStateCallback","getRequest","interpolateVariables","panel","getEndpoint","dummyStringSettings","httpMethodOptions","contentTypeOptions","APIEditor","context","defaultApiConfig","onEndpointChange","onDataChange","onMethodChange","method","onContentTypeChange","contentType","formatCreateLabel","input","onQueryParamsChange","queryParams","onHeaderParamsChange","headerParams","renderJSON","json","JSONFormatter","renderTestAPIButton","InlineFieldRow","InlineField","RadioButtonGroup","Select","Field","variantOptions","ButtonStyleEditor","defaultStyleConfig","onVariantChange","variant","ConnectionPath","ConnectionDirection","defaultBgColor","defaultTextColor","defaultLightTextColor","defaultThemeTextColor","QuickPlacement","Align","VAlign","ButtonDisplay","isLoading","setIsLoading","loading","onClick","Spinner","buttonItem","dimensionContext","elementOptions","buttonConfig","getAPIConfig","builder","category","TextDimensionEditor","cloudItem","props","uniqueId","textConfig","background","border","ColorDimensionEditor","textTop","textLeft","textTransform","droneFrontItem","droneFrontTransformStyle","droneFrontConfig","droneSideItem","droneSidePitchTransformStyle","droneSideConfig","droneTopItem","fRightRotorAnimation","fLeftRotorAnimation","bRightRotorAnimation","bLeftRotorAnimation","droneTopTransformStyle","droneTopConfig","ellipseItem","svgStrokePathClass","IconDisplay","svgStyle","SanitizedSVG","iconItem","iconConfig","path","dummyFieldSettings","MetricValueDisplay","isSelected","scene","panelData","isEditMode","useObservable","of","getDisplayValue","fieldNotFound","fieldNames","MetricValueEdit","onFieldChange","selectedElement","FieldNamePicker","metricValueItem","parallelogramItem","RectangleDisplay","stylesFactory","rectangleItem","ServerDatabase","getServerStyles","ServerSingle","ServerStack","ServerTerminal","ServerType","outlineColor","serverItem","serverConfig","TextDisplay","TextEdit","textRef","saveText","onKeyDown","onKeyUp","textValue","textItem","triangleItem","windTurbineItem","windTurbineAnimation","windTurbineConfig","DEFAULT_CANVAS_ELEMENT_CONFIG","defaultElementItems","advancedElementItems","canvasElementRegistry","Registry","counter","SVGElements","ElementState","parent","target","hasHorizontalCenterConstraint","hasVerticalCenterConstraint","height","yOffset","rotationDelta","placement","calculatedRotation","transformScale","style","deltaX","deltaY","dirLR","dirTB","rotationInRadians","originalDirLR","originalDirTB","shouldHandleOneClickLink","shouldHandleOneClickAction","primaryDataLink","primaryAction","getRowIndex","actionsDefaultFieldConfig","frames","defaultField","rect","fallbackName","newName","trav","disablePointerEvents","constraint","vertical","horizontal","translate","elementType","elementContainer","parentContainer","parentBorderWidth","rotationTopOffset","rotationLeftOffset","rotationDegrees","rotationRadians","rotationOffset","calculateDelta","dimension1","dimension2","relativeTop","relativeBottom","relativeLeft","relativeRight","width","elementCenter","distanceFromCenter","ctx","css","image","v","visitor","oldName","isConnectionTarget","getConnectionsByTarget","connection","div","doSelect","element","selection","FrameState","targetElements","getElementTypes","shouldShowAdvancedTypes","current","getElementTypesOptions","selectables","alpha","option","onAddItem","sel","rootLayer","anchorPoint","newItem","newElementOptions","newElement","isConnectionSource","sceneByName","getConnections","connections","c","index","updateConnectionsForSource","con","calculateCoordinates","sourceRect","parentRect","info","sourceHorizontalCenter","sourceVerticalCenter","x1","y1","x2","y2","targetRect","targetHorizontalCenter","targetVerticalCenter","parentHorizontalCenter","parentVerticalCenter","calculateMidpoint","calculateAbsoluteCoords","valueX","valueY","calculateAngle","calculateDistance","fieldName","getConnectionStyles","defaultArrowSize","defaultArrowDirection","defaultArrowColor","lastRowIndex","strokeColor","strokeWidth","strokeRadius","arrowDirection","getLineStyle","shouldAnimate","getParentBoundingClientRect","getTransformInstance","getParent","getElementFields","opts","fields","cfg","prefixNames","prefix","classNames","_i","className","prefixCSS","_","selector","refs","Properties","properties","component","prototype","property","withMethods","methods","duplicate","propertyName","methodName","_a","args","result","RGB","RGBA","HSL","HSLA","COLOR_MODELS","FUNCTION","PROPERTY","ARRAY","OBJECT","STRING","NUMBER","UNDEFINED","IS_WINDOW","doc","prefixes","getCrossBrowserProperty","length","TRANSFORM","FILTER","ANIMATION","KEYFRAMES","OPEN_CLOSED_CHARACTERS","TINY_NUM","REVERSE_TINY_NUM","DEFAULT_UNIT_PRESETS","pos","size","__spreadArrays","s","il","r","k","j","jl","dot","a1","a2","b1","b2","isUndefined","isObject","isArray","isEqualSeparator","character","separator","isCharacterSpace","isSeparatorSpace","findOpen","openCharacter","texts","openCloseCharacters","isIgnore","findIgnore","findClose","otherText","closeCharacter","_loop_1","nextIndex","open","out_i_1","state_1","splitText","splitOptions","_b","isSeparateFirst","isSeparateOnlyOpenClose","_c","isSeparateOpenClose","_d","openClosedText","close","regexText","regex","chr","values","tempValues","resetTemp","_loop_2","out_i_2","nextOpenCloseCharacters","state_2","splitSpace","splitComma","splitBracket","matches","splitUnit","unit","camelize","str","all","letter","letter2","toArray","now","findIndex","arr","callback","defaultIndex","findLastIndex","findLast","defalutValue","firstTime","raf","currTime","id","caf","handle","getKeys","obj","getValues","keys","sortOrders","orders","index1","index2","convertUnitSize","sizeFunction","between","min","max","checkBoundSize","targetSize","compareSize","isMax","ratio","throttle","defaultSize","throttledSize","calculateBoundSize","minSize","maxSize","keepRatio","minWidth","minHeight","maxWidth","sum","nums","total","getRad","pos1","pos2","distX","distY","rad","getCenterPoint","points","getShapeDirection","center","pos1Rad","pos2Rad","num","reverseUnit","throttleArray","replaceOnce","fromText","toText","isOnce","flat","prev","cur","deepFlat","elements","cutHex","hex","hexToRGBA","h","g","toFullHex","hslToRGBA","hsl","l","x","m","rgb","stringToRGBA","colorArr","$","selectors","multi","hasClass","addClass","removeClass","reg","fromCSS","cssObject","getWindow","addEvent","el","listener","removeEvent","getDocument","getDocumentElement","getDocumentBody","isWindow","val","isNode","PolyMap","__proto","prevIndex","HashMap","SUPPORT_MAP","Link","prevLink","nextLink","orderChanged","changed","fixed","fromLinks","toLinks","from","to","fromLink","toLink","fromIndex","toIndex","Result","prevList","list","added","removed","maintained","changedBeforeAdded","ordered","pureChanged","fromBefore","toBefore","diff","findKeyCallback","mapClass","prevKeys","prevKeyMap","keyMap","removedMap","addedCount","removedCount","prevListIndex","listIndex","ListDiffer","newData","extendStatics","d","p","__extends","__","__assign","t","n","__rest","__spreadArray","pack","ar","fillKeys","arr2","fillProps","defaultProps","name_1","isDiff","getAttributes","otherProps","splitProps","attributes","events","name_2","findContainerNode","provider","base","removeNode","node","parentNode","executeHooks","hooks","hook","renderFunctionComponent","hooksIndex","Provider","ref","ps","contexts","nextElement","nextState","isForceUpdate","self","currentDepth","scheduledContexts","scheduledSubs","isContextUpdate","nextChildSubs","childs","sub","depth","child","renderProviders","prevProps","setCurrentInstance","fr","getCurrentInstance","getHooksIndex","setHooksInex","nextHooksIndex","Component","state","prevState","isUpdate","PureComponent","_super","createRef","defaultValue","refCallback","forwardRef","func","createComponent","contextValue","ComponentProvider","container","_this","nextProps","isMount","contextType","template","nextContexts","ef","def","diffAttributes","attrs1","attrs2","diffObject","name_3","diffEvents","events1","events2","provier","name_4","name_5","keys1","keys2","diffStyle","style1","style2","beforeName","name_6","name_7","name_8","getNativeEventName","ElementProvider","isRemove","eventName","contextValues","containerNode","isSVG","prevAttributes","prevEvents","nextAttributes","nextEvents","name_9","findDOMNode","comp","providers","findNodeProvider","ContainerProvider","TextProvider","diffProviders","containerProvider","childrenKeys","childrenProvider","next","createProvider","childProvider","getNextSibiling","childProviders","providerClass","updatedHooks","hyd","updated","nodeProvider","renderProvider","isProvider","render","renderSelf","createContext","$_subs","Consumer","getContext","mainComponent","subs","Portal","createPortal","_renderToString","parentContexts","stringProps_1","styleName","styleValue","strings","renderToString","renderSelfToString","checkHookInfo","inst","prevHt","defaultFunction","deps","contextId","providerComponent","st","nextValue","effect","unshift","effects","useImperativeHandle","some","getUserAgent","agent","userAgent","execRegExp","pattern","hasUserAgentData","userAgentData","brands","findVersion","versionTest","convertVersion","findPreset","presets","userPreset","version","preset","findPresetBrand","brandInfo","findBrand","brand","BROWSER_PRESETS","CHROMIUM_PRESETS","WEBKIT_PRESETS","WEBVIEW_PRESETS","OS_PRESETS","parseUserAgentData","osData","isMobile","firstBrand","browser","os","chromiumBrand","webkitBrand","platform_1","browserBrand","parseUserAgent","nextAgent","browserPreset","browserVersion","osPreset","osVersion","chromiumPreset","webkitPreset","getAccurateAgent","agentInfo","add","matrix","inverseMatrix","startIndex","fromX","swap","iv","divide","ignoreDimension","newMatrix","invert","createIdentityMatrix","identityIndex","targetStartIndex","targetIndex","transpose","getOrigin","originMatrix","w","fromTranslation","convertPositionMatrix","convertDimension","multiplies","matrixes","multiply","matrix2","plus","nextPos","minus","convertCSStoMatrix","is2d","convertMatrixtoCSS","calculate","rotateX3d","rotateY3d","rotateZ3d","createRotateMatrix","scale3d","sx","sy","sz","rotate","translate3d","tx","ty","tz","matrix3d","matrix1","cos","sin","createScaleMatrix","scale","createOriginMatrix","createWarpMatrix","pos0","pos3","nextPos0","nextPos1","nextPos2","nextPos3","x0","y0","x3","y3","u0","v0","u1","v1","u2","v2","u3","v3","getCenter","createMatrix","parseMat","transform","toMat","parse","getElementMatrix","calculateMatrixDist","res","getDistElementMatrix","matrixInfos","matrixFunction","functionValue","transforms","functionName","nextSize_1","posX","posY","posZ","nextSize","_e","_f","_g","_h","unitValue","childrenCount","ChildrenDiffer","EventEmitter","resolve","isStop","listeners","getDefaultScrollPosition","checkDefaultScrollEvent","getContainerElement","DragScroll","inputEvent","top","left","clientX","clientY","threshold","_startRect","_startPos","direction","prevScrollPos","throttleTime","isDrag","nextScrollPos","offsetX","offsetY","nextDirection","getScrollPosition","useScroll","nowTime","distTime","checkScrollEvent","tinyThrottle","isSameConstants","linearConstants1","linearConstants2","isSamePoint","point1","point2","getAreaSize","point","nextPoint","fitPoints","getMinMaxs","minX","minY","maxX","maxY","ratioX","ratioY","xs","ys","isInside","excludeLine","y","xLine","xLinearConstants","getLinearConstants","lines","convertLines","intersectionPosInfos","line","linearConstants","standardPoint","xPoints","getPointsOnLines","getIntersectionPointsByConstants","linePoint","intersectionCount","xMap","prevValue","getDistanceFromPointToConstants","dx","dy","c1","c2","isZeroA","isZeroB","results","getIntersectionPoints","line1","line2","isLimit","isPointOnLine","minMaxs","order","minMax","right","bottom","pointX","pointY","getOverlapPointInfos","points1","points2","targetPoints1","targetPoints2","lines1","lines2","linearConstantsList1","linearConstantsList2","overlapInfos","linePointInfos","intersectionPoints","isNext","pointMap","getOverlapPoints","infos","isConnectedLine","prevIndex1","prevIndex2","nextIndex1","nextIndex2","getOverlapAreas","areas","area","findReversedAreas","isFirst","nextPoints1","nextArea","areaPoint","nextPoint2","point2Index","findConnectedAreas","getUnoverlapAreas","overlapAreas","unoverlapAreas","overlapArea","nextOverlapArea","connectedAreas","firstConnectedArea","lastPoint_1","firstPoint","firstIndex","getOverlapSize","getRotatiion","touches","isMultiTouch","getEventClients","getClients","getClient","isMouseEvent","getPosition","clients","prevClients","startClients","getAverageClient","originalClientX","originalClientY","prevX","prevY","startX","startY","sumClient","minLength","client","ClientStore","isAdd","positions","movement","currentClient","prevClient","INPUT_TAGNAMES","Gesto","targets","isTrusted","isDragAPI","pinchOutside","preventWheelClick","preventRightClick","preventDefault","checkInput","dragFocusedInput","preventClickEventOnDragStart","preventClickEventOnDrag","preventClickEventByCondition","useTouch","isDragStart","activeElement","tagName","hasInput","hasContentEditable","activeTagName","timer","isScroll","dragResult","clientsLength","currentTime","isDouble","firstTarget","checkWindowBlur","passive_1","isCallDrag","store","nextClients","currentData","pinchThreshold","isPinch","isPrevDrag","isFirstDrag","storePosition","win","passive","hash","stringHash","getHash","getShadowRoot","parentElement","rootNode","replaceStyle","trimmedSelector","subSelector","trimmedSubSelector","injectStyle","shadowRoot","styled","injectClassName","styleElement","count","injectCount","StyledElement","defaultStyled","tag","injector","Styled","Tag","cssId","cspNonce","targetRef","injectResult","__decorate","decorators","desc","__values","o","__read","makeAble","able","DIRECTIONS4","DIRECTIONS","getSVGCursor","degree","getCursorCSS","degree45","defaultCursor","IS_WEBKIT","IS_WEBKIT605","navi","browserName","IS_CHROME","IS_CHROMIUM","chromiumVersion","IS_CHROMIUM109","IS_FIREFOX","IS_SAFARI_ABOVE15","PREFIX","directionCSS","dir","originX","originY","offset","MOVEABLE_CSS","NEARBY_POS","FLOAT_POINT_NUM","MIN_SCALE","MAX_NUM","MIN_NUM","DIRECTION_REGION_TO_DIRECTION","DIRECTION_INDEXES","DIRECTION_ROTATIONS","MOVEABLE_METHODS","setCustomDrag","delta","isConvert","ableName","datas","ableDatas","convertDragDist","CustomGesto","originalDatas","calculateElementPosition","is3d","poses","calculatePoses","x4","y4","calculatePosition","sign","calculatePointerDist","moveable","moveableClientRect","rootMatrix","calculateInversePosition","getDragDist","setDragStart","allMatrix","beforeMatrix","offsetMatrix","targetMatrix","transformOrigin","getTransformDirection","resolveTransformEvent","nextTransforms","nextTransformAppendedIndexes","convertTransformInfo","targetFunction","matFunctionName","convertTransformFormat","dist","getTransformDist","getBeforeDragDist","bx","by","getTransfromMatrix","isAfter","beforeTransform","afterTransform","beforeTransform2","afterTransform2","targetAllTransform","nextTargetMatrix","res1","afterTargetMatrix","inverseBeforeMatrix","startDragBeforeDist","absoluteOrigin","isBefore","startDragDist","getInverseDragDist","calculateTransformOrigin","prevWidth","prevHeight","prevOrigin","prevSize","measureRatio","getPosIndexesByDirection","indexes","getPosesByDirection","getPosBySingleDirection","getPosByDirection","startPos","fixedDirection","fixedPos","getNextMatrix","getAbsoluteMatrix","getNextTransformMatrix","isAllTransform","targetTransform","scaleMatrix","fillTransformStartEvent","getBeforeRenderableDatas","setTransformIndex","setDefaultTransformIndex","startTransforms","fillOriginalTransform","getNextTransforms","getNextTransformText","getNextStyle","fillTransformEvent","nextTransform","drag","Draggable","fillCSSObject","getTranslateFixedPosition","fixedOffset","nextMatrix","nextFixedPosition","getDirectionOffset","getTranslateDist","fixedPosition","groupable","groupLeft","groupTop","getScaleDist","getDirectionByPos","fixedOffsetPosition","getRotateDist","rotateDist","getResizeDist","nextOrigin","getAbsolutePosition","getAbsolutePosesByState","getGestoData","targetGesto","controlGesto","getIndividualTransforms","getStyle","individualTransforms","getMatrixStackInfo","checkContainer","documentElement","requestEnd","isEnd","targetTransformOrigin","hasFixed","offsetContainer","getOffsetInfo","zoom","getCachedStyle","getElementTransform","isFixed","getTransformMatrix","offsetParent","isOffsetEnd","isStatic","parentClientLeft","parentClientTop","fixedClientLeft","fixedClientTop","fixedInfo","getPositionFixedInfo","length_1","convert3DMatrixes","getOffsetPosInfo","hasOffset","origin_1","targetOrigin","offsetPos","offsetLeft","offsetTop","getSVGMatrix","targetZoom","offsetInfo","offsetZoom","parentSlotElement","customOffsetParent","customOffsetLeft","customOffsetTop","margin","getBodyOffset","isElementTarget","scrollLeft","scrollTop","cacheStyleMap","clientRectStyleMap","matrixContainerInfos","setStoreCache","useCache","getCachedClientRect","clientRect","nextClientRect","getClientRect","getCachedMatrixContainerInfo","result_1","cache","nextStyle_1","cached","fillChildEvents","groupableDatas","childDatas","triggerChildGesto","isStart","moveables","childEvents","eventParams","ev","childMoveable","gestos","childEvent","triggerChildAbles","eachEvent","startChildDist","parentDatas","startPositions","originalX","originalY","renderDirectionControlsByInfos","renderDirections","React","renderPoses","rotationRad","getProps","degRotation","absDegree","directionMap","renderState","renderDirectionMap","directionSign","directionRotation","dataAttrs","getControlTransform","renderDirectionControls","defaultDirections","directions","displayAroundControls","renderAroundControls","renderLine","rotation","renderEdgeLines","edge","getRenderDirections","renderDiagonalDirections","renderAllDirections","checkBoundPoses","bounds","verticalPoses","horizontalPoses","nextBounds","checkBounds","getBounds","externalBounds","containerHeight","containerWidth","clientLeft","clientTop","snapOffsetLeft","snapOffsetTop","snapOffsetRight","snapOffsetBottom","isCSS","checkBoundKeepRatio","endPos","endX","endY","abs","isBottom","isRight","verticalInfo","horizontalInfo","isBound","isVertical","startBoundPos","endBoundPos","minPos","maxPos","boundInfos","isBoundRotate$1","relativePoses","boundRect","nextPoses","boundRotate","vec","boundPos","getDistSize","checkRotateBounds","prevPoses","relativeRad1","relativeRad2","nextRad","VERTICAL_NAMES","HORIZONTAL_NAMES","SNAP_SKIP_NAMES_MAP","VERTICAL_NAMES_MAP","HORIZONTAL_NAMES_MAP","getInitialBounds","hasGuidelines","snappable","innerBounds","verticalGuidelines","horizontalGuidelines","snapGridWidth","snapGridHeight","guidelines","enableSnap","getSnapDirections","snapDirections","mapSnapDirectionPoses","snapPoses","nextSnapDirections","nextSnapPoses","splitSnapDirectionPoses","horizontalNames","verticalNames","calculateContainerPos","containerRect","clientPos","solveLineConstants","NAME_snapRotationThreshold","NAME_snapRotationDegrees","NAME_snapHorizontalThreshold","NAME_snapVerticalThreshold","checkMoveableSnapPoses","posesX","posesY","dirXs","dirYs","customSnapVerticalThreshold","customSnapHorizontalThreshold","snapThresholdMultiples","snapHorizontalThreshold","selectValue","snapVerticalThreshold","checkSnapPoses","multiples","checkSnap","checkSnapKeepRatio","getTinyDist","verticalSnapInfo","horizontalSnapInfo","getNearestSnapGuidelineInfo","isVerticalSnap","verticalGuideline","isHorizontalSnap","horizontalGuideline","horizontalPos","verticalPos","isSnap","getStringDirection","stringDirection","checkSnaps","horizontalDirection","verticalDirection","snapInfo","posInfo","guidelineInfo","guideline","targetType","targetPoses","snapThreshold","dirs","posType","snapPosInfos","targetPos","guidelineInfos","snapPosInfo","getSnapInfosByDirection","snapDirection","nextDir","checkSnapBoundPriority","aDist","bDist","getNearOffsetInfo","offsets","aSign","bSign","aOffset","bOffset","getCheckSnapDirections","endDirection_1","signX","signY","signs","isStartLine","cx","cy","hitTestLine","test1","test2","isSameStartLine","dots","centerSign","checkInnerBoundDot","start","end","checkInnerBound","verticalSign","horizontalSign","lineConstants","leftLine","topLine","rightLine","bottomLine","topBoundInfo","checkLineBoundCollision","bottomBoundInfo","leftBoundInfo","rightBoundInfo","isAllVerticalBound","isVerticalBound","isAllHorizontalBound","isHorizontalBound","verticalOffset","maxOffset","horizontalOffset","isAllBound","boundLine","isRender","dot1","boundDot1","boundDot2","dy2","dx2","hasDx","hasDy","slope","getInnerBoundInfo","lineInfos","multiple","sizeOffset","getInnerBoundDragInfo","getCheckInnerBoundLineInfos","innerBoundInfo","widthOffsetInfo","heightOffsetInfo","getCheckSnapLineDirections","lineDirections","virtualPoses","dir1","dir2","virtualLine","isBoundRotate","boundDots","getDistPointLine","solveReverseLine","checkRotateInnerBounds","dotInfos","lineRad","lineDist","dotDist","dotRad","distRad","nextRad1","nextRad2","checkInnerBoundPoses","boundMap","pos4","lineInfo","isHorizontalStart","isVerticalStart","solveEquation","snapOffset","solveNextOffset","dist1","dist2","isOutside","widthOffset","heightOffset","getSnapBound","boundInfo","checkThrottleDragRotate","throttleDragRotate","adjustPoses","adjustPos","prevDistY","checkSnapBoundsDrag","ignoreSnap","getAbsolutePoses","getRect","boundPoses","checkMoveableSnapBounds","verticalSnapBoundInfo","horizontalSnapBoundInfo","verticalInnerBoundInfo","horizontalInnerBoundInfo","horizontalBoundInfos","verticalBoundInfos","horizontalDist","verticalDist","checkSnapBounds","guideines","checkSnapRightLine","snapBoundInfo","rad180","isHorizontalLine","isVerticalLine","getSnapBoundInfo","isRequest","startDirection","endDirection","otherStartPos","otherEndPos","checkSnapBoundsKeepRatio","otherHorizontalOffset","isOtherHorizontalBound","isOtherHorizontalSnap","otherVerticalOffset","isOtherVerticalBound","isOtherVerticalSnap","snapLine","getSnapBoundOffset","horizontalBoundInfo","verticalBoundInfo","checkMaxBounds","left_1","top_1","right_1","bottom_1","otherDirection","isCheckVertical","isCheckHorizontal","otherPos","deg","nextOtherPos","isHeightOutside","isWidthOutside","hideThrottleDragRotateLine","dragInfo","beforeOrigin","parentEvent","parentGesto","startCheckSnapDrag","params","fillParams","triggerEvent","parentFlag","deltaOffset","useSnap","isGroup","parentThrottleDrag","prevDist","prevBeforeDist","startValue","parentMoveable","throttleDrag","dragRotateRad","startDragRotate","ry","rx","beforeTranslate","beforeDist","beforeDelta","fillEndParams","nextParams","passDelta","getFixedDirectionInfo","getOffsetFixedDirectionInfo","nextFixedOffset","getOffsetFixedPositionInfo","offsetFixedPosition","directionCondition$2","getDirectionCondition","Resizable","getDirectionViewClassName","parentDirection","parentFixedDirection","getTotalDirection","setRatio","setFixedDirection","setFixedPosition","setMin","setMax","nextMaxSize","startWidth","startHeight","parentKeepRatio","dragClient","parentDist","resolveMatrix","isResize","startOffsetWidth","startOffsetHeight","isWidth","startOffsetMatrix","startTransformOrigin","targetN","nextAllMatrix","resizeFormat","throttleResize","keepRatioFinally","sizeDirection","distWidth","distHeight","getNextBoundingSize","getOffsetSizeDist","nextWidth","nextHeight","boundingWidth","boundingHeight","nextFixedDirection","snapDist","checkSnapResize","computeSize","isNoSnap","inverseDelta","fillAfterTransform","errorWidth","errorHeight","isErrorWidth","isErrorHeight","originalEvents","parentStartOffsetWidth","parentStartOffsetHeight","updateGroupMin","originalMinSize","childMinSize","childStartOffsetWidth","childStartOffsetHeight","parentMinWidth","parentMinHeight","updateGroupMax","originalMaxSize","childMaxSize","parentMaxWidth","parentMaxHeight","catchEvent","parentScale","setRotateStartInfo","startAbsoluteOrigin","getAbsoluteDist","defaultDeg","prevDeg","normalizedPrevDeg","loop","getAbsoluteDistByClient","getRotateInfo","moveableRect","throttleRotate","prevSnapDeg","snapRotation","checkSnapRotate","snapDeg","getRotationPositions","rotationPosition","radPoses","getRotationRad","isReverse","dragControlCondition","rotationTarget","getRefTargets","Rotatable","rotatable","rotateAroundControls","resolveAblesWithRotatable","jsxs","ables","resolveMap_1","directionControlInfos","parentRotate","beforeDirection","resizeStart","startClientX","startClientY","externalRotate","inputTarget","regionDirection","controlDirection","clientPoses","calculateMoveableClientPositions","originalFixedPosition_1","fixedBeforeOrigin","fixedAfterOrigin","posDelta","dragStart","resolveAble","getTotalOrigin","rotatation","clientDistX","clientDistY","groupDelta","beforeInfo","afterInfo","absoluteInfo","isRotate","targetDirection","beforeRotation","absoluteDelta","absoluteDist","absoluteRotation","startRotation","absoluteStartRotation","nextClientX","nextClientY","nextRotation","inverseDist","dragEvent","transformEvent","parentDistance","resize","resizeEvent","parentLeft","parentTop","parentBeforeOrigin","childClient","startGroupClient","prevClientX","prevClientY","distRotate","renderGuideline","isHorizontal","scaleType","renderInnerGuideline","renderSnapPoses","renderPos","renderGuidelines","isDisplayInnerSnapDigit","mainNames","targetStart","targetEnd","hide","elementRect","renderDigitLine","lineType","gap","snapDigit","isDisplaySnapDigit","snapDistFormat","sizeName","absGap","snapSize","groupByElementGuidelines","otherIndex","names","groupBy","nextGuidelines","inner","elementRect1","elementRect2","renderDashedGuidelines","rendered","groups","sideNames","sidePos","prevRect","nextRect","size1","size2","renderPos1","renderPos2","renderGapGuidelines","targetSideStart","targetSideEnd","gapRects","sideStartPos","sideEndPos","sideCenterPos","getTotalGuidelines","containerClientRect","overflow","containerClientHeight","containerClientWidth","snapGap","maxSnapElementGuidelineDistance","isDisplayGridGuidelines","elementGuidelines","getElementGuidelines","totalGuidelines","getGapGuidelines","getGridGuidelines","getDefaultGuidelines","checkBetweenRects","snapThresholds","maxSnapElementGapDistance","elementRects","gapGuidelines","targetCenter","targetStart2","targetEnd2","snapThresholdMap","getDist","nextElementRects","snapRect1","snapRect2","rect1","rect2","rect1Start","rect1End","rect2Start","rect2End","isCenter","startGridGroupGuidelines","snapGridAll","snapRenderInfo","hasDirection","rect_1","children_1","posName","clientOffset","rectSize","rectPos","childSizes","firstChildSize","childSnapSizes","rectRatio","childSize","startOffset","snapThresholdInfo","defaultSnapGridWidth","defaultSnapGridHeight","pushGuideline","distance","prevValues","snapRect","nextElementGuidelines","getRefTarget","nextValues","getSnapElementRects","elementSnapDirections","topValue","leftValue","rightValue","bottomValue","centerValue","middleValue","rectTop","rectLeft","sizes","getObjectGuidelines","containerSize","posGuideline","snapWidth","snapHeight","offsetDelta","containerLeft","containerTop","elementLeft","elementTop","elementRight","elementBottom","checkSnapInfo","snapContainer","snapContainerTarget","snapContainerRect","offset1","getDragDistByState","offset2","getNextFixedPoses","nextFixedPos","normalized","getSizeOffsetInfo","innerBoundLineInfos","recheckSizeByTwoDirection","snapPos","nextWidthOffset","nextHeightOffset","checkSizeDist","getNextPoses","isWidthBound","isHeightBound","widthDist","heightDist","isGetWidthOffset","bumpDegree","baseDeg","deg1","deg2","getMinDegreeDistance","deg3","snapRotationThreshold","snapRotationDegrees","origin2_1","rad_1","sorted","firstDegree","checkSnapScale","sizeDist","getSnapGuidelines","posInfos","addBoundGuidelines","verticalSnapPoses","horizontalSnapPoses","innerBoundMap","verticalInnerBoundPoses","horizontalInnerBoundPoses","innerPos","directionCondition$1","Snappable","targetTop","targetLeft","snapRenderThreshold","watchValue","minLeft","minTop","externalPoses","snapInfos","hasExternalPoses","externalRect","verticalPosInfos","horizontalPosInfos","allGuidelines","nextBoundMap","nextInnerBoundMap","multiply2","defaultSync","fn","measureSVGSize","viewBox","getSVGViewBox","getBeforeTransformOrigin","relativeOrigin","getTransformOrigin","getTransformOriginArray","computedTransform","baseVal","lastParent","isParent","checkZoom","getTargetStyle","hasSlot","assignedSlotParentElement","isCustomElement","targetPosition","willChange","slotParentNode","targetParentNode","getSVGGraphicsOffset","getBodyStyle","bodyPosition","marginLeft","marginTop","fixedContainer","hasTransform","body","makeMatrixCSS","clientWidth","clientHeight","viewBoxWidth","viewBoxHeight","scaleX","scaleY","preserveAspectRatio","align","meetOrSlice","svgOrigin","xAlign","yAlign","scaleDimension","isGTarget","isFillBox","bbox","rectWidth","rectHeight","calculateRect","getSVGOffset","targetInfo","getSize","mat","prevLeft","prevTop","posOrigin","rectOrigin","mat2","nextLeft","nextTop","distLeft","distTop","rootClientRect","rootPoses","getDiagonalSize","offsetWidth","offsetHeight","cssWidth","cssHeight","contentWidth","contentHeight","minOffsetWidth","minOffsetHeight","maxOffsetWidth","maxOffsetHeight","inlineCSSWidth","inlineCSSHeight","svg","targetStyle","boxSizing","borderLeft","borderRight","borderTop","borderBottom","paddingLeft","paddingRight","paddingTop","paddingBottom","horizontalPadding","verticalPadding","horizontalBorder","verticalBorder","getParentStyle","resetClientRect","getExtendsRect","isRoot","extendsRect","getClientRectByPosition","isExtends","baseTop","baseLeft","convertTransformOriginArray","getDirection","direciton","unsetAbles","isControl","unsetGesto","gestoName","gesto","resolvedEvent","prevEvent","nextEvent","isBeforeEvent","isManager","pseudoElt","filterAbles","triggerAblesSimultaneously","enabledAbles","ableGroups","equals","groupKeys","groupKey","keyIndex","group","groupByMap","calculatePadding","xAdded","yAdded","nextAdded","convertCSSSize","isRelative","checkAbles","beforeFunctionTexts","beforeFunctionTexts2","targetFunctionText","afterFunctionTexts","afterFunctionTexts2","beforeFunctions","beforeFunctions2","afterFunctions","afterFunctions2","targetFunctions","beforeFunctionMatrix","beforeFunctionMatrix2","afterFunctionMatrix","afterFunctionMatrix2","allFunctionMatrix","isArrayFormat","isSelector","userTargets","getAbsoluteRotation","getSizeDistByDist","startSize","standardRad","signSize","startWidthSize","startHeightSize","secondRad","firstRad","distSize","pinchScale","startFixedDirection","directionsDists","directionRatios","ratioDistance","dist_1","convertTransformUnit","xy","leftOrigin","rightOrigin","originObject","nextOriginObject","rotatePosesInfo","isDeepArrayEquals","arr1","value1","value2","isArray1","isArray2","valueKey","countEach","getPaddingBox","padding","Pinchable","angle","pinchable","controlEventName","pinchAbles","ableEvent","directionCondition","Scalable","setMinScaleSize","setMaxScaleSize","isScale","throttleScale","tempScaleValue","getNextScale","stateDirection","nextScale","distSign","isSelfPinch","startOffsetSize","scaleSize","distText","scaleText","isZeroScale","scaleEndParam","moveableScale","getMiddleLinePos","getTriangleRad","rad1","rad2","isValidPos","poses1","poses2","pi","Warpable","resizable","scalable","warpable","linePosFrom1","linePosFrom2","linePosFrom3","linePosFrom4","linePosTo1","linePosTo2","linePosTo3","linePosTo4","targetInverseMatrix","prevMatrix","isWarp","posIndexes","absolutePoses","selectedPoses","nearByPoses","afterMatrix","totalMatrix","AREA_PIECES","AREA_PIECE","AVOID","VIEW_DRAGGING","restoreStyle","renderPieces","DragArea","dragArea","passDragArea","areaElement","rects","Origin","originStyle","scrollContainer","Scrollable","scrollOptions","dragScroll","scrollContainerElement","scrollThreshold","scrollThrottleTime","Default","Padding","paddingDirections","paddingPos1","paddingPos2","paddingPos3","paddingPos4","RADIUS_DIRECTIONS","calculateRatio","sumSize","sumRatio","HORIZONTAL_RADIUS_ORDER","VERTICAL_RADIUS_ORDER","HORIZONTAL_RADIUS_DIRECTIONS","VERTICAL_RADIUS_DIRECTIONS","getRadiusStyles","clipStyles","radiusPoses","raws","rawPos","getRadiusRange","controlPoses","horizontalRange","verticalRange","clipPose","getRadiusValues","minCounts","full","splitIndex","splitLength","horizontalValues","verticalValues","horizontalValuesLength","verticalValuesLength","hasVerticalValues","nwValue","neValue","seValue","_j","swValue","_k","_l","wnValue","_m","enValue","_o","esValue","_p","wsValue","horizontalRawPoses","verticalRawPoses","nextHorizontalPoses","nextVerticalPoses","removeRadiusPos","radiuslIndex","deleteCount","addRadiusPos","horizontalIndex","verticalIndex","radiusX","radiusY","startVerticalIndex","splitRadiusPoses","horizontals","verticals","CLIP_DIRECTIONS","CLIP_RECT_DIRECTIONS","getClipStyles","clipPath","clipRelative","clipType","clipPoses","isRect","isCircle","subWidth","subHeight","getRectPoses","dirx","diry","getControlSize","xRange","yRange","getClipPath","defaultClip","customClip","clipText","clipPrefix","splitter","xPos","yPos","radiusX_1","radiusY_1","radius","xRadius","yRadius","centerPos_1","roundIndex","rectLength","radiusValues","_q","_r","_s","top_2","_t","nextRight","nextBottom","_u","posValue","top_3","moveControlPos","dists","verticalDirections","horizontalDirections","verticalDirection_1","horizontalDirection_1","fixedIndex","nextDist","nextControlPoses_1","controlPose","controlDir","dirDir","dirHorizontal","dirVertical","addClipPath","clipIndex","clipStyle","removeClipPath","Clippable","customClipPath","defaultClipPath","clipArea","clipPathState","snapBoundInfos","calculatedPos","controls","isInset","isPolygon","linePoses_1","clipLeft","clipTop","ellipseClipPath","piece","areaPoses","allWidth","allHeight","allLeft_1","allTop_1","directionType","snapPos1","snapPos2","dragWithClip","isDragTarget","isLine","isArea","originalDraggable","originalDist","firstDist","isDragWithTarget","isAll","guidePoses","isEllipse","guideRect","guideXPoses","guideYPoses","rectPoses","rectDists_1","boundDelta","snapOffsetY","snapOffsetX","distSnapX","distSnapY","width_1","height_1","nextControlPoses_2","nextClipStyles","dragDist","isClipStart","OriginDraggable","originRelative","distOrigin","dragDelta","addBorderRadiusByLine","lineIndex","horizontalsLength","virtual","verticalsLength","controlIndex","controlPoseInfo","addBorderRadius","removeBorderRadius","getBorderRadius","borderRadius","triggerRoundEvent","getStyleBorderRadius","firstMoveable","Roundable","roundClickable","borderRadiusState","minRoundControls","maxRoundControls","roundPadding","isDisplayShadowRoundControls","verticalCount","horizontalCount","basePos","originalPos","isDisplayVerticalShadow","isDisplay","indexAttr","roundRelative","selectedControlPose","selectedVertical","selectedHorizontal","pose","poseDist","isIdentityMatrix","identityMatrix","BeforeRenderable","inlineTransform","cssMatrix","startTransform","Renderable","transformObject","matrixInfo","triggerAble","moveableAbles","eventOperations","eventAffix","eventType","requestInstant","requestAble_1","isDragStop","stop","isFirstStart","gestoType","prevGesto","trigger","conditionName","nextDatas","forceEndedCount","updatedCount","eventOperation","eventAbles","isForceEnd","flushSync","checkMoveableTarget","eventTarget","dragTargetElement","getTargetAbleGesto","moveableTarget","controlBox","dragTarget","checkTarget","getAbleGesto","getControlAbleGesto","checkControlTarget","ableType","conditionFunctions","isTargetAbles","preventClickDefault","dragContaienrOption","dragContainer","isPinchScheduled","EventManager","calculateMatrixStack","rootContainer","isAbsolute3d","prevTargetMatrix","containerZoom","rootMatrixes","isRoot3d","offsetRootContainer","rootZoom","isNext3d","isSVGGraphicElement","nextRootMatrixes","originalRootContainer","endContainer","rootMatrixBeforeOffset","nextInfo","isMatrix3d","originalRootMatrix","calculateElementInfo","allResult","getElementInfo","getMoveableTargetInfo","moveableElement","requestStyles","targetClientRect","rootContainerClientRect","getStyle_1","beforePosition","absoluteTargetPosition","absoluteContainerPosition","containerClientRectLeft","containerClientRectTop","containterClientLeft","containerClientTop","clientDelta","getPersistState","MoveableManager","parentPosition","propsTarget","translateZ","ControlBoxElement","linePadding","controlPadding","stateTarget","groupTargets","isDragging","ableAttributes","ableClassName","isVisible","viewContainer","manager","wrapperMoveable","totalSize","isTarget","isSetState","isSingle","persistState","statePos","isInstant","allAbles","requsetAble","ableRequester","requester","ableParam","originalBeforeOrigin","stateLeft","stateTop","isPersisted","renderPos3","renderPos4","zoomOffset","stateContainer","isTargetChanged","isChanged","moveableContainer","customStyleMap","hasControlBox","persistData","firstRenderState","pinchStart","dragControlStart","targetAbles","controlAbles","Renderer","styleNames","ableStyleNames","hasTargetAble","hasControlAble","isUnset","hideDefaultLines","hideChildMoveableDefaultLines","useDragArea","nextTarget","prevTarget","prevDragArea","isDragTargetChanged","isDragAreaChanged","eventKeys","hasAbles","viewContainerOption","nextClassNames","prevClassNames","classPrefix","targetGestoData","controlGestoData","observer","records","e_1","records_1","records_1_1","mutation","e_1_1","Groupable","renderGroupRects","persistDatChildren","Clickable","isMoveableElement","containsElement","containsTarget","parentTarget","getDraggableEvent","edgeDraggable","IndividualGroupable","MOVEABLE_ABLES","MOVEABLE_EVENTS","MOVEABLE_PROPS","solveConstantsDistance","solveC","getMaxPos","getMinPos","getGroupRect","parentPoses","fixedRotation","a1_1","a2_1","a1MinMax_1","a1MinMaxPos_1","a2MinMax_1","a2MinMaxPos_1","a1Dist","a2Dist","a1MinPos","a1MaxPos","a2MinPos","a2MaxPos","minHorizontalLine","maxHorizontalLine","minVerticalLine","maxVerticalLine","minX_1","minY_1","maxX_1","maxY_1","changedX","findMoveableGroups","childTargetGroups","targetGroup","childMoveableGroups","checked","MoveableGroup","checkeds","targetGroups","moveableGroups","useDefaultGroupRotate","finded","isReset","defaultGroupRotate","persistedRoatation","getMoveableGroupRect","parentRotation","posesRotations","rotations","groupRotation","firstRotation","isSameRotation","groupPoses","groupRect","rootGroupRect","posesInfo","rotateScale","isContainerChanged","MoveableIndividualGroup","canPersist","individualProps","controlBoxElement","dragElement","getElementTargets","refTargets","selectorMap","elementTargets","getTargetGroups","compareRefTargets","prevRefTargets","nextRefTargets","InitialMoveable","cssMap","moveableContructor","userAbles","userProps","nextSelectorMap","totalAbles","prevMoveable","target_1","prevTargetMoveable","mv","resolvePromise","isBrowser","updateSelectorMap","selectorTarget","Moveable","makeMoveable","InnerMoveable","PROPERTIES","METHODS","EVENTS","nextOptions","selfElement","innerMoveable","createCommonjsModule","module","keycode","exports","keyCode","searchInput","hasKeyCode","search","foundNamedKey","codes","aliases","nameOrCode","alias","keycode_1","keycode_2","keycode_3","keycode_4","keycode_5","codeData","keysSort","getKey","keyName","getCombi","getModifierCombi","getArrangeCombi","arrangeKeys","prevScore","nextScore","globalKeyController","KeyController","comb","isToggle","combi","touch","filterDuplicated","map","elementFromPoint","baseNode","jsx","elChildren","elStyle","attrs","diffValue","boundArea","getDefaultElementRect","passTargets","beforeTargets","afterTargets","continueSelectWithoutDeselect","getLineSize","CLASS_NAME","OPTIONS","OPTION_TYPES","Selecto","clickedTarget","selectFromInside","selectByClick","boundContainer","preventDragFromInside","clickBySelectEnd","dragCondition","boundElement","rectElement","hitRect","firstPassedTargets","allowClickBySelectEnd","hasInsideTargets","pointTarget","isPreventSelect","innerScrollOptions","isInnerScroll","inputEvent_1","innerScrollElement","hasScrollOptions","selectFlag","isKeyDown","isKeyUp","containers","portalContainer","selectedTargets","beforeSelected","selectedElements","startPoint","endPoint","mousedown","mousemove","mouseup","getElementRect","selectableElements","selectableTargets","selectablePoints","hasIndexesMap","parentMap_1","parents","paths","prevParentElement","keyContainer","toggleContinueSelect","toggleContinueSelectWithoutDeselect","nextClassName","continueSelect","selectRect","gestoEvent","hitRate","innerGroups","innerWidth","innerHeight","ignoreClick","rectPoints","isHit","hitRateValue","inArea","overlapPoints","overlapSize","rate","selectableInners","yGroups","isMoveInnerScroll","parentMap_2","parentInfo","containerInfo","isDragStartEnd","startResult","startSelectedTargets","startPassedTargets","afterAdded","afterRemoved","afterPrevList","afterList","containerX","containerY","offsetSize","passedTargets","isKeyup","nextKeys","toggleKeys","singleKey_1","innerScrollContainer_1","parentMap_3","innerScrollPathsList","innerScrollPaths","isAlwaysTrue","selectablePoints_1","groups_1","getter","setter","Selecto$1","CONNECTION_ANCHOR_DIV_ID","CONNECTION_ANCHOR_ALT","CONNECTION_ANCHOR_HIGHLIGHT_OFFSET","ANCHORS","ANCHOR_PADDING","HALF_SIZE","ConnectionAnchors","setRef","setAnchorsRef","handleMouseLeave","highlightEllipseRef","halfSizeHighlightEllipse","anchorImage","onMouseEnterAnchor","onMouseLeaveHighlightElement","handleMouseLeaveAnchors","generateAnchors","anchors","anchor","reorderElements","src","dest","dragToGap","destPosition","updateElements","idx","destIndex","findElementByTarget","sceneElements","stack","currentElement","nestedElements","nestedElement","frameSelection","first","currentSelectedElements","currentLayer","newLayer","framePlacement","generateFrameContainer","maxRight","maxBottom","idCounter","htmlElementTypes","ConnectionSVG","setSVGRef","setLineRef","setSVGVertexRef","setVertexPathRef","setVertexRef","headId","CONNECTION_LINE_ID","EDITOR_HEAD_ID","maximumVertices","selectedConnection","setSelectedConnection","selectedConnectionRef","clearSelectedConnection","selectConnection","renderConnections","source","vertices","xStart","yStart","xEnd","yEnd","midpoint","xDist","yDist","connectionCursorStyle","selectedStyles","CONNECTION_HEAD_ID_START","CONNECTION_HEAD_ID_END","addVertices","pathString","vertex","X","Y","xa","ya","xb","yb","lHalfArc","angle1","angle2","Xn","Yn","previousVertex","Xp","Yp","theta","ccw","lSegment","nextVertex","lSegmentNext","lDelta","markerStart","markerEnd","getAnimationDirection","CONNECTION_VERTEX_ID","CONNECTION_VERTEX_ADD_ID","CONNECTION_VERTEX_ORTHO_TOLERANCE","CONNECTION_VERTEX_SNAP_TOLERANCE","Connections","BehaviorSubject","anchorElement","anchorsElement","connectionSVG","connectionLine","connectionVertex","connectionVertexPath","elementTarget","customElementAnchors","anchorsAmount","elementBoundingRect","parentBoundingRect","connectionLineX1","connectionLineY1","sourceX","sourceY","targetX","targetY","targetName","selectedValue","vx1","vy1","vx2","vy2","xSnap","ySnap","deleteVertex","verticalBefore","verticalAfter","horizontalBefore","horizontalAfter","angleOverall","angleBefore","connectionIndex","vertexIndex","currentSource","currentConnections","currentVertices","currentVertex","newVertex","selectedTarget","connectionStartTargetBox","connectionAnchorOffsetX","connectionAnchorOffsetY","mouseX","mouseY","update","settingsViewable","openSettings","onKeyPress","dimensionViewable","constraintViewable","targetElement","verticalConstraintVisualization","horizontalConstraintVisualization","borderStyle","centerIndicatorLineOne","centerIndicatorLineTwo","centerIndicator","verticalConstraintTop","verticalConstraintBottom","verticalConstraintTopBottom","verticalConstraintCenterLine","verticalConstraintCenter","horizontalConstraintLeft","horizontalConstraintRight","horizontalConstraintLeftRight","horizontalConstraintCenterLine","horizontalConstraintCenter","disableCustomables","enableCustomables","isTargetAlreadySelected","selectedTargetParent","generateTargetElements","rootElements","initMoveable","destroySelecto","allowChanges","targetedElement","elementSupportsEditing","needsUpdate","isTargetMoveableElement","isElementSelected","DEFAULT_OFFSET","HORIZONTAL_OFFSET","frameItemDummy","updateName","shiftItemsOnDuplicate","oldPlacement","copy","elem","endIndex","firstPosition","srcIndex","vals","CanvasContextMenu","onVisibilityChange","inlineEditorOpen","isMenuVisible","setIsMenuVisible","setAnchorPoint","handleContextMenu","closeContextMenu","renderMenuItems","openCloseEditorMenuItem","MenuItem","editElementMenuItem","onClickEditElementMenuItem","typeOptions","getTypeOptionsSubmenu","submenuItems","onClickItem","sceneContainerDimensions","addItemMenuItem","setBackgroundMenuItem","contextMenuAction","actionType","currentSelectedElement","ContextMenu","CanvasTooltip","onClose","overlayProps","useOverlay","dialogProps","useDialog","timeField","lastTimeValue","shouldDisplayTimeContentItem","headerItem","contentItems","links","linkLookup","actionLookup","elementHasActions","VizTooltipContainer","CloseButton","roundNumber","decimal","checkIsNumber","handleCallback","easeOut","linear","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","animations","handleCancelAnimationFrame","animation","handleCancelAnimation","contextInstance","handleSetupAnimation","animationName","animationTime","startTime","lastStep","frameTime","animationProgress","animationType","step","isValidTargetState","targetState","positionX","positionY","animate","isValid","setTransformState","scaleDiff","positionXDiff","positionYDiff","newScale","newPositionX","newPositionY","getComponentsSizes","wrapperComponent","contentComponent","wrapperWidth","wrapperHeight","newContentWidth","newContentHeight","newDiffWidth","newDiffHeight","diffWidth","diffHeight","centerZoomedOut","scaleWidthFactor","scaleHeightFactor","minPositionX","maxPositionX","minPositionY","maxPositionY","calculateBounds","boundLimiter","minBound","maxBound","handleCalculateBounds","getMouseBoundedPosition","limitToBounds","paddingValueX","paddingValueY","paddingX","paddingY","handleCalculateZoomPositions","scaleDifference","calculatedPositionX","calculatedPositionY","newPositions","checkZoomBounds","minScale","maxScale","zoomPadding","enablePadding","scalePadding","minScaleWithPadding","isPanningStartAllowed","excluded","isInitialized","targetIsShadowDom","isWrapperChild","isAllowed","isExcluded","isExcludedNode","isPanningAllowed","isPanning","setup","disabled","handlePanningSetup","handleTouchPanningSetup","oneFingerTouch","handlePanToBounds","xChanged","yChanged","mousePosX","mousePosY","handleNewPosition","getPanningClientPosition","startCoords","transformState","panning","lockAxisX","lockAxisY","getPaddingValue","disablePadding","isVelocityCalculationAllowed","mounted","velocityAnimation","disabledVelocity","isVelocityAllowed","velocity","getVelocityMoveTime","equalToMove","sensitivity","getVelocityPosition","newPosition","startPosition","currentPosition","isLocked","minPosition","maxPosition","minTarget","maxTarget","calculatedPosition","getSizeMultiplier","defaultMultiplier","handleCalculateVelocity","lastMousePosition","velocityTime","sizeMultiplier","distanceX","distanceY","velocityX","velocityY","interval","speed","handleVelocityPanning","alignmentAnimation","zoomAnimation","sizeX","sizeY","velocityAlignmentTime","alignAnimationTime","moveAnimationTime","finalAnimationTime","maxTargetX","minTargetX","maxTargetY","minTargetY","startState","alignAnimation","alignStep","customStep","currentPositionX","currentPositionY","handlePanningStart","handleAlignToBounds","isDisabled","handlePanning","handlePanningEnd","velocityDisabled","wrapperRect","contentRect","isZoomed","handleZoomToPoint","handleAlignToScaleBounds","mousePositionX","mousePositionY","initialState","initialSetup","baseClasses","createState","createSetup","newSetup","validValue","validParameter","dataType","handleCalculateButtonZoom","smooth","targetScale","handleZoomToViewCenter","resetTransformations","onResetTransformation","initialTransformation","newBounds","boundedPositions","newState","getOffset","wrapper","content","wrapperOffset","contentOffset","xOff","yOff","calculateZoomToNode","customZoom","nodeRect","nodeOffset","nodeLeft","nodeTop","nodeWidth","nodeHeight","zoomIn","zoomOut","setTransform","resetTransform","centerView","getCenterPosition","zoomToElement","getControls","getState","passiveSupported","makePassiveEventOption","matchPrefix","exclude","cancelTimeout","timeout","getTransformStyles","getMatrixTransformStyles","centerPositionX","centerPositionY","mergeRefs","isWheelAllowed","wheelDisabled","touchPadDisabled","getDeltaY","getDelta","customDelta","getMousePosition","handleCalculateWheelZoom","disable","getTarget","paddingEnabled","handleWheelZoomStop","previousWheelEvent","isPinchStartAllowed","isPinchAllowed","pinchStartDistance","calculateTouchMidPoint","firstPointX","firstPointY","secondPointX","secondPointY","getTouchDistance","calculatePinchZoom","currentDistance","pinchStartScale","touchProportion","wheelStopEventTime","wheelAnimationTime","handleWheelStart","onWheelStart","onZoomStart","handleWheelZoom","onWheel","onZoom","wheel","smoothStep","zoomStep","mousePosition","isPaddingDisabled","isLimitedToBounds","handleWheelStop","onWheelStop","onZoomStop","hasStoppedZooming","getTouchCenter","totalX","totalY","handlePinchStart","handlePinchZoom","midPoint","panX","panY","finalX","finalY","handlePinchStop","pinchMidpoint","handleDoubleClickStop","handleDoubleClickResetMode","getDoubleClickScale","mode","handleDoubleClick","doubleClickStopEventTimer","isDoubleClickAllowed","ZoomPanPinch","newProps","currentDocument","currentWindow","centerOnInit","currentWidth","currentHeight","keysPressed","onPanningStart","onPanning","onPanningStop","onPinchingStart","onPinching","onPinchingStop","isDoubleTap","isPanningAction","isPinchAction","onTransformed","ctx_1","Context","getContent","TransformWrapper","instance","KeepScale","localRef","initialElementRect","useResize","onResize","dependencies","resizeObserverRef","rectRef","didUnmount","entries","newSize","previewStyles","MiniMap","borderColor","rest","initialized","setInitialized","useTransformContext","miniMapInstance","mainRef","wrapperRef","previewRef","getViewportSize","getContentSize","computeMiniMapScale","contentSize","computeMiniMapSize","computeMiniMapStyle","transformMiniMap","miniSize","wrapSize","previewScale","initialize","useTransformEffect","useTransformInit","zpp","wrapperStyle","styleInject","insertAt","head","css_248z","TransformComponent","wrapperClass","contentClass","contentStyle","wrapperProps","contentProps","init","cleanupWindowEvents","contentRef","libraryContext","useControls","unmountCallback","unmount","useTransformComponent","transformRender","setTransformRender","SceneTransformWrapper","sceneDiv","zoomPanPinchRef","updateMoveable","onSceneContainerMouseDown","RootElement","changeCallback","Scene","enableEditing","showAdvancedTypes","panZoom","infinitePan","onSave","ReplaySubject","Subject","visible","transformInstance","isFrame","scalar","sceneContainer","skipNextSelectionBroadcast","hasDataLinks","hasActions","isTooltipValid","canShowElementTooltip","SetBackground","bgImage","setBgImage","ResourcePickerPopover","BackgroundSizeEditor","imageSize","onImageSizeChange","defaultLineStyleConfig","LineStyleEditor","onLineStyleChange","onAnimateChange","Switch","ActionsEditor","oneClickMode","ActionsInlineEditor","DataLinksEditor","DataLinksInlineEditor","getCategoryName","optionBuilder","getConnectionEditor","lodash","ConstraintSelectionBox","onVerticalConstraintChange","onHorizontalConstraintChange","currentConstraints","onClickTopConstraint","onClickBottomConstraint","onClickVerticalCenterConstraint","onClickLeftConstraint","onClickRightConstraint","onClickHorizontalCenterConstraint","HOVER_COLOR","HOVER_OPACITY","SELECTED_COLOR","selectionBoxColor","QuickPositioning","onPositionChange","settings","onQuickPositioningChange","defaultConstraint","originalConstraint","getRightBottomPosition","elementSize","places","horizontalOptions","verticalOptions","PlacementEditor","layout","reselectElementAfterChange","onHorizontalConstraintSelect","onVerticalConstraintSelect","Icon","NumberInput","getElementEditor","layer","layerTypes","actionsEnabled","isUnsupported","currentOptions","oneClickModeOptions","oneClickCategory","oneClickDescription","TreeContext","DropIndicator","_ref","dropPosition","dropLevelOffset","indent","_objectDestructuringEmpty","Indent","prefixCls","level","baseClassName","_excluded","ICON_OPEN","ICON_CLOSE","defaultTitle","InternalTreeNode","_React$Component","_len","_key","onNodeClick","onNodeDoubleClick","onNodeSelect","_this$props","disableCheckbox","onNodeCheck","targetChecked","onNodeMouseEnter","onNodeMouseLeave","onNodeContextMenu","onNodeDragStart","onNodeDragEnter","onNodeDragOver","onNodeDragLeave","onNodeDragEnd","onNodeDrop","_this$props2","onNodeExpand","expanded","eventKey","keyEntities","_this$props3","isLeaf","loaded","loadData","hasChildren","treeDisabled","checkable","treeCheckable","_this$props$context","onNodeLoad","_this$props4","draggable","_this$props$context2","switcherIconFromProps","switcherIconFromCtx","switcherIcon","_switcherIconDom","switcherCls","switcherIconDom","_this$props5","halfChecked","$custom","dragNodeHighlight","_this$props6","_this$props6$title","title","selected","icon","_this$props$context3","showIcon","treeIcon","titleRender","wrapClass","$icon","currentIcon","titleNode","$title","_this$props7","_this$props$context4","dropIndicatorRender","dragOverNodeKey","rootDraggable","showIndicator","mergedIndent","selectable","treeSelectable","_classNames","_this$props8","dragOver","dragOverGapTop","dragOverGapBottom","domRef","active","onMouseMove","_this$props$context5","filterTreeNode","dropContainerKey","dropTargetKey","draggingNodeKey","dataOrAriaAttributeProps","pickAttrs","_ref2","isEndNode","mergedDraggable","draggableWithoutDisabled","dragging","ariaSelected","ContextTreeNode","useUnmount","triggerStart","triggerEnd","_React$useState","_React$useState2","firstMount","setFirstMount","MotionTreeNode","motion","motionNodes","motionType","onOriginMotionStart","onOriginMotionEnd","treeNodeRequiredProps","setVisible","_React$useContext","targetVisible","triggerMotionStart","triggerMotionEndRef","triggerMotionEnd","onVisibleChanged","nextVisible","motionRef","motionClassName","motionStyle","treeNode","restProps","treeNodeProps","RefMotionTreeNode","findExpandedKeys","prevLen","nextLen","find","shorter","longer","getExpandRange","shorterStartIndex","shorterEndNode","longerStartIndex","longerEndIndex","HIDDEN_STYLE","noop","MOTION_KEY","MotionNode","MotionEntity","MotionFlattenData","getMinimumRangeTransitionRange","itemHeight","itemKey","getAccessibilityPath","NodeList","expandedKeys","selectedKeys","checkedKeys","loadedKeys","loadingKeys","halfCheckedKeys","focusable","activeItem","focused","tabIndex","onFocus","onBlur","onActiveChange","onListChangeStart","onListChangeEnd","domProps","listRef","indentMeasurerRef","scroll","prevExpandedKeys","setPrevExpandedKeys","_React$useState3","_React$useState4","prevData","setPrevData","_React$useState5","_React$useState6","transitionData","setTransitionData","_React$useState7","_React$useState8","transitionRange","setTransitionRange","_React$useState9","_React$useState10","setMotionType","dataRef","onMotionEnd","latestData","diffExpanded","rangeNodes","newTransitionData","_keyIndex","_rangeNodes","_newTransitionData","mergedData","originList","mergedKey","arrDel","clone","arrAdd","posToArr","getDragChildrenKeys","dragNodeKey","dragChildrenKeys","entity","dig","isLastChild","treeNodeEntity","posArr","isFirstChild","calcDropPosition","dragNode","targetNode","startMousePosition","allowDrop","flattenedNodes","expandKeys","_abstractDropNodeEnti","_getBoundingClientRec","horizontalMouseOffset","rawDropLevelOffset","filteredExpandKeys","_keyEntities$key","abstractDropNodeEntity","nodeIndex","flattenedNode","prevNodeIndex","prevNodeKey","initialAbstractDropNodeKey","abstractDragOverEntity","abstractDragDataNode","abstractDropDataNode","dropAllowed","calcSelectedKeys","internalProcessProps","convertDataToTree","treeData","processor","_ref2$processProps","processProps","_ref3","childrenNodes","parseCheckedKeys","keyProps","warning","conductExpandParent","keyList","conductUp","MAX_RETRY_TIMES","Tree","_args","_this$state","onDragStart","newExpandedKeys","_this$state2","flattenNodes","onDragEnter","onExpand","_node$props","_assertThisInitialize","_calcDropPosition","dropTargetPos","_this$state3","onDragOver","_assertThisInitialize2","_calcDropPosition2","onDragLeave","onDragEnd","_this$getActiveItem","outsideTree","_this$state4","onDrop","abstractDropNodeProps","dropToChild","dropResult","_this$state5","nodeItem","eventNode","expandAction","onDoubleClick","_this$state6","onSelect","targetSelected","selectedNodes","selectedKey","_this$state7","oriCheckedKeys","oriHalfCheckedKeys","checkStrictly","onCheck","checkedObj","eventObj","checkedKey","_conductCheck","_checkedKeys","_halfCheckedKeys","keySet","_conductCheck2","_entity$children","loadPromise","reject","_ref$loadedKeys","_ref$loadingKeys","onLoad","promise","currentLoadedKeys","newLoadedKeys","onMouseEnter","onMouseLeave","onRightClick","_len2","_key2","_len3","_key3","_this$state8","_this$state9","_this$state10","listChanging","targetExpanded","newFlattenTreeData","currentExpandedKeys","expandedKeysToRestore","newActiveKey","activeKey","_this$props9","_this$props9$itemScro","itemScrollOffset","_this$state11","_this$state12","_key4","_this$state13","_this$props10","KeyCode","expandable","atomic","forceState","needSync","allPassed","_this$props11","_this$props11$itemScr","_this$state14","_this$props12","showLine","_this$props12$tabInde","onContextMenu","onScroll","rootClassName","rootStyle","draggableConfig","entitiesMap","cloneKeyEntities","nextExpandedKeys","checkedKeyEntity","_checkedKeyEntity","_checkedKeyEntity$che","_checkedKeyEntity$hal","conductKeys","getGlobalStyles","TreeNodeTitle","nodeData","setAllowSelection","getScene","onDelete","onDuplicate","onNameChange","verifyLayerNameUniqueness","nameToVerify","getLayerInfo","LayerName","getTreeData","root","selectedColor","destKey","srcKey","destPos","srcElement","allowSelection","TreeNavigationEditor","setTreeData","autoExpandParent","setAutoExpandParent","setExpandedKeys","setSelectedKeys","globalCSS","selectedBgColor","selectionByUID","srcEl","destEl","allow","onClearSelection","onTitleRender","onFrameSelection","getLayerEditor","TabsEditor","onTabChange","activeTab","setActiveTab","tabs","onCurrentTabChange","TabsBar","Tab","InlineEditBody","activePanel","activePanelSubject","instanceState","pane","OptionsPaneCategoryDescriptor","supplier","addStandardCanvasEditorOptions","getOptionsPaneCategoryDescriptor","topLevelItemsContainerStyle","tab","noElementSelected","renderOptionsPaneCategoryDescriptor","OptionsPaneCategory","getOptionsPaneCategory","categoryNames","access","OFFSET_X","OFFSET_Y","InlineEdit","windowHeight","windowWidth","inlineEditKey","defaultMeasurements","defaultX","defaultY","savedPlacement","measurements","setMeasurements","setPlacement","onDragStop","saveToStore","onResizeStop","canvasInstances","activeCanvasPanel","isInlineEditOpen","isSetBackgroundOpen","CanvasPanel","Subscription","onOptionsChange","tooltip","dashboard","allowEditing","PanelContext","canvasInstance","ci","inlineEditingSwitched","shouldShowAdvancedTypesSwitched","panZoomSwitched","infinitePanSwitched","helpUrl","PanZoomHelp","Alert","newWindow","canvasMigrationHandler","pluginVersion","PanelPlugin","connectionSelection","HorizontalConstraint","VerticalConstraint","BackgroundImageSize","HttpRequestMethod","defaultCanvasConnection","defaultCanvasElementOptions","defaultOptions","getDataLinks","rowIdx","disp","getFieldActions","dataFrame","replaceVars","rowIndex"],"sourceRoot":""}