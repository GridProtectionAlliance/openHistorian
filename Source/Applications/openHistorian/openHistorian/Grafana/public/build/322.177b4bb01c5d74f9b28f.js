(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[322],{76287:(_,L,e)=>{"use strict";e.d(L,{p:()=>s});var t=e(74848),n=e(96540),r=e(94841);function s(a){const{children:g,instanceSettings:i}=a,l=(0,n.useMemo)(()=>({instanceSettings:i,meta:i.meta}),[i]);return(0,t.jsx)(r.o.Provider,{value:l,children:g})}},94841:(_,L,e)=>{"use strict";e.d(L,{o:()=>n});var t=e(96540);const n=(0,t.createContext)(void 0)},13834:(_,L,e)=>{"use strict";e.d(L,{a:()=>r});var t=e(74848),n=e(94841);function r(s){const{children:a,...g}=s;return(0,t.jsx)(n.o.Provider,{value:g,children:a})}},95187:(_,L,e)=>{"use strict";e.d(L,{S:()=>t});function t(n){return"instanceSettings"in n&&"meta"in n}},92470:(_,L,e)=>{"use strict";e.d(L,{Q:()=>r});var t=e(96540),n=e(94841);function r(){const s=(0,t.useContext)(n.o);return s||null}},33948:(_,L,e)=>{"use strict";e.d(L,{I:()=>s,f:()=>r});var t=e(11261),n=e(14236);class r{constructor(l,d){return this.fields=[],this.length=0,s(l,d)}}function s(i,l){const d={fields:[],length:i.length};if(!i?.length)return d;if(l){if(!g(i))throw new Error("source is not an array of objects");for(const u of l)d.fields.push(a(u,i.map(c=>c&&c[u])));return d}if(i.find(u=>u)===null)return d;if(g(i)){const u=i.find(c=>c);d.fields=Object.keys(u||{}).map(c=>a(c,i.map(p=>p&&p[c])))}else d.fields.push(a(t.Bc,i));return d}function a(i,l){const d={name:i,config:{},values:l,type:t.PU.other};return d.type=(0,n.dF)(d)??t.PU.other,d}function g(i){const l=i.find(d=>d);return i.length>0&&typeof l=="object"}},33526:(_,L,e)=>{"use strict";e.d(L,{x:()=>r});var t=e(36120),n=e(37471);class r extends n.k{constructor(a){super(void 0,g=>new t.$({...a,buffer:g}))}}},89667:(_,L,e)=>{"use strict";e.d(L,{EL:()=>a,Nw:()=>l,or:()=>i,t:()=>s});var t=e(11261),n=e(14236);const r={Inf:1/0,NegInf:-1/0,Undef:void 0,NaN:NaN};function s(d,o){let u;for(u in d){const c=r[u];for(const p of d[u])p<o.length&&(o[p]=c)}}function a(d,o){for(let u=0;u<o.length;u++)o[u]=d[Number(o[u])]}function g(d,o){for(const u of o)if(u!=null)return(0,n.by)(d,u);return t.PU.other}function i(d){const{schema:o,data:u}=d;if(!o||!o.fields)throw new Error("JSON needs a fields definition");const c=u?u.values.reduce((h,y)=>Math.max(h,y.length),0):0,p=o.fields.map((h,y)=>{let f=u?u.values[y]:[],v=f.length,P=h.type;v!==c&&(f.length=c,f.fill(void 0,v));let m=u?.entities?.[y];m&&s(m,f);let D=u?.enums?.[y];D&&(a(D,f),P=t.PU.string);const x=u?.nanos?.[y],E={...h,type:P??g(h.name,f),config:h.config??{},values:f,entities:m??{}};return x!=null&&(E.nanos=x),E});return{...o,fields:p,length:c}}function l(d){const o={values:[]},u=[];let c=!1;const p={refId:d.refId,meta:d.meta,name:d.name,fields:d.fields.map(h=>{const{values:y,nanos:f,state:v,display:P,...m}=h;return"entities"in m&&delete m.entities,o.values.push(y),f!=null?(u.push(f),c=!0):u.push(null),m})};return c&&(o.nanos=u),{schema:p,data:o}}},78368:(_,L,e)=>{"use strict";e.d(L,{R:()=>n});var t=e(18008);class n extends t.F{constructor(s){super(),this.data=s,this.index=0;const a={},g={};for(let i=0;i<s.fields.length;i++){const l=s.fields[i];if(!l.name)continue;g[l.name]=l;const d=()=>l.values.get(this.index);a.hasOwnProperty(l.name)||Object.defineProperty(a,l.name,{enumerable:!0,get:d}),a.hasOwnProperty(i.toString())||Object.defineProperty(a,i,{enumerable:!1,get:d})}this.obj=a,this.fields=g}get dataFrame(){return this.data}get length(){return this.data.length}getFieldDisplayProcessor(s){if(!this.dataFrame||!this.dataFrame.fields)return;const a=this.dataFrame.fields[s];if(!(!a||!a.display))return a.display}get(s){return this.index=s,this.obj}toArray(){return new Array(this.data.length).fill(0).map((s,a)=>({...this.get(a)}))}}},85404:(_,L,e)=>{"use strict";e.d(L,{L:()=>r});var t=e(11261),n=e(14236);class r{constructor(a){this.fields=[],this.fieldByName={},this.fieldByType={},this.fields=a.fields.map((g,i)=>({...g,index:i}));for(let g=0;g<a.fields.length;g++){const i=a.fields[g];if(i.type===t.PU.other){const l=(0,n.dF)(i);l&&(i.type=l)}this.fieldByType[i.type]||(this.fieldByType[i.type]=[]),this.fieldByType[i.type].push({...i,index:g}),this.fieldByName[i.name]?console.warn("Duplicate field names in DataFrame: ",i.name):this.fieldByName[i.name]={...i,index:g}}}getFields(a){if(!a)return[...this.fields];const g=this.fieldByType[a];return g?[...g]:[]}hasFieldOfType(a){const g=this.fieldByType[a];return g&&g.length>0}getFirstFieldOfType(a,g=!1){return this.fieldByType[a]?.find(d=>g||!d.config.custom?.hidden)}hasFieldNamed(a){return!!this.fieldByName[a]}hasFieldWithNameAndType(a,g){return!!this.fieldByName[a]&&this.fieldByType[g].filter(i=>i.name===a).length>0}getFieldByName(a){return this.fieldByName[a]}getFieldsByLabel(a,g){return Object.values(this.fieldByName).filter(i=>i.labels&&i.labels[a]===g)}}},37471:(_,L,e)=>{"use strict";e.d(L,{p:()=>g,k:()=>i});var t=e(2543),n=e(11261),r=e(14236);function s(l,d){return d.type||(d.name==="time"||d.name==="Time"?d.type=n.PU.time:d.type=(0,r.HW)(l)),d.type===n.PU.number?o=>parseFloat(o):d.type===n.PU.boolean?o=>!(o[0]==="F"||o[0]==="f"||o[0]==="0"):o=>o}var a=e(18008);const g=void 0;class i extends a.F{constructor(d,o){if(super(),this.fields=[],this.first=[],this.parsers=void 0,this.creator=o||(u=>u??[]),d){const{name:u,refId:c,meta:p,fields:h}=d;if(u&&(this.name=u),c&&(this.refId=c),p&&(this.meta=p),h)for(const y of h)this.addField(y)}Object.defineProperty(this,"length",{enumerable:!0,get:()=>this.first.length})}get length(){return this.first.length}addFieldFor(d,o){return this.addField({name:o||"",type:(0,r.HW)(d)})}addField(d,o){let u;d.values&&(u=d.values);let c=d.type;!c&&(d.name==="time"||d.name==="Time")?c=n.PU.time:(!c&&u&&u.length&&(c=(0,r.HW)(u[0])),c||(c=n.PU.other));let p=d.name;p||(p=`Field ${this.fields.length+1}`);const h={...d,name:p,type:c,config:d.config||{},values:this.creator(u)};if(c===n.PU.other&&(c=(0,r.dF)(h),c&&(h.type=c)),this.fields.push(h),this.first=this.fields[0].values,o)for(;h.values.length<o;)h.values.push(g);else this.validate();return h}validate(){const d=this.fields.reduce((o,u)=>Math.max(o,u.values.length),0);for(const o of this.fields)for(;o.values.length!==d;)o.values.push(g)}setParser(d,o){return this.parsers||(this.parsers=new Map),this.parsers.set(d,o),o}parseValue(d,o){let u=this.parsers?.get(d);return u||(u=this.setParser(d,s(o,d))),u(o)}appendRow(d){for(let o=this.fields.length;o<d.length;o++)this.addField({name:`Field ${o+1}`,type:(0,r.HW)(d[o])});if(this.length<1)for(let o=0;o<this.fields.length;o++){const u=this.fields[o];(!u.type||u.type===n.PU.other)&&(u.type=(0,r.HW)(d[o]))}for(let o=0;o<this.fields.length;o++){const u=this.fields[o];let c=d[o];u.type!==n.PU.string&&(0,t.isString)(c)&&(c=this.parseValue(u,c)),u.values.push(c)}}push(...d){for(const o of d)this.add(o);return this.length}reverse(){for(const d of this.fields)d.values.reverse();return this}add(d){const o=d;for(const u of this.fields){let c=o[u.name];u.type!==n.PU.string&&(0,t.isString)(c)&&(c=this.parseValue(u,c)),c===void 0&&(c=g),u.values.push(c)}}set(d,o){if(d>this.length)throw new Error("Unable to set value beyond current length");const u=o||{};for(const c of this.fields)c.values[d]=u[c.name]}get(d){const o={};for(const u of this.fields)o[u.name]=u.values[d];return o}toJSON(){return(0,r.Kl)(this)}}},9631:(_,L,e)=>{"use strict";e.d(L,{Kh:()=>i,Ls:()=>p,k9:()=>o,m8:()=>u});var t=e(73060),n=e(11261),r=e(8249),s=e(43659),a=e(89667),g=e(14236),i=(D=>(D.Append="append",D.Replace="replace",D))(i||{});const l="__name__";var d=(D=>(D[D.wide=0]="wide",D[D.labels=1]="labels",D))(d||{});class o{constructor(x){this.options=x,this.meta={},this.fields=[],this.length=0,this.schemaFields=[],this.timeFieldIndex=-1,this.pushMode=0,this.labels=new Set,this.packetInfo={schemaChanged:!0,number:0,action:"replace",length:0},this.serialize=(E,C,b)=>{const T=C?Object.assign({},{...this.options,...C}):this.options,A=(0,g.By)(this,E),R=P(A.fields.map(O=>O.values??[]),typeof b?.maxLength=="number"?Math.min(b.maxLength,T.maxLength):T.maxLength,this.timeFieldIndex,T.maxDelta);A.fields=A.fields.map(O=>({...O,values:O.values?.slice(R)}));const S=A.fields[0]?.values?.length??0;return{...A,labels:this.labels,schemaFields:this.schemaFields,name:this.name,refId:this.refId,meta:this.meta,length:S,timeFieldIndex:this.timeFieldIndex,pushMode:this.pushMode,packetInfo:this.packetInfo,options:T}},this.initFromSerialized=E=>{this.name=E.name,this.refId=E.refId,this.meta=E.meta,this.length=E.length,this.labels=E.labels,this.schemaFields=E.schemaFields,this.timeFieldIndex=E.timeFieldIndex,this.pushMode=E.pushMode,this.packetInfo.length=E.packetInfo.length,this.packetInfo.number=E.packetInfo.number,this.packetInfo.action="replace",this.packetInfo.schemaChanged=!0,this.fields=E.fields.map(C=>({...C,type:C.type??n.PU.other,config:C.config??{},values:C.values??[]})),v(this.fields.map(C=>C.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)},this.needsResizing=({maxLength:E,maxDelta:C})=>{const b=E&&this.options.maxLength<E,T=C&&this.options.maxDelta<C,A=C&&this.options.maxDelta===1/0;return!!(b||T||A)},this.resize=({maxLength:E,maxDelta:C})=>{C&&(this.options.maxDelta===1/0?this.options.maxDelta=C:this.options.maxDelta=Math.max(C,this.options.maxDelta)),this.options.maxLength=Math.max(this.options.maxLength,E??0)},this.pushNewValues=E=>{if(!E?.length)return;this.packetInfo.action=this.options.action,this.packetInfo.number++,this.packetInfo.length=E[0].length,this.packetInfo.schemaChanged=!1,this.options.action==="append"?f(this.fields.map(b=>b.values),E,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta):(E.forEach((b,T)=>{this.fields[T]&&(this.fields[T].values=b)}),v(this.fields.map(b=>b.values),this.options.maxLength,this.timeFieldIndex,this.options.maxDelta));const C=this.fields?.[0]?.values.length;C!==void 0&&(this.length=C)},this.resetStateCalculations=()=>{this.fields.forEach(E=>{E.state={...E.state??{},calcs:void 0,range:void 0}})},this.getMatchingFieldIndexes=E=>this.fields.map((C,b)=>E(C)?b:void 0).filter(C=>C!==void 0),this.getValuesFromLastPacket=()=>this.fields.map(E=>{const C=E.values;return C.slice(Math.max(C.length-this.packetInfo.length))}),this.hasAtLeastOnePacket=()=>!!this.packetInfo.length,this.getOptions=()=>this.options,Object.defineProperty(this,"length",{enumerable:!0}),Object.defineProperty(this,"fields",{enumerable:!0})}static{this.deserialize=x=>{const E=new o(x.options);return E.initFromSerialized(x),E}}static{this.empty=x=>new o(u(x))}static{this.fromDataFrameJSON=(x,E)=>{const C=new o(u(E));return C.push(x),C}}get alwaysReplace(){return this.options.action==="replace"}push(x){const{schema:E,data:C}=x;if(this.packetInfo.number++,this.packetInfo.length=0,this.packetInfo.schemaChanged=!1,E){this.pushMode=0,this.timeFieldIndex=E.fields.findIndex(R=>R.type===n.PU.time);const b=E.fields[0];this.timeFieldIndex===1&&b.type===n.PU.string&&(b.name==="labels"||b.name==="Labels")&&(this.pushMode=1,this.timeFieldIndex=0);const T=this.pushMode===1?E.fields.slice(1):E.fields;this.refId=E.refId,E.meta&&(this.meta={...E.meta});const{displayNameFormat:A}=this.options;if(m(this.schemaFields,T)){const R=T.length;this.fields.forEach((S,O)=>{const j=T[O%R];S.config=j.config??{},S.labels=j.labels}),A&&this.fields.forEach(S=>{const O={[l]:S.name,...S.labels};S.config.displayNameFromDS=(0,s.j)(A,O)})}else{this.packetInfo.schemaChanged=!0;const R=this.pushMode===0;this.fields=T.map(S=>{const O=S.config??{};if(A){const j={[l]:S.name,...S.labels};O.displayNameFromDS=(0,s.j)(A,j)}return{config:O,name:S.name,labels:S.labels,type:S.type??n.PU.other,values:R?this.fields.find(j=>j.name===S.name&&S.type===j.type)?.values??Array(this.length).fill(void 0):[]}})}this.schemaFields=T}if(C&&C.values.length&&C.values[0].length){let{values:b,entities:T}=C;if(T&&T.forEach((R,S)=>{R&&(0,a.t)(R,b[S])}),this.pushMode===1){const R=c(b);for(const j of R.keys())this.labels.has(j)||(this.packetInfo.schemaChanged=!0,this.addLabel(j));let S=Array(this.schemaFields.length).fill([]),O=[];this.labels.forEach(j=>{O.push(R.get(j)??S)}),b=(0,t.fj)(O)}if(b.length!==this.fields.length){if(this.fields.length)throw new Error(`push message mismatch.  Expected: ${this.fields.length}, received: ${b.length} (labels=${this.pushMode===1})`);this.fields=b.map((R,S)=>{let O=`Field ${S}`,j=(0,g.HW)(R[0]);return S===0&&j===n.PU.number&&R[0]>1600016688632&&(j=n.PU.time,O="Time"),{name:O,type:j,config:{},values:[]}})}let A=b;this.packetInfo.length=b[0].length,this.alwaysReplace||!this.length?this.packetInfo.action="replace":(this.packetInfo.action="append",A=this.fields.map(R=>R.values),f(A,b,this.options.maxLength,this.timeFieldIndex,this.options.maxDelta)),A.forEach((R,S)=>{const O=this.fields[S],{state:j}=O;O.values=R,j&&(j.calcs=void 0)}),this.length=A[0].length}return{...this.packetInfo}}addLabel(x){const{displayNameFormat:E}=this.options,C=this.labels.size,b=h(x);if(C===0)this.fields.forEach((T,A)=>{if(A>0&&(T.labels=b,E)){const R={[l]:T.name,...b};T.config.displayNameFromDS=(0,s.j)(E,R)}});else for(let T=1;T<this.schemaFields.length;T++){let A=this.schemaFields[T];const R=A.config??{};if(E){const S={[l]:A.name,...b};R.displayNameFromDS=(0,s.j)(E,S)}this.fields.push({...A,config:R,labels:b,values:Array(this.length).fill(void 0)})}this.labels.add(x)}}function u(D){return{maxLength:D?.maxLength??1e3,maxDelta:D?.maxDelta??1/0,action:D?.action??"append",displayNameFormat:D?.displayNameFormat}}function c(D){let x=new Set(D[0]),E=new Map;x.forEach(C=>{let b=Array(D.length-1).fill(null).map(()=>[]);E.set(C,b)});for(let C=0;C<D[0].length;C++){let b=E.get(D[0][C]);for(let T=1;T<D.length;T++)b[T-1].push(D[T][C])}return E}function p(D,x,E,C){let b;E=E||0,C=C||x.length-1;let T=C<=2147483647;for(;C-E>1;)b=T?E+C>>1:Math.floor((E+C)/2),x[b]<D?E=b:C=b;return D-x[E]<=x[C]-D?E:C}function h(D){if(!D.length)return{};if(D.charAt(0)==="{")return(0,r.Xy)(D);const x={};return D.split(",").forEach(E=>{const[C,b]=E.trim().split("=");x[C]=b}),x}function y(D){const x=D.packetInfo;return x?.action?x:void 0}function f(D,x,E=1/0,C=0,b=1/0){for(let T=0;T<D.length;T++)for(let A=0;A<x[T].length;A++)D[T].push(x[T][A]);return v(D,E,C,b)}function v(D,x=1/0,E=0,C=1/0){const b=P(D,x,E,C);if(b)for(let T=0;T<D.length;T++)D[T].splice(0,b);return b}function P(D,x=1/0,E=0,C=1/0){if(!D[0]?.length)return 0;const b=D[0].length;let T=0;if(b>x&&(T=b-x),C!==1/0&&E>=0){const A=D[E],R=A[T],S=A[b-1];S-R>C&&(T=p(S-C,A,T))}return T}function m(D,x){if(D?.length!==x.length)return!1;for(let E=0;E<D.length;E++){const C=D[E],b=x[E];if(C.name!==b.name||C.type!==b.type)return!1}return!0}},61443:(_,L,e)=>{"use strict";e.d(L,{Km:()=>a,P4:()=>r,WK:()=>s,g6:()=>n,r4:()=>t,xB:()=>g});const t=(i,l)=>({name:i,columns:l}),n=i=>i.columns,r=(i,l)=>i.columns[l],s=(i,l,d)=>i.columns[l].values[d],a=(i,l,d)=>i.columns.map(o=>o.values[d]),g=(i,l)=>i[l]},21423:(_,L,e)=>{"use strict";e.d(L,{J3:()=>s,ab:()=>g,bW:()=>r});var t=e(2543),n=e.n(t);function r(i,l,d){if(i===l)return!0;if(i?.fields?.length!==l?.fields?.length||i.name!==l.name)return!1;for(let o=0;o<i.fields.length;o++){const u=i.fields[o],c=l.fields[o];if(u.type!==c.type||u.name!==c.name)return!1;if(d)continue;if(u.labels&&c.labels&&!g(u.labels,c.labels))return!1;const p=u.config,h=c.config;if(Object.keys(p).length!==Object.keys(h).length)return!1;let y;for(y in p){if(!(y in h))return!1;if(y!=="interval"&&!(0,t.isEqual)(p[y],h[y]))return!1}}return!0}function s(i,l,d){if(i===l)return!0;if(i?.length!==l?.length)return!1;for(let o=0;o<i.length;o++)if(!d(i[o],l[o]))return!1;return!0}const a=(i,l)=>i===l;function g(i,l,d=a){if(i===l)return!0;if(Object.keys(i).length!==Object.keys(l).length)return!1;let o;for(o in i)if(!d(i[o],l[o]))return!1;return!0}},14236:(_,L,e)=>{"use strict";e.d(L,{Bt:()=>N,By:()=>O,EI:()=>K,ES:()=>T,HW:()=>v,KR:()=>j,Kl:()=>S,LI:()=>E,N$:()=>I,Vc:()=>C,XQ:()=>m,Yn:()=>R,by:()=>y,ci:()=>x,dF:()=>P,oE:()=>f,pH:()=>D,q7:()=>A,w3:()=>b});var t=e(2543),n=e.n(t),r=e(47232),s=e(48241),a=e(28240),g=e(39070),i=e(11261),l=e(33948),d=e(89667);function o(w){const U=w.columns.map(W=>{const{text:H,type:z,...G}=W,M=[];return{name:H?.length?H:W,config:G||{},values:M,type:z&&Object.values(i.PU).includes(z)?z:i.PU.other}});if(!(0,t.isArray)(w.rows))throw new Error(`Expected table rows to be array, got ${typeof w.rows}.`);for(const W of w.rows)for(let H=0;H<U.length;H++)U[H].values.push(W[H]);for(const W of U)if(W.type===i.PU.other){const H=P(W);H&&(W.type=H)}return{fields:U,refId:w.refId,meta:w.meta,name:w.name,length:w.rows.length}}function u(w){const U=[],W=[],H=w.datapoints||w.points;for(const G of H)W.push(G[0]),U.push(G[1]);const z=[{name:i.LE,type:i.PU.time,config:{},values:U},{name:i.Bc,type:i.PU.number,config:{unit:w.unit},values:W,labels:w.tags}];return w.title&&(z[1].config.displayNameFromDS=w.title),{name:w.target||w.name,refId:w.refId,meta:w.meta,fields:z,length:W.length}}function c(w){const U=[],W=[];for(let H=0;H<w.data.length;H++){const z=w.data[H];U.push(z[1]),W.push(z[0])}return{name:w.label,fields:[{name:w.label||i.Bc,type:i.PU.number,config:{},values:U},{name:i.LE,type:i.PU.time,config:{unit:"dateTimeAsIso"},values:W}],length:U.length}}function p(w){const U=[{name:w.target,type:i.PU.other,labels:w.tags,config:{unit:w.unit,filterable:w.filterable},values:[]}];for(const W of w.datapoints)U[0].values.push(W);return{name:w.target,refId:w.target,meta:{json:!0},fields:U,length:w.datapoints.length}}const h=/^\s*(-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?|NAN)\s*$/i;function y(w,U){return w&&(w=w.toLowerCase(),w==="date"||w==="time")?i.PU.time:v(U)}function f(w){return w instanceof Date||(0,r.Ar)(w)?i.PU.time:(0,t.isNumber)(w)?i.PU.number:(0,t.isString)(w)?i.PU.string:(0,t.isBoolean)(w)?i.PU.boolean:i.PU.other}function v(w){return w instanceof Date||(0,r.Ar)(w)?i.PU.time:(0,t.isNumber)(w)?i.PU.number:(0,t.isString)(w)?h.test(w)?i.PU.number:w==="true"||w==="TRUE"||w==="True"||w==="false"||w==="FALSE"||w==="False"?i.PU.boolean:i.PU.string:(0,t.isBoolean)(w)?i.PU.boolean:i.PU.other}function P(w){if(w.name){const U=w.name.toLowerCase();if(U==="date"||U==="time")return i.PU.time}for(let U=0;U<w.values.length;U++){const W=w.values[U];if(W!=null)return v(W)}}const m=(w,U=!1)=>{for(const W of w.fields)if(!W.type||W.type===i.PU.other||U)return{...w,fields:w.fields.map(H=>H.type&&H.type!==i.PU.other&&!U?H:{...H,type:P(H)||i.PU.other})};return w},D=w=>!!(w&&w.hasOwnProperty("columns")),x=w=>!!(w&&w.hasOwnProperty("fields")),E=w=>!!(x(w)&&w.hasOwnProperty("value"));function C(w){if("fields"in w)return"length"in w&&w.fields[0]?.values?.get?w:K(w);if(w.hasOwnProperty("type")&&w.type==="docs")return p(w);if(w.hasOwnProperty("datapoints")||w.hasOwnProperty("points"))return u(w);if(w.hasOwnProperty("data"))return w.hasOwnProperty("schema")?(0,d.or)(w):c(w);if(w.hasOwnProperty("columns"))return o(w);if(Array.isArray(w))return(0,l.I)(w);throw console.warn("Can not convert",w),new Error("Unsupported data format")}const b=w=>{const{fields:U}=w,W=w.length,H=[];if(U.length===2){const{timeField:z,timeIndex:G}=j(w);if(z){const Q=U[G===0?1:0],Y=U[G];for(let q=0;q<W;q++)H.push([Q.values[q],Y.values[q]]);return{alias:w.name,target:(0,a.Ct)(Q,w),datapoints:H,unit:U[0].config?U[0].config.unit:void 0,refId:w.refId,meta:w.meta}}}for(let z=0;z<W;z++){const G=[];for(let M=0;M<U.length;M++)G.push(U[M].values[z]);H.push(G)}return w.meta&&w.meta.json?{alias:U[0].name||w.name,target:U[0].name||w.name,datapoints:U[0].values,filterable:U[0].config?U[0].config.filterable:void 0,type:"docs"}:{columns:U.map(z=>{const{name:G,config:M}=z;if(M){const{...Q}=M;return Q.text=G,Q}return{text:G}}),type:"table",refId:w.refId,meta:w.meta,rows:H}};function T(w,U,W=!1){const H=w.fields[U];if(!H)return w;const z=[];for(let M=0;M<w.length;M++)z.push(M);const G=(0,s.i)(H,W);return z.sort(G),{...w,fields:w.fields.map(M=>{const Q={...M,values:M.values.map((q,te)=>M.values[z[te]])},{nanos:Y}=M;return Y!==void 0&&(Q.nanos=Y.map((q,te)=>Y[z[te]])),Q})}}function A(w){return{...w,fields:w.fields.map(U=>{const W=[...U.values];W.reverse();const H={...U,values:W},{nanos:z}=U;if(z!==void 0){const G=[...z];G.reverse(),H.nanos=G}return H})}}function R(w,U){const W=[];for(const H of w.fields)W.push(H.values[U]);return W}function S(w){return O(w)}function O(w,U){return{fields:(U?w.fields.filter(U):w.fields).map(z=>{let G=z.values;return{name:z.name,type:z.type,config:z.config,values:G,labels:z.labels}}),refId:w.refId,meta:w.meta,name:w.name}}const j=w=>{for(let U=0;U<w.fields.length;U++)if(w.fields[U].type===i.PU.time)return{timeField:w.fields[U],timeIndex:U};return{}};function B(w){const U=m(C(w));if(U.fields&&U.fields.length)for(const W of U.fields)W.state=null;return U}function N(w){return!w||!(0,t.isArray)(w)?[]:w.map(U=>B(U))}function I(w,U){const{series:W,annotations:H}=w;if(w.state===g.Gu.Loading&&W.length===0)return U||(U=w),{...U,state:g.Gu.Loading,request:w.request};const z=performance.now(),G=W.map(Y=>B(Y)),M=N(H),Q=performance.now();return{...w,series:G,annotations:M,timings:{dataProcessingTime:Q-z}}}function K(w){let U=0;const W=w.fields.map((H,z)=>{const{state:G,...M}=H;return M.name||(M.name=`Field ${z+1}`),M.config||(M.config={}),M.values?M.values.length>U&&(U=M.values.length):M.values=new Array(U),M.type||(M.type=P(M)??i.PU.other),M});return{...w,fields:W,length:U}}},19845:(_,L,e)=>{"use strict";e.d(L,{S1:()=>l,aH:()=>s,hF:()=>g,jq:()=>a,t9:()=>d,tP:()=>i,uY:()=>o});var t=e(11261),n=e(14236);const r=100;function s(u){if(u.fields.length<2)return!1;const c=u.fields.find(h=>h.type===t.PU.number);let p=!1;for(const h of u.fields)if(g(h)){p=!0;break}return p&&c!==void 0}function a(u){return!u.find(c=>!s(c))}function g(u){if(u.type!==t.PU.time)return!1;let c=null,p=u.values.length>r?r:u.values.length;for(let h=0;h<p;h++){const y=u.values[h];if(c===null||y!==null&&y>c)c=y;else return!1}return!0}function i(u){for(let c=0;c<u.length;c++){const p=(0,n.KR)(u[c]);if(p.timeField!==void 0&&p.timeIndex!==void 0)return!0}return!1}function l(u){return u.fields.some(c=>c.type===t.PU.time)}function d(u,c){if(u.meta?.uniqueRowIdFields!==void 0)return u.meta.uniqueRowIdFields.map(p=>u.fields[p].values[c]).join("-")}function o(u,c){if(c instanceof Array)for(let p=0;p<c.length;p++)u.fields[p].values.push(c[p]);else for(const p of u.fields)p.values.push(c[p.name]);try{u.length++}catch{}}},70416:(_,L,e)=>{"use strict";e.d(L,{E9:()=>g,Ri:()=>i,V3:()=>c,WT:()=>l,dU:()=>a,di:()=>o,pp:()=>u,vd:()=>d});var t=e(89369),n=e(68284),r=e(25579);const s={years:["y","Y","years"],months:["M","months"],weeks:["w","W","weeks"],days:["d","D","days"],hours:["h","H","hours"],minutes:["m","minutes"],seconds:["s","S","seconds"]};function a(h,y=!0){if((0,t.d)(h.start,h.end))return"";const f=(0,n.F)(h);return Object.entries(f).reduce((v,[P,m])=>m&&m!==0&&!(P==="seconds"&&!y&&v)?v+`${v!==""?" ":""}${m}${s[P][0]}`:v,"")}function g(h){return h.split(" ").reduce((y,f)=>{const v=f.match(/(\d+)(.+)/),P=v?.[1],m=v?.[2];if(!(P&&m))return y;const D=Object.entries(s).find(([E,C])=>C?.includes(v[2])),x=parseInt(P,10);return D?{...y,[D[0]]:x}:y},{})}function i(h,y){return(0,r.W)(h,y)}function l(h){const y=new Date;return i(y,h).getTime()-y.getTime()}function d(h){return!isNaN(Date.parse(h))}function o(h){for(const y of h.trim().split(" ")){const f=y.match(/(\d+)(.+)/);if(f===null||f.length!==3||!Object.entries(s).find(([P,m])=>m?.includes(f[2]))?.[0])return!1}return!0}function u(h){return p(h,["h","m","s","ms","us","\xB5s","ns"])}function c(h){return p(h,["y","M","w","d","h","m","s","ms","us","\xB5s","ns"])}function p(h,y){for(const f of h.trim().split(" ")){const v=f.match(/([0-9]*[.]?[0-9]+)(.+)/);if(v===null||v.length!==3||!y.includes(v[2]))return!1}return!0}},91410:(_,L,e)=>{"use strict";e.d(L,{HD:()=>l,P3:()=>o,QZ:()=>d,U3:()=>u,g$:()=>g,le:()=>i});var t=e(2543),n=e.n(t),r=e(84743),s=e.n(r),a=e(1933),g=(v=>(v.default="",v.localBrowserTime="browser",v.utc="utc",v))(g||{});const i=v=>{switch((0,a.O)({timeZone:v})){case"browser":return"Local browser time";case"utc":return"UTC";default:return v}},l=v=>s().tz.zone(v),d=(v,P)=>{const m=c(v,P);return m||h(v,P)},o=(0,t.memoize)((v=!1)=>{const P=[];return v===!0?P.push("","browser","utc"):v&&P.push(...v),s().tz.names().reduce((m,D)=>{const x=f[D];return!Array.isArray(x)||x.length===0||m.push(D),m},P)}),u=(0,t.memoize)((v=!1)=>{const m=o(v).reduce((D,x)=>{const E=x.indexOf("/");if(E===-1){const b="";return D[b]=D[b]??[],D[b].push(x),D}const C=x.slice(0,E);return D[C]=D[C]??[],D[C].push(x),D},{});return Object.keys(m).map(D=>({name:D,zones:m[D]}))}),c=(v,P)=>{switch(v){case"utc":return{name:"Coordinated Universal Time",ianaName:"UTC",zone:v,countries:[],abbreviation:"UTC, GMT",offsetInMins:0};case"":{const m=(0,a.O)(),x=m==="browser"||m==="utc"?c(m,P):h(m,P);return{countries:f[m]??[],abbreviation:"",offsetInMins:0,...x,ianaName:x?.ianaName??"",name:"Default",zone:v}}case"browser":{const m=s().tz.guess(!0),D=h(m,P);return{countries:f[m]??[],abbreviation:"Your local time",offsetInMins:new Date().getTimezoneOffset(),...D,name:"Browser Time",ianaName:D?.ianaName??"",zone:v}}default:return}},p=v=>/^(\+|\-).+/.test(v)?"":v,h=(v,P)=>{const m=s().tz.zone(v);if(m)return{name:v,ianaName:m.name,zone:v,countries:f[v]??[],abbreviation:p(m.abbr(P)),offsetInMins:m.utcOffset(P)}},y={AF:"Afghanistan",AX:"Aland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua And Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia And Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, Democratic Republic",CK:"Cook Islands",CR:"Costa Rica",CI:"Cote D'Ivoire",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island & Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran (Islamic Republic Of)",IQ:"Iraq",IE:"Ireland",IM:"Isle Of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KR:"Korea",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libyan Arab Jamahiriya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia (Federated States Of)",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Reunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthelemy",SH:"Saint Helena",KN:"Saint Kitts And Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre And Miquelon",VC:"Saint Vincent And Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome And Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia And Sandwich Isl.",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard And Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad And Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks And Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis And Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},f=s().tz.countries().reduce((v,P)=>s().tz.zonesForCountry(P).reduce((D,x)=>{D[x]||(D[x]=[]);const E=y[P];return E&&D[x].push({code:P,name:E}),D},v),{})},69129:(_,L,e)=>{"use strict";e.d(L,{LL:()=>d,LO:()=>s,NI:()=>l,Tp:()=>o,We:()=>a,b_:()=>n,gc:()=>g,ql:()=>r,wE:()=>i});var t=e(65463);class n extends t.x{static{this.type="data-hover"}}class r extends t.a{static{this.type="data-hover-clear"}}class s extends t.x{static{this.type="data-select"}}class a extends t.x{static{this.type="annotation-event"}}class g extends t.x{static{this.type="dashboard-loaded"}}class i extends t.a{static{this.type="datasource-updated-successfully"}}class l extends t.a{static{this.type="datasource-test-succeeded"}}class d extends t.a{static{this.type="datasource-test-failed"}}class o extends t.x{static{this.type="set-panel-attention"}}},66670:(_,L,e)=>{"use strict";e.d(L,{K:()=>n});var t=e(83077);class n extends t.O{}},57875:(_,L,e)=>{"use strict";e.d(L,{H:()=>h,J:()=>c});var t=e(2543),n=e.n(t),r=e(14236),s=e(47232),a=e(53531),g=e(11261),i=e(28802),l=e(62398),d=e(83195),o=e(58563);const u={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function c(f){if(!f||(0,t.isEmpty)(f)||!f.field)return p;const v=f.field,P=v.config??{},{palette:m}=f.theme.visualization;let D=P.unit,x=D&&(u[D]||D.startsWith("time:")),E=!1;if(v.type===g.PU.time&&!x){if(D="dateTimeAsSystem",x=!0,v.values&&v.values.length>1){let j=v.values[0],B=v.values[v.values.length-1];typeof j=="string"?(j=(0,a.b)(j).unix(),B=(0,a.b)(B).unix()):(j/=1e3,B/=1e3),E=Math.abs(B-j)<60}}else v.type===g.PU.boolean?(0,d.j9)(D)||(D="bool"):!D&&v.type===g.PU.string&&(D="string");const C=D?.startsWith("currency"),b=(0,d.j9)(D),T=v.type===g.PU.number,R=!x&&!C&&!b&&!(D==="locale")&&T&&P.decimals==null,S=(0,d.j_)(D||"none"),O=(0,o.jc)(v,f.theme);return(j,B)=>{const{mappings:N}=P,I=D==="string";x&&typeof j=="string"&&(j=(0,s.yT)(j).valueOf());let K=I?NaN:(0,i.t)(j),w,U,W,H,z,G;if(N&&N.length>0){const Q=(0,l.Zz)(N,j);Q&&(Q.text!=null&&(w=Q.text),Q.color!=null&&(H=f.theme.visualization.getColorByName(Q.color)),Q.icon!=null&&(z=Q.icon))}else if(v.type===g.PU.enum){if(j==null)return{text:"",numeric:NaN};const Q=+j;if(P&&P.type&&P.type.enum){const{text:Y,color:q}=P.type.enum;if(w=Y?Y[Q]:`${j}`,H=q?q[Q]:void 0,H==null){const te=m[Q%m.length];H=f.theme.visualization.getColorByName(te)}}}if(!Number.isNaN(K)){if(w==null&&!(0,t.isBoolean)(j)){let Q;R&&B!=null?(Q=S(K,B,null,f.timeZone,E),Q.text=+Q.text+""):Q=S(K,P.decimals,null,f.timeZone,E),w=Q.text,W=Q.suffix,U=Q.prefix}if(H==null){const Q=O(K);H=Q.color,G=Q.percent}}if(w==null&&(0,t.isArray)(j)&&(w=(0,t.join)(j,", ")),w==null&&(w=(0,t.toString)(j),w||(P.noValue?w=P.noValue:w="")),!H){const Q=O(-1/0);H=Q.color,G=Q.percent}const M={text:w,numeric:K,prefix:U,suffix:W,color:H};return z!=null&&(M.icon=z),G!=null&&(M.percent=G),M}}function p(f){return{text:(0,t.toString)(f),numeric:(0,i.t)(f)}}function h(){return f=>({text:(0,r.oE)(f)==="other"?`${JSON.stringify(f,y())}`:`${f}`,numeric:null})}const y=()=>{const f=new WeakSet;return(v,P)=>{if(typeof P=="object"&&P!==null){if(f.has(P))return;f.add(P)}return P}}},8066:(_,L,e)=>{"use strict";e.d(L,{Hs:()=>h,Qi:()=>p,lz:()=>y,uf:()=>u});var t=e(21197),n=e(55459),r=e.n(n),s=e(84140),a=e(23596),g=e(75059),i=e(24293),l=e(83077),d=e(58563),o=e(47737);const u=new l.O(()=>[{id:i.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:f},{id:i.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:v},{id:i.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(P,m)=>(D,x,E)=>{const C=E??o.QS;return m.visualization.getColorByName(C.color)}},new c({id:i.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:P=>P.visualization.palette}),new c({id:i.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:P=>P.visualization.palette.filter(m=>(0,a.eM)(P.visualization.getColorByName(m),P.colors.background.primary)>=P.colors.contrastThreshold)}),new c({id:i.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:P=>["green","yellow","red"]}),new c({id:i.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:P=>["red","yellow","green"]}),new c({id:i.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:P=>["dark-blue","super-light-yellow","dark-red"]}),new c({id:i.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:P=>["super-light-yellow","dark-red"]}),new c({id:i.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:P=>["blue","purple"]}),new c({id:i.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:P=>["super-light-yellow","dark-blue"]}),new c({id:i.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:P=>["panel-bg","dark-blue"]}),new c({id:i.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:P=>["panel-bg","dark-red"]}),new c({id:i.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:P=>["panel-bg","dark-green"]}),new c({id:i.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:P=>["panel-bg","dark-purple"]})]);class c{constructor(m){this.id=m.id,this.name=m.name,this.description=m.description,this.getNamedColors=m.getColors,this.isContinuous=m.isContinuous,this.isByValue=m.isByValue,this.useSeriesName=m.useSeriesName}getColors(m){return this.getNamedColors?this.colorCache&&this.colorCacheTheme===m?this.colorCache:(this.colorCache=this.getNamedColors(m).map(m.visualization.getColorByName),this.colorCacheTheme=m,this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,t.Ik)(this.colorCache)),this.interpolator}getCalculator(m,D){const x=this.getColors(D);return this.isByValue?this.isContinuous?(E,C,b)=>this.getInterpolator()(C):(E,C,b)=>x[C*(x.length-1)]:this.useSeriesName?(E,C,b)=>x[Math.abs(r()(m.state?.displayName??m.name))%x.length]:(E,C,b)=>{const T=m.state?.seriesIndex??0;return x[T%x.length]}}}function p(P){return u.get(P.config.color?.mode??i.Y.Thresholds)}function h(P){return u.get(P??i.Y.Thresholds)}function y(P,m){const D=p(P);if(!D.isByValue)return{color:D.getCalculator(P,m)(0,0),threshold:o.QS,percent:1};const x=(0,d.jc)(P,m),E=P.config.color?.seriesBy??"last",b=(0,g.Nw)({field:P,reducers:[E]})[E]??0;return x(b)}function f(P,m){return()=>m.visualization.getColorByName(P.config.color?.fixedColor??i.F)}function v(P,m){return()=>{const D=m.visualization.getColorByName(P.config.color?.fixedColor??i.F),x=[D],E=6,C=10,b=35,T=35;for(let R=1;R<E;R++)x.push((0,s.A)(D).spin(R/E*C).brighten(R/E*b).toHexString()),x.push((0,s.A)(D).spin(-(R/E)*C).darken(R/E*T).toHexString());const A=P.state?.seriesIndex??0;return x[A%x.length]}}},56323:(_,L,e)=>{"use strict";e.d(L,{PI:()=>v,Pm:()=>f,XS:()=>E,Zo:()=>T,a_:()=>y,eG:()=>x,k3:()=>u,k_:()=>h,nF:()=>p,py:()=>c});var t=e(2543),n=e.n(t),r=e(78368),s=e(14236),a=e(75059),g=e(85200),i=e(1173),l=e(11261),d=e(57875),o=e(28240);const u="__series.name",c="__field.displayName",p="__field.labels",h="__calc",y="__cell_",f=25,v=R=>{const{replaceVariables:S,reduceOptions:O,timeZone:j,theme:B}=R,N=O.calcs.length?O.calcs:[a.gy.last],I=[],K=(0,g.NS)(O.fields?{id:i.Ct.byRegexp,options:O.fields}:{id:i.Ct.numeric}),w=R.data??[],U=O.limit?O.limit:f;let W=!1;for(let H=0;H<w.length&&!W;H++){const z=w[H],{timeField:G}=(0,s.KR)(z),M=new r.R(z);for(let Q=0;Q<z.fields.length&&!W;Q++){const Y=z.fields[Q],q=Y.getLinks;if(!K(Y,z,w))continue;let te=Y.config;Y.state?.range&&(te={...te,...Y.state?.range});let X=Y.config.displayName??"";const ee=Y.display??(0,d.J)({field:Y,theme:R.theme,timeZone:j});if(O.values)for(let ne=0;ne<Y.values.length;ne++){Y.state=m(Y,I.length);const Z=A(Y,ne),ae=ee(Y.values[ne]),re=P(z,Y,ne,S,Z),se=D(re,R.fieldConfig,B);if(I.push({name:"",field:te,display:{...ae,title:re,color:se??ae.color},view:M,colIndex:Q,rowIndex:ne,getLinks:q?()=>q({valueRowIndex:ne}):()=>[],hasLinks:x(Y)}),I.length>=U){W=!0;break}}else{const ne=(0,a.Nw)({field:Y,reducers:N});for(const Z of N){const ae=Y.state?.scopedVars??{};ae[h]={value:Z,text:Z};const re=ee(ne[Z]);X!==""?re.title=S(X,ae):re.title=(0,o.Ct)(Y,z,w),re.percentChange=R.percentChange?(0,a.Nw)({field:Y,reducers:[a.gy.diffperc]}).diffperc:void 0;let se;R.sparkline&&(se={y:z.fields[Q],x:G},Z===a.gy.last?se.highlightIndex=se.y.values.length-1:Z===a.gy.first&&(se.highlightIndex=0));const de=z.length===1?0:void 0;I.push({name:Z,field:te,display:re,sparkline:se,view:M,colIndex:Q,getLinks:q?()=>q({calculatedValue:re,valueRowIndex:de}):()=>[],hasLinks:x(Y)})}}}}return I.length===0&&I.push(C(R)),I};function P(R,S,O,j,B){const N=S.config.displayName;if(N)return N.indexOf(y)?j(T(N),B):j(N,B);let I=[],K=0;for(const w of R.fields)if(w!==S)if(w.type===l.PU.string){const U=w.values[O]??"",W=w.display?w.display(U).text:U;W.length>0&&I.push(W)}else w.type===l.PU.number&&K++;return(K||I.length===0)&&I.push((0,o.Ct)(S,R)),I.join(" ")}function m(R,S){return{...R.state,seriesIndex:S}}function D(R,S,O){for(const j of S.overrides)if(j.matcher.id==="byName"&&j.matcher.options===R){for(const B of j.properties)if(B.id==="color"&&B.value)return O.visualization.getColorByName(B.value.fixedColor)}return null}function x(R){return R.config?.links?.length?R.config.links.length>0:!1}function E(R){let S="",O="",j="",B="";for(let N=0;N<R.length;N++){const I=R[N].display;I.text&&I.text.length>O.length&&(O=I.text),I.title&&I.title.length>S.length&&(S=I.title),I.prefix&&I.prefix.length>j.length&&(j=I.prefix),I.suffix&&I.suffix.length>B.length&&(B=I.suffix)}return{text:O,title:S,suffix:B,prefix:j}}function C(R){const S="No data",{fieldConfig:O,timeZone:j}=R,{defaults:B}=O,I=(0,d.J)({field:{type:l.PU.other,config:B},theme:R.theme,timeZone:j})(null),K=b(I,S);return{name:S,field:{...B,max:B.max??0,min:B.min??0},display:{text:K,numeric:0,color:I.color},hasLinks:!1}}function b(R,S){return!R||(0,t.isEmpty)(R.text)?S:R.text}function T(R){return R.replace(/\${__cell_(\d+)(.*?)}|\[\[__cell_(\d+)(.*?)\]\]|\$__cell_(\d+)(\S*)/g,(S,O,j,B,N,I,K)=>`\${__data.fields[${O??B??I}]${j??N??K}}`)}function A(R,S){return R.state?.scopedVars?.__dataContext?{...R.state?.scopedVars,__dataContext:{value:{...R.state?.scopedVars?.__dataContext.value,rowIndex:S}}}:R.state?.scopedVars}},90708:(_,L,e)=>{"use strict";e.d(L,{BF:()=>T,K3:()=>S,_M:()=>R,nJ:()=>P,rJ:()=>O,vd:()=>j,we:()=>m});var t=e(2543),n=e.n(t),r=e(96540),s=e(80292),a=e(52622),g=e(21423),i=e(14236),l=e(23596),d=e(75059),o=e(85200),u=e(11261),c=e(24293),p=e(6709),h=e(71733),y=e(57875),f=e(58563),v=e(69550);function P(B){let N=null,I=null;const K=[d.gy.min,d.gy.max];for(const w of B)for(const U of w.fields)if(U.type===u.PU.number){const W=(0,d.Nw)({field:U,reducers:K}),H=W[d.gy.min],z=W[d.gy.max];(N===null||H<N)&&(N=H),(I===null||z>I)&&(I=z)}return{min:N,max:I,delta:(I??0)-(N??0)}}function m(B){if(!B.data)return[];const N=B.fieldConfig;if(!N)return B.data;const I=B.fieldConfigRegistry??v.G;let K=0,w;const U=[];if(N.overrides)for(const W of N.overrides){const H=o.sJ.get(W.matcher.id);H&&U.push({match:H.get(W.matcher.options),properties:W.properties})}return B.data.map((W,H)=>{const z={...W};z.fields=z.fields.map(G=>({...G,config:(0,t.cloneDeep)(G.config),state:{...G.state}}));for(const G of z.fields){const M=G.config;G.state.scopedVars={__dataContext:{value:{data:B.data,frame:z,frameIndex:H,field:G}}};const Q={field:G,data:B.data,dataFrameIndex:H,replaceVariables:B.replaceVariables,fieldConfigRegistry:I};C(M,N.defaults,Q);for(const X of U)if(X.match(G,z,B.data))for(const ee of X.properties)E(M,ee,Q);let Y=G.type;if(!Y||Y===u.PU.other){const X=(0,i.dF)(G);X&&(Y=X)}const{range:q,newGlobalRange:te}=D(M,G,w,B.data);if(w=te,G.state.displayName=null,G.state.seriesIndex=K,G.state.range=q,G.type=Y,G.type!==u.PU.time&&K++,G.display=(0,y.J)({field:G,theme:B.theme,timeZone:B.timeZone}),G.config.unit!=="dateTimeFromNow"&&(G.display=x(G.display,2500)),G.getLinks=R(z,G,G.state.scopedVars,Q.replaceVariables,B.timeZone,B.dataLinkPostProcessor),G.type===u.PU.nestedFrames)for(const X of G.values)for(let ee=0;ee<X.length;ee++)for(const ne of X[ee].fields)ne.display=(0,y.J)({field:ne,theme:B.theme,timeZone:B.timeZone}),ne.state={scopedVars:{__dataContext:{value:{data:X,frame:X[ee],frameIndex:ee,field:ne}}}},ne.getLinks=R(X[ee],ne,ne.state.scopedVars,Q.replaceVariables,B.timeZone,B.dataLinkPostProcessor)}return z})}function D(B,N,I,K){if(N.type!==u.PU.number||(0,t.isNumber)(B.min)&&(0,t.isNumber)(B.max))return{newGlobalRange:I};if(B.fieldMinMax){const H=(0,f.AP)(N),z=B.min??H.min,G=B.max??H.max;return{range:{min:z,max:G,delta:G-z},newGlobalRange:I}}const w=I??P(K),U=B.min??w.min,W=B.max??w.max;return{range:{min:U,max:W,delta:W-U},newGlobalRange:w}}function x(B,N=2500){const I=new Map;for(let K=-1;K<=15;K++)I.set(K,new Map);return(K,w)=>{let U=I.get(w??-1),W=U.get(K);return W||(U.size===N&&U.clear(),W=B(K,w),W.color&&(W.color=(0,l.ze)(W.color)),U.set(K,W)),W}}function E(B,N,I){const w=I.fieldConfigRegistry.getIfExists(N.id);if(!w)return;const U=w.process(N.value,I,w.settings);U==null?w.isCustom&&B.custom?(0,t.unset)(B.custom,w.path):(0,t.unset)(B,w.path):w.isCustom?(B.custom||(B.custom={}),(0,t.set)(B.custom,w.path,U)):(0,t.set)(B,w.path,U)}function C(B,N,I){B.links&&N.links&&(B.links=[...B.links,...N.links]);for(const K of I.fieldConfigRegistry.list())K.isCustom&&!B.custom&&(B.custom={}),b(K.isCustom?B.custom:B,K.isCustom?N.custom:N,K,I);T(B)}function b(B,N,I,K){const w=(0,t.get)(B,I.path);if(w==null){const U=K.fieldConfigRegistry.getIfExists(I.id);if(!U)return;if(U&&U.shouldApply(K.field)){const W=U.process((0,t.get)(N,U.path),K,U.settings);W!=null&&(0,t.set)(B,U.path,W)}}}function T(B){const{thresholds:N}=B;if(B.color?B.color.mode||delete B.color:N&&(B.color={mode:c.Y.Thresholds}),B.hasOwnProperty("min")&&B.hasOwnProperty("max")&&B.min>B.max){const I=B.max;B.max=B.min,B.min=I}}const A=B=>{const{link:N,linkModel:I,dataLinkScopedVars:K,field:w,replaceVariables:U}=B;return N.internal?(0,p.u)({link:N,internalLink:N.internal,scopedVars:K,field:w,range:N.internal.range,replaceVariables:U}):I},R=(B,N,I,K,w,U)=>W=>!N.config.links||N.config.links.length===0?[]:N.config.links.map(z=>{const G=j(B,N,I),M={...I,__dataContext:G},Q=(te,X,ee)=>K(te,{...M,...X},ee);W.valueRowIndex!==void 0&&!isNaN(W.valueRowIndex)?G.value.rowIndex=W.valueRowIndex:G.value.calculatedValue=W.calculatedValue;let Y,q=z.onClick||!z.onBuildUrl?z.url:z.onBuildUrl({origin:N,replaceVariables:Q});return q&&(q=h.I.assureBaseUrl(q.replace(/\n/g,"")),q=K(q,M,a.$m.UriEncode),q=h.I.processUrl(q)),z.onClick?Y={href:q,title:K(z.title||"",M),target:z.targetBlank?"_blank":void 0,onClick:(te,X)=>{z.onClick({origin:X??N,e:te,replaceVariables:Q})},origin:N}:Y={href:q,title:K(z.title||"",M),target:z.targetBlank?"_blank":void 0,origin:N},(U||A)({frame:B,field:N,dataLinkScopedVars:M,replaceVariables:K,config:W,link:z,linkModel:Y})}).filter(z=>!!z);function S(B){if(!B||B.length===0)return[];const N=[...B],I=(0,y.H)();for(let K=0;K<N.length;K++){const w={...N[K]},U=[...w.fields];for(let W=0;W<U.length;W++)U[W]={...U[W],display:I};N[K]={...w,fields:U}}return N}function O(B,N,I,K,w,U,W){const H=B?.fieldConfigRegistry,z=(0,r.useRef)(0),G=(0,s.A)(I?.series);return(0,r.useMemo)(()=>{if(!H||!N||!I)return;const M=I?.series;I.structureRev==null&&M&&G&&!(0,g.J3)(M,G,g.bW)&&z.current++;const Q={structureRev:z.current,...I,series:m({data:M,fieldConfig:N,fieldConfigRegistry:H,replaceVariables:U,theme:w,timeZone:K,dataLinkPostProcessor:W})};return I.annotations&&I.annotations.length>0&&(Q.annotations=m({data:I.annotations,fieldConfig:{defaults:{},overrides:[]},replaceVariables:U,theme:w,timeZone:K,dataLinkPostProcessor:W})),Q},[H,N,I,G,K,w,U,W])}function j(B,N,I){return I?.__dataContext?{value:{...I.__dataContext.value}}:{value:{frame:B,field:N,data:[B]}}}},28240:(_,L,e)=>{"use strict";e.d(L,{Ct:()=>i,Fm:()=>a,Ri:()=>s,fk:()=>d,j2:()=>g});var t=e(85200),n=e(11261),r=e(8249);function s(u,c){if(u.name)return u.name;const p=[];for(const h of u.fields)if(h.type!==n.PU.time){if(p.length>1)break;p.push(i(h,u))}return p.length===1?p[0]:c===void 0&&u.fields.length>0?u.fields.filter(h=>h.type!==n.PU.time).map(h=>i(h,u)).join(", "):u.refId?`Series (${u.refId})`:`Series (${c})`}function a(u){u.forEach(c=>{c.fields.forEach(p=>{i(p,c,u)})})}function g(u,c){u.forEach(p=>{p.fields.forEach(h=>{const y={legend:!1,tooltip:!1,viz:!1,...c.defaults.custom?.hideFrom},f=h.config.custom?.hideFrom;c.overrides.forEach(v=>{if("__systemRef"in v)return;if((0,t.NS)(v.matcher)(h,p,u))for(const m of v.properties)m.id==="custom.hideFrom"&&Object.assign(y,m.value)}),h.state={...h.state,hideFrom:{...f}},h.config.custom.hideFrom=y})})}function i(u,c,p){const h=u.state?.displayName,y=!!(p&&p.length>1);if(h&&y===u.state?.multipleFrames)return h;const f=l(u,c,p);return u.state=u.state||{},u.state.displayName=f,u.state.multipleFrames=y,f}function l(u,c,p){const h=u.config?.displayName&&u.config?.displayName.length,y=!!c?.meta?.timeCompare?.isTimeShiftQuery;let f=h?u.config.displayName:u.name;if(h)return y?`${f} (comparison)`:f;if(c&&u.config?.displayNameFromDS)return y?`${u.config.displayNameFromDS} (comparison)`:u.config.displayNameFromDS;if(u.type===n.PU.time&&!u.labels)return f??n.LE;let v=[],P=!1;if(p&&p.length>1){for(let x=1;x<p.length;x++)if(p[x].name!==p[x-1].name){P=!0;break}}let m=!1,D=!1;if(P&&c?.name&&(v.push(c.name),m=!0),u.name&&u.name!==n.Bc&&v.push(u.name),u.labels&&c){let x=o(p??[c]);if(x)u.labels[x]&&(v.push(u.labels[x]),D=!0);else{let E=(0,r.h6)(u.labels);E&&(v.push(E),D=!0)}}return c&&!m&&!D&&u.name===n.Bc&&c.name&&c.name.length>0&&(v.push(c.name),m=!0),v.length?f=v.join(" "):u.name?f=u.name:f=n.Bc,f===u.name&&(f=d(u,c)),y&&(f=`${f} (comparison)`),f}function d(u,c){let p=0,h=!1;if(c)for(let y=0;y<c.fields.length;y++){const f=c.fields[y];if(u===f){if(h=!0,p>0){p++;break}}else if(u.name===f.name&&(p++,h))break}return p?`${u.name} ${p}`:u.name}function o(u){let c=null;for(let p=0;p<u.length;p++){const h=u[p];for(const y of h.fields)if(y.labels){for(const f in y.labels)if(c===null)c=f;else if(f!==c)return null}}return c}},92461:(_,L,e)=>{"use strict";e.d(L,{F:()=>a});var t=e(2543),n=e.n(t),r=e(83195),s=e(57875);function a(g){return new Proxy({},{get:(i,l)=>{let d=g.frame.fields.find(p=>l===p.name);if(!d){const p=(0,t.toNumber)(l);d=g.frame.fields[p]}if(d||(d=g.frame.fields.find(p=>l===p.config.displayName)),d||(d=g.frame.fields.find(p=>p.labels?l===p.labels.name:!1)),!d)return;const o=d.display??(0,s.J)(),u=d.values[g.rowIndex],c=o(u);return c.toString=()=>(0,r.cN)(c),c}})}},27310:(_,L,e)=>{"use strict";e.d(L,{AM:()=>r,Ch:()=>s,FM:()=>u,N7:()=>d,OU:()=>l,X4:()=>c,cz:()=>a,hL:()=>i,hS:()=>t,lG:()=>o,m0:()=>n,xT:()=>g});const t=p=>p,n=(p,h,y)=>{if(p!=null)return parseFloat(String(p))},r=(p,h,y)=>(delete h.field?.state?.displayName,l(p,h,y)),s=(p,h,y)=>p,a=(p,h,y)=>p,g=(p,h,y)=>p,i=(p,h,y)=>p,l=(p,h,y)=>p==null?p:y&&y.expandTemplateVars&&h.replaceVariables&&typeof p=="string"?h.replaceVariables(p,h.field.state.scopedVars):`${p}`,d=(p,h,y)=>p,o=(p,h,y)=>p,u=(p,h,y)=>p;var c=(p=>(p.IncludeAll="all",p.ExcludeBaseNames="exclude",p.OnlyBaseNames="only",p))(c||{})},58563:(_,L,e)=>{"use strict";e.d(L,{AP:()=>d,jc:()=>i,xg:()=>o});var t=e(2543),n=e.n(t),r=e(75059),s=e(11261),a=e(8066),g=e(47737);function i(u,c){if(u.type===s.PU.boolean)return l(u,c);const h=(0,a.Qi)(u).getCalculator(u,c),y=u.state?.range??d(u);return f=>{let v=0;f!==-1/0&&(v=(f-y.min)/y.delta,Number.isNaN(v)&&(v=0));const P=(0,g.k5)(u,f,v);return{percent:v,threshold:P,color:h(f,v,P)}}}function l(u,c){const p={color:c.visualization.getColorByName("green"),percent:1,threshold:void 0},h={color:c.visualization.getColorByName("red"),percent:0,threshold:void 0},y=(0,a.Qi)(u);if(y.isContinuous&&y.getColors){const f=y.getColors(c);p.color=f[f.length-1],h.color=f[0]}return f=>f?p:h}function d(u){if(u.type!==s.PU.number)return{min:0,max:100,delta:100};let c=u.config.min,p=u.config.max;if(!(0,t.isNumber)(c)||!(0,t.isNumber)(p))if(u.values&&u.values.length){const h=(0,r.Nw)({field:u,reducers:[r.gy.min,r.gy.max]});(0,t.isNumber)(c)||(c=h[r.gy.min]),(0,t.isNumber)(p)||(p=h[r.gy.max])}else c=0,p=100;return{min:c,max:p,delta:p-c}}function o(u,c){const{config:p}=u;let{min:h,max:y}=p;return(0,t.isNumber)(h)&&(0,t.isNumber)(y)?p:c||!u.state?.range?{...p,...d(u)}:{...p,...u.state.range}}},69550:(_,L,e)=>{"use strict";e.d(L,{D:()=>s,G:()=>r});var t=e(83077),n=e(66670);const r=new n.K,s=new t.O},47737:(_,L,e)=>{"use strict";e.d(L,{QS:()=>r,RU:()=>g,k5:()=>a,yQ:()=>s});var t=e(24293),n=e(50082);const r={value:0,color:t.F};function s(i,l){if(!l||l.length===0)return r;let d=l[0];for(const o of l)if(i>=o.value)d=o;else break;return d}function a(i,l,d){const{thresholds:o}=i.config;return o?.mode===n.O.Percentage?s(d*100,o?.steps):s(l,o?.steps)}function g(i){return i.sort((l,d)=>l.value-d.value)}},33459:(_,L,e)=>{"use strict";e.r(L),e.d(L,{AbstractLabelOperator:()=>Pt.D_,AlertState:()=>Ze.O,AnnotationChangeEvent:()=>x.We,AnnotationEventFieldSource:()=>bn.V,AppEvents:()=>rt.r1,AppPlugin:()=>rs.hX,ArrayDataFrame:()=>d.f,ArrayVector:()=>gn,BinaryOperationID:()=>ie.k,BusEventBase:()=>m.a,BusEventWithPayload:()=>m.x,ByNamesMatcherMode:()=>He.PP,CSVHeaderStyle:()=>Z.F7,CSVReader:()=>Z.i8,CircularDataFrame:()=>Nn.x,CircularVector:()=>St.$,CoreApp:()=>rs.Jk,CustomVariableSupport:()=>qe.f5,DEFAULT_FIELD_DISPLAY_VALUES_LIMIT:()=>O.Pm,DEFAULT_SAML_NAME:()=>hn.En,DashboardCursorSync:()=>Ft.y,DashboardLoadedEvent:()=>x.gc,DataFrameType:()=>on.m,DataFrameView:()=>n.R,DataHoverClearEvent:()=>x.ql,DataHoverEvent:()=>x.b_,DataLinkBuiltInVars:()=>W.c,DataLinkConfigOrigin:()=>Xt.x0,DataQueryErrorType:()=>es.v2,DataSelectEvent:()=>x.LO,DataSourceApi:()=>es.mA,DataSourcePlugin:()=>es.tD,DataSourcePluginContextProvider:()=>dt.p,DataSourceTestFailed:()=>x.LL,DataSourceTestSucceeded:()=>x.NI,DataSourceUpdatedSuccessfully:()=>x.wE,DataSourceVariableSupport:()=>qe.ZV,DataTopic:()=>p.QR,DataTransformerID:()=>Ke.F,DefaultTimeZone:()=>yn.lE,DocsId:()=>H.f,EventBusSrv:()=>D.o,ExploreMode:()=>es.ZF,FALLBACK_COLOR:()=>jt.F,FeatureState:()=>rs.Ay,FieldCache:()=>r.L,FieldColorModeId:()=>jt.Y,FieldConfigEditorBuilder:()=>I.bk,FieldConfigOptionsRegistry:()=>C.K,FieldConfigProperty:()=>kn.uo,FieldMatcherID:()=>Me.Ct,FieldNamePickerBaseNameMode:()=>N.X4,FieldType:()=>xn.PU,FrameGeometrySourceMode:()=>p.aG,FrameMatcherID:()=>Me.jR,GAUGE_DEFAULT_MAXIMUM:()=>hn.d1,GAUGE_DEFAULT_MINIMUM:()=>hn.tw,GrafanaPlugin:()=>An.Ud,GrafanaThemeType:()=>Ot.I,HttpRequestMethod:()=>sn.DO,ISO_8601:()=>fe.mt,InternalTimeZones:()=>Te.g$,LanguageProvider:()=>es.Is,LayoutModes:()=>ot.R,LegacyGraphHoverClearEvent:()=>rt.Tq,LegacyGraphHoverEvent:()=>rt.kb,LegacyMappingType:()=>Q.An,LiveChannelConnectionState:()=>qt.ZF,LiveChannelEventType:()=>qt.o4,LiveChannelScope:()=>qt.qD,LiveChannelType:()=>qt.os,LoadingState:()=>Un.Gu,LocalStorageValueProvider:()=>ge.b,LogLevel:()=>Jn.$b,LogRowContextQueryDirection:()=>Jn.ZF,LogsDedupDescription:()=>Jn._C,LogsDedupStrategy:()=>p.fY,LogsMetaKind:()=>Jn.tG,LogsSortOrder:()=>p.uH,LogsVolumeType:()=>Jn.Aj,MISSING_VALUE:()=>s.p,MappingType:()=>Kn.d,MatcherID:()=>Me.cV,MutableDataFrame:()=>s.k,NodeGraphDataFrameFieldNames:()=>ce.u,NullValueMode:()=>Un.UW,NumericLogLevel:()=>Jn.s5,OneClickMode:()=>Xt.yd,OrgRole:()=>vt.X,PageLayoutType:()=>wn.k,PanelEvents:()=>rt.ee,PanelOptionsEditorBuilder:()=>I.pv,PanelPlugin:()=>ft.m,PluginContextProvider:()=>it.a,PluginErrorCode:()=>An.ZK,PluginExtensionPoints:()=>fn.S,PluginExtensionTypes:()=>fn.u,PluginIncludeType:()=>An.ib,PluginLoadingStrategy:()=>An.xf,PluginSignatureStatus:()=>An.Ac,PluginSignatureType:()=>An.kv,PluginState:()=>An.pn,PluginType:()=>An.QE,ReducerID:()=>be.gy,Registry:()=>X.O,SetPanelAttentionEvent:()=>x.Tp,SpecialValue:()=>Gn.N,SpecialValueMatch:()=>Kn.W,StandardVariableSupport:()=>qe.J$,StreamingDataFrame:()=>l.k9,StreamingFrameAction:()=>l.Kh,SupplementaryQueryType:()=>Jn.cF,SupportedTransformationType:()=>Xt.CC,SystemDateFormatsState:()=>Ge.JE,TIME_FORMAT:()=>yn.G$,TIME_SERIES_METRIC_FIELD_NAME:()=>xn.aI,TIME_SERIES_TIME_FIELD_NAME:()=>xn.LE,TIME_SERIES_VALUE_FIELD_NAME:()=>xn.Bc,ThemeContext:()=>Ee.D,ThresholdsMode:()=>zt.O,TransformationApplicabilityLevels:()=>Gn.M,TransformerCategory:()=>Be.m,UnaryOperationID:()=>J._,VAR_CALC:()=>O.k_,VAR_CELL_PREFIX:()=>O.a_,VAR_FIELD_LABELS:()=>O.nF,VAR_FIELD_NAME:()=>O.py,VAR_SERIES_NAME:()=>O.k3,ValueMatcherID:()=>Me.Js,VariableHide:()=>Ut.zL,VariableOrigin:()=>Xt.$0,VariableRefresh:()=>Ut.CO,VariableSort:()=>Ut.ZG,VariableSuggestionsScope:()=>Xt.uP,VariableSupportBase:()=>qe.xi,VariableSupportType:()=>qe.Qz,VisualizationSuggestionScore:()=>Hn.nQ,VisualizationSuggestionsBuilder:()=>Hn.v2,VisualizationSuggestionsListAppender:()=>Hn.NV,VizOrientation:()=>Hn.wV,addDurationToDate:()=>Xe.Ri,addRow:()=>i.uY,amendTable:()=>t.c,anySeriesWithTimeField:()=>i.tP,anyToNumber:()=>G.t,applyFieldOverrides:()=>T.we,applyNullInsertThreshold:()=>pt.M,applyRawFieldOverrides:()=>T.K3,arrayToDataFrame:()=>d.I,arrayUtils:()=>Pe,availableIconsIndex:()=>Le.az,binaryOperators:()=>ie.b,booleanOverrideProcessor:()=>N.FM,booleanValueFormatter:()=>Ce.Qc,buildHistogram:()=>Je.p3,cacheFieldDisplayNames:()=>R.Fm,classicColors:()=>de,closestIdx:()=>l.Ls,colorManipulator:()=>ue.MV,compareArrayValues:()=>u.J3,compareDataFrameStructures:()=>u.bW,containsSearchFilter:()=>Y.E,contentTypeOptions:()=>sn.Ur,convertOldAngularValueMappings:()=>Q.bh,createDataFrame:()=>a.EI,createDimension:()=>g.r4,createFieldConfigRegistry:()=>et.O,createTheme:()=>ye.a,dataFrameFromJSON:()=>o.or,dataFrameToJSON:()=>o.Nw,dataLinksOverrideProcessor:()=>N.Ch,dateMath:()=>Ne,dateTime:()=>fe.KQ,dateTimeAsMoment:()=>fe.AN,dateTimeForTimeZone:()=>fe.oZ,dateTimeFormat:()=>Qe.LE,dateTimeFormatISO:()=>Qe.M7,dateTimeFormatTimeAgo:()=>Qe.fq,dateTimeFormatWithAbbrevation:()=>Qe._Q,dateTimeParse:()=>st.b,decodeFieldValueEntities:()=>o.t,decodeFieldValueEnums:()=>o.EL,defaultActionConfig:()=>sn.mx,defaultCalcs:()=>be.C6,deprecationWarning:()=>ne.l,displayNameOverrideProcessor:()=>N.AM,doStandardCalcs:()=>be.H3,durationToMilliseconds:()=>Xe.WT,ensureTimeField:()=>nt.ks,escapeRegex:()=>h.$f,escapeStringForRegex:()=>h.jD,eventFactory:()=>P.R,fieldColorModeRegistry:()=>E.uf,fieldMatchers:()=>De.sJ,fieldReducers:()=>be.AS,filterFieldConfigOverrides:()=>_e.aW,findCommonLabels:()=>ae.yO,findHighlightChunksInText:()=>y.Oq,findMatchesInText:()=>y.bs,findUniqueLabels:()=>ae.s6,fixCellTemplateExpressions:()=>O.Zo,formatLabels:()=>ae.h6,formattedValueToString:()=>Ce.cN,frameMatchers:()=>De.RE,getActiveThreshold:()=>b.yQ,getAllValuesFromDimension:()=>g.Km,getBuiltInThemes:()=>je.k,getColumnFromDimension:()=>g.P4,getColumnsFromDimension:()=>g.g6,getDataFrameRow:()=>a.Yn,getDataSourceRef:()=>ee.p$,getDataSourceUID:()=>ee.Iz,getDefaultRelativeTimeRange:()=>yn.Cn,getDefaultTimeRange:()=>yn.E2,getDimensionByName:()=>g.xB,getDisplayProcessor:()=>j.J,getDisplayValueAlignmentFactors:()=>O.XS,getFieldColorMode:()=>E.Hs,getFieldColorModeForField:()=>E.Qi,getFieldConfigWithMinMax:()=>S.xg,getFieldDataContextClone:()=>T.vd,getFieldDisplayName:()=>R.Ct,getFieldDisplayValues:()=>O.PI,getFieldDisplayValuesProxy:()=>A.F,getFieldMatcher:()=>De.NS,getFieldSeriesColor:()=>E.lz,getFieldTypeFromValue:()=>a.oE,getFlotPairs:()=>K.R,getFlotPairsConstant:()=>K.r,getFrameDisplayName:()=>R.Ri,getFrameMatchers:()=>De.Dq,getHistogramFields:()=>Je.ix,getLinksSupplier:()=>T._M,getLocale:()=>fe.JK,getLocaleData:()=>fe.XN,getMinMaxAndDelta:()=>S.AP,getNextRefId:()=>c.M,getPanelOptionsWithDefaults:()=>_e.F,getProcessedDataFrames:()=>a.Bt,getRawDisplayProcessor:()=>j.H,getRowUniqueId:()=>i.t9,getScaleCalculator:()=>S.jc,getSearchFilterScopedVar:()=>Y.c,getSeriesTimeStep:()=>le,getThemeById:()=>je.g,getTimeField:()=>a.KR,getTimeZone:()=>Ue.O,getTimeZoneGroups:()=>Te.U3,getTimeZoneInfo:()=>Te.QZ,getTimeZones:()=>Te.P3,getUniqueFieldName:()=>R.fk,getValueFormat:()=>Ce.j_,getValueFormats:()=>Ce.Ke,getValueFormatterIndex:()=>Ce.uH,getValueFromDimension:()=>g.WK,getValueMatcher:()=>De.kK,getWeekdayIndex:()=>fe.xQ,getWeekdayIndexByEnglishName:()=>fe.pp,getZone:()=>Te.HD,guessDecimals:()=>re.E,guessFieldTypeForField:()=>a.dF,guessFieldTypeFromNameAndValue:()=>a.by,guessFieldTypeFromValue:()=>a.HW,guessFieldTypes:()=>a.XQ,hasLinks:()=>O.eG,hasLogsContextSupport:()=>Jn.Ol,hasLogsContextUiSupport:()=>Jn.wj,hasMsResolution:()=>he,hasQueryExportSupport:()=>Pt.Ee,hasQueryImportSupport:()=>Pt.FL,hasQueryModificationSupport:()=>Jn._0,hasSupplementaryQuerySupport:()=>Jn.Nc,hasTimeField:()=>i.S1,hasToggleableQueryFiltersSupport:()=>Jn.FP,histogramBucketSizes:()=>Je.rW,histogramFieldInfo:()=>Je.Rt,histogramFieldsToFrame:()=>Je.cg,histogramFrameBucketMaxFieldName:()=>Je.dA,histogramFrameBucketMinFieldName:()=>Je.d$,histogramTransformer:()=>Je.OA,httpMethodOptions:()=>sn.ki,identityOverrideProcessor:()=>N.hS,incrRound:()=>Je.ZU,incrRoundDn:()=>Je.rs,incrRoundUp:()=>Je.Uh,intervalToAbbreviatedDurationString:()=>Xe.dU,isBooleanUnit:()=>Ce.j9,isCustomFieldProp:()=>_e.TQ,isDataFrame:()=>a.ci,isDataFrameWithValue:()=>a.LI,isDataSourcePluginContext:()=>xe.S,isDataSourceRef:()=>ee.fN,isDateTime:()=>fe.Ar,isDateTimeInput:()=>fe.u8,isEmptyObject:()=>se.R,isHistogramFrameBucketMaxFieldName:()=>Je.H1,isHistogramFrameBucketMinFieldName:()=>Je.NX,isIconName:()=>Le.n6,isLikelyAscendingVector:()=>Ve.g2,isLiveChannelJoinEvent:()=>qt.Cz,isLiveChannelLeaveEvent:()=>qt.jQ,isLiveChannelMessageEvent:()=>qt.Z7,isLiveChannelStatusEvent:()=>qt.ew,isObject:()=>Un.Gv,isReducerID:()=>be.Em,isStandardFieldProp:()=>_e.nx,isSystemOverride:()=>kn.Ow,isSystemOverrideWithRef:()=>kn.ZW,isTableData:()=>a.pH,isTimeSeriesField:()=>i.hF,isTimeSeriesFrame:()=>i.aH,isTimeSeriesFrames:()=>i.jq,isTruthy:()=>Un.zz,isUnsignedPluginSignature:()=>Oe.x,isValidDate:()=>Xe.vd,isValidDuration:()=>Xe.di,isValidGoDuration:()=>Xe.pp,isValidGrafanaDuration:()=>Xe.V3,isValidLiveChannelAddress:()=>qt.aj,localTimeFormat:()=>Ge.Od,locale:()=>Ce.Hg,locationUtil:()=>w.I,makeClassES5Compatible:()=>z.Y,makeTimeRange:()=>yn.HW,mapInternalLinkToExplore:()=>W.u,matchAllLabels:()=>ae._p,matchPluginId:()=>te._,monacoLanguageRegistry:()=>Tt.l,nullToValue:()=>bt.C,numberOverrideProcessor:()=>N.m0,objRemoveUndefined:()=>se.w,onUpdateDatasourceJsonDataOption:()=>ee.PG,onUpdateDatasourceJsonDataOptionChecked:()=>ee.EX,onUpdateDatasourceJsonDataOptionSelect:()=>ee.BD,onUpdateDatasourceOption:()=>ee.zX,onUpdateDatasourceResetOption:()=>ee.yV,onUpdateDatasourceSecureJsonDataOption:()=>ee.mn,onUpdateDatasourceSecureJsonDataOptionSelect:()=>ee.wY,outerJoinDataFrames:()=>Ve.Fd,parseDuration:()=>Xe.E9,parseFlags:()=>y.bQ,parseLabels:()=>ae.Xy,parseLiveChannelAddress:()=>qt.DG,patchArrayVectorProrotypeMethods:()=>Zn.V,preProcessPanelData:()=>a.N$,preferredVisualizationTypes:()=>Un.Nx,rangeUtil:()=>Fe,readCSV:()=>Z.Jh,reduceField:()=>be.Nw,renderLegendFormat:()=>q.j,renderMarkdown:()=>f.G,renderTextPanelMarkdown:()=>f.P,restoreCustomOverrideRules:()=>_e.H9,reverseDataFrame:()=>a.q7,roundDecimals:()=>re.h,scaledUnits:()=>Ce.yP,scopeFilterOperatorMap:()=>Sn.n,selectOverrideProcessor:()=>N.hL,serializeStateToUrlParam:()=>U.Pp,setLocale:()=>fe.xS,setTimeZoneResolver:()=>Ue.G,setWeekStart:()=>fe.$D,shallowCompare:()=>u.ab,simpleCountUnit:()=>Ce.UR,sortDataFrame:()=>a.ES,sortThresholds:()=>b.RU,standardEditorsRegistry:()=>B.D,standardFieldConfigEditorRegistry:()=>B.G,standardTransformers:()=>Se.c,standardTransformersRegistry:()=>Be.h,store:()=>Ie.M,stringFormater:()=>Ce.cH,stringOverrideProcessor:()=>N.OU,stringStartsAsRegEx:()=>h.AP,stringToJsRegex:()=>h.dO,stringToMs:()=>h.dc,systemDateFormats:()=>Ge.WC,textUtil:()=>v.sQ,thresholdsOverrideProcessor:()=>N.N7,timeZoneAbbrevation:()=>Qe.jw,timeZoneFormatUserFriendly:()=>Te.le,toCSV:()=>Z._O,toDataFrame:()=>a.Vc,toDataFrameDTO:()=>a.Kl,toDuration:()=>fe.Ah,toFilteredDataFrameDTO:()=>a.By,toFixed:()=>Ce.Mg,toFixedScaled:()=>Ce.gZ,toFixedUnit:()=>Ce.G8,toFloatOrUndefined:()=>h.$D,toIconName:()=>Le.Uo,toIntegerOrUndefined:()=>h.vb,toLegacyResponseData:()=>a.w3,toLiveChannelId:()=>qt.Qp,toNumberString:()=>h.kT,toOption:()=>pe.z,toPascalCase:()=>h.MX,toURLRange:()=>U.sQ,toUtc:()=>fe.yT,transformDataFrame:()=>we.m,trimTable:()=>t.F,unEscapeStringFromRegex:()=>h.xb,unaryOperators:()=>J.j,unitOverrideProcessor:()=>N.lG,updateDatasourcePluginJsonDataOption:()=>ee.lO,updateDatasourcePluginOption:()=>ee.pN,updateDatasourcePluginResetOption:()=>ee.QP,updateDatasourcePluginSecureJsonDataOption:()=>ee.wp,urlUtil:()=>U.kM,useFieldOverrides:()=>T.rJ,usePluginContext:()=>ze.Q,userHasAllPermissions:()=>Ct.Fj,userHasAnyPermission:()=>Ct.jW,userHasPermission:()=>Ct.ZU,userHasPermissionInMetadata:()=>Ct.T6,validateFieldConfig:()=>T.BF,valueMappingsOverrideProcessor:()=>N.xT,valueMatchers:()=>De.hI,vectorator:()=>kt.E,withLoadingIndicator:()=>M.k});var t=e(67414),n=e(78368),r=e(85404),s=e(37471),a=e(14236),g=e(61443),i=e(19845),l=e(9631),d=e(33948),o=e(89667),u=e(21423),c=e(77789),p=e(52622),h=e(54479),y=e(21),f=e(36663),v=e(80997),P=e(89550),m=e(65463),D=e(18226),x=e(69129),E=e(8066),C=e(66670),b=e(47737),T=e(90708),A=e(92461),R=e(28240),S=e(58563),O=e(56323),j=e(57875),B=e(69550),N=e(27310),I=e(60264),K=e(39306),w=e(71733),U=e(76885),W=e(6709),H=e(87885),z=e(92341),G=e(28802),M=e(72495),Q=e(62398),Y=e(92053),q=e(43659),te=e(80147),X=e(83077),ee=e(22391),ne=e(95344),Z=e(72436),ae=e(8249),re=e(97706),se=e(92041);const de=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"],le=Rt=>{let Mt,Kt,nn=Number.MAX_VALUE;for(let Qt=0;Qt<Rt.values.length;Qt++){const ln=Rt.values[Qt];if(Mt!==void 0){const pn=ln-Mt;Kt===void 0&&(nn=pn),pn<nn&&(nn=pn)}Mt=ln}return nn},he=Rt=>{for(let Mt=0;Mt<Rt.values.length;Mt++){const Kt=Rt.values[Mt];if(Kt!=null){const nn=Kt.toString();if(nn.length===13&&nn%1e3!==0)return!0}}return!1};var ie=e(11710),J=e(27618),ce=e(25352),pe=e(50877),Pe=e(14588),Ie=e(68941),ge=e(7144),Se=e(97522),De=e(85200),Ke=e(18282),Me=e(1173),be=e(75059),we=e(2514),Be=e(97497),He=e(58972),Ve=e(73060),Je=e(77678),nt=e(50311),pt=e(46294),bt=e(39624),Tt=e(96915),ye=e(75972),je=e(97594),ue=e(23596),Ee=e(60578),Ce=e(83195),Ne=e(85858),Fe=e(65879),Ue=e(1933),fe=e(47232),Te=e(91410),Ge=e(42994),Qe=e(72724),st=e(53531),Xe=e(70416),ot=e(19484),ft=e(65158),_e=e(581),et=e(28528),it=e(13834),dt=e(76287),ze=e(92470),xe=e(95187),Oe=e(51527),Le=e(8887),Ze=e(43585),qe=e(29505),rt=e(26272),vt=e(62625),Ot=e(25137),jt=e(24293),Ut=e(12470),zt=e(50082),qt=e(55004),fn=e(74135),Sn=e(37891),An=e(43429),Hn=e(47070),es=e(40187),rs=e(41987),Zn=e(35853),kn=e(37055),Gn=e(81010),Kn=e(25019),yn=e(43127),wn=e(64388),Jn=e(9557),bn=e(8790),Pt=e(73372),Ft=e(94624),Xt=e(91890),sn=e(83580),on=e(41260),xn=e(11261),Un=e(39070),hn=e(58649),St=e(36120),kt=e(18008);const en="ArrayVector is deprecated and will be removed in Grafana 11. Please use plain arrays for field.values.";let tn=!1;class gn extends Array{get buffer(){return this}set buffer(Mt){this.length=0;const Kt=Mt?.length;if(Kt){let nn=65e3,Qt=Math.ceil(Kt/nn);for(let ln=0;ln<Qt;ln++)this.push.apply(this,Mt.slice(ln*nn,(ln+1)*nn))}}constructor(Mt){super(),this.buffer=Mt??[],tn||(console.warn(en),tn=!0)}toJSON(){return[...this]}}var Nn=e(33526),Ct=e(29263)},65158:(_,L,e)=>{"use strict";e.d(L,{m:()=>l});var t=e(2543),n=e.n(t),r=e(66670),s=e(43429),a=e(60264),g=e(95344),i=e(28528);class l extends s.Ud{constructor(o){super(),this._fieldConfigDefaults={defaults:{},overrides:[]},this._initConfigRegistry=()=>new r.K,this.dataSupport={annotations:!1,alertStates:!1},this.panel=o}get defaults(){let o=this._defaults||{};if(!this._defaults&&this.optionsSupplier){const u=new a.pv;this.optionsSupplier(u,{data:[]});for(const c of u.getItems())c.defaultValue!=null&&(0,t.set)(o,c.path,c.defaultValue)}return o}get fieldConfigDefaults(){const o=this._fieldConfigDefaults.defaults;o.custom={};for(const u of this.fieldConfigRegistry.list())u.defaultValue!==void 0&&(0,t.set)(o,u.id,u.defaultValue);return{defaults:{...o},overrides:this._fieldConfigDefaults.overrides}}setDefaults(o){return(0,g.l)("PanelPlugin","setDefaults","setPanelOptions"),this._defaults=o,this}get fieldConfigRegistry(){return this._fieldConfigRegistry||(this._fieldConfigRegistry=this._initConfigRegistry()),this._fieldConfigRegistry}setEditor(o){return(0,g.l)("PanelPlugin","setEditor","setPanelOptions"),this.editor=o,this}setNoPadding(){return this.noPadding=!0,this}setMigrationHandler(o){return this.onPanelMigration=o,this}setPanelChangeHandler(o){return this.onPanelTypeChanged=o,this}setPanelOptions(o){return this.optionsSupplier=o,this}getPanelOptionsSupplier(){return this.optionsSupplier??(()=>{})}setDataSupport(o){return this.dataSupport={...this.dataSupport,...o},this}useFieldConfig(o={}){return this._initConfigRegistry=()=>(0,i.O)(o,this.meta.name),this}setSuggestionsSupplier(o){return this.suggestionsSupplier=o,this}getSuggestionsSupplier(){return this.suggestionsSupplier}hasPluginId(o){return this.meta.id===o}}},581:(_,L,e)=>{"use strict";e.d(L,{F:()=>i,H9:()=>p,TQ:()=>h,aW:()=>d,nx:()=>y});var t=e(2543),n=e.n(t),r=e(8066),s=e(24293),a=e(37055),g=e(50082);function i({plugin:f,currentOptions:v,currentFieldConfig:P,isAfterPluginChange:m}){const D=(0,t.mergeWith)({},f.defaults,v||{},(C,b)=>{if((0,t.isArray)(b))return b}),x=l(P,f),E=u(f,x,m);return{options:D,fieldConfig:E}}function l(f,v){const P=v.fieldConfigDefaults,m={defaults:(0,t.mergeWith)({},P.defaults,f?f.defaults:{},(D,x)=>{if((0,t.isArray)(x))return x}),overrides:f?.overrides??[]};o(m.defaults,"",v.fieldConfigRegistry),m.defaults.thresholds&&c(m.defaults.thresholds),m.overrides=d(m.overrides,D=>v.fieldConfigRegistry.getIfExists(D.id)!==void 0);for(const D of m.overrides)for(const x of D.properties)x.id==="thresholds"&&c(x.value);return m}function d(f,v){return f.map(P=>{const m=P.properties.filter(v);return{...P,properties:m}})}function o(f,v,P){let m=!1;for(const[D,x]of Object.entries(f)){const E=`${v}${D}`,C=!!P.getIfExists(E);if(C){m=!0;continue}(0,t.isArray)(x)||!(0,t.isObject)(x)?C||(0,t.unset)(f,D):o(x,`${E}.`,P)||(0,t.unset)(f,D)}return m}function u(f,v,P){if(!P)return v;const m=f.fieldConfigRegistry.getIfExists(a.uo.Color);if(m&&m.settings){const D=m.settings,x=r.uf.getIfExists(v.defaults.color?.mode);if(!D.byValueSupport&&(!x||x.isByValue))return v.defaults.color={mode:s.Y.PaletteClassic},v;if(D.byValueSupport&&D.preferThresholdsMode&&x?.id!==s.Y.Fixed&&(!x||!x.isByValue))return v.defaults.color={mode:s.Y.Thresholds},v;if(D.bySeriesSupport&&x?.isByValue)return v.defaults.color={mode:s.Y.PaletteClassic},v}return v}function c(f){f.mode||(f.mode=g.O.Absolute),f.steps?f.steps.length&&(f.steps[0].value=-1/0):f.steps=[]}function p(f,v){const P={defaults:{...f.defaults,custom:v.defaults.custom},overrides:[...f.overrides]};for(const m of v.overrides)for(const D of m.properties)if(h(D)){const x=P.overrides.find(E=>(0,t.isEqual)(E.matcher,m.matcher));x?x!==m&&x.properties.push(D):P.overrides.push(m)}return P}function h(f){return f.id.startsWith("custom.")}function y(f){return!h(f)}},28528:(_,L,e)=>{"use strict";e.d(L,{O:()=>s});var t=e(66670),n=e(69550),r=e(60264);function s(g={},i){const l=new t.K,d=n.G.list(),o={};if(g.useCustomConfig){const u=new r.bk;g.useCustomConfig(u);for(const c of u.getRegistry().list())if(c.isCustom=!0,c.id="custom."+c.id,a(c,d)){const p=o[c.category[0]]??[];p.push(c),o[c.category[0]]=p}else l.register(c)}for(let u of d){const c=u.id;if(!(g.disableStandardOptions&&g.disableStandardOptions.indexOf(c)>-1)){if(g.standardOptions){const p=g.standardOptions[c]?.hideFromDefaults,h=g.standardOptions[c]?.defaultValue,y=g.standardOptions[c]?.settings;p&&(u={...u,hideFromDefaults:p}),h&&(u={...u,defaultValue:h}),y&&(u={...u,settings:u.settings?{...u.settings,...y}:y})}if(l.register(u),u.category&&o[u.category[0]])for(let p of o[u.category[0]])l.register(p)}}for(const u of l.list())if(u.path.indexOf("[")>0)throw new Error(`[${i}] Field config paths do not support arrays: ${u.id}`);return l}function a(g,i){return!!i.find(l=>g.category&&l.category&&g.category[0]===l.category[0])}},77789:(_,L,e)=>{"use strict";e.d(L,{M:()=>t});const t=r=>{for(let s=0;;s++){const a=n(s);if(!r.some(g=>g.refId===a))return a}};function n(r){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return r<s.length?s[r]:n(Math.floor(r/s.length)-1)+s[r%s.length]}},67414:(_,L,e)=>{"use strict";e.d(L,{F:()=>r,c:()=>n});var t=e(9631);function n(s,a){let[g]=s,[i]=a,l=g.length,d=g[0],o=g[l-1],u=i.length,c=i[0],p=i[u-1],h;if(l)if(u){if(c>o)h=s.map((y,f)=>s[f].concat(a[f]));else if(p<d)h=a.map((y,f)=>a[f].concat(s[f]));else if(c<=d&&p>=o)h=a;else if(c>d&&p<o){let y=(0,t.Ls)(c,g);y=g[y]<c?y+1:y;let f=(0,t.Ls)(p,g);f=g[f]>p?f-1:f,h=s.map((v,P)=>s[P].slice(0,y).concat(a[P]).concat(s[P].slice(f+1)))}else if(c>=d){let y=(0,t.Ls)(c,g);y=g[y]<c?y-1:y,h=s.map((f,v)=>s[v].slice(0,y).concat(a[v]))}else if(p>=d){let y=(0,t.Ls)(p,g);y=g[y]<p?y:y+1,h=a.map((f,v)=>a[v].concat(s[v].slice(y)))}}else h=s;else u?h=a:h=[[]];return h}function r(s,a,g){let[i,...l]=s,d,o;return i[0]<a&&(d=(0,t.Ls)(a,i),i[d]<a&&d++),i[i.length-1]>g&&(o=(0,t.Ls)(g,i),i[o]>g&&o--),(d!=null||o!=null)&&(i=i.slice(d??0,o),l=l.map(u=>u.slice(d??0,o))),[i,...l]}},36663:(_,L,e)=>{"use strict";e.d(L,{G:()=>g,P:()=>i});var t=e(60023),n=e(33836),r=e(80997);let s=!1;const a={pedantic:!1,gfm:!0,breaks:!1};function g(l,d){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...a}),s=!0);let o;d?.breaks&&(o={...a,breaks:!0});const u=(0,t.xI)(l||"",o);if(typeof u!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?u:(0,r.G$)(u)}function i(l,d){s||(t.xI.use((0,n.z)()),t.xI.setOptions({...a}),s=!0);const o=(0,t.xI)(l||"");if(typeof o!="string")throw new Error("Failed to process markdown synchronously.");return d?.noSanitize?o:(0,r.G$)(o)}},21:(_,L,e)=>{"use strict";e.d(L,{Oq:()=>t,bQ:()=>g,bs:()=>r});function t({searchWords:i,textToHighlight:l}){const d=[];for(const o of i)typeof o=="string"&&d.push(...r(l,o));return d}const n=i=>i.replace(/[[{(][\w,.\/:;<=>?:*+]+$/,"");function r(i,l){if(!i||!l)return[];const d=[],{cleaned:o,flags:u}=g(n(l));let c;try{c=new RegExp(`(?:${o})`,u)}catch{return d}return i.replace(c,(p,...h)=>{if(p){const y=h[h.length-2];d.push({text:p,start:y,length:p.length,end:y+p.length})}return""}),d}const s="-",a=/\(\?([ims-]+)\)/g;function g(i){const l=new Set(["g"]);return{cleaned:i.replace(a,(o,u)=>{const c=u.startsWith(s);for(let p=0;p<u.length;++p){const h=u.charAt(p);c||u.charAt(p-1)===s?l.delete(h):h!==s&&l.add(h)}return""}),flags:Array.from(l).join("")}}},75059:(_,L,e)=>{"use strict";e.d(L,{AS:()=>d,C6:()=>u,Em:()=>i,H3:()=>c,Nw:()=>l,gy:()=>g});var t=e(2543),n=e.n(t),r=e(39070),s=e(11261),a=e(83077),g=(x=>(x.sum="sum",x.max="max",x.min="min",x.logmin="logmin",x.mean="mean",x.variance="variance",x.stdDev="stdDev",x.last="last",x.median="median",x.first="first",x.count="count",x.range="range",x.diff="diff",x.diffperc="diffperc",x.delta="delta",x.step="step",x.firstNotNull="firstNotNull",x.lastNotNull="lastNotNull",x.changeCount="changeCount",x.distinctCount="distinctCount",x.allIsZero="allIsZero",x.allIsNull="allIsNull",x.allValues="allValues",x.uniqueValues="uniqueValues",x.p1="p1",x.p2="p2",x.p3="p3",x.p4="p4",x.p5="p5",x.p6="p6",x.p7="p7",x.p8="p8",x.p9="p9",x.p10="p10",x.p11="p11",x.p12="p12",x.p13="p13",x.p14="p14",x.p15="p15",x.p16="p16",x.p17="p17",x.p18="p18",x.p19="p19",x.p20="p20",x.p21="p21",x.p22="p22",x.p23="p23",x.p24="p24",x.p25="p25",x.p26="p26",x.p27="p27",x.p28="p28",x.p29="p29",x.p30="p30",x.p31="p31",x.p32="p32",x.p33="p33",x.p34="p34",x.p35="p35",x.p36="p36",x.p37="p37",x.p38="p38",x.p39="p39",x.p40="p40",x.p41="p41",x.p42="p42",x.p43="p43",x.p44="p44",x.p45="p45",x.p46="p46",x.p47="p47",x.p48="p48",x.p49="p49",x.p50="p50",x.p51="p51",x.p52="p52",x.p53="p53",x.p54="p54",x.p55="p55",x.p56="p56",x.p57="p57",x.p58="p58",x.p59="p59",x.p60="p60",x.p61="p61",x.p62="p62",x.p63="p63",x.p64="p64",x.p65="p65",x.p66="p66",x.p67="p67",x.p68="p68",x.p69="p69",x.p70="p70",x.p71="p71",x.p72="p72",x.p73="p73",x.p74="p74",x.p75="p75",x.p76="p76",x.p77="p77",x.p78="p78",x.p79="p79",x.p80="p80",x.p81="p81",x.p82="p82",x.p83="p83",x.p84="p84",x.p85="p85",x.p86="p86",x.p87="p87",x.p88="p88",x.p89="p89",x.p90="p90",x.p91="p91",x.p92="p92",x.p93="p93",x.p94="p94",x.p95="p95",x.p96="p96",x.p97="p97",x.p98="p98",x.p99="p99",x))(g||{});function i(x){return Object.keys(g).includes(x)}function l(x){const{field:E,reducers:C}=x;if(!E||!C||C.length<1)return{};if(E.state?.calcs){const j=[];for(const B of C)E.state.calcs.hasOwnProperty(B)||j.push(B);if(j.length<1)return{...E.state.calcs}}E.state||(E.state={});const b=d.list(C),T=E.values;if(T&&T.length<1){const j={...E.state.calcs};for(const B of b)j[B.id]=B.emptyInputResult!==null?B.emptyInputResult:null;return E.state.calcs=j}const{nullValueMode:A=r.UW.Ignore}=E.config,R=A===r.UW.Ignore,S=A===r.UW.AsZero;if(b.length===1&&b[0].reduce){const j=b[0].reduce(E,R,S);return E.state.calcs={...E.state.calcs,...j},j}let O=c(E,R,S);for(const j of b)!O.hasOwnProperty(j.id)&&j.reduce&&(O={...O,...j.reduce(E,R,S)});return E.state.calcs={...E.state.calcs,...O},O}const d=new a.O(()=>[{id:"lastNotNull",name:"Last *",description:"Last non-null value (also excludes NaNs)",standard:!0,aliasIds:["current"],reduce:f,preservesUnits:!0},{id:"last",name:"Last",description:"Last value",standard:!0,reduce:y,preservesUnits:!0},{id:"firstNotNull",name:"First *",description:"First non-null value (also excludes NaNs)",standard:!0,reduce:h,preservesUnits:!0},{id:"first",name:"First",description:"First Value",standard:!0,reduce:p,preservesUnits:!0},{id:"min",name:"Min",description:"Minimum Value",standard:!0,preservesUnits:!0},{id:"max",name:"Max",description:"Maximum Value",standard:!0,preservesUnits:!0},{id:"mean",name:"Mean",description:"Average Value",standard:!0,aliasIds:["avg"],preservesUnits:!0},{id:"median",name:"Median",description:"Median Value",standard:!0,aliasIds:["median"],preservesUnits:!0},{id:"variance",name:"Variance",description:"Variance of all values in a field",standard:!1,reduce:v,preservesUnits:!0},{id:"stdDev",name:"StdDev",description:"Standard deviation of all values in a field",standard:!1,reduce:v,preservesUnits:!0},{id:"sum",name:"Total",description:"The sum of all values",emptyInputResult:0,standard:!0,aliasIds:["total"],preservesUnits:!0},{id:"count",name:"Count",description:"Number of values in response",emptyInputResult:0,standard:!0,preservesUnits:!1},{id:"range",name:"Range",description:"Difference between minimum and maximum values",standard:!0,preservesUnits:!0},{id:"delta",name:"Delta",description:"Cumulative change in value",standard:!0,preservesUnits:!0},{id:"step",name:"Step",description:"Minimum interval between values",standard:!0,preservesUnits:!0},{id:"diff",name:"Difference",description:"Difference between first and last values",standard:!0,preservesUnits:!0},{id:"logmin",name:"Min (above zero)",description:"Used for log min scale",standard:!0,preservesUnits:!0},{id:"allIsZero",name:"All Zeros",description:"All values are zero",emptyInputResult:!1,standard:!0,preservesUnits:!0},{id:"allIsNull",name:"All Nulls",description:"All values are null",emptyInputResult:!0,standard:!0,preservesUnits:!1},{id:"changeCount",name:"Change Count",description:"Number of times the value changes",standard:!1,reduce:P,preservesUnits:!1},{id:"distinctCount",name:"Distinct Count",description:"Number of distinct values",standard:!1,reduce:m,preservesUnits:!1},{id:"diffperc",name:"Difference percent",description:"Percentage difference between first and last values",standard:!0,preservesUnits:!1},{id:"allValues",name:"All values",description:"Returns an array with all values",standard:!1,reduce:x=>({allValues:[...x.values]}),preservesUnits:!1},{id:"uniqueValues",name:"All unique values",description:"Returns an array with all unique values",standard:!1,reduce:x=>({uniqueValues:[...new Set(x.values)]}),preservesUnits:!1},...o()]),o=(x=[...Array.from({length:99},(E,C)=>C+1)])=>{const E=[],C=b=>b>3&&b<21?"th":b%10===1?"st":b%10===2?"nd":b%10===3?"rd":"th";return x.forEach(b=>{const T=b/100,A=`p${b}`,R=`${b}${C(b)} %`,S=`${b}${C(b)} percentile value`;E.push({id:A,name:R,description:S,standard:!1,reduce:(O,j,B)=>({[A]:D(O,T,j,B)}),preservesUnits:!0})}),E},u={sum:0,max:-Number.MAX_VALUE,min:Number.MAX_VALUE,logmin:Number.MAX_VALUE,mean:null,last:null,first:null,lastNotNull:null,firstNotNull:null,count:0,nonNullCount:0,allIsNull:!0,allIsZero:!0,range:null,diff:null,delta:0,step:Number.MAX_VALUE,diffperc:0,previousDeltaUp:!0};function c(x,E,C){const b={...u},T=x.values;if(!T)return b;const A=x.type===s.PU.number||x.type===s.PU.time;for(let R=0;R<T.length;R++){let S=T[R];if(R===0&&(b.first=S),b.last=S,S==null){if(E)continue;C&&(S=0)}if(b.count++,S!=null&&!Number.isNaN(S)){const O=b.firstNotNull===null;if(O&&(b.firstNotNull=S),A){if(b.sum+=S,b.allIsNull=!1,b.nonNullCount++,!O){const j=S-b.lastNotNull;b.step>j&&(b.step=j),b.lastNotNull>S?(b.previousDeltaUp=!1,R===T.length-1&&(b.delta+=S)):(b.previousDeltaUp?b.delta+=j:b.delta+=S,b.previousDeltaUp=!0)}S>b.max&&(b.max=S),S<b.min&&(b.min=S),S<b.logmin&&S>0&&(b.logmin=S)}S!==0&&(b.allIsZero=!1),b.lastNotNull=S}}return b.max===-Number.MAX_VALUE&&(b.max=null),b.min===Number.MAX_VALUE&&(b.min=null),b.step===Number.MAX_VALUE&&(b.step=null),b.nonNullCount>0&&(b.mean=b.sum/b.nonNullCount),b.allIsNull&&(b.allIsZero=!1),b.max!==null&&b.min!==null&&(b.range=b.max-b.min),(0,t.isNumber)(b.firstNotNull)&&(0,t.isNumber)(b.lastNotNull)&&(b.diff=b.lastNotNull-b.firstNotNull),(0,t.isNumber)(b.firstNotNull)&&(0,t.isNumber)(b.diff)&&(b.diffperc=b.diff/b.firstNotNull*100),b}function p(x,E,C){return{first:x.values[0]}}function h(x,E,C){const b=x.values;for(let T=0;T<b.length;T++){const A=b[T];if(A!=null&&!Number.isNaN(A))return{firstNotNull:A}}return{firstNotNull:null}}function y(x,E,C){const b=x.values;return{last:b[b.length-1]}}function f(x,E,C){const b=x.values;let T=b.length-1;for(;T>=0;){const A=b[T--];if(A!=null&&!Number.isNaN(A))return{lastNotNull:A}}return{lastNotNull:null}}function v(x,E,C){if(!(x.type===s.PU.number||x.type===s.PU.time))return{variance:0,stdDev:0};let b=0,T=0,A=0;const R=x.values;for(let S=0;S<R.length;S++){const O=R[S];if(O!=null){A++;let j=T;T+=(O-j)/A,b+=(O-j)*(O-T)}}if(A>0){const S=b/A;return{variance:S,stdDev:Math.sqrt(S)}}return{variance:0,stdDev:0}}function P(x,E,C){const b=x.values;let T=0,A=!0,R=null;for(let S=0;S<b.length;S++){let O=b[S];if(O===null){if(E)continue;C&&(O=0)}!A&&R!==O&&T++,A=!1,R=O}return{changeCount:T}}function m(x,E,C){const b=x.values,T=new Set;for(let A=0;A<b.length;A++){let R=b[A];if(R===null){if(E)continue;C&&(R=0)}T.add(R)}return{distinctCount:T.size}}function D(x,E,C,b){let T=x.values;C&&(T=T.filter(S=>S!==null)),b&&(T=T.map(S=>S===null?0:S));const A=T.slice().sort((S,O)=>S-O),R=Math.round((A.length-1)*E);return A[R]}},85200:(_,L,e)=>{"use strict";e.d(L,{Dq:()=>P,NS:()=>v,RE:()=>y,hI:()=>f,kK:()=>m,sJ:()=>h});var t=e(83077),n=e(7029),r=e(24814),s=e(58972),a=e(72693),g=e(8549),i=e(83855),l=e(60005),d=e(21262),o=e(70218),u=e(55008),c=e(16378),p=e(75754);const h=new t.O(()=>[...(0,a.nz)(),...(0,n._)(),...(0,s.P7)(),...(0,i.W)(),r.u]),y=new t.O(()=>[...(0,a.UM)(),...(0,s.Y7)(),...(0,g.i)()]),f=new t.O(()=>[...(0,d._)(),...(0,o.E)(),...(0,l.d)(),...(0,p.m)(),...(0,u.G)(),...(0,c.z)()]);function v(D){const x=h.get(D.id);if(!x)throw new Error("Unknown field matcher: "+D.id);return x.get(D.options)}function P(D){const x=y.get(D.id);if(!x)throw new Error("Unknown frame matcher: "+D.id);return x.get(D.options)}function m(D){const x=f.get(D.id);if(!x)throw new Error("Unknown value matcher: "+D.id);return x.get(D.options)}},58972:(_,L,e)=>{"use strict";e.d(L,{P7:()=>h,PP:()=>a,Y7:()=>y});var t=e(28240),n=e(54479),r=e(11261),s=e(1173),a=(f=>(f.exclude="exclude",f.include="include",f))(a||{});const g={id:s.Ct.byName,name:"Field Name",description:"match the field name",defaultOptions:"",get:f=>{const P=l(new Set([f]));return(m,D,x)=>f===m.name||f===(0,t.Ct)(m,D,x)||!!(P&&P(m,D,x))},getOptionsDisplayText:f=>`Field name: ${f}`},i={id:s.Ct.byNames,name:"Field Names",description:"match any of the given the field names",defaultOptions:{mode:"include",names:[]},get:f=>{const{names:v,mode:P="include"}=f,m=new Set(v??[]),D=l(m),x=(E,C,b)=>m.has(E.name)||m.has((0,t.Ct)(E,C,b))||!!(D&&D(E,C,b));return P==="exclude"?(E,C,b)=>!x(E,C,b):x},getOptionsDisplayText:f=>{const{names:v,mode:P}=f,m=(v??[]).join(", ");return P==="exclude"?`All except: ${m}`:`All of: ${m}`}};function l(f){let v;return window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback&&(f.has(r.Bc)?v=(m,D)=>!!m.labels&&m.labels?.__name__===m.name:(f.has("Time")||f.has("time"))&&(v=(m,D)=>D.meta?.typeVersion==null&&m.type===r.PU.time)),v}const d={id:s.Ct.byRegexp,name:"Field Name by Regexp",description:"match the field name by a given regexp pattern",defaultOptions:"/.*/",get:f=>{const v=c(f);return(P,m,D)=>{const x=(0,t.Ct)(P,m,D);return!!v&&v.test(x)}},getOptionsDisplayText:f=>`Field name by pattern: ${f}`},o={id:s.Ct.byFrameRefID,name:"Fields by frame refId",description:"match all fields returned in data frame with refId.",defaultOptions:"",get:f=>(v,P,m)=>P.refId===f,getOptionsDisplayText:f=>`Math all fields returned by query with reference ID: ${f}`},u={id:s.Ct.byRegexpOrNames,name:"Field Name by Regexp or Names",description:"match the field name by a given regexp pattern or given names",defaultOptions:{pattern:"/.*/",names:[]},get:f=>{const v=d.get(f?.pattern||""),P=i.get({mode:"include",names:f?.names??[]});return(m,D,x)=>P(m,D,x)||v(m,D,x)},getOptionsDisplayText:f=>{const v=f?.pattern??"",P=f?.names?.join(",")??"";return`Field name by pattern: ${v} or names: ${P}`}},c=f=>{if(f)try{return(0,n.dO)(f)}catch(v){console.error(v);return}},p={id:s.jR.byName,name:"Frame Name",description:"match the frame name",defaultOptions:"/.*/",get:f=>{const v=(0,n.dO)(f);return P=>v.test(P.name||"")},getOptionsDisplayText:f=>`Frame name: ${f}`};function h(){return[g,d,i,u,o]}function y(){return[p]}},72693:(_,L,e)=>{"use strict";e.d(L,{UM:()=>D,Yg:()=>o,nz:()=>m,zx:()=>p});var t=e(11261),n=e(85200),r=e(1173);const s={id:r.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.NS)(C));return(C,b,T)=>{for(const A of E)if(A(C,b,T))return!0;return!1}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" OR ");const b=n.sJ.get(C.id);E+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return E}},a={id:r.cV.anyMatch,name:"Any",description:"Any child matches (OR)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.Dq)(C));return C=>{for(const b of E)if(b(C))return!0;return!1}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" OR ");const b=n.RE.get(C.id);E+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return E}},g={id:r.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.NS)(C));return(C,b,T)=>{for(const A of E)if(!A(C,b,T))return!1;return!0}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" AND ");const b=n.sJ.get(C.id);E+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return E}},i={id:r.cV.allMatch,name:"All",description:"Everything matches (AND)",excludeFromPicker:!0,defaultOptions:[],get:x=>{const E=x.map(C=>(0,n.Dq)(C));return C=>{for(const b of E)if(!b(C))return!1;return!0}},getOptionsDisplayText:x=>{let E="";for(const C of x){E.length>0&&(E+=" AND ");const b=n.RE.get(C.id);E+=b.getOptionsDisplayText?b.getOptionsDisplayText(C):b.name}return E}},l={id:r.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const E=(0,n.NS)(x);return(C,b,T)=>!E(C,b,T)},getOptionsDisplayText:x=>{const E=n.sJ.get(x.id);return"NOT "+(E.getOptionsDisplayText?E.getOptionsDisplayText(x.options):E.name)}},d={id:r.cV.invertMatch,name:"NOT",description:"Inverts other matchers",excludeFromPicker:!0,get:x=>{const E=(0,n.Dq)(x);return C=>!E(C)},getOptionsDisplayText:x=>{const E=n.RE.get(x.id);return"NOT "+(E.getOptionsDisplayText?E.getOptionsDisplayText(x.options):E.name)}},o=x=>!0,u=x=>!0,c=x=>!1,p=x=>x.type!==t.PU.time,h=x=>!1,y={id:r.cV.alwaysMatch,name:"All Fields",description:"Always Match",get:x=>o,getOptionsDisplayText:x=>"Always"},f={id:r.cV.alwaysMatch,name:"All Frames",description:"Always Match",get:x=>u,getOptionsDisplayText:x=>"Always"},v={id:r.cV.neverMatch,name:"No Fields",description:"Never Match",excludeFromPicker:!0,get:x=>c,getOptionsDisplayText:x=>"Never"},P={id:r.cV.neverMatch,name:"No Frames",description:"Never Match",get:x=>h,getOptionsDisplayText:x=>"Never"};function m(){return[s,g,l,y,v]}function D(){return[a,i,d,f,P]}},97497:(_,L,e)=>{"use strict";e.d(L,{h:()=>r,m:()=>n});var t=e(83077),n=(s=>(s.Combine="combine",s.CalculateNewFields="calculateNewFields",s.CreateNewVisualization="createNewVisualization",s.Filter="filter",s.PerformSpatialOperations="performSpatialOperations",s.Reformat="reformat",s.ReorderAndRename="reorderAndRename",s))(n||{});const r=new t.O},2514:(_,L,e)=>{"use strict";e.d(L,{m:()=>d});var t=e(62467),n=e(69862),r=e(81160),s=e(85200),a=e(97497);const g=(u,c)=>p=>{const h=a.h.get(u.id);if(!h)return p;const f={...h.transformation.defaultOptions??{},...u.options},v=u.filter?.options?(0,s.Dq)(u.filter):void 0;return p.pipe((0,n.Z)(P=>(0,t.of)(i(P,v)).pipe(h.transformation.operator(f,c),l(P,h,v))))};function i(u,c){return c?u.filter(p=>c(p)):u}const l=(u,c,p)=>h=>h.pipe((0,r.T)(y=>{if(y===u)return y;if(p){let f=0;const v=u.filter((P,m)=>{const D=!p(P);return D&&!f&&(f=m),D});v.length&&y.splice(f,0,...v)}return y}));function d(u,c,p){const h=(0,t.of)(c);if(!u.length)return h;const y=[],f=p??{interpolate:v=>v};for(let v=0;v<u.length;v++){const P=u[v];if(o(P))y.push(P(f));else{if(P.disabled)continue;y.push(g(P,f))}}return h.pipe.apply(h,y)}function o(u){return typeof u=="function"}},97522:(_,L,e)=>{"use strict";e.d(L,{c:()=>Pe});var t=e(66350),n=e(82150),r=e(50311),s=e(34125),a=e(64224),g=e(35602),i=e(1173),l=e(18282);const d={id:l.F.filterByRefId,name:"Filter data by query refId",description:"select a subset of results",defaultOptions:{},operator:(Ie,ge)=>Se=>{const De={};return Ie.include&&(De.include={id:i.jR.byRefId,options:Ie.include}),Ie.exclude&&(De.exclude={id:i.jR.byRefId,options:Ie.exclude}),Se.pipe(a.I.operator(De,ge))}};var o=e(73376),u=e(15400),c=e(81160),p=e(28240),h=e(81010);const y={id:l.F.formatTime,name:"Format time",description:"Set the output format of a time field",defaultOptions:{timeField:"",outputFormat:"",useTimezone:!0},isApplicable:Ie=>{for(const ge of Ie)for(const Se of ge.fields)if(Se.type==="time")return h.M.Applicable;return h.M.NotApplicable},isApplicableDescription:"The Format time transformation requires a time field to work. No time field could be found.",operator:(Ie,ge)=>Se=>Se.pipe((0,c.T)(De=>f(Ie,De,ge)))},f=({timeField:Ie,outputFormat:ge,timezone:Se},De,Ke)=>!Array.isArray(De)||De.length===0?De:((0,p.Fm)(De),ge=Ke?.interpolate(ge)??ge,De.map(Me=>({...Me,fields:Me.fields.map(be=>(be.state?.displayName===Ie&&(be=(0,r.Xv)(be,ge,{timeZone:Se})),be))})));var v=e(25094),P=e(68133),m=e(11261),D=e(85200);const x="Time",E="Time",C="Value",b=h.N.Empty,T=window?.grafanaBootData?.settings?.featureToggles?.dataplaneFrontendFallback,A={id:l.F.groupingToMatrix,name:"Grouping to Matrix",description:"Groups series by field and return a matrix visualisation",defaultOptions:{columnField:x,rowField:E,valueField:C},isApplicable:Ie=>{let ge=0;for(const Se of Ie)ge+=Se.fields.length;return ge>=3?h.M.Applicable:h.M.NotApplicable},isApplicableDescription:Ie=>{let ge=0;for(const Se of Ie)ge+=Se.fields.length;return`Grouping to matrix requiers at least 3 fields to work. Currently there are ${ge} fields.`},operator:(Ie,ge)=>Se=>Se.pipe((0,c.T)(De=>{const Ke=ge.interpolate(Ie.columnField||x),Me=ge.interpolate(Ie.rowField||E),be=ge.interpolate(Ie.valueField||C),we=Ie.emptyValue||b;if(De.length!==1)return De;const Be=De[0],He=S(Be,Ke),Ve=S(Be,Me),Je=S(Be,be),nt=`${Me}\\${Ke}`;if(!He||!Ve||!Je)return De;const pt=R(He.values),bt=R(Ve.values),Tt={};for(let je=0;je<Je.values.length;je++){const ue=He.values[je],Ee=Ve.values[je],Ce=Je.values[je];Tt[ue]||(Tt[ue]={}),Tt[ue][Ee]=Ce}const ye=[{name:nt,values:bt,type:m.PU.string,config:{}}];for(const je of pt){let ue=[];for(const Ee of bt){const Ce=Tt[je][Ee]??O(we);ue.push(Ce)}T&&typeof je=="number"&&(Je.config={...Je.config,displayNameFromDS:void 0}),ye.push({name:je.toString(),values:ue,config:Je.config,type:Je.type})}return[{fields:ye,length:bt.length}]}))};function R(Ie){const ge=new Set;for(let Se=0;Se<Ie.length;Se++)ge.add(Ie[Se]);return Array.from(ge)}function S(Ie,ge){for(let Se=0;Se<Ie.fields.length;Se++){const De=Ie.fields[Se];let Ke;if(T?Ke=D.sJ.get(i.Ct.byName).get(ge)(De,Ie,[Ie]):Ke=ge===(0,p.Ct)(De),Ke)return De}return null}function O(Ie){switch(Ie){case h.N.False:return!1;case h.N.True:return!0;case h.N.Null:return null;case h.N.Empty:default:return""}}var j=e(77678),B=e(41511),N=e(6829),I=e(67641);const K=10,w={id:l.F.limit,name:"Limit",description:"Limit the number of items to the top N",defaultOptions:{limitField:K},operator:(Ie,ge)=>Se=>Se.pipe((0,c.T)(De=>{let Ke=K;return Ie.limitField!==void 0&&(typeof Ie.limitField=="string"?(0,I.w)()?Ke=parseInt(ge.interpolate(Ie.limitField),10):Ke=parseInt(Ie.limitField,10):Ke=Ie.limitField),Ke<0&&(Ke=0),De.map(Me=>Me.length>Ke?{...Me,fields:Me.fields.map(be=>({...be,values:be.values.slice(0,Ke)})),length:Ke}:Me)}))};var U=e(58140),W=e(64586),H=e(82280);const z={id:l.F.rename,name:"Rename fields by name",description:"Rename fields based on configuration given by user",defaultOptions:{renameByName:{}},operator:Ie=>ge=>ge.pipe((0,c.T)(Se=>{const De=G(Ie.renameByName);return!Array.isArray(Se)||Se.length===0?Se:Se.map(Ke=>({...Ke,fields:De(Ke)}))}))},G=Ie=>ge=>!Ie||Object.keys(Ie).length===0?ge.fields:ge.fields.map(Se=>{const De=(0,p.Ct)(Se,ge),Ke=Ie[De];return typeof Ke!="string"||Ke.length===0?Se:{...Se,config:{...Se.config,displayName:Ke},state:{...Se.state,displayName:Ke}}}),M={id:l.F.organize,name:"Organize fields by name",description:"Order, filter and rename fields based on configuration given by user",defaultOptions:{excludeByName:{},indexByName:{},renameByName:{},includeByName:{}},isApplicable:Ie=>Ie.length>1?h.M.NotPossible:h.M.Applicable,operator:(Ie,ge)=>Se=>Se.pipe(g.D.operator({include:Ie.includeByName?{names:Q(Ie.includeByName)}:void 0,exclude:{names:Q(Ie.excludeByName)}},ge),H.x.operator(Ie,ge),z.operator(Ie,ge))},Q=Ie=>Ie?Object.keys(Ie).filter(ge=>Ie[ge]):[];var Y=e(21128),q=e(54479);const te={id:l.F.renameByRegex,name:"Rename fields by regex",description:"Rename fields based on regular expression by users.",defaultOptions:{regex:"(.*)",renamePattern:"$1"},operator:Ie=>ge=>ge.pipe((0,c.T)(Se=>!Array.isArray(Se)||Se.length===0?Se:Se.map(X(Ie))))},X=Ie=>ge=>{const Se=(0,q.dO)(Ie.regex),De=ge.fields.map(Ke=>{const Me=(0,p.Ct)(Ke,ge);if(!Se.test(Me))return Ke;const be=Me.replace(Se,Ie.renamePattern);return{...Ke,config:{...Ke.config,displayName:be},state:{...Ke.state,displayName:be}}});return{...ge,fields:De}};var ee=e(2543),ne=e(37471),Z=e(14236),ae=e(19845);const re={id:l.F.seriesToRows,name:"Series to rows",description:"Combines multiple series into a single serie and appends a column with metric name per value.",defaultOptions:{},operator:Ie=>ge=>ge.pipe((0,c.T)(Se=>{if(!Array.isArray(Se)||Se.length===0||(Se=Se.filter(we=>we.length>0),!(0,ae.jq)(Se)))return Se;const De={},Ke=new Set,Me=new ne.k,be={name:m.aI,values:[],config:{},type:m.PU.string};for(let we=0;we<Se.length;we++){const Be=Se[we];for(let He=0;He<Be.fields.length;He++){const Ve=Be.fields[He];if(Ve.type===m.PU.time){De[we]=He,Ke.has(m.LE)||(Me.addField(se(Ve,m.LE)),Me.addField(be),Ke.add(m.LE));continue}Ke.has(m.Bc)||(Me.addField(se(Ve,m.Bc)),Ke.add(m.Bc))}}for(let we=0;we<Se.length;we++){const Be=Se[we];for(let He=0;He<Be.length;He++){const Ve=De[we],Je=Ve===0?1:0;Me.add({[m.LE]:Be.fields[Ve].values[He],[m.aI]:(0,p.Ri)(Be),[m.Bc]:Be.fields[Je].values[He]})}}return[(0,Z.ES)(Me,0,!0)]}))},se=(Ie,ge)=>({...(0,ee.omit)(Ie,["values","state","labels","config","name"]),name:ge,values:[],config:{...(0,ee.omit)(Ie.config,["displayName","displayNameFromDS"])}}),de={id:l.F.sortBy,name:"Sort by",description:"Sort fields in a frame.",defaultOptions:{fields:{}},operator:(Ie,ge)=>Se=>Se.pipe((0,c.T)(De=>!Array.isArray(De)||De.length===0||!Ie?.sort?.length?De:le(De,Ie.sort,ge)))};function le(Ie,ge,Se){return Ie.map(De=>{const Ke=he(De,ge,Se);return Ke.length&&Ke[0].index!=null?(0,Z.ES)(De,Ke[0].index,Ke[0].desc):De})}function he(Ie,ge,Se){return ge.map(De=>De.index!=null?De:(0,I.w)()?{...De,index:Ie.fields.findIndex(Ke=>Se.interpolate(De.field)===(0,p.Ct)(Ke,Ie))}:{...De,index:Ie.fields.findIndex(Ke=>De.field===(0,p.Ct)(Ke,Ie))})}const ie={id:l.F.transpose,name:"Transpose",description:"Transpose the data frame",defaultOptions:{},operator:Ie=>ge=>ge.pipe((0,c.T)(Se=>Se.length===0?Se:J(Ie,Se)))};function J(Ie,ge){return ge.map(Se=>{const De=Se.fields[0],Ke=Ie.firstFieldName?Ie.firstFieldName:"Field",Me=Ie.restFieldsName?Ie.restFieldsName:"Value",be=De.type===m.PU.string||De.type===m.PU.time||De.type===m.PU.enum,we=be?[Ke,...pe(De,De.values)]:[Ke,...De.values.map((Je,nt)=>Me)],Be=be?Se.fields.map(Je=>Je.name).slice(1):Se.fields.map(Je=>Je.name),He=ce(be?Se.fields.map(Je=>Je.type).slice(1):Se.fields.map(Je=>Je.type)),Ve=we.map((Je,nt)=>{if(nt===0)return{name:Ke,type:m.PU.string,config:{},values:Be};const pt=Se.fields.map(ye=>He===m.PU.string?pe(ye,[ye.values[nt-1]])[0]:ye.values[nt-1]),bt=be?De.name:"row",Tt=be?Je:nt;return{name:be?Me:Je,labels:{[bt]:Tt},type:He,config:{},values:be?pt.slice(1):pt}});return{...Se,fields:Ve,length:Math.max(...Ve.map(Je=>Je.values.length))}})}function ce(Ie){const ge=new Set(Ie);return ge.size===1?[...ge][0]:m.PU.string}function pe(Ie,ge){switch(Ie.type){case m.PU.time:case m.PU.number:case m.PU.boolean:case m.PU.string:return ge.map(Se=>`${Se}`);case m.PU.enum:return ge.map(Se=>Ie.config.type.enum.text[Se]);default:return ge.map(Se=>JSON.stringify(Se))}}const Pe={noopTransformer:W.W,filterFieldsTransformer:a.z,filterFieldsByNameTransformer:g.D,filterFramesTransformer:a.I,filterFramesByRefIdTransformer:d,filterByValueTransformer:o.Sv,formatStringTransformer:u.yt,formatTimeTransformer:y,orderFieldsTransformer:H.x,organizeFieldsTransformer:M,reduceTransformer:Y.Wj,concatenateTransformer:n.vz,calculateFieldTransformer:t.SC,joinByFieldTransformer:B.L,seriesToColumnsTransformer:B.L,seriesToRowsTransformer:re,renameFieldsTransformer:z,labelsToFieldsTransformer:N.V,ensureColumnsTransformer:s.b,groupByTransformer:v.of,sortByTransformer:de,mergeTransformer:U.o,renameByRegexTransformer:te,histogramTransformer:j.OA,convertFieldTypeTransformer:r.zM,groupingToMatrixTransformer:A,limitTransformer:w,groupToNestedTable:P._,transposeTransformer:ie}},66350:(_,L,e)=>{"use strict";e.d(L,{Bp:()=>v,SC:()=>C,UY:()=>f,Uj:()=>D,ip:()=>P,pR:()=>I,sw:()=>w});var t=e(2543),n=e.n(t),r=e(81160),s=e(14236),a=e(28240),g=e(39070),i=e(11261),l=e(11710),d=e(27618),o=e(75059),u=e(85200),c=e(1173),p=e(34125),h=e(18282),y=e(64586),f=(U=>(U.ReduceRow="reduceRow",U.CumulativeFunctions="cumulativeFunctions",U.WindowFunctions="windowFunctions",U.BinaryOperation="binary",U.UnaryOperation="unary",U.Index="index",U))(f||{}),v=(U=>(U.Percentage="percentage",U.Fixed="fixed",U))(v||{}),P=(U=>(U.Trailing="trailing",U.Centered="centered",U))(P||{});const m={reducer:o.gy.sum},D={reducer:o.gy.mean,windowAlignment:"trailing",windowSizeMode:"percentage",windowSize:.1},x={left:{fixed:""},operator:l.k.Add,right:{fixed:""}},E={operator:d._.Abs,fieldName:""},C={id:h.F.calculateField,name:"Add field from calculation",description:"Use the row values to calculate a new field",defaultOptions:{mode:"reduceRow",reduce:{reducer:o.gy.sum}},operator:(U,W)=>H=>{const z=U&&U.timeSeries!==!1?p.b.operator(null,W):y.W.operator({},W);return U.alias!=null&&(U.alias=W.interpolate(U.alias)),H.pipe(z,(0,r.T)(G=>{const M=U.mode??"reduceRow";let Q;switch(M){case"reduceRow":Q=j((0,t.defaults)(U.reduce,m),G);break;case"cumulativeFunctions":Q=O((0,t.defaults)(U.cumulative,m),G);break;case"windowFunctions":Q=b((0,t.defaults)(U.window,D),G);break;case"unary":Q=K((0,t.defaults)(U.unary,E),G);break;case"binary":const Y=[];G.map(te=>{te.fields.map(X=>{Y.push(X.name)})});const q={left:I(U.binary?.left??"",Y),operator:U.binary?.operator??x.operator,right:I(U.binary?.right??"",Y)};if(U.binary=q,q.left?.matcher?.id&&q.left?.matcher.id===c.Ct.byType){const te=q.left.matcher.options,X=l.b.getIfExists(q.operator);return G.map(ee=>{const{timeField:ne}=(0,s.KR)(ee),Z=[];return ne&&U.timeSeries!==!1&&Z.push(ne),ee.fields.map((ae,re)=>{if(U.replaceFields||Z.push(ae),ae.type===te){const se=ae.values,de=B(ee,q.right??x.right,G,W);if(!se||!de||!X)return;const le=new Array(se.length);for(let ie=0;ie<le.length;ie++)le[ie]=X.operation(se[ie],de[ie]);const he={...ae,name:`${ae.name} ${U.binary?.operator??""} ${U.binary?.right.matcher?.options??U.binary?.right.fixed}`,values:le};Z.push(he)}}),{...ee,fields:Z}})}else Q=N((0,t.defaults)(q,x),G,W);break;case"index":return G.map(te=>{const X=[...Array(te.length).keys()];if(U.index?.asPercentile)for(let ne=0;ne<X.length;ne++)X[ne]=X[ne]/X.length;const ee={name:U.alias??"Row",type:i.PU.number,values:X,config:U.index?.asPercentile?{unit:"percentunit"}:{}};return{...te,fields:U.replaceFields?[ee]:[...te.fields,ee]}})}return Q?G.map(Y=>{const q=Q(Y);if(!q)return Y;const te={name:w(U),type:i.PU.number,config:{},values:q};let X=[];if(U.replaceFields){const{timeField:ee}=(0,s.KR)(Y);ee&&U.timeSeries!==!1?X=[ee,te]:X=[te]}else X=[...Y.fields,te];return{...Y,fields:X}}):G}))}};function b(U,W){if(U.windowSize<=0)throw new Error("Add field from calculation transformation - Window size must be larger than 0");let H=(0,u.NS)({id:c.Ct.numeric});return U.field&&(H=(0,u.NS)({id:c.Ct.byNames,options:{names:[U.field]}})),z=>{const G=Math.ceil(U.windowSize*(U.windowSizeMode==="percentage"?z.length:1));let M=null;for(const Q of z.fields)if(H(Q,z,W)){M=Q;break}if(M){if(![o.gy.mean,o.gy.stdDev,o.gy.variance].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return U.windowAlignment==="centered"?A(z,U.reducer,M,G):T(z,U.reducer,M,G)}}}function T(U,W,H,z){const G=[];let M=0,Q=0;for(let Y=0;Y<U.length;Y++)if(W===o.gy.mean){const q=H.values[Y];q!=null&&(Q++,M+=q,Y>z-1&&(M-=H.values[Y-z],Q--)),G.push(Q===0?0:M/Q)}else if(W===o.gy.variance){const q=Math.max(0,Y-z+1),te=Y+1;G.push(R(H.values.slice(q,te)))}else if(W===o.gy.stdDev){const q=Math.max(0,Y-z+1),te=Y+1;G.push(S(H.values.slice(q,te)))}return G}function A(U,W,H,z){const G=[];let M=0,Q=0;const Y=Math.ceil(z/2)-1,q=Math.floor(z/2);for(let te=0;te<U.length;te++){const X=te-q,ee=te+Y;if(W===o.gy.mean){if(te===0)for(let ne=0;ne<Y+1&&ne<H.values.length;ne++)H.values[ne]!=null&&(M+=H.values[ne],Q++);else ee<H.values.length&&H.values[ee]!=null&&(M+=H.values[ee],Q++),X>0&&H.values[X-1]!=null&&(M-=H.values[X-1],Q--);G.push(Q===0?0:M/Q)}else if(W===o.gy.variance){const ne=H.values.slice(Math.max(0,X),Math.min(ee+1,H.values.length));G.push(R(ne))}else if(W===o.gy.stdDev){const ne=H.values.slice(Math.max(0,X),Math.min(ee+1,H.values.length));G.push(S(ne))}}return G}function R(U){if(U.length<1)return 0;let W=0,H=0,z=0;for(let M=0;M<U.length;M++){const Q=U[M];if(Q!=null){z++;let Y=H;H+=(Q-Y)/z,W+=(Q-Y)*(Q-H)}}return z===0?0:W/z}function S(U){return Math.sqrt(R(U))}function O(U,W){let H=(0,u.NS)({id:c.Ct.numeric});if(U.field&&(H=(0,u.NS)({id:c.Ct.byNames,options:{names:[U.field]}})),![o.gy.mean,o.gy.sum].includes(U.reducer))throw new Error(`Add field from calculation transformation - Unsupported reducer: ${U.reducer}`);return z=>{let G=null;for(const Y of z.fields)if(H(Y,z,W)){G=Y;break}if(!G)return;const M=[];let Q=0;for(let Y=0;Y<z.length;Y++)Q+=G.values[Y]??0,U.reducer===o.gy.sum?M.push(Q):U.reducer===o.gy.mean&&M.push(Q/(Y+1));return M}}function j(U,W){let H=(0,u.NS)({id:c.Ct.numeric});U.include&&U.include.length&&(H=(0,u.NS)({id:c.Ct.byNames,options:{names:U.include}}));const z=o.AS.get(U.reducer);if(!z)throw new Error(`Unknown reducer: ${U.reducer}`);const G=z.reduce??o.H3,M=U.nullValueMode===g.UW.Ignore,Q=U.nullValueMode===g.UW.AsZero;return Y=>{const q=[];for(const ne of Y.fields)H(ne,Y,W)&&q.push(ne.values);const te=q.length,X={name:"temp",values:new Array(te),type:i.PU.number,config:{}},ee=[];for(let ne=0;ne<Y.length;ne++){for(let Z=0;Z<te;Z++)X.values[Z]=q[Z][ne];ee.push(G(X,M,Q)[U.reducer])}return ee}}function B(U,W,H,z){if(!W)return;if(W.matcher&&W.matcher.id===c.Ct.byName){const M=z.interpolate(W.matcher.options??"");for(const Q of U.fields)if(M===(0,a.Ct)(Q,U,H))return Q.type===i.PU.boolean?Q.values.map(Y=>Y?1:0):Q.values}const G=parseFloat(W.fixed??z.interpolate(W.matcher?.options??""));if(!isNaN(G))return new Array(U.length).fill(G)}function N(U,W,H){const z=l.b.getIfExists(U.operator);return G=>{const M=B(G,U.left,W,H),Q=B(G,U.right,W,H);if(!M||!Q||!z)return;const Y=new Array(M.length);for(let q=0;q<Y.length;q++)Y[q]=z.operation(M[q],Q[q]);return Y}}function I(U,W){return typeof U=="string"?isNaN(Number(U))?{matcher:{id:c.Ct.byName,options:U}}:W.includes(U)?{matcher:{id:c.Ct.byName,options:U}}:{fixed:U}:U}function K(U,W){const H=d.j.getIfExists(U.operator);return z=>{let G=[];for(const Q of z.fields)U.fieldName===(0,a.Ct)(Q,z,W)&&Q.type===i.PU.number&&(G=Q.values);if(!G.length||!H)return;const M=new Array(G.length);for(let Q=0;Q<M.length;Q++)M[Q]=H.operation(G[Q]);return M}}function w(U){if(U.alias?.length)return U.alias;switch(U.mode){case"cumulativeFunctions":{const{cumulative:W}=U;return`cumulative ${W?.reducer??""}${W?.field?`(${W.field})`:""}`}case"windowFunctions":{const{window:W}=U;return`${W?.windowAlignment??""} moving ${W?.reducer??""}${W?.field?`(${W.field})`:""}`}case"unary":{const{unary:W}=U;return`${W?.operator??""}${W?.fieldName?`(${W.fieldName})`:""}`}case"binary":{const{binary:W}=U;return`${W?.left?.matcher?.options??W?.left?.fixed??""} ${W?.operator??""} ${W?.right?.matcher?.options??W?.right?.fixed??""}`.replace(/\$/g,"")}case"reduceRow":{const W=o.AS.getIfExists(U.reduce?.reducer);if(W)return W.name}break;case"index":return"Row"}return"math"}},82150:(_,L,e)=>{"use strict";e.d(L,{vz:()=>a,x1:()=>s});var t=e(81160),n=e(11261),r=e(18282),s=(i=>(i.Drop="drop",i.FieldName="field",i.Label="label",i))(s||{});const a={id:r.F.concatenate,name:"Concatenate fields",description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",defaultOptions:{frameNameMode:"field",frameNameLabel:"frame"},operator:i=>l=>l.pipe((0,t.T)(d=>!Array.isArray(d)||d.length<2?d:[g(d,i)]))};function g(i,l){let d=!0,o=i[0].length;const u=l.frameNameLabel??"frame";let c=[];for(const p of i){o!==p.length&&(d=!1,o=Math.max(o,p.length));for(const h of p.fields){const y={...h};y.state=void 0,p.name&&(l.frameNameMode==="drop"||(l.frameNameMode==="label"?(y.labels={...h.labels},y.labels[u]=p.name):!y.name||y.name===n.Bc?y.name=p.name:y.name=`${p.name} \xB7 ${h.name}`)),c.push(y)}}return d||(c=c.map(p=>{if(p.values.length===o)return p;const h=p.values.slice();return h.length=o,{...p,values:h}})),{fields:c,length:o}}},50311:(_,L,e)=>{"use strict";e.d(L,{Xv:()=>h,ks:()=>f,s7:()=>d,zM:()=>i});var t=e(81160),n=e(53531),r=e(11261),s=e(85200),a=e(1173),g=e(18282);const i={id:g.F.convertFieldType,name:"Convert field type",description:"Convert a field to a specified field type.",defaultOptions:{fields:{},conversions:[{targetField:void 0,destinationType:void 0,dateFormat:void 0,timezone:void 0}]},operator:(P,m)=>D=>D.pipe((0,t.T)(x=>i.transformer(P,m)(x))),transformer:P=>m=>!Array.isArray(m)||m.length===0?m:l(P,m)??[]};function l(P,m){if(!P.conversions.length)return m;const D=m.map(x=>({...x}));for(const x of P.conversions){if(!x.targetField)continue;const E=s.sJ.get(a.Ct.byName).get(x.targetField);for(const C of D)C.fields=C.fields.map(b=>E(b,C,D)?d(b,x):b)}return D}function d(P,m){switch(m.destinationType){case r.PU.time:return f(P,m.dateFormat);case r.PU.number:return c(P);case r.PU.string:return h(P,m.dateFormat,{timeZone:m.timezone},m.joinWith);case r.PU.boolean:return p(P);case r.PU.enum:return v(P,m.enumConfig);case r.PU.other:return y(P);default:return P}}const o=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/;function u(P,m){let D=m?{format:m}:void 0;const x=P.values.slice();let E=x.find(b=>b!=null),C=typeof E=="string"&&o.test(E);for(let b=0;b<x.length;b++)if(x[b]){let T=C?Date.parse(x[b]):(0,n.b)(x[b],D).valueOf();x[b]=Number.isFinite(T)?T:null}else x[b]=null;return{...P,type:r.PU.time,values:x}}function c(P){const m=P.values.slice(),D=m.some(x=>typeof x=="string");for(let x=0;x<m.length;x++){let E=m[x];D&&E!=null&&typeof E=="string"&&(E=E.replace(/,/g,""));const C=+E;m[x]=Number.isFinite(C)?C:null}return{...P,type:r.PU.number,values:m}}function p(P){const m=P.values.slice();for(let D=0;D<m.length;D++)m[D]=!!m[D];return{...P,type:r.PU.boolean,values:m}}function h(P,m,D,x){let E=P.values;switch(P.type){case r.PU.time:E=E.map(C=>(0,n.b)(C,D).format(m));break;case r.PU.other:E=E.map(C=>x?.length&&Array.isArray(C)?C.join(x):JSON.stringify(C));break;default:E=E.map(C=>`${C}`)}return{...P,type:r.PU.string,values:E}}function y(P){const m=P.values.slice();for(let D=0;D<m.length;D++)try{m[D]=JSON.parse(m[D])}catch{m[D]=null}return{...P,type:r.PU.other,values:m}}function f(P,m){const D=typeof P.values[0]=="number";return P.type===r.PU.time&&D?P:D?{...P,type:r.PU.time}:u(P,m)}function v(P,m){const D={...m},x=P.values.slice(),E=new Map;if(D.text&&D.text.length>0)for(let C=0;C<D.text.length;C++)E.set(D.text[C],C);else return P;for(let C=0;C<x.length;C++){const b=x[C];x[C]=E.get(b)}return{...P,config:{...P.config,type:{enum:D}},type:r.PU.enum,values:x}}},34125:(_,L,e)=>{"use strict";e.d(L,{b:()=>a});var t=e(81160),n=e(14236),r=e(18282),s=e(41511);const a={id:r.F.ensureColumns,name:"Ensure Columns Transformer",description:"Will check if current data frames is series or columns. If in series it will convert to columns.",operator:(i,l)=>d=>d.pipe((0,t.T)(o=>a.transformer(i,l)(o))),transformer:(i,l)=>d=>{const o=g(d);return d.length>1&&o?s.L.transformer({byField:o},l)(d):d}};function g(i){let l;for(const d of i){const{timeField:o}=(0,n.KR)(d);if(!o)return;if(!l)l=o.name;else if(l!==o.name)return}return l}},64224:(_,L,e)=>{"use strict";e.d(L,{I:()=>g,z:()=>a});var t=e(81160),n=e(85200),r=e(18282),s=e(64586);const a={id:r.F.filterFields,name:"Filter Fields",description:"select a subset of fields",defaultOptions:{},operator:(i,l)=>d=>!i.include&&!i.exclude?d.pipe(s.W.operator({},l)):(typeof i.include?.options=="string"?i.include.options=l.interpolate(i.include?.options):typeof i.include?.options?.pattern=="string"&&(i.include.options.pattern=l.interpolate(i.include?.options.pattern)),typeof i.exclude?.options=="string"?i.exclude.options=l.interpolate(i.exclude?.options):typeof i.exclude?.options?.pattern=="string"&&(i.exclude.options.pattern=l.interpolate(i.exclude?.options.pattern)),d.pipe((0,t.T)(o=>{const u=i.include?(0,n.NS)(i.include):null,c=i.exclude?(0,n.NS)(i.exclude):null,p=[];for(const h of o){const y=[];for(let v=0;v<h.fields.length;v++){const P=h.fields[v];if(c){if(c(P,h,o))continue;u||y.push(P)}u&&u(P,h,o)&&y.push(P)}if(!y.length)continue;const f={...h,fields:y};p.push(f)}return p})))},g={id:r.F.filterFrames,name:"Filter Frames",description:"select a subset of frames",defaultOptions:{},operator:(i,l)=>d=>!i.include&&!i.exclude?d.pipe(s.W.operator({},l)):d.pipe((0,t.T)(o=>{const u=i.include?(0,n.Dq)(i.include):null,c=i.exclude?(0,n.Dq)(i.exclude):null,p=[];for(const h of o){if(c){if(c(h))continue;u||p.push(h)}u&&u(h)&&p.push(h)}return p}))}},35602:(_,L,e)=>{"use strict";e.d(L,{D:()=>s,R:()=>a});var t=e(1173),n=e(64224),r=e(18282);const s={id:r.F.filterFieldsByName,name:"Filter fields by name",description:"select a subset of fields",defaultOptions:{},operator:(g,i)=>l=>l.pipe(n.z.operator({include:a(i,g.include,g.byVariable),exclude:a(i,g.exclude,g.byVariable)},i))},a=(g,i,l)=>{if(!i)return;const{names:d,pattern:o,variable:u}=i;if(l&&u){const c=g.interpolate(u);if(/\{.*\}/.test(c)){const p=c.slice(1).slice(0,-1).split(",");return{id:t.Ct.byNames,options:{names:p}}}return{id:t.Ct.byNames,options:{names:c.split(",")}}}if(!((!Array.isArray(d)||d.length===0)&&!o))return o?!Array.isArray(d)||d.length===0?{id:t.Ct.byRegexp,options:o}:{id:t.Ct.byRegexpOrNames,options:i}:{id:t.Ct.byNames,options:{names:d}}}},73376:(_,L,e)=>{"use strict";e.d(L,{Sm:()=>d,Sv:()=>o,j4:()=>l});var t=e(81160),n=e(28240),r=e(85200),s=e(1173),a=e(18282),g=e(64586),i=e(67641),l=(p=>(p.exclude="exclude",p.include="include",p))(l||{}),d=(p=>(p.all="all",p.any="any",p))(d||{});const o={id:a.F.filterByValue,name:"Filter data by values",description:"select a subset of results based on values",defaultOptions:{filters:[],type:"include",match:"any"},operator:(p,h)=>y=>{const f=p.filters,v=p.match==="all",P=p.type==="include";if(!Array.isArray(f)||f.length===0)return y.pipe(g.W.operator({},h));const m=[];return(0,i.w)()&&m.push(...f.map(D=>{if(D.config.id===s.Js.between){let x=D.config.options.from,E=D.config.options.to;return typeof D.config.options.from=="string"&&(x=h.interpolate(x)),typeof D.config.options.to=="string"&&(E=h.interpolate(E)),{...D,config:{...D.config,options:{...D.config.options,to:E,from:x}}}}else if(D.config.options.value){let x=D.config.options.value;return typeof D.config.options.value=="string"&&(x=h.interpolate(x)),{...D,config:{...D.config,options:{...D.config.options,value:x}}}}return D})),y.pipe((0,t.T)(D=>{if(D.length===0)return D;const x=[];for(const E of D){const C=new Set,b=c(E,D);let T;(0,i.w)()?T=u(m,b):T=u(f,b);for(let S=0;S<E.length;S++){if(C.has(S))continue;let O=!0;for(const j of T){const B=j(S,E,D);if(!v&&B){O=!0;break}if(v&&!B){O=!1;break}O=B}O&&C.add(S)}const A=[],R=P?C.size:D[0].length-C.size;for(const S of E.fields){const O=[];for(let j=0;j<E.length;j++){if(P&&C.has(j)){O.push(S.values[j]);continue}if(!P&&!C.has(j)){O.push(S.values[j]);continue}}A.push({...S,values:O,state:{}})}x.push({...E,fields:A,length:R})}return x}))}},u=(p,h)=>{const y=()=>!1;return p.map(f=>{const v=h[f.fieldName]??-1;if(v<0)return console.warn(`[FilterByValue] Could not find index for field name: ${f.fieldName}`),y;const P=(0,r.kK)(f.config);return(m,D,x)=>P(m,D.fields[v],D,x)})},c=(p,h)=>{const y={};return p.fields.forEach((f,v)=>{const P=(0,n.Ct)(f,p,h);y[P]=v}),y}},15400:(_,L,e)=>{"use strict";e.d(L,{gs:()=>i,yt:()=>o});var t=e(81160),n=e(11261),r=e(81010),s=e(85200),a=e(1173),g=e(18282),i=(c=>(c.UpperCase="Upper Case",c.LowerCase="Lower Case",c.SentenceCase="Sentence Case",c.TitleCase="Title Case",c.PascalCase="Pascal Case",c.CamelCase="Camel Case",c.SnakeCase="Snake Case",c.KebabCase="Kebab Case",c.Trim="Trim",c.Substring="Substring",c))(i||{});const l=c=>{const p=c.split(" ");for(let h=0;h<p.length;h++)p[h]=p[h].charAt(0).toUpperCase()+p[h].slice(1).toLowerCase();return p},d=c=>p=>p.values.map(h=>{switch(c.outputFormat){case"Upper Case":return h.toUpperCase();case"Lower Case":return h.toLowerCase();case"Sentence Case":return h.charAt(0).toUpperCase()+h.slice(1);case"Title Case":return l(h).join(" ");case"Pascal Case":return l(h).join("");case"Camel Case":return h=l(h).join(""),h.charAt(0).toLowerCase()+h.slice(1);case"Snake Case":return h.toLowerCase().split(" ").join("_");case"Kebab Case":return h.toLowerCase().split(" ").join("-");case"Trim":return h.trim();case"Substring":return h.substring(c.substringStart,c.substringEnd)}}),o={id:g.F.formatString,name:"Format string",description:"Manipulate string fields formatting",defaultOptions:{stringField:"",outputFormat:"Upper Case"},isApplicable:c=>{for(const p of c)for(const h of p.fields)if(h.type==="string")return r.M.Applicable;return r.M.NotApplicable},operator:c=>p=>p.pipe((0,t.T)(h=>{if(h.length===0)return h;const y=s.sJ.get(a.Ct.byName).get(c.stringField),f=d(c),v=u(y,f);return h.map(P=>({...P,fields:v(P,h)}))}))},u=(c,p)=>(h,y)=>h.fields.map(f=>{if(c(f,h,y)){const v=p(f);return{...f,type:n.PU.string,values:v}}return f})},25094:(_,L,e)=>{"use strict";e.d(L,{Ce:()=>f,R3:()=>o,Y2:()=>y,of:()=>u});var t=e(81160),n=e(14236),r=e(28240),s=e(11261),a=e(81010),g=e(75059),i=e(18282),l=e(67641);const d=2;var o=(v=>(v.aggregate="aggregate",v.groupBy="groupby",v))(o||{});const u={id:i.F.groupBy,name:"Group by",description:"Group the data by a field values then process calculations for each group.",defaultOptions:{fields:{}},isApplicable:v=>(0,l.f)(v)>=d?a.M.Applicable:a.M.NotApplicable,isApplicableDescription:v=>{const P=(0,l.f)(v);return`The Group by transformation requires a series with at least ${d} fields to work. The maximum number of fields found on a series is ${P}`},operator:v=>P=>P.pipe((0,t.T)(m=>{if(!Object.keys(v.fields).find(E=>v.fields[E].operation==="groupby"))return m;const x=[];for(const E of m){const C=E.fields.filter(A=>c(A,v));if(C.length===0)continue;const b=y(E,C),T=f(C,b);for(const A of E.fields){if(!p(A,v))continue;const R=(0,r.Ct)(A),S=v.fields[R].aggregations,O={};b.forEach(j=>{const B=j[R],N=(0,g.Nw)({field:B,reducers:S});for(const I of S)Array.isArray(O[I])||(O[I]=[]),O[I].push(N[I])});for(const j of S){const B={name:`${R} (${j})`,values:O[j]??[],type:s.PU.other,config:{}};B.type=h(j,A,B),T.push(B)}}x.push({fields:T,length:b.size})}return x}))},c=(v,P)=>{const m=(0,r.Ct)(v);return P?.fields[m]?.operation==="groupby"},p=(v,P)=>{const m=(0,r.Ct)(v);return P?.fields[m]?.operation==="aggregate"&&Array.isArray(P?.fields[m].aggregations)&&P?.fields[m].aggregations.length>0};function h(v,P,m){switch(v){case g.gy.allIsNull:return s.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return P.type;default:return(0,n.dF)(m)??s.PU.string}}function y(v,P){const m=new Map;for(let D=0;D<v.length;D++){const x=String(P.map(C=>C.values[D])),E=m.get(x)??{};m.has(x)||m.set(x,E);for(let C of v.fields){const b=(0,r.Ct)(C);E[b]||(E[b]={name:b,type:C.type,config:{...C.config},values:[]}),E[b].values.push(C.values[D])}}return m}function f(v,P){const m=[];for(const D of v){const x=[],E=(0,r.Ct)(D);P.forEach(C=>{x.push(C[E].values[0])}),m.push({name:D.name,type:D.type,config:{...D.config},values:x})}return m}},68133:(_,L,e)=>{"use strict";e.d(L,{_:()=>p,l:()=>o});var t=e(81160),n=e(14236),r=e(28240),s=e(11261),a=e(81010),g=e(75059),i=e(25094),l=e(18282),d=e(67641);const o=!0,u=2;var c=(m=>(m.aggregate="aggregate",m.groupBy="groupby",m))(c||{});const p={id:l.F.groupToNestedTable,name:"Group to nested tables",description:"Group data by a field value and create nested tables with the grouped data",defaultOptions:{showSubframeHeaders:o,fields:{}},isApplicable:m=>(0,d.f)(m)>=u?a.M.Applicable:a.M.NotApplicable,isApplicableDescription:m=>{const D=(0,d.f)(m);return`The Group to nested table transformation requires a series with at least ${u} fields to work. The maximum number of fields found on a series is ${D}`},operator:m=>D=>D.pipe((0,t.T)(x=>{if(!Object.keys(m.fields).find(b=>m.fields[b].operation==="groupby"))return x;const C=[];for(const b of x){const T=b.fields.filter(O=>y(O,m));if(T.length===0)continue;const A=(0,i.Y2)(b,T),R=(0,i.Ce)(T,A),S=P(A,m);for(let O=0;O<b.fields.length;O++){const j=b.fields[O];if(!f(j,m))continue;const B=(0,r.Ct)(j),N=m.fields[B].aggregations,I={};A.forEach(K=>{const w=K[B],U=(0,g.Nw)({field:w,reducers:N});for(const W of N)Array.isArray(I[W])||(I[W]=[]),I[W].push(U[W])});for(const K of N){const w={name:`${B} (${K})`,values:I[K],type:s.PU.other,config:{}};w.type=v(K,j,w),R.push(w)}}R.push({config:{},name:"Nested frames",type:s.PU.nestedFrames,values:S}),C.push({fields:R,length:A.size})}return C}))};function h(m,D,x){return{meta:{custom:{noHeader:!(x.showSubframeHeaders===void 0?o:x.showSubframeHeaders)}},length:D,fields:m}}const y=(m,D)=>{const x=(0,r.Ct)(m);return D?.fields[x]?.operation==="groupby"},f=(m,D)=>{const x=(0,r.Ct)(m);return D?.fields[x]?.operation==="aggregate"&&Array.isArray(D?.fields[x].aggregations)&&D?.fields[x].aggregations.length>0},v=(m,D,x)=>{switch(m){case g.gy.allIsNull:return s.PU.boolean;case g.gy.last:case g.gy.lastNotNull:case g.gy.first:case g.gy.firstNotNull:return D.type;default:return(0,n.dF)(x)??s.PU.string}};function P(m,D){const x=[];for(const[,E]of m){const C=[];for(const[b,T]of Object.entries(E)){const A=D.fields[b];(A===void 0||A.aggregations===void 0||A.operation==="aggregate"&&A.aggregations.length===0||A.operation===null||A.operation===void 0)&&C.push(T)}C.length>0?x.push([h(C,C[0].values.length,D)]):x.push([h([],0,D)])}return x}},77678:(_,L,e)=>{"use strict";e.d(L,{H1:()=>D,NX:()=>P,OA:()=>f,Rt:()=>y,Uh:()=>b,ZU:()=>C,cg:()=>R,d$:()=>v,dA:()=>m,ix:()=>x,p3:()=>E,rW:()=>u,rs:()=>T});var t=e(81160),n=e(57875),r=e(75972),s=e(11261),a=e(41260),g=e(97706),i=e(18282),l=e(73060),d=e(39624),o=e(67641);const u=[1e-9,2e-9,25e-10,4e-9,5e-9,1e-8,2e-8,25e-9,4e-8,5e-8,1e-7,2e-7,25e-8,4e-7,5e-7,1e-6,2e-6,25e-7,4e-6,5e-6,1e-5,2e-5,25e-6,4e-5,5e-5,1e-4,2e-4,25e-5,4e-4,5e-4,.001,.002,.0025,.004,.005,.01,.02,.025,.04,.05,.1,.2,.25,.4,.5,1,2,4,5,10,20,25,40,50,100,200,250,400,500,1e3,2e3,2500,4e3,5e3,1e4,2e4,25e3,4e4,5e4,1e5,2e5,25e4,4e5,5e5,1e6,2e6,25e5,4e6,5e6,1e7,2e7,25e6,4e7,5e7,1e8,2e8,25e7,4e8,5e8,1e9,2e9,25e8,4e9,5e9],c=30,p=[],h=(S,O)=>S-O,y={bucketCount:{name:"Bucket count",description:"approx bucket count"},bucketSize:{name:"Bucket size",description:void 0},bucketOffset:{name:"Bucket offset",description:"for non-zero-based buckets"},combine:{name:"Combine series",description:"combine all series into a single histogram"}},f={id:i.F.histogram,name:"Histogram",description:"Calculate a histogram from input data.",defaultOptions:{fields:{}},operator:(S,O)=>j=>j.pipe((0,t.T)(B=>f.transformer(S,O)(B))),transformer:(S,O)=>j=>{if(!Array.isArray(j)||j.length===0)return j;let B,N;S.bucketSize&&((0,o.w)()&&(S.bucketSize=O.interpolate(S.bucketSize.toString())),typeof S.bucketSize=="string"?B=parseFloat(S.bucketSize):B=S.bucketSize,isNaN(B)&&(B=void 0)),S.bucketOffset&&((0,o.w)()&&(S.bucketOffset=O.interpolate(S.bucketOffset.toString())),typeof S.bucketOffset=="string"?N=parseFloat(S.bucketOffset):N=S.bucketOffset,isNaN(N)&&(N=void 0));const I={bucketSize:B,bucketOffset:N,combine:S.combine},K=E(j,I);return K==null?[]:[R(K)]}},v="xMin";function P(S){return S===v||S==="BucketMin"}const m="xMax";function D(S){return S===m||S==="BucketMax"}function x(S){if(S.meta?.type===a.m.HeatmapCells){let N=S.fields.find(z=>z.name==="yMin"),I=S.fields.find(z=>z.name==="yMax"),K=S.fields.find(z=>z.name==="count"),w=[...new Set(I.values)].sort((z,G)=>z-G),U=[...new Set(N.values)].sort((z,G)=>z-G),W=new Map;w.forEach(z=>W.set(z,0));for(let z=0;z<I.values.length;z++){let G=I.values[z];W.set(G,W.get(G)+K.values[z])}return{xMin:{...N,name:"xMin",values:U},xMax:{...I,name:"xMax",values:w},counts:[{...K,values:[...W.values()]}]}}else if(S.meta?.type===a.m.HeatmapRows){let N=[],I=[],K=[],w="0";return S.fields.forEach(W=>{if(W.type===s.PU.number){let H=W.values.reduce((z,G)=>z+G,0);K.push(H),N.push(w),I.push(w=W.name)}}),K.push(0),N.push(w),I.push(w),{xMin:{...S.fields[1],name:"xMin",type:s.PU.string,values:N},xMax:{...S.fields[1],name:"xMax",type:s.PU.string,values:I},counts:[{...S.fields[1],name:"count",type:s.PU.number,values:K}]}}let O,j;const B=[];for(const N of S.fields)P(N.name)?O=N:D(N.name)?j=N:N.type===s.PU.number&&B.push(N);if(!j&&O&&O.values.length>1){let N=O.values,I=(0,g.h)(N[1]-N[0],6);j={...O,name:m,values:N.map(K=>K+I)}}if(!O&&j&&j?.values.length>1){let N=j.values,I=(0,g.h)(N[1]-N[0],6);O={...j,name:v,values:N.map(K=>K-I)}}if(O&&j&&B.length)return{xMin:O,xMax:j,counts:B}}function E(S,O){let j=O?.bucketSize,B=O?.bucketCount??c,N=O?.bucketOffset??0;if(S=S.map(M=>({...M,fields:M.fields.map(Q=>{if(Q.type===s.PU.number){const Y=Number(Q.config.noValue);Number.isNaN(Y)?Q={...Q,values:Q.values.filter(q=>q!=null)}:Q=(0,d.A)(Q,Y)}return Q})})),!j||j<0){let M=[];for(const ee of S)for(const ne of ee.fields)ne.type===s.PU.number&&(M=M.concat(ne.values));M.sort((ee,ne)=>ee-ne);let Q=1/0;if(M.length===1)Q=1;else for(let ee=1;ee<M.length;ee++){let ne=M[ee]-M[ee-1];ne!==0&&(Q=Math.min(Q,ne))}let Y=M[0];const X=(M[M.length-1]-Y)/B;for(let ee=0;ee<u.length;ee++){let ne=u[ee];if(X<ne&&ne>=Q){j=ne;break}}}const I=M=>(0,g.h)(T(M-N,j)+N,9);let K=((""+j).match(/\.\d+$/)??["."])[0].length-1,w=[],U=[],W;for(const M of S)for(const Q of M.fields)if(Q.type===s.PU.number){let Y=A(Q.values,I,p,h);w.push(Y),U.push({...Q,config:{...Q.config,unit:Q.config.unit==="short"?"short":void 0}}),!W&&Q.config.unit&&(W=Q.config)}if(!U.length)return null;let H=(0,l.fj)(w);for(let M=1;M<H.length;M++){let Q=H[M];for(let Y=0;Y<Q.length;Y++)Q[Y]==null&&(Q[Y]=0)}const z={name:v,values:H[0],type:s.PU.number,state:void 0,config:K===0?W??{}:{...W,decimals:K}},G={...z,name:m,values:H[0].map(M=>M+j)};if(O?.combine){const M=new Array(H[0].length).fill(0);for(let Q=1;Q<H.length;Q++)for(let Y=0;Y<M.length;Y++)M[Y]+=H[Q][Y];U=[{...U[0],name:"count",values:M,type:s.PU.number,state:{...U[0].state,displayName:"Count",multipleFrames:!1,origin:{frameIndex:0,fieldIndex:2}}}]}else U.forEach((M,Q)=>{M.values=H[Q+1]});return{xMin:z,xMax:G,counts:U}}function C(S,O){return Math.round(S/O)*O}function b(S,O){return Math.ceil(S/O)*O}function T(S,O){return Math.floor(S/O)*O}function A(S,O,j,B){let N=new Map;for(let U=0;U<S.length;U++){let W=S[U];W!=null&&(W=O(W));let H=N.get(W);H?H.count++:N.set(W,{value:W,count:1})}j&&j.forEach(U=>N.delete(U));let I=[...N.values()];B&&I.sort((U,W)=>B(U.value,W.value));let K=Array(I.length),w=Array(I.length);for(let U=0;U<I.length;U++)K[U]=I[U].value,w[U]=I[U].count;return[K,w]}function R(S,O){if(!S.xMin.display){const j=(0,n.J)({field:S.xMin,theme:O??(0,r.a)()});S.xMin.display=j,S.xMax.display=j}return S.counts[0].display=(0,n.J)({field:S.counts[0],theme:O??(0,r.a)()}),{length:S.xMin.values.length,meta:{type:a.m.Histogram},fields:[S.xMin,S.xMax,...S.counts]}}},41511:(_,L,e)=>{"use strict";e.d(L,{L:()=>i,W:()=>g});var t=e(81160),n=e(85200),r=e(1173),s=e(18282),a=e(73060),g=(l=>(l.outer="outer",l.inner="inner",l.outerTabular="outerTabular",l))(g||{});const i={id:s.F.joinByField,aliasIds:[s.F.seriesToColumns],name:"Join by field",description:"Combine rows from two or more tables, based on a related field between them.  This can be used to outer join multiple time series on the _time_ field to show many time series in one table.",defaultOptions:{byField:void 0,mode:"outer"},operator:(l,d)=>o=>o.pipe((0,t.T)(u=>i.transformer(l,d)(u))),transformer:(l,d)=>{let o;return u=>{if(u.length>1){l.byField&&!o&&(o=n.sJ.get(r.Ct.byName).get(d.interpolate(l.byField)));const c=(0,a.Fd)({frames:u,joinBy:o,mode:l.mode});if(c)return[c]}return u}}}},73060:(_,L,e)=>{"use strict";e.d(L,{Fd:()=>d,JI:()=>h,RC:()=>c,WO:()=>p,Yj:()=>l,fj:()=>f,g2:()=>v});var t=e(14236),n=e(11261),r=e(85200),s=e(1173),a=e(41511);function g(P){const{timeField:m}=(0,t.KR)(P[0]);if(m)return r.sJ.get(s.Ct.firstTimeField).get({});let D=[];for(const x of P[0].fields)x.type===n.PU.number&&D.push(x.name);for(let x=1;x<P.length;x++){const E=[];for(const C of P[0].fields)C.type===n.PU.number&&E.push(C.name);D=D.filter(C=>!E.includes(C))}return r.sJ.get(s.Ct.byName).get(D[0])}function i(P){return P.joinBy??g(P.frames)}function l(P,m){if(m>=0){let D=P.fields[m];D.type!==n.PU.string&&!v(D.values)&&(P=(0,t.ES)(P,m))}return P}function d(P){if(!P.frames?.length)return;const m=P.nullMode??(R=>{let S=R.config.custom?.spanNulls;return S===!0?c:S===-1?p:h});if(P.frames.length===1){let R=P.frames[0],S=R;const O=i(P);let j=S.fields.findIndex(B=>O(B,S,P.frames));if(P.keepOriginIndices&&(S={...R,fields:R.fields.map((B,N)=>{const I={...B},K={frameIndex:0,fieldIndex:N};return I.state?I.state.origin=K:I.state={origin:K},I})},j>0)){const B=S.fields[j],N=S.fields.filter((I,K)=>K!==j);N.unshift(B),S.fields=N,j=0}if(j>=0&&(S=l(S,j)),P.keep){let B=S.fields.filter((N,I)=>I===j||P.keep(N,S,P.frames));R!==S?S.fields=B:S={...R,fields:B}}return S}const D=[],x=[],E=[],C=[];let b=1;const T=i(P);for(let R=0;R<P.frames.length;R++){const S=P.frames[R];if(!S||!S.fields?.length)continue;const O=[c];let j,B=[],N=[];for(let K=0;K<S.fields.length;K++){const w=S.fields[K];if(w.state=w.state||{},!j&&T(w,S,P.frames))j=w;else{if(P.keep&&!P.keep(w,S,P.frames))continue;O.push(m(w));let U=w.labels??{},W=w.name;S.name&&(w.name===n.Bc?W=S.name:U.name==null&&(U={...U,name:S.name})),B.push({...w,name:W,labels:U})}P.keepOriginIndices&&(w.state.origin={frameIndex:R,fieldIndex:K})}if(!j)continue;E.length===0&&E.push(j),D.push(O);const I=[j.values];for(const K of B)I.push(K.values),E.push(K),P.keepDisplayNames||delete K.state?.displayName,N.push(b),b++;C.push(N),x.push(I)}let A=[];return P.mode===a.W.outerTabular?A=o(x,C,E.length,D):P.mode===a.W.inner?A=u(x):A=f(x,D,P.mode),{length:A[0]?A[0].length:0,fields:E.map((R,S)=>({...R,values:A[S]}))}}function o(P,m,D,x){let E={};for(let b=0;b<P.length;b++){let T=P[b],A=T[0];for(let R=0;R<P.length;R++){if(R===b)continue;let S=P[R],O=S[0];for(let j=0;j<A.length;j++){const B=A[j],N=D-1;let I=[B].concat(new Array(N)),K=0;for(let w=1;w<T.length;w++){const U=m[b][K];I[U]=T[w][j],K++}for(let w=0;w<O.length;w++)if(A[j]===O[w]){let U=0;for(let W=1;W<S.length;W++){const H=m[R][U];I[H]=S[W][w],U++}break}E[JSON.stringify(I)]=I}}}let C=[];for(let b=0;b<D;b++)C.push(new Array(0));for(let b in E){const T=E[b];for(let A=0;A<T.length;A++)C[A].push(T[A])}return C}function u(P){const m=[],D=(x,E,C)=>{if(E===x.length){m.push(C);return}const b=x[E],[T,...A]=b;for(let R=0;R<T.length;R++){const S=T[R];if(E===0||C.includes(S)){const O=[...C];E===0&&O.push(S);for(let j=0;j<A.length;j++)O.push(A[j][R]);D(x,E+1,O)}}};if(D(P,0,[]),m.length===0){const x=P.reduce((E,C)=>E+(C.length-1),1);return Array.from({length:x},()=>[])}return m[0].map((x,E)=>m.map(C=>C[E]))}const c=0,p=1,h=2;function y(P,m,D){for(let x=0,E,C=-1;x<m.length;x++){let b=m[x];if(b>C){for(E=b-1;E>=0&&P[E]==null;)P[E--]=null;for(E=b+1;E<D&&P[E]==null;)P[C=E++]=null}}}function f(P,m,D=a.W.outer){let x=new Set;for(let T=0;T<P.length;T++){let R=P[T][0],S=R.length;for(let O=0;O<S;O++)x.add(R[O])}let E=[Array.from(x).sort((T,A)=>T-A)],C=E[0].length,b=new Map;for(let T=0;T<C;T++)b.set(E[0][T],T);for(let T=0;T<P.length;T++){let A=P[T],R=A[0];for(let S=1;S<A.length;S++){let O=A[S],j=Array(C).fill(void 0),B=m?m[T][S]:p,N=[];for(let I=0;I<O.length;I++){let K=O[I],w=b.get(R[I]);K===null?B!==c&&(j[w]=K,B===h&&N.push(w)):j[w]=K}y(j,N,C),E.push(j)}}return E}function v(P,m=50){const D=P.length;if(D<=1)return!0;let x=0,E=D-1;for(;x<=E&&P[x]==null;)x++;for(;E>=x&&P[E]==null;)E--;if(E<=x)return!0;const C=Math.max(1,Math.floor((E-x+1)/m));for(let b=P[x],T=x+C;T<=E;T+=C){const A=P[T];if(A!=null&&b!=null){if(A<=b)return!1;b=A}}return!0}},6829:(_,L,e)=>{"use strict";e.d(L,{V:()=>g,n:()=>a});var t=e(81160),n=e(28240),r=e(11261),s=e(18282),a=(l=>(l.Columns="columns",l.Rows="rows",l))(a||{});const g={id:s.F.labelsToFields,name:"Labels to fields",description:"Extract time series labels to fields (columns or rows)",defaultOptions:{},operator:(l,d)=>o=>o.pipe((0,t.T)(u=>g.transformer(l,d)(u))),transformer:l=>d=>{if(l.mode==="rows")return i(d,l.keepLabels);const o=[],u=l.keepLabels?.length?new Set(l.keepLabels):void 0;for(const c of d){const p=[],h={};for(const y of c.fields){if(!y.labels){p.push(y);continue}const f={...y,config:{...y.config,displayName:void 0,displayNameFromDS:void 0},labels:void 0};p.push(f);for(const v of Object.keys(y.labels)){if(u&&!u.has(v))continue;if(l.valueLabel===v){f.name=y.labels[v];continue}(h[v]??(h[v]=new Set)).add(y.labels[v])}}for(const y in h)for(const f of h[y]){const v=new Array(c.length).fill(f);p.push({name:y,type:r.PU.string,values:v,config:{}})}o.push({...c,fields:p,length:c.length})}return o}};function i(l,d){const o=[];for(const u of l)for(const c of u.fields)if(c.labels){const p=[],h=[];if(d)for(const y of d)p.push(y),h.push(c.labels[y]);else for(const[y,f]of Object.entries(c.labels))p.push(y),h.push(f);h.length&&o.push({...u,name:(0,n.Ct)(c,u,l),fields:[{name:"label",type:r.PU.string,config:{},values:p},{name:"value",type:r.PU.string,config:{},values:h}],length:h.length})}return o}},58140:(_,L,e)=>{"use strict";e.d(L,{o:()=>i});var t=e(2543),n=e.n(t),r=e(81160),s=e(37471),a=e(81010),g=e(18282);const i={id:g.F.merge,name:"Merge series/tables",description:"Merges multiple series/tables into a single serie/table",defaultOptions:{},isApplicable:h=>h.length>1?a.M.Applicable:a.M.NotApplicable,isApplicableDescription:h=>`The merge transformation requires at least 2 data series to work. There is currently ${h.length} data series.`,operator:h=>y=>y.pipe((0,r.T)(f=>{if(!Array.isArray(f)||f.length<=1)return f;const v=f.filter(A=>A.fields.length>0);if(v.length===0)return[f[0]];const P=new Set,m={},D=[],x=new s.k;for(let A=0;A<v.length;A++){const R=v[A];for(let S=0;S<R.fields.length;S++){const O=R.fields[S];P.has(O.name)||(x.addField(l(O)),P.add(O.name)),m[O.name]=m[O.name]||{},m[O.name][A]=S,v.length-1===A&&c(m,O,v)&&D.push(O.name)}}if(D.length===0)return f;const E={},C=[],b=d(v,m,D),T=o(v,P,m);for(let A=0;A<v.length;A++){const R=v[A];for(let S=0;S<R.length;S++){const O=b(A,S),j=T(A,S);if(!Array.isArray(E[O])){E[O]=[j],C.push(p(O,E));continue}let B=!1;E[O]=E[O].map(N=>u(N,j)?(B=!0,{...N,...j}):N),B||(E[O].push(j),C.push(p(O,E)))}}for(const A of C){const R=E[A.key][A.index];R&&x.add(R)}return[x]}))},l=h=>({...(0,t.omit)(h,["values","state","labels","config"]),values:[],config:{...(0,t.omit)(h.config,"displayName")}}),d=(h,y,f)=>{const v=f.reduce((P,m)=>Object.keys(y[m]).reduce((D,x)=>(D[x]=D[x]||[],D[x].push(y[m][x]),D),P),{});return(P,m)=>v[P].reduce((D,x)=>D+h[P].fields[x].values[m],"")},o=(h,y,f)=>(v,P)=>{const m={},D=Array.from(y);for(const x of D){const E=f[x];if(!E)continue;const C=E[v];if(typeof C!="number")continue;const b=h[v];if(!b||!b.fields)continue;const T=b.fields[C];!T||!T.values||(m[x]=T.values[P])}return m},u=(h,y)=>{let f=!0;for(const v in y)if(!(typeof h[v]>"u")&&h[v]!==null&&h[v]!==y[v]){f=!1;break}return f},c=(h,y,f)=>Object.keys(h[y.name]).length===f.length,p=(h,y)=>({key:h,index:y[h].length-1})},64586:(_,L,e)=>{"use strict";e.d(L,{W:()=>n});var t=e(18282);const n={id:t.F.noop,name:"noop",description:"No-operation transformer",defaultOptions:{},operator:r=>s=>s,transformer:r=>s=>s}},46294:(_,L,e)=>{"use strict";e.d(L,{M:()=>s});var t=e(11261);const n={threshold:(g,i,l)=>g+l,midpoint:(g,i,l)=>(g+i)/2,plusone:(g,i,l)=>g+1};function r(g,i){return g.fields.find(l=>i!=null?l.name===i:l.type===t.PU.time)}function s(g){if(g.frame.length===0)return g.frame;let i=!0,{frame:l,refFieldName:d,refFieldPseudoMax:o,refFieldPseudoMin:u,insertMode:c}=g;c||(c=n.threshold);const p=r(l,d);if(p==null)return l;p.state={...p.state,nullThresholdApplied:!0};const h=l.fields.map(f=>f.config.custom?.insertNulls||p.config.interval||null),y=new Set(h);if(y.delete(null),y.size===0)return l;if(y.size===1){const f=y.values().next().value;if(f<=0)return l;const v=p.values,P=l.fields.map(D=>D.values),m=a(v,P,f,u,o,c,i);return m===P?l:{...l,length:m[0].length,fields:l.fields.map((D,x)=>({...D,values:m[x]}))}}return l}function a(g,i,l,d=null,o=null,u,c){const p=g.length,h=[];if(d!=null&&d<g[0]){let P=Math.ceil((g[0]-d)/l),m=g[0]-P*l;for(;m<g[0];)h.push(u(m-l,m,l)),m+=l}h.push(g[0]);let y=g[0];for(let P=1;P<p;P++){const m=g[P];for(;m-y>l&&(h.push(u(y,m,l)),y+=l,!!c););h.push(m),y=m}if(o!=null&&o>y)for(;y+l<o;)h.push(u(y,o,l)),y+=l;const f=h.length;if(f===p)return i;const v=[];for(let P of i){let m;if(P!==g){m=Array(f);for(let D=0,x=0;D<f;D++)m[D]=g[x]===h[D]?P[x++]:null}else m=h;v.push(m)}return v}},39624:(_,L,e)=>{"use strict";e.d(L,{A:()=>n,C:()=>t});function t(r){return{...r,fields:r.fields.map(s=>{const a=Number(s.config.noValue);return Number.isNaN(a)?s:n(s,a)})}}function n(r,s){const a=r.values.slice();for(let g=0;g<a.length;g++)a[g]===null&&(a[g]=s);return{...r,values:a}}},82280:(_,L,e)=>{"use strict";e.d(L,{X:()=>i,x:()=>g});var t=e(2543),n=e.n(t),r=e(81160),s=e(28240),a=e(18282);const g={id:a.F.order,name:"Order fields by name",description:"Order fields based on configuration given by user",defaultOptions:{indexByName:{}},operator:o=>u=>u.pipe((0,r.T)(c=>{const p=l(o.indexByName);return!Array.isArray(c)||c.length===0?c:c.map(h=>({...h,fields:p(h.fields,c,h)}))}))},i=o=>(u,c)=>d(u,o)-d(c,o),l=o=>(u,c,p)=>{if(!Array.isArray(u)||u.length===0||!o||Object.keys(o).length===0)return u;const h=i(o);return(0,t.clone)(u).sort((y,f)=>h((0,s.Ct)(y,p,c),(0,s.Ct)(f,p,c)))},d=(o,u)=>Number.isInteger(u[o])?u[o]:Number.MAX_SAFE_INTEGER},21128:(_,L,e)=>{"use strict";e.d(L,{Wj:()=>o,rV:()=>d});var t=e(81160),n=e(14236),r=e(28240),s=e(11261),a=e(75059),g=e(85200),i=e(72693),l=e(18282),d=(f=>(f.SeriesToRows="seriesToRows",f.ReduceFields="reduceFields",f))(d||{});const o={id:l.F.reduce,name:"Reduce",description:"Reduce all rows or data points to a single value using a function like max, min, mean or last.",defaultOptions:{reducers:[a.gy.max]},operator:f=>v=>v.pipe((0,t.T)(P=>{if(!f?.reducers?.length)return P;const m=f.fields?(0,g.NS)(f.fields):f.includeTimeField&&f.mode==="reduceFields"?i.Yg:i.zx;if(f.mode==="reduceFields")return h(P,m,f.reducers);const D=u(P,m,f.reducers,f.labelsToFields);return D?[D]:[]}))};function u(f,v,P,m){const D=a.AS.list(P),x=D.map(b=>b.id),E=[],C=m?c(f):[];for(const b of f){const T=b.fields.filter(B=>v(B,b,f)),A=T.length,R=[],S=new Array(A);R.push({name:"Field",type:s.PU.string,values:S,config:{}});const O={};if(m)for(const B of C)O[B]=new Array(A),R.push({name:B,type:s.PU.string,values:O[B],config:{}});const j={};for(const B of D)j[B.id]=new Array(A),R.push({name:B.name,type:s.PU.other,values:j[B.id],config:{}});for(let B=0;B<T.length;B++){const N=T[B],I=(0,a.Nw)({field:N,reducers:x});if(m){if(S[B]=N.name,N.labels)for(const K in N.labels)O[K][B]=N.labels[K]}else S[B]=(0,r.Ct)(N,b,f);for(const K of D){const w=I[K.id];w===null?j[K.id][B]=NaN:j[K.id][B]=w}}for(const B of R)if(B.type===s.PU.other){const N=(0,n.dF)(B);N&&(B.type=N)}E.push({...b,fields:R,length:A})}return p(E)}function c(f){const v=new Set;for(const P of f)for(const m of P.fields)if(m.labels)for(const D of Object.keys(m.labels))v.add(D);return[...v]}function p(f){if(!f?.length)return;const v=f[0];for(let P=1;P<f.length;P++){const m=f[P];for(let D=0;D<v.fields.length;D++){const x=v.fields[D];for(let E=0;E<m.fields.length;E++){const C=m.fields[E],b=D===0&&E===0,T=x.type===C.type&&x.name===C.name;if(b||T){const A=x.values,R=C.values;x.values=A.concat(R)}}}}return v.name=void 0,v.length=v.fields[0].values.length,v}function h(f,v,P){const D=a.AS.list(P).map(E=>E.id),x=[];for(const E of f){const C=[];for(const b of E.fields)if(v(b,E,f)){const T=(0,a.Nw)({field:b,reducers:D});for(const A of D){const R=T[A],S={...b,type:y(A,b),values:[R]};S.state=void 0,D.length>1&&(S.labels||(S.labels={}),S.labels.reducer=a.AS.get(A).name),C.push(S)}}C.length&&x.push({...E,fields:C,length:1})}return x}function y(f,v){switch(f){case a.gy.allValues:case a.gy.uniqueValues:return s.PU.other;case a.gy.first:case a.gy.firstNotNull:case a.gy.last:case a.gy.lastNotNull:return v.type;default:return s.PU.number}}},67641:(_,L,e)=>{"use strict";e.d(L,{f:()=>n,w:()=>t});const t=()=>window?.grafanaBootData?.settings?.featureToggles?.transformationsVariableSupport;function n(r){let s=0;for(const a of r)a.fields.length>s&&(s=a.fields.length);return s}},83580:(_,L,e)=>{"use strict";e.d(L,{DO:()=>n,Ur:()=>s,ki:()=>r,mx:()=>a});var t=(g=>(g.Fetch="fetch",g))(t||{}),n=(g=>(g.POST="POST",g.PUT="PUT",g.GET="GET",g))(n||{});const r=[{label:"POST",value:"POST"},{label:"PUT",value:"PUT"},{label:"GET",value:"GET"}],s=[{label:"application/json",value:"application/json"},{label:"text/plain",value:"text/plain"},{label:"application/xml",value:"application/xml"},{label:"application/x-www-form-urlencoded",value:"application/x-www-form-urlencoded"}],a={type:"fetch",title:"",fetch:{url:"",method:"POST",body:"{}",queryParams:[],headers:[["Content-Type","application/json"]]}}},43585:(_,L,e)=>{"use strict";e.d(L,{O:()=>t});var t=(n=>(n.NoData="no_data",n.Paused="paused",n.Alerting="alerting",n.OK="ok",n.Pending="pending",n.Unknown="unknown",n))(t||{})},8790:(_,L,e)=>{"use strict";e.d(L,{V:()=>t});var t=(n=>(n.Field="field",n.Text="text",n.Skip="skip",n))(t||{})},41987:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>s,Jk:()=>n,hX:()=>r});var t=e(43429),n=(a=>(a.CloudAlerting="cloud-alerting",a.UnifiedAlerting="unified-alerting",a.Dashboard="dashboard",a.Explore="explore",a.Correlations="correlations",a.Unknown="unknown",a.PanelEditor="panel-editor",a.PanelViewer="panel-viewer",a))(n||{});class r extends t.Ud{constructor(){super(...arguments),this._exposedComponentConfigs=[],this._addedComponentConfigs=[],this._addedLinkConfigs=[]}init(g){}setRootPage(g){return this.root=g,this}setComponentsFromLegacyExports(g){if(g.ConfigCtrl&&(this.angularConfigCtrl=g.ConfigCtrl),this.meta&&this.meta.includes){for(const i of this.meta.includes)if(i.type===t.ib.page&&i.component&&!g[i.component]){console.warn("App Page uses unknown component: ",i.component,this.meta);continue}}}get exposedComponentConfigs(){return this._exposedComponentConfigs}get addedComponentConfigs(){return this._addedComponentConfigs}get addedLinkConfigs(){return this._addedLinkConfigs}addLink(g){return this._addedLinkConfigs.push(g),this}addComponent(g){return this._addedComponentConfigs.push(g),this}exposeComponent(g){return this._exposedComponentConfigs.push(g),this}configureExtensionLink(g){return this.addLink({targets:[g.extensionPointId],...g}),this}configureExtensionComponent(g){return this.addComponent({targets:[g.extensionPointId],...g,component:g.component}),this}}var s=(a=>(a.alpha="alpha",a.beta="beta",a.experimental="experimental",a.privatePreview="private preview",a.preview="preview",a))(s||{})},61268:(_,L,e)=>{"use strict";e.d(L,{r:()=>t});var t=(n=>(n.OpenSource="Open Source",n.Pro="Pro",n.Enterprise="Enterprise",n))(t||{})},58649:(_,L,e)=>{"use strict";e.d(L,{En:()=>r,d1:()=>n,tw:()=>t});const t=0,n=100,r="SAML"},94624:(_,L,e)=>{"use strict";e.d(L,{y:()=>t});var t=(n=>(n[n.Off=0]="Off",n[n.Crosshair=1]="Crosshair",n[n.Tooltip=2]="Tooltip",n))(t||{})},39070:(_,L,e)=>{"use strict";e.d(L,{Gu:()=>t,Gv:()=>g,Nx:()=>n,UW:()=>r,zz:()=>s});var t=(i=>(i.NotStarted="NotStarted",i.Loading="Loading",i.Streaming="Streaming",i.Done="Done",i.Error="Error",i))(t||{});const n=["graph","table","logs","trace","nodeGraph","flamegraph","rawPrometheus"];var r=(i=>(i.Null="null",i.Ignore="connected",i.AsZero="null as zero",i))(r||{});const s=i=>!!i;function a(i){return i}function g(i){return typeof i=="object"&&i!==null?!0:!1}},41260:(_,L,e)=>{"use strict";e.d(L,{m:()=>t});var t=(n=>(n.TimeSeriesWide="timeseries-wide",n.TimeSeriesLong="timeseries-long",n.TimeSeriesMany="timeseries-many",n.TimeSeriesMulti="timeseries-multi",n.NumericWide="numeric-wide",n.NumericMulti="numeric-multi",n.NumericLong="numeric-long",n.LogLines="log-lines",n.DirectoryListing="directory-listing",n.HeatmapRows="heatmap-rows",n.HeatmapCells="heatmap-cells",n.Histogram="histogram",n))(t||{})},91890:(_,L,e)=>{"use strict";e.d(L,{$0:()=>r,CC:()=>n,uP:()=>s,x0:()=>t,yd:()=>a});var t=(g=>(g.Datasource="Datasource",g.Correlations="Correlations",g.ExploreCorrelationsEditor="CorrelationsEditor",g))(t||{}),n=(g=>(g.Regex="regex",g.Logfmt="logfmt",g))(n||{}),r=(g=>(g.Series="series",g.Field="field",g.Fields="fields",g.Value="value",g.BuiltIn="built-in",g.Template="template",g))(r||{}),s=(g=>(g.Values="values",g))(s||{}),a=(g=>(g.Action="action",g.Link="link",g.Off="off",g))(a||{})},40187:(_,L,e)=>{"use strict";e.d(L,{Is:()=>i,ZF:()=>a,mA:()=>s,tD:()=>r,v2:()=>g});var t=e(92341),n=e(43429);class r extends n.Ud{constructor(d){super(),this.DataSourceClass=d,this.components={}}setConfigEditor(d){return this.components.ConfigEditor=d,this}setConfigCtrl(d){return this.angularConfigCtrl=d,this}setQueryCtrl(d){return this.components.QueryCtrl=d,this}setAnnotationQueryCtrl(d){return this.components.AnnotationsQueryCtrl=d,this}setQueryEditor(d){return this.components.QueryEditor=d,this}setExploreQueryField(d){return this.components.ExploreQueryField=d,this}setExploreMetricsQueryField(d){return this.components.ExploreMetricsQueryField=d,this}setExploreLogsQueryField(d){return this.components.ExploreLogsQueryField=d,this}setQueryEditorHelp(d){return this.components.QueryEditorHelp=d,this}setExploreStartPage(d){return this.setQueryEditorHelp(d)}setVariableQueryEditor(d){return this.components.VariableQueryEditor=d,this}setMetadataInspector(d){return this.components.MetadataInspector=d,this}setComponentsFromLegacyExports(d){this.angularConfigCtrl=d.ConfigCtrl,this.components.QueryCtrl=d.QueryCtrl,this.components.AnnotationsQueryCtrl=d.AnnotationsQueryCtrl,this.components.ExploreQueryField=d.ExploreQueryField,this.components.QueryEditor=d.QueryEditor,this.components.QueryEditorHelp=d.QueryEditorHelp,this.components.VariableQueryEditor=d.VariableQueryEditor}}class s{constructor(d){this.name=d.name,this.id=d.id,this.type=d.type,this.meta=d.meta,this.cachingConfig=d.cachingConfig,this.uid=d.uid,this.apiVersion=d.apiVersion}filterQuery(d){return!0}getRef(){const d={type:this.type,uid:this.uid};return this.apiVersion&&(d.apiVersion=this.apiVersion),d}}var a=(l=>(l.Logs="Logs",l.Metrics="Metrics",l.Tracing="Tracing",l))(a||{}),g=(l=>(l.Cancelled="cancelled",l.Timeout="timeout",l.Unknown="unknown",l))(g||{});class i{}i=(0,t.Y)(i),s=(0,t.Y)(s)},37055:(_,L,e)=>{"use strict";e.d(L,{Ow:()=>n,ZW:()=>t,uo:()=>r});function t(s){return a=>"__systemRef"in a&&a.__systemRef===s}const n=s=>"__systemRef"in s&&typeof s.__systemRef=="string";var r=(s=>(s.Unit="unit",s.Min="min",s.Max="max",s.FieldMinMax="fieldMinMax",s.Decimals="decimals",s.DisplayName="displayName",s.NoValue="noValue",s.Thresholds="thresholds",s.Mappings="mappings",s.Links="links",s.Color="color",s.Filterable="filterable",s))(r||{})},19484:(_,L,e)=>{"use strict";e.d(L,{R:()=>t});var t=(n=>(n.Grid="grid",n.List="list",n))(t||{})},26272:(_,L,e)=>{"use strict";e.d(L,{Tq:()=>g,ee:()=>s,kb:()=>a,r1:()=>r});var t=e(89550),n=e(65463);const r={alertSuccess:(0,t.R)("alert-success"),alertWarning:(0,t.R)("alert-warning"),alertError:(0,t.R)("alert-error"),alertInfo:(0,t.R)("alert-info")},s={refresh:(0,t.R)("refresh"),componentDidMount:(0,t.R)("component-did-mount"),dataReceived:(0,t.R)("data-received"),dataError:(0,t.R)("data-error"),dataFramesReceived:(0,t.R)("data-frames-received"),dataSnapshotLoad:(0,t.R)("data-snapshot-load"),editModeInitialized:(0,t.R)("init-edit-mode"),initPanelActions:(0,t.R)("init-panel-actions"),initialized:(0,t.R)("panel-initialized"),panelTeardown:(0,t.R)("panel-teardown"),render:(0,t.R)("render")};class a extends n.x{static{this.type="graph-hover"}}class g extends n.a{constructor(){super(...arguments),this.payload={point:{}}}static{this.type="graph-hover-clear"}}},55004:(_,L,e)=>{"use strict";e.d(L,{Cz:()=>g,DG:()=>d,Qp:()=>u,Z7:()=>l,ZF:()=>r,aj:()=>o,ew:()=>a,jQ:()=>i,o4:()=>s,os:()=>n,qD:()=>t});var t=(c=>(c.DataSource="ds",c.Plugin="plugin",c.Grafana="grafana",c.Stream="stream",c))(t||{}),n=(c=>(c.DataStream="stream",c.DataFrame="frame",c.JSON="json",c))(n||{}),r=(c=>(c.Pending="pending",c.Connected="connected",c.Connecting="connecting",c.Disconnected="disconnected",c.Shutdown="shutdown",c.Invalid="invalid",c))(r||{}),s=(c=>(c.Status="status",c.Join="join",c.Leave="leave",c.Message="message",c))(s||{});function a(c){return c.type==="status"}function g(c){return c.type==="join"}function i(c){return c.type==="leave"}function l(c){return c.type==="message"}function d(c){if(c?.length){let p=c.trim().split("/");if(p.length>=3)return{scope:p[0],namespace:p[1],path:p.slice(2).join("/")}}}function o(c){return!!(c?.path&&c.namespace&&c.scope)}function u(c){if(!c.scope)return"";let p=c.scope;return!c.namespace||(p+="/"+c.namespace,!c.path)?p:p+"/"+c.path}},9557:(_,L,e)=>{"use strict";e.d(L,{$b:()=>t,Aj:()=>l,FP:()=>u,Nc:()=>d,Ol:()=>g,ZF:()=>a,_0:()=>c,_C:()=>s,cF:()=>i,s5:()=>n,tG:()=>r,wj:()=>o});var t=(p=>(p.emerg="critical",p.fatal="critical",p.alert="critical",p.crit="critical",p.critical="critical",p.warn="warning",p.warning="warning",p.err="error",p.eror="error",p.error="error",p.info="info",p.information="info",p.informational="info",p.notice="info",p.dbug="debug",p.debug="debug",p.trace="trace",p.unknown="unknown",p))(t||{});const n={0:"critical",1:"critical",2:"critical",3:"error",4:"warning",5:"info",6:"info",7:"debug"};var r=(p=>(p[p.Number=0]="Number",p[p.String=1]="String",p[p.LabelsMap=2]="LabelsMap",p[p.Error=3]="Error",p))(r||{}),s=(p=>(p.none="No de-duplication",p.exact="De-duplication of successive lines that are identical, ignoring ISO datetimes.",p.numbers="De-duplication of successive lines that are identical when ignoring numbers, e.g., IP addresses, latencies.",p.signature="De-duplication of successive lines that have identical punctuation and whitespace.",p))(s||{}),a=(p=>(p.Backward="BACKWARD",p.Forward="FORWARD",p))(a||{});const g=p=>!p||typeof p!="object"?!1:"getLogRowContext"in p;var i=(p=>(p.LogsVolume="LogsVolume",p.LogsSample="LogsSample",p))(i||{}),l=(p=>(p.FullRange="FullRange",p.Limited="Limited",p))(l||{});const d=(p,h)=>p?("getDataProvider"in p||"getSupplementaryRequest"in p)&&"getSupplementaryQuery"in p&&"getSupportedSupplementaryQueryTypes"in p&&p.getSupportedSupplementaryQueryTypes().includes(h):!1,o=p=>!p||typeof p!="object"?!1:"getLogRowContextUi"in p,u=p=>p!=null&&typeof p=="object"&&"toggleQueryFilter"in p&&"queryHasFilter"in p,c=p=>p!=null&&typeof p=="object"&&"modifyQuery"in p&&"getSupportedQueryModifications"in p},64388:(_,L,e)=>{"use strict";e.d(L,{k:()=>t});var t=(n=>(n[n.Standard=0]="Standard",n[n.Canvas=1]="Canvas",n[n.Custom=2]="Custom",n))(t||{})},47070:(_,L,e)=>{"use strict";e.d(L,{NV:()=>i,nQ:()=>a,v2:()=>g,wV:()=>s});var t=e(2543),n=e.n(t),r=e(11261),s=(l=>(l.Auto="auto",l.Vertical="vertical",l.Horizontal="horizontal",l))(s||{}),a=(l=>(l[l.Best=100]="Best",l[l.Good=70]="Good",l[l.OK=50]="OK",l))(a||{});class g{constructor(d,o){this.list=[],this.data=d,this.panel=o,this.dataSummary=this.computeDataSummary()}getListAppender(d){return new i(this.list,d)}computeDataSummary(){const d=this.data?.series||[];let o=0,u=0,c=0,p=0,h=0,y=0,f;for(const v of d){p+=v.length,v.meta?.preferredVisualisationType&&(f=v.meta.preferredVisualisationType);for(const P of v.fields)switch(y++,P.type){case r.PU.number:o+=1;break;case r.PU.time:u+=1;break;case r.PU.string:c+=1;break}v.length>h&&(h=v.length)}return{numberFieldCount:o,timeFieldCount:u,stringFieldCount:c,rowCountTotal:p,rowCountMax:h,fieldCount:y,preferredVisualisationType:f,frameCount:d.length,hasData:p>0,hasTimeField:u>0,hasNumberField:o>0,hasStringField:c>0}}getList(){return this.list}}class i{constructor(d,o){this.list=d,this.defaults=o}append(d){this.list.push((0,t.defaultsDeep)(d,this.defaults))}}},74135:(_,L,e)=>{"use strict";e.d(L,{S:()=>n,u:()=>t});var t=(r=>(r.link="link",r.component="component",r))(t||{}),n=(r=>(r.AlertInstanceAction="grafana/alerting/instance/action",r.AlertingHomePage="grafana/alerting/home",r.AlertingAlertingRuleAction="grafana/alerting/alertingrule/action",r.AlertingRecordingRuleAction="grafana/alerting/recordingrule/action",r.CommandPalette="grafana/commandpalette/action",r.DashboardPanelMenu="grafana/dashboard/panel/menu",r.DataSourceConfig="grafana/datasources/config",r.ExploreToolbarAction="grafana/explore/toolbar/action",r.UserProfileTab="grafana/user/profile/tab",r))(n||{})},51527:(_,L,e)=>{"use strict";e.d(L,{x:()=>n});var t=e(43429);function n(r){return r&&r!==t.Ac.valid&&r!==t.Ac.internal}},73372:(_,L,e)=>{"use strict";e.d(L,{D_:()=>t,Ee:()=>r,FL:()=>n});var t=(s=>(s.Equal="Equal",s.NotEqual="NotEqual",s.EqualRegEx="EqualRegEx",s.NotEqualRegEx="NotEqualRegEx",s))(t||{});const n=s=>!s||typeof s!="object"?!1:"importFromAbstractQueries"in s,r=s=>!s||typeof s!="object"?!1:"exportToAbstractQueries"in s},37891:(_,L,e)=>{"use strict";e.d(L,{n:()=>t});const t={"=":"equals","!=":"not-equals","=~":"regex-match","!~":"regex-not-match","=|":"one-of","!=|":"not-one-of"}},12470:(_,L,e)=>{"use strict";e.d(L,{CO:()=>t,ZG:()=>n,zL:()=>r});var t=(s=>(s[s.never=0]="never",s[s.onDashboardLoad=1]="onDashboardLoad",s[s.onTimeRangeChanged=2]="onTimeRangeChanged",s))(t||{}),n=(s=>(s[s.disabled=0]="disabled",s[s.alphabeticalAsc=1]="alphabeticalAsc",s[s.alphabeticalDesc=2]="alphabeticalDesc",s[s.numericalAsc=3]="numericalAsc",s[s.numericalDesc=4]="numericalDesc",s[s.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",s[s.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",s[s.naturalAsc=7]="naturalAsc",s[s.naturalDesc=8]="naturalDesc",s))(n||{}),r=(s=>(s[s.dontHide=0]="dontHide",s[s.hideLabel=1]="hideLabel",s[s.hideVariable=2]="hideVariable",s))(r||{})},50082:(_,L,e)=>{"use strict";e.d(L,{O:()=>t});var t=(n=>(n.Absolute="absolute",n.Percentage="percentage",n))(t||{})},81010:(_,L,e)=>{"use strict";e.d(L,{M:()=>t,N:()=>n});var t=(r=>(r[r.NotPossible=-1]="NotPossible",r[r.NotApplicable=0]="NotApplicable",r[r.Applicable=1]="Applicable",r[r.HighlyApplicable=2]="HighlyApplicable",r))(t||{}),n=(r=>(r.True="true",r.False="false",r.Null="null",r.Empty="empty",r))(n||{})},25019:(_,L,e)=>{"use strict";e.d(L,{W:()=>n,d:()=>t});var t=(r=>(r.ValueToText="value",r.RangeToText="range",r.RegexToText="regex",r.SpecialValue="special",r))(t||{}),n=(r=>(r.True="true",r.False="false",r.Null="null",r.NaN="nan",r.NullAndNaN="null+nan",r.Empty="empty",r))(n||{})},29505:(_,L,e)=>{"use strict";e.d(L,{J$:()=>r,Qz:()=>t,ZV:()=>a,f5:()=>s,xi:()=>n});var t=(g=>(g.Legacy="legacy",g.Standard="standard",g.Custom="custom",g.Datasource="datasource",g))(t||{});class n{}class r extends n{getType(){return"standard"}}class s extends n{getType(){return"custom"}}class a extends n{getType(){return"datasource"}}},35853:(_,L,e)=>{"use strict";e.d(L,{V:()=>t});function t(){Object.getOwnPropertyDescriptor(Array.prototype,"toArray")||Object.defineProperties(Array.prototype,{get:{value:function(n){return this[n]},writable:!0,enumerable:!1,configurable:!0},set:{value:function(n,r){this[n]=r},writable:!0,enumerable:!1,configurable:!0},add:{value:function(n){this.push(n)},writable:!0,enumerable:!1,configurable:!0},toArray:{value:function(){return this},writable:!0,enumerable:!1,configurable:!0}})}t()},7144:(_,L,e)=>{"use strict";e.d(L,{b:()=>s});var t=e(74848),n=e(96540),r=e(68941);const s=a=>{const{children:g,storageKey:i,defaultValue:l}=a,[d,o]=(0,n.useState)({value:r.M.getObject(a.storageKey,a.defaultValue)});(0,n.useEffect)(()=>{const p=h=>{h.key===i&&o({value:r.M.getObject(a.storageKey,a.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const u=p=>{try{r.M.setObject(i,p)}catch(h){console.error(h)}o({value:p})},c=()=>{try{r.M.delete(i)}catch(p){console.log(p)}o({value:l})};return(0,t.jsx)(t.Fragment,{children:g(d.value,u,c)})}},60264:(_,L,e)=>{"use strict";e.d(L,{bk:()=>i,pv:()=>o,iF:()=>d});var t=e(2543),n=e(27310),r=e(69550),s=e(83077);class a{constructor(){this.properties=[]}addCustomEditor(c){return this.properties.push(c),this}getRegistry(){return new s.O(()=>this.properties)}getItems(){return this.properties}}var g=e(39070);class i extends a{addNumberInput(c){return this.addCustomEditor({...c,id:c.path,override:r.D.get("number").editor,editor:r.D.get("number").editor,process:n.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,override:r.D.get("slider").editor,editor:r.D.get("slider").editor,process:n.m0,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,override:r.D.get("text").editor,editor:r.D.get("text").editor,process:n.OU,shouldApply:c.shouldApply??(()=>!0),settings:c.settings||{}})}addSelect(c){return this.addCustomEditor({...c,id:c.path,override:r.D.get("select").editor,editor:r.D.get("select").editor,process:n.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addRadio(c){return this.addCustomEditor({...c,id:c.path,override:r.D.get("radio").editor,editor:r.D.get("radio").editor,process:n.hL,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{options:[]}})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("boolean").editor,override:r.D.get("boolean").editor,process:n.FM,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("color").editor,override:r.D.get("color").editor,process:n.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("unit").editor,override:r.D.get("unit").editor,process:n.lG,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("field-name").editor,override:r.D.get("field-name").editor,process:n.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}addGenericEditor(c,p){return this.addCustomEditor({...c,id:c.path,editor:p,override:p,process:n.hS,shouldApply:c.shouldApply?c.shouldApply:()=>!0,settings:c.settings||{}})}}class l{constructor(c){this.cfg=c,this.path="",this.id="nested-panel-options",this.name="nested",this.editor=()=>null,this.getBuilder=()=>this.cfg.build,this.getNestedValueAccess=p=>{const h=this.cfg.values;return h?h(p):{getValue:y=>p.getValue(`${this.path}.${y}`),onChange:(y,f)=>p.onChange(`${this.path}.${y}`,f)}},this.path=c.path,this.category=c.category,this.defaultValue=this.getDefaultValue(c)}getDefaultValue(c){let p=(0,g.Gv)(c.defaultValue)?(0,t.cloneDeep)(c.defaultValue):{};const h=new o;c.build(h,{data:[]});for(const y of h.getItems())y.defaultValue!=null&&(0,t.set)(p,y.path,y.defaultValue);return p}}function d(u){return(0,g.Gv)(u)&&"id"in u&&u.id==="nested-panel-options"}class o extends a{addNestedOptions(c){const p=new l(c);return this.addCustomEditor(p)}addNumberInput(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("number").editor})}addSliderInput(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("slider").editor})}addTextInput(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("text").editor})}addStringArray(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("strings").editor})}addSelect(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("select").editor})}addMultiSelect(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("multi-select").editor})}addRadio(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("radio").editor})}addBooleanSwitch(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("boolean").editor})}addColorPicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("color").editor,settings:c.settings||{}})}addTimeZonePicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("timezone").editor,settings:c.settings||{}})}addUnitPicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("unit").editor})}addFieldNamePicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("field-name").editor})}addDashboardPicker(c){return this.addCustomEditor({...c,id:c.path,editor:r.D.get("dashboard-uid").editor})}}},28802:(_,L,e)=>{"use strict";e.d(L,{t:()=>r});var t=e(2543),n=e.n(t);function r(s){return typeof s=="number"?s:s===""||s===null||s===void 0||Array.isArray(s)?NaN:typeof s=="boolean"?s?1:0:(0,t.toNumber)(s)}},14588:(_,L,e)=>{"use strict";e.r(L),e.d(L,{insertAfterImmutably:()=>s,insertBeforeImmutably:()=>r,moveItemImmutably:()=>n,sortValues:()=>i});var t=e(52622);function n(l,d,o){const u=[...l];return Array.prototype.splice.call(u,o,0,Array.prototype.splice.call(u,d,1)[0]),u}function r(l,d,o){if(o<0||o>l.length)throw new Error("Index out of bounds");const u=[...l];return u.splice(o,0,d),u}function s(l,d,o){if(o<0||o>l.length)throw new Error("Index out of bounds");const u=[...l];return u.splice(o+1,0,d),u}const a=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),g=(l,d)=>l-d;function i(l){return(d,o)=>{if(d===o)return 0;if(o==null||typeof o=="string"&&o.trim()==="")return-1;if(d==null||typeof d=="string"&&d?.trim()==="")return 1;let u=a.compare;return typeof d=="number"&&typeof o=="number"&&(u=g),l===t.xB.Descending?u(o,d):u(d,o)}}},11710:(_,L,e)=>{"use strict";e.d(L,{b:()=>r,k:()=>n});var t=e(83077),n=(s=>(s.Add="+",s.Subtract="-",s.Divide="/",s.Multiply="*",s))(n||{});const r=new t.O(()=>[{id:"+",name:"Add",operation:(s,a)=>s+a,binaryOperationID:"+"},{id:"-",name:"Subtract",operation:(s,a)=>s-a,binaryOperationID:"-"},{id:"*",name:"Multiply",operation:(s,a)=>s*a,binaryOperationID:"*"},{id:"/",name:"Divide",operation:(s,a)=>s/a,binaryOperationID:"/"}])},72436:(_,L,e)=>{"use strict";e.d(L,{F7:()=>o,Jh:()=>u,_O:()=>P,i8:()=>p});var t=e(2543),n=e.n(t),r=e(44809),s=e.n(r),a=e(37471),g=e(14236),i=e(28240),l=e(11261),d=e(83195),o=(m=>(m[m.full=0]="full",m[m.name=1]="name",m[m.none=2]="none",m))(o||{});function u(m,D){return new p(D).readCSV(m)}var c=(m=>(m[m.Starting=0]="Starting",m[m.InHeader=1]="InHeader",m[m.ReadingRows=2]="ReadingRows",m))(c||{});class p{constructor(D){this.chunk=(x,E)=>{for(let C=0;C<x.data.length;C++){const b=x.data[C];if(b.length<1)continue;const T=b[0];if(T){if(T.startsWith("#")){const A=T.indexOf("#",2);if(A>0){const R=T.slice(1,A),S=R==="name";if(S||{unit:"#"}.hasOwnProperty(R)){this.state===2&&(this.current=new a.k({fields:[]}),this.data.push(this.current));const j=T.slice(A+1);if(S){this.current.addFieldFor(void 0,j);for(let B=1;B<b.length;B++)this.current.addFieldFor(void 0,b[B])}else{const{fields:B}=this.current;for(let N=0;N<B.length;N++){B[N].config||(B[N].config={});const I=B[N].config;I[R]=N===0?j:b[N]}}this.state=1;continue}}else if(this.state===0){this.state=1;continue}continue}if(this.state===0){if((0,g.HW)(T)===l.PU.string){for(const R of b)this.current.addFieldFor(void 0,R);this.state=1;continue}this.state=1}}if(this.state,this.state=2,b.length>this.current.fields.length){const{fields:A}=this.current;for(let R=A.length;R<b.length;R++)this.current.addFieldFor(b[R]);this.callback&&this.callback.onHeader(this.current.fields)}this.current.appendRow(b),this.callback&&this.callback.onRow(b)}},D||(D={}),this.config=D.config||{},this.callback=D.callback,this.current=new a.k({fields:[]}),this.state=0,this.data=[]}readCSV(D){this.current=new a.k({fields:[]}),this.data=[this.current];const x={...this.config,dynamicTyping:!1,skipEmptyLines:!0,comments:!1,chunk:this.chunk};return s().parse(D,x),this.data}}function h(m,D){if(m==null)return"";const x=m.toString();return x.includes('"')?D.quoteChar+x.replace(/"/gi,'""')+D.quoteChar:x.includes(`
`)||D.delimiter&&x.includes(D.delimiter)?D.quoteChar+x+D.quoteChar:x}function y(m,D){return m.display?x=>{const E=m.display(x);return h((0,d.cN)(E),D)}:x=>h(x,D)}function f(m,D,x){const E=m==="name",C=m==="type";for(const b of D){const T=b.config;if(E||C||T&&T.hasOwnProperty(m)){let A="#"+m+"#";for(let R=0;R<D.length;R++){R>0&&(A=A+x.delimiter);let S=D[R].name;C?S=D[R].type:E||(S=D[R].config[m]),S&&(A=A+h(S,x))}return A+x.newline}}return""}function v(){const m=["x","y"];return m.toLocaleString?m.toLocaleString().charAt(1):","}function P(m,D){if(!m)return"";D=(0,t.defaults)(D,{delimiter:v(),newline:`\r
`,quoteChar:'"',encoding:"",headerStyle:1,useExcelHeader:!1});let x=D.useExcelHeader?`sep=${D.delimiter}${D.newline}`:"";for(let E=0;E<m.length;E++){const C=m[E],{fields:b}=C;if(b.length===0)continue;if(D.headerStyle===0)x=x+f("name",b,D)+f("type",b,D)+f("unit",b,D)+f("dateFormat",b,D);else if(D.headerStyle===1){for(let A=0;A<b.length;A++)A>0&&(x+=D.delimiter),x+=`"${(0,i.Ct)(b[A],C).replace(/"/g,'""')}"`;x+=D.newline}const T=b[0].values.length;if(T>0){const A=b.map(R=>y(R,D));for(let R=0;R<T;R++){for(let S=0;S<b.length;S++){S>0&&(x=x+D.delimiter);let O=b[S].values[R];b[S].type===l.PU.frame&&b[S].values[R].value&&(O=b[S].values[R].value),O!==null&&(x=x+A[S](O))}R!==T-1&&(x=x+D.newline)}}E!==m.length-1&&(x=x+D.newline)}return x}},6709:(_,L,e)=>{"use strict";e.d(L,{c:()=>r,u:()=>s});var t=e(71733),n=e(76885);const r={keepTime:"__url_time_range",timeRangeFrom:"__from",timeRangeTo:"__to",includeVars:"__all_variables",seriesName:"__series.name",fieldName:"__field.name",valueTime:"__value.time",valueNumeric:"__value.numeric",valueText:"__value.text",valueRaw:"__value.raw",valueCalc:"__value.calc"};function s(l){const{onClickFn:d,replaceVariables:o,link:u,scopedVars:c,range:p,field:h,internalLink:y}=l,f=g(u.internal?.query,c,o),v=g(u.internal?.panelsState,c,o),P=g(u.meta?.correlationData,c,o),m=u.title?u.title:y.datasourceName;return{title:o(m,c),href:a(y.datasourceUid,f,p,v),onClick:d?D=>{D.preventDefault&&D.preventDefault(),d({datasourceUid:y.datasourceUid,queries:[f],panelsState:v,correlationHelperData:P,range:p})}:void 0,target:u?.targetBlank?"_blank":"_self",origin:h}}function a(l,d,o,u){return t.I.assureBaseUrl(`/explore?left=${encodeURIComponent((0,n.Pp)({...o?.raw?{range:(0,n.sQ)(o.raw)}:{},datasource:l,queries:[d],panelsState:u}))}`)}function g(l,d,o){if(!l)return l;if(typeof l=="string")return o(l,d);const u=JSON.parse(JSON.stringify(l));return i(u,d,o)}function i(l,d,o){for(const u of Object.keys(l))typeof l[u]=="string"?l[u]=o(l[u],d):typeof l[u]=="object"&&l[u]!==null&&(l[u]=i(l[u],d,o));return l}},22391:(_,L,e)=>{"use strict";e.d(L,{BD:()=>d,EX:()=>o,Iz:()=>a,PG:()=>i,QP:()=>f,fN:()=>s,lO:()=>h,mn:()=>l,p$:()=>r,pN:()=>p,wY:()=>u,wp:()=>y,yV:()=>c,zX:()=>g});var t=e(2543),n=e.n(t);function r(v){const P={uid:v.uid,type:v.type};return v.apiVersion&&(P.apiVersion=v.apiVersion),P}function s(v){return typeof v=="object"&&typeof v?.uid=="string"}function a(v){if(s(v))return v.uid;if((0,t.isString)(v))return v}const g=(v,P)=>m=>{p(v,P,m.currentTarget.value)},i=(v,P)=>m=>{h(v,P,m.currentTarget.value)},l=(v,P)=>m=>{y(v,P,m.currentTarget.value)},d=(v,P)=>m=>{h(v,P,m.value)},o=(v,P)=>m=>{h(v,P,m.currentTarget.checked)},u=(v,P)=>m=>{y(v,P,m.value)},c=(v,P)=>m=>{f(v,P)};function p(v,P,m){const D=v.options;v.onOptionsChange({...D,[P]:m})}const h=(v,P,m)=>{const D=v.options;v.onOptionsChange({...D,jsonData:{...D.jsonData,[P]:m}})},y=(v,P,m)=>{const D=v.options;v.onOptionsChange({...D,secureJsonData:{...D.secureJsonData?D.secureJsonData:{},[P]:m}})},f=(v,P)=>{const m=v.options;v.onOptionsChange({...m,secureJsonData:{...m.secureJsonData?m.secureJsonData:{},[P]:""},secureJsonFields:{...m.secureJsonFields,[P]:!1}})}},87885:(_,L,e)=>{"use strict";e.d(L,{f:()=>t});var t=(n=>(n[n.Transformations=0]="Transformations",n[n.FieldConfig=1]="FieldConfig",n[n.FieldConfigOverrides=2]="FieldConfigOverrides",n))(t||{})},39306:(_,L,e)=>{"use strict";e.d(L,{R:()=>n,r:()=>r});var t=e(39070);function n({xField:s,yField:a,nullValueMode:g}){const i=s.values,l=a.values,d=i.length;if(l.length!==d)throw new Error("Unexpected field length");const o=g===t.UW.Ignore,u=g===t.UW.AsZero,c=[];for(let p=0;p<d;p++){const h=i[p];let y=l[p];if(y===null){if(o)continue;u&&(y=0)}h!==null&&c.push([h,y])}return c}function r(s,a){if(!a.from||!a.to||!s||s.length===0)return[];const g=a.from.valueOf(),i=a.to.valueOf(),l=s[0][1];return[[g,l],[i,l]]}},8249:(_,L,e)=>{"use strict";e.d(L,{Xy:()=>n,_p:()=>a,h6:()=>g,s6:()=>s,yO:()=>r});const t=/\b(\w+)(!?=~?)"([^"\n]*?)"/g;function n(i){const l={};return i.replace(t,(d,o,u,c)=>(l[o]=c,"")),l}function r(i){return i.reduce((l,d)=>{if(!d)throw new Error("Need parsed labels to find common labels.");return Object.keys(d).forEach(o=>{(l[o]===void 0||l[o]!==d[o])&&delete l[o]}),Object.keys(l).forEach(o=>{d[o]===void 0&&delete l[o]}),l},{...i[0]})}function s(i,l){const d={...i};return Object.keys(l).forEach(o=>{delete d[o]}),d}function a(i,l){if(!i)return!0;for(const[d,o]of Object.entries(i))if(!l||l[d]!==o)return!1;return!0}function g(i,l="",d){if(!i||Object.keys(i).length===0)return l;const u=Object.keys(i).sort().map(c=>`${c}="${i[c]}"`).join(", ");return d?u:["{",u,"}"].join("")}},71733:(_,L,e)=>{"use strict";e.d(L,{I:()=>u});var t=e(80997),n=e(76885);let r={appSubUrl:""},s,a;const g=c=>{try{return new URL(c)}catch{return}},i=c=>{const p=g(c);if(p&&p.origin!==window.location.origin)return c;const h=r.appSubUrl??"",y=h.endsWith("/")?1:0,f=c.startsWith("http");let v=h;return(!c.startsWith("/")||f)&&(v=`${window.location.origin}${h}`),c.length>0&&(c.indexOf(v+"/")===0||c===v)?c.slice(v.length-y):c},l=c=>c.startsWith("/")?`${r.appSubUrl}${i(c)}`:c,u={initialize:c=>{r=c.config,s=c.getTimeRangeForUrl,a=c.getVariablesUrlParams},stripBaseFromUrl:i,assureBaseUrl:l,updateSearchParams:(c,p)=>{const h=new URLSearchParams(p);try{const y=new URL(c);return h.forEach((f,v)=>y.searchParams.set(v,f)),y.href}catch{const y=new URLSearchParams(c);return h.forEach((f,v)=>{y.set(v,f)}),"?"+y.toString()}},getTimeRangeUrlParams:()=>s?n.kM.toUrlParams(s()):null,getVariablesUrlParams:c=>{if(!a)return null;const p=a(c);return n.kM.toUrlParams(p)},getUrlForPartial:(c,p)=>{const h=n.kM.parseKeyValue(c.search.startsWith("?")?c.search.substring(1):c.search);for(const y in p)p[y]===null||p[y]===void 0?delete h[y]:h[y]=p[y];return l(n.kM.renderUrl(c.pathname,h))},processUrl:c=>r.disableSanitizeHtml?c:t.sQ.sanitizeUrl(c)}},92341:(_,L,e)=>{"use strict";e.d(L,{Y:()=>t});function t(n){return new Proxy(n,{apply(r,s,a){return(typeof Reflect>"u"||!Reflect.construct)&&alert("Browser is too old"),Reflect.construct(r,a,s.constructor)}})}},80147:(_,L,e)=>{"use strict";e.d(L,{_:()=>t});function t(n,r){return r.id===n?!0:r.aliasIDs?r.aliasIDs.includes(n):!1}},25352:(_,L,e)=>{"use strict";e.d(L,{u:()=>t});var t=(n=>(n.id="id",n.title="title",n.subTitle="subtitle",n.mainStat="mainstat",n.secondaryStat="secondarystat",n.arc="arc__",n.icon="icon",n.color="color",n.source="source",n.target="target",n.detail="detail__",n.nodeRadius="noderadius",n.thickness="thickness",n.highlighted="highlighted",n.strokeDasharray="strokedasharray",n.fixedX="fixedx",n.fixedY="fixedy",n))(t||{})},97706:(_,L,e)=>{"use strict";e.d(L,{E:()=>n,h:()=>t});function t(r,s=0){if(Number.isInteger(r))return r;let a=10**s,g=r*a*(1+Number.EPSILON);return Math.round(g)/a}function n(r){return((""+r).split(".")[1]||"").length}},92041:(_,L,e)=>{"use strict";e.d(L,{R:()=>n,w:()=>t});const t=r=>Object.keys(r).reduce((s,a)=>(r[a]!==void 0&&(s[a]=r[a]),s),{}),n=r=>typeof r=="object"&&r!==null&&Object.keys(r).length===0},68941:(_,L,e)=>{"use strict";e.d(L,{M:()=>n});class t{get(s){return window.localStorage[s]}set(s,a){window.localStorage[s]=a}getBool(s,a){return a!==void 0&&!this.exists(s)?a:window.localStorage[s]==="true"}getObject(s,a){let g=a;if(this.exists(s)){const i=window.localStorage[s];try{g=JSON.parse(i)}catch(l){console.error(`Error parsing store object: ${s}. Returning default: ${a}. [${l}]`)}}return g}setObject(s,a){let g;try{g=JSON.stringify(a)}catch(i){throw new Error(`Could not stringify object: ${s}. [${i}]`)}try{this.set(s,g)}catch(i){const l=new Error(`Could not save item in localStorage: ${s}. [${i}]`);throw i instanceof Error&&(l.name=i.name),l}return!0}exists(s){return window.localStorage[s]!==void 0}delete(s){window.localStorage.removeItem(s)}}const n=new t},27618:(_,L,e)=>{"use strict";e.d(L,{_:()=>n,j:()=>r});var t=e(83077),n=(s=>(s.Abs="abs",s.Exp="exp",s.Ln="ln",s.Floor="floor",s.Ceil="ceil",s))(n||{});const r=new t.O(()=>[{id:"abs",name:"Absolute value",operation:s=>Math.abs(s),unaryOperationID:"abs"},{id:"exp",name:"Natural exponent",operation:s=>Math.exp(s),unaryOperationID:"exp"},{id:"ln",name:"Natural logarithm",operation:s=>Math.log(s),unaryOperationID:"ln"},{id:"floor",name:"Floor",operation:s=>Math.floor(s),unaryOperationID:"floor"},{id:"ceil",name:"Ceiling",operation:s=>Math.ceil(s),unaryOperationID:"ceil"}])},76885:(_,L,e)=>{"use strict";e.d(L,{Pp:()=>u,kM:()=>o,sQ:()=>c});var t=e(47232);/**
 * @preserve jquery-param (c) 2015 KNOWLEDGECODE | MIT
 */function n(p,h){return h&&Object.keys(h).length>0&&(p+="?"+s(h)),p}function r(p,h){return encodeURIComponent(p).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,h?"%20":"+").replace(/[!'()*]/g,function(y){return"%"+y.charCodeAt(0).toString(16).toUpperCase()})}function s(p,h=!0){const y=[],f=/\[\]$/,v=h?(x,E)=>r(x,E):(x,E)=>encodeURIComponent(x),P=x=>Object.prototype.toString.call(x)==="[object Array]",m=(x,E)=>{if(E=typeof E=="function"?E():E===null||E===void 0?"":E,typeof E!="boolean")y[y.length]=v(x,!0)+"="+v(E,!0);else{const C=E?"":"="+v("false",!0);y[y.length]=v(x,!0)+C}},D=(x,E)=>{let C,b,T;if(x)if(P(E))for(C=0,b=E.length;C<b;C++)f.test(x)?m(x,E[C]):D(x,E[C]);else if(E&&String(E)==="[object Object]")for(T in E)D(x+"["+T+"]",E[T]);else m(x,E);else if(P(E))for(C=0,b=E.length;C<b;C++)m(E[C].name,E[C].value);else for(T in E)D(T,E[T]);return y};return D("",p).join("&")}function a(p){return s(p,!1)}function g(p,h){if(h!=null&&h!==""){const y=p.indexOf("?");y!==-1?p.length-y>1&&(p+="&"):p+="?",p+=h}return p}function i(){const h=window.location.search.substring(1).split("&"),y={};for(const f of h){const v=f.split("=");if(v.length>1){const P=decodeURIComponent(v[0]),m=decodeURIComponent(v[1]);P in y?y[P]=[...y[P],m]:y[P]=[m]}else if(v.length===1){const P=decodeURIComponent(v[0]);y[P]=!0}}return y}function l(p){const h={},y=(p||"").split("&");for(let f of y){let v,P,m;if(f&&(P=f=f.replace(/\+/g,"%20"),v=f.indexOf("="),v!==-1&&(P=f.substring(0,v),m=f.substring(v+1)),P=d(P),P!==void 0)){m=m!==void 0?d(m):!0;let D;typeof m=="string"&&m!==""?D=m==="true"||m==="false"?m==="true":m:D=m,h.hasOwnProperty(P)?Array.isArray(h[P])?h[P].push(m):h[P]=[h[P],isNaN(D)?m:D]:h[P]=isNaN(D)?m:D}}return h}function d(p){try{return decodeURIComponent(p)}catch{return}}const o={renderUrl:n,toUrlParams:s,appendQueryToUrl:g,getUrlSearchParams:i,parseKeyValue:l,serializeParams:a};function u(p,h){return h!==void 0&&console.warn("`compact` parameter is deprecated and will be removed in a future release"),JSON.stringify(p)}const c=p=>{let h=p.from;(0,t.Ar)(h)&&(h=h.valueOf().toString());let y=p.to;return(0,t.Ar)(y)&&(y=y.valueOf().toString()),{from:h,to:y}}},62398:(_,L,e)=>{"use strict";e.d(L,{An:()=>g,Zz:()=>s,bh:()=>i});var t=e(47737),n=e(54479),r=e(25019);function s(d,o){for(const u of d)switch(u.type){case r.d.ValueToText:if(o==null)continue;const c=u.options[o];if(c)return c;break;case r.d.RangeToText:if(o==null)continue;const p=parseFloat(o);if(isNaN(p)||!isNaN(u.options.from)&&p<u.options.from||!isNaN(u.options.to)&&p>u.options.to)continue;return u.options.result;case r.d.RegexToText:if(o==null||typeof o!="string")continue;const f=(0,n.dO)(u.options.pattern);if(o.match(f)){const v={...u.options.result};return v.text!=null&&(v.text=o.replace(f,u.options.result.text||"")),v}case r.d.SpecialValue:switch(u.options.match){case r.W.Null:{if(o==null)return u.options.result;break}case r.W.NaN:{if(typeof o=="number"&&isNaN(o))return u.options.result;break}case r.W.NullAndNaN:{if(typeof o=="number"&&isNaN(o)||o==null)return u.options.result;break}case r.W.True:{if(o===!0||o==="true")return u.options.result;break}case r.W.False:{if(o===!1||o==="false")return u.options.result;break}case r.W.Empty:{if(o==="")return u.options.result;break}}}return null}function a(d){return(typeof d=="number"||typeof d=="string"&&d.trim()!=="")&&!isNaN(d)}var g=(d=>(d[d.ValueToText=1]="ValueToText",d[d.RangeToText=2]="RangeToText",d))(g||{});function i(d,o){const u=[];let c=d.mappingType;if(d.mappingType||(d.valueMaps&&d.valueMaps.length?c=1:d.rangeMaps&&d.rangeMaps.length&&(c=2)),c===1)for(let p=0;p<d.valueMaps.length;p++){const h=d.valueMaps[p];u.push(l({...h,id:p,type:r.d.ValueToText},d.fieldConfig?.defaults?.thresholds||o))}else if(c===2)for(let p=0;p<d.rangeMaps.length;p++){const h=d.rangeMaps[p];u.push(l({...h,id:p,type:r.d.RangeToText},d.fieldConfig?.defaults?.thresholds||o))}return u}function l(d,o){const u={type:r.d.ValueToText,options:{}},c=[];let p;const h=parseFloat(d.text);if(o&&!isNaN(h)){const y=(0,t.yQ)(h,o.steps);y&&y.color&&(p=y.color)}switch(d.type){case 1:case r.d.ValueToText:d.value!=null&&(d.value==="null"?c.push({type:r.d.SpecialValue,options:{match:r.W.Null,result:{text:d.text,color:p}}}):u.options[String(d.value)]={text:d.text,color:p});break;case 2:case r.d.RangeToText:d.from==="null"||d.to==="null"?c.push({type:r.d.SpecialValue,options:{match:r.W.Null,result:{text:d.text,color:p}}}):c.push({type:r.d.RangeToText,options:{from:+d.from,to:+d.to,result:{text:d.text,color:p}}});break}return Object.keys(u.options).length>0&&c.unshift(u),c[0]}},92053:(_,L,e)=>{"use strict";e.d(L,{E:()=>n,c:()=>r});const t="__searchFilter",n=s=>s&&typeof s=="string"?s.indexOf(t)!==-1:!1,r=s=>{const{query:a,wildcardChar:g}=s;if(!n(a))return{};let{options:i}=s;return i=i||{searchFilter:""},{__searchFilter:{value:i.searchFilter?`${i.searchFilter}${g}`:`${g}`,text:""}}}},72495:(_,L,e)=>{"use strict";e.d(L,{k:()=>a});var t=e(44240),n=e(39697),r=e(65961),s=e(67791);function a({whileLoading:g,source:i}){return(0,t.h)((0,n.O)(200).pipe((0,r.u)(g),(0,s.Q)(i)),i)}},36120:(_,L,e)=>{"use strict";e.d(L,{$:()=>n});var t=e(18008);class n extends t.F{constructor(s){return super(),this.buffer=s.buffer||[],this.capacity=this.buffer.length,this.tail=s.append!=="head",this.index=0,this.add=this.getAddFunction(),s.capacity&&this.setCapacity(s.capacity),new Proxy(this,{get(a,g,i){if(typeof g!="symbol"){const l=+g;if(String(l)===g)return a.get(l)}return Reflect.get(a,g,i)},set(a,g,i,l){if(typeof g!="symbol"){const d=+g;if(String(d)===g)return a.set(d,i),!0}return Reflect.set(a,g,i,l)}})}getAddFunction(){return this.capacity>this.buffer.length?this.tail?s=>{this.buffer.push(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:s=>{this.buffer.unshift(s),this.buffer.length>=this.capacity&&(this.add=this.getAddFunction())}:this.tail?s=>{this.buffer[this.index]=s,this.index=(this.index+1)%this.buffer.length}:s=>{let a=this.index-1;a<0&&(a=this.buffer.length-1),this.buffer[a]=s,this.index=a}}setCapacity(s){if(this.capacity===s)return;const a=this.toArray();if(s>this.length)this.buffer=a;else if(s<this.capacity){const g=this.length-s;this.tail?this.buffer=a.slice(g,a.length):this.buffer=a.slice(0,a.length-g)}this.capacity=s,this.index=0,this.add=this.getAddFunction()}setAppendMode(s){const a=s!=="head";a!==this.tail&&(this.buffer=this.toArray().reverse(),this.index=0,this.tail=a,this.add=this.getAddFunction())}reverse(){return this.buffer.reverse()}get(s){return this.buffer[(s+this.index)%this.buffer.length]}set(s,a){this.buffer[(s+this.index)%this.buffer.length]=a}get length(){return this.buffer.length}}},18008:(_,L,e)=>{"use strict";e.d(L,{E:()=>a,F:()=>r});var t,n;class r{constructor(){this[t]={}}*iterator(){for(let i=0;i<this.length;i++)yield this.get(i)}set(i,l){throw"unsupported operation"}add(i){throw"unsupported operation"}push(...i){for(const l of i)this.add(l);return this.length}[(n=Symbol.iterator,t=Symbol.unscopables,n)](){return this.iterator()}forEach(i){return a(this).forEach(i)}map(i){return a(this).map(i)}filter(i){return a(this).filter(i)}at(i){return this.get(i)}toArray(){const i=new Array(this.length);for(let l=0;l<this.length;l++)i[l]=this.get(l);return i}join(i){return this.toArray().join(i)}toJSON(){return this.toArray()}pop(){throw new Error("Method not implemented.")}concat(...i){throw new Error("Method not implemented.")}reverse(){throw new Error("Method not implemented.")}shift(){throw new Error("Method not implemented.")}sort(i){throw new Error("Method not implemented.")}splice(i,l,...d){throw new Error("Method not implemented.")}unshift(...i){throw new Error("Method not implemented.")}fill(i,l,d){throw new Error("Method not implemented.")}copyWithin(i,l,d){throw new Error("Method not implemented.")}slice(i,l){return this.toArray().slice(i,l)}indexOf(i,l){return this.toArray().indexOf(i,l)}lastIndexOf(i,l){return this.toArray().lastIndexOf(i,l)}every(i,l){return this.toArray().every(i,l)}some(i,l){return this.toArray().some(i,l)}reduce(i,l){throw new Error("Method not implemented.")}reduceRight(i,l){throw new Error("Method not implemented.")}find(i,l){return this.toArray().find(i,l)}findIndex(i,l){return this.toArray().findIndex(i,l)}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.toArray().values()}includes(i,l){return this.toArray().includes(i,l)}flatMap(i,l){return this.toArray().flatMap(i,l)}flat(i){throw new Error("Method not implemented.")}}const s=[];function a(g){return{*[Symbol.iterator](){for(let i=0;i<g.length;i++)yield g.get(i)},forEach(i){for(let l=0;l<g.length;l++)i(g.get(l),l,s)},map(i){const l=[];for(let d=0;d<g.length;d++)l.push(i(g.get(d),d,s));return l},filter(i){const l=[];let d=0;for(const o of this)i(o,d++,s)&&l.push(o);return l}}}},80822:(_,L,e)=>{"use strict";e.d(L,{Wn:()=>a,_k:()=>s});var t=e(21423),n=e(41260),r=e(11261);function s(p,h){const y=a({data:p.series},{data:h.series}).data;return{...p,series:y}}function a(p,h){if(!p)return o(h);h.data.forEach(P=>{const m=p.data.find(D=>c(D,P));if(!m){p.data.push(u(P));return}g(m,P)});const y=[...p.errors??[],...h.errors??[]];y.length>0&&(p.errors=y);const f=p.error??h.error;f!=null&&(p.error=f);const v=[...p.traceIds??[],...h.traceIds??[]];return v.length>0&&(p.traceIds=v),p}function g(p,h){const y=Math.max(p.fields.length,h.fields.length);for(let f=0;f<y;f++){if(!p.fields[f])continue;const v=i(p.fields[f],h.fields,f);if(v&&(p.fields[f].values=[].concat.apply(v.values,p.fields[f].values),v.nanos)){const P=p.fields[f].nanos?.slice()||[];p.fields[f].nanos=h.fields[f].nanos?.concat(P)}}p.length+=h.length,p.meta={...p.meta,stats:d(p.meta?.stats??[],h.meta?.stats??[])}}function i(p,h,y){const f=h.filter(v=>v.name===p.name);return f.length===1?f[0]:p.labels?f.find(v=>(0,t.ab)(p.labels??{},v.labels??{})):h[y]}const l="Summary: total bytes processed";function d(p,h){const y=p.find(P=>P.displayName===l),f=h.find(P=>P.displayName===l);if(f!=null&&y!=null)return[{value:f.value+y.value,displayName:l,unit:y.unit}];const v=f??y;return v!=null?[v]:[]}function o(p){return{...p,data:p.data.map(u)}}function u(p){return{...p,fields:p.fields.map(h=>({...h,values:h.values}))}}function c(p,h){if(p.refId!==h.refId||p.name!==h.name)return!1;const y=p.meta?.type,f=h.meta?.type;if(y!==f)return!1;if(y===n.m.TimeSeriesMulti){const m=p.fields.find(x=>x.type===r.PU.number),D=h.fields.find(x=>x.type===r.PU.number);return m===void 0||D===void 0?!1:(0,t.ab)(m.labels??{},D.labels??{})}const v=p.meta?.custom?.frameType,P=h.meta?.custom?.frameType;return v==="LabeledTimeValues"&&P==="LabeledTimeValues"?!0:v===P}},80937:(_,L,e)=>{"use strict";e.d(L,{t:()=>s});var t=e(84555),n=e(32370),r=e(76040);function s(d,o,u,c="="){if(!o||!u)throw new Error("Need label to add to query.");const p=a(d);if(!p.length)return d;const h=g(o,u,c);return i(d,p,h)}function a(d){const o=t.K3.parse(d),u=[];return o.iterate({enter:({to:c,from:p,type:h})=>{if(h.id===t.Fb){const y=(0,r.u)(d.substring(p,c));return u.push({query:y.query,from:p,to:c}),!1}}}),u}function g(d,o,u){const c=o===1/0?"+Inf":o.toString();return{label:d,op:u,value:c}}function i(d,o,u){const c=new n.l;let p="",h=0;for(let y=0;y<o.length;y++){const f=o[y],v=y===o.length-1,P=d.substring(h,f.from),m=v?d.substring(f.to):"";l(f.query.labels,u)||f.query.labels.push(u);const D=c.renderQuery(f.query);p+=P+D+m,h=f.to}return p}function l(d,o){return d.find(u=>u.label===o.label&&u.value===o.value)}},7338:(_,L,e)=>{"use strict";e.d(L,{L:()=>ze});var t=e(74848),n=e(32196),r=e(96540),s=e(14236),a=e(7144),g=e(13544),i=e(14110),l=e(14578),d=e(55852),o=e(40845),u=e(81996),c=e(91396);function p(xe){return typeof xe=="object"&&xe!==null&&"isCanceled"in xe}const h=xe=>{let Oe=!1;return{promise:new Promise((Ze,qe)=>{const rt={isCanceled:!0};xe.then(vt=>Oe?qe(rt):Ze(vt)),xe.catch(vt=>qe(Oe?rt:vt))}),cancel(){Oe=!0}}};var y=e(84555),f=e(2543),v=e(75357),P=e(39554),m=e(62938),D=e(85828);function x(){const xe=new Map;return xe.set("expandSuggestionDocs","true"),{onDidChangeValue:Oe=>{},onDidChangeTarget:Oe=>{},onWillSaveState:Oe=>{},get:(Oe,Le,Ze)=>xe.get(Oe)??Ze,getBoolean:(Oe,Le,Ze)=>{const qe=xe.get(Oe);return qe!==void 0?qe==="true":Ze},getNumber:(Oe,Le,Ze)=>{const qe=xe.get(Oe);return qe!==void 0?parseInt(qe,10):Ze},store:(Oe,Le,Ze,qe)=>{Le==null?xe.delete(Oe):xe.set(Oe,Le.toString())},remove:(Oe,Le)=>{xe.delete(Oe)},keys:(Oe,Le)=>Array.from(xe.keys()),logStorage:()=>{console.log("logStorage: not implemented")},migrate:()=>Promise.resolve(void 0),isNew:Oe=>!0,flush:Oe=>Promise.resolve(void 0)}}let E=null;function C(){return E===null&&(E={storageService:x()}),E}var b=e(53076),T=e(32264),A=e(20719);class R extends Error{constructor(Oe){super("should never happen")}}const S=new b.A({intraMode:1});function O(xe){let Oe=xe.getAllMetricNames();if(T.$.featureToggles.prometheusCodeModeMetricNamesSearch&&Oe.length>xe.metricNamesSuggestionLimit){const{monacoSettings:Le}=xe;Le.enableAutocompleteSuggestionsUpdate(),Le.inputInRange?Oe=S.filter(Oe,Le.inputInRange)?.slice(0,xe.metricNamesSuggestionLimit).map(Ze=>Oe[Ze])??[]:Oe=Oe.slice(0,xe.metricNamesSuggestionLimit)}return xe.metricNamesToMetrics(Oe).map(Le=>({type:"METRIC_NAME",label:Le.name,insertText:Le.name,detail:`${Le.name} : ${Le.type}`,documentation:Le.help}))}const j=A.AW.map(xe=>({type:"FUNCTION",label:xe.label,insertText:xe.insertText??"",detail:xe.detail,documentation:xe.documentation}));async function B(xe){const Oe=O(xe);return[...j,...Oe]}const N=["$__interval","$__range","$__rate_interval","1m","5m","10m","30m","1h","1d"].map(xe=>({type:"DURATION",label:xe,insertText:xe}));function I(xe){return xe.getHistory().slice(0,10).map(Le=>({type:"HISTORY",label:Le,insertText:Le}))}function K(xe,Oe){const Le=[...Oe];return xe!==void 0&&Le.push({name:"__name__",value:xe,op:"="}),`{${Le.map(qe=>`${qe.name}${qe.op}"${(0,u.Qn)(qe.value)}"`).join(",")}}`}async function w(xe,Oe,Le){if(xe===void 0&&Oe.length===0)return Promise.resolve(Le.getAllLabelNames());{const Ze=K(xe,Oe);return await Le.getSeriesLabels(Ze,Oe)}}async function U(xe,Oe,Le,Ze,qe){return(await w(xe,Ze,qe)).map(vt=>({type:"LABEL_NAME",label:vt,insertText:`${vt}${Oe}`,triggerOnInsert:Le}))}async function W(xe,Oe,Le){return U(xe,"=",!0,Oe,Le)}async function H(xe,Oe,Le){return U(xe,"",!1,Oe,Le)}async function z(xe,Oe,Le,Ze){if(xe===void 0&&Le.length===0)return Ze.getLabelValues(Oe);{const qe=K(xe,Le);return await Ze.getSeriesValues(Oe,qe)}}async function G(xe,Oe,Le,Ze,qe){return(await z(xe,Oe,Ze,qe)).map(vt=>({type:"LABEL_VALUE",label:vt,insertText:Le?vt:`"${vt}"`}))}function M(xe,Oe){switch(xe.type){case"IN_DURATION":return Promise.resolve(N);case"IN_FUNCTION":return B(Oe);case"AT_ROOT":return B(Oe);case"EMPTY":{const Le=O(Oe),Ze=I(Oe);return Promise.resolve([...Ze,...j,...Le])}case"IN_LABEL_SELECTOR_NO_LABEL_NAME":return W(xe.metricName,xe.otherLabels,Oe);case"IN_GROUPING":return H(xe.metricName,xe.otherLabels,Oe);case"IN_LABEL_SELECTOR_WITH_LABEL_NAME":return G(xe.metricName,xe.labelName,xe.betweenQuotes,xe.otherLabels,Oe);default:throw new R(xe)}}function Q(xe,Oe){switch(Oe){case"parent":return xe.parent;case"firstChild":return xe.firstChild;case"lastChild":return xe.lastChild;case"nextSibling":return xe.nextSibling;default:throw new R(Oe)}}function Y(xe,Oe){let Le=xe;for(const[Ze,qe]of Oe)if(Le=Q(Le,Ze),Le===null||Le.type.id!==qe)return null;return Le}function q(xe,Oe){return Oe.slice(xe.from,xe.to)}function te(xe){const Oe=xe.slice(1,xe.length-1);if(xe.startsWith('"')&&xe.endsWith('"'))return Oe.replace(/\\"/,'"');if(xe.startsWith("'")&&xe.endsWith("'"))return Oe.replace(/\\'/,"'");if(xe.startsWith("`")&&xe.endsWith("`"))return Oe;throw new Error("FIXME: invalid string literal")}function X(xe,Oe){return xe.every((Le,Ze)=>Le===Oe[Ze])}const ee=0,ne=[{path:[y.ww,y.Fb],fun:Pe},{path:[y.ab],fun:J},{path:[y.Dh],fun:ce},{path:[y.LW,y.Yq],fun:ie},{path:[ee,y.df,y.ab],fun:J},{path:[ee,y.Yq],fun:ie},{path:[ee,y.l4],fun:pe},{path:[y.x$],fun:he}],Z=new Map([[y.Hl,"="],[y.Ed,"=~"],[y.l3,"!="],[y.$i,"!~"]]);function ae(xe){const Oe=xe.firstChild;return Oe===null?null:Z.get(Oe.type.id)??null}function re(xe,Oe){if(xe.type.id!==y.Yq)return null;const Le=Y(xe,[["firstChild",y.IC]]);if(Le===null)return null;const Ze=Y(Le,[["nextSibling",y.Lf]]);if(Ze===null)return null;const qe=ae(Ze);if(qe===null)return null;const rt=Y(xe,[["lastChild",y.LW]]);if(rt===null)return null;const vt=q(Le,Oe),Ot=te(q(rt,Oe));return{name:vt,value:Ot,op:qe}}function se(xe,Oe){return xe.type.id!==y.ww?[]:xe.getChildren(y.Yq).map(Ze=>re(Ze,Oe)).filter(Se)}function de(xe){let Oe=xe.firstChild;const Le=[];for(;Oe!==null;)Le.push(Oe),Oe=Oe.nextSibling;return Le}function le(xe,Oe){if(xe.type.id===Oe)return xe;const Le=de(xe);for(const Ze of Le){const qe=le(Ze,Oe);if(qe!==null)return qe}return null}function he(xe,Oe,Le){const Ze=Y(xe,[["parent",y.hI],["parent",y.Fn]]);if(Ze===null)return null;const qe=Ze.getChild(y.Dh);if(qe===null)return null;const rt=le(qe,y.gw);return rt===null?null:{type:"IN_GROUPING",metricName:q(rt,Oe),otherLabels:[]}}function ie(xe,Oe,Le){const Ze=!xe.type.isError,qe=Y(xe,[["parent",y.Yq]]);if(qe===null)return null;const rt=Y(qe,[["firstChild",y.IC]]);if(rt===null)return null;const vt=q(rt,Oe),Ot=Y(qe,[["parent",y.ww]]);if(Ot===null)return null;const Ut=se(Ot,Oe).filter(fn=>fn.name!==vt),zt=Y(Ot,[["parent",y.Fb],["firstChild",y.gw]]);return zt===null?{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",labelName:vt,betweenQuotes:Ze,otherLabels:Ut}:{type:"IN_LABEL_SELECTOR_WITH_LABEL_NAME",metricName:q(zt,Oe),labelName:vt,betweenQuotes:Ze,otherLabels:Ut}}function J(xe,Oe,Le){return{type:"AT_ROOT"}}function ce(xe,Oe,Le){return{type:"IN_FUNCTION"}}function pe(xe,Oe,Le){return{type:"IN_DURATION"}}function Pe(xe,Oe,Le){const Ze=Y(xe,[["firstChild",y.Yq]]);if(Ze!==null&&!Oe.slice(Ze.to,Le).includes(","))return null;const qe=Y(xe,[["parent",y.Fb],["firstChild",y.gw]]),rt=se(xe,Oe);return qe===null?{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",otherLabels:rt}:{type:"IN_LABEL_SELECTOR_NO_LABEL_NAME",metricName:q(qe,Oe),otherLabels:rt}}function Ie(xe,Oe){const Le=xe.cursorAt(Oe);for(;;){if(Le.from===Oe&&Le.to===Oe){const{node:Ze}=Le;if(Ze.type.isError)return Ze}if(!Le.next())break}return null}function ge(xe,Oe){if(xe==="")return{type:"EMPTY"};const Le=y.K3.parse(xe),Ze=Ie(Le,Oe),qe=Ze!=null?Ze.cursor():Le.cursorAt(Oe),rt=qe.node,vt=[qe.type.id];for(;qe.parent();)vt.push(qe.type.id);for(let Ot of ne)if(X(Ot.path,vt))return Ot.fun(rt,xe,Oe);return null}function Se(xe){return xe!=null}function De(){return{showWords:!1}}function Ke(xe,Oe){switch(xe){case"DURATION":return Oe.languages.CompletionItemKind.Unit;case"FUNCTION":return Oe.languages.CompletionItemKind.Variable;case"HISTORY":return Oe.languages.CompletionItemKind.Snippet;case"LABEL_NAME":return Oe.languages.CompletionItemKind.Enum;case"LABEL_VALUE":return Oe.languages.CompletionItemKind.EnumMember;case"METRIC_NAME":return Oe.languages.CompletionItemKind.Constructor;default:throw new R(xe)}}function Me(xe,Oe){return{triggerCharacters:["{",",","[","(","=","~"," ",'"'],provideCompletionItems:(Ze,qe)=>{const rt=Ze.getWordAtPosition(qe),vt=rt!=null?xe.Range.lift({startLineNumber:qe.lineNumber,endLineNumber:qe.lineNumber,startColumn:rt.startColumn,endColumn:rt.endColumn}):xe.Range.fromPositions(qe),Ot={column:qe.column,lineNumber:qe.lineNumber};if(Oe.monacoSettings.setInputInRange(Ze.getValueInRange(vt)),window.getSelection){const qt=window.getSelection()?.toString();qt&&qt.length>0&&(Ot.column=Ot.column-qt.length)}const jt=Ze.getOffsetAt(Ot),Ut=ge(Ze.getValue(),jt);return(Ut!=null?M(Ut,Oe):Promise.resolve([])).then(qt=>{const fn=qt.length.toString().length;return{suggestions:qt.map((An,Hn)=>({kind:Ke(An.type,xe),label:An.label,insertText:An.insertText,detail:An.detail,documentation:An.documentation,sortText:Hn.toString().padStart(fn,"0"),range:vt,command:An.triggerOnInsert?{id:"editor.action.triggerSuggest",title:""}:void 0})),incomplete:Oe.monacoSettings.suggestionsIncomplete}})}}}var be=e(91306);const we=0;function Be(xe,Oe,Le,Ze){if(!xe)return!1;const qe=He(Oe,Ze);if(!qe.length)return!1;let rt=qe;if(xe!==Oe){const vt=He(xe,Ze);rt=qe.flatMap(Ot=>vt.filter(jt=>Ot.text===jt.text)||Ot)}return rt.map(vt=>Ve(xe,Le,vt)).filter(Je)}function He(xe,Oe){const Le=[];return Oe.parse(xe).iterate({enter:qe=>{if(qe.type.id===we){const rt=qe.node;Le.push({node:rt,text:xe.substring(rt.from,rt.to)})}}}),Le}function Ve(xe,Oe,Le){if(Oe.length===1){const rt=Le.node.from===Le.node.to,vt=rt&&Le.node.parent?Le.node.parent:Le.node,Ot=rt?xe.substring(vt.from,vt.to):Le.text;return{startLineNumber:1,startColumn:vt.from+1,endLineNumber:1,endColumn:vt.to+1,error:Ot}}let Ze=0,qe=0;for(let rt=0;rt<Oe.length;rt++){if(qe=Ze+Oe[rt].length,Le.node.from>qe){Ze+=Oe[rt].length+1;continue}return{startLineNumber:rt+1,startColumn:Le.node.from-Ze+1,endLineNumber:rt+1,endColumn:Le.node.to-Ze+1,error:Le.text}}return null}function Je(xe){return xe!==null}const nt={__interval:{text:"1s",value:"1s"},__rate_interval:{text:"1s",value:"1s"},__auto:{text:"1s",value:"1s"},__interval_ms:{text:"1000",value:1e3},__range_ms:{text:"1000",value:1e3},__range_s:{text:"1",value:1},__range:{text:"1s",value:"1s"}},pt={wordPattern:/(-?\d*\.\d\w*)|([^`~!#%^&*()\-=+\[{\]}\\|;:'",.<>\/?\s]+)/g,comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"<",close:">"}],folding:{}},bt=["sum","min","max","avg","group","stddev","stdvar","count","count_values","bottomk","topk","quantile"],Tt=["abs","absent","ceil","changes","clamp_max","clamp_min","day_of_month","day_of_week","days_in_month","delta","deriv","exp","floor","histogram_quantile","histogram_avg","histogram_count","histogram_sum","histogram_fraction","histogram_stddev","histogram_stdvar","holt_winters","hour","idelta","increase","irate","label_join","label_replace","ln","log2","log10","minute","month","predict_linear","rate","resets","round","scalar","sort","sort_desc","sqrt","time","timestamp","vector","year"],ye=[];for(let xe=0,Oe=bt;xe<Oe.length;xe++){let Le=Oe[xe];ye.push(Le+"_over_time")}const je=["on","ignoring","group_right","group_left","by","without"],ue="("+je.reduce(function(xe,Oe){return xe+"|"+Oe})+")",Ee=["+","-","*","/","%","^","==","!=",">","<",">=","<=","and","or","unless"],Ce=["offset"],Fe={ignoreCase:!1,defaultToken:"",tokenPostfix:".promql",keywords:bt.concat(Tt).concat(ye).concat(je).concat(Ce),operators:Ee,vectorMatching:ue,symbols:/[=><!~?:&|+\-*\/^%]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/\d+(_+\d+)*/,octaldigits:/[0-7]+(_+[0-7]+)*/,binarydigits:/[0-1]+(_+[0-1]+)*/,hexdigits:/[[0-9a-fA-F]+(_+[0-9a-fA-F]+)*/,integersuffix:/(ll|LL|u|U|l|L)?(ll|LL|u|U|l|L)?/,floatsuffix:/[fFlL]?/,tokenizer:{root:[[/@vectorMatching\s*(?=\()/,"type","@clauses"],[/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,"tag"],[/(^#.*$)/,"comment"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":"type","@default":"identifier"}}],[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/"/,"string","@string_double"],[/'/,"string","@string_single"],[/`/,"string","@string_backtick"],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"delimiter","@default":""}}],[/\d+[smhdwy]/,"number"],[/\d*\d+[eE]([\-+]?\d+)?(@floatsuffix)/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?(@floatsuffix)/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F](@integersuffix)/,"number.hex"],[/0[0-7']*[0-7](@integersuffix)/,"number.octal"],[/0[bB][0-1']*[0-1](@integersuffix)/,"number.binary"],[/\d[\d']*\d(@integersuffix)/,"number"],[/\d(@integersuffix)/,"number"]],string_double:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],string_single:[[/[^\\']+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/'/,"string","@pop"]],string_backtick:[[/[^\\`$]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/`/,"string","@pop"]],clauses:[[/[^(,)]/,"tag"],[/\)/,"identifier","@pop"]],whitespace:[[/[ \t\r\n]+/,"white"]]}},Ue={codeLens:!1,contextmenu:!1,fixedOverflowWidgets:!0,folding:!1,fontSize:14,lineDecorationsWidth:8,lineNumbers:"off",minimap:{enabled:!1},overviewRulerBorder:!1,overviewRulerLanes:0,padding:{top:4,bottom:5},renderLineHighlight:"none",scrollbar:{vertical:"hidden",verticalScrollbarSize:8,horizontal:"hidden",horizontalScrollbarSize:0,alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,suggest:De(),suggestFontSize:12,wordWrap:"on"},fe=2,Te=v.Y.id;let Ge=!1;function Qe(xe){if(Ge===!1){Ge=!0;const{aliases:Oe,extensions:Le,mimetypes:Ze}=v.Y;xe.languages.register({id:Te,aliases:Oe,extensions:Le,mimetypes:Ze}),xe.languages.setMonarchTokensProvider(Te,Fe),xe.languages.setLanguageConfiguration(Te,pt)}}const st=(xe,Oe)=>({container:(0,n.css)({borderRadius:xe.shape.radius.default,border:`1px solid ${xe.components.input.borderColor}`,display:"flex",flexDirection:"row",justifyContent:"start",alignItems:"center",height:"100%"}),placeholder:(0,n.css)({"::after":{content:`'${Oe}'`,fontFamily:xe.typography.fontFamilyMonospace,opacity:.6}})}),ot=xe=>{const Oe=(0,m.A)(),Le=(0,r.useRef)(C()),Ze=(0,r.useRef)(null),{languageProvider:qe,history:rt,onBlur:vt,onRunQuery:Ot,initialValue:jt,placeholder:Ut,onChange:zt,datasource:qt}=xe,fn=(0,P.A)(qe),Sn=(0,P.A)(rt),An=(0,P.A)(Ot),Hn=(0,P.A)(vt),es=(0,P.A)(zt),rs=(0,r.useRef)(null),Zn=(0,o.$j)(),kn=st(Zn,Ut);return(0,r.useEffect)(()=>()=>{rs.current?.()},[]),(0,t.jsx)("div",{"data-testid":g.Tp.components.QueryField.container,className:kn.container,ref:Ze,children:(0,t.jsx)(D.m,{overrideServices:Le.current,options:Ue,language:"promql",value:jt,beforeMount:Gn=>{Qe(Gn)},onMount:(Gn,Kn)=>{const yn=Gn.createContextKey("isEditorFocused"+Oe,!1);Gn.onDidBlurEditorWidget(()=>{yn.set(!1),Hn.current(Gn.getValue())}),Gn.onDidFocusEditorText(()=>{yn.set(!0)});const wn=new be.M9({historyProvider:Sn.current,languageProvider:fn.current}),Jn=Me(Kn,wn),bn={...Jn,provideCompletionItems:(sn,on,xn,Un)=>Gn.getModel()?.id!==sn.id?{suggestions:[]}:Jn.provideCompletionItems(sn,on,xn,Un)},{dispose:Pt}=Kn.languages.registerCompletionItemProvider(Te,bn);rs.current=Pt;const Ft=()=>{const sn=Ze.current;if(sn!==null){const on=Gn.getContentHeight();sn.style.height=`${on+fe}px`,sn.style.width="100%";const xn=sn.clientWidth;Gn.layout({width:xn,height:on})}};Gn.onDidContentSizeChange(Ft),Ft();const Xt=(0,f.debounce)(()=>{const sn=Gn.getValue();es.current(sn)},fn.current.datasource.getDebounceTimeInMilliseconds());if(Gn.getModel()?.onDidChangeContent(()=>{Xt()}),Gn.addCommand(Kn.KeyMod.Shift|Kn.KeyCode.Enter,()=>{An.current(Gn.getValue())},"isEditorFocused"+Oe),Kn.editor.addKeybindingRule({keybinding:Kn.KeyMod.CtrlCmd|Kn.KeyCode.KeyF,command:null}),Gn.addCommand(Kn.KeyMod.CtrlCmd|Kn.KeyCode.KeyK,function(){e.g.dispatchEvent(new KeyboardEvent("keydown",{key:"k",metaKey:!0}))}),Ut){const sn=[{range:new Kn.Range(1,1,1,1),options:{className:kn.placeholder,isWholeLine:!0}}];let on=[];const xn=()=>{const Un=Gn.getModel();if(!Un)return;const hn=Un.getValueLength()===0?sn:[];on=Un.deltaDecorations(on,hn)};xn(),Gn.onDidChangeModelContent(xn),Gn.onDidChangeModelContent(Un=>{const hn=Gn.getModel();if(!hn)return;const St=hn.getValue(),en=(Be(St,qt.interpolateString(St,nt),hn.getLinesContent(),y.K3)||[]).map(({error:tn,...gn})=>({message:`${tn?`Error parsing "${tn}"`:"Parse error"}. The query appears to be incorrect and could fail to be executed.`,severity:Kn.MarkerSeverity.Error,...gn}));Kn.editor.setModelMarkers(hn,"owner",en)})}}})})},ft=xe=>(0,t.jsx)(r.Suspense,{fallback:null,children:(0,t.jsx)(ot,{...xe})}),_e=xe=>{const Oe=(0,r.useRef)(null),{onRunQuery:Le,onChange:Ze,...qe}=xe,rt=jt=>{Oe.current=jt,Ze(jt),Le()},vt=jt=>{Ze(jt)},Ot=jt=>{Ze(jt)};return(0,t.jsx)(ft,{onChange:Ot,onRunQuery:rt,onBlur:vt,...qe})},et="grafana.datasources.prometheus.browser.labels";function it(xe,Oe,Le){return xe?"(Disabled)":Oe?Le?"Metrics browser":"(No metrics found)":"Loading metrics..."}class dt extends r.PureComponent{constructor(Oe){super(Oe),this.refreshHint=()=>{const{datasource:Le,query:Ze,data:qe}=this.props,rt=Le.getInitHints(),vt=rt.length>0?rt[0]:null;if(!qe||qe.series.length===0){this.setState({hint:vt});return}const Ot=(0,s.ci)(qe.series[0])?qe.series.map(s.w3):qe.series,jt=Le.getQueryHints(Ze,Ot);let Ut=jt.length>0?jt[0]:null;this.setState({hint:Ut??vt})},this.refreshMetrics=async()=>{const{range:Le,datasource:{languageProvider:Ze}}=this.props;this.languageProviderInitializationPromise=h(Ze.start(Le));try{const qe=await this.languageProviderInitializationPromise.promise;await Promise.all(qe),this.onUpdateLanguage()}catch(qe){if(!(p(qe)&&qe.isCanceled))throw qe}},this.onChangeLabelBrowser=Le=>{this.onChangeQuery(Le,!0),this.setState({labelBrowserVisible:!1})},this.onChangeQuery=(Le,Ze)=>{const{query:qe,onChange:rt,onRunQuery:vt}=this.props;if(rt){const Ot={...qe,expr:Le};rt(Ot),Ze&&vt&&vt()}},this.onClickChooserButton=()=>{this.setState(Le=>({labelBrowserVisible:!Le.labelBrowserVisible})),(0,i.rR)("user_grafana_prometheus_metrics_browser_clicked",{editorMode:this.state.labelBrowserVisible?"metricViewClosed":"metricViewOpen",app:this.props?.app??""})},this.onClickHintFix=()=>{const{datasource:Le,query:Ze,onChange:qe,onRunQuery:rt}=this.props,{hint:vt}=this.state;vt?.fix?.action&&qe(Le.modifyQuery(Ze,vt.fix.action)),rt()},this.onUpdateLanguage=()=>{const{datasource:{languageProvider:Le}}=this.props,{metrics:Ze}=Le;Ze&&this.setState({syntaxLoaded:!0})},this.state={labelBrowserVisible:!1,syntaxLoaded:!1,hint:null}}componentDidMount(){this.props.datasource.languageProvider&&this.refreshMetrics(),this.refreshHint()}componentWillUnmount(){this.languageProviderInitializationPromise&&this.languageProviderInitializationPromise.cancel()}componentDidUpdate(Oe){const{data:Le,datasource:{languageProvider:Ze},range:qe}=this.props;Ze!==Oe.datasource.languageProvider&&this.setState({syntaxLoaded:!1});const rt=this.rangeChangedToRefresh(qe,Oe.range);(Ze!==Oe.datasource.languageProvider||rt)&&this.refreshMetrics(),Le&&Oe.data&&Oe.data.series!==Le.series&&this.refreshHint()}rangeChangedToRefresh(Oe,Le){if(Oe&&Le){const Ze=(0,u.eN)(Oe.from.valueOf())===(0,u.eN)(Le.from.valueOf()),qe=(0,u.eN)(Oe.to.valueOf())===(0,u.eN)(Le.to.valueOf());return!(Ze&&qe)}return!1}render(){const{datasource:Oe,datasource:{languageProvider:Le},query:Ze,ExtraFieldElement:qe,history:rt=[],theme:vt}=this.props,{labelBrowserVisible:Ot,syntaxLoaded:jt,hint:Ut}=this.state,zt=Le.metrics.length>0,qt=it(Oe.lookupsDisabled,jt,zt),fn=!(jt&&zt);return(0,t.jsx)(a.b,{storageKey:et,defaultValue:[],children:(Sn,An,Hn)=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline gf-form-inline--xs-view-flex-column flex-grow-1","data-testid":this.props["data-testid"],children:[(0,t.jsxs)("button",{className:"gf-form-label query-keyword pointer",onClick:this.onClickChooserButton,disabled:fn,type:"button","data-testid":g.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.openButton,children:[qt,(0,t.jsx)(l.I,{name:Ot?"angle-down":"angle-right"})]}),(0,t.jsx)("div",{className:"flex-grow-1 min-width-15",children:(0,t.jsx)(_e,{languageProvider:Le,history:rt,onChange:this.onChangeQuery,onRunQuery:this.props.onRunQuery,initialValue:Ze.expr??"",placeholder:"Enter a PromQL query\u2026",datasource:Oe})})]}),Ot&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(c.ur,{languageProvider:Le,onChange:this.onChangeLabelBrowser,lastUsedLabels:Sn||[],storeLastUsedLabels:An,deleteLastUsedLabels:Hn,timeRange:this.props.range})}),qe,Ut?(0,t.jsx)("div",{className:(0,n.css)({flexBasis:"100%"}),children:(0,t.jsxs)("div",{className:"text-warning",children:[Ut.label," ",Ut.fix?(0,t.jsx)("button",{type:"button",className:(0,n.cx)((0,d.my)(vt),"text-link","muted"),onClick:this.onClickHintFix,children:Ut.fix.label}):null]})}):null]})})}}const ze=(0,o.cV)(dt)},91396:(_,L,e)=>{"use strict";e.d(L,{_N:()=>P,bS:()=>m,ur:()=>b});var t=e(74848),n=e(32196),r=e(96540),s=e(91793),a=e(13544),g=e(3911),i=e(39558),l=e(67061),d=e(60029),o=e(10354),u=e(54438),c=e(55852),p=e(40845),h=e(81996);const y="{}",f="__name__",v=25,P="40000",m="none";function D(T){let A="";const R=[];for(const S of T)if((S.name===f||S.selected)&&S.values&&S.values.length>0){const O=S.values.filter(j=>j.selected).map(j=>j.name);O.length>1?R.push(`${S.name}=~"${O.map(h.Cs).join("|")}"`):O.length===1&&(S.name===f?A=O[0]:R.push(`${S.name}="${(0,h.Qn)(O[0])}"`))}return[A,"{",R.join(","),"}"].join("")}function x(T,A,R){return T.map(S=>{const O=A[S.name];if(O){let j;if(S.name===R&&S.values)j=S.values;else{const B=new Set(S.values?.filter(N=>N.selected).map(N=>N.name)||[]);j=O.map(N=>({name:N,selected:B.has(N)}))}return{...S,loading:!1,values:j,hidden:!O,facets:j.length}}return{...S,loading:!1,hidden:!O,values:void 0,facets:0}})}const E=(0,g.N)(T=>({wrapper:(0,n.css)({backgroundColor:T.colors.background.secondary,padding:T.spacing(1),width:"100%"}),list:(0,n.css)({marginTop:T.spacing(1),display:"flex",flexWrap:"wrap",maxHeight:"200px",overflow:"auto",alignContent:"flex-start"}),section:(0,n.css)({"& + &":{margin:`${T.spacing(2)} 0`},position:"relative"}),selector:(0,n.css)({fontFamily:T.typography.fontFamilyMonospace,marginBottom:T.spacing(1)}),status:(0,n.css)({padding:T.spacing(.5),color:T.colors.text.secondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",position:"absolute",width:"50%",right:0,textAlign:"right",opacity:0,[T.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 100ms linear"}}),statusShowing:(0,n.css)({opacity:1}),error:(0,n.css)({color:T.colors.error.main}),valueList:(0,n.css)({marginRight:T.spacing(1),resize:"horizontal"}),valueListWrapper:(0,n.css)({borderLeft:`1px solid ${T.colors.border.medium}`,margin:`${T.spacing(1)} 0`,padding:`${T.spacing(1)} 0 ${T.spacing(1)} ${T.spacing(1)}`}),valueListArea:(0,n.css)({display:"flex",flexWrap:"wrap",marginTop:T.spacing(1)}),valueTitle:(0,n.css)({marginLeft:`-${T.spacing(.5)}`,marginBottom:T.spacing(1)}),validationStatus:(0,n.css)({padding:T.spacing(.5),marginBottom:T.spacing(1),color:T.colors.text.maxContrast,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"})}));class C extends r.Component{constructor(){super(...arguments),this.valueListsRef=r.createRef(),this.state={labels:[],labelSearchTerm:"",metricSearchTerm:"",status:"Ready",error:"",validationStatus:"",valueSearchTerm:""},this.onChangeLabelSearch=A=>{this.setState({labelSearchTerm:A.target.value})},this.onChangeMetricSearch=A=>{this.setState({metricSearchTerm:A.target.value})},this.onChangeSeriesLimit=A=>{this.setState({seriesLimit:A.target.value.trim()})},this.onChangeValueSearch=A=>{this.setState({valueSearchTerm:A.target.value})},this.onClickRunQuery=()=>{const A=D(this.state.labels);this.props.onChange(A)},this.onClickRunRateQuery=()=>{const R=`rate(${D(this.state.labels)}[$__rate_interval])`;this.props.onChange(R)},this.onClickClear=()=>{this.setState(A=>({labels:A.labels.map(S=>({...S,values:void 0,selected:!1,loading:!1,hidden:!1,facets:void 0})),labelSearchTerm:"",metricSearchTerm:"",status:"",error:"",validationStatus:"",valueSearchTerm:""})),this.props.deleteLastUsedLabels(),this.fetchValues(f,y)},this.onClickLabel=(A,R,S)=>{const O=this.state.labels.find(N=>N.name===A);if(!O)return;const j=!O.selected;let B={selected:j};if(O.values&&!j){const N=O.values.map(I=>({...I,selected:!1}));B={...B,facets:0,values:N}}this.setState({labelSearchTerm:""}),this.updateLabelState(A,B,"",()=>this.doFacettingForLabel(A))},this.onClickValue=(A,R,S)=>{const O=this.state.labels.find(B=>B.name===A);if(!O||!O.values)return;this.setState({labelSearchTerm:""});const j=O.values.map(B=>({...B,selected:B.name===R?!B.selected:B.selected}));this.updateLabelState(A,{values:j},"",()=>this.doFacetting(A))},this.onClickMetric=(A,R,S)=>{const O=this.state.labels.find(N=>N.name===A);if(!O||!O.values)return;this.setState({metricSearchTerm:""});const j=O.values.map(N=>({...N,selected:N.name===R||N.selected?!N.selected:N.selected})),B=j.some(N=>N.selected);this.updateLabelState(A,{selected:B,values:j},"",()=>this.doFacetting(A))},this.onClickValidate=()=>{const A=D(this.state.labels);this.validateSelector(A)},this.doFacetting=A=>{const R=D(this.state.labels);if(R===y){const S=this.state.labels.map(O=>({...O,facets:0,values:void 0,hidden:!1}));this.setState({labels:S},()=>{this.state.labels.forEach(O=>(O.selected||O.name===f)&&this.fetchValues(O.name,R))})}else this.fetchSeries(R,A)}}updateLabelState(A,R,S="",O){this.setState(j=>{const B=j.labels.map(I=>I.name===A?{...I,...R}:I),N=S?"":j.error;return{labels:B,status:S,error:N,validationStatus:""}},O)}componentDidMount(){const{languageProvider:A,lastUsedLabels:R}=this.props;if(A){const S=R;A.start(this.props.timeRange).then(()=>{let O=A.getLabelKeys();this.fetchValues(f,y);const j=O.map((B,N,I)=>({name:B,selected:S.includes(B),loading:!1}));this.setState({labels:j},()=>{this.state.labels.forEach(B=>{B.selected&&this.fetchValues(B.name,y)})})})}}doFacettingForLabel(A){const R=this.state.labels.find(O=>O.name===A);if(!R)return;const S=this.state.labels.filter(O=>O.selected).map(O=>O.name);this.props.storeLastUsedLabels(S),R.selected?R.values||this.fetchValues(A,D(this.state.labels)):this.doFacetting()}async fetchValues(A,R){const{languageProvider:S}=this.props;this.updateLabelState(A,{loading:!0},`Fetching values for ${A}`);try{let O=await S.getLabelValues(A);if(R!==D(this.state.labels)){this.updateLabelState(A,{loading:!1});return}const j=[],{metricsMetadata:B}=S;for(const N of O){const I={name:N};if(A===f&&B){const K=B[N];K&&(I.details=`(${K.type}) ${K.help}`)}j.push(I)}this.updateLabelState(A,{values:j,loading:!1})}catch(O){console.error(O)}}async fetchSeries(A,R){const{languageProvider:S}=this.props;R&&this.updateLabelState(R,{loading:!0},`Facetting labels for ${A}`);try{const O=await S.fetchSeriesLabels(A,!0,this.state.seriesLimit);if(A!==D(this.state.labels)){R&&this.updateLabelState(R,{loading:!1});return}if(Object.keys(O).length===0){this.setState({error:`Empty results, no matching label for ${A}`});return}const j=x(this.state.labels,O,R);this.setState({labels:j,error:""}),R&&this.updateLabelState(R,{loading:!1})}catch(O){console.error(O)}}async validateSelector(A){const{languageProvider:R}=this.props;this.setState({validationStatus:`Validating selector ${A}`,error:""});const S=await R.fetchSeries(A);this.setState({validationStatus:`Selector is valid (${S.length} series found)`})}render(){const{theme:A}=this.props,{labels:R,labelSearchTerm:S,metricSearchTerm:O,status:j,error:B,validationStatus:N,valueSearchTerm:I}=this.state,K=E(A);if(R.length===0)return(0,t.jsx)("div",{className:K.wrapper,children:(0,t.jsx)(i._,{text:"Loading labels..."})});let w=R.find(M=>M.name===f);w&&O&&(w={...w,values:w.values?.filter(M=>M.selected||M.name.includes(O))});let U=R.filter(M=>!M.hidden&&M.name!==f);S&&(U=U.filter(M=>M.selected||M.name.includes(S)));let W=U.filter(M=>M.selected&&M.values);I&&(W=W.map(M=>({...M,values:M.values?.filter(Q=>Q.selected||Q.name.includes(I))})));const H=D(this.state.labels),z=H===y,G=w?.values?.length||0;return(0,t.jsxs)("div",{className:K.wrapper,children:[(0,t.jsxs)(l.B,{gap:3,children:[(0,t.jsx)("div",{children:(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Once a metric is selected only possible labels are shown. Labels are limited by the series limit below.",children:"1. Select a metric"}),(0,t.jsx)("div",{children:(0,t.jsx)(o.p,{onChange:this.onChangeMetricSearch,"aria-label":"Filter expression for metric",value:O,"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.selectMetric})}),(0,t.jsx)(d.J,{description:"Set to 'none' to remove limit and show all labels for a selected metric. Removing the limit may cause performance issues.",children:"Series limit"}),(0,t.jsx)("div",{children:(0,t.jsx)(o.p,{onChange:this.onChangeSeriesLimit,"aria-label":"Limit results from series endpoint",value:this.state.seriesLimit??P,"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.seriesLimit})}),(0,t.jsx)("div",{role:"list",className:K.valueListWrapper,"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.metricList,children:(0,t.jsx)(s.Y1,{height:Math.min(450,G*v),itemCount:G,itemSize:v,itemKey:M=>w.values[M].name,width:300,className:K.valueList,children:({index:M,style:Q})=>{const Y=w?.values?.[M];return Y?(0,t.jsx)("div",{style:Q,children:(0,t.jsx)(u.J,{name:w.name,value:Y?.name,title:Y.details,active:Y?.selected,onClick:this.onClickMetric,searchTerm:O})}):null}})})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Once label values are selected, only possible label combinations are shown.",children:"2. Select labels to search in"}),(0,t.jsx)("div",{children:(0,t.jsx)(o.p,{onChange:this.onChangeLabelSearch,"aria-label":"Filter expression for label",value:S,"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelNamesFilter})}),(0,t.jsx)("div",{className:K.list,style:{height:120},children:U.map(M=>(0,t.jsx)(u.J,{name:M.name,loading:M.loading,active:M.selected,hidden:M.hidden,facets:M.facets,onClick:this.onClickLabel,searchTerm:S},M.name))})]}),(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{description:"Use the search field to find values across selected labels.",children:"3. Select (multiple) values for your labels"}),(0,t.jsx)("div",{children:(0,t.jsx)(o.p,{onChange:this.onChangeValueSearch,"aria-label":"Filter expression for label values",value:I,"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.labelValuesFilter})}),(0,t.jsx)("div",{className:K.valueListArea,ref:this.valueListsRef,children:W.map(M=>(0,t.jsxs)("div",{role:"list","aria-label":`Values for ${M.name}`,className:K.valueListWrapper,children:[(0,t.jsx)("div",{className:K.valueTitle,children:(0,t.jsx)(u.J,{name:M.name,loading:M.loading,active:M.selected,hidden:M.hidden,facets:M.facets||M.values?.length,onClick:this.onClickLabel})}),(0,t.jsx)(s.Y1,{height:Math.min(200,v*(M.values?.length||0)),itemCount:M.values?.length||0,itemSize:28,itemKey:Q=>M.values[Q].name,width:200,className:K.valueList,children:({index:Q,style:Y})=>{const q=M.values?.[Q];return q?(0,t.jsx)("div",{style:Y,children:(0,t.jsx)(u.J,{name:M.name,value:q?.name,active:q?.selected,onClick:this.onClickValue,searchTerm:I})}):null}})]},M.name))})]})]})]}),(0,t.jsxs)("div",{className:K.section,children:[(0,t.jsx)(d.J,{children:"4. Resulting selector"}),(0,t.jsx)("div",{"aria-label":"selector",className:K.selector,children:H}),N&&(0,t.jsx)("div",{className:K.validationStatus,children:N}),(0,t.jsxs)(l.B,{children:[(0,t.jsx)(c.$n,{"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useQuery,"aria-label":"Use selector for query button",disabled:z,onClick:this.onClickRunQuery,children:"Use query"}),(0,t.jsx)(c.$n,{"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.useAsRateQuery,"aria-label":"Use selector as metrics button",variant:"secondary",disabled:z,onClick:this.onClickRunRateQuery,children:"Use as rate query"}),(0,t.jsx)(c.$n,{"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.validateSelector,"aria-label":"Validate submit button",variant:"secondary",disabled:z,onClick:this.onClickValidate,children:"Validate selector"}),(0,t.jsx)(c.$n,{"data-testid":a.Tp.components.DataSource.Prometheus.queryEditor.code.metricsBrowser.clear,"aria-label":"Selector clear button",variant:"secondary",onClick:this.onClickClear,children:"Clear"}),(0,t.jsx)("div",{className:(0,n.cx)(K.status,(j||B)&&K.statusShowing),children:(0,t.jsx)("span",{className:B?K.error:"",children:B||j})})]})]})]})}}const b=(0,p.cV)(C)},91306:(_,L,e)=>{"use strict";e.d(L,{M9:()=>r,Ol:()=>n,w0:()=>t});const t="codeModeSuggestionsIncomplete";function n(s){return s.type===t&&"detail"in s&&typeof s.detail=="object"&&s.detail!==null&&"limit"in s.detail&&"datasourceUid"in s.detail}class r{constructor(a){this.languageProvider=a.languageProvider,this.historyProvider=a.historyProvider,this.inputInRange="",this.metricNamesSuggestionLimit=this.languageProvider.datasource.metricNamesAutocompleteSuggestionLimit,this.suggestionsIncomplete=!1,this.getSeriesLabels=this.languageProvider.getSeriesLabels.bind(this.languageProvider),this.getSeriesValues=this.languageProvider.getSeriesValues.bind(this.languageProvider),this.getAllLabelNames=this.languageProvider.getLabelKeys.bind(this.languageProvider),this.getLabelValues=this.languageProvider.getLabelValues.bind(this.languageProvider)}getHistory(){return this.historyProvider.map(a=>a.query.expr).filter(Boolean)}getAllMetricNames(){return this.languageProvider.metrics}metricNamesToMetrics(a){const{metricsMetadata:g}=this.languageProvider;return a.map(l=>{const d=g?.[l];return{name:l,help:d?.help??"",type:d?.type??""}})}enableAutocompleteSuggestionsUpdate(){this.suggestionsIncomplete=!0,dispatchEvent(new CustomEvent(t,{detail:{limit:this.metricNamesSuggestionLimit,datasourceUid:this.languageProvider.datasource.uid}}))}setInputInRange(a){this.inputInRange=a}get monacoSettings(){return{enableAutocompleteSuggestionsUpdate:this.enableAutocompleteSuggestionsUpdate.bind(this),inputInRange:this.inputInRange,setInputInRange:this.setInputInRange.bind(this),suggestionsIncomplete:this.suggestionsIncomplete}}}},4936:(_,L,e)=>{"use strict";e.d(L,{TT:()=>i,Zh:()=>l,jW:()=>g,k1:()=>s});var t=e(74848),n=e(32196),r=e(72093);const s=30,a=d=>{const{options:o,onOptionsChange:u}=d,c=useTheme2(),p=l(c);return jsxs(Fragment,{children:[o.access==="direct"&&jsx(Alert,{title:"Error",severity:"error",children:"Browser access mode in the Prometheus data source is no longer available. Switch to server access mode."}),jsx(DataSourceDescription,{dataSourceName:"Prometheus",docsLink:"https://grafana.com/docs/grafana/latest/datasources/prometheus/configure-prometheus-data-source/"}),jsx("hr",{className:`${p.hrTopSpace} ${p.hrBottomSpace}`}),jsx(DataSourceHttpSettingsOverhaul,{options:o,onOptionsChange:u,secureSocksDSProxyEnabled:config.secureSocksDSProxyEnabled}),jsx("hr",{}),jsxs(ConfigSection,{className:p.advancedSettings,title:"Advanced settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",children:[jsx(AdvancedHttpSettings,{className:p.advancedHTTPSettingsMargin,config:o,onChange:u}),jsx(AlertingSettingsOverhaul,{options:o,onOptionsChange:u}),jsx(PromSettings,{options:o,onOptionsChange:u})]})]})};function g(d){return(0,t.jsx)("a",{href:d||"https://grafana.com/docs/grafana/latest/datasources/prometheus/#configure-the-data-source",target:"_blank",rel:"noopener noreferrer",children:"Visit docs for more details here."})}const i=(d,o,u)=>{const c="Value is not valid";return d&&!d.match(o)?(0,t.jsx)(r.P,{children:u||c}):!0};function l(d){return{additionalSettings:(0,n.css)({marginBottom:"25px"}),secondaryGrey:(0,n.css)({color:d.colors.secondary.text,opacity:"65%"}),inlineError:(0,n.css)({margin:"0px 0px 4px 245px"}),switchField:(0,n.css)({alignItems:"center"}),sectionHeaderPadding:(0,n.css)({paddingTop:"32px"}),sectionBottomPadding:(0,n.css)({paddingBottom:"28px"}),subsectionText:(0,n.css)({fontSize:"12px"}),hrBottomSpace:(0,n.css)({marginBottom:"56px"}),hrTopSpace:(0,n.css)({marginTop:"50px"}),textUnderline:(0,n.css)({textDecoration:"underline"}),versionMargin:(0,n.css)({marginBottom:"12px"}),advancedHTTPSettingsMargin:(0,n.css)({margin:"24px 0 8px 0"}),advancedSettings:(0,n.css)({paddingTop:"32px"}),alertingTop:(0,n.css)({marginTop:"40px !important"}),overhaulPageHeading:(0,n.css)({fontWeight:400}),container:(0,n.css)({maxwidth:578})}}},75212:(_,L,e)=>{"use strict";e.d(L,{gs:()=>je,UD:()=>ue});var t=e(2543),n=e(13288),r=e(75505),s=e(81160),a=e(59099),g=e(97716),i=e.n(g),l=e(65879),d=e(43659),o=e(43127),u=e(47232),c=e(37891),p=e(41987),h=e(26657),y=e(72574),f=e(47773),v=e(17172),P=e(32264),m=e(80937),D=e(74848),x=e(13544),E=e(71087),C=e(9e4),b=e(81580),T=e(79458),A=e(51440),R=e(68402),S=e(10354),O=e(80109);function j(Ue){const fe=Ue.annotation,Te=Ue.onAnnotationChange,Ge={expr:fe.expr,refId:fe.name,interval:fe.step};return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(E.D,{children:[(0,D.jsx)(O.$,{...Ue,query:Ge,showExplain:!1,onChange:Qe=>{Te({...fe,expr:Qe.expr})}}),(0,D.jsx)(C.U,{children:(0,D.jsx)(b.c,{label:"Min step",tooltip:(0,D.jsxs)(D.Fragment,{children:["An additional lower limit for the step parameter of the Prometheus query and for the"," ",(0,D.jsx)("code",{children:"$__interval"})," and ",(0,D.jsx)("code",{children:"$__rate_interval"})," variables."]}),children:(0,D.jsx)(A.D,{type:"text","aria-label":"Set lower limit for the step parameter",placeholder:"auto",minWidth:10,onCommitChange:Qe=>{Te({...fe,step:Qe.currentTarget.value})},defaultValue:Ge.interval,id:x.Tp.components.DataSource.Prometheus.annotations.minStep})})})]}),(0,D.jsx)(R.$,{v:.5}),(0,D.jsxs)(C.U,{children:[(0,D.jsx)(b.c,{label:"Title",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,D.jsx)(S.p,{type:"text",placeholder:"{{alertname}}",value:fe.titleFormat,onChange:Qe=>{Te({...fe,titleFormat:Qe.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.title})}),(0,D.jsx)(b.c,{label:"Tags",children:(0,D.jsx)(S.p,{type:"text",placeholder:"label1,label2",value:fe.tagKeys,onChange:Qe=>{Te({...fe,tagKeys:Qe.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.tags})}),(0,D.jsx)(b.c,{label:"Text",tooltip:"Use either the name or a pattern. For example, {{instance}} is replaced with label value for the label instance.",children:(0,D.jsx)(S.p,{type:"text",placeholder:"{{instance}}",value:fe.textFormat,onChange:Qe=>{Te({...fe,textFormat:Qe.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.text})}),(0,D.jsx)(b.c,{label:"Series value as timestamp",tooltip:"The unit of timestamp is milliseconds. If the unit of the series value is seconds, multiply its range vector by 1000.",children:(0,D.jsx)(T.C,{value:fe.useValueForTime,onChange:Qe=>{Te({...fe,useValueForTime:Qe.currentTarget.value})},"data-testid":x.Tp.components.DataSource.Prometheus.annotations.seriesValueAsTimestamp})})]})]})}var B=e(50556),N=e(81996),I=e(32370),K=e(76040),w=e(62183);const U=/^label_names\(\)\s*$/,W=/^label_values\((?:(.+),\s*)?([a-zA-Z_$][a-zA-Z0-9_]*)\)\s*$/,H=/^metrics\((.+)\)\s*$/,z=/^query_result\((.+)\)\s*$/,G=/^label_names\((.+)\)\s*$/;function M(Ue){if(typeof Ue!="string")return Ue;const fe={refId:"PrometheusDatasource-VariableQuery",qryType:w.B4.LabelNames},Te=Ue.match(G);if(Te)return{...fe,qryType:w.B4.LabelNames,match:Te[1]};const Ge=Ue.match(U);if(Ge)return{...fe,qryType:w.B4.LabelNames};const Qe=Ue.match(/^label_values\(/);if(Qe){const ot=Ue.match(W),ft=ot?ot[2]:"",_e=ot?ot[1]:"";if(_e){const et=(0,K.u)(_e);return{...fe,qryType:w.B4.LabelValues,label:ft,metric:et.query.metric,labelFilters:et.query.labels}}else return{...fe,qryType:w.B4.LabelValues,label:ft}}const st=Ue.match(/^metrics\(/);if(st){const ot=Ue.match(H),ft=ot?ot[1]:"";return{...fe,qryType:w.B4.MetricNames,metric:ft}}const Xe=Ue.match(/^query_result\(/);if(Xe){const ot=Ue.match(z),ft=ot?ot[1]:"";return{...fe,qryType:w.B4.VarQueryResult,varQuery:ft}}return!Ge&&!Qe&&!st&&!Xe?{...fe,qryType:w.B4.SeriesQuery,seriesQuery:Ue}:fe}function Q(Ue){switch(Ue.qryType){case w.B4.LabelNames:return Ue.match?`label_names(${Ue.match})`:"label_names()";case w.B4.LabelValues:if(Ue.metric||Ue.labelFilters&&Ue.labelFilters.length!==0){const Te={metric:Ue.metric,labels:Ue.labelFilters??[],operations:[]};return`label_values(${I.z.renderQuery(Te)},${Ue.label})`}else return`label_values(${Ue.label})`;case w.B4.MetricNames:return`metrics(${Ue.metric})`;case w.B4.VarQueryResult:return`query_result(${Y(Ue.varQuery)})`;case w.B4.SeriesQuery:return Ue.seriesQuery??"";case w.B4.ClassicQuery:return Ue.classicQuery??""}return""}function Y(Ue){return Ue?Ue.replace(/[\r\n]+/gm,""):""}class q{constructor(fe,Te){this.datasource=fe,this.query=Te,this.datasource=fe,this.query=Te,this.range=(0,o.E2)()}process(fe){this.range=fe;const Te=U,Ge=G,Qe=/^label_values\((?:(.+),\s*)?([a-zA-Z_][a-zA-Z0-9_]*)\)\s*$/,st=H,Xe=z,ot=this.query.match(Te),ft=this.query.match(Ge);if(ft){const ze=`{__name__=~".*${ft[1]}.*"}`;return this.datasource.languageProvider.getSeriesLabels(ze,[]).then(xe=>xe.map(Oe=>({text:Oe})))}if(ot)return this.datasource.getTagKeys({filters:[],timeRange:fe});const _e=this.query.match(Qe);if(_e){const ze=_e[1],xe=_e[2];return te(ze)?this.labelValuesQuery(xe,ze):this.labelValuesQuery(xe)}const et=this.query.match(st);if(et)return this.metricNameQuery(et[1]);const it=this.query.match(Xe);return it?this.queryResultQuery(it[1]):["label_values()","metrics()","query_result()"].includes(this.query)?Promise.resolve([]):this.metricNameAndLabelsQuery(this.query)}labelValuesQuery(fe,Te){const Ge=(0,N.mv)(this.range.from,!1),Qe=(0,N.mv)(this.range.to,!0),st={...Te&&{"match[]":Te},start:Ge.toString(),end:Qe.toString()};if(!Te||this.datasource.hasLabelsMatchAPISupport()){const Xe=`/api/v1/label/${fe}/values`;return this.datasource.metadataRequest(Xe,st).then(ot=>(0,t.map)(ot.data.data,ft=>({text:ft})))}else return this.datasource.metadataRequest("/api/v1/series",st).then(ot=>{const ft=(0,t.map)(ot.data.data,_e=>_e[fe]||"").filter(_e=>_e!=="");return(0,t.uniq)(ft).map(_e=>({text:_e,expandable:!0}))})}metricNameQuery(fe){const Te=(0,N.mv)(this.range.from,!1),Ge=(0,N.mv)(this.range.to,!0),Qe={start:Te.toString(),end:Ge.toString()};return this.datasource.metadataRequest("/api/v1/label/__name__/values",Qe).then(Xe=>(0,t.chain)(Xe.data.data).filter(ot=>new RegExp(fe).test(ot)).map(ot=>({text:ot,expandable:!0})).value())}queryResultQuery(fe){const Te="/api/v1/query",Ge={query:fe,time:(0,N.mv)(this.range.to,!0).toString()};return this.datasource.metadataRequest(Te,Ge).then(Qe=>{switch(Qe.data.data.resultType){case"scalar":case"string":return[{text:Qe.data.data.result[1]||"",expandable:!1}];case"vector":return(0,t.map)(Qe.data.data.result,st=>{let Xe=st.metric.__name__||"";return delete st.metric.__name__,Xe+="{"+(0,t.map)(st.metric,(ot,ft)=>ft+'="'+ot+'"').join(",")+"}",Xe+=" "+st.value[1]+" "+st.value[0]*1e3,{text:Xe,expandable:!0}});default:throw Error(`Unknown/Unhandled result type: [${Qe.data.data.resultType}]`)}})}metricNameAndLabelsQuery(fe){const Te=(0,N.mv)(this.range.from,!1),Ge=(0,N.mv)(this.range.to,!0),Qe={"match[]":fe,start:Te.toString(),end:Ge.toString()},st="/api/v1/series",Xe=this;return this.datasource.metadataRequest(st,Qe).then(ot=>(0,t.map)(ot.data.data,ft=>({text:Xe.datasource.getOriginalMetricName(ft),expandable:!0})))}}function te(Ue){return Ue&&Ue.split(" ").join("")!=="{}"}const X=20;function ee(Ue,fe,Te){const Ge=[],Qe=Te?.languageProvider?.metricsMetadata;if(Ue.trim().match(/^\w+_bucket$|^\w+_bucket{.*}$/))Ge.push({type:"HISTOGRAM_QUANTILE",label:"Selected metric has buckets.",fix:{label:"Consider calculating aggregated quantile by adding histogram_quantile().",action:{type:"ADD_HISTOGRAM_QUANTILE",query:Ue}}});else if(Qe&&le(Ue)){const Xe=se(Ue),{nameMetric:ot}=de(Xe,"histogram",Qe,!1);if(ot){const _e="Selected metric is a native histogram.";Ge.push({type:"HISTOGRAM_AVG",label:_e,fix:{label:"Consider calculating the arithmetic average of observed values by adding histogram_avg().",action:{type:"ADD_HISTOGRAM_AVG",query:Ue}}},{type:"HISTOGRAM_COUNT",label:_e,fix:{label:"Consider calculating the count of observations by adding histogram_count().",action:{type:"ADD_HISTOGRAM_COUNT",query:Ue}}},{type:"HISTOGRAM_SUM",label:_e,fix:{label:"Consider calculating the sum of observations by adding histogram_sum().",action:{type:"ADD_HISTOGRAM_SUM",query:Ue}}},{type:"HISTOGRAM_FRACTION",label:_e,fix:{label:"Consider calculating the estimated fraction of observations between the provided lower and upper values by adding histogram_fraction().",action:{type:"ADD_HISTOGRAM_FRACTION",query:Ue}}},{type:"HISTOGRAM_STDDEV",label:_e,fix:{label:"Consider calculating the estimated standard deviation of observations by adding histogram_stddev().",action:{type:"ADD_HISTOGRAM_STDDEV",query:Ue}}},{type:"HISTOGRAM_STDVAR",label:_e,fix:{label:"Consider calculating the estimated standard variance of observations by adding histogram_stdvar().",action:{type:"ADD_HISTOGRAM_STDVAR",query:Ue}}})}}if(Ue.indexOf("rate(")===-1&&Ue.indexOf("increase(")===-1){const Xe=Ue.match(/\b((?<!:)\w+_(total|sum|count)(?!:))\b/);let ot=Xe?Xe[1]:"",ft=!1;if(Qe){const _e=se(Ue),et=de(_e,"counter",Qe,ft);ot=et.nameMetric,ft=et.certain}if(ot){const _e=le(Ue);let it=`Selected metric ${ft?"is":"looks like"} a counter.`,dt;_e?dt={label:"Consider calculating rate of counter by adding rate().",action:{type:"ADD_RATE",query:Ue}}:it=`${it} Consider calculating rate of counter by adding rate().`,Ge.push({type:"APPLY_RATE",label:it,fix:dt})}}if(Te&&Te.ruleMappings){const Xe=Z(Ue,Te.ruleMappings);Ge.push(...Xe)}return fe&&fe.length>=X&&Ue.trim().match(/^\w+$/)&&Ge.push({type:"ADD_SUM",label:"Many time series results returned.",fix:{label:"Consider aggregating with sum().",action:{type:"ADD_SUM",query:Ue,preventSubmit:!0}}}),Ge}function ne(Ue){const fe=[];return Ue.lookupsDisabled&&fe.push({label:"Labels and metrics lookup was disabled in data source settings.",type:"INFO"}),fe}function Z(Ue,fe){const Te=[],Ge=Object.keys(fe).reduce((Qe,st)=>{if(Ue.search(st)===-1)return Qe;if(fe[st].length>1){const{idx:Xe,expandedQuery:ot,identifier:ft,identifierValue:_e}=ae(Ue,st,fe[st]);return Xe===-1?(Te.push({type:"EXPAND_RULES_WARNING",label:"We found multiple recording rules that match in this query. To expand the recording rule, add an identifier label/value."}),Qe):{...Qe,[st]:{expandedQuery:ot,identifier:ft,identifierValue:_e}}}else return{...Qe,[st]:{expandedQuery:fe[st][0].query}}},{});return(0,t.size)(Ge)>0&&Te.push({type:"EXPAND_RULES",label:"Query contains recording rules.",fix:{label:"Expand rules",action:{type:"EXPAND_RULES",query:Ue,options:Ge}}}),Te}function ae(Ue,fe,Te){const{query:Ge}=(0,K.u)(Ue),Qe=re(fe,Ge);if(Qe.length===0)return{idx:-1,identifier:"",identifierValue:"",expandedQuery:""};let st="",Xe="",ot=-1;return Qe.forEach(ft=>{ot===-1&&ft.label.search("uuid")!==-1&&(st=ft.label,Xe=ft.value)}),Te.forEach((ft,_e)=>{ft.labels&&Object.entries(ft.labels).forEach(([et,it])=>{ot===-1&&et===st&&it===Xe&&(ot=_e)})}),{idx:ot,identifier:st,identifierValue:Xe,expandedQuery:Te[ot]?.query??""}}function re(Ue,fe){if(fe.metric===Ue)return fe.labels;if(fe.binaryQueries)for(let Te=0;Te<fe.binaryQueries.length;Te++){const Ge=re(Ue,fe.binaryQueries[Te].query);if(Ge&&Ge.length>0)return Ge}return[]}function se(Ue){return Array.from(Ue.matchAll(/\$?[a-zA-Z_:][a-zA-Z0-9_:]*/g)).map(([fe])=>fe).filter(fe=>!fe.startsWith("$")).flatMap(fe=>fe.split(":"))}function de(Ue,fe,Te,Ge){return{nameMetric:Ue.find(st=>{const Xe=Te[st];return Xe&&Xe.type.toLowerCase()===fe?(Ge=!0,!0):!1})??"",certain:Ge}}function le(Ue){return Ue.trim().match(/^\w+$|^\w+{.*}$/)}var he=e(33115),ie=e(59809),J=e(14110);function ce(Ue,fe,Te){const{app:Ge,targets:Qe}=fe;if(Ge===p.Jk.Explore)for(const st of Qe)(0,J.rR)("grafana_prometheus_query_executed",{app:Ge,grafana_version:P.$.buildInfo.version,has_data:Ue.data.some(Xe=>Xe.length>0),has_error:Ue.error!==void 0,expr:st.expr,format:st.format,instant:st.instant,range:st.range,exemplar:st.exemplar,hinting:st.hinting,interval:st.interval,intervalFactor:st.intervalFactor,utcOffsetSec:st.utcOffsetSec,legend:st.legendFormat,valueWithRefId:st.valueWithRefId,requestId:fe.requestId,showingGraph:st.showingGraph,showingTable:st.showingTable,editor_mode:st.editorMode,simultaneously_sent_query_count:Qe.length,time_range_from:fe?.range?.from?.toISOString(),time_range_to:fe?.range?.to?.toISOString(),time_taken:Date.now()-Te.getTime()})}var pe=e(62467),Pe=e(65474),Ie=e(29505),ge=e(76459),Se=e.n(ge),De=e(96540),Ke=e(50877),Me=e(39268),be=e(14186),we=e(90182),Be=e(21744),He=e(29993);const Ve=[{label:"Label names",value:w.B4.LabelNames},{label:"Label values",value:w.B4.LabelValues},{label:"Metrics",value:w.B4.MetricNames},{label:"Query result",value:w.B4.VarQueryResult},{label:"Series query",value:w.B4.SeriesQuery},{label:"Classic query",value:w.B4.ClassicQuery}],Je="PrometheusVariableQueryEditor-VariableQuery",nt=({onChange:Ue,query:fe,datasource:Te,range:Ge})=>{const[Qe,st]=(0,De.useState)(void 0),[Xe,ot]=(0,De.useState)(""),[ft,_e]=(0,De.useState)(""),[et,it]=(0,De.useState)(""),[dt,ze]=(0,De.useState)(""),[xe,Oe]=(0,De.useState)(""),[Le,Ze]=(0,De.useState)(""),[qe,rt]=(0,De.useState)([]),[vt,Ot]=(0,De.useState)([]);function jt(yn,wn){Ot([...wn,...yn]);const Jn=(0,N.ky)(yn);rt([...wn,...Jn])}const[Ut,zt]=(0,De.useState)([]);(0,De.useEffect)(()=>{Te.languageProvider.start(Ge)},[]),(0,De.useEffect)(()=>{if(fe)if(fe.qryType===w.B4.ClassicQuery)st(fe.qryType),Ze(fe.query??"");else{const yn=pt(fe);_e(yn.match??""),st(yn.qryType),ot(yn.label??""),it(yn.metric??""),zt(yn.labelFilters??[]),ze(yn.varQuery??""),Oe(yn.seriesQuery??""),Ze(yn.classicQuery??"")}},[fe]),(0,De.useEffect)(()=>{if(Qe!==w.B4.LabelValues)return;const yn=Te.getVariables().map(wn=>({label:wn,value:wn}));if(!et)Te.getTagKeys({filters:[]}).then(wn=>{const Jn=wn.map(({text:bn})=>({label:bn,value:bn}));jt(Jn,yn)});else{const wn=[{label:"__name__",op:"=",value:et}],Jn=I.z.renderLabels(wn);Te.languageProvider.fetchLabelsWithMatch(Jn).then(bn=>{const Ft=Object.keys(bn).map(Xt=>({label:Xt,value:Xt}));jt(Ft,yn)})}},[Te,Qe,et]);const qt=(yn,wn)=>{const Pt={...{qryType:Qe,label:Xe,metric:et,match:ft,varQuery:dt,seriesQuery:xe,classicQuery:Le,refId:"PrometheusVariableQueryEditor-VariableQuery"},...yn,...wn?{labelFilters:wn}:{labelFilters:Ut}},Ft=Q(Pt);Ue({query:Ft,qryType:Pt.qryType,refId:Je})},fn=yn=>{st(yn.value),yn.value!==w.B4.SeriesQuery&&qt({qryType:yn.value??0})},Sn=yn=>{const wn=yn&&yn.value?yn.value:"";ot(wn),Qe===w.B4.LabelValues&&wn&&qt({label:wn})},An=yn=>{it(yn.metric),zt(yn.labels);const wn=yn.metric,Jn=yn.labels??[];Qe===w.B4.LabelValues&&Xe&&(wn||Jn)&&qt({qryType:Qe,metric:wn},Jn)},Hn=yn=>{Qe===w.B4.LabelNames&&qt({qryType:Qe,match:yn})},es=yn=>{Qe===w.B4.MetricNames&&yn&&qt({metric:yn})},rs=yn=>{ze(yn.currentTarget.value)},Zn=yn=>{Oe(yn.currentTarget.value)},kn=yn=>{Ze(yn.currentTarget.value)},Gn=(0,De.useCallback)(()=>({metric:et,labels:Ut,operations:[]}),[et,Ut]),Kn=Se()(yn=>{const wn=vt.filter(Jn=>Jn.value?.includes(yn));return(0,N.ky)(wn)},300);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Query type",labelWidth:20,tooltip:(0,D.jsx)("div",{children:"The Prometheus data source plugin provides the following query types for template variables."}),children:(0,D.jsx)(we.l6,{placeholder:"Select query type","aria-label":"Query type",onChange:fn,value:Qe,options:Ve,width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.queryType})})}),Qe===w.B4.LabelValues&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Label",labelWidth:20,required:!0,"aria-labelledby":"label-select",tooltip:(0,D.jsx)("div",{children:"Returns a list of label values for the label name in all metrics unless the metric is specified."}),children:(0,D.jsx)(we.DW,{"aria-label":"label-select",onChange:Sn,value:Xe?(0,Ke.z)(Xe):null,defaultOptions:qe,width:25,allowCustomValue:!0,isClearable:!0,loadOptions:Kn,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelValues.labelSelect})})}),(0,D.jsx)(He.I,{query:Gn(),datasource:Te,onChange:An,variableEditor:!0})]}),Qe===w.B4.LabelNames&&(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric regex",tooltip:(0,D.jsx)("div",{children:"Returns a list of label names, optionally filtering by specified metric regex."}),children:(0,D.jsx)(S.p,{type:"text","aria-label":"Metric regex",placeholder:"Metric regex",value:ft,onBlur:yn=>{_e(yn.currentTarget.value),Hn(yn.currentTarget.value)},onChange:yn=>{_e(yn.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.labelnames.metricRegex})})}),Qe===w.B4.MetricNames&&(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Metric regex",labelWidth:20,"aria-labelledby":"Metric selector",tooltip:(0,D.jsx)("div",{children:"Returns a list of metrics matching the specified metric regex."}),children:(0,D.jsx)(S.p,{type:"text","aria-label":"Metric selector",placeholder:"Metric regex",value:et,onChange:yn=>{it(yn.currentTarget.value)},onBlur:yn=>{it(yn.currentTarget.value),es(yn.currentTarget.value)},width:25,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.metricNames.metricRegex})})}),Qe===w.B4.VarQueryResult&&(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Query",labelWidth:20,tooltip:(0,D.jsx)("div",{children:"Returns a list of Prometheus query results for the query. This can include Prometheus functions, i.e. sum(go_goroutines)."}),children:(0,D.jsx)(Be.f,{type:"text","aria-label":"Prometheus Query",placeholder:"Prometheus Query",value:dt,onChange:rs,onBlur:()=>{Qe===w.B4.VarQueryResult&&dt&&qt({qryType:Qe})},cols:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.varQueryResult})})}),Qe===w.B4.SeriesQuery&&(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Series Query",labelWidth:20,tooltip:(0,D.jsx)("div",{children:'Enter a metric with labels, only a metric or only labels, i.e. go_goroutines{instance="localhost:9090"}, go_goroutines, or {instance="localhost:9090"}. Returns a list of time series associated with the entered data.'}),children:(0,D.jsx)(S.p,{type:"text","aria-label":"Series Query",placeholder:"Series Query",value:xe,onChange:Zn,onBlur:()=>{Qe===w.B4.SeriesQuery&&xe&&qt({qryType:Qe})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.seriesQuery})})}),Qe===w.B4.ClassicQuery&&(0,D.jsx)(Me.C,{children:(0,D.jsx)(be.I,{label:"Classic Query",labelWidth:20,tooltip:(0,D.jsx)("div",{children:"The original implemetation of the Prometheus variable query editor. Enter a string with the correct query type and parameters as described in these docs. For example, label_values(label, metric)."}),children:(0,D.jsx)(S.p,{type:"text","aria-label":"Classic Query",placeholder:"Classic Query",value:Le,onChange:kn,onBlur:()=>{Qe===w.B4.ClassicQuery&&Le&&qt({qryType:Qe})},width:100,"data-testid":x.Tp.components.DataSource.Prometheus.variableQueryEditor.classicQuery})})})]})};function pt(Ue){return typeof Ue=="string"?M(Ue):Ue.query?M(Ue.query):Ue}class bt extends Ie.f5{constructor(fe,Te=(0,y.w)()){super(),this.datasource=fe,this.templateSrv=Te,this.editor=nt}query(fe){let Te;if(typeof fe.targets[0]=="string"?Te=fe.targets[0]:Te=fe.targets[0].query,!Te)return(0,pe.of)({data:[]});const Ge={...fe.scopedVars,__interval:{text:this.datasource.interval,value:this.datasource.interval},__interval_ms:{text:l.intervalToMs(this.datasource.interval),value:l.intervalToMs(this.datasource.interval)},...this.datasource.getRangeScopedVars(fe.range)},Qe=this.templateSrv.replace(Te,Ge,this.datasource.interpolateQueryExpr),st=new q(this.datasource,Qe);return(0,Pe.H)(st.process(fe.range)).pipe((0,s.T)(ot=>({data:ot})))}}const Tt="60s",ye=["api/v1/query","api/v1/query_range","api/v1/series","api/v1/labels","suggestions"],je="-Instant";class ue extends h.iy{constructor(fe,Te=(0,y.w)(),Ge){super(fe),this.templateSrv=Te,this.init=async()=>{this.disableRecordingRules||this.loadRules(),this.exemplarsAvailable=await this.areExemplarsAvailable()},this.processAnnotationResponse=(Qe,st)=>{const Xe=(0,f.bE)({data:st}).data;if(!Xe||!Xe.length)return[];const ot=Qe.annotation,{tagKeys:ft="",titleFormat:_e="",textFormat:et=""}=ot,it=l.intervalToSeconds(ot.step||Tt)*1e3,dt=ft.split(","),ze=[];for(const xe of Xe){if(xe.fields.length===0)continue;const Oe=xe.fields[0],Le=xe.fields[1],Ze=Le?.labels||{},qe=Object.keys(Ze).filter(zt=>dt.includes(zt)).map(zt=>Ze[zt]),rt=[];let vt=0;Le.values.forEach(zt=>{let qt,fn;const Sn=Oe.values[vt];Qe.annotation.useValueForTime?(qt=Math.floor(parseFloat(zt)),fn=1):(qt=Math.floor(parseFloat(Sn)),fn=parseFloat(zt)),vt++,rt.push([qt,fn])});const jt=rt.filter(zt=>zt[1]>0).map(zt=>zt[0]);let Ut=null;for(const zt of jt){if(Ut&&(Ut.timeEnd??0)+it>=zt){Ut.timeEnd=zt;continue}Ut&&ze.push(Ut),Ut={time:zt,timeEnd:zt,annotation:ot,title:(0,d.j)(_e,Ze),tags:qe,text:(0,d.j)(et,Ze)}}Ut&&(Ut.timeEnd=jt[jt.length-1],ze.push(Ut))}return ze},this.type="prometheus",this.id=fe.id,this.url=fe.url,this.access=fe.access,this.basicAuth=fe.basicAuth,this.withCredentials=!!fe.withCredentials,this.interval=fe.jsonData.timeInterval||"15s",this.httpMethod=fe.jsonData.httpMethod||"GET",this.exemplarTraceIdDestinations=fe.jsonData.exemplarTraceIdDestinations,this.hasIncrementalQuery=fe.jsonData.incrementalQuerying??!1,this.ruleMappings={},this.languageProvider=Ge??new B.Ay(this),this.lookupsDisabled=fe.jsonData.disableMetricsLookup??!1,this.customQueryParameters=new URLSearchParams(fe.jsonData.customQueryParameters),this.datasourceConfigurationPrometheusFlavor=fe.jsonData.prometheusType,this.datasourceConfigurationPrometheusVersion=fe.jsonData.prometheusVersion,this.defaultEditor=fe.jsonData.defaultEditor,this.disableRecordingRules=fe.jsonData.disableRecordingRules??!1,this.variables=new bt(this,this.templateSrv),this.exemplarsAvailable=!0,this.cacheLevel=fe.jsonData.cacheLevel??w.fD.Low,this.metricNamesAutocompleteSuggestionLimit=fe.jsonData.codeModeMetricNamesSuggestionLimit??B.OP,this.cache=new he.$i({getTargetSignature:this.getPrometheusTargetSignature.bind(this),overlapString:fe.jsonData.incrementalQueryOverlapWindow??he.Dr,applyInterpolation:this.interpolateString.bind(this)}),this.annotations={QueryEditor:j}}getQueryDisplayText(fe){return fe.expr}getPrometheusTargetSignature(fe,Te){return`${this.interpolateString(Te.expr)}|${Te.interval??fe.interval}|${JSON.stringify(fe.rangeRaw??"")}|${Te.exemplar}`}hasLabelsMatchAPISupport(){return this._isDatasourceVersionGreaterOrEqualTo("2.24.0",w.N1.Prometheus)||this._isDatasourceVersionGreaterOrEqualTo("2.0.0",w.N1.Mimir)||this._isDatasourceVersionGreaterOrEqualTo("1.11.0",w.N1.Cortex)||this._isDatasourceVersionGreaterOrEqualTo("0.18.0",w.N1.Thanos)}_isDatasourceVersionGreaterOrEqualTo(fe,Te){return!this.datasourceConfigurationPrometheusVersion||!this.datasourceConfigurationPrometheusFlavor?!0:Te!==this.datasourceConfigurationPrometheusFlavor?!1:i().gte(this.datasourceConfigurationPrometheusVersion,fe)}_addTracingHeaders(fe,Te){fe.headers={},this.access==="proxy"&&(fe.headers["X-Dashboard-UID"]=Te.dashboardUID,fe.headers["X-Panel-Id"]=Te.panelId)}directAccessError(){return(0,n.$)(()=>new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode."))}_request(fe,Te,Ge={}){if(this.access==="direct")return this.directAccessError();Te=Te||{};for(const[Xe,ot]of this.customQueryParameters)Te[Xe]==null&&(Te[Xe]=ot);let Qe=this.url+fe;fe.startsWith(`/api/datasources/uid/${this.uid}`)&&(Qe=fe);const st=(0,t.defaults)(Ge,{url:Qe,method:this.httpMethod,headers:{}});return st.method==="GET"?Te&&Object.keys(Te).length&&(st.url=st.url+(st.url.search(/\?/)>=0?"&":"?")+Object.entries(Te).map(([Xe,ot])=>`${encodeURIComponent(Xe)}=${encodeURIComponent(ot)}`).join("&")):(st.headers["Content-Type"]||(st.headers["Content-Type"]="application/x-www-form-urlencoded"),st.data=Te),(this.basicAuth||this.withCredentials)&&(st.withCredentials=!0),this.basicAuth&&(st.headers.Authorization=this.basicAuth),(0,v.AI)().fetch(st)}async importFromAbstractQueries(fe){return fe.map(Te=>this.languageProvider.importFromAbstractQuery(Te))}async exportToAbstractQueries(fe){return fe.map(Te=>this.languageProvider.exportToAbstractQuery(Te))}async metadataRequest(fe,Te={},Ge){if(ye.some(Qe=>fe.includes(Qe)))try{return await(0,r.s)(this._request(`/api/datasources/uid/${this.uid}/resources${fe}`,Te,{method:this.httpMethod,hideFromInspector:!0,showErrorAlert:!1,...Ge}))}catch(Qe){if(this.httpMethod==="POST"&&(0,v.NF)(Qe)&&(Qe.status===405||Qe.status===400))console.warn("Couldn't use configured POST HTTP method for this request. Trying to use GET method instead.");else throw Qe}return await(0,r.s)(this._request(`/api/datasources/uid/${this.uid}/resources${fe}`,Te,{method:"GET",hideFromInspector:!0,...Ge}))}interpolateQueryExpr(fe=[],Te){if(!Te.multi&&!Te.includeAll)return Ne(fe);if(typeof fe=="string")return Fe(fe);const Ge=fe.map(Qe=>Fe(Qe));return Ge.length===1?Ge[0]:"("+Ge.join("|")+")"}targetContainsTemplate(fe){return this.templateSrv.containsTemplate(fe.expr)}shouldRunExemplarQuery(fe,Te){if(fe.exemplar){const Ge=this.languageProvider.histogramMetrics.find(Xe=>fe.expr.includes(Xe)),Qe=Te.targets.findIndex(Xe=>Xe.refId===fe.refId),st=Te.targets.slice(0,Qe).filter(Xe=>!Xe.hide);return!!(!Ge||Ge&&!st.some(Xe=>Xe.expr.includes(Ge)))}return!1}processTargetV2(fe,Te){const Ge=[],Qe={...fe,exemplar:this.shouldRunExemplarQuery(fe,Te),requestId:Te.panelId+fe.refId,utcOffsetSec:Te.range.to.utcOffset()*60};return P.$.featureToggles.promQLScope&&(Qe.scopes=(Te.scopes??[]).map(st=>({name:st.metadata.name,...st.spec}))),P.$.featureToggles.groupByVariable&&(Qe.groupByKeys=Te.groupByKeys),fe.instant&&fe.range?Ge.push({...Qe,refId:Qe.refId,instant:!1},{...Qe,refId:Qe.refId+je,range:!1}):Ge.push(Qe),Ge}query(fe){if(this.access==="direct")return this.directAccessError();let Te,Ge;const Qe=fe.targets.some(ot=>ot.instant);this.hasIncrementalQuery&&!Qe?(Ge=this.cache.requestInfo(fe),Te=Ge.requests[0]):Te=fe;const st=Te.targets.map(ot=>this.processTargetV2(ot,Te)),Xe=new Date;return super.query({...Te,targets:st.flat()}).pipe((0,s.T)(ot=>{const ft={...ot,data:this.cache.procFrames(fe,Ge,ot.data)};return(0,ie.J3)(ft,fe,{exemplarTraceIdDestinations:this.exemplarTraceIdDestinations})}),(0,a.M)(ot=>{ce(ot,fe,Xe)}))}metricFindQuery(fe,Te){if(!fe)return Promise.resolve([]);const Ge={...this.getIntervalVars(),...this.getRangeScopedVars(Te?.range??(0,o.E2)())},Qe=this.templateSrv.replace(fe,Ge,this.interpolateQueryExpr);return new q(this,Qe).process(Te?.range??(0,o.E2)())}getIntervalVars(){return{__interval:{text:this.interval,value:this.interval},__interval_ms:{text:l.intervalToMs(this.interval),value:l.intervalToMs(this.interval)}}}getRangeScopedVars(fe){const Te=fe.to.diff(fe.from),Ge=Math.round(Te/1e3);return{__range_ms:{text:Te,value:Te},__range_s:{text:Ge,value:Ge},__range:{text:Ge+"s",value:Ge+"s"}}}async annotationQuery(fe){if(this.access==="direct"){const Xe=new Error("Browser access mode in the Prometheus datasource is no longer available. Switch to server access mode.");return Promise.reject(Xe)}const Te=fe.annotation,{expr:Ge=""}=Te;if(!Ge)return Promise.resolve([]);const Qe=fe.annotation.step||Tt,st={expr:Ge,range:!0,instant:!1,exemplar:!1,interval:Qe,refId:"X",datasource:this.getRef()};return await(0,r.s)((0,v.AI)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:((0,N.mv)(fe.range.from,!1)*1e3).toString(),to:((0,N.mv)(fe.range.to,!0)*1e3).toString(),queries:[this.applyTemplateVariables(st,{})]},requestId:`prom-query-${Te.name}`}).pipe((0,s.T)(Xe=>this.processAnnotationResponse(fe,Xe.data))))}async getTagKeys(fe){if(P.$.featureToggles.promQLScope&&fe)return(await this.languageProvider.fetchSuggestions(fe.timeRange,fe.queries,fe.scopes,fe.filters)).filter(Xe=>!!Xe&&!fe.filters.find(ot=>ot.key===Xe)).map(Xe=>({value:Xe,text:Xe}));if(!fe||fe.filters.length===0)return await this.languageProvider.fetchLabels(fe.timeRange,fe.queries),this.languageProvider.getLabelKeys().map(st=>({value:st,text:st}));const Te=fe.filters.map(st=>({label:st.key,value:st.value,op:st.operator})),Ge=I.z.renderLabels(Te);let Qe=await this.languageProvider.fetchLabelsWithMatch(Ge);return Object.keys(Qe).filter(st=>!fe.filters.find(Xe=>Xe.key===st)).map(st=>({value:st,text:st}))}async getTagValues(fe){const Te=`[${this.uid}][${fe.key}]`;if(P.$.featureToggles.promQLScope)return(await this.languageProvider.fetchSuggestions(fe.timeRange,fe.queries,fe.scopes,fe.filters,fe.key,void 0,Te)).map(ot=>({value:ot,text:ot}));const Ge=fe.filters.map(ot=>({label:ot.key,value:ot.value,op:ot.operator})),Qe=I.z.renderLabels(Ge);if(this.hasLabelsMatchAPISupport())return(await this.languageProvider.fetchSeriesValuesWithMatch(fe.key,Qe,Te,fe.timeRange)).map(ot=>({value:ot,text:ot}));const st=this.getTimeRangeParams(fe.timeRange??(0,o.E2)());return(await this.metadataRequest(`/api/v1/label/${fe.key}/values`,st))?.data?.data?.map(ot=>({text:ot}))??[]}interpolateVariablesInQueries(fe,Te,Ge){let Qe=fe;return fe&&fe.length&&(Qe=fe.map(st=>{const Xe=this.templateSrv.replace(st.expr,Te,this.interpolateQueryExpr),ot=P.$.featureToggles.promQLScope?Xe:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ge,Xe),Te,this.interpolateQueryExpr);return{...st,...P.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ge)}:{},datasource:this.getRef(),expr:ot,interval:this.templateSrv.replace(st.interval,Te)}})),Qe}getQueryHints(fe,Te){return ee(fe.expr??"",Te,this)}getInitHints(){return ne(this)}async loadRules(){try{const Te=(await this.metadataRequest("/api/v1/rules",{},{showErrorAlert:!1})).data?.data?.groups;Te&&(this.ruleMappings=Ce(Te))}catch(fe){console.log("Rules API is experimental. Ignore next error."),console.error(fe)}}async areExemplarsAvailable(){try{return(await this.metadataRequest("/api/v1/query_exemplars",{query:"test",start:(0,u.KQ)().subtract(30,"minutes").valueOf().toString(),end:(0,u.KQ)().valueOf().toString()},{showErrorAlert:!1})).data.status==="success"}catch{return!1}}modifyQuery(fe,Te){let Ge=fe.expr??"";switch(Te.type){case"ADD_FILTER":{const{key:Qe,value:st}=Te.options??{};Qe&&st&&(Ge=(0,m.t)(Ge,Qe,st));break}case"ADD_FILTER_OUT":{const{key:Qe,value:st}=Te.options??{};Qe&&st&&(Ge=(0,m.t)(Ge,Qe,st,"!="));break}case"ADD_HISTOGRAM_QUANTILE":{Ge=`histogram_quantile(0.95, sum(rate(${Ge}[$__rate_interval])) by (le))`;break}case"ADD_HISTOGRAM_AVG":{Ge=`histogram_avg(rate(${Ge}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_FRACTION":{Ge=`histogram_fraction(0,0.2,rate(${Ge}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_COUNT":{Ge=`histogram_count(rate(${Ge}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_SUM":{Ge=`histogram_sum(rate(${Ge}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDDEV":{Ge=`histogram_stddev(rate(${Ge}[$__rate_interval]))`;break}case"ADD_HISTOGRAM_STDVAR":{Ge=`histogram_stdvar(rate(${Ge}[$__rate_interval]))`;break}case"ADD_RATE":{Ge=`rate(${Ge}[$__rate_interval])`;break}case"ADD_SUM":{Ge=`sum(${Ge.trim()}) by ($1)`;break}case"EXPAND_RULES":{Te.options&&(Ge=(0,N.P_)(Ge,Te.options));break}default:break}return{...fe,expr:Ge}}getAdjustedInterval(fe){return(0,N.Xd)(this.cacheLevel,fe)}getTimeRangeParams(fe){return{start:(0,N.mv)(fe.from,!1).toString(),end:(0,N.mv)(fe.to,!0).toString()}}getOriginalMetricName(fe){return(0,ie.hF)(fe)}generateScopeFilters(fe){return fe?fe.map(Te=>({key:Te.key,operator:c.n[Te.operator],value:this.templateSrv.replace(Te.value,{},this.interpolateQueryExpr),values:Te.values?.map(Ge=>this.templateSrv.replace(Ge,{},this.interpolateQueryExpr))})):[]}enhanceExprWithAdHocFilters(fe,Te){return!fe||fe.length===0?Te:fe.reduce((Qe,st)=>{const{key:Xe,operator:ot}=st;let{value:ft}=st;return(ot==="=~"||ot==="!~")&&(ft=Ne(ft)),(0,m.t)(Qe,Xe,ft,ot)},Te)}filterQuery(fe){return!(fe.hide||!fe.expr)}applyTemplateVariables(fe,Te,Ge){const Qe={...Te};Qe.__interval={value:"$__interval"},Qe.__interval_ms={value:"$__interval_ms"};const st=this.templateSrv.replace(fe.expr,Qe,this.interpolateQueryExpr),Xe=P.$.featureToggles.promQLScope?st:this.templateSrv.replace(this.enhanceExprWithAdHocFilters(Ge,st),Qe,this.interpolateQueryExpr);return{...fe,...P.$.featureToggles.promQLScope?{adhocFilters:this.generateScopeFilters(Ge)}:{},expr:Xe,interval:this.templateSrv.replace(fe.interval,Qe),legendFormat:this.templateSrv.replace(fe.legendFormat,Qe)}}getVariables(){return this.templateSrv.getVariables().map(fe=>`$${fe.name}`)}interpolateString(fe,Te){return this.templateSrv.replace(fe,Te,this.interpolateQueryExpr)}getDebounceTimeInMilliseconds(){switch(this.cacheLevel){case w.fD.Medium:return 600;case w.fD.High:return 1200;default:return 350}}getDaysToCacheMetadata(){switch(this.cacheLevel){case w.fD.Medium:return 7;case w.fD.High:return 30;default:return 1}}getCacheDurationInMinutes(){return(0,N.u3)(this.cacheLevel)}getDefaultQuery(fe){const Te={refId:"A",expr:"",range:!0,instant:!1};return fe===p.Jk.UnifiedAlerting?{...Te,instant:!0,range:!1}:fe===p.Jk.Explore?{...Te,instant:!0,range:!0}:Te}}function Ee(Ue,fe,Te,Ge){const Qe=Math.floor((fe+Ge)/Te)*Te-Ge,st=Math.floor((Ue+Ge)/Te)*Te-Ge;return{end:Qe,start:st}}function Ce(Ue){return Ue.reduce((fe,Te)=>Te.rules.filter(Ge=>Ge.type==="recording").reduce((Ge,Qe)=>{const st=Ge[Qe.name]??[];return st.push({query:Qe.query,labels:Qe.labels}),Ge[Qe.name]=st,Ge},fe),{})}function Ne(Ue){return typeof Ue=="string"?Ue.replace(/\\/g,"\\\\").replace(/'/g,"\\\\'"):Ue}function Fe(Ue){return typeof Ue=="string"?Ue.replace(/\\/g,"\\\\\\\\").replace(/[$^*{}\[\]\'+?.()|]/g,"\\\\$&"):Ue}},50556:(_,L,e)=>{"use strict";e.d(L,{AU:()=>D,Ay:()=>C,OP:()=>f,pK:()=>m,xB:()=>P});var t=e(2543),n=e.n(t),r=e(28848),s=e.n(r),a=e(40187),g=e(43127),i=e(37891),l=e(73372),d=e(91396),o=e(81996),u=e(20719),c=e(76040),p=e(62183);const h=["job","instance"],y="{}",f=1e4,v=A=>({headers:{"X-Grafana-Cache":`private, max-age=${A}`}});function P(A,R){if(!R[A])return;const{type:S,help:O}=R[A];return`${S.toUpperCase()}: ${O}`}function m(A,R){if(R[A])return R[A].help}function D(A,R){if(R[A])return R[A].type}const x=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,E=86400;class C extends a.Is{constructor(R,S){super(),this.labelKeys=[],this.request=async(O,j,B={},N)=>{try{return(await this.datasource.metadataRequest(O,B,N)).data.data}catch(I){T(I)||console.error(I)}return j},this.start=async O=>(this.timeRange=O??(0,g.E2)(),this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,o.Rg)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()]))),this.fetchLabelValues=async O=>{const j=this.datasource.getAdjustedInterval(this.timeRange),N=`/api/v1/label/${this.datasource.interpolateString(O)}/values`;return await this.request(N,[],j,this.getDefaultCacheHeaders())??[]},this.fetchLabels=async(O,j)=>{O&&(this.timeRange=O);let B="/api/v1/labels";const N=this.datasource.getAdjustedInterval(this.timeRange);this.labelFetchTs=Date.now().valueOf();const I=new URLSearchParams({...N});j?.forEach(w=>{const U=(0,c.u)(w.expr);U.query.metric!==""&&(I.append("match[]",U.query.metric),U.query.binaryQueries&&U.query.binaryQueries.forEach(W=>{I.append("match[]",W.query.metric)}))}),this.datasource.httpMethod==="GET"&&(B+=`?${I.toString()}`);const K=await this.request(B,[],I,this.getDefaultCacheHeaders());return Array.isArray(K)&&(this.labelKeys=K.slice().sort()),[]},this.getSeriesValues=async(O,j)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(O,j):(await this.getSeries(j))[O]??[],this.fetchSeriesValuesWithMatch=async(O,j,B,N=this.timeRange)=>{const I=O?this.datasource.interpolateString(O):null,K=j?this.datasource.interpolateString(j):null,U={...this.datasource.getAdjustedInterval(N),...K&&{"match[]":K}};let W={...this.getDefaultCacheHeaders(),...B&&{requestId:B}};return Object.keys(W).length||(W=void 0),await this.request(`/api/v1/label/${I}/values`,[],U,W)??[]},this.getSeriesLabels=async(O,j)=>{let B,N;this.datasource.hasLabelsMatchAPISupport()?(j.push({name:"__name__",value:"",op:"!="}),N=await this.fetchSeriesLabelsMatch(O),B=Object.keys(N)):(N=await this.getSeries(O),B=Object.keys(N));const I=new Set(j.map(K=>K.name));return B.filter(K=>!I.has(K))},this.fetchLabelsWithMatch=async(O,j)=>this.datasource.hasLabelsMatchAPISupport()?this.fetchSeriesLabelsMatch(O,j):this.fetchSeriesLabels(O,j,d.bS),this.fetchSeriesLabels=async(O,j,B)=>{const N=this.datasource.interpolateString(O);let K={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":N};B!=="none"&&(K={...K,limit:B??d._N});const U=await this.request("/api/v1/series",[],K,this.getDefaultCacheHeaders()),{values:W}=(0,o.P7)(U,j);return W},this.fetchSeriesLabelsMatch=async(O,j)=>{const B=this.datasource.interpolateString(O),I={...this.datasource.getAdjustedInterval(this.timeRange),"match[]":B};return(await this.request("/api/v1/labels",[],I,this.getDefaultCacheHeaders())).reduce((U,W)=>({...U,[W]:""}),{})},this.fetchSeries=async O=>{const j="/api/v1/series",N={...this.datasource.getTimeRangeParams(this.timeRange),"match[]":O};return await this.request(j,{},N,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,t.once)(async()=>{const O=await Promise.all(h.map(j=>this.fetchLabelValues(j)));return h.reduce((j,B,N)=>({...j,[B]:O[N]}),{})}),this.fetchSuggestions=async(O,j,B,N,I,K,w)=>{O&&(this.timeRange=O);const U="/suggestions",W=this.datasource.getAdjustedInterval(this.timeRange);return await this.request(U,[],{labelName:I,queries:j?.map(z=>this.datasource.interpolateString(z.expr,{...this.datasource.getIntervalVars(),...this.datasource.getRangeScopedVars(this.timeRange)})),scopes:B?.reduce((z,G)=>(z.push(...G.spec.filters),z),[]),adhocFilters:N?.map(z=>({key:z.key,operator:i.n[z.operator],value:z.value,values:z.values})),limit:K,...W},{...w&&{requestId:w},headers:{...this.getDefaultCacheHeaders()?.headers,"Content-Type":"application/json"},method:"POST"})??[]},this.datasource=R,this.histogramMetrics=[],this.timeRange=(0,g.E2)(),this.metrics=[],Object.assign(this,S)}getDefaultCacheHeaders(){if(this.datasource.cacheLevel!==p.fD.None)return v(this.datasource.getCacheDurationInMinutes()*60)}cleanText(R){return R.split(x).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return u.Ay}async loadMetricsMetadata(){const R=v(this.datasource.getDaysToCacheMetadata()*E);this.metricsMetadata=(0,o.DX)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...R}))}getLabelKeys(){return this.labelKeys}importFromAbstractQuery(R){return(0,o.pt)(R)}exportToAbstractQuery(R){const S=R.expr;if(!S||S.length===0)return{refId:R.refId,labelMatchers:[]};const O=s().tokenize(S,u.Ay),j=(0,o.VH)(O),B=b(S,O);return B&&B.length>0&&j.push({name:"__name__",operator:l.D_.Equal,value:B}),{refId:R.refId,labelMatchers:j}}async getSeries(R,S){if(this.datasource.lookupsDisabled)return{};try{return R===y?await this.fetchDefaultSeries():await this.fetchSeriesLabels(R,S,d.bS)}catch(O){return console.error(O),{}}}async getLabelValues(R){return await this.fetchLabelValues(R)}}function b(A,R){let S="";for(const O of R)if(typeof O=="string"){S=O;break}return S}function T(A){return typeof A=="object"&&A!==null&&"cancelled"in A&&A.cancelled===!0}},81996:(_,L,e)=>{"use strict";e.d(L,{Cs:()=>S,DX:()=>m,P7:()=>p,P_:()=>v,Qn:()=>R,Rg:()=>c,VH:()=>K,Xd:()=>w,eN:()=>D,ky:()=>H,mv:()=>W,pt:()=>N,u3:()=>U});var t=e(2543),n=e.n(t),r=e(28848),s=e.n(r),a=e(73372),g=e(77678),i=e(85858),l=e(80937),d=e(50556),o=e(9103),u=e(62183);const c=z=>{const G=new Set,M=new RegExp("_bucket($|:)");for(let Q=0;Q<z.length;Q++){const Y=z[Q];M.test(Y)&&G.add(Y)}return[...G]};function p(z,G=!1){const M={};z.forEach(Y=>{const{__name__:q,...te}=Y;G&&(M.__name__=M.__name__||new Set,M.__name__.has(q)||M.__name__.add(q)),Object.keys(te).forEach(X=>{M[X]||(M[X]=new Set),M[X].has(te[X])||M[X].add(te[X])})});const Q={};return C(Object.keys(M)).forEach(Y=>{Q[Y]=C(Array.from(M[Y]))}),{values:Q,keys:Object.keys(Q)}}const h=/\{[^}]*?(\}|$)/,y=/\b(\w+)(!?=~?)("[^"\n]*?")(,)?(\s*)?/g;function f(z,G=1){if(!z.match(h)){if(z.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${z}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+z)}const M=z.slice(0,G),Q=M.lastIndexOf("{"),Y=M.lastIndexOf("}");if(Q===-1)throw new Error("Not inside selector, missing open brace: "+M);if(Y>-1&&Y>Q)throw new Error("Not inside selector, previous selector already closed: "+M);const q=z.slice(G),X=q.indexOf("}")+G,ee=q.indexOf("{"),ne=ee+G;if(X===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+q);if(ee>-1&&ne<X)throw new Error("Not inside selector, next selector opens before this one closed: "+q);const Z=z.slice(Q,X),ae={};Z.replace(y,(ie,J,ce,pe)=>{const Pe=z.indexOf(ie),Ie=Pe+J.length+ce.length+1,ge=Pe+J.length+ce.length+pe.length-1;return(G<Ie||G>ge)&&(ae[J]={value:pe,operator:ce}),""});const se=z.slice(0,Q).match(/[A-Za-z:][\w:]*$/);se&&(ae.__name__={value:`"${se[0]}"`,operator:"="});const de=Object.keys(ae).sort(),he=["{",de.map(ie=>`${ie}${ae[ie].operator}${ae[ie].value}`).join(","),"}"].join("");return{labelKeys:de,selector:he}}function v(z,G){const M=te=>new RegExp(`(\\s|\\(|^)(${te})(\\s|$|\\(|\\[|\\{)`,"ig"),Q=Object.keys(G).reduce((te,X)=>{let ee=[],ne=[],Z=[];return te.filter(Boolean).forEach((ae,re)=>{ae.match(M(X))&&(ee=ae.split(X),ee.length===2?(Z.push(re),ne.push(...[ee[0],X,ee[1]].filter(Boolean))):ee.length>2&&(Z.push(re),ee=ee.map(de=>de===""?X:de),ne.push(...ee)))}),Z.forEach(ae=>te[ae]=""),te=te.filter(Boolean),te.push(...ne),te},[z]);let Y=!1;return Q.map((te,X)=>{if(Y)return Y=!1,"";if(G[te]){const{expandedQuery:ee,identifierValue:ne,identifier:Z}=G[te];if(X+1!==Q.length&&Q[X+1].match(y)){Y=!0;const ae=new RegExp(`(,)?(\\s)?(${Z}=\\"${ne}\\")(,)?(\\s)?`,"g"),re=Q[X+1].replace(ae,""),se=/(\)\{|\}\{|\]\{)/;return P(ee+re,se)}else return ee}return te}).filter(Boolean).join("")}function P(z,G){const M=z.match(G);if(!M)return z;const Q=M.index??0,Y=z.slice(0,Q+1),q=z.slice(Q+1),te=[];q.replace(y,(Z,ae,re,se,de,le)=>(te.push({key:ae,operator:re,value:se,comma:de,space:le}),""));let X=Y;te.filter(Boolean).forEach(Z=>{const ae=Z.value.slice(1,-1);X=(0,l.t)(X,Z.key,ae,Z.operator)});let ee=te.reduce((Z,ae)=>(Z+=`${ae.key}${ae.operator}${ae.value}${ae.comma??""}${ae.space??""}`,Z),"");ee="{"+ee+"}";const ne=q.replace(ee,"");return X+ne}function m(z){if(!z)return z;const G={},M={};for(const Y in z){const q=z[Y][0];G[Y]=q,q.type==="histogram"&&(M[`${Y}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${q.help})`},M[`${Y}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${q.help})`},M[`${Y}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${q.help})`}),q.type==="summary"&&(M[`${Y}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${q.help})`},M[`${Y}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${q.help})`})}const Q={};return Q.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...G,...M,...Q}}function D(z){return x(z/1e3)}function x(z){return Math.floor(z/60)}function E(z,G=1){return Math.ceil(z/60)-Math.ceil(z/60)%G}function C(z){return z.slice(0,d.OP)}function b(z){return z&&z.length>=SUGGESTIONS_LIMIT?`, limited to the first ${SUGGESTIONS_LIMIT} received items`:""}const T=/[*+?()|\\.\[\]{}^$]/g;function A(z){return z.replace(T,"\\$&")}function R(z){return z.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function S(z){return R(A(z))}const O={"=":a.D_.Equal,"!=":a.D_.NotEqual,"=~":a.D_.EqualRegEx,"!~":a.D_.NotEqualRegEx},j=(0,t.invert)(O);function B(z){const G=z.labelMatchers.map(M=>{const Q=j[M.operator];return Q?`${M.name}${Q}"${M.value}"`:""}).filter(M=>M!=="").join(", ");return G?`{${G}}`:""}function N(z){return{refId:z.refId,expr:B(z),range:!0}}function I(z){return typeof z.content=="string"?z.content:""}function K(z){const G=[];for(const M of z)if(M instanceof r.Token&&M.type==="context-labels"){let Q="",Y="",q="";const te=Array.isArray(M.content)?M.content:[M.content];for(let X of te)if(typeof X=="string"){let ee;ee=X,(ee==="="||ee==="!="||ee==="=~"||ee==="!~")&&(q=ee)}else if(X instanceof r.Token)switch(X.type){case"label-key":Q=I(X);break;case"label-value":Y=I(X),Y=Y.substring(1,Y.length-1);const ee=O[q];ee&&G.push({name:Q,operator:ee,value:Y});break}}return G}function w(z,G){if(z===u.fD.None)return{start:W(G.from,!1).toString(),end:W(G.to,!0).toString()};const M=W(G.from,!1),Q=(0,g.rs)(M,U(z)*60),Y=W(G.to,!0),q=E(Y,U(z))*60;if(Q===q){const ee=q+U(z)*60;return{start:Q.toString(),end:ee.toString()}}const te=Q.toString(),X=q.toString();return{start:te,end:X}}function U(z){switch(z){case u.fD.Medium:return 10;case u.fD.High:return 60;default:return 1}}function W(z,G){return typeof z=="string"&&(z=i.parse(z,G)),Math.ceil(z.valueOf()/1e3)}function H(z,G){return G===void 0&&(G=o.o6),z.length=Math.min(z.length,G),z}},20719:(_,L,e)=>{"use strict";e.d(L,{AW:()=>g,Ay:()=>d,n6:()=>l});const t=[{label:"$__interval",sortValue:"$__interval"},{label:"$__rate_interval",sortValue:"$__rate_interval"},{label:"$__range",sortValue:"$__range"},{label:"1m",sortValue:"00:01:00"},{label:"5m",sortValue:"00:05:00"},{label:"10m",sortValue:"00:10:00"},{label:"30m",sortValue:"00:30:00"},{label:"1h",sortValue:"01:00:00"},{label:"1d",sortValue:"24:00:00"}],n=["by","group_left","group_right","ignoring","on","offset","without"],r=null,s=[{label:"acos",insertText:"acos",detail:"acos(v instant-vector)",documentation:"calculates the arccosine of all elements in v"},{label:"acosh",insertText:"acosh",detail:"acosh(v instant-vector)",documentation:"calculates the inverse hyperbolic cosine of all elements in v"},{label:"asin",insertText:"asin",detail:"asin(v instant-vector)",documentation:"calculates the arcsine of all elements in v"},{label:"asinh",insertText:"asinh",detail:"asinh(v instant-vector)",documentation:"calculates the inverse hyperbolic sine of all elements in v"},{label:"atan",insertText:"atan",detail:"atan(v instant-vector)",documentation:"calculates the arctangent of all elements in v"},{label:"atanh",insertText:"atanh",detail:"atanh(v instant-vector)",documentation:"calculates the inverse hyperbolic tangent of all elements in v"},{label:"cos",insertText:"cos",detail:"cos(v instant-vector)",documentation:"calculates the cosine of all elements in v"},{label:"cosh",insertText:"cosh",detail:"cosh(v instant-vector)",documentation:"calculates the hyperbolic cosine of all elements in v"},{label:"sin",insertText:"sin",detail:"sin(v instant-vector)",documentation:"calculates the sine of all elements in v"},{label:"sinh",insertText:"sinh",detail:"sinh(v instant-vector)",documentation:"calculates the hyperbolic sine of all elements in v"},{label:"tan",insertText:"tan",detail:"tan(v instant-vector)",documentation:"calculates the tangent of all elements in v"},{label:"tanh",insertText:"tanh",detail:"tanh(v instant-vector)",documentation:"calculates the hyperbolic tangent of all elements in v"}],g=[...[{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"group",insertText:"group",documentation:"All values in the resulting vector are 1"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"count_values",insertText:"count_values",documentation:"Count number of elements with the same value"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"},{label:"quantile",insertText:"quantile",documentation:"Calculate \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) over dimensions"}],...s,{insertText:"abs",label:"abs",detail:"abs(v instant-vector)",documentation:"Returns the input vector with all sample values converted to their absolute value."},{insertText:"absent",label:"absent",detail:"absent(v instant-vector)",documentation:"Returns an empty vector if the vector passed to it has any elements and a 1-element vector with the value 1 if the vector passed to it has no elements. This is useful for alerting on when no time series exist for a given metric name and label combination."},{insertText:"absent_over_time",label:"absent_over_time",detail:"absent(v range-vector)",documentation:"Returns an empty vector if the range vector passed to it has any elements and a 1-element vector with the value 1 if the range vector passed to it has no elements."},{insertText:"ceil",label:"ceil",detail:"ceil(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` up to the nearest integer."},{insertText:"changes",label:"changes",detail:"changes(v range-vector)",documentation:"For each input time series, `changes(v range-vector)` returns the number of times its value has changed within the provided time range as an instant vector."},{insertText:"clamp",label:"clamp",detail:"clamp(v instant-vector, min scalar, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min` and an upper limit of `max`."},{insertText:"clamp_max",label:"clamp_max",detail:"clamp_max(v instant-vector, max scalar)",documentation:"Clamps the sample values of all elements in `v` to have an upper limit of `max`."},{insertText:"clamp_min",label:"clamp_min",detail:"clamp_min(v instant-vector, min scalar)",documentation:"Clamps the sample values of all elements in `v` to have a lower limit of `min`."},{insertText:"count_scalar",label:"count_scalar",detail:"count_scalar(v instant-vector)",documentation:"Returns the number of elements in a time series vector as a scalar. This is in contrast to the `count()` aggregation operator, which always returns a vector (an empty one if the input vector is empty) and allows grouping by labels via a `by` clause."},{insertText:"deg",label:"deg",detail:"deg(v instant-vector)",documentation:"Converts radians to degrees for all elements in v"},{insertText:"day_of_month",label:"day_of_month",detail:"day_of_month(v=vector(time()) instant-vector)",documentation:"Returns the day of the month for each of the given times in UTC. Returned values are from 1 to 31."},{insertText:"day_of_week",label:"day_of_week",detail:"day_of_week(v=vector(time()) instant-vector)",documentation:"Returns the day of the week for each of the given times in UTC. Returned values are from 0 to 6, where 0 means Sunday etc."},{insertText:"day_of_year",label:"day_of_year",detail:"day_of_year(v=vector(time()) instant-vector)",documentation:"Returns the day of the year for each of the given times in UTC. Returned values are from 1 to 365 for non-leap years, and 1 to 366 in leap years."},{insertText:"days_in_month",label:"days_in_month",detail:"days_in_month(v=vector(time()) instant-vector)",documentation:"Returns number of days in the month for each of the given times in UTC. Returned values are from 28 to 31."},{insertText:"delta",label:"delta",detail:"delta(v range-vector)",documentation:"Calculates the difference between the first and last value of each time series element in a range vector `v`, returning an instant vector with the given deltas and equivalent labels. The delta is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if the sample values are all integers."},{insertText:"deriv",label:"deriv",detail:"deriv(v range-vector)",documentation:"Calculates the per-second derivative of the time series in a range vector `v`, using simple linear regression."},{insertText:"drop_common_labels",label:"drop_common_labels",detail:"drop_common_labels(instant-vector)",documentation:"Drops all labels that have the same name and value across all series in the input vector."},{insertText:"exp",label:"exp",detail:"exp(v instant-vector)",documentation:"Calculates the exponential function for all elements in `v`.\nSpecial cases are:\n* `Exp(+Inf) = +Inf` \n* `Exp(NaN) = NaN`"},{insertText:"floor",label:"floor",detail:"floor(v instant-vector)",documentation:"Rounds the sample values of all elements in `v` down to the nearest integer."},{insertText:"histogram_quantile",label:"histogram_quantile",detail:"histogram_quantile(\u03C6 float, b instant-vector)",documentation:"Calculates the \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) from the buckets `b` of a histogram. The samples in `b` are the counts of observations in each bucket. Each sample must have a label `le` where the label value denotes the inclusive upper bound of the bucket. (Samples without such a label are silently ignored.) The histogram metric type automatically provides time series with the `_bucket` suffix and the appropriate labels."},{insertText:"holt_winters",label:"holt_winters",detail:"holt_winters(v range-vector, sf scalar, tf scalar)",documentation:"Produces a smoothed value for time series based on the range in `v`. The lower the smoothing factor `sf`, the more importance is given to old data. The higher the trend factor `tf`, the more trends in the data is considered. Both `sf` and `tf` must be between 0 and 1."},{insertText:"hour",label:"hour",detail:"hour(v=vector(time()) instant-vector)",documentation:"Returns the hour of the day for each of the given times in UTC. Returned values are from 0 to 23."},{insertText:"idelta",label:"idelta",detail:"idelta(v range-vector)",documentation:"Calculates the difference between the last two samples in the range vector `v`, returning an instant vector with the given deltas and equivalent labels."},{insertText:"increase",label:"increase",detail:"increase(v range-vector)",documentation:"Calculates the increase in the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. The increase is extrapolated to cover the full time range as specified in the range vector selector, so that it is possible to get a non-integer result even if a counter increases only by integer increments."},{insertText:"irate",label:"irate",detail:"irate(v range-vector)",documentation:"Calculates the per-second instant rate of increase of the time series in the range vector. This is based on the last two data points. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for."},{insertText:"label_join",label:"label_join",detail:"label_join(v instant-vector, dst_label string, separator string, src_label_1 string, src_label_2 string, ...)",documentation:"For each timeseries in `v`, joins all the values of all the `src_labels` using `separator` and returns the timeseries with the label `dst_label` containing the joined value. There can be any number of `src_labels` in this function."},{insertText:"label_replace",label:"label_replace",detail:"label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)",documentation:"For each timeseries in `v`, `label_replace(v instant-vector, dst_label string, replacement string, src_label string, regex string)`  matches the regular expression `regex` against the label `src_label`.  If it matches, then the timeseries is returned with the label `dst_label` replaced by the expansion of `replacement`. `$1` is replaced with the first matching subgroup, `$2` with the second etc. If the regular expression doesn't match then the timeseries is returned unchanged."},{insertText:"ln",label:"ln",detail:"ln(v instant-vector)",documentation:"Calculates the natural logarithm for all elements in `v`.\nSpecial cases are:\n * `ln(+Inf) = +Inf`\n * `ln(0) = -Inf`\n * `ln(x < 0) = NaN`\n * `ln(NaN) = NaN`"},{insertText:"log2",label:"log2",detail:"log2(v instant-vector)",documentation:"Calculates the binary logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"log10",label:"log10",detail:"log10(v instant-vector)",documentation:"Calculates the decimal logarithm for all elements in `v`. The special cases are equivalent to those in `ln`."},{insertText:"minute",label:"minute",detail:"minute(v=vector(time()) instant-vector)",documentation:"Returns the minute of the hour for each of the given times in UTC. Returned values are from 0 to 59."},{insertText:"month",label:"month",detail:"month(v=vector(time()) instant-vector)",documentation:"Returns the month of the year for each of the given times in UTC. Returned values are from 1 to 12, where 1 means January etc."},{insertText:"pi",label:"pi",detail:"pi()",documentation:"Returns pi"},{insertText:"predict_linear",label:"predict_linear",detail:"predict_linear(v range-vector, t scalar)",documentation:"Predicts the value of time series `t` seconds from now, based on the range vector `v`, using simple linear regression."},{insertText:"rad",label:"rad",detail:"rad(v instant-vector)",documentation:"Converts degrees to radians for all elements in v"},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the per-second average rate of increase of the time series in the range vector. Breaks in monotonicity (such as counter resets due to target restarts) are automatically adjusted for. Also, the calculation extrapolates to the ends of the time range, allowing for missed scrapes or imperfect alignment of scrape cycles with the range's time period."},{insertText:"resets",label:"resets",detail:"resets(v range-vector)",documentation:"For each input time series, `resets(v range-vector)` returns the number of counter resets within the provided time range as an instant vector. Any decrease in the value between two consecutive samples is interpreted as a counter reset."},{insertText:"round",label:"round",detail:"round(v instant-vector, to_nearest=1 scalar)",documentation:"Rounds the sample values of all elements in `v` to the nearest integer. Ties are resolved by rounding up. The optional `to_nearest` argument allows specifying the nearest multiple to which the sample values should be rounded. This multiple may also be a fraction."},{insertText:"scalar",label:"scalar",detail:"scalar(v instant-vector)",documentation:"Given a single-element input vector, `scalar(v instant-vector)` returns the sample value of that single element as a scalar. If the input vector does not have exactly one element, `scalar` will return `NaN`."},{insertText:"sgn",label:"sgn",detail:"sgn(v instant-vector)",documentation:"Returns a vector with all sample values converted to their sign, defined as this: 1 if v is positive, -1 if v is negative and 0 if v is equal to zero."},{insertText:"sort",label:"sort",detail:"sort(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in ascending order."},{insertText:"sort_desc",label:"sort_desc",detail:"sort_desc(v instant-vector)",documentation:"Returns vector elements sorted by their sample values, in descending order."},{insertText:"sqrt",label:"sqrt",detail:"sqrt(v instant-vector)",documentation:"Calculates the square root of all elements in `v`."},{insertText:"time",label:"time",detail:"time()",documentation:"Returns the number of seconds since January 1, 1970 UTC. Note that this does not actually return the current time, but the time at which the expression is to be evaluated."},{insertText:"timestamp",label:"timestamp",detail:"timestamp(v instant-vector)",documentation:"Returns the timestamp of each of the samples of the given vector as the number of seconds since January 1, 1970 UTC."},{insertText:"vector",label:"vector",detail:"vector(s scalar)",documentation:"Returns the scalar `s` as a vector with no labels."},{insertText:"year",label:"year",detail:"year(v=vector(time()) instant-vector)",documentation:"Returns the year for each of the given times in UTC."},{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average value of all points in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum value of all points in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum value of all points in the specified interval."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The most recent point value in specified interval."},{insertText:"present_over_time",label:"present_over_time",detail:"present_over_time(range-vector)",documentation:"The value 1 for any series in the specified interval."},{insertText:"histogram_avg",label:"histogram_avg",detail:"histogram_avg(v instant-vector)",documentation:"Returns the arithmetic average of observed values stored in a native histogram. Samples that are not native histograms are ignored and do not show up in the returned vector."},{insertText:"histogram_count",label:"histogram_count",detail:"histogram_count(v instant-vector)",documentation:"Returns the count of observations stored in a native histogram."},{insertText:"histogram_sum",label:"histogram_sum",detail:"histogram_sum(v instant-vector)",documentation:"Returns the sum of observations stored in a native histogram."},{insertText:"histogram_fraction",label:"histogram_fraction",detail:"histogram_fraction(lower scalar, upper scalar, v instant-vector)",documentation:"Returns the estimated fraction of observations between the provided lower and upper values."},{insertText:"histogram_stddev",label:"histogram_stddev",detail:"histogram_stddev(v instant-vector)",documentation:"Returns the estimated standard deviation of observations in a native histogram, based on the geometric mean of the buckets where the observations lie."},{insertText:"histogram_stdvar",label:"histogram_stdvar",detail:"histogram_stdvar(v instant-vector)",documentation:"Returns the estimated standard variance of observations in a native histogram."}],i=g.map(o=>o.label),l={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((by|without)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},function:new RegExp(`\\b(?:${g.map(o=>o.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],idList:{pattern:/\d+(\|\d+)+/,alias:"number"},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:new RegExp(`/[-+*/=%^~]|&&?|\\|?\\||!=?|<(?:=>?|<|>)?|>[>=]?|\\b(?:${n.join("|")})\\b`,"i"),punctuation:/[{};()`,.]/},d=l},32370:(_,L,e)=>{"use strict";e.d(L,{l:()=>x,z:()=>E});var t=e(20719),n=e(1220),r=e(75161),s=e(38961),a=e(15145);function g(){return[{id:a.jN.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:a.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},i({id:a.jN.HistogramAvg}),i({id:a.jN.HistogramCount}),i({id:a.jN.HistogramSum}),{id:a.jN.HistogramFraction,name:"Histogram fraction",params:[{name:"Lower scalar",type:"number"},{name:"Upper scalar",type:"number"}],defaultParams:[0,.2],category:a.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},i({id:a.jN.HistogramStddev}),i({id:a.jN.HistogramStdvar}),{id:a.jN.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:a.Ag.Functions,defaultParams:["","$1","","(.*)"],renderer:n.kf,addOperationHandler:n.iZ},{id:a.jN.Ln,name:"Ln",params:[],defaultParams:[],category:a.Ag.Functions,renderer:n.jY,addOperationHandler:n.iZ},l(a.jN.Changes),l(a.jN.Rate,!0),l(a.jN.Irate),l(a.jN.Increase,!0),l(a.jN.Idelta),l(a.jN.Delta),i({id:a.jN.HoltWinters,params:[(0,n.z2)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:a.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:u,changeTypeHandler:d}),i({id:a.jN.PredictLinear,params:[(0,n.z2)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:a.Ag.RangeFunctions,renderer:n.nU,addOperationHandler:u,changeTypeHandler:d}),i({id:a.jN.QuantileOverTime,params:[(0,n.z2)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:a.Ag.RangeFunctions,renderer:n.Kl,addOperationHandler:u,changeTypeHandler:d}),...r.Iu,{id:a.jN.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:a.Ag.BinaryOps,renderer:(b,T,A)=>A,addOperationHandler:c},i({id:a.jN.Abs}),i({id:a.jN.Absent}),i({id:a.jN.Acos,category:a.Ag.Trigonometric}),i({id:a.jN.Acosh,category:a.Ag.Trigonometric}),i({id:a.jN.Asin,category:a.Ag.Trigonometric}),i({id:a.jN.Asinh,category:a.Ag.Trigonometric}),i({id:a.jN.Atan,category:a.Ag.Trigonometric}),i({id:a.jN.Atanh,category:a.Ag.Trigonometric}),i({id:a.jN.Ceil}),i({id:a.jN.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),i({id:a.jN.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),i({id:a.jN.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),i({id:a.jN.Cos,category:a.Ag.Trigonometric}),i({id:a.jN.Cosh,category:a.Ag.Trigonometric}),i({id:a.jN.DayOfMonth,category:a.Ag.Time}),i({id:a.jN.DayOfWeek,category:a.Ag.Time}),i({id:a.jN.DayOfYear,category:a.Ag.Time}),i({id:a.jN.DaysInMonth,category:a.Ag.Time}),i({id:a.jN.Deg}),l(a.jN.Deriv),i({id:a.jN.Exp}),i({id:a.jN.Floor}),i({id:a.jN.Hour}),i({id:a.jN.LabelJoin,params:[{name:"Destination Label",type:"string",editor:s.r},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:s.r}],defaultParams:["",",",""],renderer:p,explainHandler:h,addOperationHandler:y}),i({id:a.jN.Log10}),i({id:a.jN.Log2}),i({id:a.jN.Minute}),i({id:a.jN.Month}),i({id:a.jN.Pi,renderer:b=>`${b.id}()`}),i({id:a.jN.Rad}),l(a.jN.Resets),i({id:a.jN.Round,category:a.Ag.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),i({id:a.jN.Scalar}),i({id:a.jN.Sgn}),i({id:a.jN.Sin,category:a.Ag.Trigonometric}),i({id:a.jN.Sinh,category:a.Ag.Trigonometric}),i({id:a.jN.Sort}),i({id:a.jN.SortDesc}),i({id:a.jN.Sqrt}),i({id:a.jN.Stddev}),i({id:a.jN.Tan,category:a.Ag.Trigonometric}),i({id:a.jN.Tanh,category:a.Ag.Trigonometric}),i({id:a.jN.Time,renderer:b=>`${b.id}()`}),i({id:a.jN.Timestamp}),i({id:a.jN.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:b=>`${b.id}(${b.params[0]})`}),i({id:a.jN.Year})]}function i(C){return{...C,id:C.id,name:C.name??(0,n.DQ)(C.id),params:C.params??[],defaultParams:C.defaultParams??[],category:C.category??a.Ag.Functions,renderer:C.renderer??(C.params?n.kf:n.jY),addOperationHandler:C.addOperationHandler??n.iZ}}function l(C,b=!1){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)(b)],defaultParams:[b?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:a.Ag.RangeFunctions,renderer:o,addOperationHandler:u,changeTypeHandler:d}}function d(C,b){return(C.params[0]==="$__rate_interval"&&b.defaultParams[0]!=="$__rate_interval"||C.params[0]==="$__interval"&&b.defaultParams[0]!=="$__interval")&&(C.params=b.defaultParams),C}function o(C,b,T){let A=(C.params??[])[0]??"5m";return`${b.id}(${T}[${A}])`}function u(C,b,T){const A={id:C.id,params:C.defaultParams};return b.operations.length>0&&T.getOperationDef(b.operations[0].id).addOperationHandler===u?{...b,operations:[A,...b.operations.slice(1)]}:{...b,operations:[A,...b.operations]}}function c(C,b){return{...b,binaryQueries:[...b.binaryQueries??[],{operator:"/",query:b}]}}function p(C,b,T){const A=C.params[0]??"",S=`"${C.params[1]??""}"`;return`${C.id}(${T}, "${A}", ${S}, "${C.params.slice(2).join(S)}")`}function h(C,b){let T=b?.documentation??"no docs";return typeof C.params[1]!="string"&&(T+=" \u{1F6A8}\u{1F6A8}\u{1F6A8} The `separator` must be a string."),T}function y(C,b){const T={id:C.id,params:C.defaultParams};return{...b,operations:[...b.operations,T]}}function f(){return[...(0,n.G3)(a.jN.Sum),...(0,n.G3)(a.jN.Avg),...(0,n.G3)(a.jN.Min),...(0,n.G3)(a.jN.Max),...(0,n.G3)(a.jN.Count),...(0,n.G3)(a.jN.Group),...(0,n.jC)(a.jN.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(a.jN.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,n.jC)(a.jN.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),...(0,n.jC)(a.jN.Quantile,{params:[{name:"Value",type:"number"}],defaultParams:[1]}),v(a.jN.SumOverTime),v(a.jN.AvgOverTime),v(a.jN.MinOverTime),v(a.jN.MaxOverTime),v(a.jN.CountOverTime),v(a.jN.LastOverTime),v(a.jN.PresentOverTime),v(a.jN.AbsentOverTime),v(a.jN.StddevOverTime)]}function v(C){return{id:C,name:(0,n.DQ)(C),params:[(0,n.z2)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:a.Ag.RangeFunctions,renderer:P,addOperationHandler:u}}function P(C,b,T){let A=(C.params??[])[0]??"$__interval";return`${b.id}(${T}[${A}])`}var m=e(83077);class D{constructor(b){this.categories=[],this.operationsRegistry=new m.O(b)}setOperationCategories(b){this.categories=b}getOperationsForCategory(b){return this.operationsRegistry.list().filter(T=>T.category===b&&!T.hideFromList)}getAlternativeOperations(b){return this.operationsRegistry.list().filter(T=>T.alternativesKey&&T.alternativesKey===b)}getCategories(){return this.categories}getOperationDef(b){return this.operationsRegistry.getIfExists(b)}renderOperations(b,T){for(const A of T){const R=this.operationsRegistry.getIfExists(A.id);if(!R)throw new Error(`Could not find operation ${A.id} in the registry`);b=R.renderer(A,R,b)}return b}renderBinaryQueries(b,T){if(T)for(const A of T)b=`${this.renderBinaryQuery(b,A)}`;return b}renderBinaryQuery(b,T){let A=b+` ${T.operator} `;return T.vectorMatches&&(A+=`${T.vectorMatchesType}(${T.vectorMatches}) `),A+this.renderQuery(T.query,!0)}renderLabels(b){if(b.length===0)return"";let T="{";for(const A of b)T!=="{"&&(T+=", "),T+=`${A.label}${A.op}"${A.value}"`;return T+"}"}renderQuery(b,T){let A=`${b.metric??""}${this.renderLabels(b.labels)}`;return A=this.renderOperations(A,b.operations),!T&&this.hasBinaryOp(b)&&b.binaryQueries?.length&&(A=`(${A})`),A=this.renderBinaryQueries(A,b.binaryQueries),T&&(this.hasBinaryOp(b)||b.binaryQueries?.length)&&(A=`(${A})`),A}hasBinaryOp(b){return b.operations.find(T=>this.getOperationDef(T.id)?.category===a.Ag.BinaryOps)!==void 0}}class x extends D{constructor(){super(()=>{const b=[...g(),...f()];for(const T of b){const A=t.AW.find(R=>R.insertText===T.id);A&&(T.documentation=A.documentation)}return b}),this.setOperationCategories([a.Ag.Aggregations,a.Ag.RangeFunctions,a.Ag.Functions,a.Ag.BinaryOps,a.Ag.Trigonometric,a.Ag.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:a.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:a.n5.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:a.n5.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:a.n5.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:a.n5.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const E=new x},75161:(_,L,e)=>{"use strict";e.d(L,{AE:()=>s,C8:()=>r,Iu:()=>a});var t=e(1220),n=e(15145);const r=[{id:n.jN.Addition,name:"Add scalar",sign:"+"},{id:n.jN.Subtraction,name:"Subtract scalar",sign:"-"},{id:n.jN.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:n.jN.DivideBy,name:"Divide by scalar",sign:"/"},{id:n.jN.Modulo,name:"Modulo by scalar",sign:"%"},{id:n.jN.Exponent,name:"Exponent",sign:"^"},{id:n.jN.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:n.jN.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:n.jN.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:n.jN.LessThan,name:"Less than",sign:"<",comparison:!0},{id:n.jN.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:n.jN.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],s=r.reduce((i,l)=>(i[l.sign]={id:l.id,comparison:l.comparison},i),{}),a=r.map(i=>{const l=[{name:"Value",type:"number"}];let d=[2];return i.comparison&&(l.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),d=[2,!1]),{id:i.id,name:i.name,params:l,defaultParams:d,alternativesKey:"binary scalar operations",category:n.Ag.BinaryOps,renderer:g(i.sign),addOperationHandler:t.iZ}});function g(i){return function(d,o,u){let c=d.params[0],p="";return d.params.length===2&&(p=d.params[1]?" bool":""),`${u} ${i}${p} ${c}`}}},38961:(_,L,e)=>{"use strict";e.d(L,{r:()=>i});var t=e(74848),n=e(96540),r=e(50877),s=e(90182),a=e(32370),g=e(1220);function i({onChange:d,index:o,operationId:u,value:c,query:p,datasource:h}){const[y,f]=(0,n.useState)({});return(0,t.jsx)(s.l6,{inputId:(0,g.OS)(u,o),autoFocus:c===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{f({isLoading:!0});const v=await l(p,h);f({options:v,isLoading:void 0})},isLoading:y.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:y.options,value:(0,r.z)(c),onChange:v=>d(o,v.value)})}async function l(d,o){let u=d.labels;o.type==="prometheus"&&(u=[{label:"__name__",op:"=",value:d.metric},...d.labels]);const c=a.z.renderLabels(u),p=await o.languageProvider.fetchLabelsWithMatch(c);return Object.keys(p).map(h=>({label:h,value:h}))}},9103:(_,L,e)=>{"use strict";e.d(L,{dm:()=>Ce,o6:()=>Ee});var t=e(74848),n=e(32196),r=e(76459),s=e.n(r),a=e(96540),g=e(23257),i=e.n(g),l=e(50877),d=e(13544),o=e(97801),u=e(81580),c=e(32264),p=e(40845),h=e(55852),y=e(14578),f=e(12681),v=e(88824),P=e(40276),m=e(90182),D=e(39268),x=e(14186),E=e(81996),C=e(26115),b=e(65307),T=e(37390),A=e(10354),R=e(62930),S=e(60782),O=e(19727),j=e(19384),B=e(15292),N=e(56034),I=e(14110),K=e(50556);async function w(fe,Te,Ge){let Qe=!0;const st=fe.languageProvider.metricsMetadata;st&&Object.keys(st).length===0&&(Qe=!1);let Xe={},ot={},ft;return ft=Ge?.map(_e=>{const et=U(_e,fe),it=`${_e}\xA6${et.description}`;return Xe[_e]=et,ot[it]=et,et}),{isLoading:!1,hasMetadata:Qe,metrics:ft??[],metaHaystackDictionary:ot,nameHaystackDictionary:Xe,totalMetricCount:ft?.length??0,filteredMetricCount:ft?.length??0}}function U(fe,Te){let Ge=(0,K.AU)(fe,Te.languageProvider.metricsMetadata);const Qe=(0,K.pK)(fe,Te.languageProvider.metricsMetadata);["histogram","summary"].forEach(ot=>{Qe?.toLowerCase().includes(ot)&&Ge!==ot&&(Ge+=` (${ot})`)});const st=fe.match(/^\w+_bucket$|^\w+_bucket{.*}$/);return Ge==="histogram"&&!st&&(Ge="native histogram"),{value:fe,type:Ge,description:Qe}}function W(fe,Te){const Ge=H(fe);return!fe.isLoading&&fe.filteredMetricCount!==Ge.length&&Te(je(Ge.length)),G(Ge,fe.pageNum,fe.resultsPerPage)}function H(fe){let Te=fe.metrics;return fe.fuzzySearchQuery&&!fe.useBackend&&(fe.fullMetaSearch?Te=fe.metaHaystackOrder.map(Ge=>fe.metaHaystackDictionary[Ge]):Te=fe.nameHaystackOrder.map(Ge=>fe.nameHaystackDictionary[Ge])),fe.selectedTypes.length>0&&(Te=Te.filter((Ge,Qe)=>fe.selectedTypes.some(Xe=>Ge.type&&Xe.value?Ge.type.includes(Xe.value):!Ge.type&&Xe.value==="no type"))),fe.includeNullMetadata||(Te=Te.filter(Ge=>Ge.type!==void 0&&Ge.description!==void 0)),Te}function z(fe){if(!fe.metrics.length)return[];const Te=fe.resultsPerPage===0?1:fe.resultsPerPage,Ge=Math.floor(H(fe).length/Te)+1;return[...Array(Ge).keys()].map(Qe=>Qe+1)}function G(fe,Te,Ge){const Qe=Ge===0?1:Ge,st=Te===1?0:(Te-1)*Qe,Xe=st+Qe;return fe.slice(st,Xe)}const M=(fe,Te,Ge)=>fe<1?1:fe>Ge?Ge:fe??Te;async function Q(fe,Te,Ge){const Qe=(0,C.b4)(fe),st=Te.map(ft=>`,${ft.label}="${ft.value}"`),Xe=`label_values({__name__=~".*${Qe}"${Te?st.join():""}},__name__)`;return await Ge.metricFindQuery(Xe).then(ft=>ft.map(_e=>U(_e.text,Ge)))}function Y(fe,Te,Ge,Qe){switch(fe){case"grafana_prom_metric_encycopedia_tracking":(0,I.rR)(fe,{metric:Ge,hasMetadata:Te?.hasMetadata,totalMetricCount:Te?.totalMetricCount,fuzzySearchQuery:Te?.fuzzySearchQuery,fullMetaSearch:Te?.fullMetaSearch,selectedTypes:Te?.selectedTypes,useRegexSearch:Te?.useBackend,includeResultsWithoutMetadata:Te?.includeNullMetadata});case"grafana_prom_metric_encycopedia_disable_text_wrap_interaction":(0,I.rR)(fe,{disableTextWrap:Te?.disableTextWrap});case"grafana_prometheus_metric_encyclopedia_open":(0,I.rR)(fe,{query:Qe})}}const q=[{value:"counter",description:"A cumulative metric that represents a single monotonically increasing counter whose value can only increase or be reset to zero on restart."},{value:"gauge",description:"A metric that represents a single numerical value that can arbitrarily go up and down."},{value:"histogram",description:"A histogram samples observations (usually things like request durations or response sizes) and counts them in configurable buckets."},{value:"native histogram",description:"Native histograms are different from classic Prometheus histograms in a number of ways: Native histogram bucket boundaries are calculated by a formula that depends on the scale (resolution) of the native histogram, and are not user defined."},{value:"summary",description:"A summary samples observations (usually things like request durations and response sizes) and can calculate configurable quantiles over a sliding time window."},{value:"unknown",description:"These metrics have been given the type unknown in the metadata."},{value:"no type",description:"These metrics have no defined type in the metadata."}],te={browse:"Search metrics by name",metadataSearchSwitch:"Include description in search",type:"Filter by type",includeNullMetadata:"Include results with no metadata",setUseBackend:"Enable regex search"};function X(fe){const{state:Te,onChangeFullMetaSearch:Ge,onChangeIncludeNullMetadata:Qe,onChangeDisableTextWrap:st,onChangeUseBackend:Xe}=fe,ot=(0,p.$j)(),ft=ee(ot);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:ft.selectItem,children:[(0,t.jsx)(B.d,{"data-testid":ge.searchWithMetadata,value:Te.fullMetaSearch,disabled:Te.useBackend||!Te.hasMetadata,onChange:()=>Ge()}),(0,t.jsx)("div",{className:ft.selectItemLabel,children:te.metadataSearchSwitch})]}),(0,t.jsxs)("div",{className:ft.selectItem,children:[(0,t.jsx)(B.d,{value:Te.includeNullMetadata,disabled:!Te.hasMetadata,onChange:()=>Qe()}),(0,t.jsx)("div",{className:ft.selectItemLabel,children:te.includeNullMetadata})]}),(0,t.jsxs)("div",{className:ft.selectItem,children:[(0,t.jsx)(B.d,{value:Te.disableTextWrap,onChange:()=>st()}),(0,t.jsx)("div",{className:ft.selectItemLabel,children:"Disable text wrap"})]}),(0,t.jsxs)("div",{className:ft.selectItem,children:[(0,t.jsx)(B.d,{"data-testid":ge.setUseBackend,value:Te.useBackend,onChange:()=>Xe()}),(0,t.jsxs)("div",{className:ft.selectItemLabel,children:[te.setUseBackend,"\xA0"]}),(0,t.jsx)(N.m,{content:"Filter metric names by regex search, using an additional call on the Prometheus API.",placement:"bottom-end",children:(0,t.jsx)(y.I,{name:"info-circle",size:"xs",className:ft.settingsIcon})})]})]})}function ee(fe){return{settingsIcon:(0,n.css)({color:fe.colors.text.secondary}),selectItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",padding:"4px 0"}),selectItemLabel:(0,n.css)({margin:`0 0 0 ${fe.spacing(1)}`,alignSelf:"center",color:fe.colors.text.secondary,fontSize:"12px"})}}var ne=e(67061);function Z({feedbackUrl:fe}){const Te=(0,p.of)(ae);return(0,t.jsx)(ne.B,{children:(0,t.jsxs)("a",{href:fe,className:Te.link,title:"The metrics explorer is new, please let us know how we can improve it",target:"_blank",rel:"noreferrer noopener",children:[(0,t.jsx)(y.I,{name:"comment-alt-message"})," Give feedback"]})})}function ae(fe){return{link:(0,n.css)({color:fe.colors.text.secondary,fontSize:fe.typography.bodySmall.fontSize,":hover":{color:fe.colors.text.link},margin:"-25px 0 30px 0"})}}var re=e(4936);function se(fe){const{metrics:Te,onChange:Ge,onClose:Qe,query:st,state:Xe,disableTextWrap:ot}=fe,ft=(0,p.$j)(),_e=de(ft,ot);function et(Le){Le.value&&(Ge({...st,metric:Le.value}),Y("grafana_prom_metric_encycopedia_tracking",Xe,Le.value),Qe())}function it(Le){return Xe.fullMetaSearch&&Le?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:ze(Le.type??"")}),(0,t.jsx)("td",{children:(0,t.jsx)(i(),{textToHighlight:Le.description??"",searchWords:Xe.metaHaystackMatches,autoEscape:!0,highlightClassName:_e.matchHighLight})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("td",{children:ze(Le.type??"")}),(0,t.jsx)("td",{children:Le.description??""})]})}function dt(Le,Ze,qe){return(0,t.jsxs)(t.Fragment,{children:[Le,(0,t.jsx)("span",{className:_e.tooltipSpace,children:(0,t.jsx)(N.m,{content:(0,t.jsxs)(t.Fragment,{children:["When creating a ",Ze,", Prometheus exposes multiple series with the type counter."," ",(0,re.jW)(qe)]}),placement:"bottom-start",interactive:!0,children:(0,t.jsx)(y.I,{name:"info-circle",size:"xs"})})})]})}function ze(Le){return Le?Le.includes("(summary)")?dt(Le,"summary","https://prometheus.io/docs/concepts/metric_types/#summary"):Le.includes("(histogram)")?dt(Le,"histogram","https://prometheus.io/docs/concepts/metric_types/#histogram"):Le:""}function xe(){let Le;return Xe.fuzzySearchQuery||(Le="There are no metrics found in the data source."),st.labels.length>0&&(Le="There are no metrics found. Try to expand your label filters."),(Xe.fuzzySearchQuery||Xe.selectedTypes.length>0)&&(Le="There are no metrics found. Try to expand your search and filters."),(0,t.jsx)("tr",{className:_e.noResults,children:(0,t.jsx)("td",{colSpan:3,children:Le})})}function Oe(Le){return Le.useBackend?[Le.fuzzySearchQuery]:Le.fullMetaSearch?Le.metaHaystackMatches:Le.nameHaystackMatches}return(0,t.jsxs)("table",{className:_e.table,children:[(0,t.jsx)("thead",{className:_e.stickyHeader,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:`${_e.nameWidth} ${_e.tableHeaderPadding}`,children:"Name"}),Xe.hasMetadata&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("th",{className:`${_e.typeWidth} ${_e.tableHeaderPadding}`,children:"Type"}),(0,t.jsx)("th",{className:`${_e.descriptionWidth} ${_e.tableHeaderPadding}`,children:"Description"})]}),(0,t.jsx)("th",{className:_e.selectButtonWidth,children:" "})]})}),(0,t.jsx)("tbody",{children:(0,t.jsxs)(t.Fragment,{children:[Te.length>0&&Te.map((Le,Ze)=>(0,t.jsxs)("tr",{className:_e.row,children:[(0,t.jsx)("td",{className:_e.nameOverflow,children:(0,t.jsx)(i(),{textToHighlight:Le?.value??"",searchWords:Oe(Xe),autoEscape:!0,highlightClassName:_e.matchHighLight})}),Xe.hasMetadata&&it(Le),(0,t.jsx)("td",{children:(0,t.jsx)(h.$n,{size:"md",variant:"secondary",onClick:()=>et(Le),className:_e.centerButton,children:"Select"})})]},Le?.value??Ze)),Te.length===0&&!Xe.isLoading&&xe()]})})]})}const de=(fe,Te)=>({table:(0,n.css)({tableLayout:Te?void 0:"fixed",borderRadius:fe.shape.radius.default,width:"100%",whiteSpace:Te?"nowrap":"normal",td:{padding:fe.spacing(1)},"td,th":{minWidth:fe.spacing(3),borderBottom:`1px solid ${fe.colors.border.weak}`}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${fe.colors.border.weak}`,"&:last-child":{borderBottom:0}}),tableHeaderPadding:(0,n.css)({padding:"8px"}),matchHighLight:(0,n.css)({background:"inherit",color:fe.components.textHighlight.text,backgroundColor:fe.components.textHighlight.background}),nameWidth:(0,n.css)({width:Te?void 0:"37.5%"}),nameOverflow:(0,n.css)({overflowWrap:Te?void 0:"anywhere"}),typeWidth:(0,n.css)({width:Te?void 0:"15%"}),descriptionWidth:(0,n.css)({width:Te?void 0:"35%"}),selectButtonWidth:(0,n.css)({width:Te?void 0:"12.5%"}),stickyHeader:(0,n.css)({position:"sticky",top:0,backgroundColor:fe.colors.background.primary}),noResults:(0,n.css)({textAlign:"center",color:fe.colors.text.secondary}),tooltipSpace:(0,n.css)({marginLeft:"4px"}),centerButton:(0,n.css)({display:"block",margin:"auto",border:"none"})});var le=e(78036);const he=(fe,Te)=>({modal:(0,n.css)({width:"85vw",[fe.breakpoints.down("md")]:{width:"100%"},[fe.breakpoints.up("xl")]:{width:"60%"}}),inputWrapper:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),inputItemFirst:(0,n.css)({flexBasis:"40%",paddingRight:"16px",[fe.breakpoints.down("md")]:{paddingRight:"0px",paddingBottom:"16px"}}),inputItem:(0,n.css)({flexGrow:1,flexBasis:"20%",[fe.breakpoints.down("md")]:{minWidth:"100%"}}),selectWrapper:(0,n.css)({marginBottom:fe.spacing(1)}),resultsAmount:(0,n.css)({color:fe.colors.text.secondary,fontSize:"0.85rem",padding:"0 0 4px 0"}),resultsData:(0,n.css)({margin:`4px 0 ${fe.spacing(2)} 0`}),resultsDataCount:(0,n.css)({margin:0}),resultsDataFiltered:(0,n.css)({color:fe.colors.text.secondary,textAlign:"center",border:"solid 1px rgba(204, 204, 220, 0.25)",padding:"7px"}),resultsDataFilteredText:(0,n.css)({display:"inline",verticalAlign:"text-top"}),results:(0,n.css)({height:"calc(80vh - 310px)",overflowY:"scroll"}),resultsFooter:(0,n.css)({marginTop:"24px",display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",position:"sticky"}),currentlySelected:(0,n.css)({color:"grey",opacity:"75%",fontSize:"0.75rem"}),loadingSpinner:(0,n.css)({visibility:"hidden"}),visible:(0,n.css)({visibility:"visible"}),settingsBtn:(0,n.css)({float:"right"}),noBorder:(0,n.css)({border:"none"}),resultsPerPageLabel:(0,n.css)({color:fe.colors.text.secondary,opacity:"75%",paddingTop:"5px",fontSize:"0.85rem",marginRight:"8px"}),resultsPerPageWrapper:(0,n.css)({display:"flex"})});var ie=e(53076),J=e(2543);const ce=new ie.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function pe(fe,Te,Ge){const[Qe,st,Xe]=ce.search(fe,Te,0,1e5);let ot=[],ft=new Set;if(Qe&&Xe){const _e=(et,it)=>{it&&ft.add(et)};for(let et=0;et<Xe.length;et++){let it=Xe[et];ie.A.highlight(fe[st.idx[it]],st.ranges[it],_e),ot.push(fe[st.idx[it]])}Ge([ot,[...ft]])}else Te||Ge([[],[]])}const Pe=(0,J.debounce)(pe,300),Ie=fe=>{const{datasource:Te,isOpen:Ge,onClose:Qe,onChange:st,query:Xe,initialMetrics:ot}=fe,[ft,_e]=(0,a.useReducer)(Se.reducer,(0,le.ue)(Xe)),et=(0,p.$j)(),it=he(et,ft.disableTextWrap),dt=(0,a.useCallback)(async()=>{_e(De(!0));const rt=await w(Te,Xe,ot);_e(Ke({isLoading:!1,hasMetadata:rt.hasMetadata,metrics:rt.metrics,metaHaystackDictionary:rt.metaHaystackDictionary,nameHaystackDictionary:rt.nameHaystackDictionary,totalMetricCount:rt.metrics.length,filteredMetricCount:rt.metrics.length}))},[Xe,Te,ot]);(0,a.useEffect)(()=>{dt()},[dt]);const ze=q.map(rt=>({value:rt.value,label:rt.value,description:rt.description})),xe=(0,a.useMemo)(()=>s()(async rt=>{_e(De(!0));const vt=await Q(rt,Xe.labels,Te);_e(Me({metrics:vt,filteredMetricCount:vt.length,isLoading:!1}))},Te.getDebounceTimeInMilliseconds()),[Te,Xe]);function Oe(rt){_e(He(rt))}function Le(rt){_e(Ve(rt))}function Ze(rt,vt){ft.useBackend&&rt===""?dt():ft.useBackend?xe(rt):vt?Pe(Object.keys(ft.metaHaystackDictionary),rt,Le):Pe(Object.keys(ft.nameHaystackDictionary),rt,Oe)}const qe=(0,t.jsx)(X,{state:ft,onChangeFullMetaSearch:()=>{const rt=!ft.fullMetaSearch;_e(Je(rt)),st({...Xe,fullMetaSearch:rt}),Ze(ft.fuzzySearchQuery,rt)},onChangeIncludeNullMetadata:()=>{_e(nt(!ft.includeNullMetadata)),st({...Xe,includeNullMetadata:!ft.includeNullMetadata})},onChangeDisableTextWrap:()=>{_e(Tt()),st({...Xe,disableTextWrap:!ft.disableTextWrap}),Y("grafana_prom_metric_encycopedia_disable_text_wrap_interaction",ft,"")},onChangeUseBackend:()=>{const rt=!ft.useBackend;_e(bt(rt)),st({...Xe,useBackend:rt}),rt===!1?dt():ft.fuzzySearchQuery!==""&&xe(ft.fuzzySearchQuery)}});return(0,t.jsxs)(T.a,{"data-testid":ge.metricModal,isOpen:Ge,title:"Metrics explorer",onDismiss:Qe,"aria-label":"Browse metrics",className:it.modal,children:[(0,t.jsx)(Z,{feedbackUrl:"https://forms.gle/DEMAJHoAMpe3e54CA"}),(0,t.jsxs)("div",{className:it.inputWrapper,"data-testid":d.Tp.components.DataSource.Prometheus.queryEditor.builder.metricsExplorer,children:[(0,t.jsx)("div",{className:(0,n.cx)(it.inputItem,it.inputItemFirst),children:(0,t.jsx)(A.p,{autoFocus:!0,"data-testid":ge.searchMetric,placeholder:te.browse,value:ft.fuzzySearchQuery,onInput:rt=>{const vt=rt.currentTarget.value??"";_e(Be(vt)),Ze(vt,ft.fullMetaSearch)}})}),ft.hasMetadata&&(0,t.jsx)("div",{className:it.inputItem,children:(0,t.jsx)(m.KF,{"data-testid":ge.selectType,inputId:"my-select",options:ze,value:ft.selectedTypes,placeholder:te.type,onChange:rt=>_e(pt(rt))})}),(0,t.jsx)("div",{children:(0,t.jsx)(R.y,{className:`${it.loadingSpinner} ${ft.isLoading?it.visible:""}`})}),(0,t.jsx)("div",{className:it.inputItem,children:(0,t.jsx)(S.G,{"aria-label":"Additional settings",content:qe,placement:"bottom-end",closeButton:!1,children:(0,t.jsxs)(O.e,{className:it.settingsBtn,children:[(0,t.jsx)(h.$n,{variant:"secondary",size:"md",onClick:()=>_e(ye()),"data-testid":ge.showAdditionalSettings,className:it.noBorder,children:"Additional Settings"}),(0,t.jsx)(h.$n,{className:it.noBorder,variant:"secondary",icon:ft.showAdditionalSettings?"angle-up":"angle-down"})]})})})]}),(0,t.jsxs)("div",{className:it.resultsData,children:[Xe.metric&&(0,t.jsxs)("i",{className:it.currentlySelected,children:["Currently selected: ",Xe.metric]}),Xe.labels.length>0&&(0,t.jsxs)("div",{className:it.resultsDataFiltered,children:[(0,t.jsx)(y.I,{name:"info-circle",size:"sm"}),(0,t.jsx)("div",{className:it.resultsDataFilteredText,children:"\xA0These metrics have been pre-filtered by labels chosen in the label filters."})]})]}),(0,t.jsx)("div",{className:it.results,children:ft.metrics&&(0,t.jsx)(se,{metrics:W(ft,_e),onChange:st,onClose:Qe,query:Xe,state:ft,disableTextWrap:ft.disableTextWrap})}),(0,t.jsxs)("div",{className:it.resultsFooter,children:[(0,t.jsxs)("div",{className:it.resultsAmount,children:["Showing ",ft.filteredMetricCount," of ",ft.totalMetricCount," results"]}),(0,t.jsx)(j.d,{currentPage:ft.pageNum??1,numberOfPages:z(ft).length,onNavigate:rt=>{_e(we(rt??1))}}),(0,t.jsxs)("div",{className:it.resultsPerPageWrapper,children:[(0,t.jsx)("p",{className:it.resultsPerPageLabel,children:"# Results per page\xA0"}),(0,t.jsx)(A.p,{"data-testid":ge.resultsPerPage,value:M(ft.resultsPerPage,le.J3,le.yH),placeholder:"results per page",width:10,title:"The maximum results per page is "+le.yH,type:"number",onInput:rt=>{const vt=+rt.currentTarget.value;isNaN(vt)||vt>=le.yH||_e(be(vt))}})]})]})]})},ge={metricModal:"metric-modal",searchMetric:"search-metric",searchWithMetadata:"search-with-metadata",selectType:"select-type",metricCard:"metric-card",useMetric:"use-metric",searchPage:"search-page",resultsPerPage:"results-per-page",setUseBackend:"set-use-backend",showAdditionalSettings:"show-additional-settings"},Se=(0,b.Z0)({name:"metrics-modal-state",initialState:(0,le.ue)(),reducers:{filterMetricsBackend:(fe,Te)=>{fe.metrics=Te.payload.metrics,fe.filteredMetricCount=Te.payload.filteredMetricCount,fe.isLoading=Te.payload.isLoading},buildMetrics:(fe,Te)=>{fe.isLoading=Te.payload.isLoading,fe.metrics=Te.payload.metrics,fe.hasMetadata=Te.payload.hasMetadata,fe.metaHaystackDictionary=Te.payload.metaHaystackDictionary,fe.nameHaystackDictionary=Te.payload.nameHaystackDictionary,fe.totalMetricCount=Te.payload.totalMetricCount,fe.filteredMetricCount=Te.payload.filteredMetricCount},setIsLoading:(fe,Te)=>{fe.isLoading=Te.payload},setFilteredMetricCount:(fe,Te)=>{fe.filteredMetricCount=Te.payload},setResultsPerPage:(fe,Te)=>{fe.resultsPerPage=Te.payload},setPageNum:(fe,Te)=>{fe.pageNum=Te.payload},setFuzzySearchQuery:(fe,Te)=>{fe.fuzzySearchQuery=Te.payload,fe.pageNum=1},setNameHaystack:(fe,Te)=>{fe.nameHaystackOrder=Te.payload[0],fe.nameHaystackMatches=Te.payload[1]},setMetaHaystack:(fe,Te)=>{fe.metaHaystackOrder=Te.payload[0],fe.metaHaystackMatches=Te.payload[1]},setFullMetaSearch:(fe,Te)=>{fe.fullMetaSearch=Te.payload,fe.pageNum=1},setIncludeNullMetadata:(fe,Te)=>{fe.includeNullMetadata=Te.payload,fe.pageNum=1},setSelectedTypes:(fe,Te)=>{fe.selectedTypes=Te.payload,fe.pageNum=1},setUseBackend:(fe,Te)=>{fe.useBackend=Te.payload,fe.fullMetaSearch=!1,fe.pageNum=1},setDisableTextWrap:fe=>{fe.disableTextWrap=!fe.disableTextWrap},showAdditionalSettings:fe=>{fe.showAdditionalSettings=!fe.showAdditionalSettings}}}),{setIsLoading:De,buildMetrics:Ke,filterMetricsBackend:Me,setResultsPerPage:be,setPageNum:we,setFuzzySearchQuery:Be,setNameHaystack:He,setMetaHaystack:Ve,setFullMetaSearch:Je,setIncludeNullMetadata:nt,setSelectedTypes:pt,setUseBackend:bt,setDisableTextWrap:Tt,showAdditionalSettings:ye,setFilteredMetricCount:je}=Se.actions,ue=" ",Ee=1e3;function Ce({datasource:fe,query:Te,onChange:Ge,onGetMetrics:Qe,labelsFilters:st,metricLookupDisabled:Xe,onBlur:ot,variableEditor:ft}){const _e=(0,p.of)(Ne),[et,it]=(0,a.useState)({}),dt=c.$.featureToggles.prometheusMetricEncyclopedia,ze=[{value:"BrowseMetrics",label:"Metrics explorer",description:"Browse and filter all metrics and metadata with a fuzzy search"}],xe=(0,a.useCallback)((Ut,zt)=>{const qt=Ut.label??Ut.value;return qt?qt.toLowerCase?zt.split(ue).reduce((Sn,An)=>{const Hn=qt.toLowerCase().includes(An.toLowerCase());let es=!1;return dt&&(es=qt==="Metrics explorer"),Sn&&(Hn||es)},!0):!0:!1},[dt]),Oe=(0,a.useCallback)((Ut,zt)=>Ut.__isNew__?Ut.label:(0,t.jsx)(i(),{searchWords:zt.inputValue.split(ue),textToHighlight:Ut.label??"",highlightClassName:_e.highlight}),[_e.highlight]),Le=(Ut,zt)=>{const qt=(0,C.b4)(Ut);return Fe(qt,zt)},Ze=Ut=>fe.metricFindQuery(Le(Ut,st)).then(qt=>{const fn=qt.length;(0,E.ky)(qt),fn>qt.length?it({...et,resultsTruncated:!0}):it({...et,resultsTruncated:!1});const Sn=qt.map(An=>({label:An.text,value:An.text}));return dt?[...ze,...Sn]:Sn}),qe=()=>Promise.resolve([]),rt=s()(Ut=>Ze(Ut),fe.getDebounceTimeInMilliseconds()),vt=Ut=>{const zt=Ut.data;if(zt.value==="BrowseMetrics"){const qt=Ut.isFocused?_e.focus:"";return(0,t.jsx)("div",{...Ut.innerProps,ref:Ut.innerRef,className:`${_e.customOptionWidth} metric-encyclopedia-open`,"data-testid":d.Tp.components.Select.option,onKeyDown:fn=>{fn.code==="Enter"&&it({...et,metricsModalOpen:!0})},children:(0,t.jsxs)("div",{className:`${_e.customOption} ${qt} metric-encyclopedia-open`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"metric-encyclopedia-open",children:zt.label}),(0,t.jsx)("div",{className:`${_e.customOptionDesc} metric-encyclopedia-open`,children:zt.description})]}),(0,t.jsxs)(h.$n,{fill:"text",size:"sm",variant:"secondary",onClick:()=>it({...et,metricsModalOpen:!0}),className:"metric-encyclopedia-open",children:["Open",(0,t.jsx)(y.I,{name:"arrow-right"})]})]})})}return(0,f.o5)(Ut)},Ot=({children:Ut,maxHeight:zt,innerRef:qt,innerProps:fn})=>{const Sn=(0,p.$j)(),An=(0,v.J)(Sn),Hn=!a.isValidElement(Ut)&&et.resultsTruncated;return(0,t.jsxs)("div",{...fn,className:`${An.menu} ${_e.customMenuContainer}`,style:{maxHeight:Math.round(zt*.9)},"aria-label":"Select options menu",children:[(0,t.jsx)(P.E,{scrollRefCallback:qt,autoHide:!1,autoHeightMax:"inherit",hideHorizontalTrack:!0,showScrollIndicators:!0,children:Ut}),Hn&&(0,t.jsx)("div",{className:_e.customMenuFooter,children:(0,t.jsx)("div",{children:"Only the top 1000 metrics are displayed in the metric select. Use the metrics explorer to view all metrics."})})]})},jt=()=>(0,t.jsx)(m.DW,{"data-testid":d.Tp.components.DataSource.Prometheus.queryEditor.builder.metricSelect,isClearable:!!ft,inputId:"prometheus-metric-select",className:_e.select,value:Te.metric?(0,l.z)(Te.metric):void 0,placeholder:"Select metric",allowCustomValue:!0,formatOptionLabel:Oe,filterOption:xe,minMenuHeight:250,onOpenMenu:async()=>{if(Xe)return;it({isLoading:!0});const Ut=await Qe(),zt=Ut.map(fn=>fn.value),qt=Ut.length;Ut.length>Ee&&(0,E.ky)(Ut),it(dt?{metrics:[...ze,...Ut],isLoading:void 0,initialMetrics:zt,resultsTruncated:qt>Ut.length}:{metrics:Ut,isLoading:void 0,resultsTruncated:qt>Ut.length})},loadOptions:Xe?qe:rt,isLoading:et.isLoading,defaultOptions:et.metrics??Array.from(new Array(25),()=>({value:""})),onChange:Ut=>{const zt=Ut?.value;zt?dt&&zt==="BrowseMetrics"?(Y("grafana_prometheus_metric_encyclopedia_open",null,"",Te),it({...et,metricsModalOpen:!0})):Ge({...Te,metric:zt}):Ge({...Te,metric:""})},components:dt?{Option:vt,MenuList:Ot}:{MenuList:Ot},onBlur:ot});return(0,t.jsxs)(t.Fragment,{children:[dt&&!fe.lookupsDisabled&&et.metricsModalOpen&&(0,t.jsx)(Ie,{datasource:fe,isOpen:et.metricsModalOpen,onClose:()=>it({...et,metricsModalOpen:!1}),query:Te,onChange:Ge,initialMetrics:et.initialMetrics??[]}),ft?(0,t.jsx)(D.C,{children:(0,t.jsx)(x.I,{label:"Metric",labelWidth:20,tooltip:(0,t.jsx)("div",{children:"Optional: returns a list of label values for the label name in the specified metric."}),children:jt()})}):(0,t.jsx)(o.B,{children:(0,t.jsx)(u.c,{label:"Metric",children:jt()})})]})}const Ne=fe=>({select:(0,n.css)({minWidth:"125px"}),highlight:(0,n.css)({label:"select__match-highlight",background:"inherit",padding:"inherit",color:fe.colors.warning.contrastText,backgroundColor:fe.colors.warning.main}),customOption:(0,n.css)({padding:"8px",display:"flex",justifyContent:"space-between",cursor:"pointer",":hover":{backgroundColor:fe.colors.emphasize(fe.colors.background.primary,.1)}}),customOptionlabel:(0,n.css)({color:fe.colors.text.primary}),customOptionDesc:(0,n.css)({color:fe.colors.text.secondary,fontSize:fe.typography.size.xs,opacity:"50%"}),focus:(0,n.css)({backgroundColor:fe.colors.emphasize(fe.colors.background.primary,.1)}),customOptionWidth:(0,n.css)({minWidth:"400px"}),customMenuFooter:(0,n.css)({flex:0,display:"flex",justifyContent:"space-between",padding:fe.spacing(1.5),borderTop:`1px solid ${fe.colors.border.weak}`,color:fe.colors.text.secondary}),customMenuContainer:(0,n.css)({display:"flex",flexDirection:"column",background:fe.colors.background.primary,boxShadow:fe.shadows.z3})}),Fe=(fe,Te)=>{const Ge=Te?Ue(Te):[];return`label_values({__name__=~".*${fe}"${Ge?Ge.join(""):""}},__name__)`},Ue=fe=>fe.map(Te=>`,${Te.label}="${Te.value}"`)},29993:(_,L,e)=>{"use strict";e.d(L,{I:()=>A});var t=e(74848),n=e(96540),r=e(50556),s=e(81996),a=e(32370),g=e(26115),i=e(32196),l=e(2543),d=e(85269),o=e(97801),u=e(81580),c=e(39268),p=e(76892),h=e(76459),y=e.n(h),f=e(50877),v=e(13544),P=e(81392),m=e(3721),D=e(90182);function x({item:S,defaultOp:O,onChange:j,onDelete:B,onGetLabelNames:N,onGetLabelValues:I,invalidLabel:K,invalidValue:w,getLabelValuesAutofillSuggestions:U,debounceDuration:W}){const[H,z]=(0,n.useState)({}),[G,M]=(0,n.useState)(!1),[Q,Y]=(0,n.useState)(!1),[q,te]=(0,n.useState)([]),X=(re=S.op)=>E.find(se=>se.label===re)?.isMultiValue,ee=re=>{if(re){const se=/\(([^)]+)\)/,de=re?.match(se);return de&&de[0].indexOf("|")>0?[re]:re.indexOf("|")>0?re.split("|"):[re]}return[]},ne=y()(re=>U(re,S.label),W),Z=y()(re=>{const se=q.filter(de=>de.value.includes(re));return(0,s.ky)(se)},W),ae=S?.value??"";return(0,t.jsx)("div",{"data-testid":"prometheus-dimensions-filter-item",children:(0,t.jsxs)(P.M,{children:[(0,t.jsx)(D.DW,{placeholder:"Select label","data-testid":v.Tp.components.QueryBuilder.labelSelect,inputId:"prometheus-dimensions-filter-item-key",width:"auto",value:S.label?(0,f.z)(S.label):null,allowCustomValue:!0,onOpenMenu:async()=>{z({isLoadingLabelNames:!0});const re=await N(S);te(re),M(!0);const se=(0,s.ky)(re);z({labelNames:se,isLoadingLabelNames:void 0})},onCloseMenu:()=>{M(!1)},isOpen:G,isLoading:H.isLoadingLabelNames??!1,loadOptions:Z,defaultOptions:H.labelNames,onChange:re=>{re.label&&j({...S,op:S.op??O,label:re.label})},invalid:K}),(0,t.jsx)(D.l6,{"data-testid":v.Tp.components.QueryBuilder.matchOperatorSelect,className:"query-segment-operator",value:(0,f.z)(S.op??O),options:E,width:"auto",onChange:re=>{re.value!=null&&j({...S,op:re.value,value:X(re.value)?S.value:ee(S?.value)[0]})}}),(0,t.jsx)(D.DW,{placeholder:"Select value","data-testid":v.Tp.components.QueryBuilder.valueSelect,inputId:"prometheus-dimensions-filter-item-value",width:"auto",value:X()?ee(ae).map(f.z):ee(ae).map(f.z)[0],allowCustomValue:!0,formatCreateLabel:re=>re,createOptionPosition:S.op?.includes("~")?"first":"last",onOpenMenu:async()=>{z({isLoadingLabelValues:!0});const re=await I(S);(0,s.ky)(re),Y(!0),z({...H,labelValues:re,isLoadingLabelValues:void 0})},onCloseMenu:()=>{Y(!1)},isOpen:Q,defaultOptions:H.labelValues,isMulti:X(),isLoading:H.isLoadingLabelValues,loadOptions:ne,onChange:re=>{if(re.value)j({...S,value:re.value,op:S.op??O});else{const se=re.map(de=>de.label).join("|");j({...S,value:se,op:S.op??O})}},invalid:w}),(0,t.jsx)(m.Z,{"aria-label":`remove-${S.label}`,icon:"times",variant:"secondary",onClick:B})]})},ae)}const E=[{label:"=",value:"=",isMultiValue:!1},{label:"!=",value:"!=",isMultiValue:!1},{label:"=~",value:"=~",isMultiValue:!0},{label:"!~",value:"!~",isMultiValue:!0}],C="Select at least 1 label filter (label and value)";function b({labelsFilters:S,onChange:O,onGetLabelNames:j,onGetLabelValues:B,labelFilterRequired:N,getLabelValuesAutofillSuggestions:I,debounceDuration:K,variableEditor:w}){const U="=",[W,H]=(0,n.useState)([{op:U}]);(0,n.useEffect)(()=>{S.length>0?H(S):H([{op:U}])},[S]);const z=Q=>{H(Q);const Y=Q.filter(q=>q.label!=null&&q.value!=null);(0,l.isEqual)(Y,S)||O(Y)},G=W.some(Q=>Q.label&&Q.value),M=()=>(0,t.jsx)(d.o,{items:W,onChange:z,renderItem:(Q,Y,q)=>(0,t.jsx)(x,{debounceDuration:K,item:Q,defaultOp:U,onChange:Y,onDelete:q,onGetLabelNames:j,onGetLabelValues:B,invalidLabel:N&&!Q.label,invalidValue:N&&!Q.value,getLabelValuesAutofillSuggestions:I})});return(0,t.jsx)(t.Fragment,{children:w?(0,t.jsx)(c.C,{children:(0,t.jsxs)("div",{className:(0,i.cx)((0,i.css)({display:"flex"})),children:[(0,t.jsx)(p.c,{width:20,tooltip:(0,t.jsx)("div",{children:"Optional: used to filter the metric select for this query type."}),children:"Label filters"}),M()]})}):(0,t.jsx)(o.B,{children:(0,t.jsx)(u.c,{label:"Label filters",error:C,invalid:N&&!G,children:M()})})})}var T=e(9103);function A({datasource:S,query:O,onChange:j,onBlur:B,variableEditor:N}){const I=M=>{j({...O,labels:M})},K=(0,n.useCallback)(async M=>{const Q=S.getVariables(),Y=await M;return[...Q.map(q=>({label:q,value:q})),...Y.map(q=>({label:q.value,value:q.value,title:q.description}))]},[S]),w=async M=>{if(!O.metric)return await S.languageProvider.fetchLabels(),S.languageProvider.getLabelKeys().map(te=>({value:te}));const Q=O.labels.filter(te=>te!==M);Q.push({label:"__name__",op:"=",value:O.metric});const Y=a.z.renderLabels(Q);let q=await S.languageProvider.fetchLabelsWithMatch(Y);return Object.keys(q).filter(te=>!Q.find(X=>X.label===te)).map(te=>({value:te}))},U=(M,Q)=>{const Y={label:Q??"__name__",op:"=~",value:(0,g.b4)(`.*${M}`)},q=O.labels.filter(ne=>ne.label!==Y.label);q.push(Y),O.metric&&q.push({label:"__name__",op:"=",value:O.metric});const te=q.map(ne=>({...ne,label:S.interpolateString(ne.label),value:S.interpolateString(ne.value)})),X=a.z.renderLabels(te);let ee;return S.hasLabelsMatchAPISupport()?ee=H(Y,X):ee=W(Y,X),ee.then(ne=>((0,s.ky)(ne),ne))},W=(M,Q)=>{if(!M.label)return Promise.resolve([]);const Y=S.languageProvider.fetchSeries(Q),q=S.interpolateString(M.label);return Y.then(te=>{const X=new Set;return te.forEach(ee=>{const ne=ee[q];X.add(ne)}),Array.from(X).map(ee=>({label:ee,value:ee}))})},H=(M,Q)=>{if(!M.label)return Promise.resolve([]);const Y=`[${S.uid}][${O.metric}][${M.label}][${M.op}]`;return S.languageProvider.fetchSeriesValuesWithMatch(M.label,Q,Y).then(q=>q.map(te=>({value:te,label:te})))},z=async M=>{if(!M.label)return[];if(!O.metric)return(await S.languageProvider.getLabelValues(M.label)).map(te=>({value:te}));const Q=O.labels.filter(te=>te!==M);Q.push({label:"__name__",op:"=",value:O.metric});const Y=Q.map(te=>({...te,label:S.interpolateString(te.label),value:S.interpolateString(te.value)})),q=a.z.renderLabels(Y);return S.hasLabelsMatchAPISupport()?H(M,q):W(M,q)},G=(0,n.useCallback)(()=>K(R(S,O)),[S,O,K]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.dm,{query:O,onChange:j,onGetMetrics:G,datasource:S,labelsFilters:O.labels,metricLookupDisabled:S.lookupsDisabled,onBlur:B||(()=>{}),variableEditor:N}),(0,t.jsx)(b,{debounceDuration:S.getDebounceTimeInMilliseconds(),getLabelValuesAutofillSuggestions:U,labelsFilters:O.labels,onChange:I,onGetLabelNames:M=>K(w(M)),onGetLabelValues:M=>K(z(M)),variableEditor:N})]})}async function R(S,O){S.languageProvider.metricsMetadata||await S.languageProvider.loadMetricsMetadata(),S.languageProvider.metricsMetadata||(S.languageProvider.metricsMetadata={});let j;if(O.labels.length>0){const B=a.z.renderLabels(O.labels);j=(await S.languageProvider.getSeries(B,!0)).__name__??[]}else j=await S.languageProvider.getLabelValues("__name__")??[];return j.map(B=>({value:B,description:(0,r.xB)(B,S.languageProvider.metricsMetadata)}))}},26432:(_,L,e)=>{"use strict";e.d(L,{W:()=>o,i:()=>u});var t=e(74848),n=e(96540),r=e(67061),s=e(20719),a=e(32370),g=e(76040),i=e(27994),l=e(96625),d=e(3884);const o="Fetch all series matching metric name and label filters.",u=(0,n.memo)(({query:c})=>{const p=(0,g.u)(c||"").query,h={grammar:s.Ay,name:"promql"};return(0,t.jsxs)(r.B,{gap:.5,direction:"column",children:[(0,t.jsx)(i.r,{stepNumber:1,title:(0,t.jsx)(d.Z,{query:`${p.metric} ${a.z.renderLabels(p.labels)}`,lang:h}),children:o}),(0,t.jsx)(l.k,{stepNumber:2,queryModeller:a.z,query:p,lang:h})]})});u.displayName="PromQueryBuilderExplained"},80109:(_,L,e)=>{"use strict";e.d(L,{$:()=>i});var t=e(74848),n=e(32196),r=e(13544),s=e(40845),a=e(7338),g=e(26432);function i(d){const{query:o,datasource:u,range:c,onRunQuery:p,onChange:h,data:y,app:f,showExplain:v}=d,P=(0,s.of)(l);return(0,t.jsxs)("div",{"data-testid":r.Tp.components.DataSource.Prometheus.queryEditor.code.queryField,className:P.wrapper,children:[(0,t.jsx)(a.L,{datasource:u,query:o,range:c,onRunQuery:p,onChange:h,history:[],data:y,app:f}),v&&(0,t.jsx)(g.i,{query:o.expr})]})}const l=d=>({wrapper:(0,n.css)({".gf-form":{marginBottom:0}})})},78036:(_,L,e)=>{"use strict";e.d(L,{J3:()=>t,mt:()=>s,ue:()=>r,yH:()=>n});const t=100,n=1e3;function r(a){return{isLoading:!0,metrics:[],hasMetadata:!0,metaHaystackDictionary:{},metaHaystackMatches:[],metaHaystackOrder:[],nameHaystackDictionary:{},nameHaystackOrder:[],nameHaystackMatches:[],totalMetricCount:0,filteredMetricCount:null,resultsPerPage:t,pageNum:1,fuzzySearchQuery:"",fullMetaSearch:a?.fullMetaSearch??!1,includeNullMetadata:a?.includeNullMetadata??!0,selectedTypes:[],useBackend:a?.useBackend??!1,disableTextWrap:a?.disableTextWrap??!1,showAdditionalSettings:!1}}function s(a){return{useBackend:a?.useBackend??!1,disableTextWrap:a?.disableTextWrap??!1,fullMetaSearch:a?.fullMetaSearch??!1,includeNullMetadata:a.includeNullMetadata??!1}}},1220:(_,L,e)=>{"use strict";e.d(L,{DQ:()=>h,G3:()=>v,Kl:()=>u,OS:()=>y,iZ:()=>p,jC:()=>P,jY:()=>i,kf:()=>l,nU:()=>o,z2:()=>f});var t=e(2543),n=e.n(t),r=e(55127),s=e.n(r),a=e(38961),g=e(15145);function i(A,R,S){const O=c(A,R,S),j=A.id+"(";return S&&O.push(S),j+O.join(", ")+")"}function l(A,R,S){const O=c(A,R,S),j=A.id+"(";return S&&O.unshift(S),j+O.join(", ")+")"}function d(A,R,S,O){if(R.params.length<2)throw`Cannot render a function with params of length [${R.params.length}]`;let j=(A.params??[])[0]??"5m";const B=c({...A,params:A.params.slice(1)},{...R,params:R.params.slice(1),defaultParams:R.defaultParams.slice(1)},S),N=A.id+"(";return S&&(O?B.push(`${S}[${j}]`):B.unshift(`${S}[${j}]`)),N+B.join(", ")+")"}function o(A,R,S){return d(A,R,S,!1)}function u(A,R,S){return d(A,R,S,!0)}function c(A,R,S){return(A.params??[]).map((O,j)=>R.params[j].type==="string"?'"'+O+'"':O)}function p(A,R){const S={id:A.id,params:A.defaultParams};return{...R,operations:[...R.operations,S]}}function h(A){return(0,t.capitalize)(A.replace(/_/g," "))}function y(A,R){return`operations.${A}.param.${R}`}function f(A=!1){const R=[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}];return A&&R.unshift({label:"$__rate_interval",value:"$__rate_interval"}),{name:"Range",type:"string",options:R}}function v(A,R={}){return[{id:A,name:h(A),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:g.Ag.Aggregations,renderer:i,paramChangedHandler:b(`__${A}_by`),explainHandler:x(A,""),addOperationHandler:p,...R},{id:`__${A}_by`,name:`${h(A)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:a.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:m(A),paramChangedHandler:C(A),explainHandler:x(A,"by"),addOperationHandler:p,hideFromList:!0,...R},{id:`__${A}_without`,name:`${h(A)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:a.r}],defaultParams:[""],alternativesKey:"aggregations by",category:g.Ag.Aggregations,renderer:D(A),paramChangedHandler:C(A),explainHandler:x(A,"without"),addOperationHandler:p,hideFromList:!0,...R}]}function P(A,R,S={}){const O=v(A,S);return O[0].params.unshift(...R.params),O[1].params.unshift(...R.params),O[2].params.unshift(...R.params),O[0].defaultParams=R.defaultParams,O[1].defaultParams=[...R.defaultParams,""],O[2].defaultParams=[...R.defaultParams,""],O[1].renderer=E(A),O[2].renderer=E(A),O}function m(A){return function(S,O,j){return`${A} by(${S.params.join(", ")}) (${j})`}}function D(A){return function(S,O,j){return`${A} without(${S.params.join(", ")}) (${j})`}}function x(A,R){return function(O){const j=O.params.map(N=>`\`${N}\``).join(" and "),B=s()("label",O.params.length);switch(R){case"by":return`Calculates ${A} over dimensions while preserving ${B} ${j}.`;case"without":return`Calculates ${A} over the dimensions ${j}. All other labels are preserved.`;default:return`Calculates ${A} over the dimensions.`}}}function E(A){return function(S,O,j){const B=O.params.findIndex(K=>K.restParam),N=S.params.slice(0,B),I=S.params.slice(B);return`${A} by(${I.join(", ")}) (${N.map((K,w)=>O.params[w].type==="string"?`"${K}"`:K).join(", ")}, ${j})`}}function C(A){return function(S,O,j){return O.params.length<j.params.length?{...O,id:A}:O}}function b(A){return function(S,O,j){return O.params.length===j.params.length?{...O,id:A}:O}}function T(A,R){if(!A.label||!A.op||!A.value||R.length<2)return!1;const S=A.op.toString().startsWith("!");return R.filter(B=>B.label===A.label&&B.value===A.value&&B.op!==A.op).some(B=>!!(S&&B?.op?.toString().startsWith("!")===!1||S===!1&&B?.op?.toString().startsWith("!")))}},76040:(_,L,e)=>{"use strict";e.d(L,{u:()=>s});var t=e(84555),n=e(75161),r=e(26115);function s(f){const v=(0,r.qk)(f),m=t.K3.parse(v).topNode,x={query:{metric:"",labels:[],operations:[]},errors:[]};try{g(v,m,x)}catch(E){console.error(E),E instanceof Error&&x.errors.push({text:E.message})}return y(x.query)&&(x.errors=[]),a(f)&&(x.errors=[]),x}function a(f){const v={query:{metric:"",labels:[],operations:[]},errors:[]};f=f.replace(/\$__interval/g,"1s"),f=f.replace(/\$__interval_ms/g,"1000"),f=f.replace(/\$__rate_interval/g,"1s"),f=f.replace(/\$__range_ms/g,"1000"),f=f.replace(/\$__range_s/g,"1"),f=f.replace(/\$__range/g,"1s");const m=t.K3.parse(f).topNode;try{g(f,m,v)}catch{return!1}return v.errors.length===0}function g(f,v,P){const m=P.query;switch(v.type.id){case t.gw:{m.metric=(0,r.AA)(f,v);break}case t.Yq:{m.labels.push(l(f,v));const D=v.getChild(r.Ql);D&&P.errors.push((0,r.xz)(f,D));break}case t.R6:{o(f,v,P);break}case t.Fn:{u(f,v,P);break}case t.df:{p(f,v,P);break}case r.Ql:{if(i(v))break;P.errors.push((0,r.xz)(f,v));break}default:{v.type.id===t.ek&&P.errors.push((0,r.xz)(f,v));let D=v.firstChild;for(;D;)g(f,D,P),D=D.nextSibling}}}function i(f){return f.prevSibling?.firstChild?.type.id===t.Fb}function l(f,v){const P=(0,r.AA)(f,v.getChild(t.IC)),m=(0,r.AA)(f,v.getChild(t.Lf)),D=(0,r.AA)(f,v.getChild(t.LW)).replace(/^["'`]|["'`]$/g,"");return{label:P,op:m,value:D}}const d=["changes","rate","irate","increase","delta"];function o(f,v,P){const m=P.query,D=v.getChild(t.m3),x=(0,r.AA)(f,D),E=v.getChild(t.Dh),C=[];let b="";if(d.includes(x)||x.endsWith("_over_time")){let A=(0,r.AA)(f,v).match(/\[(.+)\]/);A?.[1]&&(b=A[1],C.push(A[1]))}const T={id:x,params:C};if(m.operations.unshift(T),E){if((0,r.AA)(f,E)==="(["+b+"])")return;c(f,E,P,T)}}function u(f,v,P){const m=P.query,D=v.getChild(t.xb);let x=(0,r.AA)(f,D);const E=v.getChild(t.hI),C=[];E&&(E.getChild("By")&&x&&(x=`__${x}_by`),E.getChild(t.xB)&&(x=`__${x}_without`),C.push(...(0,r.R1)(f,E,t.IC)));const b=v.getChild(t.Dh),T={id:x,params:[]};m.operations.unshift(T),c(f,b,P,T),T.params.push(...C)}function c(f,v,P,m){if(v)switch(v.type.id){case t.Dh:{let D=v.firstChild;for(;D;){let x;D.type.id===t.df?x=D:x=D.getChild(t.df),x&&P.errors.push({text:"Query parsing is ambiguous.",from:x.from,to:x.to}),c(f,D,P,m),D=D.nextSibling}break}case t.Po:{m.params.push(parseFloat((0,r.AA)(f,v)));break}case t.LW:{m.params.push((0,r.AA)(f,v).replace(/"/g,""));break}default:g(f,v,P)}}function p(f,v,P){const m=P.query,D=v.firstChild,x=(0,r.AA)(f,D.nextSibling),E=h(f,v.getChild(t.eM)??v.getChild(t.Ue)),C=v.lastChild,b=n.AE[x],T=D.type.id===t.Po,A=C.type.id===t.Po,R=C.type.id===t.df;if(T||g(f,D,P),A)m.operations.push((0,r.rq)(b,f,C,!!E?.isBool));else if(R){const S=(0,r.z9)(C);S?.type.id===t.Po&&m.operations.push((0,r.rq)(b,f,S,!!E?.isBool)),g(f,C,P)}else{m.binaryQueries=m.binaryQueries||[];const S={operator:x,query:{metric:"",labels:[],operations:[]}};E?.isMatcher&&(S.vectorMatchesType=E.matchType,S.vectorMatches=E.matches),m.binaryQueries.push(S),g(f,C,{query:S.query,errors:P.errors})}}function h(f,v){if(v){if(v.getChild("Bool"))return{isBool:!0,isMatcher:!1};{let P="";const m=v.getChild(t.x$);return m&&(P=(0,r.R1)(f,m,t.IC).join(", ")),{isMatcher:!0,isBool:!1,matches:P,matchType:v.getChild(t.On)?"on":"ignoring"}}}}function y(f){return f.labels.length===0&&f.operations.length===0&&!f.metric}},26115:(_,L,e)=>{"use strict";e.d(L,{AA:()=>l,Ql:()=>t,R1:()=>o,b4:()=>u,qk:()=>a,rq:()=>d,xz:()=>r,z9:()=>n});const t=0;function n(c){return c.firstChild?n(c.firstChild):c}function r(c,p){return{text:l(c,p),from:p.from,to:p.to,parentType:p.parent?.name}}const s=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function a(c){return c.replace(s,(p,h,y,f,v,P,m)=>{const D=f||m;let x=h,E="0";return y&&(x=y,E="1"),v&&(x=v,E="2"),`__V_${E}__`+x+"__V__"+(D?"__F__"+D+"__F__":"")})}const g=[(c,p)=>`$${c}`,(c,p)=>`[[${c}${p?`:${p}`:""}]]`,(c,p)=>`\${${c}${p?`:${p}`:""}}`];function i(c){return c.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(p,h,y,f)=>g[parseInt(h,10)](y,f))}function l(c,p){return p?i(c.substring(p.from,p.to)):""}function d(c,p,h,y){const f=[parseFloat(l(p,h))];return c.comparison&&f.push(y),{id:c.id,params:f}}function o(c,p,h){if(p.type.id===h)return[l(c,p)];const y=[];let f=0,v=p.childAfter(f);for(;v;)y.push(...o(c,v,h)),f=v.to,v=p.childAfter(f);return y}const u=c=>c.split(" ").map(h=>`${h}.*`).join("")},27994:(_,L,e)=>{"use strict";e.d(L,{r:()=>a});var t=e(74848),n=e(32196),r=e(36663),s=e(40845);function a({title:i,stepNumber:l,markdown:d,children:o}){const u=(0,s.of)(g);return(0,t.jsxs)("div",{className:u.box,children:[l!==void 0&&(0,t.jsx)("div",{className:u.stepNumber,children:l}),(0,t.jsxs)("div",{className:u.boxInner,children:[i&&(0,t.jsx)("div",{className:u.header,children:(0,t.jsx)("span",{children:i})}),(0,t.jsxs)("div",{className:u.body,children:[d&&(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:(0,r.G)(d)}}),o]})]})]})}const g=i=>({box:(0,n.css)({background:i.colors.background.secondary,padding:i.spacing(1),borderRadius:i.shape.radius.default,position:"relative"}),boxInner:(0,n.css)({marginLeft:i.spacing(4)}),stepNumber:(0,n.css)({fontWeight:i.typography.fontWeightMedium,background:i.colors.secondary.main,width:"20px",height:"20px",borderRadius:i.shape.radius.circle,display:"flex",alignItems:"center",justifyContent:"center",position:"absolute",top:"10px",left:"11px",fontSize:i.typography.bodySmall.fontSize}),header:(0,n.css)({paddingBottom:i.spacing(.5),display:"flex",alignItems:"center",fontFamily:i.typography.fontFamilyMonospace}),body:(0,n.css)({color:i.colors.text.secondary,"p:last-child":{margin:0},a:{color:i.colors.text.link,textDecoration:"underline"}})})},96625:(_,L,e)=>{"use strict";e.d(L,{k:()=>s});var t=e(74848),n=e(27994),r=e(3884);function s({query:a,queryModeller:g,stepNumber:i,lang:l,onMouseEnter:d,onMouseLeave:o}){return(0,t.jsx)(t.Fragment,{children:a.operations.map((u,c)=>{const p=g.getOperationDef(u.id);if(!p)return`Operation ${u.id} not found`;const h=p.renderer(u,p,"<expr>"),y=p.explainHandler?p.explainHandler(u,p):p.documentation??"no docs";return(0,t.jsx)("div",{onMouseEnter:()=>d?.(u,c),onMouseLeave:()=>o?.(u,c),children:(0,t.jsx)(n.r,{stepNumber:c+i,title:(0,t.jsx)(r.Z,{query:h,lang:l}),markdown:y})},c)})})}},3884:(_,L,e)=>{"use strict";e.d(L,{Z:()=>g});var t=e(74848),n=e(32196),r=e(28848),s=e.n(r),a=e(40845);function g({query:l,lang:d,className:o}){const u=(0,a.$j)(),c=i(u),p=s().highlight(l,d.grammar,d.name);return(0,t.jsx)("div",{className:(0,n.cx)(c.editorField,"prism-syntax-highlight",o),"aria-label":"selector",dangerouslySetInnerHTML:{__html:p}})}const i=l=>({editorField:(0,n.css)({fontFamily:l.typography.fontFamilyMonospace,fontSize:l.typography.bodySmall.fontSize})})},15145:(_,L,e)=>{"use strict";e.d(L,{Ag:()=>t,jN:()=>n,n5:()=>r});var t=(s=>(s.Aggregations="Aggregations",s.RangeFunctions="Range functions",s.Functions="Functions",s.BinaryOps="Binary operations",s.Trigonometric="Trigonometric",s.Time="Time Functions",s))(t||{}),n=(s=>(s.Abs="abs",s.Absent="absent",s.AbsentOverTime="absent_over_time",s.Acos="acos",s.Acosh="acosh",s.Asin="asin",s.Asinh="asinh",s.Atan="atan",s.Atanh="atanh",s.Avg="avg",s.AvgOverTime="avg_over_time",s.BottomK="bottomk",s.Ceil="ceil",s.Changes="changes",s.Clamp="clamp",s.ClampMax="clamp_max",s.ClampMin="clamp_min",s.Cos="cos",s.Cosh="cosh",s.Count="count",s.CountOverTime="count_over_time",s.CountScalar="count_scalar",s.CountValues="count_values",s.DayOfMonth="day_of_month",s.DayOfWeek="day_of_week",s.DayOfYear="day_of_year",s.DaysInMonth="days_in_month",s.Deg="deg",s.Delta="delta",s.Deriv="deriv",s.DropCommonLabels="drop_common_labels",s.Exp="exp",s.Floor="floor",s.Group="group",s.HistogramQuantile="histogram_quantile",s.HistogramAvg="histogram_avg",s.HistogramCount="histogram_count",s.HistogramSum="histogram_sum",s.HistogramFraction="histogram_fraction",s.HistogramStddev="histogram_stddev",s.HistogramStdvar="histogram_stdvar",s.HoltWinters="holt_winters",s.Hour="hour",s.Idelta="idelta",s.Increase="increase",s.Irate="irate",s.LabelJoin="label_join",s.LabelReplace="label_replace",s.Last="last",s.LastOverTime="last_over_time",s.Ln="ln",s.Log10="log10",s.Log2="log2",s.Max="max",s.MaxOverTime="max_over_time",s.Min="min",s.MinOverTime="min_over_time",s.Minute="minute",s.Month="month",s.Pi="pi",s.PredictLinear="predict_linear",s.Present="present",s.PresentOverTime="present_over_time",s.Quantile="quantile",s.QuantileOverTime="quantile_over_time",s.Rad="rad",s.Rate="rate",s.Resets="resets",s.Round="round",s.Scalar="scalar",s.Sgn="sgn",s.Sin="sin",s.Sinh="sinh",s.Sort="sort",s.SortDesc="sort_desc",s.Sqrt="sqrt",s.Stddev="stddev",s.StddevOverTime="stddev_over_time",s.Sum="sum",s.SumOverTime="sum_over_time",s.Tan="tan",s.Tanh="tanh",s.Time="time",s.Timestamp="timestamp",s.TopK="topk",s.Vector="vector",s.Year="year",s.Addition="__addition",s.Subtraction="__subtraction",s.MultiplyBy="__multiply_by",s.DivideBy="__divide_by",s.Modulo="__modulo",s.Exponent="__exponent",s.NestedQuery="__nested_query",s.EqualTo="__equal_to",s.NotEqualTo="__not_equal_to",s.GreaterThan="__greater_than",s.LessThan="__less_than",s.GreaterOrEqual="__greater_or_equal",s.LessOrEqual="__less_or_equal",s))(n||{}),r=(s=>(s.Rate="rate",s.Histogram="histogram",s.Binary="binary",s))(r||{})},33115:(_,L,e)=>{"use strict";e.d(L,{$i:()=>l,Dr:()=>g});var t=e(70416),n=e(47232),r=e(77678),s=e(67414),a=e(65879);const g="10m",i=o=>`${o.type}|${o.name}|${JSON.stringify(o.labels??"")}`;class l{constructor(u){this.applyInterpolation=(p,h)=>p,this.cache=new Map;const c=u.overlapString;if((0,t.di)(c)){const p=(0,t.E9)(c);this.overlapWindowMs=(0,t.WT)(p)}else{const p=(0,t.E9)(g);this.overlapWindowMs=(0,t.WT)(p)}this.getTargetSignature=u.getTargetSignature,u.applyInterpolation&&(this.applyInterpolation=u.applyInterpolation)}requestInfo(u){const c=u.range.from.valueOf(),p=u.range.to.valueOf(),h=u.rangeRaw?.to?.toString()==="now";let y=h,f;const v=new Map;u.targets.forEach(P=>{let m=`${u.dashboardUID}|${u.panelId}|${P.refId}`,D=this.getTargetSignature(u,P);v.set(m,D)});for(const[P,m]of v){let D=this.cache.get(P);if(D?.signature!==m?y=!1:(f=D?.prevTo??1/0,y=p>f&&c<=f),!y)break}if(y&&f){let P=Math.max(f-this.overlapWindowMs,c);const m=(0,n.KQ)(p),D=(0,n.KQ)((0,r.rs)(P,u.intervalMs));u={...u,range:{...u.range,from:D,to:m}}}else v.forEach((P,m)=>{this.cache.delete(m)});return{requests:[u],targetSignatures:v,shouldCache:h}}procFrames(u,c,p){if(c?.shouldCache){const h=u.range.from.valueOf(),y=u.range.to.valueOf(),f=new Map;p.forEach(P=>{let m=`${u.dashboardUID}|${u.panelId}|${P.refId}`,D=f.get(m);D||(D=[],f.set(m,D)),D.push(P)});let v=[];f.forEach((P,m)=>{let D=(m?this.cache.get(m)?.frames:null)??[];P.forEach(E=>{if(E.length===0||E.fields.length===0)return;let C=i(E.fields[1]),b=D.find(T=>i(T.fields[1])===C);if(!b)D.push(E);else{let T=b.fields.map(S=>S.values),A=E.fields.map(S=>S.values),R=(0,s.c)(T,A);if(R){for(let S=0;S<R.length;S++)b.fields[S].values=R[S],b.fields[S].config.displayNameFromDS!==E.fields[S].config.displayNameFromDS&&(b.fields[S].config.displayNameFromDS=E.fields[S].config.displayNameFromDS);b.length=b.fields[0].values.length}}});let x=[];D.forEach(E=>{let C=E.fields.map(A=>A.values);const b=d(u,P,this.applyInterpolation);let T=(0,s.F)(C,h-b,y);if(T[0].length>0){for(let A=0;A<T.length;A++)E.fields[A].values=T[A];x.push(E)}}),this.cache.set(m,{signature:c.targetSignatures.get(m),frames:x,prevTo:y}),v.push(...x)}),p=v.map(P=>({...P,fields:P.fields.map(m=>({...m,config:{...m.config},values:m.values.slice()}))}))}return p}}function d(o,u,c){if(o.targets[0].datasource?.type!=="prometheus")return 0;const p=o.targets.find(y=>y.refId===u[0].refId);let h=o.intervalMs;if(p?.interval){const y=a.intervalToMs(c(p.interval));y>o.intervalMs&&(h=y)}return h}},59809:(_,L,e)=>{"use strict";e.d(L,{Bm:()=>b,J3:()=>p,L:()=>T,hF:()=>x});var t=e(2543),n=e.n(t),r=e(41987),s=e(41260),a=e(11261),g=e(28240),i=e(52622),l=e(57875),d=e(19347);const o=/^[+-]?inf(?:inity)?$/i,u=(A,R)=>R.app===r.Jk.Explore&&(A.meta?.custom?.resultType==="vector"||A.meta?.custom?.resultType==="scalar")?!0:R.targets.find(O=>O.refId===A.refId)?.format==="table",c=(A,R)=>A.meta?.type===s.m.HeatmapCells?!1:R.targets.find(O=>O.refId===A.refId)?.format==="heatmap";function p(A,R,S){A.data.forEach(Q=>{const Y=R.targets.find(q=>q.refId===Q.refId);Y&&Y.legendFormat==="__auto"&&Q.fields.forEach(q=>{if(q.labels?.__name__&&q.labels?.__name__===q.name){const te={...q,name:a.Bc};q.config.displayNameFromDS=(0,g.Ct)(te,Q,A.data)}})});const[O,j]=(0,t.partition)(A.data,Q=>u(Q,R)),B=y(O),[N,I]=(0,t.partition)(j,Q=>Q.meta?.custom?.resultType==="exemplar"),{exemplarTraceIdDestinations:K}=S,w=N.map(Q=>{if(K?.length)for(const Y of K){const q=Q.fields.find(te=>te.name===Y.name);if(q){const te=v(Y);q.config.links=q.config.links?.length?[...q.config.links,...te]:te}}return{...Q,meta:{...Q.meta,dataTopic:i.QR.Annotations}}}),[U,W]=(0,t.partition)(I,Q=>c(Q,R));U.forEach(Q=>{if(Q.name==null){let Y=Q.fields.find(q=>q.type===a.PU.number);if(Y){let q=Y.labels?.le;q&&(Q.name=q,Y.config.displayNameFromDS=q)}}});const H=(0,t.groupBy)(U,Q=>Q.refId);let z=[];for(const Q in H){const Y=H[Q],q=(0,t.groupBy)(Y,te=>{const X=te.fields.find(ee=>ee.type===a.PU.number);if(X?.labels&&h in X.labels){const{le:ee,...ne}=X?.labels;return Object.values(ne).join()}return Object.values(X?.labels??[]).join()});(0,t.forOwn)(q,(te,X)=>{const ee=te.sort(b);z.push(E(C(ee)))})}const G=W.map(Q=>({...Q,meta:{...Q.meta,preferredVisualisationType:"graph"}})),M=(0,t.flatten)(z);return{...A,data:[...G,...B,...M,...w]}}const h="le";function y(A){if(A.length===0||A.length===1&&A[0].length===0)return A;const R=(0,t.groupBy)(A,"refId"),S=Object.keys(R);return S.map(j=>{const B=f(S.length,j),N=D({data:[],valueName:B}),I=m([]),K=[];R[j].forEach(U=>{const H=U.fields[1]?.labels??{};Object.keys(H).sort().forEach(z=>{K.some(G=>G.name===z)||K.push({name:z,config:{filterable:!0},type:a.PU.string,values:[]})})}),R[j].forEach(U=>{I.config.interval??=U.fields[0]?.config.interval;const W=U.fields[0]?.values??[],H=U.fields[1]?.values??[];W.forEach(z=>I.values.push(z)),H.forEach(z=>{N.values.push(T(z));const G=U.fields[1].labels??{};K.forEach(M=>M.values.push(P(G,M.name)))})});const w=[I,...K,N];return{refId:j,fields:w,meta:{...R[j][0].meta,preferredVisualisationType:"rawPrometheus"},length:I.values.length}})}function f(A,R=""){return A>1?`Value #${R}`:"Value"}function v(A){const R=[];if(A.datasourceUid){const O=(0,d.l)().getInstanceSettings(A.datasourceUid);O&&R.push({title:A.urlDisplayLabel||`Query with ${O?.name}`,url:"",internal:{query:{query:"${__value.raw}",queryType:"traceql"},datasourceUid:A.datasourceUid,datasourceName:O?.name??"Data source not found"}})}return A.url&&R.push({title:A.urlDisplayLabel||`Go to ${A.url}`,url:A.url,targetBlank:!0}),R}function P(A,R){return A.hasOwnProperty(R)?A[R]:""}function m(A,R=!1){return{name:a.LE,type:a.PU.time,config:{},values:A.map(S=>R?S[0]:S[0]*1e3)}}function D({data:A,valueName:R=a.Bc,parseValue:S=!0,labels:O,displayNameFromDS:j}){return{name:R,type:a.PU.number,display:(0,l.J)(),config:{displayNameFromDS:j},labels:O,values:A.map(B=>S?T(B[1]):B[1])}}function x(A){const R=A.__name__||"";delete A.__name__;const S=Object.entries(A).map(O=>`${O[0]}="${O[1]}"`).join(",");return`${R}{${S}}`}function E(A){if(A.length===0||A.length===1&&A[0].length===0)return[];const R=A[0].fields.find(O=>O.type===a.PU.time),S=A.map(O=>{let j=O.fields.find(B=>B.type===a.PU.number);return{...j,name:j.config.displayNameFromDS}});return[{...A[0],meta:{...A[0].meta,type:s.m.HeatmapRows},fields:[R,...S]}]}function C(A){for(let R=A.length-1;R>0;R--){const S=A[R].fields.find(j=>j.type===a.PU.number),O=A[R-1].fields.find(j=>j.type===a.PU.number);if(!S||!O)throw new Error("Prometheus heatmap transform error: data should be a time series");for(let j=0;j<S.values.length;j++){const B=O.values[j]||[0];S.values[j]-=B,S.values[j]<1e-9&&(S.values[j]=0)}}return A}function b(A,R){let S,O;try{S=T(A.fields[1].state?.displayName??A.name??A.fields[1].name),O=T(R.fields[1].state?.displayName??R.name??R.fields[1].name)}catch(j){return console.error(j),0}return S>O?1:S<O?-1:0}function T(A){return o.test(A)?A[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY:parseFloat(A)}},62183:(_,L,e)=>{"use strict";e.d(L,{B4:()=>s,N1:()=>n,fD:()=>t,m_:()=>r});var t=(a=>(a.Low="Low",a.Medium="Medium",a.High="High",a.None="None",a))(t||{}),n=(a=>(a.Cortex="Cortex",a.Mimir="Mimir",a.Prometheus="Prometheus",a.Thanos="Thanos",a))(n||{}),r=(a=>(a.Auto="__auto",a.Verbose="__verbose",a.Custom="__custom",a))(r||{}),s=(a=>(a[a.LabelNames=0]="LabelNames",a[a.LabelValues=1]="LabelValues",a[a.MetricNames=2]="MetricNames",a[a.VarQueryResult=3]="VarQueryResult",a[a.SeriesQuery=4]="SeriesQuery",a[a.ClassicQuery=5]="ClassicQuery",a))(s||{})},5261:(_,L,e)=>{"use strict";e.d(L,{L:()=>n,y:()=>r});var t=e(32264);function n(s){return{grafana_version:t.$.buildInfo.version,plugin_type:String(s.type),plugin_version:s.info.version,plugin_id:s.id,plugin_name:s.name}}function r(s){return{...n(s.meta),datasource_uid:s.uid}}},44027:(_,L,e)=>{"use strict";e.d(L,{G:()=>i});var t=e(96540),n=e(92470),r=e(95187),s=e(14110),a=e(5261);const g="grafana_plugin_";function i(){const d=(0,n.Q)();return(0,t.useMemo)(()=>{if(!d)throw new Error("No PluginContext found. The usePluginInteractionReporter() hook can only be used from a plugin.");const o=(0,r.S)(d)?(0,a.y)(d.instanceSettings):(0,a.L)(d.meta);return(u,c)=>{if(!l(u))throw new Error(`Interactions reported in plugins should start with: "${g}".`);return(0,s.rR)(u,{...c,...o})}},[d])}function l(d){return d.startsWith(g)&&d.length>g.length}},61298:(_,L,e)=>{"use strict";e.d(L,{fX:()=>r,nB:()=>n,n_:()=>t,p6:()=>s});var t=(a=>(a.DashboardView="dashboard-view",a.DataRequest="data-request",a))(t||{});const n=a=>!!a.payload.page,r=a=>!!a.payload.interactionName,s=a=>!!a.payload.experimentId},14110:(_,L,e)=>{"use strict";e.d(L,{G$:()=>s,Jy:()=>a,Xp:()=>i,rR:()=>g});var t=e(32264),n=e(39601),r=e(63415);const s=l=>{(0,r.x$)().addEvent({type:r.on.MetaAnalytics,payload:l})},a=()=>{const l=n.Ny.getLocation(),d=`${t.$.appSubUrl??""}${l.pathname}${l.search}${l.hash}`;(0,r.x$)().addEvent({type:r.on.Pageview,payload:{page:d}})},g=(l,d)=>{t.$.reportingStaticContext&&t.$.reportingStaticContext instanceof Object&&(d={...d,...t.$.reportingStaticContext}),(0,r.x$)().addEvent({type:r.on.Interaction,payload:{interactionName:l,properties:d}})},i=(l,d,o)=>{(0,r.x$)().addEvent({type:r.on.ExperimentView,payload:{experimentId:l,experimentGroup:d,experimentVariant:o}})}},55882:(_,L,e)=>{"use strict";e.d(L,{s:()=>u});var t=e(74848),n=e(96540),r=e(22391),s=e(51527),a=e(13544),g=e(90182),i=e(67061),l=e(98624),d=e(19347),o=e(26657);class u extends n.PureComponent{constructor(p){super(p),this.dataSourceSrv=(0,d.l)(),this.state={},this.onChange=(h,y)=>{if(y.action==="clear"&&this.props.onClear){this.props.onClear();return}const f=this.dataSourceSrv.getInstanceSettings(h.value);f&&(this.props.onChange(f),this.setState({error:void 0}))}}static{this.defaultProps={autoFocus:!1,openMenuOnFocus:!1,placeholder:"Select data source"}}componentDidMount(){const{current:p}=this.props;this.dataSourceSrv.getInstanceSettings(p)||this.setState({error:"Could not find data source "+p})}getCurrentValue(){const{current:p,hideTextValue:h,noDefault:y}=this.props;if(!p&&y)return;const f=this.dataSourceSrv.getInstanceSettings(p);if(f)return{label:f.name.slice(0,37),value:f.uid,imgUrl:f.meta.info.logos.small,hideText:h,meta:f.meta};const v=(0,r.Iz)(p);return v===o.dR.uid||v===o.dR.name?{label:v,value:v,hideText:h}:{label:(v??"no name")+" - not found",value:v??void 0,imgUrl:"",hideText:h}}getDataSourceOptions(){const{alerting:p,tracing:h,metrics:y,mixed:f,dashboard:v,variables:P,annotations:m,pluginId:D,type:x,filter:E,logs:C}=this.props;return this.dataSourceSrv.getList({alerting:p,tracing:h,metrics:y,logs:C,dashboard:v,mixed:f,variables:P,annotations:m,pluginId:D,filter:E,type:x}).map(T=>({value:T.name,label:`${T.name}${T.isDefault?" (default)":""}`,imgUrl:T.meta.info.logos.small,meta:T.meta}))}render(){const{autoFocus:p,onBlur:h,onClear:y,openMenuOnFocus:f,placeholder:v,width:P,inputId:m,disabled:D=!1,isLoading:x=!1}=this.props,{error:E}=this.state,C=this.getDataSourceOptions(),b=this.getCurrentValue(),T=typeof y=="function";return(0,t.jsx)("div",{"aria-label":"Data source picker select container","data-testid":a.Tp.components.DataSourcePicker.container,children:(0,t.jsx)(g.l6,{isLoading:x,disabled:D,"aria-label":"Select a data source","data-testid":a.Tp.components.DataSourcePicker.inputV2,inputId:m||"data-source-picker",className:"ds-picker select-container",isMulti:!1,isClearable:T,backspaceRemovesValue:!1,onChange:this.onChange,options:C,autoFocus:p,onBlur:h,width:P,openMenuOnFocus:f,maxMenuHeight:500,placeholder:v,noOptionsMessage:"No datasources found",value:b??null,invalid:!!E||!!this.props.invalid,getOptionLabel:A=>A.meta&&(0,s.x)(A.meta.signature)&&A!==b?(0,t.jsxs)(i.B,{alignItems:"center",justifyContent:"space-between",children:[(0,t.jsx)("span",{children:A.label})," ",(0,t.jsx)(l.B,{status:A.meta.signature})]}):A.label||""})})}}},96937:(_,L,e)=>{"use strict";e.d(L,{f:()=>t,p:()=>n});let t=()=>{throw new Error("EmbeddedDashboard requires runtime initialization")};function n(r){t=r}},97152:(_,L,e)=>{"use strict";e.d(L,{a:()=>n,e:()=>r});var t=e(74848);let n=({message:s})=>(0,t.jsxs)("div",{children:["Unable to render data: ",s,"."]});function r(s){n=s}},24308:(_,L,e)=>{"use strict";e.d(L,{Y:()=>r,m:()=>n});var t=e(74848);let n=()=>(0,t.jsx)("div",{children:"PanelRenderer can only be used after Grafana instance has been started."});function r(s){n=s}},46235:(_,L,e)=>{"use strict";e.d(L,{V:()=>n,l:()=>r});var t=e(74848);let n=({children:s})=>(0,t.jsx)("div",{children:s});function r(s){n=s}},7117:(_,L,e)=>{"use strict";e.r(L),e.d(L,{CopyPanelEvent:()=>o.ah,DataSourcePicker:()=>B.s,DataSourceWithBackend:()=>b.iy,EchoEventType:()=>a.on,EmbeddedDashboard:()=>U.f,FakeEchoSrv:()=>a.c_,GrafanaBootConfig:()=>P.p,HealthCheckError:()=>b.b1,HealthStatus:()=>b.VQ,HistoryWrapper:()=>d.K9,LocationServiceProvider:()=>d._K,MetaAnalyticsEventName:()=>m.n_,PanelDataErrorView:()=>R.a,PanelRenderer:()=>A.m,PluginPage:()=>j.V,RefreshEvent:()=>o._,StreamingFrameAction:()=>l.Kh,ThemeChangedEvent:()=>o.E8,TimeRangeUpdatedEvent:()=>o.sR,config:()=>P.$,createDataSourcePluginEventProperties:()=>N.y,createMonitoringLogger:()=>C.DW,createPluginEventProperties:()=>N.L,createQueryRunner:()=>O.d,featureEnabled:()=>E.a,frameToMetricFindValue:()=>T.$h,getAngularLoader:()=>n.E,getAppEvents:()=>o.J7,getBackendSrv:()=>t.AI,getDataSourceSrv:()=>r.l,getEchoSrv:()=>a.x$,getGrafanaLiveSrv:()=>l.oF,getLegacyAngularInjector:()=>i.C,getLocationSrv:()=>s.X,getPluginComponentExtensions:()=>u.Dp,getPluginExtensions:()=>u.O3,getPluginImportUtils:()=>D.o,getPluginLinkExtensions:()=>u.Kf,getRunRequest:()=>O.XJ,getTemplateSrv:()=>g.w,hasAllPermissions:()=>G,hasAnyPermission:()=>M,hasPermission:()=>H,hasPermissionInMetadata:()=>z,isExperimentViewEvent:()=>m.p6,isExpressionReference:()=>b.s9,isFetchError:()=>t.NF,isInteractionEvent:()=>m.fX,isPageviewEvent:()=>m.nB,isPluginExtensionComponent:()=>f.a,isPluginExtensionLink:()=>f.D,loadPluginCss:()=>D.PL,locationSearchToObject:()=>d.SE,locationService:()=>d.Ny,logDebug:()=>C.MD,logError:()=>C.vV,logInfo:()=>C.fH,logWarning:()=>C.FF,navigationLogger:()=>d.Lc,registerEchoBackend:()=>a.pl,reportExperimentView:()=>x.Xp,reportInteraction:()=>x.rR,reportMetaAnalytics:()=>x.G$,reportPageview:()=>x.Jy,setAngularLoader:()=>n.w,setAppEvents:()=>o.H8,setBackendSrv:()=>t.u5,setChromeHeaderHeightHook:()=>w._,setCurrentUser:()=>v.l,setDataSourceSrv:()=>r.h,setEchoSrv:()=>a.H2,setEmbeddedDashboard:()=>U.p,setGrafanaLiveSrv:()=>l.S8,setLegacyAngularInjector:()=>i.j,setLocationService:()=>d.vG,setLocationSrv:()=>s.T,setPluginComponentHook:()=>p.A,setPluginComponentsHook:()=>h.R,setPluginExtensionGetter:()=>u.cE,setPluginExtensionsHook:()=>c.Vu,setPluginImportUtils:()=>D.se,setPluginLinksHook:()=>y.q,setQueryRunnerFactory:()=>O.HC,setReturnToPreviousHook:()=>K._,setRunRequest:()=>O.pC,setTemplateSrv:()=>g.d,toDataQueryError:()=>S.u,toDataQueryResponse:()=>T.bE,useChromeHeaderHeight:()=>w.k,useLocationService:()=>d.at,usePluginComponent:()=>p.S,usePluginComponentExtensions:()=>c.kr,usePluginComponents:()=>h.f,usePluginExtensions:()=>c.pc,usePluginInteractionReporter:()=>I.G,usePluginLinkExtensions:()=>c.vl,usePluginLinks:()=>y.U,useReturnToPrevious:()=>K.i});var t=e(17172),n=e(7376),r=e(19347),s=e(23509),a=e(63415),g=e(72574),i=e(81634),l=e(78731),d=e(39601),o=e(3591),u=e(4402),c=e(3197),p=e(79396),h=e(7299),y=e(71798),f=e(80882),v=e(61706),P=e(32264),m=e(61298),D=e(89191),x=e(14110),E=e(33378),C=e(34867),b=e(26657),T=e(47773),A=e(24308),R=e(97152),S=e(12091),O=e(63639),j=e(46235),B=e(55882),N=e(5261),I=e(44027),K=e(14778),w=e(23172),U=e(96937),W=e(29263);const H=Q=>(0,W.ZU)(Q,(0,v.H)()),z=(Q,Y)=>(0,W.T6)(Q,Y),G=Q=>(0,W.Fj)(Q,(0,v.H)()),M=Q=>(0,W.jW)(Q,(0,v.H)())},7376:(_,L,e)=>{"use strict";e.d(L,{E:()=>r,w:()=>n});let t;function n(s){t=s}function r(){return t}},63415:(_,L,e)=>{"use strict";e.d(L,{H2:()=>r,c_:()=>g,on:()=>t,pl:()=>a,x$:()=>s});var t=(i=>(i.Performance="performance",i.MetaAnalytics="meta-analytics",i.Pageview="pageview",i.Interaction="interaction",i.ExperimentView="experimentview",i.GrafanaJavascriptAgent="grafana-javascript-agent",i))(t||{});let n;function r(i){if(n instanceof g)for(const l of n.buffer)i.addEvent(l.event,l.meta);n=i}function s(){return n||(n=new g),n}const a=i=>{s().addBackend(i)};class g{constructor(){this.buffer=[]}flush(){this.buffer=[]}addBackend(l){}addEvent(l,d){this.buffer.push({event:l,meta:d})}}},39601:(_,L,e)=>{"use strict";e.d(L,{K9:()=>d,Lc:()=>h,Ny:()=>u,SE:()=>o,_K:()=>v,at:()=>f,vG:()=>c});var t=e(74848),n=e(17929),r=e(96540),s=e(76885),a=e(95344),g=e(91040),i=e(40621),l=e(32264);class d{constructor(m){this.history=m||n.zR({basename:l.$.appSubUrl??"/"}),this.partial=this.partial.bind(this),this.push=this.push.bind(this),this.replace=this.replace.bind(this),this.getSearch=this.getSearch.bind(this),this.getHistory=this.getHistory.bind(this),this.getLocation=this.getLocation.bind(this)}getHistory(){return this.history}getSearch(){return new URLSearchParams(this.history.location.search)}partial(m,D){const x=this.history.location,E=this.getSearchObject();for(const b in m)m[b]===null||m[b]===void 0?delete E[b]:E[b]=m[b];const C=s.kM.renderUrl(x.pathname,E);D?this.history.replace(C,this.history.location.state):this.history.push(C,this.history.location.state)}push(m){this.history.push(m)}replace(m){this.history.replace(m)}reload(){const m=this.history.location.state?.routeReloadCounter;this.history.replace({...this.history.location,state:{routeReloadCounter:m?m+1:1}})}getLocation(){return this.history.location}getSearchObject(){return o(this.history.location.search)}update(m){if((0,a.l)("LocationSrv","update","partial, push or replace"),m.partial&&m.query)this.partial(m.query,m.partial);else{const D={pathname:m.path};m.query&&(D.search=s.kM.toUrlParams(m.query)),m.replace?this.replace(D):this.push(D)}}}function o(P){let m=typeof P=="number"?String(P):P;return m.length>0?m.startsWith("?")?s.kM.parseKeyValue(m.substring(1)):s.kM.parseKeyValue(m):{}}let u=new d;const c=P=>{throw new Error("locationService can be only overriden in test environment")},p=(0,g.h)("Router"),h=p.logger;(0,i.h)("location",u,p);const y=r.createContext(void 0);function f(){const P=(0,r.useContext)(y);if(!P)throw new Error("useLocationService must be used within a LocationServiceProvider");return P}const v=({service:P,children:m})=>(0,t.jsx)(y.Provider,{value:P,children:m})},23509:(_,L,e)=>{"use strict";e.d(L,{T:()=>n,X:()=>r});let t;function n(s){t=s}function r(){return t}},63639:(_,L,e)=>{"use strict";e.d(L,{HC:()=>n,XJ:()=>g,d:()=>r,pC:()=>a});let t;const n=i=>{if(t)throw new Error("Runner should only be set when Grafana is starting.");t=i},r=()=>{if(!t)throw new Error("`createQueryRunner` can only be used after Grafana instance has started.");return t()};let s;function a(i){if(s)throw new Error("runRequest function should only be set once, when Grafana is starting.");s=i}function g(){if(!s)throw new Error("getRunRequest can only be used after Grafana instance has started.");return s}},19347:(_,L,e)=>{"use strict";e.d(L,{h:()=>n,l:()=>r});let t;function n(s){t=s}function r(){return t}},81634:(_,L,e)=>{"use strict";e.d(L,{C:()=>r,j:()=>n});let t;const n=s=>{t=s},r=()=>t},78731:(_,L,e)=>{"use strict";e.d(L,{Kh:()=>t.Kh,S8:()=>r,oF:()=>s});var t=e(9631);let n;const r=a=>{n=a},s=()=>n},4402:(_,L,e)=>{"use strict";e.d(L,{Dp:()=>i,Kf:()=>g,O3:()=>a,cE:()=>r});var t=e(80882);let n;function r(l){if(n)throw new Error("setPluginExtensionGetter() function should only be called once, when Grafana is starting.");n=l}function s(){if(!n)throw new Error("getPluginExtensionGetter() can only be used after the Grafana instance has started.");return n}const a=l=>s()(l),g=l=>{const{extensions:d}=a(l);return{extensions:d.filter(t.D)}},i=l=>{const{extensions:d}=a(l);return{extensions:d.filter(t.a)}}},79396:(_,L,e)=>{"use strict";e.d(L,{A:()=>n,S:()=>r});let t;function n(s){if(t)throw new Error("setPluginComponentHook() function should only be called once, when Grafana is starting.");t=s}function r(s){if(!t)throw new Error("setPluginComponentHook(options) can only be used after the Grafana instance has started.");return t(s)}},7299:(_,L,e)=>{"use strict";e.d(L,{R:()=>n,f:()=>r});let t;function n(s){if(t)throw new Error("setPluginComponentsHook() function should only be called once, when Grafana is starting.");t=s}function r(s){if(!t)throw new Error("setPluginComponentsHook(options) can only be used after the Grafana instance has started.");return t(s)}},3197:(_,L,e)=>{"use strict";e.d(L,{Vu:()=>s,kr:()=>i,pc:()=>a,vl:()=>g});var t=e(96540),n=e(80882);let r;function s(l){if(r)throw new Error("setPluginExtensionsHook() function should only be called once, when Grafana is starting.");r=l}function a(l){if(!r)throw new Error("usePluginExtensions(options) can only be used after the Grafana instance has started.");return r(l)}function g(l){const{extensions:d,isLoading:o}=a(l);return(0,t.useMemo)(()=>({extensions:d.filter(n.D),isLoading:o}),[d,o])}function i(l){const{extensions:d,isLoading:o}=a(l);return(0,t.useMemo)(()=>({extensions:d.filter(n.a),isLoading:o}),[d,o])}},71798:(_,L,e)=>{"use strict";e.d(L,{U:()=>r,q:()=>n});let t;function n(s){if(t)throw new Error("setPluginLinksHook() function should only be called once, when Grafana is starting.");t=s}function r(s){if(!t)throw new Error("setPluginLinksHook(options) can only be used after the Grafana instance has started.");return t(s)}},80882:(_,L,e)=>{"use strict";e.d(L,{D:()=>n,a:()=>r});var t=e(74135);function n(s){return s?s.type===t.u.link&&("path"in s||"onClick"in s):!1}function r(s){return s?s.type===t.u.component&&"component"in s:!1}},72574:(_,L,e)=>{"use strict";e.d(L,{d:()=>n,w:()=>r});let t;const n=s=>{t=s},r=()=>t},61706:(_,L,e)=>{"use strict";e.d(L,{H:()=>r,l:()=>n});let t=null;function n(s){if(t)throw new Error("User should only be set once, when Grafana is starting.");t=s}function r(){if(!t)throw new Error("User can only be used after Grafana instance has started.");return t}},26657:(_,L,e)=>{"use strict";e.d(L,{iy:()=>C,dR:()=>P,b1:()=>D,VQ:()=>x,s9:()=>m,ph:()=>T,x7:()=>b});var t=e(62467),n=e(75505),r=e(44240),s=e(63720),a=e(66847),g=e(40187),i=e(22391),l=e(55004),d=e(89667),o=e(92341),u=e(32264),c=e(19347),p=e(78731),h=e(17172),y=e(9631),f=e(47773);function v(A){const{intervalMs:R,maxDataPoints:S,requestId:O,panelId:j,queryCachingTTL:B,range:{from:N,to:I}}=A;if(!A.targets.length)return(0,t.of)({data:[]});const K={intervalMs:R,maxDataPoints:S,queryCachingTTL:B,timeRange:{from:N.valueOf().toString(),to:I.valueOf().toString(),timezone:A.timezone}};return(0,h.AI)().fetch({url:`/api/public/dashboards/${u.$.publicDashboardAccessToken}/panels/${j}/query`,method:"POST",data:K,requestId:O}).pipe((0,s.n)(w=>(0,t.of)((0,f.bE)(w,A.targets))),(0,a.W)(w=>(0,t.of)((0,f.bE)(w))))}const P=Object.freeze({type:"__expr__",uid:"__expr__",name:"Expression"});function m(A){if(!A)return!1;const R=typeof A=="string"?A:A.type;return R===P.type||R===P.name||R==="-100"}class D extends Error{constructor(R,S){super(R),this.details=S,this.name="HealthCheckError"}}var x=(A=>(A.Unknown="UNKNOWN",A.OK="OK",A.Error="ERROR",A))(x||{}),E=(A=>(A.PluginID="X-Plugin-Id",A.DatasourceUID="X-Datasource-Uid",A.DashboardUID="X-Dashboard-Uid",A.PanelID="X-Panel-Id",A.PanelPluginId="X-Panel-Plugin-Id",A.QueryGroupID="X-Query-Group-Id",A.FromExpression="X-Grafana-From-Expr",A.SkipQueryCache="X-Cache-Skip",A))(E||{});class C extends g.mA{constructor(R){super(R),this.streamOptionsProvider=T}query(R){if(u.$.publicDashboardAccessToken)return v(R);const{intervalMs:S,maxDataPoints:O,queryCachingTTL:j,range:B,requestId:N,hideFromInspector:I=!1}=R;let K=R.targets,w=!1;const U=new Set,W=new Set,H=K.map(Q=>{let Y=this.getRef(),q=this.id,te=!0;if(m(Q.datasource))return w=!0,{...Q,datasource:P};if(Q.datasource){const X=(0,c.l)().getInstanceSettings(Q.datasource,R.scopedVars);if(!X)throw new Error(`Unknown Datasource: ${JSON.stringify(Q.datasource)}`);const ee=X.rawRef??(0,i.p$)(X),ne=X.id;(ee.uid!==Y.uid||q!==ne)&&(Y=ee,q=ne,te=!1)}return Y.type?.length&&U.add(Y.type),Y.uid?.length&&W.add(Y.uid),{...te?this.applyTemplateVariables(Q,R.scopedVars,R.filters):Q,datasource:Y,datasourceId:q,intervalMs:S,maxDataPoints:O,queryCachingTTL:j}});if(!H.length)return(0,t.of)({data:[]});const z={queries:H,from:B?.from.valueOf().toString(),to:B?.to.valueOf().toString()};if(u.$.featureToggles.queryOverLive)return(0,p.oF)().getQueryData({request:R,body:z});const G=R.headers??{};G["X-Plugin-Id"]=Array.from(U).join(", "),G["X-Datasource-Uid"]=Array.from(W).join(", ");let M="/api/ds/query?ds_type="+this.type;return u.$.featureToggles.queryServiceFromUI&&(u.$.featureToggles.queryService||u.$.featureToggles.grafanaAPIServerWithExperimentalAPIs?(!w&&W.size,M=`/apis/query.grafana.app/v0alpha1/namespaces/${u.$.namespace}/query?ds_type=' + this.type`):console.warn("feature toggle queryServiceFromUI also requires the queryService to be running")),w&&(G["X-Grafana-From-Expr"]="true",M+="&expression=true"),N&&(M+=`&requestId=${N}`),R.dashboardUID&&(G["X-Dashboard-Uid"]=R.dashboardUID,R.panelId&&(G["X-Panel-Id"]=`${R.panelId}`)),R.panelPluginId&&(G["X-Panel-Plugin-Id"]=`${R.panelPluginId}`),R.queryGroupId&&(G["X-Query-Group-Id"]=`${R.queryGroupId}`),R.skipQueryCache&&(G["X-Cache-Skip"]="true"),(0,h.AI)().fetch({url:M,method:"POST",data:z,requestId:N,hideFromInspector:I,headers:G}).pipe((0,s.n)(Q=>{const Y=(0,f.bE)(Q,H);return Y.data?.length&&Y.data.find(q=>q.meta?.channel)?b(Y,R,this.streamOptionsProvider):(0,t.of)(Y)}),(0,a.W)(Q=>(0,t.of)((0,f.bE)(Q))))}getRequestHeaders(){const R={};return R["X-Plugin-Id"]=this.type,R["X-Datasource-Uid"]=this.uid,R}interpolateVariablesInQueries(R,S,O){return R.map(j=>this.applyTemplateVariables(j,S,O))}applyTemplateVariables(R,S,O){return R}async getResource(R,S,O){const j=this.getRequestHeaders();return(await(0,n.s)((0,h.AI)().fetch({...O,method:"GET",headers:O?.headers?{...O.headers,...j}:j,params:S??O?.params,url:`/api/datasources/uid/${this.uid}/resources/${R}`}))).data}async postResource(R,S,O){const j=this.getRequestHeaders();return(await(0,n.s)((0,h.AI)().fetch({...O,method:"POST",headers:O?.headers?{...O.headers,...j}:j,data:S??{...S},url:`/api/datasources/uid/${this.uid}/resources/${R}`}))).data}async callHealthCheck(){return(0,n.s)((0,h.AI)().fetch({method:"GET",url:`/api/datasources/uid/${this.uid}/health`,showErrorAlert:!1,headers:this.getRequestHeaders()})).then(R=>R.data).catch(R=>R.data)}async testDatasource(){return this.callHealthCheck().then(R=>R.status==="OK"?{status:"success",message:R.message}:Promise.reject({status:"error",message:R.message,error:new D(R.message,R.details)}))}}function b(A,R,S){const O=(0,p.oF)();if(!O)return(0,t.of)(A);const j=[],B=[];for(const N of A.data){const I=(0,l.DG)(N.meta?.channel);if(I){const K=N;B.push(O.getDataStream({addr:I,buffer:S(R,K),frame:(0,d.Nw)(N)}))}else j.push(N)}return j.length&&B.push((0,t.of)({...A,data:j})),B.length===1?B[0]:(0,r.h)(...B)}const T=(A,R)=>{const S={maxLength:A.maxDataPoints??500,action:y.Kh.Append};return A.rangeRaw?.to==="now"&&(S.maxDelta=A.range.to.valueOf()-A.range.from.valueOf()),S};C=(0,o.Y)(C)},23172:(_,L,e)=>{"use strict";e.d(L,{_:()=>n,k:()=>r});let t;const n=s=>{t=s},r=()=>(t||console.error("useChromeHeaderHeight hook not found"),t?.())},34867:(_,L,e)=>{"use strict";e.d(L,{DW:()=>d,FF:()=>a,MD:()=>g,fH:()=>s,l$:()=>l,vV:()=>i});var t=e(32631),n=e(37930),r=e(32264);function s(o,u){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([o],{level:n.$b.INFO,context:u})}function a(o,u){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([o],{level:n.$b.WARN,context:u})}function g(o,u){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushLog([o],{level:n.$b.DEBUG,context:u})}function i(o,u){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushError(o,{context:u})}function l(o,u,c){r.$.grafanaJavascriptAgent.enabled&&t.P.api.pushMeasurement({type:o,values:u,context:c})}function d(o,u){const c=p=>({source:o,...u,...p});return{logDebug:(p,h)=>g(p,c(h)),logInfo:(p,h)=>s(p,c(h)),logWarning:(p,h)=>a(p,c(h)),logError:(p,h)=>i(p,c(h)),logMeasurement:(p,h,y)=>l(p,h,c(y))}}},89191:(_,L,e)=>{"use strict";e.d(L,{PL:()=>n,o:()=>a,se:()=>s});var t=e(32264);async function n(g){try{const i=t.$.bootData.user.theme==="light"?g.light:g.dark;return window.System.import(i)}catch(i){console.error(i)}}let r;function s(g){if(r)throw new Error("pluginImportUtils should only be set once, when Grafana is starting.");r=g}function a(){if(!r)throw new Error("pluginImportUtils can only be used after Grafana instance has started.");return r}},47773:(_,L,e)=>{"use strict";e.d(L,{$h:()=>u,bE:()=>i});var t=e(39070),n=e(89667),r=e(14236),s=e(11261),a=e(12091);const g={severity:"info",text:"Cached response"};function i(c,p){const h={data:[],state:t.Gu.Done},y="traceId"in c?c.traceId:void 0;y!=null&&(h.traceIds=[y]);const f=c;if(f.data?.results){const v=f.data.results,P=p?.length?p.map(x=>x.refId):Object.keys(v),m=l(f),D=[];for(const x of P){const E=v[x];E&&(E.refId=x,D.push(E))}for(const x of D){if(x.error){const E={refId:x.refId,message:x.error,status:x.status};y!=null&&(E.traceId=y),h.error||(h.error={...E}),h.errors?h.errors.push({...E}):h.errors=[{...E}],h.state=t.Gu.Error}if(x.frames?.length){for(let E of x.frames){m&&(E=d(E));const C=(0,n.or)(E);C.refId||(C.refId=x.refId),h.data.push(C)}continue}if(x.series?.length)for(const E of x.series)E.refId||(E.refId=x.refId),h.data.push((0,r.Vc)(E));if(x.tables?.length)for(const E of x.tables)E.refId||(E.refId=x.refId),h.data.push((0,r.Vc)(E))}}return f.status&&f.status!==200&&(h.state!==t.Gu.Error&&(h.state=t.Gu.Error),h.error||(h.error=(0,a.u)(c))),h}function l(c){const p=c?.headers;return!p||!p.get?!1:p.get("X-Cache")==="HIT"}function d(c){return{...c,schema:{...c.schema,fields:[...c.schema?.fields??[]],meta:{...c.schema?.meta,notices:[...c.schema?.meta?.notices??[],g],isCachedResponse:!0}}}}function o(c){const p=i(c);if(p.error?.data?.message)return{status:"error",message:p.error.data.message,details:p.error?.data?.error?{message:p.error.data.error}:void 0};if(p.error?.refId&&p.error?.message)return{status:"error",message:p.error.message};throw c}function u(c){if(!c||!c.length)return[];const p=[];let h=c.fields.find(y=>y.type===s.PU.string);if(h||(h=c.fields.find(y=>y.type!==s.PU.time)),h)for(let y=0;y<h.values.length;y++)p.push({text:""+h.values[y]});return p}},14778:(_,L,e)=>{"use strict";e.d(L,{_:()=>n,i:()=>r});let t;const n=s=>{t=s},r=()=>t?t():()=>console.error("ReturnToPrevious hook not found")},33623:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>r,QB:()=>s});var t=e(52622);const n="11.3.1",r={barRadius:0,barWidth:.97,fullHighlight:!1,groupWidth:.7,orientation:t.wV.Auto,showValue:t.yL.Auto,stacking:t.gs.None,xTickLabelRotation:0,xTickLabelSpacing:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},16371:(_,L,e)=>{"use strict";e.d(L,{K:()=>r});var t=e(52622);const n="11.3.1",r={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},37827:(_,L,e)=>{"use strict";e.d(L,{K:()=>n});const t="11.3.1",n={selectedSeries:0}},44955:(_,L,e)=>{"use strict";e.d(L,{K:()=>r});var t=e(52622);const n="11.3.1",r={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:t.T6.Auto}},87487:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>n});const t="11.3.1",n={layers:[]},r={allLayers:!0,id:"zero",lat:0,lon:0,zoom:1};var s=(g=>(g.Details="details",g.None="none",g))(s||{}),a=(g=>(g.Coords="coords",g.Fit="fit",g.Zero="zero",g))(a||{})},96529:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>g});var t=e(52622);const n="11.3.1";var r=(i=>(i.Opacity="opacity",i.Scheme="scheme",i))(r||{}),s=(i=>(i.Exponential="exponential",i.Linear="linear",i))(s||{}),a=(i=>(i.X="x",i.Xy="xy",i.Y="y",i))(a||{});const g={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}}},42226:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>r,QB:()=>s});var t=e(52622);const n="11.3.1",r={bucketCount:30,bucketOffset:0},s={fillOpacity:80,gradientMode:t.on.None,lineWidth:1}},69383:(_,L,e)=>{"use strict";e.d(L,{K:()=>n});const t="11.3.1",n={showImage:!0}},65391:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>g});const t="11.3.1";var n=(i=>(i.Donut="donut",i.Pie="pie",i))(n||{}),r=(i=>(i.Name="name",i.Percent="percent",i.Value="value",i))(r||{}),s=(i=>(i.Percent="percent",i.Value="value",i))(s||{});const a={values:[]},g={displayLabels:[]}},89607:(_,L,e)=>{"use strict";e.d(L,{K:()=>r});var t=e(52622);const n="11.3.1",r={colorMode:t.yp.Value,graphMode:t.$p.Area,justifyMode:t.F8.Auto,percentChangeColorMode:t.CD.Standard,showPercentChange:!1,textMode:t.SV.Auto,wideLayout:!0}},15821:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>r,QB:()=>s});var t=e(52622);const n="11.3.1",r={alignValue:"left",mergeValues:!0,perPage:20,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:0}},64337:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>r,QB:()=>s});var t=e(52622);const n="11.3.1",r={colWidth:.9,rowHeight:.9,showValue:t.yL.Auto},s={fillOpacity:70,lineWidth:1}},52037:(_,L,e)=>{"use strict";e.d(L,{K:()=>r});var t=e(52622);const n="11.3.1",r={cellHeight:t.qM.Sm,footer:{show:!1,countRows:!1,reducer:[]},frameIndex:0,showHeader:!0,showTypeIcons:!1,sortBy:[]}},12183:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>g});const t="11.3.1";var n=(i=>(i.Code="code",i.HTML="html",i.Markdown="markdown",i))(n||{}),r=(i=>(i.Go="go",i.Html="html",i.Json="json",i.Markdown="markdown",i.Plaintext="plaintext",i.Sql="sql",i.Typescript="typescript",i.Xml="xml",i.Yaml="yaml",i))(r||{});const s="plaintext",a={language:"plaintext",showLineNumbers:!1,showMiniMap:!1},g={content:`# Title

For markdown syntax help: [commonmark.org/help](https://commonmark.org/help/)`,mode:"markdown"}},10055:(_,L,e)=>{"use strict";e.d(L,{KQ:()=>i,QB:()=>g});var t=e(52622);const n="11.3.1";var r=(l=>(l.Auto="auto",l.Manual="manual",l))(r||{}),s=(l=>(l.Lines="lines",l.Points="points",l.PointsAndLines="points+lines",l))(s||{});const a={exclude:[]},g={label:t.yL.Auto,show:"points"},i={series:[]}},73134:(_,L,e)=>{"use strict";e.d(L,{CO:()=>g,GW:()=>C,OA:()=>m,Ol:()=>c,QB:()=>E,Yb:()=>o,Ye:()=>b,ZG:()=>l,aD:()=>r,bf:()=>s,bt:()=>D,dM:()=>h,lt:()=>f,rw:()=>a,ss:()=>x,yV:()=>v});const t={tags:[]},n={exclude:!1,ids:[]},r={list:[]},s={builtIn:0,enable:!0,hide:!1},a={includeAll:!1,multi:!1,options:[],skipUrlSync:!1};var g=(T=>(T[T.never=0]="never",T[T.onDashboardLoad=1]="onDashboardLoad",T[T.onTimeRangeChanged=2]="onTimeRangeChanged",T))(g||{}),i=(T=>(T[T.dontHide=0]="dontHide",T[T.hideLabel=1]="hideLabel",T[T.hideVariable=2]="hideVariable",T))(i||{}),l=(T=>(T[T.alphabeticalAsc=1]="alphabeticalAsc",T[T.alphabeticalCaseInsensitiveAsc=5]="alphabeticalCaseInsensitiveAsc",T[T.alphabeticalCaseInsensitiveDesc=6]="alphabeticalCaseInsensitiveDesc",T[T.alphabeticalDesc=2]="alphabeticalDesc",T[T.disabled=0]="disabled",T[T.naturalAsc=7]="naturalAsc",T[T.naturalDesc=8]="naturalDesc",T[T.numericalAsc=3]="numericalAsc",T[T.numericalDesc=4]="numericalDesc",T))(l||{});const d={asDropdown:!1,includeVars:!1,keepTime:!1,tags:[],targetBlank:!1};var o=(T=>(T.ContinuousBlPu="continuous-BlPu",T.ContinuousBlYlRd="continuous-BlYlRd",T.ContinuousBlues="continuous-blues",T.ContinuousGrYlRd="continuous-GrYlRd",T.ContinuousGreens="continuous-greens",T.ContinuousPurples="continuous-purples",T.ContinuousRdYlGr="continuous-RdYlGr",T.ContinuousReds="continuous-reds",T.ContinuousYlBl="continuous-YlBl",T.ContinuousYlRd="continuous-YlRd",T.Fixed="fixed",T.PaletteClassic="palette-classic",T.PaletteClassicByName="palette-classic-by-name",T.Shades="shades",T.Thresholds="thresholds",T))(o||{});const u={h:9,w:12,x:0,y:0};var c=(T=>(T.Absolute="absolute",T.Percentage="percentage",T))(c||{});const p={steps:[]};var h=(T=>(T.RangeToText="range",T.RegexToText="regex",T.SpecialValue="special",T.ValueToText="value",T))(h||{}),y=(T=>(T.Empty="empty",T.False="false",T.NaN="nan",T.Null="null",T.NullAndNan="null+nan",T.True="true",T))(y||{});const f={hidden:!1,refresh_intervals:["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],time_options:["5m","15m","1h","6h","12h","24h","2d","7d","30d"]};var v=(T=>(T[T.Crosshair=1]="Crosshair",T[T.Off=0]="Off",T[T.Tooltip=2]="Tooltip",T))(v||{});const P=0,m={links:[],repeatDirection:"h",targets:[],transformations:[],transparent:!1},D={overrides:[]},x={id:""},E={links:[],mappings:[]},C={collapsed:!1,panels:[]},b={editable:!0,fiscalYearStartMonth:0,graphTooltip:0,links:[],panels:[],schemaVersion:39,tags:[],timezone:"browser"}},39651:(_,L,e)=>{"use strict";e.d(L,{Gu:()=>r,gB:()=>n});var t=e(52622);const n={align:"auto",inspect:!1,cellOptions:{type:t.ob.Auto}};var r=(s=>(s.NotStarted="NotStarted",s.Loading="Loading",s.Streaming="Streaming",s.Done="Done",s.Error="Error",s))(r||{})},79422:(_,L,e)=>{"use strict";e.d(L,{Ye:()=>r,lt:()=>a,rw:()=>s,zL:()=>n});var t=e(73134),n=(p=>(p[p.dontHide=0]="dontHide",p[p.hideLabel=1]="hideLabel",p[p.hideVariable=2]="hideVariable",p))(n||{});const r=t.Ye,s={...t.rw},a=t.lt,g=t.OA,i=t.GW,l=t.QB,d=t.bt,o=t.ss,u=t.bf,c=t.aD},11807:(_,L,e)=>{"use strict";e.d(L,{l:()=>o});var t=e(74848),n=e(32196),r=e(73287),s=e(14110),a=e(40845),g=e(29158),i=e(88575),l=e(32372),d=e(94471);function o({rawSql:c,datasourceType:p}){const[h,y]=(0,r.A)(),f=(0,a.of)(u),v=m=>{y(m),(0,s.rR)("grafana_sql_preview_copied",{datasource:p})},P=(0,t.jsxs)("div",{className:f.labelWrapper,children:[(0,t.jsx)("span",{className:f.label,children:"Preview"}),(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>v(c),name:"copy"})]});return(0,t.jsx)(i.D,{label:P,className:f.grow,children:(0,t.jsx)(l.B,{language:"sql",height:80,value:(0,d.s)(c),monacoOptions:{scrollbar:{vertical:"hidden"},scrollBeyondLastLine:!1},readOnly:!0,showMiniMap:!1})})}function u(c){return{grow:(0,n.css)({flexGrow:1}),label:(0,n.css)({fontSize:12,fontWeight:c.typography.fontWeightMedium}),labelWrapper:(0,n.css)({display:"flex",justifyContent:"space-between",paddingBottom:c.spacing(.5)})}}},94471:(_,L,e)=>{"use strict";e.d(L,{s:()=>n});var t=e(27633);function n(r){return t.Ay.format(r).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,s=>s.replace(/\s/g,""))}},42418:(_,L,e)=>{"use strict";e.d(L,{F:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(55852),i=e(14578),l=e(90613),d=e(94753);const o=r.forwardRef(({title:p,onRemove:h,children:y,buttonContent:f,elevated:v,bottomSpacing:P,topSpacing:m,className:D,severity:x="error",...E},C)=>{const b=(0,a.$j)(),A=c(b,x,!!p,v,P,m),R={error:"alert",warning:"alert",info:"status",success:"status"},S=E.role||R[x],O=E["aria-label"]||p;return(0,t.jsx)("div",{ref:C,className:(0,n.cx)(A.wrapper,D),role:S,"aria-label":O,...E,children:(0,t.jsxs)(l.a,{"data-testid":s.Tp.components.Alert.alertV2(x),display:"flex",backgroundColor:x,borderRadius:"default",paddingY:1,paddingX:2,borderStyle:"solid",borderColor:x,alignItems:"stretch",boxShadow:v?"z3":void 0,children:[(0,t.jsx)(l.a,{paddingTop:1,paddingRight:2,children:(0,t.jsx)("div",{className:A.icon,children:(0,t.jsx)(i.I,{size:"xl",name:u(x)})})}),(0,t.jsxs)(l.a,{paddingY:1,grow:1,children:[(0,t.jsx)(d.E,{color:"primary",weight:"medium",children:p}),y&&(0,t.jsx)("div",{className:A.content,children:y})]}),h&&!f&&(0,t.jsx)("div",{className:A.close,children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",icon:"times",onClick:h,type:"button",fill:"text",variant:"secondary"})}),h&&f&&(0,t.jsx)(l.a,{marginLeft:1,display:"flex",alignItems:"center",children:(0,t.jsx)(g.$n,{"aria-label":"Close alert",variant:"secondary",onClick:h,type:"button",children:f})})]})})});o.displayName="Alert";const u=p=>{switch(p){case"error":return"exclamation-circle";case"warning":return"exclamation-triangle";case"info":return"info-circle";case"success":return"check"}},c=(p,h,y,f,v,P)=>{const m=p.colors[h];return{wrapper:(0,n.css)({flexGrow:1,marginBottom:p.spacing(v??2),marginTop:p.spacing(P??0),position:"relative","&:before":{content:'""',position:"absolute",top:0,left:0,bottom:0,right:0,background:p.colors.background.primary,zIndex:-1}}),icon:(0,n.css)({color:m.text,position:"relative",top:"-1px"}),content:(0,n.css)({color:p.colors.text.primary,paddingTop:y?p.spacing(.5):0,maxHeight:"50vh",overflowY:"auto"}),close:(0,n.css)({position:"relative",color:p.colors.text.secondary,background:"none",display:"flex",top:"-6px",right:"-14px"})}}},39938:(_,L,e)=>{"use strict";e.d(L,{E:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(70255),a=e(84140),g=e(40845),i=e(72129),l=e(14578),d=e(56034);const o=r.memo(({icon:y,color:f,text:v,tooltip:P,className:m,...D})=>{const x=(0,g.of)(h,f),E=(0,t.jsxs)("div",{className:(0,n.cx)(x.wrapper,m),...D,children:[y&&(0,t.jsx)(l.I,{name:y,size:"sm"}),v]});return P?(0,t.jsx)(d.m,{content:P,placement:"auto",children:E}):E});o.displayName="Badge";const u=({rootProps:y})=>{const f=(0,g.of)(p);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:f.container,...y})},c=(0,i.j)(o,u),p=()=>({container:(0,n.css)({lineHeight:1})}),h=(y,f)=>{let v=y.visualization.getColorByName(f),P="",m="",D="";return y.isDark?(m=(0,a.A)(v).setAlpha(.15).toString(),P=(0,a.A)(v).setAlpha(.25).toString(),D=(0,a.A)(v).lighten(15).toString()):(m=(0,a.A)(v).setAlpha(.15).toString(),P=(0,a.A)(v).setAlpha(.25).toString(),D=(0,a.A)(v).darken(20).toString()),{wrapper:(0,n.css)({display:"inline-flex",padding:"1px 4px",borderRadius:y.shape.radius.default,background:m,border:`1px solid ${P}`,color:D,fontWeight:y.typography.fontWeightRegular,gap:"2px",fontSize:y.typography.bodySmall.fontSize,lineHeight:y.typography.bodySmall.lineHeight,alignItems:"center"})}}},97696:(_,L,e)=>{"use strict";e.d(L,{xE:()=>E});var t=e(74848),n=e(32196),r=e(96540),s=e(84140),a=e(47070),g=e(50082),i=e(58649),l=e(83195),d=e(24293),o=e(8066),u=e(13544),c=e(52622),p=e(29413),h=e(55852),y=e(9286);const f=18,v=50,P=150,m=1.5,D=1,x=10;class E extends r.PureComponent{static{this.defaultProps={lcdCellWidth:12,value:{text:"100",numeric:100},displayMode:c.eX.Gradient,orientation:a.wV.Horizontal,field:{min:0,max:100,thresholds:{mode:g.O.Absolute,steps:[]}},itemSpacing:8,showUnfilled:!0}}render(){const{onClick:K,className:w,theme:U}=this.props,{title:W}=this.props.value,H=T(this.props);return K?(0,t.jsxs)("button",{type:"button",style:H.wrapper,onClick:K,className:(0,n.cx)((0,h.my)(U),w),children:[(0,t.jsx)("div",{style:H.title,children:W}),this.renderBarAndValue()]}):(0,t.jsxs)("div",{style:H.wrapper,className:w,children:[W&&(0,t.jsx)("div",{style:H.title,children:W}),this.renderBarAndValue()]})}renderBarAndValue(){switch(this.props.displayMode){case"lcd":return this.renderRetroBars();case"basic":case"gradient":default:return this.renderBasicAndGradientBars()}}renderBasicAndGradientBars(){const{value:K,showUnfilled:w,valueDisplayMode:U}=this.props,W=O(this.props);return(0,t.jsxs)("div",{style:W.wrapper,children:[U!==c.$l.Hidden&&(0,t.jsx)(y.i,{"data-testid":u.Tp.components.Panels.Visualization.BarGauge.valueV2,value:K,style:W.value}),w&&(0,t.jsx)("div",{style:W.emptyBar}),(0,t.jsx)("div",{style:W.bar})]})}renderRetroBars(){const{display:K,field:w,value:U,itemSpacing:W,alignmentFactors:H,orientation:z,lcdCellWidth:G,text:M,valueDisplayMode:Q,theme:Y}=this.props,{valueHeight:q,valueWidth:te,maxBarHeight:X,maxBarWidth:ee,wrapperWidth:ne,wrapperHeight:Z}=A(this.props),ae=w.min??i.tw,re=w.max??i.d1,se=C(z),de=re-ae,le=se?X:ee,he=W,ie=Math.floor(le/G),J=Math.floor((le-he*ie)/ie),ce=B(this.props),Pe=N(H||U,ce,te,q,z,M),Ie={width:`${ne}px`,height:`${Z}px`,display:"flex"};se?(Ie.flexDirection="column-reverse",Ie.alignItems="center"):(Ie.flexDirection="row",Ie.alignItems="center",Pe.justifyContent="flex-end");const ge=[];for(let Se=0;Se<ie;Se++){const De=ae+de/ie*Se,Ke=R(De,U,K),Me={borderRadius:Y.shape.radius.default};Ke.isLit?Me.backgroundImage=`radial-gradient(${Ke.background} 10%, ${Ke.backgroundShade})`:Me.backgroundColor=Ke.background,se?(Me.height=`${J}px`,Me.width=`${ee}px`,Me.marginTop=`${he}px`):(Me.width=`${J}px`,Me.height=`${X}px`,Me.marginRight=`${he}px`),ge.push((0,t.jsx)("div",{style:Me},Se.toString()))}return(0,t.jsxs)("div",{style:Ie,children:[ge,Q!==c.$l.Hidden&&(0,t.jsx)(y.i,{"data-testid":u.Tp.components.Panels.Visualization.BarGauge.valueV2,value:U,style:Pe})]})}}function C(I){return I===a.wV.Vertical}function b(I){const{height:K,width:w,alignmentFactors:U,orientation:W,text:H,namePlacement:z}=I,G=U?U.title:I.value.title;if(!G)return{fontSize:0,width:0,height:0,placement:"above"};if(z===c.TZ.Hidden)return{fontSize:0,width:0,height:0,placement:c.TZ.Hidden};if(C(W)){const ee=H?.titleSize??14;return{fontSize:ee,width:w,height:ee*m,placement:"below"}}if(K>40&&z===c.TZ.Auto||z===c.TZ.Top){if(H?.titleSize)return{fontSize:H?.titleSize,width:0,height:H.titleSize*m,placement:"above"};const ne=Math.max(Math.min(K*.45,v),17);return{fontSize:ne/m,width:0,height:ne,placement:"above"}}const q=Math.max(K*.6,f)/m,te=(0,p.kD)(G,q),X=Math.min(te.width+15,w*.4);return{fontSize:H?.titleSize??q,height:0,width:X,placement:"left"}}function T(I){const K={display:"flex",overflow:"hidden",width:"100%"},w=b(I),U={fontSize:`${w.fontSize}px`,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",width:"100%",alignItems:"center",alignSelf:"center"};return w.placement==="hidden"?U.display="none":C(I.orientation)?(K.flexDirection="column-reverse",U.textAlign="center"):w.placement==="above"?K.flexDirection="column":(K.flexDirection="row",U.width=`${w.width}px`,U.textAlign="right",U.paddingRight="10px"),{wrapper:K,title:U}}function A(I){const{height:K,width:w,orientation:U,text:W,alignmentFactors:H,valueDisplayMode:z}=I,G=b(I),M=H??I.value,Q=(0,l.cN)(M);let Y=0,q=0,te=0,X=0,ee=0,ne=0;const Z=W?.valueSize??Math.max(G.fontSize,12),re=(0,p.kD)(Q,Z).width+x*2;return C(U)?(W?.valueSize?te=W.valueSize*D:te=Math.min(Math.max(K*.1,f),v),X=w,z===c.$l.Hidden&&(te=0,X=0),Y=K-(G.height+te),q=w,ee=w,ne=K-G.height):(z===c.$l.Hidden?(te=0,X=0):(te=K-G.height,X=Math.max(Math.min(w*.2,P),re)),Y=K-G.height,q=w-X-G.width,G.placement==="above"?(ee=w,ne=K-G.height):(ee=w-G.width,ne=K)),{valueWidth:X,valueHeight:te,maxBarWidth:q,maxBarHeight:Y,wrapperHeight:ne,wrapperWidth:ee}}function R(I,K,w){if(I===null)return{background:d.F,border:d.F};const U=w?w(I).color:null;return U?K===null||isNaN(K.numeric)||I!==null&&I>K.numeric?{background:(0,s.A)(U).setAlpha(.18).toRgbString(),border:"transparent",isLit:!1}:{background:(0,s.A)(U).setAlpha(.95).toRgbString(),backgroundShade:(0,s.A)(U).setAlpha(.55).toRgbString(),border:(0,s.A)(U).setAlpha(.9).toRgbString(),isLit:!0}:{background:d.F,border:d.F}}function S(I,K,w){const U=Math.min((I-K)/(w-K),1);return isNaN(U)?0:U}function O(I){const{displayMode:K,field:w,value:U,alignmentFactors:W,orientation:H,theme:z,text:G}=I,{valueWidth:M,valueHeight:Q,maxBarHeight:Y,maxBarWidth:q}=A(I),te=w.min??i.tw,X=w.max??i.d1,ee=S(U.numeric,te,X),ne=B(I),Z=U.color??d.F,re=N(W||U,ne,M,Q,H,G),se=K==="basic",de={display:"flex",flexGrow:1},le={borderRadius:z.shape.radius.default,position:"relative",zIndex:1},he={background:z.colors.background.secondary,flexGrow:1,display:"flex",borderRadius:z.shape.radius.default,position:"relative"};if(C(H)){const ie=Math.max(ee*Y,1);de.flexDirection="column",de.justifyContent="flex-end",le.transition="height 1s",le.height=`${ie}px`,le.width=`${q}px`,he.bottom="-3px",he.width=`${M}px`,se?(le.background=`${(0,s.A)(Z).setAlpha(.35).toRgbString()}`,le.borderTop=`2px solid ${Z}`):le.background=j(I,Y)}else{const ie=Math.max(ee*q,1);de.flexDirection="row-reverse",de.justifyContent="flex-end",de.alignItems="stretch",le.transition="width 1s",le.height=`${Y}px`,le.width=`${ie}px`,he.left="-3px",he.height=`${Q}px`,se?(le.background=`${(0,s.A)(Z).setAlpha(.35).toRgbString()}`,le.borderRight=`2px solid ${Z}`):le.background=j(I,q)}return{wrapper:de,bar:le,value:re,emptyBar:he}}function j(I,K){const{field:w,value:U,orientation:W,theme:H}=I,z=C(W)?"0deg":"90deg",G=w.min,M=w.max;let Q="",Y=0,q=(0,o.Hs)(w.color?.mode);if(q.id===d.Y.Thresholds){const te=w.thresholds;for(let X=0;X<te.steps.length;X++){const ee=te.steps[X],ne=I.theme.visualization.getColorByName(ee.color),Z=te.mode===g.O.Percentage?ee.value/100:S(ee.value,G,M),ae=Z*K,re=Math.round(ae-(ae-Y)/2),se=te.mode===g.O.Percentage?G+(M-G)*Z:ee.value;if(Q==="")Q=`linear-gradient(${z}, ${ne}, ${ne}`;else{if(U.numeric<se)break;Y=ae,Q+=` ${re}px, ${ne}`}}return Q+")"}if(q.isContinuous&&q.getColors){const te=q.getColors(H);for(let X=0;X<te.length;X++){const ee=te[X];if(Q==="")Q=`linear-gradient(${z}, ${ee} 0px`;else{const Z=X/(te.length-1)*K;Q+=`, ${ee} ${Z}px`}}return Q+")"}return U.color??d.F}function B(I){if(I.valueDisplayMode==="text")return I.theme.colors.text.primary;const{value:K}=I;return K.color?K.color:d.F}function N(I,K,w,U,W,H){const z={color:K,height:`${U}px`,width:`${w}px`,display:"flex",alignItems:"center",textWrap:"nowrap",lineHeight:D};let G=w;const M=(0,l.cN)(I);return C(W)?(z.fontSize=H?.valueSize??(0,p.Vr)(M,G,U,D),z.justifyContent="center"):(z.fontSize=H?.valueSize??(0,p.Vr)(M,G-x*2,U,D),z.justifyContent="flex-end",z.paddingLeft=`${x}px`,z.paddingRight=`${x}px`,G-=x),z}},37494:(_,L,e)=>{"use strict";e.d(L,{yV:()=>N,yp:()=>S,$p:()=>O,F8:()=>j,SV:()=>B});var t=e(74848),n=e(32196),r=e(96540),s=e(55852),a=e(9286),g=e(84140),i=e(11261),l=e(83195),d=e(52622),o=e(24284),u=e(29413),c=e(5926),p=e(14578);const h=({percentChange:I,styles:K})=>{let w;return I>0?w="arrow-up":I<0&&(w="arrow-down"),(0,t.jsxs)("div",{style:K.containerStyles,children:[w&&(0,t.jsx)(p.I,{name:w,height:K.iconSize,width:K.iconSize,viewBox:"6 6 12 12"}),y(I)]})},y=I=>(I/100).toLocaleString(void 0,{style:"percent",maximumSignificantDigits:3}),f=1.2,v=30,P=500;class m{constructor(K){this.props=K;const{width:w,height:U,value:W,text:H}=K;this.valueColor=W.color??"gray",this.panelPadding=U>100?12:8,this.textValues=A(K),this.justifyCenter=T(K.justifyMode,this.textValues.title),this.valueToAlignTo=this.textValues.valueToAlignTo,this.titleToAlignTo=this.textValues.titleToAlignTo,this.titleFontSize=0,this.valueFontSize=0,this.chartHeight=0,this.chartWidth=0,this.maxTextWidth=w-this.panelPadding*2,this.maxTextHeight=U-this.panelPadding*2,H&&(H.titleSize&&(this.titleFontSize=H.titleSize,this.titleToAlignTo=void 0),H.valueSize&&(this.valueFontSize=H.valueSize,this.valueToAlignTo=""))}getTitleStyles(){const K={fontSize:`${this.titleFontSize}px`,lineHeight:f};return(this.props.colorMode===S.Background||this.props.colorMode===S.BackgroundSolid)&&(K.color=(0,o.mZ)(this.valueColor,this.props.theme.isDark)),K}getValueStyles(){const K={fontSize:this.valueFontSize,fontWeight:P,lineHeight:f,position:"relative",zIndex:1};switch(this.justifyCenter&&(K.textAlign="center"),this.props.colorMode){case S.Value:K.color=this.valueColor;break;case S.Background:case S.BackgroundSolid:K.color=(0,o.mZ)(this.valueColor,this.props.theme.isDark);break;case S.None:K.color=this.props.theme.colors.text.primary;break}return K}getPercentChangeStyles(K,w,U){const H=this.getValueAndTitleContainerStyles(),z=Math.max(this.valueFontSize/2.5,12);let G=Math.max(this.valueFontSize/3,10);const M=this.props.theme.visualization,Q=R(K,w,U,M),Y={fontSize:z,fontWeight:P,lineHeight:f,position:"relative",display:"flex",alignItems:"center",gap:Math.max(z/3,4),zIndex:1,color:Q};switch(this.justifyCenter&&(Y.textAlign="center"),H.flexDirection==="column"&&z>12&&(Y.marginTop=-(z/4)),H.flexDirection==="row"&&(Y.alignItems="baseline",Y.lineHeight=f*2.5),this.props.colorMode){case S.Background:case S.BackgroundSolid:Y.color=(0,o.mZ)(this.valueColor,this.props.theme.isDark);break}return this.props.textMode===B.None&&(Y.fontSize=(0,u.Vr)(y(K),this.maxTextWidth*.8,this.maxTextHeight*.8,f,void 0,P),G=Y.fontSize*.8),{containerStyles:Y,iconSize:G}}getValueAndTitleContainerStyles(){const K={display:"flex",flexWrap:"wrap"};return this.justifyCenter&&(K.alignItems="center",K.justifyContent="center",K.flexGrow=1,K.gap="0.75ch"),K}getPanelStyles(){const{width:K,height:w,theme:U,colorMode:W,textMode:H}=this.props,z={width:`${K}px`,height:`${w}px`,padding:`${H===B.None?2:this.panelPadding}px`,borderRadius:U.shape.radius.default,position:"relative",display:"flex"},G=U.isDark?1:-.7;switch(W){case S.Background:const M=(0,g.A)(this.valueColor).darken(15*G).spin(8).toRgbString(),Q=(0,g.A)(this.valueColor).darken(5*G).spin(-8).toRgbString();z.background=`linear-gradient(120deg, ${M}, ${Q})`;break;case S.BackgroundSolid:z.background=(0,g.A)(this.valueColor).toString();break;case S.Value:z.background="transparent";break}return this.justifyCenter&&(z.alignItems="center",z.flexDirection="row"),z}renderChart(){const{sparkline:K,colorMode:w}=this.props;if(!K||K.y?.type!==i.PU.number)return null;let U,W;switch(w){case S.Background:case S.BackgroundSolid:U="rgba(255,255,255,0.4)",W=(0,g.A)(this.valueColor).brighten(40).toRgbString();break;case S.None:case S.Value:default:W=this.valueColor,U=(0,g.A)(this.valueColor).setAlpha(.2).toRgbString();break}const H={custom:{drawStyle:d.GR.Line,lineWidth:1,fillColor:U,lineColor:W}};return(0,t.jsx)("div",{style:this.getChartStyles(),children:(0,t.jsx)(c.O,{height:this.chartHeight,width:this.chartWidth,sparkline:K,config:H,theme:this.props.theme})})}getChartStyles(){return{position:"absolute",right:0,bottom:0}}}class D extends m{constructor(K){super(K);const w=this.titleToAlignTo?.length?.3:1;this.valueToAlignTo.length&&(this.valueFontSize=(0,u.Vr)(this.valueToAlignTo,this.maxTextWidth*w,this.maxTextHeight,f,void 0,P)),this.titleToAlignTo?.length&&(this.titleFontSize=(0,u.Vr)(this.titleToAlignTo,this.maxTextWidth*.6,this.maxTextHeight,f,v),this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.alignItems="center",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}class x extends m{constructor(K){super(K);const{width:w,height:U}=K,W=.5,H=.6,z=1-H,G=.4;this.chartWidth=w,this.chartHeight=U*W,this.titleToAlignTo?.length&&(this.titleFontSize=(0,u.Vr)(this.titleToAlignTo,this.maxTextWidth*H,this.maxTextHeight*G,f,v)),this.valueToAlignTo.length&&(this.valueFontSize=(0,u.Vr)(this.valueToAlignTo,this.maxTextWidth*z,this.maxTextHeight*W,f,void 0,P))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="row",K.flexGrow=1,this.justifyCenter||(K.justifyContent="space-between"),K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="row",K.justifyContent="space-between",K}}class E extends m{constructor(K){super(K);const{width:w,height:U}=K,W=.15,H=.25;let z=0;this.chartHeight=U*H,this.chartWidth=w,this.titleToAlignTo?.length&&(this.titleFontSize=(0,u.Vr)(this.titleToAlignTo,this.maxTextWidth,U*W,f,v),z=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,u.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-this.chartHeight-z,f,void 0,P)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize)),this.chartHeight=U-this.titleFontSize*f-this.valueFontSize*f}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.justifyContent="center",K}getPanelStyles(){const K=super.getPanelStyles();return K.flexDirection="column",K}}class C extends m{constructor(K){super(K);const{height:w}=K,U=.15;let W=0;this.titleToAlignTo?.length&&(this.titleFontSize=(0,u.Vr)(this.titleToAlignTo,this.maxTextWidth,w*U,f,v),W=this.titleFontSize*f),this.valueToAlignTo.length&&(this.valueFontSize=(0,u.Vr)(this.valueToAlignTo,this.maxTextWidth,this.maxTextHeight-W,f,void 0,P)),this.titleToAlignTo?.length&&(this.titleFontSize=Math.min(this.valueFontSize*.7,this.titleFontSize))}getValueAndTitleContainerStyles(){const K=super.getValueAndTitleContainerStyles();return K.flexDirection="column",K.flexGrow=1,K}renderChart(){return null}getPanelStyles(){const K=super.getPanelStyles();return K.alignItems="center",K}}function b(I){const{width:K,height:w,sparkline:U}=I;return K/w>2.5&&!I.disableWideLayout?w>50&&U&&U.y.values.length>1?new x(I):new D(I):w>100&&U&&U.y.values.length>1?new E(I):new C(I)}function T(I,K){return I===j.Center?!0:(K??"").length===0}function A(I){const{value:K,alignmentFactors:w,count:U}=I;let{textMode:W}=I;const H=w?w.title:K.title,z=(0,l.cN)(w||K);switch(W===B.Auto&&(U??1)===1&&(W=B.Value),W){case B.Name:return{...K,title:void 0,prefix:void 0,suffix:void 0,text:K.title||"",titleToAlignTo:void 0,valueToAlignTo:H??"",tooltip:(0,l.cN)(K)};case B.Value:return{...K,title:void 0,titleToAlignTo:void 0,valueToAlignTo:z,tooltip:K.title};case B.None:return{numeric:K.numeric,color:K.color,title:void 0,text:"",titleToAlignTo:void 0,valueToAlignTo:"1",tooltip:`Name: ${K.title}
Value: ${(0,l.cN)(K)}`};case B.ValueAndName:default:return{...K,titleToAlignTo:H,valueToAlignTo:z}}}function R(I,K,w,U){return K===d.CD.SameAsValue?w.color:I*(K===d.CD.Inverted?-1:1)>0?U.getColorByName("green"):U.getColorByName("red")}var S=(I=>(I.Background="background",I.BackgroundSolid="background_solid",I.None="none",I.Value="value",I))(S||{}),O=(I=>(I.None="none",I.Line="line",I.Area="area",I))(O||{}),j=(I=>(I.Auto="auto",I.Center="center",I))(j||{}),B=(I=>(I.Auto="auto",I.Value="value",I.ValueAndName="value_and_name",I.Name="name",I.None="none",I))(B||{});class N extends r.PureComponent{static{this.defaultProps={justifyMode:"auto"}}render(){const{onClick:K,className:w,hasLinks:U,theme:W}=this.props,H=b(this.props),z=H.getPanelStyles(),G=H.getValueAndTitleContainerStyles(),M=H.getValueStyles(),Q=H.getTitleStyles(),Y=H.textValues,q=this.props.value.percentChange,te=this.props.percentChangeColorMode,X=q!=null&&!Number.isNaN(q),ee=U?void 0:Y.tooltip;return K?(0,t.jsxs)("button",{type:"button",className:(0,n.cx)((0,s.my)(W),w),style:z,onClick:K,title:ee,children:[(0,t.jsxs)("div",{style:G,children:[Y.title&&(0,t.jsx)("div",{style:Q,children:Y.title}),(0,t.jsx)(a.i,{value:Y,style:M})]}),H.renderChart()]}):(0,t.jsxs)("div",{className:w,style:z,title:ee,children:[(0,t.jsxs)("div",{style:G,children:[Y.title&&(0,t.jsx)("div",{style:Q,children:Y.title}),(0,t.jsx)(a.i,{value:Y,style:M}),X&&(0,t.jsx)(h,{percentChange:q,styles:H.getPercentChangeStyles(q,te,M)})]}),H.renderChart()]})}}},54438:(_,L,e)=>{"use strict";e.d(L,{J:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(23257),a=e.n(s),g=e(40845),i=e(5313);const l=(0,r.forwardRef)(({name:o,value:u,hidden:c,facets:p,onClick:h,className:y,loading:f,searchTerm:v,active:P,style:m,title:D,highlightParts:x,...E},C)=>{const b=(0,g.$j)(),T=d(b),A=v?[v]:[],R=(0,r.useCallback)(O=>{h&&!c&&h(o,u,O)},[h,o,c,u]);let S=u||o;return p&&(S=`${S} (${p})`),(0,t.jsx)("button",{ref:C,onClick:R,style:m,title:D||S,type:"button",role:"option","aria-selected":!!P,className:(0,n.cx)(T.base,P&&T.active,f&&T.loading,c&&T.hidden,y,h&&!c&&T.hover),...E,children:x!==void 0?(0,t.jsx)(i.z,{text:S,highlightClassName:T.matchHighLight,highlightParts:x}):(0,t.jsx)(a(),{textToHighlight:S,searchWords:A,autoEscape:!0,highlightClassName:T.matchHighLight})},S)});l.displayName="Label";const d=o=>({base:(0,n.css)({display:"inline-block",cursor:"pointer",fontSize:o.typography.size.sm,lineHeight:o.typography.bodySmall.lineHeight,backgroundColor:o.colors.background.secondary,color:o.colors.text.primary,whiteSpace:"nowrap",textShadow:"none",padding:o.spacing(.5),borderRadius:o.shape.radius.default,border:"none",marginRight:o.spacing(1),marginBottom:o.spacing(.5)}),loading:(0,n.css)({fontWeight:o.typography.fontWeightMedium,backgroundColor:o.colors.primary.shade,color:o.colors.text.primary,[o.transitions.handleMotion("no-preference","reduce")]:{animation:"pulse 3s ease-out 0s infinite normal forwards"},"@keyframes pulse":{"0%":{color:o.colors.text.primary},"50%":{color:o.colors.text.secondary},"100%":{color:o.colors.text.disabled}}}),active:(0,n.css)({fontWeight:o.typography.fontWeightMedium,backgroundColor:o.colors.primary.main,color:o.colors.primary.contrastText}),matchHighLight:(0,n.css)({background:"inherit",color:o.components.textHighlight.text,backgroundColor:o.components.textHighlight.background}),hidden:(0,n.css)({opacity:.6,cursor:"default",border:"1px solid transparent"}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})})},19727:(_,L,e)=>{"use strict";e.d(L,{e:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);const a=(0,r.forwardRef)(({className:i,children:l,...d},o)=>{const u=(0,s.of)(g);return(0,t.jsx)("div",{ref:o,className:(0,n.cx)("button-group",u.wrapper,i),...d,children:l})});a.displayName="ButtonGroup";const g=i=>({wrapper:(0,n.css)({display:"flex","> .button-group:not(:first-child) > button, > button:not(:first-child)":{borderTopLeftRadius:0,borderBottomLeftRadius:0},"> .button-group:not(:last-child) > button, > button:not(:last-child)":{borderTopRightRadius:0,borderBottomRightRadius:0,borderRightWidth:0}})})},76442:(_,L,e)=>{"use strict";e.d(L,{c:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({message:g,callToActionElement:i,footer:l,className:d})=>{const o=(0,r.of)(a);return(0,t.jsxs)("div",{className:(0,n.cx)([o.wrapper,d]),children:[g&&(0,t.jsx)("div",{className:o.message,children:g}),i,l&&(0,t.jsx)("div",{className:o.footer,children:l})]})},a=g=>({wrapper:(0,n.css)({label:"call-to-action-card",background:g.colors.background.secondary,borderRadius:g.shape.radius.default,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexGrow:1,padding:g.spacing(3),[g.breakpoints.down("sm")]:{padding:g.spacing(3,1)}}),message:(0,n.css)({marginBottom:g.spacing(3),fontStyle:"italic"}),footer:(0,n.css)({marginTop:g.spacing(3)})})},10860:(_,L,e)=>{"use strict";e.d(L,{H:()=>C,Z:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(16797),g=e(81507);const i=r.createContext(null),l=({disabled:b,href:T,onClick:A,children:R,isSelected:S,isCompact:O,className:j,...B})=>{const N=(0,r.useMemo)(()=>r.Children.toArray(R).some(U=>r.isValidElement(U)&&U.type===d),[R]),I=b||!A&&!T,K=A&&!b?A:void 0,w=(0,s.of)(g.i,b,I,S,O);return(0,t.jsx)(g.Q,{disableEvents:b,disableHover:I,isSelected:S,className:(0,n.cx)(w.container,j),...B,children:(0,t.jsxs)(i.Provider,{value:{href:T,onClick:K,disabled:b,isSelected:S},children:[!N&&(0,t.jsx)(d,{}),R]})})},d=({children:b,className:T,"aria-label":A})=>{const R=(0,r.useContext)(i),S=(0,s.of)(o),{href:O,onClick:j,isSelected:B}=R??{href:void 0,onClick:void 0,isSelected:void 0};return(0,t.jsxs)("h2",{className:(0,n.cx)(S.heading,T),children:[O?(0,t.jsx)("a",{href:O,className:S.linkHack,"aria-label":A,onClick:j,children:b}):j?(0,t.jsx)("button",{onClick:j,className:S.linkHack,"aria-label":A,type:"button",children:b}):(0,t.jsx)(t.Fragment,{children:b}),B!==void 0&&(0,t.jsx)("input",{"aria-label":"option",type:"radio",checked:B,readOnly:!0})]})};d.displayName="Heading";const o=b=>({heading:(0,n.css)({gridArea:"Heading",justifySelf:"start",display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",marginBottom:0,fontSize:b.typography.size.md,letterSpacing:"inherit",lineHeight:b.typography.body.lineHeight,color:b.colors.text.primary,fontWeight:b.typography.fontWeightMedium,"& input[readonly]":{cursor:"inherit"}}),linkHack:(0,n.css)({all:"unset","&::after":{position:"absolute",content:'""',top:0,bottom:0,left:0,right:0,borderRadius:b.shape.radius.default},"&:focus-visible":{outline:"none",outlineOffset:0,boxShadow:"none","&::after":{...(0,a.getFocusStyles)(b),zIndex:1}}})}),u=({children:b,className:T})=>{const A=(0,s.of)(c);return(0,t.jsx)("div",{className:(0,n.cx)(A.tagList,T),children:b})};u.displayName="Tags";const c=b=>({tagList:(0,n.css)({position:"relative",gridArea:"Tags",alignSelf:"center"})}),p=({children:b,className:T})=>{const A=(0,s.of)(h);return(0,t.jsx)("p",{className:(0,n.cx)(A.description,T),children:b})};p.displayName="Description";const h=b=>({description:(0,n.css)({width:"100%",gridArea:"Description",margin:b.spacing(1,0,0),color:b.colors.text.secondary,lineHeight:b.typography.body.lineHeight})}),y=({children:b,align:T="start",className:A})=>{const R=(0,s.of)(f);return(0,t.jsx)("div",{className:(0,n.cx)(R.media,A,(0,n.css)({alignSelf:T})),children:b})};y.displayName="Figure";const f=b=>({media:(0,n.css)({position:"relative",gridArea:"Figure",marginRight:b.spacing(2),width:"40px","> img":{width:"100%"},"&:empty":{display:"none"}})}),v=(0,r.memo)(({children:b,className:T,separator:A="|"})=>{const R=(0,s.of)(P);let S=b;const O=r.Children.toArray(b).filter(Boolean);return O.length?(S=O.map((j,B)=>(0,t.jsx)("div",{className:R.metadataItem,children:j},`element_${B}`)),O.length>1&&A&&(S=O.reduce((j,B,N)=>[j,(0,t.jsx)("span",{className:R.separator,children:A},`separator_${N}`),B])),(0,t.jsx)("div",{className:(0,n.cx)(R.metadata,T),children:S})):null});v.displayName="Meta";const P=b=>({metadata:(0,n.css)({gridArea:"Meta",display:"flex",alignItems:"center",width:"100%",fontSize:b.typography.size.sm,color:b.colors.text.secondary,margin:b.spacing(.5,0,0),lineHeight:b.typography.bodySmall.lineHeight,overflowWrap:"anywhere"}),metadataItem:(0,n.css)({zIndex:0}),separator:(0,n.css)({margin:`0 ${b.spacing(1)}`})}),m=({children:b,disabled:T,variant:A,className:R})=>{const S=(0,s.of)(D),j=(0,r.useContext)(i)?.disabled||T,B=A==="primary"?S.actions:S.secondaryActions;return(0,t.jsx)("div",{className:(0,n.cx)(B,R),children:r.Children.map(b,N=>r.isValidElement(N)?(0,r.cloneElement)(N,{disabled:j,...N.props}):null)})},D=b=>({actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Actions",marginTop:b.spacing(2)}),secondaryActions:(0,n.css)({alignSelf:"center",color:b.colors.text.secondary,display:"flex",flexDirection:"row",flexWrap:"wrap",gap:b.spacing(1),gridArea:"Secondary",marginTop:b.spacing(2)})}),x=({children:b,disabled:T,className:A})=>(0,t.jsx)(m,{variant:"primary",disabled:T,className:A,children:b});x.displayName="Actions";const E=({children:b,disabled:T,className:A})=>(0,t.jsx)(m,{variant:"secondary",disabled:T,className:A,children:b});E.displayName="SecondaryActions";const C=b=>({inner:(0,n.css)({display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",flexWrap:"wrap"}),...o(b),...P(b),...h(b),...f(b),...D(b),...c(b)});l.Heading=d,l.Tags=u,l.Figure=y,l.Meta=v,l.Actions=x,l.SecondaryActions=E,l.Description=p},81507:(_,L,e)=>{"use strict";e.d(L,{Q:()=>i,i:()=>l});var t=e(74848),n=e(32196),r=e(40845),s=e(16797);const a=({children:d,href:o})=>{const{inner:u}=(0,r.of)(g);return o?(0,t.jsx)("a",{className:u,href:o,children:d}):(0,t.jsx)(t.Fragment,{children:d})},g=d=>({inner:(0,n.css)({display:"flex",width:"100%",padding:d.spacing(2)})}),i=({children:d,disableEvents:o,disableHover:u,isSelected:c,className:p,href:h,...y})=>{const{oldContainer:f}=(0,r.of)(l,o,u,c);return(0,t.jsx)("div",{...y,className:(0,n.cx)(f,p),children:(0,t.jsx)(a,{href:h,children:d})})},l=(d,o=!1,u=!1,c,p)=>{const h=c!==void 0;return{container:(0,n.css)({display:"grid",position:"relative",gridTemplateColumns:"auto 1fr auto",gridTemplateRows:"1fr auto auto auto",gridAutoColumns:"1fr",gridAutoFlow:"row",gridTemplateAreas:`
        "Figure Heading Tags"
        "Figure Meta Tags"
        "Figure Description Tags"
        "Figure Actions Secondary"`,width:"100%",padding:d.spacing(p?1:2),background:d.colors.background.secondary,borderRadius:d.shape.radius.default,marginBottom:"8px",pointerEvents:o?"none":"auto",[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!u&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(d)},...h&&{cursor:"pointer"},...c&&{outline:`solid 2px ${d.colors.primary.border}`}}),oldContainer:(0,n.css)({display:"flex",width:"100%",background:d.colors.background.secondary,borderRadius:d.shape.radius.default,position:"relative",pointerEvents:o?"none":"auto",marginBottom:d.spacing(1),[d.transitions.handleMotion("no-preference","reduce")]:{transition:d.transitions.create(["background-color","box-shadow","border-color","color"],{duration:d.transitions.duration.short})},...!u&&{"&:hover":{background:d.colors.emphasize(d.colors.background.secondary,.03),cursor:"pointer",zIndex:1},"&:focus":s.getFocusStyles(d)}})}}},3988:(_,L,e)=>{"use strict";e.d(L,{v:()=>P});var t=e(74848),n=e(32196),r=e(47078),s=e.n(r),a=e(16401),g=e(96540),i=e(40845),l=e(14578),d=e(29158),o=e(10354),u=e(67061),c=e(90182),p=e(58898),h=e(30958);const y=(0,n.css)({"&:focus":{outline:"none"}}),f=" / ";class v extends g.PureComponent{constructor(D){super(D),this.flattenOptions=(b,T=[])=>{let A=[];for(const R of b){const S=[...T];S.push(R),!R.items||R.items.length===0?A.push({singleLabel:S[S.length-1].label,label:S.map(O=>O.label).join(this.props.separator||f),value:S.map(O=>O.value)}):A=[...A,...this.flattenOptions(R.items,S)]}return A},this.getSearchableOptions=s()(b=>this.flattenOptions(b)),this.onChange=(b,T)=>{const A=this.props.hideActiveLevelLabel?"":this.props.displayAllSelectedLevels?T.map(S=>S.label).join(this.props.separator||f):T[T.length-1].label,R={rcValue:{value:b,label:A},focusCascade:!0,activeLabel:A,isSearching:!1,inputValue:A};this.setState(R),this.props.onSelect(T[T.length-1].value)},this.onSelect=b=>{const T=b.value||[],A=this.props.displayAllSelectedLevels?b.label:b.singleLabel||"",R={activeLabel:A,inputValue:A,rcValue:{value:T,label:A},isSearching:!1,focusCascade:!1};this.setState(R),this.props.onSelect(T[T.length-1])},this.onCreateOption=b=>{this.setState({activeLabel:b,inputValue:b,rcValue:[],isSearching:!1}),this.props.onSelect(b)},this.onBlur=()=>{this.setState({isSearching:!1,focusCascade:!1}),this.state.activeLabel===""&&this.setState({rcValue:[]}),this.props.onBlur?.()},this.onBlurCascade=()=>{this.setState({focusCascade:!1}),this.props.onBlur?.()},this.onInputKeyDown=b=>{if(["ArrowDown","ArrowUp","Enter","ArrowLeft","ArrowRight"].includes(b.key))return;const{activeLabel:T}=this.state;this.setState({focusCascade:!1,isSearching:!0,inputValue:T})},this.onSelectInputChange=b=>{this.setState({inputValue:b})};const x=this.getSearchableOptions(D.options),{rcValue:E,activeLabel:C}=this.setInitialValue(x,D.initialValue);this.state={isSearching:!1,focusCascade:!1,rcValue:E,activeLabel:C,inputValue:""}}static{this.defaultProps={changeOnSelect:!0}}setInitialValue(D,x){if(!x)return{rcValue:[],activeLabel:""};for(const E of D){const C=E.value||[];if(C[C.length-1]===x)return{rcValue:C,activeLabel:this.props.displayAllSelectedLevels?E.label:E.singleLabel||""}}return this.props.allowCustomValue?{rcValue:[],activeLabel:x}:{rcValue:[],activeLabel:""}}render(){const{allowCustomValue:D,formatCreateLabel:x,placeholder:E,width:C,changeOnSelect:b,options:T,disabled:A,id:R,isClearable:S,theme:O}=this.props,{focusCascade:j,isSearching:B,rcValue:N,activeLabel:I,inputValue:K}=this.state,w=this.getSearchableOptions(T),U=(0,h.T)(O);return(0,t.jsx)("div",{children:B?(0,t.jsx)(c.l6,{allowCustomValue:D,placeholder:E,autoFocus:!j,onChange:this.onSelect,onBlur:this.onBlur,options:w,onCreateOption:this.onCreateOption,formatCreateLabel:x,width:C,onInputChange:this.onSelectInputChange,disabled:A,inputValue:K,inputId:R}):(0,t.jsx)(a.A,{onChange:(0,p.k)(this.onChange),options:T,changeOnSelect:b,value:N.value,fieldNames:{label:"label",value:"value",children:"items"},expandIcon:null,open:this.props.alwaysOpen,disabled:A,dropdownClassName:U.dropdown,children:(0,t.jsx)("div",{className:y,children:(0,t.jsx)(o.p,{autoFocus:this.props.autoFocus,width:C,placeholder:E,onBlur:this.onBlurCascade,value:I,onKeyDown:this.onInputKeyDown,onChange:()=>{},suffix:(0,t.jsxs)(u.B,{gap:.5,children:[S&&I!==""&&(0,t.jsx)(d.K,{name:"times","aria-label":"Clear selection",onClick:W=>{W.preventDefault(),W.stopPropagation(),this.setState({rcValue:[],activeLabel:"",inputValue:""}),this.props.onSelect("")}}),(0,t.jsx)(l.I,{name:j?"angle-up":"angle-down"})]}),disabled:A,id:R})})})})}}const P=(0,i.cV)(v)},58898:(_,L,e)=>{"use strict";e.d(L,{W:()=>n,k:()=>t});const t=a=>(g,i)=>{a&&a(g.map(l=>String(l)),r(i))},n=a=>g=>{a&&a(r(g))},r=a=>a.map(s),s=a=>{const g=a.value?String(a.value):"";return{value:g,label:typeof a.label=="string"?a.label:g}}},30958:(_,L,e)=>{"use strict";e.d(L,{T:()=>g});var t=e(32196);const n=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"}}),r=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 0%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 0%",transform:"scaleY(0.8)"}}),s=(0,t.keyframes)({"0%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"},"100%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"}}),a=(0,t.keyframes)({"0%":{opacity:1,transformOrigin:"0% 100%",transform:"scaleY(1)"},"100%":{opacity:0,transformOrigin:"0% 100%",transform:"scaleY(0.8)"}}),g=i=>({dropdown:(0,t.css)({"&.rc-cascader-dropdown":{position:"absolute",zIndex:9999,"&-hidden":{display:"none"}},".rc-cascader":{"&-menus":{overflow:"hidden",background:i.colors.background.canvas,border:`1px solid ${i.colors.border.weak}`,borderRadius:i.shape.radius.default,boxShadow:i.shadows.z3,whiteSpace:"nowrap","&.slide-up-enter, &.slide-up-appear":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:0,animationTimingFunction:"cubic-bezier(0.08, 0.82, 0.17, 1)",animationPlayState:"paused"},"&.slide-up-enter.slide-up-enter-active.rc-cascader-menus-placement, &.slide-up-appear.slide-up-appear-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:n,animationPlayState:"running"},"&-topLeft":{animationName:s,animationPlayState:"running"}},"&.slide-up-leave":{animationDuration:"0.3s",animationFillMode:"both",transformOrigin:"0 0",opacity:1,animationTimingFunction:"cubic-bezier(0.6, 0.04, 0.98, 0.34)",animationPlayState:"paused","&.slide-up-leave-active.rc-cascader-menus-placement":{"&-bottomLeft":{animationName:r,animationPlayState:"running"},"&-topLeft":{animationName:a,animationPlayState:"running"}}}},"&-menu":{display:"inline-block",maxWidth:"50vw",height:"192px",listStyle:"none",margin:0,padding:0,borderRight:`1px solid ${i.colors.border.weak}`,overflow:"auto","&:last-child":{borderRight:0},"&-item":{height:i.spacing(4),lineHeight:i.spacing(4),padding:i.spacing(0,4,0,2),cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",transition:"all 0.3s ease",position:"relative","&:hover":{background:i.colors.action.hover},"&-disabled":{cursor:"not-allowed",color:i.colors.text.disabled,"&:hover":{background:"transparent"},"&:after":{position:"absolute",right:"12px",content:"'loading'",color:i.colors.text.disabled,fontStyle:"italic"}},"&-active":{color:i.colors.text.maxContrast,background:i.colors.background.secondary,"&:hover":{background:i.colors.action.hover}},"&-expand":{position:"relative","&:after":{background:i.colors.background.secondary,content:"''",height:i.spacing(3),mask:"url(../img/icons/unicons/angle-right.svg)",maskType:"luminance",position:"absolute",right:0,top:i.spacing(.5),width:i.spacing(3)}}}}}})})},8866:(_,L,e)=>{"use strict";e.d(L,{N:()=>r});var t=e(74848),n=e(96540);class r extends n.PureComponent{constructor(){super(...arguments),this.myRef=(0,n.createRef)(),this.state={hasEventListener:!1},this.onOutsideClick=a=>{const g=this.myRef.current;(!g||a.target instanceof Node&&!g.contains(a.target))&&this.props.onClick()}}static{this.defaultProps={includeButtonPress:!0,parent:typeof window<"u"?window:void 0,useCapture:!1}}componentDidMount(){this.props.parent.addEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.addEventListener("keyup",this.onOutsideClick,this.props.useCapture)}componentWillUnmount(){this.props.parent.removeEventListener("click",this.onOutsideClick,this.props.useCapture),this.props.includeButtonPress&&this.props.parent.removeEventListener("keyup",this.onOutsideClick,this.props.useCapture)}render(){return(0,t.jsx)("div",{ref:this.myRef,children:this.props.children})}}},10534:(_,L,e)=>{"use strict";e.d(L,{b:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(76412),a=e(40845),g=e(55852),i=e(14578),l=e(32982);const d=2*1e3;function o({onClipboardCopy:p,onClipboardError:h,children:y,getText:f,icon:v,variant:P,...m}){const D=(0,a.of)(c),[x,E]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let T;return x&&(T=setTimeout(()=>{E(!1)},d)),()=>{window.clearTimeout(T)}},[x]);const C=(0,r.useRef)(null),b=(0,r.useCallback)(async()=>{const T=f();try{await u(T,C),E(!0),p?.(T)}catch(A){h?.(T,A)}},[f,p,h]);return(0,t.jsxs)(t.Fragment,{children:[x&&(0,t.jsx)(l.r,{placement:"top",referenceElement:C.current,children:(0,t.jsx)(s.x,{i18nKey:"clipboard-button.inline-toast.success",children:"Copied"})}),(0,t.jsxs)(g.$n,{onClick:b,icon:v,variant:x?"success":P,"aria-label":x?"Copied":void 0,...m,className:(0,n.cx)(D.button,x&&D.successButton,m.className),ref:C,children:[y,x&&(0,t.jsx)("div",{className:D.successOverlay,children:(0,t.jsx)(i.I,{name:"check"})})]})]})}const u=async(p,h)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(p);{const y=document.createElement("textarea");h.current?.appendChild(y),y.value=p,y.focus(),y.select(),document.execCommand("copy"),y.remove()}},c=p=>({button:(0,n.css)({position:"relative"}),successButton:(0,n.css)({"> *":(0,n.css)({visibility:"hidden"})}),successOverlay:(0,n.css)({position:"absolute",top:0,bottom:0,right:0,left:0,visibility:"visible"})})},57418:(_,L,e)=>{"use strict";e.d(L,{M:()=>o});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(40845),i=e(16797),l=e(14578),d=e(62930);const o=({label:c,isOpen:p,onToggle:h,className:y,contentClassName:f,children:v,labelId:P,loading:m=!1,headerDataTestId:D,contentDataTestId:x})=>{const[E,C]=(0,a.useState)(p),b=(0,g.of)(u),T=S=>{S.target instanceof HTMLElement&&S.target.tagName==="A"||(S.preventDefault(),S.stopPropagation(),h?.(!E),C(!E))},{current:A}=(0,a.useRef)((0,r.uniqueId)()),R=P??`collapse-label-${A}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{onClick:T,className:(0,n.cx)(b.header,y),children:[(0,t.jsx)("button",{type:"button",id:`collapse-button-${A}`,className:b.button,onClick:T,"aria-expanded":E&&!m,"aria-controls":`collapse-content-${A}`,"aria-labelledby":R,children:m?(0,t.jsx)(d.y,{className:b.spinner}):(0,t.jsx)(l.I,{name:E?"angle-up":"angle-down",className:b.icon})}),(0,t.jsx)("div",{className:b.label,id:`collapse-label-${A}`,"data-testid":D,children:c})]}),E&&(0,t.jsx)("div",{id:`collapse-content-${A}`,className:(0,n.cx)(b.content,f),"data-testid":x,children:v})]})},u=c=>({header:(0,n.css)({display:"flex",cursor:"pointer",boxSizing:"border-box",flexDirection:"row-reverse",position:"relative",justifyContent:"space-between",fontSize:c.typography.size.lg,padding:`${c.spacing(.5)} 0`,"&:focus-within":(0,i.getFocusStyles)(c)}),button:(0,n.css)({all:"unset","&:focus-visible":{outline:"none",outlineOffset:"unset",transition:"none",boxShadow:"none"}}),icon:(0,n.css)({color:c.colors.text.secondary}),content:(0,n.css)({padding:`${c.spacing(2)} 0`}),spinner:(0,n.css)({display:"flex",alignItems:"center",width:c.spacing(2)}),label:(0,n.css)({display:"flex"})})},82762:(_,L,e)=>{"use strict";e.d(L,{S:()=>d,a:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(14578);const i=o=>({collapse:(0,n.css)({label:"collapse",marginBottom:o.spacing(1),backgroundColor:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,position:"relative",borderRadius:o.shape.radius.default,width:"100%",display:"flex",flexDirection:"column",flex:"1 1 0"}),collapseBody:(0,n.css)({label:"collapse__body",padding:o.spacing(o.components.panel.padding),paddingTop:0,flex:1,overflow:"hidden",display:"flex",flexDirection:"column"}),bodyContentWrapper:(0,n.css)({label:"bodyContentWrapper",flex:1}),loader:(0,n.css)({label:"collapse__loader",height:"2px",position:"relative",overflow:"hidden",background:"none",margin:o.spacing(.5)}),loaderActive:(0,n.css)({label:"collapse__loader_active","&:after":{content:"' '",display:"block",width:"25%",top:0,height:"250%",position:"absolute",animation:"loader 2s cubic-bezier(0.17, 0.67, 0.83, 0.67) 500ms",animationIterationCount:100,left:"-25%",background:o.colors.primary.main},"@keyframes loader":{from:{left:"-25%",opacity:.1},to:{left:"100%",opacity:1}}}),header:(0,n.css)({label:"collapse__header",padding:o.spacing(1,2,1,2),display:"flex"}),headerCollapsed:(0,n.css)({label:"collapse__header--collapsed",padding:o.spacing(1,2,1,2)}),headerLabel:(0,n.css)({label:"collapse__header-label",fontWeight:o.typography.fontWeightMedium,marginRight:o.spacing(1),fontSize:o.typography.size.md,display:"flex",flex:"0 0 100%"}),icon:(0,n.css)({label:"collapse__icon",margin:o.spacing(.25,1,0,-1)})}),l=({isOpen:o,onToggle:u,...c})=>{const[p,h]=(0,r.useState)(o);return(0,t.jsx)(d,{isOpen:p,collapsible:!0,...c,onToggle:()=>{h(!p),u&&u(!p)}})},d=({isOpen:o,label:u,loading:c,collapsible:p,onToggle:h,className:y,children:f})=>{const v=(0,s.of)(a.my),P=(0,s.of)(i),m=()=>{h&&h(!o)},D=(0,n.cx)([P.collapse,y]),x=c?(0,n.cx)([P.loader,P.loaderActive]):(0,n.cx)([P.loader]),E=p?(0,n.cx)([P.header]):(0,n.cx)([P.headerCollapsed]);return(0,t.jsxs)("div",{className:D,children:[(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(v,E),onClick:m,children:[p&&(0,t.jsx)(g.I,{className:P.icon,name:o?"angle-down":"angle-right"}),(0,t.jsx)("div",{className:(0,n.cx)([P.headerLabel]),children:u})]}),o&&(0,t.jsxs)("div",{className:(0,n.cx)([P.collapseBody]),children:[(0,t.jsx)("div",{className:x}),(0,t.jsx)("div",{className:P.bodyContentWrapper,children:f})]})]})};d.displayName="Collapse"},36314:(_,L,e)=>{"use strict";e.d(L,{A:()=>o});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(84140),i=e(40845),l=e(10354);const d=(0,a.forwardRef)(({color:p,onChange:h,isClearable:y=!1,onClick:f,onBlur:v,disabled:P,buttonAriaLabel:m,...D},x)=>{const[E,C]=(0,a.useState)(p),[b,T]=(0,a.useState)(p),A=(0,a.useMemo)(()=>(0,r.debounce)(h,100),[]);(0,a.useEffect)(()=>{const O=(0,g.A)(p);O.isValid()&&p!==b&&(C(O.toString()),T(p))},[p,b]);const R=O=>{const{value:j}=O.currentTarget;if(C(j),j===""&&y){A(j);return}const B=(0,g.A)(j);B.isValid()&&A(B.toString())},S=O=>{(0,g.A)(E).isValid()||C(p),v?.(O)};return(0,t.jsx)(l.p,{...D,value:E,onChange:R,disabled:P,onClick:f,onBlur:S,addonBefore:(0,t.jsx)(u,{onClick:f,ariaLabel:m,disabled:P,color:p}),ref:x})});d.displayName="ColorInput";const o=d,u=({color:p,onClick:h,disabled:y,ariaLabel:f})=>{const v=(0,i.of)(c);return(0,t.jsx)("button",{type:"button",onClick:h,"aria-label":f,disabled:y||!h,className:(0,n.cx)(v,(0,n.css)({backgroundColor:p}))})},c=p=>(0,n.css)({height:"100%",width:`${p.spacing.gridSize*4}px`,borderRadius:`${p.shape.radius.default} 0 0 ${p.shape.radius.default}`,border:`1px solid ${p.colors.border.medium}`})},83598:(_,L,e)=>{"use strict";e.d(L,{Dp:()=>h,sk:()=>p});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(3911),g=e(40321),i=e(13840),l=e(95868),d=e(70045),o=e(83876),u=e(70104);const c=(f,v="ColorPicker")=>class extends r.Component{constructor(){super(...arguments),this.pickerTriggerRef=(0,r.createRef)()}static{this.displayName=v}render(){const{theme:m,children:D,onChange:x,color:E}=this.props,C=y(m),b=r.createElement(f,{...this.props,children:null,onChange:x});return(0,t.jsx)(l.I,{content:b,hideAfter:300,children:(T,A,R)=>(0,t.jsxs)(t.Fragment,{children:[this.pickerTriggerRef.current&&(0,t.jsx)(i.A,{...R,referenceElement:this.pickerTriggerRef.current,wrapperClassName:C.colorPicker,onMouseLeave:A,onMouseEnter:T,onKeyDown:S=>(0,g.Q)(S,A)}),D?D({ref:this.pickerTriggerRef,showColorPicker:T,hideColorPicker:A}):(0,t.jsx)(o.q,{ref:this.pickerTriggerRef,onClick:T,onMouseLeave:A,color:m.visualization.getColorByName(E||"#000000"),"aria-label":E})]})})}},p=(0,s.cV)(c(d.$,"ColorPicker")),h=(0,s.cV)(c(u.o,"SeriesColorPicker")),y=(0,a.N)(f=>({colorPicker:(0,n.css)({position:"absolute",zIndex:f.zIndex.tooltip,color:f.colors.text.primary,maxWidth:"400px",fontSize:f.typography.size.sm})}))},70045:(_,L,e)=>{"use strict";e.d(L,{$:()=>P});var t=e(74848),n=e(32196),r=e(85690),s=e(96540),a=e(23596),g=e(40845),i=e(3911),l=e(83876),d=e(2543);function o(D,x){const E=new Array(D.length);for(let C=0;C<D.length;C++){const b=D.length-1-C;E[C]=x(D[b],b,D)}return E}const c=({hue:D,selectedColor:x,onColorSelect:E,...C})=>{const b=(0,d.upperFirst)(D.name),T=(0,g.of)(p);return(0,t.jsxs)("div",{className:T.colorRow,children:[(0,t.jsx)("div",{className:T.colorLabel,children:b}),(0,t.jsx)("div",{...C,className:T.swatchRow,children:o(D.shades,A=>(0,t.jsx)(l.q,{"aria-label":A.name,variant:A.primary?l.h.Large:l.h.Small,isSelected:A.name===x,color:A.color,onClick:()=>E(A.name)},A.name))})]})},p=D=>({colorRow:(0,n.css)({display:"grid",gridTemplateColumns:"25% 1fr",gridColumnGap:D.spacing(2),padding:D.spacing(.5,0),"&:hover":{background:D.colors.background.secondary}}),colorLabel:(0,n.css)({paddingLeft:D.spacing(2),display:"flex",alignItems:"center"}),swatchRow:(0,n.css)({display:"flex",gap:D.spacing(1),alignItems:"center",justifyContent:"space-around",flexDirection:"row"})}),h=({color:D,onChange:x})=>{const E=(0,g.$j)(),C=(0,g.of)(y),b=[];for(const T of E.visualization.hues)b.push((0,t.jsx)(c,{selectedColor:D,hue:T,onColorSelect:x},T.name));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:C.swatches,children:b}),(0,t.jsxs)("div",{className:C.extraColors,children:[(0,t.jsx)(l.q,{isSelected:D==="transparent",color:"rgba(0,0,0,0)",label:"Transparent",onClick:()=>x("transparent")}),(0,t.jsx)(l.q,{isSelected:D==="text",color:E.colors.text.primary,label:"Text color",onClick:()=>x("text")})]})]})},y=D=>({container:(0,n.css)({display:"flex",flexDirection:"column"}),extraColors:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-around",gap:D.spacing(1),padding:D.spacing(1,0)}),swatches:(0,n.css)({display:"grid",flexGrow:1})});var f=e(95151);class v extends s.Component{constructor(x){super(x),this.getTabClassName=E=>{const{activePicker:C}=this.state;return`ColorPickerPopover__tab ${C===E&&"ColorPickerPopover__tab--active"}`},this.handleChange=E=>{const{onChange:C,enableNamedColors:b,theme:T}=this.props;if(b)return C(E);C(a.MV.asHexString(T.visualization.getColorByName(E)))},this.onTabChange=E=>()=>this.setState({activePicker:E}),this.renderPicker=()=>{const{activePicker:E}=this.state,{color:C}=this.props;switch(E){case"spectrum":return(0,t.jsx)(f.A,{color:C,onChange:this.handleChange});case"palette":return(0,t.jsx)(h,{color:C,onChange:this.handleChange});default:return this.renderCustomPicker(E)}},this.renderCustomPicker=E=>{const{customPickers:C,color:b,theme:T}=this.props;return C?s.createElement(C[E].tabComponent,{color:b,theme:T,onChange:this.handleChange}):null},this.renderCustomPickerTabs=()=>{const{customPickers:E}=this.props;return E?(0,t.jsx)(t.Fragment,{children:Object.keys(E).map(C=>(0,t.jsx)("button",{className:this.getTabClassName(C),onClick:this.onTabChange(C),type:"button",children:E[C].name},C))}):null},this.state={activePicker:"palette"}}render(){const{theme:x}=this.props,E=m(x);return(0,t.jsx)(r.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsxs)("div",{tabIndex:-1,className:E.colorPickerPopover,children:[(0,t.jsxs)("div",{className:E.colorPickerPopoverTabs,children:[(0,t.jsx)("button",{className:this.getTabClassName("palette"),onClick:this.onTabChange("palette"),type:"button",children:"Colors"}),(0,t.jsx)("button",{className:this.getTabClassName("spectrum"),onClick:this.onTabChange("spectrum"),type:"button",children:"Custom"}),this.renderCustomPickerTabs()]}),(0,t.jsx)("div",{className:E.colorPickerPopoverContent,children:this.renderPicker()})]})})}}const P=(0,g.cV)(v);P.displayName="ColorPickerPopover";const m=(0,i.N)(D=>({colorPickerPopover:(0,n.css)({borderRadius:D.shape.radius.default,boxShadow:D.shadows.z3,background:D.colors.background.primary,border:`1px solid ${D.colors.border.weak}`,".ColorPickerPopover__tab":{width:"50%",textAlign:"center",padding:D.spacing(1,0),background:D.colors.background.secondary,color:D.colors.text.secondary,fontSize:D.typography.bodySmall.fontSize,cursor:"pointer",border:"none","&:focus:not(:focus-visible)":{outline:"none",boxShadow:"none"},":focus-visible":{position:"relative"}},".ColorPickerPopover__tab--active":{color:D.colors.text.primary,fontWeight:D.typography.fontWeightMedium,background:D.colors.background.primary}}),colorPickerPopoverContent:(0,n.css)({width:"246px",fontSize:D.typography.bodySmall.fontSize,minHeight:"184px",padding:D.spacing(1),display:"flex",flexDirection:"column"}),colorPickerPopoverTabs:(0,n.css)({display:"flex",width:"100%",borderRadius:`${D.shape.radius.default} ${D.shape.radius.default} 0 0`})}))},83876:(_,L,e)=>{"use strict";e.d(L,{h:()=>l,q:()=>d});var t=e(74848),n=e(32196),r=e(95382),s=e(96540),a=e(84140),g=e(13544),i=e(40845),l=(u=>(u.Small="small",u.Large="large",u))(l||{});const d=s.forwardRef(({color:u,label:c,variant:p="small",isSelected:h,"aria-label":y,...f},v)=>{const P=(0,i.$j)(),{isFocusVisible:m,focusProps:D}=(0,r.o)(),x=o(P,p,u,m,h),E=!!c,C=y||c;return(0,t.jsxs)("div",{ref:v,className:x.wrapper,"data-testid":g.Tp.components.ColorSwatch.name,...f,children:[E&&(0,t.jsx)("span",{className:x.label,children:c}),(0,t.jsx)("button",{className:x.swatch,...D,"aria-label":C?`${C} color`:"Pick a color",type:"button"})]})}),o=(u,c,p,h,y)=>{const f=(0,a.A)(p),P=c==="small"?"16px":"32px";let m="none";return f.getAlpha()<.1&&(m=`2px solid ${u.colors.border.medium}`),{wrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer"}),label:(0,n.css)({marginRight:u.spacing(1)}),swatch:(0,n.css)({width:P,height:P,background:`${p}`,border:m,borderRadius:u.shape.radius.circle,outlineOffset:"1px",outline:h?`2px solid  ${u.colors.primary.main}`:"none",boxShadow:y?`inset 0 0 0 2px ${p}, inset 0 0 0 4px ${u.colors.getContrastText(p)}`:"none",[u.transitions.handleMotion("no-preference")]:{transition:u.transitions.create(["transform"],{duration:u.transitions.duration.short})},"&:hover":{transform:"scale(1.1)"},"@media (forced-colors: active)":{forcedColorAdjust:"none"}})}};d.displayName="ColorSwatch"},70104:(_,L,e)=>{"use strict";e.d(L,{o:()=>g,t:()=>i});var t=e(74848),n=e(40845),r=e(14186),s=e(15292),a=e(70045);const g=l=>{const{yaxis:d,onToggleAxis:o,color:u,...c}=l,p=o?{yaxis:{name:"Y-Axis",tabComponent(){return(0,t.jsx)(r.I,{labelWidth:20,label:"Use right y-axis",children:(0,t.jsx)(s.K,{value:d===2,label:"Use right y-axis",onChange:o})})}}}:void 0;return(0,t.jsx)(a.$,{...c,color:u||"#000000",customPickers:p})},i=(0,n.cV)(g)},95151:(_,L,e)=>{"use strict";e.d(L,{$:()=>u,A:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(7612),a=e(65229),g=e(84140),i=e(23596),l=e(40845),d=e(36314);const o=({color:p,onChange:h})=>{const[y,f]=(0,r.useState)(p);(0,a.A)(D=>{h(i.MV.asHexString(v.visualization.getColorByName(D)))},500,[y]);const v=(0,l.$j)(),P=(0,l.of)(u),m=(0,r.useMemo)(()=>y.startsWith("rgba")?y:(0,g.A)(v.visualization.getColorByName(p)).toRgbString(),[y,v,p]);return(0,t.jsxs)("div",{className:P.wrapper,children:[(0,t.jsx)(s.p9,{className:P.root,color:m,onChange:f}),(0,t.jsx)(d.A,{theme:v,color:m,onChange:f,className:P.colorInput})]})},u=p=>({wrapper:(0,n.css)({flexGrow:1}),root:(0,n.css)({"&.react-colorful":{width:"auto"},".react-colorful":{"&__saturation":{borderRadius:`${p.shape.radius.default} ${p.shape.radius.default} 0 0`},"&__alpha":{borderRadius:`0 0 ${p.shape.radius.default} ${p.shape.radius.default}`},"&__alpha, &__hue":{height:p.spacing(2),position:"relative"},"&__pointer":{height:p.spacing(2),width:p.spacing(2)}}}),colorInput:(0,n.css)({marginTop:p.spacing(2)})}),c=o},55014:(_,L,e)=>{"use strict";e.d(L,{G:()=>E});var t=e(74848),n=e(32196),r=e(72181),s=e(76698),a=e(96540),g=e(40845),i=e(76412),l=e(14578),d=e(51440),o=e(10354);const u=400,c=C=>({menuClosed:(0,n.css)({display:"none"}),menu:(0,n.css)({label:"grafana-select-menu",background:C.components.dropdown.background,boxShadow:C.shadows.z3,zIndex:C.zIndex.dropdown,maxHeight:u,overflowY:"auto",position:"relative"}),menuUlContainer:(0,n.css)({label:"grafana-select-menu-ul-container",listStyle:"none"}),option:(0,n.css)({label:"grafana-select-option",padding:"8px",position:"absolute",display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",width:"100%",overflow:"hidden",cursor:"pointer","&:hover":{background:C.colors.action.hover,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${C.colors.primary.border}`}}}),optionBody:(0,n.css)({label:"grafana-select-option-body",display:"flex",fontWeight:C.typography.fontWeightMedium,flexDirection:"column",flexGrow:1,overflow:"hidden"}),optionLabel:(0,n.css)({label:"grafana-select-option-label",textOverflow:"ellipsis",overflow:"hidden"}),optionDescription:(0,n.css)({label:"grafana-select-option-description",fontWeight:"normal",fontSize:C.typography.bodySmall.fontSize,color:C.colors.text.secondary,lineHeight:C.typography.body.lineHeight,textOverflow:"ellipsis",overflow:"hidden"}),optionFocused:(0,n.css)({label:"grafana-select-option-focused",top:0,background:C.colors.action.focus,"@media (forced-colors: active), (prefers-contrast: more)":{border:`1px solid ${C.colors.primary.border}`}}),optionSelected:(0,n.css)({background:C.colors.action.selected,"&::before":{backgroundImage:C.colors.gradients.brandVertical,borderRadius:C.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",width:C.spacing(.5),left:0,top:0}}),clear:(0,n.css)({label:"grafana-select-clear",cursor:"pointer","&:hover":{color:C.colors.text.primary}})});var p=e(34743),h=e(83505),y=e(46885);const f=100,v=7.3;function P(){return 45}const m=(C,b,T)=>{const A=(0,a.useRef)(null),R=(0,a.useRef)(null),[S,O]=(0,a.useState)(void 0),[j,B]=(0,a.useState)(void 0),N=[(0,p.UU)({crossAxis:!0,boundary:document.body}),(0,p.Ej)({apply({availableWidth:U}){B(U)}})],I={reference:A.current,floating:R.current},{floatingStyles:K}=(0,h.we)({strategy:"fixed",open:T,placement:"bottom-start",middleware:N,elements:I,whileElementsMounted:y.ll});(0,a.useEffect)(()=>{if(b===null)return;const U=b?.startIndex,W=b?.endIndex;if(!(typeof U>"u"||typeof W>"u")){if(U===0||U%f===0&&U>=f){let H=0;const z=Math.min(C.length,W+f);for(let G=U;G<z;G++)H=Math.max(H,C[G].label.length);O(H*v)}else if(W%f===0&&W>=f){let H=0;const z=Math.max(0,U-f);for(let G=z;G<W;G++)H=Math.max(H,C[G].label.length);O(H*v)}}},[C,b,O]);const w={...K,width:S,maxWidth:j,minWidth:A.current?.offsetWidth};return{inputRef:A,floatingRef:R,floatStyles:w}};function D(C){return C?.label??C?.value.toString()??""}function x(C){const b=C.toLowerCase();return T=>!C||T?.label?.toLowerCase().includes(b)||T?.value?.toString().toLowerCase().includes(b)}const E=({options:C,onChange:b,value:T,isClearable:A=!1,createCustomValue:R=!1,id:S,width:O,"aria-labelledby":j,...B})=>{const[N,I]=(0,a.useState)(C),K=(0,a.useMemo)(()=>{if(T===null)return null;const he=C.findIndex(ie=>ie.value===T);return he===-1?null:he},[C,T]),w=(0,a.useMemo)(()=>K!==null?C[K]:T!==null?{label:T.toString(),value:T}:null,[K,C,T]),U=`downshift-${(0,a.useId)().replace(/:/g,"--")}-menu`,W=`downshift-${(0,a.useId)().replace(/:/g,"--")}-label`,H=(0,g.of)(c),z={count:N.length,getScrollElement:()=>re.current,estimateSize:P,overscan:4},G=(0,r.Te)(z),{getInputProps:M,getMenuProps:Q,getItemProps:Y,isOpen:q,highlightedIndex:te,setInputValue:X,openMenu:ee,closeMenu:ne,selectItem:Z}=(0,s.Bp)({menuId:U,labelId:W,inputId:S,items:N,itemToString:D,selectedItem:w,onSelectedItemChange:({selectedItem:he})=>{b(he)},defaultHighlightedIndex:K??0,scrollIntoView:()=>{},onInputValueChange:({inputValue:he})=>{const ie=C.filter(x(he));if(R&&he&&ie.findIndex(J=>J.label===he)===-1){const J={label:he,value:he,description:(0,i.t)("combobox.custom-value.create","Create custom value")};I([...ie,J]);return}else I(ie)},onIsOpenChange:({isOpen:he})=>{if(he){I(C);return}},onHighlightedIndexChange:({highlightedIndex:he,type:ie})=>{ie!==s.Bp.stateChangeTypes.MenuMouseLeave&&G.scrollToIndex(he)}}),{inputRef:ae,floatingRef:re,floatStyles:se}=m(N,G.range,q),de=(0,a.useCallback)(()=>{X(w?.label??T?.toString()??"")},[w,X,T]),le=O==="auto"?d.D:o.p;return(0,t.jsxs)("div",{children:[(0,t.jsx)(le,{width:O==="auto"?void 0:O,suffix:(0,t.jsxs)(t.Fragment,{children:[!!T&&T===w?.value&&A&&(0,t.jsx)(l.I,{name:"times",className:H.clear,title:(0,i.t)("combobox.clear.title","Clear value"),tabIndex:0,role:"button",onClick:()=>{Z(null)},onKeyDown:he=>{(he.key==="Enter"||he.key===" ")&&Z(null)}}),(0,t.jsx)(l.I,{name:q?"search":"angle-down",onClick:()=>{q?ne():ee()}})]}),...B,...M({ref:ae,onChange:()=>{},onBlur:de,"aria-labelledby":j})}),(0,t.jsx)("div",{className:(0,n.cx)(H.menu,!q&&H.menuClosed),style:{...se},...Q({ref:re,"aria-labelledby":j}),children:q&&(0,t.jsx)("ul",{style:{height:G.getTotalSize()},className:H.menuUlContainer,children:G.getVirtualItems().map(he=>(0,t.jsx)("li",{"data-index":he.index,className:(0,n.cx)(H.option,w&&N[he.index].value===w.value&&H.optionSelected,te===he.index&&H.optionFocused),style:{height:he.size,transform:`translateY(${he.start}px)`},...Y({item:N[he.index],index:he.index}),children:(0,t.jsxs)("div",{className:H.optionBody,children:[(0,t.jsx)("span",{className:H.optionLabel,children:N[he.index].label}),N[he.index].description&&(0,t.jsx)("span",{className:H.optionDescription,children:N[he.index].description})]})},N[he.index].value+N[he.index].label))})})]})}},82702:(_,L,e)=>{"use strict";e.d(L,{Z:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852);const g=({children:l,className:d,closeOnConfirm:o,confirmText:u="Save",confirmVariant:c="primary",disabled:p=!1,onCancel:h,onClick:y,onConfirm:f,size:v="md"})=>{const P=(0,r.useRef)(null),m=(0,r.useRef)(null),[D,x]=(0,r.useState)(!1),[E,C]=(0,r.useState)(!1),b=(0,s.of)(i);(0,r.useEffect)(()=>{D?(m.current?.focus(),C(!0)):E&&(P.current?.focus(),C(!1))},[E,D]);const T=B=>{B&&B.preventDefault(),x(!0),y?.()},A=B=>{B&&B.preventDefault(),x(!1),P.current?.focus(),h?.()},R=B=>{B&&B.preventDefault(),f?.(),o&&x(!1)},S=(0,n.cx)(d,b.mainButton,{[b.mainButtonHide]:D}),O=(0,n.cx)(b.confirmButton,{[b.confirmButtonHide]:!D}),j=(0,n.cx)(b.confirmButtonContainer,{[b.confirmButtonContainerHide]:!D});return(0,t.jsxs)("div",{className:b.container,children:[(0,t.jsx)("span",{className:S,children:typeof l=="string"?(0,t.jsx)(a.$n,{disabled:p,size:v,fill:"text",onClick:T,ref:P,children:l}):r.cloneElement(l,{disabled:p,onClick:T,ref:P})}),(0,t.jsx)("div",{className:j,children:(0,t.jsxs)("span",{className:O,children:[(0,t.jsx)(a.$n,{size:v,variant:c,onClick:R,ref:m,children:u}),(0,t.jsx)(a.$n,{size:v,fill:"text",onClick:A,children:"Cancel"})]})})]})};g.displayName="ConfirmButton";const i=l=>({container:(0,n.css)({alignItems:"center",display:"flex",justifyContent:"flex-end",position:"relative"}),mainButton:(0,n.css)({opacity:1,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:2}),mainButtonHide:(0,n.css)({opacity:0,[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden",zIndex:0}),confirmButtonContainer:(0,n.css)({overflow:"visible",position:"absolute",pointerEvents:"all",right:0}),confirmButtonContainerHide:(0,n.css)({overflow:"hidden",pointerEvents:"none"}),confirmButton:(0,n.css)({alignItems:"flex-start",background:l.colors.background.primary,display:"flex",opacity:1,transform:"translateX(0)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeOut})},zIndex:1}),confirmButtonHide:(0,n.css)({opacity:0,transform:"translateX(100%)",[l.transitions.handleMotion("no-preference")]:{transition:l.transitions.create(["opacity","transform","visibility"],{duration:l.transitions.duration.shortest,easing:l.transitions.easing.easeIn})},visibility:"hidden"})})},91605:(_,L,e)=>{"use strict";e.d(L,{e:()=>s});var t=e(74848),n=e(55852),r=e(82702);const s=({size:a,disabled:g,onConfirm:i,"aria-label":l,closeOnConfirm:d})=>(0,t.jsx)(r.Z,{confirmText:"Delete",confirmVariant:"destructive",size:a||"md",disabled:g,onConfirm:i,closeOnConfirm:d,children:(0,t.jsx)(n.$n,{"aria-label":l,variant:"destructive",icon:"times",size:a||"sm"})})},45014:(_,L,e)=>{"use strict";e.d(L,{k:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(49785),a=e(13544),g=e(40845),i=e(55852),l=e(88575),d=e(10354),o=e(67061);const u=({body:p,confirmPromptText:h,confirmButtonLabel:y,confirmButtonVariant:f,dismissButtonVariant:v,dismissButtonLabel:P,onConfirm:m,onDismiss:D,onAlternative:x,alternativeButtonLabel:E,description:C,justifyButtons:b="flex-end",disabled:T})=>{const[A,R]=(0,r.useState)(T),S=(0,g.of)(c),O=(0,r.useRef)(null),j=I=>{R(h?.toLowerCase().localeCompare(I.currentTarget.value.toLowerCase())!==0)};(0,r.useEffect)(()=>{O.current?.focus()},[]),(0,r.useEffect)(()=>{R(T?!0:!!h)},[h,T]);const B=async()=>{T===void 0&&R(!0);try{await m()}finally{T===void 0&&R(!1)}},{handleSubmit:N}=(0,s.mN)();return(0,t.jsxs)("form",{onSubmit:N(B),children:[(0,t.jsxs)("div",{className:S.text,children:[p,C?(0,t.jsx)("div",{className:S.description,children:C}):null,h?(0,t.jsx)("div",{className:S.confirmationInput,children:(0,t.jsx)(o.B,{alignItems:"flex-start",children:(0,t.jsx)(l.D,{disabled:T,children:(0,t.jsx)(d.p,{placeholder:`Type "${h}" to confirm`,onChange:j})})})}):null]}),(0,t.jsx)("div",{className:S.buttonsContainer,children:(0,t.jsxs)(o.B,{justifyContent:b,gap:2,wrap:"wrap",children:[(0,t.jsx)(i.$n,{variant:v,onClick:D,fill:"outline",children:P}),(0,t.jsx)(i.$n,{type:"submit",variant:f,disabled:A,ref:O,"data-testid":a.Tp.pages.ConfirmModal.delete,children:y}),x?(0,t.jsx)(i.$n,{variant:"primary",onClick:x,children:E}):null]})})]})},c=p=>({text:(0,n.css)({fontSize:p.typography.h5.fontSize,color:p.colors.text.primary}),description:(0,n.css)({fontSize:p.typography.body.fontSize}),confirmationInput:(0,n.css)({paddingTop:p.spacing(1)}),buttonsContainer:(0,n.css)({paddingTop:p.spacing(3)})})},96374:(_,L,e)=>{"use strict";e.d(L,{u:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(37390),a=e(45014);const g=({isOpen:l,title:d,body:o,description:u,confirmText:c,confirmVariant:p="destructive",confirmationText:h,dismissText:y="Cancel",dismissVariant:f="secondary",alternativeText:v,modalClass:P,icon:m="exclamation-triangle",onConfirm:D,onDismiss:x,onAlternative:E,confirmButtonVariant:C="destructive",disabled:b})=>{const T=(0,r.of)(i);return(0,t.jsx)(s.a,{className:(0,n.cx)(T.modal,P),title:d,icon:m,isOpen:l,onDismiss:x,children:(0,t.jsx)(a.k,{body:o,description:u,confirmButtonLabel:c,dismissButtonLabel:y,dismissButtonVariant:f,confirmPromptText:h,alternativeButtonLabel:v,confirmButtonVariant:C,onConfirm:D,onDismiss:x,onAlternative:E,disabled:b})})},i=()=>({modal:(0,n.css)({width:"500px"})})},28122:(_,L,e)=>{"use strict";e.d(L,{t:()=>i});var t=e(74848),n=e(96540),r=e(29647),s=e(13544),a=e(38138),g=e(17464);const i=n.memo(({x:l,y:d,onClose:o,focusOnOpen:u=!0,renderMenuItems:c,renderHeader:p})=>{const h=(0,n.useRef)(null),[y,f]=(0,n.useState)({});(0,n.useLayoutEffect)(()=>{const x=h.current;if(x){const E=x.getBoundingClientRect(),C=5,b={right:window.innerWidth<l+E.width,bottom:window.innerHeight<d+E.height+C};f({position:"fixed",left:b.right?l-E.width-C:l-C,top:Math.max(0,b.bottom?d-E.height-C:d+C)})}},[l,d]),(0,r.A)(h,()=>{o?.()});const v=p?.(),P=c?.(),m=x=>{u&&x(0)},D=x=>{x.key==="Escape"&&(x.preventDefault(),x.stopPropagation(),o?.())};return(0,t.jsx)(g.ZL,{children:(0,t.jsx)(a.W,{header:v,ref:h,style:y,ariaLabel:s.Tp.components.Menu.MenuComponent("Context"),onOpen:m,onClick:o,onKeyDown:D,children:P})})});i.displayName="ContextMenu"},51686:(_,L,e)=>{"use strict";e.d(L,{n:()=>s});var t=e(74848),n=e(96540),r=e(28122);const s=({children:a,renderMenuItems:g,focusOnOpen:i=!0})=>{const[l,d]=(0,n.useState)(!1),[o,u]=(0,n.useState)({x:0,y:0});return(0,t.jsxs)(t.Fragment,{children:[a({openMenu:c=>{d(!0),u({x:c.pageX,y:c.pageY-window.scrollY})}}),l&&(0,t.jsx)(r.t,{onClose:()=>d(!1),x:o.x,y:o.y,renderMenuItems:g,focusOnOpen:i})]})}},14689:(_,L,e)=>{"use strict";e.d(L,{R:()=>r});var t=e(74848),n=e(55852);function r({link:s,buttonProps:a}){return(0,t.jsx)("a",{href:s.href,target:s.target,rel:"noreferrer",onClick:s.onClick?g=>{!(g.ctrlKey||g.metaKey||g.shiftKey)&&s.onClick&&(g.preventDefault(),s.onClick(g))}:void 0,children:(0,t.jsx)(n.$n,{icon:s.target==="_blank"?"external-link-alt":"link",variant:"primary",size:"sm",...a,children:s.title})})}},64078:(_,L,e)=>{"use strict";e.d(L,{l:()=>A});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(28848),i=e.n(g),l=e(96540),d=e(80292),o=e(52845),u=e(29317),c=e(91890),p=e(6709),h=e(41781),y=e(40845),f=e(72307),v=e(40276),P=e(10354),m=e(17464),D=e(43538);class x{getBoundingClientRect(){const O=window.getSelection(),j=O&&O.anchorNode;return j&&j.parentElement?j.parentElement.getBoundingClientRect():{top:0,left:0,bottom:0,right:0,width:0,height:0,x:0,y:0,toJSON:()=>{}}}get clientWidth(){return this.getBoundingClientRect().width}get clientHeight(){return this.getBoundingClientRect().height}}const E=(S,O)=>S-O*Math.floor(S/O),C={builtInVariable:{pattern:/(\${\S+?})/}},b=[(0,h.D)({onlyIn:S=>"type"in S&&S.type==="code_block",getSyntax:()=>"links"},{...i().languages,links:C})],T=S=>({input:(0,P.n)({theme:S,invalid:!1}).input,editor:(0,n.css)({".token.builtInVariable":{color:S.colors.success.text},".token.variable":{color:S.colors.primary.text}}),suggestionsWrapper:(0,n.css)({boxShadow:S.shadows.z2}),wrapperOverrides:(0,n.css)({width:"100%","> .slate-query-field__wrapper":{padding:0,backgroundColor:"transparent",border:"none"}})}),A=(0,l.memo)(({value:S,onChange:O,suggestions:j,placeholder:B="http://your-grafana.com/d/000000010/annotations"})=>{const N=(0,l.useRef)(null),I=(0,y.of)(T),[K,w]=(0,l.useState)(!1),[U,W]=(0,l.useState)(0),[H,z]=(0,l.useState)((0,f.mO)(S)),G=(0,d.A)(H),[M,Q]=(0,l.useState)(0),Y=[(0,r.cY)(({rects:se})=>({alignmentAxis:se.reference.width})),(0,r.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:q,floatingStyles:te}=(0,s.we)({open:K,placement:"bottom-start",onOpenChange:w,middleware:Y,whileElementsMounted:a.ll,strategy:"fixed"}),X=(0,l.useRef)({showingSuggestions:K,suggestions:j,suggestionsIndex:U,linkUrl:H,onChange:O});X.current={showingSuggestions:K,suggestions:j,suggestionsIndex:U,linkUrl:H,onChange:O};const ee=(0,l.useRef)(null);(0,l.useEffect)(()=>{Q(R(ee.current,U))},[U]);const ne=l.useCallback((se,de)=>{if(!X.current.showingSuggestions){if(se.key==="="||se.key==="$"||se.keyCode===32&&se.ctrlKey){const le=new x;return q.setReference(le),w(!0)}return de()}switch(se.key){case"Backspace":X.current.linkUrl.focusText.getText().length===1&&de();case"Escape":return w(!1),W(0);case"Enter":return se.preventDefault(),ae(X.current.suggestions[X.current.suggestionsIndex]);case"ArrowDown":case"ArrowUp":se.preventDefault();const le=se.key==="ArrowDown"?1:-1;return W(he=>E(he+le,X.current.suggestions.length));default:return de()}},[]);(0,l.useEffect)(()=>{G&&G.selection.isFocused&&!H.selection.isFocused&&X.current.onChange(o.default.serialize(H))},[H,G]);const Z=l.useCallback(({value:se})=>{z(se)},[]),ae=(se,de=N.current)=>{const he=re()==="$";se.origin!==c.$0.Template||se.value===p.c.includeVars?de.insertText(`${he?"":"$"}{${se.value}}`):de.insertText(`${he?"":"$"}{${se.value}:queryparam}`),z(de.value),w(!1),W(0),X.current.onChange(o.default.serialize(de.value))},re=()=>{const se=document.getElementById("data-link-input");let de="",le,he;return window.getSelection&&(le=window.getSelection(),le&&le.rangeCount>0&&(he=le.getRangeAt(0).cloneRange(),he.collapse(!0),he.setStart(se,0),de=he.toString().slice(-1))),de};return(0,t.jsx)("div",{className:I.wrapperOverrides,children:(0,t.jsx)("div",{className:"slate-query-field__wrapper",children:(0,t.jsxs)("div",{id:"data-link-input",className:"slate-query-field",children:[K&&(0,t.jsx)(m.ZL,{children:(0,t.jsx)("div",{ref:q.setFloating,style:te,children:(0,t.jsx)(v.A,{scrollTop:M,autoHeightMax:"300px",setScrollTop:({scrollTop:se})=>Q(se),children:(0,t.jsx)(D.k,{activeRef:ee,suggestions:X.current.suggestions,onSuggestionSelect:ae,onClose:()=>w(!1),activeIndex:U})})})}),(0,t.jsx)(u.Editor,{schema:f.yx,ref:N,placeholder:B,value:X.current.linkUrl,onChange:Z,onKeyDown:(se,de,le)=>ne(se,le),plugins:b,className:(0,n.cx)(I.editor,I.input,(0,n.css)({padding:"3px 8px"}))})]})})})});A.displayName="DataLinkInput";function R(S,O){return(S?.clientHeight??0)*O}},43538:(_,L,e)=>{"use strict";e.d(L,{k:()=>o});var t=e(74848),n=e(96540),r=e(32196),s=e(2543),a=e.n(s),g=e(37151),i=e(40845),l=e(33552);const d=c=>({list:(0,r.css)({borderBottom:`1px solid ${c.colors.border.weak}`,"&:last-child":{border:"none"}}),wrapper:(0,r.css)({background:c.colors.background.primary,width:"250px"}),item:(0,r.css)({background:"none",padding:"2px 8px",userSelect:"none",color:c.colors.text.primary,cursor:"pointer","&:hover":{background:c.colors.action.hover}}),label:(0,r.css)({color:c.colors.text.secondary}),activeItem:(0,r.css)({background:c.colors.background.secondary,"&:hover":{background:c.colors.background.secondary}}),itemValue:(0,r.css)({fontFamily:c.typography.fontFamilyMonospace,fontSize:c.typography.size.sm})}),o=({suggestions:c,...p})=>{const h=(0,n.useRef)(null);(0,g.A)(h,()=>{p.onClose&&p.onClose()});const y=(0,n.useMemo)(()=>(0,s.groupBy)(c,v=>v.origin),[c]),f=(0,i.of)(d);return(0,t.jsx)("div",{role:"menu",ref:h,className:f.wrapper,children:Object.keys(y).map((v,P)=>{const m=P===0?0:Object.keys(y).reduce((D,x,E)=>E>=P?D:D+y[x].length,0);return(0,n.createElement)(u,{...p,suggestions:y[v],label:`${(0,s.capitalize)(v)}`,activeIndex:p.activeIndex,activeIndexOffset:m,key:v})})})};o.displayName="DataLinkSuggestions";const u=n.memo(({activeIndex:c,activeIndexOffset:p,label:h,onClose:y,onSuggestionSelect:f,suggestions:v,activeRef:P})=>{const m=(0,i.of)(d);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(l.B,{className:m.list,items:v,renderItem:(D,x)=>{const E=x+p===c;return(0,t.jsx)("div",{role:"menuitem",tabIndex:0,className:(0,r.cx)(m.item,E&&m.activeItem),ref:E?P:void 0,onClick:()=>{f(D)},title:D.documentation,children:(0,t.jsxs)("span",{className:m.itemValue,children:[(0,t.jsx)("span",{className:m.label,children:h})," ",D.label]})})}})})});u.displayName="DataLinkSuggestionsList"},59796:(_,L,e)=>{"use strict";e.d(L,{e:()=>l});var t=e(74848),n=e(32196),r=e(13544),s=e(14555),a=e(51686),g=e(59093),i=e(64539);const l=({children:d,links:o,style:u})=>{const c=[{items:(0,s.J)(o),label:"Data links"}],p=c[0].items.length,h=()=>c.map((f,v)=>(0,t.jsx)(g.r,{label:f.label,children:(f.items||[]).map((P,m)=>(0,t.jsx)(i.D,{url:P.url,label:P.label,target:P.target,icon:P.icon,active:P.active,onClick:P.onClick},`${f.label}-${v}-${m}}`))},`${f.label}${v}`)),y=(0,n.css)({cursor:"context-menu"});if(p>1)return(0,t.jsx)(a.n,{renderMenuItems:h,children:({openMenu:f})=>d({openMenu:f,targetClassName:y})});{const f=o()[0];return(0,t.jsx)("a",{href:f.href,onClick:f.onClick,target:f.target,title:f.title,style:{...u,overflow:"hidden",display:"flex"},"data-testid":r.Tp.components.DataLinksContextMenu.singleLink,children:d({})})}}},64919:(_,L,e)=>{"use strict";e.d(L,{e:()=>E});var t=e(74848),n=e(32196),r=e(91076),s=e(2543),a=e(96540),g=e(40845),i=e(55852),l=e(37390),d=e(14555),o=e(88575),u=e(10354),c=e(15292),p=e(64078);const h=b=>({listItem:(0,n.css)({marginBottom:b.spacing()}),infoText:(0,n.css)({paddingBottom:b.spacing(2),marginLeft:"66px",color:b.colors.text.secondary})}),y=(0,a.memo)(({index:b,value:T,onChange:A,suggestions:R,isLast:S})=>{const O=(0,g.of)(h),j=(I,K)=>{A(b,{...T,url:I},K)},B=I=>{A(b,{...T,title:I.target.value})},N=()=>{A(b,{...T,targetBlank:!T.targetBlank})};return(0,t.jsxs)("div",{className:O.listItem,children:[(0,t.jsx)(o.D,{label:"Title",children:(0,t.jsx)(u.p,{value:T.title,onChange:B,placeholder:"Show details"})}),(0,t.jsx)(o.D,{label:"URL",invalid:(0,d.F)(T.url),error:"Data link is an Explore URL in a deprecated format. Please visit the URL to be redirected, and edit this data link to use that URL.",children:(0,t.jsx)(p.l,{value:T.url,onChange:j,suggestions:R})}),(0,t.jsx)(o.D,{label:"Open in new tab",children:(0,t.jsx)(c.d,{value:T.targetBlank||!1,onChange:N})}),S&&(0,t.jsx)("div",{className:O.infoText,children:"With data links you can reference data variables like series name, labels and values. Type CMD+Space, CTRL+Space, or $ to open variable suggestions."})]})});y.displayName="DataLinkEditor";const f=({link:b,index:T,getSuggestions:A,onSave:R,onCancel:S})=>{const[O,j]=(0,a.useState)(b);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y,{value:O,index:T,isLast:!1,suggestions:A(),onChange:(B,N)=>{j(N)}}),(0,t.jsxs)(l.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:()=>S(T),fill:"outline",children:"Cancel"}),(0,t.jsx)(i.$n,{onClick:()=>{R(T,O)},children:"Save"})]})]})};var v=e(72093),P=e(14578),m=e(29158);const D=({link:b,onEdit:T,onRemove:A,index:R,itemKey:S})=>{const O=(0,g.of)(x),{title:j="",url:B=""}=b,N=j.trim()!=="",I=B.trim()!=="",K=(0,d.F)(B);return(0,t.jsx)(r.sx,{draggableId:S,index:R,children:w=>(0,t.jsx)(t.Fragment,{children:(0,a.createElement)("div",{className:(0,n.cx)(O.wrapper,O.dragRow),ref:w.innerRef,...w.draggableProps,key:R},(0,t.jsxs)("div",{className:O.linkDetails,children:[(0,t.jsx)("div",{className:(0,n.cx)(O.url,!I&&O.notConfigured,K&&O.errored),children:N?j:"Data link title not provided"}),(0,t.jsx)("div",{className:(0,n.cx)(O.url,!I&&O.notConfigured,K&&O.errored),title:B,children:I?B:"Data link url not provided"}),K&&(0,t.jsx)(v.P,{children:"Explore data link may not work in the future. Please edit."})]}),(0,t.jsxs)("div",{className:O.icons,children:[(0,t.jsx)(m.K,{name:"pen",onClick:T,className:O.icon,tooltip:"Edit data link"}),(0,t.jsx)(m.K,{name:"trash-alt",onClick:A,className:O.icon,tooltip:"Remove data link"}),(0,t.jsx)("div",{className:O.dragIcon,...w.dragHandleProps,children:(0,t.jsx)(P.I,{name:"draggabledots",size:"lg"})})]}))})},S)},x=b=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:b.shape.radius.default,background:b.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1,maxWidth:"calc(100% - 100px)"}),errored:(0,n.css)({color:b.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:b.colors.text.primary,fontSize:b.typography.size.sm,fontWeight:b.typography.fontWeightMedium}),url:(0,n.css)({color:b.colors.text.secondary,fontSize:b.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8}),dragIcon:(0,n.css)({cursor:"grab",color:b.colors.text.secondary,margin:b.spacing(0,.5)}),icon:(0,n.css)({color:b.colors.text.secondary})}),E=({links:b,onChange:T,getSuggestions:A,data:R,showOneClick:S=!1})=>{const[O,j]=(0,a.useState)(null),[B,N]=(0,a.useState)(!1),[I,K]=(0,a.useState)([]);(0,a.useEffect)(()=>{K(b??[])},[b]);const w=(0,g.of)(C),U=O!==null,W=(Y,q)=>{if(B)if(q.title.trim()===""&&q.url.trim()===""){N(!1),j(null);return}else j(null),N(!1);const te=(0,s.cloneDeep)(I);te[Y]=q,T(te),j(null)},H=()=>{let Y=(0,s.cloneDeep)(I);j(Y.length),N(!0)},z=Y=>{B&&N(!1),j(null)},G=Y=>{const q=(0,s.cloneDeep)(I);q.splice(Y,1),T(q)},M=Y=>{if(!b||!Y.destination)return;const q=(0,s.cloneDeep)(I),te=q[Y.source.index];q.splice(Y.source.index,1),q.splice(Y.destination.index,0,te),K(q),T(q)},Q=(Y,q)=>S?(0,t.jsxs)("div",{className:w.oneClickOverlay,children:[(0,t.jsx)("span",{className:w.oneClickSpan,children:"One-click link"}),Y]},q):Y;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.JY,{onDragEnd:M,children:(0,t.jsx)(r.gL,{droppableId:"sortable-links",direction:"vertical",children:Y=>(0,t.jsxs)("div",{className:w.wrapper,ref:Y.innerRef,...Y.droppableProps,children:[I.map((q,te)=>{const X=`${q.title}/${te}`,ee=(0,t.jsx)("div",{className:w.itemWrapper,children:(0,t.jsx)(D,{index:te,link:q,onChange:W,onEdit:()=>j(te),onRemove:()=>G(te),data:R,itemKey:X},X)},X);return te===0?Q(ee,X):ee}),Y.placeholder]})})}),U&&O!==null&&(0,t.jsx)(l.a,{title:"Edit link",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{z(O)},children:(0,t.jsx)(f,{index:O,link:B?{title:"",url:""}:I[O],data:R,onSave:W,onCancel:z,getSuggestions:A})}),(0,t.jsx)(i.$n,{size:"sm",icon:"plus",onClick:H,variant:"secondary",className:w.button,children:"Add link"})]})},C=b=>({wrapper:(0,n.css)({marginBottom:b.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,n.css)({height:"auto",border:`2px dashed ${b.colors.text.link}`,fontSize:10,color:b.colors.text.primary,marginBottom:b.spacing(1)}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,n.css)({padding:"4px 8px 8px 8px"}),button:(0,n.css)({marginLeft:b.spacing(1)})})},28623:(_,L,e)=>{"use strict";e.d(L,{K:()=>i});var t=e(74848),n=e(55852),r=e(14186),s=e(39268),a=e(10354),g=e(21744);const i=({hasCert:l,label:d,onChange:o,onClick:u,placeholder:c})=>(0,t.jsxs)(s.C,{children:[(0,t.jsx)(r.I,{label:d,labelWidth:14,disabled:l,children:l?(0,t.jsx)(a.p,{type:"text",value:"configured",width:24}):(0,t.jsx)(g.f,{rows:7,onChange:o,placeholder:c,required:!0})}),l&&(0,t.jsx)(n.$n,{variant:"secondary",onClick:u,style:{marginLeft:4},children:"Reset"})]})},11184:(_,L,e)=>{"use strict";e.d(L,{P:()=>p});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(40845),i=e(55852),l=e(90090),d=e(14578),o=e(56286);const u=()=>({layout:(0,n.css)({display:"flex",alignItems:"center",marginBottom:"4px","> *":{marginLeft:"4px",marginBottom:0,height:"100%","&:first-child, &:last-child":{marginLeft:0}}})}),c=({header:y,onBlur:f,onChange:v,onRemove:P,onReset:m})=>{const D=(0,g.of)(u);return(0,t.jsxs)("div",{className:D.layout,children:[(0,t.jsx)(l.z,{label:"Header",name:"name",placeholder:"X-Custom-Header",labelWidth:5,value:y.name||"",onChange:x=>v({...y,name:x.target.value}),onBlur:f}),(0,t.jsx)(o.L,{label:"Value","aria-label":"Value",name:"value",isConfigured:y.configured,value:y.value,labelWidth:5,inputWidth:y.configured?11:12,placeholder:"Header Value",onReset:()=>m(y.id),onChange:x=>v({...y,value:x.target.value}),onBlur:f}),(0,t.jsx)(i.$n,{type:"button","aria-label":"Remove header",variant:"secondary",size:"xs",onClick:x=>P(y.id),children:(0,t.jsx)(d.I,{name:"trash-alt"})})]})};c.displayName="CustomHeaderRow";class p extends a.PureComponent{constructor(f){super(f),this.state={headers:[]},this.updateSettings=()=>{const{headers:D}=this.state,x=Object.fromEntries(Object.entries(this.props.dataSourceConfig.jsonData).filter(([C,b])=>!C.startsWith("httpHeaderName"))),E=Object.fromEntries(Object.entries(this.props.dataSourceConfig.secureJsonData||{}).filter(([C,b])=>!C.startsWith("httpHeaderValue")));for(const[C,b]of D.entries())x[`httpHeaderName${C+1}`]=b.name,b.configured||(E[`httpHeaderValue${C+1}`]=b.value);this.props.onChange({...this.props.dataSourceConfig,jsonData:x,secureJsonData:E})},this.onHeaderAdd=()=>{this.setState(D=>({headers:[...D.headers,{id:(0,r.uniqueId)(),name:"",value:"",configured:!1}]}))},this.onHeaderChange=(D,x)=>{this.setState(({headers:E})=>({headers:E.map((C,b)=>D!==b?C:{...x})}))},this.onHeaderReset=D=>{this.setState(({headers:x})=>({headers:x.map((E,C)=>E.id!==D?E:{...E,value:"",configured:!1})}))},this.onHeaderRemove=D=>{this.setState(({headers:x})=>({headers:x.filter(E=>E.id!==D)}),this.updateSettings)};const{jsonData:v,secureJsonData:P,secureJsonFields:m}=this.props.dataSourceConfig;this.state={headers:Object.keys(v).sort().filter(D=>D.startsWith("httpHeaderName")).map((D,x)=>({id:(0,r.uniqueId)(),name:v[D],value:P!==void 0?P[D]:"",configured:m&&m[`httpHeaderValue${x+1}`]||!1}))}}render(){const{headers:f}=this.state,{dataSourceConfig:v}=this.props;return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)("h6",{children:"Custom HTTP Headers"})}),(0,t.jsx)("div",{children:f.map((P,m)=>(0,t.jsx)(c,{header:P,onChange:D=>{this.onHeaderChange(m,D)},onBlur:this.updateSettings,onRemove:this.onHeaderRemove,onReset:this.onHeaderReset},P.id))}),!v.readOnly&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.$n,{variant:"secondary",icon:"plus",type:"button",onClick:P=>{this.onHeaderAdd()},children:"Add header"})})]})}}var h=null},91409:(_,L,e)=>{"use strict";e.d(L,{t:()=>R});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(42418),i=e(90090),l=e(38894),d=e(14186),o=e(91634),u=e(14578),c=e(90182),p=e(15292),h=e(79924),y=e(94753),f=e(56286);const v=({dataSourceConfig:S,onChange:O})=>{const j=S.secureJsonData?S.secureJsonData.basicAuthPassword:"",B=()=>{O({...S,secureJsonData:{...S.secureJsonData,basicAuthPassword:""},secureJsonFields:{...S.secureJsonFields,basicAuthPassword:!1}})},N=I=>{O({...S,secureJsonData:{...S.secureJsonData,basicAuthPassword:I.currentTarget.value}})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.I,{disabled:S.readOnly,children:(0,t.jsx)(i.z,{label:"User",labelWidth:10,inputWidth:18,placeholder:"user",value:S.basicAuthUser,onChange:I=>O({...S,basicAuthUser:I.currentTarget.value})})}),(0,t.jsx)(d.I,{disabled:S.readOnly,children:(0,t.jsx)(f.L,{isConfigured:!!(S.secureJsonFields&&S.secureJsonFields.basicAuthPassword),value:j||"",inputWidth:18,labelWidth:10,onReset:B,onChange:N})})]})};var P=e(11184);const m=26,D=({dataSourceConfig:S,onChange:O,showForwardOAuthIdentityOption:j=!0})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(d.I,{label:"TLS Client Auth",labelWidth:m,disabled:S.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-tls-client-auth",value:S.jsonData.tlsAuth||!1,onChange:B=>O({...S.jsonData,tlsAuth:B.currentTarget.checked})})}),(0,t.jsx)(d.I,{label:"With CA Cert",tooltip:"Needed for verifying self-signed TLS Certs",labelWidth:m,disabled:S.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-ca-cert",value:S.jsonData.tlsAuthWithCACert||!1,onChange:B=>O({...S.jsonData,tlsAuthWithCACert:B.currentTarget.checked})})})]}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Skip TLS Verify",labelWidth:m,disabled:S.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-skip-tls-verify",value:S.jsonData.tlsSkipVerify||!1,onChange:B=>O({...S.jsonData,tlsSkipVerify:B.currentTarget.checked})})})}),j&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Forward OAuth Identity",tooltip:"Forward the user's upstream OAuth identity to the data source (Their access token gets passed along).",labelWidth:m,disabled:S.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-forward-oauth",value:S.jsonData.oauthPassThru||!1,onChange:B=>O({...S.jsonData,oauthPassThru:B.currentTarget.checked})})})})]});var x=e(17081),E=e(95180);const C=[{label:"Server (default)",value:"proxy"},{label:"Browser",value:"direct"}],b={label:"Server (default)",value:"proxy"},T=()=>(0,t.jsxs)(g.F,{severity:"info",title:"",topSpacing:3,children:[(0,t.jsxs)("p",{children:["Access mode controls how requests to the data source will be handled.",(0,t.jsxs)("strong",{children:["\xA0",(0,t.jsx)("i",{children:"Server"})]})," ","should be the preferred way if nothing else is stated."]}),(0,t.jsx)(y.E,{weight:"medium",children:"Server access mode (Default):"}),(0,t.jsx)("p",{children:"All requests will be made from the browser to Grafana backend/server which in turn will forward the requests to the data source and by that circumvent possible Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the grafana backend/server if you select this access mode."}),(0,t.jsx)(y.E,{weight:"medium",children:"Browser access mode:"}),(0,t.jsx)("p",{children:"All requests will be made from the browser directly to the data source and may be subject to Cross-Origin Resource Sharing (CORS) requirements. The URL needs to be accessible from the browser if you select this access mode."})]}),A=26,R=S=>{const{defaultUrl:O,dataSourceConfig:j,onChange:B,showAccessOptions:N,sigV4AuthToggleEnabled:I,showForwardOAuthIdentityOption:K,azureAuthSettings:w,renderSigV4Editor:U,secureSocksDSProxyEnabled:W,urlLabel:H,urlDocs:z}=S,[G,M]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(!1),q=(0,a.$j)();let te;const X=(0,r.useCallback)(de=>{const le=w?.azureAuthSupported&&w.getAzureAuthEnabled(j)||!1;if(Y(le),le){const he=j.jsonData.oauthPassThru!==void 0?j.jsonData.oauthPassThru:!1;de={...de,jsonData:{...j.jsonData,oauthPassThru:le?!1:he}}}B({...j,...de})},[w,j,B]);switch(j.access){case"direct":te=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Browser"}),", this means the URL needs to be accessible from the browser.",z]});break;case"proxy":te=(0,t.jsxs)(t.Fragment,{children:["Your access method is ",(0,t.jsx)("em",{children:"Server"}),", this means the URL needs to be accessible from the grafana backend/server.",z]});break;default:te=(0,t.jsxs)(t.Fragment,{children:["Specify a complete HTTP URL (for example http://your_server:8080) ",z]})}const ee=(0,t.jsx)(c.l6,{"aria-label":"Access",className:"width-20 gf-form-input",options:C,value:C.filter(de=>de.value===j.access)[0]||b,onChange:de=>X({access:de.value}),disabled:j.readOnly}),ne=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/.test(j.url),Z=(0,n.css)({boxShadow:`inset 0 0px 5px ${q.v1.palette.red}`}),ae=(0,n.cx)({"width-20":!0,[Z]:!ne}),re=(0,r.useId)(),se=(0,t.jsx)(o.p,{id:re,className:ae,placeholder:O,value:j.url,"data-testid":s.Tp.components.DataSource.DataSourceHttpSettings.urlInput,onChange:de=>X({url:de.currentTarget.value}),disabled:j.readOnly});return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"HTTP"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{interactive:!!z,label:H??"URL",labelWidth:13,tooltip:te,inputEl:se})}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"Access",labelWidth:13,inputWidth:20,inputEl:ee})}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("button",{type:"button",className:"gf-form-label query-keyword pointer",onClick:()=>M(de=>!de),children:["Help\xA0",(0,t.jsx)(u.I,{name:G?"angle-down":"angle-right",style:{marginBottom:0}})]})})]}),G&&(0,t.jsx)(T,{})]}),j.access==="proxy"&&(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(l.I,{width:13,tooltip:"Grafana proxy deletes forwarded cookies by default. Specify cookies by name that should be forwarded to the data source.",children:"Allowed cookies"}),(0,t.jsx)(h.u,{tags:j.jsonData.keepCookies,width:40,onChange:de=>X({jsonData:{...j.jsonData,keepCookies:de}}),disabled:j.readOnly})]}),(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(i.z,{label:"Timeout",type:"number",labelWidth:13,inputWidth:20,tooltip:"HTTP request timeout in seconds",placeholder:"Timeout in seconds","aria-label":"Timeout in seconds",value:j.jsonData.timeout,onChange:de=>{X({jsonData:{...j.jsonData,timeout:parseInt(de.currentTarget.value,10)}})},disabled:j.readOnly})})]})]})]}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Auth"}),(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:"gf-form-inline",children:[(0,t.jsx)(d.I,{label:"Basic auth",labelWidth:A,disabled:j.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-basic-auth",value:j.basicAuth,onChange:de=>{X({basicAuth:de.currentTarget.checked})}})}),(0,t.jsx)(d.I,{label:"With Credentials",tooltip:"Whether credentials such as cookies or auth headers should be sent with cross-site requests.",labelWidth:A,disabled:j.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-with-credentials",value:j.withCredentials,onChange:de=>{X({withCredentials:de.currentTarget.checked})}})})]}),w?.azureAuthSupported&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"Azure Authentication",tooltip:"Use Azure authentication for Azure endpoint.",labelWidth:A,disabled:j.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-azure-auth",value:Q,onChange:de=>{X(w.setAzureAuthEnabled(j,de.currentTarget.checked))}})})}),I&&(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)(d.I,{label:"SigV4 auth",labelWidth:A,disabled:j.readOnly,children:(0,t.jsx)(p.K,{id:"http-settings-sigv4-auth",value:j.jsonData.sigV4Auth||!1,onChange:de=>{X({jsonData:{...j.jsonData,sigV4Auth:de.currentTarget.checked}})}})})}),j.access==="proxy"&&(0,t.jsx)(D,{dataSourceConfig:j,onChange:de=>X({jsonData:de}),showForwardOAuthIdentityOption:Q?!1:K})]}),j.basicAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h6",{children:"Basic Auth Details"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)(v,{...S})})]}),w?.azureAuthSupported&&Q&&w.azureSettingsUI&&(0,t.jsx)(w.azureSettingsUI,{dataSourceConfig:j,onChange:B}),j.jsonData.sigV4Auth&&I&&U,(j.jsonData.tlsAuth||j.jsonData.tlsAuthWithCACert)&&(0,t.jsx)(E.j,{dataSourceConfig:j,onChange:B}),j.access==="proxy"&&(0,t.jsx)(P.P,{dataSourceConfig:j,onChange:B})]}),W&&(0,t.jsx)(x.Y,{options:j,onOptionsChange:B})]})}},17081:(_,L,e)=>{"use strict";e.d(L,{Y:()=>s});var t=e(74848),n=e(15292),r=e(14186);function s({options:a,onOptionsChange:g}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h3",{className:"page-heading",children:"Secure Socks Proxy"}),(0,t.jsx)("div",{className:"gf-form-group",children:(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(r.I,{labelWidth:26,label:"Enabled",tooltip:"Connect to this datasource via the secure socks proxy.",children:(0,t.jsx)(n.K,{value:a.jsonData.enableSecureSocksProxy??!1,onChange:i=>g({...a,jsonData:{...a.jsonData,enableSecureSocksProxy:i.currentTarget.checked}})})})})})})]})}},95180:(_,L,e)=>{"use strict";e.d(L,{j:()=>i});var t=e(74848),n=e(32196),r=e(90090),s=e(14578),a=e(56034),g=e(28623);const i=({dataSourceConfig:l,onChange:d})=>{const o=l.secureJsonFields&&l.secureJsonFields.tlsCACert,u=l.secureJsonFields&&l.secureJsonFields.tlsClientCert,c=l.secureJsonFields&&l.secureJsonFields.tlsClientKey,p=l.jsonData&&l.jsonData.serverName,h=v=>P=>{P.preventDefault();const m={...l.secureJsonFields};m[v]=!1,d({...l,secureJsonFields:m})},y=v=>P=>{const m={...l.secureJsonData};m[v]=P.currentTarget.value,d({...l,secureJsonData:m})},f=v=>{const P={...l.jsonData,serverName:v.currentTarget.value};d({...l,jsonData:P})};return(0,t.jsxs)("div",{className:"gf-form-group",children:[(0,t.jsxs)("div",{className:(0,n.cx)("gf-form",(0,n.css)({alignItems:"baseline"})),children:[(0,t.jsx)("h6",{children:"TLS/SSL Auth Details"}),(0,t.jsx)(a.m,{placement:"right-end",content:"TLS/SSL Certs are encrypted and stored in the Grafana database.",theme:"info",children:(0,t.jsx)(s.I,{name:"info-circle",size:"xs",style:{marginLeft:"10px"}})})]}),(0,t.jsxs)("div",{children:[l.jsonData.tlsAuthWithCACert&&(0,t.jsx)(g.K,{hasCert:!!o,onChange:y("tlsCACert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",label:"CA Cert",onClick:h("tlsCACert")}),l.jsonData.tlsAuth&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsx)(r.z,{label:"ServerName",labelWidth:7,inputWidth:30,placeholder:"domain.example.com",value:p&&l.jsonData.serverName,onChange:f})}),(0,t.jsx)(g.K,{hasCert:!!u,label:"Client Cert",onChange:y("tlsClientCert"),placeholder:"Begins with -----BEGIN CERTIFICATE-----",onClick:h("tlsClientCert")}),(0,t.jsx)(g.K,{hasCert:!!c,label:"Client Key",placeholder:"Begins with -----BEGIN RSA PRIVATE KEY-----",onChange:y("tlsClientKey"),onClick:h("tlsClientKey")})]})]})]})}},56181:(_,L,e)=>{"use strict";e.d(L,{l:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(21497),a=e(40845),g=e(8866),i=e(14578),l=e(72265);const d=(0,r.memo)(c=>{const p=(0,a.of)(u),{isOpen:h,onClose:y}=c;return h?(0,t.jsx)(g.N,{useCapture:!0,includeButtonPress:!1,onClick:y,children:(0,t.jsx)("div",{className:p.modal,"data-testid":"date-picker",children:(0,t.jsx)(o,{...c})})}):null});d.displayName="DatePicker";const o=(0,r.memo)(({value:c,minDate:p,maxDate:h,onChange:y})=>{const f=(0,a.of)(l.h2);return(0,t.jsx)(s.Ay,{className:f.body,tileClassName:f.title,value:c||new Date,minDate:p,maxDate:h,nextLabel:(0,t.jsx)(i.I,{name:"angle-right"}),prevLabel:(0,t.jsx)(i.I,{name:"angle-left"}),onChange:v=>{v&&!Array.isArray(v)&&y(v)},locale:"en"})});o.displayName="Body";const u=c=>({modal:(0,n.css)({zIndex:c.zIndex.modal,boxShadow:c.shadows.z3,backgroundColor:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`,borderTopLeftRadius:c.shape.radius.default,borderBottomLeftRadius:c.shape.radius.default,"button:disabled":{color:c.colors.text.disabled}})})},98239:(_,L,e)=>{"use strict";e.d(L,{l:()=>c});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(96540),i=e(47232),l=e(40845),d=e(10354),o=e(56181);const u=h=>(0,i.KQ)(h).format("L"),c=({value:h,minDate:y,maxDate:f,onChange:v,closeOnSelect:P,placeholder:m="Date",...D})=>{const[x,E]=(0,g.useState)(!1),C=(0,l.of)(p),b=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:T,refs:A,floatingStyles:R}=(0,s.we)({open:x,placement:"bottom-start",onOpenChange:E,middleware:b,whileElementsMounted:a.ll,strategy:"fixed"}),S=(0,s.kp)(T),O=(0,s.s9)(T),{getReferenceProps:j,getFloatingProps:B}=(0,s.bv)([O,S]);return(0,t.jsxs)("div",{className:C.container,children:[(0,t.jsx)(d.p,{ref:A.setReference,type:"text",autoComplete:"off",placeholder:m,value:h&&u(h),onChange:N=>{N.target.value===""&&v("")},className:C.input,...D,...j()}),(0,t.jsx)("div",{className:C.popover,ref:A.setFloating,style:R,...B(),children:(0,t.jsx)(o.l,{isOpen:x,value:h&&typeof h!="string"?h:(0,i.KQ)().toDate(),minDate:y,maxDate:f,onChange:N=>{v(N),P&&E(!1)},onClose:()=>E(!1)})})]})},p=h=>({container:(0,n.css)({position:"relative"}),input:(0,n.css)({"input[type='date']::-webkit-inner-spin-button, input[type='date']::-webkit-calendar-picker-indicator":{display:"none",WebkitAppearance:"none"}}),popover:(0,n.css)({zIndex:h.zIndex.tooltip})})},63383:(_,L,e)=>{"use strict";e.d(L,{K:()=>S});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),o=e(21497),u=e(49045),c=e(72724),p=e(47232),h=e(1933),y=e(13390),f=e(40845),v=e(55852),P=e(14186),m=e(14578),D=e(10354),x=e(67061),E=e(88448),C=e(17464),b=e(66070),T=e(72265),A=e(47619),R=e(99225);const S=({date:N,maxDate:I,minDate:K,label:w,onChange:U,disabledHours:W,disabledMinutes:H,disabledSeconds:z,timeZone:G,showSeconds:M=!0,clearable:Q=!1})=>{const[Y,q]=(0,d.useState)(!1),te=(0,d.useRef)(null),{overlayProps:X,underlayProps:ee}=(0,l.e)({onClose:()=>q(!1),isDismissable:!0,isOpen:Y,shouldCloseOnInteractOutside:ce=>{const pe=document.getElementsByClassName(b.i)[0];return!(pe&&pe.contains(ce))}},te),{dialogProps:ne}=(0,g.s)({},te),Z=(0,f.$j)(),{modalBackdrop:ae}=(0,f.of)(E.o),re=(0,u.A)(`(min-width: ${Z.breakpoints.values.lg}px)`),se=(0,f.of)(B),de=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:le,floatingStyles:he}=(0,s.we)({open:Y,placement:"bottom-start",onOpenChange:q,middleware:de,whileElementsMounted:a.ll,strategy:"fixed"}),ie=(0,d.useCallback)(ce=>{q(!1),U(ce)},[U]),J=(0,d.useCallback)(ce=>{ce.preventDefault(),q(!0)},[q]);return(0,t.jsxs)("div",{"data-testid":"date-time-picker",style:{position:"relative"},children:[(0,t.jsx)(O,{date:N,onChange:U,isFullscreen:re,onOpen:J,label:w,ref:le.setReference,showSeconds:M,clearable:Q,timeZone:G}),Y?re?(0,t.jsx)(C.ZL,{children:(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:te,...X,...ne,children:(0,t.jsx)(j,{date:N,onChange:ie,isFullscreen:!0,onClose:()=>q(!1),maxDate:I,minDate:K,ref:le.setFloating,style:he,showSeconds:M,disabledHours:W,disabledMinutes:H,disabledSeconds:z,timeZone:G})})})}):(0,t.jsxs)(C.ZL,{children:[(0,t.jsx)("div",{className:ae,...ee}),(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:te,...X,...ne,children:(0,t.jsx)("div",{className:se.modal,children:(0,t.jsx)(j,{date:N,maxDate:I,minDate:K,onChange:ie,isFullscreen:!1,onClose:()=>q(!1),showSeconds:M,disabledHours:W,disabledMinutes:H,disabledSeconds:z,timeZone:G})})})})]}):null]})},O=d.forwardRef(({date:N,label:I,onChange:K,onOpen:w,timeZone:U,showSeconds:W=!0,clearable:H=!1},z)=>{const G=(0,f.of)(B),M=W?"YYYY-MM-DD HH:mm:ss":"YYYY-MM-DD HH:mm",[Q,Y]=(0,d.useState)(()=>({value:N?(0,c.LE)(N,{timeZone:U}):H?"":(0,c.LE)((0,p.KQ)(),{timeZone:U}),invalid:!1}));(0,d.useEffect)(()=>{if(N){const ne=(0,c.LE)(N,{format:M,timeZone:U});Y({invalid:!(0,A.f)(ne),value:(0,p.Ar)(N)?ne:N})}},[N,M,U]);const q=(0,d.useCallback)(ne=>{const Z=!(0,A.f)(ne.currentTarget.value);Y({value:ne.currentTarget.value,invalid:Z})},[]),te=(0,d.useCallback)(()=>{if(!Q.invalid&&Q.value){const ne=(0,p.oZ)((0,h.O)({timeZone:U}),Q.value);K(ne)}},[Q,K,U]),X=(0,d.useCallback)(()=>{Y({value:"",invalid:!1}),K()},[K]),ee=(0,t.jsx)(v.$n,{"aria-label":"Time picker",icon:"calendar-alt",variant:"secondary",onClick:w});return(0,t.jsx)(P.I,{label:I,invalid:!!(Q.value&&Q.invalid),className:G.field,children:(0,t.jsx)(D.p,{onChange:q,addonAfter:ee,value:Q.value,onBlur:te,"data-testid":y.X.DateTimePicker.input,placeholder:"Select date/time",ref:z,suffix:H&&Q.value&&(0,t.jsx)(m.I,{name:"times",className:G.clearIcon,onClick:X})})})});O.displayName="DateTimeInput";const j=d.forwardRef(({date:N,onClose:I,onChange:K,isFullscreen:w,maxDate:U,minDate:W,style:H,showSeconds:z=!0,disabledHours:G,disabledMinutes:M,disabledSeconds:Q,timeZone:Y},q)=>{const te=(0,f.of)(T.h2),X=(0,f.of)(B),[ee,ne]=(0,d.useState)(()=>N&&N.isValid()?(0,p.oZ)((0,h.O)({timeZone:Y}),N):(0,p.oZ)((0,h.O)({timeZone:Y}),new Date)),[Z,ae]=(0,d.useState)(()=>N&&N.isValid()?(0,R.Q)(N.toDate(),(0,h.O)({timeZone:Y})):(0,R.Q)(new Date,(0,h.O)({timeZone:Y}))),re=(0,d.useCallback)(le=>{le&&!Array.isArray(le)&&ae(le)},[]),se=(0,d.useCallback)(le=>{ne(le)},[]),de=()=>{const le=(0,p.KQ)(ee);le.set("date",Z.getDate()),le.set("month",Z.getMonth()),le.set("year",Z.getFullYear()),K(le)};return(0,t.jsxs)("div",{className:(0,n.cx)(X.container,{[X.fullScreen]:w}),style:H,ref:q,children:[(0,t.jsx)(o.Ay,{next2Label:null,prev2Label:null,value:Z,nextLabel:(0,t.jsx)(m.I,{name:"angle-right"}),nextAriaLabel:"Next month",prevLabel:(0,t.jsx)(m.I,{name:"angle-left"}),prevAriaLabel:"Previous month",onChange:re,locale:"en",className:te.body,tileClassName:te.title,maxDate:U,minDate:W}),(0,t.jsx)("div",{className:X.time,children:(0,t.jsx)(b.R,{showSeconds:z,onChange:se,value:ee,disabledHours:G,disabledMinutes:M,disabledSeconds:Q})}),(0,t.jsxs)(x.B,{children:[(0,t.jsx)(v.$n,{type:"button",onClick:de,children:"Apply"}),(0,t.jsx)(v.$n,{variant:"secondary",type:"button",onClick:I,children:"Cancel"})]})]})});j.displayName="DateTimeCalendar";const B=N=>({container:(0,n.css)({padding:N.spacing(1),border:`1px ${N.colors.border.weak} solid`,borderRadius:N.shape.radius.default,backgroundColor:N.colors.background.primary,zIndex:N.zIndex.modal}),fullScreen:(0,n.css)({position:"absolute"}),time:(0,n.css)({marginBottom:N.spacing(2)}),modal:(0,n.css)({position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:N.zIndex.modal,maxWidth:"280px"}),clearIcon:(0,n.css)({cursor:"pointer"}),field:(0,n.css)({marginBottom:0,width:"100%"})})},5308:(_,L,e)=>{"use strict";e.d(L,{N:()=>B});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),o=e(40845),u=e(76412),c=e(55852),p=e(40276),h=e(88575),y=e(14578),f=e(10354),v=e(56034),P=e(64998),m=e(11752),D=e(32432);const x=/^now$|^now(\-|\+)(\d{1,10})([wdhms])$/,E=U=>({from:A(U.from),to:A(U.to)}),C=U=>{const W=S(U.from),H=S(U.to);return{from:W,to:H,display:`${W} to ${H}`}},b=(U,W=Date.now())=>T(U)?A(U)>Math.ceil(W/1e3)?{isValid:!1,errorMessage:"Can not enter value prior to January 1, 1970."}:{isValid:!0}:{isValid:!1,errorMessage:"Value not in relative time format."},T=U=>x.test(U),A=U=>{const W=x.exec(U);if(!W||W.length!==4)return 0;const[,H,z,G]=W,M=parseInt(z,10);if(isNaN(M))return 0;const Q=M*R[G];return H==="+"?Q*-1:Q},R={w:604800,d:86400,h:3600,m:60,s:1},S=U=>{if(U===0)return"now";const W=Math.abs(U);return U<0?`now+${O(W)}`:`now-${O(W)}`};function O(U){const W=[{unit:"w",value:604800},{unit:"d",value:86400},{unit:"h",value:3600},{unit:"m",value:60},{unit:"s",value:1}];for(const{unit:z,value:G}of W)if(U%G===0)return`${U/G}${z}`;const H=W[W.length-1];return`${U}${H.unit}`}const j=D.o.filter(U=>T(U.from));function B(U){const{timeRange:W,onChange:H}=U,[z,G]=(0,d.useState)(!1),M=(0,d.useCallback)(()=>G(!1),[]),Q=C(W),[Y,q]=(0,d.useState)({value:Q.from,validation:b(Q.from)}),[te,X]=(0,d.useState)({value:Q.to,validation:b(Q.to)}),ee=(0,d.useRef)(null),{overlayProps:ne,underlayProps:Z}=(0,l.e)({onClose:()=>G(!1),isDismissable:!0,isOpen:z},ee),{dialogProps:ae}=(0,g.s)({},ee),re=[(0,r.UU)({crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:se,refs:de,floatingStyles:le}=(0,s.we)({open:z,placement:"bottom-start",onOpenChange:G,middleware:re,whileElementsMounted:a.ll,strategy:"fixed"}),he=(0,s.kp)(se),ie=(0,s.s9)(se),{getReferenceProps:J,getFloatingProps:ce}=(0,s.bv)([ie,he]),pe=(0,o.of)(K(Y.validation.errorMessage,te.validation.errorMessage)),Pe=Se=>{const De=E(Se);De&&(M(),q({...Y,value:Se.from}),X({...te,value:Se.to}),H(De))},Ie=(0,d.useCallback)(Se=>{Se.stopPropagation(),Se.preventDefault(),G(!z)},[z]),ge=Se=>{if(Se.preventDefault(),!te.validation.isValid||!Y.validation.isValid)return;const De=E({from:Y.value,to:te.value,display:""});De&&(H(De),G(!1))};return(0,t.jsxs)("div",{className:pe.container,children:[(0,t.jsxs)("button",{ref:de.setReference,className:pe.pickerInput,type:"button",onClick:Ie,...J(),children:[(0,t.jsx)("span",{className:pe.clockIcon,children:(0,t.jsx)(y.I,{name:"clock-nine"})}),(0,t.jsxs)("span",{children:[Q.from," to ",Q.to]}),(0,t.jsx)("span",{className:pe.caretIcon,children:(0,t.jsx)(y.I,{name:z?"angle-up":"angle-down",size:"lg"})})]}),z&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{role:"presentation",className:pe.backdrop,...Z}),(0,t.jsx)(i.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{ref:ee,...ne,...ae,children:(0,t.jsx)("div",{className:pe.content,ref:de.setFloating,style:le,...ce(),children:(0,t.jsxs)("div",{className:pe.body,children:[(0,t.jsx)(p.A,{className:pe.leftSide,hideHorizontalTrack:!0,children:(0,t.jsx)(m.l,{title:(0,u.t)("time-picker.time-range.example-title","Example time ranges"),options:j,onChange:Pe,value:Q})}),(0,t.jsxs)("div",{className:pe.rightSide,children:[(0,t.jsx)("div",{className:pe.title,children:(0,t.jsx)(P.e,{children:(0,t.jsx)(v.m,{content:(0,t.jsx)(N,{}),placement:"bottom",theme:"info",children:(0,t.jsx)("div",{children:(0,t.jsxs)(u.x,{i18nKey:"time-picker.time-range.specify",children:["Specify time range ",(0,t.jsx)(y.I,{name:"info-circle"})]})})})})}),(0,t.jsx)(h.D,{label:"From",invalid:!Y.validation.isValid,error:Y.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>q({...Y,validation:b(Y.value)}),onChange:Se=>q({...Y,value:Se.currentTarget.value}),value:Y.value})}),(0,t.jsx)(h.D,{label:"To",invalid:!te.validation.isValid,error:te.validation.errorMessage,children:(0,t.jsx)(f.p,{onClick:Se=>Se.stopPropagation(),onBlur:()=>X({...te,validation:b(te.value)}),onChange:Se=>X({...te,value:Se.currentTarget.value}),value:te.value})}),(0,t.jsx)(c.$n,{"aria-label":"TimePicker submit button",onClick:ge,children:"Apply time range"})]})]})})})})]})]})}const N=()=>{const U=(0,o.of)(I);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:U.supported,children:["Supported formats: ",(0,t.jsx)("code",{className:U.tooltip,children:"now-[digit]s/m/h/d/w"})]}),(0,t.jsx)("div",{children:"Example: to select a time range from 10 minutes ago to now"}),(0,t.jsx)("code",{className:U.tooltip,children:"From: now-10m To: now"}),(0,t.jsxs)("div",{className:U.link,children:["For more information see"," ",(0,t.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls/",children:["docs ",(0,t.jsx)(y.I,{name:"external-link-alt"})]}),"."]})]})},I=U=>({supported:(0,n.css)({marginBottom:U.spacing(1)}),tooltip:(0,n.css)({margin:0}),link:(0,n.css)({marginTop:U.spacing(1)})}),K=(U,W)=>H=>{const z=(0,f.n)({theme:H,invalid:!1}),M=250+w(H,U)+w(H,W);return{backdrop:(0,n.css)({position:"fixed",zIndex:H.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0}),container:(0,n.css)({display:"flex",position:"relative"}),pickerInput:(0,n.cx)(z.input,z.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,paddingLeft:0,lineHeight:`${H.spacing.gridSize*H.components.height.md-2}px`})),caretIcon:(0,n.cx)(z.suffix,(0,n.css)({position:"relative",marginLeft:H.spacing(.5)})),clockIcon:(0,n.cx)(z.prefix,(0,n.css)({position:"relative",marginRight:H.spacing(.5)})),content:(0,n.css)({background:H.colors.background.primary,boxShadow:H.shadows.z3,position:"absolute",zIndex:H.zIndex.modal,width:"500px",top:"100%",borderRadius:H.shape.radius.default,border:`1px solid ${H.colors.border.weak}`,left:0,whiteSpace:"normal"}),body:(0,n.css)({display:"flex",height:`${M}px`}),description:(0,n.css)({color:H.colors.text.secondary,fontSize:H.typography.size.sm}),leftSide:(0,n.css)({width:"50% !important",borderRight:`1px solid ${H.colors.border.medium}`}),rightSide:(0,n.css)({width:"50%",padding:H.spacing(1)}),title:(0,n.css)({marginBottom:H.spacing(1)})}};function w(U,W){return W?W.length>34?U.spacing.gridSize*6.5:U.spacing.gridSize*4:0}},66070:(_,L,e)=>{"use strict";e.d(L,{R:()=>u,i:()=>o});var t=e(74848),n=e(32196),r=e(79770),s=e(47232),a=e(40845),g=e(16797),i=e(87266),l=e(14578),d=e(78537);const o="time-of-day-picker-panel",u=({minuteStep:h=1,showHour:y=!0,showSeconds:f=!1,onChange:v,value:P,size:m="auto",disabled:D,disabledHours:x,disabledMinutes:E,disabledSeconds:C})=>{const b=(0,a.of)(p);return(0,t.jsx)(r.A,{className:(0,n.cx)((0,i.lH)()[m],b.input),popupClassName:(0,n.cx)(b.picker,o),defaultValue:(0,s.AN)(),onChange:T=>{if((0,s.u8)(T))return v((0,s.KQ)(T))},allowEmpty:!1,showSecond:f,value:(0,s.AN)(P),showHour:y,minuteStep:h,inputIcon:(0,t.jsx)(c,{wrapperStyle:b.caretWrapper}),disabled:D,disabledHours:x,disabledMinutes:E,disabledSeconds:C})},c=({wrapperStyle:h=""})=>(0,t.jsx)("div",{className:h,children:(0,t.jsx)(l.I,{name:"angle-down"})}),p=h=>{const y=h.components.input.background,f=h.v1.palette.black,v=h.colors.background.secondary,P=h.shape.radius.default,m=h.components.input.borderColor;return{caretWrapper:(0,n.css)({position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",display:"inline-block",textAlign:"right",color:h.colors.text.secondary}),picker:(0,n.css)({".rc-time-picker-panel-select":{fontSize:"14px",backgroundColor:y,color:h.colors.text.secondary,borderColor:m,li:{outlineWidth:"2px","&.rc-time-picker-panel-select-option-selected":{backgroundColor:"inherit",border:`1px solid ${h.v1.palette.orange}`,borderRadius:P,color:h.colors.text.primary},"&:hover":{background:v,color:h.colors.text.primary},"&.rc-time-picker-panel-select-option-disabled":{color:h.colors.action.disabledText}}},".rc-time-picker-panel-inner":{boxShadow:`0px 4px 4px ${f}`,backgroundColor:y,borderColor:m,borderRadius:P,marginTop:"3px",".rc-time-picker-panel-input-wrap":{marginRight:"2px","&, .rc-time-picker-panel-input":{backgroundColor:y,paddingTop:"2px"}},".rc-time-picker-panel-combobox":{display:"flex"}}}),input:(0,n.css)({".rc-time-picker-input":{backgroundColor:y,borderRadius:P,borderColor:m,color:h.colors.text.primary,height:h.spacing(4),"&:focus":(0,g.getFocusStyles)(h),"&:disabled":{backgroundColor:h.colors.action.disabledBackground,color:h.colors.action.disabledText,border:`1px solid ${h.colors.action.disabledBackground}`,"&:focus":{boxShadow:"none"}}}})}}},54230:(_,L,e)=>{"use strict";e.d(L,{b:()=>P});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(96540),i=e(47232),l=e(43127),d=e(13544),o=e(40845),u=e(14578),c=e(10354),p=e(85068),h=e(3799),y=e(32432),f=e(47619);const v=()=>{},P=({value:D,onChange:x,onChangeTimeZone:E=v,clearable:C,weekStart:b,hideTimeZone:T=!0,timeZone:A="browser",placeholder:R="Select time range",isReversed:S=!0,hideQuickRanges:O=!1,disabled:j=!1,showIcon:B=!1})=>{const[N,I]=(0,g.useState)(!1),K=(0,o.of)(m,j),w=Y=>{Y.stopPropagation(),Y.preventDefault(),!j&&I(!N)},U=()=>{I(!1)},W=Y=>{U(),x(Y)},H=Y=>{Y.stopPropagation();const q=(0,i.KQ)(null),te=(0,i.KQ)(null);x({from:q,to:te,raw:{from:q,to:te}})},z=(0,g.createRef)(),G=(0,g.createRef)(),{dialogProps:M}=(0,r.s)({},z),{overlayProps:Q}=(0,a.e)({onClose:U,isDismissable:!0,isOpen:N,shouldCloseOnInteractOutside:Y=>!G.current?.contains(Y)},z);return(0,t.jsxs)("div",{className:K.container,children:[(0,t.jsxs)("button",{type:"button",className:K.pickerInput,"data-testid":d.Tp.components.TimePicker.openButton,onClick:w,ref:G,children:[B&&(0,t.jsx)(u.I,{name:"clock-nine",size:"sm",className:K.icon}),(0,t.jsx)(h.f,{value:D,timeZone:A,placeholder:R}),!j&&(0,t.jsxs)("span",{className:K.caretIcon,children:[(0,f.X)(D)&&C&&(0,t.jsx)(u.I,{className:K.clearIcon,name:"times",size:"lg",onClick:H}),(0,t.jsx)(u.I,{name:N?"angle-up":"angle-down",size:"lg"})]})]}),N&&(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:K.content,ref:z,...Q,...M,children:(0,t.jsx)(p.r,{timeZone:A,value:(0,f.X)(D)?D:(0,l.E2)(),onChange:W,quickOptions:y.o,onChangeTimeZone:E,className:K.content,hideTimeZone:T,isReversed:S,hideQuickRanges:O,weekStart:b})})})]})},m=(D,x=!1)=>{const E=(0,c.n)({theme:D,invalid:!1});return{container:(0,n.css)({display:"flex",position:"relative"}),content:(0,n.css)({marginLeft:0,position:"absolute",top:"116%",zIndex:D.zIndex.dropdown}),pickerInput:(0,n.cx)(E.input,x&&E.inputDisabled,E.wrapper,(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",paddingRight:0,lineHeight:`${D.spacing.gridSize*4-2}px`})),caretIcon:(0,n.cx)(E.suffix,(0,n.css)({position:"relative",top:"-1px",marginLeft:D.spacing(.5)})),clearIcon:(0,n.css)({marginRight:D.spacing(.5),"&:hover":{color:D.colors.text.maxContrast}}),placeholder:(0,n.css)({color:D.colors.text.disabled,opacity:1}),icon:(0,n.css)({marginRight:D.spacing(.5)})}}},15666:(_,L,e)=>{"use strict";e.d(L,{$6:()=>D,_8:()=>C,xS:()=>E});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(96540),i=e(65879),l=e(72724),d=e(91410),o=e(85858),u=e(13544),c=e(40845),p=e(76412),h=e(19727),y=e(88448),f=e(27746),v=e(56034),P=e(85068),m=e(32432);function D(R){const[S,O]=(0,g.useState)(!1),{value:j,onMoveBackward:B,onMoveForward:N,onZoom:I,onError:K,timeZone:w,fiscalYearStartMonth:U,timeSyncButton:W,isSynced:H,history:z,onChangeTimeZone:G,onChangeFiscalYearStartMonth:M,hideQuickRanges:Q,widthOverride:Y,isOnCanvas:q,onToolbarTimePickerClick:te,weekStart:X}=R,ee=ge=>{R.onChange(ge),O(!1)};(0,g.useEffect)(()=>{S&&te&&te()},[S,te]);const ne=()=>{O(ge=>!ge)},Z=()=>{O(!1)},ae=(0,g.createRef)(),re=(0,g.createRef)(),{overlayProps:se,underlayProps:de}=(0,a.e)({onClose:Z,isDismissable:!0,isOpen:S,shouldCloseOnInteractOutside:ge=>!re.current?.contains(ge)},ae),{dialogProps:le}=(0,r.s)({},ae),he=(0,c.of)(T),{modalBackdrop:ie}=(0,c.of)(y.o),J=!i.isRelativeTime(j.raw.from)||!i.isRelativeTime(j.raw.to),ce=H?"active":q?"canvas":"default",Pe=j?.to?.isBefore(j.from)?"exclamation-triangle":"clock-nine",Ie=b(j,w);return(0,t.jsxs)(h.e,{className:he.container,children:[J&&(0,t.jsx)(f.I,{"aria-label":(0,p.t)("time-picker.range-picker.backwards-time-aria-label","Move time range backwards"),variant:ce,onClick:B,icon:"angle-left",narrow:!0}),(0,t.jsx)(v.m,{ref:re,content:(0,t.jsx)(E,{timeRange:j,timeZone:w}),placement:"bottom",interactive:!0,children:(0,t.jsx)(f.I,{"data-testid":u.Tp.components.TimePicker.openButton,"aria-label":(0,p.t)("time-picker.range-picker.current-time-selected","Time range selected: {{currentTimeRange}}",{currentTimeRange:Ie}),"aria-controls":"TimePickerContent",onClick:ne,icon:Pe,isOpen:S,variant:ce,children:(0,t.jsx)(C,{...R})})}),S&&(0,t.jsxs)("div",{"data-testid":u.Tp.components.TimePicker.overlayContent,children:[(0,t.jsx)("div",{role:"presentation",className:(0,n.cx)(ie,he.backdrop),...de}),(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{className:he.content,ref:ae,...se,...le,children:(0,t.jsx)(P.r,{timeZone:w,fiscalYearStartMonth:U,value:j,onChange:ee,quickOptions:m.o,history:z,showHistory:!0,widthOverride:Y,onChangeTimeZone:G,onChangeFiscalYearStartMonth:M,hideQuickRanges:Q,onError:K,weekStart:X})})})]}),W,J&&(0,t.jsx)(f.I,{"aria-label":(0,p.t)("time-picker.range-picker.forwards-time-aria-label","Move time range forwards"),onClick:N,icon:"angle-right",narrow:!0,variant:ce}),(0,t.jsx)(v.m,{content:x,placement:"bottom",children:(0,t.jsx)(f.I,{"aria-label":(0,p.t)("time-picker.range-picker.zoom-out-button","Zoom out time range"),onClick:I,icon:"search-minus",variant:ce})})]})}D.displayName="TimeRangePicker";const x=()=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(p.x,{i18nKey:"time-picker.range-picker.zoom-out-tooltip",children:["Time range zoom out ",(0,t.jsx)("br",{})," CTRL+Z"]})}),E=({timeRange:R,timeZone:S})=>{const O=(0,c.of)(A);return(0,t.jsxs)(t.Fragment,{children:[(0,l.LE)(R.from,{timeZone:S}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)(p.x,{i18nKey:"time-picker.range-picker.to",children:"to"})}),(0,l.LE)(R.to,{timeZone:S}),(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("span",{className:O.utc,children:(0,d.le)(S)})})]})},C=(0,g.memo)(({hideText:R,value:S,timeZone:O})=>{const j=(0,c.of)(A);return R?null:(0,t.jsxs)("span",{className:j.container,"aria-live":"polite","aria-atomic":"true",children:[(0,t.jsx)("span",{children:b(S,O)}),(0,t.jsx)("span",{className:j.utc,children:i.describeTimeRangeAbbreviation(S,O)})]})});C.displayName="TimePickerButtonLabel";const b=(R,S)=>{const O={to:o.isMathString(R.raw.to)?R.raw.to:R.to,from:o.isMathString(R.raw.from)?R.raw.from:R.from};return i.describeTimeRange(O,S)},T=R=>({container:(0,n.css)({position:"relative",display:"flex",verticalAlign:"middle"}),backdrop:(0,n.css)({display:"none",[R.breakpoints.down("sm")]:{display:"block"}}),content:(0,n.css)({position:"absolute",right:0,top:"116%",zIndex:R.zIndex.dropdown,[R.breakpoints.down("sm")]:{position:"fixed",right:"50%",top:"50%",transform:"translate(50%, -50%)",zIndex:R.zIndex.modal}})}),A=R=>({container:(0,n.css)({display:"flex",alignItems:"center",whiteSpace:"nowrap"}),utc:(0,n.css)({color:R.v1.palette.orange,fontSize:R.typography.size.sm,paddingLeft:"6px",lineHeight:"28px",verticalAlign:"bottom",fontWeight:R.typography.fontWeightMedium})})},72265:(_,L,e)=>{"use strict";e.d(L,{h2:()=>f,nB:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(21497),a=e(53531),g=e(40845),i=e(76412),l=e(14578),d=e(15648),o=e(99225);const u={saturday:"islamic",sunday:"gregory",monday:"iso8601"};function c({onChange:v,from:P,to:m,timeZone:D,weekStart:x}){const E=p(P,m,new Date,D),C=h(v,D),b=(0,g.of)(f),T=(0,d.r)(x);return(0,t.jsx)(s.Ay,{selectRange:!0,next2Label:null,prev2Label:null,className:b.body,tileClassName:b.title,value:E,nextLabel:(0,t.jsx)(l.I,{name:"angle-right"}),nextAriaLabel:(0,i.t)("time-picker.calendar.next-month","Next month"),prevLabel:(0,t.jsx)(l.I,{name:"angle-left"}),prevAriaLabel:(0,i.t)("time-picker.calendar.previous-month","Previous month"),onChange:C,locale:"en",calendarType:u[T]})}c.displayName="Body";function p(v,P,m=new Date,D){let x=v.isValid()?v.toDate():m,E=P.isValid()?P.toDate():m;return D&&(x=(0,o.Q)(x,D),E=(0,o.Q)(E,D)),x>E?[E,x]:[x,E]}function h(v,P){return(0,r.useCallback)(m=>{if(!Array.isArray(m))return console.error("onCalendarChange: should be run in selectRange={true}");if(m[0]&&m[1]){const D=(0,a.b)(y(m[0]),{timeZone:P}),x=(0,a.b)(y(m[1]),{timeZone:P});v(D,x)}},[v,P])}function y(v){return[v.getFullYear(),v.getMonth(),v.getDate(),v.getHours(),v.getMinutes(),v.getSeconds()]}const f=v=>{const P=".react-calendar__tile--hasActive:not(.react-calendar__tile--range)";return{title:(0,n.css)({color:v.colors.text.primary,backgroundColor:v.colors.background.primary,fontSize:v.typography.size.md,border:"1px solid transparent","&:hover, &:focus":{position:"relative"},"&:disabled":{color:v.colors.action.disabledText}}),body:(0,n.css)({zIndex:v.zIndex.modal,backgroundColor:v.colors.background.primary,width:"268px",".react-calendar__navigation":{display:"flex"},".react-calendar__navigation__label, .react-calendar__navigation__arrow, .react-calendar__navigation":{paddingTop:"4px",backgroundColor:"inherit",color:v.colors.text.primary,border:0,fontWeight:v.typography.fontWeightMedium},".react-calendar__month-view__weekdays":{backgroundColor:"inherit",textAlign:"center",color:v.colors.primary.text,abbr:{border:0,textDecoration:"none",cursor:"default",display:"block",padding:"4px 0 4px 0"}},".react-calendar__month-view__days":{backgroundColor:"inherit"},".react-calendar__tile, .react-calendar__tile--now":{marginBottom:"4px",backgroundColor:"inherit",height:"26px"},".react-calendar__navigation__label, .react-calendar__navigation > button:focus, .time-picker-calendar-tile:focus":{outline:0},[`${P}, .react-calendar__tile--active, .react-calendar__tile--active:hover`]:{color:v.colors.primary.contrastText,fontWeight:v.typography.fontWeightMedium,background:v.colors.primary.main,border:"0px"},".react-calendar__tile--rangeEnd, .react-calendar__tile--rangeStart":{padding:0,border:"0px",color:v.colors.primary.contrastText,fontWeight:v.typography.fontWeightMedium,background:v.colors.primary.main,abbr:{backgroundColor:v.colors.primary.main,borderRadius:"100px",display:"block",paddingTop:"2px",height:"26px"}},[`${P}, .react-calendar__tile--rangeStart`]:{borderTopLeftRadius:"20px",borderBottomLeftRadius:"20px"},[`${P}, .react-calendar__tile--rangeEnd`]:{borderTopRightRadius:"20px",borderBottomRightRadius:"20px"}})}}},85068:(_,L,e)=>{"use strict";e.d(L,{r:()=>ie});var t=e(74848),n=e(32196),r=e(96540),s=e(47232),a=e(65879),g=e(13544),i=e(40845),l=e(16797),d=e(76412),o=e(67647),u=e(14578),c=e(2543),p=e(91410),h=e(55852),y=e(55014),f=e(88575),v=e(63021),P=e(40675),m=e(40980),D=e(20333),x=e(79451),E=e(17624),C=e(67459),b=e(32432);const T=Me=>{const{timeZone:be,fiscalYearStartMonth:we,timestamp:Be=Date.now(),onChangeTimeZone:He,onChangeFiscalYearStartMonth:Ve}=Me,[Je,nt]=(0,r.useState)(!1),[pt,bt]=(0,r.useState)("tz"),Tt=(0,r.useId)(),ye=(0,r.useId)(),je=(0,r.useId)(),ue=(0,r.useCallback)(Ne=>{Ne&&Ne.stopPropagation(),nt(!Je)},[Je,nt]),Ee=(0,i.of)(A);if(!(0,c.isString)(be))return null;const Ce=(0,p.QZ)(be,Be);return Ce?(0,t.jsxs)("div",{children:[(0,t.jsxs)("section",{"aria-label":(0,d.t)("time-picker.footer.time-zone-selection","Time zone selection"),className:Ee.container,children:[(0,t.jsxs)("div",{className:Ee.timeZoneContainer,children:[(0,t.jsxs)("div",{className:Ee.timeZone,children:[(0,t.jsx)(C.U,{title:Ce.name}),(0,t.jsx)("div",{className:Ee.spacer}),(0,t.jsx)(x.E,{info:Ce})]}),(0,t.jsx)(E.X,{timeZone:be,timestamp:Be})]}),(0,t.jsx)("div",{className:Ee.spacer}),(0,t.jsx)(h.$n,{"data-testid":g.Tp.components.TimeZonePicker.changeTimeSettingsButton,variant:"secondary",onClick:ue,size:"sm","aria-expanded":Je,"aria-controls":Tt,icon:Je?"angle-up":"angle-down",children:(0,t.jsx)(d.x,{i18nKey:"time-picker.footer.change-settings-button",children:"Change time settings"})})]}),Je?(0,t.jsxs)("div",{className:Ee.editContainer,id:Tt,children:[(0,t.jsxs)(v.U,{children:[(0,t.jsx)(P.o,{label:(0,d.t)("time-picker.footer.time-zone-option","Time zone"),active:pt==="tz",onChangeTab:()=>{bt("tz")},"aria-controls":ye}),(0,t.jsx)(P.o,{label:(0,d.t)("time-picker.footer.fiscal-year-option","Fiscal year"),active:pt==="fy",onChangeTab:()=>{bt("fy")},"aria-controls":je})]}),(0,t.jsx)(m.J,{children:pt==="tz"?(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:ye,className:(0,n.cx)(Ee.timeZoneContainer,Ee.timeSettingContainer),children:(0,t.jsx)(D.U,{includeInternal:!0,onChange:Ne=>{ue(),(0,c.isString)(Ne)&&He(Ne)},onBlur:ue,menuShouldPortal:!1})}):(0,t.jsx)("section",{role:"tabpanel","data-testid":g.Tp.components.TimeZonePicker.containerV2,id:je,className:(0,n.cx)(Ee.timeZoneContainer,Ee.timeSettingContainer),children:(0,t.jsx)(f.D,{className:Ee.fiscalYearField,label:(0,d.t)("time-picker.footer.fiscal-year-start","Fiscal year start month"),children:(0,t.jsx)(y.G,{value:we??null,options:b.Z,onChange:Ne=>{Ve&&Ve(Ne?.value??0)}})})})})]}):null]}):null},A=Me=>({container:(0,n.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:Me.spacing(1.5),display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center"}),editContainer:(0,n.css)({borderTop:`1px solid ${Me.colors.border.weak}`,padding:Me.spacing(1.5),paddingTop:0,justifyContent:"space-between",alignItems:"center"}),spacer:(0,n.css)({marginLeft:"7px"}),timeSettingContainer:(0,n.css)({paddingTop:Me.spacing(1)}),fiscalYearField:(0,n.css)({marginBottom:0}),timeZoneContainer:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",flexGrow:1}),timeZone:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"baseline",flexGrow:1})});var R=e(64998),S=e(53531),O=e(72724),j=e(10354),B=e(56034),N=e(47619),I=e(18828),K=e(85690),w=e(93225),U=e(59875),W=e(88448),H=e(72265),z=e(67061);function G({onClose:Me,onApply:be}){return(0,t.jsxs)(z.B,{gap:2,justifyContent:"space-between",children:[(0,t.jsx)(h.$n,{variant:"secondary",onClick:Me,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.cancel-button",children:"Cancel"})}),(0,t.jsx)(h.$n,{onClick:be,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.apply-button",children:"Apply time range"})})]})}G.displayName="Footer";var M=e(29158);function Q({onClose:Me}){return(0,t.jsxs)(z.B,{justifyContent:"space-between",children:[(0,t.jsx)(R.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.calendar.select-time",children:"Select a time range"})}),(0,t.jsx)(M.K,{"data-testid":g.Tp.components.TimePicker.calendar.closeButton,tooltip:(0,d.t)("time-picker.calendar.close","Close calendar"),name:"times",variant:"secondary",onClick:Me})]})}Q.displayName="Header";const Y=(Me,be=!1)=>({container:(0,n.css)({top:0,position:"absolute",[`${be?"left":"right"}`]:"546px"}),modalContainer:(0,n.css)({label:"modalContainer",margin:"0 auto"}),calendar:(0,n.css)({display:"flex",flexDirection:"column",gap:Me.spacing(1),padding:Me.spacing(1),label:"calendar",boxShadow:Me.shadows.z3,backgroundColor:Me.colors.background.primary,border:`1px solid ${Me.colors.border.weak}`,borderRadius:Me.shape.radius.default}),modal:(0,n.css)({label:"modal",boxShadow:Me.shadows.z3,left:"50%",position:"fixed",top:"50%",transform:"translate(-50%, -50%)",zIndex:Me.zIndex.modal})});function q(Me){const be=(0,i.$j)(),{modalBackdrop:we}=(0,i.of)(W.o),Be=Y(be,Me.isReversed),{isOpen:He,isFullscreen:Ve,onClose:Je}=Me,nt=(0,r.createRef)(),{dialogProps:pt}=(0,I.s)({"aria-label":g.Tp.components.TimePicker.calendar.label},nt),{overlayProps:bt}=(0,w.e)({isDismissable:!0,isOpen:He,onClose:Je},nt),Tt=!Ve;if(!He)return null;const ye=(0,t.jsxs)("section",{className:Be.calendar,ref:nt,...bt,...pt,"data-testid":g.Tp.components.TimePicker.calendar.label,children:[(0,t.jsx)(Q,{...Me}),(0,t.jsx)(H.nB,{...Me}),Tt&&(0,t.jsx)(G,{...Me})]});return Tt?(0,t.jsxs)(U.Sf,{children:[(0,t.jsx)("div",{className:we}),(0,t.jsx)(K.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("div",{className:Be.modal,children:(0,t.jsx)("div",{className:Be.modalContainer,children:ye})})})]}):(0,t.jsx)(K.n1,{contain:!0,restoreFocus:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:Be.container,children:ye})})}const te=(0,r.memo)(q);q.displayName="TimePickerCalendar";const X={default:()=>(0,d.t)("time-picker.range-content.default-error",'Please enter a past date or "now"'),range:()=>(0,d.t)("time-picker.range-content.range-error",`"From" can't be after "To"`)},ee=Me=>{const{value:be,isFullscreen:we=!1,timeZone:Be,onApply:He,isReversed:Ve,fiscalYearStartMonth:Je,onError:nt,weekStart:pt}=Me,[bt,Tt]=Z(be.raw.from,be.raw.to,Be),ye=(0,i.of)(re),[je,ue]=(0,r.useState)(bt),[Ee,Ce]=(0,r.useState)(Tt),[Ne,Fe]=(0,r.useState)(!1),Ue=(0,r.useId)(),fe=(0,r.useId)();(0,r.useEffect)(()=>{const[dt,ze]=Z(be.raw.from,be.raw.to,Be);ue(dt),Ce(ze)},[be.raw.from,be.raw.to,Be]);const Te=(0,r.useCallback)(dt=>{dt.preventDefault(),Fe(!0)},[Fe]),Ge=(0,r.useCallback)(()=>{if(Ee.invalid||je.invalid)return;const dt={from:je.value,to:Ee.value},ze=a.convertRawToRange(dt,Be,Je);He(ze)},[je.invalid,je.value,He,Be,Ee.invalid,Ee.value,Je]),Qe=(0,r.useCallback)((dt,ze)=>{const[xe,Oe]=Z(dt,ze,Be);ue(xe),Ce(Oe)},[Be]),st=dt=>{dt.key==="Enter"&&Ge()},Xe=()=>{const dt={from:je.value,to:Ee.value};navigator.clipboard.writeText(JSON.stringify(dt))},ot=async()=>{const dt=await navigator.clipboard.readText();let ze;try{ze=JSON.parse(dt)}catch{nt&&nt(dt);return}const[xe,Oe]=Z(ze.from,ze.to,Be);ue(xe),Ce(Oe)},ft=a.convertRawToRange({from:"now/fy",to:"now/fy"},Be,Je),_e=(0,d.t)("time-picker.range-content.fiscal-year","Fiscal year"),et=(0,t.jsx)("div",{className:ye.tooltip,children:a.isFiscal(be)?(0,t.jsx)(B.m,{content:`${_e}: ${ft.from.format("MMM-DD")} - ${ft.to.format("MMM-DD")}`,children:(0,t.jsx)(u.I,{name:"info-circle"})}):null}),it=(0,t.jsx)(h.$n,{"aria-label":(0,d.t)("time-picker.range-content.open-input-calendar","Open calendar"),"data-testid":g.Tp.components.TimePicker.calendar.openButton,icon:"calendar-alt",variant:"secondary",type:"button",onClick:Te});return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:ye.fieldContainer,children:[(0,t.jsx)(f.D,{label:(0,d.t)("time-picker.range-content.from-input","From"),invalid:je.invalid,error:je.errorMessage,children:(0,t.jsx)(j.p,{id:Ue,onClick:dt=>dt.stopPropagation(),onChange:dt=>Qe(dt.currentTarget.value,Ee.value),addonAfter:it,onKeyDown:st,"data-testid":g.Tp.components.TimePicker.fromField,value:je.value})}),et]}),(0,t.jsxs)("div",{className:ye.fieldContainer,children:[(0,t.jsx)(f.D,{label:(0,d.t)("time-picker.range-content.to-input","To"),invalid:Ee.invalid,error:Ee.errorMessage,children:(0,t.jsx)(j.p,{id:fe,onClick:dt=>dt.stopPropagation(),onChange:dt=>Qe(je.value,dt.currentTarget.value),addonAfter:it,onKeyDown:st,"data-testid":g.Tp.components.TimePicker.toField,value:Ee.value})}),et]}),(0,t.jsxs)("div",{className:ye.buttonsContainer,children:[(0,t.jsx)(h.$n,{"data-testid":g.Tp.components.TimePicker.copyTimeRange,icon:"copy",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-copy","Copy time range to clipboard"),type:"button",onClick:Xe}),(0,t.jsx)(h.$n,{"data-testid":g.Tp.components.TimePicker.pasteTimeRange,icon:"clipboard-alt",variant:"secondary",tooltip:(0,d.t)("time-picker.copy-paste.tooltip-paste","Paste time range"),type:"button",onClick:ot}),(0,t.jsx)(h.$n,{"data-testid":g.Tp.components.TimePicker.applyTimeRange,type:"button",onClick:Ge,children:(0,t.jsx)(d.x,{i18nKey:"time-picker.range-content.apply-button",children:"Apply time range"})})]}),(0,t.jsx)(te,{isFullscreen:we,isOpen:Ne,from:(0,S.b)(je.value,{timeZone:Be}),to:(0,S.b)(Ee.value,{timeZone:Be}),onApply:Ge,onClose:()=>Fe(!1),onChange:Qe,timeZone:Be,isReversed:Ve,weekStart:pt})]})};function ne(Me,be,we){const Be={from:Me,to:be},He=a.convertRawToRange(Be,we);return!(He.from.isSame(He.to)||He.from.isBefore(He.to))}function Z(Me,be,we){const Be=ae(Me,we),He=ae(be,we),Ve=!(0,N.f)(Be,!1,we),Je=!(0,N.f)(He,!0,we),nt=ne(Be,He,we)&&!Je;return[{value:Be,invalid:Ve||nt,errorMessage:nt&&!Ve?X.range():X.default()},{value:He,invalid:Je,errorMessage:X.default()}]}function ae(Me,be){if((0,s.Ar)(Me))return(0,O.LE)(Me,{timeZone:be});if(Me.endsWith("Z")){const we=(0,S.b)(Me,{timeZone:"utc"});return(0,O.LE)(we,{timeZone:be})}return Me}function re(Me){return{fieldContainer:(0,n.css)({display:"flex"}),buttonsContainer:(0,n.css)({display:"flex",gap:Me.spacing(.5),marginTop:Me.spacing(1)}),tooltip:(0,n.css)({paddingLeft:Me.spacing(1),paddingTop:Me.spacing(3)})}}var se=e(11752);const de=(Me,be)=>a.convertRawToRange({from:Me.from,to:Me.to},be),le=(Me,be)=>{const we=(0,O.LE)(Me.from,{timeZone:be}),Be=(0,O.LE)(Me.to,{timeZone:be});return{from:we,to:Be,display:`${we} to ${Be}`}},he=Me=>{const{quickOptions:be=[],isReversed:we,isFullscreen:Be,hideQuickRanges:He,timeZone:Ve,fiscalYearStartMonth:Je,value:nt,onChange:pt,history:bt,showHistory:Tt,className:ye,hideTimeZone:je,onChangeTimeZone:ue,onChangeFiscalYearStartMonth:Ee}=Me,Ce=!bt?.length,Ne=Be&&Tt||!Be&&(Tt&&!Ce||!He),Fe=(0,i.of)(ge,we,He,Ne,Be),Ue=Pe(bt,Ve),fe=Ie(nt.raw,be),[Te,Ge]=(0,r.useState)(""),Qe=be.filter(Xe=>Xe.display.toLowerCase().includes(Te.toLowerCase())),st=Xe=>pt(de(Xe));return(0,t.jsxs)("div",{id:"TimePickerContent",className:(0,n.cx)(Fe.container,ye),children:[(0,t.jsxs)("div",{className:Fe.body,children:[(!Be||!He)&&(0,t.jsxs)("div",{className:Fe.rightSide,children:[(0,t.jsx)("div",{className:Fe.timeRangeFilter,children:(0,t.jsx)(o.Z,{width:0,value:Te,onChange:Ge,placeholder:(0,d.t)("time-picker.content.filter-placeholder","Search quick ranges")})}),(0,t.jsxs)("div",{className:Fe.scrollContent,children:[!Be&&(0,t.jsx)(J,{...Me,historyOptions:Ue}),!He&&(0,t.jsx)(se.l,{options:Qe,onChange:st,value:fe})]})]}),Be&&(0,t.jsx)("div",{className:Fe.leftSide,children:(0,t.jsx)(ce,{...Me,historyOptions:Ue})})]}),!je&&Be&&(0,t.jsx)(T,{timeZone:Ve,fiscalYearStartMonth:Je,onChangeTimeZone:ue,onChangeFiscalYearStartMonth:Ee})]})},ie=Me=>{const{widthOverride:be}=Me,we=(0,i.$j)(),Be=(be||window.innerWidth)>=we.breakpoints.values.lg;return(0,t.jsx)(he,{...Me,isFullscreen:Be})},J=Me=>{const{value:be,hideQuickRanges:we,onChange:Be,timeZone:He,historyOptions:Ve=[],showHistory:Je,onError:nt,weekStart:pt}=Me,bt=(0,i.of)(Se),Tt=(0,s.Ar)(be.raw.from)||(0,s.Ar)(be.raw.to),[ye,je]=(0,r.useState)(!Tt),ue=we?!1:ye,Ee=Ce=>Be(de(Ce,He));return(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:bt.header,children:(0,t.jsxs)("button",{type:"button",className:bt.expandButton,onClick:()=>{we||je(!ue)},"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,"aria-expanded":!ue,"aria-controls":"expanded-timerange",children:[(0,t.jsx)(R.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})}),!we&&(0,t.jsx)(u.I,{name:ue?"angle-down":"angle-up"})]})}),!ue&&(0,t.jsxs)("div",{className:bt.body,id:"expanded-timerange",children:[(0,t.jsx)("div",{className:bt.form,children:(0,t.jsx)(ee,{value:be,onApply:Be,timeZone:He,isFullscreen:!1,onError:nt,weekStart:pt})}),Je&&(0,t.jsx)(se.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Ve,onChange:Ee,placeholderEmpty:null})]})]})},ce=Me=>{const{onChange:be,value:we,timeZone:Be,fiscalYearStartMonth:He,isReversed:Ve,historyOptions:Je,onError:nt,weekStart:pt}=Me,bt=(0,i.of)(De,Me.hideQuickRanges),Tt=ye=>be(de(ye,Be));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:bt.container,children:[(0,t.jsx)("div",{className:bt.title,"data-testid":g.Tp.components.TimePicker.absoluteTimeRangeTitle,children:(0,t.jsx)(R.e,{children:(0,t.jsx)(d.x,{i18nKey:"time-picker.absolute.title",children:"Absolute time range"})})}),(0,t.jsx)(ee,{value:we,timeZone:Be,fiscalYearStartMonth:He,onApply:be,isFullscreen:!0,isReversed:Ve,onError:nt,weekStart:pt})]}),Me.showHistory&&(0,t.jsx)("div",{className:bt.recent,children:(0,t.jsx)(se.l,{title:(0,d.t)("time-picker.absolute.recent-title","Recently used absolute ranges"),options:Je||[],onChange:Tt,placeholderEmpty:(0,t.jsx)(pe,{})})})]})},pe=(0,r.memo)(()=>{const Me=(0,i.of)(Ke),be=(0,d.t)("time-picker.content.empty-recent-list-info","It looks like you haven't used this time picker before. As soon as you enter some time intervals, recently used intervals will appear here.");return(0,t.jsxs)("div",{className:Me.container,children:[(0,t.jsx)("div",{children:(0,t.jsx)("span",{children:be})}),(0,t.jsx)(d.x,{i18nKey:"time-picker.content.empty-recent-list-docs",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("a",{className:Me.link,href:"https://grafana.com/docs/grafana/latest/dashboards/time-range-controls",target:"_new",children:"Read the documentation"}),(0,t.jsx)("span",{children:" to find out more about how to enter custom time ranges."})]})})]})});function Pe(Me,be){return!Array.isArray(Me)||Me.length===0?[]:Me.map(we=>le(we,be))}pe.displayName="EmptyRecentList";const Ie=(Me,be)=>(0,r.useMemo)(()=>{if(a.isRelativeTimeRange(Me))return be.find(we=>we.from===Me.from&&we.to===Me.to)},[Me,be]),ge=(Me,be,we,Be,He)=>({container:(0,n.css)({background:Me.colors.background.primary,boxShadow:Me.shadows.z3,width:`${He?"546px":"262px"}`,borderRadius:Me.shape.radius.default,border:`1px solid ${Me.colors.border.weak}`,[`${be?"left":"right"}`]:0,display:"flex",flexDirection:"column"}),body:(0,n.css)({display:"flex",flexDirection:"row-reverse",height:`${Be?"381px":"217px"}`,maxHeight:"100vh"}),leftSide:(0,n.css)({display:"flex",flexDirection:"column",borderRight:`${be?"none":`1px solid ${Me.colors.border.weak}`}`,width:`${we?"100%":"60%"}`,overflow:"auto",scrollbarWidth:"thin",order:be?1:0}),rightSide:(0,n.css)({width:`${He?"40%":"100%"}; !important`,borderRight:be?`1px solid ${Me.colors.border.weak}`:"none",display:"flex",flexDirection:"column"}),timeRangeFilter:(0,n.css)({padding:Me.spacing(1)}),spacing:(0,n.css)({marginTop:"16px"}),scrollContent:(0,n.css)({overflowY:"auto",scrollbarWidth:"thin"})}),Se=Me=>({header:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",borderBottom:`1px solid ${Me.colors.border.weak}`,padding:"7px 9px 7px 9px"}),expandButton:(0,n.css)({backgroundColor:"transparent",border:"none",display:"flex",width:"100%","&:focus-visible":(0,l.getFocusStyles)(Me)}),body:(0,n.css)({borderBottom:`1px solid ${Me.colors.border.weak}`}),form:(0,n.css)({padding:"7px 9px 7px 9px"})}),De=(Me,be)=>({container:(0,n.css)({paddingTop:"9px",paddingLeft:"11px",paddingRight:be?"11px":"20%"}),title:(0,n.css)({marginBottom:"11px"}),recent:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end",paddingTop:Me.spacing(1)})}),Ke=Me=>({container:(0,n.css)({padding:"12px",margin:"12px","a, span":{fontSize:"13px"}}),link:(0,n.css)({color:Me.colors.text.link})})},64998:(_,L,e)=>{"use strict";e.d(L,{e:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);const a=i=>({text:(0,n.css)({fontSize:i.typography.size.md,fontWeight:i.typography.fontWeightMedium,color:i.colors.text.primary,margin:0,display:"flex"})}),g=(0,r.memo)(({children:i})=>{const l=(0,s.of)(a);return(0,t.jsx)("h3",{className:l.text,children:i})});g.displayName="TimePickerTitle"},3799:(_,L,e)=>{"use strict";e.d(L,{f:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(15666),g=e(47619);const i=(0,r.memo)(function({hideText:o,value:u,timeZone:c="browser",placeholder:p="No time range selected",className:h}){const y=(0,s.of)(l);return o?null:(0,t.jsx)("span",{className:h,children:(0,g.X)(u)?(0,t.jsx)(a._8,{value:u,timeZone:c}):(0,t.jsx)("span",{className:y.placeholder,children:p})})}),l=d=>({placeholder:(0,n.css)({color:d.colors.text.disabled,opacity:1})})},11752:(_,L,e)=>{"use strict";e.d(L,{l:()=>h});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(76412),g=e(64998),i=e(62938),l=e(16797);const d=D=>({container:(0,n.css)({display:"flex",alignItems:"center",flexDirection:"row-reverse",justifyContent:"space-between"}),selected:(0,n.css)({background:D.colors.action.selected,fontWeight:D.typography.fontWeightMedium}),radio:(0,n.css)({opacity:0,width:"0 !important","&:focus-visible + label":(0,l.getFocusStyles)(D)}),label:(0,n.css)({cursor:"pointer",flex:1,padding:"7px 9px 7px 9px","&:hover":{background:D.colors.action.hover,cursor:"pointer"}})}),o=(0,r.memo)(({value:D,onSelect:x,selected:E=!1,name:C})=>{const b=(0,s.of)(d),T=(0,i.A)();return(0,t.jsxs)("li",{className:(0,n.cx)(b.container,E&&b.selected),children:[(0,t.jsx)("input",{className:b.radio,checked:E,name:C,type:"checkbox","data-role":"item",tabIndex:-1,id:T,onChange:()=>x(D)}),(0,t.jsx)("label",{className:b.label,htmlFor:T,children:D.display})]})});o.displayName="TimeRangeOption";const u=(D,x)=>(D%x+x)%x,c=["ArrowUp","ArrowDown","Home","End","Enter","Tab"],p=({localRef:D,options:x})=>{const[E,C]=(0,r.useState)(0);return(0,r.useEffect)(()=>{const T=D.current?.querySelectorAll('[data-role="item"]')||[],A=Array.from(T).findIndex(S=>S.checked),R=A>=0?A:0;T.forEach((S,O)=>{S.tabIndex=O===R?0:-1}),C(R)},[D,x]),[T=>{const A=D?.current?.querySelectorAll('[data-role="item"]'),R=A?.length??0;c.indexOf(T.key)>-1&&(T.preventDefault(),T.key!=="Tab"&&T.stopPropagation());let S=null;switch(T.key){case"ArrowUp":S=u(E-1,R);break;case"ArrowDown":S=u(E+1,R);break;case"Home":S=0;break;case"End":S=R-1;break;case"Enter":A?.[E]?.click();break;default:break}S!==null&&(C(S),A?.[S]?.focus(),A?.forEach((O,j)=>{O.tabIndex=j===S?0:-1}))}]},h=D=>{const x=(0,s.of)(P),{title:E,options:C,placeholderEmpty:b}=D;return typeof b<"u"&&C.length<=0?(0,t.jsx)(t.Fragment,{children:b}):E?(0,t.jsx)("section",{"aria-label":E,children:(0,t.jsxs)("fieldset",{children:[(0,t.jsx)("div",{className:x.title,children:(0,t.jsx)(g.e,{children:E})}),(0,t.jsx)(y,{...D})]})}):(0,t.jsx)(y,{...D})},y=({options:D,value:x,onChange:E,title:C})=>{const b=(0,s.of)(m),T=(0,r.useRef)(null),[A]=p({localRef:T,options:D});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("ul",{role:"presentation",onKeyDown:A,ref:T,"aria-roledescription":(0,a.t)("time-picker.time-range.aria-role","Time range selection"),children:D.map((R,S)=>(0,t.jsx)(o,{value:R,selected:v(R,x),onSelect:E,name:C??(0,a.t)("time-picker.time-range.default-title","Time ranges")},f(R,S)))}),(0,t.jsx)("div",{className:b.grow})]})};function f(D,x){return`${D.from}-${D.to}-${x}`}function v(D,x){return!x||!D?!1:x.from===D.from&&x.to===D.to}const P=()=>({title:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 5px 9px"})}),m=()=>({grow:(0,n.css)({flexGrow:1,alignItems:"flex-start"})})},20333:(_,L,e)=>{"use strict";e.d(L,{U:()=>D});var t=e(74848),n=e(2543),r=e(96540),s=e(91410),a=e(76412),g=e(90182),i=e(32196),l=e(40845);const d=A=>{const{children:R,label:S}=A,O=(0,l.of)(o);return S?(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:O.header,children:(0,t.jsx)("span",{className:O.label,children:S})}),R]}):(0,t.jsx)("div",{children:R})},o=A=>({header:(0,i.css)({padding:"7px 10px",width:"100%",borderTop:`1px solid ${A.colors.border.weak}`,textTransform:"capitalize"}),label:(0,i.css)({fontSize:A.typography.size.sm,color:A.colors.text.secondary,fontWeight:A.typography.fontWeightMedium})});var u=e(17624),c=e(13544),p=e(14578),h=e(79451),y=e(67459);const f="tz-utc-offset",v=A=>{const{children:R,innerProps:S,innerRef:O,data:j,isSelected:B,isFocused:N}=A,I=(0,l.of)(m),K=Date.now(),w=(0,i.cx)(I.container,N&&I.containerFocused);if(!(0,n.isString)(j.value))return null;const U=(0,s.QZ)(j.value,K);return(0,t.jsx)("div",{className:w,...S,ref:O,"data-testid":c.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:(0,i.cx)(I.leftColumn,I.row),children:[(0,t.jsxs)("div",{className:(0,i.cx)(I.leftColumn,I.wideRow),children:[(0,t.jsx)(y.U,{title:R}),(0,t.jsx)("div",{className:I.spacer}),(0,t.jsx)(h.E,{info:U})]}),(0,t.jsxs)("div",{className:I.rightColumn,children:[(0,t.jsx)(u.X,{timeZone:U?.ianaName||j.value,timestamp:K,className:f}),B&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})]})]})})},P=A=>{const{children:R,innerProps:S,innerRef:O,data:j,isSelected:B,isFocused:N}=A,I=(0,l.of)(m),K=Date.now(),w=(0,i.cx)(I.container,N&&I.containerFocused);if(!(0,n.isString)(j.value))return null;const U=(0,s.QZ)(j.value,K);return(0,t.jsx)("div",{className:w,...S,ref:O,"data-testid":c.Tp.components.Select.option,children:(0,t.jsxs)("div",{className:I.body,children:[(0,t.jsxs)("div",{className:I.row,children:[(0,t.jsx)("div",{className:I.leftColumn,children:(0,t.jsx)(y.U,{title:R})}),(0,t.jsx)("div",{className:I.rightColumn,children:B&&(0,t.jsx)("span",{children:(0,t.jsx)(p.I,{name:"check"})})})]}),(0,t.jsxs)("div",{className:I.row,children:[(0,t.jsx)("div",{className:I.leftColumn,children:(0,t.jsx)(h.E,{info:U})}),(0,t.jsx)("div",{className:I.rightColumn,children:(0,t.jsx)(u.X,{timestamp:K,timeZone:U?.ianaName||j.value,className:f})})]})]})})},m=A=>({container:(0,i.css)({display:"flex",alignItems:"center",flexDirection:"row",flexShrink:0,whiteSpace:"nowrap",cursor:"pointer",padding:"6px 8px 4px","&:hover":{background:A.colors.action.hover}}),containerFocused:(0,i.css)({background:A.colors.action.hover}),body:(0,i.css)({display:"flex",fontWeight:A.typography.fontWeightMedium,flexDirection:"column",flexGrow:1}),row:(0,i.css)({display:"flex",flexDirection:"row"}),leftColumn:(0,i.css)({flexGrow:1,textOverflow:"ellipsis"}),rightColumn:(0,i.css)({justifyContent:"flex-end",alignItems:"center"}),wideRow:(0,i.css)({display:"flex",flexDirection:"row",alignItems:"baseline"}),spacer:(0,i.css)({marginLeft:"6px"})}),D=A=>{const{onChange:R,width:S,autoFocus:O=!1,onBlur:j,value:B,includeInternal:N=!1,disabled:I=!1,inputId:K,menuShouldPortal:w=!0,openMenuOnFocus:U=!0}=A,W=x(N),H=E(W,B),z=b(),G=S&&S<=45?P:v,M=(0,r.useCallback)(Q=>{if(!Q||!(0,n.isString)(Q.value))return R(B);R(Q.value)},[R,B]);return(0,t.jsx)(g.l6,{inputId:K,value:H,placeholder:(0,a.t)("time-picker.zone.select-search-input","Type to search (country, city, abbreviation)"),autoFocus:O,menuShouldPortal:w,openMenuOnFocus:U,width:S,filterOption:z,options:W,onChange:M,onBlur:j,components:{Option:G,Group:d},disabled:I,"aria-label":(0,a.t)("time-picker.zone.select-aria-label","Time zone picker")})},x=A=>{const R=Date.now();return(0,s.U3)(A).map(O=>{const j=O.zones.reduce((B,N)=>{const I=(0,s.QZ)(N,R);return I&&B.push({label:I.name,value:I.zone,searchIndex:T(I,R)}),B},[]);return{label:O.name,options:j}})},E=(A,R)=>(0,r.useMemo)(()=>{if(R===void 0)return;const S=(0,n.toLower)(R);return A.find(j=>j.label?S.startsWith((0,n.toLower)(j.label)):C(S))?.options.find(j=>(0,n.isEmpty)(S)?j.value===s.g$.default:(0,n.toLower)(j.value)===S)},[A,R]),C=A=>{switch(A){case s.g$.default:case s.g$.localBrowserTime:case s.g$.utc:return!0;default:return!1}},b=()=>(0,r.useCallback)((A,R)=>!R||!A.data||!A.data.searchIndex?!0:A.data.searchIndex.indexOf((0,n.toLower)(R))>-1,[]),T=(A,R)=>{const S=[(0,n.toLower)(A.name),(0,n.toLower)(A.abbreviation),(0,n.toLower)((0,u.t)(R,A.zone))];for(const O of A.countries)S.push((0,n.toLower)(O.name)),S.push((0,n.toLower)(O.code));return S.join("|")}},79451:(_,L,e)=>{"use strict";e.d(L,{E:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);const a=({info:l})=>{const d=(0,s.of)(i),o=g(l);return l?(0,t.jsx)("div",{className:d.description,children:o}):null},g=l=>(0,r.useMemo)(()=>{const d=[];if(!l)return"";if(l.name==="Europe/Simferopol")return"Ukraine, EEST";if(l.countries.length>0){const o=l.countries[0];d.push(o.name)}return l.abbreviation&&d.push(l.abbreviation),d.join(", ")},[l]),i=l=>({description:(0,n.css)({fontWeight:"normal",fontSize:l.typography.size.sm,color:l.colors.text.secondary,whiteSpace:"normal",textOverflow:"ellipsis"})})},17624:(_,L,e)=>{"use strict";e.d(L,{X:()=>i,t:()=>l});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(72724),g=e(40845);const i=o=>{const{timestamp:u,timeZone:c,className:p}=o,h=(0,g.of)(d);return(0,r.isString)(c)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("span",{className:(0,n.cx)(h.offset,p),children:l(u,c)})}):null},l=(o,u)=>`UTC${(0,a.LE)(o,{timeZone:u,format:"Z"})}`,d=o=>{const u=(0,n.css)({fontWeight:"normal",fontSize:o.typography.size.sm,color:o.colors.text.secondary,whiteSpace:"normal"});return{offset:(0,n.css)(u,{color:o.colors.text.primary,background:o.colors.background.secondary,padding:"2px 5px",borderRadius:o.shape.radius.default,marginLeft:"4px"})}}},67459:(_,L,e)=>{"use strict";e.d(L,{U:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({title:g})=>{const i=(0,r.of)(a);return g?(0,t.jsx)("span",{className:i.title,children:g}):null},a=g=>({title:(0,n.css)({fontWeight:g.typography.fontWeightRegular,textOverflow:"ellipsis"})})},15648:(_,L,e)=>{"use strict";e.d(L,{l:()=>l,r:()=>i});var t=e(74848),n=e(96540),r=e(13544),s=e(55014);const a=[{value:"",label:"Default"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"},{value:"monday",label:"Monday"}],g=d=>["saturday","sunday","monday"].includes(d);function i(d){if(d&&g(d))return d;const o=window?.grafanaBootData?.user?.weekStart;return o&&g(o)?o:"monday"}const l=d=>{const{onChange:o,width:u,autoFocus:c=!1,onBlur:p,value:h,disabled:y=!1,inputId:f}=d,v=(0,n.useCallback)(m=>{m&&m.value!==void 0&&o(m.value)},[o]),P=(0,n.useMemo)(()=>a.find(m=>m.value===h)?.value??null,[h]);return(0,t.jsx)(s.G,{id:f,value:P,placeholder:r.Tp.components.WeekStartPicker.placeholder,autoFocus:c,width:u,options:a,onChange:v,onBlur:p,disabled:y})}},32432:(_,L,e)=>{"use strict";e.d(L,{Z:()=>n,o:()=>t});const t=[{from:"now-5m",to:"now",display:"Last 5 minutes"},{from:"now-15m",to:"now",display:"Last 15 minutes"},{from:"now-30m",to:"now",display:"Last 30 minutes"},{from:"now-1h",to:"now",display:"Last 1 hour"},{from:"now-3h",to:"now",display:"Last 3 hours"},{from:"now-6h",to:"now",display:"Last 6 hours"},{from:"now-12h",to:"now",display:"Last 12 hours"},{from:"now-24h",to:"now",display:"Last 24 hours"},{from:"now-2d",to:"now",display:"Last 2 days"},{from:"now-7d",to:"now",display:"Last 7 days"},{from:"now-30d",to:"now",display:"Last 30 days"},{from:"now-90d",to:"now",display:"Last 90 days"},{from:"now-6M",to:"now",display:"Last 6 months"},{from:"now-1y",to:"now",display:"Last 1 year"},{from:"now-2y",to:"now",display:"Last 2 years"},{from:"now-5y",to:"now",display:"Last 5 years"},{from:"now-1d/d",to:"now-1d/d",display:"Yesterday"},{from:"now-2d/d",to:"now-2d/d",display:"Day before yesterday"},{from:"now-7d/d",to:"now-7d/d",display:"This day last week"},{from:"now-1w/w",to:"now-1w/w",display:"Previous week"},{from:"now-1M/M",to:"now-1M/M",display:"Previous month"},{from:"now-1Q/fQ",to:"now-1Q/fQ",display:"Previous fiscal quarter"},{from:"now-1y/y",to:"now-1y/y",display:"Previous year"},{from:"now-1y/fy",to:"now-1y/fy",display:"Previous fiscal year"},{from:"now/d",to:"now/d",display:"Today"},{from:"now/d",to:"now",display:"Today so far"},{from:"now/w",to:"now/w",display:"This week"},{from:"now/w",to:"now",display:"This week so far"},{from:"now/M",to:"now/M",display:"This month"},{from:"now/M",to:"now",display:"This month so far"},{from:"now/y",to:"now/y",display:"This year"},{from:"now/y",to:"now",display:"This year so far"},{from:"now/fQ",to:"now",display:"This fiscal quarter so far"},{from:"now/fQ",to:"now/fQ",display:"This fiscal quarter"},{from:"now/fy",to:"now",display:"This fiscal year so far"},{from:"now/fy",to:"now/fy",display:"This fiscal year"}],n=[{label:"January",value:0},{label:"February",value:1},{label:"March",value:2},{label:"April",value:3},{label:"May",value:4},{label:"June",value:5},{label:"July",value:6},{label:"August",value:7},{label:"September",value:8},{label:"October",value:9},{label:"November",value:10},{label:"December",value:11}]},47619:(_,L,e)=>{"use strict";e.d(L,{X:()=>a,f:()=>s});var t=e(47232),n=e(85858),r=e(53531);function s(g,i,l){return(0,t.Ar)(g)?g.isValid():n.isMathString(g)?n.isValid(g):(0,r.b)(g,{roundUp:i,timeZone:l}).isValid()}function a(g){return n.isValid(g.from)&&n.isValid(g.to)}},99225:(_,L,e)=>{"use strict";e.d(L,{Q:()=>n});var t=e(91410);function n(r,s){const a=(0,t.HD)(s);if(!a)return r;const g=a.utcOffset(r.getTime()),i=r.getTimezoneOffset(),l=g-i;return new Date(r.getTime()-l*1e3*60)}},25994:(_,L,e)=>{"use strict";e.d(L,{c:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({direction:g="horizontal",spacing:i=2})=>{const l=(0,r.of)(a,i);return g==="vertical"?(0,t.jsx)("div",{className:l.verticalDivider}):(0,t.jsx)("hr",{className:l.horizontalDivider})};s.displayName="Divider";const a=(g,i)=>({horizontalDivider:(0,n.css)({borderTop:`1px solid ${g.colors.border.weak}`,margin:g.spacing(i,0),width:"100%"}),verticalDivider:(0,n.css)({borderRight:`1px solid ${g.colors.border.weak}`,margin:g.spacing(0,i),height:"100%"})})},69144:(_,L,e)=>{"use strict";e.d(L,{l:()=>n});var t=e(32196);const n=(r,s)=>{const a=s||"middle",g=r.colors.emphasize(r.colors.background.secondary,.15),i=r.colors.primary.border,l=r.spacing(2),d=4,o=200;let u="50%",c="50%";switch(a){case"start":{u="0%",c="0%";break}case"end":{u="100%",c="100%";break}}const p=(0,t.css)({position:"relative","&:before":{content:'""',position:"absolute",transition:r.transitions.create("border-color"),zIndex:1},"&:after":{background:g,content:'""',position:"absolute",transition:r.transitions.create("background"),transform:"translate(-50%, -50%)",borderRadius:r.shape.radius.pill,zIndex:1},"&:hover":{"&:before":{borderColor:i},"&:after":{background:i}}});return{dragHandleVertical:(0,t.cx)(p,(0,t.css)({cursor:"col-resize",width:l,"&:before":{borderRight:"1px solid transparent",height:"100%",left:u,transform:"translateX(-50%)"},"&:after":{left:u,top:"50%",height:o,width:d}})),dragHandleHorizontal:(0,t.cx)(p,(0,t.css)({height:l,cursor:"row-resize","&:before":{borderTop:"1px solid transparent",top:c,transform:"translateY(-50%)",width:"100%"},"&:after":{left:"50%",top:c,height:d,width:o}}))}}},87978:(_,L,e)=>{"use strict";e.d(L,{_:()=>v});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(50848),i=e(96540),l=e(13544),d=e(40845),o=e(76412),u=e(40276),c=e(69144),p=e(29158),h=e(94753),y=e(24932);const f={sm:{width:"25vw",minWidth:384},md:{width:"50vw",minWidth:568},lg:{width:"75vw",minWidth:744}};function v({children:C,onClose:b,closeOnMaskClick:T=!0,scrollableContent:A=!0,title:R,subtitle:S,width:O,size:j="md",tabs:B}){const[N,I,K]=P(),w=(0,d.of)(x),U=(0,d.of)(E,j),W=(0,d.of)(c.l),H=i.useRef(null),{dialogProps:z,titleProps:G}=(0,r.s)({},H),{overlayProps:M}=(0,a.e)({isDismissable:!1,isOpen:!0,onClose:b},H);D();const Q=(0,t.jsx)("div",{className:w.content,children:C}),Y=N??O??f[j].width,q=f[j].minWidth;return(0,t.jsx)(g.A,{open:!0,onClose:b,placement:"right",getContainer:".main-view",className:w.drawerContent,rootClassName:w.drawer,classNames:{wrapper:U},styles:{wrapper:{width:Y,minWidth:q}},width:"",motion:{motionAppear:!0,motionName:w.drawerMotion},maskClassName:w.mask,maskClosable:T,maskMotion:{motionAppear:!0,motionName:w.maskMotion},children:(0,t.jsx)(s.n1,{restoreFocus:!0,contain:!0,autoFocus:!0,children:(0,t.jsxs)("div",{"aria-label":typeof R=="string"?l.Tp.components.Drawer.General.title(R):l.Tp.components.Drawer.General.title("no title"),className:w.container,...M,...z,ref:H,children:[(0,t.jsx)("div",{className:(0,n.cx)(W.dragHandleVertical,w.resizer),onMouseDown:I,onTouchStart:K}),typeof R=="string"&&(0,t.jsxs)("div",{className:(0,n.cx)(w.header,!!B&&w.headerWithTabs),children:[(0,t.jsx)("div",{className:w.actions,children:(0,t.jsx)(p.K,{name:"times",variant:"secondary",onClick:b,"data-testid":l.Tp.components.Drawer.General.close,tooltip:(0,o.t)("grafana-ui.drawer.close","Close")})}),(0,t.jsxs)("div",{className:w.titleWrapper,children:[(0,t.jsx)(h.E,{element:"h3",...G,children:R}),S&&(0,t.jsx)("div",{className:w.subtitle,"data-testid":l.Tp.components.Drawer.General.subtitle,children:S}),B&&(0,t.jsx)("div",{className:w.tabsWrapper,children:B})]})]}),typeof R!="string"&&R,A?(0,t.jsx)(u.E,{children:Q}):Q]})})})}function P(){const[C,b]=(0,i.useState)(void 0),T=(0,i.useCallback)(B=>{b(m(B.clientX))},[]),A=(0,i.useCallback)(B=>{const N=B.touches[0];b(m(N.clientX))},[]),R=(0,i.useCallback)(B=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",R)},[T]),S=(0,i.useCallback)(B=>{document.removeEventListener("touchmove",A),document.removeEventListener("touchend",S)},[A]);function O(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("mousemove",T),document.addEventListener("mouseup",R)}function j(B){B.stopPropagation(),B.preventDefault(),document.addEventListener("touchmove",A),document.addEventListener("touchend",S)}return[C,O,j]}function m(C){let b=document.body.offsetWidth-(C-document.body.offsetLeft);return`${Math.min(b/document.body.clientWidth*100,98).toFixed(2)}vw`}function D(){(0,i.useEffect)(()=>{if(document.body)return document.body.classList.add("body-drawer-open"),()=>{document.body.classList.remove("body-drawer-open")}},[])}const x=C=>({container:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",flex:"1 1 0",minHeight:"100%",position:"relative"}),drawer:(0,n.css)({top:0,".rc-drawer-content-wrapper":{boxShadow:C.shadows.z3}}),drawerContent:(0,n.css)({backgroundColor:`${C.colors.background.primary} !important`,display:"flex",overflow:"unset !important",flexDirection:"column"}),drawerMotion:(0,n.css)({"&-appear":{transform:"translateX(100%)",transition:"none !important","&-active":{transition:`${C.transitions.create("transform")} !important`,transform:"translateX(0)"}}}),mask:(0,n.css)({backgroundColor:"transparent !important",position:"fixed !important","&:before":{backgroundColor:`${C.components.overlay.background} !important`,backdropFilter:"blur(1px)",bottom:0,content:'""',left:0,position:"fixed",right:0,top:0}}),maskMotion:(0,n.css)({"&-appear":{opacity:0,"&-active":{opacity:1,transition:C.transitions.create("opacity")}}}),header:(0,n.css)({label:"drawer-header",flexGrow:0,padding:C.spacing(2,2,3),borderBottom:`1px solid ${C.colors.border.weak}`}),headerWithTabs:(0,n.css)({borderBottom:"none"}),actions:(0,n.css)({position:"absolute",right:C.spacing(1),top:C.spacing(1)}),titleWrapper:(0,n.css)({label:"drawer-title",overflowWrap:"break-word"}),subtitle:(0,n.css)({label:"drawer-subtitle",color:C.colors.text.secondary,paddingTop:C.spacing(1)}),content:(0,n.css)({padding:C.spacing(2),height:"100%",flexGrow:1}),tabsWrapper:(0,n.css)({label:"drawer-tabs",paddingLeft:C.spacing(2),margin:C.spacing(1,-1,-3,-3)}),resizer:(0,n.css)({top:0,left:C.spacing(-1),bottom:0,position:"absolute",zIndex:C.zIndex.modal})});function E(C,b){return(0,n.css)({label:`drawer-content-wrapper-${b}`,overflow:"unset !important",[C.breakpoints.down("md")]:{width:`calc(100% - ${C.spacing(2)}) !important`,minWidth:"0 !important"}})}},9261:(_,L,e)=>{"use strict";e.d(L,{f:()=>p});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(85690),i=e(96540),l=e(40845),d=e(38138),o=e(64539),u=e(27746);const c=y=>{const{className:f,options:v,value:P,onChange:m,narrow:D,variant:x,...E}=y,C=(0,l.of)(h),[b,T]=(0,i.useState)(!1),A=[(0,r.cY)(0),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:R,refs:S,floatingStyles:O}=(0,s.we)({open:b,placement:"bottom-end",onOpenChange:T,middleware:A,whileElementsMounted:a.ll}),j=(0,s.kp)(R),B=(0,s.s9)(R),{getReferenceProps:N,getFloatingProps:I}=(0,s.bv)([B,j]),K=w=>{m(w),T(!1)};return(0,t.jsxs)("div",{className:C.wrapper,children:[(0,t.jsx)(u.I,{className:f,isOpen:b,narrow:D,variant:x,ref:S.setReference,...N(),...E,children:P?.label||(P?.value!=null?String(P?.value):null)}),b&&(0,t.jsx)("div",{className:C.menuWrapper,ref:S.setFloating,...I(),style:O,children:(0,t.jsx)(g.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)(d.W,{tabIndex:-1,onClose:()=>T(!1),children:v.map(w=>(0,t.jsx)(o.D,{label:w.label??String(w.value),onClick:()=>K(w),active:w.value===P?.value,ariaChecked:w.value===P?.value,ariaLabel:w.ariaLabel||w.label,disabled:w.isDisabled,component:w.component,role:"menuitemradio"},`${w.value}`))})})})]})};c.displayName="ButtonSelect";const p=(0,i.memo)(c),h=y=>({wrapper:(0,n.css)({position:"relative",display:"inline-flex"}),menuWrapper:(0,n.css)({zIndex:y.zIndex.dropdown})})},83122:(_,L,e)=>{"use strict";e.d(L,{m:()=>c});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(96540),i=e(86634),l=e(40845),d=e(67892),o=e(18976),u=e(17464);const c=g.memo(({children:h,overlay:y,placement:f,offset:v,onVisibleChange:P})=>{const[m,D]=(0,g.useState)(!1),x=(0,g.useRef)(null),E=(0,g.useCallback)(w=>{D(w),P?.(w)},[P]),C=[(0,r.cY)({mainAxis:v?.[0]??8,crossAxis:v?.[1]??0}),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:b,refs:T,floatingStyles:A}=(0,s.we)({open:m,placement:(0,o.O)(f),onOpenChange:E,middleware:C,whileElementsMounted:a.ll}),R=(0,s.kp)(b),S=(0,s.s9)(b),{getReferenceProps:O,getFloatingProps:j}=(0,s.bv)([S,R]),B=150,N=(0,l.of)(p,B),I=()=>{E(!1)},K=w=>{w.key==="Tab"&&E(!1)};return(0,t.jsxs)(t.Fragment,{children:[g.cloneElement(h,{ref:T.setReference,...O()}),m&&(0,t.jsx)(u.ZL,{children:(0,t.jsx)(s.s3,{context:b,children:(0,t.jsx)("div",{ref:T.setFloating,style:A,onClick:I,onKeyDown:K,children:(0,t.jsx)(i.A,{nodeRef:x,appear:!0,in:!0,timeout:{appear:B,exit:0,enter:0},classNames:N,children:(0,t.jsx)("div",{ref:x,children:d.renderOrCallToRender(y,{...j()})})})})})})]})});c.displayName="Dropdown";const p=(h,y)=>({appear:(0,n.css)({opacity:"0",position:"relative",transformOrigin:"top",[h.transitions.handleMotion("no-preference")]:{transform:"scaleY(0.5)"}}),appearActive:(0,n.css)({opacity:"1",[h.transitions.handleMotion("no-preference")]:{transform:"scaleY(1)",transition:`transform ${y}ms cubic-bezier(0.2, 0, 0.2, 1), opacity ${y}ms cubic-bezier(0.2, 0, 0.2, 1)`}})})},41670:(_,L,e)=>{"use strict";e.d(L,{Z:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g})=>{const i=(0,r.of)(a);return(0,t.jsx)("div",{className:i.container,children:g})},a=g=>({container:(0,n.css)({borderLeft:`3px solid ${g.colors.info.main}`,backgroundColor:`${g.colors.background.secondary}`,padding:g.spacing(2),minWidth:"350px",borderRadius:g.shape.radius.default,marginBottom:g.spacing(4)})})},69529:(_,L,e)=>{"use strict";e.d(L,{p:()=>x});var t=e(74848),n=e(32196),r=e(8867),s=e(40845),a=e(90613),g=e(67061),i=e(94753),l=e(36348);const d=({width:b="auto",height:T})=>{const A=(0,s.of)(o);return(0,t.jsx)(r.default,{src:l,className:A.svg,height:T,width:b})};d.displayName="GrotCTA";const o=b=>({svg:(0,n.css)({"#grot-cta-cactus-1, #grot-cta-cactus-2":{fill:b.isDark?"#58558c":"#c9c5f4"}})});var u=e(96540),c=e(22687);const p=-20,h=5,y=-5,f=5,v=({width:b="auto",height:T})=>{const A=(0,u.useRef)(null),R=(0,s.of)(P);return(0,u.useEffect)(()=>{const S=O=>{if(window.matchMedia("(prefers-reduced-motion: reduce").matches)return;const j=A.current?.querySelector("#grot-not-found-arm"),B=A.current?.querySelector("#grot-not-found-magnifier"),{clientX:N,clientY:I}=O,{innerWidth:K,innerHeight:w}=window,U=I/w,W=N/K,H=m(U,p,h),z=m(W,y,f);window.requestAnimationFrame(()=>{j?.setAttribute("style",`transform: rotate(${H}deg) translateX(${z}%)`),B?.setAttribute("style",`transform: rotate(${H}deg) translateX(${z}%)`)})};return window.addEventListener("mousemove",S),()=>{window.removeEventListener("mousemove",S)}},[]),(0,t.jsx)(r.default,{innerRef:A,src:c,className:R.svg,height:T,width:b})};v.displayName="GrotNotFound";const P=b=>({svg:(0,n.css)({"#grot-not-found-arm, #grot-not-found-magnifier":{transformOrigin:"center"}})}),m=(b,T,A)=>b*(A-T)+T;var D=e(9886);const x=({button:b,children:T,image:A,message:R,hideImage:S=!1,variant:O,role:j})=>{const B=(0,s.of)(C),N=A??E(O);return(0,t.jsx)(a.a,{paddingY:4,display:"flex",direction:"column",alignItems:"center",role:j,children:(0,t.jsxs)("div",{className:B.container,children:[!S&&N,(0,t.jsxs)(g.B,{direction:"column",alignItems:"center",children:[(0,t.jsx)(i.E,{variant:"h4",textAlignment:"center",children:R}),T&&(0,t.jsx)(i.E,{color:"secondary",textAlignment:"center",children:T})]}),b]})})};function E(b){switch(b){case"call-to-action":return(0,t.jsx)(d,{width:300});case"not-found":return(0,t.jsx)(v,{width:300});case"completed":return(0,t.jsx)(r.default,{src:D,width:300});default:throw new Error(`Unknown variant: ${b}`)}}const C=b=>({container:(0,n.css)({display:"flex",flexDirection:"column",alignItems:"center",gap:b.spacing(4),maxWidth:"600px"})})},66602:(_,L,e)=>{"use strict";e.d(L,{Xc:()=>l,Xw:()=>i,tH:()=>g});var t=e(74848),n=e(96540),r=e(32631),s=e(42418),a=e(52446);class g extends n.PureComponent{constructor(){super(...arguments),this.state={error:null,errorInfo:null}}componentDidCatch(o,u){r.P?.api?.pushError(o),this.setState({error:o,errorInfo:u}),this.props.onError&&this.props.onError(o)}componentDidUpdate(o){const{dependencies:u,onRecover:c}=this.props;if(this.state.error&&u&&o.dependencies){for(let p=0;p<u.length;p++)if(u[p]!==o.dependencies[p]){this.setState({error:null,errorInfo:null}),c&&c();break}}}render(){const{children:o}=this.props,{error:u,errorInfo:c}=this.state;return o({error:u,errorInfo:c})}}class i extends n.PureComponent{static{this.defaultProps={title:"An unexpected error happened",style:"alertbox"}}render(){const{title:o,children:u,style:c,dependencies:p}=this.props;return(0,t.jsx)(g,{dependencies:p,children:({error:h,errorInfo:y})=>y?c==="alertbox"?(0,t.jsx)(s.F,{title:o||"",children:(0,t.jsxs)("details",{style:{whiteSpace:"pre-wrap"},children:[h&&h.toString(),(0,t.jsx)("br",{}),y.componentStack]})}):(0,t.jsx)(a.D,{title:o||"",error:h,errorInfo:y}):u})}}function l(d,o={}){const u=c=>(0,t.jsx)(i,{...o,children:(0,t.jsx)(d,{...c})});return u.displayName="WithErrorBoundary",u}},29678:(_,L,e)=>{"use strict";e.d(L,{y:()=>s});var t=e(74848),n=e(41987),r=e(39938);const s=({featureState:g,tooltip:i})=>{const l=a(g);return(0,t.jsx)(r.E,{text:l.text,color:l.color,icon:l.icon,tooltip:i})};function a(g){switch(g){case n.Ay.alpha:return{text:"Alpha",icon:"exclamation-triangle",color:"orange"};case n.Ay.beta:return{text:"Beta",icon:"rocket",color:"blue"};case n.Ay.experimental:return{text:"Experimental",icon:"exclamation-triangle",color:"orange"};case n.Ay.preview:return{text:"Preview",icon:"rocket",color:"blue"};case n.Ay.privatePreview:return{text:"Private preview",icon:"rocket",color:"blue"}}}},37270:(_,L,e)=>{"use strict";e.d(L,{gH:()=>p,wI:()=>f});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(20978),i=e(47172),l=e(83195),d=e(40845),o=e(42418),u=e(14578),c=e(73569);function p({options:x,children:E,readAs:C,onLoad:b,fileListRenderer:T,onFileRemove:A}){const[R,S]=(0,a.useState)([]),[O,j]=(0,a.useState)([]),B=(0,l.j_)("decbytes")(x?.maxSize?x?.maxSize:0),N=(0,a.useCallback)((q,te)=>{S(X=>X.map(ee=>(ee.id===q.id&&te(ee),ee)))},[]),I=(0,a.useCallback)((q,te,X)=>{let ee=q.map(m);if(x?.multiple===!1?S(ee):S(ne=>[...ne,...ee]),M(te),x?.onDrop)x.onDrop(q,te,X);else for(const ne of ee){const Z=new FileReader,ae=()=>{C?Z[C](ne.file):Z.readAsText(ne.file)};N(ne,re=>{re.abortUpload=()=>{Z.abort()},re.retryUpload=()=>{N(ne,se=>{se.error=null,se.progress=void 0}),ae()}}),Z.onabort=()=>{N(ne,re=>{re.error=new DOMException("Aborted")})},Z.onprogress=re=>{N(ne,se=>{se.progress=re.loaded})},Z.onload=()=>{b?.(Z.result)},Z.onerror=()=>{N(ne,re=>{re.error=Z.error})},ae()}},[b,x,C,N]),K=q=>{const te=R.filter(X=>q.id!==X.id);S(te),A?.(q)},{getRootProps:w,getInputProps:U,isDragActive:W}=(0,g.VB)({...x,useFsAccessApi:!1,onDrop:I,accept:y(x?.accept)}),H=(0,d.$j)(),z=D(H,W),G=R.map(q=>T?T(q,K):(0,t.jsx)(c.I,{file:q,removeFile:K},q.id)),M=q=>{let te=[];q.map(X=>{X.errors.map(ee=>{te.findIndex(ne=>ne.code===ee.code&&ne.message===ee.message)===-1&&te.push(ee)})}),j(te)},Q=q=>(0,t.jsx)("div",{className:z.errorAlert,children:(0,t.jsx)(o.F,{title:"Upload failed",severity:"error",onRemove:Y,children:q.map(te=>{switch(te.code){case i.O4.FileTooLarge:return(0,t.jsxs)("div",{children:["File is larger than ",(0,l.cN)(B)]},te.message+te.code);default:return(0,t.jsx)("div",{children:te.message},te.message+te.code)}})})}),Y=()=>{j([])};return(0,t.jsxs)("div",{className:z.container,children:[(0,t.jsxs)("div",{"data-testid":"dropzone",...w({className:z.dropzone}),children:[(0,t.jsx)("input",{...U()}),E??(0,t.jsx)(f,{primaryText:v(R,x)})]}),O.length>0&&Q(O),(0,t.jsxs)("small",{className:(0,n.cx)(z.small,z.acceptContainer),children:[x?.maxSize&&`Max file size: ${(0,l.cN)(B)}`,x?.maxSize&&x?.accept&&(0,t.jsx)("span",{className:z.acceptSeparator,children:"|"}),x?.accept&&P(x.accept)]}),G]})}function h(x){return["txt","json","csv","xls","yml"].some(E=>x.match(E))?"text/plain":"application/octet-stream"}function y(x){return(0,r.isString)(x)?{[h(x)]:[x]}:Array.isArray(x)?x.reduce((E,C)=>{const b=h(C);return E[b]=E[b]?[...E[b],C]:[C],E},{}):x}function f({primaryText:x="Drop file here or click to upload",secondaryText:E=""}){const C=(0,d.$j)(),b=D(C);return(0,t.jsxs)("div",{className:(0,n.cx)(b.defaultDropZone),"data-testid":"file-drop-zone-default-children",children:[(0,t.jsx)(u.I,{className:(0,n.cx)(b.icon),name:"upload",size:"xl"}),(0,t.jsx)("h6",{className:(0,n.cx)(b.primaryText),children:x}),(0,t.jsx)("small",{className:b.small,children:E})]})}function v(x,E){return E?.multiple===void 0||E?.multiple?"Upload file":x.length?"Replace file":"Upload file"}function P(x){return(0,r.isString)(x)?`Accepted file type: ${x}`:Array.isArray(x)?`Accepted file types: ${x.join(", ")}`:`Accepted file types: ${Object.values(x).flat().join(", ")}`}function m(x){return{id:(0,r.uniqueId)("file"),file:x,error:null}}function D(x,E){return{container:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",padding:x.spacing(2),borderRadius:x.shape.radius.default,border:`1px dashed ${x.colors.border.strong}`,backgroundColor:E?x.colors.background.secondary:x.colors.background.primary,cursor:"pointer",alignItems:"center",justifyContent:"center"}),dropzone:(0,n.css)({height:"100%",width:"100%",display:"flex",flexDirection:"column"}),defaultDropZone:(0,n.css)({textAlign:"center"}),icon:(0,n.css)({marginBottom:x.spacing(1)}),primaryText:(0,n.css)({marginBottom:x.spacing(1)}),acceptContainer:(0,n.css)({textAlign:"center",margin:0}),acceptSeparator:(0,n.css)({margin:`0 ${x.spacing(1)}`}),small:(0,n.css)({color:x.colors.text.secondary}),errorAlert:(0,n.css)({paddingTop:"10px"})}}},73569:(_,L,e)=>{"use strict";e.d(L,{I:()=>o});var t=e(74848),n=e(32196),r=e(83195),s=e(40845),a=e(53550),g=e(55852),i=e(14578),l=e(29158);const d="Remove file";function o({file:c,removeFile:p}){const h=(0,s.of)(u),{file:y,progress:f,error:v,abortUpload:P,retryUpload:m}=c,D=()=>v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:h.error,children:v.message}),m&&(0,t.jsx)(l.K,{name:"sync",tooltip:"Retry",tooltipPlacement:"top",onClick:m}),p&&(0,t.jsx)(l.K,{className:m?h.marginLeft:"",name:"trash-alt",onClick:()=>p(c),tooltip:d})]}):f&&y.size>f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("progress",{className:h.progressBar,max:y.size,value:f}),(0,t.jsxs)("span",{className:h.paddingLeft,children:[Math.round(f/y.size*100),"%"]}),P&&(0,t.jsx)(g.$n,{variant:"secondary",type:"button",fill:"text",onClick:P,children:"Cancel upload"})]}):p&&(0,t.jsx)(l.K,{name:"trash-alt",onClick:()=>p(c),tooltip:d,tooltipPlacement:"top"}),x=(0,r.j_)("decbytes")(y.size);return(0,t.jsxs)("div",{className:h.fileListContainer,children:[(0,t.jsxs)("span",{className:h.fileNameWrapper,children:[(0,t.jsx)(i.I,{name:"file-blank",size:"lg","aria-hidden":!0}),(0,t.jsx)("span",{className:h.padding,children:(0,a.i)(y.name)}),(0,t.jsx)("span",{children:(0,r.cN)(x)})]}),(0,t.jsx)("div",{className:h.fileNameWrapper,children:D()})]})}function u(c){return{fileListContainer:(0,n.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:c.spacing(2),border:`1px dashed ${c.colors.border.medium}`,backgroundColor:`${c.colors.background.secondary}`,marginTop:c.spacing(1)}),fileNameWrapper:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center"}),padding:(0,n.css)({padding:c.spacing(0,1)}),paddingLeft:(0,n.css)({paddingLeft:c.spacing(2)}),marginLeft:(0,n.css)({marginLeft:c.spacing(1)}),error:(0,n.css)({paddingRight:c.spacing(2),color:c.colors.error.text}),progressBar:(0,n.css)({borderRadius:c.shape.radius.default,height:"4px","::-webkit-progress-bar":{backgroundColor:c.colors.border.weak,borderRadius:c.shape.radius.default},"::-webkit-progress-value":{backgroundColor:c.colors.primary.main,borderRadius:c.shape.radius.default}})}}},73546:(_,L,e)=>{"use strict";e.d(L,{e:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(62938),a=e(13544),g=e(40845),i=e(16797),l=e(53550),d=e(55852),o=e(14578);const u=({onFileUpload:p,className:h,children:y="Upload file",accept:f="*",size:v="md",showFileName:P})=>{const m=(0,g.of)(c(v)),[D,x]=(0,r.useState)(""),E=(0,s.A)(),C=(0,r.useCallback)(b=>{const T=b.currentTarget?.files?.[0];T&&x(T.name??""),p(b)},[p]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"file",id:E,className:m.fileUpload,onChange:C,multiple:!1,accept:f,"data-testid":a.Tp.components.FileUpload.inputField}),(0,t.jsxs)("label",{htmlFor:E,className:(0,n.cx)(m.labelWrapper,h),children:[(0,t.jsx)(o.I,{name:"upload",className:m.icon}),y]}),P&&D&&(0,t.jsx)("span",{"aria-label":"File name",className:m.fileName,"data-testid":a.Tp.components.FileUpload.fileNameSpan,children:(0,l.i)(D)})]})},c=p=>h=>{const y=(0,d.hs)({theme:h,variant:"primary",size:p,iconOnly:!1}),f=(0,i.getFocusStyles)(h);return{fileUpload:(0,n.css)({height:"0.1px",opacity:"0",overflow:"hidden",position:"absolute",width:"0.1px",zIndex:-1,"&:focus + label":f,"&:focus-visible + label":f}),labelWrapper:y.button,icon:y.icon,fileName:(0,n.css)({marginLeft:h.spacing(.5)})}}},67647:(_,L,e)=>{"use strict";e.d(L,{Z:()=>l});var t=e(74848),n=e(96540),r=e(54479);function s(...d){const o=n.useRef(null);return n.useEffect(()=>{d.forEach(u=>{u&&(typeof u=="function"?u(o.current):u.current=o.current)})},[d]),o}var a=e(55852),g=e(14578),i=e(10354);const l=(0,n.forwardRef)(({value:d,width:o,onChange:u,escapeRegex:c=!0,...p},h)=>{const y=(0,n.useRef)(null),f=s(h,y),v=d!==""?(0,t.jsx)(a.$n,{icon:"times",fill:"text",size:"sm",onClick:P=>{y.current?.focus(),u(""),P.stopPropagation()},children:"Clear"}):null;return(0,t.jsx)(i.p,{prefix:(0,t.jsx)(g.I,{name:"search"}),suffix:v,width:o,type:"text",value:c?(0,r.xb)(d??""):d,onChange:P=>u(c?(0,r.jD)(P.currentTarget.value):P.currentTarget.value),...p,ref:f})});l.displayName="FilterInput"},92174:(_,L,e)=>{"use strict";e.d(L,{m:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(55852),a=e(14578);const g=({label:l,selected:d,onClick:o,icon:u="check"})=>{const c=(0,r.of)(i),p=(0,r.of)(s.my);return(0,t.jsxs)("button",{type:"button",className:(0,n.cx)(p,c.wrapper,d&&c.selected),onClick:o,children:[(0,t.jsx)("span",{children:l}),d&&(0,t.jsx)(a.I,{name:u,className:c.icon})]})},i=l=>({wrapper:(0,n.css)({background:l.colors.background.secondary,borderRadius:l.shape.radius.pill,padding:l.spacing(0,2),fontSize:l.typography.bodySmall.fontSize,fontWeight:l.typography.fontWeightMedium,lineHeight:l.typography.bodySmall.lineHeight,color:l.colors.text.secondary,display:"flex",alignItems:"center",height:"32px",position:"relative",border:`1px solid ${l.colors.background.secondary}`,whiteSpace:"nowrap","&:hover":{background:l.colors.action.hover,color:l.colors.text.primary}}),selected:(0,n.css)({color:l.colors.text.primary,background:l.colors.action.selected,"&:hover":{background:l.colors.action.focus}}),icon:(0,n.css)({marginLeft:l.spacing(.5)})})},90090:(_,L,e)=>{"use strict";e.d(L,{z:()=>s});var t=e(74848),n=e(32196),r=e(38894);const s=({label:g,tooltip:i,labelWidth:l=6,inputWidth:d=12,inputEl:o,className:u,interactive:c,...p})=>{const h=a();return(0,t.jsxs)("div",{className:(0,n.cx)(h.formField,u),children:[(0,t.jsx)(r.I,{width:l,tooltip:i,interactive:c,children:g}),o||(0,t.jsx)("input",{type:"text",className:`gf-form-input ${d?`width-${d}`:""}`,...p,disabled:p.disabled})]})};s.displayName="FormField";const a=()=>({formField:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative"})})},38894:(_,L,e)=>{"use strict";e.d(L,{I:()=>i});var t=e(74848),n=e(46942),r=e.n(n),s=e(14578),a=e(56034);const i=({children:l,isFocused:d,isInvalid:o,className:u,htmlFor:c,tooltip:p,width:h,interactive:y,...f})=>{const v=r()(u,`gf-form-label width-${h||"10"}`,{"gf-form-label--is-focused":d,"gf-form-label--is-invalid":o});return(0,t.jsxs)("label",{className:v,...f,htmlFor:c,children:[l,p&&(0,t.jsx)(a.m,{placement:"top",content:p,theme:"info",interactive:y,children:(0,t.jsx)(s.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]})}},9286:(_,L,e)=>{"use strict";e.d(L,{i:()=>r});var t=e(74848);function n(s){return s<20?.9:s<26?.8:.6}const r=({value:s,className:a,style:g,...i})=>{const l=(s.prefix??"").length>0,d=(s.suffix??"").length>0;let o;if(g&&g.fontSize&&typeof g.fontSize=="number"){const u=g.fontSize,c=n(u);o={fontSize:u*c}}return(0,t.jsx)("div",{className:a,style:g,...i,children:(0,t.jsxs)("div",{children:[l&&(0,t.jsx)("span",{children:s.prefix}),(0,t.jsx)("span",{children:s.text}),d&&(0,t.jsx)("span",{style:o,children:s.suffix})]})})};r.displayName="FormattedDisplayValue"},10880:(_,L,e)=>{"use strict";e.d(L,{S:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(16797),g=e(60029);const i=r.forwardRef(({label:d,description:o,value:u,htmlValue:c,onChange:p,disabled:h,className:y,indeterminate:f,invalid:v,...P},m)=>{const D=(0,r.useCallback)(C=>{p&&p(C)},[p]),x=(0,s.of)(l,v),E=f?"mixed":void 0;return(0,t.jsxs)("label",{className:(0,n.cx)(x.wrapper,y),children:[(0,t.jsxs)("div",{className:x.checkboxWrapper,children:[(0,t.jsx)("input",{type:"checkbox",className:(0,n.cx)(x.input,f&&x.inputIndeterminate),checked:u,disabled:h,onChange:D,value:c,"aria-checked":E,...P,ref:m}),(0,t.jsx)("span",{className:x.checkmark})]}),d&&(0,t.jsx)("span",{className:x.label,children:d}),o&&(0,t.jsx)("span",{className:x.description,children:o})]})}),l=(d,o=!1)=>{const u=(0,g.f)(d),c=2,p=1,h=y=>o?d.colors.error.border:y;return{wrapper:(0,n.css)({display:"inline-grid",alignItems:"center",columnGap:d.spacing(p),gridAutoRows:"max-content",position:"relative",verticalAlign:"middle"}),input:(0,n.css)({position:"absolute",zIndex:1,top:0,left:0,width:"100% !important",height:"100%",opacity:0,"&:focus + span, &:focus-visible + span":(0,a.getFocusStyles)(d),"&:focus:not(:focus-visible) + span":(0,a.getMouseFocusStyles)(d),"&:checked + span":{background:d.colors.primary.main,border:`1px solid ${h(d.colors.primary.main)}`,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"4px",top:0,width:"6px",height:"12px",border:`solid ${d.colors.primary.contrastText}`,borderWidth:"0 3px 3px 0",transform:"rotate(45deg)"}},"&:disabled + span":{backgroundColor:d.colors.action.disabledBackground,cursor:"not-allowed",border:`1px solid ${h(d.colors.action.disabledBackground)}`,"&:hover":{backgroundColor:d.colors.action.disabledBackground},"&:after":{borderColor:d.colors.action.disabledText}}}),inputIndeterminate:(0,n.css)({"&[aria-checked='mixed'] + span":{border:`1px solid ${h(d.colors.primary.main)}`,background:d.colors.primary.main,"&:hover":{background:d.colors.primary.shade},"&:after":{content:'""',position:"absolute",zIndex:2,left:"2px",right:"2px",top:"calc(50% - 1.5px)",height:"3px",border:`1.5px solid ${d.colors.primary.contrastText}`,backgroundColor:d.colors.primary.contrastText,width:"auto",transform:"none"}},"&:disabled[aria-checked='mixed'] + span":{backgroundColor:d.colors.action.disabledBackground,border:`1px solid ${h(d.colors.error.transparent)}`,"&:after":{borderColor:d.colors.action.disabledText}}}),checkboxWrapper:(0,n.css)({display:"flex",alignItems:"center",gridColumnStart:1,gridRowStart:1}),checkmark:(0,n.css)({position:"relative",zIndex:2,display:"inline-block",width:d.spacing(c),height:d.spacing(c),borderRadius:d.shape.radius.default,background:d.components.input.background,border:`1px solid ${h(d.components.input.borderColor)}`,"&:hover":{cursor:"pointer",borderColor:h(d.components.input.borderHover)}}),label:(0,n.cx)(u.label,(0,n.css)({gridColumnStart:2,gridRowStart:1,position:"relative",zIndex:2,cursor:"pointer",maxWidth:"fit-content",lineHeight:d.typography.bodySmall.lineHeight,marginBottom:0})),description:(0,n.cx)(u.description,(0,n.css)({gridColumnStart:2,gridRowStart:2,lineHeight:d.typography.bodySmall.lineHeight,marginTop:0}))}};i.displayName="Checkbox"},88575:(_,L,e)=>{"use strict";e.d(L,{D:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(67892),g=e(72093),i=e(60029);const l=r.forwardRef(({label:u,description:c,horizontal:p,invalid:h,loading:y,disabled:f,required:v,error:P,children:m,className:D,validationMessageHorizontalOverflow:x,htmlFor:E,...C},b)=>{const T=(0,s.of)(o),A=E??(0,a.getChildId)(m),R=typeof u=="string"?(0,t.jsx)(i.J,{htmlFor:A,description:c,children:`${u}${v?" *":""}`}):u,S=d({invalid:h,disabled:f,loading:y});return(0,t.jsxs)("div",{className:(0,n.cx)(T.field,p&&T.fieldHorizontal,D),...C,children:[R,(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{ref:b,children:r.cloneElement(m,S)}),h&&P&&!p&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper,{[T.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(g.P,{children:P})})]}),h&&P&&p&&(0,t.jsx)("div",{className:(0,n.cx)(T.fieldValidationWrapper,T.fieldValidationWrapperHorizontal,{[T.validationMessageHorizontalOverflow]:!!x}),children:(0,t.jsx)(g.P,{children:P})})]})});l.displayName="Field";function d(u){for(const c in u)u[c]===void 0&&delete u[c];return u}const o=u=>({field:(0,n.css)({display:"flex",flexDirection:"column",marginBottom:u.spacing(2)}),fieldHorizontal:(0,n.css)({flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),fieldValidationWrapper:(0,n.css)({marginTop:u.spacing(.5)}),fieldValidationWrapperHorizontal:(0,n.css)({flex:"1 1 100%"}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},84167:(_,L,e)=>{"use strict";e.d(L,{n:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(17408);const a=({label:i,children:l,className:d,...o})=>{const u=(0,r.of)(g);return(0,t.jsxs)("fieldset",{className:(0,n.cx)(u.wrapper,d),...o,children:[i&&(0,t.jsx)(s.s,{children:i}),l]})},g=i=>({wrapper:(0,n.css)({marginBottom:i.spacing(4),"&:last-child":{marginBottom:0}})})},72093:(_,L,e)=>{"use strict";e.d(L,{P:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(14578);const a=({children:i,horizontal:l,className:d})=>{const o=(0,r.of)(g),u=(0,n.cx)(l?o.horizontal:o.vertical,d);return(0,t.jsxs)("div",{role:"alert",className:u,children:[(0,t.jsx)(s.I,{className:o.fieldValidationMessageIcon,name:"exclamation-triangle"}),i]})},g=i=>{const l=`
      font-size: ${i.typography.size.sm};
      font-weight: ${i.typography.fontWeightMedium};
      padding: ${i.spacing(.5,1)};
      color: ${i.colors.error.contrastText};
      background: ${i.colors.error.main};
      border-radius: ${i.shape.radius.default};
      position: relative;
      display: inline-block;
      align-self: flex-start;

      a {
        color: ${i.colors.error.contrastText};
        text-decoration: underline;
      }

      a:hover {
        text-decoration: none;
      }
    `;return{vertical:(0,n.css)(l,{margin:i.spacing(.5,0,0,0),"&:before":{content:'""',position:"absolute",left:"9px",top:"-5px",width:0,height:0,borderWidth:"0 4px 5px 4px",borderColor:`transparent transparent ${i.colors.error.main} transparent`,borderStyle:"solid"}}),horizontal:(0,n.css)(l,{marginLeft:"10px","&:before":{content:'""',position:"absolute",left:"-5px",top:"9px",width:0,height:0,borderWidth:"4px 5px 4px 0",borderColor:"transparent #e02f44 transparent transparent",borderStyle:"solid"}}),fieldValidationMessageIcon:(0,n.css)({marginRight:i.spacing()})}}},51253:(_,L,e)=>{"use strict";e.d(L,{l:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(49785);function a({defaultValues:g,onSubmit:i,validateOnMount:l=!1,validateFieldsOnMount:d,children:o,validateOn:u="onSubmit",maxWidth:c=600,...p}){const{handleSubmit:h,trigger:y,formState:f,...v}=(0,s.mN)({mode:u,defaultValues:g});return(0,r.useEffect)(()=>{l&&y(d)},[y,d,l]),(0,t.jsx)("form",{className:(0,n.css)({maxWidth:c!=="none"?c+"px":c,width:"100%"}),onSubmit:h(i),...p,children:o({errors:f.errors,formState:f,trigger:y,...v})})}},14186:(_,L,e)=>{"use strict";e.d(L,{I:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(67892),g=e(72093),i=e(76892);const l=({children:o,label:u,tooltip:c,labelWidth:p="auto",invalid:h,loading:y,disabled:f,required:v,className:P,htmlFor:m,grow:D,shrink:x,error:E,transparent:C,interactive:b,validationMessageHorizontalOverflow:T,...A})=>{const R=(0,s.$j)(),S=d(R,D,x),O=m??(0,a.getChildId)(o),j=typeof u=="string"?(0,t.jsx)(i.c,{interactive:b,width:p,tooltip:c,htmlFor:O,transparent:C,children:`${u}${v?" *":""}`}):u;return(0,t.jsxs)("div",{className:(0,n.cx)(S.container,P),...A,children:[j,(0,t.jsxs)("div",{className:S.childContainer,children:[(0,r.cloneElement)(o,{invalid:h,disabled:f,loading:y}),h&&E&&(0,t.jsx)("div",{className:(0,n.cx)(S.fieldValidationWrapper,{[S.validationMessageHorizontalOverflow]:!!T}),children:(0,t.jsx)(g.P,{children:E})})]})]})};l.displayName="InlineField";const d=(o,u,c)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${u?1:0} ${c?1:0} auto`,margin:`0 ${o.spacing(.5)} ${o.spacing(.5)} 0`}),childContainer:(0,n.css)({flex:`${u?1:0} ${c?1:0} auto`}),fieldValidationWrapper:(0,n.css)({marginTop:o.spacing(.5)}),validationMessageHorizontalOverflow:(0,n.css)({width:0,overflowX:"visible","& > *":{whiteSpace:"nowrap"}})})},39268:(_,L,e)=>{"use strict";e.d(L,{C:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,className:i,...l})=>{const d=(0,r.of)(a);return(0,t.jsx)("div",{className:(0,n.cx)(d.container,i),...l,children:g})},a=g=>({container:(0,n.css)({label:"InlineFieldRow",display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start",rowGap:g.spacing(.5)})})},76892:(_,L,e)=>{"use strict";e.d(L,{c:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(14578),a=e(56034);const g=({children:l,className:d,tooltip:o,width:u,transparent:c,interactive:p,as:h="label",...y})=>{const f=(0,r.of)(i,c,u);return(0,t.jsxs)(h,{className:(0,n.cx)(f.label,d),...y,children:[l,o&&(0,t.jsx)(a.m,{interactive:p,placement:"top",content:o,theme:"info",children:(0,t.jsx)(s.I,{tabIndex:0,name:"info-circle",size:"sm",className:f.icon})})]})},i=(l,d=!1,o)=>({label:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0,padding:l.spacing(0,1),fontWeight:l.typography.fontWeightMedium,fontSize:l.typography.size.sm,backgroundColor:d?"transparent":l.colors.background.secondary,height:l.spacing(l.components.height.md),lineHeight:l.spacing(l.components.height.md),marginRight:l.spacing(.5),borderRadius:l.shape.radius.default,border:"none",width:o?o!=="auto"?`${8*o}px`:o:"100%",color:l.colors.text.primary}),icon:(0,n.css)({color:l.colors.text.secondary,marginLeft:"10px",":hover":{color:l.colors.text.primary}})})},63056:(_,L,e)=>{"use strict";e.d(L,{e:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,className:i,grow:l,...d})=>{const o=(0,r.of)(a,l);return(0,t.jsx)("div",{className:(0,n.cx)(o.container,i),...d,children:g})};s.displayName="InlineSegmentGroup";const a=(g,i)=>({container:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",flex:`${i?1:0} 0 auto`,marginBottom:g.spacing(.5)})})},60029:(_,L,e)=>{"use strict";e.d(L,{J:()=>a,f:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(14578);const a=({children:i,description:l,className:d,category:o,...u})=>{const c=(0,r.of)(g),p=o?.map((h,y)=>(0,t.jsxs)("span",{className:c.categories,children:[(0,t.jsx)("span",{children:h}),(0,t.jsx)(s.I,{name:"angle-right",className:c.chevron})]},`${h}/${y}`));return(0,t.jsx)("div",{className:(0,n.cx)(c.label,d),children:(0,t.jsxs)("label",{...u,children:[(0,t.jsxs)("div",{className:c.labelContent,children:[p,i]}),l&&(0,t.jsx)("span",{className:c.description,children:l})]})})},g=i=>({label:(0,n.css)({label:"Label",fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightMedium,lineHeight:1.25,marginBottom:i.spacing(.5),color:i.colors.text.primary,maxWidth:"480px"}),labelContent:(0,n.css)({display:"flex",alignItems:"center"}),description:(0,n.css)({label:"Label-description",color:i.colors.text.secondary,fontSize:i.typography.size.sm,fontWeight:i.typography.fontWeightRegular,marginTop:i.spacing(.25),display:"block"}),categories:(0,n.css)({label:"Label-categories",display:"inline-flex",alignItems:"center"}),chevron:(0,n.css)({margin:i.spacing(0,.25)})})},91634:(_,L,e)=>{"use strict";e.d(L,{O:()=>g,p:()=>i});var t=e(74848),n=e(46942),r=e.n(n),s=e(96540),a=e(29734),g=(l=>(l.Invalid="invalid",l.Valid="valid",l))(g||{});class i extends s.PureComponent{constructor(){super(...arguments),this.state={error:null},this.validatorAsync=d=>o=>{const u=(0,a.tf)(o.target.value,d);this.setState(c=>({...c,error:u?u[0]:null}))},this.populateEventPropsWithStatus=(d,o)=>{const u={...d};return o&&Object.keys(a.Pw).forEach(c=>{((0,a.K)(c,o)||d[c])&&(u[c]=async p=>{p.persist(),(0,a.K)(c,o)&&await this.validatorAsync(o[c]).apply(this,[p]),d[c]&&d[c].apply(null,[p,this.status])})}),u}}static{this.defaultProps={className:""}}get status(){return this.state.error?"invalid":"valid"}get isInvalid(){return this.status==="invalid"}render(){const{validationEvents:d,className:o,hideErrorMessage:u,inputRef:c,...p}=this.props,{error:h}=this.state,y=r()("gf-form-input",{invalid:this.isInvalid},o),f=this.populateEventPropsWithStatus(p,d);return(0,t.jsxs)("div",{style:{flexGrow:1},children:[(0,t.jsx)("input",{...f,ref:c,className:y}),h&&!u&&(0,t.jsx)("span",{children:h})]})}}},17408:(_,L,e)=>{"use strict";e.d(L,{s:()=>a});var t=e(74848),n=e(32196),r=e(40845);const s=g=>({legend:(0,n.css)({fontSize:g.typography.h3.fontSize,fontWeight:g.typography.fontWeightRegular,margin:g.spacing(0,0,2,0)})}),a=({children:g,className:i,...l})=>{const d=(0,r.of)(s);return(0,t.jsx)("legend",{className:(0,n.cx)(d.legend,i),...l,children:g})}},94354:(_,L,e)=>{"use strict";e.d(L,{z:()=>h});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(8887),g=e(40845),i=e(14578),l=e(13544),d=e(16797),o=e(56034),u=e(87266);const c=s.forwardRef(({children:f,active:v=!1,disabled:P=!1,size:m="md",onChange:D,onClick:x,id:E,name:C=void 0,description:b,fullWidth:T,"aria-label":A},R)=>{const S=(0,g.of)(p,m,T),O=(0,t.jsx)("input",{type:"radio",className:S.radio,onChange:D,onClick:x,disabled:P,id:E,checked:v,name:C,"aria-label":A,ref:R});return b?(0,t.jsxs)("div",{className:S.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[(0,t.jsx)(o.m,{content:b,placement:"bottom",children:O}),(0,t.jsx)("label",{className:S.radioLabel,htmlFor:E,title:b||A,children:f})]}):(0,t.jsxs)("div",{className:S.radioOption,"data-testid":l.Tp.components.RadioButton.container,children:[O,(0,t.jsx)("label",{className:S.radioLabel,htmlFor:E,title:b||A,children:f})]})});c.displayName="RadioButton";const p=(f,v,P)=>{const{fontSize:m,height:D,padding:x}=(0,u.SM)(v,f),E=f.colors.text.secondary,C=f.colors.text.primary,b=D*f.spacing.gridSize-4-2;return{radioOption:(0,n.css)({display:"flex",justifyContent:"space-between",position:"relative",flex:P?"1 0 0":"none",textAlign:"center"}),radio:(0,n.css)({position:"absolute",opacity:0,zIndex:2,width:"100% !important",height:"100%",cursor:"pointer","&:checked + label":{color:f.colors.text.primary,fontWeight:f.typography.fontWeightMedium,background:f.colors.action.selected,zIndex:1},"&:focus + label, &:focus-visible + label":(0,d.getFocusStyles)(f),"&:focus:not(:focus-visible) + label":(0,d.getMouseFocusStyles)(f),"&:disabled + label":{color:f.colors.text.disabled,cursor:"not-allowed"}}),radioLabel:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",fontSize:m,height:`${b}px`,lineHeight:`${b}px`,color:E,padding:f.spacing(0,x),borderRadius:f.shape.radius.default,background:f.colors.background.primary,cursor:"pointer",userSelect:"none",whiteSpace:"nowrap",flexGrow:1,"&:hover":{color:C}})}};function h({options:f,value:v,onChange:P,onClick:m,disabled:D,disabledOptions:x,size:E="md",id:C,className:b,fullWidth:T=!1,autoFocus:A=!1,"aria-label":R,invalid:S=!1}){const O=(0,s.useCallback)(w=>()=>{P&&P(w.value)},[P]),j=(0,s.useCallback)(w=>()=>{m&&m(w.value)},[m]),B=C??(0,r.uniqueId)("radiogroup-"),N=(0,s.useRef)(B),I=(0,g.of)(y),K=(0,s.useRef)(null);return(0,s.useEffect)(()=>{A&&K.current&&K.current.focus()},[A]),(0,t.jsx)("div",{role:"radiogroup","aria-label":R,className:(0,n.cx)(I.radioGroup,T&&I.fullWidth,S&&I.invalid,b),children:f.map((w,U)=>{const W=x&&w.value&&x.includes(w.value),H=w.icon?(0,a.Uo)(w.icon):void 0,z=!!(w.imgUrl||w.label||w.component);return(0,t.jsxs)(c,{size:E,disabled:W||D,active:v===w.value,"aria-label":w.ariaLabel,onChange:O(w),onClick:j(w),id:`option-${w.value}-${B}`,name:N.current,description:w.description,fullWidth:T,ref:v===w.value?K:void 0,children:[H&&(0,t.jsx)(i.I,{name:H,className:(0,n.cx)(z&&I.icon)}),w.imgUrl&&(0,t.jsx)("img",{src:w.imgUrl,alt:w.label,className:I.img}),w.label," ",w.component?(0,t.jsx)(w.component,{}):null]},`o.label-${U}`)})})}h.displayName="RadioButtonGroup";const y=f=>({radioGroup:(0,n.css)({backgroundColor:f.colors.background.primary,display:"inline-flex",flexDirection:"row",flexWrap:"nowrap",border:`1px solid ${f.components.input.borderColor}`,borderRadius:f.shape.radius.default,padding:"2px"}),fullWidth:(0,n.css)({display:"flex"}),icon:(0,n.css)({marginRight:"6px"}),img:(0,n.css)({width:f.spacing(2),height:f.spacing(2),marginRight:f.spacing(1)}),invalid:(0,n.css)({border:`1px solid ${f.colors.error.border}`})})},79569:(_,L,e)=>{"use strict";e.d(L,{J:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({id:g,name:i,label:l,checked:d,value:o,disabled:u,description:c,onChange:p,...h})=>{const y=(0,r.of)(a);return(0,t.jsxs)("label",{title:c,className:y.label,children:[(0,t.jsx)("input",{...h,id:g,name:i,type:"radio",checked:d,value:o,disabled:u,className:y.input,onChange:()=>p&&p(g)}),(0,t.jsxs)("div",{children:[l,c&&(0,t.jsx)("div",{className:y.description,children:c})]})]})},a=g=>({input:(0,n.css)({position:"relative",appearance:"none",outline:"none",backgroundColor:g.colors.background.canvas,width:`${g.spacing(2)} !important`,height:g.spacing(2),border:`1px solid ${g.colors.border.medium}`,borderRadius:g.shape.radius.circle,margin:"3px 0",":checked":{backgroundColor:g.v1.palette.white,border:`5px solid ${g.colors.primary.main}`},":disabled":{backgroundColor:`${g.colors.action.disabledBackground} !important`,borderColor:g.colors.border.weak},":disabled:checked":{border:`1px solid ${g.colors.border.weak}`},":disabled:checked::after":{content:'""',width:"6px",height:"6px",backgroundColor:g.colors.text.disabled,borderRadius:g.shape.radius.circle,display:"inline-block",position:"absolute",top:"4px",left:"4px"},":focus":{outline:"none !important",boxShadow:`0 0 0 1px ${g.colors.background.canvas}, 0 0 0 3px ${g.colors.primary.main}`}}),label:(0,n.css)({fontSize:g.typography.fontSize,lineHeight:"22px",display:"grid",gridTemplateColumns:`${g.spacing(2)} auto`,gap:g.spacing(1)}),description:(0,n.css)({fontSize:g.typography.size.sm,color:g.colors.text.secondary})})},83186:(_,L,e)=>{"use strict";e.d(L,{a:()=>i});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(40845),g=e(79569);function i({name:d,id:o,options:u,value:c,onChange:p,className:h,disabled:y,disabledOptions:f=[]}){const v=(0,a.of)(l),P=o??(0,r.uniqueId)("radiogroup-list-");return(0,t.jsx)("div",{id:o,className:(0,n.cx)(v.container,h),role:"radiogroup",children:u.map((m,D)=>{const x=`${P}-${D}`,E=c&&c===m.value,C=y||f.some(T=>T===m.value),b=()=>p&&m.value&&p(m.value);return(0,t.jsx)(g.J,{id:x,name:d,label:m.label,description:m.description,checked:E,value:m.value,disabled:C,onChange:b},D)})})}const l=d=>({container:(0,n.css)({display:"grid",gap:d.spacing(1)})})},95164:(_,L,e)=>{"use strict";e.d(L,{_:()=>f});var t=e(74848),n=e(34796),r=e.n(n),s=e(96540),a=e(83195),g=e(58649),i=e(50082),l=e(52622),d=e(29413),o=e(55852),u=e(24293),c=e(47737);const p={mode:i.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]};function h(v,P,m,D){const x=m!=null,E=D===l.wV.Vertical?P:v,C=Math.min(E*.15/1.5,20),b=C*1.5,T=x?P-b:P,A=Math.min(T,v);return{showLabel:x,gaugeHeight:A,titleFontSize:C}}function y(v,P,m,D){if(P.color?.mode!==u.Y.Thresholds)return[{value:P.min??g.tw,color:m.color??u.F}];const x=P.thresholds??p,E=x.mode===i.O.Percentage,C=x.steps;let b=P.min??g.tw,T=P.max??g.d1;E&&(b=0,T=100);const A=(0,c.yQ)(b,C),R=(0,c.yQ)(T,C),S=[{value:+b.toFixed(v),color:D.visualization.getColorByName(A.color)}];let O=!0;for(let j=0;j<C.length;j++){const B=C[j];if(O){A===B&&(O=!1);continue}const N=C[j-1];if(S.push({value:B.value,color:D.visualization.getColorByName(N.color)}),B===R)break}return S.push({value:+T.toFixed(v),color:D.visualization.getColorByName(R.color)}),S}class f extends s.PureComponent{constructor(){super(...arguments),this.canvasElement=null,this.renderVisualization=()=>{const{width:P,value:m,height:D,onClick:x,text:E,theme:C,orientation:b}=this.props,T=h(P,D,m.title,b),A=b===l.wV.Vertical?`${T.gaugeHeight}px`:"100%",R=(0,t.jsx)("div",{style:{height:`${T.gaugeHeight}px`,width:A},ref:S=>this.canvasElement=S});return(0,t.jsxs)(t.Fragment,{children:[x?(0,t.jsx)("button",{className:(0,o.my)(C),type:"button",onClick:x,children:R}):R,T.showLabel&&(0,t.jsx)("div",{style:{textAlign:"center",fontSize:E?.titleSize??T.titleFontSize,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative",width:A,top:"-4px",cursor:"default"},children:m.title})]})}}static{this.defaultProps={showThresholdMarkers:!0,showThresholdLabels:!1,field:{min:0,max:100,thresholds:p}}}componentDidMount(){this.draw()}componentDidUpdate(){this.draw()}draw(){const{field:P,showThresholdLabels:m,showThresholdMarkers:D,width:x,height:E,theme:C,value:b,orientation:T}=this.props,A=h(x,E,b.title),R=T===l.wV.Vertical?A.gaugeHeight:x,S=Math.min(R,A.gaugeHeight),O=C.colors.background.secondary,j=m?1.5:1,B=Math.min(S/5.5,40)/j,N=B/5,I=(0,a.cN)(b),w=Math.min(R,S*1.3)*.9-((B+(D?N:0)+(m?10:0))*2+10),U=this.props.text?.valueSize??(0,d.Vr)(I,w,S,1,B*1.7),W=Math.max(U/2.5,12);let H=P.min??g.tw,z=P.max??g.d1,G=b.numeric;P.thresholds?.mode===i.O.Percentage&&(H=0,z=100,b.percent===void 0?G=(G-H)/(z-H)*100:G=b.percent*100);const M=P.decimals===void 0?2:P.decimals;D&&(H=+H.toFixed(M),z=+z.toFixed(M));const Q={series:{gauges:{gauge:{min:H,max:z,neutralValue:P.custom?.neutral,background:{color:O},border:{color:null},shadow:{show:!1},width:B},frame:{show:!1},label:{show:!1},layout:{margin:0,thresholdWidth:0,vMargin:0},cell:{border:{width:0}},threshold:{values:y(M,P,b,C),label:{show:m,margin:N+1,font:{size:W}},show:D,width:N},value:{color:b.color,formatter:()=>I,font:{size:U,family:C.typography.fontFamily}},show:!0}}},Y={data:[[0,G]],label:b.title};try{this.canvasElement&&r().plot(this.canvasElement,[Y],Q)}catch(q){console.error("Gauge rendering error",q,Q,b)}}render(){return(0,t.jsx)("div",{style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"center",overflow:"hidden"},className:this.props.className,children:this.renderVisualization()})}}},37166:(_,L,e)=>{"use strict";e.d(L,{w:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(42418),g=e(14578);const i=r.memo(r.forwardRef(({title:d,className:o,children:u,branded:c,url:p,urlTitle:h,onDismiss:y,severity:f="info",...v},P)=>{const m=(0,s.of)(l);return(0,t.jsxs)(a.F,{severity:f,className:o,...v,ref:P,title:d,children:[(0,t.jsx)("div",{children:u}),p&&(0,t.jsxs)("a",{href:p,className:(0,n.cx)("external-link",m.docsLink),target:"_blank",rel:"noreferrer",children:[(0,t.jsx)(g.I,{name:"book"})," ",h||"Read more"]})]})}));i.displayName="InfoBox";const l=d=>({docsLink:(0,n.css)({display:"inline-block",marginTop:d.spacing(2)})})},32982:(_,L,e)=>{"use strict";e.d(L,{r:()=>o});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(96540),i=e(40845),l=e(14578),d=e(17464);function o({referenceElement:p,children:h,suffixIcon:y,placement:f}){const v=(0,i.of)(u),P=(0,i.$j)(),m=[(0,r.cY)(8),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{context:D,refs:x,floatingStyles:E}=(0,s.we)({open:!0,placement:f,middleware:m,whileElementsMounted:a.ll,strategy:"fixed"});(0,g.useLayoutEffect)(()=>{x.setReference(p)},[p,x]);const{styles:C}=(0,s.DL)(D,{initial:({side:b})=>({opacity:0,transform:c(b,P)}),duration:P.transitions.duration.shortest});return(0,t.jsx)(d.ZL,{children:(0,t.jsx)("div",{style:{display:"inline-block",...E},ref:x.setFloating,"aria-live":"polite",children:(0,t.jsxs)("span",{className:(0,n.cx)(v.root),style:C,children:[h&&(0,t.jsx)("span",{children:h}),y&&(0,t.jsx)(l.I,{name:y})]})})})}const u=p=>({root:(0,n.css)({...p.typography.bodySmall,willChange:"transform",background:p.components.tooltip.background,color:p.components.tooltip.text,padding:p.spacing(.5,1.5),borderRadius:p.shape.radius.pill,display:"inline-flex",gap:p.spacing(.5),alignItems:"center"})}),c=(p,h)=>{switch(p){case"top":return`translateY(${h.spacing(1)})`;case"bottom":return`translateY(-${h.spacing(1)})`;case"left":return`translateX(${h.spacing(1)})`;case"right":return`translateX(-${h.spacing(1)})`}}},51440:(_,L,e)=>{"use strict";e.d(L,{D:()=>a});var t=e(74848),n=e(96540),r=e(29413),s=e(10354);const a=n.forwardRef((i,l)=>{const{defaultValue:d="",minWidth:o=10,maxWidth:u,onCommitChange:c,onKeyDown:p,onBlur:h,value:y,...f}=i,[v,P]=n.useState(y??d),[m,D]=n.useState(o);return(0,n.useEffect)(()=>{y&&P(y)},[y]),(0,n.useEffect)(()=>{D(g(v.toString(),o,u))},[v,o,u]),(0,t.jsx)(s.p,{...f,ref:l,value:v.toString(),onChange:x=>{P(x.currentTarget.value)},width:m,onBlur:x=>{h?h(x):c&&c(x)},onKeyDown:x=>{p?p(x):x.key==="Enter"&&c&&c(x)},"data-testid":"autosize-input"})});function g(i,l,d){if(!i)return l;const u=(0,r.kD)(i.toString(),14).width/8+3;return l&&u<l?l:d&&u>d?d:u}a.displayName="AutoSizeInput"},16504:(_,L,e)=>{"use strict";e.d(L,{e:()=>n});var t=e(49785);const n=t.xI},48840:(_,L,e)=>{"use strict";e.d(L,{j:()=>P});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(32885),g=e(39070),i=e(40845),l=e(14578),d=e(19384),o=e(56034),u=e(29158);const c=(0,n.css)({display:"flex",alignItems:"center",height:"100%"});function p({row:E,__rowID:C}){return(0,t.jsx)("div",{className:c,children:(0,t.jsx)(u.K,{tooltip:"toggle row expanded","aria-controls":C,name:E.isExpanded?"angle-down":"angle-right","aria-expanded":E.isExpanded,...E.getToggleRowExpandedProps(),size:"lg"})})}function h({isAllRowsExpanded:E,toggleAllRowsExpanded:C}){return(0,t.jsx)("div",{className:c,children:(0,t.jsx)(u.K,{"aria-label":E?"Collapse all rows":"Expand all rows",name:E?"table-collapse-all":"table-expand-all",onClick:()=>C(),size:"lg",tooltip:E?"Collapse all rows":"Expand all rows",variant:"secondary"})})}const y="__expander";function f(E,C=!1){return[{id:y,Cell:p,...C&&{Header:h},disableSortBy:!0,width:0},...E.map(b=>({id:b.id,accessor:b.id,Header:b.header||(()=>null),sortType:b.sortType||"alphanumeric",disableSortBy:!b.sortType,width:b.disableGrow?0:void 0,visible:b.visible,...b.cell&&{Cell:b.cell}}))]}const v=E=>{const C=E.colors.emphasize(E.colors.background.primary,.03);return{container:(0,n.css)({display:"flex",gap:E.spacing(2),flexDirection:"column",width:"100%",overflowX:"auto"}),cell:(0,n.css)({padding:E.spacing(1),minWidth:E.spacing(3)}),table:(0,n.css)({borderRadius:E.shape.radius.default,width:"100%"}),disableGrow:(0,n.css)({width:0}),header:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,minWidth:E.spacing(3),"&, & > button":{position:"relative",whiteSpace:"nowrap",padding:E.spacing(1)},"& > button":{"&:after":{content:'"\\00a0"'},width:"100%",height:"100%",background:"none",border:"none",paddingRight:E.spacing(2.5),textAlign:"left",fontWeight:E.typography.fontWeightMedium}}),row:(0,n.css)({label:"row",borderBottom:`1px solid ${E.colors.border.weak}`,"&:hover":{backgroundColor:C},"&:last-child":{borderBottom:0}}),expandedRow:(0,n.css)({label:"expanded-row-content",borderBottom:"none"}),expandedContentCell:(0,n.css)({borderBottom:`1px solid ${E.colors.border.weak}`,position:"relative",padding:E.spacing(2,2,2,5),"&:before":{content:'""',position:"absolute",width:"1px",top:0,left:"16px",bottom:E.spacing(2),background:E.colors.border.medium}}),expandedContentRow:(0,n.css)({label:"expanded-row-content"}),sortableHeader:(0,n.css)({"&&":{padding:0}})}};function P({className:E,columns:C,data:b,getRowId:T,headerTooltips:A,pageSize:R=0,renderExpandedRow:S,showExpandAll:O=!1,fetchData:j,initialSortBy:B=[]}){const N=(0,i.of)(v),I=(0,s.useMemo)(()=>f(C,O),[C,O]),K=m(),w=(0,s.useCallback)(te=>`${K}-${te.id}`.replace(/\s/g,""),[K]),U=[a.useSortBy,a.useExpanded],W=b.length>R,H=R>0;H&&U.push(a.usePagination);const z=(0,a.useTable)({columns:I,data:b,autoResetExpanded:!1,autoResetSortBy:!1,disableMultiSort:!0,manualSortBy:!!j,getRowId:T,initialState:{hiddenColumns:[!S&&y,...I.filter(te=>!(!te.visible||te.visible(b))).map(te=>te.id).filter(g.zz)].filter(g.zz),sortBy:B}},...U),{getTableProps:G,getTableBodyProps:M,headerGroups:Q,prepareRow:Y}=z,{sortBy:q}=z.state;return(0,s.useEffect)(()=>{j&&j({sortBy:q})},[q,j]),(0,s.useEffect)(()=>{H&&z.setPageSize(R)},[H,R,z.setPageSize,z]),(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsxs)("table",{...G(),className:(0,n.cx)(N.table,E),children:[(0,t.jsx)("thead",{children:Q.map(te=>{const{key:X,...ee}=te.getHeaderGroupProps();return(0,t.jsx)("tr",{...ee,children:te.headers.map(ne=>{const{key:Z,...ae}=ne.getHeaderProps(),re=A?.[ne.id];return(0,t.jsx)("th",{className:(0,n.cx)(N.header,{[N.disableGrow]:ne.width===0,[N.sortableHeader]:ne.canSort}),...ae,...ne.isSorted&&{"aria-sort":ne.isSortedDesc?"descending":"ascending"},children:(0,t.jsx)(x,{column:ne,headerTooltip:re})},Z)})},X)})}),(0,t.jsx)("tbody",{...M(),children:(H?z.page:z.rows).map(te=>{Y(te);const{key:X,...ee}=te.getRowProps(),ne=w(te),Z=te.isExpanded;return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("tr",{...ee,className:(0,n.cx)(N.row,Z&&N.expandedRow),children:te.cells.map(ae=>{const{key:re,...se}=ae.getCellProps();return(0,t.jsx)("td",{className:N.cell,...se,children:ae.render("Cell",{__rowID:ne})},re)})}),Z&&S&&(0,t.jsx)("tr",{...ee,id:ne,className:N.expandedContentRow,children:(0,t.jsx)("td",{className:N.expandedContentCell,colSpan:te.cells.length,children:S(te.original)})})]},X)})})]}),H&&W&&(0,t.jsx)("span",{children:(0,t.jsx)(d.d,{currentPage:z.state.pageIndex+1,numberOfPages:z.pageOptions.length,onNavigate:te=>z.gotoPage(te-1)})})]})}const m=()=>(0,s.useMemo)(()=>(0,r.uniqueId)("InteractiveTable"),[]),D=E=>({sortIcon:(0,n.css)({position:"absolute",top:E.spacing(1)}),headerTooltipIcon:(0,n.css)({marginLeft:E.spacing(.5)})});function x({column:{canSort:E,render:C,isSorted:b,isSortedDesc:T,getSortByToggleProps:A},headerTooltip:R}){const S=(0,i.of)(D),{onClick:O}=A(),j=(0,t.jsxs)(t.Fragment,{children:[C("Header"),R&&(0,t.jsx)(o.m,{theme:"info-alt",content:R.content,placement:"top-end",children:(0,t.jsx)(l.I,{className:S.headerTooltipIcon,name:R.iconName||"info-circle","data-testid":"header-tooltip-icon"})}),b&&(0,t.jsx)("span",{"aria-hidden":"true",className:S.sortIcon,children:(0,t.jsx)(l.I,{name:T?"angle-down":"angle-up"})})]});return E?(0,t.jsx)("button",{type:"button",onClick:O,children:j}):j}},24022:(_,L,e)=>{"use strict";e.d(L,{B:()=>s});var t=e(74848),n=e(96540),r=e(44533);class s extends n.PureComponent{constructor(){super(...arguments),this.wrapperRef=(0,n.createRef)(),this.renderJson=()=>{const{json:g,config:i,open:l,onDidRender:d}=this.props,o=this.wrapperRef.current,u=new r.O(g,l,i);o.hasChildNodes()?o.replaceChild(u.render(),o.lastChild):o.appendChild(u.render()),d&&d(u.json)}}static{this.defaultProps={open:3,config:{animateOpen:!0}}}componentDidMount(){this.renderJson()}componentDidUpdate(){this.renderJson()}render(){const{className:g}=this.props;return(0,t.jsx)("div",{className:g,ref:this.wrapperRef})}}},44533:(_,L,e)=>{"use strict";e.d(L,{O:()=>v});var t=e(2543);function n(P){return P.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function r(P){return!!P&&typeof P==="object"}function s(P){if(P===void 0)return"";if(P===null||typeof P=="object"&&!P.constructor)return"Object";const D=/function ([^(]*)/.exec(P.constructor.toString());return D&&D.length>1?D[1]:""}function a(P){return P===null?"null":typeof P}function g(P,m){const D=a(P);return D==="null"||D==="undefined"?D:(D==="string"&&(m='"'+n(m)+'"'),D==="function"?P.toString().replace(/[\r\n]/g,"").replace(/\{.*\}/,"")+"{\u2026}":m)}let i="";function l(P){return r(P)?(i=s(P),Array.isArray(P)&&(i+="["+P.length+"]")):i=g(P,P.toString()),i}function d(P){return`json-formatter-${P}`}function o(P,m,D){const x=document.createElement(P);return m&&x.classList.add(d(m)),D!==void 0&&(D instanceof Node?x.appendChild(D):x.appendChild(document.createTextNode(String(D)))),x}const u=/(^\d{1,4}[\.|\\/|-]\d{1,2}[\.|\\/|-]\d{1,4})(\s*(?:0?[1-9]:[0-5]|1(?=[012])\d:[0-5])\d\s*[ap]m)?$/,c=/\d{2}:\d{2}:\d{2} GMT-\d{4}/,p=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,h=10,y=typeof window<"u"&&window.requestAnimationFrame||(P=>(P(),0)),f={animateOpen:!0,animateClose:!0};class v{constructor(m,D=1,x=f,E){this.json=m,this.open=D,this.config=x,this.key=E,this._isOpen=null,this.element=null,this.skipChildren=!1}get isOpen(){return this._isOpen!==null?this._isOpen:this.open>0}set isOpen(m){this._isOpen=m}get isDate(){return this.type==="string"&&(u.test(this.json)||p.test(this.json)||c.test(this.json))}get isUrl(){return this.type==="string"&&this.json.indexOf("http")===0}get isArray(){return Array.isArray(this.json)}get isObject(){return r(this.json)}get isEmptyObject(){return!this.keys.length&&!this.isArray}get isEmpty(){return this.isEmptyObject||this.keys&&!this.keys.length&&this.isArray}get hasKey(){return typeof this.key<"u"}get constructorName(){return s(this.json)}get type(){return a(this.json)}get keys(){return this.isObject?Object.keys(this.json).map(m=>m||'""'):[]}toggleOpen(){this.isOpen=!this.isOpen,this.element&&(this.isOpen?this.appendChildren(this.config.animateOpen):this.removeChildren(this.config.animateClose),this.element.classList.toggle(d("open")))}openAtDepth(m=1){m<0||(this.open=m,this.isOpen=m!==0,this.element&&(this.removeChildren(!1),m===0?this.element.classList.remove(d("open")):(this.appendChildren(this.config.animateOpen),this.element.classList.add(d("open")))))}isNumberArray(){return this.json.length>0&&this.json.length<4&&((0,t.isNumber)(this.json[0])||(0,t.isNumber)(this.json[1]))}renderArray(){const m=o("span");return m.appendChild(o("span","bracket","[")),this.isNumberArray()?(this.json.forEach((D,x)=>{x>0&&m.appendChild(o("span","array-comma",",")),m.appendChild(o("span","number",D))}),this.skipChildren=!0):m.appendChild(o("span","number",this.json.length)),m.appendChild(o("span","bracket","]")),m}render(m=!1){this.element=o("div","row");const D=o("a","toggler-link"),x=o("span","toggler");if(this.isObject&&D.appendChild(x),this.hasKey&&D.appendChild(o("span","key",`${this.key}:`)),this.isObject){const C=o("span","value"),b=o("span"),T=o("span","constructor-name",this.constructorName);if(b.appendChild(T),this.isArray){const A=this.renderArray();b.appendChild(A)}C.appendChild(b),D.appendChild(C)}else{const C=this.isUrl?o("a"):o("span");C.classList.add(d(this.type)),this.isDate&&C.classList.add(d("date")),this.isUrl&&(C.classList.add(d("url")),C.setAttribute("href",this.json));const b=g(this.json,this.json);C.appendChild(document.createTextNode(b)),D.appendChild(C)}const E=o("div","children");return this.isObject&&E.classList.add(d("object")),this.isArray&&E.classList.add(d("array")),this.isEmpty&&E.classList.add(d("empty")),this.config&&this.config.theme&&this.element.classList.add(d(this.config.theme)),this.isOpen&&this.element.classList.add(d("open")),m||this.element.appendChild(D),this.skipChildren?D.removeChild(x):this.element.appendChild(E),this.isObject&&this.isOpen&&this.appendChildren(),this.isObject&&D.addEventListener("click",this.toggleOpen.bind(this)),this.element}appendChildren(m=!1){const D=this.element&&this.element.querySelector(`div.${d("children")}`);if(!(!D||this.isEmpty))if(m){let x=0;const E=()=>{const C=this.keys[x],b=new v(this.json[C],this.open-1,this.config,C);D.appendChild(b.render()),x+=1,x<this.keys.length&&(x>h?E():y(E))};y(E)}else this.keys.forEach(x=>{const E=new v(this.json[x],this.open-1,this.config,x);D.appendChild(E.render())})}removeChildren(m=!1){const D=this.element&&this.element.querySelector(`div.${d("children")}`);if(m){let x=0;const E=()=>{D&&D.children.length&&(D.removeChild(D.children[0]),x+=1,x>h?E():y(E))};y(E)}else D&&(D.innerHTML="")}}},90613:(_,L,e)=>{"use strict";e.d(L,{a:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(16795),g=e(55738);const i=(0,r.forwardRef)((u,c)=>{const{children:p,margin:h,marginX:y,marginY:f,marginTop:v,marginBottom:P,marginLeft:m,marginRight:D,padding:x,paddingX:E,paddingY:C,paddingTop:b,paddingBottom:T,paddingLeft:A,paddingRight:R,display:S,backgroundColor:O,grow:j,shrink:B,basis:N,flex:I,borderColor:K,borderStyle:w,borderRadius:U,direction:W,justifyContent:H,alignItems:z,boxShadow:G,element:M,gap:Q,width:Y,minWidth:q,maxWidth:te,height:X,minHeight:ee,maxHeight:ne,...Z}=u,ae=(0,s.of)(o,h,y,f,v,P,m,D,x,E,C,b,T,A,R,S,O,j,B,N,I,K,w,U,W,H,z,G,Q),re=(0,s.of)(g.E,Y,q,te,X,ee,ne),se=M??"div";return(0,t.jsx)(se,{ref:c,className:(0,n.cx)(ae.root,re),...Z,children:p})});i.displayName="Box";const l=(u,c)=>{switch(u){case"error":case"success":case"info":case"warning":return c.colors[u].borderTransparent;default:return u?c.colors.border[u]:void 0}},d=(u,c)=>{switch(u){case"error":case"success":case"info":case"warning":return c.colors[u].transparent;default:return u?c.colors.background[u]:void 0}},o=(u,c,p,h,y,f,v,P,m,D,x,E,C,b,T,A,R,S,O,j,B,N,I,K,w,U,W,H,z)=>({root:(0,n.css)([(0,a.Y)(u,c,G=>({margin:u.spacing(G)})),(0,a.Y)(u,p,G=>({marginLeft:u.spacing(G),marginRight:u.spacing(G)})),(0,a.Y)(u,h,G=>({marginTop:u.spacing(G),marginBottom:u.spacing(G)})),(0,a.Y)(u,y,G=>({marginTop:u.spacing(G)})),(0,a.Y)(u,f,G=>({marginBottom:u.spacing(G)})),(0,a.Y)(u,v,G=>({marginLeft:u.spacing(G)})),(0,a.Y)(u,P,G=>({marginRight:u.spacing(G)})),(0,a.Y)(u,m,G=>({padding:u.spacing(G)})),(0,a.Y)(u,D,G=>({paddingLeft:u.spacing(G),paddingRight:u.spacing(G)})),(0,a.Y)(u,x,G=>({paddingTop:u.spacing(G),paddingBottom:u.spacing(G)})),(0,a.Y)(u,E,G=>({paddingTop:u.spacing(G)})),(0,a.Y)(u,C,G=>({paddingBottom:u.spacing(G)})),(0,a.Y)(u,b,G=>({paddingLeft:u.spacing(G)})),(0,a.Y)(u,T,G=>({paddingRight:u.spacing(G)})),(0,a.Y)(u,A,G=>({display:G})),(0,a.Y)(u,R,G=>({backgroundColor:d(G,u)})),(0,a.Y)(u,w,G=>({flexDirection:G})),(0,a.Y)(u,S,G=>({flexGrow:G})),(0,a.Y)(u,O,G=>({flexShrink:G})),(0,a.Y)(u,j,G=>({flexBasis:G})),(0,a.Y)(u,B,G=>({flex:G})),(0,a.Y)(u,I,G=>({borderStyle:G})),(0,a.Y)(u,N,G=>({borderColor:l(G,u)})),(I||N)&&{borderWidth:"1px"},(0,a.Y)(u,U,G=>({justifyContent:G})),(0,a.Y)(u,W,G=>({alignItems:G})),(0,a.Y)(u,K,G=>({borderRadius:u.shape.radius[G]})),(0,a.Y)(u,H,G=>({boxShadow:u.shadows[G]})),(0,a.Y)(u,z,G=>({gap:u.spacing(G)}))])})},71259:(_,L,e)=>{"use strict";e.d(L,{x:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(16795);const g=(0,r.forwardRef)((l,d)=>{const{alignItems:o,children:u,gap:c,columns:p,minColumnWidth:h,...y}=l,f=(0,s.of)(i,c,p,h,o);return(0,t.jsx)("div",{ref:d,...y,className:f.grid,children:u})});g.displayName="Grid";const i=(l,d,o,u,c)=>({grid:(0,n.css)([{display:"grid"},(0,a.Y)(l,d,p=>({gap:l.spacing(p)})),u&&(0,a.Y)(l,u,p=>({gridTemplateColumns:`repeat(auto-fill, minmax(${l.spacing(p)}, 1fr))`})),o&&(0,a.Y)(l,o,p=>({gridTemplateColumns:`repeat(${p}, 1fr)`})),(0,a.Y)(l,c,p=>({alignItems:p}))])})},66864:(_,L,e)=>{"use strict";e.d(L,{Gy:()=>i,PE:()=>g,gW:()=>l,mc:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=(p=>(p[p.Horizontal=0]="Horizontal",p[p.Vertical=1]="Vertical",p))(a||{});const g=({children:p,orientation:h=0,spacing:y="sm",justify:f="flex-start",align:v="normal",wrap:P=!1,width:m="100%",height:D="100%",...x})=>{const E=(0,s.of)(o,h,y,f,v,P);return(0,t.jsx)("div",{className:E.layout,style:{width:m,height:D},...x,children:r.Children.toArray(p).filter(Boolean).map((C,b)=>(0,t.jsx)("div",{className:E.childWrapper,children:C},b))})},i=({children:p,spacing:h,justify:y,align:f="center",wrap:v,width:P,height:m})=>(0,t.jsx)(g,{spacing:h,justify:y,orientation:0,align:f,width:P,height:m,wrap:v,children:p}),l=({children:p,spacing:h,justify:y,align:f,width:v,height:P})=>(0,t.jsx)(g,{spacing:h,justify:y,orientation:1,align:f,width:v,height:P,children:p}),d=({children:p,padding:h,margin:y,grow:f,shrink:v})=>{const P=(0,s.of)(c,h,y);return(0,t.jsx)("div",{className:(0,n.cx)(P.wrapper,f!==void 0&&(0,n.css)({flexGrow:f}),v!==void 0&&(0,n.css)({flexShrink:v})),children:p})},o=(p,h,y,f,v,P)=>{const m=y!=="none"?p.spacing(u[y]):0,D=h===0&&!P||h===1?0:`-${m}`,x=h===1?"vertical-group":"horizontal-group";return{layout:(0,n.css)({label:x,display:"flex",flexDirection:h===1?"column":"row",flexWrap:P?"wrap":"nowrap",justifyContent:f,alignItems:v,height:"100%",maxWidth:"100%",marginBottom:D}),childWrapper:(0,n.css)({label:"layoutChildrenWrapper",marginBottom:h===0&&!P?0:m,marginRight:h===0?m:0,display:"flex",alignItems:v,"&:last-child":{marginBottom:h===1?0:void 0,marginRight:h===0?0:void 0}})}},u={none:0,xs:.5,sm:1,md:2,lg:3},c=(p,h,y)=>{const f=h&&h!=="none"&&p.spacing(u[h])||0,v=y&&y!=="none"&&p.spacing(u[y])||0;return{wrapper:(0,n.css)({label:"container",margin:v,padding:f})}}},68402:(_,L,e)=>{"use strict";e.d(L,{$:()=>r});var t=e(74848),n=e(90613);const r=({v:s=0,h:a=0,layout:g})=>(0,t.jsx)(n.a,{paddingRight:a,paddingBottom:s,display:g==="inline"?"inline-block":"block"})},50720:(_,L,e)=>{"use strict";e.d(L,{N:()=>g});var t=e(74848),n=e(96540),r=e(35557),s=e(71733),a=e(80997);const g=(0,n.forwardRef)(({href:i,children:l,...d},o)=>{const u=s.I.stripBaseFromUrl(a.sQ.sanitizeUrl(i??""));return(0,t.jsx)(r.Link,{ref:o,to:u,...d,children:l})});g.displayName="Link"},72109:(_,L,e)=>{"use strict";e.d(L,{Y:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(80997),a=e(71733),g=e(40845),i=e(14578),l=e(71356),d=e(50720);const o={h1:"xl",h2:"xl",h3:"lg",h4:"lg",h5:"md",h6:"md",body:"md",bodySmall:"xs"},u=(0,r.forwardRef)(({href:p,color:h="link",external:y=!1,inline:f=!0,variant:v="body",weight:P,icon:m,children:D,...x},E)=>{const C=s.sQ.sanitizeUrl(p??""),b=(0,g.$j)(),T=c(b,f,v,P,h),A=m||"external-link-alt";if(y)return(0,t.jsxs)("a",{href:C,ref:E,...x,target:"_blank",rel:"noreferrer",className:T,children:[D,(0,t.jsx)(i.I,{size:o[v]||"md",name:A})]});const R=a.I.stripBaseFromUrl(C);return(0,t.jsxs)(d.N,{ref:E,href:R,...x,className:T,children:[D,m&&(0,t.jsx)(i.I,{name:m,size:o[v]||"md"})]})});u.displayName="TextLink";const c=(p,h,y,f,v)=>(0,n.css)([y&&{...p.typography[y]},f&&{fontWeight:(0,l.iV)(f,p)},v&&{color:p.colors.text[v]},{alignItems:"center",gap:"0.25em",display:"inline-flex",textDecoration:"none","&:hover":{textDecoration:"underline",color:p.colors.text.link}},h&&{textDecoration:"underline","&:hover":{textDecoration:"none"}}])},85918:(_,L,e)=>{"use strict";e.d(L,{p:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(3911);const a=(0,s.N)((i=!1)=>({list:(0,n.css)({listStyleType:"none",margin:0,padding:0}),item:(0,n.css)({display:i&&"inline-block"||"block"})}));class g extends r.PureComponent{constructor(l){super(l)}render(){const{items:l,renderItem:d,getItemKey:o,className:u,inline:c}=this.props,p=a(c);return(0,t.jsx)("ul",{className:(0,n.cx)(p.list,u),children:l.map((h,y)=>(0,t.jsx)("li",{className:p.item,children:d(h,y)},o?o(h):y))})}}},1551:(_,L,e)=>{"use strict";e.d(L,{c:()=>s});var t=e(74848),n=e(96540),r=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(r.p,{inline:!0,...this.props})}}},33552:(_,L,e)=>{"use strict";e.d(L,{B:()=>s});var t=e(74848),n=e(96540),r=e(85918);class s extends n.PureComponent{render(){return(0,t.jsx)(r.p,{...this.props})}}},57514:(_,L,e)=>{"use strict";e.d(L,{G:()=>o});var t=e(74848),n=e(32196),r=e(40845);const s=28,a=2.4,g=500,i=4e3,l=300,d=100/s*100;function o({width:c,delay:p=l,ariaLabel:h="Loading bar"}){const y=Math.min(Math.max(Math.round(c*a),g),i),f=(0,r.of)(u,p,y),v={overflow:"hidden"};return(0,t.jsx)("div",{style:v,children:(0,t.jsx)("div",{"aria-label":h,className:f.bar})})}const u=(c,p,h)=>{const y=(0,n.keyframes)({"0%":{transform:"translateX(-100%)"},"85%, 100%":{transform:`translateX(${d}%)`}});return{bar:(0,n.css)({width:s+"%",height:1,background:"linear-gradient(90deg, rgba(110, 159, 255, 0) 0%, #6E9FFF 80.75%, rgba(110, 159, 255, 0) 100%)",transform:"translateX(-100%)",willChange:"transform",[c.transitions.handleMotion("no-preference")]:{animationName:y,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${h}ms`},[c.transitions.handleMotion("reduce")]:{animationName:y,animationDelay:`${p}ms`,animationTimingFunction:"linear",animationIterationCount:"infinite",animationDuration:`${4*h}ms`}})}}},76218:(_,L,e)=>{"use strict";e.d(L,{O:()=>a});var t=e(74848),n=e(96540),r=e(90182),s=e(64278);const a=({value:g,onChange:i,context:l,item:d})=>{const o=d.settings??{},u=(0,s.sE)(l.data,o?.filter),c=(0,s.m3)(u,g,void 0,void 0,o.baseNameMode),p=(0,n.useCallback)(y=>{if(!(y&&!(0,s.v3)(y.value,u)))return i(y?.value)},[u,i]),h=c.find(y=>y.value===g);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(r.l6,{value:h,placeholder:o.placeholderText??"Select field",options:c,onChange:p,noOptionsMessage:o.noFieldsMessage,width:o.width,isClearable:o.isClearable!==!1})})}},9988:(_,L,e)=>{"use strict";e.d(L,{bx:()=>d,cH:()=>c});var t=e(74848),n=e(96540),r=e(11261),s=e(1173),a=e(85200),g=e(4025),i=e(90182);const l=(0,n.memo)(p=>{const{data:h,options:y,onChange:f,id:v}=p,P=o(h),m=u(P,y),D=(0,n.useCallback)(E=>f(E.value),[f]),x=m.find(E=>E.value===y);return(0,t.jsx)(i.l6,{inputId:v,value:x,options:m,onChange:D})});l.displayName="FieldTypeMatcherEditor";const d=[{value:r.PU.number,label:"Number",icon:(0,g.lV)(r.PU.number)},{value:r.PU.string,label:"String",icon:(0,g.lV)(r.PU.string)},{value:r.PU.time,label:"Time",icon:(0,g.lV)(r.PU.time)},{value:r.PU.boolean,label:"Boolean",icon:(0,g.lV)(r.PU.boolean)},{value:r.PU.trace,label:"Traces",icon:(0,g.lV)(r.PU.trace)},{value:r.PU.enum,label:"Enum",icon:(0,g.lV)(r.PU.enum)},{value:r.PU.other,label:"Other",icon:(0,g.lV)(r.PU.other)}],o=p=>(0,n.useMemo)(()=>{const h=new Map;for(const y of d)h.set(y.value,0);for(const y of p)for(const f of y.fields){const v=f.type||r.PU.other;let P=h.get(v);P||(P=0),h.set(v,P+1)}return h},[p]),u=(p,h)=>(0,n.useMemo)(()=>{let y=!1;const f=[];for(const v of d){const P=p.get(v.value),m=h===v.value;(P||m)&&f.push({...v,label:`${v.label} (${p.get(v.value)})`}),m&&(y=!0)}return h&&!y&&f.push({value:h,label:`${h} (No matches)`}),f},[p,h]),c={id:s.Ct.byType,component:l,matcher:a.sJ.get(s.Ct.byType),name:"Fields with type",description:"Set properties for fields of a specific type (number, string, boolean)",optionsToLabel:p=>p}},19346:(_,L,e)=>{"use strict";e.d(L,{N:()=>u,r1:()=>y});var t=e(74848),n=e(32196),r=e(96540),s=e(75059),a=e(1173),g=e(85200),i=e(52622),l=e(40845),d=e(10354),o=e(90182);const u=[{label:"==",value:i.zT.EQ},{label:"!=",value:i.zT.NEQ},{label:">",value:i.zT.GT},{label:">=",value:i.zT.GTE},{label:"<",value:i.zT.LT},{label:"<=",value:i.zT.LTE}];function c(f){return f===s.gy.allIsNull||f===s.gy.allIsZero}const p=({options:f,onChange:v})=>{const P=(0,l.of)(h),m=(0,r.useMemo)(()=>s.AS.selectOptions([f?.reducer]),[f?.reducer]),D=(0,r.useCallback)(T=>v({...f,reducer:T.value}),[f,v]),x=(0,r.useCallback)(T=>v({...f,op:T.value}),[f,v]),E=(0,r.useCallback)(T=>{const A=T.currentTarget.valueAsNumber;return v({...f,value:A})},[f,v]),C=f??{},b=c(C.reducer);return(0,t.jsxs)("div",{className:P.spot,children:[(0,t.jsx)(o.l6,{value:m.current,options:m.options,onChange:D,placeholder:"Select field reducer"}),C.reducer&&!b&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.l6,{value:u.find(T=>T.value===C.op),options:u,onChange:x,"aria-label":"Comparison operator",width:19}),(0,t.jsx)(d.p,{type:"number",value:C.value,onChange:E})]})]})},h=f=>({spot:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end",gap:"4px"})}),y={id:a.Ct.byValue,component:p,matcher:g.sJ.get(a.Ct.byValue),name:"Fields with values",description:"Set properties for fields with reducer condition",optionsToLabel:f=>`${f?.reducer} ${f?.op} ${f?.value}`}},74668:(_,L,e)=>{"use strict";e.d(L,{R:()=>u,X:()=>l});var t=e(74848),n=e(96540),r=e(28240),s=e(1173),a=e(85200),g=e(90182);const i=(c,p,h)=>{if(!h)return;let y=c.find(f=>!p.some(v=>f===v));if(y)return y};function l({value:c,data:p,onChange:h,placeholder:y}){const f=(0,n.useMemo)(()=>d(p),[p]),[v,P]=(0,n.useState)({refIds:[],value:void 0}),m=(0,n.useMemo)(()=>f.find(x=>x.value===c)??i(f,v.refIds,v.value),[c,f,v]),D=(0,n.useCallback)(x=>{h(x?.value)},[h]);return(f!==v.refIds||m?.value!==v.value)&&P({refIds:f,value:m?.value}),(0,t.jsx)(g.l6,{options:f,onChange:D,isClearable:!0,placeholder:y??"Select query refId",value:m})}function d(c){const p=new Map;for(const y of c){const f=y.refId??"",v=p.get(f)??[];v.length===0&&p.set(f,v),v.push(y)}const h=[];for(const[y,f]of p.entries())h.push({value:y,label:`Query: ${y??"(missing refId)"}`,description:o(f)});return h}function o(c){return`Frames (${c.length}):
    ${c.slice(0,Math.min(3,c.length)).map(p=>(0,r.Ri)(p)).join(", ")} ${c.length>3?"...":""}`}const u={id:s.Ct.byFrameRefID,component:c=>(0,t.jsx)(l,{value:c.options,data:c.data,onChange:c.onChange}),matcher:a.sJ.get(s.Ct.byFrameRefID),name:"Fields returned by query",description:"Set properties for fields from a specific query",optionsToLabel:c=>c}},84349:(_,L,e)=>{"use strict";e.d(L,{g:()=>P});var t=e(83077),n=e(74848),r=e(96540),s=e(1173),a=e(85200),g=e(10354);const i=(0,r.memo)(m=>{const{options:D,onChange:x}=m,E=(0,r.useCallback)(C=>x(C.target.value),[x]);return(0,n.jsx)(g.p,{placeholder:"Enter regular expression",defaultValue:D,onBlur:E})});i.displayName="FieldNameByRegexMatcherEditor";const l={id:s.Ct.byRegexp,component:i,matcher:a.sJ.get(s.Ct.byRegexp),name:"Fields with name matching regex",description:"Set properties for fields with names matching a regex",optionsToLabel:m=>m};var d=e(90182),o=e(64278);const u=(0,r.memo)(m=>{const{data:D,options:x,onChange:E,id:C}=m,b=(0,o.sE)(D),T=(0,o.m3)(b,x),A=(0,r.useCallback)(S=>{if((0,o.v3)(S.value,b))return E(S.value)},[b,E]),R=T.find(S=>S.value===x);return(0,n.jsx)(d.l6,{value:R,options:T,onChange:A,inputId:C})});u.displayName="FieldNameMatcherEditor";const c={id:s.Ct.byName,component:u,matcher:a.sJ.get(s.Ct.byName),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:m=>m},p=(0,r.memo)(m=>{const{data:D,options:x,onChange:E}=m,{readOnly:C,prefix:b}=x,T=(0,o.sE)(D),A=(0,o.m3)(T,void 0),R=(0,r.useCallback)(S=>{if(Array.isArray(S))return E({...x,names:S.reduce((O,j)=>((0,o.v3)(j.value,T)&&O.push(j.value),O),[])})},[T,E,x]);if(C){const S=(x.names??[]).join(", ");return(0,n.jsx)(g.p,{value:S,readOnly:!0,disabled:!0,prefix:b})}return(0,n.jsx)(d.KF,{value:x.names,options:A,onChange:R})});p.displayName="FieldNameMatcherEditor";const h={id:s.Ct.byNames,component:p,matcher:a.sJ.get(s.Ct.byNames),name:"Fields with name",description:"Set properties for a specific field",optionsToLabel:m=>(m.names??[]).join(", "),excludeFromPicker:!0};var y=e(9988),f=e(19346),v=e(74668);const P=new t.O(()=>[c,l,y.cH,v.R,h,f.r1])},64278:(_,L,e)=>{"use strict";e.d(L,{BP:()=>g,m3:()=>l,sE:()=>i,v3:()=>a});var t=e(96540),n=e(28240),r=e(27310),s=e(4025);function a(d,o){return d?o.display.has(d)||o.raw.has(d):!1}function g(d,o){const u={display:new Set,raw:new Set,fields:new Map};for(const c of d)for(const p of c.fields){if(o&&!o(p))continue;const h=(0,n.Ct)(p,c,d);u.display.add(h),u.fields.set(h,p),p.name&&h!==p.name&&(u.raw.add(p.name),u.fields.set(p.name,p))}return u}function i(d,o){return(0,t.useMemo)(()=>g(d,o),[d,o])}function l(d,o,u,c,p){return(0,t.useMemo)(()=>{let h=!1;const y=[];if(u&&y.push(u),p===r.X4.OnlyBaseNames)for(const f of d.raw)!h&&f===o&&(h=!0),y.push({value:f,label:`${f} (base field name)`});else{for(const f of d.display){!h&&f===o&&(h=!0);const v=d.fields.get(f);(!c||c===v?.type)&&y.push({value:f,label:f,icon:v?(0,s.SS)(v):void 0})}if(p!==r.X4.ExcludeBaseNames)for(const f of d.raw)d.display.has(f)||(!h&&f===o&&(h=!0),y.push({value:f,label:`${f} (base field name)`}))}return o&&!h&&y.push({value:o,label:`${o} (not found)`}),y},[d,o,u,c,p])}},38138:(_,L,e)=>{"use strict";e.d(L,{W:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(90613),g=e(27183),i=e(59093),l=e(64539),d=e(32653);const o=r.forwardRef(({header:p,children:h,ariaLabel:y,onOpen:f,onClose:v,onKeyDown:P,...m},D)=>{const x=(0,s.of)(c),E=(0,r.useRef)(null);(0,r.useImperativeHandle)(D,()=>E.current);const[C]=(0,d.t)({isMenuOpen:!0,localRef:E,onOpen:f,onClose:v,onKeyDown:P});return(0,t.jsxs)(a.a,{...m,"aria-label":y,backgroundColor:"primary",borderRadius:"default",boxShadow:"z3",display:"inline-block",onKeyDown:C,paddingX:0,paddingY:.5,ref:E,role:"menu",tabIndex:-1,children:[p&&(0,t.jsx)("div",{className:(0,n.cx)(x.header,!!h&&r.Children.toArray(h).length>0&&x.headerBorder),children:p}),h]})});o.displayName="Menu";const u=Object.assign(o,{Item:l.D,Divider:g.N,Group:i.r}),c=p=>({header:(0,n.css)({padding:p.spacing(.5,1,1,1)}),headerBorder:(0,n.css)({borderBottom:`1px solid ${p.colors.border.weak}`})})},27183:(_,L,e)=>{"use strict";e.d(L,{N:()=>s});var t=e(74848),n=e(32196),r=e(40845);function s(){const g=(0,r.of)(a);return(0,t.jsx)("div",{className:g.divider})}const a=g=>({divider:(0,n.css)({height:1,backgroundColor:g.colors.border.weak,margin:g.spacing(.5,0)})})},59093:(_,L,e)=>{"use strict";e.d(L,{r:()=>g});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(40845);const g=({label:l,ariaLabel:d,children:o})=>{const u=(0,a.of)(i),c=`group-label-${(0,r.uniqueId)()}`;return(0,t.jsxs)("div",{role:"group","aria-labelledby":!d&&l?c:void 0,"aria-label":d,children:[l&&(0,t.jsx)("label",{id:c,className:u.groupLabel,"aria-hidden":!0,children:l}),o]})};g.displayName="MenuGroup";const i=l=>({groupLabel:(0,n.css)({color:l.colors.text.secondary,fontSize:l.typography.size.sm,padding:l.spacing(.5,1)})})},64539:(_,L,e)=>{"use strict";e.d(L,{D:()=>p});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(16797),g=e(14578),i=e(67061),l=e(13544),d=e(32653);const o=y=>{if(!y)return!1;const f=y.parentElement.getBoundingClientRect(),v=y.getBoundingClientRect();return v.width!==0&&f.right+v.width+10>window.innerWidth},u=(0,r.memo)(({items:y,isOpen:f,close:v,customStyle:P})=>{const m=(0,s.of)(c),D=(0,r.useRef)(null),[x]=(0,d.t)({localRef:D,isMenuOpen:f,close:v}),[E,C]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{f&&D.current&&C(o(D.current))},[f]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:m.iconWrapper,"aria-hidden":!0,"data-testid":l.Tp.components.Menu.SubMenu.icon,children:(0,t.jsx)(g.I,{name:"angle-right",className:m.icon})}),f&&(0,t.jsx)("div",{ref:D,className:(0,n.cx)(m.subMenu,{[m.pushLeft]:E}),"data-testid":l.Tp.components.Menu.SubMenu.container,style:P,children:(0,t.jsx)("div",{tabIndex:-1,className:m.itemsWrapper,role:"menu",onKeyDown:x,children:y})})]})});u.displayName="SubMenu";const c=y=>({iconWrapper:(0,n.css)({display:"flex",flex:1,justifyContent:"end"}),icon:(0,n.css)({opacity:.7,marginLeft:y.spacing(1),color:y.colors.text.secondary}),itemsWrapper:(0,n.css)({background:y.colors.background.primary,boxShadow:y.shadows.z3,display:"inline-block",borderRadius:y.shape.radius.default}),pushLeft:(0,n.css)({right:"100%",left:"unset"}),subMenu:(0,n.css)({position:"absolute",top:0,left:"100%",zIndex:y.zIndex.dropdown})}),p=r.memo(r.forwardRef((y,f)=>{const{url:v,icon:P,label:m,description:D,ariaLabel:x,ariaChecked:E,target:C,onClick:b,className:T,active:A,disabled:R,destructive:S,childItems:O,role:j,tabIndex:B=-1,customSubMenuContainerStyles:N,shortcut:I,testId:K}=y,w=(0,s.of)(h),[U,W]=(0,r.useState)(A),[H,z]=(0,r.useState)(!1),G=(0,r.useCallback)(()=>{R||(z(!0),W(!0))},[R]),M=(0,r.useCallback)(()=>{R||(z(!1),W(!1))},[R]),Q=O&&O.length>0,Y=Q?"div":v===void 0?"button":"a",q=(0,n.cx)({[w.item]:!0,[w.active]:U,[w.disabled]:R,[w.destructive]:S&&!R},T),te={[Y==="button"?"disabled":"aria-disabled"]:R,...Y==="a"&&R&&{href:void 0,onClick:void 0},...R&&{tabIndex:-1,"data-disabled":R}},X=(0,r.useRef)(null);(0,r.useImperativeHandle)(f,()=>X.current);const ee=ae=>{switch(ae.key){case"ArrowRight":ae.preventDefault(),ae.stopPropagation(),Q&&(z(!0),W(!0));break;default:break}},ne=()=>{z(!1),W(!1),X?.current?.focus()},Z=!!(I&&I.length>0);return(0,t.jsxs)(Y,{target:C,className:q,rel:C==="_blank"?"noopener noreferrer":void 0,href:v,onClick:ae=>{Q&&!H&&(ae.preventDefault(),ae.stopPropagation()),b?.(ae)},onMouseEnter:G,onMouseLeave:M,onKeyDown:ee,role:v?j:j||"menuitem","data-role":"menuitem",ref:X,"data-testid":K,"aria-label":x,"aria-checked":E,tabIndex:B,...te,children:[(0,t.jsxs)(i.B,{direction:"row",justifyContent:"flex-start",alignItems:"center",children:[P&&(0,t.jsx)(g.I,{name:P,className:w.icon,"aria-hidden":!0}),(0,t.jsx)("span",{className:w.ellipsis,children:m}),(0,t.jsxs)("div",{className:(0,n.cx)(w.rightWrapper,{[w.withShortcut]:Z}),children:[Z&&(0,t.jsxs)("div",{className:w.shortcut,children:[(0,t.jsx)(g.I,{name:"keyboard",title:"keyboard shortcut"}),I]}),Q&&(0,t.jsx)(u,{items:O,isOpen:H,close:ne,customStyle:N})]})]}),D&&(0,t.jsx)("div",{className:(0,n.cx)(w.description,w.ellipsis,{[w.descriptionWithIcon]:P!==void 0}),children:D}),y.component?(0,t.jsx)(y.component,{}):null]})}));p.displayName="MenuItem";const h=y=>({item:(0,n.css)({background:"none",cursor:"pointer",whiteSpace:"nowrap",color:y.colors.text.primary,display:"flex",flexDirection:"column",alignItems:"stretch",padding:y.spacing(.5,2),minHeight:y.spacing(4),margin:0,border:"none",width:"100%",position:"relative","&:hover, &:focus-visible":{background:y.colors.action.hover,color:y.colors.text.primary,textDecoration:"none"},"&:focus-visible":(0,a.getFocusStyles)(y)}),active:(0,n.css)({background:y.colors.action.hover}),destructive:(0,n.css)({color:y.colors.error.text,svg:{color:y.colors.error.text},"&:hover, &:focus, &:focus-visible":{background:y.colors.error.main,color:y.colors.error.contrastText,svg:{color:y.colors.error.contrastText}}}),disabled:(0,n.css)({color:y.colors.action.disabledText,label:"menu-item-disabled","&:hover, &:focus, &:focus-visible":{cursor:"not-allowed",background:"none",color:y.colors.action.disabledText}}),icon:(0,n.css)({opacity:.7,color:y.colors.text.secondary}),rightWrapper:(0,n.css)({display:"flex",alignItems:"center",marginLeft:"auto"}),withShortcut:(0,n.css)({minWidth:y.spacing(10.5)}),shortcut:(0,n.css)({display:"flex",alignItems:"center",gap:y.spacing(1),marginLeft:y.spacing(2),color:y.colors.text.secondary,opacity:.7}),description:(0,n.css)({...y.typography.bodySmall,color:y.colors.text.secondary,textAlign:"start"}),descriptionWithIcon:(0,n.css)({marginLeft:y.spacing(3)}),ellipsis:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})})},32653:(_,L,e)=>{"use strict";e.d(L,{t:()=>a});var t=e(96540),n=e(94701);const r=(g,i)=>(g%i+i)%i,s=-1,a=({localRef:g,isMenuOpen:i,close:l,onOpen:d,onClose:o,onKeyDown:u})=>{const[c,p]=(0,t.useState)(s);return(0,t.useEffect)(()=>{i&&p(0)},[i]),(0,t.useEffect)(()=>{const y=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])');y?.[c]?.focus(),y?.forEach((f,v)=>{f.tabIndex=v===c?0:-1})},[g,c]),(0,n.A)(()=>{d?.(p)}),[y=>{const f=g?.current?.querySelectorAll('[data-role="menuitem"]:not([data-disabled])'),v=f?.length??0;switch(y.key){case"ArrowUp":y.preventDefault(),y.stopPropagation(),p(r(c-1,v));break;case"ArrowDown":y.preventDefault(),y.stopPropagation(),p(r(c+1,v));break;case"ArrowLeft":y.preventDefault(),y.stopPropagation(),p(s),l?.();break;case"Home":y.preventDefault(),y.stopPropagation(),p(0);break;case"End":y.preventDefault(),y.stopPropagation(),p(v-1);break;case"Enter":y.preventDefault(),y.stopPropagation(),f?.[c]?.click();break;case"Escape":o?.();break;case"Tab":y.preventDefault(),o?.();break;default:break}u?.(y)}]}},37390:(_,L,e)=>{"use strict";e.d(L,{a:()=>h});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(59875),i=e(96540),l=e(40845),d=e(76412),o=e(29158),u=e(67061),c=e(29473),p=e(88448);function h(v){const{title:P,children:m,isOpen:D=!1,closeOnEscape:x=!0,closeOnBackdropClick:E=!0,className:C,contentClassName:b,onDismiss:T,onClickBackdrop:A,trapFocus:R=!0}=v,S=(0,l.of)(p.o),O=(0,i.useRef)(null),{overlayProps:j,underlayProps:B}=(0,a.e)({isKeyboardDismissDisabled:!x,isOpen:D,onClose:T},O),{dialogProps:N,titleProps:I}=(0,r.s)({},O);if(!D)return null;const K=(0,n.cx)(S.modalHeader,typeof P!="string"&&S.modalHeaderWithTabs);return(0,t.jsxs)(g.Sf,{children:[(0,t.jsx)("div",{role:"presentation",className:S.modalBackdrop,onClick:A||(E?T:void 0),...B}),(0,t.jsx)(s.n1,{contain:R,autoFocus:!0,restoreFocus:!0,children:(0,t.jsxs)("div",{className:(0,n.cx)(S.modal,C),ref:O,...j,...N,children:[(0,t.jsxs)("div",{className:K,children:[typeof P=="string"&&(0,t.jsx)(f,{...v,title:P,id:I.id}),typeof P!="string"&&P,(0,t.jsx)("div",{className:S.modalHeaderClose,children:(0,t.jsx)(o.K,{name:"times",size:"xl",onClick:T,"aria-label":(0,d.t)("grafana-ui.modal.close-tooltip","Close")})})]}),(0,t.jsx)("div",{className:(0,n.cx)(S.modalContent,b),children:m})]})})]})}function y({leftItems:v,children:P}){const m=(0,l.of)(p.o);return v?(0,t.jsx)("div",{className:m.modalButtonRow,children:(0,t.jsxs)(u.B,{justifyContent:"space-between",children:[(0,t.jsx)(u.B,{justifyContent:"flex-start",gap:2,children:v}),(0,t.jsx)(u.B,{justifyContent:"flex-end",gap:2,children:P})]})}):(0,t.jsx)("div",{className:m.modalButtonRow,children:(0,t.jsx)(u.B,{justifyContent:"flex-end",gap:2,wrap:"wrap",children:P})})}h.ButtonRow=y;function f({icon:v,iconTooltip:P,title:m,id:D}){return(0,t.jsx)(c.r,{icon:v,iconTooltip:P,title:m,id:D})}},29473:(_,L,e)=>{"use strict";e.d(L,{r:()=>s});var t=e(74848),n=e(40845),r=e(88448);const s=({icon:a,iconTooltip:g,title:i,children:l,id:d})=>{const o=(0,n.of)(r.o);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h2",{className:o.modalHeaderTitle,id:d,children:i}),l]})}},25897:(_,L,e)=>{"use strict";e.d(L,{J:()=>a});var t=e(74848),n=e(40675),r=e(63021),s=e(29473);const a=({icon:g,title:i,tabs:l,activeTab:d,onChangeTab:o})=>(0,t.jsx)(s.r,{icon:g,title:i,children:(0,t.jsx)(r.U,{hideBorder:!0,children:l.map((u,c)=>(0,t.jsx)(n.o,{label:u.label,icon:u.icon,suffix:u.tabSuffix,active:u.value===d,onChangeTab:()=>o(u)},`${u.value}-${c}`))})})},71678:(_,L,e)=>{"use strict";e.d(L,{$s:()=>g,EO:()=>a,YO:()=>s,wE:()=>r});var t=e(74848),n=e(96540);const r=n.createContext({component:null,props:{},showModal:()=>{},hideModal:()=>{}});class s extends n.Component{constructor(l){super(l),this.showModal=(d,o)=>{this.setState({component:d,props:o})},this.hideModal=()=>{this.setState({component:null,props:{}})},this.state={component:l.component||null,props:l.props||{},showModal:this.showModal,hideModal:this.hideModal}}render(){return(0,t.jsx)(r.Provider,{value:this.state,children:this.props.children})}}const a=()=>(0,t.jsx)(r.Consumer,{children:({component:i,props:l})=>i?(0,t.jsx)(i,{...l}):null}),g=r.Consumer},88448:(_,L,e)=>{"use strict";e.d(L,{o:()=>n});var t=e(32196);const n=r=>{const s=r.shape.radius.default;return{modal:(0,t.css)({position:"fixed",zIndex:r.zIndex.modal,background:r.colors.background.primary,boxShadow:r.shadows.z3,borderRadius:s,border:`1px solid ${r.colors.border.weak}`,backgroundClip:"padding-box",outline:"none",width:"750px",maxWidth:"100%",left:0,right:0,marginLeft:"auto",marginRight:"auto",top:"10%",maxHeight:"80%",display:"flex",flexDirection:"column"}),modalBackdrop:(0,t.css)({position:"fixed",zIndex:r.zIndex.modalBackdrop,top:0,right:0,bottom:0,left:0,backgroundColor:r.components.overlay.background,backdropFilter:"blur(1px)"}),modalHeader:(0,t.css)({label:"modalHeader",display:"flex",alignItems:"center",minHeight:"42px",margin:r.spacing(1,2,0,2)}),modalHeaderWithTabs:(0,t.css)({borderBottom:`1px solid ${r.colors.border.weak}`}),modalHeaderTitle:(0,t.css)({fontSize:r.typography.size.lg,margin:r.spacing(0,4,0,1),display:"flex",alignItems:"center",position:"relative",top:"2px"}),modalHeaderIcon:(0,t.css)({marginRight:r.spacing(2),fontSize:"inherit","&:before":{verticalAlign:"baseline"}}),modalHeaderClose:(0,t.css)({height:"100%",display:"flex",alignItems:"center",color:r.colors.text.secondary,flexGrow:1,justifyContent:"flex-end"}),modalContent:(0,t.css)({overflow:"auto",padding:r.spacing(3),width:"100%"}),modalButtonRow:(0,t.css)({paddingTop:r.spacing(3)})}}},99544:(_,L,e)=>{"use strict";e.d(L,{O:()=>n});var t=e(19716);function n(r){const s="${"+r.value+"}",a=r.value===r.label?r.origin:`${r.label} / ${r.origin}`;return{label:s,kind:t.q.Property,detail:a,documentation:r.documentation}}},95247:(_,L,e)=>{"use strict";e.d(L,{d:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(16797),i=e(14578),l=e(29158),d=e(50720),o=e(15068);const u=(0,r.memo)(({title:p,section:h,parent:y,pageIcon:f,onGoBack:v,children:P,titleHref:m,parentHref:D,leftItems:x,isFullscreen:E,className:C,"aria-label":b,buttonOverflowAlignment:T="right",forceShowLeftItems:A=!1})=>{const R=(0,a.of)(c),S=(0,n.cx)("page-toolbar",R.toolbar,{"page-toolbar--fullscreen":E,[R.noPageIcon]:!f},C),O=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:R.truncateText,children:p}),h&&(0,t.jsxs)("span",{className:R.pre,children:[" / ",h]})]});return(0,t.jsxs)("nav",{className:S,"aria-label":b,children:[(0,t.jsxs)("div",{className:R.leftWrapper,children:[f&&!v&&(0,t.jsx)("div",{className:R.pageIcon,children:(0,t.jsx)(i.I,{name:f,size:"lg","aria-hidden":!0})}),v&&(0,t.jsx)("div",{className:R.pageIcon,children:(0,t.jsx)(l.K,{name:"arrow-left",tooltip:"Go back (Esc)",tooltipPlacement:"bottom",size:"xxl","data-testid":s.Tp.components.BackButton.backArrow,onClick:v})}),(0,t.jsxs)("nav",{"aria-label":"Search links",className:R.navElement,children:[y&&D&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(d.N,{"aria-label":`Search dashboard in the ${y} folder`,className:(0,n.cx)(R.titleText,R.parentLink,R.titleLink,R.truncateText),href:D,children:[y," ",(0,t.jsx)("span",{className:R.parentIcon})]}),m&&(0,t.jsx)("span",{className:(0,n.cx)(R.titleText,R.titleDivider),"aria-hidden":!0,children:"/"})]}),(p||!!x?.length)&&(0,t.jsxs)("div",{className:R.titleWrapper,children:[p&&(0,t.jsx)("h1",{className:R.h1Styles,children:m?(0,t.jsx)(d.N,{"aria-label":"Search dashboard by name",className:(0,n.cx)(R.titleText,R.titleLink),href:m,children:O}):(0,t.jsx)("div",{className:R.titleText,children:O})}),x?.map((j,B)=>(0,t.jsx)("div",{className:(0,n.cx)(R.leftActionItem,{[R.forceShowLeftActionItems]:A}),children:j},B))]})]})]}),(0,t.jsx)(o.U,{alignment:T,children:r.Children.toArray(P).filter(Boolean)})]})});u.displayName="PageToolbar";const c=p=>{const{spacing:h,typography:y}=p,f=(0,g.getFocusStyles)(p);return{pre:(0,n.css)({whiteSpace:"pre"}),toolbar:(0,n.css)({alignItems:"center",background:p.colors.background.canvas,display:"flex",gap:p.spacing(2),justifyContent:"space-between",padding:p.spacing(1.5,2),[p.breakpoints.down("md")]:{paddingLeft:"53px"}}),noPageIcon:(0,n.css)({[p.breakpoints.down("md")]:{paddingLeft:p.spacing(2)}}),leftWrapper:(0,n.css)({display:"flex",flexWrap:"nowrap",maxWidth:"70%"}),pageIcon:(0,n.css)({display:"none",[p.breakpoints.up("sm")]:{display:"flex",paddingRight:p.spacing(1),alignItems:"center"}}),truncateText:(0,n.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),titleWrapper:(0,n.css)({display:"flex",margin:0,minWidth:0}),navElement:(0,n.css)({display:"flex",alignItems:"center",minWidth:0}),h1Styles:(0,n.css)({margin:h(0,1,0,0),lineHeight:"inherit",flexGrow:1,minWidth:0}),parentIcon:(0,n.css)({marginLeft:p.spacing(.5)}),titleText:(0,n.css)({display:"flex",fontSize:y.size.lg,margin:0,borderRadius:p.shape.radius.default}),titleLink:(0,n.css)({"&:focus-visible":f}),titleDivider:(0,n.css)({padding:h(0,.5,0,.5),display:"none",[p.breakpoints.up("md")]:{display:"unset"}}),parentLink:(0,n.css)({display:"none",[p.breakpoints.up("md")]:{display:"unset",flex:1}}),leftActionItem:(0,n.css)({display:"none",alignItems:"center",paddingRight:h(.5),[p.breakpoints.up("md")]:{display:"flex"}}),forceShowLeftActionItems:(0,n.css)({display:"flex"})}}},19384:(_,L,e)=>{"use strict";e.d(L,{d:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(14578);const i=({currentPage:d,numberOfPages:o,onNavigate:u,hideWhenSinglePage:c,showSmallVersion:p,className:h})=>{const y=(0,s.of)(l),f=p?1:8,v=(0,r.useMemo)(()=>{const P=[...new Array(o).keys()],m=o>f,D=(x,E)=>(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(a.$n,{size:"sm",variant:E,onClick:()=>u(x),children:x})},x);return P.reduce((x,E)=>{const C=E+1,b=C===d?"primary":"secondary",T=f,A=o-f+1,R=A-T,S=C===1||C===o,O=R>-1&&d>=T&&d<=A,j=p?1:3,B=p?0:2;return m?S||d<T&&C<T||R>=0&&d>A&&C>A||R<0&&d>=T&&C>A||O&&C>=d-B&&C<=d+B?x.push(D(C,b)):(C===T&&d<T||C===A&&d>A||O&&(C===d-j||C===d+j))&&x.push((0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(g.I,{className:y.ellipsis,name:"ellipsis-v"})},C)):x.push(D(C,b)),x},[])},[d,o,u,f,p,y.ellipsis,y.item]);return c&&o<=1?null:(0,t.jsx)("div",{className:(0,n.cx)(y.container,h),children:(0,t.jsxs)("ol",{children:[(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(a.$n,{"aria-label":"previous page",size:"sm",variant:"secondary",onClick:()=>u(d-1),disabled:d===1,children:(0,t.jsx)(g.I,{name:"angle-left"})})}),v,(0,t.jsx)("li",{className:y.item,children:(0,t.jsx)(a.$n,{"aria-label":"next page",size:"sm",variant:"secondary",onClick:()=>u(d+1),disabled:d===o,children:(0,t.jsx)(g.I,{name:"angle-right"})})})]})})},l=()=>({container:(0,n.css)({float:"right"}),item:(0,n.css)({display:"inline-block",paddingLeft:"10px",marginBottom:"5px"}),ellipsis:(0,n.css)({transform:"rotate(90deg)"})})},89963:(_,L,e)=>{"use strict";e.d(L,{I:()=>i});var t=e(74848),n=e(32196),r=e(13544),s=e(40845),a=e(14578),g=e(56034);const i=({onCancel:o,loading:u})=>{const c=window.matchMedia("(prefers-reduced-motion: reduce)").matches,p=(0,s.of)(d);return u?(0,t.jsx)(g.m,{content:"Cancel query",children:(0,t.jsx)(a.I,{className:(0,n.cx)(p.spin,{[p.clickable]:!!o}),name:c?"hourglass":"sync",size:"sm",onClick:o,"data-testid":r.Tp.components.LoadingIndicator.icon})}):null},l=(0,n.keyframes)({"0%":{transform:"rotate(0deg) scaleX(-1)"},"100%":{transform:"rotate(359deg) scaleX(-1)"}}),d=o=>({clickable:(0,n.css)({cursor:"pointer"}),spin:(0,n.css)({[o.transitions.handleMotion("no-preference")]:{animation:`${l} 3s linear infinite`}})})},79041:(_,L,e)=>{"use strict";e.d(L,{XF:()=>s,d2:()=>a,e4:()=>r});var t=e(96540),n=e(18226);const r=(0,t.createContext)({eventsScope:"global",eventBus:new n.o}),s=r.Provider,a=()=>(0,t.useContext)(r)},91052:(_,L,e)=>{"use strict";e.d(L,{NR:()=>I});var t=e(89963),n=e(74848),r=e(32196),s=e(96540),a=e(42941),g=e(49185),i=e(39070),l=e(13544),d=e(40845),o=e(16797);function u({children:K,delay:w}){const[U,W]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{window.setTimeout(()=>{W(!0)},w)},[K,w]),(0,n.jsx)(n.Fragment,{children:U?K:null})}var c=e(14578),p=e(57514),h=e(94753),y=e(56034),f=e(83122),v=e(27746);function P({menu:K,title:w,placement:U="bottom",offset:W,dragClassCancel:H,menuButtonClass:z,onOpenMenu:G}){const M=w?l.Tp.components.Panels.Panel.menu(w):"panel-menu-button",Q=(0,s.useCallback)(Y=>{Y&&G&&G()},[G]);return(0,n.jsx)(f.m,{overlay:K,placement:U,offset:W,onVisibleChange:Q,children:(0,n.jsx)(v.I,{"aria-label":`Menu for panel with ${w?`title ${w}`:"no title"}`,title:"Menu",icon:"ellipsis-v",iconSize:"md",narrow:!0,"data-testid":M,className:(0,r.cx)(z,H)})})}function m({menu:K,title:w,dragClass:U,children:W,offset:H=-32,onOpenMenu:z}){const G=(0,d.of)(D),M=(0,s.useRef)(null),Q=l.Tp.components.Panels.Panel.HoverWidget,Y=(0,s.useCallback)(te=>{M.current?.setPointerCapture(te.pointerId)},[]),q=(0,s.useCallback)(te=>{M.current?.releasePointerCapture(te.pointerId)},[]);return W===void 0||s.Children.count(W)===0?null:(0,n.jsxs)("div",{className:(0,r.cx)(G.container,"show-on-hover"),style:{top:H},"data-testid":Q.container,children:[U&&(0,n.jsx)("div",{className:(0,r.cx)(G.square,G.draggable,U),onPointerDown:Y,onPointerUp:q,ref:M,"data-testid":Q.dragIcon,children:(0,n.jsx)(c.I,{name:"expand-arrows",className:G.draggableIcon})}),W,K&&(0,n.jsx)(P,{menu:K,title:w,placement:"bottom",menuButtonClass:G.menuButton,onOpenMenu:z})]})}function D(K){return{container:(0,r.css)({label:"hover-container-widget",[K.transitions.handleMotion("no-preference","reduce")]:{transition:"all .1s linear"},display:"flex",position:"absolute",zIndex:1,right:0,boxSizing:"content-box",alignItems:"center",background:K.colors.background.secondary,color:K.colors.text.primary,border:`1px solid ${K.colors.border.weak}`,borderRadius:K.shape.radius.default,height:K.spacing(4),boxShadow:K.shadows.z1}),square:(0,r.css)({display:"flex",justifyContent:"center",alignItems:"center",width:K.spacing(4),height:"100%"}),draggable:(0,r.css)({cursor:"move",[K.breakpoints.down("md")]:{display:"none"}}),menuButton:(0,r.css)({background:"inherit",border:"none","&:hover":{background:K.colors.secondary.main}}),draggableIcon:(0,r.css)({transform:"rotate(45deg)",color:K.colors.text.secondary,"&:hover":{color:K.colors.text.primary}})}}var x=e(55852);const E=(0,s.forwardRef)(({className:K,children:w,href:U,onClick:W,target:H,title:z,...G},M)=>{const Q=(0,d.of)(C);return U?(0,n.jsx)("a",{ref:M,href:U,onClick:W,target:H,title:z,className:(0,r.cx)(Q.linkItem,K),...G,children:w}):W?(0,n.jsx)(x.$n,{ref:M,className:(0,r.cx)(Q.item,K),variant:"secondary",fill:"text",onClick:W,children:w}):(0,n.jsx)("span",{ref:M,className:(0,r.cx)(Q.item,K),...G,children:w})});E.displayName="TitleItem";const C=K=>{const w=(0,r.css)({color:`${K.colors.text.secondary}`,label:"panel-header-item",cursor:"auto",border:"none",borderRadius:`${K.shape.radius.default}`,padding:`${K.spacing(0,1)}`,height:`${K.spacing(K.components.panel.headerHeight)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,o.getFocusStyles)(K),zIndex:1},"&: focus:not(:focus-visible)":(0,o.getMouseFocusStyles)(K),"&:hover ":{boxShadow:`${K.shadows.z1}`,background:`${K.colors.background.secondary}`,color:`${K.colors.text.primary}`}});return{item:w,linkItem:(0,r.cx)(w,(0,r.css)({cursor:"pointer"}))}};function b({description:K,className:w}){const U=(0,d.of)(T),W=()=>{const H=typeof K=="function"?K():K;return(0,n.jsx)("div",{className:"panel-info-content markdown-html",children:(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:H}})})};return K!==""?(0,n.jsx)(y.m,{interactive:!0,content:W,children:(0,n.jsx)(E,{className:(0,r.cx)(w,U.description),children:(0,n.jsx)(c.I,{name:"info-circle",size:"md"})})}):null}const T=K=>({description:(0,r.css)({code:{whiteSpace:"normal",wordWrap:"break-word"},"pre > code":{display:"block"}})});function A({message:K,onClick:w,ariaLabel:U="status"}){const W=(0,d.of)(R);return(0,n.jsx)(v.I,{className:W.buttonStyles,onClick:w,variant:"destructive",icon:"exclamation-triangle",iconSize:"md",tooltip:K||"","aria-label":U,"data-testid":l.Tp.components.Panels.Panel.status("error")})}const R=K=>{const{headerHeight:w,padding:U}=K.components.panel;return{buttonStyles:(0,r.css)({label:"panel-header-state-button",display:"flex",alignItems:"center",justifyContent:"center",padding:K.spacing(U),width:K.spacing(w),height:K.spacing(w),borderRadius:K.shape.radius.default})}};function S({width:K,height:w,children:U,padding:W="md",title:H="",description:z="",displayMode:G="default",titleItems:M,menu:Q,dragClass:Y,dragClassCancel:q,hoverHeader:te=!1,hoverHeaderOffset:X,loadingState:ee,statusMessage:ne,statusMessageOnClick:Z,leftItems:ae,actions:re,onCancelQuery:se,onOpenMenu:de,collapsible:le=!1,collapsed:he,onToggleCollapse:ie,onFocus:J,onMouseMove:ce,onMouseEnter:pe}){const Pe=(0,d.$j)(),Ie=(0,d.of)(N),ge=(0,s.useId)(),Se=(0,s.useId)().replace(/:/g,"_"),De=!te,[Ke,Me]=(0,a.A)(!0);he===void 0&&(he=!Ke);const be="show-on-hover",we=G==="transparent",Be=j(Pe,De),{contentStyle:He,innerWidth:Ve,innerHeight:Je}=B(W,Pe,Be,he,w,K),nt={height:Be,cursor:Y?"move":"auto"},pt={width:K,height:he?void 0:w},[bt,{width:Tt}]=(0,g.A)();ae&&(re=ae);const ye=typeof H=="string"?l.Tp.components.Panels.Panel.title(H):"Panel",je=(0,n.jsxs)(n.Fragment,{children:[!le&&H&&(0,n.jsx)("div",{className:Ie.title,children:(0,n.jsx)(h.E,{element:"h2",variant:"h6",truncate:!0,title:typeof H=="string"?H:void 0,id:Se,children:H})}),le&&(0,n.jsx)("div",{className:Ie.title,children:(0,n.jsx)(h.E,{element:"h2",variant:"h6",children:(0,n.jsxs)("button",{type:"button",className:Ie.clearButtonStyles,onClick:()=>{Me(),ie&&ie(!he)},"aria-expanded":!he,"aria-controls":he?void 0:ge,children:[(0,n.jsx)(c.I,{name:he?"angle-right":"angle-down","aria-hidden":!!H,"aria-label":H?void 0:"toggle collapse panel"}),(0,n.jsx)(h.E,{variant:"h6",truncate:!0,id:Se,children:H})]})})}),(0,n.jsxs)("div",{className:(0,r.cx)(Ie.titleItems,q),"data-testid":"title-items-container",children:[(0,n.jsx)(b,{description:z,className:q}),M]}),ee===i.Gu.Streaming&&(0,n.jsx)(y.m,{content:se?"Stop streaming":"Streaming",children:(0,n.jsx)(E,{className:q,"data-testid":"panel-streaming",onClick:se,children:(0,n.jsx)(c.I,{name:"circle-mono",size:"md",className:Ie.streaming})})}),ee===i.Gu.Loading&&se&&(0,n.jsx)(u,{delay:2e3,children:(0,n.jsx)(y.m,{content:"Cancel query",children:(0,n.jsx)(E,{className:(0,r.cx)(q,Ie.pointer),"data-testid":"panel-cancel-query",onClick:se,children:(0,n.jsx)(c.I,{name:"sync-slash",size:"md"})})})}),(0,n.jsx)("div",{className:Ie.rightAligned,children:re&&(0,n.jsx)("div",{className:Ie.rightActions,children:O(re,ue=>ue)})})]});return(0,n.jsxs)("section",{className:(0,r.cx)(Ie.container,{[Ie.transparentContainer]:we}),style:pt,"aria-labelledby":H?Se:void 0,"data-testid":ye,tabIndex:0,onFocus:J,onMouseMove:ce,onMouseEnter:pe,ref:bt,children:[(0,n.jsx)("div",{className:Ie.loadingBarContainer,children:ee===i.Gu.Loading?(0,n.jsx)(p.G,{width:Tt,ariaLabel:"Panel loading bar"}):null}),te&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m,{menu:Q,title:typeof H=="string"?H:void 0,offset:X,dragClass:Y,onOpenMenu:de,children:je}),ne&&(0,n.jsx)("div",{className:Ie.errorContainerFloating,children:(0,n.jsx)(A,{message:ne,onClick:Z,ariaLabel:"Panel status"})})]}),De&&(0,n.jsxs)("div",{className:(0,r.cx)(Ie.headerContainer,Y),style:nt,"data-testid":"header-container",children:[ne&&(0,n.jsx)("div",{className:q,children:(0,n.jsx)(A,{message:ne,onClick:Z,ariaLabel:"Panel status"})}),je,Q&&(0,n.jsx)(P,{menu:Q,title:typeof H=="string"?H:void 0,placement:"bottom-end",menuButtonClass:(0,r.cx)(Ie.menuItem,q,be),onOpenMenu:de})]}),!he&&(0,n.jsx)("div",{id:ge,"data-testid":l.Tp.components.Panels.Panel.content,className:(0,r.cx)(Ie.content,w===void 0&&Ie.containNone),style:He,children:typeof U=="function"?U(Ve,Je):U})]})}const O=(K,w)=>{const U=s.Children.toArray(K).filter(Boolean);return U.length>0?w(U):null},j=(K,w)=>w?K.spacing.gridSize*K.components.panel.headerHeight:0,B=(K,w,U,W,H,z)=>{const G=(K==="md"?w.components.panel.padding:0)*w.spacing.gridSize,M=G*2,Q=1*2;let Y=0;z&&(Y=z-M-Q);let q=0;return H&&(q=H-U-M-Q),W&&(q=U),{contentStyle:{padding:G},innerWidth:Y,innerHeight:q}},N=K=>{const{background:w,borderColor:U,padding:W}=K.components.panel;return{container:(0,r.css)({label:"panel-container",backgroundColor:w,border:`1px solid ${U}`,position:"relative",borderRadius:K.shape.radius.default,height:"100%",display:"flex",flexDirection:"column",".show-on-hover":{opacity:"0",visibility:"hidden"},"&:focus-visible, &:hover":{".show-on-hover":{opacity:"1",visibility:"visible"}},"&:focus-visible":(0,o.getFocusStyles)(K),"&:focus-within:not(:focus)":{".show-on-hover":{visibility:"visible",opacity:"1"}}}),transparentContainer:(0,r.css)({label:"panel-transparent-container",backgroundColor:"transparent",border:"1px solid transparent",boxSizing:"border-box","&:hover":{border:`1px solid ${U}`}}),loadingBarContainer:(0,r.css)({label:"panel-loading-bar-container",position:"absolute",top:0,width:"100%",zIndex:1}),containNone:(0,r.css)({contain:"none"}),content:(0,r.css)({label:"panel-content",flexGrow:1,contain:"size layout"}),headerContainer:(0,r.css)({label:"panel-header",display:"flex",alignItems:"center"}),pointer:(0,r.css)({cursor:"pointer"}),streaming:(0,r.css)({label:"panel-streaming",marginRight:0,color:K.colors.success.text,"&:hover":{color:K.colors.success.text}}),title:(0,r.css)({label:"panel-title",display:"flex",padding:K.spacing(0,W),minWidth:0,"& > h2":{minWidth:0}}),items:(0,r.css)({display:"flex"}),item:(0,r.css)({display:"flex",justifyContent:"center",alignItems:"center"}),hiddenMenu:(0,r.css)({visibility:"hidden"}),menuItem:(0,r.css)({label:"panel-menu",border:"none",background:K.colors.secondary.main,"&:hover":{background:K.colors.secondary.shade}}),errorContainerFloating:(0,r.css)({label:"error-container",position:"absolute",left:0,top:0,zIndex:1}),rightActions:(0,r.css)({display:"flex",padding:K.spacing(0,W),gap:K.spacing(1)}),rightAligned:(0,r.css)({label:"right-aligned-container",marginLeft:"auto",display:"flex",alignItems:"center"}),titleItems:(0,r.css)({display:"flex",height:"100%"}),clearButtonStyles:(0,r.css)({alignItems:"center",display:"flex",gap:K.spacing(.5),background:"transparent",border:"none",padding:0,maxWidth:"100%"})}},I=S;I.LoadingIndicator=t.I,I.TitleItem=E},88895:(_,L,e)=>{"use strict";e.d(L,{B:()=>t});var t=(n=>(n.ToggleSelection="select",n.AppendToSelection="append",n))(t||{})},52494:(_,L,e)=>{"use strict";e.d(L,{_:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,className:i,...l})=>{const d=(0,r.of)(a);return(0,t.jsx)("div",{className:(0,n.cx)(d,i),...l,children:g})},a=g=>(0,n.css)({backgroundColor:g.components.panel.background,border:`1px solid ${g.components.panel.borderColor}`,borderRadius:g.shape.radius.default})},98624:(_,L,e)=>{"use strict";e.d(L,{B:()=>a});var t=e(74848),n=e(43429),r=e(39938);const s={[n.kv.grafana]:"grafana",[n.kv.commercial]:"shield",[n.kv.community]:"shield",DEFAULT:"shield-exclamation"},a=({status:i,color:l,signatureType:d,signatureOrg:o,...u})=>{const c=g(i,d,o);return(0,t.jsx)(r.E,{text:c.text,color:c.color,icon:c.icon,tooltip:c.tooltip,...u})};a.displayName="PluginSignatureBadge";function g(i,l,d){i||(i=n.Ac.invalid);const o=s[l||""]||s.DEFAULT;switch(i){case n.Ac.internal:return{text:"Core",color:"blue",tooltip:"Core plugin that is bundled with Grafana"};case n.Ac.valid:return{text:l||"Signed",icon:l?o:"lock",color:"green",tooltip:"Signed and verified plugin"};case n.Ac.invalid:return{text:"Invalid signature",icon:"exclamation-triangle",color:"red",tooltip:"Invalid plugin signature"};case n.Ac.modified:return{text:"Modified signature",icon:"exclamation-triangle",color:"red",tooltip:"Valid signature but content has been modified"};case n.Ac.missing:return{text:"Missing signature",icon:"exclamation-triangle",color:"red",tooltip:"Missing plugin signature"};default:return{text:"Unsigned",icon:"exclamation-triangle",color:"red",tooltip:"Unsigned external plugin"}}}},20084:(_,L,e)=>{"use strict";e.d(L,{X:()=>E});var t=e(74848),n=e(32196),r=e(46942),s=e.n(r),a=e(2543),g=e.n(a),i=e(96540),l=e(52845),d=e(29317),o=e(13544),u=e(80903),c=e(4269),p=e(88295),h=e(74738),y=e(31589),f=e(1020),v=e(99453),P=e(40845),m=e(16797),D=e(72307);class x extends i.PureComponent{constructor(T){super(T),this.lastExecutedValue=null,this.mounted=!1,this.editor=null,this.onChange=(j,B)=>{const N=j.document!==this.state.value.document,I=this.state.value;this.props.onRichValueChange&&this.props.onRichValueChange(j),this.setState({value:j},()=>{if(N){const K=l.default.serialize(I)!==l.default.serialize(j);K&&B&&this.runOnChangeAndRunQuery(),K&&!B&&this.runOnChangeDebounced()}})},this.runOnChange=()=>{const{onChange:j}=this.props,B=l.default.serialize(this.state.value);j&&j(this.cleanText(B))},this.runOnRunQuery=()=>{const{onRunQuery:j}=this.props;j&&(j(),this.lastExecutedValue=this.state.value)},this.runOnChangeAndRunQuery=()=>{this.runOnChange(),this.runOnRunQuery()},this.handleBlur=(j,B,N)=>{const{onBlur:I}=this.props;if(I)I();else{const K=this.lastExecutedValue?l.default.serialize(this.lastExecutedValue):"",w=l.default.serialize(B.value);K!==w&&this.runOnChangeAndRunQuery()}return N()},this.runOnChangeDebounced=(0,a.debounce)(this.runOnChange,500);const{onTypeahead:A,cleanText:R,portalOrigin:S,onWillApplySuggestion:O}=T;this.plugins=[(0,u.Pz)({onTypeahead:A,cleanText:R,portalOrigin:S,onWillApplySuggestion:O}),(0,c.U)({handler:this.runOnChangeAndRunQuery}),(0,p.O)(),(0,h.v)(),(0,y.l)(),(0,f.T)(),(0,v.s)(),...T.additionalPlugins||[]].filter(j=>j),this.state={suggestions:[],typeaheadContext:null,typeaheadPrefix:"",typeaheadText:"",value:(0,D.mO)(T.query||"",T.syntax)}}static{this.defaultProps={onBlur:()=>{}}}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}componentDidUpdate(T,A){const{query:R,syntax:S,syntaxLoaded:O}=this.props;if(!T.syntaxLoaded&&O&&this.editor){const B=this.editor.insertText(" ").deleteBackward(1);this.onChange(B.value,!0)}const{value:j}=this.state;R!==T.query&&R!==l.default.serialize(j)&&this.setState({value:(0,D.mO)(R||"",S)})}cleanText(T){return T.replace(/[\r]/g,"")}render(){const{disabled:T,theme:A}=this.props,R=s()("slate-query-field__wrapper",{"slate-query-field__wrapper--disabled":T}),S=C(A);return(0,t.jsx)("div",{className:(0,n.cx)(R,S.wrapper),children:(0,t.jsx)("div",{className:"slate-query-field","data-testid":o.Tp.components.QueryField.container,children:(0,t.jsx)(d.Editor,{ref:O=>this.editor=O,schema:D.yx,autoCorrect:!1,readOnly:this.props.disabled,onBlur:this.handleBlur,onClick:this.props.onClick,onChange:O=>{this.onChange(O.value,!1)},placeholder:this.props.placeholder,plugins:this.plugins,spellCheck:!1,value:this.state.value})})})}}const E=(0,P.cV)(x),C=b=>{const T=(0,m.getFocusStyles)(b);return{wrapper:(0,n.css)({"&:focus-within":T})}}},11134:(_,L,e)=>{"use strict";e.d(L,{cC:()=>u,cb:()=>o});var t=e(74848),n=e(91e3),r=e(96540),s=e(70416),a=e(13544),g=e(76412),i=e(19727),l=e(9261),d=e(27746);const o=["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"];class u extends r.PureComponent{constructor(y){super(y),this.onChangeSelect=f=>{const{onIntervalChanged:v}=this.props;v&&f.value!=null&&v(f.value)}}static{this.offOption={label:"Off",value:"",ariaLabel:"Turn off auto refresh"}}static{this.liveOption={label:"Live",value:"LIVE",ariaLabel:"Turn on live streaming"}}static{this.autoOption={label:"Auto",value:"auto",ariaLabel:"Select refresh from the query range"}}static{this.isLive=y=>y===u.liveOption.value}getVariant(){return this.props.isLive||this.props.primary?"primary":this.props.isOnCanvas?"canvas":"default"}render(){const{onRefresh:y,intervals:f,tooltip:v,value:P,text:m,isLoading:D,noIntervalPicker:x,width:E,showAutoInterval:C}=this.props,b=P||"",T=this.getVariant(),A=p({intervals:f,showAutoInterval:C}),R=A.find(({value:W})=>W===b),S=c(u.offOption.value);let O=R||S;O.label===S.label&&(O={value:""});const j=O.ariaLabel,B=(0,g.t)("refresh-picker.aria-label.duration-selected","Choose refresh time interval with current interval {{durationAriaLabel}} selected",{durationAriaLabel:j}),N=(0,g.t)("refresh-picker.aria-label.choose-interval","Auto refresh turned off. Choose refresh time interval"),I=O.value===""?N:B,K=(0,g.t)("refresh-picker.tooltip.interval-selected","Set auto refresh interval"),w=(0,g.t)("refresh-picker.tooltip.turned-off","Auto refresh off"),U=O.value===""?w:K;return(0,t.jsxs)(i.e,{className:"refresh-picker",children:[(0,t.jsx)(d.I,{"aria-label":m,tooltip:v,onClick:y,variant:T,icon:D?"spinner":"sync",style:E?{width:E}:void 0,"data-testid":a.Tp.components.RefreshPicker.runButtonV2,children:m}),!x&&(0,t.jsx)(l.f,{value:O,options:A,onChange:this.onChangeSelect,variant:T,"data-testid":a.Tp.components.RefreshPicker.intervalButtonV2,"aria-label":I,tooltip:U})]})}}function c(h){switch(h){case u.liveOption.value:return{label:(0,g.t)("refresh-picker.live-option.label","Live"),value:h,ariaLabel:(0,g.t)("refresh-picker.live-option.aria-label","Turn on live streaming")};case u.offOption.value:return{label:(0,g.t)("refresh-picker.off-option.label","Off"),value:h,ariaLabel:(0,g.t)("refresh-picker.off-option.aria-label","Turn off auto refresh")};case u.autoOption.value:return{label:(0,g.t)("refresh-picker.auto-option.label",u.autoOption.label),value:h,ariaLabel:(0,g.t)("refresh-picker.auto-option.aria-label",u.autoOption.ariaLabel)}}return{label:h,value:h}}function p({intervals:h=o,showAutoInterval:y=!1}={}){const f=h.map(v=>{const P=(0,s.E9)(v),m=(0,n.a)(P);return{label:v,value:v,ariaLabel:m}});return y&&f.unshift(c(u.autoOption.value)),f.unshift(c(u.offOption.value)),f}},44522:(_,L,e)=>{"use strict";e.d(L,{I:()=>r});var t=e(96540),n=e(80997);function r({component:s,content:a,...g}){return t.createElement(s||"span",{dangerouslySetInnerHTML:{__html:n.sQ.sanitize(a)},...g})}},56286:(_,L,e)=>{"use strict";e.d(L,{L:()=>l});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(55852),g=e(90090);const i=()=>({noRadiusInput:(0,n.css)({borderBottomRightRadius:"0 !important",borderTopRightRadius:"0 !important"}),noRadiusButton:(0,n.css)({borderBottomLeftRadius:"0 !important",borderTopLeftRadius:"0 !important"})}),l=({label:d="Password",labelWidth:o,inputWidth:u=12,onReset:c,isConfigured:p,tooltip:h,placeholder:y="Password",interactive:f,...v})=>{const P=i();return(0,t.jsx)(g.z,{label:d,tooltip:h,interactive:f,labelWidth:o,inputEl:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("input",{type:"text",className:(0,n.cx)(`gf-form-input width-${u}`,P.noRadiusInput),disabled:!0,value:"configured",...(0,r.omit)(v,"value")}),(0,t.jsx)(a.$n,{onClick:c,variant:"secondary",type:"button",children:"Reset"})]}):(0,t.jsx)("input",{type:"password",className:`gf-form-input width-${u}`,placeholder:y,...v})})};l.displayName="SecretFormField"},9226:(_,L,e)=>{"use strict";e.d(L,{L4:()=>i});var t=e(74848),n=e(55852),r=e(10354),s=e(67061);const a="configured",g="Reset",i=({isConfigured:l,onReset:d,...o})=>(0,t.jsxs)(s.B,{children:[!l&&(0,t.jsx)(r.p,{...o,type:"password"}),l&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.p,{...o,type:"text",disabled:!0,value:a}),(0,t.jsx)(n.$n,{onClick:d,variant:"secondary",children:g})]})]})},58724:(_,L,e)=>{"use strict";e.d(L,{lp:()=>u});var t=e(74848),n=e(32196),r=e(40845),s=e(55852),a=e(90613),g=e(67061),i=e(21744);const l="configured",d="Reset",o=c=>({configuredStyle:(0,n.css)({minHeight:c.spacing(c.components.height.md),paddingTop:c.spacing(.5),resize:"none"})}),u=({isConfigured:c,onReset:p,...h})=>{const y=(0,r.of)(o);return(0,t.jsxs)(g.B,{children:[(0,t.jsxs)(a.a,{children:[!c&&(0,t.jsx)(i.f,{...h}),c&&(0,t.jsx)(i.f,{...h,rows:1,disabled:!0,value:l,className:(0,n.cx)(y.configuredStyle)})]}),c&&(0,t.jsx)(s.$n,{onClick:p,variant:"secondary",children:d})]})}},38401:(_,L,e)=>{"use strict";e.d(L,{Y:()=>o});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(40845),g=e(76892),i=e(13102),l=e(86997),d=e(2336);function o({options:u,value:c,onChange:p,Component:h,className:y,allowCustomValue:f,allowEmptyValue:v,placeholder:P,disabled:m,inputMinWidth:D,inputPlaceholder:x,onExpandedChange:E,autofocus:C=!1,...b}){const[T,A,R,S]=(0,d.Q)(C,E),O=D?Math.max(D,A):A,j=(0,a.of)(l.m);if(!R){const B=(0,r.isObject)(c)?c.label:c,N=B!=null?String(B):void 0;return(0,t.jsx)(T,{disabled:m,Component:h||(0,t.jsx)(g.c,{className:(0,n.cx)(j.segment,{[j.queryPlaceholder]:P!==void 0&&!c,[j.disabled]:m},y),children:N||P})})}return(0,t.jsx)(i.a,{...b,value:c&&!(0,r.isObject)(c)?{value:c}:c,placeholder:x,options:u,width:O,onClickOutside:()=>S(!1),allowCustomValue:f,allowEmptyValue:v,onChange:B=>{S(!1),p(B)}})}},83684:(_,L,e)=>{"use strict";e.d(L,{s:()=>c});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(41053),g=e(40845),i=e(76412),l=e(76892),d=e(13102),o=e(86997),u=e(2336);function c({value:h,onChange:y,loadOptions:f,reloadOptionsOnChange:v=!1,Component:P,className:m,allowCustomValue:D,allowEmptyValue:x,disabled:E,placeholder:C,inputMinWidth:b,inputPlaceholder:T,autofocus:A=!1,onExpandedChange:R,noOptionMessageHandler:S=p,...O}){const[j,B]=(0,a.A)(f,[f]),[N,I,K,w]=(0,u.Q)(A,R),U=b?Math.max(b,I):I,W=(0,g.of)(o.m);if(!K){const H=(0,r.isObject)(h)?h.label:h,z=H!=null?String(H):void 0;return(0,t.jsx)(N,{onClick:v?void 0:B,disabled:E,Component:P||(0,t.jsx)(l.c,{className:(0,n.cx)(W.segment,{[W.queryPlaceholder]:C!==void 0&&!h,[W.disabled]:E},m),children:z||C})})}return(0,t.jsx)(d.a,{...O,value:h&&!(0,r.isObject)(h)?{value:h}:h,placeholder:T,options:j.value??[],loadOptions:v?B:void 0,width:U,noOptionsMessage:S(j),allowCustomValue:D,allowEmptyValue:x,onClickOutside:()=>{w(!1)},onChange:H=>{w(!1),y(H)}})}function p(h){return h.loading?(0,i.t)("grafana-ui.segment-async.loading","Loading options..."):h.error?(0,i.t)("grafana-ui.segment-async.error","Failed to load options"):(0,i.t)("grafana-ui.segment-async.no-options","No options found")}},57752:(_,L,e)=>{"use strict";e.d(L,{o:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(37151),a=e(40845),g=e(29413),i=e(76892),l=e(86997),d=e(2336);const o=14;function u({value:c,onChange:p,Component:h,className:y,placeholder:f,inputPlaceholder:v,disabled:P,autofocus:m=!1,onExpandedChange:D,...x}){const E=(0,r.useRef)(null),[C,b]=(0,r.useState)(c),[T,A]=(0,r.useState)((0,g.kD)((c||"").toString(),o).width),[R,,S,O]=(0,d.Q)(m,D),j=(0,a.of)(l.m);if((0,s.A)(E,()=>{O(!1),p(C)}),!S)return(0,t.jsx)(R,{disabled:P,Component:h||(0,t.jsx)(i.c,{className:(0,n.cx)(j.segment,{[j.queryPlaceholder]:f!==void 0&&!C,[j.disabled]:P},y),children:c||f})});const B=(0,n.css)({width:`${Math.max(T+20,32)}px`});return(0,t.jsx)("input",{...x,ref:E,autoFocus:!0,className:(0,n.cx)("gf-form gf-form-input",B),value:C,placeholder:v,onChange:N=>{const{width:I}=(0,g.kD)(N.target.value,o);A(I),b(N.target.value)},onBlur:()=>{O(!1),p(C)},onKeyDown:N=>{[13,27].includes(N.keyCode)&&(O(!1),p(C))}})}},64765:(_,L,e)=>{"use strict";e.d(L,{L:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(39268),a=e(76892);const g=({label:l,htmlFor:d,children:o,fill:u})=>{const c=(0,r.of)(i);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(s.C,{children:[(0,t.jsx)(a.c,{htmlFor:d,width:12,className:c.label,children:l}),o,u&&(0,t.jsx)("div",{className:c.fill,children:(0,t.jsx)(a.c,{children:""})})]})})},i=l=>({label:(0,n.css)({color:l.colors.primary.text}),fill:(0,n.css)({flexGrow:1,marginBottom:l.spacing(.5)})})},13102:(_,L,e)=>{"use strict";e.d(L,{a:()=>a});var t=e(74848),n=e(96540),r=e(40845),s=e(90182);function a({value:g,placeholder:i="",options:l=[],onChange:d,onClickOutside:o,loadOptions:u=void 0,width:c,noOptionsMessage:p="",allowCustomValue:h=!1,allowEmptyValue:y=!1,...f}){const v=(0,n.useRef)(null),P=(0,r.$j)();let m=c>0?c/P.spacing.gridSize:void 0,D,x={};return u?(D=s.DW,x={loadOptions:u,defaultOptions:!0}):D=s.l6,(0,t.jsx)("div",{...f,ref:v,children:(0,t.jsx)(D,{width:m,noOptionsMessage:p,placeholder:i,autoFocus:!0,isOpen:!0,onChange:d,options:l,value:g,closeMenuOnSelect:!1,onCloseMenu:()=>{if(v&&v.current){const E=v.current.querySelector('input[id^="react-select-"]');E&&(E.value||y)?d({value:E.value,label:E.value}):o()}},allowCustomValue:h,...x})})}},86997:(_,L,e)=>{"use strict";e.d(L,{m:()=>n});var t=e(32196);const n=r=>{const s="v1"in r?r.v1.palette:r.palette;return{segment:(0,t.css)({cursor:"pointer",width:"auto"}),queryPlaceholder:(0,t.css)({color:s.gray2}),disabled:(0,t.css)({cursor:"not-allowed",opacity:.65,boxShadow:"none"})}}},2336:(_,L,e)=>{"use strict";e.d(L,{Q:()=>a});var t=e(74848),n=e(96540),r=e(40845),s=e(55852);const a=(g,i)=>{const l=(0,n.useRef)(null),d=(0,r.of)(s.my),[o,u]=(0,n.useState)(g),[c,p]=(0,n.useState)(0),h=f=>{u(f),i&&i(f)};return[({Component:f,onClick:v,disabled:P})=>(0,t.jsx)("button",{type:"button",className:d,ref:l,disabled:P,onClick:()=>{h(!0),l&&l.current&&p(l.current.clientWidth*1.25),v?.()},children:f}),c,o,h]}},67570:(_,L,e)=>{"use strict";e.d(L,{u:()=>p});var t=e(2543),n=e.n(t),r=e(96540),s=e(13752),a=e(62467),g=e(11150),i=e(96083),l=e(63720),d=e(59099),o=e(54479),u=e(11134);function c(h){return{label:h,value:stringToMs(h)}}class p extends r.PureComponent{constructor(y){super(y),this.propsSubject=new s.B,this.subscription=null}componentDidMount(){this.subscription=this.propsSubject.pipe((0,l.n)(y=>u.cC.isLive(y.interval)?(0,a.of)({}):y.loading?g.t:(0,i.Y)((0,o.dc)(y.interval))),(0,d.M)(()=>this.props.func())).subscribe(),this.propsSubject.next(this.props)}componentDidUpdate(y){u.cC.isLive(y.interval)&&u.cC.isLive(this.props.interval)||(0,t.isEqual)(y,this.props)||this.propsSubject.next(this.props)}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe(),this.propsSubject.unsubscribe()}render(){return null}}},63250:(_,L,e)=>{"use strict";e.d(L,{I1:()=>m,_$:()=>y,gl:()=>c});var t=e(2543),n=e.n(t),r=e(47070),s=e(75059),a=e(50082),g=e(62398),i=e(24293),l=e(90708),d=e(47737),o=e(52622);const u=["reduceOptions","orientation"];function c(E,C,b){let T=E.options;if(E.fieldConfig=E.fieldConfig||{defaults:{},overrides:[]},C==="singlestat"&&b.angular)return h(E,b);if(C==="graph")return p(E,b);for(const A of u)b.hasOwnProperty(A)&&(T[A]=(0,t.cloneDeep)(b[A]));return T}function p(E,C){const b=C.angular,T={orientation:r.wV.Auto,reduceOptions:{values:!1,calcs:[]},legend:{displayMode:o.lm.List,showLegend:!0,placement:"bottom",calcs:[]}};if(b.xaxis?.mode==="series"){E.fieldConfig={...E.fieldConfig,defaults:{...E.fieldConfig.defaults,color:{mode:"palette-classic"}}},b.xaxis.values&&(T.reduceOptions.calcs=x(b.xaxis.values));const A=b.legend;if(A){if(A.show?T.legend.displayMode=A.alignAsTable?o.lm.Table:o.lm.List:T.legend.showLegend=!1,A.rightSide&&(T.legend.placement="right"),A.values){const R=(0,t.pickBy)(A,t.identity);T.legend.calcs=D(R)}A.sideWidth&&(T.legend.width=A.sideWidth)}}return T}function h(E,C){const b=C.angular,T=s.AS.getIfExists(b.valueName),A={reduceOptions:{calcs:[T?T.id:s.gy.mean]},orientation:r.wV.Horizontal},R={};if(b.format&&(R.unit=b.format),b.tableColumn&&(A.reduceOptions.fields=`/^${b.tableColumn}$/`),b.nullPointMode&&(R.nullValueMode=b.nullPointMode),b.nullText&&(R.noValue=b.nullText),(b.decimals||b.decimals===0)&&(R.decimals=b.decimals),b.thresholds&&b.colors){const O=b.thresholds.split(",").map(B=>Number(B.trim())),j=[];for(const B of b.colors){const N=j.length-1;N>=0?j.push({value:O[N],color:B}):j.push({value:-1/0,color:B})}R.thresholds={mode:a.O.Absolute,steps:j}}const S=(0,g.bh)(b,R.thresholds);return S&&S.length&&(R.mappings=S),b.gauge&&b.gauge.show&&(R.min=b.gauge.minValue,R.max=b.gauge.maxValue),E.fieldConfig.defaults=R,A}function y(E){if(!E.options)return{};const C=parseFloat(E.pluginVersion||"6.1");let b=E.options;C<6.2&&(b=v(b)),C<6.3&&(b=f(b));const{fieldOptions:T}=b;if(C<6.6&&T){if(T&&T.override){const{override:S,...O}=b.fieldOptions;b={...b,fieldOptions:{...O,overrides:[]}}}let A=T?.defaults?.thresholds;A?delete T.defaults.thresholds:(A=T?.thresholds,delete T.thresholds),A&&(T.defaults.thresholds={mode:a.O.Absolute,steps:A});const{defaults:R}=T;R.color&&typeof R.color=="string"&&(R.color={mode:i.Y.Fixed,fixedColor:R.color}),(0,l.BF)(R)}if(C<7&&(E.fieldConfig=E.fieldConfig||{defaults:{},overrides:[]},E.fieldConfig={defaults:T&&T.defaults?{...E.fieldConfig.defaults,...T.defaults}:E.fieldConfig.defaults,overrides:T&&T.overrides?[...E.fieldConfig.overrides,...T.overrides]:E.fieldConfig.overrides},T&&(b.reduceOptions={values:T.values,limit:T.limit,calcs:T.calcs}),delete b.fieldOptions),C<7.1){const A=E.fieldConfig.defaults.title;A!=null&&(E.fieldConfig.defaults.displayName=A,delete E.fieldConfig.defaults.title)}if(C<8){const A=E.fieldConfig?.defaults;let R=A?.unit;R==="percent"?((0,t.isNumber)(A.min)||(A.min=0),(0,t.isNumber)(A.max)||(A.max=100)):R==="percentunit"&&((0,t.isNumber)(A.min)||(A.min=0),(0,t.isNumber)(A.max)||(A.max=1))}return b}function f(E){const{fieldOptions:C}=E;if(!C)return E;const{mappings:b,...T}=E.fieldOptions;let A;return E.thresholds&&(A={mode:a.O.Absolute,steps:P(E.thresholds)}),{...E,fieldOptions:{...T,defaults:{...C.defaults,mappings:b,thresholds:A}}}}function v(E){const{valueOptions:C}=E;if(!C)return E;const b={},T={};if(b.mappings=E.valueMappings,b.thresholds=E.thresholds,b.defaults=T,T.unit=C.unit,T.decimals=C.decimals,C.stat){const R=s.AS.get(C.stat);R&&(b.calcs=[R.id])}T.min=E.minValue,T.max=E.maxValue;const A={...E,fieldOptions:b};return(0,t.omit)(A,"valueMappings","thresholds","valueOptions","minValue","maxValue")}function P(E){if(!E||!E.length)return;const C=E.map(b=>({value:b.value===null?-1/0:b.value,color:b.color}));return(0,d.RU)(C),C[0].value=-1/0,C}function m(E){return(0,g.bh)(E)}function D(E){const C=[];for(const b in E){const T=s.AS.getIfExists(b);T&&C.push(T.id)}return C}function x(E){const C=[];return E?.forEach(b=>{Object.values(s.gy).includes(b)?C.push(b):b==="current"?C.push(s.gy.lastNotNull):b==="total"?C.push(s.gy.sum):b==="avg"&&C.push(s.gy.mean)}),E?C:[s.gy.sum]}},47097:(_,L,e)=>{"use strict";e.d(L,{F:()=>c});var t=e(74848),n=e(32196),r=e(52762),s=e(10434),a=e(96540),g=e(40845),i=e(80427);const l=p=>{const{value:h,children:y,visible:f,placement:v,tipFormatter:P,...m}=p,D=(0,a.useRef)(null),x=(0,a.useRef)(null),E=(0,g.of)(d);function C(){x.current!==null&&cancelAnimationFrame(x.current)}function b(){x.current=requestAnimationFrame(()=>{D.current?.forceAlign()})}return(0,a.useEffect)(()=>(f?b():C(),C),[h,f]),(0,t.jsx)(i.A,{overlayClassName:E.tooltip,placement:v,overlay:P??h,overlayInnerStyle:{minHeight:"auto"},ref:D,visible:f,...m,children:y})},d=p=>({tooltip:(0,n.css)({position:"absolute",display:"block",visibility:"visible",fontSize:p.typography.bodySmall.fontSize,opacity:.9,padding:3,zIndex:p.zIndex.tooltip})}),o=l;var u=e(24849);const c=({min:p,max:h,onChange:y,onAfterChange:f,orientation:v="horizontal",reverse:P,step:m,formatTooltipResult:D,value:x,tooltipAlwaysVisible:E=!0})=>{const C=(0,a.useCallback)(S=>{y?.(typeof S=="number"?[S,S]:S)},[y]),b=(0,a.useCallback)(S=>{f?.(typeof S=="number"?[S,S]:S)},[f]),T=v==="horizontal",A=(0,g.of)(u.$,T),R=(S,O)=>(0,t.jsx)(o,{value:O.value,visible:E||O.dragging,tipFormatter:D?()=>D(O.value):void 0,placement:T?"top":"right",children:S});return(0,t.jsxs)("div",{className:(0,n.cx)(A.container,A.slider),children:[(0,t.jsx)(r.Global,{styles:A.tooltip}),(0,t.jsx)(s.A,{min:p,max:h,step:m,defaultValue:x,range:!0,onChange:C,onChangeComplete:b,vertical:!T,reverse:P,handleRender:R})]})};c.displayName="RangeSlider"},24849:(_,L,e)=>{"use strict";e.d(L,{$:()=>s});var t=e(32196),n=e(52762),r=e(12415);const s=(a,g,i=!1)=>{const{spacing:l}=a,d=a.colors.border.strong,o=a.colors.primary.main,u=a.colors.primary.main,p=`box-shadow: 0px 0px 0px 6px ${a.colors.primary.transparent}`;return{container:(0,t.css)({width:"100%",margin:g?"inherit":l(1,3,1,1),paddingBottom:g&&i?a.spacing(1):"inherit",height:g?"auto":"100%"}),slider:(0,t.css)`
      .rc-slider {
        display: flex;
        flex-grow: 1;
        margin-left: 7px; // half the size of the handle to align handle to the left on 0 value
      }
      .rc-slider-mark {
        top: ${a.spacing(1.75)};
      }
      .rc-slider-mark-text {
        color: ${a.colors.text.disabled};
        font-size: ${a.typography.bodySmall.fontSize};
      }
      .rc-slider-mark-text-active {
        color: ${a.colors.text.primary};
      }
      .rc-slider-handle {
        border: none;
        background-color: ${u};
        box-shadow: ${a.shadows.z1};
        cursor: pointer;
        opacity: 1;
      }

      .rc-slider-handle:hover,
      .rc-slider-handle:active,
      .rc-slider-handle-click-focused:focus {
        ${p};
      }

      // The triple class names is needed because that's the specificity used in the source css :(
      .rc-slider-handle-dragging.rc-slider-handle-dragging.rc-slider-handle-dragging,
      .rc-slider-handle:focus-visible {
        box-shadow: 0 0 0 5px ${a.colors.text.primary};
      }

      .rc-slider-dot,
      .rc-slider-dot-active {
        background-color: ${a.colors.text.primary};
        border-color: ${a.colors.text.primary};
      }

      .rc-slider-track {
        background-color: ${o};
      }
      .rc-slider-rail {
        background-color: ${d};
        cursor: pointer;
      }
    `,tooltip:(0,n.css)`
      body {
        .rc-slider-tooltip {
          cursor: grab;
          user-select: none;
          z-index: ${a.zIndex.tooltip};
        }

        .rc-slider-tooltip-inner {
          color: ${a.colors.text.primary};
          background-color: transparent !important;
          border-radius: 0;
          box-shadow: none;
        }

        .rc-slider-tooltip-placement-top .rc-slider-tooltip-arrow {
          display: none;
        }

        .rc-slider-tooltip-placement-top {
          padding: 0;
        }
      }
    `,sliderInput:(0,t.css)({display:"flex",flexDirection:"row",alignItems:"center",width:"100%"}),sliderInputVertical:(0,t.css)({flexDirection:"column",height:"100%",".rc-slider":{margin:0,order:2}}),sliderInputField:(0,t.css)({marginLeft:a.spacing(3),width:"60px",input:{textAlign:"center"}}),sliderInputFieldVertical:(0,t.css)({margin:`0 0 ${a.spacing(3)} 0`,order:1})}}},5926:(_,L,e)=>{"use strict";e.d(L,{O:()=>v});var t=e(74848),n=e(2543),r=e(96540),s=e(39624),a=e(21423),g=e(11261),i=e(8066),l=e(52622),d=e(81297),o=e(51336),u=e(16895),c=e(73060),p=e(14236),h=e(46294);function y(P,m){const D=P.y.values.length,x={...P.y.config,...m},E=P.x??{name:"",values:[...Array(D).keys()],type:g.PU.number,config:{}};let C={refId:"sparkline",fields:[E,{...P.y,config:x}],length:D};return(0,c.g2)(E.values)||(C=(0,p.ES)(C,0)),(0,h.M)({frame:C,refFieldPseudoMin:P.timeRange?.from.valueOf(),refFieldPseudoMax:P.timeRange?.to.valueOf()})}const f={drawStyle:l.GR.Line,showPoints:l.yL.Auto,axisPlacement:l.vM.Hidden,pointSize:2};class v extends r.PureComponent{constructor(m){super(m);const D=y(m.sparkline,m.config);this.state={data:(0,u.bq)(D,(0,u.ro)(D)),alignedDataFrame:D,configBuilder:this.prepareConfig(D)}}static getDerivedStateFromProps(m,D){const x=y(m.sparkline,m.config),E=(0,s.C)(x);return E?{...D,data:(0,u.bq)(E,(0,u.ro)(E)),alignedDataFrame:E}:{...D}}componentDidUpdate(m,D){const{alignedDataFrame:x}=this.state;if(!x)return;let E=!1;if(m.sparkline!==this.props.sparkline){const C=!(0,a.bW)(this.state.alignedDataFrame,D.alignedDataFrame),b=!(0,n.isEqual)(x.fields[1].state?.range,D.alignedDataFrame.fields[1].state?.range);E=C||b}else E=!(0,n.isEqual)(m.config,this.props.config);E&&this.setState({configBuilder:this.prepareConfig(x)})}getYRange(m){let{min:D,max:x}=this.state.alignedDataFrame.fields[1].state?.range;const E=+this.state.alignedDataFrame.fields[1].config?.noValue;return Number.isNaN(E)||(D=Math.min(D,+E),x=Math.max(x,+E)),D===x?(D===0?x=100:(D=0,x*=2),[D,x]):[Math.max(D,m.config.min??-1/0),Math.min(x,m.config.max??1/0)]}prepareConfig(m){const{theme:D}=this.props,x=new o.e;x.setCursor({show:!1,x:!1,y:!1});const E=m.fields[0];x.addScale({scaleKey:"x",orientation:l.Lt.Horizontal,direction:l.ON.Right,isTime:!1,range:()=>{const{sparkline:C}=this.props;if(C.x){if(C.timeRange&&C.x.type===g.PU.time)return[C.timeRange.from.valueOf(),C.timeRange.to.valueOf()];const b=C.x.values;return[b[0],b[b.length-1]]}return[0,C.y.values.length-1]}}),x.addAxis({scaleKey:"x",theme:D,placement:l.vM.Hidden});for(let C=0;C<m.fields.length;C++){const b=m.fields[C],T=b.config,A={...f,...T.custom};if(b===E||b.type!==g.PU.number)continue;const R=T.unit||"__fixed";x.addScale({scaleKey:R,orientation:l.Lt.Vertical,direction:l.ON.Up,range:()=>this.getYRange(b)}),x.addAxis({scaleKey:R,theme:D,placement:l.vM.Hidden});const S=(0,i.Qi)(b),O=S.getCalculator(b,D)(0,0),j=A.drawStyle===l.GR.Points?l.yL.Always:A.showPoints;x.addSeries({pxAlign:!1,scaleKey:R,theme:D,colorMode:S,thresholds:T.thresholds,drawStyle:A.drawStyle,lineColor:A.lineColor??O,lineWidth:A.lineWidth,lineInterpolation:A.lineInterpolation,showPoints:j,pointSize:A.pointSize,fillOpacity:A.fillOpacity,fillColor:A.fillColor,lineStyle:A.lineStyle,gradientMode:A.gradientMode,spanNulls:A.spanNulls})}return x}render(){const{data:m,configBuilder:D}=this.state,{width:x,height:E}=this.props;return(0,t.jsx)(d.Z,{data:m,config:D,width:x,height:E})}}},21633:(_,L,e)=>{"use strict";e.d(L,{h:()=>u});var t=e(32196),n=e(2543),r=e.n(n),s=e(96540),a=e(40845),g=e(69144);const i=.3,l=new Set(["ArrowUp","ArrowDown"]),d=new Set(["ArrowLeft","ArrowRight"]),o={row:{dim:"width",axis:"clientX",min:"minWidth",max:"maxWidth"},column:{dim:"height",axis:"clientY",min:"minHeight",max:"maxHeight"}};function u(f){const{direction:v,initialSize:P=.5,dragPosition:m="middle",onResizing:D,onSizeChanged:x}=f,E=16,C=(0,s.useRef)(null),b=(0,s.useRef)(null),T=(0,s.useRef)(null),A=(0,s.useRef)(null),R=(0,s.useRef)(null),S=(0,s.useRef)("1fr"),O=(0,s.useRef)(void 0),j=(0,s.useRef)(void 0),B=o[v].dim,N=o[v].axis,I=o[v].min,K=o[v].max;h(A.current,se=>{for(const de of se){if(!de.target.isSameNode(A.current)||!b.current)return;const le=b.current.getBoundingClientRect()[B],he=p(b.current);C.current.ariaValueNow=c(le,he[I],he[K])}},500,[K,I,v,B]);const w=(0,s.useRef)(null),U=(0,s.useCallback)(se=>{b.current&&(S.current=b.current.getBoundingClientRect()[B],R.current=A.current.getBoundingClientRect()[B],w.current=se[N],C.current.setPointerCapture(se.pointerId),O.current=p(b.current),j.current=void 0)},[B,N]),W=(0,s.useCallback)(se=>{if(w.current!==null&&S.current!=="1fr"){const de=se[N]-w.current,le=O.current,he=(0,n.clamp)(S.current+de,le[I],le[K]),ie=he/(R.current-E);b.current.style.flexGrow=`${ie}`,T.current.style.flexGrow=`${1-ie}`,C.current.ariaValueNow=c(he,le[I],le[K]),D?.(ie,he)}},[E,N,I,K,D]),H=(0,s.useCallback)(se=>{se.preventDefault(),se.stopPropagation(),C.current.releasePointerCapture(se.pointerId),w.current=null,typeof S.current=="number"&&x?.(parseFloat(b.current.style.flexGrow),S.current)},[x]),z=(0,s.useRef)(new Set),G=(0,s.useRef)(null),M=(0,s.useCallback)(se=>{if(z.current.size===0){G.current=null;return}else if(S.current==="1fr")return;const he=(se-(G.current??se))*i;let ie=0;v==="row"?(z.current.has("ArrowLeft")&&(ie-=he),z.current.has("ArrowRight")&&(ie+=he)):(z.current.has("ArrowUp")&&(ie-=he),z.current.has("ArrowDown")&&(ie+=he));const J=O.current,ce=b.current.getBoundingClientRect()[B],pe=(0,n.clamp)(ce+ie,J[I],J[K]),Pe=pe/(R.current-E);b.current.style.flexGrow=`${Pe}`,T.current.style.flexGrow=`${1-Pe}`,C.current.ariaValueNow=c(pe,J[I],J[K]),D?.(Pe,pe),G.current=se,window.requestAnimationFrame(M)},[v,E,I,K,B,D]),Q=(0,s.useCallback)(se=>{if(!b.current||!T.current||!C.current||!A.current)return;if(se.key==="Enter"){j.current===void 0?(j.current=b.current.style.flexGrow,b.current.style.flexGrow="0",T.current.style.flexGrow="1"):(b.current.style.flexGrow=j.current,T.current.style.flexGrow=`${1-parseFloat(j.current)}`,j.current=void 0);return}else if(se.key==="Home"){O.current=p(b.current),R.current=A.current.getBoundingClientRect()[B];const le=O.current[I]/(R.current-E);b.current.style.flexGrow=`${le}`,T.current.style.flexGrow=`${1-le}`,C.current.ariaValueNow="0";return}else if(se.key==="End"){O.current=p(b.current),R.current=A.current.getBoundingClientRect()[B];const le=O.current[K]/(R.current-E);b.current.style.flexGrow=`${le}`,T.current.style.flexGrow=`${1-le}`,C.current.ariaValueNow="100";return}if(!(v==="column"&&l.has(se.key)||v==="row"&&d.has(se.key))||z.current.has(se.key))return;if(j.current=void 0,se.preventDefault(),se.stopPropagation(),S.current=b.current.getBoundingClientRect()[B],R.current=A.current.getBoundingClientRect()[B],O.current=p(b.current),!z.current.has(se.key)){const le=z.current.size===0;z.current.add(se.key),le&&window.requestAnimationFrame(M)}},[v,M,E,K,B,I]),Y=(0,s.useCallback)(se=>{v==="row"&&!d.has(se.key)||v==="column"&&!l.has(se.key)||(z.current.delete(se.key),typeof S.current=="number"&&x?.(parseFloat(b.current.style.flexGrow),S.current))},[v,x]),q=(0,s.useCallback)(()=>{if(!b.current||!T.current)return;b.current.style.flexGrow="0.5",T.current.style.flexGrow="0.5";const se=p(b.current);O.current=se,S.current=b.current.getBoundingClientRect()[B],C.current.ariaValueNow=`${c(S.current,se[I],se[K])}`},[K,B,I]),te=(0,s.useCallback)(()=>{z.current.size>0&&(z.current.clear(),w.current=null,typeof S.current=="number"&&x?.(parseFloat(b.current.style.flexGrow),S.current))},[x]),X=(0,a.of)(y,v),ee=(0,a.of)(g.l,m),ne=v==="column"?ee.dragHandleHorizontal:ee.dragHandleVertical,Z=(0,s.useId)(),ae={flexGrow:(0,n.clamp)(P??.5,0,1),[I]:"min-content"},re={flexGrow:(0,n.clamp)(1-P,0,1),[I]:"min-content"};return{containerProps:{ref:A,className:X.container},primaryProps:{ref:b,className:X.panel,style:ae},secondaryProps:{ref:T,className:X.panel,style:re},splitterProps:{onPointerUp:H,onPointerDown:U,onPointerMove:W,onKeyDown:Q,onKeyUp:Y,onDoubleClick:q,onBlur:te,ref:C,style:{[B]:`${E}px`},role:"separator","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":P*100,"aria-controls":`start-panel-${Z}`,"aria-label":"Pane resize widget",tabIndex:0,className:ne}}}function c(f,v,P){return`${(0,n.clamp)((f-v)/(P-v)*100,0,100)}`}function p(f){const v=document.body.style.overflow,P=f.style.width,m=f.style.height,D=f.style.flexGrow;document.body.style.overflow="hidden",f.style.flexGrow="0";const{width:x,height:E}=f.getBoundingClientRect();f.style.flexGrow="100";const{width:C,height:b}=f.getBoundingClientRect();return document.body.style.overflow=v,f.style.width=P,f.style.height=m,f.style.flexGrow=D,{minWidth:x,maxWidth:C,minHeight:E,maxHeight:b}}function h(f,v,P=0,m){const D=(0,n.throttle)(v,P);(0,s.useLayoutEffect)(()=>{if(!f)return;const x=new ResizeObserver(D);return x.observe(f,{box:"device-pixel-content-box"}),()=>x.disconnect()},m)}function y(f,v){return{container:(0,t.css)({display:"flex",flexDirection:v==="row"?"row":"column",width:"100%",flexGrow:1,overflow:"hidden"}),panel:(0,t.css)({display:"flex",position:"relative",flexBasis:0})}}},42734:(_,L,e)=>{"use strict";e.d(L,{S:()=>i});var t=e(74848),n=e(2543),r=e.n(n),s=e(96540),a=e(75059),g=e(90182);class i extends s.PureComponent{constructor(){super(...arguments),this.checkInput=()=>{const{stats:d,allowMultiple:o,defaultStat:u,onChange:c}=this.props,p=a.AS.list(d);if(p.length!==d.length){const h=p.map(f=>f.id),y=(0,n.difference)(d,h);console.warn("Unknown stats",y,d),c(p.map(f=>f.id))}!o&&d.length>1&&(console.warn("Removing extra stat",d),c([d[0]])),u&&d.length<1&&c([u])},this.onSelectionChange=d=>{const{onChange:o}=this.props;Array.isArray(d)?o(d.map(u=>u.value)):o(d&&d.value?[d.value]:[])}}static{this.defaultProps={allowMultiple:!1}}componentDidMount(){this.checkInput()}componentDidUpdate(d){this.checkInput()}render(){const{stats:d,allowMultiple:o,defaultStat:u,placeholder:c,className:p,menuPlacement:h,width:y,inputId:f,filterOptions:v}=this.props,P=a.AS.selectOptions(d,v);return(0,t.jsx)(g.l6,{value:P.current,className:p,isClearable:!u,isMulti:o,width:y,isSearchable:!0,options:P.options,placeholder:c,onChange:this.onSelectionChange,menuPlacement:h,inputId:f})}}},15292:(_,L,e)=>{"use strict";e.d(L,{K:()=>u,d:()=>o});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(95344),i=e(40845),l=e(16797),d=e(14578);const o=(0,a.forwardRef)(({value:p,checked:h,onChange:y,id:f,label:v,disabled:P,invalid:m=!1,...D},x)=>{h&&(0,g.l)("Switch","checked prop","value");const E=(0,i.of)(c),C=(0,a.useRef)(f||(0,r.uniqueId)("switch-"));return(0,t.jsxs)("div",{className:(0,n.cx)(E.switch,m&&E.invalid),children:[(0,t.jsx)("input",{type:"checkbox",disabled:P,checked:p,onChange:b=>{!P&&y?.(b)},id:C.current,...D,ref:x}),(0,t.jsx)("label",{htmlFor:C.current,"aria-label":v??"Toggle switch",children:(0,t.jsx)(d.I,{name:"check",size:"xs"})})]})});o.displayName="Switch";const u=(0,a.forwardRef)(({transparent:p,className:h,showLabel:y,label:f,value:v,id:P,invalid:m,...D},x)=>{const E=(0,i.of)(c,p);return(0,t.jsxs)("div",{className:(0,n.cx)(E.inlineContainer,h,D.disabled&&E.disabled,m&&E.invalid),children:[y&&(0,t.jsx)("label",{htmlFor:P,className:(0,n.cx)(E.inlineLabel,v&&E.inlineLabelEnabled,"inline-switch-label"),children:f}),(0,t.jsx)(o,{...D,id:P,label:f,ref:x,value:v})]})});u.displayName="Switch";const c=(p,h)=>({switch:(0,n.css)({width:"32px",height:"16px",position:"relative",lineHeight:1,input:{height:"100%",width:"100% !important",opacity:0,zIndex:-1e3,position:"absolute","&:checked + label":{background:p.colors.primary.main,borderColor:p.colors.primary.main,"&:hover":{background:p.colors.primary.shade},svg:{transform:"translate3d(17px, -50%, 0)",background:p.colors.primary.contrastText,color:p.colors.primary.main}},"&:disabled + label":{background:p.colors.action.disabledBackground,borderColor:p.colors.border.weak,cursor:"not-allowed",svg:{background:p.colors.text.disabled}},"&:disabled:checked + label":{background:p.colors.primary.transparent,svg:{color:p.colors.primary.contrastText}},"&:focus + label, &:focus-visible + label":(0,l.getFocusStyles)(p),"&:focus:not(:focus-visible) + label":(0,l.getMouseFocusStyles)(p)},label:{width:"100%",height:"100%",cursor:"pointer",borderRadius:p.shape.radius.pill,background:p.components.input.background,border:`1px solid ${p.components.input.borderColor}`,transition:"all 0.3s ease","&:hover":{borderColor:p.components.input.borderHover},svg:{position:"absolute",display:"block",color:"transparent",width:"12px",height:"12px",borderRadius:p.shape.radius.circle,background:p.colors.text.secondary,boxShadow:p.shadows.z1,top:"50%",transform:"translate3d(1px, -50%, 0)",transition:"transform 0.2s cubic-bezier(0.19, 1, 0.22, 1)","@media (forced-colors: active)":{border:`1px solid ${p.colors.primary.contrastText}`}}}}),inlineContainer:(0,n.css)({padding:p.spacing(0,1),height:p.spacing(p.components.height.md),display:"inline-flex",alignItems:"center",background:h?"transparent":p.components.input.background,border:`1px solid ${h?"transparent":p.components.input.borderColor}`,borderRadius:p.shape.radius.default,"&:hover":{border:`1px solid ${h?"transparent":p.components.input.borderHover}`,".inline-switch-label":{color:p.colors.text.primary}}}),disabled:(0,n.css)({backgroundColor:"rgba(204, 204, 220, 0.04)",color:"rgba(204, 204, 220, 0.6)",border:"1px solid rgba(204, 204, 220, 0.04)"}),inlineLabel:(0,n.css)({cursor:"pointer",paddingRight:p.spacing(1),color:p.colors.text.secondary,whiteSpace:"nowrap"}),inlineLabelEnabled:(0,n.css)({color:p.colors.text.primary}),invalid:(0,n.css)({"input + label, input:checked + label, input:hover + label":{border:`1px solid ${p.colors.error.border}`}})})},60734:(_,L,e)=>{"use strict";e.d(L,{q:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(29158),a=e(63021),g=e(40675),i=e(40980),l=e(40845),d=e(40276);function o({tabs:c,defaultTab:p,closeIconTooltip:h,onClose:y,testId:f}){const[v,P]=(0,r.useState)(c.some(C=>C.value===p)?p:c[0].value),m=(0,l.of)(u),D=(0,l.$j)(),x=C=>{P(C.value)},E=`calc(100% - (${D.components.menuTabs.height}px + ${D.spacing(1)}))`;return(0,t.jsxs)("div",{className:m.container,"data-testid":f,children:[(0,t.jsxs)(a.U,{className:m.tabs,children:[c.map(C=>(0,t.jsx)(g.o,{label:C.label,active:C.value===v,onChangeTab:()=>x(C),icon:C.icon},C.value)),(0,t.jsx)(s.K,{className:m.close,onClick:y,name:"times",tooltip:h??"Close"})]}),(0,t.jsx)(d.E,{autoHeightMin:E,autoHeightMax:E,children:(0,t.jsx)(i.J,{className:m.tabContent,children:c.find(C=>C.value===v)?.content})})]})}const u=c=>({container:(0,n.css)({height:"100%"}),tabContent:(0,n.css)({padding:c.spacing(2),backgroundColor:c.colors.background.primary,height:"100%"}),close:(0,n.css)({position:"absolute",right:"16px",top:"5px",cursor:"pointer",fontSize:c.typography.size.lg}),tabs:(0,n.css)({paddingTop:c.spacing(1),borderColor:c.colors.border.weak,ul:{marginLeft:c.spacing(2)}})})},92015:(_,L,e)=>{"use strict";e.d(L,{u:()=>l,d:()=>o});var t=e(74848),n=e(96540),r=e(75059),s=e(13544),a=e(32196);const g=u=>{const c=(0,a.css)({width:"100%",listStyle:"none"}),p=(0,a.css)({width:"100%",display:"flex",flexDirection:"row",justifyContent:"space-between"});return u.value&&!Array.isArray(u.value)?(0,t.jsx)("span",{children:u.value}):u.value&&Array.isArray(u.value)&&u.value.length>0?(0,t.jsx)("ul",{className:c,children:u.value.map((h,y)=>{const f=Object.keys(h)[0];return(0,t.jsxs)("li",{className:p,children:[(0,t.jsx)("span",{children:f}),(0,t.jsx)("span",{children:h[f]})]},y)})}):i},i=()=>(0,t.jsx)("span",{children:"\xA0"});function l(u){const{totalColumnsWidth:c,footerGroups:p,isPaginationVisible:h,tableStyles:y}=u,f=s.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{style:{position:h?"relative":"absolute",width:c?`${c}px`:"100%",bottom:"0px"},children:p.map(v=>{const{key:P,...m}=v.getFooterGroupProps();return(0,n.createElement)("div",{className:y.tfoot,...m,key:P,"data-testid":f.footer},v.headers.map(D=>d(D,y)))})})}function d(u,c){const{key:p,...h}=u.getHeaderProps();return h?(h.style=h.style??{},h.style.position="absolute",h.style.justifyContent=u.justifyContent,(0,t.jsx)("div",{className:c.headerCell,...h,children:u.render("Footer")},p)):null}function o(u,c,p){if(c===void 0)return i;if(p){if(c[u]===void 0)return i;const h=r.AS.get(r.gy.count).name;return g({value:[{[h]:String(c[u])}]})}return g({value:c[u]})}},30355:(_,L,e)=>{"use strict";e.d(L,{a:()=>p,t:()=>c});var t=e(74848),n=e(58563),r=e(14236),s=e(83195),a=e(11261),g=e(52622),i=e(40845),l=e(29413),d=e(9286),o=e(5926),u=e(57021);const c={type:g.ob.Sparkline,drawStyle:g.GR.Line,lineInterpolation:g.dx.Smooth,lineWidth:1,fillOpacity:17,gradientMode:g.on.Hue,pointSize:2,barAlignment:g.Nj.Center,showPoints:g.yL.Never,hideValue:!1},p=f=>{const{field:v,innerWidth:P,tableStyles:m,cell:D,cellProps:x,timeRange:E}=f,C=h(D.value),b=(0,i.$j)();if(!C)return(0,t.jsx)("div",{...x,className:m.cellContainer,children:v.config.noValue||"no data"});C.x&&!C.x.config.interval&&C.x.values.length>1&&(C.x.config.interval=C.x.values[1]-C.x.values[0]),C.y.values=C.y.values.map(B=>Number.isFinite(B)?B:null);const T=(0,n.AP)(C.y);C.y.config.min=T.min,C.y.config.max=T.max,C.y.state={range:T},C.timeRange=E;const A=y(v),R={color:v.config.color,custom:{...c,...A}},S=v.config.custom?.cellOptions?.hideValue;let O=0,j=null;if(!S){const B=(0,r.LI)(D.value)?D.value.value:null,N=v.display(B),I=(0,u.zi)(v,N,D.row.index);O=(0,l.kD)((0,s.cN)(I),16).width+b.spacing.gridSize,j=(0,t.jsx)(d.i,{style:{width:`${O-b.spacing.gridSize}px`,textAlign:"right",marginRight:b.spacing(1)},value:N})}return(0,t.jsxs)("div",{...x,className:m.cellContainer,children:[j,(0,t.jsx)("div",{children:(0,t.jsx)(o.O,{width:P-O,height:m.cellHeightInner,sparkline:C,config:R,theme:m.theme})})]})};function h(f){if(Array.isArray(f))return{y:{name:"test",type:a.PU.number,values:f,config:{}}};if((0,r.ci)(f)){const v=f.fields.find(m=>m.type===a.PU.time),P=f.fields.find(m=>m.type===a.PU.number);if(v&&P)return{x:v,y:P}}}function y(f){let v=(0,u.bk)(f);if(v.type===g.ob.Auto&&(v={...v,type:g.ob.Sparkline}),v.type===g.ob.Sparkline)return v;throw new Error(`Expected options type ${g.ob.Sparkline} but got ${v.type}`)}},77093:(_,L,e)=>{"use strict";e.d(L,{X:()=>De});var t=e(74848),n=e(96540),r=e(32885),s=e(75059),a=e(11261),g=e(19845),i=e(85200),l=e(13544),d=e(52622),o=e(40845),u=e(40276),c=e(19384),p=e(92015),h=e(4025),y=e(14578),f=e(32196),v=e(13840),P=e(91793),m=e(83195),D=e(67061),x=e(67647),E=e(9261),C=e(10880),b=e(60029);const T=28,A=T*5,R={Contains:{label:"Contains",value:"Contains",description:"Contains"},"=":{label:"=",value:"=",description:"Equals"},"!=":{label:"!=",value:"!=",description:"Not equals"},">":{label:">",value:">",description:"Greater"},">=":{label:">=",value:">=",description:"Greater or Equal"},"<":{label:"<",value:"<",description:"Less"},"<=":{label:"<=",value:"<=",description:"Less or Equal"},Expression:{label:"Expression",value:"Expression",description:'Bool Expression (Char $ represents the column value in the expression, e.g. "$ >= 10 && $ <= 12")'}},S=Object.values(R),O=R.Contains,j=R.Expression,B=Ke=>{if(Ke=Ke.trim().replace(/\\/g,""),/^(\d{4}-\d{2}-\d{2}|\d{4}\/\d{2}\/\d{2})/.test(Ke)){const we=new Date(Ke);if(!isNaN(we.getTime())){const Be=(0,m.j_)("dateTimeAsIso");return(0,m.cN)(Be(we.getTime()))}}const Me=parseFloat(Ke);if(!isNaN(Me))return Me;const be=Ke.toLowerCase();return be==="true"||be==="false"?be==="true":Ke},N=({options:Ke,values:Me,caseSensitive:be,showOperators:we,onChange:Be,searchFilter:He,setSearchFilter:Ve,operator:Je,setOperator:nt})=>{const pt=(0,n.useMemo)(()=>new RegExp(He,be?void 0:"i"),[He,be]),bt=(0,n.useMemo)(()=>Ke.filter(Ge=>{if(!we||!He||Je.value===O.value)return Ge.label===void 0?!1:pt.test(Ge.label);if(Je.value===j.value){if(Ge.value===void 0)return!1;try{const Qe=He.replace(/\\/g,""),st=new Function("$",`'use strict'; return ${Qe};`),Xe=B(Ge.value);return st(Xe)}catch{}return!1}else{if(Ge.value===void 0)return!1;const Qe=B(Ge.value),st=B(He);switch(Je.value){case"=":return Qe===st;case"!=":return Qe!==st;case">":return Qe>st;case">=":return Qe>=st;case"<":return Qe<st;case"<=":return Qe<=st}return!1}}),[Ke,pt,we,Je,He]),Tt=(0,n.useMemo)(()=>bt.filter(Ge=>Me.includes(Ge)),[bt,Me]),ye=(0,n.useMemo)(()=>bt.length===Tt.length,[bt,Tt]),je=(0,n.useMemo)(()=>Tt.length>0&&bt.length>Tt.length,[bt,Tt]),ue=(0,n.useMemo)(()=>Tt.length?`${Tt.length} selected`:"Select all",[Tt]),Ee=(0,n.useMemo)(()=>bt.length!==Tt.length?"Add all displayed values to the filter":"Remove all displayed values from the filter",[bt,Tt]),Ce=(0,o.of)(K),Fe=(0,o.$j)().spacing.gridSize,Ue=(0,n.useMemo)(()=>Math.min(bt.length*T,A)+Fe,[Fe,bt.length]),fe=(0,n.useCallback)(Ge=>Qe=>{const st=Qe.currentTarget.checked?Me.concat(Ge):Me.filter(Xe=>Xe.value!==Ge.value);Be(st)},[Be,Me]),Te=(0,n.useCallback)(()=>{if(bt.length===Tt.length){const Ge=Me.filter(Qe=>!bt.includes(Qe));Be(Ge)}else{const Ge=[...new Set([...Me,...bt])];Be(Ge)}},[Be,Me,bt,Tt]);return(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[!we&&(0,t.jsx)(x.Z,{placeholder:"Filter values",onChange:Ve,value:He}),we&&(0,t.jsxs)(D.B,{direction:"row",gap:0,children:[(0,t.jsx)(E.f,{variant:"canvas",options:S,onChange:nt,value:Je,tooltip:Je.description}),(0,t.jsx)(x.Z,{placeholder:"Filter values",onChange:Ve,value:He})]}),bt.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.Y1,{height:Ue,itemCount:bt.length,itemSize:T,itemData:{items:bt,values:Tt,onCheckedChanged:fe,className:Ce.filterListRow},width:"100%",className:Ce.filterList,children:I}),(0,t.jsxs)(D.B,{direction:"column",gap:.25,children:[(0,t.jsx)("div",{className:(0,f.cx)(Ce.selectDivider)}),(0,t.jsx)("div",{className:(0,f.cx)(Ce.filterListRow),children:(0,t.jsx)(C.S,{value:ye,indeterminate:je,label:ue,description:Ee,onChange:Te})})]})]}):(0,t.jsx)(b.J,{className:Ce.noValuesLabel,children:"No values"})]})};function I({index:Ke,style:Me,data:{onCheckedChanged:be,items:we,values:Be,className:He}}){const Ve=we[Ke],{value:Je,label:nt}=Ve,pt=Be.find(bt=>bt.value===Je)!==void 0;return(0,t.jsx)("div",{className:He,style:Me,title:nt,children:(0,t.jsx)(C.S,{value:pt,label:nt,onChange:be(Ve)})})}const K=Ke=>({filterList:(0,f.css)({label:"filterList"}),filterListRow:(0,f.css)({label:"filterListRow",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:Ke.spacing(.5),":hover":{backgroundColor:Ke.colors.action.hover}}),selectDivider:(0,f.css)({label:"selectDivider",width:"100%",borderTop:`1px solid ${Ke.colors.border.medium}`,padding:Ke.spacing(.5,2)}),noValuesLabel:(0,f.css)({paddingTop:Ke.spacing(1)})});var w=e(8866),U=e(29158),W=e(55852),H=e(57021);const z=({column:{preFilteredRows:Ke,filterValue:Me,setFilter:be},onClose:we,field:Be,searchFilter:He,setSearchFilter:Ve,operator:Je,setOperator:nt})=>{const pt=(0,o.$j)(),bt=(0,n.useMemo)(()=>(0,H.MY)(Ke,Be),[Ke,Be]),Tt=(0,n.useMemo)(()=>(0,H.Yz)(bt),[bt]),ye=(0,n.useMemo)(()=>(0,H.Sj)(Tt,Me),[Tt,Me]),[je,ue]=(0,n.useState)(ye),[Ee,Ce]=(0,n.useState)(!1),Ne=(0,n.useCallback)(Ge=>we(),[we]),Fe=(0,n.useCallback)(Ge=>{const Qe=je.length?je:void 0;be(Qe),we()},[be,je,we]),Ue=(0,n.useCallback)(Ge=>{be(void 0),we()},[be,we]),fe=(0,n.useMemo)(()=>Me!==void 0,[Me]),Te=(0,o.of)(G);return(0,t.jsx)(w.N,{onClick:Ne,useCapture:!0,children:(0,t.jsx)("div",{className:(0,f.cx)(Te.filterContainer),onClick:M,children:(0,t.jsxs)(D.B,{direction:"column",gap:3,children:[(0,t.jsxs)(D.B,{direction:"column",gap:.5,children:[(0,t.jsxs)(D.B,{justifyContent:"space-between",alignItems:"center",children:[(0,t.jsx)(b.J,{className:Te.label,children:"Filter by values:"}),(0,t.jsx)(U.K,{name:"text-fields",tooltip:"Match case",style:{color:Ee?pt.colors.text.link:pt.colors.text.disabled},onClick:()=>{Ce(Ge=>!Ge)}})]}),(0,t.jsx)("div",{className:(0,f.cx)(Te.listDivider)}),(0,t.jsx)(N,{onChange:ue,values:je,options:Tt,caseSensitive:Ee,showOperators:!0,searchFilter:He,setSearchFilter:Ve,operator:Je,setOperator:nt})]}),(0,t.jsxs)(D.B,{gap:3,children:[(0,t.jsxs)(D.B,{children:[(0,t.jsx)(W.$n,{size:"sm",onClick:Fe,children:"Ok"}),(0,t.jsx)(W.$n,{size:"sm",variant:"secondary",onClick:Ne,children:"Cancel"})]}),fe&&(0,t.jsx)(D.B,{children:(0,t.jsx)(W.$n,{fill:"text",size:"sm",onClick:Ue,children:"Clear filter"})})]})]})})})},G=Ke=>({filterContainer:(0,f.css)({label:"filterContainer",width:"100%",minWidth:"250px",height:"100%",maxHeight:"400px",backgroundColor:Ke.colors.background.primary,border:`1px solid ${Ke.colors.border.weak}`,padding:Ke.spacing(2),boxShadow:Ke.shadows.z3,borderRadius:Ke.shape.radius.default}),listDivider:(0,f.css)({label:"listDivider",width:"100%",borderTop:`1px solid ${Ke.colors.border.medium}`,padding:Ke.spacing(.5,2)}),label:(0,f.css)({marginBottom:0})}),M=Ke=>{Ke.stopPropagation()},Q=({column:Ke,field:Me,tableStyles:be})=>{const we=(0,n.useRef)(null),[Be,He]=(0,n.useState)(!1),Ve=(0,o.of)(Y),Je=(0,n.useMemo)(()=>!!Ke.filterValue,[Ke.filterValue]),nt=(0,n.useCallback)(()=>He(!0),[He]),pt=(0,n.useCallback)(()=>He(!1),[He]),[bt,Tt]=(0,n.useState)(""),[ye,je]=(0,n.useState)(O);return!Me||!Me.config.custom?.filterable?null:(0,t.jsxs)("button",{className:(0,f.cx)(be.headerFilter,Je?Ve.filterIconEnabled:Ve.filterIconDisabled),ref:we,type:"button",onClick:nt,children:[(0,t.jsx)(y.I,{name:"filter"}),Be&&we.current&&(0,t.jsx)(v.A,{content:(0,t.jsx)(z,{column:Ke,tableStyles:be,field:Me,onClose:pt,searchFilter:bt,setSearchFilter:Tt,operator:ye,setOperator:je}),placement:"bottom-start",referenceElement:we.current,show:!0})]})},Y=Ke=>({filterIconEnabled:(0,f.css)({label:"filterIconEnabled",color:Ke.colors.primary.text}),filterIconDisabled:(0,f.css)({label:"filterIconDisabled",color:Ke.colors.text.disabled})}),q=Ke=>{const{headerGroups:Me,showTypeIcons:be,tableStyles:we}=Ke,Be=l.Tp.components.Panels.Visualization.Table;return(0,t.jsx)("div",{role:"rowgroup",className:we.headerRow,children:Me.map(He=>{const{key:Ve,...Je}=He.getHeaderGroupProps();return(0,n.createElement)("div",{className:we.thead,...Je,key:Ve,"aria-label":Be.header,role:"row"},He.headers.map((nt,pt)=>te(nt,we,be)))})})};function te(Ke,Me,be){const{key:we,...Be}=Ke.getHeaderProps(),He=Ke.field??null,Ve=He?.config.custom;Ke.canResize&&(Be.style.userSelect=Ke.isResizing?"none":"auto"),Be.style.position="absolute",Be.style.justifyContent=Ke.justifyContent,Be.style.left=Ke.totalLeft;let Je=Ke.render("Header"),nt=Ke.canSort&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{...Ke.getSortByToggleProps(),className:Me.headerCellLabel,children:[be&&(0,t.jsx)(y.I,{name:(0,h.SS)(He),title:He?.type,size:"sm",className:Me.typeIcon}),(0,t.jsx)("div",{children:Je}),Ke.isSorted&&(Ke.isSortedDesc?(0,t.jsx)(y.I,{size:"lg",name:"arrow-down",className:Me.sortIcon}):(0,t.jsx)(y.I,{name:"arrow-up",size:"lg",className:Me.sortIcon}))]}),Ke.canFilter&&(0,t.jsx)(Q,{column:Ke,tableStyles:Me,field:He})]});return nt&&Ve?.headerComponent?nt=(0,t.jsx)(Ve.headerComponent,{field:He,defaultContent:nt}):Ve?.headerComponent&&(Je=(0,t.jsx)(Ve.headerComponent,{field:He,defaultContent:Je})),(0,t.jsxs)("div",{className:Me.headerCell,...Be,role:"columnheader",children:[Ke.canSort&&nt,!Ke.canSort&&Je,!Ke.canSort&&Ke.canFilter&&(0,t.jsx)(Q,{column:Ke,tableStyles:Me,field:He}),Ke.canResize&&(0,t.jsx)("div",{...Ke.getResizerProps(),className:Me.resizeHandle})]},we)}var X=e(64423),ee=e(56978),ne=e(69129),Z=e(79041);function ae({tableStyles:Ke,nestedData:Me,rowIndex:be,width:we,cellHeight:Be}){const He=Me.values,Ve=[],Je=(0,o.$j)(),nt=(0,o.of)(re);let pt=Ke.rowHeight+Je.spacing.gridSize;return He[be].forEach((bt,Tt)=>{const ye=!!bt.meta?.custom?.noHeader,je=Ke.rowHeight*(bt.length+(ye?0:1)),ue={height:je,paddingLeft:H.jV,position:"absolute",top:pt};pt+=je+Je.spacing.gridSize,Ve.push((0,t.jsx)("div",{style:ue,children:(0,t.jsx)(De,{data:bt,width:we-H.jV,height:Ke.rowHeight*(bt.length+1),noHeader:ye,cellHeight:Be})},`subTable_${be}_${Tt}`))}),(0,t.jsx)("div",{className:nt.subTables,children:Ve})}const re=Ke=>({subTables:(0,f.css)({"&:before":{content:'""',position:"absolute",width:"1px",top:Ke.spacing(5),left:Ke.spacing(1),bottom:Ke.spacing(2),background:Ke.colors.border.medium}})});function se(Ke,Me,be){return Ke.values[Me].reduce((He,Ve)=>{if(Ve.length){const Je=!!Ve.meta?.custom?.noHeader;return He+be.rowHeight*(Ve.length+(Je?0:1))+8}return He},be.rowHeight)??be.rowHeight}var de=e(49618);const le=Ke=>{const{data:Me,rows:be,headerHeight:we,footerPaginationEnabled:Be,rowHeight:He,itemCount:Ve,pageIndex:Je,tableState:nt,prepareRow:pt,onCellFilterAdded:bt,width:Tt,cellHeight:ye=d.qM.Sm,timeRange:je,tableStyles:ue,nestedDataField:Ee,listHeight:Ce,listRef:Ne,enableSharedCrosshair:Fe=!1,initialRowIndex:Ue=void 0,headerGroups:fe,longestField:Te,textWrapField:Ge}=Ke,[Qe,st]=(0,n.useState)(Ue);Ue===void 0&&Qe!==void 0&&st(void 0);const Xe=(0,o.$j)(),ot=(0,Z.d2)();let ft=null;window.OffscreenCanvas!==void 0&&(ft=new OffscreenCanvas(256,1024).getContext("2d")),ft!=null&&(ft.font=`${Xe.typography.fontSize}px ${Xe.typography.body.fontFamily}`);const _e=(0,n.useMemo)(()=>{const Ot=Me.fields.find(jt=>jt.type===a.PU.time);return Ot?(0,H.HY)(Ot):0},[Me]),et=(0,n.useCallback)((Ot,jt)=>{if(!ot||!Fe||!(0,g.S1)(jt))return;const Ut=jt.fields.find(zt=>zt.type===a.PU.time);ot.eventBus.publish(new ne.b_({point:{time:Ut.values[Ot]}}))},[Fe,ot]),it=(0,n.useCallback)(()=>{!ot||!Fe||ot.eventBus.publish(new ne.ql)},[Fe,ot]),dt=(0,n.useCallback)(Ot=>{if(Ot.payload.point?.time&&Ot.payload.rowIndex!==void 0){const jt=Me.fields.find(fn=>fn.type===a.PU.time),Ut=jt.values[Ot.payload.rowIndex],zt=Ot.payload.point.time;if((0,H.Iy)(zt,Ut,_e)){st(Ot.payload.rowIndex);return}const qt=jt.values.findIndex(fn=>(0,H.Iy)(zt,fn,_e));if(qt!==-1){st(qt);return}st(void 0)}},[Me.fields,_e]);(0,n.useEffect)(()=>{if(!ot||!Fe||!(0,g.S1)(Me)||Be)return;const Ot=new X.yU;return Ot.add(ot.eventBus.getStream(ne.b_).pipe((0,ee.B)(250)).subscribe({next:jt=>{ot.eventBus!==jt.origin&&dt(jt)}})),Ot.add(ot.eventBus.getStream(ne.ql).pipe((0,ee.B)(250)).subscribe({next:jt=>{ot.eventBus!==jt.origin&&st(void 0)}})),()=>{Ot.unsubscribe()}},[Me,Fe,Be,dt,ot]);let ze;if(Qe!==void 0){const Ot=be.findIndex(jt=>jt.index===Qe);Ot!==-1&&(ze=we+(Ot-1)*He)}const xe=(0,n.useCallback)(Ot=>nt.pageIndex*nt.pageSize+Ot,[nt.pageIndex,nt.pageSize]);let Oe,Le;for(const Ot of Me.fields){const jt=Ot.config.custom;jt!==void 0&&jt.cellOptions!==void 0&&jt.cellOptions.type===d.ob.ColorBackground&&jt.cellOptions.applyToRow&&(Oe=zt=>{const qt=Ot.display(Ot.values.get(zt));return(0,H.HW)(ue,jt.cellOptions,qt)}),Ge!==void 0?Le=Ge:Te!==void 0&&(Le=Te)}const Ze=(0,n.useCallback)(({index:Ot,style:jt,rowHighlightIndex:Ut})=>{const zt=xe(Ot),qt=be[zt];let fn={};pt(qt);const Sn=nt.expanded[qt.id]?(0,f.css)({"&:hover":{background:"inherit"}}):{},An=Ee&&nt.expanded[qt.id];if(Ut!==void 0&&qt.index===Ut&&(jt={...jt,backgroundColor:Xe.components.table.rowSelected},fn={"aria-selected":"true"}),Oe){const{bgColor:rs,textColor:Zn}=Oe(qt.index);jt.background=rs,jt.color=Zn}if(Le){const Zn=Me.fields.filter(Kn=>!Kn.config.custom?.hidden).findIndex(Kn=>Kn.name===Le.name),kn=Xe.typography.body.lineHeight*Xe.typography.fontSize,Gn=(0,H.M2)(Le.values[qt.index],fe[0].headers[Zn],ft,kn,ue.rowHeight,ue.cellPadding);jt.height=Gn.height}const{key:Hn,...es}=qt.getRowProps({style:jt,...fn});return(0,t.jsxs)("div",{...es,className:(0,f.cx)(ue.row,Sn),onMouseEnter:()=>et(Ot,Me),onMouseLeave:it,children:[An&&(0,t.jsx)(ae,{nestedData:Ee,tableStyles:ue,rowIndex:qt.index,width:Tt,cellHeight:ye}),qt.cells.map((rs,Zn)=>(0,t.jsx)(de.n,{tableStyles:ue,cell:rs,onCellFilterAdded:bt,columnIndex:Zn,columnCount:qt.cells.length,timeRange:je,frame:Me,rowStyled:Oe!==void 0,rowExpanded:An,textWrapped:Le!==void 0,height:Number(jt.height)},Zn))]},Hn)},[ye,Me,Ee,bt,et,it,pt,xe,be,nt.expanded,ue,Le,Xe.components.table.rowSelected,Xe.typography.fontSize,Xe.typography.body.lineHeight,je,Tt,Oe,fe,ft]),qe=Ot=>{const jt=xe(Ot),Ut=be[jt];if(nt.expanded[Ut.id]&&Ee)return se(Ee,Ut.index,ue);if(Le){const qt=Me.fields.filter(Sn=>!Sn.config.custom?.hidden).findIndex(Sn=>Sn.name===Le.name),fn=Xe.typography.fontSize*Xe.typography.body.lineHeight;return(0,H.M2)(Le.values[Ut.index],fe[0].headers[qt],ft,fn,ue.rowHeight,ue.cellPadding).height}return ue.rowHeight},rt=Ot=>{const{scrollTop:jt}=Ot.currentTarget;Ne.current!==null&&Ne.current.scrollTo(jt)},vt=Object.keys(nt.expanded).join("|");return(0,n.useEffect)(()=>{Ne.current&&Ne.current.resetAfterIndex(0)},[be,Ne]),(0,t.jsx)(u.A,{onScroll:rt,hideHorizontalTrack:!0,scrollTop:ze,children:(0,t.jsx)(P._m,{height:Ce,itemCount:Ve,itemSize:qe,width:"100%",ref:Ne,style:{overflow:void 0},children:({index:Ot,style:jt})=>Ze({index:Ot,style:jt,rowHighlightIndex:Qe})},`${He}${Je}${vt}`)})};function he(Ke,Me){(0,n.useEffect)(()=>{if(Ke.current&&Me.current){const be=Ke.current.querySelector(".track-vertical"),we=Me.current.firstChild;we&&be&&(be.remove(),we instanceof HTMLElement&&(we.querySelector(":scope > .track-vertical")?.remove(),we.append(be)))}})}function ie(Ke,Me,be,we){const Be=JSON.stringify(Object.keys(Ke.expanded));(0,n.useEffect)(()=>{let He=0;we||(Number.isFinite(Ke.lastExpandedOrCollapsedIndex)&&(He=Ke.lastExpandedOrCollapsedIndex),He=Ke.pageIndex===0?He-1:He-Ke.pageIndex-Ke.pageIndex*Ke.pageSize),Me.current?.resetAfterIndex(Math.max(He,0))},[Ke.lastExpandedOrCollapsedIndex,Ke.pageSize,Ke.pageIndex,Me,be,Be,we])}var J=e(28240);function ce({onColumnResize:Ke,onSortByChange:Me,data:be}){return(0,n.useCallback)((we,Be)=>{switch(Be.type){case"columnDoneResizing":if(Ke){const Ve=we.columnResizing?.headerIdWidths?.[0]?.[0],Je=parseInt(Ve,10),nt=Math.round(we.columnResizing.columnWidths?.[Ve]),pt=be.fields?.[Je];if(!pt)return we;const bt=(0,J.Ct)(pt,be);Ke(bt,nt)}case"toggleSortBy":if(Me){const He=[];for(const Ve of we.sortBy){const Je=be.fields[parseInt(Ve.id,10)];Je&&He.push({displayName:(0,J.Ct)(Je,be),desc:Ve.desc})}Me(He)}case"toggleRowExpanded":if(Be.id)return{...we,lastExpandedOrCollapsedIndex:parseInt(Be.id,10)}}return we},[be,Ke,Me])}function pe(Ke,Me){const be={};if(Ke){be.sortBy=[];for(const we of Ke)for(const Be of Me)Be.Header===we.displayName&&be.sortBy.push({id:Be.id,desc:we.desc})}return be}var Pe=e(69770);const Ie=150,ge=36,Se="No data",De=(0,n.memo)(Ke=>{const{ariaLabel:Me,data:be,height:we,onCellFilterAdded:Be,width:He,columnMinWidth:Ve=Ie,noHeader:Je,resizable:nt=!0,initialSortBy:pt,footerOptions:bt,showTypeIcons:Tt,footerValues:ye,enablePagination:je,cellHeight:ue=d.qM.Sm,timeRange:Ee,enableSharedCrosshair:Ce=!1,initialRowIndex:Ne=void 0,fieldConfig:Fe}=Ke,Ue=(0,n.useRef)(null),fe=(0,n.useRef)(null),Te=(0,n.useRef)(null),Ge=(0,o.$j)(),Qe=(0,Pe.k)(Ge,ue),st=Je?0:Qe.rowHeight,[Xe,ot]=(0,n.useState)(ye),ft=Fe?.defaults?.noValue??Se,_e=(0,n.useMemo)(()=>{const bn=ge;let Pt=0;if(!Xe)return 0;for(const Ft of Xe)Array.isArray(Ft)&&Ft.length>Pt&&(Pt=Ft.length);return Pt>1?bn*Pt:bn},[Xe]),et=(0,n.useMemo)(()=>be.fields.length?Array(be.length).fill(0):[],[be]),it=!!(bt?.countRows&&bt.reducer&&bt.reducer.length&&bt.reducer[0]===s.gy.count),dt=be.fields.find(bn=>bn.type===a.PU.nestedFrames),ze=dt!==void 0,xe=(0,n.useMemo)(()=>(0,H.GH)(be,He,Ve,ze,Xe,it),[be,He,Ve,Xe,ze,it]),Oe=(0,n.useRef)(),Le=ce({...Ke,onSortByChange:bn=>{Oe.current(!1),Ke.onSortByChange&&Ke.onSortByChange(bn)}}),Ze=!!be.meta?.uniqueRowIdFields?.length,qe=(0,n.useMemo)(()=>{const bn={columns:xe,data:et,disableResizing:!nt,stateReducer:Le,autoResetPage:!1,initialState:pe(pt,xe),autoResetFilters:!1,sortTypes:{number:H.Ok,"alphanumeric-insensitive":H.IM}};return Ze&&(bn.getRowId=(Pt,Ft)=>(0,g.t9)(be,Ft),bn.autoResetExpanded=!1),bn},[pt,xe,et,nt,Le,Ze,be]),{getTableProps:rt,headerGroups:vt,footerGroups:Ot,rows:jt,prepareRow:Ut,totalColumnsWidth:zt,page:qt,state:fn,gotoPage:Sn,setPageSize:An,pageOptions:Hn,toggleAllRowsExpanded:es}=(0,r.useTable)(qe,r.useFilters,r.useSortBy,r.useAbsoluteLayout,r.useResizeColumns,r.useExpanded,r.usePagination),rs=fn;Oe.current=es,(0,n.useEffect)(()=>{bt||ot(ye)},[ye,bt]),(0,n.useEffect)(()=>{if(!bt)return;if(!bt.show){ot(void 0);return}if(it){const Pt=[];Pt[0]=jt.length.toString()??be.length.toString(),ot(Pt);return}const bn=(0,H.Ux)(vt[0].headers,(0,H.XX)(jt),bt,Ge);ot(bn)},[bt,Ge,fn.filters,be]);let Zn=we-(st+_e);je&&(Zn-=Qe.cellHeight);const kn=Math.round(Zn/Qe.rowHeight)-1;(0,n.useEffect)(()=>{kn<=0||An(kn)},[kn,An]),(0,n.useEffect)(()=>{be.length/kn<fn.pageIndex&&Sn(0)},[be]),ie(rs,Ue,be,Ze),he(Te,fe);const Gn=(0,n.useCallback)(bn=>{Sn(bn-1)},[Sn]),Kn=je?qt.length:jt.length;let yn=null;if(je){const bn=fn.pageIndex*fn.pageSize+1;let Pt=bn+fn.pageSize-1;const Ft=He<550;Pt>be.length&&(Pt=be.length),yn=(0,t.jsxs)("div",{className:Qe.paginationWrapper,children:[(0,t.jsx)(c.d,{currentPage:fn.pageIndex+1,numberOfPages:Hn.length,showSmallVersion:Ft,onNavigate:Gn}),Ft?null:(0,t.jsxs)("div",{className:Qe.paginationSummary,children:[bn," - ",Pt<jt.length?Pt:jt.length," of ",jt.length," rows"]})]})}const wn=(0,H.O4)(Fe,be);let Jn;return Fe!==void 0&&be.fields.forEach(bn=>{Fe.overrides.forEach(Pt=>{if((0,i.NS)(Pt.matcher)(bn,be,[be]))for(const Xt of Pt.properties)Xt.id==="custom.cellOptions"&&Xt.value.wrapText&&(Jn=bn)})}),(0,t.jsxs)("div",{...rt(),className:Qe.table,"aria-label":Me,role:"table",ref:fe,style:{width:He,height:we},children:[(0,t.jsx)(u.E,{hideVerticalTrack:!0,children:(0,t.jsxs)("div",{className:Qe.tableContentWrapper(zt),children:[!Je&&(0,t.jsx)(q,{headerGroups:vt,showTypeIcons:Tt,tableStyles:Qe}),Kn>0?(0,t.jsx)("div",{"data-testid":l.Tp.components.Panels.Visualization.Table.body,ref:Te,children:(0,t.jsx)(le,{headerGroups:vt,data:be,rows:jt,width:He,cellHeight:ue,headerHeight:st,rowHeight:Qe.rowHeight,itemCount:Kn,pageIndex:fn.pageIndex,listHeight:Zn,listRef:Ue,tableState:fn,prepareRow:Ut,timeRange:Ee,onCellFilterAdded:Be,nestedDataField:dt,tableStyles:Qe,footerPaginationEnabled:!!je,enableSharedCrosshair:Ce,initialRowIndex:Ne,longestField:wn,textWrapField:Jn})}):(0,t.jsx)("div",{style:{height:we-st,width:He},className:Qe.noData,children:ft}),Xe&&(0,t.jsx)(p.u,{isPaginationVisible:!!je,footerValues:Xe,footerGroups:Ot,totalColumnsWidth:zt,tableStyles:Qe})]})}),yn]})});De.displayName="Table"},49618:(_,L,e)=>{"use strict";e.d(L,{n:()=>n});var t=e(74848);const n=({cell:r,tableStyles:s,onCellFilterAdded:a,timeRange:g,userProps:i,frame:l,rowStyled:d,rowExpanded:o,textWrapped:u,height:c})=>{const p=r.getCellProps(),h=r.column.field;if(!h?.display)return null;if(p.style){p.style.wordBreak="break-word",p.style.minWidth=p.style.width;const f=r.column.justifyContent;f==="flex-end"&&!h.config.unit?(p.style.textAlign="right",p.style.direction="rtl",p.style.unicodeBidi="plaintext"):p.style.justifyContent=f}let y=(typeof r.column.width=="number"?r.column.width:24)-s.cellPadding*2;return(0,t.jsx)(t.Fragment,{children:r.render("Cell",{field:h,tableStyles:s,onCellFilterAdded:a,cellProps:p,innerWidth:y,timeRange:g,userProps:i,frame:l,rowStyled:d,rowExpanded:o,textWrapped:u,height:c})})}},69770:(_,L,e)=>{"use strict";e.d(L,{k:()=>n});var t=e(32196);function n(s,a){const g=s.colors.border.weak,i=s.colors.primary.border,l=6,d=r(s,a,l),o=d+2,u=28,c=(p,h,y,f,v,P,m,D,x)=>(0,t.css)({label:f?"cellContainerOverflow":"cellContainerNoOverflow",padding:`${l}px`,width:"100%",height:x?"auto !important":`${o-1}px`,wordBreak:m?"break-all":"inherit",display:"flex",...v?{overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}:{},alignItems:"center",borderRight:`1px solid ${g}`,color:D?"inherit":p??void 0,background:D?void 0:h??void 0,backgroundClip:"padding-box","&:last-child:not(:only-child)":{borderRight:"none"},"&:hover":{overflow:f&&!m?"visible":void 0,width:P||!f?"auto":"auto !important",height:(P||f)&&!m?"auto !important":`${o-1}px`,minHeight:`${o-1}px`,wordBreak:P?"break-word":void 0,whiteSpace:P&&f?"normal":"nowrap",boxShadow:f?`0 0 2px ${s.colors.primary.main}`:void 0,background:D?"inherit":y??s.colors.background.primary,zIndex:1,".cellActions":{color:"#FFF",visibility:"visible",opacity:1,width:"auto",background:"rgba(0, 0, 0, 0.6)"}},a:{color:"inherit"},".cellActions":{display:"flex",position:f?void 0:"absolute",top:f?void 0:"1px",right:f?void 0:0,margin:f?s.spacing(0,-.5,0,.5):"auto",visibility:"hidden",opacity:0,width:0,alignItems:"center",height:"100%",padding:s.spacing(1,.5,1,1),background:h?"none":"rgba(0, 0, 0, 0.5)",svg:{color:p}},".cellActionsLeft":{right:"auto !important",left:0},".cellActionsTransparent":{background:"none"}});return{theme:s,cellHeight:d,buildCellContainerStyle:c,cellPadding:l,cellHeightInner:d-l*2,rowHeight:o,table:(0,t.css)({height:"100%",width:"100%",overflow:"auto",display:"flex",flexDirection:"column"}),thead:(0,t.css)({label:"thead",height:`${u}px`,overflowY:"auto",overflowX:"hidden",position:"relative"}),tfoot:(0,t.css)({label:"tfoot",height:`${u}px`,borderTop:`1px solid ${g}`,overflowY:"auto",overflowX:"hidden",position:"relative"}),headerRow:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`}),headerCell:(0,t.css)({height:"100%",padding:`0 ${l}px`,overflow:"hidden",whiteSpace:"nowrap",display:"flex",alignItems:"center",fontWeight:s.typography.fontWeightMedium,"&:last-child":{borderRight:"none"}}),headerCellLabel:(0,t.css)({border:"none",padding:0,background:"inherit",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontWeight:s.typography.fontWeightMedium,display:"flex",alignItems:"center",marginRight:s.spacing(.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellContainerText:c(void 0,void 0,void 0,!0,!0),cellContainerTextNoOverflow:c(void 0,void 0,void 0,!1,!0),cellContainer:c(void 0,void 0,void 0,!0,!1),cellContainerNoOverflow:c(void 0,void 0,void 0,!1,!1),cellText:(0,t.css)({overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap"}),sortIcon:(0,t.css)({marginLeft:s.spacing(.5)}),cellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",color:s.colors.text.link,fontWeight:s.typography.fontWeightMedium,paddingRight:s.spacing(1.5),"&:hover":{textDecoration:"underline",color:s.colors.text.link}}),cellLinkForColoredCell:(0,t.css)({cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",userSelect:"text",whiteSpace:"nowrap",fontWeight:s.typography.fontWeightMedium,textDecoration:"underline"}),imageCellLink:(0,t.css)({cursor:"pointer",overflow:"hidden",height:"100%"}),headerFilter:(0,t.css)({background:"transparent",border:"none",label:"headerFilter",padding:0}),paginationWrapper:(0,t.css)({display:"flex",height:`${d}px`,justifyContent:"center",alignItems:"center",width:"100%",li:{marginBottom:0}}),paginationSummary:(0,t.css)({color:s.colors.text.secondary,fontSize:s.typography.bodySmall.fontSize,display:"flex",justifyContent:"flex-end",padding:s.spacing(0,1,0,2)}),tableContentWrapper:p=>{const h=p!==void 0?`${p}px`:"100%";return(0,t.css)({label:"tableContentWrapper",width:h,display:"flex",flexDirection:"column"})},row:(0,t.css)({label:"row",borderBottom:`1px solid ${g}`,"&:hover":{backgroundColor:s.components.table.rowHoverBackground},"&:last-child":{borderBottom:0}}),imageCell:(0,t.css)({height:"100%"}),resizeHandle:(0,t.css)({label:"resizeHandle",cursor:"col-resize !important",display:"inline-block",background:i,opacity:0,[s.transitions.handleMotion("no-preference","reduce")]:{transition:"opacity 0.2s ease-in-out"},width:"8px",height:"100%",position:"absolute",right:"-4px",borderRadius:s.shape.radius.default,top:0,touchAction:"none","&:hover":{opacity:1}}),typeIcon:(0,t.css)({marginRight:s.spacing(1),color:s.colors.text.secondary}),noData:(0,t.css)({alignItems:"center",display:"flex",height:"100%",justifyContent:"center",width:"100%"}),expanderCell:(0,t.css)({display:"flex",flexDirection:"column",justifyContent:"center",height:`${o}px`,cursor:"pointer"})}}function r(s,a,g){const i=s.typography.fontSize,l=s.typography.body.lineHeight;switch(a){case"md":return 42;case"lg":return 48;case"sm":default:return g*2+i*l}}},88407:(_,L,e)=>{"use strict";e.d(L,{Zi:()=>n,mc:()=>t});const t="=",n="!="},57021:(_,L,e)=>{"use strict";e.d(L,{jV:()=>de,HY:()=>bt,MY:()=>ce,XX:()=>we,zi:()=>nt,HW:()=>Tt,bk:()=>He,GH:()=>he,Sj:()=>ge,Ux:()=>Me,j1:()=>le,O4:()=>je,M2:()=>ye,Iy:()=>pt,o7:()=>Ve,IM:()=>Se,Ok:()=>De,Yz:()=>Pe});var t=e(2543),n=e(47078),r=e.n(n),s=e(84140),a=e(11261),g=e(28240),i=e(14236),l=e(19845),d=e(83195),o=e(75059),u=e(57875),c=e(52622),p=e(24284),h=e(74848),y=e(50082),f=e(58563),v=e(47070),P=e(97696),m=e(59796);const D={mode:y.O.Absolute,steps:[{color:"blue",value:-1/0},{color:"green",value:20}]},x=ue=>{const{field:Ee,innerWidth:Ce,tableStyles:Ne,cell:Fe,cellProps:Ue,row:fe}=ue,Te=Ee.display(Fe.value),Ge=He(Ee);let Qe=(0,f.xg)(Ee,!1);Qe.thresholds||(Qe={...Qe,thresholds:D});let st=c.eX.Gradient,Xe;Ge.type===c.ob.Gauge&&(st=Ge.mode??c.eX.Gradient,Xe=Ge.valueDisplayMode!==void 0?Ge.valueDisplayMode:c.$l.Text);const ot=()=>(0,t.isFunction)(Ee.getLinks)?Ee.getLinks({valueRowIndex:fe.index}):[],ft=!!ot().length,_e=nt(Ee,Te,Fe.row.index),et=it=>{const{openMenu:dt,targetClassName:ze}=it;return(0,h.jsx)(P.xE,{width:Ce,height:Ne.cellHeightInner,field:Qe,display:Ee.display,text:{valueSize:14},value:Te,orientation:v.wV.Horizontal,theme:Ne.theme,alignmentFactors:_e,onClick:dt,className:ze,itemSpacing:1,lcdCellWidth:8,displayMode:st,valueDisplayMode:Xe})};return(0,h.jsxs)("div",{...Ue,className:Ne.cellContainer,children:[ft&&(0,h.jsx)(m.e,{links:ot,style:{display:"flex",width:"100%"},children:it=>et(it)}),!ft&&et({})]})};var E=e(90914);const C=ue=>{const{field:Ee,row:Ce,cellProps:Ne,tableStyles:Fe}=ue,Ue=(0,E.k)(Ee,Ce);return(0,h.jsx)("div",{...Ne,className:Fe.cellContainerText,children:Ue&&Ue.map((fe,Te)=>(0,h.jsx)("span",{className:Fe.cellLink,onClick:fe.onClick,children:(0,h.jsx)("a",{href:fe.href,target:fe.target,children:fe.title})},Te))})};var b=e(32196),T=e(96540),A=e(40845),R=e(55852),S=e(29158),O=e(67061),j=e(76412),B=e(10534),N=e(87978),I=e(32372),K=e(63021),w=e(40675),U=(ue=>(ue.code="code",ue.text="text",ue))(U||{});function W({value:ue,onDismiss:Ee,mode:Ce}){let Ne=ue;const[Fe,Ue]=(0,T.useState)(Ce);if((0,t.isString)(ue)){const st=ue.trim();if(st[0]==="{"||st[0]==="["||Ce==="code")try{ue=JSON.parse(ue),Ne=JSON.stringify(ue,null,"  ")}catch(Xe){console.log("Failed to parse JSON in Table cell inspector (this will cause JSON to not print nicely): ",Xe.message)}}else Ne=JSON.stringify(ue);let fe=Ne;const Te=[{label:"Plain text",value:"text"},{label:"Code editor",value:"code"}],Ge=()=>{Ue(Fe==="text"?"code":"text")},Qe=(0,h.jsx)(K.U,{children:Te.map((st,Xe)=>(0,h.jsx)(w.o,{label:st.label,active:st.value===Fe,onChangeTab:Ge},`${st.value}-${Xe}`))});return(0,h.jsx)(N._,{onClose:Ee,title:"Inspect value",tabs:Qe,children:(0,h.jsxs)(O.B,{direction:"column",gap:2,children:[(0,h.jsx)(B.b,{icon:"copy",getText:()=>fe,style:{marginLeft:"auto",width:"200px"},children:(0,h.jsx)(j.x,{i18nKey:"grafana-ui.table.copy",children:"Copy to Clipboard"})}),Fe==="code"?(0,h.jsx)(I.B,{width:"100%",height:500,language:"json",showLineNumbers:!0,showMiniMap:(fe&&fe.length)>100,value:fe,readOnly:!0,wordWrap:!0}):(0,h.jsx)("pre",{children:fe})]})})}var H=e(88407);function z({field:ue,cell:Ee,previewMode:Ce,showFilters:Ne,onCellFilterAdded:Fe}){const[Ue,fe]=(0,T.useState)(!1),Te=le(ue)==="flex-end",Ge=!!ue.config.custom?.inspect,Qe={size:"sm",tooltipPlacement:"top"},st=(0,T.useCallback)(ot=>{Fe&&Fe({key:ue.name,operator:H.mc,value:Ee.value})},[Ee,ue,Fe]),Xe=(0,T.useCallback)(ot=>{Fe&&Fe({key:ue.name,operator:H.Zi,value:Ee.value})},[Ee,ue,Fe]);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:`cellActions${Te?" cellActionsLeft":""}`,children:(0,h.jsxs)(O.B,{gap:.5,children:[Ge&&(0,h.jsx)(S.K,{name:"eye",tooltip:"Inspect value",onClick:()=>{fe(!0)},...Qe}),Ne&&(0,h.jsx)(S.K,{name:"search-plus",onClick:st,tooltip:"Filter for value",...Qe}),Ne&&(0,h.jsx)(S.K,{name:"search-minus",onClick:Xe,tooltip:"Filter out value",...Qe})]})}),Ue&&(0,h.jsx)(W,{mode:Ce,value:Ee.value,onDismiss:()=>{fe(!1)}})]})}const G=ue=>{const{field:Ee,cell:Ce,tableStyles:Ne,row:Fe,cellProps:Ue,frame:fe,rowStyled:Te,rowExpanded:Ge,textWrapped:Qe,height:st}=ue,Xe=!!Ee.config.custom?.inspect,ot=Ee.display(Ce.value),ft=ue.onCellFilterAdded&&Ee.config.filterable,_e=ft&&Ce.value!==void 0||Xe,et=He(Ee),it=!!(0,E.k)(Ee,Fe)?.length,dt=(0,A.of)(R.Ez),[ze,xe]=(0,T.useState)(!1);let Oe;const Le=140,Ze=()=>{xe(!1)},qe=()=>{xe(!0)};if(et.type===c.ob.Custom){const zt=et.cellComponent;Oe=(0,h.jsx)(zt,{field:Ee,value:Ce.value,rowIndex:Fe.index,frame:fe})}else T.isValidElement(Ce.value)?Oe=Ce.value:Oe=(0,d.cN)(ot);const rt=typeof Oe=="string",vt=ot.text.length<=Le&&/\s/.test(ot.text),Ot=M(Ne,et,ot,Xe,rt,vt,Qe,Te,Ge);if(rt){let zt=Ue.style?.justifyContent;zt==="flex-end"?Ue.style={...Ue.style,textAlign:"right"}:zt==="center"&&(Ue.style={...Ue.style,textAlign:"center"})}st&&(Ue.style={...Ue.style,height:st}),Qe&&(Ue.style={...Ue.style,textWrap:"wrap"});const{key:jt,...Ut}=Ue;return(0,h.jsxs)("div",{...Ut,onMouseEnter:_e?qe:void 0,onMouseLeave:_e?Ze:void 0,className:Ot,children:[!it&&(rt?`${Oe}`:(0,h.jsx)("div",{className:Ne.cellText,children:Oe})),it&&(0,h.jsx)(m.e,{links:()=>(0,E.k)(Ee,Fe)||[],children:zt=>zt.openMenu?(0,h.jsx)("button",{className:(0,b.cx)(dt,Q(Ne,et,zt.targetClassName)),onClick:zt.openMenu,children:Oe}):(0,h.jsx)("div",{className:Q(Ne,et,zt.targetClassName),children:Oe})}),ze&&_e&&(0,h.jsx)(z,{...ue,previewMode:U.text,showFilters:ft})]},jt)};function M(ue,Ee,Ce,Ne=!1,Fe=!1,Ue=!1,fe=!1,Te=!1,Ge=!1){let Qe,st,Xe;const ot=Tt(ue,Ee,Ce);return Qe=ot.textColor,st=ot.bgColor,Xe=ot.bgHoverColor,ue.buildCellContainerStyle(Qe,st,Xe,!Ne,Fe,Ue,fe,Te,Ge)}function Q(ue,Ee,Ce){return Ee.type===c.ob.Auto?(0,b.cx)(ue.cellLink,Ce):(0,b.cx)(ue.cellLinkForColoredCell,Ce)}var Y=e(92015),q=e(64136),te=e(27430);function X(ue){const{cell:Ee,tableStyles:Ce,cellProps:Ne}=ue;let Fe="";return Ee.value instanceof te.A?Fe=new q.A().writeGeometry(Ee.value,{featureProjection:"EPSG:3857",dataProjection:"EPSG:4326"}):Ee.value!=null&&(Fe=`${Ee.value}`),(0,h.jsx)("div",{...Ne,className:Ce.cellContainer,children:(0,h.jsx)("div",{className:Ce.cellText,style:{fontFamily:"monospace"},children:Fe})})}const ee=10,ne=ue=>{const{field:Ee,cell:Ce,tableStyles:Ne,row:Fe,cellProps:Ue}=ue,fe=He(Ee),{title:Te,alt:Ge}=fe.type===c.ob.Image?fe:{title:void 0,alt:void 0},Qe=Ee.display(Ce.value),st=!!(0,E.k)(Ee,Fe)?.length,Xe=(0,h.jsx)("img",{style:{height:Ne.cellHeight-ee,width:"auto"},src:Qe.text,className:Ne.imageCell,alt:Ge,title:Te});return(0,h.jsxs)("div",{...Ue,className:Ne.cellContainer,children:[!st&&Xe,st&&(0,h.jsx)(m.e,{style:{height:Ne.cellHeight-ee,width:"auto"},links:()=>(0,E.k)(Ee,Fe)||[],children:ot=>ot.openMenu?(0,h.jsx)("div",{onClick:ot.openMenu,role:"button",tabIndex:0,onKeyDown:ft=>{ft.key==="Enter"&&ot.openMenu&&ot.openMenu(ft)},children:Xe}):Xe})]})};function Z(ue){const{cell:Ee,tableStyles:Ce,cellProps:Ne,field:Fe,row:Ue}=ue,fe=!!Fe.config.custom?.inspect,Te=(0,b.css)({cursor:"pointer",fontFamily:"monospace"});let Ge=Ee.value,Qe=Ge;if((0,t.isString)(Ge))try{Ge=JSON.parse(Ge)}catch{}else Qe=JSON.stringify(Ge,null," ");const st=!!(0,E.k)(Fe,Ue)?.length,Xe=(0,A.of)(R.Ez);return(0,h.jsxs)("div",{...Ne,className:fe?Ce.cellContainerNoOverflow:Ce.cellContainer,children:[(0,h.jsxs)("div",{className:(0,b.cx)(Ce.cellText,Te),children:[!st&&(0,h.jsx)("div",{className:Ce.cellText,children:Qe}),st&&(0,h.jsx)(m.e,{links:()=>(0,E.k)(Fe,Ue)||[],children:ot=>ot.openMenu?(0,h.jsx)(R.$n,{className:(0,b.cx)(Xe),onClick:ot.openMenu,children:Qe}):(0,h.jsx)(h.Fragment,{children:Qe})})]}),fe&&(0,h.jsx)(z,{...ue,previewMode:U.code})]})}var ae=e(14578);function re({row:ue,tableStyles:Ee}){return(0,h.jsx)("div",{className:Ee.expanderCell,...ue.getToggleRowExpandedProps(),children:(0,h.jsx)(ae.I,{"aria-label":ue.isExpanded?"Collapse row":"Expand row",name:ue.isExpanded?"angle-down":"angle-right",size:"lg"})})}var se=e(30355);const de=50;function le(ue){if(!ue)return"flex-start";if(ue.config.custom)switch(ue.config.custom.align){case"right":return"flex-end";case"left":return"flex-start";case"center":return"center"}return ue.type===a.PU.number?"flex-end":"flex-start"}function he(ue,Ee,Ce,Ne,Fe,Ue){const fe=[];let Te=0;Ne&&(fe.push({Header:()=>null,id:"expander",Cell:re,width:de,minWidth:de,filter:(Qe,st,Xe)=>[],justifyContent:"left",field:ue.fields[0],sortType:"basic"}),Ee-=de);for(const[Qe,st]of ue.fields.entries()){const Xe=st.config.custom||{};if(Xe.hidden||st.type===a.PU.nestedFrames)continue;Xe.width?Ee-=Xe.width:Te++;const ot=_e=>{switch(_e){case a.PU.number:case a.PU.frame:return"number";case a.PU.time:return"basic";default:return"alphanumeric-insensitive"}},ft=ie(Xe.cellOptions?.type,st);fe.push({Cell:ft,id:Qe.toString(),field:st,Header:Xe.hideHeader?"":(0,g.Ct)(st,ue),accessor:(_e,et)=>st.values[et],sortType:ot(st.type),width:Xe.width,minWidth:Xe.minWidth??Ce,filter:r()(J(st)),justifyContent:le(st),Footer:(0,Y.d)(Qe,Fe,Ue)})}let Ge=Ee/Te;for(let Qe=Te;Qe>0;Qe--)for(const st of fe)!st.width&&st.minWidth>Ge&&(st.width=st.minWidth,Ee-=st.width,Te-=1,Ge=Ee/Te);for(const Qe of fe)Qe.width||(Qe.width=Ge),Qe.minWidth=50;return fe}function ie(ue,Ee){switch(ue){case c.ob.Custom:case c.ob.ColorText:case c.ob.ColorBackground:return G;case c.ob.Image:return ne;case c.ob.Gauge:return x;case c.ob.Sparkline:return se.a;case c.ob.JSONView:return Z;case c.ob.DataLinks:return C}if(Ee.type===a.PU.geo)return X;if(Ee.type===a.PU.frame){const Ce=Ee.values[0];return(0,i.ci)(Ce)&&(0,l.aH)(Ce)?se.a:Z}return Ee.type===a.PU.other?Z:G}function J(ue){return function(Ee,Ce,Ne){return Ee.length===0||!Ne||!ue?Ee:Ee.filter(Fe=>{if(!Fe.values.hasOwnProperty(Ce))return!1;const Ue=pe(Fe,ue);return Ne.find(fe=>fe.value===Ue)!==void 0})}}function ce(ue,Ee){if(!Ee||ue.length===0)return{};const Ce={};for(let Ne=0;Ne<ue.length;Ne++){const Fe=pe(ue[Ne],Ee);Ce[Fe||"(Blanks)"]=Fe}return Ce}function pe(ue,Ee){if(!Ee||!ue)return"";const Ce=Ee.values[ue.index],Ne=Ee.display?Ee.display(Ce):Ce;return Ee.display?(0,d.cN)(Ne):Ne}function Pe(ue){return Object.keys(ue).reduce((Ee,Ce)=>Ee.concat({value:ue[Ce],label:Ce}),[]).sort(Ie)}function Ie(ue,Ee){return ue.label===void 0&&Ee.label===void 0?0:ue.label===void 0&&Ee.label!==void 0?-1:ue.label!==void 0&&Ee.label===void 0?1:ue.label<Ee.label?-1:ue.label>Ee.label?1:0}function ge(ue,Ee){return Ee?ue.filter(Ce=>Ee.some(Ne=>Ne.value===Ce.value)):[]}function Se(ue,Ee,Ce){return String(ue.values[Ce]).localeCompare(String(Ee.values[Ce]),void 0,{sensitivity:"base"})}function De(ue,Ee,Ce){const Ne=Ke(ue.values[Ce]),Fe=Ke(Ee.values[Ce]);return Ne===Fe?0:Ne>Fe?1:-1}function Ke(ue){return(0,i.LI)(ue)?ue.value??Number.NEGATIVE_INFINITY:ue==null||ue===""||isNaN(ue)?Number.NEGATIVE_INFINITY:typeof ue=="number"?ue:Number(ue)}function Me(ue,Ee,Ce,Ne){return Je(ue),ue.map((Fe,Ue)=>{if(Fe?.field?.type!==a.PU.number)return Ue===0&&Ce.reducer&&Ce.reducer.length>0?o.AS.get(Ce.reducer[0]).name:void 0;let fe=(0,t.clone)(Fe.field);return fe.values=Ee[Fe.id],fe.state=void 0,Fe.field=fe,Ce.fields&&Ce.fields.length>0?Ce.fields.find(Ge=>Ge===Fe?.field?.name)?be(Fe.field,Ce.reducer,Ne):void 0:be(Fe.field,Ce.reducer||[],Ne)})}function be(ue,Ee,Ce){const Ne=Ee[0];if(Ne===void 0)return"";const Fe=ue.display??(0,u.J)({field:ue,theme:Ce}),Ue=(0,o.Nw)({field:ue,reducers:Ee})[Ne];return o.AS.get(Ne).preservesUnits?(0,d.cN)(Fe(Ue)):(0,d.cN)({text:Ue})}function we(ue){const Ee=[];for(const Ce in ue)for(const[Ne,Fe]of Object.entries(ue[Ce].values))Ee[Ne]===void 0&&(Ee[Ne]=[]),Ee[Ne].push(Fe);return Ee}const Be={type:c.ob.Auto};function He(ue){return ue.config.custom?.displayMode?Ve(ue.config.custom?.displayMode):ue.config.custom?.cellOptions?ue.config.custom.cellOptions:Be}function Ve(ue){switch(ue){case"basic":case"gradient-gauge":case"lcd-gauge":let Ee=c.eX.Basic;return ue==="gradient-gauge"?Ee=c.eX.Gradient:ue==="lcd-gauge"&&(Ee=c.eX.Lcd),{type:c.ob.Gauge,mode:Ee};case"color-background":case"color-background-solid":let Ce=c.Wq.Basic;return ue==="color-background"&&(Ce=c.Wq.Gradient),{type:c.ob.ColorBackground,mode:Ce};default:return{type:ue}}}function Je(ue){const Ee=ue.findIndex((Ce,Ne)=>Ce?.id!==String(Ne));Ee===-1||ue[Ee]?.id==="expander"||(ue.splice(Ee,0,{id:String(Ee)}),Je(ue))}function nt(ue,Ee,Ce){let Ne=ue.state?.alignmentFactors;if(Ne)return(0,d.cN)(Ne).length<(0,d.cN)(Ee).length&&(Ne={...Ee},ue.state.alignmentFactors=Ne),Ne;{Ne={...Ee};const Fe=Math.min(ue.values.length,Ce+1e3);for(let Ue=Ce+1;Ue<Fe;Ue++){const fe=ue.display(ue.values[Ue]);(0,d.cN)(Ne).length>(0,d.cN)(fe).length&&(Ne.text=Ee.text)}return ue.state?ue.state.alignmentFactors=Ne:ue.state={alignmentFactors:Ne},Ne}}function pt(ue,Ee,Ce){return Math.abs(Math.floor(ue)-Ee)<Ce}function bt(ue){let Ee=-Number.MAX_VALUE,Ce=Number.MAX_VALUE;if(ue.values.length<2)return 0;for(let Ne=0;Ne<ue.values.length;Ne++){const Fe=ue.values[Ne];Fe>Ee&&(Ee=Fe),Fe<Ce&&(Ce=Fe)}return(Ee-Ce)/ue.values.length}function Tt(ue,Ee,Ce){const Ne=ue.theme.isDark?1:-.7;let Fe,Ue,fe;if(Ee.type===c.ob.ColorText)Fe=Ce.color;else if(Ee.type===c.ob.ColorBackground){const Te=Ee.mode??c.Wq.Gradient;if(Te===c.Wq.Basic)Fe=(0,p.mZ)(Ce.color,ue.theme.isDark),Ue=(0,s.A)(Ce.color).toRgbString(),fe=(0,s.A)(Ce.color).setAlpha(1).toRgbString();else if(Te===c.Wq.Gradient){const Ge=(0,s.A)(Ce.color).setAlpha(1).toRgbString(),Qe=(0,s.A)(Ce.color).darken(10*Ne).spin(5);Fe=(0,p.mZ)(Ce.color,ue.theme.isDark),Ue=`linear-gradient(120deg, ${Qe.toRgbString()}, ${Ce.color})`,fe=`linear-gradient(120deg, ${Qe.setAlpha(1).toRgbString()}, ${Ge})`}}return{textColor:Fe,bgColor:Ue,bgHoverColor:fe}}function ye(ue,Ee,Ce,Ne,Fe,Ue=0){const fe=Number(Ee?.width??300),Te=1.17,Ge=42,Qe=Ue*2;if(Ce!==null&&typeof ue=="string"){const st=ue.split(/\s/),Xe=[];let ot="",ft=0,_e=0;for(let dt=0;dt<st.length;dt++){const ze=st[dt];let xe=Ce.measureText(ot+" "+ze).width;xe<fe-Qe?(ot+=" "+ze,ft++):(Xe.push({width:xe,line:ot}),ot=ze,ft=0)}for(let dt=0;dt<Xe.length;dt++)if(Xe[dt].width>fe){let ze=Math.floor(Xe[dt].width/fe)-1;_e+=ze}let et=Xe.length+_e,it=38;return et>5?it=et*Ne*Te:it=et*Ne+Ge,it+=Qe,{width:fe,height:it}}return{width:fe,height:Fe}}function je(ue,Ee){let Ce;if(ue!==void 0&&ue.defaults.custom!==void 0&&ue.defaults.custom.cellOptions.wrapText){const Fe=Ee.fields.filter(Ue=>Ue.type===a.PU.string);if(Fe.length>=1&&Fe[0].values.length>0){const Ue=Fe[0].values.length;let fe=0;if(Ue<=30)for(const Te of Fe){const Ge=Te.values[0].length;Ge>fe&&(fe=Ge,Ce=Te)}else for(const Te of Fe){const Ge=(0,t.sampleSize)(Te.values,3),Qe=(Ge[0]?.length+Ge[1]?.length+Ge[2]?.length)/3;Qe>fe&&(fe=Qe,Ce=Te)}}}return Ce}},53402:(_,L,e)=>{"use strict";e.d(L,{p:()=>a});var t=e(74848),n=e(32196),r=e(83195),s=e(40845);const a=({value:i})=>{const l=(0,s.of)(g);return(0,t.jsx)("span",{className:l.counter,children:(0,r.Hg)(i,0).text})},g=i=>({counter:(0,n.css)({label:"counter",marginLeft:i.spacing(1),borderRadius:i.spacing(3),backgroundColor:i.colors.action.hover,padding:i.spacing(.25,1),color:i.colors.text.secondary,fontWeight:i.typography.fontWeightMedium,fontSize:i.typography.size.sm})})},40675:(_,L,e)=>{"use strict";e.d(L,{o:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(16797),i=e(55852),l=e(14578),d=e(53402);const o=r.forwardRef(({label:c,active:p,icon:h,onChangeTab:y,counter:f,suffix:v,className:P,href:m,...D},x)=>{const E=(0,a.of)(u),C=(0,a.of)(i.my),b=()=>(0,t.jsxs)(t.Fragment,{children:[h&&(0,t.jsx)(l.I,{name:h}),c,typeof f=="number"&&(0,t.jsx)(d.p,{value:f}),v&&(0,t.jsx)(v,{className:E.suffix})]}),A={className:(0,n.cx)(C,E.link,p?E.activeStyle:E.notActive),"data-testid":s.Tp.components.Tab.title(c),...D,onClick:y,role:"tab","aria-selected":p};return m?(0,t.jsx)("div",{className:E.item,children:(0,t.jsx)("a",{...A,href:m,ref:x,children:b()})}):(0,t.jsx)("div",{className:E.item,children:(0,t.jsx)("button",{...A,type:"button",ref:x,children:b()})})});o.displayName="Tab";const u=c=>({item:(0,n.css)({listStyle:"none",position:"relative",display:"flex",whiteSpace:"nowrap",padding:c.spacing(.5)}),link:(0,n.css)({color:c.colors.text.secondary,padding:c.spacing(1,1.5,.5),borderRadius:c.shape.radius.default,display:"block",height:"100%",svg:{marginRight:c.spacing(1)},"&:focus-visible":(0,g.getFocusStyles)(c),"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"4px",borderRadius:c.shape.radius.default,bottom:0}}),notActive:(0,n.css)({"a:hover, &:hover, &:focus":{color:c.colors.text.primary,"&::before":{backgroundColor:c.colors.action.hover}}}),activeStyle:(0,n.css)({label:"activeTabStyle",color:c.colors.text.primary,overflow:"hidden","&::before":{backgroundImage:c.colors.gradients.brandHorizontal}}),suffix:(0,n.css)({marginLeft:c.spacing(1)})})},40980:(_,L,e)=>{"use strict";e.d(L,{J:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,className:i,...l})=>{const d=(0,r.of)(a);return(0,t.jsx)("div",{...l,className:(0,n.cx)(d.tabContent,i),children:g})},a=g=>({tabContent:(0,n.css)({background:g.colors.background.primary})})},63021:(_,L,e)=>{"use strict";e.d(L,{U:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);const a=(0,r.forwardRef)(({children:i,className:l,hideBorder:d=!1},o)=>{const u=(0,s.of)(g);return(0,t.jsx)("div",{className:(0,n.cx)(u.tabsWrapper,d&&u.noBorder,l),ref:o,children:(0,t.jsx)("div",{className:u.tabs,role:"tablist",children:i})})}),g=i=>({tabsWrapper:(0,n.css)({borderBottom:`1px solid ${i.colors.border.weak}`,overflowX:"auto"}),noBorder:(0,n.css)({borderBottom:0}),tabs:(0,n.css)({position:"relative",display:"flex",height:`${i.components.menuTabs.height}px`,alignItems:"center"})});a.displayName="TabsBar"},78369:(_,L,e)=>{"use strict";e.d(L,{v:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(70255),a=e(40845),g=e(69613),i=e(72129),l=e(14578);const d=(0,r.forwardRef)(({name:h,onClick:y,icon:f,className:v,colorIndex:P,...m},D)=>{const x=(0,a.$j)(),E=p(x,h,P),C=T=>{T.preventDefault(),T.stopPropagation(),y?.(h,T)},b=(0,n.cx)(E.wrapper,v,{[E.hover]:y!==void 0});return y?(0,t.jsxs)("button",{...m,className:b,onClick:C,ref:D,children:[f&&(0,t.jsx)(l.I,{name:f}),h]}):(0,t.jsxs)("span",{...m,className:b,ref:D,children:[f&&(0,t.jsx)(l.I,{name:f}),h]})});d.displayName="Tag";const o=({rootProps:h})=>{const y=(0,a.of)(c);return(0,t.jsx)(s.A,{width:60,height:22,containerClassName:y.container,...h})},u=(0,i.j)(d,o),c=()=>({container:(0,n.css)({lineHeight:1})}),p=(h,y,f)=>{let v;return f===void 0?v=(0,g.MC)(y):v=(0,g.yC)(f),{wrapper:(0,n.css)({appearance:"none",borderStyle:"none",fontWeight:h.typography.fontWeightMedium,fontSize:h.typography.size.sm,lineHeight:h.typography.bodySmall.lineHeight,verticalAlign:"baseline",backgroundColor:v.color,color:h.v1.palette.gray98,whiteSpace:"pre",textShadow:"none",padding:"3px 6px",borderRadius:h.shape.radius.default}),hover:(0,n.css)({"&:hover":{opacity:.85,cursor:"pointer"}})}}},64149:(_,L,e)=>{"use strict";e.d(L,{L:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(72129),g=e(78369);const i=(0,r.memo)((0,r.forwardRef)(({displayMax:c,tags:p,icon:h,onClick:y,className:f,getAriaLabel:v,getColorIndex:P},m)=>{const D=(0,s.$j)(),x=u(D,!!(c&&c>0)),E=p.length,C=c?p.slice(0,c):p;return(0,t.jsxs)("ul",{className:(0,n.cx)(x.wrapper,f),"aria-label":"Tags",ref:m,children:[C.map((b,T)=>(0,t.jsx)("li",{className:x.li,children:(0,t.jsx)(g.v,{name:b,icon:h,onClick:y,"aria-label":v?.(b,T),"data-tag-id":T,colorIndex:P?.(b,T)})},b)),c&&c>0&&E-c>0&&(0,t.jsxs)("span",{className:x.moreTagsLabel,children:["+ ",E-c]})]})}));i.displayName="TagList";const l=({rootProps:c})=>{const p=(0,s.of)(o);return(0,t.jsxs)("div",{className:p.container,...c,children:[(0,t.jsx)(g.v.Skeleton,{}),(0,t.jsx)(g.v.Skeleton,{})]})},d=(0,a.j)(i,l),o=c=>({container:(0,n.css)({display:"flex",gap:c.spacing(1)})}),u=(c,p)=>({wrapper:(0,n.css)({position:"relative",alignItems:p?"center":"unset",display:"flex",flex:"1 1 auto",flexWrap:"wrap",flexShrink:p?0:1,justifyContent:"flex-end",gap:"6px"}),moreTagsLabel:(0,n.css)({color:c.colors.text.secondary,fontSize:c.typography.size.sm}),li:(0,n.css)({listStyle:"none"})})},79924:(_,L,e)=>{"use strict";e.d(L,{u:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(10354),i=e(69613),l=e(29158);const d=({name:p,disabled:h,onRemove:y})=>{const{color:f,borderColor:v}=(0,r.useMemo)(()=>(0,i.MC)(p),[p]),P=(0,s.of)(o);return(0,t.jsxs)("li",{className:P.itemStyle,style:{backgroundColor:f,borderColor:v},children:[(0,t.jsx)("span",{className:P.nameStyle,children:p}),(0,t.jsx)(l.K,{name:"times",size:"lg",disabled:h,tooltip:`Remove "${p}" tag`,onClick:()=>y(p),className:P.buttonStyles})]})},o=p=>{const h=p.spacing.gridSize*3;return{itemStyle:(0,n.css)({display:"flex",gap:"3px",alignItems:"center",height:`${h}px`,lineHeight:`${h-2}px`,color:"#fff",borderWidth:"1px",borderStyle:"solid",borderRadius:p.shape.radius.default,padding:`0 ${p.spacing(.5)}`,whiteSpace:"nowrap",textShadow:"none",fontWeight:500,fontSize:p.typography.size.sm}),nameStyle:(0,n.css)({maxWidth:"25ch",textOverflow:"ellipsis",overflow:"hidden"}),buttonStyles:(0,n.css)({margin:0,"&:hover::before":{display:"none"}})}},u=({placeholder:p="New tag (enter key to add)",tags:h=[],onChange:y,width:f,className:v,disabled:P,addOnBlur:m,invalid:D,id:x})=>{const[E,C]=(0,r.useState)(""),b=(0,s.of)(c),T=(0,s.$j)(),A=(0,r.useCallback)(B=>{C(B.target.value)},[]),R=B=>{y(h.filter(N=>N!==B))},S=B=>{B?.preventDefault(),h.includes(E)||y(h.concat(E)),C("")},O=()=>{m&&E&&S()},j=B=>{B.key==="Enter"&&E!==""&&S(B)};return(0,t.jsxs)("div",{className:(0,n.cx)(b.wrapper,v,f?(0,n.css)({width:T.spacing(f)}):""),children:[(0,t.jsx)(g.p,{id:x,disabled:P,placeholder:p,onChange:A,value:E,onKeyDown:j,onBlur:O,invalid:D,suffix:(0,t.jsx)(a.$n,{fill:"text",className:b.addButtonStyle,onClick:S,size:"md",disabled:E.length<=0,children:"Add"})}),h?.length>0&&(0,t.jsx)("ul",{className:b.tags,children:h.map(B=>(0,t.jsx)(d,{name:B,onRemove:R,disabled:P},B))})]})},c=p=>({wrapper:(0,n.css)({minHeight:p.spacing(4),display:"flex",flexDirection:"column",gap:p.spacing(1),flexWrap:"wrap"}),tags:(0,n.css)({display:"flex",justifyContent:"flex-start",flexWrap:"wrap",gap:p.spacing(.5)}),addButtonStyle:(0,n.css)({margin:`0 -${p.spacing(1)}`})})},21744:(_,L,e)=>{"use strict";e.d(L,{f:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(87266);const g=(0,r.forwardRef)(({invalid:l,className:d,...o},u)=>{const c=(0,s.of)(i,l);return(0,t.jsx)("textarea",{...o,className:(0,n.cx)(c.textarea,d),ref:u})}),i=(l,d=!1)=>({textarea:(0,n.cx)((0,a.Xb)(l),(0,a.gm)(l),(0,n.css)({display:"block",borderRadius:l.shape.radius.default,padding:`${l.spacing.gridSize/4}px ${l.spacing.gridSize}px`,width:"100%",borderColor:d?l.colors.error.border:l.components.input.borderColor}))});g.displayName="TextArea"},60782:(_,L,e)=>{"use strict";e.d(L,{G:()=>o});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(96540),i=e(40845),l=e(18976),d=e(29158);const o=(0,g.memo)(({children:c,theme:p="info",placement:h="auto",content:y,title:f,closeButton:v=!0,onClose:P,footer:m,fitContent:D=!1,onOpen:x,show:E})=>{const C=(0,g.useRef)(null),b=(0,i.$j)(),T=(0,i.of)(u),A=T[p],[R,S]=(0,g.useState)(E),O=E??R,j=[(0,r.cY)(8),(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)(),(0,r.UE)({element:C})],{context:B,refs:N,floatingStyles:I}=(0,s.we)({open:O,placement:(0,l.O)(h),onOpenChange:H=>{E===void 0&&S(H),H?x?.():P?.()},middleware:j,whileElementsMounted:a.ll,strategy:"fixed"}),K=(0,s.kp)(B),w=(0,s.s9)(B),{getReferenceProps:U,getFloatingProps:W}=(0,s.bv)([w,K]);return(0,t.jsxs)(t.Fragment,{children:[(0,g.cloneElement)(c,{ref:N.setReference,tabIndex:0,"aria-expanded":O,...U()}),O&&(0,t.jsx)(s.s3,{context:B,modal:!1,closeOnFocusOut:!1,children:(0,t.jsxs)("div",{"data-testid":"toggletip-content",className:(0,n.cx)(A.container,{[T.fitContent]:D}),ref:N.setFloating,style:I,...W(),children:[(0,t.jsx)(s.ie,{strokeWidth:.3,stroke:b.colors.border.weak,className:A.arrow,ref:C,context:B}),!!f&&(0,t.jsx)("div",{className:A.header,children:f}),v&&(0,t.jsx)("div",{className:A.headerClose,children:(0,t.jsx)(d.K,{"aria-label":"Close",name:"times","data-testid":"toggletip-header-close",onClick:()=>{S(!1),P?.()}})}),(0,t.jsxs)("div",{className:A.body,children:[(typeof y=="string"||(0,g.isValidElement)(y))&&y,typeof y=="function"&&y({})]}),!!m&&(0,t.jsx)("div",{className:A.footer,children:m})]})})]})});o.displayName="Toggletip";const u=c=>{const p=(0,l.f)(c,c.colors.background.primary,c.colors.border.weak,c.components.tooltip.text,{topBottom:2,rightLeft:2}),h=(0,l.f)(c,c.colors.error.main,c.colors.error.main,c.colors.error.contrastText,{topBottom:2,rightLeft:2});return{info:p,error:h,fitContent:(0,n.css)({maxWidth:"fit-content"})}}},27746:(_,L,e)=>{"use strict";e.d(L,{I:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(8887),a=e(13544),g=e(40845),i=e(16797),l=e(55852),d=e(14578),o=e(56034);const u=(0,r.forwardRef)(({tooltip:y,icon:f,iconSize:v,className:P,children:m,imgSrc:D,imgAlt:x,fullWidth:E,isOpen:C,narrow:b,variant:T="default",iconOnly:A,"aria-label":R,isHighlighted:S,...O},j)=>{const B=(0,g.of)(h),N=(0,n.cx)({[B.button]:!0,[B.buttonFullWidth]:E,[B.narrow]:b},B[T],P),I=(0,n.cx)({[B.content]:!0,[B.contentWithIcon]:!!f,[B.contentWithRightIcon]:C!==void 0}),K=(0,t.jsxs)("button",{ref:j,className:N,"aria-label":c(R,y),"aria-expanded":C,...O,children:[p(f,v),D&&(0,t.jsx)("img",{className:B.img,src:D,alt:x??""}),m&&!A&&(0,t.jsx)("div",{className:I,children:m}),C===!1&&(0,t.jsx)(d.I,{name:"angle-down"}),C===!0&&(0,t.jsx)(d.I,{name:"angle-up"}),S&&(0,t.jsx)("div",{className:B.highlight})]});return y?(0,t.jsx)(o.m,{ref:j,content:y,placement:"bottom",children:K}):K});u.displayName="ToolbarButton";function c(y,f){return y||(f?a.Tp.components.PageToolbar.item(f):void 0)}function p(y,f){return y?(0,s.n6)(y)?(0,t.jsx)(d.I,{name:y,size:`${f||"lg"}`}):y:null}const h=y=>{const f=(0,l.U_)(y,"primary","solid"),v=(0,l.U_)(y,"destructive","solid"),P=(0,n.css)({color:y.colors.text.primary,background:y.colors.secondary.main,"&:hover":{color:y.colors.text.primary,background:y.colors.secondary.shade,border:`1px solid ${y.colors.border.medium}`}});return{button:(0,n.css)({label:"toolbar-button",position:"relative",display:"flex",alignItems:"center",height:y.spacing(y.components.height.md),padding:y.spacing(0,1),borderRadius:y.shape.radius.default,lineHeight:`${y.components.height.md*y.spacing.gridSize-2}px`,fontWeight:y.typography.fontWeightMedium,border:`1px solid ${y.colors.secondary.border}`,whiteSpace:"nowrap",[y.transitions.handleMotion("no-preference","reduce")]:{transition:y.transitions.create(["background","box-shadow","border-color","color"],{duration:y.transitions.duration.short})},"&:focus, &:focus-visible":{...(0,i.getFocusStyles)(y),zIndex:1},"&:focus:not(:focus-visible)":(0,i.getMouseFocusStyles)(y),"&:hover":{boxShadow:y.shadows.z1},"&[disabled], &:disabled":{cursor:"not-allowed",opacity:y.colors.action.disabledOpacity,background:y.colors.action.disabledBackground,boxShadow:"none","&:hover":{color:y.colors.text.disabled,background:y.colors.action.disabledBackground,boxShadow:"none"}}}),default:(0,n.css)({color:y.colors.text.secondary,background:"transparent",border:"1px solid transparent","&:hover":{color:y.colors.text.primary,background:y.colors.background.secondary}}),canvas:P,active:(0,n.cx)(P,(0,n.css)({"&::before":{display:"block",content:'" "',position:"absolute",left:0,right:0,height:"2px",bottom:0,borderRadius:y.shape.radius.default,backgroundImage:y.colors.gradients.brandHorizontal}})),primary:(0,n.css)(f),destructive:(0,n.css)(v),narrow:(0,n.css)({padding:y.spacing(0,.5)}),img:(0,n.css)({width:"16px",height:"16px",marginRight:y.spacing(1)}),buttonFullWidth:(0,n.css)({flexGrow:1}),content:(0,n.css)({display:"flex",flexGrow:1}),contentWithIcon:(0,n.css)({display:"none",paddingLeft:y.spacing(1),[`@media ${i.mediaUp(y.v1.breakpoints.md)}`]:{display:"block"}}),contentWithRightIcon:(0,n.css)({paddingRight:y.spacing(.5)}),highlight:(0,n.css)({backgroundColor:y.colors.success.main,borderRadius:y.shape.radius.circle,width:"6px",height:"6px",position:"absolute",top:"-3px",right:"-3px",zIndex:1})}}},15068:(_,L,e)=>{"use strict";e.d(L,{U:()=>o});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(96540),i=e(40845),l=e(17464),d=e(27746);const o=(0,g.forwardRef)(({alignment:c="left",className:p,children:h,...y},f)=>{const v=g.Children.toArray(h).filter(j=>j!=null),[P,m]=(0,g.useState)(Array(v.length).fill(!1)),D=(0,g.useRef)(null),[x,E]=(0,g.useState)(!1),C=(0,g.useRef)(null),b=(0,g.createRef)(),{overlayProps:T}=(0,a.e)({onClose:()=>E(!1),isDismissable:!0,isOpen:x,shouldCloseOnInteractOutside:j=>{const B=(0,l.gF)();return!C.current?.contains(j)&&!B.contains(j)}},b),{dialogProps:A}=(0,r.s)({},b),R=(0,i.$j)(),S=c==="left"?P.indexOf(!1)-1:P.length,O=u(R,S,c);return(0,g.useLayoutEffect)(()=>{const j=new IntersectionObserver(B=>{B.forEach(N=>{if(N.target instanceof HTMLElement&&N.target.parentNode){const I=Array.prototype.indexOf.call(N.target.parentNode.children,N.target);m(K=>{const w=[...K];return w[I]=N.isIntersecting,w})}})},{threshold:1,root:D.current});return D.current&&Array.from(D.current.children).forEach(B=>{B instanceof HTMLElement&&B!==C.current&&j.observe(B)}),()=>j.disconnect()},[h]),(0,t.jsxs)("div",{ref:D,className:(0,n.cx)(O.container,p),...y,children:[v.map((j,B)=>(0,t.jsx)("div",{style:{order:B,visibility:P[B]?"visible":"hidden"},className:O.childWrapper,children:j},B)),P.includes(!1)&&(0,t.jsxs)("div",{ref:C,className:O.overflowButton,children:[(0,t.jsx)(d.I,{variant:x?"active":"default",tooltip:"Show more items",onClick:()=>E(!x),icon:"ellipsis-v",iconOnly:!0,narrow:!0}),x&&(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,children:(0,t.jsx)("div",{className:O.overflowItems,ref:b,...T,...A,children:v.map((j,B)=>!P[B]&&j)})})]})]})});o.displayName="ToolbarButtonRow";const u=(c,p,h)=>({overflowButton:(0,n.css)({order:p}),overflowItems:(0,n.css)({alignItems:"center",backgroundColor:c.colors.background.primary,borderRadius:c.shape.radius.default,boxShadow:c.shadows.z2,display:"flex",flexWrap:"wrap",gap:c.spacing(1),marginTop:c.spacing(1),maxWidth:"80vw",padding:c.spacing(.5,1),position:"absolute",right:0,top:"100%",width:"max-content",zIndex:c.zIndex.dropdown}),container:(0,n.css)({alignItems:"center",display:"flex",gap:c.spacing(1),justifyContent:h==="left"?"flex-start":"flex-end",minWidth:0,position:"relative"}),childWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:c.spacing(1)})})},13840:(_,L,e)=>{"use strict";e.d(L,{A:()=>d});var t=e(74848),n=e(34743),r=e(83505),s=e(46885),a=e(96540),g=e(40845),i=e(18976),l=e(17464);function d({content:o,show:u,placement:c,className:p,wrapperClassName:h,referenceElement:y,renderArrow:f,...v}){const P=(0,g.$j)(),m=(0,a.useRef)(null),D=[(0,n.cY)(8),(0,n.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,n.BN)()];f&&D.push((0,n.UE)({element:m}));const{context:x,refs:E,floatingStyles:C}=(0,r.we)({open:u,placement:(0,i.O)(c),middleware:D,whileElementsMounted:s.ll,strategy:"fixed"});(0,a.useLayoutEffect)(()=>{E.setReference(y)},[y,E]);const{styles:b}=(0,r.DL)(x,{initial:()=>({opacity:0}),duration:P.transitions.duration.enteringScreen});return u?(0,t.jsx)(l.ZL,{children:(0,t.jsx)("div",{ref:E.setFloating,style:{...C,...b},className:h,...v,children:(0,t.jsxs)("div",{className:p,children:[f&&(0,t.jsx)(r.ie,{fill:P.colors.border.weak,ref:m,context:x}),typeof o=="string"&&o,a.isValidElement(o)&&a.cloneElement(o),typeof o=="function"&&o({})]})})}):void 0}},95868:(_,L,e)=>{"use strict";e.d(L,{I:()=>n});var t=e(96540);class n extends t.Component{constructor(){super(...arguments),this.hideTimeout=null,this.state={show:!1},this.showPopper=()=>{this.hideTimeout&&clearTimeout(this.hideTimeout),this.setState({show:!0})},this.hidePopper=()=>{this.hideTimeout=setTimeout(()=>{this.setState({show:!1})},this.props.hideAfter)}}render(){const{children:s,content:a,placement:g="auto"}=this.props,{show:i}=this.state;return s(this.showPopper,this.hidePopper,{show:i,placement:g,content:a})}}},5313:(_,L,e)=>{"use strict";e.d(L,{z:()=>s});var t=e(74848),n=e(96540);function r(a,g){const i=[];return a.forEach(l=>{i.push(l.start,l.end+1)}),i[0]!==0&&i.unshift(0),i[i.length-1]!==g&&i.push(g),i}const s=a=>{let{highlightParts:g,text:i,highlightClassName:l}=a;if(!g?.length)return null;let d=[],o=r(g,i.length),u=g[0].start===0;for(let c=1;c<o.length;c++){let p=o[c-1],h=o[c];d.push((0,n.createElement)(u?"mark":"span",{key:c-1,className:u?l:void 0},i.substring(p,h))),u=!u}return(0,t.jsx)("div",{children:d})}},2056:(_,L,e)=>{"use strict";e.d(L,{p:()=>g});var t=e(74848),n=e(96540),r=e(83195),s=e(3988);function a(i){return`Custom unit: ${i}`}class g extends n.PureComponent{constructor(){super(...arguments),this.onChange=l=>{this.props.onChange(l.value)}}render(){const{value:l,width:d}=this.props;let o;const c=(0,r.Ke)().map(p=>{const h=p.submenu.map(y=>{const f={label:y.text,value:y.value};return y.value===l&&(o=f),f});return{label:p.text,value:p.text,items:h}});return l&&!o&&(o={value:l,label:l}),(0,t.jsx)(s.v,{width:d,initialValue:o&&o.label,allowCustomValue:!0,changeOnSelect:!1,formatCreateLabel:a,options:c,placeholder:"Choose",isClearable:!0,onSelect:this.props.onChange})}}},12942:(_,L,e)=>{"use strict";e.d(L,{e:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(16795);const a=({src:i,alt:l,width:d,height:o})=>{const u=(0,r.of)(g,d,o);return(0,t.jsx)("img",{className:u.image,src:i,alt:l})},g=(i,l=3,d=3)=>({image:(0,n.css)([(0,s.Y)(i,l,o=>({width:i.spacing(o)})),(0,s.Y)(i,d,o=>({height:i.spacing(o)})),{borderRadius:i.shape.radius.circle}])})},51986:(_,L,e)=>{"use strict";e.d(L,{i:()=>i});var t=e(74848),n=e(96540),r=e(13544),s=e(40845),a=e(55852),g=e(90182);function i({"aria-label":l,label:d,icon:o,options:u,onChange:c,variant:p,minWidth:h=16,size:y="sm",isFullWidth:f=!0,menuPlacement:v,fill:P,buttonCss:m}){const[D,x]=(0,n.useState)(!1),E=(0,s.$j)();return(0,t.jsxs)(t.Fragment,{children:[!D&&(0,t.jsx)(a.$n,{size:y||"sm",className:m,icon:o||"plus",onClick:()=>x(!0),variant:p,fill:P,fullWidth:f,"data-testid":r.Tp.components.ValuePicker.button(l??d),children:d}),D&&(0,t.jsx)("span",{style:{minWidth:E.spacing(h),flexGrow:f?1:void 0},children:(0,t.jsx)(g.l6,{placeholder:d,options:u,"aria-label":r.Tp.components.ValuePicker.select(l??d),isOpen:!0,onCloseMenu:()=>x(!1),autoFocus:!0,onChange:C=>{x(!1),c(C)},menuPlacement:v})})]})}},67266:(_,L,e)=>{"use strict";e.d(L,{KU:()=>i});var t=e(74848),n=e(32196),r=e(49185),s=e(40845),a=e(16797),g=e(40276);const i=({width:o,height:u,legend:c,children:p})=>{const h=(0,s.$j)(),y=(0,s.of)(l),f={display:"flex",width:`${o}px`,height:`${u}px`},[v,P]=(0,r.A)();if(!c)return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("div",{style:f,className:y.viz,children:p(o,u)})});let{placement:m,maxHeight:D="35%",maxWidth:x="60%"}=c.props;document.body.clientWidth<h.breakpoints.values.lg&&(m="bottom");let E=null;const C={};switch(m){case"bottom":f.flexDirection="column",C.maxHeight=D,P.height&&(E={width:o,height:u-P.height});break;case"right":f.flexDirection="row",C.maxWidth=x,P.width&&(E={width:o-P.width,height:u}),c.props.width&&(C.width=c.props.width,E={width:o-c.props.width,height:u});break}return E?.width===0&&(E.width=o),E?.height===0&&(E.height=u),(0,t.jsxs)("div",{style:f,children:[(0,t.jsx)("div",{className:y.viz,children:E&&p(E.width,E.height)}),(0,t.jsx)("div",{style:C,ref:v,children:(0,t.jsx)(g.E,{hideHorizontalTrack:!0,children:c})})]})},l=o=>({viz:(0,n.css)({flexGrow:2,borderRadius:o.shape.radius.default,"&:focus-visible":(0,a.getFocusStyles)(o)})}),d=({children:o})=>(0,t.jsx)(t.Fragment,{children:o});i.Legend=d},94536:(_,L,e)=>{"use strict";e.d(L,{p:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(8066),a=e(40845);const g=r.memo(r.forwardRef(({color:l,className:d,gradient:o,lineStyle:u,...c},p)=>{const h=(0,a.$j)(),y=(0,a.of)(i);let f;if(o){const P=s.uf.get(o).getColors?.(h);P?.length?f=`linear-gradient(90deg, ${P.join(", ")})`:f=h.visualization.getColorByName("")}else f=l;let v;return u?.fill==="dot"&&!o?v={backgroundImage:`radial-gradient(circle at 2px 2px, ${l} 2px, transparent 0)`,backgroundSize:"4px 4px",backgroundRepeat:"space"}:u?.fill==="dash"&&!o?v={backgroundImage:`linear-gradient(to right, ${l} 100%, transparent 0%)`,backgroundSize:"6px 4px",backgroundRepeat:"space"}:v={background:f,borderRadius:h.shape.radius.pill},(0,t.jsx)("div",{"data-testid":"series-icon",ref:p,className:(0,n.cx)(d,y.forcedColors,y.container),style:v,...c})})),i=l=>({container:(0,n.css)({marginRight:"8px",display:"inline-block",width:"14px",height:"4px"}),forcedColors:(0,n.css)({"@media (forced-colors: active)":{forcedColorAdjust:"none"}})});g.displayName="SeriesIcon"},96516:(_,L,e)=>{"use strict";e.d(L,{t:()=>A});var t=e(74848),n=e(96540),r=e(69129),s=e(52622),a=e(79041),g=e(88895),i=e(32196),l=e(40845),d=e(1551),o=e(33552),u=e(34375);const c=({items:R,itemRenderer:S,onLabelMouseOver:O,onLabelMouseOut:j,onLabelClick:B,placement:N,className:I,readonly:K})=>{const w=(0,l.of)(p);S||(S=W=>(0,t.jsx)(u.M,{item:W,onLabelClick:B,onLabelMouseOver:O,onLabelMouseOut:j,readonly:K}));const U=W=>`${W.getItemKey?W.getItemKey():W.label}`;switch(N){case"right":{const W=(H,z)=>(0,t.jsx)("span",{className:w.itemRight,children:S(H,z)});return(0,t.jsx)("div",{className:(0,i.cx)(w.rightWrapper,I),children:(0,t.jsx)(o.B,{items:R,renderItem:W,getItemKey:U})})}case"bottom":default:{const W=R.filter(G=>G.yAxis===1),H=R.filter(G=>G.yAxis!==1),z=(G,M)=>(0,t.jsx)("span",{className:w.itemBottom,children:S(G,M)});return(0,t.jsxs)("div",{className:(0,i.cx)(w.bottomWrapper,I),children:[W.length>0&&(0,t.jsx)("div",{className:w.section,children:(0,t.jsx)(d.c,{items:W,renderItem:z,getItemKey:U})}),H.length>0&&(0,t.jsx)("div",{className:(0,i.cx)(w.section,w.sectionRight),children:(0,t.jsx)(d.c,{items:H,renderItem:z,getItemKey:U})})]})}}};c.displayName="VizLegendList";const p=R=>{const S=(0,i.css)({paddingRight:"10px",display:"flex",fontSize:R.typography.bodySmall.fontSize,whiteSpace:"nowrap"});return{itemBottom:S,itemRight:(0,i.cx)(S,(0,i.css)({marginBottom:R.spacing(.5)})),rightWrapper:(0,i.css)({padding:R.spacing(.5)}),bottomWrapper:(0,i.css)({display:"flex",flexWrap:"wrap",justifyContent:"space-between",width:"100%",padding:R.spacing(.5),gap:"15px 25px"}),section:(0,i.css)({display:"flex"}),sectionRight:(0,i.css)({justifyContent:"flex-end",flexGrow:1,flexBasis:"50%"})}};var h=e(14578),y=e(83195),f=e(16797),v=e(94134);const P=({item:R,onLabelClick:S,onLabelMouseOver:O,onLabelMouseOut:j,className:B,readonly:N})=>{const I=(0,l.of)(m),K=(0,n.useCallback)(W=>{O&&O(R,W)},[R,O]),w=(0,n.useCallback)(W=>{j&&j(R,W)},[R,j]),U=(0,n.useCallback)(W=>{S&&S(R,W)},[R,S]);return(0,t.jsxs)("tr",{className:(0,i.cx)(I.row,B),children:[(0,t.jsx)("td",{children:(0,t.jsxs)("span",{className:I.itemWrapper,children:[(0,t.jsx)(v.R,{color:R.color,seriesName:R.fieldName??R.label,readonly:N,lineStyle:R.lineStyle}),(0,t.jsxs)("button",{disabled:N,type:"button",title:R.label,onBlur:w,onFocus:K,onMouseOver:K,onMouseOut:w,onClick:N?void 0:U,className:(0,i.cx)(I.label,R.disabled&&I.labelDisabled),children:[R.label," ",R.yAxis===2&&(0,t.jsx)("span",{className:I.yAxisLabel,children:"(right y-axis)"})]})]})}),R.getDisplayValues&&R.getDisplayValues().map((W,H)=>(0,t.jsx)("td",{className:I.value,children:(0,y.cN)(W)},`${W.title}-${H}`))]})};P.displayName="LegendTableItem";const m=R=>{const S=f.hoverColor(R.colors.background.primary,R);return{row:(0,i.css)({label:"LegendRow",fontSize:R.v1.typography.size.sm,borderBottom:`1px solid ${R.colors.border.weak}`,td:{padding:R.spacing(.25,1),whiteSpace:"nowrap"},"&:hover":{background:S}}),label:(0,i.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,maxWidth:"600px",textOverflow:"ellipsis",overflow:"hidden",userSelect:"text"}),labelDisabled:(0,i.css)({label:"LegendLabelDisabled",color:R.colors.text.disabled}),itemWrapper:(0,i.css)({display:"flex",whiteSpace:"nowrap",alignItems:"center"}),value:(0,i.css)({textAlign:"right"}),yAxisLabel:(0,i.css)({color:R.colors.text.secondary})}},D="Name",x=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}).compare,E=({items:R,sortBy:S,sortDesc:O,itemRenderer:j,className:B,onToggleSort:N,onLabelClick:I,onLabelMouseOver:K,onLabelMouseOut:w,readonly:U,isSortable:W})=>{const H=(0,l.of)(C),z={};W&&(z[D]="");for(const G of R)if(G.getDisplayValues)for(const M of G.getDisplayValues())z[M.title??"?"]=M.description??"";if(S!=null){let G=new Map;R.forEach(Q=>{if(S!==D&&Q.getDisplayValues){const Y=Q.getDisplayValues().find(te=>te.title===S),q=Y==null||Number.isNaN(Y.numeric)?-1/0:Y.numeric;G.set(Q,q)}});let M=O?-1:1;S===D?R.sort((Q,Y)=>M*x(Q.label,Y.label)):R.sort((Q,Y)=>{const q=G.get(Q)??0,te=G.get(Y)??0;return M*(q-te)})}return j||(j=(G,M)=>(0,t.jsx)(P,{item:G,onLabelClick:I,onLabelMouseOver:K,onLabelMouseOut:w,readonly:U},`${G.label}-${M}`)),(0,t.jsxs)("table",{className:(0,i.cx)(H.table,B),children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[!W&&(0,t.jsx)("th",{}),Object.keys(z).map(G=>(0,t.jsxs)("th",{title:z[G],className:(0,i.cx)(H.header,N&&H.headerSortable,W&&H.nameHeader,{[H.withIcon]:S===G}),onClick:()=>{N&&N(G)},children:[G,S===G&&(0,t.jsx)(h.I,{size:"xs",name:O?"angle-down":"angle-up"})]},G))]})}),(0,t.jsx)("tbody",{children:R.map(j)})]})},C=R=>({table:(0,i.css)({width:"100%","th:first-child":{width:"100%",borderBottom:`1px solid ${R.colors.border.weak}`}}),header:(0,i.css)({color:R.colors.primary.text,fontWeight:R.typography.fontWeightMedium,borderBottom:`1px solid ${R.colors.border.weak}`,padding:R.spacing(.25,1,.25,1),fontSize:R.typography.bodySmall.fontSize,textAlign:"right",whiteSpace:"nowrap"}),nameHeader:(0,i.css)({textAlign:"left",paddingLeft:"30px"}),withIcon:(0,i.css)({paddingRight:"4px"}),headerSortable:(0,i.css)({cursor:"pointer"})});var b=e(29995),T=e(44895);function A({items:R,thresholdItems:S,mappingItems:O,displayMode:j,sortBy:B,seriesVisibilityChangeBehavior:N=b.K.Isolate,sortDesc:I,onLabelClick:K,onToggleSort:w,placement:U,className:W,itemRenderer:H,readonly:z,isSortable:G}){const{eventBus:M,onToggleSeriesVisibility:Q,onToggleLegendSort:Y}=(0,a.d2)(),q=(0,n.useCallback)((ne,Z)=>{M?.publish({type:r.b_.type,payload:{raw:Z,x:0,y:0,dataId:ne.label}})},[M]),te=(0,n.useCallback)((ne,Z)=>{M?.publish({type:r.ql.type,payload:{raw:Z,x:0,y:0,dataId:ne.label}})},[M]),X=(0,n.useCallback)((ne,Z)=>{K&&K(ne,Z),Q&&Q(ne.fieldName??ne.label,N===b.K.Hide?g.B.AppendToSelection:(0,T.W)(Z))},[Q,K,N]),ee=(0,n.useCallback)(ne=>(0,t.jsx)(c,{className:W,placement:U,onLabelMouseOver:q,onLabelMouseOut:te,onLabelClick:X,itemRenderer:H,readonly:z,items:ne}),[W,U,q,te,X,H,z]);switch(j){case s.lm.Table:return(0,t.jsx)(E,{className:W,items:R,placement:U,sortBy:B,sortDesc:I,onLabelClick:X,onToggleSort:w||Y,onLabelMouseOver:q,onLabelMouseOut:te,itemRenderer:H,readonly:z,isSortable:G});case s.lm.List:const ne=S&&S.length>1,Z=O&&O.length>0;return(0,t.jsxs)(t.Fragment,{children:[!ne&&(!Z||R.length>1)&&ee(R),ne&&ee(S),Z&&ee(O)]});default:return null}}A.displayName="VizLegend"},34375:(_,L,e)=>{"use strict";e.d(L,{M:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(94134),i=e(2543),l=e(83195),d=e(1551);const o=({stats:h})=>{const y=(0,a.of)(u);return h.length===0?null:(0,t.jsx)(d.c,{className:y.list,items:h,renderItem:f=>(0,t.jsxs)("div",{className:y.item,title:f.description,children:[f.title&&`${(0,i.capitalize)(f.title)}:`," ",(0,l.cN)(f)]})})},u=()=>({list:(0,n.css)({flexGrow:1,textAlign:"right"}),item:(0,n.css)({marginLeft:"8px"})});o.displayName="VizLegendStatsList";const c=({item:h,onLabelClick:y,onLabelMouseOver:f,onLabelMouseOut:v,className:P,readonly:m})=>{const D=(0,a.of)(p),x=(0,r.useCallback)(b=>{f&&f(h,b)},[h,f]),E=(0,r.useCallback)(b=>{v&&v(h,b)},[h,v]),C=(0,r.useCallback)(b=>{y&&y(h,b)},[h,y]);return(0,t.jsxs)("div",{className:(0,n.cx)(D.itemWrapper,h.disabled&&D.itemDisabled,P),"data-testid":s.Tp.components.VizLegend.seriesName(h.label),children:[(0,t.jsx)(g.R,{seriesName:h.fieldName??h.label,color:h.color,gradient:h.gradient,readonly:m,lineStyle:h.lineStyle}),(0,t.jsx)("button",{disabled:m,type:"button",onBlur:E,onFocus:x,onMouseOver:x,onMouseOut:E,onClick:C,className:D.label,children:h.label}),h.getDisplayValues&&(0,t.jsx)(o,{stats:h.getDisplayValues()})]})};c.displayName="VizLegendListItem";const p=h=>({label:(0,n.css)({label:"LegendLabel",whiteSpace:"nowrap",background:"none",border:"none",fontSize:"inherit",padding:0,userSelect:"text"}),itemDisabled:(0,n.css)({label:"LegendLabelDisabled",color:h.colors.text.disabled}),itemWrapper:(0,n.css)({label:"LegendItemWrapper",display:"flex",whiteSpace:"nowrap",alignItems:"center",flexGrow:1}),value:(0,n.css)({textAlign:"right"}),yAxisLabel:(0,n.css)({color:h.v1.palette.gray2})})},94134:(_,L,e)=>{"use strict";e.d(L,{R:()=>g});var t=e(74848),n=e(96540),r=e(83598),s=e(79041),a=e(94536);const g=(0,n.memo)(({seriesName:i,color:l,gradient:d,readonly:o,lineStyle:u})=>{const{onSeriesColorChange:c}=(0,s.d2)(),p=(0,n.useCallback)(h=>c(i,h),[i,c]);return i&&c&&l&&!o?(0,t.jsx)(r.Dp,{color:l,onChange:p,enableNamedColors:!0,children:({ref:h,showColorPicker:y,hideColorPicker:f})=>(0,t.jsx)(a.p,{color:l,className:"pointer",ref:h,onClick:y,onMouseLeave:f,lineStyle:u})}):(0,t.jsx)(a.p,{color:l,gradient:d,lineStyle:u})});g.displayName="VizLegendSeriesIcon"},29995:(_,L,e)=>{"use strict";e.d(L,{K:()=>t});var t=(n=>(n[n.Isolate=0]="Isolate",n[n.Hide=1]="Hide",n))(t||{})},44895:(_,L,e)=>{"use strict";e.d(L,{W:()=>n});var t=e(88895);function n(r){return r.ctrlKey||r.metaKey||r.shiftKey?t.B.AppendToSelection:t.B.ToggleSelection}},12509:(_,L,e)=>{"use strict";e.d(L,{S:()=>i});var t=e(74848),n=e(2543),r=e(96540),s=e(47070);const a=(d,o,u,c)=>{const p=g(d,o,c),h=g(o,d,c),y=Math.max(p,h);let f=Math.floor(d/y),v=Math.ceil(c/f);f=Math.ceil(c/v);const P=f-(f*v-c),m=d/P-u+u/P;return{width:d/f-u+u/f,height:o/v-u+u/v,widthOnLastRow:m,xCount:f,yCount:v}};function g(d,o,u){const c=Math.ceil(Math.sqrt(u*d/o));return Math.floor(c*o/d)*c<u?o/Math.ceil(c*o/d):d/c}class i extends r.PureComponent{static{this.defaultProps={itemSpacing:8}}constructor(o){super(o),this.state={values:o.getValues()}}componentDidUpdate(o){const{renderCounter:u,source:c}=this.props;(u!==o.renderCounter||c!==o.source)&&this.setState({values:this.props.getValues()})}getOrientation(){const{orientation:o,width:u,height:c}=this.props;return o===s.wV.Auto?u>c?s.wV.Vertical:s.wV.Horizontal:o}renderGrid(){const{renderValue:o,height:u,width:c,itemSpacing:p,getAlignmentFactors:h,orientation:y}=this.props,{values:f}=this.state,v=a(c,u,p,f.length),P=h?h(f,v.width,v.height):{};let m=0,D=0,x=[];for(let E=0;E<f.length;E++){const C=f[E],T=D===v.yCount-1?v.widthOnLastRow:v.width,A=v.height,R=m*T+p*m,S=D*A+p*D,O={position:"absolute",left:R,top:S,width:`${T}px`,height:`${A}px`};x.push((0,t.jsx)("div",{style:O,children:o({value:C,width:T,height:A,alignmentFactors:P,orientation:y,count:f.length})},E)),m++,m===v.xCount&&(m=0,D++)}return(0,t.jsx)("div",{style:{position:"relative"},children:x})}render(){const{renderValue:o,height:u,width:c,itemSpacing:p,getAlignmentFactors:h,autoGrid:y,orientation:f,maxVizHeight:v,minVizWidth:P,minVizHeight:m}=this.props,{values:D}=this.state;if(y&&f===s.wV.Auto)return this.renderGrid();const x={display:"flex"},E={display:"flex",overflow:`${P?"auto":"hidden"} ${m?"auto":"hidden"}`};let C=u,b=c;const T=this.getOrientation();switch(T){case s.wV.Horizontal:const R=(u+p)/D.length-p;E.flexDirection="column",E.height=`${u}px`,E.overflowX="hidden",x.marginBottom=`${p}px`,b=c,C=(0,n.clamp)(R,m??0,v??R);break;case s.wV.Vertical:E.flexDirection="row",E.justifyContent="space-between",E.overflowY="hidden",x.marginRight=`${p}px`,C=u,b=Math.max(c/D.length-p+p/D.length,P??0)}x.width=`${b}px`,x.height=`${C}px`;const A=h?h(D,b,C):{};return(0,t.jsx)("div",{style:E,children:D.map((R,S)=>(0,t.jsx)("div",{style:l(x,S,D.length),children:o({value:R,width:b,height:C,alignmentFactors:A,orientation:T,count:D.length})},S))})}}function l(d,o,u){return o===u-1?{...d,marginRight:0,marginBottom:0}:d}},3139:(_,L,e)=>{"use strict";e.d(L,{g:()=>g,o:()=>i});var t=e(74848),n=e(32196),r=e(40845),s=e(94536);const a=l=>({icon:(0,n.css)({marginRight:l.spacing(1),verticalAlign:"middle"}),seriesTable:(0,n.css)({display:"table"}),seriesTableRow:(0,n.css)({display:"table-row",fontSize:l.typography.bodySmall.fontSize}),seriesTableCell:(0,n.css)({display:"table-cell"}),label:(0,n.css)({wordBreak:"break-all"}),value:(0,n.css)({paddingLeft:l.spacing(2),textAlign:"right"}),activeSeries:(0,n.css)({fontWeight:l.typography.fontWeightBold,color:l.colors.text.maxContrast}),timestamp:(0,n.css)({fontWeight:l.typography.fontWeightBold,fontSize:l.typography.bodySmall.fontSize})}),g=({color:l,label:d,value:o,isActive:u})=>{const c=(0,r.of)(a);return(0,t.jsxs)("div",{"data-testid":"SeriesTableRow",className:(0,n.cx)(c.seriesTableRow,u&&c.activeSeries),children:[l&&(0,t.jsx)("div",{className:c.seriesTableCell,children:(0,t.jsx)(s.p,{color:l,className:c.icon})}),d&&(0,t.jsx)("div",{className:(0,n.cx)(c.seriesTableCell,c.label),children:d}),o&&(0,t.jsx)("div",{className:(0,n.cx)(c.seriesTableCell,c.value),children:o})]})},i=({timestamp:l,series:d})=>{const o=(0,r.of)(a);return(0,t.jsxs)(t.Fragment,{children:[l&&(0,t.jsx)("div",{className:o.timestamp,"aria-label":"Timestamp",children:l}),d.map((u,c)=>(0,t.jsx)(g,{isActive:u.isActive,label:u.label,color:u.color,value:u.value},`${u.label}-${c}`))]})}},69503:(_,L,e)=>{"use strict";e.d(L,{o:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(52908),a=e(40845),g=e(16797),i=e(10875);const l=({position:{x:o,y:u},offset:{x:c,y:p},children:h,allowPointerEvents:y=!1,className:f,...v})=>{const P=(0,r.useRef)(null),[m,D]=(0,r.useState)({width:0,height:0}),{width:x,height:E}=(0,s.A)(),[C,b]=(0,r.useState)({x:o+c,y:u+p}),T=(0,r.useMemo)(()=>new ResizeObserver(R=>{for(let S of R){const O=Math.floor(S.contentRect.width+16),j=Math.floor(S.contentRect.height+2*8);(m.width!==O||m.height!==j)&&D({width:Math.min(O,x),height:Math.min(j,E)})}}),[m,x,E]);(0,r.useLayoutEffect)(()=>(P.current&&T.observe(P.current),()=>{T.disconnect()}),[T]),(0,r.useLayoutEffect)(()=>{if(P&&P.current){const{x:R,y:S}=(0,i.Ju)(o,u,m.width,m.height,c,p,x,E);b({x:R,y:S})}},[x,E,o,c,u,p,m]);const A=(0,a.of)(d);return(0,t.jsx)("div",{ref:P,style:{position:"fixed",left:0,pointerEvents:y?"auto":"none",top:0,transform:`translate(${C.x}px, ${C.y}px)`,transition:"transform ease-out 0.1s"},"aria-live":"polite","aria-atomic":"true",...v,className:(0,n.cx)(A.wrapper,f),children:h})};l.displayName="VizTooltipContainer";const d=o=>({wrapper:(0,n.css)((0,g.getTooltipContainerStyles)(o))})},79871:(_,L,e)=>{"use strict";e.d(L,{Ev:()=>r,fX:()=>t,lJ:()=>n});var t=(s=>(s.series="series",s.value="value",s.hexagon="hexagon",s.pie_1_4="pie_1_4",s.pie_2_4="pie_2_4",s.pie_3_4="pie_3_4",s.marker_sm="marker_sm",s.marker_md="marker_md",s.marker_lg="marker_lg",s))(t||{}),n=(s=>(s.hidden="hidden",s.first="first",s.leading="leading",s.trailing="trailing",s))(n||{});const r="series"},10875:(_,L,e)=>{"use strict";e.d(L,{Ju:()=>i,L$:()=>l,cp:()=>c});var t=e(11261),n=e(8066),r=e(83195),s=e(24293),a=e(52622),g=e(79871);const i=(p=0,h=0,y=0,f=0,v=0,P=0,m=0,D=0)=>{let x=p,E=h;const C=Math.max(p+v+y-(m-v),0),b=Math.abs(Math.min(p-v-y-v,0)),T=C>0,A=b>0,R=Math.max(h+P+f-(D-P),0),S=Math.abs(Math.min(h-P-f-P,0)),O=R>0,j=S>0;return T&&A?x=C>b?v:m-v-y:T?x=p-v-y:x=p+v,O&&j?E=R>S?P:D-P-f:O?E=h-P-f:E=h+P,{x,y:E}},l=(p,h)=>{switch(p){case g.fX.value:return h.value;case g.fX.hexagon:return h.hexagon;case g.fX.pie_1_4:return h.pie_1_4;case g.fX.pie_2_4:return h.pie_2_4;case g.fX.pie_3_4:return h.pie_3_4;case g.fX.marker_sm:return h.marker_sm;case g.fX.marker_md:return h.marker_md;case g.fX.marker_lg:return h.marker_lg;default:return h.value}},d=(p,h)=>p.numeric-h.numeric,o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"}),u=(p,h)=>o.compare(`${p.value}`,`${h.value}`),c=(p,h,y,f,v,P,m=D=>!0)=>{let D=[],x=!0;for(let E=0;E<p.length;E++){const C=p[E];if(C===h||C.type===t.PU.time||!m(C)||C.config.custom?.hideFrom?.tooltip||C.config.custom?.hideFrom?.viz||v===a.$N.Single&&f!==E)continue;let b=y[E];if(b==null)continue;C.type===t.PU.number||C.type===t.PU.boolean||C.type===t.PU.enum||(x=!1);const T=p[E].values[b];if(T==null&&C.config.noValue==null)continue;const A=C.display(T),R=Number.isNaN(A.numeric)?P===a.xB.Descending?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER:A.numeric,S=(0,n.Qi)(C);let O=g.fX.series,j=g.lJ.first;S.isByValue&&(O=g.fX.value,j=g.lJ.trailing),D.push({label:C.state?.displayName??C.name,value:(0,r.cN)(A),color:A.color??s.F,colorIndicator:O,colorPlacement:j,isActive:v===a.$N.Multi&&f===E,numeric:R,lineStyle:C.config.custom?.lineStyle})}if(P!==a.xB.None&&D.length>1){const E=x?d:u,C=P===a.xB.Descending?-1:1;D.sort((b,T)=>C*E(b,T))}return D}},55458:(_,L,e)=>{"use strict";e.d(L,{FcD:()=>Kt.F,ibS:()=>dn,Ivu:()=>Vs.Iv,DWK:()=>Vs.DW,gZN:()=>Vs.gZ,p0K:()=>ot,Dd_:()=>Hr.D,euF:()=>_o.e,Exy:()=>Uo.E,xEy:()=>on.xE,eX$:()=>ts.eX,yVm:()=>Ft.yV,ypG:()=>Ft.yp,$p8:()=>Ft.$p,F8C:()=>Ft.F8,SV3:()=>Ft.SV,azJ:()=>ir.a,jQM:()=>Xr.J,$nd:()=>ae.$n,HRi:()=>de,e2v:()=>yo.e,fHW:()=>dr.f,cbd:()=>hs.c,ZpM:()=>Qr.Z,Q_j:()=>zo.Q,vxQ:()=>ne.v,KmA:()=>On.K,Sc0:()=>ya.S,NqN:()=>ge.N,bLJ:()=>ee.b,BYM:()=>Oe.B,q0m:()=>Ze.q,MU_:()=>ln.M,SDm:()=>Qt.S,skP:()=>ce.sk,itl:()=>Ke,ZFl:()=>G.Z,uoB:()=>ze.u,mcf:()=>cr.mc,tzH:()=>Ss.t,a2C:()=>Qt.a,phK:()=>yn.p,Pli:()=>wt.P,EZm:()=>v.E,Rsn:()=>pn.R,lZ_:()=>ba.l,ebG:()=>Rs.e,eHD:()=>Oa.e,tco:()=>xt.t,lrV:()=>je.l,lS2:()=>ue.l,K7n:()=>Ee.K,etH:()=>M.e,cGx:()=>Jo.c,_s:()=>wr._,msM:()=>Va.m,Z7I:()=>we.Z,ppr:()=>Be.p,tHk:()=>Ka.tH,XwR:()=>Ka.Xw,DaU:()=>wa.D,Kur:()=>Xo.K,aaz:()=>qa.a,sN5:()=>Rr.s,AVJ:()=>Ns.A,yKR:()=>la.y,ep7:()=>or,D0$:()=>Ue.D,ED_:()=>jo,nA8:()=>In,nVY:()=>So.n,PgM:()=>Oo.P,gHy:()=>Gr.gH,wIj:()=>Gr.wI,IBq:()=>$o.I,ef9:()=>wo.e,ZYI:()=>Wo.Z,mKT:()=>dt.m,lVW:()=>po.l,i7I:()=>Ho.i,Vpd:()=>qn,_I2:()=>sn._,TS0:()=>jn,Hdp:()=>fr.H,io8:()=>fr.i,ovZ:()=>ei,MTY:()=>nn,IK5:()=>$n,xA9:()=>bo.x,GyY:()=>cr.Gy,Int:()=>a.I,K0:()=>z.K,w4Q:()=>va.w,IP5:()=>cn.I,CeB:()=>Ro.C,IjS:()=>Yo.I,c2B:()=>Io.c,e8d:()=>Ao.e,KYK:()=>Zt.K,r0T:()=>he.r,pde:()=>br.p,eyo:()=>vo.e,jDF:()=>Ne.j,BJ$:()=>Cr.B,OoN:()=>Fa.O,Z7z:()=>Ir.Z,JU7:()=>lr.J,rRI:()=>Ii,OYG:()=>n.O,s$2:()=>Mo.s,N_E:()=>Po.N,z9$:()=>ae.z9,B8B:()=>Ce.B,GmG:()=>J.G,_ae:()=>ie._,pH9:()=>Ma.p,W1t:()=>Os.W,rXV:()=>ka.r,Drp:()=>na.D,aFV:()=>rt.a,rQ0:()=>vt.r,EOs:()=>zt.EO,OHP:()=>jt,JXd:()=>Ot.J,wEe:()=>zt.wE,$sz:()=>zt.$s,YO7:()=>zt.YO,KFt:()=>Vs.KF,dAS:()=>qt.d,dKS:()=>_e.d,NRL:()=>en.NR,oQQ:()=>tn.I,_wj:()=>Zr._,XFg:()=>gn.XF,e4W:()=>gn.e4,$sV:()=>Or.$,Bjr:()=>Go.B,AMh:()=>Y.A,IE3:()=>Q.I,ZLI:()=>te.ZL,qB2:()=>te.qB,Xjo:()=>xe.X,JBW:()=>Xa.J,zWQ:()=>No.z,a0s:()=>ra.a,F16:()=>go.F,m3b:()=>Le.m,cCp:()=>Je.cC,NBP:()=>Vo.N,IUm:()=>Pt.I,L47:()=>ts.L4,L44:()=>Fo.L4,lpq:()=>Ko.lp,YAX:()=>Tn.Y,Y4n:()=>Ks.Y,sYD:()=>$s.s,oyW:()=>fs.o,Lrm:()=>Kr.L,a$h:()=>aa.a,l6P:()=>Vs.l6,KAb:()=>Vs.KA,o5c:()=>Vr.o5,Dpi:()=>ce.Dp,o0L:()=>be.o,tJM:()=>be.t,pMY:()=>Aa.p,o95:()=>St.o,gNl:()=>St.g,KHN:()=>Ct.K,Bd:()=>Zo.B,u3P:()=>fn.u,nfS:()=>xs.n,Apm:()=>Ya,$xS:()=>To.$,OW$:()=>Xt.O,y$y:()=>ys.y,BJc:()=>Co.B,SPA:()=>Ve.S,dOG:()=>Zt.d,jDu:()=>Qn.j,ozo:()=>Gn.o,JSC:()=>bn.J,qtX:()=>X.q,XIK:()=>Sn.X,bwN:()=>rs,U05:()=>kn.U,vwO:()=>et.v,LYX:()=>it.L,um3:()=>Fe.u,EYj:()=>Ja.E,fs1:()=>Hn.f,YqK:()=>Do.Y,R3l:()=>bt.R,xSz:()=>nt.xS,bYj:()=>Tr.b,fD2:()=>pt.f,$64:()=>nt.$6,ZOC:()=>Mi,U7r:()=>Tt.U,XNj:()=>Bo.X,Gff:()=>q.G,IBt:()=>$a.I,Uhs:()=>xo.U,m_M:()=>D.m,TkQ:()=>ao,xlH:()=>Ar.xl,piP:()=>_r.pi,ZCE:()=>Yr.Z,eEE:()=>Za.e,pKo:()=>He.p,nys:()=>ko,iyp:()=>Eo.i,gWJ:()=>cr.gW,sMJ:()=>wn,ipx:()=>Vs.ip,KUk:()=>Nn.KU,tZ2:()=>Rt.t,MJh:()=>Mt.M,SdN:()=>kt.S,nRt:()=>Un,oNG:()=>xn.o,l69:()=>ye.l,nuT:()=>_a.n,_XZ:()=>Jr._,jnT:()=>el,Myc:()=>Di,myI:()=>ae.my,I1_:()=>cs.I1,cbf:()=>Je.cb,gso:()=>Ys.g,Hut:()=>Qr.H,lBN:()=>Sr.l,na7:()=>br.n,gF8:()=>te.gF,Jq4:()=>zr.J,rLY:()=>ye.r,ti9:()=>za.t,YnM:()=>Nt,JcZ:()=>Wt,mYT:()=>Pi,aLN:()=>m.A,Xb:()=>mo.Xb,_$q:()=>cs._$,glJ:()=>cs.gl,IyU:()=>Oi,d2s:()=>gn.d2,hrX:()=>Ta.h,OOt:()=>qe.O,Xc0:()=>Ka.Xc});var t=e(90090),n=e(91634),r=e(74848),s=e(28581),a=e(14578);const g=ut=>{const yt=ut.selectProps.menuIsOpen;return(0,r.jsx)(s.c.IndicatorsContainer,{...ut,children:(0,r.jsx)(a.I,{name:yt?"angle-up":"angle-down",style:{marginTop:"7px"}})})},i=g,l=ut=>{const{children:yt}=ut;return(0,r.jsx)(s.c.NoOptionsMessage,{...ut,children:(0,r.jsx)("div",{className:"gf-form-select-box__desc-option",children:(0,r.jsx)("div",{className:"gf-form-select-box__desc-option__body",children:yt})})})},d=l;var o=e(46942),u=e.n(o),c=e(96540),p=e(46005),h=e(8539),y=e(66963),f=e(60578),v=e(40276),P=e(62235),m=e(23731),D=e(56034);const x=ut=>{const{children:yt,isSelected:Dt,data:Lt}=ut;return(0,r.jsx)(s.c.Option,{...ut,children:(0,r.jsxs)("div",{className:"gf-form-select-box__desc-option",children:[Lt.imgUrl&&(0,r.jsx)("img",{className:"gf-form-select-box__desc-option__img",src:Lt.imgUrl,alt:""}),(0,r.jsxs)("div",{className:"gf-form-select-box__desc-option__body",children:[(0,r.jsx)("div",{children:yt}),Lt.description&&(0,r.jsx)("div",{className:"gf-form-select-box__desc-option__desc",children:Lt.description})]}),Dt&&(0,r.jsx)(a.I,{name:"check","aria-hidden":"true"})]})})},E=null;var C=e(32196),b=e(3911),T=e(40845);const A=(0,b.N)(ut=>({header:(0,C.css)({display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${ut.colors.background.secondary}`,"&:hover":{color:ut.colors.text.maxContrast}}),label:(0,C.css)({flexGrow:1}),icon:(0,C.css)({paddingRight:"2px"})}));class R extends c.PureComponent{constructor(){super(...arguments),this.state={expanded:!1},this.onToggleChildren=()=>{this.setState(yt=>({expanded:!yt.expanded}))}}componentDidMount(){if(this.props.data.expanded)this.setState({expanded:!0});else if(this.props.selectProps&&this.props.selectProps.value){const{value:yt}=this.props.selectProps.value;yt&&this.props.options.some(Dt=>Dt.value===yt)&&this.setState({expanded:!0})}}componentDidUpdate(yt){yt.selectProps.inputValue!==""&&this.setState({expanded:!0})}render(){const{children:yt,label:Dt,theme:Lt}=this.props,{expanded:$t}=this.state,It=A(Lt);return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:It.header,onClick:this.onToggleChildren,role:"presentation",children:[(0,r.jsx)("span",{className:It.label,children:Dt}),(0,r.jsx)(a.I,{className:It.icon,name:$t?"angle-up":"angle-down"})]}),$t&&yt]})}}const S=(0,T.cV)(R),O=ut=>(0,r.jsx)(s.c.MenuList,{...ut,children:(0,r.jsx)(v.E,{autoHide:!1,autoHeightMax:"inherit",children:ut.children})});class j extends c.PureComponent{static{this.contextType=f.D}static{this.defaultProps={className:"",isDisabled:!1,isSearchable:!0,isClearable:!1,isMulti:!1,openMenuOnFocus:!1,autoFocus:!1,isLoading:!1,backspaceRemovesValue:!0,maxMenuHeight:300,tabSelectsValue:!0,allowCustomValue:!1,components:{Option:x,SingleValue:P.K,IndicatorsContainer:i,MenuList:O,Group:S}}}render(){const{defaultValue:yt,getOptionLabel:Dt,getOptionValue:Lt,onChange:$t,options:It,placeholder:_t,width:Jt,value:rn,className:Yt,isDisabled:En,isLoading:mn,isSearchable:Dn,isClearable:Vn,backspaceRemovesValue:_n,isMulti:Gt,autoFocus:as,openMenuOnFocus:Qs,onBlur:Fs,maxMenuHeight:oa,noOptionsMessage:Zs,isOpen:ua,components:Yn,tooltipContent:vn,tabSelectsValue:ms,onCloseMenu:Ln,onOpenMenu:bs,allowCustomValue:Ps,formatCreateLabel:Ts,"aria-label":Ds}=this.props;let Us="";Jt&&(Us="width-"+Jt);let zs=p.Ay;const ma={};Ps&&(zs=y.A,ma.formatCreateLabel=Ts??(Pn=>Pn));const ha=u()("gf-form-input","gf-form-input--form-dropdown",Us,Yt),Sa={...j.defaultProps.components,...Yn};return(0,r.jsx)(N,{onCloseMenu:Ln,onOpenMenu:bs,tooltipContent:vn,isOpen:ua,children:(Pn,gr)=>(0,r.jsx)(zs,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:ha,components:Sa,defaultValue:yt,value:rn,getOptionLabel:Dt,getOptionValue:Lt,menuShouldScrollIntoView:!1,isSearchable:Dn,onChange:$t,options:It,placeholder:_t||"Choose",styles:(0,m.A)(this.context),isDisabled:En,isLoading:mn,isClearable:Vn,autoFocus:as,onBlur:Fs,openMenuOnFocus:Qs,maxMenuHeight:oa,noOptionsMessage:Zs,isMulti:Gt,backspaceRemovesValue:_n,menuIsOpen:ua,onMenuOpen:Pn,onMenuClose:gr,tabSelectsValue:ms,"aria-label":Ds,...ma})})}}class B extends c.PureComponent{static{this.contextType=f.D}static{this.defaultProps={className:"",components:{},loadingMessage:()=>"Loading...",isDisabled:!1,isClearable:!1,isMulti:!1,isSearchable:!0,backspaceRemovesValue:!0,autoFocus:!1,openMenuOnFocus:!1,maxMenuHeight:300}}render(){const{defaultValue:yt,getOptionLabel:Dt,getOptionValue:Lt,onChange:$t,placeholder:It,width:_t,value:Jt,className:rn,loadOptions:Yt,defaultOptions:En,isLoading:mn,loadingMessage:Dn,noOptionsMessage:Vn,isDisabled:_n,isSearchable:Gt,isClearable:as,backspaceRemovesValue:Qs,autoFocus:Fs,onBlur:oa,openMenuOnFocus:Zs,maxMenuHeight:ua,isMulti:Yn,tooltipContent:vn,onCloseMenu:ms,onOpenMenu:Ln,isOpen:bs}=this.props;let Ps="";_t&&(Ps="width-"+_t);const Ts=u()("gf-form-input","gf-form-input--form-dropdown",Ps,rn);return(0,r.jsx)(N,{onCloseMenu:ms,onOpenMenu:Ln,tooltipContent:vn,isOpen:bs,children:(Ds,Us)=>(0,r.jsx)(h.A,{captureMenuScroll:!1,classNamePrefix:"gf-form-select-box",className:Ts,components:{Option:x,SingleValue:P.K,IndicatorsContainer:i,NoOptionsMessage:d},defaultValue:yt,value:Jt,getOptionLabel:Dt,getOptionValue:Lt,menuShouldScrollIntoView:!1,onChange:$t,loadOptions:Yt,isLoading:mn,defaultOptions:En,placeholder:It||"Choose",styles:(0,m.A)(this.context),loadingMessage:Dn,noOptionsMessage:Vn,isDisabled:_n,isSearchable:Gt,isClearable:as,autoFocus:Fs,onBlur:oa,openMenuOnFocus:Zs,maxMenuHeight:ua,isMulti:Yn,backspaceRemovesValue:Qs})})}}class N extends c.PureComponent{constructor(){super(...arguments),this.state={isOpenInternal:!1},this.onOpenMenu=()=>{const{onOpenMenu:yt}=this.props;yt&&yt(),this.setState({isOpenInternal:!0})},this.onCloseMenu=()=>{const{onCloseMenu:yt}=this.props;yt&&yt(),this.setState({isOpenInternal:!1})}}render(){const{children:yt,isOpen:Dt,tooltipContent:Lt}=this.props,{isOpenInternal:$t}=this.state;let It;return($t||Dt)&&(It=!1),Lt?(0,r.jsx)(D.m,{show:It,content:Lt,placement:"bottom",children:(0,r.jsx)("div",{children:yt(this.onOpenMenu,this.onCloseMenu)})}):(0,r.jsx)("div",{children:yt(this.onOpenMenu,this.onCloseMenu)})}}const I=null;var K=e(2543);class w extends c.PureComponent{constructor(){super(...arguments),this.state={id:(0,K.uniqueId)()},this.internalOnChange=yt=>{yt.stopPropagation(),this.props.onChange(yt)}}render(){const{labelClass:yt="",switchClass:Dt="",label:Lt,checked:$t,disabled:It,transparent:_t,className:Jt,theme:rn,tooltip:Yt,tooltipPlacement:En}=this.props,mn=W(rn),Dn=this.state.id,Vn=`gf-form-label ${yt} ${_t?"gf-form-label--transparent":""} pointer`,_n=(0,C.cx)(mn.switch,Dt,{[mn.switchTransparent]:_t});return(0,r.jsx)("div",{className:mn.container,children:(0,r.jsxs)("label",{htmlFor:Dn,className:(0,C.cx)("gf-form",mn.labelContainer,Jt),children:[Lt&&(0,r.jsxs)("div",{className:Vn,children:[Lt,Yt&&(0,r.jsx)(D.m,{placement:En||"auto",content:Yt,theme:"info",children:(0,r.jsx)(a.I,{name:"info-circle",size:"sm",style:{marginLeft:"10px"}})})]}),(0,r.jsxs)("div",{className:_n,children:[(0,r.jsx)("input",{disabled:It,id:Dn,type:"checkbox",checked:$t,onChange:this.internalOnChange}),(0,r.jsx)("span",{className:mn.slider})]})]})})}}const U=(0,T.cV)(w),W=ut=>{const yt=(0,C.css)({background:ut.v1.palette.gray1,borderRadius:ut.shape.radius.pill,height:"16px",width:"32px",display:"block",position:"relative","&::before":{position:"absolute",content:"''",height:"12px",width:"12px",left:"2px",top:"2px",background:ut.components.input.background,transition:"0.4s",borderRadius:ut.shape.radius.circle,boxShadow:ut.shadows.z1}});return{container:(0,C.css)({display:"flex",flexShrink:0}),labelContainer:(0,C.css)({display:"flex",cursor:"pointer",marginRight:ut.spacing(.5)}),switch:(0,C.css)({display:"flex",position:"relative",width:"56px",height:ut.spacing(4),background:ut.components.input.background,border:`1px solid ${ut.components.input.borderColor}`,borderRadius:ut.shape.radius.default,alignItems:"center",justifyContent:"center",input:{opacity:0,width:0,height:0},[`input:checked + .${yt}`]:{background:ut.colors.primary.main},[`input:checked + .${yt}::before`]:{transform:"translateX(16px)"}}),switchTransparent:(0,C.css)({background:"transparent",border:0,width:"40px"}),slider:yt}};var H=e(56286),z=e(29158),G=e(82702),M=e(91605),Q=e(95868),Y=e(13840),q=e(60782),te=e(17464),X=e(60734),ee=e(10534),ne=e(3988),Z=e(16401),ae=e(55852),re=e(58898),se=e(30958);const de=ut=>{const{onChange:yt,className:Dt,loadData:Lt,icon:$t,buttonProps:It,hideDownIcon:_t,variant:Jt,disabled:rn,...Yt}=ut,En=(0,T.of)(le),mn=(0,T.of)(se.T);let Dn=ut.children;return _t||(Dn=[ut.children,(0,r.jsx)(a.I,{name:"angle-down",className:En.icons.right},"down-icon")]),(0,r.jsx)(Z.A,{onChange:(0,re.k)(yt),loadData:(0,re.W)(Lt),dropdownClassName:(0,C.cx)(mn.dropdown,En.popup),...Yt,expandIcon:null,children:(0,r.jsx)(ae.$n,{icon:$t,disabled:rn,variant:Jt,...It??{},children:Dn})})};de.displayName="ButtonCascader";const le=ut=>({popup:(0,C.css)({label:"popup",zIndex:ut.zIndex.dropdown}),icons:{right:(0,C.css)({margin:"1px 0 0 4px"}),left:(0,C.css)({margin:"-1px 4px 0 0"})}});var he=e(32982),ie=e(39558),J=e(57514),ce=e(83598),pe=e(7612),Pe=e(65229),Ie=e(23596),ge=e(8866),Se=e(36314),De=e(95151);const Ke=(0,c.forwardRef)(({value:ut="",onChange:yt,returnColorAs:Dt="rgb",...Lt},$t)=>{const[It,_t]=(0,c.useState)(ut),[Jt,rn]=(0,c.useState)(!1),Yt=(0,T.$j)(),En=(0,T.of)(Me),mn=(0,T.of)(De.$);return(0,Pe.A)(Dn=>{if(Dn===ut)return;if(!Dn){yt("");return}const Vn=Yt.visualization.getColorByName(Dn);yt(Dt==="rgb"?Ie.MV.asRgbString(Vn):Ie.MV.asHexString(Vn))},500,[It]),(0,r.jsx)(ge.N,{onClick:()=>rn(!1),children:(0,r.jsxs)("div",{className:En.wrapper,children:[Jt&&!Lt.disabled&&(0,r.jsx)(pe.p9,{"data-testid":"color-popover",color:It,onChange:_t,className:(0,C.cx)(mn.root,En.picker)}),(0,r.jsx)(Se.A,{...Lt,theme:Yt,color:It,onChange:_t,buttonAriaLabel:"Open color picker",onClick:()=>rn(!0),onBlur:()=>rn(!1),ref:$t,isClearable:!0})]})})});Ke.displayName="ColorPickerInput";const Me=ut=>({wrapper:(0,C.css)({position:"relative"}),picker:(0,C.css)({"&.react-colorful":{position:"absolute",width:"100%",zIndex:11,bottom:"36px"}}),inner:(0,C.css)({position:"absolute"})});var be=e(70104),we=e(41670),Be=e(69529),He=e(2056),Ve=e(42734),Je=e(11134),nt=e(15666),pt=e(3799),bt=e(66070),Tt=e(20333),ye=e(15648),je=e(56181),ue=e(98239),Ee=e(63383),Ce=e(33552),Ne=e(48840),Fe=e(79924),Ue=e(88575);const fe=(0,c.memo)(()=>{const ut=(0,T.of)(Te);return(0,r.jsxs)("div",{className:ut.ellipsis,children:[(0,r.jsx)("span",{className:ut.firstDot,children:"."}),(0,r.jsx)("span",{className:ut.secondDot,children:"."}),(0,r.jsx)("span",{className:ut.thirdDot,children:"."})]})});fe.displayName="EllipsisAnimated";const Te=ut=>({ellipsis:(0,C.css)({display:"inline"}),firstDot:(0,C.css)({[ut.transitions.handleMotion("no-preference","reduce")]:{animation:`${Ge} 2s linear infinite`}}),secondDot:(0,C.css)({[ut.transitions.handleMotion("no-preference","reduce")]:{animation:`${Qe} 2s linear infinite`}}),thirdDot:(0,C.css)({[ut.transitions.handleMotion("no-preference","reduce")]:{animation:`${st} 2s linear infinite`}})}),Ge=(0,C.keyframes)`
  0% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Qe=(0,C.keyframes)`
  0% {
    opacity: 0;
  }
  21% {
    opacity: 0.5;
  }
  22% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,st=(0,C.keyframes)`
  0% {
    opacity: 0;
  }
  43% {
    opacity: 0.5;
  }
  44% {
    opacity: 1;
  }
  65% {
    opacity: 1;
  }
  66% {
    opacity: 0.5;
  }
  100% {
    opacity: 0;
  }
  `,Xe=2*1e3;function ot(ut){const{invalid:yt,loading:Dt,onFinishChange:Lt,saveErrorMessage:$t="Error saving this value",error:It,children:_t,disabled:Jt,...rn}=ut,[Yt,En]=c.useState({isLoading:!1,showSuccess:!1,showError:yt}),mn=(0,c.useRef)(null);c.useEffect(()=>{let as;if(Yt.showSuccess){const Qs=Yt.showError?0:Xe;as=setTimeout(()=>{En({...Yt,showSuccess:!1})},Qs)}return()=>{window.clearTimeout(as)}},[Yt]);const Dn=(0,c.useCallback)(as=>{yt||(En({...Yt,isLoading:!0,showSuccess:!1}),Lt(as).then(()=>{En({isLoading:!1,showSuccess:!0,showError:!1})}).catch(()=>{En({...Yt,isLoading:!1,showError:!0})}))},[yt,Yt,Lt]),Vn=(0,c.useMemo)(()=>(0,K.debounce)(Dn,600,{leading:!1}),[Dn]),_n=yt||Yt.showError||void 0,Gt=(0,T.of)(ft);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Ue.D,{...rn,loading:Dt||void 0,invalid:_n,disabled:Jt,error:It||Yt.showError&&$t,ref:mn,className:Gt.widthFitContent,children:c.cloneElement(_t(as=>{Vn(as)}))}),Yt.isLoading&&(0,r.jsxs)(he.r,{referenceElement:mn.current,placement:"right",children:["Saving ",(0,r.jsx)(fe,{})]}),Yt.showSuccess&&(0,r.jsx)(he.r,{suffixIcon:"check",referenceElement:mn.current,placement:"right",children:"Saved!"})]})}ot.displayName="AutoSaveField";const ft=()=>({widthFitContent:(0,C.css)({width:"fit-content"})});var _e=e(19384),et=e(78369),it=e(64149),dt=e(92174),ze=e(96374),xe=e(20084),Oe=e(32372),Le=e(85828),Ze=e(19716),qe=e(99544),rt=e(37390),vt=e(29473),Ot=e(25897);const jt=({children:ut})=>{const yt=(0,T.of)(Ut);return(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:yt.header,children:(0,r.jsx)("div",{className:yt.content,children:ut})})})},Ut=ut=>({header:(0,C.css)({display:"flex",margin:ut.spacing(0,0,3,0)}),content:(0,C.css)({flexGrow:1})});var zt=e(71678),qt=e(95247),fn=e(67570),Sn=e(77093),An=e(72436),Hn=e(21744);class es extends c.PureComponent{constructor(yt){super(yt),this.readCSV=(0,K.debounce)(()=>{const{config:$t}=this.props,{text:It}=this.state;this.setState({data:(0,An.Jh)(It,{config:$t})})},150),this.onTextChange=$t=>{this.setState({text:$t.target.value})};const{text:Dt,config:Lt}=yt;this.state={text:Dt,data:(0,An.Jh)(Dt,{config:Lt})}}componentDidUpdate(yt,Dt){const{text:Lt}=this.state;(Lt!==Dt.text||this.props.config!==yt.config)&&this.readCSV(),this.props.text!==yt.text&&this.props.text!==Lt&&this.setState({text:this.props.text}),this.state.data!==Dt.data&&this.props.onSeriesParsed(this.state.data,this.state.text)}render(){const{width:yt,height:Dt,theme:Lt}=this.props,{data:$t}=this.state,It=Zn(Lt);return(0,r.jsxs)("div",{className:It.tableInputCsv,children:[(0,r.jsx)(Hn.f,{style:{width:yt,height:Dt},placeholder:"Enter CSV here...",value:this.state.text,onChange:this.onTextChange,className:It.textarea}),$t&&(0,r.jsx)("footer",{className:It.footer,children:$t.map((_t,Jt)=>(0,r.jsxs)("span",{children:["Rows:",_t.length,", Columns:",_t.fields.length," \xA0",(0,r.jsx)(a.I,{name:"check-circle"})]},Jt))})]})}}const rs=(0,T.cV)(es);rs.displayName="TableInputCSV";const Zn=(0,b.N)(ut=>({tableInputCsv:(0,C.css)({position:"relative"}),textarea:(0,C.css)({height:"100%",width:"100%"}),footer:(0,C.css)({position:"absolute",bottom:"15px",right:"15px",border:"1px solid #222",background:ut.colors.success.main,padding:`1px ${ut.spacing(.5)}`,fontSize:"80%"})}));var kn=e(63021),Gn=e(40675),Kn=e(13544),yn=e(53402);const wn=(0,c.forwardRef)(({label:ut,active:yt,icon:Dt,counter:Lt,className:$t,suffix:It,onChangeTab:_t,href:Jt,...rn},Yt)=>{const En=(0,T.of)(Jn),mn=()=>(0,r.jsxs)(r.Fragment,{children:[Dt&&(0,r.jsx)(a.I,{name:Dt}),ut,typeof Lt=="number"&&(0,r.jsx)(yn.p,{value:Lt}),It&&(0,r.jsx)(It,{className:En.suffix})]}),Dn=(0,C.cx)(En.link,yt&&En.activeStyle);return(0,r.jsx)("a",{href:Jt,className:Dn,...rn,onClick:_t,"aria-label":rn["aria-label"]||Kn.Tp.components.Tab.title(ut),role:"tab","aria-selected":yt,ref:Yt,children:mn()})});wn.displayName="Tab";const Jn=ut=>({link:(0,C.css)({padding:"6px 12px",display:"block",height:"100%",cursor:"pointer",position:"relative",color:ut.colors.text.primary,svg:{marginRight:ut.spacing(1)},"&:hover, &:focus":{textDecoration:"underline"}}),activeStyle:(0,C.css)({label:"activeTabStyle",color:ut.colors.text.maxContrast,overflow:"hidden","&::before":{display:"block",content:'" "',position:"absolute",left:0,width:"4px",bottom:"2px",top:"2px",borderRadius:ut.shape.radius.default,backgroundImage:"linear-gradient(0deg, #f05a28 30%, #fbca0a 99%)"}}),suffix:(0,C.css)({marginLeft:ut.spacing(1)})});var bn=e(40980),Pt=e(44522),Ft=e(37494),Xt=e(5926),sn=e(95164),on=e(97696),xn=e(69503);const Un=({content:ut,position:yt,offset:Dt})=>{const Lt=(0,T.of)(hn);return yt?(0,r.jsx)(te.ZL,{className:Lt.portal,children:(0,r.jsx)(xn.o,{position:yt,offset:Dt||{x:0,y:0},children:ut})}):null};Un.displayName="VizTooltip";const hn=()=>({portal:(0,C.css)({position:"absolute",top:0,left:0,pointerEvents:"none",width:"100%",height:"100%"})});var St=e(3139),kt=e(12509),en=e(91052),tn=e(89963),gn=e(79041),Nn=e(67266),Ct=e(29995),Rt=e(96516),Mt=e(34375),Kt=e(42418);class nn extends c.Component{constructor(yt){super(yt),this.onSeriesToggle=this.onSeriesToggle.bind(this),this.state={hiddenSeries:[],toggledSeries:yt.series}}componentDidUpdate(yt){const{series:Dt}=this.props;(0,K.isEqual)(yt.series,Dt)||this.setState({hiddenSeries:[],toggledSeries:Dt})}onSeriesToggle(yt,Dt){const{series:Lt,onHiddenSeriesChanged:$t}=this.props,{hiddenSeries:It}=this.state;if(Dt.ctrlKey||Dt.metaKey||Dt.shiftKey){const Yt=It.indexOf(yt)>-1?It.filter(mn=>mn!==yt):It.concat([yt]),En=Lt.map(mn=>({...mn,isVisible:Yt.indexOf(mn.label)===-1}));this.setState({hiddenSeries:Yt,toggledSeries:En},()=>$t?$t(Yt):void 0);return}const _t=Lt.map(Yt=>Yt.label),Jt=It.length+1===_t.length?[]:(0,K.difference)(_t,[yt]),rn=Lt.map(Yt=>({...Yt,isVisible:Jt.indexOf(Yt.label)===-1}));this.setState({hiddenSeries:Jt,toggledSeries:rn},()=>$t?$t(Jt):void 0)}render(){const{children:yt}=this.props,{toggledSeries:Dt}=this.state;return yt({onSeriesToggle:this.onSeriesToggle,toggledSeries:Dt})}}var Qt=e(82762),ln=e(57418),pn=e(14689);function In({links:ut}){const yt=(0,T.of)(Rn);if(ut.length===1)return(0,r.jsx)(pn.R,{link:ut[0]});const Dt=ut.filter($t=>$t.target==="_blank"),Lt=ut.filter($t=>$t.target==="_self");return(0,r.jsxs)(r.Fragment,{children:[Lt.map(($t,It)=>(0,r.jsx)(pn.R,{link:$t},It)),(0,r.jsxs)("div",{className:yt.wrapper,children:[(0,r.jsx)("p",{className:yt.externalLinksHeading,children:"External links"}),Dt.map(($t,It)=>(0,r.jsxs)("a",{href:$t.href,target:$t.target,className:yt.externalLink,children:[(0,r.jsx)(a.I,{name:"external-link-alt"}),$t.title]},It))]})]})}const Rn=ut=>({wrapper:(0,C.css)({flexBasis:"150px",width:"100px",marginTop:ut.spacing(1)}),externalLinksHeading:(0,C.css)({color:ut.colors.text.secondary,fontWeight:ut.typography.fontWeightRegular,fontSize:ut.typography.size.sm,margin:0}),externalLink:(0,C.css)({color:ut.colors.text.link,fontWeight:ut.typography.fontWeightRegular,display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&:hover":{textDecoration:"underline"},div:{marginRight:ut.spacing(1)}})}),qn=({className:ut,children:yt})=>{const Dt=(0,T.of)(os);return(0,r.jsx)("div",{className:(0,C.cx)(Dt,ut),children:yt})},os=()=>(0,C.css)({display:"flex",button:{flexGrow:1,justifyContent:"center"},"> *":{flexGrow:1},label:{flexGrow:1,textAlign:"center"}});var cs=e(63250),hs=e(76442),Ss=e(28122),Os=e(38138),ka=e(59093),na=e(64539),_a=e(51686),Oa=e(64919),ba=e(64078),Rs=e(59796),Aa=e(94536),va=e(37166),la=e(29678);const or=(0,c.memo)((0,c.forwardRef)(({title:ut,featureState:yt,...Dt},Lt)=>{const $t=(0,T.of)(Dr),It=yt?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:$t.badge,children:(0,r.jsx)(la.y,{featureState:yt})}),(0,r.jsx)("h3",{children:ut})]}):(0,r.jsx)("h3",{children:ut});return(0,r.jsx)(va.w,{branded:!0,title:It,urlTitle:"Read documentation",ref:Lt,...Dt})}));or.displayName="FeatureInfoBox";const Dr=ut=>({badge:(0,C.css)({marginBottom:ut.spacing(1)})});var Cr=e(24022),Fa=e(44533),Ka=e(66602),wa=e(52446),xt=e(91409),wt=e(11184),Zt=e(15292),cn=e(14186);function dn({options:ut,onOptionsChange:yt}){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"page-heading",children:"Alerting"}),(0,r.jsx)("div",{className:"gf-form-group",children:(0,r.jsx)("div",{className:"gf-form-inline",children:(0,r.jsx)("div",{className:"gf-form",children:(0,r.jsx)(cn.I,{labelWidth:29,label:"Manage alert rules in Alerting UI",disabled:ut.readOnly,tooltip:"Manage alert rules for this data source. To manage other alerting resources, add an Alertmanager data source.",children:(0,r.jsx)(Zt.K,{value:ut.jsonData.manageAlerts!==!1,onChange:Dt=>yt({...ut,jsonData:{...ut.jsonData,manageAlerts:Dt.currentTarget.checked}})})})})})})]})}var Tn=e(17081),Qn=e(95180),On=e(28623),ys=e(62930),Ns=e(31511),xs=e(72960),Ks=e(38401),$s=e(83684),fs=e(57752),aa=e(13102),Kr=e(64765),wr=e(87978),fo=e(52762),xi=e(10434),br=e(10354),$r=e(24849);const Ya=({min:ut,max:yt,onChange:Dt,onAfterChange:Lt,orientation:$t="horizontal",reverse:It,step:_t,value:Jt,ariaLabelForHandle:rn,marks:Yt,included:En})=>{const mn=$t==="horizontal",Dn=(0,T.of)($r.$,mn,!!Yt),Vn=xi.A,[_n,Gt]=(0,c.useState)(Jt??ut),as=(0,c.useCallback)(Yn=>{const vn=typeof Yn=="number"?Yn:Yn[0];Gt(vn),Dt?.(vn)},[Gt,Dt]),Qs=(0,c.useCallback)(Yn=>{let vn=+Yn.target.value;Number.isNaN(vn)&&(vn=0),Gt(vn),Dt&&Dt(vn),Lt&&Lt(vn)},[Dt,Lt]),Fs=(0,c.useCallback)(Yn=>{const vn=+Yn.target.value;vn>yt?Gt(yt):vn<ut&&Gt(ut)},[yt,ut]),oa=(0,c.useCallback)(Yn=>{const vn=typeof Yn=="number"?Yn:Yn[0];Lt?.(vn)},[Lt]),Zs=mn?[]:[Dn.sliderInputVertical],ua=mn?[]:[Dn.sliderInputFieldVertical];return(0,r.jsxs)("div",{className:(0,C.cx)(Dn.container,Dn.slider),children:[(0,r.jsx)(fo.Global,{styles:Dn.tooltip}),(0,r.jsxs)("div",{className:(0,C.cx)(Dn.sliderInput,...Zs),children:[(0,r.jsx)(Vn,{min:ut,max:yt,step:_t,defaultValue:Jt,value:_n,onChange:as,onChangeComplete:oa,vertical:!mn,reverse:It,ariaLabelForHandle:rn,marks:Yt,included:En}),(0,r.jsx)(br.p,{type:"text",className:(0,C.cx)(Dn.sliderInputField,...ua),value:_n,onChange:Qs,onBlur:Fs,min:ut,max:yt})]})]})};Ya.displayName="Slider";var go=e(47097),po=e(51253),mo=e(87266),vo=e(16504),yo=e(19727),$a=e(27746),xo=e(15068),Eo=e(51986),Ys=e(84349),Po=e(50720),Do=e(72109),Ja=e(94753),ir=e(90613),Co=e(67061),bo=e(71259),To=e(68402),lr=e(60029),Mo=e(17408),So=e(84167),Oo=e(72093),Ao=e(63056),Io=e(76892),Ro=e(39268),Lo=e(49785);const jo=({name:ut,control:yt,children:Dt,...Lt})=>{const{fields:$t,append:It,prepend:_t,remove:Jt,swap:rn,move:Yt,insert:En}=(0,Lo.jz)({control:yt,name:ut,...Lt});return Dt({fields:$t,append:It,prepend:_t,remove:Jt,swap:rn,move:Yt,insert:En})};var Vs=e(90182),Vr=e(12681),zr=e(88824),Bo=e(62883),cr=e(66864),Uo=e(39938),No=e(94354),Xa=e(79569),ra=e(83186),Hr=e(51440),Wo=e(67647),Fo=e(9226),Ko=e(58724),ya=e(10880),wo=e(73546),Gr=e(37270),$o=e(73569),Tr=e(54230),Vo=e(5308),Qr=e(10860),zo=e(81507),Ho=e(9286),dr=e(9261),Va=e(83122),Go=e(98624),ur=e(47232);const Qo=ut=>{const Dt=(0,ur.KQ)(ut).diff((0,ur.KQ)(),"hours",!1);return`Active last ${(Math.floor(-Dt/24)+1)*24}h`},kr=ut=>{if(!ut)return"";const[yt,Dt]=ut.split(" ");return`${yt?.[0]??""}${Dt?.[0]??""}`.toUpperCase()},ko=({userView:ut,className:yt,children:Dt,onClick:Lt,showTooltip:$t=!0})=>{const{user:It,lastActiveAt:_t}=ut,Jt=(0,ur.KQ)(_t).diff((0,ur.KQ)(),"minutes",!0)>=-15,rn=(0,T.$j)(),Yt=(0,c.useMemo)(()=>Mr(rn,Jt),[rn,Jt]),En=(0,r.jsx)("button",{type:"button",onClick:Lt,className:(0,C.cx)(Yt.container,Lt&&Yt.pointer,yt),"aria-label":`${It.name} icon`,children:Dt?(0,r.jsx)("div",{className:(0,C.cx)(Yt.content,Yt.textContent),children:Dt}):It.avatarUrl?(0,r.jsx)("img",{className:Yt.content,src:It.avatarUrl,alt:`${It.name} avatar`}):(0,r.jsx)("div",{className:(0,C.cx)(Yt.content,Yt.textContent),children:kr(It.name)})});if($t){const mn=(0,r.jsxs)("div",{className:Yt.tooltipContainer,children:[(0,r.jsx)("div",{className:Yt.tooltipName,children:It.name}),(0,r.jsx)("div",{className:Yt.tooltipDate,children:Jt?(0,r.jsxs)("div",{className:Yt.dotContainer,children:[(0,r.jsx)("span",{children:"Active last 15m"}),(0,r.jsx)("span",{className:Yt.dot})]}):Qo(_t)})]});return(0,r.jsx)(D.m,{content:mn,children:En})}else return En},hr=ut=>`0 0 0 1px ${ut}`,Mr=(ut,yt)=>{const Dt=yt?ut.colors.primary.main:ut.colors.border.medium,Lt=yt?ut.colors.primary.text:ut.colors.border.strong;return{container:(0,C.css)({padding:0,width:"30px",height:"30px",background:"none",border:"none",borderRadius:ut.shape.radius.circle,"& > *":{borderRadius:ut.shape.radius.circle}}),content:(0,C.css)({lineHeight:"24px",maxWidth:"100%",border:`3px ${ut.colors.background.primary} solid`,boxShadow:hr(Dt),backgroundClip:"padding-box","&:hover":{boxShadow:hr(Lt)}}),textContent:(0,C.css)({background:ut.colors.background.primary,padding:0,color:ut.colors.text.secondary,textAlign:"center",fontSize:ut.typography.size.sm,"&:focus":{boxShadow:hr(Dt)}}),tooltipContainer:(0,C.css)({textAlign:"center",padding:ut.spacing(0,1)}),tooltipName:(0,C.css)({fontWeight:ut.typography.fontWeightBold}),tooltipDate:(0,C.css)({fontWeight:ut.typography.fontWeightRegular}),dotContainer:(0,C.css)({display:"flex",alignItems:"center"}),dot:(0,C.css)({height:"6px",width:"6px",backgroundColor:ut.colors.primary.main,borderRadius:ut.shape.radius.circle,display:"inline-block",marginLeft:ut.spacing(1)}),pointer:(0,C.css)({cursor:"pointer"})}};var _o=e(12942),Yo=e(38894),Jo=e(25994),Sr=e(69144),Ta=e(21633),za=e(52198),ts=e(52622),Za=e(51336),_r=e(30501),Yr=e(81297),Or=e(24182),qa=e(78226),Ma=e(6967),Jr=e(97620),Ar=e(38761),Xo=e(68268),Ir=e(23117),Rr=e(52811),Zo=e(88895),Xr=e(54438),Zr=e(52494),qo=e(34796),Lr=e.n(qo),ca=e(61443),fr=e(33083),xa=e(83195),ke=e(28240),Re=e(72724),Ye=e(42994);const lt=(ut,yt)=>{let Dt=0,Lt=ut.values.length-1,$t;for(;;){if(Dt>Lt)return Math.max(Lt,0);$t=Math.floor((Dt+Lt)/2);const It=ut.values[$t];if(It===yt)return $t;It&&It<yt?Dt=$t+1:Lt=$t-1}},At=(ut,yt,Dt,Lt)=>{let $t,It,_t,Jt,rn;const Yt=[];let En,mn;for($t=0;$t<ut.length;$t++){It=ut[$t];const Dn=yt[$t];_t=lt(Dn,Dt),Jt=Dt-Dn.values[_t],rn=Dn.values[_t],(En===void 0||Jt>=0&&(Jt<En||En<0)||Jt<0&&Jt>En)&&(En=Jt,mn=Dn.display?(0,xa.cN)(Dn.display(rn)):rn);const Vn=It.display(It.values[_t]);Yt.push({value:(0,xa.cN)(Vn),datapointIndex:_t,seriesIndex:$t,color:Vn.color,label:(0,ke.Ct)(It),time:Dn.display?(0,xa.cN)(Dn.display(rn)):rn})}return{results:Yt,time:mn}},Nt=(ut,yt)=>(0,Re.LE)(ut,{format:yt?.options?.timeformat,timeZone:yt?.options?.timezone}),Wt=(ut,yt,Dt)=>{if(yt&&Dt&&ut){const Lt=Dt-yt,$t=Lt/ut/1e3,It=86400010,_t=31536e6;return $t<=10?Ye.WC.interval.millisecond:$t<=45?Ye.WC.interval.second:Lt<=It?Ye.WC.interval.minute:$t<=8e4?Ye.WC.interval.hour:Lt<=_t?Ye.WC.interval.day:$t<=31536e3?Ye.WC.interval.month:Ye.WC.interval.year}return Ye.WC.interval.minute},Ht=({dimensions:ut,activeDimensions:yt,pos:Dt,timeZone:Lt})=>{let $t=null;if(yt.xAxis===null)return null;yt.yAxis&&($t=yt.yAxis[0]);const It=yt.xAxis[1]?(0,ca.WK)(ut.xAxis,yt.xAxis[0],yt.xAxis[1]):Dt.x,_t=At(ut.yAxis.columns,ut.xAxis.columns,It,Lt),Jt=_t.time,rn=_t.results.map((Yt,En)=>({color:Yt.color,label:Yt.label,value:Yt.value,isActive:$t===En}));return(0,r.jsx)(St.o,{series:rn,timestamp:Jt})};Ht.displayName="MultiModeGraphTooltip";const un=({dimensions:ut,activeDimensions:yt,timeZone:Dt})=>{if(yt.yAxis===null||yt.yAxis[1]===void 0||yt.xAxis===null||yt.xAxis[1]===void 0)return null;const Lt=(0,ca.WK)(ut.xAxis,yt.xAxis[0],yt.xAxis[1]),$t=(0,ca.P4)(ut.xAxis,yt.xAxis[0]),It=$t.display?(0,xa.cN)($t.display(Lt)):Lt,_t=(0,ca.P4)(ut.yAxis,yt.yAxis[0]),Jt=(0,ca.WK)(ut.yAxis,yt.yAxis[0],yt.yAxis[1]),rn=_t.display,Yt=rn(Jt);return(0,r.jsx)(St.o,{series:[{color:Yt.color,label:(0,ke.Ct)(_t),value:(0,xa.cN)(Yt)}],timestamp:It})};un.displayName="SingleModeGraphTooltip";const an=({mode:ut=ts.$N.Single,dimensions:yt,activeDimensions:Dt,pos:Lt,timeZone:$t})=>!Dt||!Dt.xAxis?null:ut==="single"?(0,r.jsx)(un,{dimensions:yt,activeDimensions:Dt,timeZone:$t}):(0,r.jsx)(Ht,{dimensions:yt,activeDimensions:Dt,pos:Lt,timeZone:$t});an.displayName="GraphTooltip";class jn extends c.PureComponent{constructor(){super(...arguments),this.state={isTooltipVisible:!1,isContextVisible:!1},this.element=null,this.$element=null,this.onPlotSelected=(yt,Dt)=>{const{onHorizontalRegionSelected:Lt}=this.props;Lt&&Lt(Dt.xaxis.from,Dt.xaxis.to)},this.onPlotHover=(yt,Dt,Lt)=>{this.setState({isTooltipVisible:!0,activeItem:Lt,pos:Dt})},this.onPlotClick=(yt,Dt,Lt)=>{this.setState({isContextVisible:!0,isTooltipVisible:!1,contextItem:Lt,contextPos:Dt})},this.renderTooltip=()=>{const{children:yt,series:Dt,timeZone:Lt}=this.props,{pos:$t,activeItem:It,isTooltipVisible:_t}=this.state;let Jt;if(!_t||!$t||Dt.length===0||(c.Children.forEach(yt,as=>{if(Jt)return;(as&&as.type&&(as.type.displayName||as.type.name))===Un.displayName&&(Jt=as)}),!Jt))return null;const rn=Jt.props,Yt=rn.mode||"single";if(!It&&Yt==="single")return null;const En=rn.tooltipComponent||an,mn=It?It.series.seriesIndex:0,Dn=It?It.dataIndex:void 0,Vn={xAxis:[mn,Dn],yAxis:It?[It.series.seriesIndex,It.dataIndex]:null},_n={dimensions:{xAxis:(0,ca.r4)("xAxis",Dt.map(as=>as.timeField)),yAxis:(0,ca.r4)("yAxis",Dt.map(as=>as.valueField))},activeDimensions:Vn,pos:$t,mode:rn.mode||ts.$N.Single,timeZone:Lt},Gt=c.createElement(En,{..._n});return c.cloneElement(Jt,{content:Gt,position:{x:$t.pageX,y:$t.pageY},offset:{x:10,y:10}})},this.renderContextMenu=()=>{const{series:yt}=this.props,{contextPos:Dt,contextItem:Lt,isContextVisible:$t}=this.state;if(!$t||!Dt||!Lt||yt.length===0)return null;const It=Lt?Lt.series.seriesIndex:0,_t=Lt?Lt.dataIndex:void 0,Jt={xAxis:[It,_t],yAxis:Lt?[Lt.series.seriesIndex,Lt.dataIndex]:null},rn={xAxis:(0,ca.r4)("xAxis",yt.map(Dn=>Dn.timeField)),yAxis:(0,ca.r4)("yAxis",yt.map(Dn=>Dn.valueField))},Yt=()=>this.setState({isContextVisible:!1}),En=()=>({datapoint:Lt.datapoint,dataIndex:Lt.dataIndex,series:Lt.series,seriesIndex:Lt.series.seriesIndex,pageX:Dt.pageX,pageY:Dt.pageY}),mn={x:Dt.pageX,y:Dt.pageY,onClose:Yt,getContextMenuSource:En,timeZone:this.props.timeZone,dimensions:rn,contextDimensions:Jt};return(0,r.jsx)(fr.H,{...mn})},this.getBarWidth=()=>{const{series:yt}=this.props;return Math.min(...yt.map(Dt=>Dt.timeStep))}}static{this.defaultProps={showLines:!0,showPoints:!1,showBars:!1,isStacked:!1,lineWidth:1}}componentDidUpdate(yt,Dt){yt!==this.props&&this.draw()}componentDidMount(){this.draw(),this.element&&(this.$element=Lr()(this.element),this.$element.bind("plotselected",this.onPlotSelected),this.$element.bind("plothover",this.onPlotHover),this.$element.bind("plotclick",this.onPlotClick))}componentWillUnmount(){this.$element&&this.$element.unbind("plotselected",this.onPlotSelected)}getYAxes(yt){return yt.length===0?[{show:!0,min:-1,max:1}]:(0,K.uniqBy)(yt.map(Dt=>{const Lt=Dt.yAxis?Dt.yAxis.index:1,$t=Dt.yAxis&&Dt.yAxis.min&&!isNaN(Dt.yAxis.min)?Dt.yAxis.min:null,It=Dt.yAxis&&Dt.yAxis.tickDecimals&&!isNaN(Dt.yAxis.tickDecimals)?Dt.yAxis.tickDecimals:null;return{show:!0,index:Lt,position:Lt===1?"left":"right",min:$t,tickDecimals:It}}),Dt=>Dt.index)}draw(){if(this.element===null)return;const{width:yt,series:Dt,timeRange:Lt,showLines:$t,showBars:It,showPoints:_t,isStacked:Jt,lineWidth:rn,timeZone:Yt,onHorizontalRegionSelected:En}=this.props;if(!yt)return;const mn=yt/100,Dn=Lt.from.valueOf(),Vn=Lt.to.valueOf(),_n=this.getYAxes(Dt),Gt={legend:{show:!1},series:{stack:Jt,lines:{show:$t,lineWidth:rn,zero:!1},points:{show:_t,fill:1,fillColor:!1,radius:2},bars:{show:It,fill:1,barWidth:It?this.getBarWidth()/1.5:1,zero:!1,lineWidth:rn},shadowSize:0},xaxis:{timezone:Yt,show:!0,mode:"time",min:Dn,max:Vn,label:"Datetime",ticks:mn,timeformat:Wt(mn,Dn,Vn),tickFormatter:Nt},yaxes:_n,grid:{minBorderMargin:0,markings:[],backgroundColor:null,borderWidth:0,hoverable:!0,clickable:!0,color:"#a1a1a1",margin:{left:0,right:0},labelMarginX:0,mouseActiveRadius:30},selection:{mode:En?"x":null,color:"#666"},crosshair:{mode:"x"}};try{Lr().plot(this.element,Dt.filter(as=>as.isVisible),Gt)}catch(as){throw console.error("Graph rendering error",as,Gt,Dt),new Error("Error rendering panel")}}render(){const{ariaLabel:yt,height:Dt,width:Lt,series:$t}=this.props,It=$t.length===0,_t=this.renderTooltip(),Jt=this.renderContextMenu();return(0,r.jsxs)("div",{className:"graph-panel","aria-label":yt,children:[(0,r.jsx)("div",{className:"graph-panel__chart",ref:rn=>this.element=rn,style:{height:Dt,width:Lt},onMouseLeave:()=>{this.setState({isTooltipVisible:!1})}}),It&&(0,r.jsx)("div",{className:"datapoints-warning",children:"No data"}),_t,Jt]})}}const Xn=null,ds=(ut,yt=!1,Dt=!1)=>{const Lt=ut.reduce((It,_t)=>It+(_t[1]||0),0)===0,$t=!ut.reduce((It,_t)=>It&&_t[1]!==null,!0);return yt&&$t||Dt&&Lt},$n=ut=>{const{series:yt,timeRange:Dt,width:Lt,height:$t,showBars:It,showLines:_t,showPoints:Jt,sortLegendBy:rn,sortLegendDesc:Yt,legendDisplayMode:En,legendVisibility:mn,placement:Dn,onSeriesToggle:Vn,onToggleSort:_n,hideEmpty:Gt,hideZero:as,isStacked:Qs,lineWidth:Fs,onHorizontalRegionSelected:oa,timeZone:Zs,children:ua,ariaLabel:Yn}=ut,{graphContainer:vn,wrapper:ms,legendContainer:Ln}=(0,T.of)(is,ut.placement),bs=yt.reduce((Ps,Ts)=>ds(Ts.data,Gt,as)?Ps:Ps.concat([{label:Ts.label,color:Ts.color||"",disabled:!Ts.isVisible,yAxis:Ts.yAxis.index,getDisplayValues:()=>Ts.info||[]}]),[]);return(0,r.jsxs)("div",{className:ms,"aria-label":Yn,children:[(0,r.jsx)("div",{className:vn,children:(0,r.jsx)(jn,{series:yt,timeRange:Dt,timeZone:Zs,showLines:_t,showPoints:Jt,showBars:It,width:Lt,height:$t,isStacked:Qs,lineWidth:Fs,onHorizontalRegionSelected:oa,children:ua})}),mn&&(0,r.jsx)("div",{className:Ln,children:(0,r.jsx)(v.E,{hideHorizontalTrack:!0,children:(0,r.jsx)(Rt.t,{items:bs,displayMode:En,placement:Dn,sortBy:rn,sortDesc:Yt,onLabelClick:(Ps,Ts)=>{Vn&&Vn(Ps.label,Ts)},onToggleSort:_n})})})]})},is=(ut,yt)=>({wrapper:(0,C.css)({display:"flex",flexDirection:yt==="bottom"?"column":"row"}),graphContainer:(0,C.css)({minHeight:"65%",flexGrow:1}),legendContainer:(0,C.css)({padding:"10px 0",maxHeight:yt==="bottom"?"35%":"none"})});var gs=e(64423),ss=e(99165),us=e(85200),ps=e(1173),Is=e(11261),ns=e(69129),Bs=e(26272),Js=e(16895),ws=e(73060);const Ws={threshold:(ut,yt,Dt)=>ut+Dt,midpoint:(ut,yt,Dt)=>(ut+yt)/2,plusone:(ut,yt,Dt)=>ut+1};function Ls(ut){if(ut.frame.length===0)return ut.frame;let yt=!0,{frame:Dt,refFieldName:Lt,refFieldPseudoMax:$t,refFieldPseudoMin:It,insertMode:_t}=ut;_t||(_t=Ws.threshold);const Jt=Ei(Dt,Lt);if(Jt==null)return Dt;Jt.state={...Jt.state,nullThresholdApplied:!0};const rn=Dt.fields.map(En=>En.config.custom?.insertNulls||Jt.config.interval||null),Yt=new Set(rn);if(Yt.delete(null),Yt.size===0)return Dt;if(Yt.size===1){const En=Yt.values().next().value;if(En<=0)return Dt;const mn=Jt.values,Dn=Dt.fields.map(_n=>_n.values),Vn=Ia(mn,Dn,En,It,$t,_t,yt);return Vn===Dn?Dt:{...Dt,length:Vn[0].length,fields:Dt.fields.map((_n,Gt)=>({..._n,values:Vn[Gt]}))}}return Dt}function Ia(ut,yt,Dt,Lt=null,$t=null,It,_t){const Jt=ut.length,rn=[];if(Lt!=null&&Lt<ut[0]){let Dn=Math.ceil((ut[0]-Lt)/Dt),Vn=ut[0]-Dn*Dt;for(;Vn<ut[0];)rn.push(It(Vn-Dt,Vn,Dt)),Vn+=Dt}rn.push(ut[0]);let Yt=ut[0];for(let Dn=1;Dn<Jt;Dn++){const Vn=ut[Dn];for(;Vn-Yt>Dt&&(rn.push(It(Yt,Vn,Dt)),Yt+=Dt,!!_t););rn.push(Vn),Yt=Vn}if($t!=null&&$t>Yt)for(;Yt+Dt<$t;)rn.push(It(Yt,$t,Dt)),Yt+=Dt;const En=rn.length;if(En===Jt)return yt;const mn=[];for(let Dn of yt){let Vn;if(Dn!==ut){Vn=Array(En);for(let _n=0,Gt=0;_n<En;_n++)Vn[_n]=ut[Gt]===rn[_n]?Dn[Gt++]:null}else Vn=rn;mn.push(Vn)}return mn}function jr(ut,yt,Dt){let Lt,$t;for(let It=0;It<yt.length;It++)if(yt[It]==null)$t==null&&Lt!=null&&($t=It);else{if($t!=null){if(ut[It]-Lt<Dt)for(;$t<It;)yt[$t++]=void 0;$t=null}Lt=ut[It]}return yt}function qr(ut){return ut.type===Is.PU.number&&ut.config.custom?.drawStyle===ts.GR.Bars&&!ut.config.custom?.hideFrom?.viz}function Ei(ut,yt){return ut.fields.find(Dt=>yt!=null?Dt.name===yt:Dt.type===Is.PU.time)}function Br(ut,yt){const Dt=Ei(ut,yt);let Lt=Dt?.values;for(let $t=0;$t<ut.fields.length;$t++){let It=ut.fields[$t];if(It===Dt||qr(It))continue;let _t=It.config.custom?.spanNulls;typeof _t=="number"&&_t!==-1&&Lt&&(It.values=jr(Lt,It.values,_t))}return ut}function Pi(ut,yt,Dt){let Lt;e:for(let Jt of ut)for(let rn of Jt.fields)if(yt.x(rn,Jt,ut)){Lt=rn;break e}ut=ut.map(Jt=>Lt?.state?.nullThresholdApplied?Jt:Ls({frame:Jt,refFieldName:Lt.name,refFieldPseudoMin:Dt?.from.valueOf(),refFieldPseudoMax:Dt?.to.valueOf()}));let $t=0;ut.forEach(Jt=>{Jt.fields.forEach(rn=>{qr(rn)&&(rn.config.custom={...rn.config.custom,spanNulls:-1},$t++)})});let It=1/0;$t>1&&ut.forEach(Jt=>{if(!Jt.fields.some(qr))return;const rn=Lt.values;for(let Yt=0;Yt<rn.length;Yt++)Yt>0&&(It=Math.min(It,rn[Yt]-rn[Yt-1]))});let _t=(0,ws.Fd)({frames:ut,joinBy:yt.x,keep:yt.y,keepOriginIndices:!0});return _t?(_t=Br(_t,Lt.name),It!==1/0&&(_t.fields.forEach((Jt,rn)=>{let Yt=Jt.values;if(rn===0){let En=Yt[Yt.length-1];Yt.push(En+It,En+2*It)}else qr(Jt)?Yt.push(null,null):Yt.push(void 0,void 0)}),_t.length+=2),_t):null}function Di(ut,yt){const Dt="na",Lt=`${ut.min!==void 0?ut.min:Dt}-${ut.max!==void 0?ut.max:Dt}`,$t=`${ut.custom?.axisSoftMin!==void 0?ut.custom.axisSoftMin:Dt}-${ut.custom?.axisSoftMax!==void 0?ut.custom.axisSoftMax:Dt}`,It=`${ut.custom?.axisPlacement!==void 0?ut.custom?.axisPlacement:ts.vM.Auto}`,_t=ut.unit??Rr.s,Jt=ut.custom?.scaleDistribution?Ji(ut.custom.scaleDistribution):ts.L4.Linear,rn=ut.custom?.axisLabel?ut.custom.axisLabel:Dt;return`${_t}/${Lt}/${$t}/${It}/${Jt}/${rn}/${yt}`}function Ji(ut){return ut.type===ts.L4.Log?`${ut.type}${ut.log}`:ut.type}function Xi(ut,yt,Dt=[]){for(const Lt of Dt)if(typeof Lt=="function"){if(!Lt(ut,yt))return!1}else if(yt[Lt]!==ut[Lt])return!1;return!0}class ei extends c.Component{constructor(yt){super(yt),this.panelContext={},this.subscription=new gs.yU,this.getTimeRange=()=>this.props.timeRange;let Dt=this.prepState(yt);Dt.alignedData=Dt.config.prepData([Dt.alignedFrame]),this.state=Dt,this.plotInstance=c.createRef()}static{this.contextType=gn.e4}prepState(yt,Dt=!0){let Lt=null;const{frames:$t,fields:It,preparePlotFrame:_t}=yt,rn=(_t||Pi)($t,It||{x:us.sJ.get(ps.Ct.firstTimeField).get({}),y:us.sJ.get(ps.Ct.byTypes).get(new Set([Is.PU.number,Is.PU.enum]))},yt.timeRange);if((0,Js.uY)("GraphNG",!1,"data aligned",rn),rn){let Yt=this.state?.config;Dt&&(Yt=yt.prepConfig(rn,this.props.frames,this.getTimeRange),(0,Js.uY)("GraphNG",!1,"config prepared",Yt)),Lt={alignedFrame:rn,config:Yt},(0,Js.uY)("GraphNG",!1,"data prepared",Lt.alignedData)}return Lt}handleCursorUpdate(yt){const Dt=yt.payload?.point?.time,Lt=this.plotInstance.current;if(Lt&&Dt){const $t=Lt.valToPos(Dt,"x");let It;if($t&&(It=(0,Js.sw)(Lt,Lt.posToIdx($t))),!It||!$t)return;Lt.setCursor({left:$t,top:It})}}componentDidMount(){this.panelContext=this.context;const{eventBus:yt}=this.panelContext;this.subscription.add(yt.getStream(ns.b_).pipe((0,ss.c)(50)).subscribe({next:Dt=>{yt!==Dt.origin&&this.handleCursorUpdate(Dt)}})),this.subscription.add(yt.getStream(Bs.kb).pipe((0,ss.c)(50)).subscribe({next:Dt=>this.handleCursorUpdate(Dt)})),this.subscription.add(yt.getStream(ns.ql).pipe((0,ss.c)(50)).subscribe({next:()=>{const Dt=this.plotInstance?.current;Dt&&!Dt.cursor._lock&&Dt.setCursor({left:-10,top:-10})}}))}componentDidUpdate(yt){const{frames:Dt,structureRev:Lt,timeZone:$t,propsToDiff:It}=this.props,_t=!Xi(yt,this.props,It);if(Dt!==yt.frames||_t||$t!==yt.timeZone){let Jt=this.prepState(this.props,!1);Jt&&((this.state.config===void 0||$t!==yt.timeZone||Lt!==yt.structureRev||!Lt||_t)&&(Jt.config=this.props.prepConfig(Jt.alignedFrame,this.props.frames,this.getTimeRange),(0,Js.uY)("GraphNG",!1,"config recreated",Jt.config)),Jt.alignedData=Jt.config.prepData([Jt.alignedFrame]),this.setState(Jt))}}componentWillUnmount(){this.subscription.unsubscribe()}render(){const{width:yt,height:Dt,children:Lt,renderLegend:$t}=this.props,{config:It,alignedFrame:_t,alignedData:Jt}=this.state;return It?(0,r.jsx)(Nn.KU,{width:yt,height:Dt,legend:$t(It),children:(rn,Yt)=>(0,r.jsx)(Yr.Z,{config:It,data:Jt,width:rn,height:Yt,plotRef:En=>this.plotInstance.current=En,children:Lt?Lt(It,_t):null})}):null}}var eo=e(36613),Hs=e(57875),to=e(8066),Ha=e(24293),no=e(94624),ti=e(74863);const Ci=new Set(["bytes","bits","kbytes","mbytes","gbytes","tbytes","pbytes","binBps","binbps","KiBs","Kibits","MiBs","Mibits","GiBs","Gibits","TiBs","Tibits","PiBs","Pibits"]),ni=Array(53);for(let ut=0;ut<ni.length;ut++)ni[ut]=2**ut;const bi=(ut,yt=1)=>ut==null?"-":ut.toFixed(yt),Zi={drawStyle:ts.GR.Line,showPoints:ts.yL.Auto,axisPlacement:ts.vM.Auto},qi=({frame:ut,theme:yt,timeZones:Dt,getTimeRange:Lt,sync:$t,allFrames:It,renderers:_t,tweakScale:Jt=Yt=>Yt,tweakAxis:rn=Yt=>Yt})=>{const Yt="__global_",En=new Za.e(Dt[0]);let mn;En.setPrepData(Yn=>(mn=Yn[0],(0,Js.bq)(Yn[0],En.getStackingGroups())));const Dn=ut.fields[0];if(!Dn)return En;const Vn="x";let _n="";const Gt=Dn.config.custom?.axisPlacement!==ts.vM.Hidden?ts.vM.Bottom:ts.vM.Hidden,as=Dn.config.custom?.axisPlacement!==ts.vM.Hidden;if(Dn.type===Is.PU.time){En.addScale({scaleKey:Vn,orientation:ts.Lt.Horizontal,direction:ts.ON.Right,isTime:!0,range:()=>{const vn=Lt();return[vn.from.valueOf(),vn.to.valueOf()]}});const Yn=Dt.length>1?(vn,ms)=>ms.map((Ln,bs)=>bs<2?null:Ln):void 0;for(let vn=0;vn<Dt.length;vn++){const ms=Dt[vn];En.addAxis({scaleKey:Vn,isTime:!0,placement:Gt,show:as,label:Dn.config.custom?.axisLabel,timeZone:ms,theme:yt,grid:{show:vn===0&&Dn.config.custom?.axisGridShow},filter:Yn})}Dt.length>1&&En.addHook("drawAxes",vn=>{vn.ctx.save(),vn.ctx.fillStyle=yt.colors.text.primary,vn.ctx.textAlign="left",vn.ctx.textBaseline="bottom";let ms=0;vn.axes.forEach(Ln=>{if(Ln.side===2){let bs=Ln._pos+Ln._size;vn.ctx.fillText(Dt[ms],vn.bbox.left,bs*eo.A.pxRatio),ms++}}),vn.ctx.restore()})}else En.addScale({scaleKey:Vn,orientation:ts.Lt.Horizontal,direction:ts.ON.Right,range:(Yn,vn,ms)=>[Dn.config.min??vn,Dn.config.max??ms]}),En.addAxis({scaleKey:Vn,placement:Gt,show:as,label:Dn.config.custom?.axisLabel,theme:yt,grid:{show:Dn.config.custom?.axisGridShow},formatValue:(Yn,vn)=>(0,xa.cN)(Dn.display(Yn,vn))});let Qs=_t?.flatMap(Yn=>Object.values(Yn.fieldMap).filter(vn=>Yn.indicesOnly.indexOf(vn)===-1))??[],Fs;for(let Yn=1;Yn<ut.fields.length;Yn++){const vn=ut.fields[Yn],ms={...vn.config,custom:{...Zi,...vn.config.custom}},Ln=ms.custom;if(vn===Dn||vn.type!==Is.PU.number&&vn.type!==Is.PU.enum)continue;let bs=vn.display??bi;vn.config.custom?.stacking?.mode===ts.gs.Percent&&(bs=(0,Hs.J)({field:{...vn,config:{...vn.config,unit:"percentunit"}},theme:yt}));const Ps=Di(ms,vn.type),Ts=(0,to.Qi)(vn),Us=(0,to.lz)(vn,yt).color;if(En.addScale(Jt({scaleKey:Ps,orientation:ts.Lt.Vertical,direction:ts.ON.Up,distribution:Ln.scaleDistribution?.type,log:Ln.scaleDistribution?.log,linearThreshold:Ln.scaleDistribution?.linearThreshold,min:vn.config.min,max:vn.config.max,softMin:Ln.axisSoftMin,softMax:Ln.axisSoftMax,centeredZero:Ln.axisCenteredZero,range:Ln.stacking?.mode===ts.gs.Percent?(ls,Ea,Es)=>(Ea=Ea<0?-1:0,Es=Es>0?1:0,[Ea,Es]):vn.type===Is.PU.enum?(ls,Ea,Es)=>[-1,vn.config.type.enum.text.length]:void 0,decimals:vn.config.decimals},vn)),_n||(_n=Ps),Ln.axisPlacement!==ts.vM.Hidden){let ls;Ln.axisColorMode===ts.Y$.Series&&(Ts.isByValue&&vn.config.custom?.gradientMode===ts.on.Scheme&&Ts.id===Ha.Y.Thresholds?ls=(0,ti.pl)(1,yt,Ts,vn.config.thresholds):ls=Us);const Ea={border:{show:Ln.axisBorderShow||!1,width:1/devicePixelRatio,stroke:ls||yt.colors.text.primary},ticks:{show:Ln.axisBorderShow||!1,stroke:ls||yt.colors.text.primary},color:ls||yt.colors.text.primary};let Es,ks,qs;if(Ci.has(ms.unit))Es=ni;else if(vn.type===Is.PU.enum){let fa=vn.config.type.enum.text;qs=fa.map((Pa,Da)=>Da),ks=fa}En.addAxis(rn({scaleKey:Ps,label:Ln.axisLabel,size:Ln.axisWidth,placement:Ln.axisPlacement??ts.vM.Auto,formatValue:(fa,Pa)=>(0,xa.cN)(bs(fa,Pa)),theme:yt,grid:{show:Ln.axisGridShow},decimals:vn.config.decimals,distr:Ln.scaleDistribution?.type,splits:qs,values:ks,incrs:Es,...Ea},vn))}const zs=Ln.drawStyle===ts.GR.Points?ts.yL.Always:Ln.showPoints;let ma=()=>null;Ln.spanNulls!==!0&&(ma=(ls,Ea,Es,ks)=>{let qs=[],fa=ls.series[Ea];if(!Es&&ks&&ks.length){const[Pa,Da]=fa.idxs,La=ls.data[0],pr=ls.data[Ea],er=Math.round(ls.valToPos(La[Pa],"x",!0)),ja=Math.round(ls.valToPos(La[Da],"x",!0));ks[0][0]===er&&qs.push(Pa);for(let Ba=0;Ba<ks.length;Ba++){let ro=ks[Ba],Ri=ks[Ba+1];if(Ri&&ro[1]===Ri[0]){let tr=ls.posToIdx(ro[1],!0);if(pr[tr]==null)for(let mr=1;mr<100;mr++){if(pr[tr+mr]!=null){tr+=mr;break}if(pr[tr-mr]!=null){tr-=mr;break}}qs.push(tr)}}ks[ks.length-1][1]===ja&&qs.push(Da)}return qs.length?qs:null});let{fillOpacity:ha}=Ln,Sa=null,Pn=null;if(vn.state?.origin){Fs||(Fs=Ti(ut,It));const ls=It[vn.state.origin.frameIndex],Ea=ls?.fields[vn.state.origin.fieldIndex],Es=(0,ke.Ct)(Ea??vn,ls,It);if(Qs.indexOf(Es)>=0)Sa=()=>null,Pn=()=>{};else if(Ln.transform===ts.NU.Constant){const ks=eo.A.paths.linear();Sa=(qs,fa)=>{const Pa=qs._data,Da=Lt();let La=[Da.from.valueOf(),Da.to.valueOf()],pr=Pa[fa].find(Ba=>Ba!=null),er=[pr,pr],ja=Pa.slice();return ja[0]=La,ja[fa]=er,ks({...qs,_data:ja},fa,0,1)}}if(Ln.fillBelowTo){const ks=ut.fields.find(Da=>Ln.fillBelowTo===Da.name||Ln.fillBelowTo===Da.config?.displayNameFromDS||Ln.fillBelowTo===(0,ke.Ct)(Da,ut,It)),qs=ks?(0,ke.Ct)(ks,ut,It):Ln.fillBelowTo,fa=Fs.get(Es),Pa=Fs.get(qs);(0,K.isNumber)(Pa)&&(0,K.isNumber)(fa)?(En.addBand({series:[fa,Pa],fill:void 0}),ha||(ha=35)):ha=0}}let gr;Ts.id===Ha.Y.Thresholds&&(gr=ls=>(0,to.lz)(mn.fields[ls],yt).color),En.addSeries({pathBuilder:Sa,pointsBuilder:Pn,scaleKey:Ps,showPoints:zs,pointsFilter:ma,colorMode:Ts,fillOpacity:ha,theme:yt,dynamicSeriesColor:gr,drawStyle:Ln.drawStyle,lineColor:Ln.lineColor??Us,lineWidth:Ln.lineWidth,lineInterpolation:Ln.lineInterpolation,lineStyle:Ln.lineStyle,barAlignment:Ln.barAlignment,barWidthFactor:Ln.barWidthFactor,barMaxWidth:Ln.barMaxWidth,pointSize:Ln.pointSize,spanNulls:Ln.spanNulls||!1,show:!Ln.hideFrom?.viz,gradientMode:Ln.gradientMode,thresholds:ms.thresholds,hardMin:vn.config.min,hardMax:vn.config.max,softMin:Ln.axisSoftMin,softMax:Ln.axisSoftMax,dataFrameFieldIndex:vn.state?.origin}),Ln.thresholdsStyle&&ms.thresholds&&(Ln.thresholdsStyle.mode??ts.Ly.Off)!==ts.Ly.Off&&En.addThresholds({config:Ln.thresholdsStyle,thresholds:ms.thresholds,scaleKey:Ps,theme:yt,hardMin:vn.config.min,hardMax:vn.config.max,softMin:Ln.axisSoftMin,softMax:Ln.axisSoftMax})}let oa=(0,Js.ro)(ut);En.setStackingGroups(oa),_t?.forEach(Yn=>{Fs||(Fs=Ti(ut,It));let vn={};for(let ms in Yn.fieldMap){let Ln=Yn.fieldMap[ms];vn[ms]=Fs.get(Ln)}Yn.init(En,vn)}),En.scaleKeys=[Vn,_n];const Zs=15;let ua={dataIdx:(Yn,vn,ms,Ln)=>{let bs=Yn.data[vn];if(bs[ms]==null){let Ps=null,Ts=null,Ds;for(Ds=ms;Ps==null&&Ds-- >0;)bs[Ds]!=null&&(Ps=Ds);for(Ds=ms;Ts==null&&Ds++<bs.length;)bs[Ds]!=null&&(Ts=Ds);let Us=Yn.data[0],zs=Yn.valToPos(Ln,"x"),ma=Ts==null?1/0:Yn.valToPos(Us[Ts],"x"),ha=Ps==null?-1/0:Yn.valToPos(Us[Ps],"x"),Sa=zs-ha,Pn=ma-zs;Sa<=Pn?Sa<=Zs&&(ms=Ps):Pn<=Zs&&(ms=Ts)}return ms}};return $t&&$t()!==no.y.Off&&(ua.sync={key:Yt,scales:[Vn,null]}),En.setCursor(ua),En};function Ti(ut,yt){const Dt=new Map;return ut.fields.forEach((Lt,$t)=>{const It=Lt.state?.origin;if(It){const _t=yt[It.frameIndex]?.fields[It.fieldIndex];_t&&Dt.set((0,ke.Ct)(_t,yt[It.frameIndex],yt),$t)}}),Dt}const so=["legend","options","theme"];class Ur extends c.Component{constructor(){super(...arguments),this.prepConfig=(yt,Dt,Lt)=>{const{sync:$t}=this.context,{theme:It,timeZone:_t,renderers:Jt,tweakAxis:rn,tweakScale:Yt}=this.props;return qi({frame:yt,theme:It,timeZones:Array.isArray(_t)?_t:[_t],getTimeRange:Lt,sync:$t,allFrames:Dt,renderers:Jt,tweakScale:Yt,tweakAxis:rn})},this.renderLegend=yt=>{const{legend:Dt,frames:Lt}=this.props;return!yt||Dt&&!Dt.showLegend||!(0,Or.t)(yt,Lt)?null:(0,r.jsx)(Or.$,{data:Lt,config:yt,...Dt})}}static{this.contextType=gn.e4}render(){return(0,r.jsx)(ei,{...this.props,prepConfig:this.prepConfig,propsToDiff:so,renderLegend:this.renderLegend})}}const Mi=(0,T.cV)(Ur);Mi.displayName="TimeSeries";const Si=(0,c.createContext)({}),Oi=()=>{const{data:ut,dimFields:yt,mapSeriesIndexToDataFrameFieldIndex:Dt}=(0,c.useContext)(Si),Lt=(0,c.useCallback)(()=>{const $t=yt.x;let It=null;for(let _t=0;_t<ut.fields.length;_t++)if($t(ut.fields[_t],ut,[ut])){It=ut.fields[_t];break}return It},[ut,yt]);return{dimFields:yt,mapSeriesIndexToDataFrameFieldIndex:Dt,getXAxisField:Lt,alignedData:ut}},Ai=5,si=ut=>ut!=null&&!ut.ctrlKey&&!ut.metaKey,el=({onZoom:ut,config:yt,withZoomY:Dt=!1})=>((0,c.useLayoutEffect)(()=>{let Lt=!1,$t=!1;Dt&&yt.addHook("init",It=>{It.over.addEventListener("mousedown",_t=>{if(si(_t)&&_t.button===0&&_t.shiftKey){$t=!0,It.cursor.drag.x=!1,It.cursor.drag.y=!0;let Jt=rn=>{It.cursor.drag.x=!0,It.cursor.drag.y=!1,document.removeEventListener("mouseup",Jt,!0)};document.addEventListener("mouseup",Jt,!0)}},!0)}),yt.addHook("setSelect",It=>{const _t=It.scales.x.ori===0;if(si(It.cursor.event)){if(Dt&&$t){if(It.select.height>=Ai){for(let Jt in It.scales)if(Jt!=="x"){const rn=_t?It.posToVal(It.select.top,Jt):It.posToVal(It.select.left+It.select.width,Jt),Yt=_t?It.posToVal(It.select.top+It.select.height,Jt):It.posToVal(It.select.left,Jt);It.setScale(Jt,{min:Yt,max:rn})}Lt=!0}$t=!1}else if(It.select.width>=Ai){const Jt=_t?It.posToVal(It.select.left,"x"):It.posToVal(It.select.top+It.select.height,"x"),rn=_t?It.posToVal(It.select.left+It.select.width,"x"):It.posToVal(It.select.top,"x");ut({from:Jt,to:rn}),Lt=!1}}It.setSelect({left:0,width:0,top:0,height:0},!1)}),yt.setCursor({bind:{dblclick:It=>()=>{if(!si(It.cursor.event))return null;if(Dt&&Lt){for(let _t in It.scales)_t!=="x"&&It.setScale(_t,{min:null,max:null});Lt=!1}else{let _t=It.scales.x;const Jt=_t.min,rn=_t.max,Yt=(rn-Jt)/2;ut({from:Jt-Yt,to:rn+Yt})}return null}}})},[yt,ut,Dt]),null);var tl=e(1604),Gs=e(14588);const Ra=10,ao=({mode:ut=ts.$N.Single,sortOrder:yt=ts.xB.None,sync:Dt,timeZone:Lt,config:$t,renderTooltip:It,..._t})=>{const Jt=(0,c.useRef)(),rn=(0,T.$j)(),[Yt,En]=(0,c.useState)(null),[mn,Dn]=(0,c.useState)(null),[Vn,_n]=(0,c.useState)([]),[Gt,as]=(0,c.useState)(null),[Qs,Fs]=(0,c.useState)(!1),oa=(0,tl.A)();let Zs=null;const ua=(0,T.of)(da);if((0,c.useLayoutEffect)(()=>{let bs;const Ps=()=>{oa()&&(Fs(!0),Jt.current?.root.classList.add("plot-active"))},Ts=()=>{oa()&&(as(null),Fs(!1),Jt.current?.root.classList.remove("plot-active"))};return $t.addHook("syncRect",(Ds,Us)=>bs=Us),$t.addHook("init",Ds=>{Jt.current=Ds,Ds.over.addEventListener("mouseenter",Ps),Ds.over.addEventListener("mouseleave",Ts),Zs=Ds.root.closest("[tabindex]"),Zs&&(Zs.addEventListener("focus",Ps),Zs.addEventListener("blur",Ts)),Dt&&Dt()===no.y.Crosshair&&Ds.root.classList.add("shared-crosshair")}),$t.addHook("setLegend",Ds=>{oa()&&(Dn(Ds.legend.idx),_n(Ds.legend.idxs.slice()))}),$t.addHook("setCursor",Ds=>{if(!bs||!oa())return;const{x:Us,y:zs}=Xs(Ds,bs);as(Us!==void 0&&zs!==void 0?{x:Us,y:zs}:null)}),$t.addHook("setSeries",(Ds,Us)=>{oa()&&En(Us)}),()=>{as(null),Jt.current&&(Jt.current.over.removeEventListener("mouseleave",Ts),Jt.current.over.removeEventListener("mouseenter",Ps),Zs&&(Zs.removeEventListener("focus",Ps),Zs.removeEventListener("blur",Ts)))}},[$t,as,Fs,Dn,_n]),mn===null||!Qs&&Dt&&Dt()===no.y.Crosshair)return null;let Yn=_t.data.fields[0];if(!Yn)return null;const vn=Yn.display||(0,Hs.J)({field:Yn,timeZone:Lt,theme:rn});let ms=null,Ln=vn(Yn.values[mn]).text;if(It)ms=It(_t.data,Yt,mn);else{if(ut===ts.$N.Single&&Yt!==null){const bs=_t.data.fields[Yt];if(!bs)return null;const Ps=Vn?.[Yt]??mn;Ln=vn(Yn.values[Ps]).text;const Ds=(bs.display||(0,Hs.J)({field:bs,timeZone:Lt,theme:rn}))(bs.values[Ps]);ms=(0,r.jsx)(St.o,{series:[{color:Ds.color||Ha.F,label:(0,ke.Ct)(bs,_t.data,_t.frames),value:Ds?(0,xa.cN)(Ds):null}],timestamp:Ln})}if(ut===ts.$N.Multi){let bs=[];const Ps=_t.data,Ts=Ps.fields,Ds=[];for(let Us=0;Us<Ts.length;Us++){const zs=Ps.fields[Us];if(!zs||zs===Yn||zs.type===Is.PU.time||zs.type!==Is.PU.number||zs.config.custom?.hideFrom?.tooltip||zs.config.custom?.hideFrom?.viz)continue;const ma=_t.data.fields[Us].values[Vn[Us]],ha=zs.display(ma);Ds.push(ma),bs.push({color:ha.color||Ha.F,label:(0,ke.Ct)(zs,Ps,_t.frames),value:ha?(0,xa.cN)(ha):null,isActive:Yt===Us})}if(yt!==ts.xB.None){const Us=[...bs],zs=Gs.sortValues(yt);bs.sort((ma,ha)=>{const Sa=Us.indexOf(ma),Pn=Us.indexOf(ha);return zs(Ds[Sa],Ds[Pn])})}ms=(0,r.jsx)(St.o,{series:bs,timestamp:Ln})}}return(0,r.jsx)(te.ZL,{className:Qs?ua.tooltipWrapper:void 0,children:ms&&Gt&&(0,r.jsx)(xn.o,{position:{x:Gt.x,y:Gt.y},offset:{x:Ra,y:Ra},children:ms})})};function ai({left:ut,top:yt},Dt){return ut===void 0||yt===void 0?!1:ut<0||ut>Dt.width||yt<0||yt>Dt.height}function Xs(ut,yt){let Dt,Lt;const $t=ut.cursor.left||0,It=ut.cursor.top||0;if(ai(ut.cursor,yt)){const _t=ut.posToIdx($t);if(It<0||It>yt.height){let Jt=(0,Js.sw)(ut,_t);Jt&&(Lt=yt.top+Jt,$t>=0&&$t<=yt.width&&(Dt=yt.left+ut.valToPos(ut.data[0][ut.posToIdx($t)],ut.series[0].scale)))}}else Dt=yt.left+$t,Lt=yt.top+It;return{x:Dt,y:Lt}}const da=ut=>({tooltipWrapper:(0,C.css)({"z-index":ut.zIndex.portal+1+" !important"})}),Ii={SecretFormField:H.L,FormField:t.z,Select:j,AsyncSelect:B,IndicatorsContainer:g,NoOptionsMessage:l,Input:n.p,Switch:U}},81297:(_,L,e)=>{"use strict";e.d(L,{Z:()=>d});var t=e(74848),n=e(96540),r=e(36613),s=e(16895),a=e(7650);function g(o,u){return u.width===o.width&&u.height===o.height}function i(o,u){return u.data===o.data}function l(o,u){return u.config===o.config}class d extends n.Component{constructor(u){super(u),this.plotContainer=(0,n.createRef)(),this.plotCanvasBBox=(0,n.createRef)(),this.state={plot:null}}reinitPlot(){let{width:u,height:c,plotRef:p}=this.props;if(this.state.plot?.destroy(),u===0&&c===0)return;this.props.config.addHook("setSize",f=>{f.over});const h={width:Math.floor(this.props.width),height:Math.floor(this.props.height),...this.props.config.getConfig()};(0,s.uY)("UPlot",!1,"Reinitializing plot",h);const y=new r.A(h,this.props.data,this.plotContainer.current);p&&p(y),this.setState({plot:y})}componentDidMount(){this.reinitPlot()}componentWillUnmount(){this.state.plot?.destroy()}componentDidUpdate(u){let{plot:c}=this.state;g(u,this.props)?l(u,this.props)?i(u,this.props)||c?.setData(this.props.data):this.reinitPlot():c?.setSize({width:Math.floor(this.props.width),height:Math.floor(this.props.height)})}render(){return(0,t.jsxs)("div",{style:{position:"relative"},children:[(0,t.jsx)("div",{ref:this.plotContainer,"data-testid":"uplot-main-div"}),this.props.children]})}}},24182:(_,L,e)=>{"use strict";e.d(L,{$:()=>u,t:()=>o});var t=e(74848),n=e(96540),r=e(28240),s=e(8066),a=e(52622),g=e(40845),i=e(67266),l=e(96516),d=e(16895);function o(c,p){return c.getSeries().some(h=>{const y=h.props.dataFrameFieldIndex;if(!y)return!1;const f=p[y.frameIndex]?.fields[y.fieldIndex];return!(!f||f.config.custom?.hideFrom?.legend)})}const u=(0,n.memo)(({data:c,config:p,placement:h,calcs:y,displayMode:f,...v})=>{const P=(0,g.$j)(),m=p.getSeries().map(D=>{const x=D.props,E=x.dataFrameFieldIndex,C=p.getAxisPlacement(D.props.scaleKey);if(!E)return;const b=c[E.frameIndex]?.fields[E.fieldIndex];if(!b||b.config.custom?.hideFrom?.legend)return;const T=(0,r.Ct)(b,c[E.frameIndex],c),R=(0,s.lz)(b,P).color;return{disabled:!(x.show??!0),fieldIndex:E,color:R,label:T,yAxis:C===a.vM.Left||C===a.vM.Bottom?1:2,getDisplayValues:()=>(0,d.UO)(y,b,P),getItemKey:()=>`${T}-${E.frameIndex}-${E.fieldIndex}`,lineStyle:x.lineStyle}}).filter(D=>D!==void 0);return(0,t.jsx)(i.KU.Legend,{placement:h,...v,children:(0,t.jsx)(l.t,{placement:h,items:m,displayMode:f,sortBy:v.sortBy,sortDesc:v.sortDesc,isSortable:!0})})});u.displayName="PlotLegend"},52198:(_,L,e)=>{"use strict";e.d(L,{t:()=>n});var t=e(52622);const n={drawStyle:[{label:"Lines",value:t.GR.Line},{label:"Bars",value:t.GR.Bars},{label:"Points",value:t.GR.Points}],lineInterpolation:[{description:"Linear",value:t.dx.Linear,icon:"gf-interpolation-linear"},{description:"Smooth",value:t.dx.Smooth,icon:"gf-interpolation-smooth"},{description:"Step before",value:t.dx.StepBefore,icon:"gf-interpolation-step-before"},{description:"Step after",value:t.dx.StepAfter,icon:"gf-interpolation-step-after"}],barAlignment:[{description:"Before",value:t.Nj.Before,icon:"gf-bar-alignment-before"},{description:"Center",value:t.Nj.Center,icon:"gf-bar-alignment-center"},{description:"After",value:t.Nj.After,icon:"gf-bar-alignment-after"}],showPoints:[{label:"Auto",value:t.yL.Auto,description:"Show points when the density is low"},{label:"Always",value:t.yL.Always},{label:"Never",value:t.yL.Never}],axisPlacement:[{label:"Auto",value:t.vM.Auto,description:"First field on the left, everything else on the right"},{label:"Left",value:t.vM.Left},{label:"Right",value:t.vM.Right},{label:"Hidden",value:t.vM.Hidden}],fillGradient:[{label:"None",value:t.on.None},{label:"Opacity",value:t.on.Opacity,description:"Enable fill opacity gradient"},{label:"Hue",value:t.on.Hue,description:"Small color hue gradient"},{label:"Scheme",value:t.on.Scheme,description:"Use color scheme to define gradient"}],stacking:[{label:"Off",value:t.gs.None},{label:"Normal",value:t.gs.Normal},{label:"100%",value:t.gs.Percent}],thresholdsDisplayModes:[{label:"Off",value:t.Ly.Off},{label:"As lines",value:t.Ly.Line},{label:"As lines (dashed)",value:t.Ly.Dashed},{label:"As filled regions",value:t.Ly.Area},{label:"As filled regions and lines",value:t.Ly.LineAndArea},{label:"As filled regions and lines (dashed)",value:t.Ly.DashedAndArea}]}},30501:(_,L,e)=>{"use strict";e.d(L,{Zj:()=>v,pi:()=>d,zH:()=>f});var t=e(83195),n=e(97706),r=e(42994),s=e(72724),a=e(52622),g=e(29413),i=e(52811),l=e(93060);const d=12,o=150,u=30,c=15,p=40,h=18,y=8;class f extends i.R{merge(C){this.props.size=(0,l.Y)("max",this.props.size,C.size),this.props.label||(this.props.label=C.label),this.props.placement===a.vM.Auto&&(this.props.placement=C.placement)}getConfig(){let{scaleKey:C,label:b,show:T=!0,placement:A=a.vM.Auto,grid:R={show:!0},ticks:S,space:O,filter:j,gap:B=5,formatValue:N,splits:I,values:K,incrs:w,isTime:U,timeZone:W,theme:H,tickLabelRotation:z,size:G,color:M,border:Q,decimals:Y,distr:q=a.L4.Linear}=this.props;const te=`${d}px ${H.typography.fontFamily}`,X=H.isDark?"rgba(240, 250, 255, 0.09)":"rgba(0, 10, 23, 0.09)";(0,t.j9)(C)&&(I=[0,1]),Y===0&&q===a.L4.Linear&&(j=(ne,Z)=>Z.map(ae=>Number.isInteger(ae)?ae:null));let ee={scale:C,show:T,stroke:M??H.colors.text.primary,side:x(A),font:te,size:G??((ne,Z,ae)=>D(ne,Z,ae)),rotate:z,gap:B,labelGap:0,grid:{show:R.show,stroke:X,width:1/devicePixelRatio},ticks:Object.assign({show:!0,stroke:Q?.show?M??H.colors.text.primary:X,width:1/devicePixelRatio,size:4},S),splits:I,values:K,space:O??((ne,Z,ae,re,se)=>m(ne,Z,ae,re,se,N)),filter:j,incrs:w};return Q?.show&&(ee.border={stroke:M??H.colors.text.primary,width:1/devicePixelRatio,...Q}),b!=null&&b.length>0&&(ee.label=b,ee.labelSize=d+y,ee.labelFont=te,ee.labelGap=y),K?ee.values=K:U?ee.values=P:N&&(ee.values=(ne,Z,ae,re,se)=>{let de=(0,n.E)((0,n.h)(se,6));return Z.map(le=>le==null?null:N(le,de>0?de:void 0))}),ee.timeZone=W,ee}}const v={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:28*24*60*60*1e3,year:365*24*60*60*1e3};function P(E,C,b,T,A){const R=E.axes[b],S="timeZone"in R&&typeof R.timeZone=="string"?R.timeZone:void 0,O=E.scales.x,j=(O?.max??0)-(O?.min??0),B=Math.round(v.year/v.day)*v.day,N=Math.round(A/v.day)*v.day;let I=r.WC.interval.year;return A<v.second?I=r.WC.interval.millisecond:A<=v.minute?I=r.WC.interval.second:j<=v.day?I=r.WC.interval.minute:A<=v.day?I=r.WC.interval.hour:j<v.year?I=r.WC.interval.day:N===B?I=r.WC.interval.year:A<=v.year&&(I=r.WC.interval.month),C.map(K=>K==null?"":(0,s.LE)(K,{format:I,timeZone:S}))}function m(E,C,b,T,A,R){const S=E.axes[C],O=E.scales[S.scale];if(S.side!==2||!O)return A<=o?c:u;const j=A/p,B=(T-b)/j,N=Math.max(Math.abs(b),Math.abs(T));let I="";if(O.time)I=P(E,[N],C,p,B)[0];else if(R!=null)I=R(N);else return p;return(0,g.kD)(I,d).width+h}function D(E,C,b){const T=E.axes[b];let A=T.ticks.size;if(T.side===2)A+=T.gap+d;else if(C?.length){let R=C.reduce((O,j)=>Math.max(O,(0,g.kD)(j,d).width),0);const S=Math.min(E.width*.4,R);A+=T.gap+T.labelGap+S}return Math.ceil(A)}function x(E){switch(E){case a.vM.Top:return 0;case a.vM.Right:return 1;case a.vM.Bottom:return 2;case a.vM.Left:}return 3}},51336:(_,L,e)=>{"use strict";e.d(L,{e:()=>D});var t=e(2543),n=e(36613),r=e(43127),s=e(91410),a=e(52622),g=e(16895),i=e(30501),l=e(93060),d=e(24293),o=e(23596),u=e(52811),c=e(74863);class p extends u.R{getConfig(){const{facets:E,drawStyle:C,pathBuilder:b,pointsBuilder:T,pointsFilter:A,lineInterpolation:R,lineWidth:S,lineStyle:O,barAlignment:j,barWidthFactor:B,barMaxWidth:N,showPoints:I,pointSize:K,scaleKey:w,pxAlign:U,spanNulls:W,show:H=!0}=this.props;let z={},G=this.getLineColor();z.stroke=G,z.width=S,O&&O.fill!=="solid"&&(O.fill==="dot"&&(z.cap="round"),z.dash=O.dash??[10,10]),b!=null?z.paths=b:C===a.GR.Points?z.paths=()=>null:C!=null&&(z.paths=(Y,q,te,X)=>y(C,R,j,B,N)(Y,q,te,X));const M=typeof G=="string"?G:(Y,q)=>Y.series[q]._stroke,Q={points:{stroke:M,fill:M,size:!K||K<S?void 0:K,filter:A}};return T!=null?Q.points.show=T:C===a.GR.Points?Q.points.show=!0:I===a.yL.Auto?C===a.GR.Bars&&(Q.points.show=!1):I===a.yL.Never?Q.points.show=!1:I===a.yL.Always&&(Q.points.show=!0),{scale:w,facets:E,spanGaps:typeof W=="number"?!1:W,value:()=>"",pxAlign:U,show:H,fill:this.getFill(),...z,...Q}}getLineColor(){const{lineColor:E,gradientMode:C,colorMode:b,thresholds:T,theme:A,hardMin:R,hardMax:S,softMin:O,softMax:j,dynamicSeriesColor:B}=this.props;return C===a.on.None&&B?(N,I)=>B(I)??E??d.F:C===a.on.Scheme&&b?.id!==d.Y.Fixed?(0,c.pl)(1,A,b,T,R,S,O,j):C===a.on.Hue?(0,c.B5)(E??d.F,1,A):E??d.F}getFill(){const{lineColor:E,fillColor:C,gradientMode:b,fillOpacity:T,colorMode:A,thresholds:R,theme:S,hardMin:O,hardMax:j,softMin:B,softMax:N,dynamicSeriesColor:I}=this.props;if(C)return C;const K=b??a.on.None,w=(T??0)/100;if(K===a.on.None&&I&&w>0)return(U,W)=>{let H=U.series[W]._stroke;return o.MV.alpha(H??"",w)};switch(K){case a.on.Opacity:return(0,c.WO)(C??E,w);case a.on.Hue:return(0,c.B5)(C??E,w,S);case a.on.Scheme:if(A?.id!==d.Y.Fixed)return(0,c.pl)(w,S,A,R,O,j,B,N);default:if(w>0)return o.MV.alpha(E??"",w)}}}let h;function y(x,E,C=a.Nj.Center,b=.6,T=200){const A=n.A.paths;if(h||(h={linear:A.linear(),smooth:A.spline(),stepBefore:A.stepped({align:-1}),stepAfter:A.stepped({align:1})}),x===a.GR.Bars){let R=`bars|${C}|${b}|${T}`;return h[R]||(h[R]=A.bars({size:[b,T],align:C})),h[R]}else if(x===a.GR.Line){if(E===a.dx.StepBefore)return h.stepBefore;if(E===a.dx.StepAfter)return h.stepAfter;if(E===a.dx.Smooth)return h.smooth}return h.linear}var f=e(84140),v=e(50082);function P(x){const E=x.config.mode===a.Ly.Dashed||x.config.mode===a.Ly.DashedAndArea?[10,10]:[];function C(I,K,w,U){let W=I.ctx,H=0;for(let z=0;z<w.length;z++)if(w[z].color==="transparent"){H=z;break}W.lineWidth=2,W.setLineDash(E);for(let z=1;z<w.length;z++){const G=w[z];let M;H>=z&&z>0?M=(0,f.A)(U.visualization.getColorByName(w[z-1].color)):M=(0,f.A)(U.visualization.getColorByName(G.color)),M.getAlpha()===1&&M.setAlpha(.7);const Q=I.scales.x.ori===a.Lt.Horizontal,Y=I.valToPos(G.value,K,!0);let q=Math.round(Q?I.bbox.left:Y),te=Math.round(Q?Y:I.bbox.top),X=Math.round(Q?I.bbox.left+I.bbox.width:Y),ee=Math.round(Q?Y:I.bbox.top+I.bbox.height);W.beginPath(),W.moveTo(q,te),W.lineTo(X,ee),W.strokeStyle=M.toString(),W.stroke()}}function b(I,K,w,U){let W=I.ctx,H=(0,c.Z8)(I,K,w.map(z=>{let G=(0,f.A)(U.visualization.getColorByName(z.color));return G.getAlpha()===1&&G.setAlpha(.15),[z.value,G.toString()]}),!0);W.fillStyle=H,W.fillRect(I.bbox.left,I.bbox.top,I.bbox.width,I.bbox.height)}const{scaleKey:T,thresholds:A,theme:R,config:S,hardMin:O,hardMax:j,softMin:B,softMax:N}=x;return I=>{const K=I.ctx,{min:w,max:U}=I.scales.x,{min:W,max:H}=I.scales[T];if(w==null||U==null||W==null||H==null)return;let{steps:z,mode:G}=A;if(G===v.O.Percentage){let[M,Q]=(0,c.EJ)(I,T,O,j,B,N),Y=Q-M;z=z.map(q=>({...q,value:M+Y*(q.value/100)}))}switch(K.save(),S.mode){case a.Ly.Line:case a.Ly.Dashed:C(I,T,z,R);break;case a.Ly.Area:b(I,T,z,R);break;case a.Ly.LineAndArea:case a.Ly.DashedAndArea:b(I,T,z,R),C(I,T,z,R)}K.restore()}}const m={drag:{setScale:!1},points:{size:(x,E)=>x.series[E].points.size*2,width:(x,E,C)=>C/4},focus:{prox:30}};class D{constructor(E=r.lE){this.uid=Math.random().toString(36).slice(2),this.series=[],this.axes={},this.scales=[],this.bands=[],this.stackingGroups=[],this.hasLeftAxis=!1,this.hooks={},this.tz=void 0,this.mode=1,this.frames=void 0,this.thresholds={},this.padding=void 0,this.prepData=void 0,this.scaleKeys=["",""],this.tzDate=C=>{let b=new Date(C);return this.tz?n.A.tzDate(b,this.tz):b},this.tz=(0,s.QZ)(E,Date.now())?.ianaName}addHook(E,C){(0,g.uY)("UPlotConfigBuilder",!1,"addHook",E),this.hooks[E]||(this.hooks[E]=[]),this.hooks[E].push(C)}addThresholds(E){this.thresholds[E.scaleKey]||(this.thresholds[E.scaleKey]=E,this.addHook("drawClear",P(E)))}addAxis(E){E.placement=E.placement??a.vM.Auto,E.grid=E.grid??{};let C=E.scaleKey;if(C==="x"&&(C+=E.timeZone??""),this.axes[C]){this.axes[C].merge(E);return}E.placement===a.vM.Auto&&(E.placement=this.hasLeftAxis?a.vM.Right:a.vM.Left),E.placement===a.vM.Left&&(this.hasLeftAxis=!0),E.placement===a.vM.Hidden&&(E.grid.show=!1,E.size=0),this.axes[C]=new i.zH(E)}getAxisPlacement(E){return this.axes[E]?.props.placement??a.vM.Left}setCursor(E){this.cursor=(0,t.merge)({},this.cursor,E)}setMode(E){this.mode=E}setSelect(E){this.select=E}addSeries(E){this.series.push(new p(E))}getSeries(){return this.series}addScale(E){const C=this.scales.find(b=>b.props.scaleKey===E.scaleKey);if(C){C.merge(E);return}this.scales.push(new l.G(E))}addBand(E){this.bands.push(E)}setStackingGroups(E){this.stackingGroups=E}getStackingGroups(){return this.stackingGroups}setPrepData(E){this.prepData=C=>(this.frames=C,E(C,this.getStackingGroups()))}setPadding(E){this.padding=E}getConfig(){if(this.cachedConfig)return this.cachedConfig;const E={...g.NN,mode:this.mode,series:[this.mode===2?null:{value:()=>""}]};E.axes=this.ensureNonOverlappingAxes(Object.values(this.axes)).map(b=>b.getConfig()),E.series=[...E.series,...this.series.map(b=>b.getConfig())],E.scales=this.scales.reduce((b,T)=>({...b,...T.getConfig()}),{}),E.hooks=this.hooks,E.select=this.select;const C=(b="")=>(T,A)=>{let R=T.series[A].points._stroke;if(typeof R!="string"){let S=this.frames[0].fields[A];R=S.display(S.values[T.cursor.idxs[A]]).color}return R+b};return E.cursor=(0,t.merge)({},m,{points:{stroke:C("80"),fill:C()}},this.cursor),E.tzDate=this.tzDate,Array.isArray(this.padding)&&(E.padding=this.padding),this.stackingGroups.forEach(b=>{(0,g.Tz)(b).forEach(T=>{this.addBand(T)})}),this.bands.length&&(E.bands=this.bands),this.cachedConfig=E,E}ensureNonOverlappingAxes(E){const C=E.find(A=>A.props.scaleKey==="x"),b=E.filter(A=>A.props.grid?.show===void 0),T=b.findIndex(A=>A.props.placement===a.vM.Left||A.props.placement===a.vM.Right||A.props.placement===a.vM.Bottom&&A!==C);for(let A=0;A<b.length;A++)b[A]===C||A===T?b[A].props.grid.show=!0:b[A].props.grid.show=!1;return E}}},93060:(_,L,e)=>{"use strict";e.d(L,{G:()=>g,Y:()=>i});var t=e(36613),n=e(77678),r=e(83195),s=e(52622),a=e(52811);class g extends a.R{merge(d){this.props.min=i("min",this.props.min,d.min),this.props.max=i("max",this.props.max,d.max)}getConfig(){let{isTime:d,scaleKey:o,min:u,max:c,softMin:p,softMax:h,range:y,direction:f,orientation:v,centeredZero:P,decimals:m,stackingMode:D}=this.props;D===s.gs.Percent&&(u==null&&p==null&&(p=0),c==null&&h==null&&(h=1));const x=this.props.distribution,E=d?{}:{distr:x===s.L4.Symlog?4:x===s.L4.Log?3:x===s.L4.Ordinal?2:1,log:x===s.L4.Log||x===s.L4.Symlog?this.props.log??2:void 0,asinh:x===s.L4.Symlog?this.props.linearThreshold??1:void 0};if(x===s.L4.Log){let B=this.props.log,N=B===2?Math.log2:Math.log10;u!=null&&(u<=0?u=null:u=B**Math.floor(N(u))),c!=null&&(c<=0?c=null:c=B**Math.ceil(N(c))),p!=null&&(p<=0?p=null:p=B**Math.floor(N(p))),h!=null&&(h<=0?h=null:h=B**Math.ceil(N(h)))}let C=p==null?3:1,b=h==null?3:1;const T={min:{pad:.1,hard:u??-1/0,soft:p||0,mode:C},max:{pad:.1,hard:c??1/0,soft:h||0,mode:b}};let A=p==null&&u!=null,R=h==null&&c!=null,S=A&&R;const O=(B,N,I,K)=>{const w=B.scales[K];let U=[N,I];if(!S&&N==null&&I==null)return U;let W=w.log??10;if(w.distr===1||w.distr===2||w.distr===4){if(P){let H=Math.abs(N),z=Math.abs(I),G=Math.max(H,z);G===0&&(G=80),N=-G,I=G}w.distr===4?U=t.A.rangeAsinh(N,I,W,!0):U=t.A.rangeNum(A?u:N,R?c:I,T)}else w.distr===3&&(U=t.A.rangeLog(u??N,c??I,W,!0));if(m===0)if(w.distr===1||w.distr===2)U[0]=(0,n.rs)(U[0],1),U[1]=(0,n.Uh)(U[1],1);else if(w.distr===3){let H=w.log===2?Math.log2:Math.log10;if(U[0]<=1)U[0]=1;else{let G=Math.floor(H(U[0]));U[0]=W**G}let z=Math.ceil(H(U[1]));U[1]=W**z,U[0]===U[1]&&(U[1]*=W)}else w.distr===4&&(U[0]=(0,n.rs)(U[0],1),U[1]=(0,n.Uh)(U[1],1));return(w.distr===1||w.distr===4)&&(A&&(U[0]=u),R&&(U[1]=c)),U[0]>=U[1]&&(U[0]=w.distr===3?1:0,U[1]=100),U};let j=!d&&!S;return(0,r.j9)(o)&&(j=!1,y=[0,1]),{[o]:{time:d,auto:j,range:y??O,dir:f,ori:v,...E}}}}function i(l,d,o){const u=d!=null,c=o!=null;return u?c?l==="min"?d<o?d:o:d>o?d:o:d:o}},74863:(_,L,e)=>{"use strict";e.d(L,{B5:()=>d,EJ:()=>p,WO:()=>l,Z8:()=>u,pl:()=>y});var t=e(84140),n=e(23596),r=e(24293),s=e(50082),a=e(52622),g=e(29413);function i(f,v,P){let m=0,D=0,x=0,E=0;return f===3?(D=v.top,E=v.top+v.height):f===2?(m=v.left+v.width,x=v.left):f===1?(D=v.top+v.height,E=v.top):f===0&&(m=v.left,x=v.left+v.width),P.createLinearGradient(m,D,x,E)}function l(f,v){return(P,m)=>{const D=(0,g.Yc)(),x=i(P.scales.x.ori===a.Lt.Horizontal?3:2,P.bbox,D);return x.addColorStop(0,n.MV.alpha(f,v)),x.addColorStop(1,n.MV.alpha(f,0)),x}}function d(f,v,P){return(m,D)=>{const x=(0,g.Yc)(),E=i(m.scales.x.ori===a.Lt.Horizontal?3:2,m.bbox,x),C=(0,t.A)(f).spin(-25).darken(5),b=(0,t.A)(f).saturate(20).spin(20).brighten(10);return P.isDark?(E.addColorStop(0,b.lighten(10).setAlpha(v).toString()),E.addColorStop(1,C.darken(10).setAlpha(v).toString())):(E.addColorStop(0,b.lighten(10).setAlpha(v).toString()),E.addColorStop(1,C.setAlpha(v).toString())),E}}var o=(f=>(f[f.Right=0]="Right",f[f.Up=1]="Up",f[f.Left=2]="Left",f[f.Down=3]="Down",f))(o||{});function u(f,v,P,m=!1){let D=f.scales[v],x=null,E=null;for(let w=0;w<P.length;w++){let U=P[w][0];if((U<=D.min||x==null)&&(x=w),E=w,U>=D.max)break}if(x===E)return P[x][1];let C=P[x][0],b=P[E][0];C===-1/0&&(C=D.min),b===1/0&&(b=D.max);let T=Math.round(f.valToPos(C,v,!0)),A=Math.round(f.valToPos(b,v,!0)),R=T-A;if(R===0)return P[E][1];let S,O,j,B;f.scales.x.ori===a.Lt.Horizontal?(S=j=0,O=T,B=A):(O=B=0,S=T,j=A);let I=(0,g.Yc)().createLinearGradient(S,O,j,B),K;for(let w=x;w<=E;w++){let U=P[w],W=w===x?T:w===E?A:Math.round(f.valToPos(U[0],v,!0)),H=(T-W)/R;m&&w>x&&I.addColorStop(H,K),I.addColorStop(H,K=U[1])}return I}function c(f,v){let P=f.scales[v],m=1/0,D=-1/0;return f.series.forEach((x,E)=>{if(x.show&&x.scale===v)if(x.min==null){let C=f.data[E];for(let b=0;b<C.length;b++)C[b]!=null&&(m=Math.min(m,C[b]),D=Math.max(D,C[b]))}else m=Math.min(m,x.min),D=Math.max(D,x.max)}),D===m&&(m=P.min,D=P.max),[m,D]}function p(f,v,P,m,D,x){let E=P??D??null,C=m??x??null;if(E==null||C==null){let[b,T]=c(f,v);E=E??b??0,C=C??T??100}return[E,C]}function h(f){return f==="transparent"||f[0]==="#"&&f.slice(-2)==="00"}function y(f,v,P,m,D,x,E,C){if(!P)throw Error("Missing colorMode required for color scheme gradients");if(!m)throw Error("Missing thresholds required for color scheme gradients");return(b,T)=>{let A=b.series[T].scale,R="";if(P.id===r.Y.Thresholds)if(m.mode===s.O.Absolute){const S=m.steps.map(O=>[O.value,h(O.color)?"#0000":n.MV.alpha(v.visualization.getColorByName(O.color),f)]);R=u(b,A,S,!0)}else{const[S,O]=p(b,A,D,x,E,C),j=O-S,B=m.steps.map(N=>[S+j*(N.value/100),n.MV.alpha(v.visualization.getColorByName(N.color),f)]);R=u(b,A,B,!0)}else if(P.getColors){const S=P.getColors(v),[O,j]=p(b,A,D,x,E,C),B=j-O,N=S.map((I,K)=>[O+B*(K/(S.length-1)),n.MV.alpha(v.visualization.getColorByName(I),f)]);R=u(b,A,N,!1)}return R}}},78226:(_,L,e)=>{"use strict";e.d(L,{a:()=>g});var t=e(74848),n=e(96540),r=e(1604),s=e(6967),a=e(97620);function g({id:i,events:l,renderEventMarker:d,mapEventToXYCoords:o,config:u}){const c=(0,n.useRef)(),[p,h]=(0,n.useState)(0),y=(0,r.A)();(0,n.useLayoutEffect)(()=>{u.addHook("init",v=>{c.current=v}),u.addHook("draw",()=>{y()&&h(v=>v+1)})},[u,h]);const f=(0,n.useMemo)(()=>{const v=[];if(!c.current||l.length===0)return v;for(let P=0;P<l.length;P++){const m=l[P];for(let D=0;D<m.length;D++){const x=o(m,{fieldIndex:D,frameIndex:P});x&&v.push((0,n.createElement)(s.p,{...x,key:`${i}-marker-${P}-${D}`},d(m,{fieldIndex:D,frameIndex:P})))}}return(0,t.jsx)(t.Fragment,{children:v})},[l,d,p]);return c.current?(0,t.jsx)(a._,{left:c.current.bbox.left/window.devicePixelRatio,top:c.current.bbox.top/window.devicePixelRatio,children:f}):null}},6967:(_,L,e)=>{"use strict";e.d(L,{p:()=>n});var t=e(74848);const n=({x:r,y:s,children:a})=>(0,t.jsx)("div",{style:{position:"absolute",top:`${s}px`,left:`${r}px`},children:a})},97620:(_,L,e)=>{"use strict";e.d(L,{_:()=>s});var t=e(74848),n=e(32196),r=e(96540);const s=({children:a,left:g,top:i})=>{const l=(0,r.useMemo)(()=>(0,n.css)({position:"absolute",overflow:"visible",left:`${g}px`,top:`${i}px`}),[g,i]);return(0,t.jsx)("div",{className:l,children:a})}},55129:(_,L,e)=>{"use strict";e.d(L,{M:()=>r});var t=e(52622),n=e(52811);function r(a,g){const i="na",l=`${a.min!==void 0?a.min:i}-${a.max!==void 0?a.max:i}`,d=`${a.custom?.axisSoftMin!==void 0?a.custom.axisSoftMin:i}-${a.custom?.axisSoftMax!==void 0?a.custom.axisSoftMax:i}`,o=`${a.custom?.axisPlacement!==void 0?a.custom?.axisPlacement:t.vM.Auto}`,u=a.unit??n.s,c=a.custom?.scaleDistribution?s(a.custom.scaleDistribution):t.L4.Linear,p=a.custom?.axisLabel?a.custom.axisLabel:i;return`${u}/${l}/${d}/${o}/${c}/${p}/${g}`}function s(a){return a.type===t.L4.Log?`${a.type}${a.log}`:a.type}},96287:(_,L,e)=>{"use strict";e.d(L,{J:()=>a});var t=e(74848),n=e(32196),r=e(29158),s=e(40845);const a=({onClick:i,"aria-label":l,style:d})=>{const o=(0,s.of)(g);return(0,t.jsx)(r.K,{"aria-label":l??"Close",className:o,name:"times",onClick:i,style:d})},g=i=>(0,n.css)({position:"absolute",margin:"0px",right:5,top:6})},68268:(_,L,e)=>{"use strict";e.d(L,{K:()=>l});var t=e(2543),n=e.n(t),r=e(96540),s=e(64423),a=e(99165),g=e(69129),i=e(26272);const l=({config:d,eventBus:o,frame:u})=>{const c=(0,r.useRef)(u);return c.current=u,(0,r.useLayoutEffect)(()=>{let p=null;const h={point:{time:null},data:c.current};d.addHook("init",E=>{p=E});let y=null;d.addHook("setSeries",(E,C)=>{y=C}),d.addHook("setLegend",()=>{if(!(p.cursor.event==null)){let C=p.cursor.idxs.find(b=>b!=null);if(C==null)x();else{let b=C,T=y,A=p.data[0]??p.data[1][0];h.point.time=A[b],h.rowIndex=b??void 0,h.columnIndex=T??void 0,h.data=c.current;let R=p.cursor.top;h.point.panelRelY=R===0?.001:R>0?R/p.rect.height:1,D()}}});function f(E){const C=E.payload?.point?.time;if(C){const b=p.valToPos(C,"x");p.setCursor({left:b,top:p.rect.height/2})}}const v=new s.yU,P=new g.b_(h).setTags(["uplot"]),m=new g.ql().setTags(["uplot"]);let D=(0,t.throttle)(()=>{o.publish(P)},100),x=(0,t.throttle)(()=>{o.publish(m)},100);return v.add(o.getStream(g.b_).subscribe({next:E=>{o===E.origin||E.tags?.has("uplot")||f(E)}})),v.add(o.getStream(i.kb).subscribe({next:E=>f(E)})),v.add(o.getStream(g.ql).pipe((0,a.c)(50)).subscribe({next:E=>{o===E.origin||E.tags?.has("uplot")||p.cursor._lock||p.setCursor({left:-10,top:-10})}})),()=>{v.unsubscribe()}},[d]),null}},23117:(_,L,e)=>{"use strict";e.d(L,{Z:()=>l});var t=e(2543),n=e.n(t),r=e(96540);const s=.1,a=2,g=new Set(["ArrowRight","ArrowLeft","ArrowUp","ArrowDown","Shift"," "]),i=d=>{let o=d.root,u=new Set,c=null,p=null;if(!o)return;o.tabIndex=0;const h=(x,E)=>{const{cursor:C}=d;if(C.left===void 0||C.top===void 0)return;const{width:b,height:T}=d.over.style,[A,R]=[Math.floor(parseFloat(b)),Math.floor(parseFloat(T))];d.setCursor({left:(0,t.clamp)(C.left+x,0,A),top:(0,t.clamp)(C.top+E,0,R)})},y=x=>{if(u.size===0||!d){p=null;return}const b=(x-(p??x))*s;let T=0,A=0;u.has("ArrowUp")&&(A-=b),u.has("ArrowDown")&&(A+=b),u.has("ArrowLeft")&&(T-=b),u.has("ArrowRight")&&(T+=b),u.has("Shift")&&(T*=a,A*=a),h(T,A);const{cursor:R}=d;if(u.has(" ")&&R){const S=Number(d.over.style.height.slice(0,-2));d.setSelect({left:R.left<c?R.left:c,top:0,width:Math.abs(R.left-(c??R.left)),height:S},!1)}p=x,window.requestAnimationFrame(y)},f=x=>{if(x.key==="Tab"){d.setCursor({left:-5,top:-5});return}if(!g.has(x.key))return;if(x.preventDefault(),x.stopPropagation(),!u.has(x.key)){const C=u.size===0;u.add(x.key),c=x.key===" "&&c===null?d.cursor.left:c,C&&window.requestAnimationFrame(y)}},v=x=>{g.has(x.key)&&(u.delete(x.key),x.key===" "&&(x.preventDefault(),x.stopPropagation(),d.setSelect(d.select),c=null))},P=()=>{if(!o?.matches(":focus-visible"))return;const x=parseFloat(d.over.style.width),E=parseFloat(d.over.style.height);d.setCursor({left:x/2,top:E/2})},m=()=>{p=null,c=null,u.clear(),d.setSelect({left:0,top:0,width:0,height:0},!1)};o.addEventListener("keydown",f),o.addEventListener("keyup",v),o.addEventListener("focus",P),o.addEventListener("blur",m);const D=()=>{o?.removeEventListener("keydown",f),o?.removeEventListener("keyup",v),o?.removeEventListener("focus",P),o?.removeEventListener("blur",m),o=null};(d.hooks.destroy??=[]).push(D)},l=({config:d})=>((0,r.useLayoutEffect)(()=>d.addHook("init",i),[d]),null)},38761:(_,L,e)=>{"use strict";e.d(L,{b3:()=>u,xl:()=>f});var t=e(74848),n=e(32196),r=e(96540),s=e(40961),a=e(73134),g=e(40845),i=e(17464),l=e(96287);const d=void 0,o=10;var u=(P=>(P[P.xOne=0]="xOne",P[P.xAll=1]="xAll",P[P.xyOne=2]="xyOne",P))(u||{});function c(P,m){return{...P,...m,style:{...P.style,...m.style}}}function p(){return{style:{transform:"",pointerEvents:"none"},isHovering:!1,isPinned:!1,contents:null,plot:null,dismiss:()=>{}}}const h=5,y=P=>P!=null&&!P.ctrlKey&&!P.metaKey,f=({config:P,hoverMode:m,render:D,clientZoom:x=!1,queryZoom:E,onSelectRange:C,maxWidth:b,syncMode:T=a.yV.Off,syncScope:A="global"})=>{const R=(0,r.useRef)(null),S=(0,r.useRef)(null);S.current==null&&(S.current=(0,i.gF)());const[{plot:O,isHovering:j,isPinned:B,contents:N,style:I,dismiss:K},w]=(0,r.useReducer)(c,null,p),U=(0,r.useRef)(),W=(0,g.of)(v,b),H=(0,r.useRef)(D);return H.current=D,(0,r.useLayoutEffect)(()=>{U.current={width:0,height:0,observer:new ResizeObserver(be=>{let we=U.current;for(const Be of be)Be.borderBoxSize?.length>0?(we.width=Be.borderBoxSize[0].inlineSize,we.height=Be.borderBoxSize[0].blockSize):(we.width=Be.contentRect.width,we.height=Be.contentRect.height)})};let z=!1,G=!1,M=O,Q=j,Y=!1,q=B,te=I,X=!1;const ee=T===a.yV.Tooltip;T!==a.yV.Off&&P.scales[0].props.isTime&&P.setCursor({sync:{key:A,scales:["x",null]}});const ne=()=>{le?Q=X&&Y&&ee:Q=de!=null||m===1&&Y};let Z=0,ae=0,re=null,se=O?.cursor.idxs.slice(),de=null,le=!1,he=!1,ie=!1;const J=(be=!1)=>{he||(Q?queueMicrotask(pe):setTimeout(pe,100),he=!0),be&&(ie=!0)},ce=be=>{R.current.contains(be.target)||Pe()},pe=()=>{he=!1,ie&&(te={pointerEvents:q?"all":"none"},M.cursor._lock=q,q?(document.addEventListener("mousedown",ce,!0),document.addEventListener("keydown",ce,!0)):(document.removeEventListener("mousedown",ce,!0),document.removeEventListener("keydown",ce,!0)),ie=!1);let be={style:te,isPinned:q,isHovering:Q,contents:Q||re!=null?H.current(M,se,de,q,Pe,re,le):null,dismiss:Pe};w(be),re=null},Pe=()=>{let be=q;q=!1,Q=!1,M.setCursor({left:-10,top:-10}),J(be)};P.addHook("init",be=>{w({plot:M=be}),x&&be.over.addEventListener("mousedown",we=>{if(y(we)&&we.button===0&&we.shiftKey){G=!0,be.cursor.drag.x=!1,be.cursor.drag.y=!0;let Be=He=>{be.cursor.drag.x=!0,be.cursor.drag.y=!1,document.removeEventListener("mouseup",Be,!0)};document.addEventListener("mouseup",Be,!0)}},!0),be.over.addEventListener("click",we=>{if(we.target===be.over)if(we.ctrlKey||we.metaKey){let Be;be.scales.x.ori===0?Be=be.posToVal(be.cursor.left,"x"):Be=be.posToVal(be.select.top+be.select.height,"x"),re={from:Be,to:Be},J(!1)}else Q&&de!=null&&!q&&setTimeout(()=>{q=!0,J(!0)},0)})}),P.addHook("setSelect",be=>{const we=be.scales.x.ori===0;if(!le&&(x||E!=null))if(y(be.cursor.event)){if(C!=null){let Be=[];const He=!!be.cursor.drag.y,Ve=!!be.cursor.drag.x;let Je=null,nt=[];Ve&&(Je={from:we?be.posToVal(be.select.left,"x"):be.posToVal(be.select.top+be.select.height,"x"),to:we?be.posToVal(be.select.left+be.select.width,"x"):be.posToVal(be.select.top,"x")}),He&&P.scales.forEach(pt=>{const bt=pt.props.scaleKey;if(bt!=="x"){let Tt={from:we?be.posToVal(be.select.top+be.select.height,bt):be.posToVal(be.select.left+be.select.width,bt),to:we?be.posToVal(be.select.top,bt):be.posToVal(be.select.left,bt)};nt.push(Tt)}}),Ve?He?Be=nt.map(pt=>({x:Je,y:pt})):Be=[{x:Je}]:He&&(Be=nt.map(pt=>({y:pt}))),C(Be)}else if(x&&G){if(be.select.height>=h){for(let Be in be.scales)if(Be!=="x"){const He=we?be.posToVal(be.select.top,Be):be.posToVal(be.select.left+be.select.width,Be),Ve=we?be.posToVal(be.select.top+be.select.height,Be):be.posToVal(be.select.left,Be);be.setScale(Be,{min:Ve,max:He})}z=!0}G=!1}else if(E!=null&&be.select.width>=h){const Be=we?be.posToVal(be.select.left,"x"):be.posToVal(be.select.top+be.select.height,"x"),He=we?be.posToVal(be.select.left+be.select.width,"x"):be.posToVal(be.select.top,"x");E({from:Be,to:He}),z=!1}}else re={from:we?be.posToVal(be.select.left,"x"):be.posToVal(be.select.top+be.select.height,"x"),to:we?be.posToVal(be.select.left+be.select.width,"x"):be.posToVal(be.select.top,"x")},J(!0);be.setSelect({left:0,width:0,top:0,height:0},!1)}),(x||E!=null)&&P.setCursor({bind:{dblclick:be=>()=>{if(!y(be.cursor.event))return null;if(x&&z){for(let we in be.scales)we!=="x"&&be.setScale(we,{min:null,max:null});z=!1}else if(E!=null){let we=be.scales.x;const Be=we.min,He=we.max,Ve=(He-Be)/2;E({from:Be-Ve,to:He+Ve})}return null}}}),P.addHook("setData",be=>{z=!1,G=!1,q&&Pe()}),P.addHook("setSeries",(be,we)=>{de=we,le=be.cursor.event==null,ne(),J()}),P.addHook("setLegend",be=>{se=M?.cursor.idxs.slice(),Y=se.some((Be,He)=>He>0&&Be!=null),le=be.cursor.event==null;let we=Q;ne(),(Q||Q!==we)&&J()});const Ie=16;let ge=0,Se=0;const De=()=>{Q&&!q&&Pe(),ge=window.innerWidth-Ie,Se=window.innerHeight-Ie},Ke=()=>{X=M.rect.bottom<=Se&&M.rect.top>=0&&M.rect.left>=0&&M.rect.right<=ge};De(),P.addHook("ready",Ke),P.addHook("setCursor",be=>{if(le=be.cursor.event==null,!Q)return;let{left:we=-10,top:Be=-10}=be.cursor;if(we>=0||Be>=0){let He=be.rect.left+we,Ve=be.rect.top+Be,Je="",{width:nt,height:pt}=U.current;nt+=o,pt+=o,ae!==0?Ve+pt<Se||Ve-pt<0?ae=0:ae!==-pt&&(ae=-pt):Ve+pt>Se&&Ve-pt>=0&&(ae=-pt),Z!==0?He+nt<ge||He-nt<0?Z=0:Z!==-nt&&(Z=-nt):He+nt>ge&&He-nt>=0&&(Z=-nt);const bt=He+(Z===0?o:-o),Tt=Ve+(ae===0?o:-o);Je=`translateX(${bt}px) ${Z===0?"":"translateX(-100%)"} translateY(${Tt}px) ${ae===0?"":"translateY(-100%)"}`,R.current!=null?R.current.style.transform=Je:(te.transform=Je,J())}});const Me=be=>{Ke(),Q&&be.target instanceof Node&&be.target.contains(M.root)&&Pe()};return window.addEventListener("resize",De),window.addEventListener("scroll",Me,!0),()=>{window.removeEventListener("resize",De),window.removeEventListener("scroll",Me,!0),document.removeEventListener("mousedown",ce,!0),document.removeEventListener("keydown",ce,!0)}},[P]),(0,r.useLayoutEffect)(()=>{const z=U.current;if(R.current!=null){z.observer.observe(R.current);const{width:G,height:M}=R.current.getBoundingClientRect();z.width=G,z.height=M;let Q=O.cursor.event;if(Q!=null){const Y=Q.type!=="mousemove";Y&&(Q=new MouseEvent("mousemove",{view:window,bubbles:!0,cancelable:!0,clientX:Q.clientX,clientY:Q.clientY,screenX:Q.screenX,screenY:Q.screenY})),!(Y?!1:performance.now()-Q.timeStamp>16)&&O.over.dispatchEvent(Q)}else O.setCursor({left:O.cursor.left,top:O.cursor.top},!0)}else z.width=0,z.height=0},[j]),O&&j?(0,s.createPortal)((0,t.jsxs)("div",{className:(0,n.cx)(W.tooltipWrapper,B&&W.pinned),style:I,"aria-live":"polite","aria-atomic":"true",ref:R,children:[B&&(0,t.jsx)(l.J,{onClick:K}),N]}),S.current):null},v=(P,m)=>({tooltipWrapper:(0,n.css)({top:0,left:0,zIndex:P.zIndex.portal,whiteSpace:"pre",borderRadius:P.shape.radius.default,position:"fixed",background:P.colors.background.primary,border:`1px solid ${P.colors.border.weak}`,boxShadow:P.shadows.z2,userSelect:"text",maxWidth:m??"none"}),pinned:(0,n.css)({boxShadow:P.shadows.z3})})},52811:(_,L,e)=>{"use strict";e.d(L,{R:()=>n,s:()=>t});const t="__fixed";class n{constructor(s){this.props=s}}},16895:(_,L,e)=>{"use strict";e.d(L,{NN:()=>o,Tz:()=>c,UO:()=>P,bq:()=>h,ro:()=>p,sw:()=>y,uY:()=>D});var t=e(11261),n=e(50311),r=e(75059),s=e(57875),a=e(52622),g=e(40621),i=e(91040),l=e(55129);const d=(x,E,C)=>{let b=E%2?C[0]||C[2]:C[1]||C[3];return C[E]||!b?0:8},o={ms:1,focus:{alpha:1},cursor:{focus:{prox:30}},legend:{show:!1},padding:[d,d,d,d],series:[],hooks:{}};var u=(x=>(x[x.Pos=1]="Pos",x[x.Neg=-1]="Neg",x))(u||{});function c(x){let E=[],{series:C,dir:b}=x,T=C.length-1,A=C.slice().reverse();return A.forEach((R,S)=>{if(S!==T){let O=A[S+1];E.push({series:[R,O],dir:-1*b})}}),E}function p(x){let E=new Map;return x.fields.forEach(({config:C,values:b,type:T},A)=>{if(A===0)return;let{custom:R}=C;if(R==null||R.hideFrom?.viz)return;let{stacking:S}=R;if(S==null)return;let{mode:O,group:j}=S;if(O===a.gs.None)return;let B=R.transform,N=f(B,b),I=R.drawStyle,K=I===a.GR.Bars?R.barAlignment:I===a.GR.Line?R.lineInterpolation:null,w=`${N}|${O}|${j}|${(0,l.M)(C,T)}|${I}|${K}`,U=E.get(w);U==null&&(U={series:[],dir:N},E.set(w,U)),U.series.push(A)}),[...E.values()]}function h(x,E,C){let b=Array(x.fields.length),T=E.length,A=x.length,R=T>0?Array(A).fill(0):[],S=T>0?Array(A).fill(!1):[],O=Array.from({length:T},()=>R.slice()),j=Array.from({length:T},()=>S.slice());if(E.forEach((B,N)=>{let I=j[N];B.series.forEach(K=>{let w=x.fields[K];if(w.config.custom?.hideFrom?.viz)return;let U=w.values;for(let W=0;W<A;W++)U[W]!=null&&(I[W]=!0)})}),x.fields.forEach((B,N)=>{let I=B.values;if(N===0){B.type===t.PU.time?b[0]=(0,n.ks)(B).values:b[0]=I;return}let{custom:K}=B.config;if(!K||K.hideFrom?.viz){b[N]=I;return}if(K.transform===a.NU.Constant){let U=I.findIndex(H=>H!=null),W=I[U];I=Array(I.length).fill(void 0),I[U]=W}else if(I=I.slice(),K.transform===a.NU.NegativeY)for(let U=0;U<I.length;U++)I[U]!=null&&(I[U]*=-1);let w=K.stacking?.mode;if(!w||w===a.gs.None)b[N]=I;else{let U=E.findIndex(G=>G.series.indexOf(N)>-1),W=O[U],H=j[U],z=b[N]=Array(A);for(let G=0;G<A;G++){let M=I[G];M!=null?z[G]=W[G]+=M:z[G]=H[G]?W[G]:M}}}),C){let B=b.map((N,I)=>{let K=E.findIndex(w=>w.series.indexOf(I)>-1);return K!==-1?O[K]:N});C({totals:B})}return x.fields.forEach((B,N)=>{if(N===0||B.config.custom?.hideFrom?.viz)return;if(B.config.custom?.stacking?.mode===a.gs.Percent){let K=E.findIndex(H=>H.series.indexOf(N)>-1),w=O[K],U=E[K],W=b[N];for(let H=0;H<A;H++){let z=W[H];z!=null&&(W[H]=w[H]===0?0:U.dir*(z/w[H]))}}}),b}function y(x,E){let C,b=1,T=1,A=x.data[1][E],R=x.data[1][E];for(let S=1;S<x.data.length;S++){const j=x.data[S][E];j!=null&&(A==null?A=j:j>A&&(A=x.data[S][E],b=S),R==null?R=j:j<R&&(R=x.data[S][E],T=S))}return R==null&&A==null?C=void 0:R!=null&&A!=null?C=(x.valToPos(R,x.series[T].scale)+x.valToPos(A,x.series[b].scale))/2:C=x.valToPos(R||A,x.series[b||T].scale),C!==void 0&&C<0&&(C=x.bbox.height/devicePixelRatio),C}function f(x,E){const C=v(E);return x===a.NU.NegativeY?C?1:-1:C?-1:1}function v(x,E=100){const C=x.length;if(C===0)return!1;let b=0,T=C-1;for(;b<=T&&x[b]==null;)b++;for(;T>=b&&x[T]==null;)T--;let A=0,R=0;if(T>=b){const S=Math.max(1,Math.floor((T-b+1)/E));for(let O=b;O<=T;O+=S){const j=x[O];j!=null&&typeof j=="number"&&(j<0||Object.is(j,-0)?A++:j>0&&R++)}if(A>R)return!0}return!1}const P=(x,E,C)=>{if(!x?.length)return[];const b=S=>S==null?"-":S.toFixed(1),T=E.display??b;let A=null;const R=(0,r.Nw)({field:E,reducers:x});return x.map(S=>{const O=r.AS.get(S);let j=T;return O.id===r.gy.diffperc&&(j=(0,s.J)({field:{...E,config:{...E.config,unit:"percent"}},theme:C})),(O.id===r.gy.count||O.id===r.gy.changeCount||O.id===r.gy.distinctCount)&&(A||(A=(0,s.J)({field:{...E,config:{...E.config,unit:"none"}},theme:C})),j=A),{...j(R[S]),title:O.name,description:O.description}})},m=(0,i.h)("uPlot"),D=m.logger;(0,g.h)("graphng",void 0,m)},33083:(_,L,e)=>{"use strict";e.d(L,{H:()=>c,i:()=>p});var t=e(74848),n=e(32196),r=e(61443),s=e(72724),a=e(28122),g=e(9286),i=e(66864),l=e(59093),d=e(64539),o=e(94536),u=e(40845);const c=({getContextMenuSource:y,timeZone:f,itemsGroup:v,dimensions:P,contextDimensions:m,...D})=>{const x=y(),E=v?v.map(T=>({...T,items:T.items?.filter(A=>A.label)})):[],C=()=>{if(!x)return null;let T;if(P?.yAxis&&m?.yAxis?.[1]){const R=(0,r.WK)(P.yAxis,m.yAxis[0],m.yAxis[1]),S=x.series.valueField.display;T=S(R)}const A=(0,s.LE)(x.datapoint[0],{defaultWithMS:x.series.hasMsResolution,timeZone:f});return(0,t.jsx)(p,{timestamp:A,seriesColor:x.series.color,displayName:x.series.alias||x.series.label,displayValue:T})},b=()=>E?.map((T,A)=>(0,t.jsx)(l.r,{label:T.label,children:(T.items||[]).map(R=>(0,t.jsx)(d.D,{url:R.url,label:R.label,target:R.target,icon:R.icon,active:R.active,onClick:R.onClick},`${R.label}`))},`${T.label}${A}`));return(0,t.jsx)(a.t,{...D,renderMenuItems:b,renderHeader:C})},p=({timestamp:y,seriesColor:f,displayName:v,displayValue:P})=>{const m=(0,u.of)(h);return(0,t.jsxs)("div",{className:m.wrapper,children:[(0,t.jsx)("strong",{children:y}),(0,t.jsxs)(i.Gy,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(o.p,{color:f}),(0,t.jsx)("span",{className:m.displayName,children:v})]}),P&&(0,t.jsx)(g.i,{value:P})]})]})};function h(y){return{wrapper:(0,n.css)({padding:y.spacing(.5,1),fontSize:y.typography.size.sm,zIndex:y.zIndex.tooltip}),displayName:(0,n.css)({whiteSpace:"nowrap",paddingLeft:y.spacing(.5)})}}},8984:(_,L,e)=>{"use strict";e.r(L),e.d(L,{ALERTING_COLOR:()=>s.xj,Alert:()=>t.FcD,AlertingSettings:()=>t.ibS,AsyncMultiSelect:()=>t.Ivu,AsyncSelect:()=>t.DWK,AsyncVirtualizedSelect:()=>t.gZN,AutoSaveField:()=>t.p0K,AutoSizeInput:()=>t.Dd_,Avatar:()=>t.euF,AxisPlacement:()=>l.vM,Badge:()=>t.Exy,BarAlignment:()=>l.Nj,BarGauge:()=>t.xEy,BarGaugeDisplayMode:()=>t.eX$,BarValueVisibility:()=>l.TC,BigValue:()=>t.yVm,BigValueColorMode:()=>t.ypG,BigValueGraphMode:()=>t.$p8,BigValueJustifyMode:()=>t.F8C,BigValueTextMode:()=>t.SV3,Box:()=>t.azJ,BracesPlugin:()=>i.e1,BrowserLabel:()=>t.jQM,Button:()=>t.$nd,ButtonCascader:()=>t.HRi,ButtonGroup:()=>t.e2v,ButtonSelect:()=>t.fHW,CallToActionCard:()=>t.cbd,Card:()=>t.ZpM,CardContainer:()=>t.Q_j,Cascader:()=>t.vxQ,CertificationKey:()=>t.KmA,Checkbox:()=>t.Sc0,ClearPlugin:()=>i.vJ,ClickOutsideWrapper:()=>t.NqN,ClipboardButton:()=>t.bLJ,ClipboardPlugin:()=>i.sW,CodeEditor:()=>t.BYM,CodeEditorSuggestionItemKind:()=>t.q0m,CollapsableSection:()=>t.MU_,Collapse:()=>t.SDm,ColorPicker:()=>t.skP,ColorPickerInput:()=>t.itl,ConfirmButton:()=>t.ZFl,ConfirmModal:()=>t.uoB,Container:()=>t.mcf,ContextMenu:()=>t.tzH,ControlledCollapse:()=>t.a2C,Counter:()=>t.phK,CustomHeadersSettings:()=>t.Pli,CustomScrollbar:()=>t.EZm,DEFAULT_ANNOTATION_COLOR:()=>s.Mk,DOMUtil:()=>s.bk,DataLinkButton:()=>t.Rsn,DataLinkInput:()=>t.lZ_,DataLinksContextMenu:()=>t.ebG,DataLinksInlineEditor:()=>t.eHD,DataSourceHttpSettings:()=>t.tco,DatePicker:()=>t.lrV,DatePickerWithInput:()=>t.lS2,DateTimePicker:()=>t.K7n,DeleteButton:()=>t.etH,Divider:()=>t.cGx,DrawStyle:()=>l.yg,Drawer:()=>t._s,Dropdown:()=>t.msM,EmptySearchResult:()=>t.Z7I,EmptyState:()=>t.ppr,ErrorBoundary:()=>t.tHk,ErrorBoundaryAlert:()=>t.XwR,ErrorWithStack:()=>t.DaU,EventBusPlugin:()=>t.Kur,EventsCanvas:()=>t.aaz,EventsWithValidation:()=>s.Pw,FIXED_UNIT:()=>t.sN5,FadeTransition:()=>t.AVJ,FeatureBadge:()=>t.yKR,FeatureInfoBox:()=>t.ep7,Field:()=>t.D0$,FieldArray:()=>t.ED_,FieldLinkList:()=>t.nA8,FieldSet:()=>t.nVY,FieldValidationMessage:()=>t.PgM,FileDropzone:()=>t.gHy,FileDropzoneDefaultChildren:()=>t.wIj,FileListItem:()=>t.IBq,FileUpload:()=>t.ef9,FilterInput:()=>t.ZYI,FilterPill:()=>t.mKT,Form:()=>t.lVW,FormattedValueDisplay:()=>t.i7I,FullWidthButtonContainer:()=>t.Vpd,Gauge:()=>t._I2,GlobalStyles:()=>a.kH,Graph:()=>t.TS0,GraphContextMenu:()=>t.Hdp,GraphContextMenuHeader:()=>t.io8,GraphGradientMode:()=>l.on,GraphNG:()=>t.ovZ,GraphSeriesToggler:()=>t.MTY,GraphThresholdsStyleMode:()=>l.Ly,GraphWithLegend:()=>t.IK5,Grid:()=>t.xA9,HorizontalGroup:()=>t.GyY,Icon:()=>t.Int,IconButton:()=>t.K0,IndentationPlugin:()=>i.TA,InfoBox:()=>t.w4Q,InlineField:()=>t.IP5,InlineFieldRow:()=>t.CeB,InlineFormLabel:()=>t.IjS,InlineLabel:()=>t.c2B,InlineSegmentGroup:()=>t.e8d,InlineSwitch:()=>t.KYK,InlineToast:()=>t.r0T,Input:()=>t.pde,InputControl:()=>t.eyo,InteractiveTable:()=>t.jDF,JSONFormatter:()=>t.BJ$,JsonExplorer:()=>t.OoN,KeyboardPlugin:()=>t.Z7z,Label:()=>t.JU7,LegacyForms:()=>t.rRI,LegacyInputStatus:()=>t.OYG,Legend:()=>t.s$2,LegendDisplayMode:()=>l.lm,LineInterpolation:()=>l.dx,Link:()=>t.N_E,LinkButton:()=>t.z9$,List:()=>t.B8B,LoadingBar:()=>t.GmG,LoadingPlaceholder:()=>t._ae,Marker:()=>t.pH9,Menu:()=>t.W1t,MenuGroup:()=>t.rXV,MenuItem:()=>t.Drp,Modal:()=>t.aFV,ModalHeader:()=>t.rQ0,ModalRoot:()=>t.EOs,ModalTabContent:()=>t.OHP,ModalTabsHeader:()=>t.JXd,ModalsContext:()=>t.wEe,ModalsController:()=>t.$sz,ModalsProvider:()=>t.YO7,MultiSelect:()=>t.KFt,NO_DATA_COLOR:()=>s.nO,NewlinePlugin:()=>i.Om,NodeGraphDataFrameFieldNames:()=>s.uc,OK_COLOR:()=>s.Xw,PENDING_COLOR:()=>s.ct,PageToolbar:()=>t.dAS,Pagination:()=>t.dKS,PanelChrome:()=>t.NRL,PanelChromeLoadingIndicator:()=>t.oQQ,PanelContainer:()=>t._wj,PanelContextProvider:()=>t.XFg,PanelContextRoot:()=>t.e4W,PlotLegend:()=>t.$sV,PluginSignatureBadge:()=>t.Bjr,PointVisibility:()=>l.nT,Popover:()=>t.AMh,PopoverController:()=>t.IE3,Portal:()=>t.ZLI,PortalContainer:()=>t.qB2,QueryField:()=>t.Xjo,REGION_FILL_ALPHA:()=>s.UJ,RadioButtonDot:()=>t.JBW,RadioButtonGroup:()=>t.zWQ,RadioButtonList:()=>t.a0s,RangeSlider:()=>t.F16,ReactMonacoEditor:()=>t.m3b,ReactUtils:()=>s.zt,RefreshPicker:()=>t.cCp,RelativeTimeRangePicker:()=>t.NBP,RenderUserContentAsHTML:()=>t.IUm,RunnerPlugin:()=>i.Ul,SCHEMA:()=>s.yx,ScaleDirection:()=>l.ON,ScaleDistribution:()=>t.L47,ScaleOrientation:()=>l.Lt,SearchFunctionType:()=>s.Tt,SecretInput:()=>t.L44,SecretTextArea:()=>t.lpq,SecureSocksProxySettings:()=>t.YAX,Segment:()=>t.Y4n,SegmentAsync:()=>t.sYD,SegmentInput:()=>t.oyW,SegmentSection:()=>t.Lrm,SegmentSelect:()=>t.a$h,Select:()=>t.l6P,SelectContainer:()=>t.KAb,SelectMenuOptions:()=>t.o5c,SelectionShortcutsPlugin:()=>i.l9,SeriesColorPicker:()=>t.Dpi,SeriesColorPickerPopover:()=>t.o0L,SeriesColorPickerPopoverWithTheme:()=>t.tJM,SeriesIcon:()=>t.pMY,SeriesTable:()=>t.o95,SeriesTableRow:()=>t.gNl,SeriesVisibilityChangeBehavior:()=>t.KHN,SeriesVisibilityChangeMode:()=>t.Bd,SetInterval:()=>t.u3P,SlatePrism:()=>i.De,SlideOutTransition:()=>t.nfS,Slider:()=>t.Apm,Space:()=>t.$xS,Sparkline:()=>t.OW$,Spinner:()=>t.y$y,Stack:()=>t.BJc,StackingMode:()=>l.gs,StatsPicker:()=>t.SPA,SuggestionsPlugin:()=>i.Pz,Switch:()=>t.dOG,TLSAuthSettings:()=>t.jDu,Tab:()=>t.ozo,TabContent:()=>t.JSC,TabbedContainer:()=>t.qtX,Table:()=>t.XIK,TableCellDisplayMode:()=>l.ob,TableInputCSV:()=>t.bwN,TabsBar:()=>t.U05,Tag:()=>t.vwO,TagList:()=>t.LYX,TagsInput:()=>t.um3,Text:()=>t.EYj,TextArea:()=>t.fs1,TextLink:()=>t.YqK,ThemeContext:()=>a.Dx,TimeOfDayPicker:()=>t.R3l,TimePickerTooltip:()=>t.xSz,TimeRangeInput:()=>t.bYj,TimeRangeLabel:()=>t.fD2,TimeRangePicker:()=>t.$64,TimeSeries:()=>t.ZOC,TimeZonePicker:()=>t.U7r,ToggleAllState:()=>t.XNj,Toggletip:()=>t.Gff,ToolbarButton:()=>t.IBt,ToolbarButtonRow:()=>t.Uhs,Tooltip:()=>t.m_M,TooltipDisplayMode:()=>l.$N,TooltipPlugin:()=>t.TkQ,TooltipPlugin2:()=>t.xlH,UPLOT_AXIS_FONT_SIZE:()=>t.piP,UPlotChart:()=>t.ZCE,UPlotConfigBuilder:()=>t.eEE,UnitPicker:()=>t.pKo,UserIcon:()=>t.nys,ValuePicker:()=>t.iyp,VerticalGroup:()=>t.gWJ,VerticalTab:()=>t.sMJ,VirtualizedSelect:()=>t.ipx,VizLayout:()=>t.KUk,VizLegend:()=>t.tZ2,VizLegendListItem:()=>t.MJh,VizRepeater:()=>t.SdN,VizTooltip:()=>t.nRt,VizTooltipContainer:()=>t.oNG,WeekStartPicker:()=>t.l69,WithContextMenu:()=>t.nuT,XYCanvas:()=>t._XZ,ZoomPlugin:()=>t.jnT,ansicolor:()=>s.DB,attachDebugger:()=>s.hF,buildScaleKey:()=>t.Myc,calculateFontSize:()=>s.Vr,clearButtonStyles:()=>t.myI,colors:()=>s.Tj,commonOptionsBuilder:()=>g.j,convertOldAngularValueMapping:()=>t.I1_,createLogger:()=>s.h,defaultIntervals:()=>t.cbf,fieldMatchersUI:()=>t.gso,fuzzyMatch:()=>s.It,getCanvasContext:()=>s.Yc,getCardStyles:()=>t.Hut,getCellLinks:()=>s.kl,getDragStyles:()=>t.lBN,getInputStyles:()=>t.na7,getPortalContainer:()=>t.gF8,getScrollbarWidth:()=>s.XJ,getSelectStyles:()=>t.Jq4,getTagColor:()=>s.yC,getTagColorIndexFromName:()=>s.JF,getTagColorsFromName:()=>s.MC,getTextColorForAlphaBackground:()=>s.mZ,getTextColorForBackground:()=>s.sg,getTheme:()=>a.O4,getWeekStart:()=>t.rLY,graphFieldOptions:()=>t.ti9,graphTickFormatter:()=>t.YnM,graphTimeFormat:()=>t.JcZ,hasValidationEvent:()=>s.K,isCompactUrl:()=>s.Fr,linkModelToContextMenuItems:()=>s.Jl,makeFragment:()=>s.dF,makeValue:()=>s.mO,measureText:()=>s.kD,mockTheme:()=>a.mG,mockThemeContext:()=>a.fq,preparePlotFrame:()=>t.mYT,regexValidation:()=>s.RP,resetSelectStyles:()=>t.aLN,sharedInputStyle:()=>t.Xb,sharedSingleStatMigrationHandler:()=>t._$q,sharedSingleStatPanelChangedHandler:()=>t.glJ,sortedColors:()=>s.Ih,styleMixins:()=>a.YF,stylesFactory:()=>a.N3,useForceUpdate:()=>s.CH,useGraphNGContext:()=>t.IyU,usePanelContext:()=>t.d2s,useSplitter:()=>t.hrX,useStyles:()=>a.IS,useStyles2:()=>a.of,useTheme:()=>a.DP,useTheme2:()=>a.$j,validate:()=>s.tf,variableSuggestionToCodeEditorSuggestion:()=>t.OOt,withErrorBoundary:()=>t.Xc0,withTheme:()=>a.SL,withTheme2:()=>a.cV});var t=e(55458),n=e(80186),r={};for(const d in n)["default","Alert","AlertingSettings","AsyncMultiSelect","AsyncSelect","AsyncVirtualizedSelect","AutoSaveField","AutoSizeInput","Avatar","Badge","BarGauge","BarGaugeDisplayMode","BigValue","BigValueColorMode","BigValueGraphMode","BigValueJustifyMode","BigValueTextMode","Box","BrowserLabel","Button","ButtonCascader","ButtonGroup","ButtonSelect","CallToActionCard","Card","CardContainer","Cascader","CertificationKey","Checkbox","ClickOutsideWrapper","ClipboardButton","CodeEditor","CodeEditorSuggestionItemKind","CollapsableSection","Collapse","ColorPicker","ColorPickerInput","ConfirmButton","ConfirmModal","Container","ContextMenu","ControlledCollapse","Counter","CustomHeadersSettings","CustomScrollbar","DataLinkButton","DataLinkInput","DataLinksContextMenu","DataLinksInlineEditor","DataSourceHttpSettings","DatePicker","DatePickerWithInput","DateTimePicker","DeleteButton","Divider","Drawer","Dropdown","EmptySearchResult","EmptyState","ErrorBoundary","ErrorBoundaryAlert","ErrorWithStack","EventBusPlugin","EventsCanvas","FIXED_UNIT","FadeTransition","FeatureBadge","FeatureInfoBox","Field","FieldArray","FieldLinkList","FieldSet","FieldValidationMessage","FileDropzone","FileDropzoneDefaultChildren","FileListItem","FileUpload","FilterInput","FilterPill","Form","FormattedValueDisplay","FullWidthButtonContainer","Gauge","Graph","GraphContextMenu","GraphContextMenuHeader","GraphNG","GraphSeriesToggler","GraphWithLegend","Grid","HorizontalGroup","Icon","IconButton","InfoBox","InlineField","InlineFieldRow","InlineFormLabel","InlineLabel","InlineSegmentGroup","InlineSwitch","InlineToast","Input","InputControl","InteractiveTable","JSONFormatter","JsonExplorer","KeyboardPlugin","Label","LegacyForms","LegacyInputStatus","Legend","Link","LinkButton","List","LoadingBar","LoadingPlaceholder","Marker","Menu","MenuGroup","MenuItem","Modal","ModalHeader","ModalRoot","ModalTabContent","ModalTabsHeader","ModalsContext","ModalsController","ModalsProvider","MultiSelect","PageToolbar","Pagination","PanelChrome","PanelChromeLoadingIndicator","PanelContainer","PanelContextProvider","PanelContextRoot","PlotLegend","PluginSignatureBadge","Popover","PopoverController","Portal","PortalContainer","QueryField","RadioButtonDot","RadioButtonGroup","RadioButtonList","RangeSlider","ReactMonacoEditor","RefreshPicker","RelativeTimeRangePicker","RenderUserContentAsHTML","ScaleDistribution","SecretInput","SecretTextArea","SecureSocksProxySettings","Segment","SegmentAsync","SegmentInput","SegmentSection","SegmentSelect","Select","SelectContainer","SelectMenuOptions","SeriesColorPicker","SeriesColorPickerPopover","SeriesColorPickerPopoverWithTheme","SeriesIcon","SeriesTable","SeriesTableRow","SeriesVisibilityChangeBehavior","SeriesVisibilityChangeMode","SetInterval","SlideOutTransition","Slider","Space","Sparkline","Spinner","Stack","StatsPicker","Switch","TLSAuthSettings","Tab","TabContent","TabbedContainer","Table","TableInputCSV","TabsBar","Tag","TagList","TagsInput","Text","TextArea","TextLink","TimeOfDayPicker","TimePickerTooltip","TimeRangeInput","TimeRangeLabel","TimeRangePicker","TimeSeries","TimeZonePicker","ToggleAllState","Toggletip","ToolbarButton","ToolbarButtonRow","Tooltip","TooltipPlugin","TooltipPlugin2","UPLOT_AXIS_FONT_SIZE","UPlotChart","UPlotConfigBuilder","UnitPicker","UserIcon","ValuePicker","VerticalGroup","VerticalTab","VirtualizedSelect","VizLayout","VizLegend","VizLegendListItem","VizRepeater","VizTooltip","VizTooltipContainer","WeekStartPicker","WithContextMenu","XYCanvas","ZoomPlugin","buildScaleKey","clearButtonStyles","convertOldAngularValueMapping","defaultIntervals","fieldMatchersUI","getCardStyles","getDragStyles","getInputStyles","getPortalContainer","getSelectStyles","getWeekStart","graphFieldOptions","graphTickFormatter","graphTimeFormat","preparePlotFrame","resetSelectStyles","sharedInputStyle","sharedSingleStatMigrationHandler","sharedSingleStatPanelChangedHandler","useGraphNGContext","usePanelContext","useSplitter","variableSuggestionToCodeEditorSuggestion","withErrorBoundary"].indexOf(d)<0&&(r[d]=()=>n[d]);e.d(L,r);var s=e(67985),a=e(7918),g=e(42482),i=e(50955),l=e(49149)},38248:(_,L,e)=>{"use strict";e.d(L,{W:()=>p,r:()=>o});var t=e(74848),n=e(11261),r=e(27310),s=e(52622),a=e(88575),g=e(94354),i=e(10354),l=e(90182),d=e(52198);function o(h,y,f){const v=["Axis"];h.addRadio({path:"axisPlacement",name:"Placement",category:v,defaultValue:d.t.axisPlacement[0].value,settings:{options:d.t.axisPlacement}}).addTextInput({path:"axisLabel",name:"Label",category:v,defaultValue:"",settings:{placeholder:"Optional text",expandTemplateVars:!0},showIf:P=>P.axisPlacement!==s.vM.Hidden,shouldApply:P=>P.type!==n.PU.time&&P.type!==n.PU.string}).addNumberInput({path:"axisWidth",name:"Width",category:v,settings:{placeholder:"Auto"},showIf:P=>P.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisGridShow",name:"Show grid lines",category:v,defaultValue:void 0,settings:{options:[{value:void 0,label:"Auto"},{value:!0,label:"On"},{value:!1,label:"Off"}]},showIf:P=>P.axisPlacement!==s.vM.Hidden}).addRadio({path:"axisColorMode",name:"Color",category:v,defaultValue:s.Y$.Text,settings:{options:[{value:s.Y$.Text,label:"Text"},{value:s.Y$.Series,label:"Series"}]},showIf:P=>P.axisPlacement!==s.vM.Hidden}).addBooleanSwitch({path:"axisBorderShow",name:"Show border",category:v,defaultValue:!1,showIf:P=>P.axisPlacement!==s.vM.Hidden}),h.addCustomEditor({id:"scaleDistribution",path:"scaleDistribution",name:"Scale",category:v,editor:p,override:p,defaultValue:{type:s.L4.Linear},shouldApply:P=>P.type===n.PU.number,process:r.hS}).addBooleanSwitch({path:"axisCenteredZero",name:"Centered zero",category:v,defaultValue:!1,showIf:P=>P.scaleDistribution?.type!==s.L4.Log}).addNumberInput({path:"axisSoftMin",name:"Soft min",defaultValue:y.axisSoftMin,category:v,settings:{placeholder:"See: Standard options > Min"}}).addNumberInput({path:"axisSoftMax",name:"Soft max",defaultValue:y.axisSoftMax,category:v,settings:{placeholder:"See: Standard options > Max"}})}const u=[{label:"Linear",value:s.L4.Linear},{label:"Logarithmic",value:s.L4.Log},{label:"Symlog",value:s.L4.Symlog}],c=[{label:"2",value:2},{label:"10",value:10}],p=({value:h,onChange:y})=>{const f=h?.type??s.L4.Linear,v=h?.log??2;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:16},children:(0,t.jsx)(g.z,{value:f,options:u,onChange:P=>{y({...h,type:P,log:P===s.L4.Linear?void 0:v})}})}),(f===s.L4.Log||f===s.L4.Symlog)&&(0,t.jsx)(a.D,{label:"Log base",children:(0,t.jsx)(l.l6,{options:c,value:v,onChange:P=>{y({...h,log:P.value})}})}),f===s.L4.Symlog&&(0,t.jsx)(a.D,{label:"Linear threshold",children:(0,t.jsx)(i.p,{placeholder:"1",value:h?.linearThreshold,onChange:P=>{y({...h,linearThreshold:Number(P.currentTarget.value)})}})})]})}},11404:(_,L,e)=>{"use strict";e.d(L,{e:()=>l});var t=e(74848),n=e(2543),r=e.n(n),s=e(96540),a=e(92174),g=e(67061);const i=({value:d,onChange:o})=>{const u=(0,s.useCallback)(c=>{o({...d,[c]:!d[c]})},[d,o]);return(0,t.jsx)(g.B,{gap:.5,children:Object.keys(d).map(c=>{const p=c;return(0,t.jsx)(a.m,{icon:d[p]?"eye-slash":"eye",onClick:()=>u(p),label:(0,n.startCase)(p),selected:d[p]},p)})})};function l(d){d.addCustomEditor({id:"hideFrom",name:"Hide in area",category:["Series"],path:"hideFrom",defaultValue:{tooltip:!1,viz:!1,legend:!1},editor:i,override:i,shouldApply:()=>!0,hideFromDefaults:!0,process:o=>o})}},22680:(_,L,e)=>{"use strict";e.d(L,{H:()=>r});var t=e(69550),n=e(52622);function r(s,a=!0,g=!0){s.addBooleanSwitch({path:"legend.showLegend",name:"Visibility",category:["Legend"],description:"",defaultValue:g}).addRadio({path:"legend.displayMode",name:"Mode",category:["Legend"],description:"",defaultValue:n.lm.List,settings:{options:[{value:n.lm.List,label:"List"},{value:n.lm.Table,label:"Table"}]},showIf:i=>i.legend.showLegend}).addRadio({path:"legend.placement",name:"Placement",category:["Legend"],description:"",defaultValue:"bottom",settings:{options:[{value:"bottom",label:"Bottom"},{value:"right",label:"Right"}]},showIf:i=>i.legend.showLegend}).addNumberInput({path:"legend.width",name:"Width",category:["Legend"],settings:{placeholder:"Auto"},showIf:i=>i.legend.showLegend&&i.legend.placement==="right"}),a&&s.addCustomEditor({id:"legend.calcs",path:"legend.calcs",name:"Values",category:["Legend"],description:"Select values or calculations to show in legend",editor:t.D.get("stats-picker").editor,defaultValue:[],settings:{allowMultiple:!0},showIf:i=>i.legend.showLegend!==!1})}},56675:(_,L,e)=>{"use strict";e.d(L,{I:()=>u,m:()=>o});var t=e(74848),n=e(27310),r=e(11261),s=e(52622),a=e(94354),g=e(29158),i=e(10354),l=e(67061),d=e(52198);const o=({value:c,context:p,onChange:h,item:y})=>(0,t.jsxs)(l.B,{children:[(0,t.jsx)(a.z,{value:c?.mode||s.gs.None,options:y.settings?.options??[],onChange:f=>{h({...c,mode:f})}}),p.isOverride&&c?.mode&&c?.mode!==s.gs.None&&(0,t.jsx)(i.p,{type:"text",placeholder:"Group",suffix:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Name of the stacking group",tooltipPlacement:"top"}),defaultValue:c?.group,onChange:f=>{h({...c,group:f.currentTarget.value.trim()})}})]});function u(c,p,h=["Graph styles"]){c.addCustomEditor({id:"stacking",path:"stacking",name:"Stack series",category:h,defaultValue:p,editor:o,override:o,settings:{options:d.t.stacking},process:n.hS,shouldApply:y=>y.type===r.PU.number})}},71242:(_,L,e)=>{"use strict";e.d(L,{I:()=>t});function t(n,r=!0){r&&n.addNumberInput({path:"text.titleSize",category:["Text size"],name:"Title",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0}),n.addNumberInput({path:"text.valueSize",category:["Text size"],name:"Value",settings:{placeholder:"Auto",integer:!1,min:1,max:200},defaultValue:void 0})}},89654:(_,L,e)=>{"use strict";e.d(L,{D:()=>n});var t=e(52622);function n(r,s=!1,a=!1,g){const i=["Tooltip"],l=s?[{value:t.$N.Single,label:"Single"},{value:t.$N.None,label:"Hidden"}]:[{value:t.$N.Single,label:"Single"},{value:t.$N.Multi,label:"All"},{value:t.$N.None,label:"Hidden"}],d=[{value:t.xB.None,label:"None"},{value:t.xB.Ascending,label:"Ascending"},{value:t.xB.Descending,label:"Descending"}];r.addRadio({path:"tooltip.mode",name:"Tooltip mode",category:i,defaultValue:g?.tooltip?.mode??t.$N.Single,settings:{options:l}}).addRadio({path:"tooltip.sort",name:"Values sort order",category:i,defaultValue:g?.tooltip?.sort??t.xB.None,showIf:o=>o.tooltip?.mode===t.$N.Multi,settings:{options:d}}),a&&r.addNumberInput({path:"tooltip.hoverProximity",name:"Hover proximity",description:"How close the cursor must be to a point to trigger the tooltip, in pixels",category:i,settings:{integer:!0},showIf:o=>o.tooltip?.mode!==t.$N.None}),r.addNumberInput({path:"tooltip.maxWidth",name:"Max width",category:i,settings:{integer:!0},showIf:o=>o.tooltip?.mode!==t.$N.None}).addNumberInput({path:"tooltip.maxHeight",name:"Max height",category:i,defaultValue:void 0,settings:{integer:!0},showIf:o=>o.tooltip?.mode===t.$N.Multi})}},42482:(_,L,e)=>{"use strict";e.d(L,{j:()=>t});var t={};e.r(t),e.d(t,{ScaleDistributionEditor:()=>n.W,StackingEditor:()=>i.m,addAxisConfig:()=>n.r,addHideFrom:()=>r.e,addLegendOptions:()=>s.H,addStackingConfig:()=>i.I,addTextSizeOptions:()=>g.I,addTooltipOptions:()=>a.D});var n=e(38248),r=e(11404),s=e(22680),a=e(89654),g=e(71242),i=e(56675)},49149:(_,L,e)=>{"use strict";e.d(L,{$N:()=>t.$N,Lt:()=>t.Lt,Ly:()=>t.Ly,Nj:()=>t.Nj,ON:()=>t.ON,TC:()=>t.yL,dx:()=>t.dx,gs:()=>t.gs,lm:()=>t.lm,nT:()=>t.yL,ob:()=>t.ob,on:()=>t.on,vM:()=>t.vM,yg:()=>t.GR});var t=e(52622)},74738:(_,L,e)=>{"use strict";e.d(L,{v:()=>t});function t(){return{onKeyDown(n,r,s){const a=r.value;if(a.selection.isExpanded)return s();if(n.key==="k"&&n.ctrlKey){n.preventDefault();const g=a.anchorText.text,i=a.selection.anchor.offset,d=g.length-i;return r.deleteForward(d),!0}return s()}}}},99453:(_,L,e)=>{"use strict";e.d(L,{s:()=>r});const t=(s,a,g)=>{if(!s.length)return;const i=s.slice(0,-1).join("").length+s.length-1;return s.join(`
`).slice(a,i+g)},n=s=>s?.replace(/[\uFEFF]/g,"");function r(){const s={onCopy(a,g,i){a.preventDefault();const{document:l,selection:d}=g.value,{start:{offset:o},end:{offset:u}}=d,c=l.getLeafBlocksAtRange(d).toArray().map(h=>h.text),p=n(t(c,o,u));return p&&a.clipboardData&&a.clipboardData.setData("Text",p),!0},onPaste(a,g,i){if(a.preventDefault(),a.clipboardData){const d=n(a.clipboardData.getData("Text"))?.split(`
`);if(d&&d.length){g.insertText(d[0]);for(const o of d.slice(1))g.splitBlock().insertText(o)}}return!0}};return{...s,onCut(a,g,i){return s.onCopy(a,g,i),g.deleteAtRange(g.value.selection),!0}}}},1020:(_,L,e)=>{"use strict";e.d(L,{T:()=>o});var t=e(57746),n=e(82611),r=e(52845);const s=(0,t.Sn)("mod+["),a=(0,t.Sn)("shift+tab"),g=(0,t.Sn)("mod+]"),i="  ",l=(u,c,p)=>{const{startBlock:h,endBlock:y,selection:{start:{offset:f,key:v},end:{offset:P,key:m}}}=c.value;if(r.default.serialize(c.value)==="")return;u.preventDefault();const D=h.getFirstText();D&&f===0&&v===D.key&&P===D.text.length&&m===D.key||!h.equals(y)?d(c,"right"):c.insertText(i)},d=(u,c)=>{const p=u.value.selection,h=u.value.document.getLeafBlocksAtRange(p).toArray();if(c==="left")for(const y of h){const f=y.text.length-y.text.trimLeft().length,v=y.getFirstText().key,P={anchor:{key:v,offset:f,path:[]},focus:{key:v,offset:f,path:[]}};u.deleteBackwardAtRange(n.Range.create(P),Math.min(i.length,f))}else{const{startText:y}=u.value,f=y.text.slice(0,p.start.offset),v=/^\s*$/.test(f);for(const P of h)u.insertTextByKey(P.getFirstText().key,0,i);v&&u.moveStartBackward(i.length)}};function o(){return{onKeyDown(u,c,p){if(s(u)||a(u))u.preventDefault(),d(c,"left");else if(g(u))u.preventDefault(),d(c,"right");else if(u.key==="Tab")l(u,c,p);else return p();return!0}}}},50955:(_,L,e)=>{"use strict";e.d(L,{e1:()=>s,vJ:()=>a.v,sW:()=>g.s,TA:()=>i.T,Om:()=>l.O,Ul:()=>d.U,l9:()=>o.l,De:()=>u.D,Pz:()=>c.Pz});var t=e(62938);const n={"[":"]","{":"}","(":")"},r="brace_match";function s(){return{onKeyDown(p,h,y){const{value:f}=h;switch(p.key){case"(":case"{":case"[":{const{start:{offset:v,key:P},end:{offset:m,key:D},focus:{offset:x}}=f.selection,E=f.focusText.text;if(f.selection.isExpanded)return p.preventDefault(),h.insertTextByKey(P,v,p.key).insertTextByKey(D,m+1,n[p.key]).moveEndBackward(1),!0;if(x===E.length||E[x]===" "||Object.values(n).includes(E[x])){p.preventDefault();const C=n[p.key],b={key:`${r}-${(0,t.A)()}`,type:`${r}-${C}`,anchor:{key:P,offset:v,object:"point"},focus:{key:D,offset:m+1,object:"point"},object:"annotation"};return h.insertText(p.key).insertText(C).addAnnotation(b).moveBackward(1),!0}break}case")":case"}":case"]":{const v=f.anchorText.text,P=f.selection.anchor.offset,m=v[P],D=p.key,x=`${r}-${D}`,E=f.annotations.find(C=>C?.type===x&&C.anchor.key===f.anchorText.key);if(E&&m===D&&!f.selection.isExpanded)return p.preventDefault(),h.moveFocusForward(1).removeAnnotation(E).moveAnchorForward(1),!0;break}case"Backspace":{const v=f.anchorText.text,P=f.selection.anchor.offset,m=v[P-1],D=v[P];if(n[m]&&n[m]===D)return p.preventDefault(),h.deleteBackward(1).deleteForward(1).focus(),!0}default:break}return y()}}}var a=e(74738),g=e(99453),i=e(1020),l=e(88295),d=e(4269),o=e(31589),u=e(41781),c=e(80903)},88295:(_,L,e)=>{"use strict";e.d(L,{O:()=>n});function t(r){let s=r.length-r.trimLeft().length;if(s){let a=r[0];for(;--s;)a+=r[0];return a}return""}function n(){return{onKeyDown(r,s,a){const g=s.value;if(g.selection.isExpanded)return a();if(r.key==="Enter"){r.preventDefault();const{startBlock:i}=g,l=i.text,d=t(l);return s.splitBlock().insertText(d).focus()}return a()}}}},4269:(_,L,e)=>{"use strict";e.d(L,{U:()=>t});function t({handler:n}){return{onKeyDown(r,s,a){return n&&r.key==="Enter"&&(r.shiftKey||r.ctrlKey)?(r.preventDefault(),n(r),s):a()}}}},31589:(_,L,e)=>{"use strict";e.d(L,{l:()=>r});var t=e(57746);const n=(0,t.Sn)("mod+l");function r(){return{onKeyDown(s,a,g){if(n(s)){s.preventDefault();const{focusBlock:i,document:l}=a.value;a.moveAnchorToStartOfBlock(),l.getNextBlock(i.key)?a.moveFocusToStartOfNextBlock():a.moveFocusToEndOfText()}else return g();return!0}}}},84694:(_,L,e)=>{"use strict";e.d(L,{A:()=>n});const n="prism-token"},41781:(_,L,e)=>{"use strict";e.d(L,{D:()=>c,R:()=>f});var t=e(28848),n=e.n(t),r=e(82611),s=e(84694),a=e(74848),g=e(49568);function i(v){return v.object==="block"&&v.type==="code_block"}function l(v){return"javascript"}function d(v,P,m){const{decoration:D}=v;if(D.type!==s.A)return m();const x=D.data.get("className");return(0,a.jsx)("span",{className:x,children:v.children})}class o extends(0,g.Record)({onlyIn:i,getSyntax:l,renderDecoration:d}){constructor(P){super(P)}}const u=o;function c(v={},P=n().languages){const m=new u(v);return{decorateNode:(D,x,E)=>{if(!m.onlyIn(D))return E();const C=r.Block.create(D),b=m.getSyntax(C),T=P[b];if(!T)return[];const R=C.getTexts().map(B=>B&&B.getText()).join(`
`),S=n().tokenize(R,T),O=f(S),j=x.value.data.set("tokens",O);return x.setData(j),p(m,S,C)},renderDecoration:(D,x,E)=>m.renderDecoration({children:D.children,decoration:D.decoration},x,E)}}function p(v,P,m){const D=m.getTexts(),x=[];let E=0,C=0;return D.forEach(b=>{C=E+b.getText().length;let T=0;function A(R,S){if(typeof R=="string"){if(S){const O=h({text:b,textStart:E,textEnd:C,start:T,end:T+R.length,className:`prism-token token ${S}`,block:m});O&&x.push(O)}T+=R.length}else if(S=`${S} ${R.type}`,R.alias&&(S+=" "+R.alias),typeof R.content=="string"){const O=h({text:b,textStart:E,textEnd:C,start:T,end:T+R.content.length,className:`prism-token token ${S}`,block:m});O&&x.push(O),T+=R.content.length}else for(let O=0;O<R.content.length;O+=1)A(R.content[O],S)}P.forEach(A),E=C+1}),x}function h({text:v,textStart:P,textEnd:m,start:D,end:x,className:E,block:C}){return D>=m||x<=P?null:(D=Math.max(D,P),x=Math.min(x,m),D-=P,x-=P,C.createDecoration({object:"decoration",anchor:{key:v.key,offset:D,object:"point"},focus:{key:v.key,offset:x,object:"point"},type:s.A,data:{className:E}}))}function y(v){return typeof v=="string"?[{content:v,types:[],aliases:[]}]:Array.isArray(v)?v.flatMap(P=>y(P)):v instanceof n().Token?y(v.content).flatMap(P=>{let m=[];return typeof v.alias=="string"?m=[v.alias]:m=v.alias??[],{content:P.content,types:[v.type,...P.types],aliases:[...m,...P.aliases]}}):[]}function f(v){const P=y(v);if(!P.length)return[];const m=P[0];m.prev=null,m.next=P.length>=2?P[1]:null,m.offsets={start:0,end:m.content.length};for(let x=1;x<P.length-1;x++)P[x].prev=P[x-1],P[x].next=P[x+1],P[x].offsets={start:P[x-1].offsets.end,end:P[x-1].offsets.end+P[x].content.length};const D=P[P.length-1];return D.prev=P.length>=2?P[P.length-2]:null,D.next=null,D.offsets={start:P.length>=2?P[P.length-2].offsets.end:0,end:P.length>=2?P[P.length-2].offsets.end+D.content.length:D.content.length},P}},80903:(_,L,e)=>{"use strict";e.d(L,{Pz:()=>I});var t=e(74848),n=e(2543),r=e(32196),s=e(96540),a=e(40961),g=e(91793),i=e(60578),l=e(50774),d=e(49579);const o=U=>U.reduce((W,{items:H,label:z})=>(W.push({label:z,kind:l.I.GroupTitle}),H.reduce((G,M)=>(G.push(M),G),W)),[]),u=U=>U.reduce((W,H)=>W.length<H.label.length?H.label:W,""),c=(U,W,H)=>{const z=(0,d.A)(H,{font:U.typography.fontFamilyMonospace,fontSize:U.typography.bodySmall.fontSize,fontWeight:"normal"}),G=h(z.width,U),M=p(z.height,U),Q=y(M,W);return{listWidth:G,listHeight:Q,itemHeight:M}},p=(U,W)=>{const H=W.spacing.gridSize*2;return U+H},h=(U,W)=>{const H=W.spacing.gridSize*3;return Math.min(Math.max(U+H,200),800)},y=(U,W)=>{const H=Math.min(W.length,10),z=100,G=H*U;return Math.max(G,z)};var f=e(36663),v=e(40845);const P=(U,W,H)=>({typeaheadItem:(0,r.css)({label:"type-ahead-item",zIndex:11,padding:U.spacing(1,1,1,2),border:U.colors.border.medium,overflowY:"scroll",overflowX:"hidden",outline:"none",background:U.colors.background.secondary,color:U.colors.text.secondary,boxShadow:`0 0 20px ${U.v1.colors.dropdownShadow}`,visibility:H===!0?"visible":"hidden",width:"250px",minHeight:`${W+parseInt(U.spacing(.25),10)}px`,position:"relative",wordBreak:"break-word"})}),m=({item:U,height:W})=>{const H=U&&!!U.documentation,z=U?U.label:"",G=(0,f.G)(U?.documentation),M=(0,v.$j)(),Q=P(M,W,H);return(0,t.jsxs)("div",{className:(0,r.cx)([Q.typeaheadItem]),children:[(0,t.jsx)("b",{children:z}),(0,t.jsx)("hr",{}),(0,t.jsx)("div",{dangerouslySetInnerHTML:{__html:G}})]})};var D=e(23257),x=e.n(D),E=e(5313);const C=U=>({typeaheadItem:(0,r.css)({border:"none",background:"none",textAlign:"left",label:"type-ahead-item",height:"auto",fontFamily:U.typography.fontFamilyMonospace,padding:U.spacing(1,1,1,2),fontSize:U.typography.bodySmall.fontSize,textOverflow:"ellipsis",overflow:"hidden",zIndex:11,display:"block",whiteSpace:"nowrap",cursor:"pointer",[U.transitions.handleMotion("no-preference","reduce")]:{transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"}}),typeaheadItemSelected:(0,r.css)({label:"type-ahead-item-selected",backgroundColor:U.colors.background.secondary}),typeaheadItemMatch:(0,r.css)({label:"type-ahead-item-match",color:U.v1.palette.yellow,borderBottom:`1px solid ${U.v1.palette.yellow}`,padding:"inherit",background:"inherit"}),typeaheadItemGroupTitle:(0,r.css)({label:"type-ahead-item-group-title",color:U.colors.text.secondary,fontSize:U.typography.bodySmall.fontSize,lineHeight:U.typography.body.lineHeight,padding:U.spacing(1)})}),b=U=>{const W=(0,v.of)(C),{isSelected:H,item:z,prefix:G,style:M,onMouseEnter:Q,onMouseLeave:Y,onClickItem:q}=U,te=H?(0,r.cx)([W.typeaheadItem,W.typeaheadItemSelected]):(0,r.cx)([W.typeaheadItem]),X=(0,r.cx)([W.typeaheadItemMatch]),ee=(0,r.cx)([W.typeaheadItemGroupTitle]),ne=z.label||"";return z.kind===l.I.GroupTitle?(0,t.jsx)("li",{className:ee,style:M,children:(0,t.jsx)("span",{children:ne})}):(0,t.jsx)("li",{role:"none",children:(0,t.jsx)("button",{role:"menuitem",className:te,style:M,onMouseDown:q,onMouseEnter:Q,onMouseLeave:Y,type:"button",children:z.highlightParts!==void 0?(0,t.jsx)(E.z,{text:ne,highlightClassName:X,highlightParts:z.highlightParts}):(0,t.jsx)(x(),{textToHighlight:ne,searchWords:[G??""],autoEscape:!0,highlightClassName:X})})})},T=(U,W)=>U-W*Math.floor(U/W);class A extends s.PureComponent{constructor(){super(...arguments),this.listRef=(0,s.createRef)(),this.state={hoveredItem:null,typeaheadIndex:null,allItems:[],listWidth:-1,listHeight:-1,itemHeight:-1},this.componentDidMount=()=>{this.props.menuRef&&this.props.menuRef(this),document.addEventListener("selectionchange",this.handleSelectionChange);const W=o(this.props.groupedItems),H=u(W),{listWidth:z,listHeight:G,itemHeight:M}=c(this.context,W,H);this.setState({listWidth:z,listHeight:G,itemHeight:M,allItems:W})},this.componentWillUnmount=()=>{document.removeEventListener("selectionchange",this.handleSelectionChange)},this.handleSelectionChange=()=>{this.forceUpdate()},this.componentDidUpdate=(W,H)=>{if(this.state.typeaheadIndex!==null&&H.typeaheadIndex!==this.state.typeaheadIndex&&this.listRef&&this.listRef.current){if(this.state.typeaheadIndex===1){this.listRef.current.scrollToItem(0);return}this.listRef.current.scrollToItem(this.state.typeaheadIndex)}if((0,n.isEqual)(W.groupedItems,this.props.groupedItems)===!1){const z=o(this.props.groupedItems),G=u(z),{listWidth:M,listHeight:Q,itemHeight:Y}=c(this.context,z,G);this.setState({listWidth:M,listHeight:Q,itemHeight:Y,allItems:z,typeaheadIndex:null})}},this.onMouseEnter=W=>{this.setState({hoveredItem:W})},this.onMouseLeave=()=>{this.setState({hoveredItem:null})},this.moveMenuIndex=W=>{const H=this.state.allItems.length;if(H){const z=this.state.typeaheadIndex||0;let G=T(z+W,H);this.state.allItems[G].kind===l.I.GroupTitle&&(G=T(G+W,H)),this.setState({typeaheadIndex:G});return}},this.insertSuggestion=()=>{this.props.onSelectSuggestion&&this.state.typeaheadIndex!==null&&this.props.onSelectSuggestion(this.state.allItems[this.state.typeaheadIndex])}}static{this.contextType=i.D}get menuPosition(){if(!window.getSelection)return"";const W=window.getSelection(),H=W&&W.anchorNode;if(H&&H.parentElement){const z=H.parentElement.getBoundingClientRect(),G=window.scrollX,M=window.scrollY;return`position: absolute; display: flex; top: ${z.top+M+z.height+6}px; left: ${z.left+G-2}px`}return""}render(){const{prefix:W,isOpen:H=!1,origin:z}=this.props,{allItems:G,listWidth:M,listHeight:Q,itemHeight:Y,hoveredItem:q,typeaheadIndex:te}=this.state,X=S(this.context),ee=q||te,ne=G[q||te||0];return(0,t.jsxs)(R,{origin:z,isOpen:H,style:this.menuPosition,children:[(0,t.jsx)("ul",{role:"menu",className:X.typeahead,"data-testid":"typeahead",children:(0,t.jsx)(g.Y1,{ref:this.listRef,itemCount:G.length,itemSize:Y,itemKey:Z=>{const ae=G&&G[Z];return ae?`${Z}-${ae.label}`:`${Z}`},width:M,height:Q,children:({index:Z,style:ae})=>{const re=G&&G[Z];return re?(0,t.jsx)(b,{onClickItem:()=>this.props.onSelectSuggestion?this.props.onSelectSuggestion(re):{},isSelected:te===null?!1:G[te]===re,item:re,prefix:W,style:ae,onMouseEnter:()=>this.onMouseEnter(Z),onMouseLeave:this.onMouseLeave}):null}})}),ee&&(0,t.jsx)(m,{height:Q,item:ne})]})}}class R extends s.PureComponent{constructor(W){super(W);const{index:H=0,origin:z="query",style:G}=W;this.node=document.createElement("div"),this.node.setAttribute("style",G),this.node.classList.add(`slate-typeahead-${z}-${H}`),document.body.appendChild(this.node)}componentWillUnmount(){document.body.removeChild(this.node)}render(){return this.props.isOpen?(this.node.setAttribute("style",this.props.style),this.node.classList.add("slate-typeahead--open"),a.createPortal(this.props.children,this.node)):(this.node.classList.remove("slate-typeahead--open"),null)}}const S=U=>({typeahead:(0,r.css)({position:"relative",zIndex:U.zIndex.typeahead,borderRadius:U.shape.radius.default,border:`1px solid ${U.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:U.components.panel.background,color:U.colors.text.primary,boxShadow:U.shadows.z2,strong:{color:U.v1.palette.yellow}})});var O=e(72307),j=e(75071),B=e(84694);const N=250;function I({onTypeahead:U,cleanText:W,onWillApplySuggestion:H,portalOrigin:z}){let G,M={groupedItems:[],typeaheadPrefix:"",typeaheadContext:"",typeaheadText:""};const Q=(0,n.debounce)(K,N),Y=q=>{M={...M,...q}};return{onBlur:(q,te,X)=>(M={...M,groupedItems:[]},X()),onClick:(q,te,X)=>(M={...M,groupedItems:[]},X()),onKeyDown:(q,te,X)=>{const ne=M.groupedItems.length;switch(q.key){case"Escape":{if(ne)return q.preventDefault(),M={...M,groupedItems:[]},te.insertText("");break}case"ArrowDown":case"ArrowUp":if(ne){q.preventDefault(),G.moveMenuIndex(q.key==="ArrowDown"?1:-1);return}break;case"Enter":{if(!(q.shiftKey||q.ctrlKey)&&ne)return q.preventDefault(),G.insertSuggestion();break}case"Tab":{if(ne)return q.preventDefault(),G.insertSuggestion();break}default:{q.key.length===1&&Q(te,Y,U,W);break}}return X()},commands:{selectSuggestion:(q,te)=>{const X=M.groupedItems;if(!X||!X.length)return q;const ee=q.applyTypeahead(te);return Q(q,Y,U,W),ee},applyTypeahead:(q,te)=>{let X=te.insertText||te.label;const ee=te.kind==="function",ne=te.move||0,Z=ne>0?ne:0,ae=ne<0?-ne:0,{typeaheadPrefix:re,typeaheadText:se,typeaheadContext:de}=M;H&&(X=H(X,{groupedItems:M.groupedItems,typeaheadContext:de,typeaheadPrefix:re,typeaheadText:se}));const{forward:le,backward:he}=w(X,re,se,ee,te.deleteBackwards,W);if(X.match(/\n/)){const ie=(0,O.dF)(X);return q.deleteBackward(he).deleteForward(le).insertFragment(ie).focus(),q}return M={...M,groupedItems:[]},q.snapshotSelection().deleteBackward(he).deleteForward(le).insertText(X).moveForward(Z).moveBackward(ae).focus(),q}},renderEditor(q,te,X){if(te.value.selection.isExpanded)return X();const ee=X();return(0,t.jsxs)(t.Fragment,{children:[ee,(0,t.jsx)(A,{menuRef:ne=>G=ne,origin:z,prefix:M.typeaheadPrefix,isOpen:!!M.groupedItems.length,groupedItems:M.groupedItems,onSelectSuggestion:te.selectSuggestion})]})}}}const K=async(U,W,H,z)=>{if(!H)return;const{value:G}=U,{selection:M}=G,Q=G.document.getClosestBlock(G.focusBlock.key),Y=G.selection.start.offset-1,q=Q&&Q.getDecorations(U),te=q?q.filter(he=>he.start.offset<=Y&&he.end.offset>Y&&he.type===B.A).toArray():[],X=q&&q.filter(he=>he.end.offset<=Y&&he.type===B.A&&he.data.get("className").includes("label-key")).last(),ee=X&&G.focusText.text.slice(X.start.offset,X.end.offset),ne=te.map(he=>he.data.get("className")).join(" ").split(" ").filter(he=>he.length);let Z=G.focusText.text,ae=Z.slice(0,M.focus.offset);te.length&&(Z=G.focusText.text.slice(te[0].start.offset,te[0].end.offset),ae=G.focusText.text.slice(te[0].start.offset,M.focus.offset));const re=ae.match(/(?:!?=~?"?|")(.*)/);re?ae=re[1]:z&&(ae=z(ae));const{suggestions:se,context:de}=await H({prefix:ae,text:Z,value:G,wrapperClasses:ne,labelKey:ee||void 0,editor:U}),le=se.map(he=>{if(!he.items)return he;const ie=he.searchFunctionType||(he.prefixMatch?j.T.Prefix:j.T.Word),J=j.H[ie];let ce={...he};return ae&&(he.skipFilter||(ce.items=ce.items.filter(pe=>(pe.filterText||pe.label).length>=ae.length),ce.items=J(ce.items,ae)),ce.items=ce.items.filter(pe=>!(pe.insertText===ae||(pe.filterText??pe.label)===ae))),he.skipSort||(ce.items=(0,n.sortBy)(ce.items,pe=>pe.sortText===void 0?pe.sortValue!==void 0?pe.sortValue:pe.label:pe.sortText||pe.label)),ce}).filter(he=>he.items&&he.items.length);W({groupedItems:le,typeaheadPrefix:ae,typeaheadContext:de,typeaheadText:Z}),U.blur().focus()};function w(U,W,H,z,G,M){const Q=G||W.length,Y=M?M(H):H,q=H.indexOf(W),te=q>-1?Y.length-q-W.length:Y.length-W.length;return{forward:!!(W&&te>0||U===H)&&!z?te+q:0,backward:Q}}},57108:(_,L,e)=>{"use strict";e.d(L,{k:()=>N});var t=e(74848),n=e(52762),r=e(40845);function s(I){return(0,n.css)({".sr-only":{position:"absolute",width:"1px",height:"1px",padding:0,margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",border:0}})}function a(I){return(0,n.css)({".alert-state-paused, .alert-state-pending":{color:I.colors.text.secondary,fontWeight:I.typography.fontWeightMedium},".alert-state-ok":{color:I.colors.success.text,fontWeight:I.typography.fontWeightMedium},".alert-state-warning":{color:I.colors.warning.text,fontWeight:I.typography.fontWeightMedium},".alert-state-critical":{color:I.colors.error.text,fontWeight:I.typography.fontWeightMedium}})}function g(I){return(0,n.css)({".panel-options-group":{borderBottom:`1px solid ${I.colors.border.weak}`},".panel-options-group__header":{padding:I.spacing(1,2,1,1),position:"relative",display:"flex",alignItems:"center",cursor:"pointer",fontWeight:500,color:I.colors.text.primary,"&:hover":{background:I.colors.emphasize(I.colors.background.primary,.03)}},".panel-options-group__icon":{color:I.colors.text.secondary,marginRight:I.spacing(1),padding:I.spacing(0,.9,0,.6)},".panel-options-group__title":{position:"relative"},".panel-options-group__body":{padding:I.spacing(1,2,1,4)}})}function i(I){return(0,n.css)({".card-section":{marginBottom:I.spacing(4)},".card-list":{display:"flex",flexDirection:"row",flexWrap:"wrap",listStyleType:"none"},".card-item":{display:"block",height:"100%",background:I.colors.background.secondary,boxShadow:"none",padding:I.spacing(2),borderRadius:"4px","&:hover":{background:I.colors.emphasize(I.colors.background.secondary,.03)},".label-tag":{marginLeft:I.spacing(1),fontSize:"11px",padding:"2px 6px"}},".card-item-body":{display:"flex",overflow:"hidden"},".card-item-details":{overflow:"hidden"},".card-item-header":{marginBottom:I.spacing(2)},".card-item-type":{color:I.colors.text.secondary,textTransform:"uppercase",fontSize:I.typography.size.sm,fontWeight:I.typography.fontWeightMedium},".card-item-badge":{margin:"6px 0"},".card-item-notice":{fontSize:I.typography.size.sm},".card-item-name":{color:I.colors.text.primary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-label":{marginLeft:I.spacing(1)},".card-item-sub-name":{color:I.colors.text.secondary,overflow:"hidden",textOverflow:"ellipsis",width:"100%"},".card-item-sub-name--header":{color:I.colors.text.secondary,textTransform:"uppercase",marginBottom:I.spacing(2),fontSize:I.typography.size.sm,fontWeight:"bold"},".card-list-layout-grid":{".card-item-type":{display:"inline-block"},".card-item-notice":{fontSize:I.typography.size.sm,display:"inline-block",marginLeft:I.spacing(2)},".card-item-header-action":{float:"right"},".card-item-wrapper":{width:"100%",padding:I.spacing(0,2,2,0)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item-figure":{margin:I.spacing(0,2,2,0),height:"80px",img:{width:"80px"}},".card-item-name":{fontSize:I.typography.h3.fontSize},[I.breakpoints.up("md")]:{".card-item-wrapper":{width:"50%"}},[I.breakpoints.up("lg")]:{".card-item-wrapper":{width:"33.333333%"}},"&.card-list-layout-grid--max-2-col":{[I.breakpoints.up("lg")]:{".card-item-wrapper":{width:"50%"}}}},".card-list-layout-list":{".card-item-wrapper":{padding:0,width:"100%",marginBottom:I.spacing(1)},".card-item-wrapper--clickable":{cursor:"pointer"},".card-item":{borderRadius:"2px"},".card-item-header":{float:"right",textAlign:"right"},".card-item-figure":{margin:I.spacing(0,2,0,0),img:{width:"48px"}},".card-item-name":{fontSize:I.typography.h4.fontSize},".card-item-sub-name":{fontSize:I.typography.size.sm},".layout-selector":{marginRight:0}}})}function l(I){return(0,n.css)({"code, pre, kbd, samp":{...I.typography.code,fontSize:I.typography.bodySmall.fontSize,backgroundColor:I.colors.background.primary,color:I.colors.text.primary,border:`1px solid ${I.colors.border.medium}`,borderRadius:"4px"},code:{whiteSpace:"nowrap",padding:"2px 5px",margin:"0 2px"},pre:{display:"block",margin:I.spacing(0,0,2),lineHeight:I.typography.body.lineHeight,wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-wrap",overflow:"auto",padding:"10px",code:{padding:0,color:"inherit",whiteSpace:"pre-wrap",backgroundColor:"transparent",border:0}}})}function d(I){return(0,n.css)({".react-resizable-handle":{visibility:"hidden"},".react-grid-item, #grafana-portal-container":{touchAction:"initial !important","&:hover":{".react-resizable-handle":{visibility:"visible"}}},[I.breakpoints.down("md")]:{".react-grid-layout":{height:"unset !important"},".react-grid-item":{display:"block !important",transitionProperty:"none !important",position:"unset !important",transform:"translate(0px, 0px) !important",marginBottom:I.spacing(2)},".panel-repeater-grid-item":{height:"auto !important"}},".react-grid-item.react-grid-placeholder":{boxShadow:`0 0 4px ${I.colors.primary.border} !important`,background:`${I.colors.primary.transparent} !important`,zIndex:"-1 !important",opacity:"unset !important"},".react-grid-item > .react-resizable-handle::after":{borderRight:`2px solid ${I.isDark?I.v1.palette.gray1:I.v1.palette.gray3} !important`,borderBottom:`2px solid ${I.isDark?I.v1.palette.gray1:I.v1.palette.gray3} !important`},".react-grid-item.resizing.panel, .react-grid-item.panel.dropdown-menu-open, .react-grid-item.react-draggable-dragging.panel":{zIndex:I.zIndex.dropdown},".react-grid-item.cssTransforms":{transitionProperty:"none !important"},[I.transitions.handleMotion("no-preference")]:{".react-grid-layout--enable-move-animations":{".react-grid-item.cssTransforms":{transitionProperty:"transform !important"}}}})}function o(I){return(0,n.css)({".delta-html":{background:I.colors.background.secondary,paddingTop:"5px",paddingBottom:"5px",userSelect:"none"},".diff-line":{color:I.colors.text.primary,fontFamily:I.typography.fontFamilyMonospace,fontSize:I.typography.size.sm,lineHeight:2,marginBottom:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",position:"relative","&:after":{left:"-40px"}},".diff-line-number":{color:I.colors.text.secondary,display:"inline-block",fontSize:I.typography.size.xs,lineHeight:2.3,textAlign:"right",width:"30px"},".diff-line-number-hide":{visibility:"hidden"},".diff-line-icon":{color:I.colors.text.primary,fontSize:I.typography.size.xs,float:"right",position:"relative",top:"2px",right:"10px"},".diff-json-new, .diff-json-old, .diff-json-deleted, .diff-json-added":{color:I.v1.palette.gray5,".diff-line-number":{color:I.colors.text.primary}},".diff-json-new":{backgroundColor:I.isDark?"#457740":"#664e33"},".diff-json-old":{backgroundColor:I.isDark?"#a04338":"#5a372a"},".diff-json-added":{backgroundColor:I.colors.primary.shade},".diff-json-deleted":{backgroundColor:I.colors.error.shade},".diff-value":{userSelect:"all"},".diff-circle":{marginRight:"0.5em","*":{marginBottom:"1px"}},".diff-circle-changed":{color:"#f59433"},".diff-circle-added":{color:"#29d761"},".diff-circle-deleted":{color:"#fd474a"},".diff-item-added, .diff-item-deleted":{listStyle:"none"},".diff-group":{background:I.colors.background.secondary,fontSize:"16px",fontStyle:"normal",padding:"10px 15px",margin:I.spacing(2,0),".diff-group":{padding:"0 5px"}},".diff-group-name":{display:"inline-block",width:"100%",fontSize:"16px",paddingLeft:"1.75em",margin:"0 0 14px 0"},".diff-summary-key":{paddingLeft:"0.25em"},".diff-list":{paddingLeft:"40px",".diff-list":{paddingLeft:0}},".diff-item":{color:I.v1.palette.gray2,lineHeight:2.5,"> div":{display:"inline"}},".diff-item-changeset":{listStyle:"none"},".diff-label":{backgroundColor:I.colors.action.hover,borderRadius:"3px",color:I.colors.text.primary,display:"inline",fontSize:`${I.typography.fontSize}px`,margin:"0 5px",padding:"3px 8px"},".diff-linenum":{float:"right"},".diff-arrow":{color:I.colors.text.primary},".diff-block":{width:"100%",display:"inline-block"},".diff-block-title":{fontSize:"16px",display:"inline-block"},".diff-title":{fontSize:"16px"},".diff-change-container":{margin:"0 0",paddingLeft:"3em",paddingRight:0},".diff-change-group":{width:"100%",color:I.colors.text.primary,marginBottom:"14px"},".diff-change-item":{display:"inline-block"},".diff-change-title":{fontSize:"16px"},".bullet-position-container":{position:"relative",left:"-6px"},".diff-list-circle":{marginBottom:"3px"}})}var u=e(16797);function c(I){return(0,n.css)({"*, *::before, *::after":{boxSizing:"inherit"},"[tabindex='-1']:focus":{outline:"none !important"},html:{MsOverflowStyle:"scrollbar",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",boxSizing:"border-box",height:"100%",fontSize:`${I.typography.htmlFontSize}px`,fontFamily:I.typography.fontFamily,lineHeight:I.typography.body.lineHeight,fontKerning:"normal"},":root":{colorScheme:I.colors.mode},body:{height:"100%",width:"100%",position:"unset",color:I.colors.text.primary,backgroundColor:I.colors.background.canvas,overflowY:"auto !important",paddingRight:"0 !important","@media print":{overflow:"visible"},"@page":{margin:0,size:"auto",padding:0},...I.typography.body},"h1, .h1":p(I.typography.h1),"h2, .h2":p(I.typography.h2),"h3, .h3":p(I.typography.h3),"h4, .h4":p(I.typography.h4),"h5, .h5":p(I.typography.h5),"h6, .h6":p(I.typography.h6),p:{margin:I.spacing(0,0,2)},textarea:{overflow:"auto",resize:"vertical"},button:{letterSpacing:I.typography.body.letterSpacing,"&:focus-visible":(0,u.getFocusStyles)(I),"&:focus":{outline:"none"}},label:{display:"inline-block"},figure:{margin:I.spacing(0,0,2)},img:{verticalAlign:"middle"},fieldset:{minWidth:0,padding:0,margin:0,border:0},legend:{display:"block",width:"100%",padding:0,marginBottom:I.spacing(1),fontSize:I.spacing(3),lineHeight:"inherit",border:0},"small, .small":{fontSize:I.typography.bodySmall.fontSize,fontWeight:"normal"},"b, strong":{fontWeight:I.typography.fontWeightMedium},em:{fontStyle:"italic",color:I.colors.text.primary},cite:{fontStyle:"normal"},blockquote:{padding:I.spacing(0,0,0,2),margin:I.spacing(0,0,2),borderLeft:`5px solid ${I.v1.palette.gray3}`,p:{marginBottom:0,fontSize:I.typography.fontSize*1.25,fontWeight:300,lineHeight:1.25},small:{display:"block",lineHeight:I.typography.body.lineHeight,color:I.v1.palette.gray2,"&:before":{content:"'\\2014 \\00A0'"}}},"q:before, q:after, blockquote:before, blockquote:after":{content:"''"},address:{display:"block",marginBottom:I.spacing(2),fontStyle:"normal",lineHeight:I.typography.body.lineHeight},"a.external-link":{color:I.colors.text.link,textDecoration:"normal","&:hover":{color:I.colors.text.link,textDecoration:"underline"}},".link":{color:I.colors.text.primary,cursor:"pointer"},".link:hover":{color:I.colors.text.maxContrast},".pointer":{cursor:"pointer"},"audio, canvas, progress, video":{display:"inline-block",verticalAlign:"baseline"},"audio:not([controls])":{display:"none",height:0},"abbr[title]":{borderBottom:"1px dotted",cursor:"help"},dfn:{fontStyle:"italic"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},hr:{marginTop:I.spacing(2),marginBottom:I.spacing(2),border:0,borderTop:`1px solid ${I.colors.border.medium}`},"mark, .mark":{background:I.colors.warning.main},"ul, ol, dl":{marginTop:0,marginBottom:0,padding:0},"ul ul, ul ol, ol ol, ol ul":{marginBottom:0},li:{lineHeight:I.typography.body.lineHeight},dd:{marginBottom:I.spacing(1),marginLeft:0},"dt, dd":{lineHeight:I.typography.body.lineHeight},dt:{fontWeight:I.typography.fontWeightMedium},"button, input, optgroup, select, textarea":{borderRadius:0,color:"inherit",font:"inherit",lineHeight:"inherit",margin:0},optgroup:{fontWeight:"bold"},'button, html input[type="button"], input[type="submit"]':{WebkitAppearance:"button",cursor:"pointer"},'input[type="search"]':{WebkitAppearance:"none"},'input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration':{WebkitAppearance:"none"},table:{backgroundColor:"transparent",borderCollapse:"collapse",borderSpacing:0},caption:{paddingTop:I.spacing(.5),paddingBottom:I.spacing(.5),color:I.colors.text.secondary,textAlign:"left",captionSide:"bottom"},th:{fontWeight:I.typography.fontWeightMedium,textAlign:"left"},"td, th":{padding:0},".muted":{color:I.colors.text.secondary},"a.muted:hover, a.muted:focus":{color:I.colors.text.primary},".text-warning":{color:I.colors.warning.text,"&:hover, &:focus":{color:I.colors.emphasize(I.colors.warning.text,.15)}},".text-error":{color:I.colors.error.text,"&:hover, &:focus":{color:I.colors.emphasize(I.colors.error.text,.15)}},".text-success":{color:"$success-text-color","&:hover, &:focus":{color:I.colors.emphasize(I.colors.success.text,.15)}},a:{cursor:"pointer",color:I.colors.text.primary,textDecoration:"none","&:focus":{outline:"none"},"&:focus-visible":(0,u.getFocusStyles)(I),"&:[disabled]":{cursor:"default",pointerEvents:"none !important"}},"[role='button']":{cursor:"pointer"},"[hidden]":{display:"none !important"},"a, area, button, [role='button'], input, label, select, summary, textarea":{touchAction:"manipulation"},".text-link":{textDecoration:"underline"},".text-left":{textAlign:"left"},".text-right":{textAlign:"right"},".text-center":{textAlign:"center"},".highlight-search-match":{background:I.components.textHighlight.background,color:I.components.textHighlight.text,padding:0},".template-variable":{color:I.colors.primary.text},".modal-header-title":{fontSize:I.typography.size.lg,float:"left",paddingTop:I.spacing(1),margin:I.spacing(0,2)}})}function p(I){return{margin:0,fontSize:I.fontSize,lineHeight:I.lineHeight,fontWeight:I.fontWeight,letterSpacing:I.letterSpacing,fontFamily:I.fontFamily,marginBottom:"0.45em"}}function h(I){return(0,n.css)({"iframe.intercom-borderless-frame":{colorScheme:I.colors.mode}})}function y(I){return(0,n.css)({".filter-table *":{boxSizing:"border-box"},".filter-table":{width:"100%",borderCollapse:"separate",tbody:{"tr:nth-child(odd)":{background:I.colors.emphasize(I.colors.background.primary,.02)}},th:{width:"auto",padding:I.spacing(.5,1),textAlign:"left",lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},td:{padding:I.spacing(.5,1),lineHeight:"30px",height:"30px",whiteSpace:"nowrap"},".link-td":{padding:0,lineHeight:"30px",height:"30px",whiteSpace:"nowrap",a:{display:"block",padding:I.spacing(0,1),height:"30px"}},".ellipsis":{display:"block",width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},".expanded":{borderColor:I.components.panel.background},".expanded > td":{paddingBottom:0},".filter-table__avatar":{width:"25px",height:"25px",borderRadius:"50%"},"&--hover":{"tbody tr:hover":{background:I.colors.emphasize(I.colors.background.primary,.05)}}}})}function f(I){const K=typeof window<"u"&&window.__grafana_public_path__,w=K?`${K}fonts/`:"public/fonts/";return(0,n.css)([{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${w}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Roboto Mono",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${w}roboto/L0xTDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_3vrtSM1J-gEPT5Ese6hmHSh0mQ.woff2') format('woff2')`,unicodeRange:"U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD"}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:400,fontDisplay:"swap",src:`url('${w}inter/Inter-Regular.woff2') format('woff2')`}},{"@font-face":{fontFamily:"Inter",fontStyle:"normal",fontWeight:500,fontDisplay:"swap",src:`url('${w}inter/Inter-Medium.woff2') format('woff2')`}}])}function v(I){return(0,n.css)({"input, button, select, textarea":{fontFamily:I.typography.body.fontFamily,fontSize:I.typography.body.fontSize,fontWeight:I.typography.body.fontWeight,lineHeight:I.typography.body.lineHeight},"input, select":{backgroundColor:I.components.input.background,color:I.components.input.text,border:"none",boxShadow:"none"},"input, textarea":{"&::placeholder":{color:I.colors.text.disabled}},'input[type="number"]::-webkit-outer-spin-button, input[type="number"]::-webkit-inner-spin-button':{WebkitAppearance:"none",margin:0},'input[type="number"]':{MozAppearance:"textfield"},'select, input[type="file"]':{height:I.components.height.md,lineHeight:I.components.height.md},select:{width:"220px",border:`1px solid ${I.components.input.borderColor}`,backgroundColor:I.components.input.background},"select[multiple], select[size], textarea":{height:"auto"},'select:focus, input[type="file"]:focus, input[type="radio"]:focus, input[type="checkbox"]:focus':{outline:"5px auto -webkit-focus-ring-color",outlineOffset:"-2px"},"input[type='file'], input[type='image'], input[type='submit'], input[type='reset'], input[type='button'], input[type='radio'], input[type='checkbox']":{width:"auto"},"input[disabled], select[disabled], textarea[disabled], input[readonly], select[readonly], textarea[readonly]":{cursor:"not-allowed",backgroundColor:I.colors.action.disabledBackground},'input[type="radio"][disabled], input[type="checkbox"][disabled], input[type="radio"][readonly], input[type="checkbox"][readonly]':{cursor:"not-allowed",backgroundColor:"transparent"},"input:-webkit-autofill, input:-webkit-autofill:hover, input:-webkit-autofill:focus, input:-webkit-autofill, textarea:-webkit-autofill, textarea:-webkit-autofill:hover, textarea:-webkit-autofill:focus, select:-webkit-autofill, select:-webkit-autofill:hover, select:-webkit-autofill:focus":{WebkitBoxShadow:`0 0 0px 1000px ${I.components.input.background} inset !important`,WebkitTextFillColor:I.components.input.text,boxShadow:`0 0 0px 1000px ${I.components.input.background} inset`,border:`1px solid ${I.components.input.background}`},".gf-form":{display:"flex",flexDirection:"row",alignItems:"flex-start",textAlign:"left",position:"relative",marginBottom:I.spacing(.5),"&--offset-1":{marginLeft:I.spacing(2)},"&--grow":{flexGrow:1},"&--flex-end":{justifyContent:"flex-end"},"&--align-center":{alignContent:"center"},"&--alt":{flexDirection:"column",alignItems:"flex-start",".gf-form-label":{padding:"4px 0"}}},".gf-form--has-input-icon":{position:"relative",marginRight:I.spacing(.5),".gf-form-input-icon":{position:"absolute",top:"8px",fontSize:I.typography.size.lg,left:"10px",color:I.colors.text.disabled},"> input":{paddingLeft:"35px","&:focus + .gf-form-input-icon":{color:I.colors.text.secondary}},".Select--multi .Select-multi-value-wrapper, .Select-placeholder":{paddingLeft:"30px"}},".gf-form-disabled":{color:I.colors.text.secondary,".gf-form-select-wrapper::after":{color:I.colors.text.secondary},"a, .gf-form-input":{color:I.colors.text.secondary}},".gf-form-group":{marginBottom:I.spacing(5)},".gf-form-inline":{display:"flex",flexDirection:"row",flexWrap:"wrap",alignContent:"flex-start","&--nowrap":{flexWrap:"nowrap"},"&--xs-view-flex-column":{flexDirection:"row",flexWrap:"nowrap",[I.breakpoints.down("sm")]:{flexDirection:"column"}},".select-container":{marginRight:I.spacing(.5)},".gf-form-spacing":{marginRight:I.spacing(.5)}},".gf-form-button-row":{paddingTop:I.spacing(3),"a, button":{marginRight:I.spacing(2)}},".gf-form-label":{display:"flex",alignItems:"center",padding:I.spacing(0,1),flexShrink:0,fontWeight:I.typography.fontWeightMedium,fontSize:I.typography.size.sm,backgroundColor:I.colors.background.secondary,height:"32px",lineHeight:"32px",marginRight:I.spacing(.5),borderRadius:I.shape.radius.default,justifyContent:"space-between",border:"none","&--grow":{flexGrow:1},"&--transparent":{backgroundColor:"transparent",border:0,textAlign:"right",paddingLeft:0},"&--variable":{color:I.colors.primary.text,background:I.components.panel.background,border:`1px solid ${I.components.panel.borderColor}`},"&--btn":{border:"none",borderRadius:I.shape.radius.default,"&:hover":{background:I.colors.background.secondary,color:I.colors.text.primary}},"&:disabled":{color:I.colors.text.secondary}},".gf-form-label + .gf-form-label":{marginRight:I.spacing(.5)},".gf-form-pre":{display:"block !important",flexGrow:1,margin:0,marginRight:I.spacing(.5),border:"1px solid transparent",borderLeft:"none",borderRadius:I.shape.radius.default},".gf-form-textarea":{maxWidth:"650px"},".gf-form-input":{display:"block",width:"100%",height:"32px",padding:I.spacing(0,1),fontSize:I.typography.size.md,lineHeight:"18px",color:I.components.input.text,backgroundColor:I.components.input.background,backgroundImage:"none",backgroundClip:"padding-box",border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,marginRight:I.spacing(.5),whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","&textarea":{overflow:"auto",whiteSpace:"pre-wrap",padding:`6px ${I.spacing(1)}`,minHeight:"32px",height:"auto"},"&::-ms-expand":{backgroundColor:"transparent",border:0,display:"none"},"&:focus":{borderColor:I.colors.primary.border,outline:"none"},"&::placeholder":{color:I.colors.text.disabled,opacity:1},"&:disabled, &[readonly]":{backgroundColor:I.colors.action.disabledBackground,opacity:1},"&:disabled":{cursor:"not-allowed"},"&.gf-size-auto":{width:"auto"},"&--dropdown":{paddingRight:I.spacing(3),position:"relative",display:"flex",alignItems:"center","&::after":{position:"absolute",top:"36%",right:"11px",fontSize:"11px",backgroundColor:"transparent",color:I.colors.text.primary,font:`normal normal normal ${I.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none"}},"&--has-help-icon":{paddingRight:I.spacing(4)}},".gf-form-select-wrapper":{position:"relative",backgroundColor:I.components.input.background,marginRight:I.spacing(.5),".gf-form-select-icon":{position:"absolute",zIndex:1,top:"50%",marginTop:"-7px","+ .gf-form-input":{position:"relative",zIndex:2,paddingLeft:I.spacing(4),backgroundColor:"transparent",option:{color:I.v1.palette.black}}},".gf-form-input":{marginRight:0,lineHeight:"32px"},"select.gf-form-input":{textIndent:"0.01px",textOverflow:"''",paddingRight:I.spacing(4),appearance:"none","&:-moz-focusring":{outline:"none",color:"transparent",textShadow:`0 0 0 ${I.colors.text.primary}`},"&.ng-empty":{color:I.colors.text.secondary}},"&::after":{position:"absolute",top:"36%",right:"11px",backgroundColor:"transparent",color:I.colors.text.primary,font:`normal normal normal ${I.typography.size.sm}/1 FontAwesome`,content:'"\f0d7"',pointerEvents:"none",fontSize:"11px"},"&--has-help-icon":{"&::after":{right:I.spacing(4)}}},".gf-form--v-stretch":{alignItems:"stretch"},".gf-form-btn":{padding:I.spacing(0,1),marginRight:I.spacing(.5),lineHeight:"18px",fontSize:I.typography.size.sm,flexShrink:0,flexGrow:0},".gf-form-help-icon":{flexGrow:0,color:I.colors.text.secondary,"&:hover":{color:I.colors.text.primary}},".cta-form":{position:"relative",padding:I.spacing(3),backgroundColor:I.colors.background.secondary,marginBottom:I.spacing(3),borderTop:`3px solid ${I.colors.success.main}`},".input-small":{width:"90px"}})}function P(I){return(0,n.css)({".json-formatter-row":{fontFamily:"monospace","&, a, a:hover":{color:I.colors.text.primary,textDecoration:"none"},".json-formatter-row":{marginLeft:I.spacing(2)},".json-formatter-children":{"&.json-formatter-empty":{opacity:.5,marginLeft:I.spacing(2),"&::after":{display:"none"},"&.json-formatter-object::after":{content:"'No properties'"},"&.json-formatter-array::after":{content:"'[]'"}}},".json-formatter-string":{color:I.isDark?"#23d662":"green",whiteSpace:"pre-wrap",wordWrap:"break-word",wordBreak:"break-all"},".json-formatter-number":{color:I.isDark?I.colors.primary.text:I.colors.primary.main},".json-formatter-boolean":{color:I.isDark?I.colors.primary.text:I.colors.error.main},".json-formatter-null":{color:I.isDark?"#eec97d":"#855a00"},".json-formatter-undefined":{color:I.isDark?"rgb(239, 143, 190)":"rgb(202, 11, 105)"},".json-formatter-function":{color:I.isDark?"#fd48cb":"#ff20ed"},".json-formatter-url":{textDecoration:"underline",color:I.isDark?"#027bff":I.colors.primary.main,cursor:"pointer"},".json-formatter-bracket":{color:I.isDark?"#9494ff":I.colors.primary.main},".json-formatter-key":{color:I.isDark?"#23a0db":"#00008b",cursor:"pointer",paddingRight:I.spacing(.25),marginRight:I.spacing(.5)},".json-formatter-constructor-name":{cursor:"pointer"},".json-formatter-array-comma":{marginRight:I.spacing(.5)},".json-formatter-toggler":{lineHeight:"16px",fontSize:I.typography.size.xs,verticalAlign:"middle",opacity:.6,cursor:"pointer",paddingRight:I.spacing(.25),"&::after":{display:"inline-block",transition:"transform 100ms ease-in",content:"'\u25BA'"}},"> a > .json-formatter-preview-text":{opacity:0,transition:"opacity 0.15s ease-in",fontStyle:"italic"},"&:hover > a > .json-formatter-preview-text":{opacity:.6},"&.json-formatter-open":{"> .json-formatter-toggler-link .json-formatter-toggler::after":{transform:"rotate(90deg)"},"> .json-formatter-children::after":{display:"inline-block"},"> a > .json-formatter-preview-text":{display:"none"},"&.json-formatter-empty::after":{display:"block"}}}})}function m(I){return(0,n.css)({".gf-form-select-box__control":{width:"100%",marginRight:I.spacing(.5),backgroundColor:I.components.input.background,border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,color:I.components.input.text,cursor:"default",height:I.spacing(4),outline:"none",overflow:"hidden",position:"relative"},".gf-form-select-box__control--is-focused":{backgroundColor:I.components.input.background,borderColor:I.colors.primary.border,outline:"none",boxShadow:`inset 0 1px 1px rgba(0, 0, 0, 0.075), 0 0 8px ${I.colors.primary.border}`},".gf-form-select-box__control--is-disabled":{backgroundColor:I.colors.action.disabledBackground},".gf-form-select-box__control--menu-right":{".gf-form-select-box__menu":{right:0,left:"unset"}},".gf-form-select-box__input":{input:{lineHeight:"inherit"}},".gf-form-select-box__menu":{background:I.colors.background.primary,boxShadow:I.shadows.z3,position:"absolute",zIndex:I.zIndex.dropdown,minWidth:"100%","&-notice--no-options":{backgroundColor:I.components.input.background,padding:"10px"}},".gf-form-select-box__menu-list":{overflowY:"auto",maxHeight:"300px",maxWidth:"600px"},".tag-filter .gf-form-select-box__menu":{width:"100%"},".gf-form-select-box__multi-value":{display:"inline",margin:"0 6px 0 0",cursor:"pointer"},".gf-form-select-box__multi-value__remove":{textAlign:"center",display:"inline-block",marginLeft:"2px",position:"relative"},".gf-form-select-box__multi-value__label":{display:"inline",verticalAlign:"middle"},".gf-form-select-box__option":{borderLeft:"2px solid transparent",whiteSpace:"nowrap",backgroundColor:I.components.input.background,"&.gf-form-select-box__option--is-focused":{color:I.colors.text.primary,background:I.colors.action.hover,borderImage:I.colors.gradients.brandVertical,borderImageSlice:1,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"},"&.gf-form-select-box__option--is-selected":{".fa":{color:I.colors.text.primary}}},".gf-form-select-box__placeholder":{color:I.colors.text.disabled},".gf-form-select-box__control--is-focused .gf-form-select-box__placeholder":{display:"none"},".gf-form-select-box__value-container":{display:"inline-block",padding:"6px 20px 6px 10px",verticalAlign:"middle","> div":{display:"inline-block",verticalAlign:"middle"}},".gf-form-select-box__indicators":{position:"absolute",height:"100%",right:"8px",top:"1px",display:"inline-block",textAlign:"right"},".gf-form-input--form-dropdown":{padding:0,border:0,overflow:"visible",position:"relative"},".gf-form--has-input-icon":{".gf-form-select-box__value-container":{paddingLeft:"30px"}},".gf-form-select-box__desc-option":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%"},".gf-form-select-box__desc-option__body":{display:"flex",flexDirection:"column",flexGrow:1,paddingRight:"10px",fontWeight:I.typography.fontWeightMedium},".gf-form-select-box__desc-option__desc":{fontWeight:"normal",fontSize:I.typography.bodySmall.fontSize,color:I.colors.text.secondary},".gf-form-select-box__desc-option__img":{width:"16px",marginRight:"10px"},".gf-form-select-box__option-group__header":{display:"flex",alignItems:"center",justifyContent:"flex-start",justifyItems:"center",cursor:"pointer",padding:"7px 10px",width:"100%",borderBottom:`1px solid ${I.v1.palette.dark9}`,textTransform:"capitalize",".fa":{paddingRight:"2px"}},".gf-form-select-box-button-select":{height:"auto"},".select-button":{display:"flex",alignItems:"center"}})}function D(I){return(0,n.css)({".markdown-html":{img:{maxWidth:"100%"},"ul, ol":{paddingLeft:I.spacing(3),marginBottom:I.spacing(2)},table:{marginBottom:I.spacing(2),"td, th":{padding:I.spacing(.5,1)},th:{fontWeight:I.typography.fontWeightMedium,background:I.colors.background.secondary}},"table, th, td":{border:`1px solid ${I.colors.border.medium}`,borderCollapse:"collapse"},a:{color:I.colors.text.link,textDecoration:"none","&:hover":{color:I.colors.text.link,textDecoration:"underline"}},"p:last-child":{marginBottom:0},"table:last-child, ul:last-child, ol:last-child":{marginBottom:0}}})}function x(I){const K=I.breakpoints.values.xxl+I.spacing.gridSize*2+I.components.sidemenu.width;return(0,n.css)({".grafana-app":{display:"flex",flexDirection:"column",height:"100vh"},".main-view":{display:"flex",flexDirection:"column",flexGrow:1,position:"relative",minWidth:0},".page-scrollbar-content":{display:"flex",minHeight:"100%",flexDirection:"column",width:"100%",height:"100%"},".page-container":{flexGrow:1,flexBasis:"100%",paddingLeft:I.spacing(2),paddingRight:I.spacing(2),[I.breakpoints.up("sm")]:{margin:I.spacing(0,1)},[I.breakpoints.up("md")]:{margin:I.spacing(0,2)},[`@media (min-width: ${K}px)`]:{maxWidth:`${I.breakpoints.values.xxl}px`,marginLeft:"auto",marginRight:"auto",width:"100%"}},".page-full":{marginLeft:I.spacing(2),paddingLeft:I.spacing(2),paddingRight:I.spacing(2)},".page-body":{padding:I.spacing(1),background:I.components.panel.background,border:`1px solid ${I.components.panel.borderColor}`,marginBottom:"32px",[I.breakpoints.up("md")]:{padding:I.spacing(2)},[I.breakpoints.up("lg")]:{padding:I.spacing(3)}},".page-heading":{fontSize:I.typography.h4.fontSize,marginTop:0,marginBottom:I.spacing(2)},".page-action-bar":{marginBottom:I.spacing(2),display:"flex",alignItems:"flex-start",gap:I.spacing(2)},".page-action-bar--narrow":{marginBottom:0},".page-action-bar__spacer":{width:I.spacing(2),flexGrow:1},".page-sub-heading":{marginBottom:I.spacing(2)},".page-sub-heading-icon":{marginLeft:I.spacing(1),marginTop:I.spacing(.5)},".page-hidden":{display:"none"}})}function E(I){return(0,n.css)({".query-editor-row":{marginBottom:"2px","&--disabled":{".query-keyword":{color:I.colors.text.secondary}}},".query-keyword":{fontWeight:I.typography.fontWeightMedium,color:`${I.colors.primary.text} !important`},".query-part":{backgroundColor:I.colors.background.secondary,"&:hover":{background:I.colors.emphasize(I.colors.background.secondary,.03)}},".query-segment-operator":{color:`${I.v1.palette.orange} !important`},".tight-form-func":{background:I.colors.background.secondary},'input[type="text"].tight-form-func-param':{fontSize:I.typography.bodySmall.fontSize,background:"transparent",border:"none",margin:0,padding:0},".tight-form-func-controls":{textAlign:"center",".fa-arrow-left":{float:"left",position:"relative",top:2},".fa-arrow-right":{float:"right",position:"relative",top:2},".fa-remove":{marginLeft:"10px"}}})}function C(I){return(0,n.css)({".rc-time-picker-input,.rc-time-picker-panel-input-wrap,.rc-time-picker-panel-inner":{backgroundColor:I.components.input.background,color:I.colors.text.secondary,borderColor:I.components.input.borderColor,fontSize:I.typography.body.fontSize},".rc-time-picker-input":{padding:I.spacing(0,1),height:I.spacing(4)},".rc-time-picker-panel":{width:"176px"},".rc-time-picker-panel-select":{width:"50%","&:only-child":{width:"100%"},".rc-time-picker-panel-select-option-selected":{backgroundColor:I.colors.background.secondary},"li:hover":{backgroundColor:I.colors.background.secondary}},".rc-time-picker-panel-narrow":{maxWidth:"none"}})}var b=e(72129);const T=I=>(0,n.css)({".react-loading-skeleton":b.Q});function A(I){return(0,n.css)({".slate-query-field":{fontSize:I.typography.fontSize,fontFamily:I.typography.fontFamilyMonospace,height:"auto",wordBreak:"break-word",overflow:"auto"},".slate-query-field__wrapper":{position:"relative",display:"inline-block",padding:"6px 8px",minHeight:"32px",width:"100%",color:I.colors.text.primary,backgroundColor:I.components.input.background,backgroundImage:"none",border:`1px solid ${I.components.input.borderColor}`,borderRadius:I.shape.radius.default,transition:"all 0.3s",lineHeight:"18px"},".slate-query-field__wrapper--disabled":{backgroundColor:"inherit",cursor:"not-allowed"},".slate-typeahead":{".typeahead":{position:"relative",zIndex:I.zIndex.typeahead,borderRadius:I.shape.radius.default,border:`1px solid ${I.components.panel.borderColor}`,maxHeight:"66vh",overflowY:"scroll",overflowX:"hidden",outline:"none",listStyle:"none",background:I.components.panel.background,color:I.colors.text.primary,boxShadow:I.shadows.z2},".typeahead-group__title":{color:I.colors.text.secondary,fontSize:I.typography.size.sm,lineHeight:I.typography.body.lineHeight,padding:I.spacing(1)},".typeahead-item":{height:"auto",fontFamily:I.typography.fontFamilyMonospace,padding:I.spacing(1,1,1,2),fontSize:I.typography.size.sm,textOverflow:"ellipsis",overflow:"hidden",zIndex:1,display:"block",whiteSpace:"nowrap",cursor:"pointer",transition:"color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), border-color 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), background 0.3s cubic-bezier(0.645, 0.045, 0.355, 1), padding 0.15s cubic-bezier(0.645, 0.045, 0.355, 1)"},".typeahead-item__selected":{backgroundColor:I.isDark?I.v1.palette.dark9:I.v1.palette.gray6,".typeahead-item-hint":{fontSize:I.typography.size.xs,color:I.colors.text.primary,whiteSpace:"normal"}},".typeahead-match":{color:I.v1.palette.yellow,borderBottom:`1px solid ${I.v1.palette.yellow}`,padding:"inherit",background:"inherit"}},".slate-query-field, .prism-syntax-highlight":{".token.comment, .token.block-comment, .token.prolog, .token.doctype, .token.cdata":{color:I.colors.text.secondary},".token.variable, .token.entity":{color:I.colors.text.primary},".token.property, .token.tag, .token.constant, .token.symbol, .token.deleted":{color:I.colors.error.text},".token.attr-value, .token.selector, .token.string, .token.char, .token.builtin, .token.inserted":{color:I.colors.success.text},".token.boolean, .token.number, .token.operator, .token.url":{color:"#fe85fc"},".token.function, .token.attr-name, .token.function-name, .token.atrule, .token.keyword, .token.class-name":{color:I.colors.primary.text},".token.punctuation, .token.regex, .token.important":{color:I.v1.palette.orange},".token.important":{fontWeight:"normal"},".token.bold":{fontWeight:"bold"},".token.italic":{fontStyle:"italic"},".token.entity":{cursor:"help"},".namespace":{opacity:.7}}})}function R(I){return(0,n.css)({".uplot":{fontFamily:"inherit"},".u-select":{background:"rgba(120, 120, 130, 0.2)"},".u-hz .u-cursor-x, .u-vt .u-cursor-y":{borderRight:"1px dashed rgba(120, 120, 130, 0.5)"},".u-hz .u-cursor-y, .u-vt .u-cursor-x":{borderBottom:"1px dashed rgba(120, 120, 130, 0.5)"},".shared-crosshair:not(.plot-active) .u-cursor-pt":{display:"none !important"}})}function S(I,K,w="#fff",U="0px 1px 0 rgba(0, 0, 0, 0.1)"){return{backgroundColor:I,backgroundImage:`linear-gradient(to bottom, ${I}, ${K})`,backgroundRepeat:"repeat-x",color:w,textShadow:U,borderColor:I,"&:hover, &:focus, &:active, &.active, &.disabled, &[disabled]":{color:w,backgroundImage:"none",backgroundColor:I}}}function O(I,K,w,U){return{padding:`${I} ${K}`,fontSize:w,borderRadius:U}}function j(I,K){let w={};for(let U=1;U<=K;U++){const W=`${I.spacing(2*U)} !important`;w[`.width-${U}`]={width:W},w[`.max-width-${U}`]={maxWidth:W,flexGrow:1},w[`.min-width-${U}`]={minWidth:W},w[`.offset-width-${U}`]={marginLeft:W}}return w}function B(I){return(0,n.css)({".highlight-word":{color:I.v1.palette.orange},".hide":{display:"none"},".show":{display:"block"},".invisible":{visibility:"hidden !important"},".absolute":{position:"absolute"},".flex-grow-1":{flexGrow:1},".flex-shrink-1":{flexShrink:1},".flex-shrink-0":{flexShrink:0},".center-vh":{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",justifyItems:"center"},".btn":{display:"inline-flex",alignItems:"center",justifyContent:"center",fontWeight:I.typography.fontWeightMedium,lineHeight:I.typography.body.lineHeight,textAlign:"center",verticalAlign:"middle",cursor:"pointer",border:"none",height:`${I.spacing.gridSize*I.components.height.md}px`,...O(I.spacing(0),I.spacing(2),`${I.typography.fontSize}px`,I.shape.radius.default),"&, &:active, &.active":{"&:focus, &.focus":{outline:"none"}},"&:focus, &:hover":{textDecoration:"none"},"&.focus":{textDecoration:"none"},"&:active, &.active":{backgroundImage:"none",outline:0},"&.disabled, &[disabled], &:disabled":{cursor:"not-allowed",opacity:.65,boxShadow:"none",pointerEvents:"none"}},".btn-small":{...O(I.spacing(.5),I.spacing(1),I.typography.size.sm,I.shape.radius.default),height:`${I.spacing.gridSize*I.components.height.sm}px`},".btn-mini":{...O(I.spacing(.5),I.spacing(1),I.typography.size.sm,I.shape.radius.default),height:`${I.spacing.gridSize*I.components.height.sm}px`},".btn-success, .btn-primary":{...S(I.colors.primary.main,I.colors.primary.shade)},".btn-danger":{...S(I.colors.error.main,I.colors.error.shade)},".btn-secondary":{...S(I.colors.secondary.main,I.colors.secondary.shade,I.colors.text.primary)},".btn-inverse":{...S(I.isDark?I.v1.palette.dark6:I.v1.palette.gray5,I.isDark?I.v1.palette.dark5:I.v1.palette.gray4,I.colors.text.primary),"&":{boxShadow:"none"}},".typeahead":{zIndex:I.zIndex.typeahead},...j(I,30),".row":{display:"flex",flexWrap:"wrap",marginLeft:`calc(${I.spacing(4)} / -2)`,marginRight:`calc(${I.spacing(4)} / -2)`},".container":{marginLeft:"auto",marginRight:"auto",paddingLeft:`calc(${I.spacing(4)} / 2)`,paddingRight:`calc(${I.spacing(4)} / 2)`,[I.breakpoints.up("sm")]:{maxWidth:I.breakpoints.values.sm},[I.breakpoints.up("md")]:{maxWidth:I.breakpoints.values.md},[I.breakpoints.up("lg")]:{maxWidth:I.breakpoints.values.lg},[I.breakpoints.up("xl")]:{maxWidth:I.breakpoints.values.xl}}})}function N(){const I=(0,r.$j)();return(0,t.jsx)(n.Global,{styles:[s(I),g(I),a(I),l(I),o(I),d(I),c(I),h(I),y(I),f(I),v(I),P(I),i(I),D(I),x(I),E(I),C(I),T(I),A(I),R(I),B(I),m(I)]})}},7918:(_,L,e)=>{"use strict";e.d(L,{kH:()=>l.k,Dx:()=>t.D,O4:()=>a,mG:()=>g,fq:()=>n.fq,YF:()=>d,N3:()=>i.N,IS:()=>n.IS,of:()=>n.of,DP:()=>n.DP,$j:()=>n.$j,SL:()=>n.SL,cV:()=>n.cV});var t=e(60578),n=e(40845),r=e(75972);let s;const a=(o="dark")=>s?s(o):(0,r.a)({colors:{mode:o}}).v1,g=o=>(s=o,()=>{s=null});var i=e(3911),l=e(57108),d=e(16797)},50774:(_,L,e)=>{"use strict";e.d(L,{I:()=>t});var t=(n=>(n.GroupTitle="GroupTitle",n))(t||{})},29621:()=>{"use strict"},80186:(_,L,e)=>{"use strict";e.r(L),e.d(L,{CompletionItemKind:()=>a.I,getAvailableIcons:()=>l.GO,getFieldTypeIcon:()=>l.SS,getFieldTypeIconName:()=>l.lV,isIconSize:()=>l.rJ,toIconName:()=>l.Uo});var t=e(64611),n=e.n(t),y={};for(const f in t)f!=="default"&&(y[f]=()=>t[f]);e.d(L,y);var r=e(11866),s=e.n(r),y={};for(const f in r)f!=="default"&&(y[f]=()=>r[f]);e.d(L,y);var a=e(50774),g=e(29621),i=e.n(g),y={};for(const f in g)["default","CompletionItemKind"].indexOf(f)<0&&(y[f]=()=>g[f]);e.d(L,y);var l=e(4025),d=e(19932),o=e.n(d),y={};for(const f in d)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(y[f]=()=>d[f]);e.d(L,y);var u=e(72389),c=e.n(u),y={};for(const f in u)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(y[f]=()=>u[f]);e.d(L,y);var p=e(65484),h=e.n(p),y={};for(const f in p)["default","CompletionItemKind","getAvailableIcons","getFieldTypeIcon","getFieldTypeIconName","isIconSize","toIconName"].indexOf(f)<0&&(y[f]=()=>p[f]);e.d(L,y)},11866:()=>{"use strict"},65484:()=>{"use strict"},19932:()=>{"use strict"},72389:()=>{"use strict"},64611:()=>{"use strict"},40321:(_,L,e)=>{"use strict";e.d(L,{Q:()=>t});const t=(n,r)=>{n.key==="Tab"||n.altKey||n.ctrlKey||n.metaKey||(n.stopPropagation(),n.key==="Escape"&&r())}},24284:(_,L,e)=>{"use strict";e.d(L,{Ih:()=>v,Mk:()=>a,Tj:()=>u,UJ:()=>o,Xw:()=>g,ct:()=>d,mZ:()=>f,nO:()=>l,sg:()=>y,xj:()=>i});var t=e(2543),n=e.n(t),r=e(84140);const s=4,a="rgba(0, 211, 255, 1)",g="rgba(11, 237, 50, 1)",i="rgba(237, 46, 24, 1)",l="rgba(150, 150, 150, 1)",d="rgba(247, 149, 32, 1)",o=.09,u=["#7EB26D","#EAB839","#6ED0E0","#EF843C","#E24D42","#1F78C1","#BA43A9","#705DA0","#508642","#CCA300","#447EBC","#C15C17","#890F02","#0A437C","#6D1F62","#584477","#B7DBAB","#F4D598","#70DBED","#F9BA8F","#F29191","#82B5D8","#E5A8E2","#AEA2E0","#629E51","#E5AC0E","#64B0C8","#E0752D","#BF1B00","#0A50A1","#962D82","#614D93","#9AC48A","#F2C96D","#65C5DB","#F9934E","#EA6460","#5195CE","#D683CE","#806EB7","#3F6833","#967302","#2F575E","#99440A","#58140C","#052B51","#511749","#3F2B5B","#E0F9D7","#FCEACA","#CFFAFF","#F9E2D2","#FCE2DE","#BADFF4","#F9D9F9","#DEDAF7"];function c(P){const m=(0,t.map)(P,p),D=(0,t.sortBy)(m,["h"]),x=(0,t.chunk)(D,s),E=(0,t.map)(x,b=>(0,t.sortBy)(b,"l")),C=(0,t.flattenDeep)((0,t.zip)(...E));return(0,t.map)(C,h)}function p(P){return(0,r.A)(P).toHsl()}function h(P){return(0,r.A)(P).toHexString()}function y(P){return(0,r.A)(P).getBrightness()>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}function f(P,m){const D=(0,r.A)(P),x=D.getBrightness();return D.getAlpha()<.3?m?"rgb(247, 248, 250)":"rgb(32, 34, 38)":x>180?"rgb(32, 34, 38)":"rgb(247, 248, 250)"}let v=c(u)},14555:(_,L,e)=>{"use strict";e.d(L,{F:()=>n,J:()=>t});const t=r=>r().map(s=>({label:s.title,ariaLabel:s.title,url:s.href,target:s.target,icon:`${s.target==="_blank"?"external-link-alt":"link"}`,onClick:s.onClick})),n=r=>/\/explore\?.*&(left|right)=\[(.*\,){2,}(.*){1}\]/.test(r)},40621:(_,L,e)=>{"use strict";e.d(L,{h:()=>t});function t(n,r,s){}},53550:(_,L,e)=>{"use strict";e.d(L,{i:()=>t});function t(n){const s=n.lastIndexOf("."),a=n.substring(s),g=n.substring(0,s);return g.length<16?n:`${g.substring(0,16)}...${a}`}},9830:(_,L,e)=>{"use strict";e.d(L,{I:()=>r});var t=e(2543),n=e.n(t);function r(s,a){let g=0,i=s.indexOf(a);a=a.replace(/\s/g,"");const l=[];if(i!==-1)return{distance:0,found:!0,ranges:[{start:i,end:i+a.length-1}]};for(const d of a){const o=s.indexOf(d,i);if(o===-1)return{distance:1/0,ranges:[],found:!1};if(i!==-1&&(g+=o-i),i=o+1,l.length===0)l.push({start:o,end:o});else{const u=(0,t.last)(l);o===u.end+1?u.end++:l.push({start:o,end:o})}}return{distance:g,ranges:l,found:!0}}},67985:(_,L,e)=>{"use strict";e.d(L,{xj:()=>a.xj,Mk:()=>a.Mk,bk:()=>t,Pw:()=>g.Pw,nO:()=>a.nO,uc:()=>m,Xw:()=>a.Xw,ct:()=>a.ct,UJ:()=>a.UJ,zt:()=>s,yx:()=>i.yx,Tt:()=>y.T,DB:()=>f.DB,hF:()=>P.h,Vr:()=>p.Vr,Tj:()=>a.Tj,h:()=>v.h,It:()=>D.I,Yc:()=>p.Yc,kl:()=>c.k,XJ:()=>u,yC:()=>d.yC,JF:()=>d.JF,MC:()=>d.MC,mZ:()=>a.mZ,sg:()=>a.sg,K:()=>g.K,Fr:()=>l.F,Jl:()=>l.J,dF:()=>i.dF,mO:()=>i.mO,kD:()=>p.kD,RP:()=>g.RP,Ih:()=>a.Ih,CH:()=>h.C,tf:()=>g.tf});var t={};e.r(t),e.d(t,{getNextCharacter:()=>r,getPreviousCousin:()=>n}),typeof window<"u"&&"Element"in window&&!Element.prototype.closest&&(Element.prototype.closest=function(x){const E=(this.document||this.ownerDocument).querySelectorAll(x);let C=this,b;do{for(b=E.length;--b>=0&&E.item(b)!==C;);C=C.parentElement}while(b<0&&C);return C});function n(x,E){let C=x.parentElement.previousSibling,b;for(;C;){if(b=C.querySelector(E),b)return b;C=C.previousSibling}}function r(x){const E=(x||window).getSelection();if(!E||!E.anchorNode)return null;const C=E.getRangeAt(0),b=E.anchorNode.textContent,T=C.startOffset;return b.slice(T,T+1)}var s=e(67892),a=e(24284),g=e(29734),i=e(72307),l=e(14555),d=e(69613);let o=null;function u(){if(o!==null)return o;if(typeof document<"u"){const x=document.createElement("div"),E={width:"100px",height:"100px",position:"absolute",top:"-9999px",overflow:"scroll",MsOverflowStyle:"scrollbar"};Object.keys(E).map(C=>{x.style[C]=E[C]}),document.body.appendChild(x),o=x.offsetWidth-x.clientWidth,document.body.removeChild(x)}else o=0;return o||0}var c=e(90914),p=e(29413),h=e(69731),y=e(75071),f=e(88838),v=e(91040),P=e(40621),m=(x=>(x.id="id",x.title="title",x.subTitle="subTitle",x.mainStat="mainStat",x.secondaryStat="secondaryStat",x.source="source",x.target="target",x.detail="detail__",x.arc="arc__",x.color="color",x))(m||{}),D=e(9830)},91040:(_,L,e)=>{"use strict";e.d(L,{h:()=>s});var t=e(2543),n=e.n(t);const r=(0,t.throttle)((...a)=>{console.log(...a)},500),s=a=>{let g=!1;return typeof window<"u"&&(g=window.localStorage.getItem("grafana.debug")==="true"),{logger:(i,l=!1,...d)=>{},enable:()=>g=!0,disable:()=>g=!1,isEnabled:()=>g}}},29413:(_,L,e)=>{"use strict";e.d(L,{Vr:()=>i,Yc:()=>a,kD:()=>g});let t;const n=new Map,r=500;let s="";function a(){return t||(t=document.createElement("canvas").getContext("2d")),t}function g(l,d,o=400){const u=`${o} ${d}px 'Inter'`,c=l+u,p=n.get(c);if(p)return p;const h=a();s!==u&&(h.font=s=u);const y=h.measureText(l);return n.size===r&&n.clear(),n.set(c,y),y}function i(l,d,o,u,c,p){const h=g(l,14,p),y=d/(h.width+2)*14,f=o/u,v=Math.min(f,y);return Math.min(v,c??v)}},67892:(_,L,e)=>{"use strict";e.r(L),e.d(L,{getChildId:()=>n,renderOrCallToRender:()=>r});var t=e(96540);function n(s){let a;const g=t.Children.only(s);return"id"in g?.props?a=g.props.id:"inputId"in g.props&&(a=g?.props.inputId),typeof a=="string"?a:void 0}function r(s,a){if(t.isValidElement(s)||typeof s=="string"||typeof s=="number")return s;if(typeof s=="function"&&a)return s(a);throw new Error(`${s} is not a React element nor a function that returns React element`)}},75071:(_,L,e)=>{"use strict";e.d(L,{H:()=>g,T:()=>n});var t=e(9830),n=(i=>(i.Word="Word",i.Prefix="Prefix",i.Fuzzy="Fuzzy",i))(n||{});const g={Word:(i,l)=>i.filter(d=>(d.filterText||d.label).includes(l)),Prefix:(i,l)=>i.filter(d=>(d.filterText||d.label).startsWith(l)),Fuzzy:(i,l)=>(l=l.toLowerCase(),i.filter(d=>{const{distance:o,ranges:u,found:c}=(0,t.I)(d.label.toLowerCase(),l);return c?(d.sortValue=o,d.highlightParts=u,!0):!1}))}},72129:(_,L,e)=>{"use strict";e.d(L,{Q:()=>s,j:()=>a});var t=e(74848),n=e(32196);const s={animationName:(0,n.keyframes)({"0%":{opacity:0},"100%":{opacity:1}}),animationDelay:"100ms",animationTimingFunction:"ease-in",animationDuration:"100ms",animationFillMode:"backwards"},a=(g,i)=>Object.assign(g,{Skeleton:d=>(0,t.jsx)(i,{...d,rootProps:{style:s}})})},72307:(_,L,e)=>{"use strict";e.d(L,{dF:()=>r,mO:()=>s,yx:()=>n});var t=e(82611);const n={document:{nodes:[{match:[{type:"paragraph"},{type:"code_block"},{type:"code_line"}]}]},inlines:{}},r=(a,g)=>{const i=a.split(`
`).map(d=>t.Block.create({type:"code_line",nodes:[t.Text.create(d)]})),l=t.Block.create({data:{syntax:g},type:"code_block",nodes:i});return t.Document.create({nodes:[l]})},s=(a,g)=>{const i=r(a,g);return t.Value.create({document:i})}},90914:(_,L,e)=>{"use strict";e.d(L,{k:()=>t});const t=(n,r)=>{let s;if(n.getLinks&&(s=n.getLinks({valueRowIndex:r.index})),!!s){for(let a=0;a<s?.length;a++)if(s[a].onClick){const g=s[a].onClick;s[a].onClick=i=>{i.ctrlKey||i.metaKey||i.shiftKey||(i.preventDefault(),g(i,{field:n,rowIndex:r.index}))}}return s}}},69613:(_,L,e)=>{"use strict";e.d(L,{JF:()=>r,MC:()=>s,yC:()=>a});const t=["#D32D20","#1E72B8","#B240A2","#705DA0","#466803","#497A3C","#3D71AA","#B15415","#890F02","#6E6E6E","#0A437C","#6D1F62","#584477","#4C7A3F","#2F4F4F","#BF1B00","#7662B1","#8A2EB8","#517A00","#000000","#3F6833","#2F575E","#99440A","#AE561A","#0E4AB4","#58140C","#052B51","#511749","#3F2B5B"],n=["#FF7368","#459EE7","#E069CF","#9683C6","#6C8E29","#76AC68","#6AA4E2","#E7823D","#AF3528","#9B9B9B","#3069A2","#934588","#7E6A9D","#88C477","#557575","#E54126","#A694DD","#B054DE","#8FC426","#262626","#658E59","#557D84","#BF6A30","#FF9B53","#3470DA","#7E3A32","#2B5177","#773D6F","#655181"];function r(l=""){const d=g(l.toLowerCase());return Math.abs(d%t.length)}function s(l=""){const d=r(l);return a(d)}function a(l){return{color:t[l],borderColor:n[l]}}function g(l){let d=5381;for(let o=0;o<l.length;o++)d=(d<<5)+d+l.charCodeAt(o);return d}var i={getTagColorsFromName:s}},69731:(_,L,e)=>{"use strict";e.d(L,{C:()=>n});var t=e(96540);function n(){const[r,s]=(0,t.useState)(0);return(0,t.useCallback)(()=>s(a=>a+1),[])}},29734:(_,L,e)=>{"use strict";e.d(L,{K:()=>r,Pw:()=>t,RP:()=>s,tf:()=>n});var t=(a=>(a.onBlur="onBlur",a.onFocus="onFocus",a.onChange="onChange",a))(t||{});const n=(a,g)=>{const i=g.reduce((l,d)=>d.rule(a)?l:l.concat(d.errorMessage),[]);return i.length>0?i:null},r=(a,g)=>g&&g[a],s=(a,g)=>({rule:i=>!!i.match(a),errorMessage:g||"Value is not valid"})},91950:(_,L,e)=>{"use strict";e.d(L,{A:()=>r,f:()=>a});var t=e(2543),n=e.n(t);class r{constructor(i){if(this.columns=[],this.columnMap={},this.rows=[],this.type="table",i){if(i.columns)for(const l of i.columns)this.addColumn(l);if(i.rows)for(const l of i.rows)this.addRow(l)}}sort(i){i.col===null||i.col===void 0||this.columns.length<=i.col||(this.rows.sort((l,d)=>(l=l[i.col],d=d[i.col],+(l==null)-+(d==null)||+(l>d)||-(l<d))),i.desc&&this.rows.reverse(),this.columns[i.col].sort=!0,this.columns[i.col].desc=i.desc)}addColumn(i){this.columnMap[i.text]||(this.columns.push(i),this.columnMap[i.text]=i)}addRow(i){this.rows.push(i)}}function s(g,i,l){let d=!1;for(let o=0;o<g.length;o++)if(i[o]!==void 0&&l[o]!==void 0){if(i[o]!==l[o])return!1}else(i[o]===void 0||l[o]===void 0)&&(d=!0);return d}function a(g,...i){const l=g||new r;if(arguments.length===1)return l;if(arguments.length===2)return l.columns=i[0].hasOwnProperty("columns")?[...i[0].columns]:[],l.rows=i[0].hasOwnProperty("rows")?[...i[0].rows]:[],l;const d=i.filter(f=>!!f.columns),o={},u=d.slice().reduce((f,v)=>(v.columns.forEach(P=>{const{text:m}=P;o[m]===void 0&&(o[m]=f.length,f.push(P))}),f),[]),c=d.map(f=>f.columns.map(v=>o[v.text])),p=d.reduce((f,v,P)=>{const m=c[P];return v.rows.forEach(D=>{const x=[];m.forEach((E,C)=>{x[E]=D[C]}),f.push(x)}),f},[]),h={},y=p.reduce((f,v,P)=>{if(!h[P]){let m=P+1;for(;m<p.length;){const D=(0,t.findIndex)(p,x=>s(u,v,x),m);if(D>-1){const x=p[D];for(let E=0;E<u.length;E++)v[E]===void 0&&x[E]!==void 0&&(v[E]=x[E]);h[D]=x,m=D+1}else break}f.push(v)}return f},[]);return l.columns=u,l.rows=y,l}},97007:(_,L,e)=>{"use strict";e.d(L,{N:()=>n});var t=e(65307);const n=(0,t.VP)("core/cleanUpState")},82467:(_,L,e)=>{"use strict";e.d(L,{Do:()=>t.Do,Vz:()=>n.Vz,YA:()=>n.YA,dx:()=>t.dx});var t=e(16001),n=e(28215)},5108:(_,L,e)=>{"use strict";e.d(L,{x:()=>w});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(40845),g=e(68402),i=e(90613),l=e(94753),d=e(55852),o=e(9025),u=e(8484),c=e(27677),p=e(43907),h=e(67061),y=e(90182),f=e(25469),v=e(17172);class P extends s.Component{constructor(q){super(q),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,r.debounce)(this.search,300,{leading:!0,trailing:!0})}search(q){return this.setState({isLoading:!0}),(0,r.isNil)(q)&&(q=""),(0,v.AI)().get("/api/serviceaccounts/search").then(te=>te.serviceAccounts.map(X=>({id:X.id,value:X.id,label:X.login,imgUrl:X.avatarUrl,login:X.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:q,onSelected:te,inputId:X}=this.props,{isLoading:ee}=this.state;return(0,t.jsx)("div",{className:"service-account-picker","data-testid":"serviceAccountPicker",children:(0,t.jsx)(y.DW,{isClearable:!0,className:q,inputId:X,isLoading:ee,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:te,placeholder:"Start typing to search for service accounts",noOptionsMessage:"No service accounts found","aria-label":"Service Account picker"})})}}class m extends s.Component{constructor(q){super(q),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,r.debounce)(this.search,300,{leading:!0,trailing:!0})}componentDidMount(){const{teamId:q}=this.props;q&&(0,v.AI)().get(`/api/teams/${q}`).then(te=>{this.setState({value:{value:te,label:te.name,imgUrl:te.avatarUrl}})})}search(q){return this.setState({isLoading:!0}),(0,r.isNil)(q)&&(q=""),(0,v.AI)().get(`/api/teams/search?perpage=100&page=1&query=${q}`).then(te=>{const X=te.teams.map(ee=>({value:ee,label:ee.name,imgUrl:ee.avatarUrl}));return this.setState({isLoading:!1}),X})}render(){const{onSelected:q,className:te}=this.props,{isLoading:X,value:ee}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"teamPicker",children:(0,t.jsx)(y.DW,{isLoading:X,defaultOptions:!0,loadOptions:this.debouncedSearch,value:ee,onChange:q,className:te,placeholder:"Select a team",noOptionsMessage:"No teams found","aria-label":"Team picker"})})}}class D extends s.Component{constructor(q){super(q),this.state={isLoading:!1},this.search=this.search.bind(this),this.debouncedSearch=(0,r.debounce)(this.search,300,{leading:!0,trailing:!0})}search(q){return this.setState({isLoading:!0}),(0,r.isNil)(q)&&(q=""),(0,v.AI)().get(`/api/org/users/lookup?query=${q}&limit=100`).then(te=>te.map(X=>({id:X.userId,value:X.userId,label:X.login,imgUrl:X.avatarUrl,login:X.login}))).finally(()=>{this.setState({isLoading:!1})})}render(){const{className:q,onSelected:te,inputId:X}=this.props,{isLoading:ee}=this.state;return(0,t.jsx)("div",{className:"user-picker","data-testid":"userPicker",children:(0,t.jsx)(y.DW,{isClearable:!0,className:q,inputId:X,isLoading:ee,defaultOptions:!0,loadOptions:this.debouncedSearch,onChange:te,placeholder:"Start typing to search for user",noOptionsMessage:"No users found","aria-label":"User picker"})})}}var x=e(24897),E=(Y=>(Y.None="None",Y.Team="Team",Y.User="User",Y.ServiceAccount="ServiceAccount",Y.BuiltInRole="builtInRole",Y))(E||{});const C=({title:Y=(0,u.t)("access-control.add-permission.title","Add permission for"),permissions:q,assignments:te,onAdd:X,onCancel:ee})=>{const[ne,Z]=(0,s.useState)(E.None),[ae,re]=(0,s.useState)(0),[se,de]=(0,s.useState)(0),[le,he]=(0,s.useState)(""),[ie,J]=(0,s.useState)(""),ce=(0,s.useMemo)(()=>{const Pe=[];return te.users&&Pe.push({value:E.User,label:(0,u.t)("access-control.add-permission.user-label","User")}),te.serviceAccounts&&Pe.push({value:E.ServiceAccount,label:(0,u.t)("access-control.add-permission.serviceaccount-label","Service Account")}),te.teams&&Pe.push({value:E.Team,label:(0,u.t)("access-control.add-permission.team-label","Team")}),te.builtInRoles&&Pe.push({value:E.BuiltInRole,label:(0,u.t)("access-control.add-permission.role-label","Role")}),Pe},[te]);(0,s.useEffect)(()=>{q.length>0&&J(q[0])},[q]);const pe=()=>ne===E.Team&&ae>0||ne===E.User&&se>0||ne===E.ServiceAccount&&se>0||E.BuiltInRole&&x.XT.hasOwnProperty(le);return(0,t.jsxs)("div",{className:"cta-form","aria-label":"Permissions slider",children:[(0,t.jsx)(f.J,{onClick:ee}),(0,t.jsx)("h5",{children:Y}),(0,t.jsx)("form",{name:"addPermission",onSubmit:Pe=>{Pe.preventDefault(),X({userId:se,teamId:ae,builtInRole:le,permission:ie,target:ne})},children:(0,t.jsxs)(h.B,{gap:1,direction:"row",children:[(0,t.jsx)(y.l6,{"aria-label":"Role to add new permission to",value:ne,options:ce,onChange:Pe=>Z(Pe.value),disabled:ce.length===0,width:"auto"}),ne===E.User&&(0,t.jsx)(D,{onSelected:Pe=>de(Pe?.value||0)}),ne===E.ServiceAccount&&(0,t.jsx)(P,{onSelected:Pe=>de(Pe?.value||0)}),ne===E.Team&&(0,t.jsx)(m,{onSelected:Pe=>re(Pe.value?.id||0)}),ne===E.BuiltInRole&&(0,t.jsx)(y.l6,{"aria-label":"Built-in role picker",options:Object.values(x.XT).filter(Pe=>Pe!==x.XT.None).map(Pe=>({value:Pe,label:Pe})),onChange:Pe=>he(Pe.value||""),width:"auto"}),(0,t.jsx)(y.l6,{"aria-label":"Permission Level",width:"auto",value:q.find(Pe=>Pe===ie),options:q.map(Pe=>({label:Pe,value:Pe})),onChange:Pe=>J(Pe.value||"")}),(0,t.jsx)(d.$n,{type:"submit",disabled:!pe(),children:(0,t.jsx)(u.x6,{i18nKey:"access-control.add-permissions.save",children:"Save"})})]})})]})};var b=e(56034),T=e(14578);const A=({item:Y,permissionLevels:q,canSet:te,onRemove:X,onChange:ee})=>{const ne=(0,a.of)(B);return(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:R(Y)}),(0,t.jsx)("td",{children:O(Y)}),(0,t.jsx)("td",{children:Y.isInherited&&(0,t.jsx)("em",{className:ne.inherited,children:"Inherited from folder"})}),(0,t.jsx)("td",{children:(0,t.jsx)(y.l6,{disabled:!te||!Y.isManaged,onChange:Z=>ee(Y,Z.value),value:q.find(Z=>Z===Y.permission),options:q.map(Z=>({value:Z,label:Z}))})}),(0,t.jsx)("td",{children:Y.warning?(0,t.jsx)(b.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.a,{marginBottom:1,children:Y.warning}),j(Y)]}),children:(0,t.jsx)(T.I,{name:"exclamation-triangle",className:ne.warning})}):(0,t.jsx)(b.m,{content:j(Y),children:(0,t.jsx)(T.I,{name:"info-circle"})})}),(0,t.jsx)("td",{children:Y.isManaged?(0,t.jsx)(d.$n,{size:"sm",icon:"times",variant:"destructive",disabled:!te,onClick:()=>X(Y),"aria-label":`Remove permission for ${S(Y)}`}):(0,t.jsx)(b.m,{content:Y.isInherited?"Inherited Permission":"Provisioned Permission",children:(0,t.jsx)(d.$n,{size:"sm",icon:"lock","aria-label":"Locked permission indicator"})})})]})},R=Y=>Y.teamId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Y.teamAvatarUrl,alt:`Avatar for team ${Y.teamId}`}):Y.userId?(0,t.jsx)("img",{className:"filter-table__avatar",src:Y.userAvatarUrl,alt:`Avatar for user ${Y.userId}`}):(0,t.jsx)(T.I,{size:"xl",name:"shield"}),S=Y=>Y.userId?Y.userLogin:Y.teamId?Y.team:Y.builtInRole,O=Y=>Y.userId?(0,t.jsxs)("span",{children:[Y.userLogin," "]},"name"):Y.teamId?(0,t.jsxs)("span",{children:[Y.team," "]},"name"):Y.builtInRole?(0,t.jsxs)("span",{children:[Y.builtInRole," "]},"name"):(0,t.jsx)("span",{},"name"),j=Y=>`Actions: ${[...new Set(Y.actions)].sort().join(" ")}`,B=Y=>({warning:(0,n.css)({color:Y.colors.warning.main}),inherited:(0,n.css)({color:Y.colors.text.secondary,flexWrap:"nowrap"})}),N=({title:Y,items:q,compareKey:te,permissionLevels:X,canSet:ee,onRemove:ne,onChange:Z})=>{const ae=(0,s.useMemo)(()=>{const re={};for(let se of q){const de=se[te];if(!re[de]){re[de]=se;continue}if(se.actions.length>re[de].actions.length){re[de]=se;continue}se.actions.length===re[de].actions.length&&!se.isInherited&&(re[de]=se)}return Object.keys(re).map(se=>re[se])},[q,te]);return ae.length===0?null:(0,t.jsx)("div",{children:(0,t.jsxs)("table",{className:"filter-table gf-form-group",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{children:Y}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%"},children:(0,t.jsx)(u.x6,{i18nKey:"access-control.permission-list.permission",children:"Permission"})}),(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)("tbody",{children:ae.map((re,se)=>(0,t.jsx)(A,{item:re,onRemove:ne,onChange:Z,canSet:ee,permissionLevels:X},`${se}-${re.userId}`))})]})})},I="",K={permissions:[],assignments:{teams:!1,users:!1,serviceAccounts:!1,builtInRoles:!1}},w=({title:Y=(0,u.t)("access-control.permissions.title","Permissions"),buttonLabel:q=(0,u.t)("access-control.permissions.add-label","Add a permission"),emptyLabel:te=(0,u.t)("access-control.permissions.no-permissions","There are no permissions"),resource:X,resourceId:ee,canSetPermissions:ne,addPermissionTitle:Z,getWarnings:ae,epilogue:re})=>{const se=(0,a.of)(Q),[de,le]=(0,s.useState)(!1),[he,ie]=(0,s.useState)([]),[J,ce]=(0,s.useState)(K),pe=(0,s.useCallback)(async()=>{let Ve=await W(X,ee);ae&&(Ve=ae(Ve)),ie(Ve)},[X,ee,ae]);(0,s.useEffect)(()=>{U(X).then(Ve=>(ce(Ve),pe()))},[X,ee,pe]);const Pe=Ve=>{let Je=null;Ve.target===E.User||Ve.target===E.ServiceAccount?Je=H(X,ee,Ve.userId,Ve.permission):Ve.target===E.Team?Je=z(X,ee,Ve.teamId,Ve.permission):Ve.target===E.BuiltInRole&&(Je=G(X,ee,Ve.builtInRole,Ve.permission)),Je!==null&&Je.then(pe)},Ie=Ve=>{let Je=null;Ve.userId?Je=H(X,ee,Ve.userId,I):Ve.teamId?Je=z(X,ee,Ve.teamId,I):Ve.isServiceAccount&&Ve.userId?Je=H(X,ee,Ve.userId,I):Ve.builtInRole&&(Je=G(X,ee,Ve.builtInRole,I)),Je!==null&&Je.then(pe)},ge=(Ve,Je)=>{Ve.permission!==Je&&(Ve.userId?Pe({permission:Je,userId:Ve.userId,target:E.User}):Ve.isServiceAccount?Pe({permission:Je,userId:Ve.userId,target:E.User}):Ve.teamId?Pe({permission:Je,teamId:Ve.teamId,target:E.Team}):Ve.builtInRole&&Pe({permission:Je,builtInRole:Ve.builtInRole,target:E.BuiltInRole}))},Se=(0,s.useMemo)(()=>(0,r.sortBy)(he.filter(Ve=>Ve.teamId),["team","isManaged"]),[he]),De=(0,s.useMemo)(()=>(0,r.sortBy)(he.filter(Ve=>Ve.userId&&!Ve.isServiceAccount),["userLogin","isManaged"]),[he]),Ke=(0,s.useMemo)(()=>(0,r.sortBy)(he.filter(Ve=>Ve.userId&&Ve.isServiceAccount),["userLogin","isManaged"]),[he]),Me=(0,s.useMemo)(()=>(0,r.sortBy)(he.filter(Ve=>Ve.builtInRole),["builtInRole","isManaged"]),[he]),be=(0,u.t)("access-control.permissions.role","Role"),we=(0,u.t)("access-control.permissions.user","User"),Be=(0,u.t)("access-control.permissions.serviceaccount","Service Account"),He=(0,u.t)("access-control.permissions.team","Team");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[ne&&X==="folders"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.x6,{i18nKey:"access-control.permissions.permissions-change-warning",children:"This will change permissions for this folder and all its descendants. In total, this will affect:"}),(0,t.jsx)(p.x,{selectedItems:{folder:{[ee]:!0},dashboard:{},panel:{},$all:!1}}),(0,t.jsx)(g.$,{v:2})]}),he.length===0&&(0,t.jsx)(i.a,{children:(0,t.jsx)(l.E,{children:te})}),(0,t.jsx)(N,{title:be,items:Me,compareKey:"builtInRole",permissionLevels:J.permissions,onChange:ge,onRemove:Ie,canSet:ne}),(0,t.jsx)(N,{title:we,items:De,compareKey:"userLogin",permissionLevels:J.permissions,onChange:ge,onRemove:Ie,canSet:ne}),(0,t.jsx)(N,{title:Be,items:Ke,compareKey:"userLogin",permissionLevels:J.permissions,onChange:ge,onRemove:Ie,canSet:ne}),(0,t.jsx)(N,{title:He,items:Se,compareKey:"team",permissionLevels:J.permissions,onChange:ge,onRemove:Ie,canSet:ne}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.$n,{className:se.addPermissionButton,variant:"primary",onClick:()=>le(!0),icon:"plus",children:q},"add-permission"),(0,t.jsx)(o.a,{in:de,children:(0,t.jsx)(C,{title:Z,onAdd:Pe,permissions:J.permissions,assignments:J.assignments,onCancel:()=>le(!1)})})]})]}),re&&re(he)]})},U=async Y=>{try{return await(0,c.AI)().get(`/api/access-control/${Y}/description`)}catch(q){return console.error("failed to load resource description: ",q),K}},W=(Y,q)=>(0,c.AI)().get(`/api/access-control/${Y}/${q}`),H=(Y,q,te,X)=>M(Y,q,"users",te,X),z=(Y,q,te,X)=>M(Y,q,"teams",te,X),G=(Y,q,te,X)=>M(Y,q,"builtInRoles",te,X),M=(Y,q,te,X,ee)=>(0,c.AI)().post(`/api/access-control/${Y}/${q}/${te}/${X}`,{permission:ee}),Q=Y=>({breakdown:(0,n.css)({...Y.typography.bodySmall,color:Y.colors.text.secondary,marginBottom:Y.spacing(2)}),addPermissionButton:(0,n.css)({marginBottom:Y.spacing(2)})})},9025:(_,L,e)=>{"use strict";e.d(L,{a:()=>i});var t=e(74848),n=e(96540),r=e(22669);const s="200px",a=200,g={transition:`max-height ${a}ms ease-in-out`,overflow:"hidden"},i=({children:l,in:d,maxHeight:o=s,style:u=g})=>{const c=(0,n.useRef)(null),p={exited:{maxHeight:0},entering:{maxHeight:o},entered:{maxHeight:"unset",overflow:"visible"},exiting:{maxHeight:0}};return(0,t.jsx)(r.Ay,{in:d,timeout:a,nodeRef:c,children:h=>(0,t.jsx)("div",{style:{...u,...p[h]},ref:c,children:l})})}},75269:(_,L,e)=>{"use strict";e.d(L,{H:()=>r});var t=e(96540),n=e(76888);const r=t.memo(({actions:s})=>{const{chrome:a}=(0,n.Il)();return(0,t.useLayoutEffect)(()=>{a.update({actions:s})}),null});r.displayName="TopNavUpdate"},32209:(_,L,e)=>{"use strict";e.d(L,{J:()=>G,A:()=>M});var t=e(74848),n=e(32196),r=e(96540),s=e(54148),a=e(13544),g=e(32264),i=e(14110),l=e(40845),d=e(14578),o=e(29158),u=e(40276),c=e(67061),p=e(76888),h=e(8484),y=e(91219),f=e(8856),v=e(31678),P=e(27746),m=e(19361),D=e(13884),x=e(57571);function E({handleMegaMenu:Y,handleDockedMenu:q,onClose:te}){const X=(0,l.$j)(),{chrome:ee}=(0,p.Il)(),ne=ee.useState(),Z=C(X);return(0,t.jsxs)("div",{className:Z.header,children:[(0,t.jsxs)(c.B,{alignItems:"center",minWidth:0,gap:.25,children:[(0,t.jsx)(P.I,{narrow:!0,onClick:Y,tooltip:(0,h.t)("navigation.megamenu.close","Close menu"),children:(0,t.jsx)(m.M.MenuLogo,{className:Z.img})}),(0,t.jsx)(D.N,{})]}),(0,t.jsx)(o.K,{id:"dock-menu-button",className:Z.dockMenuButton,tooltip:ne.megaMenuDocked?(0,h.t)("navigation.megamenu.undock","Undock menu"):(0,h.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:q,variant:"secondary"}),(0,t.jsx)(o.K,{className:Z.mobileCloseButton,tooltip:(0,h.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:te,size:"xl",variant:"secondary"})]})}E.displayName="MegaMenuHeader";const C=Y=>({dockMenuButton:(0,n.css)({display:"none",[Y.breakpoints.up("xl")]:{display:"inline-flex"}}),header:(0,n.css)({alignItems:"center",borderBottom:`1px solid ${Y.colors.border.weak}`,display:"flex",gap:Y.spacing(1),justifyContent:"space-between",padding:Y.spacing(0,1,0,.75),height:x.l,minHeight:x.l}),img:(0,n.css)({alignSelf:"center",height:Y.spacing(3),width:Y.spacing(3)}),mobileCloseButton:(0,n.css)({[Y.breakpoints.up("md")]:{display:"none"}})});var b=e(78685),T=e(8887),A=e(94753),R=e(18759);const S=({children:Y})=>{const q=(0,l.of)(O);return(0,t.jsxs)(t.Fragment,{children:[Y,(0,t.jsx)("span",{className:q.highlight})]})},O=Y=>({highlight:(0,n.css)({backgroundColor:Y.colors.success.main,borderRadius:Y.shape.radius.circle,width:"6px",height:"6px",display:"inline-block;",position:"absolute",top:"50%",transform:"translateY(-50%)"})});var j=e(50720);function B({children:Y,isActive:q,onClick:te,target:X,url:ee,onPin:ne,isPinned:Z}){const ae=(0,l.$j)(),re=N(ae,q),se=!X&&ee.startsWith("/")?j.N:"a",de=(0,t.jsxs)("div",{className:re.linkContent,children:[Y,X==="_blank"&&(0,t.jsx)(d.I,{"data-testid":"external-link-icon",name:"external-link-alt"})]});return(0,t.jsxs)("div",{className:(0,n.cx)(re.wrapper,{[re.wrapperActive]:q,[re.wrapperBookmark]:g.$.featureToggles.pinNavItems}),children:[(0,t.jsx)(se,{"data-testid":a.Tp.components.NavMenu.item,className:re.container,href:ee,target:X,onClick:te,...q&&{"aria-current":"page"},children:de}),g.$.featureToggles.pinNavItems&&ee&&ee!=="/bookmarks"&&(0,t.jsx)(o.K,{name:"bookmark",className:"pin-icon",iconType:Z?"solid":"default",onClick:()=>ne(ee),"aria-label":Z?(0,h.t)("navigation.item.remove-bookmark","Remove from Bookmarks"):(0,h.t)("navigation.item.add-bookmark","Add to Bookmarks")})]})}B.displayName="MegaMenuItemText";const N=(Y,q)=>({wrapper:(0,n.css)({display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}),wrapperBookmark:(0,n.css)({".pin-icon":{display:"none"},"&:hover, &:focus-within":{a:{width:"calc(100% - 20px)"},".pin-icon":{display:"inline-flex"}}}),wrapperActive:(0,n.css)({backgroundColor:Y.colors.background.secondary,borderTopRightRadius:Y.shape.radius.default,borderBottomRightRadius:Y.shape.radius.default,position:"relative","&::before":{backgroundImage:Y.colors.gradients.brandVertical,borderRadius:Y.shape.radius.default,content:'" "',display:"block",height:"100%",position:"absolute",transform:"translateX(-50%)",width:Y.spacing(.5)}}),container:(0,n.css)({alignItems:"center",color:q?Y.colors.text.primary:Y.colors.text.secondary,height:"100%",position:"relative",width:"100%","&:hover, &:focus-visible":{color:Y.colors.text.primary,textDecoration:"underline"},"&:focus-visible":{boxShadow:"none",outline:`2px solid ${Y.colors.primary.main}`,outlineOffset:"-2px",transition:"none"}}),linkContent:(0,n.css)({alignItems:"center",display:"flex",gap:"0.5rem",height:"100%",width:"100%",justifyContent:"space-between"})});var I=e(29795);const K=2;function w({link:Y,activeItem:q,level:te=0,onClick:X,onPin:ee,isPinned:ne}){const{chrome:Z}=(0,p.Il)(),re=Z.useState().megaMenuDocked,se=(0,s.zy)(),de=Y.highlightText?S:r.Fragment,le=(0,I.m0)(Y,q),he=Y===q||te===K&&le,[ie,J]=(0,b.A)(`grafana.navigation.expanded[${Y.text}]`,!!le),ce=te<K&&!!(W(Y)||Y.emptyMessage),pe=(0,r.useRef)(null),Pe=g.$.featureToggles.singleTopNav,Ie=(0,l.of)(U);if((0,r.useEffect)(()=>{le&&J(!0)},[le,se,re,J]),(0,r.useEffect)(()=>{he&&pe.current&&H(pe.current)&&pe.current.scrollIntoView({block:"center"})},[he]),!Y.url)return null;let ge=null;Y.icon?ge=(0,t.jsx)(d.I,{className:Ie.icon,name:(0,T.Uo)(Y.icon)??"link",size:"lg"}):Y.img&&(ge=(0,t.jsx)(c.B,{width:3,justifyContent:"center",children:(0,t.jsx)("img",{className:Ie.img,src:Y.img,alt:""})}));function Se(Ke){return Pe?Ke?"angle-up":"angle-down":Ke?"angle-down":"angle-right"}const De=(0,t.jsx)("div",{className:Ie.collapseButtonWrapper,children:ce&&(0,t.jsx)(o.K,{"aria-label":`${ie?"Collapse":"Expand"} section ${Y.text}`,className:Ie.collapseButton,onClick:()=>J(!ie),name:Se(!!ie),size:"md",variant:"secondary"})});return(0,t.jsxs)("li",{ref:pe,className:Ie.listItem,children:[(0,t.jsxs)("div",{className:(0,n.cx)(Ie.menuItem,{[Ie.menuItemWithIcon]:!!(te===0&&ge)}),children:[te!==0&&(0,t.jsx)(R.T,{level:te===K?te-1:te,spacing:3}),te===K&&(0,t.jsx)("div",{className:Ie.itemConnector}),!Pe&&De,(0,t.jsx)("div",{className:Ie.collapsibleSectionWrapper,children:(0,t.jsx)(B,{isActive:he,onClick:()=>{Y.onClick?.(),X?.()},target:Y.target,url:Y.url,onPin:()=>ee(Y),isPinned:ne(Y.url),children:(0,t.jsxs)("div",{className:(0,n.cx)(Ie.labelWrapper,{[Ie.hasActiveChild]:le,[Ie.labelWrapperWithIcon]:!!(te===0&&ge)}),children:[te===0&&ge&&(0,t.jsx)(de,{children:ge}),(0,t.jsx)(A.E,{truncate:!0,children:Y.text})]})})}),Pe&&De]}),ce&&ie&&(0,t.jsx)("ul",{className:Ie.children,children:W(Y)?Y.children.filter(Ke=>!Ke.isCreateAction).map(Ke=>(0,t.jsx)(w,{link:Ke,activeItem:q,onClick:X,level:te+1,onPin:ee,isPinned:ne},`${Y.text}-${Ke.text}`)):(0,t.jsx)("div",{className:Ie.emptyMessage,"aria-live":"polite",children:Y.emptyMessage})})]})}const U=Y=>({icon:(0,n.css)({width:Y.spacing(3)}),img:(0,n.css)({height:Y.spacing(2),width:Y.spacing(2)}),listItem:(0,n.css)({flex:1,maxWidth:"100%"}),menuItem:(0,n.css)({display:"flex",alignItems:"center",gap:Y.spacing(1),height:Y.spacing(4),paddingLeft:Y.spacing(.5),position:"relative"}),menuItemWithIcon:(0,n.css)({paddingLeft:Y.spacing(0)}),collapseButtonWrapper:(0,n.css)({display:"flex",justifyContent:"center",width:Y.spacing(3),flexShrink:0}),itemConnector:(0,n.css)({position:"relative",height:"100%",width:Y.spacing(1.5),"&::before":{borderLeft:`1px solid ${Y.colors.border.medium}`,content:'""',height:"100%",right:0,position:"absolute",transform:"translateX(50%)"}}),collapseButton:(0,n.css)({margin:0}),collapsibleSectionWrapper:(0,n.css)({alignItems:"center",display:"flex",flex:1,height:"100%",minWidth:0}),labelWrapper:(0,n.css)({display:"flex",alignItems:"center",gap:Y.spacing(2),minWidth:0,paddingLeft:Y.spacing(1)}),labelWrapperWithIcon:(0,n.css)({paddingLeft:Y.spacing(.5)}),hasActiveChild:(0,n.css)({color:Y.colors.text.primary}),children:(0,n.css)({display:"flex",listStyleType:"none",flexDirection:"column"}),emptyMessage:(0,n.css)({color:Y.colors.text.secondary,fontStyle:"italic",padding:Y.spacing(1,1.5,1,7)})});function W(Y){return!!(Y.children&&Y.children.length>0)}function H(Y){const q=Y.getBoundingClientRect();return q.bottom<0||q.top>=window.innerHeight}var z=e(21286);const G="300px",M=(0,r.memo)((0,r.forwardRef)(({onClose:Y,...q},te)=>{const X=(0,v.useSelector)(Pe=>Pe.navBarTree),ee=(0,l.of)(Q),ne=(0,s.zy)(),{chrome:Z}=(0,p.Il)(),ae=(0,v.useDispatch)(),re=Z.useState(),[se]=(0,f.o)(),de=(0,z.s)(),le=X.filter(Pe=>Pe.id!=="profile"&&Pe.id!=="help").map(Pe=>(0,I.J0)(Pe,re.megaMenuDocked));if(g.$.featureToggles.pinNavItems){const Pe=(0,I.Wk)(le,"/bookmarks");Pe&&(Pe.children=de.reduce((Ie,ge)=>{const Se=(0,I.Wk)(le,ge);if(!Se)return Ie;const De={id:Se.id,text:Se.text,url:Se.url,parentItem:{id:"bookmarks",text:"Bookmarks"}};return Ie.push((0,I.J0)(De,re.megaMenuDocked)),Ie},[]))}const he=(0,I.A6)(le,re.sectionNav.node,ne.pathname),ie=()=>{Z.setMegaMenuOpen(!re.megaMenuOpen)},J=()=>{Z.setMegaMenuDocked(!re.megaMenuDocked),re.megaMenuDocked&&Z.setMegaMenuOpen(!1),setTimeout(()=>{document.getElementById(re.megaMenuDocked?"mega-menu-toggle":"dock-menu-button")?.focus()})},ce=(0,r.useCallback)(Pe=>!Pe||!de?.length?!1:de?.includes(Pe),[de]),pe=Pe=>{const Ie=Pe.url;if(Ie&&g.$.featureToggles.pinNavItems){const ge=ce(Ie),Se=ge?de.filter(Ke=>Ie!==Ke):[...de,Ie],De=ge?"grafana_nav_item_unpinned":"grafana_nav_item_pinned";(0,i.rR)(De,{path:Ie}),se({patchPrefsCmd:{navbar:{bookmarkUrls:Se}}}).then(Ke=>{Ke.error||ae((0,y.ve)({item:Pe,isSaved:!ge}))})}};return(0,t.jsxs)("div",{"data-testid":a.Tp.components.NavMenu.Menu,ref:te,...q,children:[g.$.featureToggles.singleTopNav?(0,t.jsx)(E,{handleDockedMenu:J,handleMegaMenu:ie,onClose:Y}):(0,t.jsxs)("div",{className:ee.mobileHeader,children:[(0,t.jsx)(d.I,{name:"bars",size:"xl"}),(0,t.jsx)(o.K,{tooltip:(0,h.t)("navigation.megamenu.close","Close menu"),name:"times",onClick:Y,size:"xl",variant:"secondary"})]}),(0,t.jsx)("nav",{className:ee.content,children:(0,t.jsx)(u.E,{showScrollIndicators:!0,hideHorizontalTrack:!0,children:(0,t.jsx)("ul",{className:ee.itemList,"aria-label":(0,h.t)("navigation.megamenu.list-label","Navigation"),children:le.map((Pe,Ie)=>(0,t.jsxs)(c.B,{direction:Ie===0?"row-reverse":"row",alignItems:"start",children:[Ie===0&&!g.$.featureToggles.singleTopNav&&(0,t.jsx)(o.K,{id:"dock-menu-button",className:ee.dockMenuButton,tooltip:re.megaMenuDocked?(0,h.t)("navigation.megamenu.undock","Undock menu"):(0,h.t)("navigation.megamenu.dock","Dock menu"),name:"web-section-alt",onClick:J,variant:"secondary"}),(0,t.jsx)(w,{link:Pe,isPinned:ce,onClick:re.megaMenuDocked?void 0:Y,activeItem:he,onPin:pe})]},Pe.text))})})})]})}));M.displayName="MegaMenu";const Q=Y=>({content:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",minHeight:0,position:"relative"}),mobileHeader:(0,n.css)({display:"flex",justifyContent:"space-between",padding:Y.spacing(1,1,1,2),borderBottom:`1px solid ${Y.colors.border.weak}`,[Y.breakpoints.up("md")]:{display:"none"}}),itemList:(0,n.css)({boxSizing:"border-box",display:"flex",flexDirection:"column",listStyleType:"none",padding:Y.spacing(1,1,2,1),[Y.breakpoints.up("md")]:{width:G}}),dockMenuButton:(0,n.css)({display:"none",position:"relative",top:Y.spacing(1),[Y.breakpoints.up("xl")]:{display:"inline-flex"}})})},21286:(_,L,e)=>{"use strict";e.d(L,{s:()=>s});var t=e(96540),n=e(32264),r=e(8856);const s=()=>{const a=(0,r.Pj)(void 0,{skip:!n.$.bootData.user.isSignedIn}),g=(0,t.useMemo)(()=>a.data?.navbar?.bookmarkUrls||[],[a]);return n.$.featureToggles.pinNavItems?g:[]}},29795:(_,L,e)=>{"use strict";e.d(L,{A6:()=>c,CS:()=>d,J0:()=>o,Wk:()=>h,m0:()=>u});var t=e(14110),n=e(32264),r=e(8484),s=e(28215),a=e(28444),g=e(28138),i=e(38645),l=e(93522);const d=y=>{let f=y.children||[];if(y.id==="help"){const v=()=>{g.A.publish(new a.S8({component:l.N}))};y.children=[...f,...(0,i.Dd)(),...p(),{id:"keyboard-shortcuts",text:(0,r.t)("nav.help/keyboard-shortcuts","Keyboard shortcuts"),icon:"keyboard",onClick:v}]}return y},o=(y,f)=>{const v={...y},P=v.onClick;return v.onClick=()=>{(0,t.rR)("grafana_navigation_item_clicked",{path:v.url??v.id,menuIsDocked:f,itemIsBookmarked:!!(n.$.featureToggles.pinNavItems&&v?.parentItem?.id==="bookmarks"),bookmarkToggleOn:!!n.$.featureToggles.pinNavItems}),P?.()},v.children&&(v.children=v.children.map(m=>o(m,f))),v},u=(y,f)=>!!y.children?.some(v=>v===f?!0:u(v,f)),c=(y,f,v)=>{const{id:P,parentItem:m}=f;if(v==="/")return y.find(D=>D.id===s.Id);if(f.id!=="profile"){for(const D of y){const x=!!(D.id&&D.id===P),E=D.text===f.text&&D.url===f.url;if(x||E)return D;if(D.children){const C=c(D.children,f);if(C)return C}}if(m)return c(y,m)}};function p(){const{buildInfo:y,licenseInfo:f}=n.$,v=f.stateInfo?` (${f.stateInfo})`:"",P=[];return P.push({target:"_blank",id:"version",text:`${y.edition}${v}`,url:f.licenseUrl,icon:"external-link-alt"}),y.hasUpdate&&P.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),P}function h(y,f){for(const v of y){if(v.url===f)return v;if(v.children?.length){const P=h(v.children,f);if(P)return P}}return null}},10804:(_,L,e)=>{"use strict";e.d(L,{K:()=>s});var t=e(74848),n=e(32196),r=e(40845);function s({className:g,leftActionsSeparator:i}){const l=(0,r.of)(a);return i?(0,t.jsx)("div",{className:(0,n.cx)(g,l.leftActionsSeparator)}):(0,t.jsx)("div",{className:(0,n.cx)(g,l.line)})}const a=g=>({leftActionsSeparator:(0,n.css)({display:"flex",flexGrow:1}),line:(0,n.css)({width:1,backgroundColor:g.colors.border.medium,height:24})})},13884:(_,L,e)=>{"use strict";e.d(L,{N:()=>D});var t=e(74848),n=e(32196),r=e(96540),s=e(39601),a=e(32264),g=e(40845),i=e(94753),l=e(60619),d=e(16233),o=e(32931),u=e(31678),c=e(19361),p=e(51986);function h({orgs:E,onSelectChange:C}){const b=(0,g.of)(y);return(0,t.jsx)(p.i,{"aria-label":"Change organization",variant:"secondary",buttonCss:b.buttonCss,size:"md",label:"",fill:"text",isFullWidth:!1,options:E.map(T=>({label:T.name,description:T.role,value:T})),onChange:C,icon:"building"})}const y=E=>({buttonCss:(0,n.css)({color:E.colors.text.secondary,"&:hover":{color:E.colors.text.primary}})});var f=e(90182),v=e(14578);function P({orgs:E,onSelectChange:C}){const b=(0,g.of)(m),{orgName:T,orgId:A,orgRole:R}=d.TP.user,[S,O]=(0,r.useState)(()=>({label:T,value:{role:R,orgId:A,name:T},description:R})),j=B=>{O(B),C(B)};return(0,t.jsx)(f.l6,{"aria-label":"Change organization",width:"auto",value:S,prefix:(0,t.jsx)(v.I,{className:"prefix-icon",name:"building"}),className:b.select,options:E.map(B=>({label:B.name,description:B.role,value:B})),onChange:j})}const m=E=>({select:(0,n.css)({border:"none",background:"none",color:E.colors.text.secondary,"&:hover":{color:E.colors.text.primary,"& .prefix-icon":(0,n.css)({color:E.colors.text.primary})}})});function D(){const E=(0,g.$j)(),C=(0,u.useDispatch)(),b=(0,u.useSelector)(B=>B.organization.userOrgs),T=(0,g.of)(x),A=B=>{B.value&&((0,o.bA)(B.value.orgId),s.Ny.push(`/?orgId=${B.value.orgId}`),window.location.reload())};(0,r.useEffect)(()=>{d.TP.isSignedIn&&!(d.TP.user.authenticatedBy==="apikey"||d.TP.user.authenticatedBy==="render")&&C((0,o.wV)())},[C]);const R=E.breakpoints.values.sm,[S,O]=(0,r.useState)(!a.$.featureToggles.singleTopNav&&!window.matchMedia(`(min-width: ${R}px)`).matches);if((0,l.Y)({breakpoint:R,onChange:B=>{O(!a.$.featureToggles.singleTopNav&&!B.matches)}}),b?.length<=1)return a.$.featureToggles.singleTopNav?(0,t.jsx)("span",{className:T.brandTitle,children:(0,t.jsx)(i.E,{truncate:!0,children:c.M.AppTitle})}):null;const j=S?h:P;return(0,t.jsx)(j,{orgs:b,onSelectChange:A})}const x=E=>({brandTitle:(0,n.css)({paddingLeft:E.spacing(1)})})},57571:(_,L,e)=>{"use strict";e.d(L,{l:()=>t});const t=40},19361:(_,L,e)=>{"use strict";e.d(L,{M:()=>d});var t=e(74848),n=e(32196),r=e(23596),s=e(40845);const a=({className:o,logo:u})=>(0,t.jsx)("img",{className:o,src:`${u||"public/img/grafana_icon.svg"}`,alt:"Grafana"}),g=({className:o,children:u})=>{const c=(0,s.$j)(),p=(0,n.css)({"&:before":{content:'""',position:"fixed",left:0,right:0,bottom:0,top:0,background:`url(public/img/g8_login_${c.isDark?"dark":"light"}.svg)`,backgroundPosition:"top center",backgroundSize:"auto",backgroundRepeat:"no-repeat",opacity:0,transition:"opacity 3s ease-in-out",[c.breakpoints.up("md")]:{backgroundPosition:"center",backgroundSize:"cover"}}});return(0,t.jsx)("div",{className:(0,n.cx)(p,o),children:u})},i=({className:o})=>(0,t.jsx)("img",{className:o,src:"public/img/grafana_icon.svg",alt:"Grafana"}),l=()=>{const o=(0,s.$j)();return(0,n.css)({background:r.MV.alpha(o.colors.background.primary,.7),backgroundSize:"cover"})};class d{static{this.LoginLogo=a}static{this.LoginBackground=g}static{this.MenuLogo=i}static{this.LoginBoxBackground=l}static{this.AppTitle="Grafana"}static{this.LoginTitle="Welcome to Grafana"}static{this.HideEdition=!1}static{this.GetLoginSubTitle=()=>null}}},3984:(_,L,e)=>{"use strict";e.d(L,{Z:()=>t});function t(n,r,s){const a=[];let g=!1,i;function l(d,o=!1){if(g)return;const u=d.url?.split("?")??["",""];let c=u[0];const p=new URLSearchParams(u[1]);if(p.has("editview")&&(c+=`?editview=${p.get("editview")}`),s&&c===s.url){a.unshift({text:s.text,href:d.url??""}),g=!0;return}const h=c.length>0&&i===c;if(i=c,!d.hideFromBreadcrumbs&&!(o&&h)){const f=d.children?.findIndex(v=>v.active)??-1;if(f>0){const v=d.children?.[f];v&&a.unshift({text:v.text,href:v.url??""})}a.unshift({text:d.text,href:d.url??""})}d.parentItem&&l(d.parentItem)}return r&&l(r),l(n,!0),a}},25469:(_,L,e)=>{"use strict";e.d(L,{J:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(29158);const a=({onClick:i,"aria-label":l,style:d})=>{const o=(0,r.of)(g);return(0,t.jsx)(s.K,{"aria-label":l??"Close",className:o,name:"times",onClick:i,style:d,tooltip:"Close"})},g=i=>(0,n.css)({position:"absolute",right:i.spacing(.5),top:i.spacing(1)})},27921:(_,L,e)=>{"use strict";e.d(L,{A:()=>n});var t=e(96540);const n=r=>(0,t.lazy)(r)},38645:(_,L,e)=>{"use strict";e.d(L,{Dd:()=>l,wi:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(32264),a=e(40845),g=e(14578),i=e(8484);let l=()=>[{target:"_blank",id:"documentation",text:(0,i.t)("nav.help/documentation","Documentation"),icon:"document-info",url:"https://grafana.com/docs/grafana/latest/?utm_source=grafana_footer"},{target:"_blank",id:"support",text:(0,i.t)("nav.help/support","Support"),icon:"question-circle",url:"https://grafana.com/products/enterprise/?utm_source=grafana_footer"},{target:"_blank",id:"community",text:(0,i.t)("nav.help/community","Community"),icon:"comments-alt",url:"https://community.grafana.com/?utm_source=grafana_footer"}];function d(y){return{hasReleaseNotes:!0,isBeta:y.includes("-beta")}}function o(y){const{buildInfo:f,licenseInfo:v}=s.$,P=[],m=v.stateInfo?` (${v.stateInfo})`:"";if(y||P.push({target:"_blank",id:"license",text:`${f.edition}${m}`,url:v.licenseUrl}),f.hideVersion)return P;const{hasReleaseNotes:D}=d(f.version);return P.push({target:"_blank",id:"version",text:f.versionString,url:D?"https://github.com/grafana/grafana/blob/main/CHANGELOG.md":void 0}),f.hasUpdate&&P.push({target:"_blank",id:"updateVersion",text:"New version available!",icon:"download-alt",url:"https://grafana.com/grafana/download?utm_source=grafana_footer"}),P}function u(y){l=y}const c=(0,r.memo)(({customLinks:y,hideEdition:f})=>{const v=(y||l()).concat(o(f)),P=(0,a.of)(h);return(0,t.jsx)("footer",{className:P.footer,children:(0,t.jsx)("div",{className:"text-center",children:(0,t.jsx)("ul",{className:P.list,children:v.map((m,D)=>(0,t.jsx)("li",{className:P.listItem,children:(0,t.jsx)(p,{item:m})},D))})})})});c.displayName="Footer";function p({item:y}){const f=y.url?(0,t.jsx)("a",{href:y.url,target:y.target,rel:"noopener noreferrer",id:y.id,children:y.text}):y.text;return(0,t.jsxs)(t.Fragment,{children:[y.icon&&(0,t.jsx)(g.I,{name:y.icon})," ",f]})}const h=y=>({footer:(0,n.css)({...y.typography.bodySmall,color:y.colors.text.primary,display:"block",padding:y.spacing(2,0),position:"relative",width:"98%","a:hover":{color:y.colors.text.maxContrast,textDecoration:"underline"},[y.breakpoints.down("md")]:{display:"none"}}),list:(0,n.css)({listStyle:"none"}),listItem:(0,n.css)({display:"inline-block","&:after":{content:"' | '",padding:y.spacing(0,1)},"&:last-child:after":{content:"''",paddingLeft:0}})})},18759:(_,L,e)=>{"use strict";e.d(L,{T:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(16795);function a({children:i,spacing:l,level:d}){const o=(0,r.of)(g,l,d);return(0,t.jsx)("span",{className:(0,n.css)(o.indentor),children:i})}const g=(i,l,d)=>({indentor:(0,n.css)((0,s.Y)(i,l,o=>({paddingLeft:i.spacing(o*d)})))})},61680:(_,L,e)=>{"use strict";e.d(L,{b:()=>s});var t=e(74848),n=e(96540),r=e(33390);const s=a=>{const{children:g,storageKey:i,defaultValue:l}=a,[d,o]=(0,n.useState)({value:r.A.getObject(a.storageKey,a.defaultValue)});(0,n.useEffect)(()=>{const p=h=>{h.key===i&&o({value:r.A.getObject(a.storageKey,a.defaultValue)})};return window.addEventListener("storage",p),()=>{window.removeEventListener("storage",p)}});const u=p=>{try{r.A.setObject(i,p)}catch(h){console.error(h)}o({value:p})},c=()=>{try{r.A.delete(i)}catch(p){console.log(p)}o({value:l})};return(0,t.jsx)(t.Fragment,{children:g(d.value,u,c)})}},27673:(_,L,e)=>{"use strict";e.d(L,{A:()=>n});var t=e(96540);function n({children:s,onSetScrollRef:a,divId:g}){const i=(0,t.useRef)(null);return(0,t.useEffect)(()=>{a&&a(new r(document.documentElement))},[i,a]),s}class r{constructor(a){this.element=a}get scrollTop(){return this.element.scrollTop}scrollTo(a,g,i=0){if(!(this.element.scrollHeight-this.element.clientHeight-g>=0)&&i<10){requestAnimationFrame(()=>this.scrollTo(a,g,i+1));return}this.element.scrollTo(a,g)}}},60188:(_,L,e)=>{"use strict";e.d(L,{Q:()=>i});var t=e(74848),n=e(2543),r=e.n(n),s=e(96540),a=e(10354),g=e(88575);class i extends s.PureComponent{constructor(){super(...arguments),this.state={text:"",inputCorrected:!1},this.inputRef=s.createRef(),this.updateValue=()=>{const d=this.inputRef.current?.value;let o=!1,u="";const c=this.props.min,p=this.props.max;let h=d!==""?Number(d):void 0;h&&!Number.isNaN(h)&&(c!=null&&h<c?(u=c.toString(),o=!0):p!=null&&h>p?(u=p.toString(),o=!0):u=d??"",this.setState({text:u,inputCorrected:o})),o&&this.updateValueDebounced(),!Number.isNaN(h)&&h!==this.props.value&&this.props.onChange(h)},this.updateValueDebounced=(0,n.debounce)(this.updateValue,500),this.onChange=d=>{this.setState({text:d.currentTarget.value}),this.updateValueDebounced()},this.onKeyPress=d=>{d.key==="Enter"&&this.updateValue()}}componentDidMount(){this.setState({text:isNaN(this.props.value)?"":`${this.props.value}`})}componentDidUpdate(d){if(this.props.value!==d.value){const o=isNaN(this.props.value)?"":`${this.props.value}`;o!==this.state.text&&this.setState({text:o})}}renderInput(){return(0,t.jsx)(a.p,{type:"number",ref:this.inputRef,min:this.props.min,max:this.props.max,step:this.props.step,autoFocus:this.props.autoFocus,value:this.state.text,onChange:this.onChange,onBlur:this.updateValue,onKeyPress:this.onKeyPress,placeholder:this.props.placeholder,disabled:this.props.fieldDisabled,width:this.props.width,suffix:this.props.suffix})}render(){const{inputCorrected:d}=this.state;if(d){let o="",{min:u,max:c}=this.props;return c==null?u!=null&&(o=`< ${u}`):u!=null?o=`${u} < > ${c}`:o=`> ${c}`,(0,t.jsx)(g.D,{invalid:d,error:`Out of range ${o}`,validationMessageHorizontalOverflow:!0,style:{direction:"rtl"},children:this.renderInput()})}return this.renderInput()}}},77268:(_,L,e)=>{"use strict";e.d(L,{a:()=>i});var t=e(74848),n=e(32196),r=e(40845),s=e(83598),a=e(29158),g=e(83876);const i=({value:d,settings:o,onChange:u,details:c})=>{const p=(0,r.$j)(),h=(0,r.of)(l);return(0,t.jsx)(s.sk,{color:d??"",onChange:u,enableNamedColors:o?.enableNamedColors!==!1,children:({ref:y,showColorPicker:f,hideColorPicker:v})=>(0,t.jsxs)("div",{className:h.spot,children:[(0,t.jsx)("div",{className:h.colorPicker,children:(0,t.jsx)(g.q,{ref:y,onClick:f,onMouseLeave:v,color:d?p.visualization.getColorByName(d):p.components.input.borderColor})}),c&&(0,t.jsxs)(t.Fragment,{children:[d?(0,t.jsx)("span",{className:h.colorText,onClick:f,children:d}):(0,t.jsx)("span",{className:h.placeholderText,onClick:f,children:o?.placeholder??"Select color"}),o?.isClearable&&d&&(0,t.jsx)(a.K,{name:"times",onClick:()=>u(void 0),tooltip:"Clear settings"})]})]})})},l=d=>({spot:(0,n.css)({cursor:"pointer",color:d.colors.text.primary,background:d.components.input.background,padding:"3px",height:d.v1.spacing.formInputHeight,border:`1px solid ${d.components.input.borderColor}`,display:"flex",flexDirection:"row",alignItems:"center",alignContent:"flex-end","&:hover":{border:`1px solid ${d.components.input.borderHover}`}}),colorPicker:(0,n.css)({padding:`0 ${d.spacing(1)}`}),colorText:(0,n.css)({flexGrow:2}),placeholderText:(0,n.css)({flexGrow:2,color:d.colors.text.secondary})})},72626:(_,L,e)=>{"use strict";e.d(L,{w:()=>s});var t=e(74848),n=e(96540),r=e(60188);const s=({value:a,onChange:g,item:i})=>{const{settings:l}=i,d=(0,n.useCallback)(o=>{g(l?.integer&&o!==void 0?Math.floor(o):o)},[g,l?.integer]);return(0,t.jsx)(r.Q,{value:a,min:l?.min,max:l?.max,step:l?.step,placeholder:l?.placeholder,onChange:d})}},79648:(_,L,e)=>{"use strict";e.d(L,{H:()=>ye,u:()=>je});var t=e(74848),n=e(69550),r=e(27310),s=e(11261),a=e(50082),g=e(32264),i=e(15292),l=e(94354),d=e(20333),o=e(76218),u=e(96540),c=e(32196),p=e(2543),h=e(47737),y=e(60578),f=e(24284),v=e(10354),P=e(83598),m=e(29158),D=e(55852),x=e(60029),E=e(3911);const C=[{value:a.O.Absolute,label:"Absolute",description:"Pick thresholds based on the absolute values"},{value:a.O.Percentage,label:"Percentage",description:"Pick threshold based on the percent between min/max"}];class b extends u.PureComponent{constructor(Ee){super(Ee),this.onAddThreshold=()=>{const{steps:Ne}=this.state;let Fe=0;Ne.length>1&&(Fe=Ne[Ne.length-1].value+10);let Ue=f.Tj.filter(Ge=>!Ne.some(Qe=>Qe.color===Ge))[1];Ue||(Ue="#CCCCCC");const fe={value:Fe,color:Ue,key:T++},Te=[...Ne,fe];(0,h.RU)(Te),this.setState({steps:Te},()=>{this.latestThresholdInputRef.current&&this.latestThresholdInputRef.current.focus(),this.onChange()})},this.onRemoveThreshold=Ne=>{const{steps:Fe}=this.state;Fe.length&&Ne.key!==Fe[0].key&&this.setState({steps:Fe.filter(Ue=>Ue.key!==Ne.key)},this.onChange)},this.onChangeThresholdValue=(Ne,Fe)=>{const Ue=Ne.target.value.replace(/,/g,"."),fe=parseFloat(Ue),Te=isNaN(fe)?"":fe,Ge=this.state.steps.map(Qe=>(Qe.key===Fe.key&&(Qe={...Qe,value:Te}),Qe));Ge.length&&(Ge[0].value=-1/0),(0,h.RU)(Ge),this.setState({steps:Ge})},this.onChangeThresholdColor=(Ne,Fe)=>{const{steps:Ue}=this.state,fe=Ue.map(Te=>(Te.key===Ne.key&&(Te={...Te,color:Fe}),Te));this.setState({steps:fe},this.onChange)},this.onBlur=()=>{const Ne=[...this.state.steps];(0,h.RU)(Ne),this.setState({steps:Ne},this.onChange)},this.onChange=()=>{this.props.onChange(R(this.props.thresholds,this.state.steps))},this.onModeChanged=Ne=>{this.props.onChange({...this.props.thresholds,mode:Ne})};const Ce=A(Ee.thresholds.steps);Ce[0].value=-1/0,this.state={steps:Ce},this.latestThresholdInputRef=u.createRef()}renderInput(Ee,Ce,Ne){const Fe=this.props.thresholds.mode===a.O.Percentage,Ue=`Threshold ${Ne+1}`;return isFinite(Ee.value)?(0,t.jsx)(v.p,{type:"number",step:"0.0001",onChange:fe=>this.onChangeThresholdValue(fe,Ee),value:Ee.value,"aria-label":Ue,ref:Ne===0?this.latestThresholdInputRef:null,onBlur:this.onBlur,prefix:(0,t.jsxs)("div",{className:Ce.inputPrefix,children:[(0,t.jsx)("div",{className:Ce.colorPicker,children:(0,t.jsx)(P.sk,{color:Ee.color,onChange:fe=>this.onChangeThresholdColor(Ee,fe),enableNamedColors:!0})}),Fe&&(0,t.jsx)("div",{className:Ce.percentIcon,children:"%"})]}),suffix:(0,t.jsx)(m.K,{className:Ce.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveThreshold(Ee),tooltip:`Remove ${Ue}`})},Fe.toString()):(0,t.jsx)(v.p,{type:"text",value:"Base","aria-label":Ue,disabled:!0,prefix:(0,t.jsx)("div",{className:Ce.colorPicker,children:(0,t.jsx)(P.sk,{color:Ee.color,onChange:fe=>this.onChangeThresholdColor(Ee,fe),enableNamedColors:!0})})})}render(){const{thresholds:Ee}=this.props,{steps:Ce}=this.state;return(0,t.jsx)(y.D.Consumer,{children:Ne=>{const Fe=S(Ne);return(0,t.jsxs)("div",{className:Fe.wrapper,children:[(0,t.jsx)(D.$n,{size:"sm",icon:"plus",onClick:()=>this.onAddThreshold(),variant:"secondary",className:Fe.addButton,fullWidth:!0,children:"Add threshold"}),(0,t.jsx)("div",{className:Fe.thresholds,children:Ce.slice(0).reverse().map((Ue,fe)=>(0,t.jsx)("div",{className:Fe.item,children:this.renderInput(Ue,Fe,fe)},`${Ue.key}`))}),(0,t.jsxs)("div",{children:[(0,t.jsx)(x.J,{description:"Percentage means thresholds relative to min & max",children:"Thresholds mode"}),(0,t.jsx)(l.z,{options:C,onChange:this.onModeChanged,value:Ee.mode})]})]})}})}}let T=100;function A(ue){return(!ue||ue.length===0)&&(ue=[{value:-1/0,color:"green"}]),ue.filter((Ee,Ce)=>(0,p.isNumber)(Ee.value)||Ce===0).map(Ee=>({color:Ee.color,value:Ee.value===null?-1/0:Ee.value,key:T++}))}function R(ue,Ee){return{mode:ue.mode??a.O.Absolute,steps:Ee.map(Ne=>{const{key:Fe,...Ue}=Ne;return Ue})}}const S=(0,E.N)(ue=>({wrapper:(0,c.css)`
      display: flex;
      flex-direction: column;
    `,thresholds:(0,c.css)`
      display: flex;
      flex-direction: column;
      margin-bottom: ${ue.spacing(2)};
    `,item:(0,c.css)`
      margin-bottom: ${ue.spacing(1)};

      &:last-child {
        margin-bottom: 0;
      }
    `,colorPicker:(0,c.css)`
      padding: 0 ${ue.spacing(1)};
    `,addButton:(0,c.css)`
      margin-bottom: ${ue.spacing(1)};
    `,percentIcon:(0,c.css)`
      font-size: ${ue.typography.bodySmall.fontSize};
      color: ${ue.colors.text.secondary};
    `,inputPrefix:(0,c.css)`
      display: flex;
      align-items: center;
    `,trashIcon:(0,c.css)`
      color: ${ue.colors.text.secondary};
      cursor: pointer;
      margin-right: 0;

      &:hover {
        color: ${ue.colors.text};
      }
    `}));class O extends u.PureComponent{constructor(Ee){super(Ee)}render(){const{onChange:Ee}=this.props;let Ce=this.props.value;return Ce||(Ce={mode:a.O.Percentage,steps:[]}),(0,t.jsx)(b,{thresholds:Ce,onChange:Ee})}}var j=e(25019),B=e(40845),N=e(66864),I=e(14578),K=e(37390),w=e(80744),U=e(25148),W=e(91076),H=e(51986),z=e(90182);function G({mapping:ue,index:Ee,onChange:Ce,onRemove:Ne,onDuplicate:Fe,showIconPicker:Ue}){const{key:fe,result:Te,id:Ge}=ue,Qe=(0,B.of)(M),st=(0,u.useRef)(null),Xe=(0,u.useCallback)(qe=>{const rt={...ue,result:{...ue.result}};qe(rt),Ce(Ee,rt)},[ue,Ee,Ce]);(0,u.useEffect)(()=>{st.current&&ue.isNew&&(st.current.focus(),Xe(qe=>{qe.isNew=!1}))},[ue,st,Xe]);const ot=qe=>{Xe(rt=>{rt.result.color=qe})},ft=()=>{Xe(qe=>{qe.result.color=void 0})},_e=qe=>{Xe(rt=>{rt.result.icon=qe})},et=()=>{Xe(qe=>{qe.result.icon=void 0})},it=qe=>{Xe(rt=>{rt.key=qe.currentTarget.value})},dt=qe=>{Xe(rt=>{rt.result.text=qe.currentTarget.value})},ze=qe=>{Xe(rt=>{rt.from=parseFloat(qe.currentTarget.value)})},xe=qe=>{Xe(rt=>{rt.to=parseFloat(qe.currentTarget.value)})},Oe=qe=>{Xe(rt=>{rt.pattern=qe.currentTarget.value})},Le=qe=>{Xe(rt=>{rt.specialMatch=qe.value})},Ze=[{label:"Null",value:j.W.Null,description:"Matches null and undefined values"},{label:"NaN",value:j.W.NaN,description:"Matches against Number.NaN (not a number)"},{label:"Null + NaN",value:j.W.NullAndNaN,description:"Matches null, undefined and NaN"},{label:"True",value:j.W.True,description:"Boolean true values"},{label:"False",value:j.W.False,description:"Boolean false values"},{label:"Empty",value:j.W.Empty,description:"Empty string"}];return(0,t.jsx)(W.sx,{draggableId:Ge,index:Ee,children:qe=>(0,t.jsxs)("tr",{className:Qe.dragRow,ref:qe.innerRef,...qe.draggableProps,children:[(0,t.jsx)("td",{children:(0,t.jsx)("div",{className:Qe.dragHandle,...qe.dragHandleProps,children:(0,t.jsx)(I.I,{name:"draggabledots",size:"lg"})})}),(0,t.jsx)("td",{className:Qe.typeColumn,children:ue.type}),(0,t.jsxs)("td",{children:[ue.type===j.d.ValueToText&&(0,t.jsx)(v.p,{ref:st,type:"text",value:fe??"",onChange:it,placeholder:"Exact value to match"}),ue.type===j.d.RangeToText&&(0,t.jsxs)("div",{className:Qe.rangeInputWrapper,children:[(0,t.jsx)(v.p,{type:"number",value:ue.from??"",placeholder:"Range start",onChange:ze,prefix:"From"}),(0,t.jsx)(v.p,{type:"number",value:ue.to??"",placeholder:"Range end",onChange:xe,prefix:"To"})]}),ue.type===j.d.RegexToText&&(0,t.jsx)(v.p,{type:"text",value:ue.pattern??"",placeholder:"Regular expression",onChange:Oe}),ue.type===j.d.SpecialValue&&(0,t.jsx)(z.l6,{value:Ze.find(rt=>rt.value===ue.specialMatch),options:Ze,onChange:Le})]}),(0,t.jsx)("td",{children:(0,t.jsx)(v.p,{type:"text",value:Te.text??"",onChange:dt,placeholder:"Optional display text"})}),(0,t.jsxs)("td",{className:Qe.textAlignCenter,children:[Te.color&&(0,t.jsxs)(N.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(P.sk,{color:Te.color,onChange:ot,enableNamedColors:!0}),(0,t.jsx)(m.K,{name:"times",onClick:ft,tooltip:"Remove color",tooltipPlacement:"top"})]}),!Te.color&&(0,t.jsx)(P.sk,{color:"gray",onChange:ot,enableNamedColors:!0,children:rt=>(0,t.jsx)(D.$n,{variant:"primary",fill:"text",onClick:rt.showColorPicker,ref:rt.ref,size:"sm",children:"Set color"})})]}),Ue&&(0,t.jsx)("td",{className:Qe.textAlignCenter,children:(0,t.jsxs)(N.Gy,{spacing:"sm",justify:"center",children:[(0,t.jsx)(U.n,{onChange:_e,onClear:et,value:Te.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:Te.color}),Te.icon&&(0,t.jsx)(m.K,{name:"times",onClick:et,tooltip:"Remove icon",tooltipPlacement:"top"})]})}),(0,t.jsx)("td",{className:Qe.textAlignCenter,children:(0,t.jsxs)(N.Gy,{spacing:"sm",children:[(0,t.jsx)(m.K,{name:"copy",onClick:()=>Fe(Ee),"data-testid":"duplicate-value-mapping","aria-label":"Duplicate value mapping",tooltip:"Duplicate"}),(0,t.jsx)(m.K,{name:"trash-alt",onClick:()=>Ne(Ee),"data-testid":"remove-value-mapping","aria-label":"Delete value mapping",tooltip:"Delete"})]})})]})},Ge)}const M=ue=>({dragRow:(0,c.css)({position:"relative"}),dragHandle:(0,c.css)({cursor:"grab","&:focus-visible&:after":{bottom:0,content:'""',left:0,position:"absolute",right:0,top:0,outline:`2px solid ${ue.colors.primary.main}`,outlineOffset:"-2px"}}),rangeInputWrapper:(0,c.css)({display:"flex","> div:first-child":{marginRight:ue.spacing(2)}}),regexInputWrapper:(0,c.css)({display:"flex","> div:first-child":{marginRight:ue.spacing(2)}}),typeColumn:(0,c.css)({textTransform:"capitalize",textAlign:"center",width:"1%"}),textAlignCenter:(0,c.css)({textAlign:"center"})});function Q({value:ue,onChange:Ee,onClose:Ce,showIconPicker:Ne}){const Fe=(0,B.of)(Y),[Ue,fe]=(0,u.useState)([]);(0,u.useEffect)(()=>{fe(ne(ue))},[ue]);const Te=_e=>{if(!ue||!_e.destination)return;const et=[...Ue],it=et[_e.source.index];et.splice(_e.source.index,1),et.splice(_e.destination.index,0,it),fe(et)},Ge=(_e,et)=>{const it=[...Ue];it.splice(_e,1,et),fe(it)},Qe=_e=>{const et=[...Ue];et.splice(_e,1),fe(et)},st=[{label:"Value",value:j.d.ValueToText,description:"Match a specific text value"},{label:"Range",value:j.d.RangeToText,description:"Match a numerical range of values"},{label:"Regex",value:j.d.RegexToText,description:"Match a regular expression with replacement"},{label:"Special",value:j.d.SpecialValue,description:"Match on null, NaN, boolean and empty values"}],Xe=_e=>{fe([...Ue,te({type:_e.value,result:{},isNew:!0})])},ot=_e=>{const et=X(Ue[_e]),it=[...Ue];it.splice(_e,0,{...et});for(let dt=_e;dt<Ue.length;dt++)it[dt].result.index=dt;fe(it)},ft=()=>{Ee(ee(Ue)),Ce()};return(0,u.useEffect)(()=>{ue?.length||Xe({value:j.d.ValueToText})},[]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Fe.tableWrap,children:(0,t.jsxs)("table",{className:Fe.editTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{width:"1%"}}),(0,t.jsx)("th",{style:{width:"40%",textAlign:"left"},colSpan:2,children:"Condition"}),(0,t.jsx)("th",{style:{textAlign:"left"},children:"Display text"}),(0,t.jsx)("th",{style:{width:"10%"},children:"Color"}),Ne&&(0,t.jsx)("th",{style:{width:"10%"},children:"Icon"}),(0,t.jsx)("th",{style:{width:"1%"}})]})}),(0,t.jsx)(W.JY,{onDragEnd:Te,children:(0,t.jsx)(W.gL,{droppableId:"sortable-field-mappings",direction:"vertical",children:_e=>(0,t.jsxs)("tbody",{ref:_e.innerRef,..._e.droppableProps,children:[Ue.map((et,it)=>(0,t.jsx)(G,{mapping:et,index:it,onChange:Ge,onRemove:Qe,onDuplicate:ot,showIconPicker:Ne},et.id)),_e.placeholder]})})})]})}),(0,t.jsxs)(K.a.ButtonRow,{leftItems:(0,t.jsx)(H.i,{label:"Add a new mapping",variant:"secondary",size:"md",icon:"plus",menuPlacement:"auto",minWidth:40,options:st,onChange:Xe}),children:[(0,t.jsx)(D.$n,{variant:"secondary",fill:"outline",onClick:Ce,children:"Cancel"}),(0,t.jsx)(D.$n,{variant:"primary",onClick:ft,children:"Update"})]})]})}const Y=ue=>({tableWrap:(0,c.css)`
    max-height: calc(80vh - 170px);
    min-height: 40px;
    overflow: auto;
  `,editTable:(0,c.css)({width:"100%",marginBottom:ue.spacing(2),"thead th":{textAlign:"center"},"tbody tr:hover":{background:ue.colors.action.hover}," th, td":{padding:ue.spacing(1)}})});function q(){return(0,p.uniqueId)("mapping-")}function te(ue){return{type:j.d.ValueToText,result:{},id:q(),...ue}}function X(ue){return{...te(ue),id:q()}}function ee(ue){const Ee=[],Ce={type:j.d.ValueToText,options:{}};return ue.forEach((Ne,Fe)=>{const Ue={...Ne.result,index:Fe};switch((!Ue.text||Ue.text.trim().length===0)&&(Ue.text=void 0),Ne.type){case j.d.ValueToText:Ne.key!=null&&(Ce.options[Ne.key]=Ue);break;case j.d.RangeToText:Ne.from!=null&&Ne.to!=null&&Ee.push({type:Ne.type,options:{from:Ne.from,to:Ne.to,result:Ue}});break;case j.d.RegexToText:Ne.pattern!=null&&Ee.push({type:Ne.type,options:{pattern:Ne.pattern,result:Ue}});break;case j.d.SpecialValue:Ee.push({type:Ne.type,options:{match:Ne.specialMatch,result:Ue}})}}),Object.keys(Ce.options).length>0&&Ee.unshift(Ce),Ee}function ne(ue){const Ee=[];if(ue)for(const Ce of ue)switch(Ce.type){case j.d.ValueToText:for(const Ne in Ce.options)Ee.push(te({type:Ce.type,result:Ce.options[Ne],key:Ne}));break;case j.d.RangeToText:Ee.push(te({type:Ce.type,result:Ce.options.result,from:Ce.options.from??0,to:Ce.options.to??0}));break;case j.d.RegexToText:Ee.push(te({type:Ce.type,result:Ce.options.result,pattern:Ce.options.pattern}));break;case j.d.SpecialValue:Ee.push(te({type:Ce.type,result:Ce.options.result,specialMatch:Ce.options.match??j.W.Null}))}return Ee.sort((Ce,Ne)=>(Ce.result.index??0)>(Ne.result.index??0)?1:-1),Ee}const Z=(0,u.memo)(ue=>{const{value:Ee,onChange:Ce,item:Ne}=ue,Fe=(0,B.of)(ae),Ue=Ne.settings?.icon,[fe,Te]=(0,u.useState)(!1),Ge=(0,u.useCallback)(()=>{Te(!1)},[Te]),Qe=(0,u.useMemo)(()=>ne(Ee),[Ee]),st=(0,u.useCallback)((ot,ft)=>{Qe[ft].result.color=ot,Ce(ee(Qe))},[Qe,Ce]),Xe=(0,u.useCallback)((ot,ft)=>{Qe[ft].result.icon=ot,Ce(ee(Qe))},[Qe,Ce]);return(0,t.jsxs)(N.gW,{children:[(0,t.jsx)("table",{className:Fe.compactTable,children:(0,t.jsx)("tbody",{children:Qe.map((ot,ft)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[ot.type===j.d.ValueToText&&ot.key,ot.type===j.d.RangeToText&&(0,t.jsxs)("span",{children:["[",ot.from," - ",ot.to,"]"]}),ot.type===j.d.RegexToText&&ot.pattern,ot.type===j.d.SpecialValue&&ot.specialMatch]}),(0,t.jsx)("td",{children:(0,t.jsx)(I.I,{name:"arrow-right"})}),(0,t.jsx)("td",{children:ot.result.text}),ot.result.color&&(0,t.jsx)("td",{children:(0,t.jsx)(P.sk,{color:ot.result.color,onChange:_e=>st(_e,ft),enableNamedColors:!0})}),Ue&&ot.result.icon&&(0,t.jsx)("td",{"data-testid":"iconPicker",children:(0,t.jsx)(U.n,{onChange:_e=>Xe(_e,ft),value:ot.result.icon,size:w.Iy.SMALL,folderName:w.Iu.Icon,mediaType:w.zu.Icon,color:ot.result.color})})]},ft.toString()))})}),(0,t.jsxs)(D.$n,{variant:"secondary",size:"sm",fullWidth:!0,onClick:()=>Te(!0),children:[Qe.length>0&&(0,t.jsx)("span",{children:"Edit value mappings"}),Qe.length===0&&(0,t.jsx)("span",{children:"Add value mappings"})]}),(0,t.jsx)(K.a,{isOpen:fe,title:"Value mappings",onDismiss:Ge,className:Fe.modal,closeOnBackdropClick:!1,children:(0,t.jsx)(Q,{value:Ee,onChange:Ce,onClose:Ge,showIconPicker:Ue})})]})});Z.displayName="ValueMappingsEditor";const ae=ue=>({modal:(0,c.css)({width:"980px"}),compactTable:(0,c.css)({width:"100%","tbody td":{padding:ue.spacing(.5)}})});var re=e(59429);const se=({value:ue,onChange:Ee,item:Ce})=>{const{placeholder:Ne,isClearable:Fe}=Ce?.settings??{},Ue=(0,u.useCallback)(fe=>{Ee(fe?.value?.uid)},[Ee]);return(0,t.jsx)(re.b,{isClearable:Fe,defaultOptions:!0,onChange:Ue,placeholder:Ne,value:ue})};var de=e(91890),le=e(13762);const he=({value:ue,onChange:Ee,context:Ce})=>(0,t.jsx)(le.G,{actions:ue,onChange:Ee,data:Ce.data,getSuggestions:()=>Ce.getSuggestions?Ce.getSuggestions(de.uP.Values):[]});var ie=e(77268),J=e(8066),ce=e(24293),pe=e(88575);const Pe=({value:ue,onChange:Ee,item:Ce,id:Ne})=>{const Fe=(0,B.$j)(),Ue=(0,B.of)(ge),fe=(0,J.Hs)(ue?.mode),Ge=(Ce.settings?.byValueSupport?J.uf.list():J.uf.list().filter(ft=>!ft.isByValue)).filter(ft=>!ft.excludeFromPicker).map(ft=>{let _e=ft.isByValue?" (by value)":"";return{value:ft.id,label:`${ft.name}${_e}`,description:ft.description,isContinuous:ft.isContinuous,isByValue:ft.isByValue,component(){return(0,t.jsx)(Ie,{mode:ft,theme:Fe})}}}),Qe=ft=>{Ee({...ue,mode:ft.value})},st=ft=>{Ee({...ue,mode:ot,fixedColor:ft})},Xe=ft=>{Ee({...ue,mode:ot,seriesBy:ft})},ot=ue?.mode??ce.Y.Thresholds;if(ot===ce.Y.Fixed||ot===ce.Y.Shades)return(0,t.jsxs)("div",{className:Ue.group,children:[(0,t.jsx)(z.l6,{minMenuHeight:200,options:Ge,value:ot,onChange:Qe,className:Ue.select,inputId:Ne}),(0,t.jsx)(ie.a,{value:ue?.fixedColor,onChange:st})]});if(Ce.settings?.bySeriesSupport&&fe.isByValue){const ft=[{label:"Last",value:"last"},{label:"Min",value:"min"},{label:"Max",value:"max"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{style:{marginBottom:Fe.spacing(2)},children:(0,t.jsx)(z.l6,{minMenuHeight:200,options:Ge,value:ot,onChange:Qe,inputId:Ne})}),(0,t.jsx)(pe.D,{label:"Color series by",children:(0,t.jsx)(l.z,{value:ue?.seriesBy??"last",options:ft,onChange:Xe})})]})}return(0,t.jsx)(z.l6,{minMenuHeight:200,options:Ge,value:ot,onChange:Qe,inputId:Ne})},Ie=({mode:ue,theme:Ee})=>{if(!ue.getColors)return null;const Ce=ue.getColors(Ee).map(Ee.visualization.getColorByName),Ne={height:"8px",width:"100%",margin:"2px 0",borderRadius:"3px",opacity:1};if(ue.isContinuous)Ne.background=`linear-gradient(90deg, ${Ce.join(",")})`;else{let Fe="",Ue="";for(let fe=0;fe<Ce.length;fe++){const Te=Ce[fe];if(Fe==="")Fe=`linear-gradient(90deg, ${Te} 0%`;else{const Qe=fe/(Ce.length-1)*100;Fe+=`, ${Ue} ${Qe}%, ${Te} ${Qe}%`}Ue=Te}Ne.background=Fe}return(0,t.jsx)("div",{style:Ne})},ge=ue=>({group:(0,c.css)({display:"flex"}),select:(0,c.css)({marginRight:ue.spacing(1),flexGrow:1})});var Se=e(64919);const De=({value:ue,onChange:Ee,context:Ce})=>(0,t.jsx)(Se.e,{links:ue,onChange:Ee,data:Ce.data,getSuggestions:()=>Ce.getSuggestions?Ce.getSuggestions(de.uP.Values):[]});class Ke extends u.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Ee}=this.props,{settings:Ce}=Ee;let Ne=Ee.settings?.options||[];Ce?.getOptions&&(Ne=await Ce.getOptions(this.props.context)),this.state.options!==Ne&&this.setState({isLoading:!1,options:Ne})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Ee){const Ce=Ee.item?.settings,Ne=this.props.item?.settings;if(Ce!==Ne)this.updateOptions();else if(Ne?.getOptions){const Fe=Ee.context?.data,Ue=this.props.context?.data;Fe!==Ue&&this.updateOptions()}}render(){const{options:Ee,isLoading:Ce}=this.state,{value:Ne,onChange:Fe,item:Ue}=this.props,{settings:fe}=Ue;return(0,t.jsx)(z.KF,{isLoading:Ce,value:Ne,defaultValue:Ne,allowCustomValue:fe?.allowCustomValue,onChange:Te=>{Fe(Te.map(Ge=>Ge.value).flatMap(Ge=>Ge!==void 0?[Ge]:[]))},options:Ee})}}var Me=e(72626);class be extends u.PureComponent{constructor(){super(...arguments),this.state={isLoading:!0,options:[]},this.updateOptions=async()=>{const{item:Ee}=this.props,{settings:Ce}=Ee;let Ne=Ee.settings?.options||[];Ce?.getOptions&&(Ne=await Ce.getOptions(this.props.context)),this.state.options!==Ne&&this.setState({isLoading:!1,options:Ne})}}componentDidMount(){this.updateOptions()}componentDidUpdate(Ee){const Ce=Ee.item?.settings,Ne=this.props.item?.settings;if(Ce!==Ne)this.updateOptions();else if(Ne?.getOptions){const Fe=Ee.context?.data,Ue=this.props.context?.data;Fe!==Ue&&this.updateOptions()}}render(){const{options:Ee,isLoading:Ce}=this.state,{value:Ne,onChange:Fe,item:Ue}=this.props,{settings:fe}=Ue;let Te=Ee.find(Ge=>Ge.value===Ne);return!Te&&Ne&&(Te={label:`${Ne}`,value:Ne}),(0,t.jsx)(z.l6,{isLoading:Ce,value:Te,defaultValue:Ne,allowCustomValue:fe?.allowCustomValue,isClearable:fe?.isClearable,onChange:Ge=>Fe(Ge?.value),options:Ee})}}var we=e(57602),Be=e(42734);const He=({value:ue,onChange:Ee,item:Ce,id:Ne})=>(0,t.jsx)(Be.S,{stats:ue,onChange:Ee,allowMultiple:!!Ce.settings?.allowMultiple,defaultStat:Ce.settings?.defaultStat,inputId:Ne});var Ve=e(29286);class Je extends u.PureComponent{constructor(){super(...arguments),this.state={showAdd:!1},this.onRemoveString=Ee=>{const{value:Ce,onChange:Ne}=this.props,Fe=[...Ce];Fe.splice(Ee,1),Ne(Fe)},this.onValueChange=(Ee,Ce)=>{if("key"in Ee&&Ee.key!=="Enter")return;const{value:Ne,onChange:Fe}=this.props,Ue=Ee.currentTarget.value.trim();if(Ce<0){Ue&&(Ee.currentTarget.value="",Fe([...Ne,Ue])),this.setState({showAdd:!1});return}if(!Ue)return this.onRemoveString(Ce);const fe=[...Ne];fe[Ce]=Ue,Fe(fe)}}render(){const{value:Ee,item:Ce}=this.props,{showAdd:Ne}=this.state,Fe=nt(g.$.theme2),Ue=Ce.settings?.placeholder||"Add text";return(0,t.jsxs)("div",{children:[Ee.map((fe,Te)=>(0,t.jsx)(v.p,{className:Fe.textInput,defaultValue:fe||"",onBlur:Ge=>this.onValueChange(Ge,Te),onKeyDown:Ge=>this.onValueChange(Ge,Te),suffix:(0,t.jsx)(I.I,{className:Fe.trashIcon,name:"trash-alt",onClick:()=>this.onRemoveString(Te)})},`${Te}/${fe}`)),Ne?(0,t.jsx)(v.p,{autoFocus:!0,className:Fe.textInput,placeholder:Ue,defaultValue:"",onBlur:fe=>this.onValueChange(fe,-1),onKeyDown:fe=>this.onValueChange(fe,-1),suffix:(0,t.jsx)(I.I,{name:"plus-circle"})}):(0,t.jsx)(D.$n,{icon:"plus",size:"sm",variant:"secondary",onClick:()=>this.setState({showAdd:!0}),children:Ue})]})}}const nt=(0,E.N)(ue=>({textInput:(0,c.css)({marginBottom:"5px","&:hover":{border:`1px solid ${ue.components.input.borderHover}`}}),trashIcon:(0,c.css)({color:ue.colors.text.secondary,cursor:"pointer","&:hover":{color:ue.colors.text.primary}})}));var pt=e(2056);function bt({value:ue,onChange:Ee,item:Ce}){const Ne=(0,B.of)(Tt);return Ce?.settings?.isClearable&&ue!=null?(0,t.jsxs)("div",{className:Ne.wrapper,children:[(0,t.jsx)("span",{className:Ne.first,children:(0,t.jsx)(pt.p,{value:ue,onChange:Ee})}),(0,t.jsx)(m.K,{name:"times",onClick:()=>Ee(void 0),tooltip:"Clear unit selection"})]}):(0,t.jsx)(pt.p,{value:ue,onChange:Ee})}const Tt=ue=>({wrapper:(0,c.css)({width:"100%",display:"flex",flexDirection:"row",alignItems:"center"}),first:(0,c.css)({marginRight:ue.spacing(1),flexGrow:2})}),ye=()=>{const ue={id:"number",name:"Number",description:"Allows numeric values input",editor:Me.w},Ee={id:"slider",name:"Slider",description:"Allows numeric values input",editor:we.G},Ce={id:"text",name:"Text",description:"Allows string values input",editor:Ve.g},Ne={id:"strings",name:"String array",description:"An array of strings",editor:Je},Fe={id:"boolean",name:"Boolean",description:"Allows boolean values input",editor(xe){const{id:Oe,...Le}=xe;return(0,t.jsx)(i.d,{...Le,onChange:Ze=>xe.onChange(Ze.currentTarget.checked)})}},Ue={id:"select",name:"Select",description:"Allows option selection",editor:be},fe={id:"multi-select",name:"Multi select",description:"Allows for multiple option selection",editor:Ke},Te={id:"radio",name:"Radio",description:"Allows option selection",editor(xe){return(0,t.jsx)(l.z,{...xe,options:xe.item.settings?.options})}},Ge={id:"unit",name:"Unit",description:"Allows unit input",editor:bt},Qe={id:"color",name:"Color",description:"Allows color selection",editor(xe){return(0,t.jsx)(ie.a,{value:xe.value,onChange:xe.onChange,settings:xe.item.settings,details:!0})}},st={id:"fieldColor",name:"Field Color",description:"Field color selection",editor:Pe},Xe={id:"links",name:"Links",description:"Allows defining data links",editor:De},ot={id:"actions",name:"Actions",description:"Allows defining actions",editor:he},ft={id:"stats-picker",name:"Stats Picker",editor:He,description:""},_e={id:"timezone",name:"Time zone",description:"Time zone selection",editor:d.U},et={id:"field-name",name:"Field name",description:"Allows selecting a field name from a data frame",editor:o.O};return[Ce,ue,Ee,Fe,Te,Ue,Ge,Xe,ot,ft,Ne,_e,st,Qe,fe,et,{id:"dashboard-uid",name:"Dashboard",description:"Select dashboard",editor:se},{id:"mappings",name:"Mappings",description:"Allows defining value mappings",editor:Z},{id:"thresholds",name:"Thresholds",description:"Allows defining thresholds",editor:O}]},je=()=>{const ue=["Standard options"],Ee={id:"displayName",path:"displayName",name:"Display name",description:"Change the field or series name",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:r.AM,settings:{placeholder:"none",expandTemplateVars:!0},shouldApply:()=>!0,category:ue},Ce={id:"unit",path:"unit",name:"Unit",description:"",editor:n.D.get("unit").editor,override:n.D.get("unit").editor,process:r.OU,settings:{placeholder:"none"},shouldApply:()=>!0,category:ue},Ne={id:"fieldMinMax",path:"fieldMinMax",name:"Field min/max",description:"Calculate min max per field",editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:r.FM,shouldApply:et=>et.type===s.PU.number,showIf:et=>et.min===void 0||et.max===void 0,category:ue},Fe={id:"min",path:"min",name:"Min",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto"},shouldApply:et=>et.type===s.PU.number,category:ue},Ue={id:"max",path:"max",name:"Max",description:"Leave empty to calculate based on all values",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto"},shouldApply:et=>et.type===s.PU.number,category:ue},fe={id:"decimals",path:"decimals",name:"Decimals",editor:n.D.get("number").editor,override:n.D.get("number").editor,process:r.m0,settings:{placeholder:"auto",min:0,max:15,integer:!0},shouldApply:et=>et.type===s.PU.number,category:ue},Te={id:"noValue",path:"noValue",name:"No value",description:"What to show when there is no value",editor:n.D.get("text").editor,override:n.D.get("text").editor,process:r.OU,settings:{placeholder:"-"},shouldApply:()=>!0,category:ue},Ge=g.$.featureToggles.vizActions?"Data links and actions":"Data links",Qe={id:"links",path:"links",name:"Data links",editor:n.D.get("links").editor,override:n.D.get("links").editor,process:r.Ch,settings:{placeholder:"-"},shouldApply:()=>!0,category:[Ge],getItemsCount:et=>et?et.length:0},st={id:"actions",path:"actions",name:"Actions",editor:n.D.get("actions").editor,override:n.D.get("actions").editor,process:r.cz,settings:{placeholder:"-"},shouldApply:()=>!0,category:[Ge],getItemsCount:et=>et?et.length:0,showIf:()=>g.$.featureToggles.vizActions},Xe={id:"color",path:"color",name:"Color scheme",editor:n.D.get("fieldColor").editor,override:n.D.get("fieldColor").editor,process:r.hS,shouldApply:()=>!0,settings:{byValueSupport:!0,preferThresholdsMode:!0},category:ue},ot={id:"mappings",path:"mappings",name:"Value mappings",description:"Modify the display text based on input value",editor:n.D.get("mappings").editor,override:n.D.get("mappings").editor,process:r.xT,settings:{},defaultValue:[],shouldApply:et=>et.type!==s.PU.time,category:["Value mappings"],getItemsCount:et=>et?et.length:0},ft={id:"thresholds",path:"thresholds",name:"Thresholds",editor:n.D.get("thresholds").editor,override:n.D.get("thresholds").editor,process:r.N7,settings:{},defaultValue:{mode:a.O.Absolute,steps:[{value:-1/0,color:"green"},{value:80,color:"red"}]},shouldApply:()=>!0,category:["Thresholds"],getItemsCount:et=>et?et.steps.length:0},_e={id:"filterable",path:"filterable",name:"Ad-hoc filterable",hideFromDefaults:!0,editor:n.D.get("boolean").editor,override:n.D.get("boolean").editor,process:r.FM,shouldApply:()=>!0,settings:{},category:ue};return[Ce,Fe,Ue,Ne,fe,Ee,Xe,Te,Qe,st,ot,ft,_e]}},57602:(_,L,e)=>{"use strict";e.d(L,{G:()=>d});var t=e(74848),n=e(32196),r=e(52762),s=e(10434),a=e(96540),g=e(40845),i=e(24849),l=e(60188);const d=({value:c,onChange:p,item:h})=>{const y=(0,a.useRef)(null),{settings:f}=h,v=f?.min||0,P=f?.max||100,m=f?.step,D=f?.marks||{[v]:v,[P]:P},x=f?.included,E=f?.ariaLabelForHandle,C=75,b=!0,T=(0,g.$j)(),[A,R]=(0,a.useState)(c??v),[S,O]=(0,a.useState)(C);(0,a.useEffect)(()=>{c!=null&&c!==A&&R(c)},[c,A]),(0,a.useEffect)(()=>{const w=getComputedStyle(y.current),U=w.getPropertyValue("font-weight")||"normal",W=w.getPropertyValue("font-size")||"16px",H=w.getPropertyValue("font-family")||"Arial",z="0",G=4,M=8,Q=Math.max((P+(m||0)).toString().length,(P-(m||0)).toString().length)+G,Y=z.repeat(Q),q=o(Y,`${U} ${W} ${H}`);q&&O(q+M*2)},[P,m]);const j=(0,a.useCallback)(w=>{const U=typeof w=="number"?w:w[0];R(U),p&&p(U)},[R,p]),B=(0,a.useCallback)(w=>{let U=w;(Number.isNaN(U)||!U)&&(U=0),R(U),p&&p(U)},[p]),N=(0,i.$)(T,b,!!D),I=u(T,S),K=b?[]:[N.sliderInputVertical];return(0,t.jsxs)("div",{className:(0,n.cx)(N.container,N.slider),children:[(0,t.jsx)(r.Global,{styles:N.slider}),(0,t.jsxs)("div",{className:(0,n.cx)(N.sliderInput,...K),children:[(0,t.jsx)(s.A,{min:v,max:P,step:m,defaultValue:c,value:A,onChange:j,vertical:!b,reverse:!1,ariaLabelForHandle:E,marks:D,included:x}),(0,t.jsx)("span",{className:I.numberInputWrapper,ref:y,children:(0,t.jsx)(l.Q,{value:A,onChange:B,max:P,min:v,step:m})})]})]})};function o(c,p){const y=document.createElement("canvas").getContext("2d");return y?(y.font=p,y.measureText(c).width):null}const u=(c,p)=>({numberInputWrapper:(0,n.css)({marginLeft:c.spacing(3),maxHeight:"32px",maxWidth:p,minWidth:p,overflow:"visible",width:"100%"})})},29286:(_,L,e)=>{"use strict";e.d(L,{g:()=>a});var t=e(74848),n=e(96540),r=e(21744),s=e(10354);const a=({value:g,onChange:i,item:l,suffix:d})=>{const o=l.settings?.useTextarea?r.f:s.p,u=(0,n.useCallback)(c=>{let p=g??"";"key"in c?c.key==="Enter"&&!l.settings?.useTextarea&&(p=c.currentTarget.value.trim()):p=c.currentTarget.value.trim(),p!==g&&i(p===""?void 0:p)},[g,l.settings?.useTextarea,i]);return(0,t.jsx)(o,{placeholder:l.settings?.placeholder,defaultValue:g||"",rows:l.settings?.useTextarea&&l.settings.rows||5,onBlur:u,onKeyDown:u,suffix:d})}},21780:(_,L,e)=>{"use strict";e.d(L,{YW:()=>X,YO:()=>te});var t=e(74848),n=e(32196),r=e(96540),s=e(64388),a=e(32264),g=e(40845),i=e(76888),l=e(57571),d=e(27673),o=e(39419);const u=({isLoading:ne,children:Z,className:ae})=>{let re=ae?(0,t.jsx)("div",{className:ae,children:Z}):Z;return(0,t.jsx)(t.Fragment,{children:ne?(0,t.jsx)(o.A,{}):re})};var c=e(13773),p=e(17172),h=e(94753),y=e(29158),f=e(88575),v=e(10354);const P=({value:ne,onEdit:Z})=>{const ae=(0,g.of)(m),[re,se]=(0,r.useState)(ne),[de,le]=(0,r.useState)(!1),[he,ie]=(0,r.useState)(!1),[J,ce]=(0,r.useState)();(0,r.useEffect)(()=>{se(ne)},[ne]);const pe=(0,r.useCallback)(async Pe=>{const Ie=Pe.currentTarget.value;if(!Ie)ce("Please enter a title");else if(Ie===ne)ce(void 0),le(!1);else{ie(!0);try{await Z(Ie),ce(void 0),le(!1)}catch(ge){(0,p.NF)(ge)?ce(ge.data.message):ge instanceof Error&&ce(ge.message)}ie(!1)}},[Z,ne]);return de?(0,t.jsx)("div",{className:ae.inputContainer,children:(0,t.jsx)(f.D,{className:ae.field,loading:he,invalid:!!J,error:J,children:(0,t.jsx)(v.p,{className:ae.input,defaultValue:re,onKeyDown:Pe=>{Pe.key==="Enter"&&pe(Pe)},autoFocus:!0,onBlur:pe,onChange:Pe=>se(Pe.currentTarget.value),onFocus:()=>le(!0)})})}):(0,t.jsx)("div",{className:ae.textContainer,children:(0,t.jsxs)("div",{className:ae.textWrapper,children:[(0,t.jsx)(h.E,{element:"h1",truncate:!0,children:re}),(0,t.jsx)(y.K,{name:"pen",size:"lg",tooltip:"Edit title",onClick:()=>le(!0)})]})})};P.displayName="EditableTitle";const m=ne=>({textContainer:(0,n.css)({minWidth:0}),field:(0,n.css)({flex:1,left:`calc(-${ne.spacing(1)} - 1px)`,position:"relative",marginBottom:0}),input:(0,n.css)({input:{...ne.typography.h1}}),inputContainer:(0,n.css)({display:"flex",flex:1}),textWrapper:(0,n.css)({alignItems:"center",display:"flex",gap:ne.spacing(1)})});function D({navItem:ne,renderTitle:Z,actions:ae,info:re,subTitle:se,onEditTitle:de}){const le=(0,g.of)(x),he=se??ne.subTitle,ie=de?(0,t.jsx)(P,{value:ne.text,onEdit:de}):(0,t.jsxs)("div",{className:le.title,children:[ne.img&&(0,t.jsx)("img",{className:le.img,src:ne.img,alt:`logo for ${ne.text}`}),Z?Z(ne.text):(0,t.jsx)("h1",{children:ne.text})]});return(0,t.jsxs)("div",{className:le.pageHeader,children:[(0,t.jsxs)("div",{className:le.topRow,children:[(0,t.jsxs)("div",{className:le.titleInfoContainer,children:[ie,re&&(0,t.jsx)(c.Q,{info:re})]}),(0,t.jsx)("div",{className:le.actions,children:ae})]}),he&&(0,t.jsx)("div",{className:le.subTitle,children:he})]})}const x=ne=>({topRow:(0,n.css)({alignItems:"flex-start",display:"flex",flexDirection:"row",flexWrap:"wrap",gap:ne.spacing(1,3)}),title:(0,n.css)({display:"flex",flexDirection:"row",maxWidth:"100%",flex:1,h1:{marginBottom:0}}),actions:(0,n.css)({display:"flex",flexDirection:"row",gap:ne.spacing(1)}),titleInfoContainer:(0,n.css)({display:"flex",label:"title-info-container",flex:1,flexWrap:"wrap",gap:ne.spacing(1,4),justifyContent:"space-between",maxWidth:"100%",minWidth:"200px"}),pageHeader:(0,n.css)({label:"page-header",display:"flex",flexDirection:"column",gap:ne.spacing(1),marginBottom:ne.spacing(2)}),subTitle:(0,n.css)({position:"relative",color:ne.colors.text.secondary}),img:(0,n.css)({width:"32px",height:"32px",marginRight:ne.spacing(2)})});var E=e(63021),C=e(8887),b=e(40675);function T({navItem:ne}){const Z=(0,g.of)(A);return(0,t.jsx)("div",{className:Z.tabsWrapper,children:(0,t.jsx)(E.U,{children:ne.children.map((ae,re)=>{const se=ae.icon?(0,C.Uo)(ae.icon):void 0;return!ae.hideFromTabs&&(0,t.jsx)(b.o,{label:ae.text,active:ae.active,icon:se,counter:ae.tabCounter,href:ae.url,suffix:ae.tabSuffix,onChangeTab:ae.onClick},`${ae.url}-${re}`)})})})}const A=ne=>({tabsWrapper:(0,n.css)({paddingBottom:ne.spacing(3)})});var R=e(13390),S=e(23172),O=e(67061),j=e(32209);function B({children:ne}){const Z=(0,S.k)(),{chrome:ae}=(0,i.Il)(),re=ae.useState(),se=!re.chromeless&&re.megaMenuDocked&&re.megaMenuOpen,de=(0,g.of)(N,Z??0,se);return(0,t.jsx)("div",{"data-testid":R.X.NavToolbar.container,className:de.pageToolbar,children:(0,t.jsx)(O.B,{alignItems:"center",justifyContent:"flex-end",flex:1,wrap:"nowrap",minWidth:0,children:ne})})}const N=(ne,Z,ae)=>({pageToolbar:(0,n.css)({alignItems:"center",backgroundColor:ne.colors.background.primary,borderBottom:`1px solid ${ne.colors.border.weak}`,display:"flex",height:l.l,left:ae?j.J:0,padding:ne.spacing(0,1,0,2),position:"fixed",top:Z,right:0,zIndex:ne.zIndex.navbarFixed})});var I=e(25508),K=e(17422),w=e(99140),U=e(31678);function W(ne,Z){if(Z)return Z;if(ne&&w.M_)return(0,U.useSelector)((0,I.Mz)(H,ae=>(0,K.tc)(ae,ne??"home")))}function H(ne){return ne.navIndex}var z=e(28215),G=e(19361),M=e(3984);function Q(ne,Z){const ae=(0,U.useSelector)(re=>re.navIndex)?.[z.Id];(0,r.useEffect)(()=>{const re=(ne?.node!==ne?.main?ne?.node:ne?.main)??{text:"Grafana"},se=(0,M.Z)(re,Z,ae).map(de=>de.text).reverse();se[se.length-1]=G.M.AppTitle,document.title=se.join(" - ")},[ae,ne,Z])}const Y=(0,r.createContext)(void 0);function q(){const ne=(0,r.useContext)(Y);if(!ne)throw new Error("No PageContext found");return ne}function te(ne){const{setToolbar:Z}=q();(0,r.useEffect)(()=>(Z(ne),()=>Z(void 0)),[Z,ne])}const X=({navId:ne,navModel:Z,pageNav:ae,renderTitle:re,onEditTitle:se,actions:de,subTitle:le,children:he,className:ie,toolbar:J,info:ce,layout:pe=s.k.Standard,onSetScrollRef:Pe,...Ie})=>{const ge=a.$.featureToggles.singleTopNav,[Se,De]=(0,r.useState)(J),Ke=(0,g.of)(ee,!!(ge&&Se)),Me=W(ne,Z),{chrome:be}=(0,i.Il)();Q(Me,ae);const we=ae??Me?.node;return(0,r.useLayoutEffect)(()=>{Me&&be.update({sectionNav:Me,pageNav:ae,layout:pe})},[Me,ae,be,pe]),(0,t.jsx)(Y.Provider,{value:{setToolbar:De},children:(0,t.jsxs)("div",{className:(0,n.cx)(Ke.wrapper,ie),...Ie,children:[ge&&Se&&(0,t.jsx)(B,{children:Se}),pe===s.k.Standard&&(0,t.jsx)(d.A,{divId:"page-scrollbar",onSetScrollRef:Pe,children:(0,t.jsxs)("div",{className:Ke.pageInner,children:[we&&(0,t.jsx)(D,{actions:de,onEditTitle:se,navItem:we,renderTitle:re,info:ce,subTitle:le}),ae&&ae.children&&(0,t.jsx)(T,{navItem:ae}),(0,t.jsx)("div",{className:Ke.pageContent,children:he})]})}),pe===s.k.Canvas&&(0,t.jsx)(d.A,{divId:"page-scrollbar",onSetScrollRef:Pe,children:(0,t.jsx)("div",{className:Ke.canvasContent,children:he})}),pe===s.k.Custom&&he]})})};X.Contents=u;const ee=(ne,Z)=>({wrapper:(0,n.css)({label:"page-wrapper",display:"flex",flex:"1 1 0",flexDirection:"column",marginTop:Z?l.l:0,position:"relative"}),pageContent:(0,n.css)({label:"page-content",flexGrow:1}),primaryBg:(0,n.css)({background:ne.colors.background.primary}),pageInner:(0,n.css)({label:"page-inner",padding:ne.spacing(2),borderBottom:"none",background:ne.colors.background.primary,display:"flex",flexDirection:"column",flexGrow:1,margin:ne.spacing(0,0,0,0),[ne.breakpoints.up("md")]:{padding:ne.spacing(4)}}),canvasContent:(0,n.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:ne.spacing(2),flexBasis:"100%",flexGrow:1})})},13773:(_,L,e)=>{"use strict";e.d(L,{Q:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);function a({info:i}){const l=(0,s.of)(g);return(0,t.jsx)("div",{className:l.container,children:i.map((d,o)=>(0,t.jsxs)(r.Fragment,{children:[(0,t.jsxs)("div",{className:l.infoItem,children:[(0,t.jsx)("div",{className:l.label,children:d.label}),d.value]}),o+1<i.length&&(0,t.jsx)("div",{"data-testid":"page-info-separator",className:l.separator})]},o))})}const g=i=>({container:(0,n.css)({display:"flex",flexDirection:"row",gap:i.spacing(1.5),overflow:"auto"}),infoItem:(0,n.css)({...i.typography.bodySmall,display:"flex",flexDirection:"column",gap:i.spacing(.5)}),label:(0,n.css)({color:i.colors.text.secondary}),separator:(0,n.css)({borderLeft:`1px solid ${i.colors.border.weak}`})})},39419:(_,L,e)=>{"use strict";e.d(L,{A:()=>a});var t=e(74848),n=e(90613),r=e(39558);const a=({pageName:g=""})=>{const i=`Loading ${g}...`;return(0,t.jsx)(n.a,{display:"flex",alignItems:"center",direction:"column",justifyContent:"center",paddingTop:10,children:(0,t.jsx)(r._,{text:i})})}},7392:(_,L,e)=>{"use strict";e.d(L,{L:()=>i});var t=e(74848),n=e(32196),r=e(13544),s=e(40845),a=e(69529),g=e(72109);function i({entity:d="Page"}){const o=(0,s.of)(l);return(0,t.jsx)("div",{className:o.container,"data-testid":r.Tp.components.EntityNotFound.container,children:(0,t.jsxs)(a.p,{message:`${d} not found`,variant:"not-found",children:["We're looking but can't seem to find this ",d.toLowerCase(),". Try returning"," ",(0,t.jsx)(g.Y,{href:"/",children:"home"})," or seeking help on the"," ",(0,t.jsx)(g.Y,{href:"https://community.grafana.com",external:!0,children:"community site."})]})})}function l(d){return{container:(0,n.css)({padding:d.spacing(8,2,2,2)})}}},64915:(_,L,e)=>{"use strict";e.d(L,{H:()=>a});var t=e(74848),n=e(64388),r=e(21780),s=e(7392);function a(){return(0,t.jsx)(r.YW,{navId:"home",layout:n.k.Canvas,pageNav:{text:"Page not found"},children:(0,t.jsx)(s.L,{entity:"Page"})})}},68313:(_,L,e)=>{"use strict";e.d(L,{$:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(32264),a=e(40845),g=e(55852),i=e(90182),l=e(14578),d=e(17706);const o=({onChange:c,maxMenuHeight:p,isWidget:h=!1})=>{const y=()=>s.$.featureToggles.vizAndWidgetSplit?h?(0,d.nr)():(0,d.if)():(0,d.A4)(),f=(0,r.useMemo)(y,[h]),v=(0,r.useMemo)(()=>f.map(C=>({label:C.name,imgUrl:C.info.logos.small,value:C})).sort((C,b)=>C.label?.localeCompare(b.label)),[f]),[P,m]=(0,r.useState)([]),D=(0,r.useCallback)(C=>{const b=C.filter(T=>T.value).map(T=>T.value);c(b),m(C)},[c]),x=(0,a.of)(u),E={defaultOptions:!0,getOptionLabel:C=>C.label,getOptionValue:C=>C.value,noOptionsMessage:"No Panel types found",placeholder:"Filter by type",maxMenuHeight:p,options:v,value:P,onChange:D};return(0,t.jsxs)("div",{className:x.container,children:[P.length>0&&(0,t.jsx)(g.$n,{size:"xs",icon:"trash-alt",fill:"text",className:x.clear,onClick:()=>D([]),"aria-label":"Clear types",children:"Clear types"}),(0,t.jsx)(i.KF,{...E,prefix:(0,t.jsx)(l.I,{name:"filter"}),"aria-label":"Panel Type filter"})]})};function u(c){return{container:(0,n.css)`
      label: container;
      position: relative;
      min-width: 180px;
      flex-grow: 1;
    `,clear:(0,n.css)`
      label: clear;
      font-size: ${c.spacing(1.5)};
      position: absolute;
      top: -${c.spacing(4.5)};
      right: 0;
    `}}},22214:(_,L,e)=>{"use strict";e.d(L,{j:()=>g});var t=e(74848),n=e(32196),r=e(96540),s=e(36663),a=e(40845);const g=r.memo(r.forwardRef(({className:d,children:o,markdown:u,styleOverrides:c,onRemove:p,...h},y)=>{const f=(0,a.of)(v=>l(v,c?.borderTop));return(0,t.jsxs)("div",{className:(0,n.cx)(f.wrapper,d),...h,ref:y,children:[u&&i(u),o]})}));function i(d){const o=(0,s.G)(d);return(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:o}})}g.displayName="OperationRowHelp";const l=(d,o)=>{const u=d.shape.radius.default,c=d.colors.background.secondary;return{wrapper:(0,n.css)`
      padding: ${d.spacing(2)};
      border: 2px solid ${c};
      border-top: ${o?o+c:"none"};
      border-radius: 0 0 ${u} ${u};
      position: relative;
      top: -4px;
    `}}},10343:(_,L,e)=>{"use strict";e.d(L,{A:()=>l,q:()=>i});var t=e(74848),n=e(32196),r=e(13544),s=e(40845),a=e(29158);function g(o){const u=(0,s.of)(d);return(0,t.jsx)("div",{className:(0,n.cx)(u.icon,"active"in o&&o.active&&u.active),children:(0,t.jsx)(a.K,{name:o.icon,tooltip:o.title,className:u.icon,disabled:!!o.disabled,onClick:o.onClick,type:"button","data-testid":o.dataTestId??r.Tp.components.QueryEditorRow.actionButton(o.title),..."active"in o&&{"aria-pressed":o.active}})})}function i(o){return(0,t.jsx)(g,{...o})}const l=o=>(0,t.jsx)(g,{...o}),d=o=>({icon:(0,n.css)({display:"flex",position:"relative",color:o.colors.text.secondary}),active:(0,n.css)({"&:before":{display:"block",content:'" "',position:"absolute",left:-1,right:2,height:3,borderRadius:o.shape.radius.default,bottom:-8,backgroundImage:o.colors.gradients.brandHorizontal}})})},7788:(_,L,e)=>{"use strict";e.d(L,{u:()=>y});var t=e(74848),n=e(32196),r=e(91076),s=e(96540),a=e(22589),g=e(14110),i=e(40845),l=e(67892),d=e(29158),o=e(67061),u=e(14578),c=e(8484);const p=({actionsElement:v,disabled:P,draggable:m,collapsable:D=!0,dragHandleProps:x,headerElement:E,isContentVisible:C,onRowToggle:b,reportDragMousePosition:T,title:A,id:R,expanderMessages:S})=>{const O=(0,i.of)(h);let j=C?(0,c.t)("query-operation.header.collapse-row","Collapse query row"):(0,c.t)("query-operation.header.expand-row","Expand query row");S!==void 0&&C?j=S.close:S!==void 0&&(j=S?.open);const B=(0,c.t)("query-operation.header.drag-and-drop","Drag and drop to reorder");return(0,t.jsxs)("div",{className:O.header,children:[(0,t.jsxs)("div",{className:O.column,children:[D&&(0,t.jsx)(d.K,{name:C?"angle-down":"angle-right",tooltip:j,className:O.collapseIcon,onClick:b,"aria-expanded":C,"aria-controls":R}),A&&(0,t.jsx)("div",{className:O.titleWrapper,onClick:b,"aria-label":"Query operation row title",children:(0,t.jsx)("div",{className:(0,n.cx)(O.title,P&&O.disabled),children:A})}),E]}),(0,t.jsxs)(o.B,{gap:1,alignItems:"center",children:[v,m&&(0,t.jsx)("div",{onMouseMove:T,...x,children:(0,t.jsx)(u.I,{title:B,name:"draggabledots",size:"lg",className:O.dragIcon})})]})]})},h=v=>({header:(0,n.css)`
    label: Header;
    padding: ${v.spacing(.5,.5)};
    border-radius: ${v.shape.radius.default};
    background: ${v.colors.background.secondary};
    min-height: ${v.spacing(4)};
    display: grid;
    grid-template-columns: minmax(100px, max-content) min-content;
    align-items: center;
    justify-content: space-between;
    white-space: nowrap;

    &:focus {
      outline: none;
    }
  `,column:(0,n.css)`
    label: Column;
    display: flex;
    align-items: center;
    overflow: hidden;
  `,dragIcon:(0,n.css)`
    cursor: grab;
    color: ${v.colors.text.disabled};
    margin: ${v.spacing(0,.5)};
    &:hover {
      color: ${v.colors.text};
    }
  `,collapseIcon:(0,n.css)`
    margin-left: ${v.spacing(.5)};
    color: ${v.colors.text.disabled};
    }
  `,titleWrapper:(0,n.css)`
    display: flex;
    align-items: center;
    flex-grow: 1;
    cursor: pointer;
    overflow: hidden;
    margin-right: ${v.spacing(.5)};
  `,title:(0,n.css)`
    font-weight: ${v.typography.fontWeightBold};
    color: ${v.colors.text.link};
    margin-left: ${v.spacing(.5)};
    overflow: hidden;
    text-overflow: ellipsis;
  `,disabled:(0,n.css)`
    color: ${v.colors.text.disabled};
  `});p.displayName="QueryOperationRowHeader";function y({children:v,actions:P,title:m,headerElement:D,onClose:x,onOpen:E,isOpen:C,disabled:b,draggable:T,collapsable:A,index:R,id:S,expanderMessages:O}){const[j,B]=(0,s.useState)(C!==void 0?C:!0),N=(0,i.of)(f),I=(0,s.useCallback)(()=>{B(!j)},[j,B]);(0,s.useEffect)(()=>{typeof C=="boolean"&&B(C)},[C]);const K=(0,s.useCallback)(H=>{if(H.defaultPrevented){const z=H.currentTarget.getBoundingClientRect(),G=H.clientX-z.left,M=H.clientY-z.top;(0,g.rR)("query_row_reorder_drag_position",{x:G/z.width,y:M/z.height,width:z.width,height:z.height})}},[]);(0,a.A)(()=>{j?E&&E():x&&x()},[j]);const w={isOpen:j,onOpen:()=>{B(!0)},onClose:()=>{B(!1)}},U=P&&l.renderOrCallToRender(P,w),W=D&&l.renderOrCallToRender(D,w);return T?(0,t.jsx)(r.sx,{draggableId:S,index:R,children:H=>(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{ref:H.innerRef,className:N.wrapper,...H.draggableProps,children:[(0,t.jsx)("div",{children:(0,t.jsx)(p,{id:S,actionsElement:U,disabled:b,draggable:!0,collapsable:A,dragHandleProps:H.dragHandleProps,headerElement:W,isContentVisible:j,onRowToggle:I,reportDragMousePosition:K,title:m,expanderMessages:O})}),j&&(0,t.jsx)("div",{className:N.content,children:v})]})})}):(0,t.jsxs)("div",{className:N.wrapper,children:[(0,t.jsx)(p,{id:S,actionsElement:U,disabled:b,draggable:!1,collapsable:A,headerElement:W,isContentVisible:j,onRowToggle:I,reportDragMousePosition:K,title:m,expanderMessages:O}),j&&(0,t.jsx)("div",{className:N.content,children:v})]})}const f=v=>({wrapper:(0,n.css)`
      margin-bottom: ${v.spacing(2)};
    `,content:(0,n.css)`
      margin-top: ${v.spacing(.5)};
      margin-left: ${v.spacing(3)};
    `});y.displayName="QueryOperationRow"},47694:(_,L,e)=>{"use strict";e.d(L,{y:()=>o});var t=e(74848),n=e(8867),r=e(80997),s=e(62938);const a=2,g=5,i=h=>{const y=h.match(new RegExp('<style type="text/css">([\\s\\S]*?)<\\/style>'));return y?y[0]:null},l=h=>h.match(new RegExp(`<svg.*id\\s*=\\s*(['"])(.*?)\\1`))?.[a],d=h=>{let y=l(h);if(!y){y=`x${(0,s.A)()}`;const v=h.indexOf("<svg")+g;h=h.substring(0,v)+`id="${y}" `+h.substring(v)}let f=i(h);if(f){let v=f.replace(/(#(.*?))?\./g,`#${y} .`);h=h.replace(f,v)}return h},o=h=>{const{cleanStyle:y,...f}=h;return(0,t.jsx)(n.default,{...f,cacheRequests:!0,preProcessor:y?p:c})};let u=new Map;function c(h){let y=u.get(h);return y||(y=r.sQ.sanitizeSVGContent(h),u.set(h,y)),y}function p(h){let y=u.get(h);return y||(y=r.sQ.sanitizeSVGContent(h),y.indexOf('<style type="text/css">')>-1&&(y=d(y)),u.set(h,y)),y}},59429:(_,L,e)=>{"use strict";e.d(L,{b:()=>u});var t=e(74848),n=e(76459),r=e.n(n),s=e(96540),a=e(90182),g=e(27677),i=e(28676);const l=(c="Dashboards",p)=>`${c}/${p}`;async function d(c=""){return g.IB.search({type:"dash-db",query:c,limit:100}).then(p=>p.map(h=>({value:{uid:h.uid,title:h.title,folderTitle:h.folderTitle,folderUid:h.folderUid},label:l(h?.folderTitle,h.title)})))}const o=r()(d,250,{leading:!0}),u=({value:c,onChange:p,placeholder:h="Select dashboard",noOptionsMessage:y="No dashboards found",...f})=>{const[v,P]=(0,s.useState)();(0,s.useEffect)(()=>{!c||c===v?.value?.uid||(async()=>{const D=await(0,i.n)().getDashboardDTO(c);D.dashboard&&P({value:{uid:D.dashboard.uid,title:D.dashboard.title,folderTitle:D.meta.folderTitle,folderUid:D.meta.folderUid},label:l(D.meta?.folderTitle,D.dashboard.title)})})()},[c]);const m=(0,s.useCallback)(D=>{P(D),p?.(D?.value)},[p,P]);return(0,t.jsx)(a.DW,{loadOptions:o,onChange:m,placeholder:h,noOptionsMessage:y,value:v,defaultOptions:!0,...f})}},36607:(_,L,e)=>{"use strict";e.d(L,{d:()=>se});var t=e(74848),n=e(96540),r=e(32264),s=e(32196),a=e(34743),g=e(83505),i=e(46885),l=e(76459),d=e.n(l),o=e(40845),u=e(10354),c=e(14578),p=e(42418),h=e(57514),y=e(8484),f=e(55314),v=e(65812),P=e(40957),m=e(31678),D=e(70255),x=e(91793),E=e(10022),C=e(29158),b=e(94753),T=e(18759),A=e(37690);const R=40,S="md",O=(le,he)=>`${le}-${he||"root"}`;function j({items:le,focusedItemIndex:he,foldersAreOpenable:ie,idPrefix:J,selectedFolder:ce,onFolderExpand:pe,onFolderSelect:Pe,isItemLoaded:Ie,requestLoadMore:ge}){const Se=(0,n.useRef)(null),De=(0,o.of)(I),Ke=(0,n.useMemo)(()=>({items:le,focusedItemIndex:he,foldersAreOpenable:ie,selectedFolder:ce,onFolderExpand:pe,onFolderSelect:Pe,idPrefix:J}),[le,he,ie,ce,pe,Pe,J]),Me=(0,n.useCallback)(we=>Ie(we),[Ie]),be=(0,n.useCallback)((we,Be)=>{const{parentUID:He}=le[we];ge(He)},[ge,le]);return(0,t.jsx)("div",{className:De.table,role:"tree",children:le.length>0?(0,t.jsx)(E.A,{ref:Se,itemCount:le.length,isItemLoaded:Me,loadMoreItems:be,children:({onItemsRendered:we,ref:Be})=>(0,t.jsx)(x.Y1,{ref:Be,height:R*Math.min(6.5,le.length),width:"100%",itemData:Ke,itemSize:R,itemCount:le.length,onItemsRendered:we,children:N})}):(0,t.jsx)("div",{className:De.emptyMessage,children:(0,t.jsx)(y.x6,{i18nKey:"browse-dashboards.folder-picker.empty-message",children:"No folders found"})})})}const B=[100,200,130,160,150];function N({index:le,style:he,data:ie}){const{items:J,focusedItemIndex:ce,foldersAreOpenable:pe,selectedFolder:Pe,onFolderExpand:Ie,onFolderSelect:ge,idPrefix:Se}=ie,{item:De,isOpen:Ke,level:Me,parentUID:be}=J[le],we=(0,n.useRef)(null),Be=(0,n.useId)(),He=(0,m.useSelector)(A.ku),Ve=(0,m.useSelector)(A.Am),Je=(De.uid?Ve[De.uid]:He)?.items??[];let nt=[];De.uid&&(nt=(be?Ve[be]:He)?.items??[]);const pt=(0,o.of)(I),bt=(0,n.useCallback)(ye=>{ye.preventDefault(),ye.stopPropagation(),De.uid&&Ie(De.uid,!Ke)},[De.uid,Ke,Ie]),Tt=(0,n.useCallback)(()=>{De.kind==="folder"&&ge(De)},[De,ge]);return De.kind==="ui"&&De.uiKind==="pagination-placeholder"?(0,t.jsxs)("span",{style:he,className:pt.row,children:[(0,t.jsx)(T.T,{level:Me,spacing:2}),(0,t.jsx)(D.A,{width:B[le%B.length]})]}):De.kind!=="folder"?null:(0,t.jsx)("div",{ref:we,style:he,className:(0,s.cx)(pt.row,{[pt.rowFocused]:le===ce,[pt.rowSelected]:De.uid===Pe}),tabIndex:-1,onClick:Tt,"aria-expanded":Ke,"aria-selected":De.uid===Pe,"aria-labelledby":Be,"aria-level":Me+1,role:"treeitem","aria-owns":Je.length>0?Je.map(ye=>O(Se,ye.uid)).join(" "):void 0,"aria-setsize":Je.length,"aria-posinset":nt.findIndex(ye=>ye.uid===De.uid)+1,id:O(Se,De.uid),children:(0,t.jsxs)("div",{className:pt.rowBody,children:[(0,t.jsx)(T.T,{level:Me,spacing:2}),pe?(0,t.jsx)(C.K,{size:S,onMouseDown:bt,tabIndex:-1,"aria-label":Ke?`Collapse folder ${De.title}`:`Expand folder ${De.title}`,name:Ke?"angle-down":"angle-right"}):(0,t.jsx)("span",{className:pt.folderButtonSpacer}),(0,t.jsx)("label",{className:pt.label,id:Be,children:(0,t.jsx)(b.E,{truncate:!0,children:De.title})})]})})}const I=le=>{const he=(0,s.css)({height:R,display:"flex",position:"relative",alignItems:"center",flexGrow:1,gap:le.spacing(.5),overflow:"hidden",padding:le.spacing(0,1)});return{table:(0,s.css)({background:le.components.input.background}),emptyMessage:(0,s.css)({padding:le.spacing(1),textAlign:"center",width:"100%"}),folderButtonSpacer:(0,s.css)({paddingLeft:le.spacing(.5)}),row:(0,s.css)({display:"flex",position:"relative",alignItems:"center",":not(:first-child)":{borderTop:`solid 1px ${le.colors.border.weak}`}}),rowFocused:(0,s.css)({backgroundColor:le.colors.background.secondary}),rowSelected:(0,s.css)({"&::before":{display:"block",content:'""',position:"absolute",left:0,bottom:0,top:0,width:4,borderRadius:le.shape.radius.default,backgroundImage:le.colors.gradients.brandVertical}}),rowBody:he,label:(0,s.css)({lineHeight:R+"px",flexGrow:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","&:hover":{textDecoration:"underline",cursor:"pointer"}})}};var K=e(16797);function w({handleClearSelection:le,isLoading:he,invalid:ie,label:J,...ce},pe){const Pe=(0,o.$j)(),Ie=W(Pe,ie),ge=Se=>{(Se.key==="Enter"||Se.key===" ")&&le?.(Se)};return(0,t.jsx)("div",{className:Ie.wrapper,children:(0,t.jsxs)("div",{className:Ie.inputWrapper,children:[J?(0,t.jsx)("div",{className:Ie.prefix,children:(0,t.jsx)(c.I,{name:"folder"})}):void 0,(0,t.jsxs)("button",{type:"button",className:(0,s.cx)(Ie.fakeInput,J?Ie.hasPrefix:void 0),...ce,ref:pe,children:[he?(0,t.jsx)(D.A,{width:100}):J?(0,t.jsx)(b.E,{truncate:!0,children:J}):(0,t.jsx)(b.E,{truncate:!0,color:"secondary",children:(0,t.jsx)(y.x6,{i18nKey:"browse-dashboards.folder-picker.button-label",children:"Select folder"})}),!he&&le&&(0,t.jsx)(c.I,{role:"button",tabIndex:0,"aria-label":(0,y.t)("browse-dashboards.folder-picker.clear-selection","Clear selection"),className:Ie.clearIcon,name:"times",onClick:le,onKeyDown:ge})]}),(0,t.jsx)("div",{className:Ie.suffix,children:(0,t.jsx)(c.I,{name:"angle-down"})})]})})}const U=(0,n.forwardRef)(w),W=(le,he=!1)=>{const ie=(0,u.n)({theme:le,invalid:he});return{wrapper:ie.wrapper,inputWrapper:ie.inputWrapper,prefix:(0,s.css)([ie.prefix,{pointerEvents:"none",color:le.colors.text.primary}]),suffix:(0,s.css)([ie.suffix,{pointerEvents:"none"}]),fakeInput:(0,s.css)([ie.input,{textAlign:"left",letterSpacing:"normal","&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,s.css)`
          ${(0,K.focusCss)(le)}
        `,alignItems:"center",display:"flex",flexWrap:"nowrap",justifyContent:"space-between",paddingRight:28}]),hasPrefix:(0,s.css)({paddingLeft:28}),clearIcon:(0,s.css)({color:le.colors.text.secondary,cursor:"pointer","&:hover":{color:le.colors.text.primary},"&:focus:not(:focus-visible)":(0,K.getMouseFocusStyles)(le),"&:focus-visible":(0,K.getFocusStyles)(le)})}};var H=e(25508),z=e(92955),G=e(93519),M=e(64756);const Q=(0,H.Mz)([le=>le,(le,he)=>he],(le,he)=>{const ie=new Set,J=[],ce={};let pe=!1;for(const Pe of he){if(ie.has(Pe.requestId))continue;const Ie=f.cU.endpoints.listFolders.select({parentUid:Pe.arg.parentUid,page:Pe.arg.page,limit:Pe.arg.limit,permission:Pe.arg.permission})(le);Ie.status==="pending"&&(pe=!0);const ge=Ie.originalArgs?.parentUid;ge?(ce[ge]||(ce[ge]=[]),ce[ge].push(Ie)):J.push(Ie)}return{isLoading:pe,rootPages:J,pagesByParent:ce}});function Y(le){const he=le.at(-1),ie=he?.originalArgs?.page;return he?.data?[he.data.length<he.originalArgs.limit,ie]:[!1,ie]}function q(le,he,ie){const J=(0,M.wA)(),ce=(0,n.useRef)([]),pe=(0,M.d4)(ge=>Q(ge,ce.current)),Pe=(0,n.useCallback)(ge=>{const Se=ge?pe.pagesByParent[ge]:pe.rootPages,[De,Ke]=Y(Se??[]);if(De)return;const Me={parentUid:ge,page:(Ke??0)+1,limit:z.md,permission:ie},be=J(f.cU.endpoints.listFolders.initiate(Me));ce.current=ce.current.concat([be])},[pe,J,ie]);return(0,n.useEffect)(()=>()=>{for(const ge of ce.current)ge.unsubscribe()},[]),{items:(0,n.useMemo)(()=>{if(!le)return[];function ge(De,Ke,Me){const be=Ke.flatMap(Be=>(Be.data??[]).flatMap(Ve=>{const Je=he[Ve.uid],nt={isOpen:!!Je,level:Me,item:{kind:"folder",title:Ve.title,uid:Ve.uid}},pt=Je&&pe.pagesByParent[Ve.uid];if(pt){const bt=ge(Ve.uid,pt,Me+1);return[nt,...bt]}return nt})),[we]=Y(Ke);return we||be.push(...(0,G.T)(z.md,De,Me)),be}const Se=ge(void 0,pe.rootPages,1);return Se.unshift(te),Se},[pe,le,he]),isLoading:pe.isLoading,requestNextPage:Pe}}const te={isOpen:!0,level:0,item:{kind:"folder",title:"Dashboards",uid:""}};function X({tree:le,handleCloseOverlay:he,handleFolderSelect:ie,handleFolderExpand:J,idPrefix:ce,search:pe,visible:Pe}){const[Ie,ge]=(0,n.useState)(-1),Se=!!r.$.featureToggles.nestedFolders;(0,n.useEffect)(()=>{Pe&&ge(-1)},[Pe]),(0,n.useEffect)(()=>{ge(0)},[pe]),(0,n.useEffect)(()=>{document.getElementById(O(ce,le[Ie]?.item.uid))?.scrollIntoView({block:"nearest",inline:"nearest"})},[Ie,ce,le]);const De=(0,n.useCallback)(Ke=>{const Me=Se&&!pe;switch(Ke.key){case"ArrowRight":case"ArrowLeft":Me&&(Ke.preventDefault(),J(le[Ie].item.uid,Ke.key==="ArrowRight"));break;case"ArrowUp":Ie>0&&(Ke.preventDefault(),ge(Ie-1));break;case"ArrowDown":Ie<le.length-1&&(Ke.preventDefault(),ge(Ie+1));break;case"Enter":Ke.preventDefault();const be=le[Ie].item;be.kind==="folder"&&ie(be);break;case"Tab":Ke.stopPropagation(),he();break;case"Escape":Ke.stopPropagation(),Ke.preventDefault(),he();break}},[Ie,he,J,ie,Se,pe,le]);return{focusedItemIndex:Ie,handleKeyDown:De}}const ee=d()(ne,300);async function ne(le,he){const ie=await(0,v.getGrafanaSearcher)().search({query:le,kind:["folder"],limit:100,permission:he}),J=ie.view.map(ce=>(0,P.hI)(ce,ie.view));return{...ie,items:J}}function Z({value:le,invalid:he,showRootFolder:ie=!0,clearable:J=!1,excludeUIDs:ce,permission:pe=m.PermissionLevelString.Edit,onChange:Pe}){const Ie=(0,o.of)(ae),ge=(0,f.kH)(le||f.hT),Se=!!r.$.featureToggles.nestedFolders,[De,Ke]=(0,n.useState)(""),[Me,be]=(0,n.useState)(null),[we,Be]=(0,n.useState)(!1),[He,Ve]=(0,n.useState)(!1),[Je,nt]=(0,n.useState)(!1),[pt,bt]=(0,n.useState)({}),Tt=(0,n.useId)(),[ye]=(0,n.useState)(void 0),je=(0,n.useRef)(0),ue=!!(Je&&!(De&&Me)),{items:Ee,isLoading:Ce,requestNextPage:Ne}=q(ue,pt,pe);(0,n.useEffect)(()=>{if(!De){be(null);return}const rt=Date.now();Be(!0),ee(De,pe).then(vt=>{if(rt>je.current){const Ot=vt.view.map(jt=>(0,P.hI)(jt,vt.view));be({...vt,items:Ot}),Be(!1),je.current=rt}})},[De,pe]);const Fe=[(0,a.UU)({crossAxis:!1,boundary:document.body})],{context:Ue,refs:fe,floatingStyles:Te,elements:Ge}=(0,g.we)({open:Je,placement:"bottom",onOpenChange:rt=>{rt&&(Ke(""),Ve(!0)),nt(rt)},middleware:Fe,whileElementsMounted:i.ll}),Qe=(0,g.kp)(Ue),st=(0,g.s9)(Ue),{getReferenceProps:Xe,getFloatingProps:ot}=(0,g.bv)([st,Qe]),ft=(0,n.useCallback)(async(rt,vt)=>{bt(Ot=>({...Ot,[rt]:vt})),vt&&!pt[rt]&&Ne(rt)},[Ne,pt]),_e=(0,n.useCallback)(rt=>{Pe&&Pe(rt.uid,rt.title),nt(!1)},[Pe]),et=(0,n.useCallback)(rt=>{rt.preventDefault(),rt.stopPropagation(),Pe&&Pe(void 0,void 0)},[Pe]),it=(0,n.useCallback)(()=>nt(!1),[nt]),dt=(0,n.useCallback)(rt=>{De||Ne(rt)},[De,Ne]),ze=(0,n.useMemo)(()=>{let rt=[];return ue?rt=Ee:rt=Me?.items.map(vt=>({isOpen:!1,level:0,item:{kind:"folder",title:vt.title,uid:vt.uid}}))??[],(!ie||ce?.length)&&(rt=rt.filter(vt=>!(!ie&&vt===te||ce?.includes(vt.item.uid)))),rt},[Ee,ce,ue,Me?.items,ie]),xe=(0,n.useCallback)(rt=>{const vt=ze[rt];if(!vt)return!1;const Ot=vt.item;return!(Ot.kind==="ui"&&Ot.uiKind==="pagination-placeholder")},[ze]),Oe=Ce||we,{focusedItemIndex:Le,handleKeyDown:Ze}=X({tree:ze,handleCloseOverlay:it,handleFolderSelect:_e,handleFolderExpand:ft,idPrefix:Tt,search:De,visible:Je});let qe=ge.data?.title;return le===""&&(qe="Dashboards"),Je?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.p,{ref:fe.setReference,autoFocus:!0,prefix:qe?(0,t.jsx)(c.I,{name:"folder"}):null,placeholder:qe??(0,y.t)("browse-dashboards.folder-picker.search-placeholder","Search folders"),value:De,invalid:he,className:Ie.search,onChange:rt=>Ke(rt.currentTarget.value),"aria-autocomplete":"list","aria-expanded":!0,"aria-haspopup":!0,"aria-controls":Tt,"aria-owns":Tt,"aria-activedescendant":O(Tt,ze[Le]?.item.uid),role:"combobox",suffix:(0,t.jsx)(c.I,{name:"search"}),...Xe(),onKeyDown:Ze}),(0,t.jsx)("fieldset",{ref:fe.setFloating,id:Tt,className:Ie.tableWrapper,style:{...Te,width:Ge.domReference?.clientWidth},...ot(),children:ye?(0,t.jsx)(p.F,{className:Ie.error,severity:"warning",title:(0,y.t)("browse-dashboards.folder-picker.error-title","Error loading folders"),children:ye.message||ye.toString?.()||(0,y.t)("browse-dashboards.folder-picker.unknown-error","Unknown error")}):(0,t.jsxs)("div",{children:[Oe&&(0,t.jsx)("div",{className:Ie.loader,children:(0,t.jsx)(h.G,{width:600})}),(0,t.jsx)(j,{items:ze,selectedFolder:le,focusedItemIndex:Le,onFolderExpand:ft,onFolderSelect:_e,idPrefix:Tt,foldersAreOpenable:Se&&!(De&&Me),isItemLoaded:xe,requestLoadMore:dt})]})})]}):(0,t.jsx)(U,{label:qe,handleClearSelection:J&&le!==void 0?et:void 0,invalid:he,isLoading:ge.isLoading,autoFocus:He,ref:fe.setReference,"aria-label":qe?(0,y.t)("browse-dashboards.folder-picker.accessible-label","Select folder: {{ label }} currently selected",{label:qe}):void 0,...Xe()})}const ae=le=>({button:(0,s.css)({maxWidth:"100%"}),error:(0,s.css)({marginBottom:0}),tableWrapper:(0,s.css)({boxShadow:le.shadows.z3,position:"relative",zIndex:le.zIndex.portal}),loader:(0,s.css)({position:"absolute",top:0,left:0,right:0,zIndex:le.zIndex.portal+1,overflow:"hidden"}),search:(0,s.css)({input:{cursor:"default"}})});var re=e(85242);function se(le){const he=r.$.featureToggles.newFolderPicker||r.$.featureToggles.nestedFolders,{initialTitle:ie,dashboardId:J,enableCreateNew:ce,...pe}=le;return he?(0,t.jsx)(Z,{...pe}):(0,t.jsx)(de,{...le})}function de({value:le,showRootFolder:he,onChange:ie,initialTitle:J,dashboardId:ce,enableCreateNew:pe,inputId:Pe,skipInitialLoad:Ie}){const ge=(0,n.useCallback)(Se=>{ie&&ie(Se.uid,Se.title)},[ie]);return(0,t.jsx)(re.sR,{onChange:ge,showRoot:he,initialFolderUid:le,initialTitle:J,inputId:Pe,skipInitialLoad:Ie,dashboardId:ce,enableCreateNew:pe})}},85242:(_,L,e)=>{"use strict";e.d(L,{sR:()=>D});var t=e(74848),n=e(32196),r=e(76459),s=e.n(r),a=e(96540),g=e(16817),i=e(26272),l=e(13544),d=e(14110),o=e(40845),u=e(10354),c=e(90182),p=e(28138),h=e(8484),y=e(16233),f=e(11230),v=e(31678);const P="+ Add new",m="-10";function D(b){const{dashboardId:T,allowEmpty:A,onChange:R,filter:S,enableCreateNew:O,inputId:j,onClear:B,enableReset:N,initialFolderUid:I,initialTitle:K="",permissionLevel:w=v.PermissionLevelString.Edit,rootName:U,showRoot:W=!0,skipInitialLoad:H,searchQueryType:z,customAdd:G,folderWarning:M,invalid:Q}=b,Y=U??"Dashboards",[q,te]=(0,a.useState)(null),[X,ee]=(0,a.useState)(!1),[ne,Z]=(0,a.useState)(""),[ae,re]=(0,a.useState)(q?.title??""),se=(0,o.of)(C),de=typeof B=="function",le=(0,a.useCallback)(async Ke=>{const Me=await(0,f.c0)(Ke,w,z),we=x(Me,S);return(0,d.rR)("grafana_folder_picker_results_loaded",{results:we.length,searchTermLength:Ke.length,enableCreateNew:!!O}),(y.TP.hasPermission(v.AccessControlAction.DashboardsWrite)||y.TP.hasPermission(v.AccessControlAction.DashboardsCreate))&&Y?.toLowerCase().startsWith(Ke.toLowerCase())&&W&&we.unshift({label:Y,value:""}),N&&Ke===""&&K!==""&&!we.find(He=>He.label===K)&&we.unshift({label:K,value:I}),O&&G?[...we,{value:m,label:P,title:Ke}]:we},[N,I,K,w,Y,W,z,S,O,G]),he=(0,a.useMemo)(()=>s()(le,300,{leading:!0}),[le]),ie=async()=>{const Ke={label:K,value:void 0},Me={label:Y,value:""},be=await le("");let we=null;I!=null?we=be.find(Be=>Be.value===I)||null:N&&K?we=Ke:I&&(we=be.find(Be=>Be.id===I)||null),!we&&!A&&(y.TP.isEditor?we=Me:!!T?we=Ke:we=be.length>0?be[0]:Ke),!X&&te(we)};(0,a.useEffect)(()=>{q&&q.value!==I&&!X&&q.value&&q.label&&R({uid:q.value,title:q.label})},[q,I]),(0,g.A)(async()=>{if(H){const Ke=await E({getFolder:f.Ql,folderUid:I,folderName:K});te(Ke)}await ie()},[H,I,K]),(0,a.useEffect)(()=>{q&&q.id===m&&ee(!0)},[q]);const J=(0,a.useCallback)((Ke,Me)=>{if(Ke?.value===m)te({id:m,title:ne}),re(ne);else{if(Ke||(Ke={value:"",label:Y}),Me.action==="clear"&&B){B();return}te(Ke),R({uid:Ke.value,title:Ke.label})}},[R,B,Y,ne]),ce=(0,a.useCallback)(async Ke=>{if(M?.warningCondition(Ke))return(0,d.rR)("grafana_folder_picker_folder_created",{status:"failed_condition"}),!1;const Me=await(0,f.vV)({title:Ke});let be={value:"",label:"Not created"};return Me.uid?((0,d.rR)("grafana_folder_picker_folder_created",{status:"success"}),p.A.emit(i.r1.alertSuccess,["Folder Created","OK"]),be={value:Me.uid,label:Me.title},te(Me),J(be,{action:"create-option",option:be})):((0,d.rR)("grafana_folder_picker_folder_created",{status:"failed"}),p.A.emit(i.r1.alertError,["Folder could not be created"])),be},[M,J]),pe=(0,a.useCallback)(Ke=>{const Me=!!G?.disallowValues;if(Ke.key==="Enter"&&Me&&!G?.isAllowedValue(ae)){Ke.preventDefault();return}switch(Ke.key){case"Enter":{ce(q?.title),ee(!1);break}case"Escape":te({value:"",label:Y}),ee(!1)}},[G?.disallowValues,G?.isAllowedValue,ae,ce,q?.title,Y]),Pe=Ke=>{const Me=Ke.currentTarget.value;re(Me),te({id:void 0,title:Me})},Ie=()=>{te({value:"",label:Y}),ee(!1)},ge=(Ke,{action:Me})=>{Me==="input-change"&&Z(be=>Ke),Me==="menu-close"&&Z(be=>Ke)},Se=()=>M?.warningCondition(ae)?(0,t.jsx)(M.warningComponent,{}):null,De=()=>M?.warningCondition(ne)?(0,t.jsx)(M.warningComponent,{}):null;return X?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Se,{}),(0,t.jsx)("div",{className:se.newFolder,children:"Press enter to create the new folder."}),(0,t.jsx)(u.p,{width:30,autoFocus:!0,value:ae,onChange:Pe,onKeyDown:pe,placeholder:"Press enter to confirm new folder.",onBlur:Ie})]}):(0,t.jsxs)("div",{"data-testid":l.Tp.components.FolderPicker.containerV2,children:[(0,t.jsx)(De,{}),(0,t.jsx)(c.gZ,{inputId:j,"data-testid":l.Tp.components.FolderPicker.input,loadingMessage:(0,h.t)("folder-picker.loading","Loading folders..."),defaultOptions:!0,defaultValue:q,inputValue:ne,onInputChange:ge,value:q,allowCustomValue:O&&!G,loadOptions:he,onChange:J,onCreateOption:ce,invalid:Q,isClearable:de})]})}function x(b,T){return(T?T(b):b).map(R=>({label:R.title,value:R.uid}))}async function E({folderName:b,folderUid:T,getFolder:A}){if(T==null)throw new Error("folderUid is not found.");return b?{label:b,value:T}:{label:(await A(T)).title,value:T}}const C=b=>({newFolder:(0,n.css)({color:b.colors.warning.main,fontSize:b.typography.bodySmall.fontSize,paddingBottom:b.spacing(1)})})},73725:(_,L,e)=>{"use strict";e.d(L,{r:()=>l});var t=e(74848),n=e(16817),r=e(90182),s=e(14578),a=e(53477),g=e(65812);const i=()=>(0,g.getGrafanaSearcher)().getSortOptions();function l({onChange:d,value:o,placeholder:u,filter:c,getSortOptions:p,isClearable:h}){const y=(0,n.A)(async()=>{const v=await(p??i)();return c?v.filter(P=>c.includes(P.value)):v},[p,c]);if(y.loading)return null;const f=!!(o?.includes("desc")||o?.startsWith("-"));return(0,t.jsx)(r.l6,{width:28,onChange:d,value:y.value?.find(v=>v.value===o)??null,options:y.value,"aria-label":"Sort",placeholder:u??`Sort (Default ${a.r4.label})`,prefix:(0,t.jsx)(s.I,{name:f?"sort-amount-down":"sort-amount-up"}),isClearable:h},o)}},46334:(_,L,e)=>{"use strict";e.d(L,{$:()=>i,E:()=>g});var t=e(74848),n=e(32196),r=e(69613),s=e(40845),a=e(14578);const g=({count:l,label:d,onClick:o,removeIcon:u})=>{const{color:c}=(0,r.MC)(d),p=(0,s.of)(i),h=l!==0&&(0,t.jsx)("span",{style:{marginLeft:"3px"},children:`(${l})`});return(0,t.jsxs)("span",{className:p.badge,style:{backgroundColor:c},children:[u&&(0,t.jsx)(a.I,{onClick:o,name:"times"}),d," ",h]})},i=l=>({badge:(0,n.css)({...l.typography.bodySmall,backgroundColor:l.v1.palette.gray1,borderRadius:l.shape.radius.default,color:l.v1.palette.white,display:"inline-block",height:"20px",lineHeight:"20px",padding:l.spacing(0,.75),verticalAlign:"baseline",whiteSpace:"nowrap","&:hover":{opacity:.85}})})},99818:(_,L,e)=>{"use strict";e.d(L,{$:()=>h});var t=e(74848),n=e(32196),r=e(96540),s=e(28581),a=e(54479),g=e(40845),i=e(90182),l=e(14578),d=e(8484),o=e(46334);const u=({data:f,className:v,label:P,isFocused:m,innerProps:D})=>{const x=(0,g.of)(c);return(0,t.jsx)("div",{className:(0,n.cx)(x.option,m&&x.optionFocused),"aria-label":"Tag option",...D,children:(0,t.jsx)("div",{className:(0,n.cx)(x.optionInner,v),children:typeof P=="string"?(0,t.jsx)(o.E,{label:P,removeIcon:!1,count:f.count??0}):P})})},c=f=>({option:(0,n.css)({padding:f.spacing(1),whiteSpace:"nowrap",cursor:"pointer",borderLeft:"2px solid transparent","&:hover":{background:f.colors.background.secondary}}),optionFocused:(0,n.css)({background:f.colors.background.secondary,borderStyle:"solid",borderTop:0,borderRight:0,borderBottom:0,borderLeftWidth:"2px"}),optionInner:(0,n.css)({position:"relative",textAlign:"left",width:"100%",display:"block",cursor:"pointer",padding:"2px 0"})}),p=(f,v)=>{const P=RegExp((0,a.jD)(v),"i");return!!(f.value&&P.test(f.value))},h=({allowCustomValue:f=!1,formatCreateLabel:v,hideValues:P,inputId:m,isClearable:D,onChange:x,placeholder:E,tagOptions:C,tags:b,width:T})=>{const A=(0,g.of)(y),R=b.map(M=>({value:M,label:M,count:0})),[S,O]=(0,r.useState)(R),[j,B]=(0,r.useState)(!1),[N,I]=(0,r.useState)(b),[K,w]=(0,r.useState)(R),U=(0,r.useMemo)(()=>b.join(),[b]),W=(0,r.useCallback)(async()=>(await C()).map(Q=>b.includes(Q.term)?{value:Q.term,label:Q.term,count:0}:{value:Q.term,label:Q.term,count:Q.count}),[C,b]),H=(0,r.useCallback)(async()=>{B(!0);const M=await W();f&&K.forEach(Q=>M.push(Q)),O(M),B(!1)},[f,K,W]);(0,r.useEffect)(()=>{b.length>0&&S.length===0&&H()},[H,S.length,b.length]),(0,r.useEffect)(()=>{b!==N&&(I(b),H())},[H,N,b]);const z=M=>{M.forEach(Q=>Q.count=0),x((M||[]).map(Q=>Q.value)),f&&w(M.filter(Q=>!b.includes(Q)))},G={onFocus:H,isLoading:j,options:S,allowCreateWhileLoading:!0,allowCustomValue:f,formatCreateLabel:v,defaultOptions:!0,filterOption:p,getOptionLabel:M=>M.label,getOptionValue:M=>M.value,inputId:m,isMulti:!0,onChange:z,loadingMessage:(0,d.t)("tag-filter.loading","Loading..."),noOptionsMessage:(0,d.t)("tag-filter.no-tags","No tags found"),placeholder:E||(0,d.t)("tag-filter.placeholder","Filter by tag"),value:R,width:T,components:{Option:u,MultiValueLabel:()=>null,MultiValueRemove(M){const{data:Q}=M;return(0,t.jsx)(s.c.MultiValueRemove,{...M,children:(0,t.jsx)(o.E,{label:Q.label,removeIcon:!0,count:Q.count},Q.label)})},MultiValueContainer:P?()=>null:s.c.MultiValueContainer}};return(0,t.jsxs)("div",{className:A.tagFilter,children:[D&&b.length>0&&(0,t.jsx)("button",{className:A.clear,onClick:()=>z([]),children:"Clear tags"}),(0,t.jsx)(i.KF,{...G,prefix:(0,t.jsx)(l.I,{name:"tag-alt"}),"aria-label":"Tag filter"},U)]})};h.displayName="TagFilter";const y=f=>{const v=(0,o.$)(f);return{tagFilter:(0,n.css)({position:"relative",minWidth:"180px",flexGrow:1,[`.${v.badge}`]:{marginLeft:"6px",cursor:"pointer"}}),clear:(0,n.css)({background:"none",border:"none",textDecoration:"underline",fontSize:"12px",padding:"none",position:"absolute",top:"-17px",right:0,cursor:"pointer",color:f.colors.text.secondary,"&:hover":{color:f.colors.text.primary}})}}},25573:(_,L,e)=>{"use strict";e.d(L,{m:()=>c});var t=e(74848),n=e(2543),r=e.n(n),s=e(26272),a=e(65879),g=e(47232),i=e(15666),l=e(76412),d=e(28138),o=e(61680);const u="grafana.dashboard.timepicker.history",c=P=>(0,t.jsx)(o.b,{storageKey:u,defaultValue:[],children:(m,D)=>{const x=h(m),E=p(x);return(0,t.jsx)(i.$6,{...P,history:E,onChange:C=>{y(C,x,D),P.onChange(C)},onError:C=>d.A.emit(s.r1.alertError,[(0,l.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,l.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:C})])})}});function p(P){return P.map(m=>a.convertRawToRange(m,"utc",void 0,"YYYY-MM-DD HH:mm:ss"))}function h(P){return P.map(m=>{const D=typeof m.from=="string"?m.from:m.from.toISOString(),x=typeof m.to=="string"?m.to:m.to.toISOString();return{from:D,to:x}})}function y(P,m,D){if(!f(P))return;const x={from:typeof P.raw.from=="string"?P.raw.from:P.raw.from.toISOString(),to:typeof P.raw.to=="string"?P.raw.to:P.raw.to.toISOString()},E=v([x,...m]);D(E)}function f(P){return(0,g.Ar)(P.raw.from)||(0,g.Ar)(P.raw.to)}function v(P){return(0,n.uniqBy)(P,m=>m.from+m.to).slice(0,4)}},93522:(_,L,e)=>{"use strict";e.d(L,{N:()=>u});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(37390),g=e(71259),i=e(94753),l=e(8484),d=e(63917);const o=y=>[{category:(0,l.t)("help-modal.shortcuts-category.global","Global"),shortcuts:[{keys:["g","h"],description:(0,l.t)("help-modal.shortcuts-description.go-to-home-dashboard","Go to Home Dashboard")},{keys:["g","d"],description:(0,l.t)("help-modal.shortcuts-description.go-to-dashboards","Go to Dashboards")},{keys:["g","e"],description:(0,l.t)("help-modal.shortcuts-description.go-to-explore","Go to Explore")},{keys:["g","p"],description:(0,l.t)("help-modal.shortcuts-description.go-to-profile","Go to Profile")},{keys:[`${y} + k`],description:(0,l.t)("help-modal.shortcuts-description.open-search","Open search")},{keys:["esc"],description:(0,l.t)("help-modal.shortcuts-description.exit-edit/setting-views","Exit edit/setting views")},{keys:["?"],description:(0,l.t)("help-modal.shortcuts-description.show-all-shortcuts","Show all keyboard shortcuts")},{keys:["c","t"],description:(0,l.t)("help-modal.shortcuts-description.change-theme","Change theme")}]},{category:(0,l.t)("help-modal.shortcuts-category.time-range","Time range"),shortcuts:[{keys:["t","z"],description:(0,l.t)("help-modal.shortcuts-description.zoom-out-time-range","Zoom out time range")},{keys:["t","\u2190"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-back","Move time range back")},{keys:["t","\u2192"],description:(0,l.t)("help-modal.shortcuts-description.move-time-range-forward","Move time range forward")},{keys:["t","a"],description:(0,l.t)("help-modal.shortcuts-description.make-time-range-permanent","Make time range absolute/permanent")},{keys:["t","c"],description:(0,l.t)("help-modal.shortcuts-description.copy-time-range","Copy time range")},{keys:["t","v"],description:(0,l.t)("help-modal.shortcuts-description.paste-time-range","Paste time range")}]},{category:(0,l.t)("help-modal.shortcuts-category.dashboard","Dashboard"),shortcuts:[{keys:[`${y} + s`],description:(0,l.t)("help-modal.shortcuts-description.save-dashboard","Save dashboard")},{keys:["d","r"],description:(0,l.t)("help-modal.shortcuts-description.refresh-all-panels","Refresh all panels")},{keys:["d","s"],description:(0,l.t)("help-modal.shortcuts-description.dashboard-settings","Dashboard settings")},{keys:["d","v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-active-mode","Toggle in-active / view mode")},{keys:["d","k"],description:(0,l.t)("help-modal.shortcuts-description.toggle-kiosk","Toggle kiosk mode (hides top nav)")},{keys:["d","\u21E7 + e"],description:(0,l.t)("help-modal.shortcuts-description.expand-all-rows","Expand all rows")},{keys:["d","\u21E7 + c"],description:(0,l.t)("help-modal.shortcuts-description.collapse-all-rows","Collapse all rows")},{keys:["d","a"],description:(0,l.t)("help-modal.shortcuts-description.toggle-auto-fit","Toggle auto fit panels (experimental feature)")},{keys:[`${y} + o`],description:(0,l.t)("help-modal.shortcuts-description.toggle-graph-crosshair","Toggle shared graph crosshair")},{keys:["d","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-all-panel-legends","Toggle all panel legends")},{keys:["d","x"],description:(0,l.t)("help-modal.shortcuts-description.toggle-exemplars","Toggle exemplars in all panel")}]},{category:(0,l.t)("help-modal.shortcuts-category.focused-panel","Focused panel"),shortcuts:[{keys:["e"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-edit","Toggle panel edit view")},{keys:["v"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-fullscreen","Toggle panel fullscreen view")},{keys:["p","s"],description:(0,l.t)("help-modal.shortcuts-description.open-shared-modal","Open Panel Share Modal")},{keys:["p","d"],description:(0,l.t)("help-modal.shortcuts-description.duplicate-panel","Duplicate Panel")},{keys:["p","r"],description:(0,l.t)("help-modal.shortcuts-description.remove-panel","Remove Panel")},{keys:["p","l"],description:(0,l.t)("help-modal.shortcuts-description.toggle-panel-legend","Toggle panel legend")}]}],u=({onDismiss:y})=>{const f=(0,s.of)(h),v=(0,r.useMemo)(()=>(0,d.gn)(),[]),P=(0,r.useMemo)(()=>o(v),[v]);return(0,t.jsx)(a.a,{title:(0,l.t)("help-modal.title","Shortcuts"),isOpen:!0,onDismiss:y,onClickBackdrop:y,children:(0,t.jsx)(g.x,{columns:{xs:1,sm:2},gap:3,tabIndex:0,children:Object.values(P).map(({category:m,shortcuts:D})=>(0,t.jsx)("section",{children:(0,t.jsxs)("table",{className:f.table,children:[(0,t.jsx)("caption",{children:(0,t.jsx)(i.E,{element:"p",variant:"h5",children:m})}),(0,t.jsx)("thead",{className:"sr-only",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Keys"}),(0,t.jsx)("th",{children:"Description"})]})}),(0,t.jsx)("tbody",{children:D.map(({keys:x,description:E})=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:f.keys,children:x.map(C=>(0,t.jsx)(c,{children:C},C))}),(0,t.jsx)("td",{children:(0,t.jsx)(i.E,{variant:"bodySmall",element:"p",children:E})})]},x.join()))})]})},m))})})},c=({children:y})=>{const f=(0,s.of)(h),v=(0,r.useMemo)(()=>p(y),[y]),P=(0,t.jsx)("span",{dangerouslySetInnerHTML:{__html:v}});return(0,t.jsx)("kbd",{className:f.shortcutTableKey,children:(0,t.jsx)(i.E,{variant:"code",children:P})})};function p(y){let f,v;if(y.includes("ctrl"))f="ctrl",v="Control";else if(y.includes("esc"))f="esc",v="Escape";else return y;return y.replace(f,`<span class="sr-only">${v}</span><span aria-hidden="true" role="none">${f}</span>`)}function h(y){return{table:(0,n.css)({borderCollapse:"separate",borderSpacing:y.spacing(2),"& caption":{captionSide:"top"}}),keys:(0,n.css)({textAlign:"end",whiteSpace:"nowrap",minWidth:83}),shortcutTableKey:(0,n.css)({display:"inline-block",textAlign:"center",marginRight:y.spacing(.5),padding:"3px 5px",lineHeight:"10px",verticalAlign:"middle",border:`solid 1px ${y.colors.border.medium}`,borderRadius:y.shape.radius.default,color:y.colors.text.primary,backgroundColor:y.colors.background.secondary})}}},15054:(_,L,e)=>{"use strict";e.d(L,{FG:()=>c,HG:()=>a,IZ:()=>o,MM:()=>h,Pz:()=>s,bJ:()=>i,cV:()=>r,cx:()=>l,dU:()=>n,o9:()=>g,sD:()=>t,tH:()=>d,wV:()=>p});const t=30,n=8,r=24,s="v",a="h",g=4,i=250,l=t*3,d="panel-copy",o=2,u=23763571993,c=40,p="VisualizationSelectPane.ListMode",h="WidgetSelectPane.ListMode"},76888:(_,L,e)=>{"use strict";e.d(L,{Il:()=>a,YE:()=>s,k9:()=>l,ni:()=>g});var t=e(96540),n=e(39601),r=e(32264);const s=(0,t.createContext)(void 0);function a(){const d=(0,t.useContext)(s);if(!d)throw new Error("No GrafanaContext found");return d}function g(){const{chrome:d}=a();return(0,t.useCallback)((o,u)=>{const{pathname:c,search:p}=n.Ny.getLocation();d.setReturnToPrevious({title:o,href:u??c+p})},[d])}const i=40;function l(){const{chrome:d}=a(),{kioskMode:o,searchBarHidden:u,chromeless:c}=d.useState();return o||c?0:u||r.$.featureToggles.singleTopNav?i:i*2}},3169:(_,L,e)=>{"use strict";e.d(L,{Cf:()=>c,_2:()=>p,gi:()=>o,q8:()=>u,tZ:()=>d});var t=e(96540),n=e(62938),r=e(94954),s=e(31678),a=e(82467);const g={title:"",text:"",severity:s.AppNotificationSeverity.Success,icon:"check"},i={title:"",text:"",severity:s.AppNotificationSeverity.Warning,icon:"exclamation-triangle"},l={title:"",text:"",severity:s.AppNotificationSeverity.Error,icon:"exclamation-triangle"},d=(h,y="",f)=>({...g,title:h,text:y,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),o=(h,y="",f,v)=>({...l,text:(0,r.q)(y),title:h,id:(0,n.A)(),traceId:f,component:v,timestamp:Date.now(),showing:!0}),u=(h,y="",f)=>({...i,title:h,text:y,traceId:f,id:(0,n.A)(),timestamp:Date.now(),showing:!0}),c=(h,y="",f)=>({severity:s.AppNotificationSeverity.Info,icon:"info-circle",title:h,text:y,id:(0,n.A)(),timestamp:Date.now(),showing:!0});function p(){const h=(0,s.useDispatch)();return(0,t.useMemo)(()=>({success:(y,f="")=>{h((0,a.dx)(d(y,f)))},warning:(y,f="",v)=>{h((0,a.dx)(u(y,f,v)))},error:(y,f="",v)=>{h((0,a.dx)(o(y,f,v)))},info:(y,f="")=>{h((0,a.dx)(c(y,f)))}}),[h])}},39640:(_,L,e)=>{"use strict";e.d(L,{$H:()=>d,Ay:()=>o});var t=e(2543),n=e(33390),r=e(38877),s=e(19347);const a=m=>{const D=(0,s.l)().getInstanceSettings(m.datasourceName);return{id:m.ts.toString(),createdAt:m.ts,datasourceName:m.datasourceName,datasourceUid:D?.uid||"",starred:m.starred,comment:m.comment,queries:m.queries}},g=m=>{if(!(0,s.l)().getInstanceSettings({uid:m.datasourceUid}))throw new Error("Datasource not found.");return{ts:m.createdAt,datasourceName:m.datasourceName,starred:m.starred,comment:m.comment,queries:m.queries}};var i=e(75533);const l="grafana.explore.richHistory",d=1e4;class o{async getRichHistory(D){const x=h().map(a),E=D.starred?x.filter(T=>T.starred===!0):x,C=D.from&&D.to?[D.from,D.to]:void 0,b=(0,i.a_)(E,D.sortOrder,D.datasourceFilters,D.search,C);return{richHistory:b,total:b.length}}async addToRichHistory(D){const x=Date.now(),E={id:x.toString(),createdAt:x,...D},C=g(E),b=c(h()),T=C.queries.map(j=>(0,t.omit)(j,["key","refId"])),A=b.length>0&&b[0].queries.map(j=>(0,t.omit)(j,["key","refId"]));if((0,t.isEqual)(T,A)){const j=new Error("Entry already exists");throw j.name=r.m.DuplicatedEntry,j}const{queriesToKeep:R,limitExceeded:S}=p(b),O=[C,...R];try{n.A.setObject(l,O)}catch(j){if(j instanceof Error&&j.name==="QuotaExceededError")P(r.m.StorageFull,`Saving rich history failed: ${j.message}`);else throw j}return S?{warning:{type:r.C.LimitExceeded,message:`Query history reached the limit of ${d}. Old, not-starred items have been removed.`},richHistoryQuery:E}:{richHistoryQuery:E}}async deleteAll(){n.A.delete(l)}async deleteRichHistory(D){const x=parseInt(D,10),C=n.A.getObject(l,[]).filter(b=>b.ts!==x);n.A.setObject(l,C)}async updateStarred(D,x){return u(D,E=>E.starred=x)}async updateComment(D,x){return u(D,E=>E.comment=x)}async getSettings(){return{activeDatasourcesOnly:n.A.getObject(i.mE.activeDatasourcesOnly)??n.A.getObject(i.mE.legacyActiveDatasourceOnly,!1),retentionPeriod:n.A.getObject(i.mE.retentionPeriod,7),starredTabAsFirstTab:n.A.getBool(i.mE.starredTabAsFirstTab,!1),lastUsedDatasourceFilters:n.A.getObject(i.mE.datasourceFilters,[]).map(x=>x.value)}}async updateSettings(D){n.A.set(i.mE.activeDatasourcesOnly,D.activeDatasourcesOnly),n.A.set(i.mE.retentionPeriod,D.retentionPeriod),n.A.set(i.mE.starredTabAsFirstTab,D.starredTabAsFirstTab),n.A.setObject(i.mE.datasourceFilters,(D.lastUsedDatasourceFilters||[]).map(x=>({value:x})))}}function u(m,D){const x=parseInt(m,10),E=n.A.getObject(l,[]),C=(0,t.find)(E,{ts:x});if(!C)throw new Error("Rich history item not found.");return D(C),n.A.setObject(l,E),a(C)}function c(m){const D=n.A.getObject(i.mE.retentionPeriod,7),x=(0,i.wQ)(D,{isLastTs:!1});return m.filter(E=>E.ts>x||E.starred===!0)||[]}function p(m){let D=!1,x=m.length-1;for(;x>=0&&m.length>=d;)m[x].starred||(m.splice(x,1),D=!0),x--;return{queriesToKeep:m,limitExceeded:D}}function h(){const m=n.A.getObject(l,[]);return y(m)}function y(m){return m.map(x=>{const E=x.queries.map((C,b)=>f(x,C,b));return{...x,queries:E}})}function f(m,D,x){const E="ABCDEFGHIJKLMNOPQRSTUVXYZ";return typeof D=="object"?D:v(D)?JSON.parse(D):{expr:D,refId:E[x]}}function v(m){try{JSON.parse(m)}catch{return!1}return!0}function P(m,D){const x=new Error(D);throw x.name=m,x}},38877:(_,L,e)=>{"use strict";e.d(L,{C:()=>n,m:()=>t});var t=(r=>(r.StorageFull="StorageFull",r.DuplicatedEntry="DuplicatedEntry",r))(t||{}),n=(r=>(r.LimitExceeded="LimitExceeded",r))(n||{})},75533:(_,L,e)=>{"use strict";e.d(L,{a_:()=>a,mE:()=>u,wQ:()=>g});var t=e(2543),n=e.n(t),r=e(47232),s=e(91650);function a(c,p,h,y,f){const v=l(c,h),P=d(v,y),m=f?i(P,f):P;return o(m,p)}const g=(c,p)=>{let h=p.now;return h||(h=p.tz?(0,r.oZ)(p.tz):(0,r.KQ)()),h.add(-c,"d"),(p.isLastTs?h.endOf("d"):h.startOf("d")).valueOf()};function i(c,p){return c.filter(h=>h.createdAt>p[0]&&h.createdAt<p[1])}function l(c,p){return p.length>0?c.filter(h=>p.includes(h.datasourceName)):c}function d(c,p){return c.filter(h=>h.comment.includes(p)?!0:h.queries.filter(f=>Object.values((0,t.omit)(f,["datasource","key","refId","hide","queryType"])).some(v=>v?.toString().includes(p))).length>0)}const o=(c,p)=>{let h;return p===s.x.Ascending&&(h=(y,f)=>y.createdAt<f.createdAt?-1:y.createdAt>f.createdAt?1:0),p===s.x.Descending&&(h=(y,f)=>y.createdAt<f.createdAt?1:y.createdAt>f.createdAt?-1:0),p===s.x.DatasourceZA&&(h=(y,f)=>y.datasourceName<f.datasourceName?-1:y.datasourceName>f.datasourceName?1:0),p===s.x.DatasourceAZ&&(h=(y,f)=>y.datasourceName<f.datasourceName?1:y.datasourceName>f.datasourceName?-1:0),c.sort(h)},u={retentionPeriod:"grafana.explore.richHistory.retentionPeriod",starredTabAsFirstTab:"grafana.explore.richHistory.starredTabAsFirstTab",legacyActiveDatasourceOnly:"grafana.explore.richHistory.activeDatasourceOnly",activeDatasourcesOnly:"grafana.explore.richHistory.activeDatasourcesOnly",datasourceFilters:"grafana.explore.richHistory.datasourceFilters"}},11401:(_,L,e)=>{"use strict";e.d(L,{tU:()=>f,a:()=>y,gQ:()=>v});var t=e(32264),n=e(10096),r=e(91650),s=e(39640),a=e(75505),g=e(17172),i=e(19347),l=e(65615);const d=P=>{const m=(0,i.l)().getInstanceSettings({uid:P.datasourceUid});return{id:P.uid,createdAt:P.createdAt*1e3,datasourceName:m?.name||"",datasourceUid:P.datasourceUid,starred:P.starred,comment:P.comment,queries:P.queries}},o=P=>({uid:P.id,createdAt:Math.floor(P.createdAt/1e3),datasourceUid:P.datasourceUid,starred:P.starred,comment:P.comment,queries:P.queries});class u{constructor(){this.preferenceService=new l.W("user")}async addToRichHistory(m){const{result:D}=await(0,g.AI)().post("/api/query-history",{dataSourceUid:m.datasourceUid,queries:m.queries});return{richHistoryQuery:d(D)}}async deleteAll(){throw new Error("not supported")}async deleteRichHistory(m){(0,g.AI)().delete(`/api/query-history/${m}`)}async getRichHistory(m){const D=c(m);let x="query-history-get-all";m.starred&&(x="query-history-get-starred");const C=(await(0,a.s)((0,g.AI)().fetch({method:"GET",url:`/api/query-history?${D}`,requestId:x}))).data,b=(C.result.queryHistory||[]).map(d),T=C.result.totalCount||0;return{richHistory:b,total:T}}async getSettings(){return{activeDatasourcesOnly:!1,lastUsedDatasourceFilters:void 0,retentionPeriod:14,starredTabAsFirstTab:(await this.preferenceService.load()).queryHistory?.homeTab==="starred"}}async updateComment(m,D){const x=await(0,g.AI)().patch(`/api/query-history/${m}`,{comment:D});return d(x.result)}updateSettings(m){return this.preferenceService.patch({queryHistory:{homeTab:m.starredTabAsFirstTab?"starred":"query"}})}async updateStarred(m,D){let x;return D?x=await(0,g.AI)().post(`/api/query-history/star/${m}`):x=await(0,g.AI)().delete(`/api/query-history/star/${m}`),d(x.result)}}function c(P){let m=`${P.datasourceFilters.map(D=>{const x=(0,i.l)().getInstanceSettings(D).uid;return`datasourceUid=${encodeURIComponent(x)}`}).join("&")}`;return P.search&&(m=m+`&searchString=${P.search}`),P.sortOrder&&(m=m+`&sort=${P.sortOrder===r.x.Ascending?"time-asc":"time-desc"}`),P.starred||(m=m+`&to=${P.to}`,m=m+`&from=${P.from}`),m=m+"&limit=100",m=m+`&page=${P.page||1}`,P.starred&&(m=m+`&onlyStarred=${P.starred}`),m}const p=new s.Ay,h=new u,y=()=>t.$.queryHistoryEnabled?h:p,f=()=>p,v=()=>t.$.queryHistoryEnabled?{availableFilters:[r.x.Descending,r.x.Ascending],lastUsedDataSourcesAvailable:!1,clearHistory:!1,onlyActiveDataSource:!1,changeRetention:!1,queryHistoryAvailable:n.TP.isSignedIn}:{availableFilters:[r.x.Descending,r.x.Ascending,r.x.DatasourceAZ,r.x.DatasourceZA],lastUsedDataSourcesAvailable:!0,clearHistory:!0,onlyActiveDataSource:!0,changeRetention:!0,queryHistoryAvailable:!0}},16021:(_,L,e)=>{"use strict";e.d(L,{u:()=>n});var t=e(96540);function n(r,s){const[a,g]=(0,t.useState)();return(0,t.useEffect)(()=>{const i=r.subscribe(s,g);return()=>i.unsubscribe()},[r,s]),a}},60619:(_,L,e)=>{"use strict";e.d(L,{Y:()=>n});var t=e(96540);function n({breakpoint:r,onChange:s}){(0,t.useEffect)(()=>{const a=window.matchMedia(`(min-width: ${r}px)`),g=i=>s(i);return a.addEventListener("change",g),()=>a.removeEventListener("change",g)},[r,s])}},25249:(_,L,e)=>{"use strict";e.d(L,{C:()=>r});var t=e(31678),n=e(17422);const r=s=>{const a=(0,t.useSelector)(g=>g.navIndex);return(0,n.tc)(a,s)}},83277:(_,L,e)=>{"use strict";e.d(L,{s:()=>s});var t=e(96540),n=e(54148),r=e(39601);function s(){const{search:a}=(0,n.zy)(),g=(0,t.useMemo)(()=>(0,r.SE)(a||""),[a]),i=(0,t.useCallback)((l,d)=>r.Ny.partial(l,d),[]);return[g,i]}},74513:(_,L,e)=>{"use strict";e.d(L,{Nm:()=>o,Yj:()=>u,dK:()=>p,rd:()=>c,wi:()=>d});var t=e(2543),n=e.n(t);const r="en-US",s="fr-FR",a="es-ES",g="de-DE",i="pt-BR",l="zh-Hans",d="pseudo-LOCALE",o=r,u=[{code:r,name:"English",loader:{grafana:()=>e.e(9521).then(e.t.bind(e,19521,19))}},{code:s,name:"Fran\xE7ais",loader:{grafana:()=>e.e(5648).then(e.t.bind(e,35648,19))}},{code:a,name:"Espa\xF1ol",loader:{grafana:()=>e.e(680).then(e.t.bind(e,70680,19))}},{code:g,name:"Deutsch",loader:{grafana:()=>e.e(3082).then(e.t.bind(e,23082,19))}},{code:l,name:"\u4E2D\u6587\uFF08\u7B80\u4F53\uFF09",loader:{grafana:()=>e.e(9538).then(e.t.bind(e,29538,19))}},{code:i,name:"Portugu\xEAs Brasileiro",loader:{grafana:()=>e.e(2288).then(e.t.bind(e,12288,19))}}];{const h=e(55905);if(h.keys().includes("app/extensions/locales/localeExtensions")){const{LOCALE_EXTENSIONS:y,ENTERPRISE_I18N_NAMESPACE:f}=h("app/extensions/locales/localeExtensions");for(const v of u){const P=y[v.code];P&&(v.loader[f]=P)}}}const c=u.map(h=>h.code),p=(0,t.uniq)(u.flatMap(h=>Object.keys(h.loader)))},8484:(_,L,e)=>{"use strict";e.d(L,{x6:()=>c,iL:()=>h,JL:()=>o,t:()=>p});var t=e(74848),n=e(72635),r=e(94997),s=e(32389),a=e(74513);const g=y=>y.split("-")[0].toLowerCase(),i={type:"backend",init(){},async read(y,f,v){let P=a.Yj.find(x=>x.code===y);if(P||(P=a.Yj.find(x=>g(x.code)===g(y))),!P)return v(new Error(`No message loader available for ${y}`),null);const m=P.loader[f];if(!m)return v(new Error(`No message loader available for ${y} with namespace ${f}`),null);const D=await m();v(null,D)}};let l,d;async function o(y){const f={partialBundledLanguages:!0,resources:{},returnEmptyString:!1,supportedLngs:a.rd,fallbackLng:a.Nm,ns:a.dK};if(d=n.default,y==="detect"){d=d.use(r.A);const P={order:["navigator"],caches:[]};f.detection=P}else f.lng=a.rd.includes(y)?y:void 0;return await d.use(i).use(s.r9).init(f),l=n.default.getFixedT(null,a.dK),{language:d.resolvedLanguage}}function u(y){const f=VALID_LANGUAGES.includes(y)?y:void 0;return i18n.changeLanguage(f)}const c=y=>(0,t.jsx)(s.x6,{shouldUnescape:!0,ns:a.dK,...y}),p=(y,f,v)=>(l||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),l=n.default.t),l(y,f,v));function h(){return l?d||n.default:(console.warn("An attempt to internationalize was made before it was initialized. This was probably caused by calling a locale-aware function in the root module scope, instead of in render"),n.default)}},16001:(_,L,e)=>{"use strict";e.d(L,{$K:()=>y,Do:()=>o,XC:()=>c,XR:()=>u,dx:()=>d,fX:()=>m,g5:()=>h,oF:()=>p,qN:()=>P});var t=e(65307),n=e(25508),r=e(31678);const s=25,a="notifications",g=`${a}/lastRead`,i={byId:C(),lastRead:Number.parseInt(window.localStorage.getItem(g)??`${Date.now()}`,10)},l=(0,t.Z0)({name:"appNotifications",initialState:i,reducers:{notifyApp:(T,{payload:A})=>{Object.values(T.byId).some(R=>D(A,R)&&R.showing)||(T.byId[A.id]=A,b(T.byId))},hideAppNotification:(T,{payload:A})=>{A in T.byId&&(T.byId[A].showing=!1,b(T.byId))},clearNotification:(T,{payload:A})=>{delete T.byId[A],b(T.byId)},clearAllNotifications:T=>{T.byId={},b(T.byId)},readAllNotifications:(T,{payload:A})=>{T.lastRead=A}}}),{notifyApp:d,hideAppNotification:o,clearNotification:u,clearAllNotifications:c,readAllNotifications:p}=l.actions,h=l.reducer,y=T=>T.lastRead,f=T=>T.byId,v=(0,n.Mz)(f,T=>Object.values(T).sort((A,R)=>R.timestamp-A.timestamp)),P=(0,n.Mz)(v,T=>T.filter(x)),m=(0,n.Mz)(f,T=>Object.values(T).filter(A=>A.showing));function D(T,A){return T.icon===A.icon&&T.severity===A.severity&&T.text===A.text&&T.title===A.title}function x(T){return T.severity===r.AppNotificationSeverity.Warning||T.severity===r.AppNotificationSeverity.Error}function E(T){return typeof T=="object"&&T!==null&&"id"in T&&"icon"in T&&"title"in T&&"text"in T}function C(){const T=window.localStorage.getItem(a);if(!T)return{};const A=JSON.parse(T);return Object.values(A).every(R=>E(R))?A:{}}function b(T){const A=Object.values(T).filter(x).sort((R,S)=>S.timestamp-R.timestamp).slice(0,s).reduce((R,S)=>(R[S.id]={id:S.id,severity:S.severity,icon:S.icon,title:S.title,text:S.text,traceId:S.traceId,timestamp:S.timestamp,showing:!1},R),{});try{window.localStorage.setItem(a,JSON.stringify(A))}catch(R){console.error("Unable to persist notifications to local storage"),console.error(R)}}},91219:(_,L,e)=>{"use strict";e.d(L,{I_:()=>c,L1:()=>g,TU:()=>o,ci:()=>l,fc:()=>d,ve:()=>u});var t=e(65307),n=e(32264),r=e(36689);const s=n.$.bootData?.navTree??[];function a(p){return p.map(h=>{const y=h.children&&a(h.children);return{...h,children:y,text:(0,r.C)(h.id)??h.text,subTitle:(0,r.o)(h.id)??h.subTitle,emptyMessage:(0,r.C)(h.emptyMessageId)}})}const g="starred/",i=(0,t.Z0)({name:"navBarTree",initialState:()=>a(n.$.bootData?.navTree??[]),reducers:{setStarred:(p,h)=>{const y=p.find(D=>D.id==="starred"),{id:f,title:v,url:P,isStarred:m}=h.payload;if(y)if(m){y.children||(y.children=[]);const D={id:g+f,text:v,url:P};y.children.push(D),y.children.sort((x,E)=>x.text.localeCompare(E.text))}else{const D=y.children?.findIndex(x=>x.id===g+f)??-1;D>-1&&y?.children?.splice(D,1)}},setBookmark:(p,h)=>{if(!n.$.featureToggles.pinNavItems)return;const y=p.find(P=>P.id==="bookmarks"),{item:f,isSaved:v}=h.payload;if(y)if(v){y.children||=[];const P={...f,children:[],sortWeight:0,emptyMessageId:"",emptyMessage:"",parentItem:{id:y.id,text:y.text}};y.children.push(P)}else y.children=y.children?.filter(P=>P.url!==f.url)??[]},updateDashboardName:(p,h)=>{const{id:y,title:f,url:v}=h.payload,P=p.find(m=>m.id==="starred");if(P){const m=P.children?.find(D=>D.id===y);m&&(m.text=f,m.url=v,P.children?.sort((D,x)=>D.text.localeCompare(x.text)))}},removePluginFromNavTree:(p,h)=>{const y="plugin-page-"+h.payload.pluginID,f=p.findIndex(v=>v.id===y);f>-1&&p.splice(f,1)}}}),{setStarred:l,removePluginFromNavTree:d,updateDashboardName:o,setBookmark:u}=i.actions,c=i.reducer},28215:(_,L,e)=>{"use strict";e.d(L,{Id:()=>g,Im:()=>p,Vz:()=>u,YA:()=>c,_h:()=>y,s2:()=>i});var t=e(65307),n=e(2543),r=e.n(n),s=e(2913),a=e(36689);const g="home";function i(){const f={},v=(0,n.cloneDeep)(s.Ay.bootData.navTree),P=v.find(D=>D.id===g),m=v.filter(D=>D.id!==g);return P&&l(f,[P]),l(f,m,f[g]),f}function l(f,v,P){const m=[];for(const D of v){const x={...D,text:(0,a.C)(D.id)??D.text,subTitle:(0,a.o)(D.id)??D.subTitle,emptyMessage:(0,a.C)(D.emptyMessageId),parentItem:P};x.id&&(f[x.id]=x),x.children&&l(f,x.children,x),m.push(x)}P&&(P.children=m),f["not-found"]={...d("Page not found","404 Error").node},f.error={...d("Page error","An unexpected error").node}}function d(f,v){const P={text:f,subTitle:v,icon:"exclamation-triangle"};return{node:P,main:P}}const o={},u=(0,t.VP)("navIndex/updateNavIndex"),c=(0,t.VP)("navIndex/updateConfigurationSubtitle"),p=(0,t.VP)("navIndex/removeNavIndex"),h=(f,v)=>({...f,parentItem:{...f.parentItem,text:f.parentItem?.text??"",subTitle:v}}),y=(f=o,v)=>{if(u.match(v)){let m=function(E){if(E.children)for(const C of E.children)D[C.id]={...C,parentItem:E};E.parentItem&&m(E.parentItem)};var P=m;const D={},x=v.payload;return m(x),{...f,...D}}else if(c.match(v)){const m=`Organization: ${v.payload}`;return{...f,cfg:{...f.cfg,subTitle:m},datasources:h(f.datasources,m),correlations:h(f.correlations,m),users:h(f.users,m),teams:h(f.teams,m),plugins:h(f.plugins,m),"org-settings":h(f["org-settings"],m),apikeys:h(f.apikeys,m)}}else p.match(v)&&delete f[v.payload];return f}},17422:(_,L,e)=>{"use strict";e.d(L,{rH:()=>g,tc:()=>a});var t=e(41811),n=e(71101),r=e(28215);const s=()=>{const d={id:"not-found",text:"Page not found",icon:"exclamation-triangle",subTitle:"404 Error",url:"not-found"};return{node:d,main:d}},a=(0,t.A)((d,o,u,c=!1)=>{if(d[o]){const p=d[o],h=c?p:g(p),y=i(h,o);return{node:p,main:y}}return u||s()});function g(d){return d.id===n.Rj?d:d.parentItem&&d.parentItem.id!==r.Id?g(d.parentItem):d}function i(d,o){return d.id===o?{...d,active:!0}:d.children&&d.children.length>0?{...d,children:d.children.map(u=>i(u,o))}:d}const l=d=>`${d.main.text}${d.node.text?": "+d.node.text:""}`},65615:(_,L,e)=>{"use strict";e.d(L,{W:()=>n});var t=e(27677);class n{constructor(s){this.resourceUri=s}update(s){return t.IB.put(`/api/${this.resourceUri}/preferences`,s)}patch(s){return t.IB.patch(`/api/${this.resourceUri}/preferences`,s)}load(){return t.IB.get(`/api/${this.resourceUri}/preferences`)}}},11848:(_,L,e)=>{"use strict";e.d(L,{L:()=>a});var t=e(49426),n=e(32264),r=e(39601);class s{constructor(){this._activePluginId=new t.t(void 0)}assertFeatureEnabled(){return n.$.featureToggles.appSidecar?!0:(console.warn("The `appSidecar` feature toggle is not enabled, doing nothing."),!1)}get activePluginId(){return this._activePluginId.asObservable()}openApp(l){return this.assertFeatureEnabled()?this._activePluginId.next(l):!1}closeApp(l){if(!this.assertFeatureEnabled())return!1;if(this._activePluginId.getValue()===l)return this._activePluginId.next(void 0)}isAppOpened(l){return this.assertFeatureEnabled()?this._activePluginId.getValue()===l||g()===l:!1}}const a=new s;function g(){const{pathname:i}=r.Ny.getLocation();let l=i.match(/\/a\/([^/]+)/)?.[1];return!l&&i.match(/\/explore/)&&(l="explore"),!l&&i.match(/\/d\//)&&(l="dashboards"),l||"unknown"}},2619:(_,L,e)=>{"use strict";e.d(L,{Q:()=>s});var t=e(96540),n=e(13752),r=e(69731);class s{constructor(i){this._subject=new n.B,this._state=i}useState(){return a(this)}get state(){return this._state}setState(i){this._state={...this._state,...i},this._subject.next(this._state)}subscribeToState(i){return this._subject.subscribe(i)}}function a(g){const i=(0,r.C)();return(0,t.useEffect)(()=>{const l=g.subscribeToState({next:i});return()=>l.unsubscribe()},[g,i]),g.state}},27677:(_,L,e)=>{"use strict";e.d(L,{Mf:()=>Ke,IB:()=>Me,AI:()=>be});var t=e(56568),n=e(13752),r=e(75505),s=e(88483),a=e(64423),g=e(13288),i=e(65474),l=e(20039),d=e(81160),o=e(69862),u=e(59099),c=e(37748),p=e(66847),h=e(67791),y=e(16126),f=e(41560),v=e(69850),P=e(1005),m=e(62938),D=e(26272),x=e(40187),E=e(95344),C=e(32264),b=e(28138),T=e(2913),A=e(92315),R=e(67027),S=e(28676),O=e(74848),j=e(32196),B=e(40845),N=e(17464),I=e(37166),K=e(55852),w=e(88448);const U=we=>{const Be=(0,B.of)(W),He=(0,B.$j)(),Ve=(0,w.o)(He),Je=!!we.maxConcurrentSessions,nt=()=>{window.location.reload()};return(0,O.jsxs)(N.ZL,{children:[(0,O.jsx)("div",{className:Ve.modal,children:(0,O.jsxs)(I.w,{title:"You have been automatically signed out",severity:"warning",className:Be.infobox,children:[(0,O.jsxs)("div",{className:Be.text,children:[(0,O.jsxs)("p",{children:["Your session token was automatically revoked because you have reached",(0,O.jsx)("strong",{children:` the maximum number of ${Je?we.maxConcurrentSessions:""} concurrent sessions `}),"for your account."]}),(0,O.jsxs)("p",{children:[(0,O.jsx)("strong",{children:"To resume your session, sign in again."}),"Contact your administrator or visit the license page to review your quota if you are repeatedly signed out automatically."]})]}),(0,O.jsx)(K.$n,{size:"md",variant:"primary",onClick:nt,children:"Sign in"})]})}),(0,O.jsx)("div",{className:(0,j.cx)(Ve.modalBackdrop,Be.backdrop)})]})},W=we=>({infobox:(0,j.css)`
    margin-bottom: 0;
  `,text:(0,j.css)`
    margin: ${we.spacing(1,0,2)};
  `,backdrop:(0,j.css)`
    background-color: ${we.colors.background.canvas};
    opacity: 0.8;
  `});var H=e(28444),z=e(2543);const G=we=>{const Be=we.method,He=Z(we),Ve=ae(He),Je=re(we,Ve),nt=he(we);return{method:Be,headers:He,body:Je,credentials:nt}},M={canParse:()=>!0,parse:we=>(we.get("accept")||we.set("accept","application/json, text/plain, */*"),we)},Q=we=>({canParse:Be=>(Be?.method?Be?.method.toLowerCase():"")===we,parse:Be=>(Be.get("content-type")||Be.set("content-type","application/json"),Be)}),Y=Q("post"),q=Q("put"),te=Q("patch"),X=[Y,q,te,M],ee=/[^\u0000-\u00ff]/g;function ne(we){return ee.test(we)?encodeURI(we):we}const Z=we=>{const Be={};for(let[nt,pt]of Object.entries(we.headers??{}))Be[ne(nt)]=ne(pt);const He=new Headers(Be);return X.filter(nt=>nt.canParse(we)).reduce((nt,pt)=>pt.parse(nt),He)},ae=we=>{if(!we)return!1;const Be=we.get("content-type");return!!(Be&&(Be.toLowerCase()==="application/json"||Be.toLowerCase()==="application/merge-patch+json"))},re=(we,Be)=>we&&(!we.data||typeof we.data=="string"||we.data instanceof Blob?we.data:Be?JSON.stringify(we.data):new URLSearchParams(we.data));async function se(we,Be){if(Be)switch(Be){case"arraybuffer":return we.arrayBuffer();case"blob":return we.blob();case"json":return we.headers.get("Content-Length")==="0"?(console.warn(`${we.url} returned an invalid JSON`),{}):await we.json();case"text":return we.text()}const He=await we.text();try{return JSON.parse(He)}catch{}return He}function de(we){return Object.keys(we).map(Be=>{const He=we[Be];return Array.isArray(He)?He.map(Ve=>`${encodeURIComponent(Be)}=${encodeURIComponent(Ve)}`).join("&"):`${encodeURIComponent(Be)}=${encodeURIComponent(He)}`}).join("&")}const le=we=>{const Be=(0,z.omitBy)(we.params,Ve=>Ve===void 0||Ve&&Ve.length===0),He=de(Be);return we.params&&He.length?`${we.url}?${He}`:we.url},he=we=>we&&(we.credentials?we.credentials:we.withCredentials?((0,E.l)("BackendSrvRequest","withCredentials","credentials"),"include"):"same-origin");var ie=e(21969),J=(we=>(we[we.Pending=0]="Pending",we[we.InProgress=1]="InProgress",we[we.Done=2]="Done",we))(J||{});class ce{constructor(Be=!1){this.state={},this.queue=new n.B,this.updates=new n.B,this.add=(He,Ve)=>this.queue.next({id:He,options:Ve,state:0}),this.setInProgress=He=>this.queue.next({id:He,state:1}),this.setDone=He=>this.queue.next({id:He,state:2}),this.getUpdates=()=>this.updates.asObservable(),this.getUpdate=He=>{const Ve=Object.keys(He).filter(nt=>He[nt].state===1).length;return{noOfPending:Object.keys(He).filter(nt=>He[nt].state===0).length,noOfInProgress:Ve,state:He}},this.publishUpdate=(He,Ve)=>{this.printState(He,Ve),this.updates.next(He)},this.printState=(He,Ve)=>{if(!Ve)return;const Je=Object.keys(He.state).reduce((nt,pt)=>{const bt={id:pt,state:He.state[pt].state};return nt.push(bt),nt},[]);console.log("FetchQueue noOfStarted",He.noOfInProgress),console.log("FetchQueue noOfNotStarted",He.noOfPending),console.log("FetchQueue state",Je)},this.queue.subscribe(He=>{const{id:Ve,state:Je,options:nt}=He;if(this.state[Ve]||(this.state[Ve]={state:0,options:{url:""}}),Je===2){delete this.state[Ve];const bt=this.getUpdate(this.state);this.publishUpdate(bt,Be);return}this.state[Ve].state=Je,nt&&(this.state[Ve].options=nt);const pt=this.getUpdate(this.state);this.publishUpdate(pt,Be)})}}var pe=e(95864);class Pe{constructor(Be,He,Ve){const Je=Ve?.http2Enabled?1e3:5;Be.getUpdates().pipe((0,y.p)(({noOfPending:nt})=>nt>0),(0,pe.H)(({state:nt,noOfInProgress:pt})=>{const bt=Object.keys(nt).filter(ue=>nt[ue].state===J.Pending&&!(0,ie.dr)(nt[ue].options.url)).reduce((ue,Ee)=>{const Ce={id:Ee,options:nt[Ee].options};return ue.push(Ce),ue},[]),Tt=Object.keys(nt).filter(ue=>nt[ue].state===J.Pending&&(0,ie.dr)(nt[ue].options.url)).reduce((ue,Ee)=>{const Ce={id:Ee,options:nt[Ee].options};return ue.push(Ce),ue},[]),ye=Math.max(Je-pt-bt.length,0),je=Tt.slice(0,ye);return bt.concat(je)})).subscribe(({id:nt,options:pt})=>{He.add(nt,pt)})}}class Ie{constructor(Be,He){this.queue=new n.B,this.responses=new n.B,this.add=(Ve,Je)=>{this.queue.next({id:Ve,options:Je})},this.getResponses=Ve=>this.responses.asObservable().pipe((0,y.p)(Je=>Je.id===Ve)),this.queue.subscribe(Ve=>{const{id:Je,options:nt}=Ve;Be.setInProgress(Je),this.responses.next({id:Je,observable:He(nt)})})}}var ge=e(16233);const Se="cancel_all_requests_request_id",De="grafana-trace-id";class Ke{constructor(Be){this.inFlightRequests=new n.B,this.HTTP_REQUEST_CANCELED=-1,this.inspectorStream=new n.B,this._tokenRotationInProgress=null,this.deviceID=null,this.dependencies={fromFetch:l.$,appEvents:b.A,contextSrv:ge.TP,logout:()=>{ge.TP.setLoggedOut()}},Be&&(this.dependencies={...this.dependencies,...Be}),this.noBackendCache=!1,this.internalFetch=this.internalFetch.bind(this),this.fetchQueue=new ce,this.responseQueue=new Ie(this.fetchQueue,this.internalFetch),this.initGrafanaDeviceID(),new Pe(this.fetchQueue,this.responseQueue,(0,T.zj)())}async initGrafanaDeviceID(){try{const He=await(await t.Ay.load()).get();this.deviceID=He.visitorId}catch(Be){console.error(Be)}}async request(Be){return await(0,r.s)(this.fetch(Be).pipe((0,d.T)(He=>He.data)))}fetch(Be){const He=(0,m.A)(),Ve=this.fetchQueue;return new s.c(Je=>{const nt=new a.yU;return nt.add(this.responseQueue.getResponses(He).subscribe(pt=>{nt.add(pt.observable.subscribe(Je))})),this.fetchQueue.add(He,Be),function(){Ve.setDone(He),nt.unsubscribe()}})}internalFetch(Be){Be.requestId&&this.inFlightRequests.next(Be.requestId),Be=this.parseRequestOptions(Be);const He=(0,R.r)();return He!==null&&He!==""&&C.$.jwtUrlLogin&&C.$.jwtHeaderName&&(Be.headers=Be.headers??{},Be.headers[C.$.jwtHeaderName]=`${He}`),this.deviceID&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-Device-Id"]=`${this.deviceID}`),this.getFromFetchStream(Be).pipe(this.handleStreamResponse(Be),this.handleStreamError(Be),this.handleStreamCancellation(Be))}resolveCancelerIfExists(Be){this.inFlightRequests.next(Be)}cancelAllInFlightRequests(){this.inFlightRequests.next(Se)}async datasourceRequest(Be){return(0,r.s)(this.fetch(Be))}parseRequestOptions(Be){const He=this.dependencies.contextSrv.user?.orgId;return Be.retry=Be.retry??0,(0,ie.Lr)(Be.url)&&(He&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-Org-Id"]=He),Be.url.startsWith("/")&&(Be.url=Be.url.substring(1)),Be.headers?.Authorization&&(Be.headers["X-DS-Authorization"]=Be.headers.Authorization,delete Be.headers.Authorization),this.noBackendCache&&(Be.headers=Be.headers??{},Be.headers["X-Grafana-NoCache"]="true")),Be.hideFromInspector===void 0&&(Be.hideFromInspector=(0,ie.Lr)(Be.url)&&!(0,ie.dr)(Be.url)),Be}getFromFetchStream(Be){const He=le(Be),Ve=G(Be);return this.dependencies.fromFetch(He,Ve).pipe((0,o.Z)(async Je=>{const{status:nt,statusText:pt,ok:bt,headers:Tt,url:ye,type:je,redirected:ue}=Je,Ee=Be.responseType??(ae(Tt)?"json":void 0),Ce=await se(Je,Ee);return{status:nt,statusText:pt,ok:bt,data:Ce,headers:Tt,url:ye,type:je,redirected:ue,config:Be,traceId:Je.headers.get(De)??void 0}}))}showApplicationErrorAlert(Be){}showSuccessAlert(Be){const{config:He}=Be;if(He.showSuccessAlert===!1||He.showSuccessAlert===void 0&&(He.method==="GET"||(0,ie.dr)(He.url)||!(0,ie.Lr)(He.url)))return;const Ve=Be.data;Ve?.message&&this.dependencies.appEvents.emit(D.r1.alertSuccess,[Ve.message])}showErrorAlert(Be,He){if(Be.showErrorAlert===!1||Be.showErrorAlert===void 0&&((0,ie.dr)(Be.url)||!(0,ie.Lr)(Be.url)))return;let Ve="",Je=He.data.message;Je==="Unexpected error"&&He.message&&(Je=He.message),Je.length>80&&(Ve=Je,Je="Error"),He.status===422&&(Ve=He.data.message,Je="Validation failed"),this.dependencies.appEvents.emit(He.status<500?D.r1.alertWarning:D.r1.alertError,[Je,Ve,He.data.traceID])}processRequestError(Be,He){return He.data=He.data??{message:"Unexpected error"},typeof He.data=="string"&&(He.data={message:He.data,error:He.statusText,response:He.data}),He.data&&!He.data.message&&typeof He.data.error=="string"&&(He.data.message=He.data.error),He.data.message&&setTimeout(()=>{He.isHandled||this.showErrorAlert(Be,He)},50),this.inspectorStream.next({response:He,requestId:Be.requestId}),He}handleStreamResponse(Be){return He=>He.pipe((0,d.T)(Ve=>{if(!Ve.ok){const{status:Je,statusText:nt,data:pt}=Ve;throw{status:Je,statusText:nt,data:pt,config:Be,traceId:Ve.headers.get(De)??void 0}}return Ve}),(0,u.M)(Ve=>{this.showSuccessAlert(Ve),this.inspectorStream.next({response:Ve,requestId:Be.requestId})}))}handleStreamError(Be){const{isSignedIn:He}=this.dependencies.contextSrv.user;return Ve=>Ve.pipe((0,c.l)(Je=>Je.pipe((0,o.Z)((nt,pt)=>{const bt=pt===0&&Be.retry===0;if(nt.status===401&&(0,ie.Lr)(Be.url)&&bt&&He){if(nt.data?.error?.id==="ERR_TOKEN_REVOKED")return this.dependencies.appEvents.publish(new H.S8({component:U,props:{maxConcurrentSessions:nt.data?.error?.maxConcurrentSessions}})),this.dependencies.contextSrv.setRedirectToUrl(),(0,g.$)(()=>nt);let Tt=this.loginPing();return(0,A.m)()&&(0,A.W)()*1e3<Date.now()&&(Tt=this.rotateToken()),(0,i.H)(Tt).pipe((0,p.W)(ye=>(ye.status===401&&this.dependencies.logout(),(0,g.$)(ye))))}return(0,g.$)(nt)}))),(0,p.W)(Je=>(0,g.$)(()=>this.processRequestError(Be,Je))))}handleStreamCancellation(Be){return He=>He.pipe((0,h.Q)(this.inFlightRequests.pipe((0,y.p)(Ve=>{let Je=!1;return Be&&Be.requestId&&Be.requestId===Ve&&(Je=!0),Ve===Se&&(Je=!0),Je}))),(0,f.v)(()=>({type:x.v2.Cancelled,cancelled:!0,data:null,status:this.HTTP_REQUEST_CANCELED,statusText:"Request was aborted",config:Be})))}getInspectorStream(){return this.inspectorStream}async get(Be,He,Ve,Je){return this.request({...Je,method:"GET",url:Be,params:He,requestId:Ve})}async delete(Be,He,Ve){return this.request({...Ve,method:"DELETE",url:Be,data:He})}async post(Be,He,Ve){return this.request({...Ve,method:"POST",url:Be,data:He})}async patch(Be,He,Ve){return this.request({...Ve,method:"PATCH",url:Be,data:He})}async put(Be,He,Ve){return this.request({...Ve,method:"PUT",url:Be,data:He})}withNoBackendCache(Be){return this.noBackendCache=!0,Be().finally(()=>{this.noBackendCache=!1})}rotateToken(){return this._tokenRotationInProgress?this._tokenRotationInProgress:(this._tokenRotationInProgress=this.fetch({url:"/api/user/auth-tokens/rotate",method:"POST",retry:1}).pipe((0,v.j)(()=>{this._tokenRotationInProgress=null}),(0,P.u)()),this._tokenRotationInProgress)}loginPing(){return this.fetch({url:"/api/login/ping",method:"GET",retry:1})}search(Be){return this.get("/api/search",Be)}getDashboardByUid(Be){return(0,E.l)("backend_srv","getDashboardByUid(uid)","getDashboardAPI().getDashboardDTO(uid)"),(0,S.n)().getDashboardDTO(Be)}validateDashboard(Be){return Promise.resolve({isValid:!1,message:"dashboard validation is not supported"})}getPublicDashboardByUid(Be){return this.get(`/api/public/dashboards/${Be}`)}getFolderByUid(Be,He={}){const Ve=new URLSearchParams;return He.withAccessControl&&Ve.set("accesscontrol","true"),this.get(`/api/folders/${Be}?${Ve.toString()}`,void 0,void 0,{showErrorAlert:!1})}}const Me=new Ke,be=()=>Me},42614:(_,L,e)=>{"use strict";e.d(L,{n:()=>n});var t=e(63415);const n=(s,a)=>{(0,t.x$)().addEvent({type:t.on.Performance,payload:{name:s,value:a}})},r=s=>faro?.api?.pushError(s)},62301:(_,L,e)=>{"use strict";e.d(L,{A:()=>l});var t=e(2543),n=e.n(t),r=e(17172),s=e(2913),a=e(33390);class g{constructor(){}addDashboardImpression(o){const u=this.impressionKey();let c=[];a.A.exists(u)&&(c=JSON.parse(a.A.get(u)),(0,t.isArray)(c)||(c=[])),c=c.filter(p=>o!==p),c.unshift(o),c.length>50&&c.pop(),a.A.set(u,JSON.stringify(c))}async convertToUIDs(){let o=this.getImpressions();const u=(0,t.filter)(o,p=>(0,t.isNumber)(p));if(!u.length)return;const c=await(0,r.AI)().get(`/api/dashboards/ids/${u.join(",")}`);a.A.set(this.impressionKey(),JSON.stringify([...(0,t.filter)(o,p=>(0,t.isString)(p)),...c]))}getImpressions(){const o=a.A.get(this.impressionKey())||"[]";return JSON.parse(o)}async getDashboardOpened(){try{await this.convertToUIDs()}catch{}return(0,t.filter)(this.getImpressions(),u=>(0,t.isString)(u))}impressionKey(){return"dashboard_impressions-"+s.Ay.bootData.user.orgId}}const l=new g},4898:(_,L,e)=>{"use strict";e.d(L,{R:()=>P});let t={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},n={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},s={option:"alt",command:"meta",return:"enter",escape:"esc",plus:"+",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"},a=null;for(let m=1;m<20;++m)t[111+m]="f"+m;for(let m=0;m<=9;++m)t[m+96]=m.toString();function g(m){if(m.type==="keypress"){let D=String.fromCharCode(m.which);return m.shiftKey||(D=D.toLowerCase()),D}return t[m.which]?t[m.which]:n[m.which]?n[m.which]:String.fromCharCode(m.which).toLowerCase()}function i(m,D){return m.sort().join(",")===D.sort().join(",")}function l(m){let D=[];return m.shiftKey&&D.push("shift"),m.altKey&&D.push("alt"),m.ctrlKey&&D.push("ctrl"),m.metaKey&&D.push("meta"),D}function d(m){if(m.preventDefault){m.preventDefault();return}m.returnValue=!1}function o(m){if(m.stopPropagation){m.stopPropagation();return}m.cancelBubble=!0}function u(m){return m==="shift"||m==="ctrl"||m==="alt"||m==="meta"}function c(){if(!a){a={};for(let m in t){const D=parseInt(m,10);D>95&&D<112||t.hasOwnProperty(m)&&(a[t[m]]=m)}}return a}function p(m,D,x){return x||(x=c()[m]?"keydown":"keypress"),x==="keypress"&&D.length&&(x="keydown"),x}function h(m){return m==="+"?["+"]:(m=m.replace(/\+{2}/g,"+plus"),m.split("+"))}function y(m,D){let x,E,C,b=[];for(x=h(m),C=0;C<x.length;++C)E=x[C],s[E]&&(E=s[E]),D&&D!=="keypress"&&r[E]&&(E=r[E],b.push("shift")),u(E)&&b.push(E);if(!E)throw new Error("Unable to get key");return D=p(E,b,D),{key:E,modifiers:b,action:D}}function f(m,D){return m===null||m===document?!1:m===D?!0:f(m.parentNode,D)}class v{constructor(D){this._callbacks={},this._directMap={},this._sequenceLevels={},this._resetTimer=void 0,this._ignoreNextKeyup=!1,this._ignoreNextKeypress=!1,this._nextExpectedAction=!1,this._globalCallbacks={},this._resetSequences=x=>{x=x||{};let E=!1,C;for(C in this._sequenceLevels){if(x[C]){E=!0;continue}this._sequenceLevels[C]=0}E||(this._nextExpectedAction=!1)},this._getMatches=(x,E,C,b,T,A)=>{let R,S,O=[],j=C.type;if(!this._callbacks[x])return[];for(j==="keyup"&&u(x)&&(E=[x]),R=0;R<this._callbacks[x].length;++R)if(S=this._callbacks[x][R],!(!b&&S.seq&&this._sequenceLevels[S.seq]!==S.level)&&j===S.action&&(j==="keypress"&&!C.metaKey&&!C.ctrlKey||i(E,S.modifiers))){let B=!b&&S.combo===T,N=b&&S.seq===b&&S.level===A;(B||N)&&this._callbacks[x].splice(R,1),O.push(S)}return O},this._fireCallback=(x,E,C,b)=>{const T=E.target||E.srcElement;T&&T instanceof HTMLElement&&this.stopCallback(E,T,C,b)||x(E,C)===!1&&(d(E),o(E))},this._handleKey=(x,E,C)=>{let b=this._getMatches(x,E,C),T,A={},R=0,S=!1;for(T=0;T<b.length;++T)b[T].seq&&(R=Math.max(R,b[T].level??0));for(T=0;T<b.length;++T){const j=b[T].seq;if(j){if(b[T].level!==R)continue;S=!0,A[j]=1,this._fireCallback(b[T].callback,C,b[T].combo,j);const B=j.lastIndexOf(x),N=j.slice(0,B);for(const[I,K]of Object.entries(this._sequenceLevels))K>0&&I.startsWith(N)&&(A[I]=1);continue}S||this._fireCallback(b[T].callback,C,b[T].combo)}for(const j of this._callbacks[x]??[])j.action===C.type&&j.seq&&j.level===0&&(A[j.seq]=1);let O=C.type==="keypress"&&this._ignoreNextKeypress;C.type===this._nextExpectedAction&&!u(x)&&!O&&this._resetSequences(A),this._ignoreNextKeypress=S&&C.type==="keydown"},this._handleKeyEvent=x=>{if(!(x instanceof KeyboardEvent))throw new Error("Didn't get a KeyboardEvent");const E=x;if(E.repeat)return;typeof E.which!="number"&&(E.which=E.keyCode);let C=g(E);if(C){if(E.type==="keyup"&&this._ignoreNextKeyup===C){this._ignoreNextKeyup=!1;return}this.handleKey(C,l(E),E)}},this._resetSequenceTimer=()=>{clearTimeout(this._resetTimer),this._resetTimer=setTimeout(this._resetSequences,1e3)},this._bindSequence=(x,E,C,b)=>{this._sequenceLevels[x]=0;const T=R=>()=>{this._nextExpectedAction=R,++this._sequenceLevels[x],this._resetSequenceTimer()},A=R=>{this._fireCallback(C,R,x),b!=="keyup"&&(this._ignoreNextKeyup=g(R)),this._resetSequenceTimer()};for(let R=0;R<E.length;++R){let O=R+1===E.length?A:T(b||y(E[R+1]).action);this._bindSingle(E[R],O,b,x,R)}},this._bindSingle=(x,E,C,b,T)=>{this._directMap[x+":"+C]=E,x=x.replace(/\s+/g," ");let A=x.split(" "),R;if(A.length>1){this._bindSequence(x,A,E,C);return}R=y(x,C),this._callbacks[R.key]=this._callbacks[R.key]||[];const S={type:R.action,metaKey:!1,ctrlKey:!1};this._getMatches(R.key,R.modifiers,S,b,x,T);const O={callback:E,modifiers:R.modifiers,action:R.action,seq:b,level:T,combo:x};this._callbacks[R.key][b?"unshift":"push"](O)},this._bindMultiple=(x,E,C)=>{for(let b=0;b<x.length;++b)this._bindSingle(x[b],E,C)},this.bind=(x,E,C)=>(x=x instanceof Array?x:[x],this._bindMultiple(x,E,C),self),this.unbind=(x,E)=>this.bind(x,function(){},E),this.bindGlobal=(x,E,C)=>{if(this.bind(x,E,C),x instanceof Array){for(let b=0;b<x.length;b++)this._globalCallbacks[x[b]]=!0;return}this._globalCallbacks[x]=!0},this.unbindGlobal=(x,E)=>{if(this.unbind(x,E),x instanceof Array){for(let C=0;C<x.length;C++)this._globalCallbacks[x[C]]=!1;return}this._globalCallbacks[x]=!1},this.trigger=(x,E)=>{let C=this;return C._directMap[x+":"+E]&&C._directMap[x+":"+E]({},x),C},this.reset=()=>(this._callbacks={},this._directMap={},this),this.stopCallback=(x,E,C,b)=>{if(this._globalCallbacks[C]||b&&this._globalCallbacks[b]||(" "+E.className+" ").indexOf(" mousetrap ")>-1||f(E,this.target))return!1;if("composedPath"in x&&typeof x.composedPath=="function"){let T=x.composedPath()[0];T!==x.target&&T instanceof HTMLElement&&(E=T)}return!!(E.tagName==="INPUT"||E.tagName==="SELECT"||E.tagName==="TEXTAREA"||"isContentEditable"in E&&E.isContentEditable)},this.handleKey=(...x)=>this._handleKey(...x),this.addKeycodes=x=>{for(let E in x)x.hasOwnProperty(E)&&(t[E]=x[E]);a=null},this.target=D,this.target.addEventListener("keypress",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keydown",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)}),this.target.addEventListener("keyup",x=>{x instanceof KeyboardEvent&&this._handleKeyEvent(x)})}}const P=new v(document)},2769:(_,L,e)=>{"use strict";e.d(L,{K:()=>i,O:()=>l});var t=e(97594),n=e(3591),r=e(28138),s=e(2913),a=e(10096),g=e(65615);async function i(d,o){const u=s.$W.theme2,c=(0,t.g)(d);if(r.A.publish(new n.E8(c)),u.colors.mode!==c.colors.mode){const y=document.createElement("link");y.rel="stylesheet",y.href=s.$W.bootData.assets[c.colors.mode],y.onload=()=>{const f=document.getElementsByTagName("link");for(let v=0;v<f.length;v++){const P=f[v];P.href&&P.href.includes(`build/grafana.${u.colors.mode}`)&&P.remove()}},document.head.insertBefore(y,document.head.firstChild)}if(o||!a.TP.isSignedIn)return;const p=new g.W("user"),h=await p.load();await p.update({...h,theme:c.colors.mode})}async function l(d){const o=s.$W.theme2;i(o.isDark?"light":"dark",d)}},33390:(_,L,e)=>{"use strict";e.d(L,{A:()=>r});class t{get(a){return window.localStorage[a]}set(a,g){window.localStorage[a]=g}getBool(a,g){return g!==void 0&&!this.exists(a)?g:window.localStorage[a]==="true"}getObject(a,g){let i=g;if(this.exists(a)){const l=window.localStorage[a];try{i=JSON.parse(l)}catch(d){console.error(`Error parsing store object: ${a}. Returning default: ${g}. [${d}]`)}}return i}setObject(a,g){let i;try{i=JSON.stringify(g)}catch(l){throw new Error(`Could not stringify object: ${a}. [${l}]`)}try{this.set(a,i)}catch(l){const d=new Error(`Could not save item in localStorage: ${a}. [${l}]`);throw l instanceof Error&&(d.name=l.name),d}return!0}exists(a){return window.localStorage[a]!==void 0}delete(a){window.localStorage.removeItem(a)}}const r=new t},80714:(_,L,e)=>{"use strict";e.d(L,{F:()=>t});function t(n={}){return{...n,accesscontrol:!0}}},94041:(_,L,e)=>{"use strict";e.d(L,{b:()=>t});const t=(n,r,s)=>(n.splice(s,0,n.splice(r,1)[0]),n)},63917:(_,L,e)=>{"use strict";e.d(L,{gn:()=>r});function t(){const s=navigator.userAgent.indexOf("MSIE")>-1,a=navigator.userAgent.indexOf("Edge/")>-1||navigator.userAgent.indexOf("Edg/")>-1,g=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,i=/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor),l=/Edge\/([0-9.]+)/.exec(navigator.userAgent);return s&&parseFloat(/Trident\/([0-9.]+)/.exec(navigator.userAgent)[1])<=7||a&&(l&&parseFloat(l[1])<=16||parseFloat(/Edg\/([0-9.]+)/.exec(navigator.userAgent)[1])<=16)||g&&parseFloat(/Firefox\/([0-9.]+)/.exec(navigator.userAgent)[1])<=64?!1:!(i&&parseFloat(/Chrome\/([0-9.]+)/.exec(navigator.userAgent)[1])<=54)}function n(){return/(iPhone|iPad|Mac)/.test(navigator.platform)}function r(){return n()?"\u2318":"ctrl"}},34525:(_,L,e)=>{"use strict";e.d(L,{TS:()=>r});class t{_linkTo(i,l){l<=0&&i.inputEdges.push(this),l>=0&&i.outputEdges.push(this),i.edges.push(this)}link(i,l){if(!i)throw Error("inputNode is required");if(!l)throw Error("outputNode is required");return this.unlink(),this.inputNode=i,this.outputNode=l,this._linkTo(i,1),this._linkTo(l,-1),this}unlink(){let i;const l=this.inputNode,d=this.outputNode;l&&d&&(i=l.edges.indexOf(this),i>-1&&l.edges.splice(i,1),i=d.edges.indexOf(this),i>-1&&d.edges.splice(i,1),i=l.outputEdges.indexOf(this),i>-1&&l.outputEdges.splice(i,1),i=d.inputEdges.indexOf(this),i>-1&&d.inputEdges.splice(i,1))}}class n{constructor(i){this.name=i,this.edges=[],this.inputEdges=[],this.outputEdges=[]}getEdgeFrom(i){return i?typeof i=="object"?this.inputEdges.find(l=>l.inputNode?.name===i.name):this.inputEdges.find(l=>l.inputNode?.name===i):null}getEdgeTo(i){return i?typeof i=="object"?this.outputEdges.find(l=>l.outputNode?.name===i.name):this.outputEdges.find(l=>l.outputNode?.name===i):null}getOptimizedInputEdges(){const i=[];return this.inputEdges.forEach(l=>{l.inputNode?.inputEdges.map(o=>o.inputNode)?.forEach(o=>{const u=o?.getEdgeTo(this.name);u&&i.push(u)})}),this.inputEdges.filter(l=>i.indexOf(l)===-1)}}class r{constructor(){this.nodes={}}createNode(i){const l=new n(i);return this.nodes[i]=l,l}createNodes(i){const l=[];return i.forEach(d=>{l.push(this.createNode(d))}),l}link(i,l){let d=[],o=[];const u=[],c=[];i instanceof Array?d=i:d=[i],l instanceof Array?o=l:o=[l];for(let h=0;h<d.length;h++){const y=d[h];if(typeof y=="string"){const f=this.getNode(y);if(!f)throw Error(`cannot link input node named ${y} since it doesn't exist in graph`);u.push(f)}else u.push(y)}for(let h=0;h<o.length;h++){const y=o[h];if(typeof y=="string"){const f=this.getNode(y);if(!f)throw Error(`cannot link output node named ${y} since it doesn't exist in graph`);c.push(f)}else c.push(y)}const p=[];return u.forEach(h=>{c.forEach(y=>{if(this.willCreateCycle(h,y))throw Error(`cannot link ${h.name} to ${y.name} since it would create a cycle`);p.push(this.createEdge().link(h,y))})}),p}descendants(i){if(!i.length)return new Set;const l=new Set(a(i)?i.map(d=>this.nodes[d]).filter(d=>d!==void 0):i);return this.descendantsRecursive(l)}descendantsRecursive(i,l=new Set){for(const d of i){const o=new Set;for(const{inputNode:u}of d.inputEdges)u&&!l.has(u)&&(l.add(u),o.add(u));this.descendantsRecursive(o,l)}return l}willCreateCycle(i,l){if(i===l)return!0;const d=new Set,o=[l];for(;o.length;){const u=o.pop();if(u===i)return!0;d.add(u);for(const c of u.outputEdges){const p=c.outputNode;p&&!d.has(p)&&o.push(p)}}return!1}createEdge(){return new t}getNode(i){return this.nodes[i]}}const s=g=>{Object.keys(g.nodes).forEach(i=>{const l=g.nodes[i];let d=l.outputEdges.map(u=>u.outputNode?.name).join(", ");d||(d="<none>");let o=l.inputEdges.map(u=>u.inputNode?.name).join(", ");o||(o="<none>"),console.log(`${l.name}:
 - links to:   ${d}
 - links from: ${o}`)})};function a(g){return g.length>0&&typeof g[0]=="string"}},94954:(_,L,e)=>{"use strict";e.d(L,{q:()=>n});var t=e(17172);function n(r){if(typeof r=="string")return r;if(r){if(r instanceof Error)return r.message;if((0,t.NF)(r)){if(r.data&&r.data.message)return r.data.message;if(r.statusText)return r.statusText}}return JSON.stringify(r)}},87490:(_,L,e)=>{"use strict";e.d(L,{HQ:()=>m,Ll:()=>S,MA:()=>A,WP:()=>y,Xe:()=>E,_u:()=>U,bI:()=>b,dY:()=>I,di:()=>j,dr:()=>D,eF:()=>O,o$:()=>x,uE:()=>w,uJ:()=>H,uq:()=>C,w4:()=>T,zT:()=>N,zq:()=>K});var t=e(44329),n=e(62938),r=e(52622),s=e(76885),a=e(71733),g=e(41987),i=e(43127),l=e(77789),d=e(65879),o=e(19347),u=e(11134),c=e(33390),p=e(66718);const h={dedupStrategy:r.fY.none},y="0123456789abcdefghijklmnopqrstuvwxyz",f=(0,t.d_)(y,3),v="grafana.explore.datasource",P=z=>`${v}.${z}`,m=z=>c.A.getObject(P(z)),D=(z,G)=>c.A.setObject(P(z),G);function x(){for(;;){const z=f(3);if(!/^\d+$/.test(z))return z}}async function E(z){const{queries:G,dsRef:M,timeRange:Q,scopedVars:Y,adhocFilters:q}=z,te=(await Promise.allSettled(G.filter(ee=>ee.datasource?.uid!==p.Uj).map(async ee=>{const ne=await(0,o.l)().get(ee.datasource||M);return{...ne.interpolateVariablesInQueries?.([ee],Y??{},q)[0]||ee,...!ne.meta.mixed&&{datasource:ne.getRef()}}}))).filter(ee=>ee.status==="fulfilled").map(ee=>ee.value),X=JSON.stringify({[x()]:{range:(0,s.sQ)(Q.raw),queries:te,datasource:M?.uid}});return a.I.assureBaseUrl(s.kM.renderUrl("/explore",{panes:X,schemaVersion:1}))}function C(z){return`explore_${z}`}function b(z,G,M,Q,Y,q,te){const X=Number.parseInt(z,36),{interval:ee,intervalMs:ne}=W(Q,M.minInterval,M.maxDataPoints),Z={app:g.Jk.Explore,timezone:q||i.lE,startTime:Date.now(),interval:ee,intervalMs:ne,panelId:X,targets:G,range:Q,requestId:C(z),rangeRaw:Q.raw,scopedVars:{__interval:{text:ee,value:ee},__interval_ms:{text:ne,value:ne},...te},maxDataPoints:M.maxDataPoints,liveStreaming:M.liveStreaming,skipQueryCache:!0};return{queries:G,request:Z,scanning:Y,id:R(),done:!1}}const T=({key:z,...G})=>G,A=(z,G)=>{if(z==null)return"";try{return JSON.stringify(z,null,G)}catch(M){console.error(M)}return""};function R(z=0){return`Q-${(0,n.A)()}-${z}`}async function S(z,G=0,M){let Q,Y,q;return M?Y=M:z.length>0&&z[z.length-1].datasource?Y=z[z.length-1].datasource:(Q=await(0,o.l)().get(),q=Q.getDefaultQuery?.(g.Jk.Explore),Y=Q.getRef()),Q||(Q=await(0,o.l)().get(Y),q=Q.getDefaultQuery?.(g.Jk.Explore)),{...q,refId:(0,l.M)(z),key:R(G),datasource:Y}}const O=(z,G,M=0)=>{const Q=R(M),Y=z.refId||(0,l.M)(G);return{...z,refId:Y,key:Q}};async function j(z,G){if(z&&typeof z=="object"&&z.length>0){const M=[];for(let Q=0;Q<z.length;Q++){const Y=z[Q],q=R(Q);let te=Y.refId;te||(te=(0,l.M)(M));let X=!0;if(Y.datasource)try{await(0,o.l)().get(Y.datasource.uid)}catch{console.error("One of the queries has a datasource that is no longer available and was removed."),X=!1}X&&M.push({...Y,refId:te,key:q})}return M}try{const M=G??(await(0,o.l)().get()).getRef();return[await S(z??[],void 0,M)]}catch{return[]}}const B=["refId","key","context","datasource"];function N(z){return z&&z.some(G=>Object.entries(G).filter(([Q,Y])=>B.indexOf(Q)===-1).filter(([Q,Y])=>Y).length>0)}const I=z=>z.reduce((M,Q,Y)=>{const q=Q.datasource?.uid||Q.key;return M.concat(`${q}-${Y}`)},[]),K=(z,G,M)=>d.convertRawToRange(G,z,M),w=z=>u.cC.isLive(z)?r.uH.Ascending:r.uH.Descending,U=z=>{z&&z.unsubscribe()};function W(z,G,M){return M?d.calculateInterval(z,M,G):{interval:"1s",intervalMs:1e3}}const H=z=>{if(navigator.clipboard&&window.isSecureContext)navigator.clipboard.writeText(z);else{const G=document.createElement("textarea");G.value=z,document.body.appendChild(G),G.select(),document.execCommand("copy"),document.body.removeChild(G)}}},78827:(_,L,e)=>{"use strict";e.r(L),e.d(L,{default:()=>t});function t(n,r){r=r||{};const s=r.delimiter||".";let a=r.maxDepth||3,g=1;const i={};function l(d,o){Object.entries(d).forEach(([u,c])=>{const p=r?.safe&&Array.isArray(c),y=Object.prototype.toString.call(c)==="[object Object]",f=o?o+s+u:u;if(r?.maxDepth||(a=g+1),!p&&y&&Object.keys(c).length&&g<a)return++g,l(c,f);i[f]=c})}return l(n,null),i}},68576:(_,L,e)=>{"use strict";e.d(L,{A:()=>i});var t=e(95344),n=e(54479),r=e(65879),s=e(83195);const g={valueFormats:{},intervalRegex:/(\d+(?:\.\d+)?)(ms|[Mwdhmsy])/,intervalsInSeconds:{y:31536e3,M:2592e3,w:604800,d:86400,h:3600,m:60,s:1,ms:.001},regexEscape:l=>((0,t.l)("kbn.ts","kbn.regexEscape()","escapeRegex from @grafana/data"),(0,n.$f)(l)),roundInterval:l=>((0,t.l)("kbn.ts","kbn.roundInterval()","@grafana/data"),r.roundInterval(l)),secondsToHms:l=>((0,t.l)("kbn.ts","kbn.secondsToHms()","@grafana/data"),r.secondsToHms(l)),secondsToHhmmss:l=>{const d=[],o=Math.floor(l/3600),u=Math.floor(l%3600/60),c=Math.floor(l%3600%60);return o>9?d.push(""+o):d.push("0"+o),u>9?d.push(""+u):d.push("0"+u),c>9?d.push(""+c):d.push("0"+c),d.join(":")},toPercent:(l,d)=>Math.floor(l/d*1e4)/100+"%",addSlashes:l=>l.replace(/[\'\"\\0]/g,"\\$&"),describeInterval:l=>((0,t.l)("kbn.ts","kbn.describeInterval()","@grafana/data"),r.describeInterval(l)),intervalToSeconds:l=>((0,t.l)("kbn.ts","rangeUtil.intervalToSeconds()","@grafana/data"),r.intervalToSeconds(l)),intervalToMs:l=>((0,t.l)("kbn.ts","rangeUtil.intervalToMs()","@grafana/data"),r.intervalToMs(l)),calculateInterval:(l,d,o)=>((0,t.l)("kbn.ts","kbn.calculateInterval()","@grafana/data"),r.calculateInterval(l,d,o)),queryColorDot:(l,d)=>'<div class="icon-circle" style="'+["display:inline-block","color:"+l,"font-size:"+d+"px"].join(";")+'"></div>',slugifyForUrl:l=>l.toLowerCase().replace(/[^\w ]+/g,"").replace(/ +/g,"-"),stringToJsRegex:l=>((0,t.l)("kbn.ts","kbn.stringToJsRegex()","@grafana/data"),(0,n.dO)(l)),toFixed:(l,d)=>{if(l===null)return"";const o=d?Math.pow(10,Math.max(0,d)):1,u=String(Math.round(l*o)/o);if(u.indexOf("e")!==-1||l===0)return u;if(d!=null){const c=u.indexOf("."),p=c===-1?0:u.length-c-1;if(p<d)return(p?u:u+".")+String(o).slice(1,d-p+1)}return u},toFixedScaled:(l,d,o,u,c)=>o===null?g.toFixed(l,d)+c:g.toFixed(l,o+u)+c,roundValue:(l,d)=>{if(l===null)return null;const o=Math.pow(10,d),u=(o*l).toFixed(d);return Math.round(parseFloat(u))/o},getUnitFormats:s.Ke};typeof Proxy<"u"?g.valueFormats=new Proxy(g.valueFormats,{get(l,d,o){if(typeof d!="string")throw{message:`Value format ${String(d)} is not a string`};const u=(0,s.j_)(d);return u?(c,p,h,y)=>(0,s.cN)(u(c,p,h,y?"utc":"browser")):Reflect.get(l,d,o)}}):g.valueFormats=(0,s.uH)();const i=g},78160:(_,L,e)=>{"use strict";e.d(L,{j:()=>n,z:()=>r});var t=e(42614);function n(s){if(!(!performance||!performance.mark))try{performance.mark(`${s}_started`)}catch(a){console.error(`[Metrics] Failed to startMeasure ${s}`,a)}}function r(s){if(!(!performance||!performance.mark))try{const a=`${s}_started`,g=`${s}_completed`,i=`${s}_measured`;performance.mark(g);const l=performance.measure(i,a,g);return(0,t.n)(`${s}_ms`,l.duration),performance.clearMarks(a),performance.clearMarks(g),performance.clearMeasures(i),l}catch(a){console.error(`[Metrics] Failed to stopMeasure ${s}`,a);return}}},36689:(_,L,e)=>{"use strict";e.d(L,{C:()=>r,o:()=>s});var t=e(32264),n=e(8484);function r(a){switch(a){case"home":return(0,n.t)("nav.home.title","Home");case"home-setup-guide":return(0,n.t)("nav.setup-guide.title","Setup guide");case"new":return(0,n.t)("nav.new.title","New");case"create":return(0,n.t)("nav.create.title","Create");case"create-dashboard":return(0,n.t)("nav.create-dashboard.title","Dashboard");case"folder":return(0,n.t)("nav.create-folder.title","Folder");case"import":return(0,n.t)("nav.create-import.title","Import dashboard");case"alert":return(0,n.t)("nav.create-alert.title","New alert rule");case"bookmarks":return(0,n.t)("nav.bookmarks.title","Bookmarks");case"bookmarks-empty":return(0,n.t)("nav.bookmarks-empty.title","Bookmark pages for them to appear here");case"starred":return(0,n.t)("nav.starred.title","Starred");case"starred-empty":return(0,n.t)("nav.starred-empty.title","Your starred dashboards will appear here");case"dashboards":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/browse":return(0,n.t)("nav.dashboards.title","Dashboards");case"dashboards/playlists":return(0,n.t)("nav.playlists.title","Playlists");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.title","Snapshots");case"dashboards/library-panels":return(0,n.t)("nav.library-panels.title","Library panels");case"reports":return(0,n.t)("nav.reporting.title","Reporting");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.title","Shared dashboards"):(0,n.t)("nav.public.title","Public dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.title","Recently deleted");case"dashboards/new":return(0,n.t)("nav.new-dashboard.title","New dashboard");case"dashboards/folder/new":return(0,n.t)("nav.new-folder.title","New folder");case"dashboards/import":return(0,n.t)("nav.create-import.title","Import dashboard");case"scenes":return(0,n.t)("nav.scenes.title","Scenes");case"explore":return(0,n.t)("nav.explore.title","Explore");case"alerting":return(0,n.t)("nav.alerting.title","Alerting");case"plugin-page-grafana-oncall-app":return(0,n.t)("nav.oncall.title","OnCall");case"alerting-legacy":return(0,n.t)("nav.alerting-legacy.title","Alerting (legacy)");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.title","Alerting upgrade");case"alert-home":return(0,n.t)("nav.alerting-home.title","Home");case"alert-list":return(0,n.t)("nav.alerting-list.title","Alert rules");case"alert-list-legacy":return(0,n.t)("nav.alert-list-legacy.title","Alert rules");case"receivers":return(0,n.t)("nav.alerting-receivers.title","Contact points");case"am-routes":return(0,n.t)("nav.alerting-am-routes.title","Notification policies");case"channels":return(0,n.t)("nav.alerting-channels.title","Notification channels");case"silences":return(0,n.t)("nav.alerting-silences.title","Silences");case"groups":return(0,n.t)("nav.alerting-groups.title","Active notifications");case"alerting-admin":return(0,n.t)("nav.alerting-admin.title","Settings");case"cfg":return(0,n.t)("nav.config.title","Administration");case"cfg/general":return(0,n.t)("nav.config-general.title","General");case"cfg/plugins":return(0,n.t)("nav.config-plugins.title","Plugins and data");case"cfg/access":return(0,n.t)("nav.config-access.title","Users and access");case"datasources":return(0,n.t)("nav.datasources.title","Data sources");case"authentication":return(0,n.t)("nav.authentication.title","Authentication");case"licensing":return(0,n.t)("nav.statistics-and-licensing.title","Statistics and licensing");case"recordedQueries":return(0,n.t)("nav.recorded-queries.title","Recorded queries");case"correlations":return(0,n.t)("nav.correlations.title","Correlations");case"users":return(0,n.t)("nav.users.title","Users");case"teams":return(0,n.t)("nav.teams.title","Teams");case"plugins":return(0,n.t)("nav.plugins.title","Plugins");case"org-settings":return(0,n.t)("nav.org-settings.title","Default preferences");case"apikeys":return(0,n.t)("nav.api-keys.title","API keys");case"serviceaccounts":return(0,n.t)("nav.service-accounts.title","Service accounts");case"admin":return(0,n.t)("nav.admin.title","Server admin");case"support-bundles":return(0,n.t)("nav.support-bundles.title","Support bundles");case"global-users":return(0,n.t)("nav.global-users.title","Users");case"global-orgs":return(0,n.t)("nav.global-orgs.title","Organizations");case"server-settings":return(0,n.t)("nav.server-settings.title","Settings");case"storage":return(0,n.t)("nav.storage.title","Storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.title","Migrate to Grafana Cloud");case"upgrading":return(0,n.t)("nav.upgrading.title","Stats and license");case"monitoring":return(0,n.t)("nav.monitoring.title","Observability");case"infrastructure":return(0,n.t)("nav.infrastructure.title","Infrastructure");case"frontend":return(0,n.t)("nav.frontend.title","Frontend");case"apps":return(0,n.t)("nav.apps.title","More apps");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.title","Alerts & IRM");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.title","Testing & synthetics");case"plugin-page-grafana-incident-app":return(0,n.t)("nav.incidents.title","Incident");case"plugin-page-grafana-ml-app":return(0,n.t)("nav.machine-learning.title","Machine learning");case"plugin-page-grafana-slo-app":return(0,n.t)("nav.slo.title","SLO");case"plugin-page-k6-app":return(0,n.t)("nav.k6.title","Performance");case"monitoring":return(0,n.t)("nav.observability.title","Observability");case"plugin-page-grafana-k8s-app":return(0,n.t)("nav.kubernetes.title","Kubernetes");case"plugin-page-grafana-app-observability-app":return(0,n.t)("nav.application.title","Application");case"plugin-page-grafana-pyroscope-app":return(0,n.t)("nav.profiles.title","Profiles");case"plugin-page-grafana-kowalski-app":return(0,n.t)("nav.frontend-app.title","Frontend");case"plugin-page-grafana-synthetic-monitoring-app":return(0,n.t)("nav.synthetics.title","Synthetics");case"help":return(0,n.t)("nav.help.title","Help");case"profile/settings":return(0,n.t)("nav.profile/settings.title","Profile");case"profile/notifications":return(0,n.t)("nav.profile/notifications.title","Notification history");case"profile/password":return(0,n.t)("nav.profile/password.title","Change password");case"sign-out":return(0,n.t)("nav.sign-out.title","Sign out");case"search":return(0,n.t)("nav.search-dashboards.title","Search dashboards");case"connections":return(0,n.t)("nav.connections.title","Connections");case"connections-add-new-connection":return(0,n.t)("nav.add-new-connections.title","Add new connection");case"standalone-plugin-page-/connections/collector":return(0,n.t)("nav.collector.title","Collector");case"connections-datasources":return(0,n.t)("nav.data-sources.title","Data sources");case"standalone-plugin-page-/connections/infrastructure":return(0,n.t)("nav.integrations.title","Integrations");case"standalone-plugin-page-/connections/connect-data":return(0,n.t)("nav.connect-data.title","Connect data");case"standalone-plugin-page-/connections/private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.title","Private data source connect");case"plugin-page-grafana-detect-app":return(0,n.t)("nav.detect.title","Detect");case"plugin-page-grafana-quaderno-app":return(0,n.t)("nav.grafana-quaderno.title","Grafana Quaderno");default:return}}function s(a){switch(a){case"dashboards":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"dashboards/browse":return(0,n.t)("nav.dashboards.subtitle","Create and manage dashboards to visualize your data");case"manage-folder":return(0,n.t)("nav.manage-folder.subtitle","Manage folder dashboards and permissions");case"dashboards/playlists":return(0,n.t)("nav.playlists.subtitle","Groups of dashboards that are displayed in a sequence");case"dashboards/snapshots":return(0,n.t)("nav.snapshots.subtitle","Interactive, publically available, point-in-time representations of dashboards and panels");case"dashboards/public":return t.$.featureToggles.newDashboardSharingComponent?(0,n.t)("nav.shared-dashboard.subtitle","Manage your organization's externally shared dashboards"):void 0;case"dashboards/library-panels":return(0,n.t)("nav.library-panels.subtitle","Reusable panels that can be added to multiple dashboards");case"dashboards/recently-deleted":return(0,n.t)("nav.recently-deleted.subtitle","Any items listed here for more than 30 days will be automatically deleted.");case"alerting":return(0,n.t)("nav.alerting.subtitle","Learn about problems in your systems moments after they occur");case"alerting-upgrade":return(0,n.t)("nav.alerting-upgrade.subtitle","Upgrade your existing legacy alerts and notification channels to the new Grafana Alerting");case"alerting-admin":return(0,n.t)("nav.alerting-admin.subtitle","Manage Alertmanager configurations");case"alert-list":return(0,n.t)("nav.alerting-list.subtitle","Rules that determine whether an alert will fire");case"receivers":return(0,n.t)("nav.alerting-receivers.subtitle","Choose how to notify your contact points when an alert instance fires");case"am-routes":return(0,n.t)("nav.alerting-am-routes.subtitle","Determine how alerts are routed to contact points");case"silences":return(0,n.t)("nav.alerting-silences.subtitle","Stop notifications from one or more alerting rules");case"groups":return(0,n.t)("nav.alerting-groups.subtitle","See grouped alerts with active notifications");case"datasources":return(0,n.t)("nav.datasources.subtitle","Add and configure data sources");case"correlations":return(0,n.t)("nav.correlations.subtitle","Add and configure correlations");case"users":return(0,n.t)("nav.users.subtitle","Invite and assign roles to users");case"teams":return(0,n.t)("nav.teams.subtitle","Groups of users that have common dashboard and permission needs");case"plugins":return(0,n.t)("nav.plugins.subtitle","Extend the Grafana experience with plugins");case"org-settings":return(0,n.t)("nav.org-settings.subtitle","Manage preferences across an organization");case"apikeys":return(0,n.t)("nav.api-keys.subtitle","Manage and create API keys that are used to interact with Grafana HTTP APIs");case"serviceaccounts":return(0,n.t)("nav.service-accounts.subtitle","Use service accounts to run automated workloads in Grafana");case"groupsync":return(0,n.t)("nav.groupsync.subtitle","Manage mappings of Identity Provider groups to Grafana Roles");case"global-users":return(0,n.t)("nav.global-users.subtitle","Manage users in Grafana");case"global-orgs":return(0,n.t)("nav.global-orgs.subtitle","Isolated instances of Grafana running on the same server");case"server-settings":return(0,n.t)("nav.server-settings.subtitle","View the settings defined in your Grafana config");case"storage":return(0,n.t)("nav.storage.subtitle","Manage file storage");case"migrate-to-cloud":return(0,n.t)("nav.migrate-to-cloud.subtitle","Copy configuration from your self-managed installation to a cloud stack");case"support-bundles":return(0,n.t)("nav.support-bundles.subtitle","Download support bundles");case"admin":return(0,n.t)("nav.admin.subtitle","Manage server-wide settings and access to resources such as organizations, users, and licenses");case"cfg/general":return(0,n.t)("nav.config-general.subtitle","Manage default preferences and settings across Grafana");case"cfg/plugins":return(0,n.t)("nav.config-plugins.subtitle","Install plugins and define the relationships between data");case"cfg/access":return(0,n.t)("nav.config-access.subtitle","Configure access for individual users, teams, and service accounts");case"apps":return(0,n.t)("nav.apps.subtitle","App plugins that extend the Grafana experience");case"monitoring":return(0,n.t)("nav.monitoring.subtitle","Out-of-the-box observability solutions");case"infrastructure":return(0,n.t)("nav.infrastructure.subtitle","Understand your infrastructure's health");case"frontend":return(0,n.t)("nav.frontend.subtitle","Gain real user monitoring insights");case"alerts-and-incidents":return(0,n.t)("nav.alerts-and-incidents.subtitle","Alerting and incident management apps");case"testing-and-synthetics":return(0,n.t)("nav.testing-and-synthetics.subtitle","Optimize performance with k6 and Synthetic Monitoring insights");case"connections-add-new-connection":return(0,n.t)("nav.connections.subtitle","Browse and create new connections");case"connections-datasources":return(0,n.t)("nav.data-sources.subtitle","View and manage your connected data source connections");case"connections-private-data-source-connections":return(0,n.t)("nav.private-data-source-connections.subtitle","Query data that lives within a secured network without opening the network to inbound traffic from Grafana Cloud. Learn more in our docs.");default:return}}},28874:(_,L,e)=>{"use strict";e.d(L,{v:()=>r});var t=e(2543),n=e.n(t);function r(s){return(0,t.isArray)(s)?s.map(r):(0,t.isPlainObject)(s)?Object.keys(s).sort().reduce((a,g)=>{const i=s[g];return i!=null&&(a[g]=r(i)),a},{}):s}},21969:(_,L,e)=>{"use strict";e.d(L,{Ih:()=>n,Lr:()=>a,U7:()=>r,dr:()=>s,fE:()=>g});var t=e(77789);function n(i){const l=["refId","hide","key","queryType","datasource"];for(const d in i)if(d!=="label"&&!l.includes(d))return!1;return!0}function r(i,l,d){const o={...l,refId:(0,t.M)(i),hide:!1};return!o.datasource&&d&&(o.datasource=d),[...i,o]}function s(i){return i.indexOf("api/datasources/proxy")!==-1||i.indexOf("api/ds/query")!==-1}function a(i){return!i.match(/^http/)}function g(i){return i||void 0}},81523:(_,L,e)=>{"use strict";e.d(L,{Ax:()=>S,DI:()=>f,Gx:()=>P,IA:()=>b,NC:()=>E,TR:()=>j,U3:()=>C,X1:()=>m,cX:()=>x,ev:()=>A,l0:()=>y,oU:()=>D,rs:()=>v,x8:()=>O,xB:()=>h.x});var t=e(2543),n=e.n(t),r=e(76885),s=e(72724),a=e(19347),g=e(82467),i=e(3169),l=e(8484),d=e(99140),o=e(38877),u=e(75533),c=e(11401),p=e(16233),h=e(91650);async function y(N){const{queries:I,localOverride:K,datasource:w,starred:U,comment:W,showNotif:H}=N,z=H?.quotaExceededError??!0,G=H?.limitExceededWarning??!0,M=H?.otherErrors??!0,Q=I&&I.filter(Y=>B(Y));if(Q.length>0){let Y=!1,q=!1,te;try{te=(await(K?(0,c.tU)():(0,c.a)()).addToRichHistory({datasourceUid:w.uid,datasourceName:w.name??"",queries:Q,starred:U,comment:W??""})).warning}catch(X){return X instanceof Error&&(X.name===o.m.StorageFull?(Y=!0,z&&(0,d.JD)((0,g.dx)((0,i.gi)(X.message)))):M&&X.name!==o.m.DuplicatedEntry&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.update-failed","Rich History update failed"),X.message)))),{richHistoryStorageFull:Y,limitExceeded:q}}return te&&te.type===o.C.LimitExceeded&&(q=!0,G&&(0,d.JD)((0,g.dx)((0,i.q8)(te.message)))),{richHistoryStorageFull:Y,limitExceeded:q}}return{}}async function f(N){const I={...N,from:N.to===void 0?N.to:(0,u.wQ)(N.to,{isLastTs:!0,tz:p.TP.user?.timezone}),to:N.from===void 0?N.from:(0,u.wQ)(N.from,{isLastTs:!0,tz:p.TP.user?.timezone})};return await(0,c.a)().getRichHistory(I)}async function v(N){await(0,c.a)().updateSettings(N)}async function P(){return await(0,c.a)().getSettings()}async function m(){return(0,c.a)().deleteAll()}async function D(N,I){try{return await(0,c.a)().updateStarred(N,I)}catch(K){K instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),K.message)));return}}async function x(N,I){try{return await(0,c.a)().updateComment(N,I)}catch(K){K instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),K.message)));return}}async function E(N){try{return await(0,c.a)().deleteRichHistory(N),N}catch(I){I instanceof Error&&(0,d.JD)((0,g.dx)((0,i.gi)((0,l.t)("explore.rich-history-utils-notification.saving-failed","Saving rich history failed"),I.message)));return}}const C=N=>{const I={range:{from:(0,l.t)("explore.rich-history-utils.default-from","now-1h"),to:(0,l.t)("explore.rich-history-utils.default-to","now")},datasource:N.datasourceName,queries:N.queries},K=(0,r.Pp)(I),w=/.*(?=\/explore)/.exec(`${window.location.href}`)[0];return r.kM.renderUrl(`${w}/explore`,{left:K})},b=N=>{let I;switch(N){case 0:I=(0,l.t)("explore.rich-history-utils.today","today");break;case 1:I=(0,l.t)("explore.rich-history-utils.yesterday","yesterday");break;case 7:I=(0,l.t)("explore.rich-history-utils.a-week-ago","a week ago");break;case 14:I=(0,l.t)("explore.rich-history-utils.two-weeks-ago","two weeks ago");break;default:I=(0,l.t)("explore.rich-history-utils.days-ago","{{num}} days ago",{num:`${N}`})}return I};function T(N){return(0,s.LE)(N,{format:"MMMM D"})}function A(N){const I=(0,t.omit)(N,["key","refId","datasource"]);return JSON.stringify(I)}function R(N,I){let K="";return I===h.x.DatasourceAZ||I===h.x.DatasourceZA?K=N.datasourceName:K=T(N.createdAt),K}function S(N,I){return I?.getQueryDisplayText?I.getQueryDisplayText(N):A(N)}function O(N,I){let K={};return N.forEach(w=>{let U=R(w,I);U in K?K[U]=[...K[U],w]:K[U]=[w]}),K}function j(){return(0,a.l)().getList({mixed:!0}).map(N=>({name:N.name,uid:N.uid}))}function B(N){const I=(0,t.omit)(N,["key","refId","datasource"]);return Object.keys(I).length>0}},91650:(_,L,e)=>{"use strict";e.d(L,{x:()=>t});var t=(n=>(n.Descending="Descending",n.Ascending="Ascending",n.DatasourceAZ="Datasource A-Z",n.DatasourceZA="Datasource Z-A",n))(t||{})},7030:(_,L,e)=>{"use strict";e.d(L,{$l:()=>P,Sp:()=>f,VN:()=>v,VP:()=>y,fn:()=>h});var t=e(41811),n=e(32264),r=e(17172),s=e(39601),a=e(81887),g=e(82467),i=e(3169),l=e(11982),d=e(99140),o=e(8484),u=e(87490);function c(){return`${window.location.protocol}//${window.location.host}${n.$.appSubUrl}`}function p(m){let D=m.replace(c(),"");return D.startsWith("/")?D.substring(1,D.length):D}const h=(0,t.A)(async function(m){try{return(await(0,r.AI)().post("/api/short-urls",{path:p(m)})).url}catch(D){console.error("Error when creating shortened link: ",D),(0,d.JD)((0,g.dx)((0,i.gi)("Error generating shortened link")))}}),y=async m=>{const D=await h(m);D?((0,u.uJ)(D),(0,d.JD)((0,g.dx)((0,i.tZ)("Shortened link copied to clipboard")))):(0,d.JD)((0,g.dx)((0,i.gi)("Error generating shortened link")))},f=async(m,D,x)=>{const E=v(m,D,x);if(D.useShortUrl)return await y(E);(0,u.uJ)(E),(0,d.JD)((0,g.dx)((0,i.tZ)((0,o.t)("link.share.copy-to-clipboard","Link copied to clipboard"))))},v=(m,D,x)=>{const E=s.Ny.getLocation(),C=a.jh.getTimeRange(x??m),b=P(D,C,x);return(0,l.uZ)({uid:m.state.uid,slug:m.state.meta.slug,currentQueryParams:E.search,updateQuery:b,absolute:!0})},P=(m,D,x)=>{const E={};return x&&(E.viewPanel=x.state.key),m.useAbsoluteTimeRange&&(E.from=D.state.value.from.toISOString(),E.to=D.state.value.to.toISOString()),m.theme!=="current"&&(E.theme=m.theme),E}},92247:(_,L,e)=>{"use strict";e.r(L),e.d(L,{getPrecision:()=>a,getScaledDecimals:()=>n,getStringPrecision:()=>g,grafanaTimeFormat:()=>r,logp:()=>s,tickStep:()=>t});function t(i,l,d){const o=Math.sqrt(50),u=Math.sqrt(10),c=Math.sqrt(2),p=Math.abs(l-i)/Math.max(0,d);let h=Math.pow(10,Math.floor(Math.log(p)/Math.LN10));const y=p/h;return y>=o?h*=10:y>=u?h*=5:y>=c&&(h*=2),l<i?-h:h}function n(i,l){return i-Math.floor(Math.log(l)/Math.LN10)}function r(i,l,d){if(l&&d&&i){const o=d-l,u=o/i/1e3,c=864e5,p=31536e6;return u<=45?"HH:mm:ss":u<=7200||o<=c?"HH:mm":u<=8e4?"MM/DD HH:mm":u<=2419200||o<=p?"MM/DD":"YYYY-MM"}return"HH:mm"}function s(i,l){return Math.log(i)/Math.log(l)}function a(i){const l=i.toString();return g(l)}function g(i){if(isNaN(i))return 0;const l=i.indexOf(".");return l===-1?0:i.length-l-1}},80582:(_,L,e)=>{"use strict";e.d(L,{Wb:()=>n,Zk:()=>r,zG:()=>s});var t=e(47232);const n=(a,g)=>{const i={from:(0,t.yT)(g.from),to:(0,t.yT)(g.to)},l=(i.to.valueOf()-i.from.valueOf())/2;let d,o;return a===-1?(d=i.to.valueOf()-l,o=i.from.valueOf()-l):a===1?(d=i.to.valueOf()+l,o=i.from.valueOf()+l,d>Date.now()&&i.to.valueOf()<Date.now()&&(d=Date.now(),o=i.from.valueOf())):(d=i.to.valueOf(),o=i.from.valueOf()),{from:o,to:d}},r=(a,g)=>{const i=a.to.valueOf()-a.from.valueOf(),l=a.to.valueOf()-i/2,d=i===0?3e4:i*g,o=l+d/2;return{from:l-d/2,to:o}};async function s(){const a=await navigator.clipboard.readText();let g;try{return g=JSON.parse(a),!g.from||!g.to?{range:a,isError:!0}:{range:g,isError:!1}}catch{return{range:a,isError:!0}}}},94515:(_,L,e)=>{"use strict";e.d(L,{iU:()=>n});var t=e(47232);function n(a,g){if(!(a.fromDayOfWeek||a.from)&&!(a.toDayOfWeek||a.to))return[];const i={...a};i.from&&!i.to&&(i.to=i.from),!i.from&&i.to&&(i.from=i.to);const l={from:r(i.from),to:r(i.to)};if(!i.fromDayOfWeek&&i.toDayOfWeek&&(i.fromDayOfWeek=i.toDayOfWeek),!i.toDayOfWeek&&i.fromDayOfWeek&&(i.toDayOfWeek=i.fromDayOfWeek),i.fromDayOfWeek&&(l.from.dayOfWeek=Number(i.fromDayOfWeek)),i.toDayOfWeek&&(l.to.dayOfWeek=Number(i.toDayOfWeek)),l.from.dayOfWeek&&l.from.h==null&&l.from.m==null&&(l.from.h=0,l.from.m=0,l.from.s=0),l.to.dayOfWeek&&l.to.h==null&&l.to.m==null&&(l.to.h=23,l.to.m=59,l.to.s=59),!l.from||!l.to)return[];l.from.h==null&&(l.from.h=0),l.to.h==null&&(l.to.h=23);const d=[],o=(0,t.KQ)(g.from).utc();for(o.set("hour",0),o.set("minute",0),o.set("second",0),o.set("millisecond",0),o.add(l.from.h,"hours"),o.add(l.from.m,"minutes"),o.add(l.from.s,"seconds");o.unix()<=g.to.unix();){for(;l.from.dayOfWeek&&l.from.dayOfWeek!==o.isoWeekday();)o.add(24,"hours");if(o.unix()>g.to.unix())break;const u=(0,t.KQ)(o).utc();if(u.hour)if(l.from.h<=l.to.h)u.add(l.to.h-l.from.h,"hours");else if(l.from.h>l.to.h)for(;u.hour()!==l.to.h;)u.add(1,"hours");else for(u.add(24-l.from.h,"hours");u.hour()!==l.to.h;)u.add(1,"hours");for(u.set("minute",l.to.m??0),u.set("second",l.to.s??0);l.to.dayOfWeek&&l.to.dayOfWeek!==u.isoWeekday();)u.add(24,"hours");o.unix()<g.from.unix()&&u.unix()<g.from.unix()||o.unix()>g.to.unix()&&u.unix()>g.to.unix()||d.push({from:o.valueOf(),to:u.valueOf()}),o.add(24,"hours")}return d}function r(a){const g={};if(!a?.length)return g;const i=a.split(":");return i?.length&&(g.h=Math.min(23,Math.max(0,Number(i[0]))),i.length>1&&(g.m=Math.min(60,Math.max(0,Number(i[1]))),i.length>2&&(g.s=Math.min(60,Math.max(0,Number(i[2])))))),g}function s(a){if(!a||a.h==null&&a.m==null&&a.s==null)return"";let g=String(a.h??0).padStart(2,"0")+":"+String(a.m??0).padStart(2,"0");return a.s!=null&&(g+=String(a.s??0).padStart(2,"0")),g}},67027:(_,L,e)=>{"use strict";e.d(L,{r:()=>n});let t="";const n=()=>{const s=new URLSearchParams(window.location.search).get("auth_token");return s!==null&&s!==""?(t=s,s):t}},13762:(_,L,e)=>{"use strict";e.d(L,{G:()=>O});var t=e(74848),n=e(32196),r=e(91076),s=e(2543),a=e(96540),g=e(83580),i=e(55852),l=e(37390),d=e(40845),o=e(88575),u=e(14186),c=e(39268),p=e(94354),h=e(24022),y=e(88841),f=e(29158),v=e(10354),P=e(67061),m=e(90182);const D=({value:B,onChange:N,suggestions:I,contentTypeHeader:K=!1})=>{const w=(0,d.of)(x),U=B.find(([re,se])=>re==="Content-Type"),[W,H]=(0,a.useState)(""),[z,G]=(0,a.useState)(""),[M,Q]=(0,a.useState)("");(0,a.useEffect)(()=>{M!==""?Q(M):U&&Q(U[1])},[M,U]);const[Y,q]=(0,a.useState)(Math.random().toString()),te=re=>{G(re)},X=re=>{H(re)},ee=re=>()=>{const se=B.filter(de=>de[0]!==re);N(se)},ne=re=>{let se;B?se=B.filter(de=>de[0]!==(re?re[0]:W)):se=[],se.push(re??[W,z]),se.sort((de,le)=>de[0].localeCompare(le[0])),N(se),H(""),G(""),q(Math.random().toString())},Z=re=>{Q(re),ne(["Content-Type",re])},ae=W===""||z==="";return(0,t.jsxs)("div",{children:[(0,t.jsxs)(P.B,{direction:"row",children:[(0,t.jsx)(y.y,{value:W,onChange:X,suggestions:I,placeholder:"Key",style:{width:332}}),(0,t.jsx)(y.y,{value:z,onChange:te,suggestions:I,placeholder:"Value",style:{width:332}}),(0,t.jsx)(f.K,{"aria-label":"add",name:"plus-circle",onClick:()=>ne(),disabled:ae})]},Y),(0,t.jsx)(P.B,{direction:"column",children:Array.from(B.filter(re=>re[0]!=="Content-Type")||[]).map(re=>(0,t.jsxs)(P.B,{direction:"row",children:[(0,t.jsx)(v.p,{disabled:!0,value:re[0]}),(0,t.jsx)(v.p,{disabled:!0,value:re[1]}),(0,t.jsx)(f.K,{"aria-label":"delete",onClick:ee(re[0]),name:"trash-alt"})]},re[0]))}),K&&(0,t.jsx)("div",{className:w.extraHeader,children:(0,t.jsxs)(P.B,{direction:"row",children:[(0,t.jsx)(v.p,{value:"Content-Type",disabled:!0}),(0,t.jsx)(m.l6,{onChange:re=>Z(re.value),options:g.Ur,value:M})]})})]})},x=B=>({extraHeader:(0,n.css)({marginTop:B.spacing(1),marginBottom:B.spacing(1),maxWidth:673})}),E=13,C=(0,a.memo)(({index:B,value:N,onChange:I,suggestions:K})=>{const w=(0,d.of)(b),U=q=>{I(B,{...N,title:q})},W=q=>{I(B,{...N,fetch:{...N.fetch,url:q}})},H=q=>{I(B,{...N,fetch:{...N.fetch,body:q}})},z=q=>{I(B,{...N,fetch:{...N.fetch,method:q}})},G=q=>{I(B,{...N,fetch:{...N.fetch,queryParams:q}})},M=q=>{I(B,{...N,fetch:{...N.fetch,headers:q}})},Q=(q="{}")=>{try{const te=JSON.parse(q);return(0,t.jsx)(h.B,{json:te})}catch(te){return te instanceof Error?`Invalid JSON provided: ${te.message}`:"Invalid JSON provided"}},Y=N.fetch.method!==g.DO.GET&&N.fetch.headers?.some(([q,te])=>q==="Content-Type"&&te==="application/json");return(0,t.jsxs)("div",{className:w.listItem,children:[(0,t.jsx)(o.D,{label:"Title",children:(0,t.jsx)(y.y,{value:N.title,onChange:U,suggestions:K,autoFocus:N.title==="",placeholder:"Action title"})}),(0,t.jsx)(c.C,{children:(0,t.jsx)(u.I,{label:"Method",labelWidth:E,grow:!0,children:(0,t.jsx)(p.z,{value:N?.fetch.method,options:g.ki,onChange:z,fullWidth:!0})})}),(0,t.jsx)(c.C,{children:(0,t.jsx)(u.I,{label:"URL",labelWidth:E,grow:!0,children:(0,t.jsx)(y.y,{value:N.fetch.url,onChange:W,suggestions:K,placeholder:"URL"})})}),(0,t.jsx)(o.D,{label:"Query parameters",className:w.fieldGap,children:(0,t.jsx)(D,{value:N?.fetch.queryParams??[],onChange:G,suggestions:K})}),(0,t.jsx)(o.D,{label:"Headers",children:(0,t.jsx)(D,{value:N?.fetch.headers??[],onChange:M,suggestions:K,contentTypeHeader:!0})}),N?.fetch.method!==g.DO.GET&&(0,t.jsx)(o.D,{label:"Body",children:(0,t.jsx)(y.y,{value:N.fetch.body,onChange:H,suggestions:K,type:y.c.TextAreaElement})}),Y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{}),Q(N?.fetch.body)]})]})}),b=B=>({listItem:(0,n.css)({marginBottom:B.spacing()}),infoText:(0,n.css)({paddingBottom:B.spacing(2),marginLeft:"66px",color:B.colors.text.secondary}),fieldGap:(0,n.css)({marginTop:B.spacing(2)})});C.displayName="ActionEditor";const T=({action:B,index:N,onSave:I,onCancel:K,getSuggestions:w})=>{const[U,W]=(0,a.useState)(B);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(C,{value:U,index:N,onChange:(H,z)=>{W(z)},suggestions:w()}),(0,t.jsxs)(l.a.ButtonRow,{children:[(0,t.jsx)(i.$n,{variant:"secondary",onClick:()=>K(N),fill:"outline",children:"Cancel"}),(0,t.jsx)(i.$n,{onClick:()=>{I(N,U)},disabled:U.title.trim()===""||U.fetch.url.trim()==="",children:"Save"})]})]})};var A=e(14578);const R=({action:B,onEdit:N,onRemove:I,index:K,itemKey:w})=>{const U=(0,d.of)(S),{title:W=""}=B,H=W.trim()!=="";return(0,t.jsx)(r.sx,{draggableId:w,index:K,children:z=>(0,t.jsx)(t.Fragment,{children:(0,a.createElement)("div",{className:(0,n.cx)(U.wrapper,U.dragRow),ref:z.innerRef,...z.draggableProps,key:K},(0,t.jsx)("div",{className:U.linkDetails,children:(0,t.jsx)("div",{className:(0,n.cx)(U.url,!H&&U.notConfigured),children:H?W:"Action title not provided"})}),(0,t.jsxs)("div",{className:U.icons,children:[(0,t.jsx)(f.K,{name:"pen",onClick:N,className:U.icon,tooltip:"Edit action title"}),(0,t.jsx)(f.K,{name:"times",onClick:I,className:U.icon,tooltip:"Remove action title"}),(0,t.jsx)("div",{className:U.dragIcon,...z.dragHandleProps,children:(0,t.jsx)(A.I,{name:"draggabledots",size:"lg"})})]}))})},w)},S=B=>({wrapper:(0,n.css)({display:"flex",flexGrow:1,alignItems:"center",justifyContent:"space-between",width:"100%",padding:"5px 0 5px 10px",borderRadius:B.shape.radius.default,background:B.colors.background.secondary,gap:8}),linkDetails:(0,n.css)({display:"flex",flexDirection:"column",flexGrow:1}),errored:(0,n.css)({color:B.colors.error.text,fontStyle:"italic"}),notConfigured:(0,n.css)({fontStyle:"italic"}),title:(0,n.css)({color:B.colors.text.primary,fontSize:B.typography.size.sm,fontWeight:B.typography.fontWeightMedium}),url:(0,n.css)({color:B.colors.text.secondary,fontSize:B.typography.size.sm,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"calc(100% - 100px)"}),dragIcon:(0,n.css)({cursor:"grab",color:B.colors.text.secondary,margin:B.spacing(0,.5)}),icon:(0,n.css)({color:B.colors.text.secondary}),dragRow:(0,n.css)({position:"relative"}),icons:(0,n.css)({display:"flex",padding:6,alignItems:"center",gap:8})}),O=({actions:B,onChange:N,data:I,getSuggestions:K,showOneClick:w=!1})=>{const[U,W]=(0,a.useState)(null),[H,z]=(0,a.useState)(!1),[G,M]=(0,a.useState)([]);(0,a.useEffect)(()=>{M(B??[])},[B]);const Q=(0,d.of)(j),Y=U!==null,q=(ae,re)=>{if(H)if(re.title.trim()===""){z(!1),W(null);return}else W(null),z(!1);const se=(0,s.cloneDeep)(G);se[ae]=re,N(se),W(null)},te=()=>{let ae=(0,s.cloneDeep)(G);W(ae.length),z(!0)},X=ae=>{H&&z(!1),W(null)},ee=ae=>{const re=(0,s.cloneDeep)(G);re.splice(ae,1),N(re)},ne=ae=>{if(!B||!ae.destination)return;const re=(0,s.cloneDeep)(G),se=re[ae.source.index];re.splice(ae.source.index,1),re.splice(ae.destination.index,0,se),M(re),N(re)},Z=(ae,re)=>w?(0,t.jsxs)("div",{className:Q.oneClickOverlay,children:[(0,t.jsx)("span",{className:Q.oneClickSpan,children:"One-click action"})," ",ae]},re):ae;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.JY,{onDragEnd:ne,children:(0,t.jsx)(r.gL,{droppableId:"sortable-actions",direction:"vertical",children:ae=>(0,t.jsxs)("div",{className:Q.wrapper,ref:ae.innerRef,...ae.droppableProps,children:[G.map((re,se)=>{const de=`${re.title}/${se}`,le=(0,t.jsx)("div",{className:Q.itemWrapper,children:(0,t.jsx)(R,{index:se,action:re,onChange:q,onEdit:()=>W(se),onRemove:()=>ee(se),data:I,itemKey:de},de)},de);return se===0?Z(le,de):le}),ae.placeholder]})})}),Y&&U!==null&&(0,t.jsx)(l.a,{title:"Edit action",isOpen:!0,closeOnBackdropClick:!1,onDismiss:()=>{X(U)},children:(0,t.jsx)(T,{index:U,action:H?g.mx:G[U],data:I,onSave:q,onCancel:X,getSuggestions:K})}),(0,t.jsx)(i.$n,{size:"sm",icon:"plus",onClick:te,variant:"secondary",className:Q.button,children:"Add action"})]})},j=B=>({wrapper:(0,n.css)({marginBottom:B.spacing(2),display:"flex",flexDirection:"column"}),oneClickOverlay:(0,n.css)({height:"auto",border:`2px dashed ${B.colors.text.link}`,fontSize:10,color:B.colors.text.primary,marginBottom:B.spacing(1)}),oneClickSpan:(0,n.css)({padding:10,marginBottom:-10,display:"inline-block"}),itemWrapper:(0,n.css)({padding:"4px 8px 8px 8px"}),button:(0,n.css)({marginLeft:B.spacing(1)})})},57334:(_,L,e)=>{"use strict";e.d(L,{$u:()=>W,A5:()=>Y,Bc:()=>q,DX:()=>B,JI:()=>O,Jc:()=>N,Kg:()=>j,MV:()=>f,N6:()=>m,P3:()=>E,Pi:()=>C,T$:()=>T,TK:()=>h,VR:()=>A,Vk:()=>z,hG:()=>P,hU:()=>K,is:()=>te,kz:()=>c,ly:()=>y,mI:()=>S,nM:()=>U,nh:()=>x,nr:()=>v,pm:()=>R,xq:()=>M,yd:()=>H});var t=e(2543),n=e.n(t),r=e(72724),s=e(33378),a=e(17172),g=e(39601),i=e(2913),l=e(10096),d=e(80714),o=e(31678),u=e(44672);function c(X){return async ee=>{try{ee((0,u.D1)(!1)),await ee(p(X)),await ee(D(X)),await ee(b(X)),i.Ay.ldapEnabled&&(0,s.a)("ldapsync")&&await ee(R()),ee((0,u.D1)(!0))}catch(ne){if(console.error(ne),(0,a.NF)(ne)){const Z={title:ne.data.message,body:ne.data.error};ee((0,u.PV)(Z))}}}}function p(X){return async ee=>{const ne=await(0,a.AI)().get(`/api/users/${X}`,(0,d.F)());ee((0,u.G_)(ne))}}function h(X){return async ee=>{await(0,a.AI)().put(`/api/users/${X.id}`,X),ee(c(X.id))}}function y(X,ee){return async ne=>{const Z={password:ee};await(0,a.AI)().put(`/api/admin/users/${X}/password`,Z),ne(c(X))}}function f(X){return async ee=>{await(0,a.AI)().post(`/api/admin/users/${X}/disable`),g.Ny.push("/admin/users")}}function v(X){return async ee=>{await(0,a.AI)().post(`/api/admin/users/${X}/enable`),ee(c(X))}}function P(X){return async ee=>{await(0,a.AI)().delete(`/api/admin/users/${X}`),g.Ny.push("/admin/users")}}function m(X,ee){return async ne=>{const Z={isGrafanaAdmin:ee};await(0,a.AI)().put(`/api/admin/users/${X}/permissions`,Z),ne(c(X))}}function D(X){return async ee=>{const ne=await(0,a.AI)().get(`/api/users/${X}/orgs`);ee((0,u.OF)(ne))}}function x(X,ee,ne){return async Z=>{const ae={loginOrEmail:X.login,role:ne};await(0,a.AI)().post(`/api/orgs/${ee}/users/`,ae),Z(c(X.id))}}function E(X,ee,ne){return async Z=>{const ae={role:ne};await(0,a.AI)().patch(`/api/orgs/${ee}/users/${X}`,ae),Z(c(X))}}function C(X,ee){return async ne=>{await(0,a.AI)().delete(`/api/orgs/${ee}/users/${X}`),ne(c(X))}}function b(X){return async ee=>{if(!l.TP.hasPermission(o.AccessControlAction.UsersAuthTokenList))return;const ne=await(0,a.AI)().get(`/api/admin/users/${X}/auth-tokens`);ne.reverse();const Z=ne.map(ae=>({id:ae.id,isActive:ae.isActive,seenAt:(0,r.fq)(ae.seenAt),createdAt:ae.createdAt,clientIp:ae.clientIp,browser:ae.browser,browserVersion:ae.browserVersion,os:ae.os,osVersion:ae.osVersion,device:ae.device}));ee((0,u.ag)(Z))}}function T(X,ee){return async ne=>{const Z={authTokenId:X};await(0,a.AI)().post(`/api/admin/users/${ee}/revoke-auth-token`,Z),ne(b(ee))}}function A(X){return async ee=>{await(0,a.AI)().post(`/api/admin/users/${X}/logout`),ee(b(X))}}function R(){return async X=>{const ee=l.TP.hasPermission(o.AccessControlAction.LDAPStatusRead);if((0,s.a)("ldapsync")&&ee){const ne=await(0,a.AI)().get("/api/admin/ldap-sync-status");X((0,u.OR)(ne))}}}function S(X){return async ee=>{await(0,a.AI)().post(`/api/admin/ldap/sync/${X}`),ee(c(X))}}function O(){return async X=>{if(l.TP.hasPermission(o.AccessControlAction.LDAPStatusRead))try{const ee=await(0,a.AI)().get("/api/admin/ldap/status");X((0,u.pH)(ee))}catch(ee){if((0,a.NF)(ee)){ee.isHandled=!0;const ne={title:ee.data.message,body:ee.data.error};X((0,u.V$)(ne))}}}}function j(X){return async ee=>{try{const ne=await(0,a.AI)().get(`/api/admin/ldap/${encodeURIComponent(X)}`),{name:Z,surname:ae,email:re,login:se,isGrafanaAdmin:de,isDisabled:le,roles:he,teams:ie}=ne,J={info:{name:Z,surname:ae,email:re,login:se},permissions:{isGrafanaAdmin:de,isDisabled:le},roles:he,teams:ie};ee((0,u.TW)(J))}catch(ne){if((0,a.NF)(ne)){ne.isHandled=!0;const Z={title:ne.data.message,body:ne.data.error};ee((0,u.Vv)()),ee((0,u.Nf)(Z))}}}}function B(){return X=>{X((0,u.zi)())}}function N(){return X=>{X((0,u.zi)()),X((0,u.Vv)())}}const I=X=>X.map(ee=>Array.isArray(ee.value)?ee.value.map(ne=>`${ee.name}=${ne.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function K(){return async(X,ee)=>{try{const{perPage:ne,page:Z,query:ae,filters:re,sort:se}=ee().userListAdmin;let de=`/api/users/search?perpage=${ne}&page=${Z}&query=${ae}&${I(re)}`;se&&(de+=`&sort=${se}`);const le=await(0,a.AI)().get(de);X((0,u.Mb)(le))}catch(ne){(0,u.g4)(),console.error(ne)}}}const w=(0,t.debounce)(X=>X(K()),500);function U(X){return async ee=>{ee((0,u.Cj)()),ee((0,u.L5)(X)),w(ee)}}function W(X){return async ee=>{ee((0,u.Cj)()),ee((0,u.jX)(X)),w(ee)}}function H(X){return async ee=>{ee((0,u.Cj)()),ee((0,u.EC)(X)),ee(K())}}function z({sortBy:X}){const ee=X.length?`${X[0].id}-${X[0].desc?"desc":"asc"}`:void 0;return async(ne,Z)=>{Z().userListAdmin.sort!==ee&&(ne((0,u.Cj)()),ne((0,u.$u)(ee)),ne(K()))}}const G=X=>X.map(ee=>Array.isArray(ee.value)?ee.value.map(ne=>`${ee.name}=${ne.value}`).join("&"):`${ee.name}=${ee.value}`).join("&");function M(){return async(X,ee)=>{try{const{perPage:ne,page:Z,query:ae,filters:re,sort:se}=ee().userListAnonymousDevices;let de=`/api/anonymous/search?perpage=${ne}&page=${Z}&query=${ae}&${G(re)}`;se&&(de+=`&sort=${se}`);const le=await(0,a.AI)().get(de);X((0,u.o3)(le))}catch(ne){console.error(ne)}}}const Q=(0,t.debounce)(X=>X(M()),500);function Y({sortBy:X}){const ee=X.length?`${X[0].id}-${X[0].desc?"desc":"asc"}`:void 0;return async(ne,Z)=>{Z().userListAnonymousDevices.sort!==ee&&(ne((0,u.kh)(ee)),ne(M()))}}function q(X){return async ee=>{ee((0,u.xx)(X)),Q(ee)}}function te(X){return async ee=>{ee((0,u.iK)(X)),ee(M())}}},44672:(_,L,e)=>{"use strict";e.d(L,{$u:()=>S,Ay:()=>W,Cj:()=>C,D1:()=>v,EC:()=>A,G_:()=>h,L5:()=>T,Mb:()=>E,Nf:()=>d,OF:()=>y,OR:()=>l,PV:()=>P,TW:()=>o,V$:()=>i,Vv:()=>a,ag:()=>f,g4:()=>b,iK:()=>K,jX:()=>R,kh:()=>I,o3:()=>N,pH:()=>g,xx:()=>w,zi:()=>s});var t=e(65307);const n={connectionInfo:[],syncInfo:void 0,user:void 0,connectionError:void 0,userError:void 0},r=(0,t.Z0)({name:"ldap",initialState:n,reducers:{ldapConnectionInfoLoadedAction:(H,z)=>({...H,ldapError:void 0,connectionInfo:z.payload}),ldapFailedAction:(H,z)=>({...H,ldapError:z.payload}),ldapSyncStatusLoadedAction:(H,z)=>({...H,syncInfo:z.payload}),userMappingInfoLoadedAction:(H,z)=>({...H,user:z.payload,userError:void 0}),userMappingInfoFailedAction:(H,z)=>({...H,user:void 0,userError:z.payload}),clearUserMappingInfoAction:(H,z)=>({...H,user:void 0}),clearUserErrorAction:(H,z)=>({...H,userError:void 0})}}),{clearUserErrorAction:s,clearUserMappingInfoAction:a,ldapConnectionInfoLoadedAction:g,ldapFailedAction:i,ldapSyncStatusLoadedAction:l,userMappingInfoFailedAction:d,userMappingInfoLoadedAction:o}=r.actions,u=r.reducer,c={user:void 0,sessions:[],orgs:[],isLoading:!0,error:void 0},p=(0,t.Z0)({name:"userAdmin",initialState:c,reducers:{userProfileLoadedAction:(H,z)=>({...H,user:z.payload}),userOrgsLoadedAction:(H,z)=>({...H,orgs:z.payload}),userSessionsLoadedAction:(H,z)=>({...H,sessions:z.payload}),userAdminPageLoadedAction:(H,z)=>({...H,isLoading:!z.payload}),userAdminPageFailedAction:(H,z)=>({...H,error:z.payload,isLoading:!1})}}),{userProfileLoadedAction:h,userOrgsLoadedAction:y,userSessionsLoadedAction:f,userAdminPageLoadedAction:v,userAdminPageFailedAction:P}=p.actions,m=p.reducer,D={users:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!1}],isLoading:!0},x=(0,t.Z0)({name:"userListAdmin",initialState:D,reducers:{usersFetched:(H,z)=>{const{totalCount:G,perPage:M,...Q}=z.payload,Y=Math.ceil(G/M);return{...H,...Q,totalPages:Y,perPage:M,showPaging:Y>1,isLoading:!1}},usersFetchBegin:H=>({...H,isLoading:!0}),usersFetchEnd:H=>({...H,isLoading:!1}),queryChanged:(H,z)=>({...H,query:z.payload,page:0}),pageChanged:(H,z)=>({...H,page:z.payload}),sortChanged:(H,z)=>({...H,page:0,sort:z.payload}),filterChanged:(H,z)=>{const{name:G,value:M}=z.payload;return H.filters.some(Q=>Q.name===G)?{...H,page:0,filters:H.filters.map(Q=>Q.name===G?{...Q,value:M}:Q)}:{...H,page:0,filters:[...H.filters,z.payload]}}}}),{usersFetched:E,usersFetchBegin:C,usersFetchEnd:b,queryChanged:T,pageChanged:A,filterChanged:R,sortChanged:S}=x.actions,O=x.reducer,j={devices:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,filters:[{name:"activeLast30Days",value:!0}]},B=(0,t.Z0)({name:"userListAnonymousDevices",initialState:j,reducers:{usersAnonymousDevicesFetched:(H,z)=>{const{totalCount:G,perPage:M,...Q}=z.payload,Y=Math.ceil(G/M);return{...H,...Q,totalPages:Y,perPage:M,showPaging:Y>1}},anonQueryChanged:(H,z)=>({...H,query:z.payload,page:0}),anonPageChanged:(H,z)=>({...H,page:z.payload}),anonUserSortChanged:(H,z)=>({...H,page:0,sort:z.payload}),filterChanged:(H,z)=>{const{name:G,value:M}=z.payload;return H.filters.some(Q=>Q.name===G)?{...H,page:0,filters:H.filters.map(Q=>Q.name===G?{...Q,value:M}:Q)}:{...H,page:0,filters:[...H.filters,z.payload]}}}}),{usersAnonymousDevicesFetched:N,anonUserSortChanged:I,anonPageChanged:K,anonQueryChanged:w}=B.actions,U=B.reducer,W={ldap:u,userAdmin:m,userListAdmin:O,userListAnonymousDevices:U}},55907:(_,L,e)=>{"use strict";e.d(L,{A:()=>m,p:()=>i});var t=e(2543),n=e.n(t),r=e(1062);const s=new r.tI({type:"query",params:[{name:"queryRefId",type:"string",dynamicLookup:!0},{name:"from",type:"string",options:["10s","1m","5m","10m","15m","1h","2h","6h","12h","24h","48h"]},{name:"to",type:"string",options:["now","now-1m","now-5m","now-10m","now-1h"]}],defaultParams:["#A","15m","now","avg"]}),a=[{text:"Query",value:"query"}],g={alerting:1,firing:1,no_data:2,pending:3,ok:4,paused:5,inactive:5};var i=(D=>(D.IsAbove="gt",D.IsBelow="lt",D.IsOutsideRange="outside_range",D.IsWithinRange="within_range",D.HasNoValue="no_value",D))(i||{});const l=[{value:"gt",text:"IS ABOVE"},{value:"lt",text:"IS BELOW"},{value:"outside_range",text:"IS OUTSIDE RANGE"},{value:"within_range",text:"IS WITHIN RANGE"},{value:"no_value",text:"HAS NO VALUE"}],d=[{text:"OR",value:"or"},{text:"AND",value:"and"},{text:"LOGIC OR",value:"logic-or"}],o=[{text:"avg()",value:"avg"},{text:"min()",value:"min"},{text:"max()",value:"max"},{text:"sum()",value:"sum"},{text:"count()",value:"count"},{text:"last()",value:"last"},{text:"median()",value:"median"},{text:"diff()",value:"diff"},{text:"diff_abs()",value:"diff_abs"},{text:"percent_diff()",value:"percent_diff"},{text:"percent_diff_abs()",value:"percent_diff_abs"},{text:"count_non_null()",value:"count_non_null"}],u=[{text:"Alerting",value:"alerting"},{text:"No Data",value:"no_data"},{text:"Keep Last State",value:"keep_state"},{text:"Ok",value:"ok"}],c=[{text:"Alerting",value:"alerting"},{text:"Keep Last State",value:"keep_state"}];function p(D){const x=new r.tI({type:D.type,defaultParams:[]});return new r.kW(D,x)}function h(D){return D.toLowerCase().replace(/_/g,"").split(" ")[0]}function y(D){switch(h(D)){case"normal":case"ok":return{text:"OK",iconClass:"heart",stateClass:"alert-state-ok"};case"alerting":return{text:"ALERTING",iconClass:"heart-break",stateClass:"alert-state-critical"};case"nodata":return{text:"NO DATA",iconClass:"question-circle",stateClass:"alert-state-warning"};case"paused":return{text:"PAUSED",iconClass:"pause",stateClass:"alert-state-paused"};case"pending":return{text:"PENDING",iconClass:"hourglass",stateClass:"alert-state-warning"};case"firing":return{text:"FIRING",iconClass:"fire",stateClass:""};case"inactive":return{text:"INACTIVE",iconClass:"check",stateClass:""};case"error":return{text:"ERROR",iconClass:"heart-break",stateClass:"alert-state-critical"};case"unknown":default:return{text:"UNKNOWN",iconClass:"question-circle",stateClass:".alert-state-paused"}}}function f(D,x){return(0,t.reduce)(D,(E,C)=>(C.metric!==void 0&&C.value!==void 0&&E.push(C.metric+"="+C.value),C.Metric!==void 0&&C.Value!==void 0&&E.push(C.Metric+"="+C.Value),E),[]).join(x)}function v(D){return(0,t.isArray)(D.data)?f(D.data,", "):(0,t.isArray)(D.data.evalMatches)?f(D.data.evalMatches,", "):D.data.error?"Error: "+D.data.error:""}function P(D){return(0,t.isArray)(D)?f(D,", "):(0,t.isArray)(D.evalMatches)?f(D.evalMatches,", "):D.error?"Error: "+D.error:""}const m={alertQueryDef:s,getStateDisplayModel:y,conditionTypes:a,evalFunctions:l,evalOperators:d,noDataModes:u,executionErrorModes:c,reducerTypes:o,createReducerPart:p,getAlertAnnotationInfo:v,getAlertAnnotationText:P,alertStateSortScore:g}},1062:(_,L,e)=>{"use strict";e.d(L,{Dw:()=>g,Wn:()=>a,kW:()=>s,tI:()=>r});var t=e(2543),n=e.n(t);class r{constructor(o){this.type=o.type,this.params=o.params,this.defaultParams=o.defaultParams,this.renderer=o.renderer,this.category=o.category,this.addStrategy=o.addStrategy}}class s{constructor(o,u){if(this.part=o,this.def=u,!this.def)throw{message:"Could not find query part "+o.type};o.params=o.params||(0,t.clone)(this.def.defaultParams),this.params=o.params,this.text="",this.updateText()}render(o){return this.def.renderer(this,o)}hasMultipleParamsInString(o,u){return o.indexOf(",")===-1?!1:this.def.params[u+1]&&this.def.params[u+1].optional}updateParam(o,u){if(this.hasMultipleParamsInString(o,u)){(0,t.each)(o.split(","),(c,p)=>{this.updateParam(c.trim(),p)});return}o===""&&this.def.params[u].optional?this.params.splice(u,1):this.params[u]=o,this.part.params=this.params,this.updateText()}updateText(){if(this.params.length===0){this.text=this.def.type+"()";return}let o=this.def.type+"(";o+=this.params.join(", "),o+=")",this.text=o}}function a(d,o){const u=d.def.type+"(",c=(0,t.map)(d.params,(p,h)=>{const y=d.def.params[h];return y.type==="time"&&p==="auto"&&(p="$__interval"),y.quote==="single"?"'"+p+"'":y.quote==="double"?'"'+p+'"':p});return o&&c.unshift(o),u+c.join(", ")+")"}function g(d,o){return o+" "+d.params[0]}function i(d,o){return d.params[0]}function l(d,o){return'"'+d.params[0]+'"'}},25027:(_,L,e)=>{"use strict";e.d(L,{AK:()=>R,Cl:()=>w,FF:()=>y,Hs:()=>H,IR:()=>A,KF:()=>P,Ke:()=>D,P6:()=>U,QA:()=>f,Rk:()=>T,Sn:()=>B,Sq:()=>C,U6:()=>I,U7:()=>v,aL:()=>N,fH:()=>c,iW:()=>W,l$:()=>h,le:()=>u,nf:()=>b,t6:()=>K,vV:()=>p,zs:()=>O});var t=e(2543),n=e.n(t),r=e(47232),s=e(34867),a=e(17172),g=e(32264),i=e(14110),l=e(10096),d=e(28475);const o=7,u={filterByLabel:"filtering alert instances by label",loadedList:"loaded Alert Rules list",leavingRuleGroupEdit:"leaving rule group edit without saving",alertRuleFromPanel:"creating alert rule from panel",alertRuleFromScratch:"creating alert rule from scratch",recordingRuleFromScratch:"creating recording rule from scratch",clickingAlertStateFilters:"clicking alert state filters",cancelSavingAlertRule:"user canceled alert rule creation",successSavingAlertRule:"alert rule saved successfully",unknownMessageFromError:"unknown messageFromError",grafanaRecording:"creating Grafana recording rule from scratch",loadedCentralAlertStateHistory:"loaded central alert state history"},{logInfo:c,logError:p,logMeasurement:h,logWarning:y}=(0,s.DW)("features.alerting",{module:"Alerting"});function f(z,G,M){return async function(...Q){const Y=performance.now(),q=await G(...Q),te=performance.now()-Y;return h(z,{loadTimesMs:te},M),q}}function v(z,G,M){return async(...Q)=>{const Y=performance.now(),q=await G(...Q),{namespacesCount:te,groupsCount:X,rulesCount:ee}=m(q);return h(z,{loadTimeMs:performance.now()-Y,namespacesCount:te,groupsCount:X,rulesCount:ee},M),q}}function P(z){Object.entries(z).forEach(([G,M])=>{const Q=M.message??"unknown error",Y=String(M.type)??"unknown",q=new Error(Q);p(q,{field:G,type:Y})})}function m(z){const G=z.length,M=z.flatMap(q=>q.groups).length,Q=z.flatMap(q=>q.groups).flatMap(q=>q.rules).length;return{namespacesCount:G,groupsCount:M,rulesCount:Q}}function D(z,G,M){return async(...Q)=>{const Y=performance.now(),q=await G(...Q),{namespacesCount:te,groupsCount:X,rulesCount:ee}=x(q);return h(z,{namespacesCount:te,groupsCount:X,rulesCount:ee,loadTimeMs:performance.now()-Y},M),q}}function x(z){const G=Object.keys(z),M=Object.values(z).flatMap(Y=>Y),Q=M.flatMap(Y=>Y.rules);return{namespacesCount:G.length,groupsCount:M.length,rulesCount:Q.length}}async function E(){try{const{createdAt:z}=await(0,a.AI)().get("/api/user"),G=(0,r.KQ)().subtract(o,"days"),M=(0,r.KQ)(z);return G.isBefore(M)}catch{return!0}}const C=async(z={grafana_version:g.$.buildInfo.version,org_id:l.TP.user.orgId,user_id:l.TP.user.id})=>{await E()||(0,i.rR)("grafana_alerting_navigation",z)},b=z=>{(0,i.rR)("grafana_alerting_rule_creation",z)},T=z=>{(0,i.rR)("grafana_alerting_rule_aborted",z)},A=z=>{(0,i.rR)("grafana_alerting_rule_form_error",z)},R=async z=>{const G={grafana_version:g.$.buildInfo.version,org_id:l.TP.user.orgId,user_id:l.TP.user.id};(0,i.rR)("grafana_alerting_insights",{...G,...z})};function S(z){(0,i.rR)("grafana_alerting_rules_search",{...z})}function O({oldQuery:z,newQuery:G}){try{const M=(0,d.XY)(z),Q=(0,d.XY)(G),Y=j(M);j(Q).filter(X=>!Y.includes(X)).forEach(X=>{S({filter:X,triggeredBy:"typing"})})}catch(M){M instanceof Error&&p(M)}}function j(z){return Object.entries(z).filter(([G,M])=>!(0,t.isEmpty)(M)).map(([G])=>G)}function B(z){S({filter:z,triggeredBy:"component"})}function N(z){(0,i.rR)("grafana_alerting_rules_list_mode",{...z})}function I(){(0,i.rR)("grafana_alerting_contact_point_form_edit_input_with_template")}function K(){(0,i.rR)("grafana_alerting_contact_point_form_use_custom_input_in_template")}function w(){(0,i.rR)("grafana_alerting_contact_point_form_use_single_template_in_input")}function U(z){(0,i.rR)("grafana_alerting_central_alert_state_history_filter_by_clicking",z)}function W(){(0,i.rR)("grafana_alerting_central_alert_state_history_expand_row")}function H(z){(0,i.rR)("grafana_alerting_central_alert_state_history_max_events_reached",z)}},79741:(_,L,e)=>{"use strict";e.r(L),e.d(L,{default:()=>v,defaultPageNav:()=>y});var t=e(74848),n=e(96540),r=e(54148),s=e(17172),a=e(42418),g=e(66602),i=e(7392),l=e(37959),d=e(5179),o=e(39890),u=e(730),c=e(78742),p=e(18461);const h=()=>{const P=(0,r.g)(),m=(0,p.uE)(P),[D]=(0,o.P5)(),E=D===o.gQ.Instances?void 0:0,C=(0,n.useMemo)(()=>{if(!m)throw new Error("Rule ID is required");return(0,p.qg)(m,!0)},[m]),{loading:b,error:T,result:A}=(0,u.ZU)({ruleIdentifier:C,limitAlerts:E});return T?(0,t.jsx)(l.d,{pageNav:y,navId:"alert-list",children:(0,t.jsx)(f,{error:T})}):b?(0,t.jsx)(l.d,{pageNav:y,navId:"alert-list",isLoading:!0,children:(0,t.jsx)(t.Fragment,{})}):A?(0,t.jsx)(d.K,{identifier:C,rule:A,children:(0,t.jsx)(o.Ay,{})}):(0,t.jsx)(l.d,{pageNav:y,navId:"alert-list",children:(0,t.jsx)(i.L,{entity:"Rule"})})},y={id:"alert-rule-view",text:""};function f({error:P}){return(0,s.NF)(P)&&P.status===404?(0,t.jsx)(i.L,{entity:"Rule"}):(0,t.jsx)(a.F,{title:"Something went wrong loading the rule",children:(0,c.JZ)(P)})}const v=(0,g.Xc)(h,{style:"page"})},79938:(_,L,e)=>{"use strict";e.d(L,{hK:()=>p});var t=e(2543),n=e.n(t),r=e(8484),s=e(57220),a=e(75214),g=e(23662),i=e(49962),l=e(49498),d=e(28220);const o="/api/v1/rule/test/grafana",u="api/prometheus/grafana/api/v1/rules";var c=(h=>(h.RuleGroup="rule_group",h.Namespace="file",h.FolderUID="folder_uid",h.LimitAlerts="limit_alerts",h))(c||{});const p=i.H.injectEndpoints({endpoints:h=>({preview:h.mutation({query:({alertQueries:y,condition:f,customLabels:v,folder:P,alertName:m,alertUid:D})=>({url:o,data:{rule:{grafana_alert:{data:y,condition:f,no_data_state:"Alerting",title:m,uid:D??"N/A"},for:"0s",labels:(0,a.x4)(v),annotations:{}},folderUid:P.uid,folderTitle:P.title},method:"POST"})}),prometheusRulesByNamespace:h.query({query:({limitAlerts:y,identifier:f,filter:v,state:P,matcher:m})=>{const D=new URLSearchParams;y&&D.set("limit_alerts",String(y)),f&&((0,g.Mj)(f)||(0,g.X4)(f))&&(D.set("file",f.namespace),D.set("rule_group",f.groupName));const E={...(0,l.ou)(v),...Object.fromEntries(D)};return{url:u,params:(0,l.Dj)(E,P,m)}},transformResponse:y=>(0,l.lH)(y.data.groups,s.hY)}),prometheusRuleNamespaces:h.query({query:({ruleSourceName:y,namespace:f,groupName:v,ruleName:P,dashboardUid:m,panelId:D,limitAlerts:x})=>{const E={rule_group:v,rule_name:P,dashboard_uid:m,panel_id:D?.toString()};return f&&((0,s.z2)(y)?(0,t.set)(E,"folder_uid",f):(0,t.set)(E,"file",f)),x!==void 0&&(0,t.set)(E,"limit_alerts",String(x)),{url:`api/prometheus/${(0,s.w5)(y)}/api/v1/rules`,params:E}},transformResponse:(y,f,v)=>(0,l.lH)(y.data.groups,v.ruleSourceName),providesTags:["CombinedAlertRule"]}),rulerRules:h.query({query:({rulerConfig:y,filter:f})=>{const{path:v,params:P}=(0,d.$o)(y).rules(f);return{url:v,params:P}},providesTags:["CombinedAlertRule"]}),rulerNamespace:h.query({query:({rulerConfig:y,namespace:f})=>{const{path:v,params:P}=(0,d.$o)(y).namespace(f);return{url:v,params:P}}}),getRuleGroupForNamespace:h.query({query:({rulerConfig:y,namespace:f,group:v,notificationOptions:P})=>{const{path:m,params:D}=(0,d.$o)(y).namespaceGroup(f,v);return{url:m,params:D,notificationOptions:P}},providesTags:(y,f,{namespace:v,group:P})=>[{type:"RuleGroup",id:`${v}/${P}`},{type:"RuleNamespace",id:v}]}),deleteRuleGroupFromNamespace:h.mutation({query:({rulerConfig:y,namespace:f,group:v,notificationOptions:P})=>{const m=(0,r.t)("alerting.rule-groups.delete.success","Successfully deleted rule group"),{path:D,params:x}=(0,d.$o)(y).namespaceGroup(f,v);return{url:D,params:x,method:"DELETE",notificationOptions:{successMessage:m,...P}}},invalidatesTags:(y,f,{namespace:v,group:P})=>[{type:"RuleGroup",id:`${v}/${P}`},{type:"RuleNamespace",id:v}]}),upsertRuleGroupForNamespace:h.mutation({query:({payload:y,namespace:f,rulerConfig:v,notificationOptions:P})=>{const{path:m,params:D}=(0,d.$o)(v).namespace(f),x=(0,r.t)("alerting.rule-groups.update.success","Successfully updated rule group");return{url:m,params:D,data:y,method:"POST",notificationOptions:{successMessage:x,...P}}},invalidatesTags:(y,f,{namespace:v,payload:P})=>[{type:"RuleNamespace",id:v},{type:"RuleGroup",id:`${v}/${P.name}`}]}),getAlertRule:h.query({query:({uid:y})=>({url:`/api/ruler/${s.hY}/api/v1/rule/${y}`}),providesTags:(y,f,{uid:v})=>[{type:"GrafanaRulerRule",id:v}]}),exportRules:h.query({query:({format:y,folderUid:f,group:v,ruleUid:P})=>({url:"/api/ruler/grafana/api/v1/export/rules",params:{format:y,folderUid:f,group:v,ruleUid:P},responseType:"text"}),keepUnusedDataFor:0}),exportReceiver:h.query({query:({receiverName:y,decrypt:f,format:v})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:v,decrypt:f,name:y},responseType:"text"}),keepUnusedDataFor:0}),exportReceivers:h.query({query:({decrypt:y,format:f})=>({url:"/api/v1/provisioning/contact-points/export/",params:{format:f,decrypt:y},responseType:"text"}),keepUnusedDataFor:0}),exportPolicies:h.query({query:({format:y})=>({url:"/api/v1/provisioning/policies/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportModifiedRuleGroup:h.mutation({query:({payload:y,format:f,nameSpaceUID:v})=>({url:`/api/ruler/grafana/api/v1/rules/${v}/export/`,params:{format:f},responseType:"text",data:y,method:"POST"})}),exportMuteTimings:h.query({query:({format:y})=>({url:"/api/v1/provisioning/mute-timings/export/",params:{format:y},responseType:"text"}),keepUnusedDataFor:0}),exportMuteTiming:h.query({query:({format:y,muteTiming:f})=>({url:`/api/v1/provisioning/mute-timings/${f}/export/`,params:{format:y},responseType:"text"}),keepUnusedDataFor:0})})})},91540:(_,L,e)=>{"use strict";e.d(L,{F:()=>s});var t=e(26272),n=e(28138),r=e(49962);const s=r.H.injectEndpoints({endpoints:a=>({getSilences:a.query({query:({datasourceUid:g,ruleMetadata:i,accessControl:l})=>({url:`/api/alertmanager/${g}/api/v2/silences`,params:{ruleMetadata:i,accesscontrol:l}}),providesTags:g=>g?[...g.map(({id:i})=>({type:"AlertmanagerSilences",id:i})),{type:"AlertmanagerSilences"}]:[{type:"AlertmanagerSilences"}]}),getSilence:a.query({query:({datasourceUid:g,id:i,ruleMetadata:l,accessControl:d})=>({url:`/api/alertmanager/${g}/api/v2/silence/${i}`,showErrorAlert:!1,params:{ruleMetadata:l,accesscontrol:d}}),providesTags:(g,i,{id:l})=>g?[{type:"AlertmanagerSilences",id:l}]:["AlertmanagerSilences"]}),createSilence:a.mutation({query:({datasourceUid:g,payload:i})=>({url:`/api/alertmanager/${g}/api/v2/silences`,method:"POST",data:i}),invalidatesTags:["AlertmanagerSilences","AlertmanagerAlerts"],onQueryStarted:async(g,{queryFulfilled:i})=>{try{await i,n.A.emit(t.r1.alertSuccess,["Silence created"])}catch{n.A.emit(t.r1.alertError,["Could not create silence"])}}}),expireSilence:a.mutation({query:({datasourceUid:g,silenceId:i})=>({url:`/api/alertmanager/${g}/api/v2/silence/${i}`,method:"DELETE"}),invalidatesTags:["AlertmanagerSilences"]})})})},49962:(_,L,e)=>{"use strict";e.d(L,{H:()=>u});var t=e(75816),n=e(10378),r=e(2543),s=e.n(r),a=e(75505),g=e(26272),i=e(17172),l=e(28138),d=e(25027);const o=()=>async({body:c,notificationOptions:p={},...h},y,f)=>{const{errorMessage:v,showErrorAlert:P,successMessage:m,showSuccessAlert:D}=p,{hideErrorMessage:x}=f||{};try{const E={...h,...c&&{data:c},...m&&{showSuccessAlert:!1},...(v||x)&&{showErrorAlert:!1}},C=performance.now(),{data:b,...T}=await(0,a.s)((0,i.AI)().fetch(E));return(0,d.l$)("backendSrvBaseQuery",{loadTimeMs:performance.now()-C},{url:h.url,method:h.method??"GET",responseStatus:T.statusText}),m&&D!==!1&&l.A.emit(g.r1.alertSuccess,[m]),{data:b,meta:T}}catch(E){return v&&P!==!1&&l.A.emit(g.r1.alertError,[v]),{error:E}}},u=(0,t.xP)({reducerPath:"alertingApi",baseQuery:o(),serializeQueryArgs:c=>(0,n.lE)((0,r.omit)(c,"queryArgs.notificationOptions")),tagTypes:["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","AlertmanagerAlerts","AlertmanagerSilences","OnCallIntegrations","DataSourceSettings","GrafanaLabels","CombinedAlertRule","GrafanaRulerRule","GrafanaSlo","RuleGroup","RuleNamespace","ContactPoint","ContactPointsStatus","Receiver"],endpoints:()=>({})})},32415:(_,L,e)=>{"use strict";e.d(L,{By:()=>o,VO:()=>d,WS:()=>a,f4:()=>l,nd:()=>i,vk:()=>g});var t=e(75505),n=e(39070),r=e(17172),s=e(57220);async function a(y){try{const f=await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}));return{template_files:f.data.template_files??{},template_file_provenances:f.data.template_file_provenances??{},alertmanager_config:f.data.alertmanager_config??{},last_applied:f.data.last_applied,id:f.data.id}}catch(f){if(y===s.hY&&(0,r.NF)(f)&&f.data?.message?.includes("could not find an Alertmanager configuration"))return{template_files:{},alertmanager_config:{}};throw f}}async function g(y,f){await(0,t.s)((0,r.AI)().fetch({method:"POST",url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,data:f,showErrorAlert:!1,showSuccessAlert:!1}))}async function i(y){await(0,t.s)((0,r.AI)().fetch({method:"DELETE",url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/alerts`,showErrorAlert:!1,showSuccessAlert:!1}))}async function l(y){return(await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/api/v2/alerts/groups`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function d(y){return(await(0,t.s)((0,r.AI)().fetch({url:`/api/alertmanager/${(0,s.w5)(y)}/api/v2/status`,showErrorAlert:!1,showSuccessAlert:!1}))).data}async function o(y,f,v){const P={receivers:f,alert:v};try{const m=await(0,t.s)((0,r.AI)().fetch({method:"POST",data:P,url:`/api/alertmanager/${(0,s.w5)(y)}/config/api/v1/receivers/test`,showErrorAlert:!1,showSuccessAlert:!1}));if(u(m.data))throw new Error(h(m.data))}catch(m){throw(0,r.NF)(m)&&c(m.data)&&u(m.data)?new Error(h(m.data)):m}}function u(y){return y.receivers.some(f=>f.grafana_managed_receiver_configs.some(v=>v.status==="failed"))}function c(y){return(0,n.Gv)(y)&&"receivers"in y&&Array.isArray(y.receivers)?y.receivers.every(p):!1}function p(y){return(0,n.Gv)(y)&&"name"in y&&typeof y.name=="string"&&"grafana_managed_receiver_configs"in y&&Array.isArray(y.grafana_managed_receiver_configs)}function h(y){return y.receivers.flatMap(f=>f.grafana_managed_receiver_configs.filter(v=>v.status==="failed").map(v=>v.error??"Unknown error.")).join("; ")}},82843:(_,L,e)=>{"use strict";e.d(L,{m:()=>f});var t=e(2543),n=e.n(t),r=e(32642),s=e(99140),a=e(25027),g=e(98164),i=e(57220),l=e(78742),d=e(88467),o=e(49962),u=e(32415),c=e(77583);const p=30,h=30*1e3,y=["AlertingConfiguration","AlertmanagerConfiguration","AlertmanagerConnectionStatus","ContactPoint","ContactPointsStatus","Receiver"],f=o.H.injectEndpoints({endpoints:v=>({getAlertmanagerAlerts:v.query({query:({amSourceName:P,filter:m,showErrorAlert:D=!0})=>{const x=m?.matchers?.filter(S=>S.name&&S.value).map(S=>(0,r.b2)((0,g.MU)(S))),{silenced:E,inhibited:C,unprocessed:b,active:T}=m||{},A=Object.fromEntries(Object.entries({silenced:E,active:T,inhibited:C,unprocessed:b}).filter(([S,O])=>O!==void 0)),R={filter:x};return A&&Object.keys(A).forEach(S=>{R[S]=A[S]}),{url:`/api/alertmanager/${(0,i.w5)(P)}/api/v2/alerts`,params:R,showErrorAlert:D}},providesTags:["AlertmanagerAlerts"]}),getAlertmanagerAlertGroups:v.query({query:({amSourceName:P})=>({url:`/api/alertmanager/${(0,i.w5)(P)}/api/v2/alerts/groups`})}),grafanaNotifiers:v.query({query:()=>({url:"/api/alert-notifiers"})}),getGrafanaAlertingConfiguration:v.query({query:()=>({url:"/api/v1/ngalert/admin_config",showErrorAlert:!1}),providesTags:["AlertingConfiguration"]}),getGrafanaAlertingConfigurationStatus:v.query({query:()=>({url:"/api/v1/ngalert"}),providesTags:["AlertingConfiguration"]}),getExternalAlertmanagers:v.query({query:()=>({url:"/api/v1/ngalert/alertmanagers"}),transformResponse:P=>P.data,providesTags:["AlertmanagerConnectionStatus"]}),updateGrafanaAlertingConfiguration:v.mutation({query:P=>({url:"/api/v1/ngalert/admin_config",method:"POST",data:P,showSuccessAlert:!1}),invalidatesTags:[...y]}),getAlertmanagerConfigurationHistory:v.query({query:()=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/history`,params:{limit:p}}),providesTags:["AlertmanagerConfiguration"]}),resetAlertmanagerConfigurationToOldVersion:v.mutation({query:P=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/history/${P.id}/_activate`,method:"POST"}),invalidatesTags:["AlertmanagerConfiguration"]}),getAlertmanagerConfiguration:v.query({queryFn:async P=>{const m=P===i.hY;if((0,i.AL)(P))return(0,d.$I)((0,u.VO)(P).then(A=>({data:{alertmanager_config:A.config,template_files:{}}})));const{data:x}=await(0,s.JD)(c.L.endpoints.discoverAmFeatures.initiate({amSourceName:P})),E={alertmanager_config:{},template_files:{},template_file_provenances:{}},C=x?.lazyConfigInit??!1,b=(0,a.QA)("unifiedalerting/fetchAmConfig",u.WS,{dataSourceName:P,thunk:"unifiedalerting/fetchAmConfig"}),T=(0,l.i9)(()=>b(P),A=>!!(0,d.CZ)(A)?.includes("alertmanager storage object not found")&&!C,h).then(A=>m?A:(0,t.isEmpty)(A.alertmanager_config)&&(0,t.isEmpty)(A.template_files)?(0,u.VO)(P).then(S=>({alertmanager_config:S.config,template_files:{},template_file_provenances:A.template_file_provenances,last_applied:A.last_applied,id:A.id})):A).then(A=>A??E).then(A=>({data:A})).catch(A=>{if(C&&(0,d.CZ)(A)?.includes("alertmanager storage object not found"))return{data:E};throw A});return(0,d.$I)(T).catch(A=>({error:A,data:void 0}))},providesTags:["AlertmanagerConfiguration"]}),updateAlertmanagerConfiguration:v.mutation({query:({selectedAlertmanager:P,config:m})=>({url:`/api/alertmanager/${(0,i.w5)(P)}/config/api/v1/alerts`,method:"POST",data:m,showSuccessAlert:!1}),invalidatesTags:["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"]}),getContactPointsStatus:v.query({query:()=>({url:`/api/alertmanager/${(0,i.w5)(i.hY)}/config/api/v1/receivers`}),transformResponse:P=>{const m=D=>D.startsWith("0001-01-01");return P.map(D=>({...D,integrations:D.integrations.map(x=>{const E=m(x.lastNotifyAttempt);return{...x,lastNotifyAttempt:E?"":x.lastNotifyAttempt,lastNotifyAttemptDuration:E?"":x.lastNotifyAttemptDuration}})}))},providesTags:["ContactPointsStatus"]}),getContactPointsList:v.query({query:()=>({url:"/api/v1/notifications/receivers"}),providesTags:["ContactPoint"]}),getMuteTimingList:v.query({query:()=>({url:"/api/v1/notifications/time-intervals"}),providesTags:["AlertmanagerConfiguration"]})})})},92240:(_,L,e)=>{"use strict";e.d(L,{O5:()=>u,_y:()=>o,nD:()=>l});var t=e(75505),n=e(17172),r=e(94822),s=e(55740),a=e(57220),g=e(49498),i=e(28220);async function l(v){if(v===a.hY)return{features:{rulerApiEnabled:!0}};const P=(0,a.oh)(v);if(!P)throw new Error(`Cannot find data source configuration for ${v}`);const{url:m,name:D,type:x}=P;if(!m)throw new Error("The data source url cannot be empty.");if(x!=="prometheus"&&x!=="loki")throw new Error(`The build info request is not available for ${x}. Only 'prometheus' and 'loki' are supported`);return d({name:D,url:m,type:x})}async function d(v){const{url:P,name:m,type:D}=v,x=D==="loki"?void 0:await p(P);if(!(x!==void 0)){if(!await h(m))throw new Error(`Unable to fetch alert rules. Is the ${m} data source properly configured?`);const T=await y(m);return{application:r.N1.Cortex,features:{rulerApiEnabled:T}}}const{features:C}=x.data;return C?{application:r.N1.Mimir,features:{rulerApiEnabled:C?.ruler_config_api==="true"}}:{application:r.N1.Prometheus,features:{rulerApiEnabled:!1}}}async function o(v){if(v===a.hY)return{lazyConfigInit:!1};const P=c(v),{url:m,type:D}=P;if(!m)throw new Error("The data source url cannot be empty.");if(D!=="alertmanager")throw new Error(`Alertmanager feature discovery is not available for ${D}. Only 'alertmanager' type is supported`);return await u(m)}async function u(v){try{return{lazyConfigInit:(await p(v))?.data?.application==="Grafana Mimir"}}catch{return{lazyConfigInit:!1}}}function c(v){const P=(0,a.oh)(v);if(!P)throw new Error(`Cannot find data source configuration for ${v}`);return P}async function p(v){return(await(0,t.s)((0,n.AI)().fetch({url:`${v}/api/v1/status/buildinfo`,showErrorAlert:!1,showSuccessAlert:!1})).catch(m=>{if(!("status"in m&&m.status===404))throw m}))?.data}async function h(v){try{return await(0,g.sA)(v),!0}catch{return!1}}async function y(v){try{return await(0,i.Zp)(v),!0}catch(P){if(f(P))return!1;throw P}}function f(v){return(0,n.NF)(v)?v.data.message?.includes("GetRuleGroup unsupported in rule local store")||v.data.message?.includes("page not found")||v.data.message?.includes(s.UU):v instanceof Error&&v.message?.includes("404 from rules config endpoint")}},77583:(_,L,e)=>{"use strict";e.d(L,{L:()=>i,b:()=>g});var t=e(94822),n=e(25027),r=e(57220),s=e(49962),a=e(92240);const g={dataSourceName:"grafana",apiVersion:"legacy"},i=s.H.injectEndpoints({endpoints:l=>({discoverAmFeatures:l.query({queryFn:async({amSourceName:d})=>{try{return{data:await(0,a._y)(d)}}catch(o){return{error:o}}}}),discoverDsFeatures:l.query({queryFn:async({rulesSourceName:d})=>{if((0,r.z2)(d))return{data:{rulerConfig:g}};const o=(0,r.Jz)(d);if(!o)return{error:new Error(`Missing data source configuration for ${d}`)};const c=await(0,n.QA)("unifiedalerting/featureDiscoveryApi/discoverDsFeatures",a.nD,{dataSourceName:d,endpoint:"unifiedalerting/featureDiscoveryApi/discoverDsFeatures"})(o.name);return{data:{rulerConfig:c.features.rulerApiEnabled?{dataSourceName:o.name,apiVersion:c.application===t.N1.Cortex?"legacy":"config"}:void 0}}}})})})},26423:(_,L,e)=>{"use strict";e.d(L,{Pc:()=>a,WG:()=>i,uz:()=>o});var t=e(17172),n=e(37534),r=e(99494),s=e(49962);const a="grafana_alerting_v2",g=u=>`/api/plugins/${r.W.OnCall}/resources${u}`,i=s.H.injectEndpoints({endpoints:u=>({grafanaOnCallIntegrations:u.query({query:()=>({url:g("/alert_receive_channels/"),params:{filters:!0,integration:[n.FI,"legacy_grafana_alerting"],skip_pagination:!0},showErrorAlert:!1}),transformResponse:c=>l(c)?c.results:c,providesTags:["OnCallIntegrations"]}),validateIntegrationName:u.query({query:c=>({url:g("/alert_receive_channels/validate_name/"),params:{verbal_name:c},showErrorAlert:!1})}),createIntegration:u.mutation({query:c=>({url:g("/alert_receive_channels/"),data:c,method:"POST",showErrorAlert:!0}),invalidatesTags:["OnCallIntegrations"]}),features:u.query({query:()=>({url:g("/features/"),showErrorAlert:!1})}),onCallConfigChecks:u.query({query:()=>({url:g("/organization/config-checks/"),showErrorAlert:!1})})})});function l(u){return"results"in u&&Array.isArray(u.results)}const{useGrafanaOnCallIntegrationsQuery:d}=i;function o(u){return(0,t.NF)(u)&&"detail"in u.data}},49498:(_,L,e)=>{"use strict";e.d(L,{Dj:()=>d,Kw:()=>u,lH:()=>o,ou:()=>l,sA:()=>p});var t=e(75505),n=e(17172),r=e(25027),s=e(94822),a=e(57220),g=e(23662);function i(h){const{dataSourceName:y,limitAlerts:f,identifier:v}=h;return{rules:(P,m,D)=>{const x=new URLSearchParams;y===a.hY&&f&&x.set("limit_alerts",String(f)),v&&((0,g.Mj)(v)||(0,g.X4)(v))&&(x.set("file",v.namespace),x.set("rule_group",v.groupName));const C={...l(P),...Object.fromEntries(x)};return{url:`/api/prometheus/${(0,a.w5)(y)}/api/v1/rules`,params:d(C,m,D)}}}}function l(h){const y={};return h?.dashboardUID&&(y.dashboard_uid=h.dashboardUID,h?.panelId&&(y.panel_id=String(h.panelId))),y}function d(h,y,f){let v={...h};if(y?.length&&(v={...v,state:y}),f?.length){const P=f.map(m=>JSON.stringify(m));v={...v,matcher:P}}return v}const o=(h,y)=>{const f={};return h.forEach(v=>{v.rules.forEach(P=>{P.query=P.query||"",P.type===s.JS.Alerting&&(P.state||((0,r.fH)("prom rule with type=alerting is missing a state",{dataSourceName:y,ruleName:P.name}),P.state=s.cF.Inactive))}),f[v.file]?f[v.file].groups.push(v):f[v.file]={dataSourceName:y,name:v.file,groups:[v]}}),Object.values(f)},u=(h=[])=>h?.flatMap(y=>y.groups.flatMap(f=>c(f,y.name)));function c(h,y){return{name:h.name,file:y,rules:h.rules,interval:h.interval}}async function p(h,y,f,v,P,m){if(y?.dashboardUID&&h!==a.hY)throw new Error("Filtering by dashboard UID is only supported for Grafana Managed rules.");const{url:D,params:x}=i({dataSourceName:h,limitAlerts:f,identifier:m}).rules(y,P,v),E=await(0,t.s)((0,n.AI)().fetch({url:D,params:x,showErrorAlert:!1,showSuccessAlert:!1})).catch(C=>{throw"status"in C&&C.status===404?new Error("404 from rule state endpoint. Perhaps ruler API is not enabled?"):C});return o(E.data.data.groups,h)}},28220:(_,L,e)=>{"use strict";e.d(L,{$o:()=>o,HO:()=>f,Zp:()=>y,iy:()=>p});var t=e(75505),n=e(39070),r=e(17172),s=e(52487),a=e(55740),g=e(57220),i=e(49498);const l="QUERY_NAMESPACE",d="QUERY_GROUP";function o(x){const E=c(x),C=u(x),b=x.apiVersion==="legacy"?"cortex":"mimir";return{rules:T=>({path:E,params:{subtype:b,...(0,i.ou)(T)}}),namespace:T=>{const{namespace:A,searchParams:R}=C.namespace(T);return{path:`${E}/${encodeURIComponent(A)}`,params:{subtype:b,...R}}},namespaceGroup:(T,A)=>{const{namespace:R,searchParams:S}=C.namespace(T),{group:O,searchParams:j}=C.group(A);return{path:`${E}/${encodeURIComponent(R)}/${encodeURIComponent(O)}`,params:{subtype:b,...S,...j}}}}}function u(x){const E=x.dataSourceName===g.hY,C=b=>(0,s.Cl)(b)===!0?{group:d,searchParams:{group:b}}:{group:b,searchParams:{}};return E?{namespace:b=>({namespace:b,searchParams:{}}),group:C}:{namespace:b=>(0,s.Cl)(b)===!0?{namespace:l,searchParams:{namespace:b}}:{namespace:b,searchParams:{}},group:C}}function c(x){return`${`/api/ruler/${(0,g.w5)(x.dataSourceName)}`}/api/v1/rules`}async function p(x,E){if(E?.dashboardUID&&x.dataSourceName!==g.hY)throw new Error("Filtering by dashboard UID is only supported by Grafana.");const{path:C,params:b}=o(x).rules(E);return v(C,{},b)}async function h(x,E){const{path:C,params:b}=o(x).namespace(E);return(await v(C,{},b))[E]||[]}async function y(x){return v(`/api/ruler/${(0,g.w5)(x)}/api/v1/rules/test/test`,null)}async function f(x,E,C){const{path:b,params:T}=o(x).namespaceGroup(E,C);return v(b,null,T)}async function v(x,E,C){try{return(await(0,t.s)((0,r.AI)().fetch({url:x,showErrorAlert:!1,showSuccessAlert:!1,params:C}))).data}catch(b){if(!P(b))throw b;if(D(b))return E;throw m(b)?{...b,data:{...b.data,message:a.UU}}:b}}function P(x){if(!(0,n.Gv)(x))return!1;const E="data"in x&&x.data!==null&&x.data!==void 0;return"status"in x&&Number.isFinite(x.status)&&E}function m(x){return x.status===404||x.status===500&&x.data.message?.includes("unexpected content type from upstream. expected YAML, got text/html")}function D(x){return x.status===404&&(x.data.message?.includes("group does not exist")||x.data.message?.includes("no rule groups found"))}},53270:(_,L,e)=>{"use strict";e.d(L,{E:()=>r,R:()=>n});var t=e(17172);function n(s){if(r(s))return null;throw s}function r(s){return(0,t.NF)(s)&&s.status===404}},69087:(_,L,e)=>{"use strict";e.d(L,{m:()=>h});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(55127),g=e.n(a),i=e(96540),l=e(40845),d=e(55852),o=e(69613),u=e(8484),c=e(75214),p=e(8406);const h=({labels:v,commonLabels:P={},size:m,onClick:D})=>{const x=(0,l.of)(f,m),[E,C]=(0,i.useState)(!1),b=(0,r.chain)(v).toPairs().reject(c.w0).reject(([S])=>E?!1:S in P).value(),T=Object.keys(P).length,A=T>0,R=(0,u.t)("alert-labels.button.show.tooltip","Show common labels");return(0,t.jsxs)("div",{className:x.wrapper,role:"list","aria-label":"Labels",children:[b.map(([S,O])=>(0,t.jsx)(p.J,{size:m,label:S,value:O,color:y(S),onClick:D},S+O)),!E&&A&&(0,t.jsxs)(d.$n,{variant:"secondary",fill:"text",onClick:()=>C(!0),tooltip:R,tooltipPlacement:"top",size:"sm",children:["+",T," common ",g()("label",T)]}),E&&A&&(0,t.jsx)(d.$n,{variant:"secondary",fill:"text",onClick:()=>C(!1),tooltipPlacement:"top",size:"sm",children:(0,t.jsx)(u.x6,{i18nKey:"alert-labels.button.hide",children:"Hide common labels"})})]})};function y(v){return(0,o.MC)(v).color}const f=(v,P)=>({wrapper:(0,n.css)({display:"flex",flexWrap:"wrap",alignItems:"center",gap:P==="md"?v.spacing():v.spacing(.5)})})},37959:(_,L,e)=>{"use strict";e.d(L,{d:()=>D,y:()=>x});var t=e(74848),n=e(87586),r=e(21780),s=e(70383),a=e(32196),g=e(96540),i=e(40845),l=e(14186),d=e(90182),o=e(12681),u=e(57220);function c(b){return b.name===u.hY?"Grafana":b.name}const p=({disabled:b=!1})=>{const T=(0,i.of)(h),{selectedAlertmanager:A,availableAlertManagers:R,setSelectedAlertmanager:S}=(0,s.VI)(),O=(0,g.useMemo)(()=>R.map(N=>({label:c(N),value:N.name,imgUrl:N.imgUrl,meta:N.meta})),[R]),j=b||O.length===1,B=j?"Alertmanager":"Choose Alertmanager";return(0,t.jsx)(l.I,{className:T.field,label:B,disabled:j,"data-testid":"alertmanager-picker",children:(0,t.jsx)(d.l6,{"aria-label":B,width:29,className:"ds-picker select-container",backspaceRemovesValue:!1,onChange:N=>{N?.value&&S(N.value)},options:O,noOptionsMessage:"No datasources found",value:A,getOptionLabel:N=>N.label,components:{Option:y}})})},h=b=>({field:(0,a.css)({margin:0})}),y=b=>(0,t.jsx)(o.o5,{...b,renderOptionLabel:({label:T})=>(0,t.jsx)("div",{style:{whiteSpace:"pre-line"},children:T})});var f=e(42418);const v=()=>(0,t.jsx)(f.F,{title:"No Alertmanager found",severity:"warning",children:"We could not find any external Alertmanagers and you may not have access to the built-in Grafana Alertmanager."}),P=()=>(0,t.jsx)(f.F,{title:"Selected Alertmanager not found.",severity:"warning",children:"The selected Alertmanager no longer exists or you may not have permission to access it. You can select a different Alertmanager from the dropdown."}),m=({availableAlertManagers:b})=>{const T=b.length>0;return(0,t.jsx)("div",{children:T?(0,t.jsx)(P,{}):(0,t.jsx)(v,{})})},D=({children:b,isLoading:T,...A})=>(0,t.jsx)(r.YW,{...A,children:(0,t.jsx)(r.YW.Contents,{isLoading:T,children:b})}),x=({children:b,accessType:T,...A})=>{const R=E();return(0,t.jsx)(s.b9,{accessType:T,children:(0,t.jsx)(D,{...A,actions:(0,t.jsx)(p,{disabled:R}),children:(0,t.jsx)(C,{children:b})})})};function E(){const b=(0,n.A)();return["/edit","/new"].some(A=>b?.pathname?.includes(A))}const C=({children:b})=>{const{availableAlertManagers:T,selectedAlertmanager:A}=(0,s.VI)();return A?(0,t.jsx)(t.Fragment,{children:b}):(0,t.jsx)(m,{availableAlertManagers:T})}},71223:(_,L,e)=>{"use strict";e.d(L,{s:()=>u});var t=e(74848),n=e(32196),r=e(56034),s=e(40845),a=e(72109),g=e(55740),i=e(84396),l=e(16577),d=e(73750);const o=["message","description"],u=({annotationKey:h,value:y,valueLink:f})=>{const v=h,P=g.J3[v]?(0,t.jsx)(r.m,{content:h,placement:"top",theme:"info",children:(0,t.jsx)("span",{children:g.J3[v]})}):h;return(0,t.jsx)(i.X,{label:P,horizontal:!0,children:(0,t.jsx)(c,{annotationKey:h,value:y,valueLink:f})})},c=({annotationKey:h,value:y,valueLink:f})=>{const v=(0,s.of)(p),P=o.includes(h),m=y&&y.startsWith("http"),D=(0,t.jsx)(l.Y,{input:y,delimiter:["{{","}}"]});return f?(0,t.jsx)(a.Y,{href:f,external:!0,children:y}):P?(0,t.jsx)(d.L,{className:v.well,children:D}):m?(0,t.jsx)(a.Y,{href:y,external:!0,children:y}):(0,t.jsx)(t.Fragment,{children:D})},p=h=>({well:(0,n.css)({wordBreak:"break-word"})})},84396:(_,L,e)=>{"use strict";e.d(L,{X:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({className:g,label:i,horizontal:l,children:d,childrenWrapperClassName:o})=>{const u=(0,r.of)(a);return(0,t.jsxs)("div",{className:(0,n.cx)(u.field,l?u.fieldHorizontal:u.fieldVertical,g),children:[(0,t.jsx)("div",{children:i}),(0,t.jsx)("div",{className:o,children:d})]})},a=g=>({fieldHorizontal:(0,n.css)({flexDirection:"row",[g.breakpoints.down("md")]:{flexDirection:"column"}}),fieldVertical:(0,n.css)({flexDirection:"column"}),field:(0,n.css)({display:"flex",margin:`${g.spacing(2)} 0`,"& > div:first-child":{width:"110px",paddingRight:g.spacing(1),fontSize:g.typography.size.sm,fontWeight:g.typography.fontWeightBold,lineHeight:1.8},"& > div:nth-child(2)":{flex:1,color:g.colors.text.secondary}})})},75591:(_,L,e)=>{"use strict";e.d(L,{E:()=>o});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(29158),i=e(19384),l=e(98439),d=e(22620);const o=({cols:c,items:p,isExpandable:h=!1,onCollapse:y,onExpand:f,isExpanded:v,renderExpandedContent:P,testIdGenerator:m,pagination:D,paginationStyles:x,renderPrefixCell:E,renderPrefixHeader:C,footerRow:b,dataTestId:T})=>{const A=(0,a.of)(d.H);if((y||f||v)&&!(y&&f&&v))throw new Error("either all of onCollapse, onExpand, isExpanded must be provided, or none");if((h||P)&&!(h&&P))throw new Error("either both isExpanded and renderExpandedContent must be provided, or neither");const R=(0,a.of)(u(c,h,!!C)),[S,O]=(0,r.useState)([]),j=U=>{v&&y&&f?v(U)?y(U):f(U):O(S.includes(U.id)?S.filter(W=>W!==U.id):[...S,U.id])},B=D?.itemsPerPage??p.length,{page:N,numberOfPages:I,onPageChange:K,pageItems:w}=(0,l.W)(p,1,B);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:R.container,"data-testid":T??"dynamic-table",children:[(0,t.jsxs)("div",{className:R.row,"data-testid":"header",children:[C&&C(),h&&(0,t.jsx)("div",{className:R.cell()}),c.map(U=>(0,t.jsx)("div",{className:R.cell(U.alignColumn),children:U.label},U.id))]}),w.map((U,W)=>{const H=v?v(U):S.includes(U.id);return(0,t.jsxs)("div",{className:R.row,"data-testid":m?.(U,W)??"row",children:[E&&E(U,W,p),h&&(0,t.jsx)("div",{className:(0,n.cx)(R.cell(),R.expandCell),children:(0,t.jsx)(g.K,{tooltip:`${H?"Collapse":"Expand"} row`,"data-testid":s.Tp.components.AlertRules.toggle,name:H?"angle-down":"angle-right",onClick:()=>j(U)})}),c.map(z=>(0,t.jsx)("div",{className:(0,n.cx)(R.cell(z.alignColumn),R.bodyCell,z.className),"data-column":z.label,children:z.renderCell(U,W)},`${U.id}-${z.id}`)),H&&P&&(0,t.jsx)("div",{className:R.expandedContentRow,"data-testid":s.Tp.components.AlertRules.expandedContent,children:P(U,W,p)})]},`${U.id}-${W}`)}),b&&(0,t.jsx)("div",{className:(0,n.cx)(R.row,R.footerRow),children:b})]}),D&&(0,t.jsx)(i.d,{className:(0,n.cx)(A,x),currentPage:N,numberOfPages:I,onNavigate:K,hideWhenSinglePage:!0})]})},u=(c,p,h)=>{const y=c.map(f=>f.size?typeof f.size=="number"?`${f.size}fr`:f.size:"auto");return p&&y.unshift("calc(1em + 16px)"),h&&y.unshift("0"),f=>({container:(0,n.css)({border:`1px solid ${f.colors.border.weak}`,borderRadius:f.shape.radius.default,color:f.colors.text.secondary}),row:(0,n.css)({display:"grid",gridTemplateColumns:y.join(" "),gridTemplateRows:"1fr auto","&:nth-child(2n + 1)":{backgroundColor:f.colors.background.secondary},"&:nth-child(2n)":{backgroundColor:f.colors.background.primary},[f.breakpoints.down("sm")]:{gridTemplateColumns:"auto 1fr",gridTemplateAreas:"left right",padding:`0 ${f.spacing(.5)}`,"&:first-child":{display:"none"},"& > *:first-child":{display:h?"none":void 0}}}),footerRow:(0,n.css)({display:"flex",padding:f.spacing(1)}),cell:v=>(0,n.css)({display:"flex",alignItems:"center",padding:f.spacing(1),justifyContent:v||"initial",[f.breakpoints.down("sm")]:{padding:`${f.spacing(1)} 0`,gridTemplateColumns:"1fr"}}),bodyCell:(0,n.css)({overflow:"hidden",[f.breakpoints.down("sm")]:{gridColumnEnd:"right",gridColumnStart:"right","&::before":{content:"attr(data-column)",display:"block",color:f.colors.text.primary}}}),expandCell:(0,n.css)({justifyContent:"center",[f.breakpoints.down("sm")]:{alignItems:"start",gridArea:"left"}}),expandedContentRow:(0,n.css)({gridColumnEnd:y.length+1,gridColumnStart:h?3:2,gridRow:2,padding:`0 ${f.spacing(3)} 0 ${f.spacing(1)}`,position:"relative",[f.breakpoints.down("sm")]:{gridColumnStart:2,borderTop:`1px solid ${f.colors.border.strong}`,gridRow:"auto",padding:`${f.spacing(1)} 0 0 0`}})})}},10562:(_,L,e)=>{"use strict";e.d(L,{B:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(75591);const a=({renderExpandedContent:i,...l})=>{const d=(0,r.of)(g);return(0,t.jsx)(s.E,{renderExpandedContent:i?(o,u,c)=>(0,t.jsxs)(t.Fragment,{children:[u!==c.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.contentGuideline,d.guideline)}),i(o,u,c)]}):void 0,renderPrefixHeader:()=>(0,t.jsx)("div",{className:d.relative,children:(0,t.jsx)("div",{className:(0,n.cx)(d.headerGuideline,d.guideline)})}),renderPrefixCell:(o,u,c)=>(0,t.jsxs)("div",{className:d.relative,children:[(0,t.jsx)("div",{className:(0,n.cx)(d.topGuideline,d.guideline)}),u!==c.length-1&&(0,t.jsx)("div",{className:(0,n.cx)(d.bottomGuideline,d.guideline)})]}),...l})},g=i=>({relative:(0,n.css)({position:"relative",height:"100%"}),guideline:(0,n.css)({left:"-19px",borderLeft:`1px solid ${i.colors.border.weak}`,position:"absolute",[i.breakpoints.down("md")]:{display:"none"}}),topGuideline:(0,n.css)({width:"18px",borderBottom:`1px solid ${i.colors.border.medium}`,top:0,bottom:"50%"}),bottomGuideline:(0,n.css)({top:"50%",bottom:0}),contentGuideline:(0,n.css)({top:0,bottom:0,left:"-49px !important"}),headerGuideline:(0,n.css)({top:"-17px",bottom:0})})},35108:(_,L,e)=>{"use strict";e.d(L,{B:()=>o});var t=e(74848),n=e(32196),r=e(46942),s=e.n(r),a=e(96540),g=e(40845),i=e(67061),l=e(95868),d=e(13840);const o=({children:c,header:p,content:h,footer:y,arrow:f,showAfter:v=300,wrapperClassName:P,disabled:m=!1,showOn:D="hover",...x})=>{const E=(0,a.useRef)(null),C=(0,g.of)(u);if(m)return c;const b=D==="hover",T=D==="click",A=(0,t.jsxs)(i.B,{direction:"column",gap:0,role:"tooltip",children:[p&&(0,t.jsx)("div",{className:C.card.header,children:p}),(0,t.jsx)("div",{className:C.card.body,children:h}),y&&(0,t.jsx)("div",{className:C.card.footer,children:y})]});return(0,t.jsx)(l.I,{content:A,hideAfter:100,children:(R,S,O)=>{const j={onClick:R},B={onMouseLeave:S,onMouseEnter:R},N={onBlur:S,onFocus:R};return(0,t.jsxs)(t.Fragment,{children:[E.current&&(0,t.jsx)(d.A,{...O,...x,wrapperClassName:s()(C.popover,P),referenceElement:E.current,renderArrow:f,...N,...b?B:{}}),(0,a.cloneElement)(c,{ref:E,onFocus:R,onBlur:S,tabIndex:0,...b?B:{},...T?j:{}})]})}})},u=c=>({popover:(0,n.css)({borderRadius:c.shape.radius.default,boxShadow:c.shadows.z3,background:c.colors.background.primary,border:`1px solid ${c.colors.border.weak}`}),card:{body:(0,n.css)({padding:c.spacing(1)}),header:(0,n.css)({padding:c.spacing(1),background:c.colors.background.secondary,borderBottom:`solid 1px ${c.colors.border.medium}`}),footer:(0,n.css)({padding:c.spacing(.5,1),background:c.colors.background.secondary,borderTop:`solid 1px ${c.colors.border.medium}`})}})},93810:(_,L,e)=>{"use strict";e.d(L,{A:()=>s});var t=e(74848),n=e(42418);const s=()=>(0,t.jsx)(n.F,{severity:"info",title:"Alert evaluation currently paused",children:"Notifications for this rule will not fire and no alert instances will be created until the rule is un-paused."})},8406:(_,L,e)=>{"use strict";e.d(L,{J:()=>l});var t=e(74848),n=e(32196),r=e(96540),s=e(84140),a=e(40845),g=e(67061),i=e(14578);const l=({label:o,value:u,icon:c,color:p,size:h="md",onClick:y})=>{const f=(0,a.of)(d,p,h),v=`${o}: ${u}`,P=o?.toString()??"",m=u?.toString()??"",D=(0,r.useMemo)(()=>(0,t.jsxs)(g.B,{direction:"row",gap:0,alignItems:"stretch",children:[(0,t.jsx)("div",{className:f.label,children:(0,t.jsxs)(g.B,{direction:"row",gap:.5,alignItems:"center",children:[c&&(0,t.jsx)(i.I,{name:c}),o&&(0,t.jsx)("span",{className:f.labelText,title:o.toString(),children:o??""})]})}),(0,t.jsx)("div",{className:f.value,title:u?.toString(),children:u??"-"})]}),[c,o,u,f]);return(0,t.jsx)("div",{className:f.wrapper,role:"listitem","aria-label":v,"data-testid":"label-value",children:y?(0,t.jsx)("div",{className:f.clickable,role:"button",tabIndex:0,onClick:()=>y(P,m),onKeyDown:x=>{x.key==="Enter"&&(y(P,m),x.preventDefault())},children:D},P+m):D})},d=(o,u,c)=>{const p=u??o.colors.secondary.main,h=o.isDark?(0,s.A)(p).lighten(5).toString():(0,s.A)(p).darken(5).toString(),y=o.isDark?(0,s.A)(p).darken(5).toString():(0,s.A)(p).lighten(5).toString(),f=u?s.A.mostReadable(p,["#000","#fff"]).toString():o.colors.text.primary;let v=o.spacing(.33,1);switch(c){case"sm":v=o.spacing(.2,.6);break;case"xs":v=o.spacing(0,.5);break;default:break}return{wrapper:(0,n.css)({color:f,fontSize:o.typography.bodySmall.fontSize,borderRadius:o.shape.borderRadius(2)}),labelText:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"}),label:(0,n.css)({display:"flex",alignItems:"center",color:"inherit",padding:v,background:p,border:`solid 1px ${h}`,borderTopLeftRadius:o.shape.borderRadius(2),borderBottomLeftRadius:o.shape.borderRadius(2)}),clickable:(0,n.css)({"&:hover":{opacity:.8,cursor:"pointer"}}),value:(0,n.css)({color:"inherit",padding:v,background:y,border:`solid 1px ${h}`,borderLeft:"none",borderTopRightRadius:o.shape.borderRadius(2),borderBottomRightRadius:o.shape.borderRadius(2),whiteSpace:"pre",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"300px"})}}},55196:(_,L,e)=>{"use strict";e.d(L,{P:()=>i});var t=e(74848),n=e(32196),r=e(40845),s=e(94753),a=e(67061),g=e(14578);const i=({children:d,icon:o,color:u="secondary",direction:c="row",...p})=>{const h=(0,r.of)(l),y=typeof p.onClick=="function",f=c==="row",v=f?"center":"flex-start",P=f?.5:0;return(0,t.jsx)("div",{className:(0,n.cx)({[h.interactive]:y}),...p,children:(0,t.jsx)(s.E,{variant:"bodySmall",color:u,children:(0,t.jsxs)(a.B,{direction:c,alignItems:v,gap:P,wrap:"wrap",children:[o&&(0,t.jsx)(g.I,{size:"xs",name:o}),d]})})})},l=()=>({interactive:(0,n.css)({cursor:"pointer"})})},90141:(_,L,e)=>{"use strict";e.d(L,{A:()=>i});var t=e(74848),n=e(96540),r=e(55852),s=e(67061),a=e(14578);const i=(0,n.forwardRef)(function(d,o){return(0,t.jsx)(r.$n,{variant:"secondary",size:"sm",type:"button","aria-label":"More",ref:o,...d,children:(0,t.jsxs)(s.B,{direction:"row",alignItems:"center",gap:0,children:["More ",(0,t.jsx)(a.I,{name:"angle-down"})]})})})},76156:(_,L,e)=>{"use strict";e.d(L,{h:()=>s});var t=e(74848),n=e(12210);const r=({children:a,plugin:g,loadingComponent:i,notInstalledFallback:l})=>{const{loading:d,installed:o}=usePluginBridge(g);return d?i??null:o?jsx(Fragment,{children:a}):l??null};function s(a,g,i){const l=new URLSearchParams(i).toString();return`/a/${a}${g}`+(l?"?"+l:"")}},48205:(_,L,e)=>{"use strict";e.d(L,{Yi:()=>i,hk:()=>g,rS:()=>l});var t=e(74848),n=e(42418),r=e(39938),s=e(56034),a=e(8484),g=(d=>(d.ContactPoint="contact point",d.Template="template",d.MuteTiming="mute timing",d.AlertRule="alert rule",d.RootNotificationPolicy="root notification policy",d))(g||{});const i=({resource:d,...o})=>(0,t.jsxs)(n.F,{title:`This ${d} cannot be edited through the UI`,severity:"info",...o,children:["This ",d," has been provisioned, that means it was created by config. Please contact your server admin to update this ",d,"."]}),l=({tooltip:d,provenance:o})=>{const u=(0,t.jsx)(r.E,{text:"Provisioned",color:"purple"});if(d){const c=(0,t.jsxs)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-provenance",values:{provenance:o},children:["This resource has been provisioned via ",{provenance:o}," and cannot be edited through the UI"]}),p=(0,t.jsx)(a.x6,{i18nKey:"alerting.provisioning.badge-tooltip-standard",children:"This resource has been provisioned and cannot be edited through the UI"}),h=o?c:p;return(0,t.jsx)(s.m,{content:h,children:(0,t.jsx)("span",{children:u})})}return u}},82437:(_,L,e)=>{"use strict";e.d(L,{c:()=>s});var t=e(74848),n=e(94753),r=e(14578);const s=({namespace:a,group:g})=>g?(0,t.jsxs)(n.E,{element:"h3",variant:"body",children:[a," ",(0,t.jsx)(r.I,{name:"angle-right","aria-label":">"})," ",g]}):(0,t.jsx)(n.E,{element:"h3",variant:"body",children:a})},26058:(_,L,e)=>{"use strict";e.d(L,{h:()=>r});var t=e(74848),n=e(32196);const r=()=>(0,t.jsx)("span",{className:(0,n.css)({flex:1})})},65415:(_,L,e)=>{"use strict";e.d(L,{O:()=>a});var t=e(74848),n=e(32196),r=e(96540),s=e(40845);const a=(0,r.forwardRef)(({children:i,state:l,size:d="md",muted:o=!1},u)=>{const c=(0,s.of)(g);return(0,t.jsx)("span",{className:(0,n.cx)(c.common,c[l],c[d],{[c.muted]:o}),ref:u,children:i||l})});a.displayName="StateTag";const g=i=>({common:(0,n.css)({display:"inline-block",color:"white",borderRadius:i.shape.radius.default,fontSize:i.typography.size.sm,textTransform:"capitalize",lineHeight:"1.2",textAlign:"center",fontWeight:i.typography.fontWeightBold}),good:(0,n.css)({backgroundColor:i.colors.success.main,border:`solid 1px ${i.colors.success.main}`,color:i.colors.success.contrastText}),warning:(0,n.css)({backgroundColor:i.colors.warning.main,border:`solid 1px ${i.colors.warning.main}`,color:i.colors.warning.contrastText}),bad:(0,n.css)({backgroundColor:i.colors.error.main,border:`solid 1px ${i.colors.error.main}`,color:i.colors.error.contrastText}),neutral:(0,n.css)({backgroundColor:i.colors.secondary.main,border:`solid 1px ${i.colors.secondary.main}`,color:i.colors.secondary.contrastText}),info:(0,n.css)({backgroundColor:i.colors.primary.main,border:`solid 1px ${i.colors.primary.main}`,color:i.colors.primary.contrastText}),md:(0,n.css)({padding:i.spacing(.5,1),minWidth:i.spacing(8)}),sm:(0,n.css)({padding:i.spacing(.3,.5),minWidth:"52px"}),muted:(0,n.css)({opacity:"0.5"})})},16577:(_,L,e)=>{"use strict";e.d(L,{Y:()=>l});var t=e(74848),n=e(32196),r=e(40845),s=e(39938),a=e(35108),g=e(83225);const i=["$",".",'"'];function l({input:f,delimiter:v=["{{","}}"]}){const P=(0,r.of)(y),[m,D]=v,x=new RegExp(`(?<before>.*?)(${m}(?<token>.*?)${D}|$)`,"gm"),E=f.split(`
`),C=[];return E.forEach((b,T)=>{Array.from(b.matchAll(x)).forEach((R,S)=>{const O=R.groups?.before,j=R.groups?.token?.trim();if(O&&C.push((0,t.jsx)("span",{children:O},`${T}-${S}-before`)),j){const B=h(j),N=B==="variable"?j:"",I=`${m} ${j} ${D}`;C.push((0,t.jsx)(o,{content:I,type:B,description:N},`${T}-${S}-token`))}}),C.push((0,t.jsx)("br",{},`${T}-newline`))}),(0,t.jsx)("span",{className:P.wrapper,children:C})}var d=(f=>(f.Variable="variable",f.Function="function",f.Keyword="keyword",f.Unknown="unknown",f))(d||{});function o({content:f,description:v,type:P}){const m=(0,r.of)(y),D=!P;return(0,t.jsx)(a.B,{placement:"top-start",disabled:D,content:(0,t.jsxs)("div",{className:m.hoverTokenItem,children:[(0,t.jsx)(s.E,{tabIndex:0,text:(0,t.jsx)(t.Fragment,{children:P}),color:"blue"})," ",v&&(0,t.jsx)("code",{children:v})]}),children:(0,t.jsx)("span",{children:(0,t.jsx)(s.E,{tabIndex:0,className:m.token,text:f,color:"blue"})})})}function u(f){return i.some(v=>f.startsWith(v))}function c(f){return g.keywords.some(v=>f.startsWith(v))}function p(f){return g.builtinFunctions.some(v=>f.startsWith(v))}function h(f){let v;return u(f)?v="variable":c(f)?v="keyword":p(f)?v="function":v="unknown",v}const y=f=>({wrapper:(0,n.css)({whiteSpace:"pre-wrap"}),token:(0,n.css)({cursor:"default",fontFamily:f.typography.fontFamilyMonospace}),popover:(0,n.css)({borderRadius:f.shape.radius.default,boxShadow:f.shadows.z3,background:f.colors.background.primary,border:`1px solid ${f.colors.border.medium}`,padding:f.spacing(1)}),hoverTokenItem:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"center",gap:f.spacing(1)})})},73750:(_,L,e)=>{"use strict";e.d(L,{L:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,className:i})=>{const l=(0,r.of)(a);return(0,t.jsx)("div",{className:(0,n.cx)(l.wrapper,i),children:g})},a=g=>({wrapper:(0,n.css)({backgroundColor:g.components.panel.background,border:`solid 1px ${g.components.input.borderColor}`,borderRadius:g.shape.radius.default,padding:g.spacing(.5,1),fontFamily:g.typography.fontFamilyMonospace})})},96636:(_,L,e)=>{"use strict";e.d(L,{d:()=>r});var t=e(96540),n=e(14778);const r=({component:s,title:a="previous page"})=>{const g=(0,n.i)(),i=(0,t.useCallback)(()=>{g(a)},[g,a]);return(0,t.cloneElement)(s,{onClick:i})}},53876:(_,L,e)=>{"use strict";e.d(L,{X:()=>h});var t=e(74848),n=e(32196),r=e(96540),s=e(40996),a=e(40845),g=e(14578),i=e(88575),l=e(60029),d=e(67061),o=e(56034),u=e(10354),c=e(25027),p=e(32642);const h=({onFilterChange:f,defaultQueryString:v})=>{const P=(0,a.of)(y),[m,D]=(0,r.useState)(v??"");(0,s.A)(()=>{(0,c.fH)(c.le.filterByLabel),f(m)},600,[m]);const x=(0,t.jsx)(g.I,{name:"search"});let E=!!(v&&v.length>=3);try{v?(0,p.S6)(v):E=!0}catch{E=!1}return(0,t.jsx)(i.D,{className:P.fixMargin,invalid:!E,error:E?null:"Query must use valid matcher syntax. See the examples in the help tooltip.",label:(0,t.jsx)(l.J,{children:(0,t.jsxs)(d.B,{gap:.5,alignItems:"center",children:[(0,t.jsx)("span",{children:"Search by label"}),(0,t.jsx)(o.m,{content:(0,t.jsxs)("div",{children:["Filter alerts using label querying without spaces, ex:",(0,t.jsx)("pre",{children:'{severity="critical", instance=~"cluster-us-.+"}'}),"Invalid use of spaces:",(0,t.jsx)("pre",{children:'{severity= "critical"}'}),(0,t.jsx)("pre",{children:'{severity ="critical"}'}),"Valid use of spaces:",(0,t.jsx)("pre",{children:'{severity=" critical"}'}),"Filter alerts using label querying without braces, ex:",(0,t.jsx)("pre",{children:'severity="critical", instance=~"cluster-us-.+"'})]}),children:(0,t.jsx)(g.I,{name:"info-circle",size:"sm"})})]})}),children:(0,t.jsx)(u.p,{placeholder:"Search",value:m,onChange:C=>D(C.currentTarget.value),"data-testid":"search-query-input",prefix:x,className:P.inputWidth})})},y=f=>({fixMargin:(0,n.css)({marginBottom:0}),inputWidth:(0,n.css)({width:340,flexGrow:0})})},99085:(_,L,e)=>{"use strict";e.d(L,{t:()=>r,w:()=>s});var t=e(31678);const n=[t.AccessControlAction.AlertingReceiversRead],r=[t.AccessControlAction.AlertingReceiversCreate,t.AccessControlAction.AlertingReceiversWrite],s=[...n,...r]},56528:(_,L,e)=>{"use strict";e.d(L,{GX:()=>N,r4:()=>j});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(49785),i=e(39070),l=e(19845),d=e(72724),o=e(40845),u=e(42418),c=e(67061),p=e(55852),h=e(51440),y=e(29158),f=e(98808),v=e(71680),P=e(1712),m=e(34263),D=e(18225),x=e(76658),E=e(66718),C=e(94822),b=e(98439),T=e(35108),A=e(26058),R=e(30423),S=e(81875),O=e(99106);const j=({queries:z=[],query:G,data:M,error:Q,warning:Y,isAlertCondition:q,onSetCondition:te,onUpdateRefId:X,onRemoveExpression:ee,onUpdateExpressionType:ne,onChangeQuery:Z})=>{const ae=(0,o.of)(H),re=G?.type,{setError:se,clearErrors:de}=(0,g.xW)(),le=(0,a.useCallback)(De=>{De?se("queries",{type:"custom",message:De}):de("queries")},[se,de]),he=M&&Object.values(M).some(De=>!!De&&De.state===i.Gu.Loading),ie=Array.isArray(M?.series)&&!he,J=M?.series??[],ce=q??!1,{seriesCount:pe,groupedByState:Pe}=K(J),Ie=(0,a.useCallback)(De=>{const Ke=z.filter(Me=>De.refId!==Me.refId).map(Me=>({value:Me.refId,label:Me.refId}));switch(De.type){case E.Tz.math:return(0,t.jsx)(v.z,{onChange:Z,query:De,labelWidth:"auto",onRunQuery:()=>{}});case E.Tz.reduce:return(0,t.jsx)(P.Z,{onChange:Z,refIds:Ke,labelWidth:"auto",query:De});case E.Tz.resample:return(0,t.jsx)(m.C,{onChange:Z,query:De,labelWidth:"auto",refIds:Ke});case E.Tz.classic:return(0,t.jsx)(f.z,{onChange:Z,query:De,refIds:Ke});case E.Tz.threshold:return(0,t.jsx)(x.O,{onChange:Z,query:De,labelWidth:"auto",refIds:Ke,onError:le,useHysteresis:!0});case E.Tz.sql:return(0,t.jsx)(D.k,{onChange:Z,query:De,refIds:Ke});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",De.type]})}},[Z,z,le]),Se=E.uQ.find(De=>De.value===re)?.description??"";return(0,t.jsx)("div",{className:(0,n.cx)(ae.expression.wrapper,ce&&ae.expression.alertCondition,re===E.Tz.classic&&ae.expression.classic,re!==E.Tz.classic&&ae.expression.nonClassic),children:(0,t.jsxs)("div",{className:ae.expression.stack,children:[(0,t.jsx)(w,{refId:G.refId,queryType:re,onRemoveExpression:()=>ee(G.refId),onUpdateRefId:De=>X(G.refId,De),onSetCondition:te,query:G,alertCondition:ce}),(0,t.jsxs)("div",{className:ae.expression.body,children:[Q&&(0,t.jsx)(u.F,{title:"Expression failed",severity:"error",children:Q.message}),Y&&(0,t.jsx)(u.F,{title:"Expression warning",severity:"warning",children:Y.message}),(0,t.jsx)("div",{className:ae.expression.description,children:Se}),Ie(G)]}),ie&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N,{series:J,isAlertCondition:q}),(0,t.jsx)("div",{className:ae.footer,children:(0,t.jsxs)(c.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)(A.h,{}),(0,t.jsx)(I,{isCondition:!!q,firing:Pe[C.cF.Firing].length,normal:Pe[C.cF.Inactive].length,seriesCount:pe})]})})]})]})})},B=20,N=({series:z,isAlertCondition:G})=>{const{pageItems:M,previousPage:Q,nextPage:Y,numberOfPages:q,pageStart:te,pageEnd:X}=(0,b.W)(z,1,B),ee=(0,o.of)(H),ne=(0,O.PI)(z),Z=!ne&&(0,l.jq)(z),ae=q>1;return(0,t.jsxs)("div",{className:ee.expression.results,children:[!ne&&Z&&(0,t.jsx)("div",{children:M.map((re,se)=>(0,t.jsx)(W,{frame:re,index:te+se,isAlertCondition:G},(0,r.uniqueId)()))}),!ne&&!Z&&M.map((re,se)=>(0,t.jsx)(U,{frame:re,index:te+se,isAlertCondition:G},(0,r.uniqueId)())),ne&&(0,t.jsx)("div",{className:(0,n.cx)(ee.expression.noData,ee.mutedText),children:"No data"}),ae&&(0,t.jsx)("div",{className:ee.pagination.wrapper,"data-testid":"paginate-expression",children:(0,t.jsxs)(c.B,{children:[(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:Q,icon:"angle-left",size:"sm","aria-label":"previous-page"}),(0,t.jsx)(A.h,{}),(0,t.jsxs)("span",{className:ee.mutedText,children:[te," - ",X," of ",z.length]}),(0,t.jsx)(A.h,{}),(0,t.jsx)(p.$n,{variant:"secondary",fill:"outline",onClick:Y,icon:"angle-right",size:"sm","aria-label":"next-page"})]})})]})},I=({firing:z,normal:G,isCondition:M,seriesCount:Q})=>{const{mutedText:Y}=(0,o.of)(H);return Q===0?(0,t.jsx)("span",{className:Y,children:"No series"}):M?(0,t.jsx)("span",{className:Y,children:`${Q} series: ${z} firing, ${G} normal`}):(0,t.jsx)("span",{className:Y,children:`${Q} series`})};function K(z){const G=z.filter(Y=>(0,O.Lm)(Y)===void 0).length,M={[C.cF.Firing]:z.filter(Y=>(0,O.Lm)(Y)!==void 0&&(0,O.Lm)(Y)!==0),[C.cF.Inactive]:z.filter(Y=>(0,O.Lm)(Y)===0)},Q=z.length-G;return{groupedByState:M,seriesCount:Q}}const w=({refId:z,queryType:G,onUpdateRefId:M,onRemoveExpression:Q,onSetCondition:Y,alertCondition:q,query:te})=>{const X=(0,o.of)(H),ee=(0,o.of)(p.my),[ne,Z]=(0,a.useState)(!1),re=ne!==!1&&ne==="refId";return(0,t.jsx)("header",{className:X.header.wrapper,children:(0,t.jsxs)(c.B,{direction:"row",gap:.5,alignItems:"center",children:[(0,t.jsxs)(c.B,{direction:"row",gap:1,alignItems:"center",children:[!re&&(0,t.jsx)("button",{type:"button",className:(0,n.cx)(ee,X.editable),onClick:()=>Z("refId"),children:(0,t.jsx)("div",{className:X.expression.refId,children:z})}),re&&(0,t.jsx)(h.D,{autoFocus:!0,defaultValue:z,minWidth:5,onFocus:se=>se.target.select(),onBlur:se=>{M(se.currentTarget.value),Z(!1)}}),(0,t.jsx)("div",{children:(0,E.NI)(G)})]}),(0,t.jsx)(A.h,{}),(0,t.jsx)(S.a,{onSetCondition:()=>Y(te.refId),isCondition:q}),(0,t.jsx)(y.K,{name:"trash-alt",variant:"secondary",className:X.mutedIcon,onClick:Q,tooltip:"Remove expression"})]})})},U=({frame:z,index:G,isAlertCondition:M})=>{const Q=(0,o.of)(H),Y=(0,O.Jw)(z)||"Series "+G,q=(0,O.Lm)(z),te=(0,O.JQ)(z),X=Object.entries(te),ee=X.length>0,ne=M&&q!==0,Z=M&&q===0,ae=`${ee?"":Y}${ee?`{${(0,O.h6)(te)}}`:""}`;return(0,t.jsx)("div",{className:Q.expression.resultsRow,children:(0,t.jsxs)(c.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsxs)("div",{className:Q.expression.resultLabel,title:ae,children:[(0,t.jsx)("span",{children:ee?"":Y}),ee&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{children:"{"}),X.map(([re,se],de)=>(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:Q.expression.labelKey,children:re}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:Q.expression.labelValue,children:se}),(0,t.jsx)("span",{children:'"'}),de<X.length-1&&(0,t.jsx)("span",{children:", "})]},(0,r.uniqueId)())),(0,t.jsx)("span",{children:"}"})]})]}),(0,t.jsx)("div",{className:Q.expression.resultValue,children:q}),ne&&(0,t.jsx)(R.C,{state:C.cF.Firing,size:"sm"}),Z&&(0,t.jsx)(R.C,{state:C.cF.Inactive,size:"sm"})]})})},W=({frame:z,index:G})=>{const M=(0,o.of)(H),Q=z.fields[1],Y=Q.labels,te=Q.config?.displayNameFromDS??(Y?(0,O.h6)(Q.labels??{}):"Series "+G),X=z.fields[0].values,ee=Z=>z.fields[0].values[Z],ne=Z=>z.fields[1].values[Z];return(0,t.jsx)("div",{className:M.expression.resultsRow,children:(0,t.jsxs)(c.B,{direction:"row",alignItems:"center",children:[(0,t.jsx)("span",{className:(0,n.cx)(M.mutedText,M.expression.resultLabel),title:te,children:te}),(0,t.jsx)("div",{className:M.expression.resultValue,children:(0,t.jsx)(T.B,{placement:"right",wrapperClassName:M.timeseriesTableWrapper,content:(0,t.jsxs)("table",{className:M.timeseriesTable,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Timestamp"}),(0,t.jsx)("th",{children:"Value"})]})}),(0,t.jsx)("tbody",{children:X.map((Z,ae)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:M.mutedText,children:(0,d.LE)(ee(ae))}),(0,t.jsx)("td",{className:M.expression.resultValue,children:ne(ae)})]},ae))})]}),children:(0,t.jsx)("span",{children:"Time series data"})})})]})})},H=z=>({expression:{wrapper:(0,n.css)({display:"flex",border:`solid 1px ${z.colors.border.medium}`,flex:1,flexBasis:"400px",borderRadius:z.shape.radius.default}),stack:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",gap:0,width:"100%",minWidth:"0"}),classic:(0,n.css)({maxWidth:"100%"}),nonClassic:(0,n.css)({maxWidth:"640px"}),alertCondition:(0,n.css)({}),body:(0,n.css)({padding:z.spacing(1),flex:1}),description:(0,n.css)({marginBottom:z.spacing(1),fontSize:z.typography.size.xs,color:z.colors.text.secondary}),refId:(0,n.css)({fontWeight:z.typography.fontWeightBold,color:z.colors.primary.text}),results:(0,n.css)({display:"flex",flexDirection:"column",flexWrap:"nowrap",borderTop:`solid 1px ${z.colors.border.medium}`}),noResults:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center"}),resultsRow:(0,n.css)({padding:`${z.spacing(.75)} ${z.spacing(1)}`,"&:nth-child(odd)":{backgroundColor:z.colors.background.secondary},"&:hover":{backgroundColor:z.colors.background.canvas}}),labelKey:(0,n.css)({color:z.isDark?"#73bf69":"#56a64b"}),labelValue:(0,n.css)({color:z.isDark?"#ce9178":"#a31515"}),resultValue:(0,n.css)({textAlign:"right"}),resultLabel:(0,n.css)({flex:1,overflowX:"auto",display:"inline-block",whiteSpace:"nowrap"}),noData:(0,n.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:z.spacing()})},mutedText:(0,n.css)({color:z.colors.text.secondary,fontSize:"0.9em",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}),header:{wrapper:(0,n.css)({background:z.colors.background.secondary,padding:`${z.spacing(.5)} ${z.spacing(1)}`,borderBottom:`solid 1px ${z.colors.border.weak}`})},footer:(0,n.css)({background:z.colors.background.secondary,padding:z.spacing(1),borderTop:`solid 1px ${z.colors.border.weak}`}),draggableIcon:(0,n.css)({cursor:"grab"}),mutedIcon:(0,n.css)({color:z.colors.text.secondary}),editable:(0,n.css)({padding:`${z.spacing(.5)} ${z.spacing(1)}`,border:`solid 1px ${z.colors.border.weak}`,borderRadius:z.shape.radius.default,display:"flex",flexDirection:"row",alignItems:"center",gap:z.spacing(1),cursor:"pointer"}),timeseriesTableWrapper:(0,n.css)({maxHeight:"500px",overflowY:"scroll"}),timeseriesTable:(0,n.css)({tableLayout:"auto",width:"100%",height:"100%","td, th":{padding:z.spacing(1)},td:{background:z.colors.background.primary},th:{background:z.colors.background.secondary},tr:{borderBottom:`1px solid ${z.colors.border.medium}`,"&:last-of-type":{borderBottom:"none"}}}),pagination:{wrapper:(0,n.css)({borderTop:`1px solid ${z.colors.border.medium}`,padding:z.spacing()})}})},81875:(_,L,e)=>{"use strict";e.d(L,{a:()=>l});var t=e(74848),n=e(32196),r=e(49785),s=e(40845),a=e(39938),g=e(55852),i=e(23662);const l=({isCondition:o,onSetCondition:u})=>{const c=(0,s.of)(d),{watch:p}=(0,r.xW)(),h=p("type"),y=h?(0,i.pq)(h):!1,f=y?"Recording rule output":"Alert condition",v=y?"Set as recording rule output":"Set as alert condition";return o?(0,t.jsx)(a.E,{color:"green",icon:"check",text:f},"condition"):(0,t.jsx)("button",{type:"button",className:c.actionLink,onClick:()=>u&&u(),children:v},"make-condition")},d=o=>{const u=(0,g.my)(o);return{actionLink:(0,n.css)(u,{color:o.colors.text.link,cursor:"pointer","&:hover":{textDecoration:"underline"}})}}},99106:(_,L,e)=>{"use strict";e.d(L,{EL:()=>d,JQ:()=>i,Jw:()=>a,Lm:()=>g,PI:()=>u,h6:()=>l,wf:()=>o});var t=e(2543),n=e.n(t),r=e(97706),s=e(57220);const a=c=>{const p=c.fields[0];return p?.config?.displayNameFromDS??c.name??p?.labels?.__name__},g=c=>{const p=c.fields[0]?.values[0];return Number.isFinite(p)?(0,r.h)(p,5):p},i=c=>c.fields[0]?.labels??{},l=c=>Object.entries(c).map(([p,h])=>p+"="+h).join(", "),d=c=>{const p=c.name;if((0,s.Eb)(c.rulesSource))return{name:p,parents:[]};try{const h=JSON.parse(p);if(!Array.isArray(h))throw new Error("not a nested Grafana folder");const y=(0,t.last)(h)??p,f=(0,t.dropRight)(h,1);return{name:y,parents:f}}catch{return{name:c.name,parents:[]}}},o=(c,p=[])=>JSON.stringify(p.concat(c)),u=c=>c.every(h=>h.fields.every(y=>y.values.every(f=>f==null)))},83225:(_,L,e)=>{"use strict";e.r(L),e.d(L,{AlertmanagerTemplateFunction:()=>n,availableAlertManagerFunctions:()=>r,builtinFunctions:()=>a,conf:()=>l,keywords:()=>g,language:()=>i});var t=(d=>(d.Delimiter="delimiter",d.Keyword="keyword",d.Function="type.identifier",d.String="string",d.Variable="variable.name",d.Number="number",d.Comment="comment",d.Operator="operator",d.Identifier="idenfifier",d))(t||{}),n=(d=>(d.toUpper="toUpper",d.toLower="toLower",d.title="title",d.join="join",d.match="match",d.safeHtml="safeHtml",d.reReplaceAll="reReplaceAll",d.stringSlice="stringSlice",d))(n||{});const r=Object.values(n),a=["and","call","html","index","slice","js","len","not","or","print","printf","println","urlquery",...["eq","ne","lt","le","gt","ge"]],g=["define","if","else","end","range","break","continue","template","block","with"],i={defaultToken:"",keywords:g,functions:[...a,...r],operators:["|"],tokenizer:{root:[[/"/,"string","@string"],[/`/,"string","@rawstring"],[/\d*\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d*\.\d+([eE][\-+]?\d+)?/,"number.float"],[/0[xX][0-9a-fA-F']*[0-9a-fA-F]/,"number.hex"],[/0[0-7']*[0-7]/,"number.octal"],[/0[bB][0-1']*[0-1]/,"number.binary"],[/\d[\d']*/,"number"],[/\d/,"number"],[/[;,.]/,"delimiter"],[/{{-?/,"delimiter"],[/-?}}/,"delimiter"],[/\.([A-Za-z]+)?/,"variable.name"],[/[a-zA-Z_]\w*/,{cases:{"@keywords":{token:"keyword"},"@functions":{token:"type.identifier"},"@default":"idenfifier"}}],[/\/\*.*\*\//,"comment"]],string:[[/[^\\"]+/,"string"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],rawstring:[[/[^\`]/,"string"],[/`/,"string","@pop"]]}},l={comments:{blockComment:["/*","*/"]},brackets:[["{{","}}"],["(",")"]],autoClosingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{{",close:"}}"},{open:"(",close:")"},{open:"`",close:"`"},{open:'"',close:'"'},{open:"'",close:"'"}]}},37534:(_,L,e)=>{"use strict";e.d(L,{FI:()=>t,J4:()=>n});const t="grafana_alerting";var n=(a=>(a.OnCall="oncall",a))(n||{});const r=(a,g)=>g.includes(a),s=(a,g)=>{if(!a.grafana_managed_receiver_configs)return!1;const i=a.grafana_managed_receiver_configs.length===1,l=r(a.grafana_managed_receiver_configs[0]?.settings?.url??"",g.map(d=>d.integration_url));return i&&l}},74685:(_,L,e)=>{"use strict";e.d(L,{j:()=>o});var t=e(74848),n=e(32196),r=e(70713),s=e(19845),a=e(40845),g=e(28138),i=e(72519),l=e(56528),d=e(52487);const o=({data:c,thresholds:p,thresholdsType:h})=>{const y=(0,a.of)(u),f=(0,s.jq)(c.series),v=(0,d.yW)(c),P=h?{mode:h}:void 0;return(0,t.jsx)("div",{className:y.wrapper,children:(0,t.jsx)(r.Ay,{disableHeight:!0,children:({width:m})=>(0,t.jsx)("div",{style:{width:m},children:f?(0,t.jsx)(i.y,{statusMessage:v,data:c.series,eventBus:g.A,height:300,width:m,timeRange:c.timeRange,timeZone:"browser",onChangeTime:()=>{},splitOpenFn:()=>{},loadingState:c.state,thresholdsConfig:p,thresholdsStyle:P}):(0,t.jsxs)("div",{className:y.instantVectorResultWrapper,children:[(0,t.jsx)("header",{className:y.title,children:"Table"}),(0,t.jsx)(l.GX,{series:c.series})]})})})})},u=c=>({wrapper:(0,n.css)({width:"100%",position:"relative"}),instantVectorResultWrapper:(0,n.css)({border:`solid 1px ${c.colors.border.medium}`,borderRadius:c.shape.radius.default,padding:0,display:"flex",flexDirection:"column",flexWrap:"nowrap"}),title:(0,n.css)({label:"panel-title",padding:c.spacing(),textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",fontSize:c.typography.h6.fontSize,fontWeight:c.typography.h6.fontWeight})})},36795:(_,L,e)=>{"use strict";e.d(L,{qQ:()=>d,vL:()=>g});var t=e(2543),n=e.n(t),r=e(41811),s=e(34525),a=e(69437);const g=(0,r.A)(i,(p,h)=>c(p[0])===c(h[0]));function i(p){const h=new s.TS,y=p.map(f=>f.refId);return h.createNodes(y),p.forEach(f=>{const v=f.refId;((0,a.f)(f.model)&&f.model.type==="math"?l(f.model.expression??""):[f.model.expression]).forEach(D=>{v&&D&&!(v===D)&&h.link(D,v)})}),h}function l(p){const h=new RegExp(/\$\{(?<var>[a-zA-Z0-9_ ]+?)\}/gm),y=new RegExp(/\$(?<var>[a-zA-Z0-9_]+)/gm),f=Array.from(p.matchAll(h)).map(P=>P.groups?.var),v=Array.from(p.matchAll(y)).map(P=>P.groups?.var);return(0,t.compact)((0,t.uniq)([...f,...v]))}const d=(0,t.memoize)(o,(p,h)=>p+u(h));function o(p,h){const y=h.getNode(p),f=[];function v(P){const m=P.inputEdges;m.length>0?m.forEach(D=>{D.inputNode&&v(D.inputNode)}):f?.push(P)}return v(y),f.map(P=>P.name)}function u(p){return Object.keys(p.nodes).map(h=>{const y=p.nodes[h],f=y.outputEdges.map(P=>P.outputNode?.name).join(", "),v=y.inputEdges.map(P=>P.inputNode?.name).join(", ");return`${y.name}:${f}:${v}`}).join(" ")}function c(p){return p.map(h=>{const y=(0,a.f)(h.model)?h.model.type:h.queryType;return h.refId+(h.model.expression??"")+y}).join()}},52487:(_,L,e)=>{"use strict";e.d(L,{Cl:()=>f,I3:()=>p,YG:()=>b,_u:()=>C,an:()=>D,lb:()=>P,xb:()=>y,yW:()=>E,yr:()=>m,zy:()=>v});var t=e(2543),n=e.n(t),r=e(19845),s=e(50082),a=e(39070),g=e(52622),i=e(2913),l=e(55907),d=e(69437),o=e(66718),u=e(86590),c=e(36795);function p(T,A,R){return T.map(S=>{if(A===R||!(0,d.f)(S.model))return S;const O=S.model.type==="math",j=S.model.type==="reduce",B=S.model.type==="resample",N=S.model.type==="classic_conditions",I=S.model.type==="threshold";if(O)return{...S,model:{...S.model,expression:h(S.model.expression??"",A,R)}};if(B||j||I){const K=S.model.expression===A;return{...S,model:{...S.model,expression:K?R:S.model.expression}}}if(N){const K=S.model.conditions?.map(w=>({...w,query:{...w.query,params:w.query.params.map(U=>U===A?R:U)}}));return{...S,model:{...S.model,conditions:K}}}return S})}function h(T,A,R){const S=new RegExp("(\\$"+A+"\\b)|(\\${"+A+"})","gm"),O="${"+R+"}";return T.replace(S,O)}function y(T,A){return T.find(R=>R.refId===A)!==void 0}function f(T){return T.includes("/")||T.includes("\\")}function v(T){if(T.series.length===0)return;const A=(0,r.jq)(T.series);let R;return A&&(R=new Error("You cannot use time series data as an alert condition, consider adding a reduce expression.")),R}function P(T){if(T.errors?.length)return new Error(T.errors[0].message)}function m(T){const R=(T[0]?.meta?.notices??[]).find(S=>S.severity==="warning")?.text;return R?new Error(R):void 0}function D(T,A){const R={},S=[o.Tz.threshold,o.Tz.classic];if(!A)return R;for(const B of T){if(!(0,d.f)(B.model)||!S.includes(B.model.type)||!Array.isArray(B.model.conditions)||B.model.refId!==A)continue;const N=B.model.conditions.some(x);B.model.conditions.forEach(I=>{const K=I.evaluator.params,w=I.query?.params[0]??B.model.expression;if(!w)return;const U=x(I);try{const W=(0,c.vL)(T),H=(0,c.qQ)(w,W);T.filter(G=>H.includes(G.refId)).forEach(G=>{const M=G.refId,Y=!!(!(0,d.f)(G?.model)&&M);M&&!R[M]&&(R[M]={config:{mode:s.O.Absolute,steps:[]},mode:g.Ly.Line}),M&&Y&&!U&&!N?O(M,K[0]):M&&Y&&U&&(j(M,K,I.evaluator.type),R[M].mode=g.Ly.LineAndArea)})}catch(W){console.error("Failed to parse thresholds",W);return}})}function O(B,N){R[B].config.steps.push({value:-1/0,color:"transparent"},{value:N,color:i.$W.theme2.colors.error.main})}function j(B,N,I){I===l.p.IsWithinRange&&R[B].config.steps.push({value:-1/0,color:"transparent"},{value:N[0],color:i.$W.theme2.colors.error.main},{value:N[1],color:i.$W.theme2.colors.error.main},{value:N[1],color:"transparent"}),I===l.p.IsOutsideRange&&R[B].config.steps.push({value:-1/0,color:i.$W.theme2.colors.error.main},{value:N[0],color:i.$W.theme2.colors.error.main},{value:N[0],color:"transparent"},{value:N[1],color:i.$W.theme2.colors.error.main}),R[B].config.steps.sort((K,w)=>K.value-w.value),R[B].config.steps=R[B].config.steps.filter(K=>K.value!==void 0)}return R}function x(T){return T.evaluator.type===l.p.IsWithinRange||T.evaluator.type===l.p.IsOutsideRange}function E(T){const A="Failed to fetch data";if(T.state!==a.Gu.Error)return;const R=T.errors;return R?.length?R.map(S=>S.message??A).join(", "):T.error?.message??A}function C(T=""){return T==="recording"?u.Z.cloudRecording:T==="grafana-recording"?u.Z.grafanaRecording:u.Z.grafana}function b(T,A){const R=A.filter(B=>!(0,d.f)(B.model)).map(B=>B.refId),S=T.filter(B=>!(0,d.f)(B.model)).map(B=>B.refId),[O,j]=(0,t.xor)(S,R);return[O,j]}},13064:(_,L,e)=>{"use strict";e.d(L,{C:()=>i});var t=e(87836),n=e(72880),r=e(70416),s=e(47232),a=e(72724),g=e(25968);function i(d,o){if(!d||!o||!(0,r.vd)(d))return;let u;try{u=(0,g.M9)(o)}catch{return}if((0,g.mo)(d))return;const c=Date.parse(d||""),p=(0,t.A)(c,u);return(0,n.Y)(p,new Date)?{humanized:`within ${o}`,fullDate:`within ${o}`}:{humanized:`in ${(0,s.KQ)(p).locale("en").fromNow(!0)}`,fullDate:(0,a.LE)(p,{format:"YYYY-MM-DD HH:mm:ss"})}}function l(d){if(!d)return null;if(!isNullDate(d))return formatDistanceToNowStrict(new Date(d))}},5179:(_,L,e)=>{"use strict";e.d(L,{K:()=>s,k:()=>a});var t=e(74848),n=e(96540);const r=n.createContext(void 0),s=({children:g,rule:i,identifier:l})=>{const d={rule:i,identifier:l};return(0,t.jsx)(r.Provider,{value:d,children:g})},a=()=>{const g=n.useContext(r);if(g===void 0)throw new Error("useAlertRule must be used within a AlertRuleContext");return g}},39890:(_,L,e)=>{"use strict";e.d(L,{gQ:()=>qt,Ay:()=>bn,lf:()=>Zn,P5:()=>kn});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(49185),g=e(67061),i=e(42418),l=e(40980),d=e(72109),o=e(94753),u=e(40845),c=e(55852),p=e(57514),h=e(76412),y=e(83277),f=e(93810),v=e(35896),P=e(21460),m=e(94822),D=e(79741),x=e(24608),E=e(99935),C=e(55776),b=e(85244),T=e(55740),A=e(78742),R=e(23662),S=e(3704),O=e(69087),j=e(37959),B=e(48205),N=e(96636),I=e(99106),K=e(51921);function w(){return(0,t.jsx)(i.F,{severity:"info",title:"This rule is part of a federated rule group.",bottomSpacing:0,topSpacing:2,children:(0,t.jsxs)(g.B,{direction:"column",children:["Federated rule groups are currently an experimental feature.",(0,t.jsx)(c.$n,{fill:"text",icon:"book",children:(0,t.jsx)("a",{href:"https://grafana.com/docs/metrics-enterprise/latest/tenant-management/tenant-federation/#cross-tenant-alerting-and-recording-rule-federation",children:"Read documentation"})})]})})}var U=e(14578);function W(){return(0,t.jsx)(o.E,{variant:"bodySmall",color:"warning",children:(0,t.jsxs)(g.B,{direction:"row",alignItems:"center",gap:.25,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(U.I,{name:"pause",size:"xs"})," Paused"]})})}var H=e(5179);const z=({color:Pt,includeState:Ft})=>{const Xt=(0,u.of)(G,{color:Pt,includeState:Ft});return(0,t.jsx)(g.B,{direction:"row",gap:.5,children:(0,t.jsx)("div",{className:Xt.dot})})},G=(Pt,Ft)=>{const Xt=Pt.spacing(1.25),sn=`calc(${Xt} / 2.5)`,on=Ft.color==="error",xn=Ft.color==="success",Un=Ft.color==="warning";return{dot:(0,n.css)({width:Xt,height:Xt,borderRadius:"100%",backgroundColor:Pt.colors.secondary.main,outline:`solid ${sn} ${Pt.colors.secondary.transparent}`,margin:sn},xn&&(0,n.css)({backgroundColor:Pt.colors.success.main,outlineColor:Pt.colors.success.transparent}),Un&&(0,n.css)({backgroundColor:Pt.colors.warning.main,outlineColor:Pt.colors.warning.transparent}),on&&(0,n.css)({backgroundColor:Pt.colors.error.main,outlineColor:Pt.colors.error.transparent}))}},M=({health:Pt})=>{const Ft=Zn(Pt),Xt=Ft?"error":"success",sn=Ft?"Recording error":"Recording";return(0,t.jsx)(Y,{color:Xt,text:sn})},Q=({state:Pt,health:Ft})=>{let Xt,sn;switch(Pt){case m.cF.Inactive:sn="success",Xt="Normal";break;case m.cF.Firing:sn="error",Xt="Firing";break;case m.cF.Pending:sn="warning",Xt="Pending";break}return Zn(Ft)&&(sn="error",Xt="Error"),Ft==="nodata"&&(sn="warning",Xt="No data"),(0,t.jsx)(Y,{color:sn,text:Xt})};function Y({color:Pt,text:Ft}){return(0,t.jsxs)(g.B,{direction:"row",gap:.5,wrap:"nowrap",flex:"0 0 auto",children:[(0,t.jsx)(z,{color:Pt}),(0,t.jsx)(o.E,{variant:"bodySmall",color:Pt,children:Ft})]})}var q=e(50509),te=e(32264),X=e(46013);const ee=(0,s.lazy)(()=>e.e(7409).then(e.bind(e,9790))),ne=(0,s.lazy)(()=>Promise.all([e.e(8895),e.e(285)]).then(e.bind(e,285))),Z=({rule:Pt})=>{const Ft=te.$.unifiedAlerting.alertStateHistoryBackend,Xt=te.$.unifiedAlerting.alertStateHistoryPrimary,on=[Ft,Xt].some(hn=>hn===X.Q.Loki)?X.Q.Loki:X.Q.Annotations,xn=Pt.grafana_alert.id??"",Un=Pt.grafana_alert.uid;return(0,t.jsxs)(s.Suspense,{fallback:"Loading...",children:[on===X.Q.Loki&&(0,t.jsx)(ne,{ruleUID:Un}),on===X.Q.Annotations&&(0,t.jsx)(ee,{alertId:xn})]})};var ae=e(15054),re=e(99938);const se=({rule:Pt})=>(0,t.jsx)(re.s,{rule:Pt,pagination:{itemsPerPage:ae.FG},enableFiltering:!0});var de=e(24120),le=e(39070),he=e(76885),ie=e(65879),J=e(11807),ce=e(66602),pe=e(39938),Pe=e(69437),Ie=e(66718),ge=e(55907),Se=e(26058),De=e(56528),Ke=e(52487),Me=e(74685);function be({data:Pt,thresholds:Ft}){return Pt?(0,t.jsx)(Me.j,{data:Pt,thresholds:Ft?.config,thresholdsType:Ft?.mode}):null}var we=e(20382),Be=e(57220),He=e(63066),Ve=e(85828);const Je=({expression:Pt})=>(0,t.jsx)(Ve.m,{options:{readOnly:!0,minimap:{enabled:!1},scrollBeyondLastColumn:0,scrollBeyondLastLine:!1,lineNumbers:"off",cursorWidth:0,overviewRulerLanes:0},defaultLanguage:"sql",height:80,defaultValue:Pt,width:"100%"});function nt(Pt){return"rawSql"in Pt}const pt=null,bt=s.lazy(()=>e.e(8468).then(e.bind(e,58468))),Tt=s.lazy(()=>e.e(7011).then(e.bind(e,67011)));function ye({model:Pt,dataSource:Ft}){return Ft.type===Be.ol.Prometheus&&(0,He.Bu)(Pt)?(0,t.jsx)(bt,{query:Pt.expr}):Ft.type===Be.ol.Loki&&(0,He.Bu)(Pt)?(0,t.jsx)(Tt,{query:Pt.expr??""}):nt(Pt)?(0,t.jsx)(Je,{expression:Pt.rawSql}):(0,t.jsx)("pre",{children:(0,t.jsx)("code",{children:(0,we.Bh)(Pt)})})}var je=e(19073);function ue({rule:Pt,queries:Ft,condition:Xt,evalDataByQuery:sn={}}){const on=(0,r.keyBy)(Object.values(te.$.datasources),kt=>kt.uid),xn=Ft.filter(kt=>!(0,Pe.f)(kt.model)),Un=Ft.filter(kt=>(0,Pe.f)(kt.model)),hn=(0,u.of)(et),St=(0,Ke.an)(Ft,Xt);return(0,t.jsxs)(g.B,{gap:1,direction:"column",flex:"1 1 320px",children:[(0,t.jsx)("div",{className:hn.maxWidthContainer,children:(0,t.jsx)(g.B,{gap:1,wrap:"wrap","data-testid":"queries-container",children:xn.map(({model:kt,relativeTimeRange:en,refId:tn,datasourceUid:gn},Nn)=>{const Ct=on[gn];return(0,t.jsx)(Ee,{rule:Pt,refId:tn,model:kt,relativeTimeRange:en,dataSource:Ct,thresholds:St[tn],queryData:sn[tn]},Nn)})})}),(0,t.jsx)("div",{className:hn.maxWidthContainer,children:(0,t.jsx)(g.B,{gap:1,wrap:"wrap","data-testid":"expressions-container",children:Un.map(({model:kt,refId:en,datasourceUid:tn},gn)=>(0,Pe.f)(kt)&&(0,t.jsx)(Ue,{refId:en,isAlertCondition:Xt===en,model:kt,evalData:sn[en]},gn))})})]})}function Ee({refId:Pt,rule:Ft,thresholds:Xt,model:sn,dataSource:on,queryData:xn,relativeTimeRange:Un}){const hn=(0,u.of)(Fe),St=(0,Pe.f)(sn),[kt,en]=(0,je.mh)(Ft,je.j5.Explore),tn=kt&&en,gn=[];if(on){const Ct=on.name??"[[Data source not found]]",Rt=on.meta.info.logos.small;gn.push((0,t.jsx)(Ne,{name:Ct,imgUrl:Rt},"datasource"))}Un&&gn.push((0,t.jsxs)(o.E,{color:"secondary",children:[(0,ie.secondsToHms)(Un.from)," to now"]},"timerange"));let Nn;return!St&&tn&&(Nn=on&&Ce(on,sn)),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(fe,{refId:Pt,headerItems:gn,exploreLink:Nn,children:(0,t.jsx)("div",{className:hn.queryPreviewWrapper,children:(0,t.jsx)(ce.Xw,{children:sn&&on&&(0,t.jsx)(ye,{model:sn,dataSource:on})})})}),on&&(0,t.jsx)(be,{data:xn,thresholds:Xt})]})}function Ce(Pt,Ft){const{uid:Xt,type:sn}=Pt,{refId:on,...xn}=Ft;return he.kM.renderUrl(`${te.$.appSubUrl}/explore`,{left:JSON.stringify({datasource:Pt.uid,queries:[{refId:"A",...xn,datasource:{type:sn,uid:Xt}}],range:{from:"now-1h",to:"now"}})})}function Ne({name:Pt,imgUrl:Ft}){const Xt=(0,u.of)(Fe);return(0,t.jsxs)("div",{className:Xt.dataSource,children:[(0,t.jsx)("img",{src:Ft,width:16,alt:Pt}),Pt]},"datasource")}const Fe=Pt=>({queryPreviewWrapper:(0,n.css)({margin:Pt.spacing(1)}),contentBox:(0,n.css)({flex:"1 0 100%"}),visualization:(0,n.css)({padding:Pt.spacing(1)}),dataSource:(0,n.css)({border:`1px solid ${Pt.colors.border.weak}`,borderRadius:Pt.shape.radius.default,padding:Pt.spacing(.5,1),display:"flex",alignItems:"center",gap:Pt.spacing(1)})});function Ue({refId:Pt,model:Ft,evalData:Xt,isAlertCondition:sn}){function on(){switch(Ft.type){case Ie.Tz.math:return(0,t.jsx)(it,{model:Ft});case Ie.Tz.reduce:return(0,t.jsx)(st,{model:Ft});case Ie.Tz.resample:return(0,t.jsx)(ot,{model:Ft});case Ie.Tz.classic:return(0,t.jsx)(Ge,{model:Ft});case Ie.Tz.threshold:return(0,t.jsx)(_e,{model:Ft});case Ie.Tz.sql:return(0,t.jsx)(J.l,{rawSql:Ft.expression||"",datasourceType:Ft.datasource?.type});default:return(0,t.jsxs)(t.Fragment,{children:["Expression not supported: ",Ft.type]})}}return(0,t.jsxs)(fe,{refId:Pt,headerItems:[(0,t.jsx)(o.E,{color:"secondary",children:(0,r.startCase)(Ft.type)},"expression-type")],isAlertCondition:sn,children:[on(),(0,t.jsx)(Se.h,{}),Xt&&(0,t.jsx)(De.GX,{series:Xt.series,isAlertCondition:sn})]})}function fe({refId:Pt,headerItems:Ft=[],children:Xt,isAlertCondition:sn,exploreLink:on}){const xn=(0,u.of)(Te);return(0,t.jsxs)("div",{className:(0,n.cx)(xn.container),children:[(0,t.jsxs)("header",{className:xn.header,children:[(0,t.jsx)("span",{className:xn.refId,children:Pt}),Ft,(0,t.jsx)(Se.h,{}),sn&&(0,t.jsx)(pe.E,{color:"green",icon:"check",text:"Alert condition"}),on&&(0,t.jsx)(N.d,{component:(0,t.jsx)(c.z9,{size:"md",variant:"secondary",icon:"compass",href:on,children:"View in Explore"})})]}),Xt]})}const Te=Pt=>({container:(0,n.css)({flex:"1 0 25%",border:`1px solid ${Pt.colors.border.weak}`,maxWidth:"100%",borderRadius:Pt.shape.radius.default,display:"flex",flexDirection:"column"}),header:(0,n.css)({display:"flex",alignItems:"center",gap:Pt.spacing(1),padding:Pt.spacing(1),backgroundColor:Pt.colors.background.secondary}),textBlock:(0,n.css)({border:`1px solid ${Pt.colors.border.weak}`,padding:Pt.spacing(.5,1),backgroundColor:Pt.colors.background.primary,borderRadius:Pt.shape.radius.default}),refId:(0,n.css)({color:Pt.colors.text.link,padding:Pt.spacing(.5,1),border:`1px solid ${Pt.colors.border.weak}`,borderRadius:Pt.shape.radius.default})});function Ge({model:Pt}){const Ft=(0,u.of)(Qe),Xt=(0,r.keyBy)(ge.A.reducerTypes,xn=>xn.value),sn=(0,r.keyBy)(ge.A.evalOperators,xn=>xn.value),on=(0,r.keyBy)(ge.A.evalFunctions,xn=>xn.value);return(0,t.jsx)("div",{className:Ft.container,children:Pt.conditions?.map(({query:xn,operator:Un,reducer:hn,evaluator:St},kt)=>{const en=ze(St);return(0,t.jsxs)(s.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:kt===0?"WHEN":!!Un?.type&&sn[Un?.type]?.text}),(0,t.jsx)("div",{className:Ft.bold,children:hn?.type&&Xt[hn.type]?.text}),(0,t.jsx)("div",{className:Ft.blue,children:"OF"}),(0,t.jsx)("div",{className:Ft.bold,children:xn.params[0]}),(0,t.jsx)("div",{className:Ft.blue,children:on[St.type].text}),(0,t.jsx)("div",{className:Ft.bold,children:en?`(${St.params[0]}; ${St.params[1]})`:St.params[0]})]},kt)})})}const Qe=Pt=>({container:(0,n.css)({padding:Pt.spacing(1),display:"grid",gridTemplateColumns:"repeat(6, max-content)",gap:Pt.spacing(0,1)}),...dt(Pt)});function st({model:Pt}){const Ft=(0,u.of)(Xe),{reducer:Xt,expression:sn,settings:on}=Pt,xn=Ie.Cu.find(St=>St.value===Xt),Un=on?.mode??Ie.Mt.Strict,hn=Ie.HZ.find(St=>St.value===Un);return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Function"}),(0,t.jsx)("div",{className:Ft.value,children:xn?.label}),(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:sn}),(0,t.jsx)("div",{className:Ft.label,children:"Mode"}),(0,t.jsx)("div",{className:Ft.value,children:hn?.label})]})}const Xe=Pt=>({container:(0,n.css)({padding:Pt.spacing(1),display:"grid",gap:Pt.spacing(.5),gridTemplateRows:"1fr 1fr",gridTemplateColumns:"repeat(4, 1fr)","> :nth-child(6)":{gridColumn:"span 3"}}),...dt(Pt)});function ot({model:Pt}){const Ft=(0,u.of)(ft),{expression:Xt,window:sn,downsampler:on,upsampler:xn}=Pt,Un=Ie.PN.find(St=>St.value===on),hn=Ie.iX.find(St=>St.value===xn);return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Xt}),(0,t.jsx)("div",{className:Ft.label,children:"Resample to"}),(0,t.jsx)("div",{className:Ft.value,children:sn}),(0,t.jsx)("div",{className:Ft.label,children:"Downsample"}),(0,t.jsx)("div",{className:Ft.value,children:Un?.label}),(0,t.jsx)("div",{className:Ft.label,children:"Upsample"}),(0,t.jsx)("div",{className:Ft.value,children:hn?.label})]})}const ft=Pt=>({container:(0,n.css)({padding:Pt.spacing(1),display:"grid",gap:Pt.spacing(.5),gridTemplateColumns:"repeat(4, 1fr)",gridTemplateRows:"1fr 1fr"}),...dt(Pt)});function _e({model:Pt}){const Ft=(0,u.of)(et),{expression:Xt,conditions:sn}=Pt,on=sn&&sn[0]?.evaluator,xn=Ie.zd.find(en=>en.value===on?.type),Un=on?ze(on):!1,hn=sn&&sn[0]?.unloadEvaluator,St=Ie.zd.find(en=>en.value===hn?.type),kt=hn?ze(hn):!1;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Xt}),on&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:xn?.label}),(0,t.jsx)("div",{className:Ft.bold,children:Un?`(${on.params[0]}; ${on.params[1]})`:on.params[0]})]})]}),(0,t.jsx)("div",{className:Ft.container,children:hn&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.label,children:"Stop alerting when "}),(0,t.jsx)("div",{className:Ft.value,children:Xt}),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Ft.blue,children:St?.label}),(0,t.jsx)("div",{className:Ft.bold,children:kt?`(${hn.params[0]}; ${hn.params[1]})`:hn.params[0]})]})]})})]})}const et=Pt=>{const{blue:Ft,bold:Xt,...sn}=dt(Pt);return{...sn,maxWidthContainer:(0,n.css)({maxWidth:"100%"}),container:(0,n.css)({padding:Pt.spacing(1),display:"flex",gap:Pt.spacing(.5)}),blue:(0,n.css)(Ft,{margin:"auto 0"}),bold:(0,n.css)(Xt,{margin:"auto 0"})}};function it({model:Pt}){const Ft=(0,u.of)(et),{expression:Xt}=Pt;return(0,t.jsxs)("div",{className:Ft.container,children:[(0,t.jsx)("div",{className:Ft.label,children:"Input"}),(0,t.jsx)("div",{className:Ft.value,children:Xt})]})}const dt=Pt=>({blue:(0,n.css)({color:Pt.colors.text.link}),bold:(0,n.css)({fontWeight:Pt.typography.fontWeightBold}),label:(0,n.css)({display:"flex",alignItems:"center",padding:Pt.spacing(.5,1),backgroundColor:Pt.colors.background.secondary,fontSize:Pt.typography.bodySmall.fontSize,lineHeight:Pt.typography.bodySmall.lineHeight,fontWeight:Pt.typography.fontWeightBold,borderRadius:Pt.shape.radius.default}),value:(0,n.css)({padding:Pt.spacing(.5,1),border:`1px solid ${Pt.colors.border.weak}`,borderRadius:Pt.shape.radius.default})});function ze(Pt){return Pt.type===ge.p.IsWithinRange||Pt.type===ge.p.IsOutsideRange}var xe=e(36135),Oe=e(28318),Le=e(1932),Ze=e(25968);function qe(Pt){if(!Pt)return[];const{namespace:Ft,rulerRule:Xt}=Pt,{rulesSource:sn}=Ft;if((0,R.lT)(Xt)){const on=Xt.grafana_alert.data;return rt(on,Xt.for??"",Pt.group.interval)}if((0,Be.Eb)(sn)){const on=Ot(sn,Pt);return[vt(on,sn.uid)]}return[]}function rt(Pt,Ft,Xt){const sn=(0,Ze.P8)(Ft)??(0,Ze.P8)(Xt??"1m"),on=Math.floor(sn/1e3);return Pt.map(xn=>(0,Le.jM)(xn,Un=>{const hn=Un.relativeTimeRange?.from??0,St=Math.max(on*3,hn+on*2);Un.relativeTimeRange={from:St,to:0}}))}function vt(Pt,Ft){return{refId:Pt.refId,datasourceUid:Ft,queryType:"",model:Pt,relativeTimeRange:{from:360,to:0}}}function Ot(Pt,Ft){const Xt="A";switch(Pt.type){case"prometheus":return{refId:Xt,expr:Ft.query};case"loki":return{refId:Xt,expr:Ft.query};default:throw new Error(`Query for datasource type ${Pt.type} is currently not supported by cloud alert rules.`)}}const jt=({rule:Pt})=>{const Ft=(0,s.useMemo)(()=>new Oe.t,[]),Xt=(0,de.A)(Ft.get()),sn=Ut(Xt),on=(0,s.useMemo)(()=>qe(Pt),[Pt]),{allDataSourcesAvailable:xn}=(0,xe.g)(on),Un=(0,s.useCallback)(()=>{if(on.length>0&&xn){let St;Pt&&(0,R.lT)(Pt.rulerRule)&&(St=Pt.rulerRule.grafana_alert.condition),Ft.run(on,St??"A")}},[on,xn,Pt,Ft]);(0,s.useEffect)(()=>{xn&&Un()},[xn,Un]),(0,s.useEffect)(()=>()=>Ft.destroy(),[Ft]);const hn=(0,R.YN)(Pt.group);return(0,t.jsx)(t.Fragment,{children:sn?"Loading...":(0,t.jsxs)(t.Fragment,{children:[(0,R.lT)(Pt.rulerRule)&&!hn&&(0,t.jsx)(ue,{rule:Pt,condition:Pt.rulerRule.grafana_alert.condition,queries:on,evalDataByQuery:Xt}),!(0,R.lT)(Pt.rulerRule)&&!hn&&Xt&&Object.keys(Xt).length>0&&(0,t.jsx)(g.B,{direction:"column",gap:1,children:on.map(St=>(0,t.jsx)(Ee,{rule:Pt,refId:St.refId,model:St.model,dataSource:Object.values(te.$.datasources).find(kt=>kt.uid===St.datasourceUid),queryData:Xt[St.refId],relativeTimeRange:St.relativeTimeRange},St.refId))}),!hn&&!xn&&(0,t.jsx)(i.F,{title:"Query not available",severity:"warning",children:"Cannot display the query preview. Some of the data sources used in the queries are not available."})]})})};function Ut(Pt){return Pt?!!Object.values(Pt).find(Ft=>Ft.state===le.Gu.Loading):!0}const zt=()=>(0,t.jsx)(t.Fragment,{children:"Routing"});var qt=(Pt=>(Pt.Query="query",Pt.Instances="instances",Pt.History="history",Pt.Routing="routing",Pt.Details="details",Pt))(qt||{});const fn=(0,x.w)(),Sn=()=>{const{rule:Pt,identifier:Ft}=(0,H.k)(),{pageNav:Xt,activeTab:sn}=Kn(Pt),[on,xn]=(0,s.useState)(),{annotations:Un,promRule:hn}=Pt,St=Zn(Pt.promRule?.health),kt=(0,R.Z8)(hn),en=(0,R.YN)(Pt.group),tn=(0,R.lT)(Pt.rulerRule)&&!!Pt.rulerRule.grafana_alert.provenance,gn=(0,R.lT)(Pt.rulerRule)&&(0,R.HH)(Pt.rulerRule),Nn=St&&!gn,Ct=(0,R.uo)(Pt),Rt=Un[T.YH.summary];return(0,t.jsxs)(j.d,{pageNav:Xt,navId:"alert-list",isLoading:!1,renderTitle:Mt=>(0,t.jsx)(es,{name:Mt,paused:gn,state:kt?hn.state:void 0,health:Pt.promRule?.health,ruleType:Pt.promRule?.type,ruleOrigin:Ct}),actions:(0,t.jsx)(v.l,{rule:Pt,showCopyLinkButton:!0,rulesSource:Pt.namespace.rulesSource}),info:An(Pt),subTitle:(0,t.jsxs)(g.B,{direction:"column",children:[gn&&(0,t.jsx)(f.A,{}),Rt,en&&(0,t.jsx)(w,{}),tn&&(0,t.jsx)(B.Yi,{resource:B.hk.AlertRule,bottomSpacing:0,topSpacing:2}),Nn&&(0,t.jsx)(i.F,{title:"Something went wrong when evaluating this alert rule",bottomSpacing:0,topSpacing:2,children:(0,t.jsx)("pre",{style:{marginBottom:0},children:(0,t.jsx)("code",{children:Pt.promRule?.lastError??"No error message"})})})]}),children:[fn&&(0,t.jsx)(rs,{ruleIdentifier:Ft}),(0,t.jsx)(g.B,{direction:"column",gap:2,children:(0,t.jsxs)(l.J,{children:[sn==="query"&&(0,t.jsx)(jt,{rule:Pt}),sn==="instances"&&(0,t.jsx)(se,{rule:Pt}),sn==="history"&&(0,R.lT)(Pt.rulerRule)&&(0,t.jsx)(Z,{rule:Pt.rulerRule}),sn==="routing"&&(0,t.jsx)(zt,{}),sn==="details"&&(0,t.jsx)(q.B,{rule:Pt})]})}),on&&(0,t.jsx)(K.Z,{redirectTo:!0,identifier:on,isProvisioned:tn,onDismiss:()=>xn(void 0)})]})},An=Pt=>{const{labels:Ft,annotations:Xt,group:sn}=Pt,on=[],xn=Xt[T.YH.runbookURL],Un=Xt[T.YH.dashboardUID],hn=Xt[T.YH.panelID],St=Un&&hn,kt=Un,en=!(0,r.isEmpty)(Ft),tn=sn.interval;if(xn){const gn=(0,r.truncate)(xn,{length:42}),Nn=Jn(xn)?(0,t.jsx)(d.Y,{variant:"bodySmall",href:xn,external:!0,children:gn}):(0,t.jsx)(o.E,{variant:"bodySmall",children:gn});on.push({label:"Runbook URL",value:Nn})}if(St?on.push({label:"Dashboard and panel",value:(0,t.jsx)(N.d,{title:Pt.name,component:(0,t.jsx)(d.Y,{variant:"bodySmall",href:(0,A.D2)(Un,hn),children:"View panel"})})}):kt&&on.push({label:"Dashboard",value:(0,t.jsx)(N.d,{title:Pt.name,component:(0,t.jsx)(d.Y,{title:Pt.name,variant:"bodySmall",href:(0,A.JM)(Un),children:"View dashboard"})})}),(0,R.Gy)(Pt.rulerRule)){const gn=Pt.rulerRule?.grafana_alert.record?.metric??"";on.push({label:"Metric name",value:(0,t.jsx)(o.E,{color:"primary",children:gn})})}return tn&&on.push({label:"Evaluation interval",value:(0,t.jsxs)(o.E,{color:"primary",children:["Every ",tn]})}),en&&on.push({label:"Labels",value:(0,t.jsx)(O.m,{labels:Ft,size:"sm"})}),on},Hn=Pt=>{const Ft=new URLSearchParams([["search",Pt.map(([Xt,sn])=>`${Xt}:"${sn}"`).join(" ")]]);return(0,S.G)("/alerting/list",Ft)},es=({name:Pt,paused:Ft=!1,state:Xt,health:sn,ruleType:on,ruleOrigin:xn})=>{const Un=(0,u.of)(wn),hn=on===m.JS.Recording,{returnTo:St}=(0,C.h)("/alerting/list");return(0,t.jsxs)("div",{className:Un.title,children:[(0,t.jsx)(c.z9,{variant:"secondary",icon:"angle-left",href:St}),xn&&(0,t.jsx)(b.T,{pluginId:xn.pluginId}),(0,t.jsx)(o.E,{variant:"h1",truncate:!0,children:Pt}),Ft?(0,t.jsx)(W,{}):(0,t.jsxs)(t.Fragment,{children:[Xt&&(0,t.jsx)(Q,{state:Xt,health:sn}),hn&&(0,t.jsx)(M,{health:sn})]})]})};function rs({ruleIdentifier:Pt}){const[Ft,{width:Xt}]=(0,a.A)(),{isConsistent:sn,error:on}=(0,E.f)(Pt);return sn?null:on?(0,t.jsx)(i.F,{title:"Unable to check the rule status",bottomSpacing:0,topSpacing:2,children:(0,A.JZ)(on)}):(0,t.jsxs)(g.B,{direction:"column",gap:0,ref:Ft,children:[(0,t.jsx)(p.G,{width:Xt}),(0,t.jsx)(i.F,{title:(0,h.t)("alerting.rule-viewer.prometheus-consistency-check.alert-title","Update in progress"),severity:"info",children:(0,t.jsx)(h.x,{i18nKey:"alerting.rule-viewer.prometheus-consistency-check.alert-message",children:"Alert rule has been updated. Changes may take up to a minute to appear on the Alert rules list view."})})]})}const Zn=Pt=>Pt==="error"||Pt==="err";function kn(){const[Pt,Ft]=(0,y.s)(),Xt=Pt.tab;return[Gn(Xt)?Xt:"query",xn=>{Ft({tab:xn})}]}function Gn(Pt){return typeof Pt=="string"&&Object.values(qt).includes(Pt)}function Kn(Pt){const[Ft,Xt]=kn(),{annotations:sn,promRule:on}=Pt,xn=sn[T.YH.summary],Un=(0,R.Z8)(on),hn=Un?yn(Pt.instanceTotals):void 0,St=(0,I.EL)(Pt.namespace).name,kt=Pt.group.name,en=(0,R.lT)(Pt.rulerRule)&&Un,tn=(0,R.KB)(Pt.promRule);return{pageNav:{...D.defaultPageNav,text:Pt.name,subTitle:xn,children:[{text:"Query and conditions",active:Ft==="query",onClick:()=>{Xt("query")}},{text:"Instances",active:Ft==="instances",onClick:()=>{Xt("instances")},tabCounter:hn,hideFromTabs:tn},{text:"History",active:Ft==="history",onClick:()=>{Xt("history")},hideFromTabs:!en},{text:"Details",active:Ft==="details",onClick:()=>{Xt("details")}}],parentItem:{text:kt,url:Hn([["namespace",St],["group",kt]]),parentItem:{text:St,url:Hn([["namespace",St]])}}},activeTab:Ft}}const yn=Pt=>(0,r.chain)(Pt).pick([P.$.Alerting,P.$.Pending,P.$.Normal]).values().sum().value(),wn=()=>({title:(0,n.css)({display:"flex",alignItems:"center",gap:8,minWidth:0})});function Jn(Pt){const Ft=Pt.startsWith("/");let Xt=!1;try{new URL(Pt),Xt=!0}catch{return!1}return Ft||Xt}const bn=Sn},50509:(_,L,e)=>{"use strict";e.d(L,{$:()=>f,B:()=>y});var t=e(74848),n=e(32196),r=e(72095),s=e(96540),a=e(40845),g=e(67061),i=e(94753),l=e(10534),d=e(72109),o=e(86783),u=e(23662),c=e(55196),p=e(16577),h=(P=>(P.GrafanaManagedAlertRule="Grafana-managed alert rule",P.GrafanaManagedRecordingRule="Grafana-managed recording rule",P.CloudAlertRule="Cloud alert rule",P.CloudRecordingRule="Cloud recording rule",P))(h||{});const y=({rule:P})=>{const m=(0,a.of)(v);let D;const x=(0,o.G)(P);(0,u.lT)(P.rulerRule)?D=(0,u.Gy)(P.rulerRule)?"Grafana-managed recording rule":"Grafana-managed alert rule":(0,u.i7)(P.rulerRule)?D="Cloud recording rule":D="Cloud alert rule";const E=P.promRule?.evaluationTime,C=P.promRule?.lastEvaluation,b=(0,s.useCallback)(()=>(0,u.lT)(P.rulerRule)?P.rulerRule.grafana_alert.uid:"",[P.rulerRule]),T=(0,u.Rh)(P),A=Number.isFinite(E);return(0,t.jsxs)(g.B,{direction:"column",gap:3,children:[(0,t.jsxs)("div",{className:m.metadataWrapper,children:[(0,t.jsxs)(c.P,{direction:"column",children:["Rule type",(0,t.jsx)(i.E,{color:"primary",children:D})]}),(0,t.jsx)(c.P,{direction:"column",children:(0,u.lT)(P.rulerRule)&&(0,t.jsxs)(t.Fragment,{children:["Rule Identifier",(0,t.jsx)(g.B,{direction:"row",alignItems:"center",gap:.5,children:(0,t.jsxs)(i.E,{color:"primary",children:[P.rulerRule.grafana_alert.uid,(0,t.jsx)(l.b,{fill:"text",variant:"secondary",icon:"copy",size:"sm",getText:b})]})})]})}),(0,t.jsx)(c.P,{direction:"column",children:A&&(0,t.jsxs)(t.Fragment,{children:["Last evaluation",C&&E?(0,t.jsxs)("span",{children:[(0,t.jsxs)(i.E,{color:"primary",children:[(0,r.B)(new Date(C))," ago"]}),", took"," ",(0,t.jsxs)(i.E,{color:"primary",children:[E,"ms"]})]}):null]})}),(0,t.jsx)(c.P,{direction:"column",children:x&&(0,t.jsxs)(t.Fragment,{children:["Pending period",(0,t.jsx)(i.E,{color:"primary",children:x})]})}),(0,u.lT)(P.rulerRule)&&P.rulerRule.grafana_alert.no_data_state&&P.rulerRule.grafana_alert.exec_err_state&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.P,{direction:"column",children:["Alert state if no data or all values are null",(0,t.jsx)(i.E,{color:"primary",children:P.rulerRule.grafana_alert.no_data_state})]}),(0,t.jsxs)(c.P,{direction:"column",children:["Alert state if execution error or timeout",(0,t.jsx)(i.E,{color:"primary",children:P.rulerRule.grafana_alert.exec_err_state})]})]})]}),T&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.E,{variant:"h4",children:"Annotations"}),Object.keys(T).length===0?(0,t.jsx)(i.E,{variant:"bodySmall",color:"secondary",italic:!0,children:"No annotations"}):(0,t.jsx)("div",{className:m.metadataWrapper,children:Object.entries(T).map(([R,S])=>(0,t.jsxs)(c.P,{direction:"column",children:[R,(0,t.jsx)(f,{value:S})]},R))})]})]})};function f({value:P}){const m=P&&P.startsWith("http"),D=(0,t.jsx)(p.Y,{input:P,delimiter:["{{","}}"]});return m?(0,t.jsx)(d.Y,{variant:"bodySmall",href:P,external:!0,children:P}):(0,t.jsx)(i.E,{color:"primary",children:D})}const v=P=>({metadataWrapper:(0,n.css)({display:"grid",gridTemplateColumns:"auto auto",rowGap:P.spacing(3),columnGap:P.spacing(12)})})},2426:(_,L,e)=>{"use strict";e.d(L,{D:()=>D});var t=e(74848),n=e(96540),r=e(8249),s=e(47232),a=e(74135),g=e(23662),i=e(69087),l=e(75591),d=e(71798),o=e(83122),u=e(29158),c=e(24401),p=e(30973);const h=({rule:E,instance:C,extensionPointId:b})=>{const[T,A]=(0,n.useState)(),R=(0,n.useMemo)(()=>({instance:C,rule:E}),[C,E]),{links:S}=(0,d.U)({context:R,extensionPointId:b,limitPerPlugin:3});if(S.length===0)return null;const O=(0,t.jsx)(p.w,{extensions:S,onSelect:A});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.m,{placement:"bottom-start",overlay:O,children:(0,t.jsx)(u.K,{name:"ellipsis-v","aria-label":"Actions",variant:"secondary"})}),!!T&&!!T.path&&(0,t.jsx)(c.s,{path:T.path,title:T.title,onDismiss:()=>A(void 0)})]})};var y=e(33225),f=e(71223),v=e(84396);const P=({instance:E})=>{const C=(0,y.Hx)(E.annotations),b=(0,y.gO)(C);return(0,t.jsxs)("div",{children:[E.value&&(0,t.jsx)(v.X,{label:"Value",horizontal:!0,children:E.value}),C.map(([T,A])=>(0,t.jsx)(f.s,{annotationKey:T,value:A,valueLink:b.get(T)},T))]})};var m=e(30423);const D=({rule:E,instances:C,pagination:b,footerRow:T})=>{const A=(0,n.useMemo)(()=>C.length>1?(0,r.yO)(C.map(S=>S.labels)):{},[C]),R=(0,n.useMemo)(()=>C.map(S=>({data:{rule:E,alert:{...S,commonLabels:A}},id:(0,g.RI)(S)})),[A,C,E]);return(0,t.jsx)(l.E,{cols:x,isExpandable:!0,items:R,renderExpandedContent:({data:S})=>(0,t.jsx)(P,{instance:S.alert}),pagination:b,footerRow:T})},x=[{id:"state",label:"State",renderCell:({data:{alert:{state:E}}})=>(0,t.jsx)(m.C,{state:E}),size:"80px"},{id:"labels",label:"Labels",renderCell:({data:{alert:{labels:E,commonLabels:C}}})=>(0,t.jsx)(i.m,{labels:E,commonLabels:C,size:"sm"})},{id:"created",label:"Created",renderCell:({data:{alert:{activeAt:E}}})=>(0,t.jsx)(t.Fragment,{children:E.startsWith("0001")?"-":(0,s.KQ)(E).format("YYYY-MM-DD HH:mm:ss")}),size:"150px"},{id:"actions",label:"",renderCell:({data:{alert:E,rule:C}})=>(0,t.jsx)(h,{rule:C,instance:E,extensionPointId:a.S.AlertInstanceAction},"alert-instance-extension-point"),size:"40px"}]},30423:(_,L,e)=>{"use strict";e.d(L,{C:()=>i});var t=e(74848),n=e(96540),r=e(56034),s=e(14578),a=e(23662),g=e(65415);const i=(0,n.memo)(({state:l,isPaused:d=!1,size:o="md",muted:u=!1})=>d?(0,t.jsx)(r.m,{content:"Alert evaluation is currently paused",placement:"top",children:(0,t.jsxs)(g.O,{state:"warning",size:o,muted:u,children:[(0,t.jsx)(s.I,{name:"pause",size:"xs"})," Paused"]})}):(0,t.jsx)(g.O,{state:(0,a.Wy)(l),size:o,muted:u,children:(0,a.XI)(l)}));i.displayName="AlertStateTag"},51921:(_,L,e)=>{"use strict";e.d(L,{Z:()=>l});var t=e(74848),n=e(96540),r=e(24180),s=e(54148),a=e(96374),g=e(55852),i=e(18461);function l({identifier:o,isProvisioned:u,redirectTo:c=!1,onDismiss:p}){const h=(0,r.zy)(),[y,f]=(0,n.useState)(u?"confirm":"redirect");if(y==="redirect"){const v=i.$9(o),P=h.pathname+h.search,m=new URLSearchParams({copyFrom:v,returnTo:c?P:""});return(0,t.jsx)(s.C5,{to:"/alerting/new?"+m.toString(),replace:!1})}return(0,t.jsx)(a.u,{isOpen:y==="confirm",title:"Copy provisioned alert rule",body:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["The new rule will ",(0,t.jsx)("strong",{children:"not"})," be marked as a provisioned rule."]}),(0,t.jsx)("p",{children:"You will need to set a new evaluation group for the copied rule because the original one has been provisioned and cannot be used for rules created in the UI."})]}),confirmText:"Copy",onConfirm:()=>f("redirect"),onDismiss:p})}const d=(0,n.forwardRef)(({text:o,ruleIdentifier:u,isProvisioned:c,className:p},h)=>{const[y,f]=(0,n.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.$n,{title:"Copy",className:p,size:"sm",variant:"secondary",icon:"copy",onClick:()=>f(!0),ref:h,children:o},"clone"),y&&(0,t.jsx)(l,{identifier:u,isProvisioned:c,onDismiss:()=>f(!1)})]})});d.displayName="CloneRuleButton"},35896:(_,L,e)=>{"use strict";e.d(L,{l:()=>ge});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(67061),i=e(26272),l=e(38138),d=e(83122),o=e(28138),u=e(3169),c=e(23662),p=e(8484),h=e(79938),y=e(48070),f=e(6833),v=e(43482);function P(){const[De]=(0,v.D)(),[Ke]=h.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),Me=(0,p.t)("alerting.rules.pause-rule.success","Rule evaluation paused"),be=(0,p.t)("alerting.rules.resume-rule.success","Rule evaluation resumed");return(0,f.Yb)(async(we,Be,He)=>{const{namespaceName:Ve}=we,Je=(0,y.LH)({uid:Be,pause:He}),{newRuleGroupDefinition:nt,rulerConfig:pt}=await De(we,Je);return Ke({rulerConfig:pt,namespace:Ve,payload:nt,notificationOptions:{successMessage:He?Me:be}}).unwrap()})}var m=e(78742);const x=({rule:De,onPauseChange:Ke})=>{const Me=(0,u._2)(),[be,we]=P(),Be=(0,c.lT)(De.rulerRule)&&(0,c.HH)(De.rulerRule),He=Be?"play":"pause",Ve=Be?"Resume evaluation":"Pause evaluation",Je=async nt=>{if((0,c.lT)(De.rulerRule)){try{const pt=(0,c.Uw)(De),bt=De.rulerRule.grafana_alert.uid;await be.execute(pt,bt,nt)}catch(pt){Me.error(`Failed to ${nt?"pause":"resume"} the rule: ${(0,m.JZ)(pt)}`);return}Ke?.()}};return(0,t.jsx)(l.W.Item,{label:Ve,icon:He,disabled:(0,f.VP)(we),onClick:()=>{Je(!Be)}})};var E=e(90141),C=e(74135),b=e(71798),T=e(94822);function A(De){const Ke=R(De),{links:Me}=(0,b.U)(Ke),be=(0,c.uo)(De),we=De.promRule?.type;if(!be||!we)return[];const{pluginId:Be}=be;return Me.filter(He=>He.pluginId===Be)}function R(De){return(0,r.useMemo)(()=>{switch(De.promRule?.type){case T.JS.Alerting:return{extensionPointId:C.S.AlertingAlertingRuleAction,context:{name:De.name,namespace:De.namespace.name,group:De.group.name,expression:De.query,labels:De.labels,annotations:De.annotations}};case T.JS.Recording:return{extensionPointId:C.S.AlertingRecordingRuleAction,context:{name:De.name,namespace:De.namespace.name,group:De.group.name,expression:De.query,labels:De.labels}};default:return{extensionPointId:""}}},[De])}var S=e(19073),O=e(18461),j=e(3704),B=e(56034),N=e(12210),I=e(99494),K=e(76156);const w=({title:De="",severity:Ke="",url:Me=""})=>{const be=createBridgeURL(SupportedPlugin.Incident,"/incidents/declare",{title:De,severity:Ke,url:Me}),{loading:we,installed:Be,settings:He}=usePluginBridge(SupportedPlugin.Incident);return jsxs(Fragment,{children:[we===!0&&jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"}),Be===!1&&jsx(Tooltip,{content:"Grafana Incident is not installed or is not configured correctly",children:jsx(Button,{icon:"fire",size:"sm",type:"button",disabled:!0,children:"Declare Incident"})}),He&&jsx(LinkButton,{icon:"fire",size:"sm",type:"button",href:be,children:"Declare Incident"})]})},U=({title:De="",severity:Ke="",url:Me=""})=>{const be=(0,K.h)(I.W.Incident,"/incidents/declare",{title:De,severity:Ke,url:Me}),{loading:we,installed:Be,settings:He}=(0,N._)(I.W.Incident);return(0,t.jsxs)(t.Fragment,{children:[we===!0&&(0,t.jsx)(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0}),Be===!1&&(0,t.jsx)(B.m,{content:"Grafana Incident is not installed or is not configured correctly",children:(0,t.jsx)(l.W.Item,{label:"Declare incident",icon:"fire",disabled:!0})}),He&&(0,t.jsx)(l.W.Item,{label:"Declare incident",url:be,icon:"fire"})]})},W=({rule:De,identifier:Ke,showCopyLinkButton:Me,handleSilence:be,handleDelete:we,handleDuplicateRule:Be,onPauseChange:He,buttonSize:Ve})=>{const[Je,nt]=(0,S.mh)(De,S.j5.Pause),pt=Je&&nt,[bt,Tt]=(0,S.mh)(De,S.j5.Delete),ye=bt&&Tt,[je,ue]=(0,S.mh)(De,S.j5.Duplicate),Ee=je&&ue,[Ce,Ne]=(0,S.mh)(De,S.j5.Silence),Fe=Ce&&Ne,[Ue,fe]=(0,S.mh)(De,S.j5.ModifyExport),Te=Ue&&fe,Ge=A(De),Qe=Ge.length>0,st=(!(0,m.y$)()||(0,m.ES)())&&(0,c.Z8)(De.promRule)&&De.promRule.state===T.cF.Firing,Xe=(0,m.S2)(De.namespace.rulesSource,De),ot=[pt,Fe,st,Ee].some(Boolean)&&[Me,Te].some(Boolean),ft=(0,t.jsxs)(t.Fragment,{children:[pt&&(0,t.jsx)(x,{rule:De,onPauseChange:He}),Fe&&(0,t.jsx)(l.W.Item,{label:"Silence notifications",icon:"bell-slash",onClick:be}),st&&(0,t.jsx)(U,{title:De.name,url:""}),Ee&&(0,t.jsx)(l.W.Item,{label:"Duplicate",icon:"copy",onClick:()=>Be(Ke)}),ot&&(0,t.jsx)(l.W.Divider,{}),Xe&&(0,t.jsx)(l.W.Item,{label:"Copy link",icon:"share-alt",onClick:()=>H(Xe)}),Te&&(0,t.jsx)(l.W.Item,{label:"Export",icon:"download-alt",childItems:[(0,t.jsx)(z,{identifier:Ke},"export-with-modifications")]}),Qe&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.W.Divider,{}),Ge.map(_e=>(0,t.jsx)(l.W.Item,{label:_e.title,icon:_e.icon,onClick:_e.onClick},_e.id))]}),ye&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.W.Divider,{}),(0,t.jsx)(l.W.Item,{label:"Delete",icon:"trash-alt",destructive:!0,onClick:()=>we(De)})]})]});return(0,t.jsx)(d.m,{overlay:(0,t.jsx)(l.W,{children:ft}),children:(0,t.jsx)(E.A,{size:Ve})})};function H(De){navigator.clipboard?.writeText(De).then(()=>{o.A.emit(i.r1.alertSuccess,["URL copied to clipboard"])})}const z=({identifier:De})=>{const Ke=location.pathname+location.search,Me=(0,j.G)(`/alerting/${encodeURIComponent(O.$9(De))}/modify-export`,{returnTo:Ke});return(0,t.jsx)(l.W.Item,{label:"With modifications",icon:"file-edit-alt",url:Me},"with-modifications")},G=W;var M=e(39601),Q=e(96374),Y=e(99140),q=e(24608),te=e(96065),X=e(99935),ee=e(26627);const ne=(0,q.w)(),Z=(De=!1)=>{const[Ke,Me]=(0,r.useState)(),[be]=(0,te.Y)(),{waitForRemoval:we}=(0,X.I)(),Be=(0,r.useCallback)(()=>{Me(void 0)},[]),He=(0,r.useCallback)(nt=>{Me(nt)},[]),Ve=(0,r.useCallback)(async nt=>{if(!nt?.rulerRule)return;const pt=(0,c.Uw)(nt),bt=(0,O.mw)(pt,nt.rulerRule);await be.execute(pt,bt),(0,Y.JD)((0,ee.Lc)({rulesSourceName:pt.dataSourceName})),ne&&(0,c.X4)(bt)?await we(bt):await(0,Y.JD)((0,ee.eB)({rulesSourceName:pt.dataSourceName})),Be(),De&&M.Ny.replace("/alerting/list")},[be,Be,De,we]);return[(0,r.useMemo)(()=>(0,t.jsx)(Q.u,{isOpen:!!Ke,title:"Delete rule",body:"Deleting this rule will permanently remove it from your alert rule list. Are you sure you want to delete this rule?",confirmText:"Yes, delete",icon:"exclamation-triangle",onConfirm:()=>Ve(Ke),onDismiss:Be}),[Ve,Be,Ke]),He,Be]};var ae=e(75648),re=e(87978),se=e(98569),de=e(17272),le=e(57220);const ie=({rulerRule:De,onClose:Ke})=>{const{uid:Me}=De.grafana_alert,be=(0,de.Di)();return(0,t.jsx)(re._,{title:"Silence alert rule",subtitle:"Configure silences to stop notifications from a particular alert rule.",onClose:Ke,size:"md",children:(0,t.jsx)(g.B,{direction:"column",children:(0,t.jsx)(se.G,{ruleUid:Me,formValues:be,alertManagerSourceName:le.hY,onSilenceCreated:Ke,onCancel:Ke})})})};var J=e(14285),ce=e(70383),pe=e(31678),Pe=e(51921);const Ie=De=>window.matchMedia(`(max-width: ${De}px)`).matches,ge=({compact:De,showViewButton:Ke,showCopyLinkButton:Me,rule:be,rulesSource:we})=>{const Be=(0,pe.useDispatch)(),He=(0,s.of)(Se),Ve=!De,[Je,nt]=Z(Ve),[pt,bt]=(0,r.useState)(!1),[Tt,ye]=(0,r.useState)(void 0),{namespace:je,group:ue,rulerRule:Ee}=be,{hasActiveFilters:Ce}=(0,J.dI)(),Ne=(0,c.lT)(be.rulerRule)&&!!be.rulerRule.grafana_alert.provenance,[Fe,Ue]=(0,S.mh)(be,S.j5.Update),fe=Fe&&Ue,Te=[],Ge=(0,n.cx)({[He.compactButton]:De}),Qe=De?"sm":"md",st=(0,le.EV)(we),Xe=O.UP(st,be);if(Ke&&Te.push((0,t.jsx)(a.z9,{tooltip:De?"View":void 0,tooltipPlacement:"top",className:Ge,title:"View",size:Qe,variant:"secondary",icon:"eye",href:(0,m.w$)(we,be),children:!De&&"View"},"view")),Ee&&fe){const ot=O.P1(st,je.name,ue.name,Ee),ft=(0,j.G)(`/alerting/${encodeURIComponent(O.$9(ot))}/edit`);Te.push((0,t.jsx)(a.z9,{tooltip:De?"Edit":void 0,tooltipPlacement:"top",title:"Edit",className:Ge,size:Qe,variant:"secondary",icon:"pen",href:ft,children:!De&&"Edit"},"edit"))}return(0,t.jsxs)(g.B,{gap:1,children:[Te,(0,t.jsx)(G,{buttonSize:Qe,rule:be,identifier:Xe,showCopyLinkButton:Me,handleDelete:()=>nt(be),handleSilence:()=>bt(!0),handleDuplicateRule:()=>ye({identifier:Xe,isProvisioned:Ne}),onPauseChange:()=>{const ot=Ce?void 0:ae.Ys+1;Be((0,ee.Lc)({rulesSourceName:le.hY,limitAlerts:ot}))}}),Je,(0,c.pv)(be.rulerRule)&&pt&&(0,t.jsx)(ce.b9,{accessType:"instance",children:(0,t.jsx)(ie,{rulerRule:be.rulerRule,onClose:()=>bt(!1)})}),Tt?.identifier&&(0,t.jsx)(Pe.Z,{identifier:Tt.identifier,isProvisioned:Tt.isProvisioned,onDismiss:()=>ye(void 0)})]})},Se=De=>({compactButton:(0,n.css)({padding:`0 ${De.spacing(2)}`})})},75648:(_,L,e)=>{"use strict";e.d(L,{Ys:()=>X,DI:()=>ee});var t=e(74848),n=e(32196),r=e(72724),s=e(47232),a=e(40845),g=e(56034),i=e(97814),l=e(86783),d=e(33225),o=e(23662),u=e(25968),c=e(69087),p=e(84396),h=e(71223);function y(ae){const re=(0,a.of)(f),{annotations:se}=ae,de=(0,d.gO)(se);return se.length===0?null:(0,t.jsx)("div",{className:re.annotations,children:se.map(([le,he])=>(0,t.jsx)(h.s,{annotationKey:le,value:he,valueLink:de.get(le)},le))})}const f=()=>({annotations:(0,n.css)({marginTop:"46px"})});var v=e(96540),P=e(80997),m=e(14778),D=e(55852),x=e(67061),E=e(19073),C=e(46013),b=e(55740),T=e(57220),A=e(78742);const S=({rule:ae,rulesSource:re})=>{const{group:se}=ae,{StateHistoryModal:de,showStateHistoryModal:le}=(0,C.G)(),he=(0,m.i)(),[ie,J]=(0,E.mh)(ae,E.j5.Explore),ce=[],pe=(0,o.YN)(se);if((0,T.Eb)(re)&&ie&&J&&!pe&&ce.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"chart-line",target:"_blank",href:(0,A.Yp)(re,ae.query),children:"See graph"},"explore")),ae.annotations[b.YH.runbookURL]&&ce.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"book",target:"_blank",href:P.sQ.sanitizeUrl(ae.annotations[b.YH.runbookURL]),children:"View runbook"},"runbook")),ae.annotations[b.YH.dashboardUID]){const Pe=ae.annotations[b.YH.dashboardUID];if(Pe){ce.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Pe)}`,onClick:()=>{he(ae.name)},children:"Go to dashboard"},"dashboard"));const Ie=ae.annotations[b.YH.panelID];Ie&&ce.push((0,t.jsx)(D.z9,{size:"sm",variant:"primary",icon:"apps",href:`d/${encodeURIComponent(Pe)}?viewPanel=${encodeURIComponent(Ie)}`,onClick:()=>{he(ae.name)},children:"Go to panel"},"panel"))}}return(0,o.pv)(ae.rulerRule)&&ce.push((0,t.jsxs)(v.Fragment,{children:[(0,t.jsx)(D.$n,{size:"sm",icon:"history",onClick:()=>(0,o.lT)(ae.rulerRule)&&le(ae.rulerRule),children:"Show state history"}),de]},"history")),ce.length?(0,t.jsx)(x.B,{children:ce}):null};var O=e(19347),j=e(66718);function B(ae){const{rulesSource:re,rule:se}=ae,de=(0,a.of)(N),le=(0,v.useMemo)(()=>{if((0,T.Eb)(re))return[{name:re.name,icon:re.meta.info.logos.small}];if((0,o.lT)(se.rulerRule)){const{data:he}=se.rulerRule.grafana_alert,ie=he.reduce((J,ce)=>{const pe=(0,O.l)().getInstanceSettings(ce.datasourceUid);return!pe||pe.uid===j.Uj||(J[pe.name]={name:pe.name,icon:pe.meta.info.logos.small}),J},{});return Object.values(ie)}return[]},[se,re]);return le.length===0?null:(0,t.jsx)(p.X,{label:"Data source",children:le.map(({name:he,icon:ie},J)=>(0,t.jsxs)("div",{children:[ie&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{alt:`${he} datasource logo`,className:de.dataSourceIcon,src:ie})," "]}),he]},he))})}function N(ae){const re=ae.spacing(2);return{dataSourceIcon:(0,n.css)({width:re,height:re})}}var I=e(28848),K=e(29317),w=e(20719),U=e(41781),W=e(72307),H=e(71713),z=e(73750);const G=({language:ae,expr:re})=>{const se=(0,v.useMemo)(()=>[(0,U.D)({onlyIn:le=>"type"in le&&le.type==="code_block",getSyntax:()=>ae},{...I.languages,[ae]:ae==="logql"?H.Ay:w.n6})],[ae]),de=(0,v.useMemo)(()=>(0,W.mO)(re),[re]);return(0,t.jsx)(K.Editor,{"data-testid":"expression-editor",plugins:se,value:de})},M=({expression:ae,rulesSource:re})=>{const se=(0,a.of)(Q);return(0,t.jsx)(z.L,{className:(0,n.cx)(se.well,"slate-query-field"),children:(0,T.Eb)(re)?(0,t.jsx)(G,{expr:ae,language:re.type===T.ol.Loki?"logql":"promql"}):ae})},Q=ae=>({well:(0,n.css)({fontFamily:ae.typography.fontFamilyMonospace})});function Y(ae){const{annotations:re,rulesSource:se,rule:de}=ae,le=q();return(0,T.Eb)(se)?(0,t.jsx)(p.X,{label:"Expression",horizontal:!0,className:(0,n.cx)({[le.exprRow]:!!re.length}),children:(0,t.jsx)(M,{expression:de.query,rulesSource:se})}):null}const q=()=>({exprRow:(0,n.css)({marginBottom:"46px"})});var te=e(99938);const X=15,ee=({rule:ae})=>{const re=(0,a.of)(Z),{namespace:{rulesSource:se}}=ae,de=(0,d.Hx)(ae.annotations);return(0,t.jsxs)("div",{children:[(0,t.jsx)(S,{rule:ae,rulesSource:se}),(0,t.jsxs)("div",{className:re.wrapper,children:[(0,t.jsxs)("div",{className:re.leftSide,children:[(0,t.jsx)(ne,{rule:ae}),!!ae.labels&&!!Object.keys(ae.labels).length&&(0,t.jsx)(p.X,{label:"Labels",horizontal:!0,children:(0,t.jsx)(c.m,{labels:ae.labels})}),(0,t.jsx)(Y,{rulesSource:se,rule:ae,annotations:de}),(0,t.jsx)(y,{annotations:de})]}),(0,t.jsx)("div",{className:re.rightSide,children:(0,t.jsx)(B,{rulesSource:se,rule:ae})})]}),(0,t.jsx)(p.X,{label:"Instances",horizontal:!0,children:(0,t.jsx)(te.s,{rule:ae,itemsDisplayLimit:X})})]})},ne=({rule:ae})=>{const re=ae.group.interval,se=ae.promRule?.lastEvaluation,de=ae.promRule?.evaluationTime,le=(0,o.Gy)(ae.rulerRule)?ae.rulerRule?.grafana_alert.record?.metric:void 0,he=(0,l.G)(ae);return(0,t.jsxs)(t.Fragment,{children:[le&&(0,t.jsx)(p.X,{label:"Metric",horizontal:!0,children:le}),re&&(0,t.jsxs)(p.X,{label:"Evaluate",horizontal:!0,children:["Every ",re]}),he&&(0,t.jsx)(p.X,{label:"Pending period",horizontal:!0,children:he}),se&&!(0,u.mo)(se)&&(0,t.jsx)(p.X,{label:"Last evaluation",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${(0,r.LE)(se,{format:"YYYY-MM-DD HH:mm:ss"})}`,theme:"info",children:(0,t.jsx)("span",{children:`${(0,s.KQ)(se).locale("en").fromNow(!0)} ago`})})}),se&&!(0,u.mo)(se)&&de!==void 0&&(0,t.jsx)(p.X,{label:"Evaluation time",horizontal:!0,children:(0,t.jsx)(g.m,{placement:"top",content:`${de}s`,theme:"info",children:(0,t.jsx)("span",{children:(0,i.g)({timeInMs:de*1e3,humanize:!0})})})})]})},Z=ae=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",[ae.breakpoints.down("md")]:{flexDirection:"column"}}),leftSide:(0,n.css)({flex:1}),rightSide:(0,n.css)({[ae.breakpoints.up("md")]:{paddingLeft:"90px",width:"300px"}})})},99938:(_,L,e)=>{"use strict";e.d(L,{s:()=>C});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(40845),g=e(55852),i=e(53876),l=e(78369),d=e(60029),o=e(94354),u=e(94822);const c=({className:A,onStateFilterChange:R,stateFilter:S,filterType:O,itemPerStateStats:j})=>{const B=(0,a.of)(p),N=W=>function(){return j&&j[W]?(0,t.jsx)(l.v,{name:j[W].toFixed(0),colorIndex:9,className:B.tag}):null},I=Object.values(u.Gi).map(W=>({label:W,value:W,component:N(W)})),w=[u.cF.Firing,u.cF.Pending].map(W=>({label:(0,r.capitalize)(W),value:W,component:N(W)})),U=O==="grafana"?I:w;return(0,t.jsxs)("div",{className:A,"data-testid":"alert-instance-state-filter",children:[(0,t.jsx)(d.J,{children:"State"}),(0,t.jsx)(o.z,{options:U,value:S,onChange:R,onClick:W=>{W===S&&R(void 0)}})]})};function p(A){return{tag:(0,n.css)({fontSize:"11px",fontWeight:"normal",padding:A.spacing(.25,.5),verticalAlign:"middle",marginLeft:A.spacing(.5)})}}var h=e(98164),y=e(78742),f=e(64861),v=e(57220),P=e(32642),m=e(23662),D=e(2426),x=e(92467);function E({stats:A,onClick:R,href:S}){const O=(0,a.of)(T);return(0,t.jsxs)("div",{className:O.footerRow,children:[(0,t.jsxs)("div",{children:["Showing ",A.visibleItemsCount," out of ",A.totalItemsCount," instances"]}),(0,t.jsxs)(g.z9,{size:"sm",variant:"secondary","data-testid":"show-all",onClick:R,href:S,children:["Show all ",A.totalItemsCount," alert instances"]})]})}function C(A){const{rule:R,itemsDisplayLimit:S=Number.POSITIVE_INFINITY,pagination:O,enableFiltering:j=!1}=A,{promRule:B,namespace:N,instanceTotals:I}=R,[K,w]=(0,s.useState)(),[U,W]=(0,s.useState)(),[H]=(0,s.useState)(Math.floor(Math.random()*100)),z=`queryString-${H}`,G=(0,a.of)(T),M=(0,v.z2)(N.rulesSource)?v.hY:"prometheus",Q=(0,s.useMemo)(()=>(0,m.Z8)(B)&&B.alerts?.length?b(K,U,(0,y.Cp)(f.xB.Importance,B.alerts)):[],[B,U,K]);if(!(0,m.Z8)(B))return null;const Y=Q.slice(0,S),q=(0,r.countBy)(B.alerts,se=>(0,u.lh)(se.state)),te=(0,r.sum)([I.alerting,I.inactive,I.pending,I.nodata]),X=te-Y.length,ee={totalItemsCount:te,visibleItemsCount:Y.length},ne=(0,y.w$)(N.rulesSource,A.rule,location.pathname+location.search),Z=(0,x.kc)(I),ae=()=>W(void 0),re=X?(0,t.jsx)(E,{stats:ee,onClick:j?ae:void 0,href:j?void 0:ne}):void 0;return(0,t.jsxs)(t.Fragment,{children:[j&&(0,t.jsx)("div",{className:(0,n.cx)(G.flexRow,G.spaceBetween),children:(0,t.jsxs)("div",{className:G.flexRow,children:[(0,t.jsx)(i.X,{defaultQueryString:K,onFilterChange:se=>w(se)},z),(0,t.jsx)(c,{filterType:M,stateFilter:U,onStateFilterChange:W,itemPerStateStats:q})]})}),!j&&(0,t.jsx)("div",{className:G.stats,children:Z}),(0,t.jsx)(D.D,{rule:R,instances:Y,pagination:O,footerRow:re})]})}function b(A,R,S){let O=[...S];if(A){const j=A?(0,P.Zc)(A):[];O=O.filter(({labels:B})=>(0,h.Av)(B,j))}return R&&(O=O.filter(j=>(0,u.lh)(j.state)===R)),O}const T=A=>({flexRow:(0,n.css)({display:"flex",flexDirection:"row",alignItems:"flex-end",width:"100%",flexWrap:"wrap",marginBottom:A.spacing(1),gap:A.spacing(1)}),spaceBetween:(0,n.css)({justifyContent:"space-between"}),footerRow:(0,n.css)({display:"flex",flexDirection:"column",gap:A.spacing(1),justifyContent:"space-between",alignItems:"center",width:"100%"}),instancesContainer:(0,n.css)({marginBottom:A.spacing(2)}),stats:(0,n.css)({display:"flex",gap:A.spacing(1),padding:A.spacing(1,0)})})},92467:(_,L,e)=>{"use strict";e.d(L,{M_:()=>c,j7:()=>y,kc:()=>f});var t=e(74848),n=e(2543),r=e.n(n),s=e(55127),a=e.n(s),g=e(96540),i=e(67061),l=e(39938),d=e(21460),o=e(94822);const u={recording:0,alerting:0,[o.cF.Pending]:0,[o.cF.Inactive]:0,paused:0,error:0,nodata:0},c=g.memo(({namespaces:v})=>{const P=(0,g.useDeferredValue)(v),m=(0,g.useMemo)(()=>p(P),[P]),D=h(m),x=f(m),E=!!x.length;return x.unshift((0,t.jsxs)(g.Fragment,{children:[D," ",a()("rule",D)]},"total")),(0,t.jsx)(i.B,{direction:"row",children:E&&(0,t.jsx)("div",{children:(0,t.jsx)(i.B,{gap:.5,children:x})})})});c.displayName="RuleStats";function p(v){const P={...u};return v.forEach(({groups:m})=>{m.forEach(D=>{const x=(0,n.omitBy)(D.totals,n.isUndefined);for(const E in x)P[E]+=x[E]})}),P}function h(v){const P=(0,n.pick)(v,["alerting","pending","inactive","recording"]);return(0,n.sum)(Object.values(P))}const y=({group:v})=>{const P=v.totals,m=v?.interval,D=f(P),x=!!D.length;return(0,t.jsxs)(i.B,{direction:"row",children:[x&&(0,t.jsx)("div",{children:(0,t.jsx)(i.B,{gap:.5,children:D})}),m&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{children:"|"}),(0,t.jsx)(l.E,{text:m,icon:"clock-nine",color:"blue"})]})]})};function f(v){const P=[];return v[d.$.Alerting]&&P.push((0,t.jsx)(l.E,{color:"red",text:`${v[d.$.Alerting]} firing`},"firing")),v.error&&P.push((0,t.jsx)(l.E,{color:"red",text:`${v.error} ${a()("error",v.error)}`},"errors")),v.nodata&&P.push((0,t.jsx)(l.E,{color:"blue",text:`${v.nodata} no data`},"nodata")),v[d.$.Pending]&&P.push((0,t.jsx)(l.E,{color:"orange",text:`${v[d.$.Pending]} pending`},"pending")),v[d.$.Normal]&&v.paused&&P.push((0,t.jsx)(l.E,{color:"green",text:`${v[d.$.Normal]} normal (${v.paused} paused)`},"paused")),v[d.$.Normal]&&!v.paused&&P.push((0,t.jsx)(l.E,{color:"green",text:`${v[d.$.Normal]} normal`},"inactive")),v.recording&&P.push((0,t.jsx)(l.E,{color:"purple",text:`${v.recording} recording`},"recording")),P}},80215:(_,L,e)=>{"use strict";e.d(L,{s:()=>ne});var t=e(74848),n=e(32196),r=e(96540),s=e(70255),a=e(40845),g=e(19384),i=e(56034),l=e(15054),d=e(79938),o=e(77583),u=e(24608),c=e(6833),p=e(9518),h=e(83903),y=e(98439),f=e(85244),v=e(55740),P=e(57220),m=e(23662),D=e(75591),x=e(10562),E=e(48205),C=e(82437),b=e(16577),T=e(13064),A=e(35896),R=e(32264),S=e(14578),O=e(82775);function j({rule:he}){const ie=(0,a.of)(B),J=(0,m.lT)(he.rulerRule);return(0,r.useMemo)(()=>J?(0,O.q)(he.group.interval).exceedsLimit:!1,[he.group.interval,J])?(0,t.jsx)(i.m,{theme:"error",content:(0,t.jsxs)("div",{children:["A minimum evaluation interval of"," ",(0,t.jsx)("span",{className:ie.globalLimitValue,children:R.$.unifiedAlerting.minInterval})," has been configured in Grafana and will be used instead of the ",he.group.interval," interval configured for the Rule Group."]}),children:(0,t.jsx)(S.I,{name:"stopwatch-slash",className:ie.icon})}):null}function B(he){return{globalLimitValue:(0,n.css)({fontWeight:he.typography.fontWeightBold}),icon:(0,n.css)({fill:he.colors.warning.text})}}var N=e(75648),I=e(39890);const K=({rule:he})=>{const ie=(0,a.of)(w);return(0,I.lf)(he.health)?(0,t.jsx)(i.m,{theme:"error",content:he.lastError||"No error message provided.",children:(0,t.jsxs)("div",{className:ie.warn,children:[(0,t.jsx)(S.I,{name:"exclamation-triangle"}),(0,t.jsx)("span",{children:"error"})]})}):(0,t.jsx)(t.Fragment,{children:he.health})},w=he=>({warn:(0,n.css)({display:"inline-flex",flexDirection:"row",alignItems:"center",gap:he.spacing(1),color:he.colors.warning.text})});var U=e(70416),W=e(67061),H=e(62930),z=e(8484),G=e(94822),M=e(65415),Q=e(30423);const Y=({rule:he,isDeleting:ie,isCreating:J,isPaused:ce})=>{const pe=(0,a.of)(q),{promRule:Pe,rulerRule:Ie}=he,ge=()=>ce&&(0,m.Gy)(Ie)?(0,t.jsx)(i.m,{content:"Recording rule evaluation is currently paused",placement:"top",children:(0,t.jsxs)(M.O,{state:"warning",children:[(0,t.jsx)(S.I,{name:"pause",size:"xs"}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.paused",children:"Paused"})]})}):(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.recording-rule",children:"Recording rule"}),Se=(0,r.useMemo)(()=>{if(Pe&&(0,m.Z8)(Pe)&&Pe.alerts?.length&&Pe.state!==G.cF.Inactive){const De=Pe.activeAt?new Date(Pe.activeAt):(0,m.Om)(Pe);if(De)return(0,t.jsxs)("span",{title:String(De),className:pe.for,children:["for"," ",(0,U.dU)({start:De,end:new Date},!1)]})}return null},[Pe,pe]);return ie?(0,t.jsxs)(W.B,{gap:1,children:[(0,t.jsx)(H.y,{}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.deleting",children:"Deleting"})]}):J?(0,t.jsxs)(W.B,{gap:1,children:[(0,t.jsx)(H.y,{}),(0,t.jsx)(z.x6,{i18nKey:"alerting.rule-state.creating",children:"Creating"})]}):Pe&&(0,m.Z8)(Pe)?(0,t.jsxs)(W.B,{gap:1,children:[(0,t.jsx)(Q.C,{state:Pe.state,isPaused:ce}),!ce&&Se]}):Pe&&(0,m.KB)(Pe)?(0,t.jsx)(ge,{}):(0,t.jsx)(t.Fragment,{children:"n/a"})},q=he=>({for:(0,n.css)({fontSize:he.typography.bodySmall.fontSize,color:he.colors.text.secondary,whiteSpace:"nowrap",paddingTop:"2px"})}),te=(0,u.w)(),{useLazyGetRuleGroupForNamespaceQuery:X}=d.hK,{useLazyDiscoverDsFeaturesQuery:ee}=o.L,ne=({rules:he,className:ie,showGuidelines:J=!1,emptyMessage:ce="No rules found.",showGroupColumn:pe=!1,showSummaryColumn:Pe=!1,showNextEvaluationColumn:Ie=!1})=>{const ge=(0,a.of)(ae),Se=(0,n.cx)(ge.wrapper,ie,{[ge.wrapperMargin]:J}),{pageItems:De,page:Ke,numberOfPages:Me,onPageChange:be}=(0,y.W)(he,1,l.FG),{result:we,status:Be}=Z(De),He=Be==="loading",Ve=(0,r.useMemo)(()=>we.map((pt,bt)=>({id:`${pt.namespace.name}-${pt.group.name}-${pt.name}-${bt}`,data:pt})),[we]),Je=re(Pe,pe,Ie,He);if(!De.length)return(0,t.jsx)("div",{className:(0,n.cx)(Se,ge.emptyMessage),children:ce});const nt=J?x.B:D.E;return(0,t.jsxs)("div",{className:Se,"data-testid":"rules-table",children:[(0,t.jsx)(nt,{cols:Je,isExpandable:!0,items:Ve,renderExpandedContent:({data:pt})=>(0,t.jsx)(N.DI,{rule:pt})}),(0,t.jsx)(g.d,{currentPage:Ke,numberOfPages:Me,onNavigate:be,hideWhenSinglePage:!0,className:ge.pagination})]})};function Z(he){const[ie]=X(),[J]=ee(),[ce,pe]=(0,c.Yb)(async()=>Promise.all(he.map(async Ie=>{const ge=await J({rulesSourceName:(0,P.EV)(Ie.namespace.rulesSource)},!0).unwrap();if(ge.rulerConfig&&Ie.namespace.rulesSource!==P.hY){const Se=await ie({namespace:Ie.namespace.name,group:Ie.group.name,rulerConfig:ge.rulerConfig},!0).unwrap();(0,p.yh)(Ie,Se)}return Ie})),he);return(0,r.useEffect)(()=>{te?ce.execute():ce.reset()},[he,ce]),pe}const ae=he=>({wrapperMargin:(0,n.css)({[he.breakpoints.up("md")]:{marginLeft:"36px"}}),emptyMessage:(0,n.css)({padding:he.spacing(1)}),wrapper:(0,n.css)({width:"auto",borderRadius:he.shape.radius.default}),skeletonWrapper:(0,n.css)({flex:1}),pagination:(0,n.css)({display:"flex",margin:0,paddingTop:he.spacing(1),paddingBottom:he.spacing(.25),justifyContent:"center",borderLeft:`1px solid ${he.colors.border.medium}`,borderRight:`1px solid ${he.colors.border.medium}`,borderBottom:`1px solid ${he.colors.border.medium}`,float:"none"})});function re(he,ie,J,ce){return(0,r.useMemo)(()=>{const pe=[{id:"state",label:"State",renderCell:({data:Pe})=>(0,t.jsx)(se,{rule:Pe}),size:"165px"},{id:"name",label:"Name",renderCell:({data:Pe})=>Pe.name,size:J?4:5},{id:"metadata",label:"",renderCell:({data:Pe})=>{const Ie=Pe.rulerRule,ge=(0,m.uo)(Pe);return ge?(0,t.jsx)(f.T,{pluginId:ge.pluginId}):(0,m.lT)(Ie)&&Ie.grafana_alert.provenance?(0,t.jsx)(E.rS,{}):null},size:"100px"},{id:"warnings",label:"",renderCell:({data:Pe})=>(0,t.jsx)(j,{rule:Pe}),size:"45px"},{id:"health",label:"Health",renderCell:({data:{promRule:Pe,group:Ie}})=>Pe?(0,t.jsx)(K,{rule:Pe}):null,size:"75px"}];return he&&pe.push({id:"summary",label:"Summary",renderCell:({data:Pe})=>(0,t.jsx)(b.Y,{input:Pe.annotations[v.YH.summary]??""}),size:J?4:5}),J&&pe.push({id:"nextEvaluation",label:"Next evaluation",renderCell:({data:Pe})=>{const Ie=(0,T.C)(Pe.promRule?.lastEvaluation,Pe.group.interval);return Ie&&(0,t.jsx)(i.m,{placement:"top",content:`${Ie?.fullDate}`,theme:"info",children:(0,t.jsx)("span",{children:Ie?.humanized})})},size:2}),ie&&pe.push({id:"group",label:"Group",renderCell:({data:Pe})=>{const{namespace:Ie,group:ge}=Pe;return ge.name==="default"?(0,t.jsx)(C.c,{namespace:Ie.name}):(0,t.jsx)(C.c,{namespace:Ie.name,group:ge.name})},size:5}),pe.push({id:"actions",label:"Actions",renderCell:({data:Pe})=>(0,t.jsx)(de,{rule:Pe,isLoadingRuler:ce}),size:"200px"}),pe},[he,ie,J,ce])}function se({rule:he}){const{isDeleting:ie,isCreating:J,isPaused:ce}=le(he);return(0,t.jsx)(Y,{rule:he,isDeleting:ie,isCreating:J,isPaused:ce})}function de({rule:he,isLoadingRuler:ie}){const J=(0,a.of)(ae),{isDeleting:ce,isCreating:pe}=le(he);return ie?(0,t.jsx)(s.A,{containerClassName:J.skeletonWrapper}):(0,t.jsx)(A.l,{compact:!0,showViewButton:!ce&&!pe,rule:he,rulesSource:he.namespace.rulesSource})}function le(he){const{hasRuler:ie,rulerRulesLoaded:J}=(0,h.y)(he.namespace.rulesSource),{promRule:ce,rulerRule:pe}=he;if(te&&!(0,m.lT)(pe))return{isDeleting:!1,isCreating:!1,isPaused:!1};const Pe=!!(ie&&J&&ce&&!pe),Ie=!!(ie&&J&&pe&&!ce),ge=(0,m.lT)(pe)&&(0,m.HH)(pe);return{isDeleting:Pe,isCreating:Ie,isPaused:ge}}},97754:(_,L,e)=>{"use strict";e.d(L,{y:()=>a});var t=e(74848),n=e(60021),r=e(65415);const s={[n.Or.Active]:"bad",[n.Or.Unprocessed]:"neutral",[n.Or.Suppressed]:"info"},a=({state:g})=>(0,t.jsx)(r.O,{state:s[g],children:g})},98569:(_,L,e)=>{"use strict";e.d(L,{G:()=>se,A:()=>le});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(49785),g=e(54148),i=e(40996),l=e(70416),d=e(47232),o=e(17172),u=e(39601),c=e(32264),p=e(39558),h=e(42418),y=e(40845),f=e(84167),v=e(88575),P=e(10354),m=e(21744),D=e(67061),x=e(55852),E=e(91540),C=e(55740),b=e(57220),T=e(60021),A=e(19073),R=e(98164),S=e(78742),O=e(25994),j=e(90182),B=e(29158),N=e(79938);const I=({className:he,required:ie,ruleUid:J})=>{const ce=(0,y.of)(K),pe=(0,a.xW)(),{control:Pe,register:Ie,formState:{errors:ge}}=pe,{fields:Se=[],append:De,remove:Ke}=(0,a.jz)({name:"matchers"}),[Me,{data:be}]=N.hK.endpoints.getAlertRule.useLazyQuery();return(0,s.useEffect)(()=>{J&&Me({uid:J})},[Me,J]),(0,t.jsx)("div",{className:he,children:(0,t.jsx)(v.D,{label:"Refine affected alerts",required:ie,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:(0,n.cx)(ce.matchers,ce.indent),children:[be&&(0,t.jsxs)("div",{children:[(0,t.jsx)(v.D,{label:"Alert rule",disabled:!0,children:(0,t.jsx)(P.p,{id:"alert-rule-name",defaultValue:be.grafana_alert.title,disabled:!0})}),(0,t.jsx)(O.c,{})]}),Se.map((we,Be)=>(0,t.jsxs)("div",{className:ce.row,"data-testid":"matcher",children:[(0,t.jsx)(v.D,{label:"Label",invalid:!!ge?.matchers?.[Be]?.name,error:ge?.matchers?.[Be]?.name?.message,children:(0,t.jsx)(P.p,{...Ie(`matchers.${Be}.name`,{required:{value:ie,message:"Required."}}),defaultValue:we.name,placeholder:"label",id:`matcher-${Be}-label`})}),(0,t.jsx)(v.D,{label:"Operator",children:(0,t.jsx)(a.xI,{control:Pe,render:({field:{onChange:He,ref:Ve,...Je}})=>(0,t.jsx)(j.l6,{...Je,onChange:nt=>He(nt.value),className:ce.matcherOptions,options:R.xH,"aria-label":"operator",id:`matcher-${Be}-operator`}),defaultValue:we.operator||R.xH[0].value,name:`matchers.${Be}.operator`,rules:{required:{value:ie,message:"Required."}}})}),(0,t.jsx)(v.D,{label:"Value",invalid:!!ge?.matchers?.[Be]?.value,error:ge?.matchers?.[Be]?.value?.message,children:(0,t.jsx)(P.p,{...Ie(`matchers.${Be}.value`,{required:{value:ie,message:"Required."}}),defaultValue:we.value,placeholder:"value",id:`matcher-${Be}-value`})}),(Se.length>1||!ie)&&(0,t.jsx)(B.K,{"aria-label":"Remove matcher",className:ce.removeButton,name:"trash-alt",onClick:()=>Ke(Be),children:"Remove"})]},`${we.id}`))]}),(0,t.jsx)(x.$n,{className:ce.indent,tooltip:"Refine which alert instances are silenced by selecting label matchers",type:"button",icon:"plus",variant:"secondary",onClick:()=>{const we={name:"",value:"",operator:T.ho.equal};De(we)},children:"Add matcher"})]})})})},K=he=>({wrapper:(0,n.css)({marginTop:he.spacing(2)}),row:(0,n.css)({marginTop:he.spacing(1),display:"flex",alignItems:"flex-start",flexDirection:"row",backgroundColor:he.colors.background.secondary,padding:`${he.spacing(1)} ${he.spacing(1)} 0 ${he.spacing(1)}`,"& > * + *":{marginLeft:he.spacing(2)}}),removeButton:(0,n.css)({marginLeft:he.spacing(1),marginTop:he.spacing(2.5)}),matcherOptions:(0,n.css)({minWidth:"140px"}),matchers:(0,n.css)({maxWidth:`${he.breakpoints.values.sm}px`,margin:`${he.spacing(1)} 0`,paddingTop:he.spacing(.5)}),indent:(0,n.css)({marginLeft:he.spacing(2)})}),w=I;var U=e(54230);const W=()=>{const{control:he,getValues:ie}=(0,a.xW)(),{field:{onChange:J,value:ce},fieldState:{invalid:pe}}=(0,a.as)({name:"startsAt",control:he,rules:{validate:we=>ie().endsAt>we}}),{field:{onChange:Pe,value:Ie},fieldState:{invalid:ge}}=(0,a.as)({name:"endsAt",control:he,rules:{validate:we=>ie().startsAt<we}}),{field:{onChange:Se,value:De}}=(0,a.as)({name:"timeZone",control:he}),Ke=pe||ge,Me=(0,d.KQ)(ce),be=(0,d.KQ)(Ie);return(0,t.jsx)(v.D,{className:H.timeRange,label:"Silence start and end",error:Ke?"To is before or the same as from":"",invalid:Ke,children:(0,t.jsx)(U.b,{value:{from:Me,to:be,raw:{from:Me,to:be}},timeZone:De,onChange:we=>{J((0,d.KQ)(we.from)),Pe((0,d.KQ)(we.to))},onChangeTimeZone:we=>Se(we),hideTimeZone:!1,hideQuickRanges:!0,placeholder:"Select time range"})})},H={timeRange:(0,n.css)({width:"400px"})};var z=e(45214),G=e(39938),M=e(82843),Q=e(25968),Y=e(69087),q=e(75591),te=e(97754);const X=(he,ie,J)=>{const[ce,pe]=(0,s.useState)();(0,i.A)(he,ie,[ce]),(0,z.A)(()=>{pe(J)},[J])},ee=({amSourceName:he,matchers:ie,ruleUid:J})=>{const ce=[...J?[{name:C.kW,value:J,operator:T.ho.equal}]:[],...ie].map(R.Wc),pe=M.m.endpoints.getAlertmanagerAlerts.useLazyQuery,Pe=(0,y.of)(Z),Ie=ne(),ge=J||ie.some(we=>we.value&&we.name),[Se,{currentData:De=[],isFetching:Ke,isError:Me}]=pe();if(X(()=>{ge&&Se({amSourceName:he,filter:{matchers:ce}})},500,[he,ce]),Me)return(0,t.jsx)(h.F,{title:"Preview not available",severity:"error",children:"Error occurred when generating preview of affected alerts. Are your matchers valid?"});const be=De.map(we=>({id:we.fingerprint,data:we}));return(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:Pe.title,children:["Affected alert rule instances",be.length>0?(0,t.jsx)(G.E,{className:Pe.badge,color:"blue",text:be.length}):null]}),!ge&&(0,t.jsx)("span",{children:"Add a valid matcher to see affected alerts"}),Ke&&(0,t.jsx)(p._,{text:"Loading affected alert rule instances..."}),!Ke&&!Me&&ge&&(0,t.jsx)("div",{className:Pe.table,children:be.length>0?(0,t.jsx)(q.E,{items:be,isExpandable:!1,cols:Ie,pagination:{itemsPerPage:10}}):(0,t.jsx)("span",{children:"No firing alert instances found"})})]})};function ne(){const he=(0,y.of)(Z);return[{id:"state",label:"State",renderCell:function({data:J}){return(0,t.jsx)(te.y,{state:J.status.state})},size:"120px",className:he.stateColumn},{id:"labels",label:"Labels",renderCell:function({data:J}){return(0,t.jsx)(Y.m,{labels:J.labels,size:"sm"})},size:"auto"},{id:"created",label:"Created",renderCell:function({data:J}){return(0,t.jsx)(t.Fragment,{children:(0,Q.mo)(J.startsAt)?"-":(0,d.KQ)(J.startsAt).format("YYYY-MM-DD HH:mm:ss")})},size:"180px"}]}const Z=he=>({table:(0,n.css)({maxWidth:`${he.breakpoints.values.lg}px`}),moreMatches:(0,n.css)({marginTop:he.spacing(1)}),title:(0,n.css)({display:"flex",alignItems:"center"}),badge:(0,n.css)({marginLeft:he.spacing(1)}),stateColumn:(0,n.css)({display:"flex",alignItems:"center"})});var ae=e(17272);const re=({alertManagerSourceName:he})=>{const{id:ie=""}=(0,g.g)(),{data:J,isLoading:ce,error:pe}=E.F.endpoints.getSilence.useQuery({id:ie,datasourceUid:(0,b.w5)(he),ruleMetadata:!0,accessControl:!0}),Pe=J?.matchers?.find(Ke=>Ke.name===C.kW)?.value,Ie=he===b.hY,ge=(0,s.useMemo)(()=>{if(!J)return;const Ke=J.matchers?.filter(Me=>Me.name!==C.kW);return(0,ae.Ee)({...J,matchers:Ke})},[J]);return ie&&ce?(0,t.jsx)(p._,{text:"Loading existing silence information..."}):(0,o.NF)(pe)&&pe.status===404?(0,t.jsx)(h.F,{title:`Existing silence "${ie}" not found`,severity:"warning"}):(Ie?J?.accessControl?.write:!0)?(0,t.jsx)(se,{ruleUid:Pe,formValues:ge,alertManagerSourceName:he}):(0,t.jsx)(h.F,{title:"You do not have permission to edit/recreate this silence",severity:"error"})},se=({formValues:he=(0,ae.Di)(),alertManagerSourceName:ie,onSilenceCreated:J,onCancel:ce,ruleUid:pe})=>{const[Pe,Ie]=(0,A.L7)(A.QI.PreviewSilencedInstances),ge=Pe&&Ie,[Se,{isLoading:De}]=E.F.endpoints.createSilence.useMutation(),Ke=(0,a.mN)({defaultValues:he}),Me=(0,y.of)(de),{register:be,handleSubmit:we,formState:Be,watch:He,setValue:Ve,clearErrors:Je}=Ke,[nt,pt,bt,Tt]=He(["duration","startsAt","endsAt","matchers"]),ye=()=>{u.Ny.push((0,S.nL)("/alerting/silences",ie))},je=J||ye,ue=ce||ye,Ee=async Ue=>{const{id:fe,startsAt:Te,endsAt:Ge,comment:Qe,createdBy:st,matchers:Xe}=Ue;pe&&Xe.push({name:C.kW,value:pe,operator:T.ho.equal});const ot=Xe.map(R.Wc).filter(_e=>_e.name&&_e.value),ft=(0,r.pickBy)({id:fe,startsAt:Te,endsAt:Ge,comment:Qe,createdBy:st,matchers:ot},_e=>!!_e);await Se({datasourceUid:(0,b.w5)(ie),payload:ft}).unwrap().then(_e=>{je?.(_e)})},[Ce,Ne]=(0,s.useState)(nt);(0,i.A)(()=>{if((0,l.vd)(pt)&&(0,l.vd)(bt))if(nt!==Ce)Ve("endsAt",(0,d.KQ)((0,l.Ri)(new Date(pt),(0,l.E9)(nt))).toISOString()),Ne(nt);else{const Ue=new Date(pt).valueOf();if(new Date(bt).valueOf()>Ue){const Te=(0,l.dU)({start:new Date(pt),end:new Date(bt)});Ve("duration",Te),Ne(Te)}}},700,[Je,nt,bt,Ce,Ve,pt]);const Fe=!!(c.$.bootData.user.isSignedIn&&c.$.bootData.user.name);return(0,t.jsx)(a.Op,{...Ke,children:(0,t.jsxs)("form",{onSubmit:we(Ee),children:[(0,t.jsxs)(f.n,{className:Me.formContainer,children:[(0,t.jsxs)("div",{className:Me.silencePeriod,children:[(0,t.jsx)(W,{}),(0,t.jsx)(v.D,{label:"Duration",invalid:!!Be.errors.duration,error:Be.errors.duration&&(Be.errors.duration.type==="required"?"Required field":Be.errors.duration.message),children:(0,t.jsx)(P.p,{...be("duration",{validate:Ue=>Object.keys((0,l.E9)(Ue)).length===0?"Invalid duration. Valid example: 1d 4h (Available units: y, M, w, d, h, m, s)":void 0}),id:"duration"})})]}),(0,t.jsx)(w,{required:!pe,ruleUid:pe}),(0,t.jsx)(v.D,{label:"Comment",required:!0,error:Be.errors.comment?.message,invalid:!!Be.errors.comment,children:(0,t.jsx)(m.f,{...be("comment",{required:{value:!0,message:"Required."}}),rows:5,placeholder:"Details about the silence",id:"comment"})}),!Fe&&(0,t.jsx)(v.D,{label:"Created By",required:!0,error:Be.errors.createdBy?.message,invalid:!!Be.errors.createdBy,children:(0,t.jsx)(P.p,{...be("createdBy",{required:{value:!0,message:"Required."}}),placeholder:"Who's creating the silence"})}),ge&&(0,t.jsx)(ee,{amSourceName:ie,matchers:Tt,ruleUid:pe})]}),(0,t.jsxs)(D.B,{gap:1,children:[De&&(0,t.jsx)(x.$n,{disabled:!0,icon:"spinner",variant:"primary",children:"Saving..."}),!De&&(0,t.jsx)(x.$n,{type:"submit",children:"Save silence"}),(0,t.jsx)(x.z9,{onClick:ue,variant:"secondary",children:"Cancel"})]})]})})},de=he=>({formContainer:(0,n.css)({maxWidth:he.breakpoints.values.md}),alertRule:(0,n.css)({paddingBottom:he.spacing(2)}),silencePeriod:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-start",gap:he.spacing(1),maxWidth:he.breakpoints.values.sm,paddingTop:he.spacing(2)})}),le=re},17272:(_,L,e)=>{"use strict";e.d(L,{Di:()=>u,Ee:()=>o,LP:()=>d});var t=e(70416),n=e(43127),r=e(47232),s=e(32264),a=e(98164),g=e(55740),i=e(32642),l=e(60021);const d=c=>{const p={},h=c.get("comment"),f=c.getAll("matcher").filter(P=>!P.startsWith(g.kW)),v=(0,i.ou)(f);return v.length&&(p.matchers=v.map(a.MU)),h&&(p.comment=h),p},o=c=>{const p=new Date,y=Date.parse(c.endsAt)<Date.now()?{start:p,end:(0,t.Ri)(p,{hours:2})}:{start:new Date(c.startsAt),end:new Date(c.endsAt)};return{id:c.id,startsAt:y.start.toISOString(),endsAt:y.end.toISOString(),comment:c.comment,createdBy:c.createdBy,duration:(0,t.dU)(y),isRegex:!1,matchers:c.matchers?.map(a.MU)||[],matcherName:"",matcherValue:"",timeZone:n.lE}},u=c=>{const p=new Date,h=(0,t.Ri)(p,{hours:2});return{id:"",startsAt:p.toISOString(),endsAt:h.toISOString(),comment:`created ${(0,r.KQ)().format("YYYY-MM-DD HH:mm")}`,createdBy:s.$.bootData.user.name,duration:"2h",isRegex:!1,matcherName:"",matcherValue:"",timeZone:n.lE,matchers:[{name:"",value:"",operator:l.ho.equal}],...c}}},24608:(_,L,e)=>{"use strict";e.d(L,{w:()=>n});var t=e(32264);const n=()=>t.$.featureToggles.alertingPrometheusRulesPrimary??!1},96065:(_,L,e)=>{"use strict";e.d(L,{Y:()=>g});var t=e(8484),n=e(79938),r=e(48070),s=e(6833),a=e(43482);function g(){const[i]=(0,a.D)(),[l]=n.hK.endpoints.upsertRuleGroupForNamespace.useMutation(),[d]=n.hK.endpoints.deleteRuleGroupFromNamespace.useMutation();return(0,s.Yb)(async(o,u)=>{const{groupName:c,namespaceName:p}=o,h=(0,r.KH)({identifier:u}),{newRuleGroupDefinition:y,rulerConfig:f}=await i(o,h),v=(0,t.t)("alerting.rules.delete-rule.success","Rule successfully deleted");return y.rules.length===0?d({rulerConfig:f,namespace:p,group:c,notificationOptions:{successMessage:v}}).unwrap():l({rulerConfig:f,namespace:p,payload:y,notificationOptions:{successMessage:v}}).unwrap()})}},43482:(_,L,e)=>{"use strict";e.d(L,{D:()=>d,_:()=>l});var t=e(79938),n=e(77583),r=e(53270),s=e(48070),a=e(63066);const{useLazyGetRuleGroupForNamespaceQuery:g}=t.hK,{useLazyDiscoverDsFeaturesQuery:i}=n.L,l=u=>new Error(`DataSource ${u} does not support ruler API or does not have the ruler API enabled.`);function d(){const[u,c]=g(),[p]=i();return[async(y,f)=>{const{dataSourceName:v,groupName:P,namespaceName:m}=y,{rulerConfig:D}=await p({rulesSourceName:v}).unwrap();if(!D)throw l(v);const x=await u({rulerConfig:D,namespace:m,group:P,notificationOptions:{showErrorAlert:!1}}).unwrap().catch(r.R);return{newRuleGroupDefinition:(0,s.i3)(x??o(y.groupName),f),rulerConfig:D}},c]}const o=u=>({name:u,interval:a.T6,rules:[]})},86783:(_,L,e)=>{"use strict";e.d(L,{G:()=>r});var t=e(96540),n=e(23662);function r(s){return(0,t.useMemo)(()=>(0,n.fC)(s),[s])}},19073:(_,L,e)=>{"use strict";e.d(L,{Ej:()=>m,Hl:()=>T,L7:()=>b,QI:()=>p,RY:()=>y,e2:()=>P,iI:()=>C,j5:()=>h,mh:()=>D});var t=e(96540),n=e(16233),r=e(11167),s=e(60021),a=e(31678),g=e(82843),i=e(70383),l=e(75471),d=e(57220),o=e(78742),u=e(23662),c=e(97009),p=(S=>(S.ViewExternalConfiguration="view-external-configuration",S.UpdateExternalConfiguration="update-external-configuration",S.CreateContactPoint="create-contact-point",S.ViewContactPoint="view-contact-point",S.UpdateContactPoint="edit-contact-points",S.DeleteContactPoint="delete-contact-point",S.ExportContactPoint="export-contact-point",S.CreateNotificationTemplate="create-notification-template",S.ViewNotificationTemplate="view-notification-template",S.UpdateNotificationTemplate="edit-notification-template",S.DeleteNotificationTemplate="delete-notification-template",S.DecryptSecrets="decrypt-secrets",S.CreateNotificationPolicy="create-notification-policy",S.ViewNotificationPolicyTree="view-notification-policy-tree",S.UpdateNotificationPolicyTree="update-notification-policy-tree",S.DeleteNotificationPolicy="delete-notification-policy",S.ExportNotificationPolicies="export-notification-policies",S.ViewAutogeneratedPolicyTree="view-autogenerated-policy-tree",S.CreateSilence="create-silence",S.ViewSilence="view-silence",S.UpdateSilence="update-silence",S.PreviewSilencedInstances="preview-silenced-alerts",S.ViewMuteTiming="view-mute-timing",S.CreateMuteTiming="create-mute-timing",S.UpdateMuteTiming="update-mute-timing",S.DeleteMuteTiming="delete-mute-timing",S.ExportMuteTimings="export-mute-timings",S))(p||{}),h=(S=>(S.Duplicate="duplicate-alert-rule",S.View="view-alert-rule",S.Update="update-alert-rule",S.Delete="delete-alert-rule",S.Explore="explore-alert-rule",S.Silence="silence-alert-rule",S.ModifyExport="modify-export-rule",S.Pause="pause-alert-rule",S))(h||{}),y=(S=>(S.CreateAlertRule="create-alert-rule",S.ViewAlertRule="view-alert-rule",S.UpdateAlertRule="update-alert-rule",S.DeleteAlertRule="delete-alert-rule",S.ExportGrafanaManagedRules="export-grafana-managed-rules",S.ReadConfigurationStatus="read-configuration-status",S.CreateExternalAlertRule="create-external-alert-rule",S.ViewExternalAlertRule="view-external-alert-rule",S.UpdateExternalAlertRule="update-external-alert-rule",S.DeleteExternalAlertRule="delete-external-alert-rule",S))(y||{});const f=!0,v=!1,P=()=>({"create-alert-rule":R(f,a.AccessControlAction.AlertingRuleCreate),"view-alert-rule":R(f,a.AccessControlAction.AlertingRuleRead),"update-alert-rule":R(f,a.AccessControlAction.AlertingRuleUpdate),"delete-alert-rule":R(f,a.AccessControlAction.AlertingRuleDelete),"export-grafana-managed-rules":R(f,a.AccessControlAction.AlertingRuleRead),"read-configuration-status":[f,n.TP.hasPermission(a.AccessControlAction.AlertingInstanceRead)||n.TP.hasPermission(a.AccessControlAction.AlertingNotificationsRead)],"create-external-alert-rule":R(f,a.AccessControlAction.AlertingRuleExternalWrite),"view-external-alert-rule":R(f,a.AccessControlAction.AlertingRuleExternalRead),"update-external-alert-rule":R(f,a.AccessControlAction.AlertingRuleExternalWrite),"delete-external-alert-rule":R(f,a.AccessControlAction.AlertingRuleExternalWrite)}),m=S=>P()[S];function D(S,O){const j=E(S);return(0,t.useMemo)(()=>j[O],[j,O])}function x(S,O){const j=E(S);return useMemo(()=>O.map(B=>j[B]),[j,O])}function E(S){const O=(0,d.EV)(S.namespace.rulesSource),{isEditable:j,isRemovable:B,isRulerAvailable:N=!1,loading:I}=(0,c.g)(O,S.rulerRule),[K,w]=m("export-grafana-managed-rules"),U=A(S);return(0,t.useMemo)(()=>{const H=(0,u.lT)(S.rulerRule)&&!!S.rulerRule.grafana_alert.provenance,z=(0,u.YN)(S.group),G=(0,u.lT)(S.rulerRule),M=(0,u.Tm)(S),Q=H||z||M,Y=I?v:N,q=Q?v:Y,te=M?v:Y,X=(0,l.Wd)(O);return{"duplicate-alert-rule":R(te,X.create),"view-alert-rule":R(f,X.read),"update-alert-rule":[q,j??!1],"delete-alert-rule":[q,B??!1],"explore-alert-rule":R(f,a.AccessControlAction.DataSourcesExplore),"silence-alert-rule":U,"modify-export-rule":[G,w],"pause-alert-rule":[q&&G,j??!1]}},[S,I,N,j,B,O,w,U])}function C(){const{selectedAlertmanager:S,hasConfigurationAPI:O,isGrafanaAlertmanager:j}=(0,i.VI)(),B=(0,l.lV)(S),N=(0,l.jy)(S);return{"view-external-configuration":R(f,a.AccessControlAction.AlertingNotificationsExternalRead),"update-external-configuration":R(O,a.AccessControlAction.AlertingNotificationsExternalWrite),"create-contact-point":R(O,B.create,j?a.AccessControlAction.AlertingReceiversCreate:null),"view-contact-point":R(f,B.read),"edit-contact-points":R(O,B.update),"delete-contact-point":R(O,B.delete),"export-contact-point":[j,j],"create-notification-template":R(O,B.create),"view-notification-template":R(f,B.read),"edit-notification-template":R(O,B.update),"delete-notification-template":R(O,B.delete),"create-notification-policy":R(O,B.create),"view-notification-policy-tree":R(f,B.read),"update-notification-policy-tree":R(O,B.update),"delete-notification-policy":R(O,B.delete),"export-notification-policies":R(j,B.read),"decrypt-secrets":R(j,B.provisioning.readSecrets),"view-autogenerated-policy-tree":[j,(0,o.qc)()],"create-silence":R(f,N.create),"view-silence":R(f,N.read),"update-silence":R(f,N.update),"preview-silenced-alerts":R(f,N.read),"create-mute-timing":R(O,B.create),"view-mute-timing":R(f,B.read),"update-mute-timing":R(O,B.update),"delete-mute-timing":R(O,B.delete),"export-mute-timings":R(j,B.read)}}function b(S){const O=C();return(0,t.useMemo)(()=>O[S],[O,S])}function T(S){const O=C();return(0,t.useMemo)(()=>S.map(j=>O[j]),[O,S])}function A(S){const j=S.namespace.rulesSource===d.hY,B=(0,u.Gy)(S.rulerRule),{currentData:N,isLoading:I}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery(void 0,{skip:!j}),K=(0,u.lT)(S.rulerRule)?S.rulerRule.grafana_alert.namespace_uid:void 0,{loading:w,folder:U}=(0,r.a)(K);if(!j||B||I||w||!U)return[!1,!1];const W=N?.alertmanagersChoice===s.nA.External,H=N?.alertmanagersChoice===s.nA.All,z=!W||H,{accessControl:G={}}=U,M=!!(n.TP.hasPermission(a.AccessControlAction.AlertingInstanceCreate)||G[a.AccessControlAction.AlertingSilenceCreate]);return[z,M]}const R=(S,...O)=>[S,O.some(j=>j&&n.TP.hasPermission(j))]},62190:(_,L,e)=>{"use strict";e.d(L,{W:()=>r});var t=e(96540),n=e(57220);function r(s){return(0,t.useMemo)(()=>(0,n.sq)(s),[s])}},36135:(_,L,e)=>{"use strict";e.d(L,{g:()=>s});var t=e(96540),n=e(19347),r=e(26657);function s(a){return{allDataSourcesAvailable:(0,t.useMemo)(()=>a.filter(i=>!(0,r.s9)(i.datasourceUid)).every(i=>!!(0,n.l)().getInstanceSettings(i.datasourceUid)),[a])}}},6833:(_,L,e)=>{"use strict";e.d(L,{Gz:()=>o,VP:()=>d,Yb:()=>s});var t=e(74848),n=e(96540),r=e(78742);function s(c,p){const[h,y]=(0,n.useState)({status:"not-executed",error:void 0,result:p}),f=(0,n.useRef)(),v=(0,n.useRef)(),P=a({execute(...m){v.current=m;const D=c(...m);return f.current=D,y(x=>({...x,status:"loading"})),D.then(x=>{D===f.current&&y(E=>({...E,status:"success",error:void 0,result:x}))},x=>{D===f.current&&y(E=>({...E,status:"error",error:x}))}),D},reset(){y({status:"not-executed",error:void 0,result:p}),f.current=void 0,v.current=void 0}});return[(0,n.useMemo)(()=>({reset(){P.current.reset()},execute:(...m)=>P.current.execute(...m)}),[]),h,{promise:f.current,lastArgs:v.current}]}function a(c){const p=(0,n.useRef)(c);return p.current=c,(0,n.useMemo)(()=>Object.freeze({get current(){return p.current}}),[])}function g(c){return c.status==="error"}function i(c){return c.status==="success"}function l(c){return c.status==="not-executed"}function d(c){return c.status==="loading"}function o(...c){return{uninitialized:c.every(l),loading:c.some(d),error:c.find(g)?.error,success:c.some(i)}}function u({state:c}){return jsxs(Fragment,{children:[l(c)&&"uninitialized",d(c)&&"loading",i(c)&&"success",i(c)&&`result: ${JSON.stringify(c.result,null,2)}`,g(c)&&`error: ${stringifyErrorLike(c.error)}`]})}},730:(_,L,e)=>{"use strict";e.d(L,{Ll:()=>h,O3:()=>y,ZU:()=>u,we:()=>o});var t=e(96540),n=e(16817),r=e(57220),s=e(79938),a=e(77583),g=e(18461),i=e(23662),l=e(9518),d=e(11167);function o(f,v,P){const m=(0,r.oh)(v),{dsFeatures:D,isLoadingDsFeatures:x}=y(v),{currentData:E,isLoading:C,error:b}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:v,ruleName:f,namespace:P?.namespace,groupName:P?.groupName}),[T]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery(),{loading:A,error:R,value:S}=(0,n.A)(async()=>{if(!m)throw new Error("Unable to obtain data source settings");if(b)throw new Error("Unable to obtain Prometheus rules");const O=E||[],j=[];if(D?.rulerConfig){const I=D.rulerConfig,K=O.map(w=>w.groups.map(U=>({namespace:w,group:U}))).flat();await Promise.allSettled(K.map(async w=>{const U=await T({rulerConfig:I,namespace:w.namespace.name,group:w.group.name}).unwrap();j.push(U)}))}return O.map(I=>(0,l.O6)(m,I,j)).flatMap(I=>I.groups.flatMap(K=>K.rules))},[m,D,C,b,E,T]);return{loading:x||A,error:R,rules:S}}function u({ruleIdentifier:f,limitAlerts:v}){const{ruleSourceName:P}=f,m=p(f),{dsFeatures:D,isLoadingDsFeatures:x}=y(P),{loading:E,error:C,result:b}=c(f),{currentData:T=[],isLoading:A,error:R}=s.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:f.ruleSourceName,namespace:b?.namespace,groupName:b?.group,ruleName:b?.ruleName,limitAlerts:v},{skip:!b||E,refetchOnMountOrArgChange:!0}),S=(0,r.z2)(P),O=(0,d.a)(S?b?.namespace:void 0),j=S&&O.folder?(0,d.W)(O.folder):b?.namespace,[B,{currentData:N,isLoading:I,error:K}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!D?.rulerConfig||!b||B({rulerConfig:D.rulerConfig,namespace:b.namespace,group:b.group})},[D,B,b]);const w=(0,t.useMemo)(()=>{if(!m||!b)return;const U=N&&j?{[j]:[N]}:{};return(0,l.gt)(m,T,U).flatMap(G=>G.groups).flatMap(G=>G.rules).find(G=>g.LC(g.UP(P,G),f))},[f,P,T,N,m,b,j]);return{loading:x||A||I,error:C??R??K,result:w}}function c(f){const{isLoading:v,currentData:P,error:m,isUninitialized:D}=s.hK.endpoints.getAlertRule.useQuery({uid:(0,i.A4)(f)?f.uid:""},{skip:!(0,i.A4)(f),refetchOnMountOrArgChange:!0});return(0,t.useMemo)(()=>(0,i.Mj)(f)||(0,i.X4)(f)?{result:{datasource:f.ruleSourceName,namespace:f.namespace,group:f.groupName,ruleName:f.ruleName},loading:!1}:(0,i.A4)(f)?v||D?{loading:!0}:m?{loading:!1,error:m}:P?{result:{datasource:f.ruleSourceName,namespace:P.grafana_alert.namespace_uid,group:P.grafana_alert.rule_group,ruleName:P.grafana_alert.title},loading:!1}:{loading:!1,error:new Error(`Unable to obtain rule location for rule ${f.uid}`)}:{loading:!1,error:new Error("Unsupported rule identifier")},[f,v,D,m,P])}function p(f){return(0,i.A4)(f)?"grafana":(0,r.oh)(f.ruleSourceName)}function h({ruleIdentifier:f}){const v=p(f),{dsFeatures:P,isLoadingDsFeatures:m}=y(f.ruleSourceName),{loading:D,error:x,result:E}=c(f),[C,{currentData:b,isLoading:T,isUninitialized:A,error:R}]=s.hK.endpoints.getRuleGroupForNamespace.useLazyQuery();(0,t.useEffect)(()=>{!P?.rulerConfig||!E||C({rulerConfig:P.rulerConfig,namespace:E.namespace,group:E.group})},[P,C,E]);const S=(0,t.useMemo)(()=>{const{ruleSourceName:O}=f;if(!b||!v||!E)return;const j=b.rules.find(B=>{const N=g.P1(O,E.namespace,E.group,B);return g.LC(N,f)});if(j)return{ruleSourceName:O,group:b,namespace:E.namespace,rule:j}},[f,b,v,E]);return{loading:D||m||T||A,error:x??R,result:S}}function y(f){const{currentData:v,isLoading:P}=a.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:f});return{isLoadingDsFeatures:P,dsFeatures:v}}},9518:(_,L,e)=>{"use strict";e.d(L,{Jr:()=>P,NW:()=>C,O6:()=>y,Tj:()=>b,Ug:()=>E,dy:()=>p,gt:()=>h,kU:()=>j,yh:()=>f});var t=e(2543),n=e.n(t),r=e(96540),s=e(21460),a=e(94822),g=e(79938),i=e(77583),l=e(55740),d=e(57220),o=e(18461),u=e(23662),c=e(61410);function p(B,N){const I=(0,c.$)(W=>W.promRules),K=(0,c.$)(W=>W.rulerRules),w=(0,r.useRef)({}),U=(0,r.useMemo)(()=>{if(B){const W=(0,d.Zw)(B);if(!W)throw new Error(`Unknown rules source: ${B}`);return[W]}return(0,d.lS)()},[B]);return(0,r.useMemo)(()=>U.map(W=>{const H=(0,d.Eb)(W)?W.name:W,z=K[H]?.result;let G=I[H]?.result;H===d.hY&&N&&(G=N);const M=w.current[H];if(M&&M.promRules===G&&M.rulerRules===z)return M.result;const Q={};Object.entries(z||{}).forEach(([q,te])=>{const X={rulesSource:W,name:q,groups:[]};(0,u.lT)(te[0].rules[0])&&(X.uid=te[0].rules[0].grafana_alert.namespace_uid),Q[q]=X,D(X,te)}),G?.forEach(({name:q,groups:te})=>{const X=Q[q]=Q[q]||{rulesSource:W,name:q,groups:[]};x(X,te)});const Y=Object.values(Q);return w.current[H]={promRules:G,rulerRules:z,result:Y},Y}).flat(),[I,K,U,N])}function h(B,N,I){const K={};return Object.entries(I||{}).forEach(([w,U])=>{const W={rulesSource:B,name:w,groups:[]};K[w]=W,D(W,U)}),N?.forEach(({name:w,groups:U})=>{const W=K[w]=K[w]||{rulesSource:B,name:w,groups:[]};x(W,U)}),Object.values(K)}function y(B,N,I){const K={rulesSource:B,name:N.name,groups:[]};return D(K,I),x(K,N.groups),K.groups.forEach(w=>{w.rules=w.rules.filter(U=>U.promRule)}),K}function f(B,N){if(!B.promRule)return;const K=N.rules.map(U=>R(U,B.namespace,B.group)).reduce((U,W)=>{const H=U.get(W.name);return H?H.push(W):U.set(W.name,[W]),U},new Map),w=S(B.promRule,K,B.namespace.rulesSource);w&&(B.rulerRule=w.rulerRule,B.query=w.query,B.labels=w.labels,B.annotations=w.annotations)}function v(B,N,I){return D(B,I),x(B,N),B}function P(B){return B.map(N=>{const I={...N,groups:[]};return I.groups.push({name:"default",rules:m(N.groups.flatMap(K=>K.rules)),totals:T(N.groups)}),I})}function m(B){return B.sort((N,I)=>N.name.localeCompare(I.name))}function D(B,N=[]){B.groups=N.map(I=>{const K=I.rules.filter(W=>(0,u.i7)(W)).length,w=I.rules.filter(W=>(0,u.lT)(W)&&W.grafana_alert.is_paused).length,U={name:I.name,interval:I.interval,source_tenants:I.source_tenants,rules:[],totals:{paused:w,recording:K}};return U.rules=I.rules.map(W=>R(W,B,U)),U})}function x(B,N){const I=new Map;B.groups.forEach(K=>I.set(K.name,K)),N.forEach(K=>{let w=I.get(K.name);w||(w={name:K.name,rules:[],totals:b(K)},B.groups.push(w),I.set(K.name,w)),w.totals={...w.totals,...b(K)};const U=new Map;w.rules.forEach(W=>{const H=U.get(W.name);H?H.push(W):U.set(W.name,[W])}),(K.rules??[]).forEach(W=>{const H=S(W,U,B.rulesSource);H?(H.promRule=W,H.instanceTotals=(0,u.Z8)(W)?E(W):{},H.filteredInstanceTotals=(0,u.Z8)(W)?C(W):{}):w.rules.push(A(W,B,w))})})}function E(B){const N=(0,t.countBy)(B.alerts,"state");if(B.totals){const{normal:I,...K}=B.totals;return{...K,inactive:I}}return{alerting:N[s.$.Alerting]||N.firing,pending:N[s.$.Pending],inactive:N[s.$.Normal],nodata:N[s.$.NoData],error:N[s.$.Error]||N.err||void 0}}function C(B){if(B.totalsFiltered){const{normal:N,...I}=B.totalsFiltered;return{...I,inactive:N}}return{}}function b(B){if(B.totals){const{firing:w,...U}=B.totals;return{...U,alerting:w}}const N=(0,t.countBy)(B.rules,w=>(0,u.Z8)(w)&&w.state),I=(0,t.countBy)(B.rules,w=>w.health),K=B.rules.filter(w=>(0,u.KB)(w)).length;return{alerting:N[a.cF.Firing],error:I.error,nodata:I.nodata,inactive:N[a.cF.Inactive],pending:N[a.cF.Pending],recording:K}}function T(B){const N={};return B.forEach(I=>{const K=I.totals;Object.entries(K).forEach(([w,U])=>{N[w]||(N[w]=0),N[w]+=U})}),N}function A(B,N,I){return{name:B.name,query:B.query,labels:B.labels||{},annotations:(0,u.Z8)(B)?B.annotations||{}:{},promRule:B,namespace:N,group:I,instanceTotals:(0,u.Z8)(B)?E(B):{},filteredInstanceTotals:(0,u.Z8)(B)?C(B):{}}}function R(B,N,I){return(0,u.$y)(B)?{name:B.alert,query:B.expr,labels:B.labels||{},annotations:B.annotations||{},rulerRule:B,namespace:N,group:I,instanceTotals:{},filteredInstanceTotals:{}}:(0,u.i7)(B)?{name:B.record,query:B.expr,labels:B.labels||{},annotations:{},rulerRule:B,namespace:N,group:I,instanceTotals:{},filteredInstanceTotals:{}}:{name:B.grafana_alert.title,query:"",labels:B.labels||{},annotations:B.annotations||{},rulerRule:B,namespace:N,group:I,instanceTotals:{},filteredInstanceTotals:{}}}function S(B,N,I){const K=N.get(B.name);if(!K)return;if((0,d.z2)(I))return K[0];const w=K.find(W=>!W.promRule&&O(W,B,!0));if(w)return w;const U=K.find(W=>!W.promRule&&O(W,B,!1));if(U)return U}function O(B,N,I=!0){return B.name===N.name?(0,t.isEqual)([I?(0,o.h1)(B.query):"",B.labels,B.annotations],[I?(0,o.h1)(N.query):"",N.labels||{},(0,u.Z8)(N)?N.annotations||{}:{}]):!1}function j(B,N,I){const{currentData:K,isLoading:w,error:U}=g.hK.endpoints.prometheusRuleNamespaces.useQuery({ruleSourceName:d.hY,dashboardUid:B??void 0,panelId:N},{skip:B===null,pollingInterval:I?l.HH:void 0}),{currentData:W,isLoading:H,error:z}=g.hK.endpoints.rulerRules.useQuery({rulerConfig:i.b,filter:{dashboardUID:B??void 0,panelId:N}},{pollingInterval:I?l.HH:void 0,skip:B===null}),G=(0,r.useRef)({}),M=(0,d.Zw)(d.hY),Q=(0,r.useMemo)(()=>{if(!M)return[];const Y=G.current[d.hY];if(Y&&Y.promRules===K&&Y.rulerRules===W)return Y.result;const q={};Object.entries(W||{}).forEach(([X,ee])=>{const ne={rulesSource:M,name:X,groups:[]};(0,u.lT)(ee[0].rules[0])&&(ne.uid=ee[0].rules[0].grafana_alert.namespace_uid),q[X]=ne,D(ne,ee)}),K?.forEach(({name:X,groups:ee})=>{const ne=q[X]=q[X]||{rulesSource:M,name:X,groups:[]};x(ne,ee)});const te=Object.values(q);return G.current[d.hY]={promRules:K,rulerRules:W,result:te},te},[K,W,M]);return{loading:w||H,error:U??z,result:Q}}},14285:(_,L,e)=>{"use strict";e.d(L,{dI:()=>x,i7:()=>E});var t=e(53076),n=e(1932),r=e(2543),s=e.n(r),a=e(96540),g=e(19347),i=e(94822),l=e(25027),d=e(28475),o=e(98164),u=e(55740),c=e(57220),p=e(32642),h=e(23662),y=e(9518),f=e(39964);const v=25,P=1/0,m=new Error("Failed to search rules"),D=j=>j.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");function x(){const[j,B]=(0,f.l)(),N=j.get("search")??"",I=(0,a.useMemo)(()=>(0,d.XY)(N),[N]),K=(0,a.useMemo)(()=>Object.values(I).some(W=>!(0,r.isEmpty)(W)),[I]),w=(0,a.useCallback)(W=>{const H=(0,d.kL)(N,W);B({search:H})},[N,B]),U=(0,a.useCallback)(W=>{B({search:W})},[B]);return(0,a.useEffect)(()=>{const W={dataSource:j.get("dataSource")??void 0,alertState:j.get("alertState")??void 0,ruleType:j.get("ruleType")??void 0,labels:(0,p.S6)(j.get("queryString")??"").map(o.MU)};Object.values(W).some(z=>!(0,r.isEmpty)(z))&&(B({dataSource:void 0,alertState:void 0,ruleType:void 0,queryString:void 0}),w((0,n.jM)(I,z=>{if(z.dataSourceNames??=W.dataSource?[W.dataSource]:[],W.alertState&&(0,i.Si)(W.alertState)&&(z.ruleState??=W.alertState),W.ruleType&&(0,h.nf)(W.ruleType)&&(z.ruleType??=W.ruleType),z.labels.length===0&&W.labels.length>0){const G=W.labels.map(({name:M,operator:Q,value:Y})=>`${M}${Q}${Y}`);z.labels.push(...G)}})))},[j,w,I,B]),{filterState:I,hasActiveFilters:K,searchQuery:N,setSearchQuery:U,updateFilters:w}}const E=(j,B)=>{const N=(0,a.useDeferredValue)(j),I=(0,a.useDeferredValue)(B);return(0,a.useMemo)(()=>{const K=C(N,I);return K.forEach(w=>{w.groups.forEach(U=>{U.rules.forEach(W=>{(0,h.Z8)(W.promRule)&&(W.instanceTotals=(0,y.Ug)(W.promRule),W.filteredInstanceTotals=(0,y.NW)(W.promRule))}),U.totals=(0,y.Tj)({rules:U.rules.map(W=>W.promRule).filter(W=>!!W)})})}),K},[N,I])},C=(j,B={dataSourceNames:[],labels:[],freeFormWords:[]})=>{let N=j;const I=B.dataSourceNames;I.length&&(N=N.filter(({rulesSource:U})=>(0,c.Eb)(U)?I.includes(U.name):!0));const K=B.namespace;if(K){const U=N.map(Q=>Q.name),W=D(K),H=S(K),[z,G,M]=H.search(U,W,A(K),P);G&&M?N=M.map(Q=>N[G.idx[Q]]):z&&(N=z.map(Q=>N[Q]))}const w=[];try{N.reduce(b(B),[]).forEach(W=>{w.push(W)})}catch{(0,l.vV)(m,{search:JSON.stringify(B)})}return w},b=j=>(B,N)=>{const I=j.groupName;let K=N.groups;if(I){const w=K.map(M=>M.name),U=S(I),W=D(I),[H,z,G]=U.search(w,W,A(I),P);z&&G?K=G.map(M=>K[z.idx[M]]):H&&(K=H.map(M=>K[M]))}return K=K.reduce(T(j),[]),K.length&&B.push({...N,groups:K}),B},T=j=>{const B=j.ruleName??j.freeFormWords.join(" ");return(N,I)=>{let K=I.rules;if(B){const w=K.map(M=>M.name),U=S(B),W=D(B),[H,z,G]=U.search(w,W,A(B),P);z&&G?K=G.map(M=>K[z.idx[M]]):H&&(K=H.map(M=>K[M]))}return K=K.filter(w=>{const U=w.promRule,W=(0,r.chain)(j).pick(["ruleType","dataSourceNames","ruleHealth","labels","ruleState","dashboardUid","plugins","contactPoint"]).omitBy(r.isEmpty).mapValues(()=>!1).value();if("ruleType"in W&&j.ruleType===U?.type&&(W.ruleType=!0),"plugins"in W&&j.plugins==="hide"&&(W.plugins=!(0,h.Tm)(w)),"contactPoint"in W){const H=j.contactPoint;(0,h.lT)(w.rulerRule)&&w.rulerRule.grafana_alert.notification_settings?.receiver===H&&(W.contactPoint=!0)}if("dataSourceNames"in W&&((0,h.lT)(w.rulerRule)?O(w.rulerRule,j)&&(W.dataSourceNames=!0):W.dataSourceNames=!0),"ruleHealth"in j&&U){const H=(0,h.f6)(U.health);j.ruleHealth===H&&(W.ruleHealth=!0)}if("labels"in W){const H=(0,r.compact)(j.labels.map(R)),z=H.length>0&&(0,o.Av)(w.labels,H),G=H.length>0&&U&&U.type===i.JS.Alerting&&U.alerts&&U.alerts.some(M=>(0,o.Av)(M.labels,H));(z||G)&&(W.labels=!0)}if("ruleState"in W){const H=w.promRule;H&&(0,h.Z8)(H)&&H.state===j.ruleState&&(W.ruleState=!0)}return"dashboardUid"in W&&w.annotations[u.YH.dashboardUID]===j.dashboardUid&&(W.dashboardUid=!0),Object.values(W).every(H=>H===!0)}),K.length&&N.push({...I,rules:K}),N}};function A(j){return S(j).split(j).length<5?4:0}function R(j){try{return(0,p.qR)(j)}catch{return{name:j,value:"",isRegex:!0,isEqual:!0}}}function S(j){const B=j.length>v;return new t.A({intraMode:B?0:1,interSplit:"\\s+"})}const O=(j,B)=>B.dataSourceNames?.length?!!j.grafana_alert.data.find(N=>{if(!N.datasourceUid)return!1;const I=(0,g.l)().getInstanceSettings(N.datasourceUid);return I?.name&&B?.dataSourceNames?.includes(I.name)}):!0},11167:(_,L,e)=>{"use strict";e.d(L,{W:()=>i,a:()=>g});var t=e(96540),n=e(31678),r=e(26627),s=e(88467),a=e(61410);function g(l){const d=(0,n.useDispatch)(),o=(0,a.$)(u=>u.folders);if((0,t.useEffect)(()=>{l&&d((0,r.Om)(l))},[d,l]),l){const u=o[l]||s.jA;return{folder:u.result,loading:u.loading}}return{loading:!1}}function i({title:l,parents:d}){return d&&d?.length?[...d.map(o=>o.title),l].join("/"):l}},83903:(_,L,e)=>{"use strict";e.d(L,{y:()=>a});var t=e(77583),n=e(57220),r=e(61410);const{useDiscoverDsFeaturesQuery:s}=t.L;function a(g){const i=(0,r.$)(c=>c.rulerRules),l=(0,n.EV)(g),{currentData:d}=s({rulesSourceName:l}),o=!!d?.rulerConfig,u=!!i[l]?.result;return{hasRuler:o,rulerRulesLoaded:u}}},97009:(_,L,e)=>{"use strict";e.d(L,{g:()=>i});var t=e(16233),n=e(77583),r=e(75471),s=e(23662),a=e(11167),g=e(61410);function i(l,d){const o=(0,g.$)(D=>D.dataSources),{currentData:u,isLoading:c}=n.L.endpoints.discoverDsFeatures.useQuery({rulesSourceName:l}),p=d&&(0,s.lT)(d)?d.grafana_alert.namespace_uid:void 0,h=(0,r.Wd)(l),{folder:y,loading:f}=(0,a.a)(p);if(!d)return{isEditable:!1,isRemovable:!1,loading:!1};if((0,s.lT)(d)){if(!p)throw new Error(`Rule ${d.grafana_alert.title} does not have a folder uid, cannot determine if it is editable.`);if(!y)return{isRulerAvailable:!0,isEditable:!1,isRemovable:!1,loading:f};const D=t.TP.hasPermissionInMetadata(h.update,y),x=t.TP.hasPermissionInMetadata(h.delete,y);return{isRulerAvailable:!0,isEditable:D,isRemovable:x,loading:f||c}}const v=!!o[l]?.result?.rulerConfig||!!u?.rulerConfig,P=t.TP.hasPermission(h.update),m=t.TP.hasPermission(h.delete);return{isRulerAvailable:v,isEditable:P&&v,isRemovable:m&&v,loading:c||o[l]?.loading}}},98439:(_,L,e)=>{"use strict";e.d(L,{W:()=>s});var t=e(2543),n=e.n(t),r=e(96540);function s(a,g=1,i){const[l,d]=(0,r.useState)(g),o=(0,r.useMemo)(()=>(0,t.chunk)(a,i),[a,i]),u=o.length,c=o[l-1]??[],p=(l-1)*i+1,h=(0,t.clamp)(l*i,a.length),y=(0,r.useCallback)(P=>{d((0,t.clamp)(P,1,o.length))},[d,o]),f=(0,r.useCallback)(()=>y(l+1),[l,y]),v=(0,r.useCallback)(()=>y(l-1),[l,y]);return(0,r.useEffect)(()=>d(1),[u]),{page:l,onPageChange:y,numberOfPages:u,pageItems:c,pageStart:p,pageEnd:h,nextPage:f,previousPage:v}}},27747:(_,L,e)=>{"use strict";e.d(L,{S:()=>n});var t=e(9518);function n({dashboardUID:r,panelId:s,poll:a=!1}){const{result:g,loading:i,error:l}=(0,t.kU)(r,s,a);return{rules:g?g.flatMap(o=>o.groups).flatMap(o=>o.rules):[],errors:l?[l]:[],loading:i}}},12210:(_,L,e)=>{"use strict";e.d(L,{_:()=>r});var t=e(16817),n=e(27716);function r(s){const{loading:a,error:g,value:i}=(0,t.A)(()=>(0,n.x)(s,{showErrorAlert:!1})),l=i&&!g&&!a,d=i?.enabled;return a&&!i?{loading:!0}:!l||!d?{loading:!1,installed:!1}:{loading:a,installed:!0,settings:i}}},99935:(_,L,e)=>{"use strict";e.d(L,{I:()=>c,f:()=>p});var t=e(96540),n=e(79938),r=e(18461),s=e(23662),a=e(6833);const{useLazyPrometheusRuleNamespacesQuery:g}=n.hK,i=3*1e3,l=90*1e3,{setInterval:d,clearInterval:o}=window;function u(){const[h]=g();return{matchingPromRuleExists:(0,t.useCallback)(async f=>{const{ruleSourceName:v,namespace:P,groupName:m,ruleName:D}=f;return(await h({ruleSourceName:v,namespace:P,groupName:m,ruleName:D}).unwrap()).find(b=>b.name===P)?.groups.find(b=>b.name===m)?.rules.some(b=>{const T=r.Lg(v,P,m,b);return r.LC(T,f)})??!1},[h])}}function c(){const{matchingPromRuleExists:h}=u(),y=(0,t.useRef)(),f=(0,t.useRef)();(0,t.useEffect)(()=>()=>{v(),P()},[]);const v=()=>{y.current&&(o(y.current),y.current=void 0)},P=()=>{f.current&&(o(f.current),f.current=void 0)};async function m(x){v();const E=new Promise((b,T)=>{setTimeout(()=>{v(),T(new Error("Timeout while waiting for rule removal"))},l)}),C=new Promise((b,T)=>{y.current=d(()=>{h(x).then(A=>{A===!1&&(v(),b())}).catch(A=>{v(),T(A)})},i)});return Promise.race([E,C])}async function D(x){P();const E=new Promise((b,T)=>{setTimeout(()=>{P(),T(new Error("Timeout while waiting for rule creation"))},l)}),C=new Promise((b,T)=>{f.current=d(()=>{h(x).then(A=>{A===!0&&(P(),b())}).catch(A=>{P(),T(A)})},i)});return Promise.race([E,C])}return{waitForRemoval:m,waitForCreation:D}}function p(h){const{matchingPromRuleExists:y}=u(),{waitForCreation:f}=c(),[v,P]=(0,a.Yb)(async m=>(0,s.X4)(m)?f(m):Promise.resolve());return(0,t.useEffect)(()=>{(0,s.X4)(h)&&y(h).then(m=>{m||v.execute(h)})},[v,h,y]),{isConsistent:P.status==="success"||P.status==="not-executed",error:P.error}}},55776:(_,L,e)=>{"use strict";e.d(L,{h:()=>a});var t=e(80997),n=e(32264),r=e(25027),s=e(39964);function a(i){const l={returnTo:i},[d]=(0,s.l)(),o=d.get("returnTo");if(!o)return l;const u=t.sQ.sanitizeUrl(o),c=`${window.location.origin}/${n.$.appSubUrl}`,p=g(u,c);if(!p)return(0,r.FF)("Malformed returnTo parameter",{returnTo:o}),l;const{protocol:h,origin:y,pathname:f,search:v}=p;return["http:","https:"].includes(h)===!1||y!==window.location.origin?((0,r.FF)("Malformed returnTo parameter",{returnTo:o}),l):{returnTo:`${f}${v}`}}function g(i,l){try{return new URL(i,l)}catch{return null}}},46013:(_,L,e)=>{"use strict";e.d(L,{G:()=>o,Q:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(32264),a=e(40845),g=e(37390);const i=(0,r.lazy)(()=>e.e(7409).then(e.bind(e,9790))),l=(0,r.lazy)(()=>Promise.all([e.e(8895),e.e(285)]).then(e.bind(e,285)));var d=(c=>(c.Loki="loki",c.Annotations="annotations",c))(d||{});function o(){const[c,p]=(0,r.useState)(!1),[h,y]=(0,r.useState)(),f=(0,a.of)(u),v=s.$.unifiedAlerting.alertStateHistoryBackend,P=s.$.unifiedAlerting.alertStateHistoryPrimary,D=[v,P].some(b=>b==="loki")?"loki":"annotations",x=(0,r.useCallback)(()=>{y(void 0),p(!1)},[]),E=(0,r.useCallback)(b=>{y(b),p(!0)},[]);return{StateHistoryModal:(0,r.useMemo)(()=>h?(0,t.jsx)(g.a,{isOpen:c,onDismiss:x,closeOnBackdropClick:!0,closeOnEscape:!0,title:"State history",className:f.modal,contentClassName:f.modalContent,children:(0,t.jsxs)(r.Suspense,{fallback:"Loading...",children:[D==="loki"&&(0,t.jsx)(l,{ruleUID:h.grafana_alert.uid}),D==="annotations"&&(0,t.jsx)(i,{alertId:h.grafana_alert.id??""})]})}):null,[h,c,x,D,f]),showStateHistoryModal:E,hideStateHistoryModal:x}}const u=c=>({modal:(0,n.css)({width:"80%",height:"80%",minWidth:"800px"}),modalContent:(0,n.css)({height:"100%",width:"100%",padding:c.spacing(2)})})},39964:(_,L,e)=>{"use strict";e.d(L,{l:()=>s});var t=e(96540),n=e(54148),r=e(39601);function s(){const{search:a}=(0,n.zy)(),g=(0,t.useMemo)(()=>new URLSearchParams(a),[a]),i=(0,t.useCallback)((l,d)=>{r.Ny.partial(l,d)},[]);return[g,i]}},61410:(_,L,e)=>{"use strict";e.d(L,{$:()=>r});var t=e(25508),n=e(31678);function r(s,a){return(0,n.useSelector)((0,t.Mz)(g=>g.unifiedAlerting,g=>s(g)),a)}},85244:(_,L,e)=>{"use strict";e.d(L,{T:()=>g});var t=e(74848),n=e(16817),r=e(39938),s=e(56034),a=e(27716);function g({pluginId:i}){const{value:l}=(0,n.A)(()=>(0,a.x)(i)),d=l?.info.logos?.small,o=d?(0,t.jsx)("img",{src:d,alt:l?.name,style:{width:"20px",height:"20px"}}):(0,t.jsx)(r.E,{text:i,color:"orange"}),u=l?`This rule is managed by the ${l?.name} plugin`:"This rule is managed by a plugin";return(0,t.jsx)(s.m,{content:u,children:(0,t.jsx)("div",{children:o})})}},48070:(_,L,e)=>{"use strict";e.d(L,{Ct:()=>m,KH:()=>o,KL:()=>p,LH:()=>d,Qn:()=>i,Wu:()=>l,bw:()=>h,fO:()=>c,i3:()=>f,lF:()=>u});var t=e(65307),n=e(2543),r=e.n(n),s=e(57220),a=e(18461),g=e(23662);const i=(0,t.VP)("ruleGroup/rules/add"),l=(0,t.VP)("ruleGroup/rules/update"),d=(0,t.VP)("ruleGroup/rules/pause"),o=(0,t.VP)("ruleGroup/rules/delete"),u=(0,t.VP)("ruleGroup/update"),c=(0,t.VP)("ruleGroup/move"),p=(0,t.VP)("ruleGroup/rename"),h=(0,t.VP)("ruleGroup/rules/reorder"),y={name:"initial",rules:[]},f=(0,t.vy)(y,x=>{x.addCase(i,(E,{payload:C})=>{const{rule:b}=C;E.rules.push(b)}).addCase(l,(E,{payload:C})=>{const{identifier:b,rule:T}=C,A=D(E.rules,b);E.rules[A]=T}).addCase(o,(E,{payload:C})=>{const{identifier:b}=C,T=D(E.rules,b);E.rules.splice(T,1)}).addCase(d,(E,{payload:C})=>{const{uid:b,pause:T}=C,A={ruleSourceName:s.hY,uid:b},R=D(E.rules,A),S=E.rules[R];if((0,g.lT)(S))S.grafana_alert.is_paused=T;else throw new Error("Matching rule is not a Grafana-managed rule")}).addCase(h,(E,{payload:C})=>{const{swaps:b}=C;P(E.rules,b)}).addMatcher((0,t.i0)(p,c,i),(E,{payload:C})=>{const{groupName:b}=C;E.name=b??E.name}).addMatcher((0,t.i0)(u,p,c,i),(E,{payload:C})=>{const{interval:b}=C;E.interval=b??E.interval}).addDefaultCase((E,C)=>{throw new Error(`Unknown action for rule group reducer: ${C.type}`)})}),v=x=>{const E=(0,g.A4)(x),C=(0,g.X4)(x);return b=>{const T=(0,g.lT)(b),A=(0,g.Mt)(b);if(E&&T)return b.grafana_alert.uid===x.uid;if(A&&C)return(0,a.Ns)(b)===x.rulerRuleHash}};function P(x,E){for(const C of E)m(x,C);return x}function m(x,[E,C]){if(!((0,n.inRange)(E,x.length)&&(0,n.inRange)(C,x.length)))throw new Error("Invalid operation: index out of bounds");const[T]=x.splice(E,1);x.splice(C,0,T)}function D(x,E){const C=x.findIndex(v(E));if(C===-1)throw new Error("no rule matching identifier found");return C}},28475:(_,L,e)=>{"use strict";e.d(L,{Jc:()=>M,kL:()=>Y,XY:()=>Q});var t=e(94822),n=e(23662);const r=1,s=2,a=3,g=4,i=5,l=6,d=7,o=8,u=9,c=10,p=11,h=12,y=13,f=14,v=15,P=0,m=1,D=2,x=3,E=4,C=5,b=6,T=7,A=8,R=9,S=10;var O=e(2543),j=e(48820);const B=j.U1.deserialize({version:14,states:"!vOQOPOOO{OPO'#CkOOOO'#Ck'#CkOQOPO'#CoOOOO'#Cl'#ClQQOPOOO!yOQO'#C^O#OOPO'#CmO#TOPO,59VOOOO,59Z,59ZOOOO-E6j-E6jOOOO,58x,58xOOOO,59X,59XOOOO-E6k-E6k",stateData:"$t~ORUOTUOUUOVUOWUOXUOYUOZUO[UO]UO^UOdPOfQO~OeVOR_XT_XU_XV_XW_XX_XY_XZ_X[_X]_X^_Xd_Xf_X~OSZO~Od[O~OeVOR_aT_aU_aV_aW_aX_aY_aZ_a[_a]_a^_ad_af_a~OR~T~U~V~W~Y~Z~[~]~^~R^][ZYXWVUTd~",goto:"}dPPePPPPPPPPPPPPejpPvVRORTQTORYTQWPR]WSSOTRXR",nodeNames:"\u26A0 AlertRuleSearch FilterExpression DataSourceToken FilterValue NameSpaceToken LabelToken GroupToken RuleToken StateToken TypeToken HealthToken DashboardToken PluginsToken ContactPointToken FreeFormExpression",maxTerm:22,skippedNodes:[0],repeatNodeCount:2,tokenData:"$ nRRtqr#crs&ost#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]+q!]#V#c#V#W-T#W#X@m#X#Z#c#Z#[!/S#[#]!7|#]#`#c#`#a!B`#a#b#c#b#c!KY#c#d#c#d#e#,W#e#f#c#f#g#8S#g#h#?d#h#i#H^#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#jcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cQ$zcSQqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uQ&YP;=`<%l$uQ&`P;=`;NQ$uR&fP;=`<%l#cR&lP;=`;NQ#cR&rrX^(|pq(|qr(|st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R)PsX^(|pq(|qr(|rs+^st(|tu(|uv(|vw(|wx(|xy(|yz(|z{(|{|(||!P(|!P!Q(|!Q![(|![!](|!]#y(|#y#z(|#z$f(|$f$g(|$g#BY(|#BY#BZ(|#BZ$Ch(|$IS$I_(|$I|$JO(|$JT$JU(|$JU$KV(|$KV$KW(|$KW&FU(|&FU&FV(|&FV;'S(|;'S;(d+e;(d;(e+k<%lO(|R+eOSQfPR+hP;=`<%l(|R+nP;=`;NQ(|R+xcSQePqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR-[eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d.m#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR.teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c0V#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR0^eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i1o#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR1veSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U3X#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR3`eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W4q#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR4xeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i6Z#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR6beSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]!r#c!r!s7s!s$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR7zeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d9]#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR9deSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^:u#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR:|eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c<_#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR<feSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i=w#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR>OcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]?Z!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR?bcSQ^Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR@teSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UBV#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRB^fSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#hCr#h#i! n#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRCyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]E[#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cREceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#VFt#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRF{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#dH^#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRHeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#UIv#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRI}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#gK`#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRKgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#W#c#W#XLx#X$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRMPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cRNccSQ[Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR! ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!#W#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!#_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h!$p#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!$weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!&Y#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!&aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!'r#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!'yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!)[#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!)ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W!*t#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!*{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!,^#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!,ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!-p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!-wcSQRPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!/ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#f#c#f#g!0l#g$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!0seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#c#c#c#d!2U#d$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!2]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j!3n#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!3ueSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e!5W#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!5_cSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!6j!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!6qcSQVPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!8TeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!9f#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!9meSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!;O#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!;VeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!<h#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!<oeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i!>Q#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!>XeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#[#c#[#]!?j#]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!?qcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!@|!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!ATcSQZPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!BgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Cx#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!DPeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#U#c#U#V!Eb#V$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!EieSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y!Fz#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!GReSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a!Hd#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!HkcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]!Iv!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!I}cSQUPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR!KaeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U!Lr#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!LyeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#a#c#a#b!N[#b$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR!NceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y# t#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR# {eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h##^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR##eeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#$v#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#$}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#&`#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#&geSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#V#c#V#W#'x#W$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#(PeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#)b#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#)icSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#*t!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#*{cSQTPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#,_eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#-p#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#-weSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#/Y#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#/aeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#Z#c#Z#[#0r#[$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#0yeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#]#c#]#^#2[#^$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#2ceSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#b#c#b#c#3t#c$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#3{eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#g#c#g#h#5^#h$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#5ecSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#6p!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#6wcSQ]Pqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#8ZeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#i#c#i#j#9l#j$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#9seSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#`#c#`#a#;U#a$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#;]eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#<n#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#<ucSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#>Q!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#>XcSQWPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#?keSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#@|#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#ATeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#T#c#T#U#Bf#U$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#BmeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#h#c#h#i#DO#i$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#DVeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Eh#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#EocSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#Fz!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#GRcSQXPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$uR#HeeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#m#c#m#n#Iv#n$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#I}eSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#d#c#d#e#K`#e$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#KgeSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]$u!]#X#c#X#Y#Lx#Y$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#MPcSQdPqr#cst#ctu#cuv#cvw#cwx#cxy#cyz#cz{#c{|#c|!P#c!P!Q#c!Q![#c![!]#N[!]$Ch#c$JU;'S#c;'S;(d&c;(d;(e&i<%lO#cR#NccSQYPqr$ust$utu$uuv$uvw$uwx$uxy$uyz$uz{$u{|$u|!P$u!P!Q$u!Q![$u![!]$u!]$Ch$u$JU;'S$u;'S;(d&V;(d;(e&]<%lO$u",tokenizers:[0,1],topRules:{AlertRuleSearch:[0,1]},dialects:{dataSourceFilter:141,nameSpaceFilter:143,labelFilter:145,groupFilter:147,ruleFilter:149,stateFilter:84,typeFilter:151,healthFilter:153,dashboardFilter:155,pluginsFilter:157,contactPointFilter:159},tokenPrec:161}),N={[a]:"datasource",[i]:"namespace",[l]:"label",[o]:"rule",[d]:"group",[u]:"state",[c]:"type",[p]:"health",[h]:"dashboard",[y]:"plugins",[f]:"contactPoint"};var I=(te=>(te.dataSource="dataSourceFilter",te.nameSpace="nameSpaceFilter",te.label="labelFilter",te.group="groupFilter",te.rule="ruleFilter",te.state="stateFilter",te.type="typeFilter",te.health="healthFilter",te.dashboard="dashboardFilter",te.plugins="pluginsFilter",te.contactPoint="contactPointFilter",te))(I||{});function K(te,X,ee){H(te,X,ne=>{if(ne.type.id===s){const Z=w(te,ne);if(Z.type&&Z.value){const ae=ee[Z.type];ae&&ae(Z.value)}}else if(ne.type.id===v){const Z=ee[v];Z&&Z(U(te,ne))}})}function w(te,X){if(X.type.id!==s)throw new Error("Invalid node provided. Only FilterExpression nodes are supported");const ee=X.firstChild;if(!ee)return{type:void 0,value:void 0};const ne=X.getChild(g),Z=ne?(0,O.trim)(U(te,ne),'"'):void 0;return{type:ee.type.id,value:Z}}function U(te,X){return te.slice(X.from,X.to).trim().replace(/\"/g,"")}function W(te,X,ee){const ne=[];H(te,X,ae=>{ae.type.id===s&&ae.firstChild&&ne.push(ae.firstChild),ae.type.id===v&&ne.push(ae)});const Z=[];return ne.forEach(ae=>{const re=ee.findIndex(se=>se.type===ae.type.id);if(re!==-1){if(ae.parent?.type.is(s)){const se=N[ae.type.id],de=ee.splice(re,1)[0];Z.push(`${se}:${z(de.value)}`)}if(ae.type.is(v)){const se=ee.splice(re,1)[0];Z.push(se.value)}}}),ee.forEach(ae=>{ae.type===v?Z.push(ae.value):Z.push(`${N[ae.type]}:${z(ae.value)}`)}),Z.join(" ")}function H(te,X,ee){const ne=X.join(" "),ae=B.configure({dialect:ne}).parse(te).cursor();do ee(ae.node);while(ae.next())}function z(te){return/\s/.test(te)?`"${te}"`:te}const G=[I.dataSource,I.nameSpace,I.label,I.group,I.rule,I.state,I.type,I.health,I.dashboard,I.plugins,I.contactPoint];var M=(te=>(te.Ok="ok",te.Error="error",te.NoData="nodata",te.Unknown="unknown",te))(M||{});function Q(te){const X={labels:[],freeFormWords:[],dataSourceNames:[]},ee={[a]:ne=>X.dataSourceNames.push(ne),[i]:ne=>X.namespace=ne,[d]:ne=>X.groupName=ne,[o]:ne=>X.ruleName=ne,[l]:ne=>X.labels.push(ne),[u]:ne=>X.ruleState=q(ne),[c]:ne=>(0,n.nf)(ne)?X.ruleType=ne:void 0,[p]:ne=>X.ruleHealth=(0,n.f6)(ne),[h]:ne=>X.dashboardUid=ne,[y]:ne=>X.plugins=ne==="hide"?ne:void 0,[f]:ne=>X.contactPoint=ne,[v]:ne=>X.freeFormWords.push(ne)};return K(te,G,ee),X}function Y(te,X){const ee=[];return X.dataSourceNames&&ee.push(...X.dataSourceNames.map(ne=>({type:a,value:ne}))),X.namespace&&ee.push({type:i,value:X.namespace}),X.groupName&&ee.push({type:d,value:X.groupName}),X.ruleName&&ee.push({type:o,value:X.ruleName}),X.ruleState&&ee.push({type:u,value:X.ruleState}),X.ruleType&&ee.push({type:c,value:X.ruleType}),X.ruleHealth&&ee.push({type:p,value:X.ruleHealth}),X.labels&&ee.push(...X.labels.map(ne=>({type:l,value:ne}))),X.dashboardUid&&ee.push({type:h,value:X.dashboardUid}),X.plugins&&ee.push({type:y,value:X.plugins}),X.freeFormWords&&ee.push(...X.freeFormWords.map(ne=>({type:v,value:ne}))),X.contactPoint&&ee.push({type:f,value:X.contactPoint}),W(te,G,ee)}function q(te){if(te==="normal")return t.cF.Inactive;if((0,t.Si)(te))return te}},28318:(_,L,e)=>{"use strict";e.d(L,{t:()=>O});var t=e(2543),n=e(39741),r=e(62467),s=e(66847),a=e(1005),g=e(81160),i=e(62938),l=e(39070),d=e(14236),o=e(72495),u=e(65879),c=e(43127),p=e(89667),h=e(19347),y=e(26657),f=e(12091),v=e(27677),P=e(69437),m=e(81583),D=e(72955),x=e(66718);const E={from:21600,to:0},C=(U,W)=>{const H=b(U,W);if(!H)return E;const{from:z,to:G}=A(H,W);return!z.length&&!G.length?E:{from:Math.max(...z),to:Math.min(...G)}},b=(U,W)=>{switch(U.type){case x.Tz.classic:return T(U);case x.Tz.math:case x.Tz.sql:return R(U,W);case x.Tz.resample:case x.Tz.reduce:case x.Tz.threshold:return S(U)}},T=U=>U.conditions?.map(W=>W.query.params[0]),A=(U,W)=>{const H=[],z=[E.to];for(const G of U){const M=W.find(Q=>Q.refId===G);!M||!M.relativeTimeRange||(H.push(M.relativeTimeRange.from),z.push(M.relativeTimeRange.to))}return{from:H,to:z}},R=(U,W)=>W.filter(H=>H.queryType==="query"&&U.expression?.includes(H.refId)).map(H=>H.refId),S=U=>U.expression?[U.expression]:void 0;class O{constructor(W=(0,v.AI)(),H=(0,h.l)()){this.backendSrv=W,this.dataSourceSrv=H,this.subject=new n.m(1),this.lastResult={}}get(){return this.subject.asObservable()}async run(W,H){const z=B(W,l.Gu.Done),G=[];for(const Q of W){const Y=Q.model.refId;if((0,P.f)(Q.model))continue;const q=await this.dataSourceSrv.get(Q.datasourceUid);q instanceof y.iy&&q.filterQuery&&!q.filterQuery(Q.model)&&G.push(Y)}const M=(0,t.reject)(W,Q=>G.includes(Q.model.refId));if(M.length===0)return this.subject.next(z);this.subscription=j(this.backendSrv,M,H).subscribe({next:Q=>{const Y=w(Q,(q,te)=>{const X=this.lastResult[q],ee=(0,d.N$)(te,X);return(0,D.B)(ee,X)});this.lastResult=Y,this.subject.next(this.lastResult)},error:Q=>{this.lastResult=K(this.lastResult,Q),this.subject.next(this.lastResult)}})}cancel(){if(!this.subscription)return;this.subscription.unsubscribe();let W=!1;const H=w(this.lastResult,(z,G)=>(G.state===l.Gu.Loading&&(W=!0),{...G,state:l.Gu.Done}));W&&this.subject.next(H)}destroy(){this.subject&&this.subject.complete(),this.cancel()}}const j=(U,W,H)=>{const z=B(W,l.Gu.Loading),G={data:{data:W,condition:H},url:"/api/v1/eval",method:"POST",requestId:(0,i.A)()};return(0,o.k)({whileLoading:z,source:U.fetch(G).pipe(I(z),(0,s.W)(M=>(0,r.of)(K(z,M))),(0,m.N)(U,G.requestId),(0,a.u)())})},B=(U,W)=>U.reduce((H,z)=>(H[z.refId]={state:W,series:[],timeRange:N(z,U)},H),{}),N=(U,W)=>{if((0,P.f)(U.model)){const H=C(U.model,W);return u.relativeToTimeRange(H)}return U.relativeTimeRange?u.relativeToTimeRange(U.relativeTimeRange):(console.warn(`Query with refId: ${U.refId} did not have any relative time range, using default.`),(0,c.E2)())},I=U=>(0,g.T)(W=>{const{data:H}=W,z={};for(const[G,M]of Object.entries(H.results)){const{error:Q,status:Y,frames:q=[]}=M,te=Q?[{message:Q,refId:G,status:Y}]:[];z[G]={errors:te,timeRange:U[G].timeRange,state:l.Gu.Done,series:q.map(p.or)}}return z}),K=(U,W)=>{const H=(0,f.u)(W);return w(U,(z,G)=>({...G,state:l.Gu.Error,error:H}))},w=(U,W)=>{const H={};for(const[z,G]of Object.entries(U))H[z]=W(z,G);return H}},70383:(_,L,e)=>{"use strict";e.d(L,{Kh:()=>h,VI:()=>u,b9:()=>o});var t=e(74848),n=e(96540),r=e(33390),s=e(60021),a=e(62190),g=e(39964),i=e(55740),l=e(57220);const d=n.createContext(void 0),o=({children:y,accessType:f,alertmanagerSourceName:v})=>{const[P,m]=(0,g.l)(),D=(0,a.W)(f),x=D.availableInternalDataSources.concat(D.availableExternalDataSources),E=n.useCallback(I=>{c(x,I)&&(I===l.hY?(r.A.delete(i.Oq),m({[i.DD]:void 0})):(r.A.set(i.Oq,I),m({[i.DD]:I})))},[x,m]),C=P.get(i.DD),b=r.A.get(i.Oq),T=l.hY;n.useEffect(()=>{C&&C!==b&&r.A.set(i.Oq,C)},[C,b]);const A=v??C??b??T,R=c(x,A)?A:void 0,S=(0,l.r3)(R)?.jsonData,O=R===l.hY,j=S?h(S):!1,N={selectedAlertmanager:R,hasConfigurationAPI:O||j,isGrafanaAlertmanager:O,selectedAlertmanagerConfig:S,availableAlertManagers:x,setSelectedAlertmanager:E};return(0,t.jsx)(d.Provider,{value:N,children:y})};function u(){const y=n.useContext(d);if(y===void 0)throw new Error("useAlertmanager must be used within a AlertmanagerContext");return y}function c(y,f){return y.map(P=>P.name).includes(f)}const p=[s.Oz.mimir,s.Oz.cortex,void 0];function h(y){return p.includes(y.implementation)}},26627:(_,L,e)=>{"use strict";e.d(L,{nO:()=>U,D3:()=>w,yo:()=>O,wE:()=>R,nV:()=>j,Tp:()=>I,Om:()=>K,JH:()=>B,Lc:()=>A,mB:()=>b,eB:()=>T,DC:()=>S,Qt:()=>C,uQ:()=>H,bO:()=>W,RW:()=>N});var t=e(65307),n=e(2543),r=e(39601),s=e(34867),a=e(94822),g=e(27677),i=e(25027),l=e(32415),d=e(82843),o=e(17172);function u(z){return(0,o.AI)().get("/api/annotations",{alertId:z}).then(G=>G?.sort(c))}function c(z,G){const M=(q,te)=>q>te?-1:te>q?1:0,Q=M(z.timeEnd,G.timeEnd);if(Q)return Q;const Y=M(z.time,G.time);return Y||M(z.id,G.id)}var p=e(92240),h=e(49498),y=e(28220),f=e(98164),v=e(57220),P=e(78742),m=e(88467),D=e(23662),x=e(25968);function E(z,G){const M=z().unifiedAlerting.dataSources,Q=M[G]?.result,Y=M[G]?.error;if(!Q){const q=new Error(`Data source configuration is not available for "${G}" data source`);throw Y&&(q.cause=Y),q}return Q}function C(z,G){const M=E(z,G);if(!M.rulerConfig)throw new Error(`Ruler API is not available for ${G}`);return M.rulerConfig}const b=(0,t.zD)("unifiedalerting/fetchPromRules",async({rulesSourceName:z,filter:G,limitAlerts:M,matcher:Q,state:Y,identifier:q},te)=>{await te.dispatch(S({rulesSourceName:z}));const X=(0,i.U7)("unifiedalerting/fetchPromRules",h.sA,{dataSourceName:z,thunk:"unifiedalerting/fetchPromRules"});return await(0,m.$I)(X(z,G,M,Q,Y,q))}),T=(0,t.zD)("unifiedalerting/fetchRulerRules",async({rulesSourceName:z,filter:G},{dispatch:M,getState:Q})=>{await M(S({rulesSourceName:z}));const Y=C(Q,z),q=(0,i.Ke)("unifiedalerting/fetchRulerRules",y.iy,{dataSourceName:z,thunk:"unifiedalerting/fetchRulerRules"});return await(0,m.$I)(q(Y,G))});function A({rulesSourceName:z,identifier:G,filter:M,limitAlerts:Q,matcher:Y,state:q}){return async(te,X)=>{await te(S({rulesSourceName:z}));const ee=E(X,z);await te(b({rulesSourceName:z,identifier:G,filter:M,limitAlerts:Q,matcher:Y,state:q})),ee.rulerConfig&&await te(T({rulesSourceName:z}))}}function R(){return async z=>{const G=(0,v.gR)().map(M=>z(S({rulesSourceName:M})));await Promise.allSettled(G)}}const S=(0,t.zD)("unifiedalerting/fetchPromBuildinfo",async({rulesSourceName:z})=>(0,m.$I)((async()=>{if(z===v.hY)return{name:v.hY,id:v.hY,rulerConfig:{dataSourceName:v.hY,apiVersion:"legacy"}};const G=(0,v.Jz)(z);if(!G)throw new Error(`Missing data source configuration for ${z}`);const{id:M,name:Q}=G,q=await(0,i.QA)("unifiedalerting/fetchPromBuildinfo",p.nD,{dataSourceName:z,thunk:"unifiedalerting/fetchPromBuildinfo"})(Q),te=q.features.rulerApiEnabled?{dataSourceName:Q,apiVersion:q.application===a.N1.Cortex?"legacy":"config"}:void 0;return{name:Q,id:M,rulerConfig:te}})()),{condition:({rulesSourceName:z},{getState:G})=>{const M=G().unifiedAlerting.dataSources,Q=!!M[z]?.result,Y=!!M[z]?.error;return!(Q||Y)}});function O(z=!1,G={}){return async(M,Q)=>{const Y=performance.now();await Promise.allSettled((0,v.gR)().map(async q=>{await M(S({rulesSourceName:q}));const{promRules:te,rulerRules:X,dataSources:ee}=Q().unifiedAlerting,ne=ee[q].result;if(!ne)return;const Z=z||!te[q]?.loading,ae=(z||!X[q]?.loading)&&!!ne.rulerConfig;await Promise.allSettled([Z&&M(b({rulesSourceName:q,...G})),ae&&M(T({rulesSourceName:q}))])})),(0,s.l$)("unifiedalerting/fetchAllPromAndRulerRulesAction",{loadTimeMs:performance.now()-Y})}}function j(z=!1,G={}){return async(M,Q)=>{const{promRules:Y}=Q().unifiedAlerting;(0,v.gR)().map(q=>{(z||!Y[q]?.loading)&&M(b({rulesSourceName:q,...G}))})}}const B=(0,t.zD)("unifiedalerting/fetchGrafanaAnnotations",z=>(0,m.$I)(u(z))),N=(0,t.zD)("unifiedalerting/updateAMConfig",({alertManagerSourceName:z,oldConfig:G,newConfig:M,successMessage:Q,redirectPath:Y,redirectSearch:q},te)=>(0,m.v5)((0,m.$I)((async()=>{const X=await te.dispatch(d.m.endpoints.getAlertmanagerConfiguration.initiate(z,{forceRefetch:!0})).unwrap(),ee=(0,n.isEmpty)(X.alertmanager_config)&&(0,n.isEmpty)(X.template_files),ne=JSON.stringify(X)!==JSON.stringify(G);if(!ee&&ne)throw new Error("A newer Alertmanager configuration is available. Please reload the page and try again to not overwrite recent changes.");if(await(0,l.vk)(z,(0,f.MZ)(M)),te.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration","ContactPoint","ContactPointsStatus","Receiver"])),Y){const Z=new URLSearchParams(q??"");r.Ny.push((0,P.nL)(Y,z,Z))}})()),{successMessage:Q})),I=(0,t.zD)("unifiedalerting/fetchFolder",z=>(0,m.$I)(g.IB.getFolderByUid(z,{withAccessControl:!0}))),K=z=>(G,M)=>{M().unifiedAlerting.folders[z]?.dispatched||G(I(z))},w=(0,t.zD)("unifiedalerting/fetchAlertGroups",z=>(0,m.$I)((0,l.f4)(z))),U=(0,t.zD)("unifiedalerting/deleteAlertManagerConfig",async(z,G)=>(0,m.v5)((0,m.$I)((async()=>{await(0,l.nd)(z),await G.dispatch(d.m.util.invalidateTags(["AlertmanagerConfiguration"]))})()),{errorMessage:"Failed to reset Alertmanager configuration",successMessage:"Alertmanager configuration reset."})),W=(0,t.zD)("unifiedalerting/testReceivers",({alertManagerSourceName:z,receivers:G,alert:M})=>(0,m.v5)((0,m.$I)((0,l.By)(z,G,M)),{errorMessage:"Failed to send test alert.",successMessage:"Test alert sent."})),H=(z,G)=>z.filter(M=>{const{forDuration:Q}=(0,D.jg)(M,G),Y=Q?(0,x.P8)(Q):null,q=(0,x.P8)(G);return Y?Y!==0&&Y<q:!1})},22620:(_,L,e)=>{"use strict";e.d(L,{H:()=>n});var t=e(32196);const n=r=>(0,t.css)({float:"none",display:"flex",justifyContent:"flex-start",margin:r.spacing(2,0)})},99494:(_,L,e)=>{"use strict";e.d(L,{W:()=>t});var t=(n=>(n.Incident="grafana-incident-app",n.OnCall="grafana-oncall-app",n.MachineLearning="grafana-ml-app",n.Labels="grafana-labels-app",n.Slo="grafana-slo-app",n))(t||{})},86590:(_,L,e)=>{"use strict";e.d(L,{Z:()=>t});var t=(n=>(n.grafana="grafana-alerting",n.grafanaRecording="grafana-recording",n.cloudAlerting="cloud-alerting",n.cloudRecording="cloud-recording",n))(t||{})},41068:(_,L,e)=>{"use strict";e.d(L,{y:()=>t});var t=(n=>(n.seconds="s",n.minutes="m",n.hours="h",n.days="d",n.weeks="w",n))(t||{})},75471:(_,L,e)=>{"use strict";e.d(L,{C0:()=>h,HL:()=>g,Q9:()=>y,VQ:()=>i,Wd:()=>p,jy:()=>u,lV:()=>c,nU:()=>l,q0:()=>f});var t=e(2913),n=e(16233),r=e(31678),s=e(57220);function a(v){return(0,s.z2)(v)?"grafana":"external"}const g={read:{grafana:r.AccessControlAction.AlertingInstanceRead,external:r.AccessControlAction.AlertingInstancesExternalRead},create:{grafana:r.AccessControlAction.AlertingInstanceCreate,external:r.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:r.AccessControlAction.AlertingInstanceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite},delete:{grafana:r.AccessControlAction.AlertingInstanceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite}},i={read:{grafana:r.AccessControlAction.AlertingNotificationsRead,external:r.AccessControlAction.AlertingNotificationsExternalRead},create:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite},update:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite},delete:{grafana:r.AccessControlAction.AlertingNotificationsWrite,external:r.AccessControlAction.AlertingNotificationsExternalWrite}},l={read:{grafana:r.AccessControlAction.AlertingSilenceRead,external:r.AccessControlAction.AlertingInstanceRead},create:{grafana:r.AccessControlAction.AlertingSilenceCreate,external:r.AccessControlAction.AlertingInstancesExternalWrite},update:{grafana:r.AccessControlAction.AlertingSilenceUpdate,external:r.AccessControlAction.AlertingInstancesExternalWrite}},d={read:r.AccessControlAction.AlertingProvisioningRead,readSecrets:r.AccessControlAction.AlertingProvisioningReadSecrets,write:r.AccessControlAction.AlertingProvisioningWrite},o={read:{grafana:r.AccessControlAction.AlertingRuleRead,external:r.AccessControlAction.AlertingRuleExternalRead},create:{grafana:r.AccessControlAction.AlertingRuleCreate,external:r.AccessControlAction.AlertingRuleExternalWrite},update:{grafana:r.AccessControlAction.AlertingRuleUpdate,external:r.AccessControlAction.AlertingRuleExternalWrite},delete:{grafana:r.AccessControlAction.AlertingRuleDelete,external:r.AccessControlAction.AlertingRuleExternalWrite}};function u(v){const P=a(v);return{read:g.read[P],create:g.create[P],update:g.update[P],delete:g.delete[P]}}function c(v){const P=a(v);return{read:i.read[P],create:i.create[P],update:i.update[P],delete:i.delete[P],provisioning:d}}function p(v){const P=a(v);return{read:o.read[P],create:o.create[P],update:o.update[P],delete:o.delete[P]}}function h(v){return()=>n.TP.evaluatePermission(v)}function y(){return{canCreateGrafanaRules:n.TP.hasPermission(r.AccessControlAction.FoldersRead)&&n.TP.hasPermission(o.create.grafana),canCreateCloudRules:n.TP.hasPermission(r.AccessControlAction.DataSourcesRead)&&n.TP.hasPermission(o.create.external),canEditRules:v=>n.TP.hasPermission(p(v).update)}}function f(){const{unifiedAlertingEnabled:v}=(0,t.zj)(),P=n.TP.hasPermission(p(s.hY).read),m=n.TP.hasPermission(p(s.hY).update);return v&&P&&m}},98164:(_,L,e)=>{"use strict";e.d(L,{$P:()=>R,$m:()=>d,Av:()=>P,Dm:()=>b,EU:()=>m,LF:()=>C,MN:()=>u,MU:()=>p,MZ:()=>i,NL:()=>v,UL:()=>A,VE:()=>D,Wc:()=>h,_n:()=>l,mP:()=>S,uH:()=>T,xH:()=>f});var t=e(2543),n=e.n(t),r=e(60021),s=e(82775),a=e(57220),g=e(32642);function i(O){return O.alertmanager_config.receivers||(O.alertmanager_config.receivers=[{name:"default "}]),O.alertmanager_config.route||(O.alertmanager_config.route={receiver:O.alertmanager_config.receivers[0].name}),O.template_files||(O.template_files={}),O}function l(O,j){return{...j,mute_time_intervals:j.mute_time_intervals?.filter(N=>N!==O)??[],active_time_intervals:j.active_time_intervals?.filter(N=>N!==O)??[],routes:j.routes?.map(N=>l(O,N))}}function d(O,j,B){return{...B,mute_time_intervals:B.mute_time_intervals?.map(N=>N===j?O:N),active_time_intervals:B.active_time_intervals?.map(N=>N===j?O:N),routes:B.routes?.map(N=>d(O,j,N))}}function o(O){return O.map(([j,B,N])=>[j,B,unquoteWithUnescape(N)])}function u(O){return O.isEqual?O.isRegex?r.ho.regex:r.ho.equal:O.isRegex?r.ho.notRegex:r.ho.notEqual}function c(O){switch(O){case r.ho.equal:return{isEqual:!0,isRegex:!1};case r.ho.notEqual:return{isEqual:!1,isRegex:!1};case r.ho.regex:return{isEqual:!0,isRegex:!0};case r.ho.notRegex:return{isEqual:!1,isRegex:!0}}}function p(O){return{name:O.name,value:O.value,operator:u(O)}}function h(O){return{name:O.name,value:O.value,...c(O.operator)}}function y(O){return`{ ${O.map(p).reduce((N,I)=>{const K=`${I.name}${I.operator}"${I.value}"`;return N?`${N}, ${K}`:K},"")} }`}const f=[{label:r.ho.equal,description:"Equals",value:r.ho.equal},{label:r.ho.notEqual,description:"Does not equal",value:r.ho.notEqual},{label:r.ho.regex,description:"Matches regex",value:r.ho.regex},{label:r.ho.notRegex,description:"Does not match regex",value:r.ho.notRegex}];function v(O){const j=u(O);return[O.name,j,O.value]}function P(O,j){return j.every(({name:B,value:N,isRegex:I,isEqual:K})=>Object.entries(O).some(([w,U])=>{const W=B===w;let H;return K&&!I&&(H=N===U),!K&&!I&&(H=N!==U),K&&I&&(H=new RegExp(N).test(U)),!K&&I&&(H=!new RegExp(N).test(U)),W&&H}))}function m(...O){const j=O.map(g.Zc).flat(),B=(0,t.uniqWith)(j,t.isEqual);return y(B)}function D(O){return O===a.hY?"default":"unquote"}function x(){return getAllDataSources().filter(O=>O.type===DataSourceType.Alertmanager)}function E(O){return x().find(j=>O===j.uid)}function C(O){const{times:j,weekdays:B,days_of_month:N,months:I,years:K,location:w}=O,U=b(j,w),W=T(B),H=A(N),z=R(I),G=S(K);return[U,W,H,z,G].join(", ")}function b(O,j){return"Times: "+(O?O?.map(({start_time:B,end_time:N})=>`${B} - ${N} [${j??"UTC"}]`).join(" and "):"All")}function T(O){return"Weekdays: "+(O?.map(j=>{if(j.includes(":"))return j.split(":").map(B=>{const N=B.slice(0,3);return N[0].toLocaleUpperCase()+N.slice(1)}).join("-");{const B=j.slice(0,3);return B[0].toLocaleUpperCase()+B.slice(1)}}).join(", ")??"All")}function A(O){return"Days of the month: "+(O?.join(", ")??"All")}function R(O){return"Months: "+(O?.join(", ")??"All")}function S(O){return"Years: "+(O?.join(", ")??"All")}},33225:(_,L,e)=>{"use strict";e.d(L,{Hx:()=>a,gO:()=>g});var t=e(96540),n=e(55740),r=e(78742);function s(i){return{dashboardUID:i.find(([l])=>l===n.YH.dashboardUID)?.[1],panelId:i.find(([l])=>l===n.YH.panelID)?.[1]}}function a(i){return(0,t.useMemo)(()=>Object.entries(i||{}).filter(([l,d])=>!!d.trim()),[i])}function g(i){const l=new Map,{panelId:d,dashboardUID:o}=s(i);return o&&l.set(n.YH.dashboardUID,(0,r.JM)(o)),o&&d&&l.set(n.YH.panelID,(0,r.D2)(o,d)),l}},82775:(_,L,e)=>{"use strict";e.d(L,{k:()=>r,q:()=>s});var t=e(32264),n=e(25968);function r(){return Object.values(t.$.datasources)}function s(a){if(!(0,n.TN)(t.$.unifiedAlerting.minInterval))return{globalLimit:0,exceedsLimit:!1};const g=(0,n.P8)(t.$.unifiedAlerting.minInterval);if(!a||!(0,n.TN)(a))return{globalLimit:g,exceedsLimit:!1};const i=(0,n.P8)(a),l=g>i&&i>0;return{globalLimit:g,exceedsLimit:l}}},55740:(_,L,e)=>{"use strict";e.d(L,{DD:()=>r,H8:()=>p,HH:()=>n,J3:()=>c,Oq:()=>s,U3:()=>g,UU:()=>t,YH:()=>u,cB:()=>i,kW:()=>y,kl:()=>h,wG:()=>a});const t="ruler not supported",n=3e4,r="alertmanager",s="alerting-alertmanager",a=2e4,g=2e4,i=2e4,l="timeseries",d="table",o="stat";var u=(f=>(f.description="description",f.summary="summary",f.runbookURL="runbook_url",f.alertId="__alertId__",f.dashboardUID="__dashboardUid__",f.panelID="__panelId__",f))(u||{});const c={description:"Description",summary:"Summary",runbook_url:"Runbook URL",__dashboardUid__:"Dashboard UID",__panelId__:"Panel ID",__alertId__:"Alert ID"},p={description:"Description of what the alert rule does.",summary:"Short summary of what happened and why.",runbook_url:"Webpage where you keep your runbook for the alert.",__dashboardUid__:"",__panelId__:"",__alertId__:""},h=[{key:"summary",value:""},{key:"description",value:""},{key:"runbook_url",value:""}],y="__alert_rule_uid__"},57220:(_,L,e)=>{"use strict";e.d(L,{AL:()=>K,EV:()=>B,Eb:()=>I,Jz:()=>P,Vr:()=>te,Zw:()=>z,bD:()=>x,cy:()=>A,gR:()=>O,hP:()=>q,hY:()=>c,iV:()=>C,k5:()=>Q,lS:()=>j,oh:()=>W,ol:()=>h,qi:()=>f,r3:()=>H,sq:()=>R,v0:()=>N,v8:()=>v,vv:()=>p,w5:()=>M,y9:()=>Y,yc:()=>w,z2:()=>U});var t=e(19347),n=e(16233),r=e(60021),s=e(31678),a=e(94822),g=e(82843),i=e(99085),l=e(62190),d=e(70383),o=e(75471),u=e(82775);const c="grafana",p="-- Grafana --";var h=(X=>(X.Alertmanager="alertmanager",X.Loki="loki",X.Prometheus="prometheus",X))(h||{});const y=["loki","prometheus"];function f(){return n.TP.hasPermission(s.AccessControlAction.AlertingRuleExternalRead)?(0,u.k)().filter(X=>y.includes(X.type)&&X.jsonData.manageAlerts!==!1).sort((X,ee)=>X.name.localeCompare(ee.name)):[]}function v(X){return U(X)?"grafana":X.uid??X.id}function P(X){return f().find(ee=>ee.name===X)}function m(){return(0,u.k)().filter(D).sort((X,ee)=>X.name.localeCompare(ee.name))}function D(X){return X.type==="alertmanager"}function x(X){return X.type==="alertmanager"}function E(){return m().filter(X=>X.jsonData.handleGrafanaManagedAlerts)}function C(X){return X.jsonData.handleGrafanaManagedAlerts===!0}const b={name:c,imgUrl:"public/img/grafana_icon.svg",hasConfigurationAPI:!0};function T(){return[b,...m().map(X=>({name:X.name,displayName:X.name,imgUrl:X.meta.info.logos.small,meta:X.meta}))]}function A(X){const ee=(0,l.W)(X),ne=ee.availableExternalDataSources.filter(se=>se.handleGrafanaManagedAlerts),Z=ee.availableInternalDataSources,{currentData:ae}=g.m.endpoints.getGrafanaAlertingConfigurationStatus.useQuery();switch(ae?.alertmanagersChoice){case r.nA.Internal:return Z;case r.nA.External:return ne;default:return[...Z,...ne]}}function R(X){const ee=[],ne=[],Z={instance:o.HL.read,notification:o.VQ.read,silence:o.nU.read};if([...Object.values(Z).flatMap(se=>se.grafana),...i.w].some(se=>n.TP.hasPermission(se))&&ee.push(b),n.TP.hasPermission(Z[X].external)){const se=m().map(de=>({name:de.name,displayName:de.name,imgUrl:de.meta.info.logos.small,meta:de.meta,hasConfigurationAPI:(0,d.Kh)(de.jsonData),handleGrafanaManagedAlerts:de.jsonData.handleGrafanaManagedAlerts}));ne.push(...se)}return{availableInternalDataSources:ee,availableExternalDataSources:ne}}function S(X){const ee=W(X);if(!ee)throw new Error(`Data source ${X} not found`);if(ee.type!=="loki"&&ee.type!=="prometheus")throw new Error(`Unexpected data source type ${ee.type}`);return ee}function O(){const X=f().map(ee=>ee.name);return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&X.push(c),X}function j(){const X=f();return n.TP.hasPermission(s.AccessControlAction.AlertingRuleRead)&&X.push(c),X}function B(X){return I(X)?X.name:X}function N(X){return I(X)?X.uid:c}function I(X){return X!==c}function K(X){return X!==c&&H(X)?.jsonData?.implementation===r.Oz.prometheus}function w(X){return X.readOnly===!0}function U(X){return X===c}function W(X){return(0,u.k)().find(ee=>ee.name===X)}function H(X){return(0,u.k)().filter(D).find(ee=>ee.name===X)}function z(X){return X===c?c:W(X)}function G(X){if(X===c)return c;const ee=W(X);if(!ee)throw new Error(`Datasource "${X}" not found`);return String(ee.id)}function M(X){if(X===c)return c;const ee=W(X);if(!ee)throw new Error(`Datasource "${X}" not found`);return ee.uid}function Q(){return(0,t.l)().getList({alerting:!0})[0]}function Y(){const X=(0,t.l)().getInstanceSettings("default");return X?.meta.alerting??!1?X:Q()}function q(X){return X.jsonData.manageAlerts!==!1}function te(X){return U(X)?"grafana":"prometheusType"in X.jsonData?X.jsonData?.prometheusType??a.N1.Prometheus:X.type==="loki"?"loki":a.N1.Prometheus}},75214:(_,L,e)=>{"use strict";e.d(L,{Dd:()=>n,F2:()=>i,M4:()=>t,lL:()=>a,rm:()=>g,w0:()=>l,x4:()=>s,zm:()=>r});function t(d){return Object.entries(d).map(([o,u])=>`${o}=${u}`).sort()}function n(d){return Object.entries(d).map(([o,u])=>[o,u])}function r(d){const o={};return d.forEach(u=>{o[u[0]]=u[1]}),o}function s(d){const o={};return d.forEach(u=>{u.key&&(o[u.key]=u.value)}),o}const a="__grafana_origin";function g(d){return Object.keys(d).filter(o=>!i(o)).length}function i(d){return d.startsWith("__")&&d.endsWith("__")||d===a}const l=([d,o])=>i(d)},32642:(_,L,e)=>{"use strict";e.d(L,{Ig:()=>P,J$:()=>p,J9:()=>c,S6:()=>d,So:()=>i,Zc:()=>o,b2:()=>v,ou:()=>u,qR:()=>g,t8:()=>m});var t=e(2543),n=e.n(t),r=e(60021),s=e(75214);const a=[r.ho.regex,r.ho.notRegex,r.ho.notEqual,r.ho.equal];function g(C){if(C.startsWith("{")&&C.endsWith("}"))throw new Error("this function does not support PromQL-style matcher syntax, call parsePromQLStyleMatcher() instead");const b=a.map(O=>[O,C.indexOf(O)]).filter(([O,j])=>j>-1).sort((O,j)=>O[1]-j[1]);if(!b.length)throw new Error(`Invalid matcher: ${C}`);const[T,A]=b[0],R=C.slice(0,A).trim(),S=C.slice(A+T.length);if(!R)throw new Error(`Invalid matcher: ${C}`);return{name:R,value:S,isRegex:T===r.ho.regex||T===r.ho.notRegex,isEqual:T===r.ho.equal||T===r.ho.regex}}function i(C){return D(C)?l(C):[g(C)]}function l(C){if(!D(C))throw new Error("not a PromQL style matcher");return d(C)}function d(C){const b=/,(?=(?:[^"]*"[^"]*")*[^"]*$)/,T=C.replace(/^\{/,"").replace(/\}$/,"").trim().split(b);return(0,t.compact)(T).flatMap(g).map(A=>({...A,name:P(A.name),value:P(A.value)}))}function o(C){try{return d(C)}catch{return[]}}function u(C){const b=C.filter(T=>!!T.trim()).map(T=>g(T));return(0,t.uniqBy)(b,T=>T.name)}const c=C=>{const b=Object.entries(C).filter(([A])=>!(0,s.F2)(A)),T=new URLSearchParams;return b.forEach(([A,R])=>T.append("matcher",`${A}=${R}`)),T},p=C=>{let b=[];return C.matchers&&C.matchers.forEach(T=>{const A=i(T).map(x);b=b.concat(A)}),C.object_matchers&&b.push(...C.object_matchers),C.match_re&&Object.entries(C.match_re).forEach(([T,A])=>{b.push([T,r.ho.regex,A])}),C.match&&Object.entries(C.match).forEach(([T,A])=>{b.push([T,r.ho.equal,A])}),b};function h(C){return`"${C.replace(/[\\"]/g,T=>`\\${T}`)}"`}const y=/[\{\}\!\=\~\,\\\"\'\`\s]+/;function f(C){return y.test(C)?h(C):C}const v=({name:C,operator:b,value:T})=>{const A=f(C),R=h(T);return`${A}${b}${R}`};function P(C){return/^"(.*)"$/.test(C)?C.replace(/^"(.*)"$/,"$1").replace(/\\"/g,'"').replace(/\\\\/g,"\\"):C}const m={default:([C,b,T])=>`${C} ${b} ${T||""}`,unquote:([C,b,T])=>{const A=P(C),R=P(T)||'""';return`${A} ${b} ${R}`}};function D(C){return C.startsWith("{")&&C.endsWith("}")}function x(C){const b=E(C);return[C.name,b,C.value]}function E(C){return C.isEqual?C.isRegex?r.ho.regex:r.ho.equal:C.isRegex?r.ho.notRegex:r.ho.notEqual}},78742:(_,L,e)=>{"use strict";e.d(L,{BK:()=>A,Cp:()=>w,D2:()=>N,ES:()=>H,GD:()=>R,Ht:()=>x,JM:()=>B,JZ:()=>G,KT:()=>b,NH:()=>S,S2:()=>m,Sl:()=>D,Yp:()=>f,bg:()=>v,c$:()=>O,i7:()=>P,i9:()=>I,nL:()=>T,qN:()=>j,qc:()=>W,qy:()=>C,u7:()=>z,w$:()=>y,y$:()=>U});var t=e(2543),n=e.n(t),r=e(61268),s=e(32264),a=e(17172),g=e(16233),i=e(18461),l=e(23662),d=e(64861),o=e(94822),u=e(55740),c=e(57220),p=e(32642),h=e(3704);function y(M,Q,Y){const q=(0,c.EV)(M),te=i.UP(q,Q),X=encodeURIComponent(i.$9(te)),ee=encodeURIComponent(q);return(0,h.G)(`/alerting/${ee}/${X}/view`,Y?{returnTo:Y}:{})}function f(M,Q){const{uid:Y,type:q}=M;return(0,h.G)("/explore",{left:JSON.stringify({datasource:M.uid,queries:[{refId:"A",datasource:{uid:Y,type:q},expr:Q}],range:{from:"now-1h",to:"now"}})})}function v(M,Q=""){return(0,h.G)(`/alerting/notifications/receivers/${encodeURIComponent(M)}/edit`,{alertmanager:Q})}function P(M,Q=""){return(0,h.G)("/alerting/routes/mute-timing/edit",{muteName:M,alertmanager:Q})}function m(M,Q){if((0,c.Eb)(M))return(0,h.z)(`/alerting/${encodeURIComponent(M.name)}/${encodeURIComponent((0,i.PH)(Q.name))}/find`);if((0,l.lT)(Q.rulerRule))return(0,h.z)(`/alerting/grafana/${Q.rulerRule.grafana_alert.uid}/view`)}function D(M){return M.reduce((Q,{key:Y,value:q})=>(Q[Y]=q,Q),{})}const x=M=>{const Q=M.queryString===void 0?void 0:String(M.queryString),Y=M.alertState===void 0?void 0:String(M.alertState),q=M.dataSource===void 0?void 0:String(M.dataSource),te=M.ruleType===void 0?void 0:String(M.ruleType),X=M.groupBy===void 0?void 0:String(M.groupBy).split(",");return{queryString:Q,alertState:Y,dataSource:q,groupBy:X,ruleType:te}},E=M=>({queryString:M.get("queryString")??void 0,contactPoint:M.get("contactPoint")??void 0}),C=M=>{const Q=M.queryString===void 0?void 0:String(M.queryString),Y=M.silenceState===void 0?void 0:String(M.silenceState);return{queryString:Q,silenceState:Y}};function b(M){return Object.entries(M).map(([Q,Y])=>({key:Q,value:Y}))}function T(M,Q,Y){const q=new URLSearchParams(Y);return Q&&q.set(u.DD,Q),`${M}?${q.toString()}`}function A(M,Q){const Y=new URLSearchParams;return Y.append("alertmanager",M),(0,p.J9)(Q).forEach((te,X)=>Y.append(X,te)),(0,h.G)("/alerting/silence/new",Y)}function R(M){return(0,h.G)(`/datasources/edit/${M}`)}function S(M){return(0,h.G)(`/dashboards/f/${M}`)}function O(M,Q){return(0,h.G)(`/dashboards/f/${M}/${Q}/alerting`)}function j(M){return(0,h.G)(`/dashboards/f/${M}/settings`)}function B(M){return(0,h.G)(`/d/${encodeURIComponent(M)}`)}function N(M,Q){const Y=new URLSearchParams({viewPanel:Q});return(0,h.G)(`/d/${encodeURIComponent(M)}`,Y)}function I(M,Q,Y,q=1e3){const te=new Date().getTime(),X=()=>M().catch(ee=>{if(Q(ee)&&new Date().getTime()-te<Y)return new Promise(ne=>setTimeout(ne,q)).then(X);throw ee});return X()}const K={[o.Gi.Alerting]:1,[o.cF.Firing]:1,[o.Gi.Error]:1,[o.Gi.Pending]:2,[o.cF.Pending]:2,[o.cF.Inactive]:2,[o.Gi.NoData]:3,[o.Gi.Normal]:4};function w(M,Q){if(M===d.xB.Importance)return(0,t.sortBy)(Q,q=>[K[(0,o.lh)(q.state)],(0,l.RI)(q).toLocaleLowerCase()]);if(M===d.xB.TimeAsc)return(0,t.sortBy)(Q,q=>[new Date(q.activeAt)||new Date,(0,l.RI)(q).toLocaleLowerCase()]);if(M===d.xB.TimeDesc)return(0,t.sortBy)(Q,q=>[new Date(q.activeAt)||new Date,(0,l.RI)(q).toLocaleLowerCase()]).reverse();const Y=(0,t.sortBy)(Q,q=>(0,l.RI)(q).toLocaleLowerCase());return M===d.xB.AlphaDesc&&Y.reverse(),Y}function U(){return s.$.buildInfo.edition===r.r.OpenSource}function W(){return g.TP.hasRole("Admin")||g.TP.isGrafanaAdmin}function H(){return s.$.buildInfo.env==="development"}function z(M){return!!(M&&typeof M=="object"&&"message"in M)}function G(M){return(0,a.NF)(M)?M.message?M.message:"message"in M.data&&typeof M.data.message=="string"?M.data.message:M.statusText?M.statusText:String(M.status)||"Unknown error":z(M)?M.cause?`${M.message}, cause: ${G(M.cause)}`:M.message:String(M)}},88467:(_,L,e)=>{"use strict";e.d(L,{$I:()=>u,BU:()=>x,CZ:()=>h,J7:()=>d,ML:()=>E,Vf:()=>m,Xw:()=>o,jA:()=>i,p0:()=>y,t4:()=>D,v5:()=>c});var t=e(65307),n=e(26272),r=e(17172),s=e(10096),a=e(25027),g=e(78742);const i=Object.freeze({loading:!1,result:void 0,error:void 0,dispatched:!1});function l(C,b=i,T){if(C.pending.match(T))return{result:b.result,loading:!0,error:b.error,dispatched:!0,requestId:T.meta.requestId};if(C.fulfilled.match(T)){if(b.requestId===void 0||b.requestId===T.meta.requestId)return{...b,result:T.payload,loading:!1,error:void 0}}else if(C.rejected.match(T)&&b.requestId===T.meta.requestId)return{...b,loading:!1,error:T.error};return b}function d(C,b){return(0,t.Z0)({name:C,initialState:i,reducers:{},extraReducers:T=>T.addDefaultCase((A,R)=>l(b,A,R))})}function o(C,b,T){return(0,t.Z0)({name:C,initialState:{},reducers:{},extraReducers:A=>A.addDefaultCase((R,S)=>{if((0,t.$S)(b)(S)){const O=S,j=T(O.meta.arg);return{...R,[j]:l(b,R[j],O)}}return R})})}function u(C){return C.catch(b=>{throw{message:h(b),code:b.statusCode}})}function c(C,b){return C.then(T=>(b.successMessage&&s.lE.emit(n.r1.alertSuccess,[b.successMessage]),T)).catch(T=>{const A=h(T);throw s.lE.emit(n.r1.alertError,[`${b.errorMessage??"Error"}: ${A}`]),T})}const p="Unknown Error";function h(C){if((0,r.NF)(C))if(C.data?.message){let b=C.data?.message;return typeof C.data?.error=="string"&&(b+=`; ${C.data.error}`),b}else{if(Array.isArray(C.data)&&C.data.length&&C.data[0]?.message)return C.data.map(b=>b?.message).filter(b=>!!b).join(" ");if(C.statusText)return C.statusText}return(0,g.u7)(C)?C.message:((0,a.fH)(a.le.unknownMessageFromError,{error:JSON.stringify(C)}),p)}function y(C){return Object.values(C).every(f)}function f(C){return C.dispatched&&!C.loading}function v(C){return Object.values(C).every(P)}function P(C){return C.dispatched&&!C.loading&&!C.error}function m(C){return Object.values(C).some(E)}function D(C){return Object.values(C).some(b=>b.dispatched)}function x(C){return Object.values(C).some(P)}function E(C){return C?C.dispatched&&C.loading:!1}},63066:(_,L,e)=>{"use strict";e.d(L,{Bu:()=>de,IJ:()=>R,J6:()=>Z,JE:()=>N,Os:()=>E,Q8:()=>x,QX:()=>M,Qk:()=>Q,Rk:()=>le,T6:()=>A,XI:()=>Y,Z9:()=>w,ir:()=>he,l1:()=>j,mp:()=>ne,qO:()=>q});var t=e(2543),n=e.n(t),r=e(43127),s=e(65879),a=e(77789),g=e(32264),i=e(19347),l=e(26657),d=e(81887),o=e(74730),u=e(66718),c=e(94822),p=e(55907),h=e(86590),y=e(75471),f=e(55740),v=e(57220),P=e(78742),m=e(23662),D=e(25968);const x="grafana.alerting.manualRouting",E="grafana.alerting.simplifiedQueryEditor",C=(0,D.P8)(g.$.unifiedAlerting?.minInterval??"10s"),b=(0,D.P8)("1m"),A=(0,D.an)((0,t.clamp)(C,b,1/0)),R=()=>{const{canCreateGrafanaRules:ie,canCreateCloudRules:J}=(0,y.Q9)();return Object.freeze({name:"",uid:"",labels:[{key:"",value:""}],annotations:f.kl,dataSourceName:v.hY,type:ie?h.Z.grafana:J?h.Z.cloudAlerting:void 0,group:"",folder:null,queries:[],recordingRulesQueries:[],condition:"",noDataState:c.Q8.NoData,execErrState:c.Q8.Error,evaluateFor:A,evaluateEvery:A,manualRouting:S(),contactPoints:{},overrideGrouping:!1,overrideTimings:!1,muteTimeIntervals:[],editorSettings:O(),namespace:"",expression:"",forTime:1,forTimeUnit:"m"})},S=()=>g.$.featureToggles.alertingSimplifiedRouting??!1?localStorage.getItem(x)!=="false":!1;function O(){return g.$.featureToggles.alertingQueryAndExpressionsStepMode??!1?{simplifiedQueryEditor:localStorage.getItem(E)!=="false"}:void 0}function j(ie){const{name:J,expression:ce,forTime:pe,forTimeUnit:Pe,keepFiringForTime:Ie,keepFiringForTimeUnit:ge,type:Se}=ie,De=(0,P.Sl)(U(ie.annotations)),Ke=(0,P.Sl)(W(ie.labels));if(Se===h.Z.cloudAlerting){let Me;return Ie&&ge&&(Me=`${Ie}${ge}`),{alert:J,for:`${pe}${Pe}`,keep_firing_for:Me,annotations:De,labels:Ke,expr:ce}}else if(Se===h.Z.cloudRecording)return{record:J,labels:Ke,expr:ce};throw new Error(`unexpected rule type: ${Se}`)}function B(ie,J){const ce=[...(0,P.KT)(ie||{})];return J&&ce.push({key:"",value:""}),ce}function N(ie){const J=[...ie];return f.kl.map(pe=>pe.key).forEach((pe,Pe)=>{const Ie=J.findIndex(ge=>ge.key===pe);if(Ie===-1){const ge={key:pe,value:""};J.splice(Pe,0,ge)}else Ie!==Pe&&J.splice(Pe,0,J.splice(Ie,1)[0])}),J}function I(ie,J){if(J?.grafana?.selectedContactPoint&&ie)return{receiver:J?.grafana?.selectedContactPoint,mute_time_intervals:J?.grafana?.muteTimeIntervals,group_by:J?.grafana?.overrideGrouping?J?.grafana?.groupBy:void 0,group_wait:J?.grafana?.overrideTimings&&J?.grafana?.groupWaitValue?J?.grafana?.groupWaitValue:void 0,group_interval:J?.grafana?.overrideTimings&&J?.grafana?.groupIntervalValue?J?.grafana?.groupIntervalValue:void 0,repeat_interval:J?.grafana?.overrideTimings&&J?.grafana?.repeatIntervalValue?J?.grafana?.repeatIntervalValue:void 0}}function K(ie){return{simplified_query_and_expressions_section:ie.simplifiedQueryEditor}}function w(ie){const{name:J,condition:ce,noDataState:pe,execErrState:Pe,evaluateFor:Ie,queries:ge,isPaused:Se,contactPoints:De,manualRouting:Ke,type:Me,metric:be}=ie;if(!ce)throw new Error("You cannot create an alert rule without specifying the alert condition");const we=I(Ke,De),Be=ie.editorSettings?{editor_settings:K(ie.editorSettings)}:void 0,He=(0,P.Sl)(U(ie.annotations)),Ve=(0,P.Sl)(W(ie.labels)),Je=(0,m.Mu)(Me),nt=(0,m.pq)(Me);if(Je)return{grafana_alert:{title:J,condition:ce,data:ge.map(re),is_paused:!!Se,no_data_state:pe,exec_err_state:Pe,notification_settings:we,metadata:Be},annotations:He,labels:Ve,for:Ie};if(nt)return{grafana_alert:{title:J,condition:ce,data:ge.map(re),is_paused:!!Se,record:{metric:be??J,from:ce}},annotations:He,labels:Ve};throw new Error(`Failed to convert form values to Grafana rule: unknown type ${Me}`)}const U=ie=>ie.map(H).filter(({key:J,value:ce})=>!!J&&!!ce),W=ie=>ie.map(H).filter(({key:J})=>!!J),H=({key:ie,value:J})=>({key:ie.trim(),value:J.trim()});function z(ie){const J=ie.notification_settings?{selectedContactPoint:ie.notification_settings.receiver,muteTimeIntervals:ie.notification_settings.mute_time_intervals??[],overrideGrouping:Array.isArray(ie.notification_settings.group_by)&&ie.notification_settings.group_by.length>0,overrideTimings:[ie.notification_settings.group_wait,ie.notification_settings.group_interval,ie.notification_settings.repeat_interval].some(Boolean),groupBy:ie.notification_settings.group_by||[],groupWaitValue:ie.notification_settings.group_wait||"",groupIntervalValue:ie.notification_settings.group_interval||"",repeatIntervalValue:ie.notification_settings.repeat_interval||""}:void 0;return J?{[v.hY]:J}:void 0}function G(ie){if(g.$.featureToggles.alertingQueryAndExpressionsStepMode)return ie.metadata?.editor_settings?{simplifiedQueryEditor:ie.metadata.editor_settings.simplified_query_and_expressions_section}:{simplifiedQueryEditor:!1}}function M(ie){const{ruleSourceName:J,namespace:ce,group:pe,rule:Pe}=ie,Ie=R();if((0,v.z2)(J))if((0,m.Gy)(Pe)){const ge=Pe.grafana_alert;return{...Ie,name:ge.title,type:h.Z.grafanaRecording,group:pe.name,evaluateEvery:pe.interval||Ie.evaluateEvery,queries:ge.data,condition:ge.condition,annotations:N(B(Pe.annotations,!1)),labels:B(Pe.labels,!0),folder:{title:ce,uid:ge.namespace_uid},isPaused:ge.is_paused,metric:ge.record?.metric}}else if((0,m.lT)(Pe)){const ge=Pe.grafana_alert,Se=z(ge);if(ge.no_data_state!==void 0&&ge.exec_err_state!==void 0)return{...Ie,name:ge.title,type:h.Z.grafana,group:pe.name,evaluateEvery:pe.interval||Ie.evaluateEvery,evaluateFor:Pe.for||"0",noDataState:ge.no_data_state,execErrState:ge.exec_err_state,queries:ge.data,condition:ge.condition,annotations:N(B(Pe.annotations,!1)),labels:B(Pe.labels,!0),folder:{title:ce,uid:ge.namespace_uid},isPaused:ge.is_paused,contactPoints:Se,manualRouting:!!Se,editorSettings:G(ge)};throw new Error("Unexpected type of rule for grafana rules source")}else throw new Error("Unexpected type of rule for grafana rules source");else if((0,m.$y)(Pe)){const Se={refId:"A",datasourceUid:(0,i.l)().getInstanceSettings(J)?.uid??"",queryType:"",relativeTimeRange:(0,r.Cn)(),expr:Pe.expr,model:{refId:"A",hide:!1,expr:Pe.expr}},De=Q(Pe);return{...Ie,...De,queries:[Se],annotations:N(B(Pe.annotations,!1)),type:h.Z.cloudAlerting,dataSourceName:J,namespace:ce,group:pe.name}}else if((0,m.i7)(Pe)){const ge=Y(Pe);return{...Ie,...ge,type:h.Z.cloudRecording,dataSourceName:J,namespace:ce,group:pe.name}}else throw new Error("Unexpected type of rule for cloud rules source")}function Q(ie){const J=R(),[ce,pe]=ie.for?(0,D.P1)(ie.for):[0,"s"],[Pe,Ie]=ie.keep_firing_for?(0,D.P1)(ie.keep_firing_for):[J.keepFiringForTime,J.keepFiringForTimeUnit];return{name:ie.alert,expression:ie.expr,forTime:ce,forTimeUnit:pe,keepFiringForTime:Pe,keepFiringForTimeUnit:Ie,annotations:B(ie.annotations,!1),labels:B(ie.labels,!0)}}function Y(ie){return{name:ie.record,expression:ie.expr,labels:B(ie.labels,!0)}}const q=()=>{const ie=(0,v.y9)();if(!ie)return[...X("A","B")];const J=(0,r.Cn)();return[{refId:"A",datasourceUid:ie.uid,queryType:"",relativeTimeRange:J,model:{refId:"A"}},...X("B","C")]},te=ie=>{const J=getDefaultRelativeTimeRange();return[{refId:"A",datasourceUid:ie[0]?.uid||"",queryType:"",relativeTimeRange:J,model:{refId:"A"}}]},X=(...ie)=>{const J=ie[0],ce=ie[1],pe={refId:ie[0],type:u.Tz.reduce,datasource:{uid:u.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[],type:p.p.IsAbove},operator:{type:"and"},query:{params:[J]},reducer:{params:[],type:"last"}}],reducer:"last",expression:"A"},Pe={refId:ce,type:u.Tz.threshold,datasource:{uid:u.Uj,type:l.dR.type},conditions:[{type:"query",evaluator:{params:[0],type:p.p.IsAbove},operator:{type:"and"},query:{params:[ce]},reducer:{params:[],type:"last"}}],expression:J};return[{refId:J,datasourceUid:u.Uj,queryType:"",model:pe},{refId:ce,datasourceUid:u.Uj,queryType:"",model:Pe}]},ee=async(ie,J,ce,pe,Pe,Ie)=>{const ge=[];for(const Se of ie){const De=await(0,i.l)().get(Se.datasource?.uid?Se.datasource:pe),Ke={uid:De.uid,type:De.type},Me=s.relativeToTimeRange(J),{interval:be,intervalMs:we}=ae(Me,Ie??De.interval,Pe),Be={__interval:{text:be,value:be},__interval_ms:{text:we,value:we},...ce},He=De.interpolateVariablesInQueries?De.interpolateVariablesInQueries([Se],Be)[0]:Se;if(Ke.uid===u.Uj){const Ve={refId:He.refId,queryType:"",relativeTimeRange:J,datasourceUid:u.Uj,model:He};ge.push(Ve)}else{const Ve=(0,i.l)().getInstanceSettings(Ke);if(Ve&&Ve.meta.alerting){const Je={refId:He.refId,queryType:He.queryType??"",relativeTimeRange:J,datasourceUid:Ve.uid,model:{...He,maxDataPoints:Pe,intervalMs:we}};ge.push(Je)}}}return ge},ne=async(ie,J)=>{const{targets:ce}=ie;if(!ie.id||!J.uid)return;const pe=s.timeRangeToRelative(s.convertRawToRange(J.time)),Pe=await ee(ce,pe,ie.scopedVars||{},ie.datasource??void 0,ie.maxDataPoints??void 0,ie.interval??void 0);if(!Pe.length||!Pe.find(De=>De.datasourceUid!==u.Uj))return;if(!Pe.find(De=>De.datasourceUid===u.Uj)){const[De,Ke]=X((0,a.M)(Pe),"-");Pe.push(De);const[Me,be]=X(De.refId,(0,a.M)(Pe));Pe.push(be)}const{folderTitle:Ie,folderUid:ge}=J.meta;return{type:h.Z.grafana,folder:ge&&Ie?{uid:ge,title:Ie}:void 0,queries:Pe,name:ie.title,condition:Pe[Pe.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:J.uid},{key:f.YH.panelID,value:String(ie.id)}]}},Z=async ie=>{if(!ie.state.key)return;const J=d.jh.getTimeRange(ie),ce=(0,o.un)(ie);if(!ce)return;const{queries:pe,datasource:Pe,maxDataPoints:Ie,minInterval:ge}=ce.state,Se=(0,o.YQ)(ie);if(!Se||!Se.state.uid)return;const De=await ee(pe,s.timeRangeToRelative(s.convertRawToRange(J.state.value.raw)),{__sceneObject:{value:ie}},Pe,Ie,ge);if(!De.length||!De.find(we=>we.datasourceUid!==u.Uj))return;if(!De.find(we=>we.datasourceUid===u.Uj)){const[we,Be]=X((0,a.M)(De),"-");De.push(we);const[He,Ve]=X(we.refId,(0,a.M)(De));De.push(Ve)}const{folderTitle:Ke,folderUid:Me}=Se.state.meta;return{type:h.Z.grafana,folder:Me&&Ke?{uid:Me,title:Ke}:void 0,queries:De,name:ie.state.title,condition:De[De.length-1].refId,annotations:[{key:f.YH.dashboardUID,value:Se.state.uid},{key:f.YH.panelID,value:String((0,o.Cs)(ie))}]}};function ae(ie,J,ce){return ce?s.calculateInterval(ie,ce,J):J&&s.intervalToMs(J)>1e3?{interval:J,intervalMs:s.intervalToMs(J)}:{interval:"1s",intervalMs:1e3}}function re(ie){const J=ie.model;return se(J)&&J.instant&&J.range?{...ie,model:{...J,range:!0,instant:!1}}:ie}function se(ie){return"expr"in ie&&"instant"in ie&&"range"in ie}function de(ie){return"expr"in ie}const le=ie=>({...ie,queries:ie.queries?.map(J=>(0,t.omit)(J,"model.hide"))});function he(ie){return le(M(ie))}},18461:(_,L,e)=>{"use strict";e.d(L,{$9:()=>E,LC:()=>p,Lg:()=>o,Ns:()=>b,P1:()=>l,PH:()=>P,UP:()=>u,VY:()=>j,c:()=>m,h1:()=>S,mw:()=>d,qg:()=>D,uE:()=>B,x6:()=>x});var t=e(2543),n=e.n(t),r=e(39601),s=e(94822),a=e(24608),g=e(57220),i=e(23662);function l(N,I,K,w){return(0,i.lT)(w)?{uid:w.grafana_alert.uid,ruleSourceName:"grafana"}:{ruleSourceName:N,namespace:I,groupName:K,ruleName:(0,i.$y)(w)?w.alert:w.record,rulerRuleHash:b(w)}}function d(N,I){const{dataSourceName:K,namespaceName:w,groupName:U}=N;return l(K,w,U,I)}function o(N,I,K,w){return{ruleSourceName:N,namespace:I,groupName:K,ruleName:w.name,ruleHash:A(w)}}function u(N,I){const K=I.namespace.name,w=I.group.name;if(I.rulerRule)return l(N,K,w,I.rulerRule);if(I.promRule)return o(N,K,w,I.promRule);throw new Error("Could not create an id for a rule that is missing both `rulerRule` and `promRule`.")}function c(N){return l(N.ruleSourceName,N.namespace,N.group.name,N.rule)}function p(N,I){return(0,i.A4)(N)&&(0,i.A4)(I)?N.uid===I.uid:(0,i.X4)(N)&&(0,i.X4)(I)?N.groupName===I.groupName&&N.namespace===I.namespace&&N.ruleName===I.ruleName&&N.rulerRuleHash===I.rulerRuleHash&&N.ruleSourceName===I.ruleSourceName:(0,i.Mj)(N)&&(0,i.Mj)(I)?N.groupName===I.groupName&&N.namespace===I.namespace&&N.ruleName===I.ruleName&&N.ruleHash===I.ruleHash&&N.ruleSourceName===I.ruleSourceName:(0,i.X4)(N)&&(0,i.Mj)(I)?N.groupName===I.groupName&&N.namespace===I.namespace&&N.ruleName===I.ruleName&&N.rulerRuleHash===I.ruleHash&&N.ruleSourceName===I.ruleSourceName:(0,i.Mj)(N)&&(0,i.X4)(I)?N.groupName===I.groupName&&N.namespace===I.namespace&&N.ruleName===I.ruleName&&N.ruleHash===I.rulerRuleHash&&N.ruleSourceName===I.ruleSourceName:!1}const h="cri",y="pri";function f(N){return N.replace(/\$/g,"_DOLLAR_")}function v(N){return N.replace(/\_DOLLAR\_/g,"$")}function P(N){return N.replace(/\//g,"").replace(/\\/g,"")}function m(N){return N.replace(/\x1f/g,"/").replace(/\x1e/g,"\\")}function D(N,I=!1){const w=(I?decodeURIComponent(N):N).split("$");if(w.length===1)return{uid:N,ruleSourceName:"grafana"};if(w.length===6){const[U,W,H,z,G,M]=w.map(v).map(m);if(U===h)return{ruleSourceName:W,namespace:H,groupName:z,ruleName:G,rulerRuleHash:M};if(U===y)return{ruleSourceName:W,namespace:H,groupName:z,ruleName:G,ruleHash:M}}throw new Error(`Failed to parse rule location: ${N}`)}function x(N,I=!1){if(N)try{return D(N,I)}catch{return}}function E(N){return(0,i.A4)(N)?N.uid:(0,i.X4)(N)?[h,N.ruleSourceName,N.namespace,N.groupName,N.ruleName,N.rulerRuleHash].map(String).map(f).map(P).join("$"):[y,N.ruleSourceName,N.namespace,N.groupName,N.ruleName,N.ruleHash].map(String).map(f).map(P).join("$")}function C(N){let I=0;if(N.length===0)return I;for(let K=0;K<N.length;K++){const w=N.charCodeAt(K);I=(I<<5)-I+w,I=I&I}return I}function b(N){if((0,i.lT)(N))return N.grafana_alert.uid;const I=T(N);return C(JSON.stringify(I)).toString()}function T(N){const K=(0,a.w)()?"":S(N.expr),w=O(N.labels);if((0,i.i7)(N))return[N.record,s.JS.Recording,K,w];if((0,i.$y)(N))return[N.alert,s.JS.Alerting,K,O(N.annotations),w];throw new Error("Only recording and alerting ruler rules can be hashed")}function A(N){const I=R(N);return C(JSON.stringify(I)).toString()}function R(N){const K=(0,a.w)()?"":S(N.query),w=O(N.labels);if((0,i.KB)(N))return[N.name,s.JS.Recording,K,w];if((0,i.Z8)(N))return[N.name,s.JS.Alerting,K,O(N.annotations),w];throw new Error("Only recording and alerting rules can be hashed")}function S(N){return N.length>1&&N[0]==="("&&N[N.length-1]===")"&&(N=N.slice(1,-1)),N=N.replace(/\s|\n/g,""),N.split("").sort().join("")}function O(N){return JSON.stringify(Object.entries(N||{}).sort((I,K)=>I[0].localeCompare(K[0])))}function j(N){return(0,i.A4)(N)?g.hY:N.ruleSourceName}function B(N){const{pathname:I=""}=r.Ny.getLocation(),{id:K}=N;return K?(0,t.nth)(I.split("/"),-2):void 0}},23662:(_,L,e)=>{"use strict";e.d(L,{$7:()=>C,$y:()=>h,A4:()=>b,BL:()=>se,Gy:()=>v,H2:()=>le,HH:()=>x,I2:()=>ee,KB:()=>p,Mj:()=>R,Mt:()=>D,Mu:()=>ae,OF:()=>de,Om:()=>M,RI:()=>E,Rh:()=>B,TU:()=>W,Tm:()=>K,UL:()=>f,Uw:()=>X,Wy:()=>z,X4:()=>T,XI:()=>w,YN:()=>Q,Z8:()=>c,dS:()=>H,f6:()=>O,fC:()=>j,i7:()=>y,j_:()=>ne,jg:()=>q,lT:()=>m,nf:()=>A,pq:()=>re,pv:()=>P,qz:()=>Y,s_:()=>ie,uo:()=>N,vE:()=>he,y1:()=>Z});var t=e(2543),n=e.n(t),r=e(43585),s=e(32264),a=e(94822),g=e(28475),i=e(86590),l=e(55740),d=e(57220),o=e(75214),u=e(25968);function c(J){return typeof J=="object"&&J.type===a.JS.Alerting}function p(J){return typeof J=="object"&&J.type===a.JS.Recording}function h(J){return typeof J=="object"&&"alert"in J}function y(J){return typeof J=="object"&&"record"in J}function f(J){return typeof J=="object"&&y(J)||m(J)&&"record"in J.grafana_alert}function v(J){return typeof J=="object"&&f(J)&&m(J)}function P(J){return typeof J=="object"&&m(J)&&!f(J)}function m(J){return typeof J=="object"&&"grafana_alert"in J}function D(J){return typeof J=="object"&&!m(J)}function x(J){return J&&m(J)&&!!J.grafana_alert.is_paused}function E(J){return JSON.stringify(J.labels)}function C(J){return J.error&&J.error?.message?.includes(l.UU)}function b(J){return"uid"in J}function T(J){return"rulerRuleHash"in J}function A(J){return Object.values(a.JS).includes(J)}function R(J){return"ruleHash"in J}function S(J){return b(J)||T(J)}function O(J){switch(J){case"ok":return g.Jc.Ok;case"nodata":return g.Jc.NoData;case"error":case"err":return g.Jc.Error;case"unknown":return g.Jc.Unknown;default:return}}function j(J){if(!(y(J.rulerRule)||p(J.promRule)||v(J.rulerRule))){if(h(J.rulerRule))return J.rulerRule.for;if(c(J.promRule)){const ce=(J.promRule.duration??0)*1e3;return(0,u.an)(ce)}}}function B(J){if(!(y(J.rulerRule)||p(J.promRule)||v(J.rulerRule)))return J.annotations??[]}function N(J){const ce=J.labels[o.lL];if(!ce)return;const pe=ce.match(/^plugin\/(?<pluginId>.+)$/);if(!pe?.groups)return;const Pe=pe.groups.pluginId;if(I(Pe))return{pluginId:Pe}}function I(J){return!!s.$.apps[J]}function K(J){return!!N(J)}function w(J){return J===a.cF.Inactive?"Normal":(0,t.capitalize)(J)}const U=J=>J.reduce((ce,{dataSourceName:pe,name:Pe,groups:Ie})=>(Ie.forEach(({name:ge,rules:Se})=>{Se.forEach(De=>{c(De)&&ce.push({dataSourceName:pe,namespaceName:Pe,groupName:ge,rule:De})})}),ce),[]),W=J=>c(J.promRule)?J.promRule:null,H=J=>J.reduce((ce,{rulesSource:pe,name:Pe,groups:Ie})=>(Ie.forEach(({name:ge,rules:Se})=>{Se.forEach(De=>{De.promRule&&c(De.promRule)&&ce.push({dataSourceName:(0,d.EV)(pe),namespaceName:Pe,groupName:ge,...De})})}),ce),[]);function z(J){let ce;return Object.values(r.O).includes(J)?ce=J:ce=(0,a.lh)(J),G[ce]}const G={[a.cF.Inactive]:"good",[a.cF.Firing]:"bad",[a.cF.Pending]:"warning",[a.Gi.Alerting]:"bad",[a.Gi.Error]:"bad",[a.Gi.NoData]:"info",[a.Gi.Normal]:"good",[a.Gi.Pending]:"warning",[r.O.NoData]:"info",[r.O.Paused]:"warning",[r.O.Alerting]:"bad",[r.O.OK]:"good",[r.O.Unknown]:"info"};function M(J){return J?.alerts?J.alerts.reduce((ce,pe)=>{const Pe=(0,a.lh)(pe.state)!==a.Gi.Normal;if(pe.activeAt&&Pe){const Ie=new Date(pe.activeAt);if(ce===null||ce.getTime()>Ie.getTime())return Ie}return ce},null):null}function Q(J){return Array.isArray(J.source_tenants)}function Y(J){return m(J)?J.grafana_alert.title:h(J)?J.alert:y(J)?J.record:""}const q=(J,ce)=>{const pe={alertName:"",forDuration:"0s",evaluationsToFire:0};return m(J)?{alertName:J.grafana_alert.title,forDuration:J.for,evaluationsToFire:J.for?te(J.for,ce):null}:h(J)?{alertName:J.alert,forDuration:J.for??"0s",evaluationsToFire:te(J.for??"0s",ce)}:pe},te=(J,ce)=>{const pe=(0,u.P8)(ce),Pe=(0,u.P8)(J);return Pe===0&&pe!==0?1:pe===0||Pe/pe<1?0:Math.ceil(Pe/pe)+1};function X(J){const ce=(0,d.z2)(J.namespace.rulesSource)?J.namespace.rulesSource:J.namespace.rulesSource.name,pe=m(J.rulerRule)?J.rulerRule.grafana_alert.namespace_uid:J.namespace.name;return{dataSourceName:ce,namespaceName:pe,groupName:J.group.name}}function ee(J){const ce=J.ruleSourceName,pe=m(J.rule)?J.rule.grafana_alert.namespace_uid:J.namespace,Pe=J.group.name;return{dataSourceName:ce,namespaceName:pe,groupName:Pe}}function ne(J){const ce=J.dataSourceName,pe=J.folder?.uid??J.namespace,Pe=J.group;if(!ce)throw new Error("no datasource name in form values");return{dataSourceName:ce,namespaceName:pe,groupName:Pe}}function Z(J){return(0,d.z2)(J)?J:J.name}function ae(J){return J===i.Z.grafana}function re(J){return J===i.Z.grafanaRecording}function se(J){return J===i.Z.cloudAlerting}function de(J){return J===i.Z.cloudRecording}function le(J){return ae(J)||re(J)}function he(J){return re(J)||de(J)}function ie(J){return se(J)||de(J)}},25968:(_,L,e)=>{"use strict";e.d(L,{M9:()=>d,P1:()=>n,P8:()=>u,TN:()=>a,an:()=>o,mo:()=>c,sc:()=>s,yl:()=>p});var t=e(41068);function n(h){const y=h.match(/(\d+)(\w+)/);if(y)return[Number(y[1]),y[2]];throw new Error(`Invalid interval description: ${h}`)}function r(h){const{sec:y,count:f}=describeInterval(h);return y*f}const s=Object.entries(t.y).map(([h,y])=>({label:h[0].toUpperCase()+h.slice(1),value:y}));function a(h){try{return d(h),!0}catch{return!1}}const g={ms:1,s:1e3,m:60*1e3,h:60*60*1e3,d:24*60*60*1e3,w:7*24*60*60*1e3,y:365*24*60*60*1e3},i=new RegExp(/^(?:(?<value>\d+)(?<type>ms|s|m|h|d|w|y))|0$/),l=new Error(`Must be of format "(number)(unit)", for example "1m", or just "0". Available units: ${Object.values(t.y).join(", ")}`);function d(h){let y=h;const f=[];function v(m){const D=i.exec(m),x=D?.groups?.value&&D?.groups?.type;if(!D||!x)throw l;D&&D.groups?.value&&D.groups?.type&&(y=y.replace(D[0],""),f.push([Number(D.groups.value),D.groups.type])),y&&v(y)}if(v(h),!f.length)throw l;return f.reduce((m,[D,x])=>{const E=D*g[x];return m+E},0)}function o(h){const y=Math.floor(h/1e3),f=Math.floor(y/60),v=Math.floor(f/60),P=Math.floor(v/24),m=Math.floor(P/7),D=Math.floor(P/365);return h===0?"0s":[[D,"y"],[m%52,"w"],[P%365-7*(m%52),"d"],[v%24,"h"],[f%60,"m"],[y%60,"s"],[h%1e3,"ms"]].filter(([E])=>E>0).map(([E,C])=>E+C).join("")}const u=h=>{try{return d(h)}catch{return 0}},c=h=>h.includes("0001-01-01T00");function p(h){return h%(1e3*60*60)===0?h/(1e3*60*60)+"h":h%(1e3*60)===0?h/(1e3*60)+"m":h%1e3===0?h/1e3+"s":h.toFixed()+"ms"}},3704:(_,L,e)=>{"use strict";e.d(L,{G:()=>n,z:()=>r});var t=e(32264);function n(s,a){const i=new URLSearchParams(a).toString();return`${t.$.appSubUrl}${s}${i?`?${i}`:""}`}function r(s,a){const i=new URLSearchParams(a).toString();try{return`${new URL(t.$.appSubUrl+s,t.$.appUrl).href}${i?`?${i}`:""}`}catch{return n(s,a)}}},10154:(_,L,e)=>{"use strict";e.d(L,{Xm:()=>s,rJ:()=>r,vJ:()=>n,vy:()=>a});var t=e(17172);function n(g){return(0,t.AI)().post("/api/annotations",g)}function r(g){return(0,t.AI)().put(`/api/annotations/${g.id}`,g)}function s(g){return(0,t.AI)().delete(`/api/annotations/${g.id}`)}async function a(){return(await(0,t.AI)().get("/api/annotations/tags")).result.tags.map(({tag:i,count:l})=>({term:i,count:l}))}},82241:(_,L,e)=>{"use strict";e.d(L,{A:()=>C});var t=e(74848),n=e(96540),r=e(75505),s=e(39070),a=e(76287),g=e(13544),i=e(68402),l=e(62930),d=e(55852),o=e(42418),u=e(14792),c=e(74856),p=e(34214),h=e(27302),y=e(42493),f=e(28240),v=e(8790),P=e(83195),m=e(56034),D=e(14578),x=e(90182);class E extends n.PureComponent{constructor(T){super(T),this.updateFields=()=>{const A=this.props.response?.panelData,R=A?.series?.[0]??A?.annotations?.[0];if(R&&R.fields){const S=R.fields.map(O=>{const j=(0,f.Ct)(O,R);let B="";for(let N=0;N<R.length;N++){if(N>0&&(B+=", "),N>2){B+="...";break}B+=O.values[N]}return B.length>50&&(B=B.substring(0,50)+"..."),{label:`${j} (${O.type})`,value:j,description:B}});this.setState({fieldNames:S})}},this.onFieldSourceChange=(A,R)=>{const S=this.props.mappings||{},O=S[A]||{};this.props.change({...S,[A]:{...O,source:R.value||v.V.Field}})},this.onFieldNameChange=(A,R)=>{const S=this.props.mappings||{};if(!R){const j={...this.props.mappings};delete j[A],this.props.change(j);return}const O=S[A]||{};this.props.change({...S,[A]:{...O,value:R.value,source:v.V.Field}})},this.state={fieldNames:[]}}componentDidMount(){this.updateFields()}componentDidUpdate(T){T.response!==this.props.response&&this.updateFields()}renderRow(T,A,R){const{fieldNames:S}=this.state;let O=[...S];const j=A.value;let B=S.find(I=>j===I.value);j&&!B&&O.push({label:j,value:j});let N=R?R[T.key]:"";if(N&&T.key.startsWith("time")){const I=(0,P.j_)("dateTimeAsIso");N=(0,P.cN)(I(N))}return N==null&&(N=""),(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{children:[T.label||T.key," ",T.help&&(0,t.jsx)(m.m,{content:T.help,children:(0,t.jsx)(D.I,{name:"info-circle"})})]}),(0,t.jsx)("td",{children:(0,t.jsx)(x.l6,{value:B,options:O,placeholder:T.placeholder||T.key,onChange:I=>{this.onFieldNameChange(T.key,I)},noOptionsMessage:"Unknown field names",allowCustomValue:!0,isClearable:!0})}),(0,t.jsx)("td",{children:`${N}`})]},T.key)}render(){const T=this.props.response?.events?.[0],A=this.props.mappings||{};return(0,t.jsxs)("table",{className:"filter-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Annotation"}),(0,t.jsx)("th",{children:"From"}),(0,t.jsx)("th",{children:"First Value"})]})}),(0,t.jsx)("tbody",{children:y.kj.map(R=>this.renderRow(R,A[R.key]||{},T))})]})}}class C extends n.PureComponent{constructor(){super(...arguments),this.state={},this.onRunQuery=async()=>{const{datasource:T,annotation:A}=this.props;if((0,y.E7)(T))return;const R=(0,u.UA)().getCurrent();if(!R)return;this.setState({running:!0});const S=await(0,r.s)((0,h.b)({range:(0,c.jG)().timeRange(),panel:new p.a({}),dashboard:R},T,A));this.setState({running:!1,response:S})},this.onQueryChange=T=>{this.props.onChange({...this.props.annotation,target:T})},this.onMappingChange=T=>{this.props.onChange({...this.props.annotation,mappings:T})},this.onAnnotationChange=T=>{this.props.onChange(T)}}componentDidMount(){this.verifyDataSource()}componentDidUpdate(T){this.props.annotation!==T.annotation&&!(0,y.E7)(this.props.datasource)&&this.verifyDataSource()}verifyDataSource(){const{datasource:T,annotation:A}=this.props,S={...y.CU,...T.annotations}.prepareAnnotation(A);S!==A?this.props.onChange(S):this.onRunQuery()}getStatusSeverity(T){const{events:A,panelData:R}=T;return R?.errors||R?.error?"error":A?.length?"success":"warning"}renderStatusText(T,A){const{events:R,panelData:S}=T;if(A||T?.panelData?.state===s.Gu.Loading||!T)return(0,t.jsx)("p",{children:"loading..."});if(S?.errors)return(0,t.jsx)(t.Fragment,{children:S.errors.map((j,B)=>(0,t.jsx)("p",{children:j.message},B))});if(S?.error)return(0,t.jsx)("p",{children:S.error.message??"There was an error fetching data"});if(!R?.length)return(0,t.jsx)("p",{children:"No events found"});const O=S?.series?.[0]??S?.annotations?.[0];return(0,t.jsxs)("p",{children:[R.length," events (from ",O?.fields.length," fields)"]})}renderStatus(){const{response:T,running:A}=this.state;return T?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.$,{v:2}),(0,t.jsx)("div",{children:A?(0,t.jsx)(l.y,{}):(0,t.jsx)(d.$n,{"data-testid":g.Tp.components.Annotations.editor.testButton,variant:"secondary",size:"xs",onClick:this.onRunQuery,children:"Test annotation query"})}),(0,t.jsx)(i.$,{v:2,layout:"block"}),(0,t.jsx)(o.F,{"data-testid":g.Tp.components.Annotations.editor.resultContainer,severity:this.getStatusSeverity(T),title:"Query result",children:this.renderStatusText(T,A)})]}):null}render(){const{datasource:T,annotation:A,datasourceInstanceSettings:R}=this.props,{response:S}=this.state;let O=T.annotations?.QueryEditor||T.components?.QueryEditor;if(!O)return(0,t.jsx)("div",{children:"Annotations are not supported. This datasource needs to export a QueryEditor"});const j={...T.annotations?.getDefaultQuery?.(),...A.target??{refId:"Anno"}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.p,{instanceSettings:R,children:(0,t.jsx)(O,{query:j,datasource:T,onChange:this.onQueryChange,onRunQuery:this.onRunQuery,data:S?.panelData,range:(0,c.jG)().timeRange(),annotation:A,onAnnotationChange:this.onAnnotationChange},T?.name)}),(0,y.JX)(T)&&(0,t.jsxs)(t.Fragment,{children:[this.renderStatus(),(0,t.jsx)(E,{response:S,mappings:A.mappings,change:this.onMappingChange})]})]})}}},27302:(_,L,e)=>{"use strict";e.d(L,{b:()=>o});var t=e(62467),n=e(69862),r=e(81160),s=e(65879),a=e(41987),g=e(39374),i=e(42493);let l=100;function d(){return"AQ"+l++}function o(u,c,p){const h={...i.CU,...c.annotations},y={...h.getDefaultQuery?.(),...p},f=h.prepareAnnotation(y);if(!f)return(0,t.of)({});const v=h.prepareQuery(f);if(!v)return(0,t.of)({});const P=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,m=s.calculateInterval(u.range,P,c.interval),D={__interval:{text:m.interval,value:m.interval},__interval_ms:{text:m.intervalMs.toString(),value:m.intervalMs},__annotation:{text:f.name,value:f}},x={startTime:Date.now(),requestId:d(),range:u.range,maxDataPoints:P,scopedVars:D,...m,app:a.Jk.Dashboard,timezone:u.dashboard.timezone,targets:[{...v,refId:"Anno"}]};return(0,g.BN)(c,x).pipe((0,n.Z)(E=>{const C=E?.series.length?E.series:E.annotations;return C?.length?h.processEvents(f,C).pipe((0,r.T)(b=>({panelData:E,events:b}))):(0,t.of)({panelData:E,events:[]})}))}},42493:(_,L,e)=>{"use strict";e.d(L,{CU:()=>u,E7:()=>m,JX:()=>P,kj:()=>p});var t=e(2543),n=e.n(t),r=e(62467),s=e(69862),a=e(81160),g=e(97522),i=e(11261),l=e(28240),d=e(8790),o=e(2913);const u={prepareAnnotation:D=>{if((0,t.isString)(D?.query)){const{query:x,...E}=D;return{...E,target:{refId:"annotation_query",query:x},mappings:{}}}return D},prepareQuery:D=>D.target,processEvents:(D,x)=>f(x,D.mappings)};function c(){return D=>D.pipe((0,s.Z)(x=>{if(!x?.length)return(0,r.of)(void 0);if(x.length===1)return(0,r.of)(x[0]);const E={interpolate:C=>C};return(0,r.of)(x).pipe(g.c.mergeTransformer.operator({},E),(0,a.T)(C=>C[0]))}))}const p=[{key:"time",field:D=>D.fields.find(x=>x.type===i.PU.time),placeholder:"time, or the first time field"},{key:"timeEnd",label:"end time",help:"When this field is defined, the annotation will be treated as a range"},{key:"title"},{key:"text",field:D=>D.fields.find(x=>x.type===i.PU.string),placeholder:"text, or the first text field"},{key:"tags",split:",",help:"The results will be split on comma (,)"},{key:"id"}],h=[{key:"color"},{key:"isRegion"},{key:"source"}],y=[...o.$W.publicDashboardAccessToken?h:[],...p,{key:"userId"},{key:"login"},{key:"email"},{key:"prevState"},{key:"newState"},{key:"data"},{key:"panelId"},{key:"alertId"},{key:"dashboardId"},{key:"dashboardUID"}];function f(D,x){return(0,r.of)(D).pipe(c(),(0,a.T)(E=>{if(!E?.length)return[];let C=!1,b=!1;const T={};for(const S of E.fields){const O=(0,l.Ct)(S,E);T[O.toLowerCase()]=S}x||(x={});const A=[];for(const S of y){const O=x[S.key]||{};if(O.source===d.V.Skip)continue;const j={key:S.key,split:S.split};if(O.source===d.V.Text)j.text=O.value;else{const B=(O.value||S.key).toLowerCase();j.field=T[B],!j.field&&S.field&&(j.field=S.field(E))}(j.field||j.text)&&(A.push(j),j.key==="time"?C=!0:j.key==="text"&&(b=!0))}if(!C||!b)return console.error("Cannot process annotation fields. No time or text present."),[];const R=[];for(let S=0;S<E.length;S++){const O={type:"default",color:"red"};for(const j of A){let B;if(j.text)B=j.text;else if(j.field&&(B=j.field.values[S],B!==void 0&&j.regex)){const N=j.regex.exec(B);N&&(B=N[1]?N[1]:N[0])}B!=null&&(j.split&&typeof B=="string"&&(B=B.split(",")),O[j.key]=B)}R.push(O)}return R}))}const v=["prometheus","loki","elasticsearch","grafana-opensearch-datasource"];function P(D){const{type:x}=D;return!(x==="datasource"||v.includes(x))}function m(D){const{type:x}=D;return v.includes(x)}},93584:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>o,QB:()=>l,Ri:()=>i,Sf:()=>s,cV:()=>a,h8:()=>g});var t=e(65307);const n={hasFetched:!1,includeExpired:!1,keys:[],keysIncludingExpired:[],searchQuery:"",migrationResult:{total:0,migrated:0,failed:0,failedApikeyIDs:[0],failedDetails:[]}},r=(0,t.Z0)({name:"apiKeys",initialState:n,reducers:{apiKeysLoaded:(u,c)=>{const{keys:p,keysIncludingExpired:h}=c.payload,y=c.payload.keys.length===0&&c.payload.keysIncludingExpired.length>0?!0:u.includeExpired;return{...u,hasFetched:!0,keys:p,keysIncludingExpired:h,includeExpired:y}},setSearchQuery:(u,c)=>({...u,searchQuery:c.payload}),includeExpiredToggled:u=>({...u,includeExpired:!u.includeExpired}),isFetching:u=>({...u,hasFetched:!1}),setMigrationResult:(u,c)=>({...u,migrationResult:c.payload})}}),{apiKeysLoaded:s,includeExpiredToggled:a,isFetching:g,setSearchQuery:i,setMigrationResult:l}=r.actions,o={apiKeys:r.reducer}},2468:(_,L,e)=>{"use strict";e.d(L,{H:()=>i,w:()=>a});var t=e(32264),n=e(17172),r=e(10096),s=e(48814);class a{constructor(d,o=!0){const u=o?`namespaces/${t.$.namespace}/`:"";this.url=`/apis/${d.group}/${d.version}/${u}${d.resource}`}async get(d){return(0,n.AI)().get(`${this.url}/${d}`)}async subresource(d,o){return(0,n.AI)().get(`${this.url}/${d}/${o}`)}async list(d){const o=d||{};return o.labelSelector=this.parseListOptionsSelector(o?.labelSelector),o.fieldSelector=this.parseListOptionsSelector(o?.fieldSelector),(0,n.AI)().get(this.url,d)}async create(d){if(!d.metadata.name&&!d.metadata.generateName){const o=r.TP.user.login;d.metadata.generateName=o?o.slice(0,2):"g"}return g(d.metadata),(0,n.AI)().post(this.url,d)}async update(d){return g(d.metadata),(0,n.AI)().put(`${this.url}/${d.metadata.name}`,d)}async delete(d){return(0,n.AI)().delete(`${this.url}/${d}`)}parseListOptionsSelector(d){return Array.isArray(d)?d.map(o=>{const u=String(o.key),c=o.operator;switch(c){case"=":case"!=":return`${u}${c}${o.value}`;case"in":case"notin":return`${u} ${c} (${o.value.join(",")})`;case"":case"!":return`${c}${u}`;default:return null}}).filter(Boolean).join(","):d}}function g(l){l.annotations||(l.annotations={}),l.annotations[s.dc]="UI",l.annotations[s.zv]=window.location.pathname,l.annotations[s.M8]=t.$.buildInfo.versionString}class i{async get(d){if(this.apiVersions)return this.apiVersions[d];const o=await(0,n.AI)().get("/apis"),u={};return o.groups.forEach(c=>{if(c.name.includes("datasource.grafana.app")){const p=c.name.split(".")[0];u[p]=c.preferredVersion.version,p.endsWith("-datasource")||(p.includes("-")?u[`${p}-datasource`]=c.preferredVersion.version:u[`grafana-${p}-datasource`]=c.preferredVersion.version)}}),this.apiVersions=u,u[d]}}},48814:(_,L,e)=>{"use strict";e.d(L,{M8:()=>d,dc:()=>i,ew:()=>s,fY:()=>a,zv:()=>l});const t="grafana.app/createdBy",n="grafana.app/updatedTimestamp",r="grafana.app/updatedBy",s="grafana.app/folder",a="grafana.app/message",g="grafana.app/slug",i="grafana.app/originName",l="grafana.app/originPath",d="grafana.app/originHash",o="grafana.app/originTimestamp"},73399:(_,L,e)=>{"use strict";e.d(L,{getAuthProviderStatus:()=>u,getRegisteredAuthProviders:()=>l,initAuthConfig:()=>c});var t=e(2913),n=e(10096),r=e(27677),s=e(31678);const a=[],g={};function i(h,y){a.find(f=>f.id===h.id)||(a.push(h),y&&(g[h.id]=y))}function l(){return a}function d(h){return a.find(y=>y.id===h)}function o(h){const y=[];for(const[f,v]of Object.entries(h)){const P=a.find(m=>`auth.${m.id}`===f);if(P){const m={...v,providerId:P.id,displayName:v.name||P.displayName};y.push(m)}}return y}async function u(h){if(g[h]){const y=g[h];return y()}return{configured:!1,enabled:!1}}function c(){if(t.Ay.featureToggles.ssoSettingsApi&&t.Ay.featureToggles.ssoSettingsLDAP)return;i({id:"ldap",type:"LDAP",protocol:"LDAP",displayName:"LDAP",configPath:"ldap"},p)}async function p(){if(n.TP.hasPermission(s.AccessControlAction.SettingsRead)){const y=(await(0,r.AI)().get("/api/admin/settings"))["auth.ldap"]||{};return{configured:y.enabled==="true",enabled:y.enabled==="true",hide:y.enabled!=="true"}}return{configured:!1,enabled:!1}}},20604:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>h,MH:()=>i,Nh:()=>l,Oy:()=>c,SH:()=>d,TO:()=>a,jA:()=>s,sr:()=>g});var t=e(65307);const n={settings:{},providerStatuses:{},isLoading:!1,providers:[]},r=(0,t.Z0)({name:"authConfig",initialState:n,reducers:{settingsUpdated:(y,f)=>({...y,settings:f.payload}),providerStatusesLoaded:(y,f)=>({...y,providerStatuses:f.payload}),loadingBegin:y=>({...y,isLoading:!0}),loadingEnd:y=>({...y,isLoading:!1}),setError:(y,f)=>({...y,updateError:f.payload}),resetError:y=>({...y,updateError:void 0}),setWarning:(y,f)=>({...y,warning:f.payload}),resetWarning:y=>({...y,warning:void 0}),providersLoaded:(y,f)=>({...y,providers:f.payload})}}),{settingsUpdated:s,providerStatusesLoaded:a,loadingBegin:g,loadingEnd:i,setError:l,resetError:d,setWarning:o,resetWarning:u,providersLoaded:c}=r.actions,h={authConfig:r.reducer}},55314:(_,L,e)=>{"use strict";e.d(L,{D$:()=>B,G2:()=>C,Ko:()=>x,Vc:()=>R,aF:()=>T,cU:()=>m,e8:()=>S,hT:()=>v.hT,iB:()=>O,kH:()=>b,uz:()=>E,vR:()=>j,vZ:()=>D,wt:()=>A});var t=e(75816),n=e(75505),r=e(71733),s=e(39070),a=e(26272),g=e(17172),i=e(39601),l=e(82467),d=e(28138),o=e(3169),u=e(10096),c=e(28676),p=e(6473),h=e(8484),y=e(37690),f=e(92955),v=e(10378);function P({baseURL:N}){async function I(K){K=K.url==="/folders/general"?{...K,showErrorAlert:!1}:K;try{const{data:U,...W}=await(0,n.s)((0,g.AI)().fetch({...K,url:N+K.url}));return{data:U,meta:W}}catch(U){return K.manageError?K.manageError(U):{error:U}}}return I}const m=(0,t.xP)({tagTypes:["getFolder"],reducerPath:"browseDashboardsAPI",baseQuery:P({baseURL:"/api"}),endpoints:N=>({listFolders:N.query({providesTags:I=>I?.map(K=>({type:"getFolder",id:K.uid}))??[],query:({parentUid:I,limit:K,page:w,permission:U})=>({url:"/folders",params:{parentUid:I,limit:K,page:w,permission:U}})}),getFolder:N.query({providesTags:(I,K,w)=>[{type:"getFolder",id:w}],query:I=>({url:`/folders/${I}`,params:{accesscontrol:!0}})}),newFolder:N.mutation({query:({title:I,parentUid:K})=>({method:"POST",url:"/folders",data:{title:I,parentUid:K}}),onQueryStarted:({parentUid:I},{queryFulfilled:K,dispatch:w})=>{K.then(async({data:U})=>{await u.TP.fetchUserPermissions(),w((0,l.dx)((0,o.tZ)("Folder created"))),w((0,y.bw)({parentUID:I,pageSize:f.md})),i.Ny.push(r.I.stripBaseFromUrl(U.url))})}}),saveFolder:N.mutation({invalidatesTags:["getFolder"],query:({uid:I,title:K,version:w})=>({method:"PUT",url:`/folders/${I}`,data:{title:K,version:w}}),onQueryStarted:({parentUid:I},{queryFulfilled:K,dispatch:w})=>{K.then(()=>{w((0,y.bw)({parentUID:I,pageSize:f.md}))})}}),moveFolder:N.mutation({invalidatesTags:["getFolder"],query:({folder:I,destinationUID:K})=>({url:`/folders/${I.uid}/move`,method:"POST",data:{parentUID:K}}),onQueryStarted:({folder:I,destinationUID:K},{queryFulfilled:w,dispatch:U})=>{const{parentUid:W}=I;w.then(()=>{U((0,y.bw)({parentUID:W,pageSize:f.md})),U((0,y.bw)({parentUID:K,pageSize:f.md}))})}}),deleteFolder:N.mutation({query:({uid:I})=>({url:`/folders/${I}`,method:"DELETE",params:{forceDeleteRules:!1}}),onQueryStarted:({parentUid:I},{queryFulfilled:K,dispatch:w})=>{K.then(()=>{w((0,y.bw)({parentUID:I,pageSize:f.md}))})}}),getAffectedItems:N.query({keepUnusedDataFor:0,queryFn:async I=>{const w=Object.keys(I.folder).filter(H=>I.folder[H]).map(H=>(0,g.AI)().get(`/api/folders/${H}/counts`)),U=await Promise.all(w),W={folder:Object.values(I.folder).filter(s.zz).length,dashboard:Object.values(I.dashboard).filter(s.zz).length,libraryPanel:0,alertRule:0};for(const H of U)W.folder+=H.folder??0,W.dashboard+=H.dashboard,W.alertRule+=H.alertrule,W.libraryPanel+=H.librarypanel;return{data:W}}}),moveItems:N.mutation({invalidatesTags:["getFolder"],queryFn:async({selectedItems:I,destinationUID:K},w,U,W)=>{const H=Object.keys(I.dashboard).filter(G=>I.dashboard[G]),z=Object.keys(I.folder).filter(G=>I.folder[G]);for(const G of z)await W({url:`/folders/${G}/move`,method:"POST",data:{parentUID:K}});for(const G of H){const Q={dashboard:(await(0,c.n)().getDashboardDTO(G)).dashboard,folderUid:K,overwrite:!1,message:""};await W({url:"/dashboards/db",method:"POST",data:Q})}return{data:void 0}},onQueryStarted:({destinationUID:I,selectedItems:K},{queryFulfilled:w,dispatch:U})=>{const W=Object.keys(K.dashboard).filter(z=>K.dashboard[z]),H=Object.keys(K.folder).filter(z=>K.folder[z]);w.then(()=>{U((0,y.bw)({parentUID:I,pageSize:f.md})),U((0,y.Zw)([...H,...W]))})}}),deleteItems:N.mutation({queryFn:async({selectedItems:I},K,w,U)=>{const W=Object.keys(I.dashboard).filter(z=>I.dashboard[z]),H=Object.keys(I.folder).filter(z=>I.folder[z]);for(const z of H)await U({url:`/folders/${z}`,method:"DELETE",params:{forceDeleteRules:!1}});for(const z of W){const M=(await U({url:`/dashboards/uid/${z}`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;M&&d.A.publish({type:a.r1.alertSuccess.name,payload:[(0,h.t)("browse-dashboards.soft-delete.success","Dashboard {{name}} moved to Recently deleted",{name:M})]})}return{data:void 0}},onQueryStarted:({selectedItems:I},{queryFulfilled:K,dispatch:w})=>{const U=Object.keys(I.dashboard).filter(H=>I.dashboard[H]),W=Object.keys(I.folder).filter(H=>I.folder[H]);K.then(()=>{w((0,y.Zw)([...W,...U]))})}}),saveDashboard:N.mutation({queryFn:async I=>{try{return{data:await(0,c.n)().saveDashboard(I)}}catch(K){return{error:K}}},onQueryStarted:({folderUid:I},{queryFulfilled:K,dispatch:w})=>{p.t.ignoreNextSave(),K.then(async()=>{await u.TP.fetchUserPermissions(),w((0,y.bw)({parentUID:I,pageSize:f.md}))})}}),importDashboard:N.mutation({query:({dashboard:I,overwrite:K,inputs:w,folderUid:U})=>({method:"POST",url:"/dashboards/import",data:{dashboard:I,overwrite:K,inputs:w,folderUid:U}}),onQueryStarted:({folderUid:I},{queryFulfilled:K,dispatch:w})=>{K.then(async U=>{w((0,y.bw)({parentUID:I,pageSize:f.md}));const W=r.I.stripBaseFromUrl(U.data.importedUrl);i.Ny.push(W)})}}),restoreDashboard:N.mutation({query:({dashboardUID:I,targetFolderUID:K})=>({url:`/dashboards/uid/${I}/trash`,data:{folderUid:K},method:"PATCH"})}),hardDeleteDashboard:N.mutation({queryFn:async({dashboardUID:I},K,w,U)=>{const H=(await U({url:`/dashboards/uid/${I}/trash`,method:"DELETE",showSuccessAlert:!1}))?.data?.title;return H&&d.A.publish({type:a.r1.alertSuccess.name,payload:[(0,h.t)("browse-dashboards.hard-delete.success","Dashboard {{name}} deleted",{name:H})]}),{data:void 0}},onQueryStarted:({dashboardUID:I},{queryFulfilled:K,dispatch:w})=>{K.then(()=>{w((0,y.Zw)([I]))})}})})}),{endpoints:D,useDeleteFolderMutation:x,useDeleteItemsMutation:E,useGetAffectedItemsQuery:C,useGetFolderQuery:b,useMoveFolderMutation:T,useMoveItemsMutation:A,useNewFolderMutation:R,useSaveDashboardMutation:S,useSaveFolderMutation:O,useRestoreDashboardMutation:j,useHardDeleteDashboardMutation:B}=m},92955:(_,L,e)=>{"use strict";e.d(L,{aw:()=>u,md:()=>d,uT:()=>o});var t=e(32264),n=e(17172),r=e(53477),s=e(65812),a=e(40957),g=e(10096),i=e(31678),l=e(49952);const d=50;async function o(c,p,h=1,y=d){if(c&&!t.$.featureToggles.nestedFolders)return[];const f=(0,n.AI)();let v=[];g.TP.hasPermission(i.AccessControlAction.FoldersRead)&&(v=await f.get("/api/folders",{parentUid:c,page:h,limit:y}));const P=t.$.appSubUrl??"";return v.map(m=>({kind:"folder",uid:m.uid,title:m.title,parentTitle:p,parentUID:c,url:(0,l.I)(m.uid)?void 0:`${P}/dashboards/f/${m.uid}/`}))}async function u(c,p=1,h=d){const f=await(0,s.getGrafanaSearcher)().search({kind:["dashboard"],query:"*",location:c||"general",from:(p-1)*h,limit:h});return f.view.map(v=>{const P=(0,a.hI)(v,f.view);return P.parentUID===r.TF&&(P.parentUID=void 0),P})}},43907:(_,L,e)=>{"use strict";e.d(L,{x:()=>l});var t=e(74848),n=e(70255),r=e(94753),s=e(42418),a=e(55314),g=e(8484);function i(d,o,u,c){const p=d+o+u+c,h=[];d&&h.push((0,g.t)("browse-dashboards.counts.folder","{{count}} folder",{count:d})),o&&h.push((0,g.t)("browse-dashboards.counts.dashboard","{{count}} dashboard",{count:o})),u&&h.push((0,g.t)("browse-dashboards.counts.libraryPanel","{{count}} library panel",{count:u})),c&&h.push((0,g.t)("browse-dashboards.counts.alertRule","{{count}} alert rule",{count:c}));let y=(0,g.t)("browse-dashboards.counts.total","{{count}} item",{count:p});return h.length>0&&(y+=`: ${h.join(", ")}`),y}const l=({selectedItems:d})=>{const{data:o,isFetching:u,isLoading:c,error:p}=(0,a.G2)(d);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.E,{element:"p",color:"secondary",children:[o&&i(o.folder,o.dashboard,o.libraryPanel,o.alertRule),(u||c)&&(0,t.jsx)(n.A,{width:200})]}),p&&(0,t.jsx)(s.F,{severity:"error",title:"Unable to retrieve descendant information"})]})}},49952:(_,L,e)=>{"use strict";e.d(L,{I:()=>r,e:()=>n});var t=e(32264);function n(s,a){return s+a.uid}function r(s){return s===t.$.sharedWithMeFolderUID}},36141:(_,L,e)=>{"use strict";e.d(L,{Ii:()=>i,Zw:()=>a,bw:()=>g});var t=e(53477),n=e(31678),r=e(92955),s=e(93519);const a=(0,n.createAsyncThunk)("browseDashboards/refreshParents",async(l,{getState:d,dispatch:o})=>{const{browseDashboards:u}=d(),{rootItems:c,childrenByParentUID:p}=u,h=new Set;for(const y of l){const f=(0,s.R)(c?.items??[],p,y);h.add(f?.parentUID)}for(const y of h)o(g({parentUID:y,pageSize:r.md}))}),g=(0,n.createAsyncThunk)("browseDashboards/refetchChildren",async({parentUID:l,pageSize:d})=>{const o=l===t.TF?void 0:l;let u=1,c="folder",p=await(0,r.uT)(o,void 0,u,d),h=p.length<d;if(c==="folder"&&h){c="dashboard",u=1;const y=await(0,r.aw)(o,u,d);h=y.length<d,p=p.concat(y)}return{children:p,lastPageOfKind:h,page:u,kind:c}}),i=(0,n.createAsyncThunk)("browseDashboards/fetchNextChildrenPage",async({parentUID:l,excludeKinds:d=[],pageSize:o},u)=>{const c=!d.includes("dashboard"),p=l===t.TF?void 0:l,h=u.getState().browseDashboards,y=p?h.childrenByParentUID[p]:h.rootItems;let f=1,v;if(y?y.lastFetchedKind==="dashboard"&&!y.lastKindHasMoreItems?console.warn(`fetchNextChildrenPage called for ${p} but that collection is fully loaded`):y.lastFetchedKind==="folder"&&y.lastKindHasMoreItems?(f=y.lastFetchedPage+1,v="folder"):c&&(f=y.lastFetchedKind==="folder"?1:y.lastFetchedPage+1,v="dashboard"):(f=1,v="folder"),!v)return;let P=v==="folder"?await(0,r.uT)(p,void 0,f,o):await(0,r.aw)(p,f,o),m=P.length<o;if(v==="folder"&&m&&c){v="dashboard",f=1;const D=await(0,r.aw)(p,f,o);m=D.length<o,P=P.concat(D)}return{children:P,lastPageOfKind:m,page:f,kind:v}})},37690:(_,L,e)=>{"use strict";e.d(L,{Am:()=>o,xN:()=>t.xN,Ii:()=>n.Ii,bw:()=>n.bw,Zw:()=>n.Zw,ku:()=>d,cT:()=>t.cT,wn:()=>t.wn,t$:()=>t.t$,xK:()=>x,eC:()=>f,Ms:()=>m,V6:()=>D,q0:()=>v,QE:()=>P,Zg:()=>E});var t=e(79763),n=e(36141),r=e(96540),s=e(25508),a=e(31678),g=e(92955),i=e(49952),l=e(93519);const d=b=>b.browseDashboards.rootItems,o=b=>b.browseDashboards.childrenByParentUID,u=b=>b.browseDashboards.openFolders,c=b=>b.browseDashboards.selectedItems,p=(0,s.Mz)(d,o,u,(b,T)=>T,(b,T,A,R)=>C(R,b,T,A)),h=(0,s.Mz)(c,b=>Object.values(b).some(T=>Object.values(T).some(A=>A))),y=(0,s.Mz)(c,o,(b,T)=>{const A={dashboard:{...b.dashboard},folder:{...b.folder}};for(const R of Object.keys(b.folder))if(b.folder[R]){const O=T[R];if(O)for(const j of O.items)j.kind==="dashboard"&&(A.dashboard[j.uid]=!1),j.kind==="folder"&&(A.folder[j.uid]=!1)}return A});function f(b){return(0,a.useSelector)(T=>(b?T.browseDashboards.childrenByParentUID[b]:T.browseDashboards.rootItems)?"fulfilled":"pending")}function v(b){return(0,a.useSelector)(T=>p(T,b))}function P(){return(0,a.useSelector)(b=>h(b))}function m(){return(0,a.useSelector)(c)}function D(){return(0,a.useSelector)(b=>b.browseDashboards.childrenByParentUID)}function x(){return(0,a.useSelector)(b=>y(b))}function E(b=[]){const T=(0,a.useDispatch)(),A=(0,r.useRef)(!1);return(0,r.useCallback)(S=>{if(A.current)return Promise.resolve();A.current=!0;const O=T((0,n.Ii)({parentUID:S,excludeKinds:b,pageSize:g.md}));return O.finally(()=>A.current=!1),O},[T,b])}function C(b,T,A,R,S=0,O=[],j=[]){function B(H,z,G){if(O.includes(H.kind)||j.includes(H.uid))return[];const M=C(H.uid,T,A,R,G+1,O,j),Q=!!R[H.uid],Y=A[H.uid]?.items.length===0;Q&&Y&&!O.includes("empty-folder")&&M.push({isOpen:!1,level:G+1,item:{kind:"ui",uiKind:"empty-folder",uid:H.uid+"empty-folder"},parentUID:z});const q={item:H,parentUID:z,level:G,isOpen:Q},te=[q,...M];return(0,i.I)(q.item.uid)&&te.push({item:{kind:"ui",uiKind:"divider",uid:"shared-with-me-divider"},parentUID:z,level:G+1,isOpen:!1}),te}const N=b&&R[b]||S===0,I=b?A[b]:T;let w=((b?N&&I?.items:I?.items)||[]).flatMap(H=>B(H,b,S));const U=O.includes("dashboard")&&I?.lastFetchedKind==="dashboard";return(S===0&&!I||N&&I&&!(I.isFullyLoaded||U))&&(w=w.concat((0,l.T)(g.md,b,S))),w}},79763:(_,L,e)=>{"use strict";e.d(L,{xN:()=>x,Ay:()=>E,cT:()=>D,wn:()=>P,t$:()=>m});var t={};e.r(t),e.d(t,{clearFolders:()=>u,fetchNextChildrenPageFulfilled:()=>i,refetchChildrenFulfilled:()=>g,setAllSelection:()=>o,setFolderOpenState:()=>l,setItemSelectionState:()=>d});var n=e(65307),r=e(36141),s=e(49952),a=e(93519);function g(C,b){const{children:T,page:A,kind:R,lastPageOfKind:S}=b.payload,{parentUID:O}=b.meta.arg,j={items:T,lastFetchedKind:R,lastFetchedPage:A,lastKindHasMoreItems:!S,isFullyLoaded:R==="dashboard"&&S};O?C.childrenByParentUID[O]=j:C.rootItems=j}function i(C,b){const T=b.payload;if(!T)return;const{children:A,page:R,kind:S,lastPageOfKind:O}=T,{parentUID:j,excludeKinds:B=[]}=b.meta.arg,K={items:((j?C.childrenByParentUID[j]:C.rootItems)?.items??[]).concat(A),lastFetchedKind:S,lastFetchedPage:R,lastKindHasMoreItems:!O,isFullyLoaded:(B.includes("dashboard")||S==="dashboard")&&O};if(!j){C.rootItems=K;return}if(C.childrenByParentUID[j]=K,C.selectedItems.folder[j])for(const U of A)C.selectedItems[U.kind][U.uid]=!0}function l(C,b){const{folderUID:T,isOpen:A}=b.payload;C.openFolders[T]=A}function d(C,b){const{item:T,isSelected:A}=b.payload;if((0,s.I)(T.uid))return;function R(S,O){if(C.selectedItems[S][O]=A,S!=="folder")return;let j=C.childrenByParentUID[O];for(const B of j?.items??[])R(B.kind,B.uid)}if(R(T.kind,T.uid),!A){let S=T.parentUID;for(;S;){const O=(0,a.R)(C.rootItems?.items??[],C.childrenByParentUID,S);if(!O)break;C.selectedItems[O.kind][O.uid]=!1,S=O.parentUID}}C.selectedItems.$all=C.rootItems?.items?.every(S=>C.selectedItems[S.kind][S.uid])??!1}function o(C,b){const{isSelected:T,folderUID:A}=b.payload;if(!(A&&(0,s.I)(A)))if(C.selectedItems.$all=T,T){let S=function(O){if(O&&(0,s.I)(O))return;const j=O?C.childrenByParentUID[O]:C.rootItems;if(j)for(const B of j.items)(0,s.I)(B.uid)||(C.selectedItems[B.kind][B.uid]=T,B.kind==="folder"&&S(B.uid))};var R=S;S(A)}else for(const S in C.selectedItems){if(!(S==="dashboard"||S==="panel"||S==="folder"))continue;const O=C.selectedItems[S];for(const j in O)O[j]=T}}function u(C,b){const T=Array.isArray(b.payload)?b.payload:[b.payload];for(const A of T)A?(C.childrenByParentUID[A]=void 0,C.openFolders[A]=!1):C.rootItems=void 0}const{fetchNextChildrenPageFulfilled:c,refetchChildrenFulfilled:p,...h}=t,y={rootItems:void 0,childrenByParentUID:{},openFolders:{},selectedItems:{dashboard:{},folder:{},panel:{},$all:!1}},f=(0,n.Z0)({name:"browseDashboards",initialState:y,reducers:h,extraReducers:C=>{C.addCase(r.Ii.fulfilled,c),C.addCase(r.bw.fulfilled,p)}}),v=f.reducer,{setFolderOpenState:P,setItemSelectionState:m,setAllSelection:D,clearFolders:x}=f.actions,E={browseDashboards:v}},93519:(_,L,e)=>{"use strict";e.d(L,{R:()=>t,T:()=>n});function t(r,s,a){for(const g of r)if(g.uid===a)return g;for(const g in s){const i=s[g];if(i){for(const l of i.items)if(l.uid===a)return l}}}function n(r,s,a){return new Array(r).fill(null).map((g,i)=>({parentUID:s,level:a,isOpen:!1,item:{kind:"ui",uiKind:"pagination-placeholder",uid:`${s}-pagination-${i}`}}))}},6320:(_,L,e)=>{"use strict";e.d(L,{b:()=>n,q:()=>t});const t="connections",n={Base:`/${t}`,DataSources:`/${t}/datasources`,DataSourcesNew:`/${t}/datasources/new`,DataSourcesEdit:`/${t}/datasources/edit/:uid`,DataSourcesDashboards:`/${t}/datasources/edit/:uid/dashboards`,AddNewConnection:`/${t}/add-new-connection`,DataSourcesDetails:`/${t}/datasources/:id`,ConnectDataOutdated:`/${t}/connect-data`,YourConnectionsOutdated:`/${t}/your-connections`}},67023:(_,L,e)=>{"use strict";e.d(L,{k:()=>a});var t=e(60455),n=e.n(t),r=e(91890),s=e(87490);const a=(g,i,l)=>{let d={},o={};if(g.type===r.CC.Regex&&g.expression){const u=new RegExp(g.expression,"gi"),p=(typeof i=="string"?i:(0,s.MA)(i)).matchAll(u);for(const h of p)h.groups?o=h.groups:o[g.mapValue||l]=h[1]||h[0]}else g.type===r.CC.Logfmt&&(o=n().parse(i));return Object.keys(o).forEach(u=>{const c=typeof o[u]=="string"?o[u]:(0,s.MA)(o[u]);d[u]={value:c}}),d}},40511:(_,L,e)=>{"use strict";e.d(L,{F0:()=>l,bQ:()=>d,lW:()=>o});var t=e(41053),n=e(75505),r=e(19347),s=e(76888),a=e(18380);const g=({sourceUID:u,...c})=>{const p=(0,r.l)().getInstanceSettings(u),h=c.type==="query"?(0,r.l)().getInstanceSettings(c.targetUID):void 0;if((c?.orgId===void 0||c?.orgId===null||c?.orgId===0)&&a.kb.logWarning("Invalid correlation config: Missing org id."),p&&p?.uid!==void 0&&h?.uid!==void 0&&c.type==="query")return{...c,source:p,target:h};if(p&&p?.uid!==void 0&&h?.uid===void 0&&c.type==="external")return{...c,source:p};a.kb.logWarning("Invalid correlation config: Missing source or target.",{source:JSON.stringify(p),target:JSON.stringify(h)})},i=u=>!!u,l=u=>({...u,correlations:u.correlations.map(g).filter(i)});function d(u){return u.data}const o=()=>{const{backend:u}=(0,s.Il)(),[c,p]=(0,t.A)(D=>(0,n.s)(u.fetch({url:"/api/datasources/correlations",params:{page:D.page},method:"GET",showErrorAlert:!1})).then(d).then(l),[u]),[h,y]=(0,t.A)(({sourceUID:D,...x})=>u.post(`/api/datasources/uid/${D}/correlations`,x).then(E=>{const C=g(E.result);if(C!==void 0)return C;throw new Error("invalid sourceUID")}),[u]),[f,v]=(0,t.A)(({sourceUID:D,uid:x})=>u.delete(`/api/datasources/uid/${D}/correlations/${x}`),[u]),[P,m]=(0,t.A)(({sourceUID:D,uid:x,...E})=>u.patch(`/api/datasources/uid/${D}/correlations/${x}`,E).then(C=>{const b=g(C.result);if(b!==void 0)return b;throw new Error("invalid sourceUID")}),[u]);return{create:{execute:y,...h},update:{execute:m,...P},get:{execute:p,...c},remove:{execute:v,...f}}}},18380:(_,L,e)=>{"use strict";e.d(L,{$q:()=>u,J6:()=>o,cA:()=>l,kb:()=>h,tZ:()=>p});var t=e(75505),n=e(91890),r=e(17172),s=e(19347),a=e(34867),g=e(9651),i=e(40511);const l=(y,f,v)=>(y.forEach(P=>{const m=P.refId;if(!m)return;let D=v[m];if(D===void 0&&P.meta?.preferredVisualisationType==="rawPrometheus"){const E=(0,g.a)(m);D=v[E]}const x=f.filter(E=>E.source.uid===D);d(P,x)}),y),d=(y,f)=>{y.fields.forEach(v=>{v.config.links=v.config.links?.filter(P=>P.origin!==n.x0.Correlations)||[],f.map(P=>{if(P.config.field===v.name){if(P.type==="query"){const m=P.config.target||{};v.config.links.push({internal:{query:{...m,datasource:{uid:P.target.uid}},datasourceUid:P.target.uid,datasourceName:P.target.name},url:"",title:P.label||P.target.name,origin:n.x0.Correlations,meta:{transformations:P.config.transformations}})}else if(P.type==="external"){const m=P.config.target;v.config.links.push({url:m.url,title:P.label||"External URL",origin:n.x0.Correlations,meta:{transformations:P.config?.transformations}})}}})})},o=async y=>(0,t.s)((0,r.AI)().fetch({url:"/api/datasources/correlations",method:"GET",showErrorAlert:!1,params:{sourceUID:y}})).then(i.bQ).then(i.F0),u=async(y,f)=>(0,r.AI)().post(`/api/datasources/uid/${y}/correlations`,f),c=async y=>y.datasourceInstance?.meta.mixed?await(0,s.l)().get(y.queries[0].datasource):y.datasourceInstance,p=async(y,f)=>Promise.all([c(y),c(f)]).then(v=>v[0]?.name!==void 0&&v[1]?.name!==void 0?`${v[0]?.name} to ${v[1]?.name}`:""),h=(0,a.DW)("features.correlations")},41524:(_,L,e)=>{"use strict";e.d(L,{W:()=>r});var t=e(11261);function n(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZ",a="abcdefghijklmnopqrstuvwxyz",g=s.length,i=new Map;return l=>{const d=i.get(l);if(d!=null)return d;const o=[...l].map(u=>u.toLowerCase()&&u!==u.toUpperCase()?a.charAt(Math.floor(Math.random()*g)):u.toUpperCase()&&u!==u.toUpperCase()?s.charAt(Math.floor(Math.random()*g)):u).join("");return i.set(l,o),o}}function r(s,a){if(!(a.labels||a.names||a.values))return s;const g=new Set(["time","value","exemplar","traceid","id","uid","uuid","__name__","le","name"]),i=n();return s.map(l=>{let{schema:d,data:o}=l;if(d&&o){if(a.labels){for(const u of d.fields)if(u.labels){const c={};for(const[p,h]of Object.entries(u.labels))c[p]=i(h);u.labels=c}}if(a.names)for(const u of d.fields)u.name?.length&&!g.has(u.name.toLowerCase())&&(u.name=i(u.name));a.values&&d.fields.forEach((u,c)=>{if(u.type===t.PU.string&&o){const p=o.values[c].map(h=>i(String(h)));o.values[c]=p}})}return{schema:d,data:o}})}},72255:(_,L,e)=>{"use strict";e.d(L,{m6:()=>E,sP:()=>T});var t=e(71733),n=e(17172),r=e(39601),s=e(32264),a=e(2619),g=e(33390),i=e(94954),l=e(78160),d=e(17493),o=e(14792),u=e(41176),c=e(20470),p=e(16833),h=e(53001),y=e(31678),f=e(71176),v=e(19997),P=e(27734),m=e(77431);const D=500,x="loadDashboardScene",E="__grafana_home_uid__";class C extends a.Q{constructor(){super(...arguments),this.cache={}}async fetchDashboard({uid:R,route:S,urlFolderUid:O,keepDashboardFromExploreInLocalStorage:j}){const B=g.A.getObject(c.us);if(B)return j||(0,c.yZ)(),B;const N=S===y.DashboardRoutes.Home?E:R,I=this.getDashboardFromCache(N);if(I)return I;let K;try{switch(S){case y.DashboardRoutes.New:K=await(0,f.X)(O);break;case y.DashboardRoutes.Home:if(K=await(0,n.AI)().get("/api/dashboards/home"),K.redirectUri)return K;K?.meta&&(K.meta.canSave=!1,K.meta.canShare=!1,K.meta.canStar=!1);break;case y.DashboardRoutes.Public:return await d.np.loadDashboard("public","",R);default:K=await d.np.loadDashboard("db","",R),S===y.DashboardRoutes.Embedded&&(K.meta.isEmbedded=!0)}if(K.meta.url&&S===y.DashboardRoutes.Normal){const w=t.I.stripBaseFromUrl(K.meta.url),U=r.Ny.getLocation().pathname;w!==U&&(r.Ny.replace({...r.Ny.getLocation(),pathname:w}),console.log("not correct url correcting",w,U))}K.meta.folderUid&&await(0,m.Q)(K.meta.folderUid),this.setDashboardCache(N,K)}catch(w){if((0,n.NF)(w)&&w.cancelled)return null;throw w}return K}async loadSnapshot(R){try{const S=await this.loadSnapshotScene(R);this.setState({dashboard:S,isLoading:!1})}catch(S){this.setState({isLoading:!1,loadError:String(S)})}}async loadSnapshotScene(R){const S=await d.np.loadDashboard("snapshot",R,"");if(S?.dashboard)return(0,v.wM)(S);throw new Error("Snapshot not found")}async loadDashboard(R){try{(0,l.j)(x);const S=await this.loadScene(R);if(!S)return;s.$.featureToggles.preserveDashboardStateWhenNavigating&&R.uid&&(0,P.Gq)(S),this.setState({dashboard:S,isLoading:!1});const O=(0,l.z)(x);(0,p.D)(S,O?.duration),R.route!==y.DashboardRoutes.New&&(0,u.B)({meta:S.state.meta,uid:S.state.uid,title:S.state.title,id:S.state.id})}catch(S){const O=(0,i.q)(S);this.setState({isLoading:!1,loadError:O})}}async loadScene(R){const S=!!(g.A.getObject(c.us)&&R.keepDashboardFromExploreInLocalStorage===!1);this.setState({dashboard:void 0,isLoading:!0});const O=await this.fetchDashboard(R),j=this.getSceneFromCache(R.uid);if(!S&&j&&j.state.version===O?.dashboard.version)return j;if(O?.dashboard){const B=(0,v.wM)(O);return R.uid&&!S&&this.setSceneCache(R.uid,B),B}if(O?.redirectUri){const B=t.I.stripBaseFromUrl(O.redirectUri);return r.Ny.replace(B),null}throw new Error("Dashboard not found")}getDashboardFromCache(R){const S=this.dashboardCache;return R=this.getCacheKey(R),S&&S.cacheKey===R&&Date.now()-S?.ts<D?S.dashboard:null}clearState(){(0,o.UA)().setCurrent(void 0),this.setState({dashboard:void 0,loadError:void 0,isLoading:!1,panelEditor:void 0})}setDashboardCache(R,S){R=this.getCacheKey(R),this.dashboardCache={dashboard:S,ts:Date.now(),cacheKey:R}}clearDashboardCache(){this.dashboardCache=void 0}getSceneFromCache(R){return R=this.getCacheKey(R),this.cache[R]}setSceneCache(R,S){R=this.getCacheKey(R),this.cache[R]=S}getCacheKey(R){const S=(0,h.F_)().sort().join("__scp__");return S?`${R}__scp__${S}`:R}}let b=null;function T(){return b||(b=new C({})),b}},77431:(_,L,e)=>{"use strict";e.d(L,{Q:()=>a});var t=e(82467),n=e(27677),r=e(71101),s=e(99140);async function a(g){try{const i=await n.IB.getFolderByUid(g);s.M_.dispatch((0,t.Vz)((0,r.R4)(i)))}catch(i){console.warn("Error fetching parent folder",g,"for dashboard",i)}}},79280:(_,L,e)=>{"use strict";e.d(L,{p:()=>l});var t=e(74848),n=e(13544),r=e(90613),s=e(67061),a=e(94753),g=e(55852),i=e(8484);function l(d){return(0,t.jsx)(r.a,{alignItems:"center",padding:4,children:(0,t.jsxs)(s.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(a.E,{element:"h3",textAlignment:"center",children:(0,t.jsx)(i.x6,{i18nKey:"transformations.empty.add-transformation-header",children:"Start transforming data"})}),(0,t.jsx)(a.E,{element:"p",textAlignment:"center","data-testid":n.Tp.components.Transforms.noTransformationsMessage,children:(0,t.jsxs)(i.x6,{i18nKey:"transformations.empty.add-transformation-body",children:["Transformations allow data to be changed in various ways before your visualization is shown.",(0,t.jsx)("br",{}),"This includes joining data together, renaming fields, making calculations, formatting data for display, and more."]})}),(0,t.jsx)(g.$n,{icon:"plus",variant:"primary",size:"md",onClick:d.onShowPicker,"data-testid":n.Tp.components.Transforms.addTransformationButton,children:"Add transformation"})]})})}},34865:(_,L,e)=>{"use strict";e.d(L,{L:()=>Nn});var t=e(2543),n=e(39601),r=e(32264),s=e(81887),a=e(26443),g=e(36974),i=e(57767),l=e(13530),d=e(45429),o=e(41507),u=e(20455),c=e(74730);class p extends s.Bs{constructor(Rt){super({source:Rt.source,data:Rt.source.resolve().state.data}),this.addActivationHandler(()=>{this._subs.add(this.state.source.resolve().subscribeToState((Mt,Kt)=>{Mt.data!==Kt.data&&this.setState({data:Mt.data})}))})}setContainerWidth(Rt){this.state.source.resolve().setContainerWidth?.(Rt)}isDataReadyToDisplay(){return this.state.source.resolve().isDataReadyToDisplay?.()??!0}cancelQuery(){this.state.source.resolve().cancelQuery?.()}getResultsStream(){return this.state.source.resolve().getResultsStream()}}var h=e(74848),y=e(32196),f=e(13544),v=e(40845),P=e(63021),m=e(40276),D=e(40980),x=e(66864),E=e(2913),C=e(10096),b=e(75471),T=e(57220),A=e(42418),R=e(39558),S=e(40675),O=e(80215),j=e(27747),B=e(78742),N=e(54148),I=e(16817),K=e(76885),w=e(34867),U=e(55852),W=e(25027),H=e(63066);const z=({panel:Ct,className:Rt})=>{const Mt=(0,N.zy)(),{loading:Kt,value:nn}=(0,I.A)(()=>(0,H.J6)(Ct),[Ct]);if(Kt)return(0,h.jsx)(U.$n,{disabled:!0,children:"New alert rule"});if(!nn)return(0,h.jsx)(A.F,{severity:"info",title:"No alerting capable query found",children:"Cannot create alerts from this panel because no query to an alerting capable datasource is found."});const Qt=async()=>{(0,w.fH)(W.le.alertRuleFromPanel);const ln=await(0,H.J6)(Ct),pn=K.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(ln),returnTo:Mt.pathname+Mt.search});n.Ny.push(pn)};return(0,h.jsx)(U.$n,{icon:"bell",onClick:Qt,className:Rt,"data-testid":"create-alert-rule-button",children:"New alert rule"})};var G=(Ct=>(Ct.Queries="queries",Ct.Transformations="transformations",Ct.Alert="alert",Ct))(G||{});class M extends s.Bs{constructor(){super(...arguments),this.tabId=G.Alert}static{this.Component=Q}renderTab(Rt){return(0,h.jsx)(q,{model:this,...Rt},this.getTabLabel())}getTabLabel(){return"Alert"}getDashboardUID(){return this.getDashboard().state.uid}getDashboard(){return(0,c.YQ)(this)}getLegacyPanelId(){return(0,c.Cs)(this.state.panelRef.resolve())}getCanCreateRules(){const Rt=(0,b.Wd)("grafana");return this.getDashboard().state.meta.canSave&&C.TP.hasPermission(Rt.create)}}function Q({model:Ct}){const Rt=(0,v.of)(Y),{errors:Mt,loading:Kt,rules:nn}=(0,j.S)({dashboardUID:Ct.getDashboardUID(),panelId:Ct.getLegacyPanelId()}),Qt=Mt.length?(0,h.jsx)(A.F,{title:"Errors loading rules",severity:"error",children:Mt.map((In,Rn)=>(0,h.jsxs)("div",{children:["Failed to load Grafana rules state: ",(0,B.JZ)(In)]},Rn))}):null;if(Kt&&!nn.length)return(0,h.jsxs)(h.Fragment,{children:[Qt,(0,h.jsx)(R._,{text:"Loading rules..."})]});const ln=Ct.state.panelRef.resolve(),pn=Ct.getCanCreateRules();return nn.length?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(O.s,{rules:nn}),pn&&(0,h.jsx)(z,{className:Rt.newButton,panel:ln})]}):(0,h.jsxs)("div",{className:Rt.noRulesWrapper,children:[(0,h.jsx)("p",{children:"There are no alert rules linked to this panel."}),pn&&(0,h.jsx)(z,{panel:ln})]})}const Y=Ct=>({newButton:(0,y.css)({marginTop:Ct.spacing(3)}),noRulesWrapper:(0,y.css)({margin:Ct.spacing(2),backgroundColor:Ct.colors.background.secondary,padding:Ct.spacing(3)})});function q(Ct){const{model:Rt}=Ct,{rules:Mt}=(0,j.S)({dashboardUID:Rt.getDashboardUID(),panelId:Rt.getLegacyPanelId(),poll:!1});return(0,h.jsx)(S.o,{label:Rt.getTabLabel(),icon:"bell",counter:Mt.length,active:Ct.active,onChangeTab:Ct.onChangeTab})}var te=e(22391),X=e(41987),ee=e(19347),ne=e(67061),Z=e(21969),ae=e(47311),re=e(53478),se=e(64152),de=e(44932),le=e(37464),he=e(93117),ie=e(14348),J=e(7928);class ce extends s.Bs{constructor(Rt){super(Rt),this.tabId=G.Queries,this.onOpenInspector=()=>{const Mt=this.state.panelRef.resolve(),Kt=(0,c.Cs)(Mt);n.Ny.partial({inspect:Kt,inspectTab:"query"})},this.onChangeDataSource=async(Mt,Kt)=>{const{dsSettings:nn}=this.state,Qt=this.queryRunner,ln=nn?await(0,ee.l)().get({uid:nn.uid}):void 0,pn=await(0,ee.l)().get({uid:Mt.uid}),In=Qt.state.queries,Rn=Kt||await(0,he.y)(pn,Mt.uid,In,ln);Qt.setState({datasource:(0,te.p$)(Mt),queries:Rn}),Kt&&Qt.runQueries(),this.loadDataSource()},this.onQueryOptionsChange=Mt=>{const Kt=this.state.panelRef.resolve(),nn=this.queryRunner,Qt=Kt.state.$timeRange,ln={},pn={};Mt.maxDataPoints!==nn.state.maxDataPoints&&(ln.maxDataPoints=Mt.maxDataPoints??void 0),Mt.minInterval!==nn.state.minInterval&&Mt.minInterval!==null&&(ln.minInterval=Mt.minInterval),Mt.timeRange&&(pn.timeFrom=Mt.timeRange.from??void 0,pn.timeShift=Mt.timeRange.shift??void 0,pn.hideTimeOverride=Mt.timeRange.hide),Qt instanceof J.v?pn.timeFrom!==void 0||pn.timeShift!==void 0?Qt.setState(pn):Kt.setState({$timeRange:void 0}):Kt.setState({$timeRange:new J.v(pn)}),Mt.cacheTimeout!==nn?.state.cacheTimeout&&(ln.cacheTimeout=Mt.cacheTimeout),Mt.queryCachingTTL!==nn?.state.queryCachingTTL&&(ln.queryCachingTTL=Mt.queryCachingTTL),nn.setState(ln),nn.runQueries()},this.onQueriesChange=Mt=>{this.queryRunner.setState({queries:Mt})},this.onRunQueries=()=>{this.queryRunner.runQueries()},this.addQueryClick=()=>{const Mt=this.getQueries();this.onQueriesChange((0,Z.U7)(Mt,this.newQuery()))},this.onAddQuery=Mt=>{const Kt=this.getQueries(),nn=this.state.dsSettings;this.onQueriesChange((0,Z.U7)(Kt,Mt,nn?(0,te.p$)(nn):{type:void 0,uid:void 0}))},this.onAddExpressionClick=()=>{const Mt=this.getQueries();this.onQueriesChange((0,Z.U7)(Mt,re.Ex.newQuery()))},this.addActivationHandler(()=>this.onActivate())}static{this.Component=pe}getTabLabel(){return"Queries"}getItemsCount(){return this.getQueries().length}renderTab(Rt){return(0,h.jsx)(Pe,{model:this,...Rt},this.getTabLabel())}onActivate(){this.loadDataSource()}async loadDataSource(){if(!this.state.panelRef.resolve().state.$data)return;let Kt=this.queryRunner.state.datasource;try{let nn,Qt;if(Kt)nn=await(0,ee.l)().get(Kt),Qt=(0,ee.l)().getInstanceSettings(Kt);else{const pn=(0,c.YQ)(this).state.uid??"",In=(0,g.CW)(pn);In?.datasourceUid!==null&&(Qt=(0,ee.l)().getInstanceSettings({uid:In?.datasourceUid}),Qt&&(nn=await(0,ee.l)().get({uid:In?.datasourceUid,type:Qt.type}),this.queryRunner.setState({datasource:{...(0,te.p$)(Qt),uid:In?.datasourceUid}})))}nn&&Qt&&(this.setState({datasource:nn,dsSettings:Qt}),(0,ae.tw)((0,te.p$)(Qt)||{default:!0}))}catch(nn){const Qt=await(0,ee.l)().get(r.$.defaultDatasource),ln=(0,ee.l)().getInstanceSettings(r.$.defaultDatasource);Qt&&ln&&(this.setState({datasource:Qt,dsSettings:ln}),this.queryRunner.setState({datasource:(0,te.p$)(ln)})),console.error(nn)}}buildQueryOptions(){const Rt=this.state.panelRef.resolve(),Mt=(0,c.un)(Rt),Kt=s.jh.getTimeRange(Rt);let nn={from:void 0,shift:void 0,hide:void 0};Kt instanceof J.v&&(nn={from:Kt.state.timeFrom,shift:Kt.state.timeShift,hide:Kt.state.hideTimeOverride});let Qt=Mt.state.queries;const ln=this.state.dsSettings;return{cacheTimeout:ln?.meta.queryOptions?.cacheTimeout?Mt.state.cacheTimeout:void 0,queryCachingTTL:ln?.cachingConfig?.enabled?Mt.state.queryCachingTTL:void 0,dataSource:{default:ln?.isDefault,...ln?(0,te.p$)(ln):{type:void 0,uid:void 0}},queries:Qt,maxDataPoints:Mt.state.maxDataPoints,minInterval:Mt.state.minInterval,timeRange:nn}}getQueries(){return this.queryRunner.state.queries}newQuery(){const{dsSettings:Rt,datasource:Mt}=this.state;let Kt;return Rt?.meta.mixed?Mt?.meta.mixed?Kt=(0,ee.l)().getInstanceSettings(r.$.defaultDatasource):Kt=Mt:Kt=Rt,{...Mt?.getDefaultQuery?.(X.Jk.PanelEditor),datasource:{uid:Kt?.uid,type:Kt?.type}}}isExpressionsSupported(Rt){return(Rt.meta.alerting||Rt.meta.mixed)===!0}renderExtraActions(){return se.m.getAllExtraRenderAction().map((Rt,Mt)=>Rt({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:Mt})).filter(Boolean)}get queryRunner(){return(0,c.un)(this.state.panelRef.resolve())}}function pe({model:Ct}){const{datasource:Rt,dsSettings:Mt}=Ct.useState(),{data:Kt,queries:nn}=Ct.queryRunner.useState();if(!Rt||!Mt||!Kt)return null;const Qt=!(0,ie.kN)(Mt.name);return(0,h.jsxs)("div",{"data-testid":f.Tp.components.QueryTab.content,children:[(0,h.jsx)(le.K,{data:Kt,dsSettings:Mt,dataSource:Rt,options:Ct.buildQueryOptions(),onDataSourceChange:Ct.onChangeDataSource,onOptionsChange:Ct.onQueryOptionsChange,onOpenQueryInspector:Ct.onOpenInspector}),(0,h.jsx)(de.L,{data:Kt,queries:nn,dsSettings:Mt,onAddQuery:Ct.onAddQuery,onQueriesChange:Ct.onQueriesChange,onRunQueries:Ct.onRunQueries}),(0,h.jsxs)(ne.B,{gap:2,children:[Qt&&(0,h.jsx)(U.$n,{icon:"plus",onClick:Ct.addQueryClick,variant:"secondary","data-testid":f.Tp.components.QueryTab.addQuery,children:"Add query"}),r.$.expressionsEnabled&&Ct.isExpressionsSupported(Mt)&&(0,h.jsx)(U.$n,{icon:"plus",onClick:Ct.onAddExpressionClick,variant:"secondary","data-testid":f.Tp.components.QueryTab.addExpression,children:(0,h.jsx)("span",{children:"Expression\xA0"})}),Ct.renderExtraActions()]})]})}function Pe(Ct){const{model:Rt}=Ct,Mt=Rt.queryRunner.useState();return(0,h.jsx)(S.o,{label:Rt.getTabLabel(),icon:"database",counter:Mt.queries.length,active:Ct.active,onChangeTab:Ct.onChangeTab})}var Ie=e(91076),ge=e(96540),Se=e(19727),De=e(96374),Ke=e(57650),Me=e(79280),be=e(97497),we=e(29158),Be=e(21427),He=e(66879);function Ve(Ct){const{isOpen:Rt,series:Mt,onClose:Kt,onTransformationAdd:nn}=Ct,[Qt,ln]=(0,ge.useState)({search:"",showIllustrations:!0}),pn=hs=>ln({...Qt,search:hs.currentTarget.value}),In=hs=>ln({...Qt,showIllustrations:hs}),Rn=hs=>ln({...Qt,selectedFilter:hs}),qn=(0,ge.useMemo)(()=>be.h.list().sort((hs,Ss)=>hs.name>Ss.name?1:Ss.name>hs.name?-1:0),[]),os=qn.filter(hs=>Qt.selectedFilter&&Qt.selectedFilter!==He.e&&!hs.categories?.has(Qt.selectedFilter)?!1:hs.name.toLocaleLowerCase().includes(Qt.search.toLocaleLowerCase())),cs=(0,h.jsxs)(h.Fragment,{children:[os.length," / ",qn.length," \xA0\xA0",(0,h.jsx)(we.K,{name:"times",onClick:()=>{ln({...Qt,search:""})},tooltip:"Clear search"})]});if(Rt)return(0,h.jsx)(Be.R,{data:Mt,onTransformationAdd:nn,xforms:os,search:Qt.search,noTransforms:!1,suffix:Qt.search!==""?cs:(0,h.jsx)(h.Fragment,{}),selectedFilter:Qt.selectedFilter,onSearchChange:pn,onSearchKeyDown:()=>{},showIllustrations:Qt.showIllustrations,onShowIllustrationsChange:In,onSelectedFilterChange:Rn,onClose:Kt})}class Je extends s.Bs{constructor(){super(...arguments),this.tabId=G.Transformations}static{this.Component=nt}getTabLabel(){return"Transformations"}renderTab(Rt){return(0,h.jsx)(Tt,{model:this,...Rt},this.getTabLabel())}getQueryRunner(){return(0,c.un)(this.state.panelRef.resolve())}getDataTransformer(){const Rt=this.state.panelRef.resolve().state.$data;if(!Rt||!(Rt instanceof s.Es))throw new Error("Could not find SceneDataTransformer for panel");return Rt}onChangeTransformations(Rt){const Mt=this.getDataTransformer();Mt.setState({transformations:Rt}),Mt.reprocessTransformations()}}function nt({model:Ct}){const Rt=(0,v.of)(bt),Mt=Ct.getQueryRunner().useState(),{data:Kt,transformations:nn}=Ct.getDataTransformer().useState(),Qt=nn,[ln,pn]=(0,ge.useState)(!1),[In,Rn]=(0,ge.useState)(!1),qn=()=>pn(!0),os=()=>pn(!1);if(!Kt||!Mt.data)return;const cs=(0,h.jsx)(Ve,{onClose:os,onTransformationAdd:hs=>{hs.value!==void 0&&(Ct.onChangeTransformations([...Qt,{id:hs.value,options:{}}]),os())},isOpen:ln,series:Kt.series});return Qt.length<1?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Me.p,{onShowPicker:qn}),cs]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(pt,{data:Mt.data,transformations:Qt,model:Ct}),(0,h.jsxs)(Se.e,{children:[(0,h.jsx)(U.$n,{icon:"plus",variant:"secondary",onClick:qn,"data-testid":f.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),(0,h.jsx)(U.$n,{"data-testid":f.Tp.components.Transforms.removeAllTransformationsButton,className:Rt.removeAll,icon:"times",variant:"secondary",onClick:()=>Rn(!0),children:"Delete all transformations"})]}),(0,h.jsx)(De.u,{isOpen:In,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>{Ct.onChangeTransformations([]),Rn(!1)},onDismiss:()=>Rn(!1)}),cs]})}function pt({transformations:Ct,model:Rt,data:Mt}){const Kt=Ct.map((Qt,ln)=>({id:`${ln} - ${Qt.id}`,transformation:Qt})),nn=Qt=>{if(!Qt||!Qt.destination)return;const ln=Qt.source.index,pn=Qt.destination.index;if(ln===pn)return;const In=Array.from(Kt),[Rn]=In.splice(ln,1);In.splice(pn,0,Rn),Rt.onChangeTransformations(In.map(qn=>qn.transformation))};return(0,h.jsx)(Ie.JY,{onDragEnd:nn,children:(0,h.jsx)(Ie.gL,{droppableId:"transformations-list",direction:"vertical",children:Qt=>(0,h.jsxs)("div",{ref:Qt.innerRef,...Qt.droppableProps,children:[(0,h.jsx)(Ke.A,{onChange:(ln,pn)=>{const In=Ct.slice();In[ln]=pn,Rt.onChangeTransformations(In)},onRemove:ln=>{const pn=Ct.slice();pn.splice(ln,1),Rt.onChangeTransformations(pn)},configs:Kt,data:Mt}),Qt.placeholder]})})})}const bt=Ct=>({removeAll:(0,y.css)({marginLeft:Ct.spacing(2)})});function Tt(Ct){const{model:Rt}=Ct,Mt=Rt.getDataTransformer().useState();return(0,h.jsx)(S.o,{label:Rt.getTabLabel(),icon:"process",counter:Mt.transformations.length,active:Ct.active,onChangeTab:Ct.onChangeTab})}class ye extends s.Bs{constructor(){super(...arguments),this._urlSync=new s.So(this,{keys:["tab"]}),this.onChangeTab=Rt=>{this.setState({tab:Rt.tabId})}}static{this.Component=je}static createFor(Rt){const Mt=Rt.getRef(),Kt=[new ce({panelRef:Mt}),new Je({panelRef:Mt})];return ue(Rt.state.pluginId)&&Kt.push(new M({panelRef:Mt})),new ye({panelRef:Mt,tabs:Kt,tab:G.Queries})}getUrlState(){return{tab:this.state.tab}}updateFromUrl(Rt){Rt.tab&&typeof Rt.tab=="string"&&this.setState({tab:Rt.tab})}}function je({model:Ct}){const{tab:Rt,tabs:Mt}=Ct.useState(),Kt=(0,v.of)(Ee);if(!Mt||!Mt.length)return;const nn=Mt.find(Qt=>Qt.tabId===Rt);return(0,h.jsxs)("div",{className:Kt.dataPane,"data-testid":f.Tp.components.PanelEditor.DataPane.content,children:[(0,h.jsx)(P.U,{hideBorder:!0,className:Kt.tabsBar,children:Mt.map(Qt=>Qt.renderTab({active:Qt.tabId===Rt,onChangeTab:()=>Ct.onChangeTab(Qt)}))}),(0,h.jsx)(m.E,{className:Kt.scroll,children:(0,h.jsx)(D.J,{className:Kt.tabContent,children:(0,h.jsx)(x.mc,{children:nn&&(0,h.jsx)(nn.Component,{model:nn})})})})]})}function ue(Ct){const{unifiedAlertingEnabled:Rt=!1}=(0,E.zj)(),Mt=C.TP.hasPermission((0,b.Wd)(T.hY).read);return Rt&&Mt?Ct==="graph"||Ct==="timeseries":!1}function Ee(Ct){return{dataPane:(0,y.css)({display:"flex",flexDirection:"column",flexGrow:1,minHeight:0,height:"100%",width:"100%"}),tabContent:(0,y.css)({padding:Ct.spacing(2),border:`1px solid ${Ct.colors.border.weak}`,borderLeft:"none",borderBottom:"none",borderTopRightRadius:Ct.shape.radius.default,flexGrow:1}),tabsBar:(0,y.css)({flexShrink:0,paddingLeft:Ct.spacing(2)}),scroll:(0,y.css)({background:Ct.colors.background.primary})}}var Ce=e(27746),Ne=e(62930),Fe=e(61086),Ue=e(54174),fe=e(1951),Te=e(21633);function Ge(Ct){const{paneOptions:Rt}=Ct,[Mt,Kt]=(0,ge.useState)({collapsed:!1}),nn=(0,ge.useCallback)((os,cs)=>{if(os<=0&&cs<=0)return;const hs=cs/os*(1-os);Mt.collapsed&&hs>Rt.collapseBelowPixels&&Kt({collapsed:!1}),!Mt.collapsed&&hs<Rt.collapseBelowPixels&&Kt({collapsed:!0})},[Mt,Rt.collapseBelowPixels]),Qt=(0,ge.useCallback)((os,cs)=>{if(os<=0&&cs<=0)return;const hs=1-os,Ss=Mt.snapSize===0,Os=cs/os,na=(Rt.snapOpenToPixels??Os/2)/Os;Mt.collapsed?Kt(Ss?{snapSize:Math.max(hs,na),collapsed:!1}:{snapSize:0,collapsed:!0}):Ss&&Kt({snapSize:hs,collapsed:!1})},[Mt,Rt.snapOpenToPixels]),ln=(0,ge.useCallback)(()=>{Kt({collapsed:!Mt.collapsed})},[Mt.collapsed]),{containerProps:pn,primaryProps:In,secondaryProps:Rn,splitterProps:qn}=(0,Te.h)({...Ct,onResizing:nn,onSizeChanged:Qt});return Rn.style.overflow="hidden",Rn.style.minWidth="unset",Rn.style.minHeight="unset",Mt.snapSize?(In.style={...In.style,flexGrow:1-Mt.snapSize},Rn.style.flexGrow=Mt.snapSize):Mt.snapSize===0&&(In.style.flexGrow=1,Rn.style.flexGrow=0,Rn.style.minWidth="unset",Rn.style.minHeight="unset",Rn.style.overflow="unset"),{containerProps:pn,primaryProps:In,secondaryProps:Rn,splitterProps:qn,splitterState:Mt,onToggleCollapse:ln}}function Qe({model:Ct}){const Rt=(0,c.YQ)(Ct),{optionsPane:Mt}=Ct.useState(),Kt=(0,v.of)(ot),{containerProps:nn,primaryProps:Qt,secondaryProps:ln,splitterProps:pn,splitterState:In,onToggleCollapse:Rn}=Ge({direction:"row",dragPosition:"end",initialSize:.75,paneOptions:{collapseBelowPixels:250,snapOpenToPixels:400}});return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Fe.c,{dashboard:Rt}),(0,h.jsxs)("div",{...nn,className:(0,y.cx)(nn.className,Kt.content),"data-testid":f.Tp.components.PanelEditor.General.content,children:[(0,h.jsx)("div",{...Qt,className:(0,y.cx)(Qt.className,Kt.body),children:(0,h.jsx)(st,{model:Ct})}),(0,h.jsx)("div",{...pn}),(0,h.jsxs)("div",{...ln,className:(0,y.cx)(ln.className,Kt.optionsPane),children:[In.collapsed&&(0,h.jsx)("div",{className:Kt.expandOptionsWrapper,children:(0,h.jsx)(Ce.I,{tooltip:"Open options pane",icon:"arrow-to-right",onClick:Rn,variant:"canvas",className:Kt.rotate180,"aria-label":"Open options pane"})}),!In.collapsed&&Mt&&(0,h.jsx)(Mt.Component,{model:Mt}),!In.collapsed&&!Mt&&(0,h.jsx)(Ne.y,{})]})]})]})}function st({model:Ct}){const Rt=(0,c.YQ)(Ct),{dataPane:Mt,showLibraryPanelSaveModal:Kt,showLibraryPanelUnlinkModal:nn,tableView:Qt}=Ct.useState(),ln=Ct.getPanel(),pn=(0,c.iL)(ln),{controls:In}=Rt.useState(),Rn=(0,v.of)(ot),{containerProps:qn,primaryProps:os,secondaryProps:cs,splitterProps:hs,splitterState:Ss,onToggleCollapse:Os}=Ge({direction:"column",dragPosition:"start",initialSize:.5,paneOptions:{collapseBelowPixels:150}});return qn.className=(0,y.cx)(qn.className,Rn.container),Mt||(os.style.flexGrow=1),(0,h.jsxs)("div",{className:(0,y.cx)(Rn.pageContainer,In&&Rn.pageContainerWithControls),children:[In&&(0,h.jsx)("div",{className:Rn.controlsWrapper,children:(0,h.jsx)(In.Component,{model:In})}),(0,h.jsxs)("div",{...qn,children:[(0,h.jsx)("div",{...os,children:(0,h.jsx)(Xe,{panel:ln,tableView:Qt})}),Kt&&pn&&(0,h.jsx)(fe.Z,{libraryPanel:pn,onDismiss:Ct.onDismissLibraryPanelSaveModal,onConfirm:Ct.onConfirmSaveLibraryPanel,onDiscard:Ct.onDiscard}),nn&&pn&&(0,h.jsx)(Ue.l,{onDismiss:Ct.onDismissUnlinkLibraryPanelModal,onConfirm:Ct.onConfirmUnlinkLibraryPanel,isOpen:!0}),Mt&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{...hs}),(0,h.jsxs)("div",{...cs,children:[Ss.collapsed&&(0,h.jsx)("div",{className:Rn.expandDataPane,children:(0,h.jsx)(U.$n,{tooltip:"Open query pane",icon:"arrow-to-right",onClick:Os,variant:"secondary",size:"sm",className:Rn.openDataPaneButton,"aria-label":"Open query pane"})}),!Ss.collapsed&&(0,h.jsx)(Mt.Component,{model:Mt})]})]})]})]})}function Xe({panel:Ct,tableView:Rt}){const Mt=(0,v.of)(ot),Kt=Rt??Ct;return(0,h.jsx)("div",{className:Mt.vizWrapper,children:(0,h.jsx)(Kt.Component,{model:Kt})})}function ot(Ct){return{pageContainer:(0,y.css)({display:"grid",gridTemplateAreas:`
        "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",height:"100%"}),pageContainerWithControls:(0,y.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),container:(0,y.css)({gridArea:"panels",height:"100%"}),canvasContent:(0,y.css)({label:"canvas-content",display:"flex",flexDirection:"column",flexBasis:"100%",flexGrow:1,minHeight:0,width:"100%"}),content:(0,y.css)({position:"absolute",width:"100%",height:"100%"}),body:(0,y.css)({label:"body",flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}),optionsPane:(0,y.css)({flexDirection:"column",borderLeft:`1px solid ${Ct.colors.border.weak}`,background:Ct.colors.background.primary}),expandOptionsWrapper:(0,y.css)({display:"flex",flexDirection:"column",padding:Ct.spacing(2,1)}),expandDataPane:(0,y.css)({display:"flex",flexDirection:"row",padding:Ct.spacing(1),borderTop:`1px solid ${Ct.colors.border.weak}`,borderRight:`1px solid ${Ct.colors.border.weak}`,background:Ct.colors.background.primary,flexGrow:1,justifyContent:"space-around"}),rotate180:(0,y.css)({rotate:"180deg"}),controlsWrapper:(0,y.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:Ct.spacing(2,0,2,2)}),openDataPaneButton:(0,y.css)({width:Ct.spacing(8),justifyContent:"center",svg:{rotate:"-90deg"}}),vizWrapper:(0,y.css)({height:"100%",width:"100%",paddingLeft:Ct.spacing(2)})}}var ft=e(581),_e=e(43429),et=e(67647),it=e(10860),dt=e(8484),ze=e(41394),xe=e(17706),Oe=e(74106),Le=e(20485),Ze=e(22290),qe=e(66211),rt=e(68435),vt=e(15292),Ot=e(94354),jt=e(90182),Ut=e(64919),zt=e(10354),qt=e(21744),fn=e(20214),Sn=e(74410),An=e(48192),Hn=e(74097),es=e(92378),rs=e(29304),Zn=e(32023);function kn(Ct,Rt){const Mt=new An.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),Kt=Zn.b4.getPanelLinks(Ct),nn=Kt?.state.rawLinks??[],Qt=(0,c.YQ)(Ct),ln=Ct.parent;if(Mt.addItem(new Hn.v({title:"Title",value:Ct.state.title,popularRank:1,render:function(){return(0,h.jsx)(Kn,{panel:Ct})},addon:r.$.featureToggles.dashgpt&&(0,h.jsx)(Sn.h,{onGenerate:pn=>wn(Ct,pn),panel:(0,u.Z6)(Ct),dashboard:(0,u.Uy)(Qt)})})).addItem(new Hn.v({title:"Description",value:Ct.state.description,render:function(){return(0,h.jsx)(yn,{panel:Ct})},addon:r.$.featureToggles.dashgpt&&(0,h.jsx)(fn.t,{onGenerate:pn=>Ct.setState({description:pn}),panel:(0,u.Z6)(Ct)})})).addItem(new Hn.v({title:"Transparent background",render:function(){return(0,h.jsx)(vt.d,{value:Ct.state.displayMode==="transparent",id:"transparent-background",onChange:()=>{Ct.setState({displayMode:Ct.state.displayMode==="transparent"?"default":"transparent"})}})}})).addCategory(new An.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:nn?.length}).addItem(new Hn.v({title:"Panel links",render:()=>(0,h.jsx)(Gn,{panelLinks:Kt??void 0})}))),ln instanceof o.U){const pn=ln,In=new An.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1});In.addItem(new Hn.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,h.jsx)(es.U,{id:"repeat-by-variable-select",sceneContext:Ct,repeat:pn.state.variableName,onChange:qn=>pn.setRepeatByVariable(qn)})}})),In.addItem(new Hn.v({title:"Repeat direction",showIf:()=>!!pn.state.variableName,render:function(){const qn=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,h.jsx)(Ot.z,{options:qn,value:pn.state.repeatDirection??"h",onChange:os=>pn.setState({repeatDirection:os})})}})),In.addItem(new Hn.v({title:"Max per row",showIf:()=>!!(pn.state.variableName&&pn.state.repeatDirection==="h"),render:function(){const qn=[2,3,4,6,8,12].map(os=>({label:os.toString(),value:os}));return(0,h.jsx)(jt.l6,{options:qn,value:pn.state.maxPerRow??4,onChange:os=>pn.setState({maxPerRow:os.value})})}})),Mt.addCategory(In)}return Mt}function Gn({panelLinks:Ct}){const{rawLinks:Rt}=Ct?Ct.useState():{rawLinks:[]};return(0,h.jsx)(Ut.e,{links:Rt,onChange:Mt=>Ct?.setState({rawLinks:Mt}),getSuggestions:rs.Fq,data:[]})}function Kn({panel:Ct}){const{title:Rt}=Ct.useState();return(0,h.jsx)(zt.p,{"data-testid":f.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),value:Rt,onChange:Mt=>wn(Ct,Mt.currentTarget.value)})}function yn({panel:Ct}){const{description:Rt}=Ct.useState();return(0,h.jsx)(qt.f,{id:"description-text-area",value:Rt,onChange:Mt=>Ct.setState({description:Mt.currentTarget.value})})}function wn(Ct,Rt){Ct.setState({title:Rt,hoverHeader:Rt===""})}const Jn=ge.memo(({panel:Ct,searchQuery:Rt,listMode:Mt,data:Kt})=>{const{options:nn,fieldConfig:Qt,_pluginInstanceState:ln}=Ct.useState(),In=Ct.parent.useState(),Rn=(0,ge.useMemo)(()=>kn(Ct,In),[Ct,In]),qn=(0,ge.useMemo)(()=>{const Os=Ct.getPlugin();if(Os)return(0,qe.Z4)({panel:Ct,data:Kt,plugin:Os,eventBus:Ct.getPanelContext().eventBus,instanceState:ln})},[Kt,Ct,nn,Qt,ln]),os=(0,ge.useMemo)(()=>{if(Ct instanceof s.Eb&&(0,c.ME)(Ct)){const Os=(0,c.iL)(Ct);return Os instanceof rt.u?(0,qe.tN)(Os):void 0}},[Ct]),cs=(0,ge.useMemo)(()=>(0,Ze.v)(Qt,Ct.getPlugin()?.fieldConfigRegistry,Kt?.series??[],Rt,Os=>{Ct.onFieldConfigChange(Os,!0)}),[Kt,Rt,Ct,Qt]),hs=Rt.length>0,Ss=[];if(hs)Ss.push((0,a.Po)([Rn,...os?[os]:[],...qn??[]],cs,Rt));else switch(Mt){case a.gs.All:os&&Ss.push(os.render()),Ss.push(Rn.render());for(const Os of qn??[])Ss.push(Os.render());for(const Os of cs)Ss.push(Os.render());break;case a.gs.Overrides:for(const Os of cs)Ss.push(Os.render());default:break}return Ss});Jn.displayName="PanelOptions";var bn=e(78685),Pt=e(88575),Ft=e(15054),Xt=e(32696),sn=e(56707),on=e(86292),xn=e(53543);function Un({panel:Ct,data:Rt,onChange:Mt,onClose:Kt}){const nn=(0,v.of)(hn),[Qt,ln]=(0,ge.useState)(""),pn=!1,In=pn?Ft.MM:Ft.wV,Rn=pn?Xt.__.Widgets:Xt.__.Visualizations,qn=(0,ge.useMemo)(()=>new xn.R(Ct),[Ct]),os=(0,ge.useMemo)(()=>new Set([Xt.__.Widgets,Xt.__.Visualizations,Xt.__.Suggestions]),[]),[cs,hs]=(0,bn.A)(In,Rn);(0,ge.useEffect)(()=>{cs&&!os.has(cs)&&hs(Rn)},[Rn,cs,hs,os]);const Ss=[{label:"Visualizations",value:Xt.__.Visualizations},{label:"Suggestions",value:Xt.__.Suggestions}];return(0,h.jsxs)("div",{className:nn.wrapper,children:[(0,h.jsxs)("div",{className:nn.searchRow,children:[(0,h.jsx)(et.Z,{className:nn.filter,value:Qt,onChange:ln,autoFocus:!0,placeholder:"Search for..."}),(0,h.jsx)(U.$n,{title:"Close",variant:"secondary",icon:"angle-up",className:nn.closeButton,"data-testid":f.Tp.components.PanelEditor.toggleVizPicker,onClick:Kt})]}),(0,h.jsx)(Pt.D,{className:nn.customFieldMargin,children:(0,h.jsx)(Ot.z,{options:Ss,value:cs,onChange:hs,fullWidth:!0})}),(0,h.jsxs)(m.E,{children:[cs===Xt.__.Visualizations&&(0,h.jsx)(on.G,{pluginId:Ct.state.pluginId,searchQuery:Qt,onChange:Mt}),cs===Xt.__.Suggestions&&(0,h.jsx)(sn.a,{onChange:Mt,searchQuery:Qt,panel:qn,data:Rt})]})]})}const hn=Ct=>({wrapper:(0,y.css)({display:"flex",flexDirection:"column",flexGrow:1,padding:Ct.spacing(2,1),height:"100%",gap:Ct.spacing(2),border:`1px solid ${Ct.colors.border.weak}`,borderRight:"none",borderBottom:"none",borderTopLeftRadius:Ct.shape.radius.default}),searchRow:(0,y.css)({display:"flex",marginBottom:Ct.spacing(1)}),closeButton:(0,y.css)({marginLeft:Ct.spacing(1)}),customFieldMargin:(0,y.css)({marginBottom:Ct.spacing(1)}),filter:(0,y.css)({minHeight:Ct.spacing(4)})});class St extends s.Bs{constructor(){super(...arguments),this._cachedPluginOptions={},this.onToggleVizPicker=()=>{this.setState({isVizPickerOpen:!this.state.isVizPickerOpen})},this.onChangePanelPlugin=Rt=>{const Mt=this.state.panelRef.resolve(),{options:Kt,fieldConfig:nn,pluginId:Qt}=Mt.state,ln=Rt.pluginId;let pn={defaults:{...nn.defaults,custom:{}},overrides:(0,ft.aW)(nn.overrides,ft.nx)};this._cachedPluginOptions[Qt]={options:Kt,fieldConfig:nn};const In=this._cachedPluginOptions[ln]?.options,Rn=this._cachedPluginOptions[ln]?.fieldConfig;Rn&&(pn=(0,ft.H9)(pn,Rn)),Mt.changePluginType(ln,In,pn),this.onToggleVizPicker()},this.onSetSearchQuery=Rt=>{this.setState({searchQuery:Rt})},this.onSetListMode=Rt=>{this.setState({listMode:Rt})},this.onOpenPanelJSON=Rt=>{n.Ny.partial({inspect:Rt.state.key,inspectTab:"json"})}}static{this.Component=({model:Rt})=>{const{isVizPickerOpen:Mt,searchQuery:Kt,listMode:nn,panelRef:Qt}=Rt.useState(),ln=Qt.resolve(),{pluginId:pn}=ln.useState(),{data:In}=s.jh.getData(ln).useState(),Rn=(0,v.of)(kt),qn=(0,Le.Wu)(ln);return(0,h.jsxs)(h.Fragment,{children:[!Mt&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:Rn.top,children:[(0,h.jsx)(en,{pluginId:pn,onOpen:Rt.onToggleVizPicker}),(0,h.jsx)(et.Z,{className:Rn.searchOptions,value:Kt,placeholder:"Search options",onChange:Rt.onSetSearchQuery})]}),qn&&(0,h.jsx)("div",{className:Rn.angularDeprecationContainer,children:(0,h.jsxs)(Oe.c,{showPluginDetailsLink:!0,pluginId:pn,pluginType:_e.QE.panel,angularSupportEnabled:r.$?.angularSupportEnabled,interactionElementId:"panel-options",children:[(0,h.jsx)(it.Z.Heading,{children:(0,h.jsx)(dt.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-heading",children:"Panel options"})}),(0,h.jsx)(it.Z.Description,{children:(0,h.jsx)(dt.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-description",children:"Angular panels options can only be edited using the JSON editor."})}),(0,h.jsx)(it.Z.Actions,{children:(0,h.jsx)(U.$n,{variant:"secondary",fullWidth:!1,onClick:()=>{Rt.onOpenPanelJSON(ln)},children:(0,h.jsx)(dt.x6,{i18nKey:"dashboards.panel-edit.angular-deprecation-button-open-panel-json",children:"Open JSON editor"})})})]})}),(0,h.jsx)("div",{className:Rn.listOfOptions,children:(0,h.jsx)(Jn,{panel:ln,searchQuery:Kt,listMode:nn,data:In})})]}),Mt&&(0,h.jsx)(Un,{panel:ln,onChange:Rt.onChangePanelPlugin,onClose:Rt.onToggleVizPicker,data:In})]})}}}function kt(Ct){return{top:(0,y.css)({display:"flex",flexDirection:"column",padding:Ct.spacing(2,1),gap:Ct.spacing(2)}),listOfOptions:(0,y.css)({display:"flex",flexDirection:"column",flexGrow:"1",overflow:"auto"}),searchOptions:(0,y.css)({minHeight:Ct.spacing(4)}),searchWrapper:(0,y.css)({padding:Ct.spacing(2,2,2,0)}),vizField:(0,y.css)({marginBottom:Ct.spacing(1)}),rotateIcon:(0,y.css)({rotate:"180deg"}),angularDeprecationContainer:(0,y.css)({label:"angular-deprecation-container",padding:Ct.spacing(1),display:"flex",flexDirection:"column",alignItems:"flex-end"})}}function en({pluginId:Ct,onOpen:Rt}){const Mt=(0,v.of)(tn);let Kt=(0,ge.useMemo)(()=>(0,xe.A4)().filter(nn=>nn.id===Ct)[0],[Ct]);return Kt||(Kt=(0,ze.$)(`Panel plugin not found (${Ct})`,!0).meta),(0,h.jsx)(ne.B,{gap:1,children:(0,h.jsx)(Ce.I,{className:Mt.vizButton,tooltip:"Click to change visualization",imgSrc:Kt.info.logos.small,onClick:Rt,"data-testid":f.Tp.components.PanelEditor.toggleVizPicker,"aria-label":"Change Visualization",variant:"canvas",isOpen:!1,fullWidth:!0,children:Kt.name})})}function tn(Ct){return{vizButton:(0,y.css)({textAlign:"left"})}}class gn extends s.Bs{constructor(Rt){super(Rt),this._changesHaveBeenMade=!1,this.debounceSaveModelDiff=!0,this.onDiscard=()=>{this.setState({isDirty:!1});const Mt=this.state.panelRef.resolve();this.state.isNewPanel?(0,c.YQ)(this).removePanel(Mt):this._layoutElement.setState(this._originalLayoutElementState),n.Ny.partial({editPanel:null})},this.onSaveLibraryPanel=()=>{this.setState({showLibraryPanelSaveModal:!0})},this.onConfirmSaveLibraryPanel=()=>{(0,i.DW)(this.state.panelRef.resolve()),this.setState({isDirty:!1}),n.Ny.partial({editPanel:null})},this.onDismissLibraryPanelSaveModal=()=>{this.setState({showLibraryPanelSaveModal:!1})},this.onUnlinkLibraryPanel=()=>{this.setState({showLibraryPanelUnlinkModal:!0})},this.onDismissUnlinkLibraryPanelModal=()=>{this.setState({showLibraryPanelUnlinkModal:!1})},this.onConfirmUnlinkLibraryPanel=()=>{const Mt=(0,c.iL)(this.getPanel());Mt&&(Mt.unlink(),this.setState({showLibraryPanelUnlinkModal:!1}))},this.onToggleTableView=()=>{if(this.state.tableView){this.setState({tableView:void 0});return}const Kt=this.state.panelRef.resolve().state.$data;Kt&&this.setState({tableView:s.d0.table().setTitle("").setOption("showTypeIcons",!0).setOption("showHeader",!0).setData(new p({source:Kt.getRef()})).build()})},this.setOriginalState(this.state.panelRef),this.addActivationHandler(this._activationHandler.bind(this))}static{this.Component=Qe}_activationHandler(){const Rt=this.state.panelRef.resolve(),Mt=(0,c.M6)(Rt),Kt=Rt.parent;return this.waitForPlugin(),()=>{Kt instanceof o.U&&Kt.editingCompleted(this.state.isDirty||this._changesHaveBeenMade),Mt&&Mt()}}waitForPlugin(Rt=0){const Mt=this.getPanel(),Kt=Mt.getPlugin();if(!Kt||Kt.meta.id!==Mt.state.pluginId){Rt<100?setTimeout(()=>this.waitForPlugin(Rt+1),Rt*10):this.setState({pluginLoadErrror:"Failed to load panel plugin"});return}this.gotPanelPlugin(Kt)}setOriginalState(Rt){const Mt=Rt.resolve();this._originalSaveModel=(0,u.Z6)(Mt),Mt.parent instanceof o.U&&(this._originalLayoutElementState=s.Go.cloneSceneObjectState(Mt.parent.state),this._layoutElement=Mt.parent)}_setupChangeDetection(){const Rt=this.state.panelRef.resolve(),Mt=()=>{const{hasChanges:Qt}=(0,d.yO)(this._originalSaveModel,(0,u.Z6)(Rt));this.setState({isDirty:Qt})},Kt=this.debounceSaveModelDiff?(0,t.debounce)(Mt,250):Mt,nn=Qt=>{l.l.isUpdatingPersistedState(Qt)&&Kt()};this._subs.add(Rt.subscribeToEvent(s.bZ,nn)),this._subs.add(this._layoutElement.subscribeToEvent(s.bZ,nn))}getPanel(){return this.state.panelRef?.resolve()}gotPanelPlugin(Rt){const Mt=this.getPanel(),Kt=Mt.parent;this.state.isInitializing?(this.setOriginalState(this.state.panelRef),Kt instanceof o.U&&Kt.editingStarted(),this._setupChangeDetection(),this._updateDataPane(Rt),this._subs.add(Mt.subscribeToState((nn,Qt)=>{nn.pluginId!==Qt.pluginId&&this.waitForPlugin()})),this.setState({optionsPane:new St({panelRef:this.state.panelRef,searchQuery:"",listMode:a.gs.All}),isInitializing:!1})):this._updateDataPane(Rt)}_updateDataPane(Rt){const Mt=Rt.meta.skipDataQuery,Kt=this.state.panelRef.resolve();if(Mt&&(this.state.dataPane&&(n.Ny.partial({tab:null},!0),this.setState({dataPane:void 0})),Kt.state.$data&&Kt.setState({$data:void 0})),!Mt&&(this.state.dataPane||this.setState({dataPane:ye.createFor(this.getPanel())}),!Kt.state.$data)){let nn=(0,g.CW)((0,c.YQ)(this).state.uid)?.datasourceUid;nn||(nn=r.$.defaultDatasource),Kt.setState({$data:new s.Es({$data:new s.dt({datasource:{uid:nn},queries:[{refId:"A"}]}),transformations:[]})})}}getUrlKey(){return this.getPanelId().toString()}getPanelId(){return(0,c.Cs)(this.state.panelRef.resolve())}getPageNav(Rt,Mt){return{text:"Edit panel",parentItem:(0,c.YQ)(this).getPageNav(Rt,Mt)}}dashboardSaved(){this.setOriginalState(this.state.panelRef),this.setState({isDirty:!1}),this._changesHaveBeenMade=!1}}function Nn(Ct,Rt=!1){return new gn({isInitializing:!0,panelRef:Ct.getRef(),isNewPanel:Rt})}},1951:(_,L,e)=>{"use strict";e.d(L,{Z:()=>c});var t=e(74848),n=e(96540),r=e(16817),s=e(40996),a=e(40845),g=e(37390),i=e(10354),l=e(14578),d=e(55852),o=e(57767),u=e(43535);const c=({libraryPanel:p,isUnsavedPrompt:h,onDismiss:y,onConfirm:f,onDiscard:v})=>{const[P,m]=(0,n.useState)(""),D=(0,r.A)(async()=>{const A=await(0,o.xV)(p.state.uid);return A.length>0?A.map(R=>R.title):[]},[p.state.uid]),[x,E]=(0,n.useState)([]);(0,s.A)(()=>D.value?E(D.value.filter(A=>A.toLowerCase().includes(P.toLowerCase()))):E([]),300,[D.value,P]);const C=(0,a.of)(u.o),b=(0,n.useCallback)(()=>{v()},[v]),T=h?"Unsaved library panel changes":"Save library panel";return(0,t.jsx)(g.a,{title:T,icon:"save",onDismiss:y,isOpen:!0,children:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:C.textInfo,children:["This update will affect ",(0,t.jsxs)("strong",{children:[p.state._loadedPanel?.meta?.connectedDashboards," ",p.state._loadedPanel?.meta?.connectedDashboards===1?"dashboard":"dashboards","."]}),"The following dashboards using the panel will be affected:"]}),(0,t.jsx)(i.p,{className:C.dashboardSearch,prefix:(0,t.jsx)(l.I,{name:"search"}),placeholder:"Search affected dashboards",value:P,onChange:A=>m(A.currentTarget.value)}),D.loading?(0,t.jsx)("p",{children:"Loading connected dashboards..."}):(0,t.jsxs)("table",{className:C.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:x.map((A,R)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:A})},`dashrow-${R}`))})]}),(0,t.jsxs)(g.a.ButtonRow,{children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:y,fill:"outline",children:"Cancel"}),h&&(0,t.jsx)(d.$n,{variant:"destructive",onClick:b,children:"Discard"}),(0,t.jsx)(d.$n,{onClick:()=>{f()},children:"Update all"})]})]})})}},13530:(_,L,e)=>{"use strict";e.d(L,{l:()=>h});var t=e(2543),n=e(81887),r=e(67278);const s=()=>new r.c(new URL(e.p+e.u(9666),e.b));var a=e(38477),g=e(33278),i=e(41507),l=e(55600),d=e(68435),o=e(42397),u=e(7928),c=e(20455),p=e(17663);class h{constructor(v){this._dashboard=v}static isUpdatingPersistedState({payload:v}){return Object.keys(v.partialUpdate).length===0?!1:!!(v.changedObject instanceof n.Eb||v.changedObject instanceof i.U||v.changedObject instanceof u.v||v.changedObject instanceof n.dt&&!Object.prototype.hasOwnProperty.call(v.partialUpdate,"data")||v.changedObject instanceof n.Es&&!Object.prototype.hasOwnProperty.call(v.partialUpdate,"data")||v.changedObject instanceof o.$||v.changedObject instanceof n.WM&&(Object.prototype.hasOwnProperty.call(v.partialUpdate,"intervals")||Object.prototype.hasOwnProperty.call(v.partialUpdate,"refresh"))||v.changedObject instanceof d.u&&Object.prototype.hasOwnProperty.call(v.partialUpdate,"name")||v.changedObject instanceof n.Gg.K2||v.changedObject instanceof n.kh||v.changedObject instanceof i.U||v.changedObject instanceof n.hy||v.changedObject instanceof l.H$&&Object.keys(v.partialUpdate).some(P=>l.vk.includes(P))||v.changedObject instanceof n.JZ||v.changedObject instanceof g.x&&Object.prototype.hasOwnProperty.call(v.partialUpdate,"hideTimeControls")||v.changedObject instanceof n.Pj||v.changedObject instanceof a.g&&!Object.prototype.hasOwnProperty.call(v.partialUpdate,"data")||v.changedObject instanceof n.Gg.en||(0,p.c7)(v.changedObject))}detectSaveModelChanges(){const v=(0,c.Uy)(this._dashboard),P=this._dashboard.getInitialSaveModel(),m=typeof v=="object"?JSON.parse(JSON.stringify(v)):v,D=typeof P=="object"?JSON.parse(JSON.stringify(P)):P;this._changesWorker?.postMessage({initial:D,changed:m})}hasMetadataChanges(){return this._dashboard.state.meta.folderUid!==this._dashboard.getInitialState()?.meta.folderUid}updateIsDirty(v){const{hasChanges:P}=v;P||this.hasMetadataChanges()?this._dashboard.state.isDirty||this._dashboard.setState({isDirty:!0}):this._dashboard.state.isDirty&&this._dashboard.setState({isDirty:!1})}init(){this._changesWorker=s()}startTrackingChanges(){this._changesWorker||this.init(),this._changesWorker.onmessage=P=>{this.updateIsDirty(P.data)};const v=y(this.detectSaveModelChanges.bind(this));this._changeTrackerSub=this._dashboard.subscribeToEvent(n.bZ,P=>{h.isUpdatingPersistedState(P)&&v()})}stopTrackingChanges(){this._changeTrackerSub?.unsubscribe()}terminate(){this.stopTrackingChanges(),this._changesWorker?.terminate(),this._changesWorker=void 0}}function y(f){return(0,t.debounce)(f,250)}},45429:(_,L,e)=>{"use strict";e.d(L,{Yy:()=>a,yO:()=>d});var t=e(56596);function n(o,u){try{let c=o;for(const p of u)c=c[p];return c}catch{return}}function r(o,u){return typeof o==typeof u&&(typeof o=="string"&&o===u||Array.isArray(o)&&o.length===u.length&&o.every((c,p)=>c===u[p]))}function s(o,u){return o===u||o&&u&&o.selected===u.selected&&r(o.text,u.text)&&r(o.value,u.value)}function a(o,u,c,p,h){const y=o,f=u,v=g(f,y),P=l(f,y,p),m=f.refresh!==y.refresh;c||(f.time=y.time),h||(f.refresh=y.refresh);const D=(0,t.G4)(y,f),x=Object.values(D).reduce((E,C)=>E+C.length,0);return{changedSaveModel:f,initialSaveModel:y,diffs:D,diffCount:x,hasChanges:x>0,hasTimeChanges:v,isNew:f.version===0,hasVariableValueChanges:P,hasRefreshChange:m}}function g(o,u){return o.time?.from!==u.time?.from||o.time?.to!==u.time?.to}function i(o,u){if(o.filters===void 0&&u.filters===void 0)return console.warn("Adhoc variable filter property is undefined"),!0;if(o.filters===void 0&&u.filters!==void 0||u.filters===void 0&&o.filters!==void 0)return console.warn("Adhoc variable filter property is undefined"),!1;if(o.filters.length!==u.filters.length)return!1;for(let c=0;c<o.filters.length;c++){const p=o.filters[c],h=u.filters[c];if(p.key!==h.key||p.operator!==h.operator||p.value!==h.value)return!1}return!0}function l(o,u,c){const p=u.templating?.list??[],h=o.templating?.list??[];let y=!1;for(const f of h){const v=p.find(({name:P,type:m})=>P===f.name&&m===f.type);if(v&&(v.current&&delete v.current.selected,s(f.current,v.current)?f.type==="adhoc"&&!i(f,v)&&(y=!0):y=!0,!c)){const P=f;P.type==="adhoc"?P.filters=v.filters:(f.current=v.current,f.options=v.options)}}return y}function d(o,u){const c=(0,t.G4)(u,o),p=Object.values(c).reduce((h,y)=>h+y.length,0);return{changedSaveModel:o,initialSaveModel:u,diffs:c,diffCount:p,hasChanges:p>0}}},91309:(_,L,e)=>{"use strict";e.d(L,{C:()=>E,S:()=>C});var t=e(65474),n=e(81160),r=e(52622),s=e(43585),a=e(14236),g=e(39070),i=e(32264),l=e(81887),d=e(82467),o=e(3169),u=e(10096),c=e(94954),p=e(79938),h=e(49498),y=e(55740),f=e(57220),v=e(23662),P=e(99140),m=e(31678),D=e(94822),x=e(74730);class E extends l.VE{constructor(T){super({isEnabled:!0,...T,isHidden:!0}),this.hasAlertRules=!0,this.topic=r.QR.AlertStates,this.handleError=A=>{const R=(0,o.gi)("AlertStatesDataLayer",(0,c.q)(A));(0,P.JD)((0,d.dx)(R))}}onEnable(){const T=l.jh.getTimeRange(this);this._timeRangeSub=T.subscribeToState(()=>{this.runWithTimeRange(T)})}onDisable(){this._timeRangeSub?.unsubscribe()}runLayer(){const T=l.jh.getTimeRange(this);this.runWithTimeRange(T)}async runWithTimeRange(T){const A=(0,x.YQ)(this),{uid:R,id:S}=A.state;if(this.querySub&&this.querySub.unsubscribe(),!this.canWork(T))return;const O=async()=>{const N=await(0,P.JD)(p.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:f.hY,dashboardUid:R},{forceRefetch:!0}));if(N.error)throw new Error("Unexpected alert rules response.");return N.data},B=(0,t.H)(O()).pipe((0,n.T)(N=>(0,h.Kw)(N))).pipe((0,n.T)(N=>{this.hasAlertRules=!1;const I={};return N.forEach(K=>K.rules.forEach(w=>{if((0,v.Z8)(w)&&w.annotations&&w.annotations[y.YH.panelID]){this.hasAlertRules=!0;const U=Number(w.annotations[y.YH.panelID]),W=C(w.state);I[U]?W===s.O.Alerting&&I[U].state!==s.O.Alerting?I[U].state=s.O.Alerting:W===s.O.Pending&&I[U].state!==s.O.Alerting&&I[U].state!==s.O.Pending&&(I[U].state=s.O.Pending):I[U]={state:W,id:Object.keys(I).length,panelId:U,dashboardId:S}}})),Object.values(I)}));this.querySub=B.subscribe({next:N=>{const I=(0,a.Vc)(N);this.publishResults({state:g.Gu.Done,series:[{...I,meta:{...I.meta,dataTopic:r.QR.AlertStates}}],timeRange:T.state.value})},error:N=>{this.handleError(N),this.publishResults({state:g.Gu.Error,series:[],errors:[{message:(0,c.q)(N)}],timeRange:T.state.value})}})}canWork(T){const A=(0,x.YQ)(this),{uid:R}=A.state;return!(!R||i.$.publicDashboardAccessToken||T.state.value.raw.to!=="now"||this.hasAlertRules===!1||!(u.TP.hasPermission(m.AccessControlAction.AlertingRuleRead)&&u.TP.hasPermission(m.AccessControlAction.AlertingRuleExternalRead)))}}function C(b){return b===D.cF.Firing?s.O.Alerting:b===D.cF.Pending?s.O.Pending:s.O.OK}},38477:(_,L,e)=>{"use strict";e.d(L,{g:()=>i});var t=e(43127),n=e(33948),r=e(52622),s=e(32264),a=e(81887),g=e(90569);class i extends a.tV.g{async resolveDataSource(d){return s.$.publicDashboardAccessToken?new g.X:super.resolveDataSource(d)}processEvents(d,o){if(s.$.publicDashboardAccessToken){const u={series:[],timeRange:(0,t.E2)(),state:o.state},c=(0,n.I)(o.events);return c.meta={...c.meta,dataTopic:r.QR.Annotations},u.annotations=[c],u}else return super.processEvents(d,o)}}},33278:(_,L,e)=>{"use strict";e.d(L,{x:()=>P});var t=e(74848),n=e(32196),r=e(12470),s=e(13544),a=e(81887),g=e(40845),i=e(67061),l=e(90613),d=e(15292);function o({panelEditor:x}){const{tableView:E,dataPane:C}=x.useState();return(0,t.jsx)(t.Fragment,{children:C&&(0,t.jsx)(d.K,{label:"Table view",showLabel:!0,id:"table-view",value:!!E,onClick:x.onToggleTableView,"aria-label":"toggle-table-view","data-testid":s.Tp.components.PanelEditor.toggleTableView})})}var u=e(74730),c=e(80997),p=e(56034),h=e(52424),y=e(29304),f=e(4588);function v({links:x,dashboard:E}){a.jh.getTimeRange(E).useState();const C=E.state.uid;return!x||!C?null:(0,t.jsx)(t.Fragment,{children:x.map((b,T)=>{const A=(0,y.mQ)().getAnchorInfo(b),R=`${b.title}-$${T}`;if(b.type==="dashboards")return(0,t.jsx)(h.aK,{link:b,linkInfo:A,dashboardUID:C},R);const S=f.G[b.icon],O=(0,t.jsx)(h.Zx,{icon:S,href:(0,c.Jf)(A.href),target:b.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":s.Tp.components.DashboardLinks.link,children:A.title});return(0,t.jsx)("div",{"data-testid":s.Tp.components.DashboardLinks.container,children:b.tooltip?(0,t.jsx)(p.m,{content:A.tooltip,children:O}):O},R)})})}class P extends a.Bs{constructor(E){super({variableControls:[],timePicker:E.timePicker??new a.KE({}),refreshPicker:E.refreshPicker??new a.WM({}),...E}),this._variableDependency=new a.Sh(this,{onAnyVariableChanged:this._onAnyVariableChanged.bind(this)}),this._urlSync=new a.So(this,{keys:["_dash.hideTimePicker","_dash.hideVariables","_dash.hideLinks"]}),this.addActivationHandler(()=>{let C;return this.state.hideTimeControls&&(C=this.state.refreshPicker.activate()),()=>{C&&C()}})}static{this.Component=m}getUrlState(){return{}}updateFromUrl(E){const{hideTimeControls:C,hideVariableControls:b,hideLinksControls:T}=this.state,A=R=>E[R]==="true"||E[R]==="";!C&&A("_dash.hideTimePicker")&&this.setState({hideTimeControls:!0}),!b&&A("_dash.hideVariables")&&this.setState({hideVariableControls:!0}),!T&&A("_dash.hideLinks")&&this.setState({hideLinksControls:!0})}_onAnyVariableChanged(){(0,u.YQ)(this).state.links?.length>0&&this.forceRender()}hasControls(){const E=a.jh.getVariables(this)?.state.variables.some(S=>S.state.hide!==r.zL.hideVariable),C=a.jh.getDataLayers(this).some(S=>S.state.isEnabled&&!S.state.isHidden),b=(0,u.YQ)(this).state.links?.length>0,T=this.state.hideLinksControls||!b,A=this.state.hideVariableControls||!C&&!E,R=this.state.hideTimeControls;return!(A&&T&&R)}}function m({model:x}){const{variableControls:E,refreshPicker:C,timePicker:b,hideTimeControls:T,hideVariableControls:A,hideLinksControls:R}=x.useState(),S=(0,u.YQ)(x),{links:O,editPanel:j}=S.useState(),B=(0,g.of)(D),N=location.search.includes("scene-debugger");return x.hasControls()?(0,t.jsxs)("div",{"data-testid":s.Tp.pages.Dashboard.Controls,className:B.controls,children:[(0,t.jsxs)(i.B,{grow:1,wrap:"wrap",children:[!A&&E.map(I=>(0,t.jsx)(I.Component,{model:I},I.state.key)),(0,t.jsx)(l.a,{grow:1}),!R&&!j&&(0,t.jsx)(v,{links:O,dashboard:S}),j&&(0,t.jsx)(o,{panelEditor:j})]}),!T&&(0,t.jsxs)(i.B,{justifyContent:"flex-end",children:[(0,t.jsx)(b.Component,{model:b}),(0,t.jsx)(C.Component,{model:C})]}),N&&(0,t.jsx)(a.or,{scene:x},"scene-debugger")]}):null}function D(x){return{controls:(0,n.css)({display:"flex",alignItems:"flex-start",flex:"100%",gap:x.spacing(1),flexDirection:"row",flexWrap:"nowrap",position:"relative",width:"100%",marginLeft:"auto",[x.breakpoints.down("sm")]:{flexDirection:"column-reverse",alignItems:"stretch"}}),embedded:(0,n.css)({background:"unset",position:"unset"})}}},16279:(_,L,e)=>{"use strict";e.d(L,{s:()=>r});var t=e(74848),n=e(81887);class r extends n.ps{constructor(a){super({...a,name:a.name??"Data layers",annotationLayers:a.annotationLayers??[]}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){return this._subs.add(this.subscribeToState((a,g)=>{a.annotationLayers!==g.annotationLayers&&(this.querySub?.unsubscribe(),this.subscribeToAllLayers(this.getAllLayers()))})),this.subscribeToAllLayers(this.getAllLayers()),()=>{this.querySub?.unsubscribe()}}addAnnotationLayer(a){this.setState({annotationLayers:[...this.state.annotationLayers,a]})}getAllLayers(){const a=[...this.state.annotationLayers];return this.state.alertStatesLayer&&a.push(this.state.alertStatesLayer),a}static{this.Component=({model:a})=>{const{annotationLayers:g}=a.useState();return(0,t.jsx)(t.Fragment,{children:g.map(i=>(0,t.jsx)(i.Component,{model:i},i.state.key))})}}}},39820:(_,L,e)=>{"use strict";e.d(L,{L:()=>s});var t=e(81887),n=e(14348),r=e(74730);class s extends t.Bs{constructor(g){super(g),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){const g=this.parent;let i,l;if(!(g instanceof t.dt))throw new Error("DashboardDatasourceBehaviour must be attached to a SceneQueryRunner");if(g.state.datasource?.uid!==n.K)return;try{l=(0,r.YQ)(g)}catch{return}const d=g.state.queries.find(y=>y.panelId!==void 0);if(!d)return;const o=d.panelId,u=(0,r.XA)(o),c=(0,r.vL)(l,u);if(!(c instanceof t.Eb))return;const p=(0,r.iL)(c);if(p&&!p.state.isLoaded){i=p.subscribeToState(y=>{this.handleLibPanelStateUpdates(y,g,c)});return}const h=(0,r.un)(c);if(!h)throw new Error("Could not find SceneQueryRunner for panel");return this.prevRequestId&&this.prevRequestId!==h.state.data?.request?.requestId&&g.runQueries(),()=>{this.prevRequestId=h?.state.data?.request?.requestId,i&&i.unsubscribe()}}handleLibPanelStateUpdates(g,i,l){if(g&&g?.isLoaded){if(!((0,r.un)(l)instanceof t.dt))throw new Error("Could not find SceneQueryRunner for library panel");i.runQueries()}}}},41507:(_,L,e)=>{"use strict";e.d(L,{U:()=>c});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(96540),g=e(32264),i=e(81887),l=e(15054),d=e(74730),o=e(7196),u=e(30195);class c extends i.Bs{constructor(v){super(v),this._variableDependency=new p(this),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.variableName&&(this._subs.add(this.subscribeToState((v,P)=>this._handleGridResize(v,P))),this.performRepeat())}_handleGridResize(v,P){const m=this.state.repeatedPanels?.length??1,D={};if(v.height!==P.height){if(this.getRepeatDirection()==="v"){const x=Math.ceil(v.height/m);D.itemHeight=x}else{const x=Math.ceil(m/this.getMaxPerRow());D.itemHeight=Math.ceil(v.height/x)}D.itemHeight!==this.state.itemHeight&&this.setState(D)}}performRepeat(){if(!this.state.variableName||i.jh.hasVariableDependencyInLoadingState(this))return;const v=i.jh.lookupVariable(this.state.variableName,this)??new i.yP({name:"_____default_sys_repeat_var_____",options:[],value:"",text:"",query:"A"});if(!(v instanceof i.n8)){console.error("DashboardGridItem: Variable is not a MultiValueVariable");return}const{values:P,texts:m}=(0,d.a7)(v);if((0,r.isEqual)(this._prevRepeatValues,P)){this.notifyRepeatedPanelsWaitingForVariables(v);return}const D=this.state.body,x=[],E={values:[""],texts:v.hasAllValue()?["All"]:["None"]},C=P.length?P:E.values,b=m.length?m:E.texts;for(let j=0;j<C.length;j++){const B={$variables:new i.Pj({variables:[new i.xc({name:v.state.name,value:C[j],text:String(b[j])})]}),key:`${D.state.key}-clone-${j}`};j>0&&(B.menu=new i.Lw({$behaviors:[o.t0]}));const N=D.clone(B);x.push(N)}const T=this.getRepeatDirection(),A={repeatedPanels:x},R=this.state.itemHeight??10,S=this.state.height,O=this.getMaxPerRow();if(T==="h"){const j=Math.ceil(x.length/O);A.height=j*R}else A.height=x.length*R;if(this.setState(A),S!==this.state.height){const j=i.jh.getLayout(this);j instanceof i.hy&&j.forceRender()}this._prevRepeatValues=P,this.publishEvent(new u.d({source:this}),!0)}setRepeatByVariable(v){const P={variableName:v};v&&!this.state.repeatDirection&&(P.repeatDirection="h"),this.state.body.state.$variables&&this.state.body.setState({$variables:void 0}),this.setState(P)}editingStarted(){this.state.variableName&&(this.state.repeatedPanels?.length??!1)&&this.state.body.setState({$variables:this.state.repeatedPanels[0].state.$variables?.clone(),$data:this.state.repeatedPanels[0].state.$data?.clone()})}editingCompleted(v){v&&(this._prevRepeatValues=void 0),this.state.variableName&&this.state.repeatDirection==="h"&&this.state.width!==l.cV&&this.setState({width:l.cV})}notifyRepeatedPanelsWaitingForVariables(v){for(const P of this.state.repeatedPanels??[]){const m=(0,d.un)(P);m&&m.variableDependency?.variableUpdateCompleted(v,!1)}}getMaxPerRow(){return this.state.maxPerRow??4}getRepeatDirection(){return this.state.repeatDirection==="v"?"v":"h"}getClassName(){return this.state.variableName?"panel-repeater-grid-item":""}isRepeated(){return this.state.variableName!==void 0}static{this.Component=({model:v})=>{const{repeatedPanels:P,itemHeight:m,variableName:D,body:x}=v.useState(),E=P?.length??0,C=h(v.getRepeatDirection(),E,v.getMaxPerRow(),m??10);return!D&&x instanceof i.Eb?(0,t.jsx)(x.Component,{model:x},x.state.key):P?(0,t.jsx)("div",{className:C,children:P.map(b=>(0,t.jsx)("div",{className:y,children:(0,t.jsx)(b.Component,{model:b},b.state.key)},b.state.key))}):null}}}class p{constructor(v){this._gridItem=v}getNames(){return this._gridItem.state.variableName?new Set([this._gridItem.state.variableName]):new Set}hasDependencyOn(v){return this._gridItem.state.variableName===v}variableUpdateCompleted(v,P){this._gridItem.state.variableName===v.state.name&&this._gridItem.performRepeat()}}function h(f,v,P,m){return(0,a.useMemo)(()=>{const D=g.$.theme2,x=m*l.sD*v+(v-1)*l.dU;if(f==="h"){const E=Math.ceil(v/P),C=Math.min(v,P);return(0,n.css)({display:"grid",height:"100%",width:"100%",gridTemplateColumns:`repeat(${C}, 1fr)`,gridTemplateRows:`repeat(${E}, 1fr)`,gridColumnGap:D.spacing(1),gridRowGap:D.spacing(1),[D.breakpoints.down("md")]:{display:"flex",flexDirection:"column",height:x}})}return(0,n.css)({display:"flex",height:"100%",width:"100%",flexDirection:"column",gap:D.spacing(1),[D.breakpoints.down("md")]:{height:x}})},[f,v,P,m])}const y=(0,n.css)({display:"flex",flexGrow:1,position:"relative"})},55600:(_,L,e)=>{"use strict";e.d(L,{H$:()=>fr,vk:()=>qo});var t=e(71733),n=e(26272),r=e(41987),s=e(39601),a=e(32264),g=e(3591),i=e(81887),l=e(28138),d=e(15054),o=e(17422),u=e(33390),c=e(14792),p=e(34214),h=e(6473),y=e(53001),f=e(80484),v=e(28444),P=e(13530),m=e(74848),D=e(63021),x=e(40675),E=e(87978),C=e(54943),b=e(76459),T=e.n(b),A=e(96540),R=e(49785),S=e(13544),O=e(55852),j=e(42418),B=e(67061),N=e(88575),I=e(10354),K=e(21744),w=e(15292),U=e(90613),W=e(60029),H=e(36607),z=e(71500),G=e(17172),M=e(8484);function Q(ke){return(0,G.NF)(ke)&&ke.data&&ke.data.status==="version-mismatch"}function Y(ke){return(0,G.NF)(ke)&&ke.data&&ke.data.status==="name-exists"}function q(ke){return(0,G.NF)(ke)&&ke.data&&ke.data.status==="plugin-dashboard"}function te({cancelButton:ke,saveButton:Re}){return a.$.featureToggles.dashboardRestore&&a.$.featureToggles.dashboardRestoreUI?(0,m.jsxs)(j.F,{title:(0,M.t)("save-dashboards.name-exists.title","Dashboard name already exists"),severity:"error",children:[(0,m.jsx)("p",{children:(0,m.jsx)(M.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,m.jsx)("p",{children:(0,m.jsx)(M.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,m.jsxs)(j.F,{title:"Name already exists",severity:"error",children:[(0,m.jsx)("p",{children:"A dashboard with the same name in selected folder already exists. Would you still like to save this dashboard?"}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsxs)(B.B,{alignItems:"center",children:[ke,Re(!0)]})})]})}function X({overwrite:ke,isLoading:Re,isValid:Ye,onSave:lt}){return(0,m.jsx)(O.$n,{disabled:!Ye||Re,icon:Re?"spinner":void 0,onClick:()=>lt(ke),variant:ke?"destructive":"primary","data-testid":S.Tp.components.Drawer.DashboardSaveDrawer.saveButton,children:Re?"Saving...":ke?"Save and overwrite":"Save"})}var ee=e(41053),ne=e(14110),Z=e(3169),ae=e(91219),re=e(55314),se=e(31678),de=e(36974);function le(ke=!1){const Re=(0,se.useDispatch)(),Ye=(0,Z._2)(),[lt]=(0,re.e8)(),[At,Nt]=(0,ee.A)(async(Wt,Ht,un)=>{{const an=await lt({dashboard:Ht,folderUid:un.folderUid,message:un.message,overwrite:un.overwrite,showErrorAlert:!1,k8s:void 0});if("error"in an)throw an.error;const jn=an.data;Wt.saveCompleted(Ht,jn,un.folderUid),l.A.publish(new v.Eu),Ye.success("Dashboard saved"),(0,de.ko)(jn.uid),ke?(0,ne.rR)("grafana_dashboard_copied",{name:Ht.title,url:jn.url}):(0,ne.rR)(`grafana_dashboard_${jn.uid?"saved":"created"}`,{name:Ht.title,url:jn.url});const Xn=s.Ny.getLocation(),ds=t.I.stripBaseFromUrl(jn.url);return ds!==Xn.pathname&&setTimeout(()=>{s.Ny.push({pathname:ds,search:Xn.search})}),Wt.state.meta.isStarred&&Re((0,ae.TU)({id:jn.uid,title:Wt.state.title,url:ds})),an.data}},[Re,Ye]);return{state:At,onSaveDashboard:Nt}}function he({dashboard:ke,changeInfo:Re}){const{changedSaveModel:Ye}=Re,{register:lt,handleSubmit:At,setValue:Nt,formState:Wt,getValues:Ht,watch:un}=(0,R.mN)({mode:"onBlur",defaultValues:{title:Re.isNew?Ye.title:`${Ye.title} Copy`,description:Ye.description??"",folder:{uid:ke.state.meta.folderUid,title:ke.state.meta.folderTitle},copyTags:!1}}),{errors:an,isValid:jn,defaultValues:Xn}=Wt,ds=un(),{state:$n,onSaveDashboard:is}=le(!1),[gs,ss]=(0,A.useState)({}),[us,ps]=(0,A.useState)(!1),Is=async ws=>{const Ws=Ht(),Ls=pe(Ye,Ws,Re.isNew);(await is(ke,Ls,{overwrite:ws,folderUid:Ws.folder.uid})).status==="success"?ke.closeModal():ss({title:Ws.title,folderUid:Ws.folder.uid})},ns=(0,m.jsx)(O.$n,{variant:"secondary",onClick:()=>ke.closeModal(),fill:"outline",children:"Cancel"}),Bs=ws=>{const Ws=!jn&&us?!0:jn;return(0,m.jsx)(X,{isValid:Ws,isLoading:$n.loading,onSave:Is,overwrite:ws})};function Js(ws){const Ws=ds.title.trim()===gs.title&&ds.folder.uid===gs.folderUid;return Y(ws)&&Ws?(0,m.jsx)(te,{cancelButton:ns,saveButton:Bs}):(0,m.jsxs)(m.Fragment,{children:[ws&&Ws&&(0,m.jsx)(j.F,{title:"Failed to save dashboard",severity:"error",children:ws.message&&(0,m.jsx)("p",{children:ws.message})}),(0,m.jsxs)(B.B,{alignItems:"center",children:[ns,Bs(!1)]})]})}return(0,m.jsxs)("form",{onSubmit:At(()=>Is(!1)),children:[(0,m.jsx)(N.D,{label:(0,m.jsx)(ie,{dashboard:Ye,onChange:Nt}),invalid:!!an.title,error:an.title?.message,children:(0,m.jsx)(I.p,{...lt("title",{required:"Required",validate:ce}),"aria-label":"Save dashboard title field","data-testid":S.Tp.components.Drawer.DashboardSaveDrawer.saveAsTitleInput,onChange:T()(async ws=>{Nt("title",ws.target.value,{shouldValidate:!0})},400)})}),(0,m.jsx)(N.D,{label:(0,m.jsx)(J,{dashboard:Ye,onChange:Nt}),invalid:!!an.description,error:an.description?.message,children:(0,m.jsx)(K.f,{...lt("description",{required:!1}),"aria-label":"Save dashboard description field",autoFocus:!0})}),(0,m.jsx)(N.D,{label:"Folder",children:(0,m.jsx)(H.d,{onChange:(ws,Ws)=>{Nt("folder",{uid:ws,title:Ws});const Ls=ke.state.meta.folderUid;ps(ws!==Ls)},value:ds.folder?.uid,initialTitle:Xn.folder.title,dashboardId:Ye.id??void 0,enableCreateNew:!0})}),!Re.isNew&&(0,m.jsx)(N.D,{label:"Copy tags",children:(0,m.jsx)(w.d,{...lt("copyTags")})}),(0,m.jsx)(U.a,{paddingTop:2,children:Js($n.error)})]})}function ie(ke){return(0,m.jsx)(B.B,{justifyContent:"space-between",children:(0,m.jsx)(W.J,{htmlFor:"description",children:"Title"})})}function J(ke){return(0,m.jsx)(B.B,{justifyContent:"space-between",children:(0,m.jsx)(W.J,{htmlFor:"description",children:"Description"})})}async function ce(ke,Re){if(ke===Re.folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await z.P.validateNewDashboardName(Re.folder.uid??"general",ke),!0}catch(Ye){return Ye instanceof Error?Ye.message:"Dashboard name is invalid"}}function pe(ke,Re,Ye){return{...ke,id:null,uid:"",title:Re.title,description:Re.description,tags:Ye||Re.copyTags?ke.tags:[]}}var Pe=e(10880);function Ie({dashboard:ke,drawer:Re,changeInfo:Ye}){const{changedSaveModel:lt,hasChanges:At}=Ye,{state:Nt,onSaveDashboard:Wt}=le(!1),[Ht,un]=(0,A.useState)({folderUid:ke.state.meta.folderUid}),an=async $n=>{(await Wt(ke,lt,{...Ht,overwrite:$n})).status==="success"&&(ke.closeModal(),Re.state.onSaveSuccess?.())},jn=(0,m.jsx)(O.$n,{variant:"secondary",onClick:()=>ke.closeModal(),fill:"outline",children:"Cancel"}),Xn=$n=>(0,m.jsx)(X,{isValid:At,isLoading:Nt.loading,onSave:an,overwrite:$n});function ds($n){return Q($n)?(0,m.jsxs)(j.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,m.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsxs)(B.B,{alignItems:"center",children:[jn,Xn(!0)]})})]}):Y($n)?(0,m.jsx)(te,{cancelButton:jn,saveButton:Xn}):q($n)?(0,m.jsxs)(j.F,{title:"Plugin dashboard",severity:"error",children:[(0,m.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,m.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsxs)(B.B,{alignItems:"center",children:[jn,Xn(!0)]})})]}):(0,m.jsxs)(m.Fragment,{children:[$n&&(0,m.jsx)(j.F,{title:"Failed to save dashboard",severity:"error",children:(0,m.jsx)("p",{children:$n.message})}),(0,m.jsxs)(B.B,{alignItems:"center",children:[jn,Xn(!1),!At&&(0,m.jsx)("div",{children:"No changes to save"})]})]})}return(0,m.jsxs)(B.B,{gap:2,direction:"column",children:[(0,m.jsx)(ge,{drawer:Re,changeInfo:Ye}),(0,m.jsx)(N.D,{label:"Message",children:(0,m.jsx)(K.f,{"aria-label":"message",value:Ht.message??"",onChange:$n=>{un({...Ht,message:$n.currentTarget.value})},placeholder:"Add a note to describe your changes (optional).",autoFocus:!0,rows:5})}),ds(Nt.error)]})}function ge({drawer:ke,changeInfo:Re}){const{saveVariables:Ye=!1,saveTimeRange:lt=!1,saveRefresh:At=!1}=ke.useState(),{hasTimeChanges:Nt,hasVariableValueChanges:Wt,hasRefreshChange:Ht}=Re;return(0,m.jsxs)(B.B,{direction:"column",alignItems:"flex-start",children:[Nt&&(0,m.jsx)(Pe.S,{id:"save-timerange",checked:lt,onChange:ke.onToggleSaveTimeRange,label:"Update default time range",description:"Will make current time range the new default","data-testid":S.Tp.pages.SaveDashboardModal.saveTimerange}),Ht&&(0,m.jsx)(Pe.S,{id:"save-refresh",label:"Update default refresh value",description:"Will make the current refresh the new default",checked:At,onChange:ke.onToggleSaveRefresh,"data-testid":S.Tp.pages.SaveDashboardModal.saveRefresh}),Wt&&(0,m.jsx)(Pe.S,{id:"save-variables",label:"Update default variable values",description:"Will make the current values the new default",checked:Ye,onChange:ke.onToggleSaveVariables,"data-testid":S.Tp.pages.SaveDashboardModal.saveVariables})]})}var Se=e(32196),De=e(4213),Ke=e.n(De),Me=e(70713),be=e(32372),we=e(10534);function Be({dashboard:ke,drawer:Re,changeInfo:Ye}){const lt=(0,A.useMemo)(()=>JSON.stringify(Ye.changedSaveModel,null,2),[Ye]),At=(0,A.useCallback)(()=>{const Nt=new Blob([lt],{type:"application/json;charset=utf-8"});(0,De.saveAs)(Nt,Ye.changedSaveModel.title+"-"+new Date().getTime()+".json")},[Ye.changedSaveModel,lt]);return(0,m.jsx)("div",{className:He.container,children:(0,m.jsxs)(B.B,{direction:"column",gap:2,grow:1,children:[(0,m.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,m.jsx)("br",{}),(0,m.jsxs)("i",{children:["See"," ",(0,m.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,m.jsx)("br",{})," ",(0,m.jsx)("br",{}),(0,m.jsx)("strong",{children:"File path: "})," ",ke.state.meta.provisionedExternalId]}),(0,m.jsx)(ge,{drawer:Re,changeInfo:Ye}),(0,m.jsx)("div",{className:He.json,children:(0,m.jsx)(Me.Ay,{disableWidth:!0,children:({height:Nt})=>(0,m.jsx)(be.B,{width:"100%",height:Nt,language:"json",showLineNumbers:!0,showMiniMap:lt.length>100,value:lt,readOnly:!0})})}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsxs)(B.B,{gap:2,children:[(0,m.jsx)(O.$n,{variant:"secondary",onClick:Re.onClose,fill:"outline",children:"Cancel"}),(0,m.jsx)(we.b,{icon:"copy",getText:()=>lt,children:"Copy JSON to clipboard"}),(0,m.jsx)(O.$n,{type:"submit",onClick:At,children:"Save JSON to file"})]})})]})})}const He={container:(0,Se.css)({height:"100%",display:"flex"}),json:(0,Se.css)({flexGrow:1,maxHeight:"800px"})};var Ve=e(20455),Je=e(45429);function nt(ke,Re,Ye,lt){const At=(0,Je.Yy)(ke.getInitialSaveModel(),(0,Ve.Uy)(ke),Re,Ye,lt),Nt=ke.getInitialState()?.meta.folderUid!==ke.state.meta.folderUid;return{...At,hasFolderChanges:Nt,hasChanges:At.hasChanges||Nt}}class pt extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{this.state.dashboardRef.resolve().setState({overlay:void 0})},this.onToggleSaveTimeRange=()=>{this.setState({saveTimeRange:!this.state.saveTimeRange})},this.onToggleSaveVariables=()=>{this.setState({saveVariables:!this.state.saveVariables})},this.onToggleSaveRefresh=()=>{this.setState({saveRefresh:!this.state.saveRefresh})}}static{this.Component=({model:Re})=>{const{showDiff:Ye,saveAsCopy:lt,saveTimeRange:At,saveVariables:Nt,saveRefresh:Wt}=Re.useState(),Ht=nt(Re.state.dashboardRef.resolve(),At,Nt,Wt),{changedSaveModel:un,initialSaveModel:an,diffs:jn,diffCount:Xn,hasFolderChanges:ds}=Ht,$n=Xn+(ds?1:0),is=Re.state.dashboardRef.resolve(),{meta:gs}=is.useState(),{provisioned:ss,folderTitle:us}=gs,ps=(0,m.jsxs)(D.U,{children:[(0,m.jsx)(x.o,{label:"Details",active:!Ye,onChangeTab:()=>Re.setState({showDiff:!1})}),$n>0&&(0,m.jsx)(x.o,{label:"Changes",active:Ye,onChangeTab:()=>Re.setState({showDiff:!0}),counter:$n})]});let Is="Save dashboard";lt?Is="Save dashboard copy":ss&&(Is="Provisioned dashboard");const ns=()=>Ye?(0,m.jsx)(C.l,{diff:jn,oldValue:an,newValue:un,hasFolderChanges:ds,oldFolder:is.getInitialState()?.meta.folderTitle,newFolder:us}):lt||Ht.isNew?(0,m.jsx)(he,{dashboard:is,changeInfo:Ht}):ss?(0,m.jsx)(Be,{dashboard:is,changeInfo:Ht,drawer:Re}):(0,m.jsx)(Ie,{dashboard:is,changeInfo:Ht,drawer:Re});return(0,m.jsx)(E._,{title:Is,subtitle:is.state.title,onClose:Re.onClose,tabs:ps,children:ns()})}}}var bt=e(19997),Tt=e(57714),ye=e(64423),je=e(18226),ue=e(94624),Ee=e(72724),Ce=e(13989),Ne=e(53543),Fe=e(74730);class Ue{constructor(Re){this._scene=Re,this.events=new je.o,this._subs=new ye.yU;const Ye=i.jh.getTimeRange(Re);this.formatDate=this.formatDate.bind(this),this._subs.add(Ye.subscribeToState((lt,At)=>{lt.value!==At.value&&this.events.publish(new g.sR(lt.value))}))}get id(){return this._scene.state.id??null}get uid(){return this._scene.state.uid??null}get title(){return this._scene.state.title}get description(){return this._scene.state.description}get editable(){return this._scene.state.editable}get graphTooltip(){return this._getSyncMode()}get timepicker(){return{refresh_intervals:this._scene.state.controls.state.refreshPicker.state.intervals,hidden:this._scene.state.controls.state.hideTimeControls??!1}}get timezone(){return this.getTimezone()}get weekStart(){return i.jh.getTimeRange(this._scene).state.weekStart}get tags(){return this._scene.state.tags}get links(){return this._scene.state.links}get meta(){return this._scene.state.meta}get time(){const Re=i.jh.getTimeRange(this._scene);return{from:Re.state.from,to:Re.state.to}}get panels(){return fe(this._scene,Ye=>Ye instanceof i.Eb).map(Ye=>new Ne.R(Ye))}get annotations(){const Re={list:[]};return this._scene.state.$data instanceof i.kh&&(Re.list=(0,Ce.O)(this._scene.state.$data.state.layers)),Re}getTimezone(){return i.jh.getTimeRange(this._scene).getTimeZone()}sharedTooltipModeEnabled(){return this._getSyncMode()>0}sharedCrosshairModeOnly(){return this._getSyncMode()===1}_getSyncMode(){if(this._scene.state.$behaviors){for(const Re of this._scene.state.$behaviors)if(Re instanceof i.Gg.K2)return Re.state.sync}return ue.y.Off}otherPanelInFullscreen(Re){return!1}formatDate(Re,Ye){return(0,Ee.LE)(Re,{format:Ye,timeZone:this.getTimezone()})}getPanelById(Re){const Ye=(0,Fe.vL)(this._scene,(0,Fe.XA)(Re));return Ye?new Ne.R(Ye):null}removePanel(Re){const Ye=(0,Fe.vL)(this._scene,(0,Fe.XA)(Re.id));if(!Ye){console.error("Trying to remove a panel that was not found in scene",Re);return}this._scene.removePanel(Ye)}canEditAnnotations(Re){return this._scene.canEditDashboard()?Re?!!this._scene.state.meta.annotationsPermissions?.dashboard.canEdit:!!this._scene.state.meta.annotationsPermissions?.organization.canEdit:!1}panelInitialized(){}destroy(){this.events.removeAllListeners(),this._subs.unsubscribe()}hasUnsavedChanges(){return this._scene.state.isDirty}}function fe(ke,Re){let Ye=[];return ke.forEachChild(lt=>{Re(lt)?Ye.push(lt):Ye=Ye.concat(fe(lt,Re))}),Ye}var Te=e(32023);function Ge(ke){let Re=5381;for(let Ye=0;Ye<ke.length;Ye++)Re=Re*33^ke.charCodeAt(Ye);return Re>>>0}var Qe=e(11982),st=e(16678),Xe=e(41507),ot=e(68435);class ft extends i.Bs{constructor(){super(...arguments),this.onClose=()=>{(0,Fe.YQ)(this).closeModal()},this.onAddLibraryPanel=Re=>{const Ye=(0,Fe.YQ)(this),lt=(0,Fe.O8)(Ye);lt.setState({$behaviors:[new ot.u({uid:Re.uid,name:Re.name})]});const At=this.state.panelToReplaceRef?.resolve();if(At){const Nt=At.parent;if(!(Nt instanceof Xe.U))throw new Error("Trying to replace a panel that does not have a DashboardGridItem");Nt.setState({body:lt})}else Ye.addPanel(lt);this.onClose()}}static{this.Component=({model:Re})=>{const Ye=(0,M.t)("library-panel.add-widget.title","Add panel from panel library");return(0,m.jsx)(E._,{title:Ye,onClose:Re.onClose,children:(0,m.jsx)(st.j,{onClick:Re.onAddLibraryPanel,variant:st.s.Tight,showPanelFilter:!0})})}}}var _e=e(54148),et=e(64388),it=e(23172),dt=e(40845),ze=e(57571),xe=e(27673),Oe=e(21780),Le=e(7392),Ze=e(68064),qe=e(61086),rt=e(46942),vt=e.n(rt),Ot=e(77517);const jt="--panels-per-row";function Ut({dashboard:ke,panelSearch:Re="",panelsPerRow:Ye}){const{body:lt}=ke.state,At=[],Nt=(0,dt.of)(qt),Wt=lt instanceof Ot.D?lt.state.grid:null;if(!Wt)return(0,m.jsx)(M.x6,{i18nKey:"panel-search.unsupported-layout",children:"Unsupported layout"});for(const Ht of Wt.state.children)if(Ht instanceof Xe.U)fn(Ht,ke,Re,At);else if(Ht instanceof i.tI)for(const un of Ht.state.children)un instanceof Xe.U&&fn(un,ke,Re,At);return At.length>0?(0,m.jsx)("div",{className:vt()(Nt.grid,{[Nt.perRow]:Ye!==void 0}),style:{[jt]:Ye},children:At.map(Ht=>(0,m.jsx)(zt,{panel:Ht},Ht.state.key))}):(0,m.jsx)("p",{className:Nt.noHits,children:(0,m.jsx)(M.x6,{i18nKey:"panel-search.no-matches",children:"No matches found"})})}function zt({panel:ke}){return(0,A.useEffect)(()=>(0,Fe.M6)(ke),[ke]),(0,m.jsx)(ke.Component,{model:ke})}function qt(ke){return{grid:(0,Se.css)({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(400px, 1fr))",gap:ke.spacing(1),gridAutoRows:"320px"}),perRow:(0,Se.css)({gridTemplateColumns:`repeat(var(${jt}, 3), 1fr)`}),noHits:(0,Se.css)({display:"grid",placeItems:"center"})}}function fn(ke,Re,Ye,lt){const At=i.jh.interpolate(Re,Ye).toLowerCase();if(ke.state.variableName&&!ke.isActive){const Wt=ke.state.body;Wt.interpolate(Wt.state.title,void 0,"text").toLowerCase().includes(At)&&ke.activate()}const Nt=ke.state.repeatedPanels??[ke.state.body];for(const Wt of Nt)Wt.interpolate(Wt.state.title,void 0,"text").toLowerCase().includes(At)&&lt.push(Wt);return lt}var Sn=e(84423),An=e(66827);const Hn=({dashboard:ke})=>{const Ye=ke.getDashboardPanels().some(At=>At instanceof i.Eb?Sn.vI.includes(At.state.pluginId):!1);return a.$.featureToggles.angularDeprecationUI&&ke.hasDashboardAngularPlugins()&&ke.state.uid?(0,m.jsx)(An.j,{dashboardUid:ke.state.uid,showAutoMigrateLink:Ye},ke.state.uid):null};function es({model:ke}){const{controls:Re,overlay:Ye,editview:lt,editPanel:At,isEmpty:Nt,meta:Wt,viewPanelScene:Ht,panelSearch:un,panelsPerRow:an}=ke.useState(),jn=(0,it.k)(),Xn=(0,dt.of)(rs,jn??0),ds=(0,_e.zy)(),$n=(0,se.useSelector)(Ls=>Ls.navIndex),is=ke.getPageNav(ds,$n),gs=ke.getBodyToRender(),ss=(0,o.tc)($n,"dashboards/browse"),us=Re?.hasControls(),ps=lt!==void 0,Is=a.$.featureToggles.singleTopNav;if((0,A.useMemo)(()=>{(Ht||ps||At)&&ke.rememberScrollPos()},[ps,At,Ht,ke]),(0,A.useEffect)(()=>{!Ht&&!ps&&!At&&ke.restoreScrollPos()},[ps,At,Ht,ke]),lt)return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(lt.Component,{model:lt}),Ye&&(0,m.jsx)(Ye.Component,{model:Ye})]});const ns=(0,m.jsx)(Ze.A,{dashboard:ke,canCreate:!!ke.state.meta.canEdit},"dashboard-empty-state"),Bs=(0,m.jsx)("div",{className:(0,Se.cx)(Xn.body,!us&&Xn.bodyWithoutControls),children:(0,m.jsx)(gs.Component,{model:gs})},"dashboard-panels"),Js=Wt.dashboardNotFound&&(0,m.jsx)(Le.L,{entity:"Dashboard"},"dashboard-not-found");let Ws=[(0,m.jsx)(Hn,{dashboard:ke},"angular-deprecation-banner"),Bs];return Js?Ws=[Js]:Nt?Ws=[ns,Bs]:(un||an)&&(Ws=(0,m.jsx)(Ut,{panelSearch:un,panelsPerRow:an,dashboard:ke})),(0,m.jsxs)(Oe.YW,{navModel:ss,pageNav:is,layout:et.k.Custom,toolbar:Is?(0,m.jsx)(qe.v,{dashboard:ke}):void 0,children:[At&&(0,m.jsx)(At.Component,{model:At}),!At&&(0,m.jsx)(xe.A,{divId:"page-scrollbar",onSetScrollRef:ke.onSetScrollRef,children:(0,m.jsxs)("div",{className:(0,Se.cx)(Xn.pageContainer,us&&Xn.pageContainerWithControls),children:[!Is&&(0,m.jsx)(qe.c,{dashboard:ke}),Re&&(0,m.jsx)("div",{className:Xn.controlsWrapper,children:(0,m.jsx)(Re.Component,{model:Re})}),(0,m.jsx)("div",{className:(0,Se.cx)(Xn.canvasContent),children:Ws})]})}),Ye&&(0,m.jsx)(Ye.Component,{model:Ye})]})}function rs(ke,Re){return{pageContainer:(0,Se.css)({display:"grid",gridTemplateAreas:`
  "panels"`,gridTemplateColumns:"1fr",gridTemplateRows:"1fr",flexGrow:1,[ke.breakpoints.down("sm")]:{display:"flex",flexDirection:"column"}}),pageContainerWithControls:(0,Se.css)({gridTemplateAreas:`
        "controls"
        "panels"`,gridTemplateRows:"auto 1fr"}),controlsWrapper:(0,Se.css)({display:"flex",flexDirection:"column",flexGrow:0,gridArea:"controls",padding:ke.spacing(2),":empty":{display:"none"},[ke.breakpoints.up("md")]:{position:"sticky",zIndex:ke.zIndex.activePanel,background:ke.colors.background.canvas,top:a.$.featureToggles.singleTopNav?Re+ze.l:Re}}),canvasContent:(0,Se.css)({label:"canvas-content",display:"flex",flexDirection:"column",padding:ke.spacing(.5,2),flexBasis:"100%",gridArea:"panels",flexGrow:1,minWidth:0}),body:(0,Se.css)({label:"body",flexGrow:1,display:"flex",gap:"8px",paddingBottom:ke.spacing(2),boxSizing:"border-box"}),bodyWithoutControls:(0,Se.css)({paddingTop:ke.spacing(2)})}}var Zn=e(10096),kn=e(65123),Gn=e(54612),Kn=e(16560),yn=e(29678),wn=e(14578),Jn=e(62930),bn=e(90182),Pt=e(16233),Ft=e(83195),Xt=e(2619),sn=e(2543),on=e(89667),xn=e(52622),Un=e(39070),hn=e(68706),St=e(41524);function kt(ke){const Re=[];if(ke?.series)for(const Ye of ke.series)Re.push((0,on.Nw)(Ye));if(ke?.annotations)for(const Ye of ke.annotations){const lt=(0,on.Nw)(Ye);lt.schema?.meta||(lt.schema.meta={}),lt.schema.meta.dataTopic=xn.QR.Annotations,Re.push(lt)}return Re}function en(ke,Re){const Ye={panelType:ke.state.pluginId,datasource:"??"},lt=a.$.buildInfo.versionString;let At=`| Key | Value |
|--|--|
| Panel | ${Ye.panelType} @ ${ke.state.pluginVersion??lt} |
| Grafana | ${lt} // ${a.$.buildInfo.edition} |
`;return Re&&(At+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+Re+"\n```\n</details>"),At}async function tn(ke,Re,Ye){let lt={type:""};const At=ke.parent;(0,Fe.ME)(ke)?lt={...(0,Ve.ZB)(At),...(0,Ve.Z6)(ke)}:lt=(0,Ve.ZB)(At);const Nt=(0,sn.cloneDeep)(Rt),Wt={panelType:ke.state.pluginId,datasource:"??"},Ht=(0,Fe.un)(ke);if(!Ht.state.data)return;const un=Ht.state.data,an=Ht?.state.datasource,jn=(0,St.W)(kt(un),Re),Xn=a.$.buildInfo.versionString,ds=Ht.state.queries??[],$n=un.annotations?un.annotations.reduce((gs,ss)=>ss.length+gs,0):0,is=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${Wt.panelType} @ ${lt.pluginVersion??Xn}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${ds.map(gs=>{const ss=gs.datasource??an;return`${gs.refId}[${ss?.type}]`}).join(", ")}</td>
    </tr>
    ${gn(lt)}
    ${Nn(un,jn)}
    ${Ct(un)}
    <tr>
      <th>Grafana</th>
      <td>${Xn} // ${a.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(Nt.panels[0]={...lt,...Nt.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:hn.nj.Snapshot,snapshot:jn}]},delete Nt.panels[0].libraryPanel,lt.transformations?.length){const gs=Nt.panels[Nt.panels.length-1];gs.title=gs.title+" (after transformations)";const ss=(0,sn.cloneDeep)(gs);ss.id=100,ss.title="Data (before transformations)",ss.gridPos.w=24,ss.targets[0].withTransforms=!1,Nt.panels.push(ss)}return $n>0&&Nt.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:xn.QR.Annotations,refId:"A"}]}),Nt.panels[1].options.content=is,Nt.panels[2].options.content=JSON.stringify(lt,null,2),Nt.title=`Debug: ${lt.title} // ${(0,Ee.LE)(new Date)}`,Nt.tags=["debug",`debug-${Wt.panelType}`],Nt.time={from:Ye.from.toISOString(),to:Ye.to.toISOString()},Nt}function gn(ke){return ke.transformations?`<tr>
      <th>Transform</th>
      <td>${ke.transformations.map(Re=>Re.id).join(", ")}</td>
  </tr>`:""}function Nn(ke,Re){let Ye=ke.series.length??0,lt=0,At=0;for(const Nt of ke.series)lt+=Nt.fields.length,At+=Nt.length;return`<tr><th>Data</th><td>${ke.state!==Un.Gu.Done?ke.state:""} ${Ye} frames, ${lt} fields, ${At} rows </td></tr>`}function Ct(ke){return ke.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${ke.annotations.reduce((Re,Ye)=>Ye.length+Re,0)}</td>
</tr>`:""}const Rt={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37};var Mt=(ke=>(ke[ke.Support=0]="Support",ke[ke.Data=1]="Data",ke))(Mt||{}),Kt=(ke=>(ke[ke.PanelSnapshot=0]="PanelSnapshot",ke[ke.GithubComment=1]="GithubComment",ke))(Kt||{});class nn extends Xt.Q{constructor(Re){super({panel:Re,panelTitle:i.jh.interpolate(Re,Re.state.title,{},"text"),currentTab:0,showMessage:1,snapshotText:"",markdownText:"",randomize:{},snapshotUpdate:0,options:[{label:"GitHub comment",description:"Copy and paste this message into a GitHub issue or comment",value:1},{label:"Panel support snapshot",description:"Dashboard JSON used to help troubleshoot visualization issues",value:0}]}),this.onCurrentTabChange=Ye=>{this.setState({currentTab:Ye})},this.onShowMessageChange=Ye=>{this.setState({showMessage:Ye.value})},this.onGetMarkdownForClipboard=()=>{const{markdownText:Ye}=this.state,lt=Math.pow(1024,2)*1.5;return Ye.length>lt?(this.setState({error:{title:"Copy to clipboard failed",message:"Snapshot is too large, consider download and attaching a file instead"}}),""):Ye},this.onDownloadDashboard=()=>{const{snapshotText:Ye,panelTitle:lt}=this.state,At=new Blob([Ye],{type:"text/plain"}),Nt=`debug-${lt}-${(0,Ee.LE)(new Date)}.json.txt`;Ke()(At,Nt)},this.onSetSnapshotText=Ye=>{this.setState({snapshotText:Ye})},this.onToggleRandomize=Ye=>{const{randomize:lt}=this.state;this.setState({randomize:{...lt,[Ye]:!lt[Ye]}})}}async buildDebugDashboard(){const{panel:Re,randomize:Ye,snapshotUpdate:lt}=this.state,At=await tn(Re,Ye,i.jh.getTimeRange(Re).state.value),Nt=JSON.stringify(At,null,2),Wt=en(Re,Nt),Ht=(0,Ft.cN)((0,Ft.j_)("bytes")(Nt?.length??0));let un;if(At)try{un=(0,bt.wM)({dashboard:At,meta:{isEmbedded:!0}}).state.body}catch(an){console.log("Error creating scene:",an)}this.setState({snapshot:At,snapshotText:Nt,markdownText:Wt,snapshotSize:Ht,snapshotUpdate:lt+1,scene:un})}}function Qt({panel:ke,onClose:Re}){const Ye=(0,dt.of)(ln),lt=(0,A.useMemo)(()=>new nn(ke),[ke]),At=ke.getPlugin(),{currentTab:Nt,loading:Wt,error:Ht,options:un,showMessage:an,snapshotSize:jn,markdownText:Xn,snapshotText:ds,randomize:$n,panelTitle:is,scene:gs}=lt.useState();if((0,A.useEffect)(()=>{lt.buildDebugDashboard()},[lt,At,$n]),!At)return null;const ss=[{label:"Snapshot",value:Mt.Support},{label:"Data",value:Mt.Data}],us=a.$.supportBundlesEnabled&&Pt.TP.hasPermission(se.AccessControlAction.ActionSupportBundlesCreate);return(0,m.jsxs)(E._,{title:"Get help with this panel",size:"lg",onClose:Re,subtitle:(0,m.jsxs)(B.B,{direction:"column",gap:1,children:[(0,m.jsxs)(B.B,{direction:"row",gap:1,children:[(0,m.jsx)(yn.y,{featureState:r.Ay.beta}),(0,m.jsxs)("a",{href:"https://grafana.com/docs/grafana/latest/troubleshooting/",target:"blank",className:"external-link",rel:"noopener noreferrer",children:["Troubleshooting docs ",(0,m.jsx)(wn.I,{name:"external-link-alt"})]})]}),(0,m.jsx)("span",{className:"muted",children:"To request troubleshooting help, send a snapshot of this panel to Grafana Labs Technical Support. The snapshot contains query response data and panel settings."}),us&&(0,m.jsxs)("span",{className:"muted",children:["You can also retrieve a support bundle containing information concerning your Grafana instance and configured datasources in the ",(0,m.jsx)("a",{href:"/support-bundles",children:"support bundles section"}),"."]})]}),tabs:(0,m.jsx)(D.U,{children:ss.map((ps,Is)=>(0,m.jsx)(x.o,{label:ps.label,active:ps.value===Nt,onChangeTab:()=>lt.onCurrentTabChange(ps.value)},`${ps.value}-${Is}`))}),children:[Wt&&(0,m.jsx)(Jn.y,{}),Ht&&(0,m.jsx)(j.F,{title:Ht.title,children:Ht.message}),Nt===Mt.Data&&(0,m.jsxs)("div",{className:Ye.code,children:[(0,m.jsxs)("div",{className:Ye.opts,children:[(0,m.jsx)(N.D,{label:"Template",className:Ye.field,children:(0,m.jsx)(bn.l6,{options:un,value:an,onChange:lt.onShowMessageChange})}),an===Kt.GithubComment?(0,m.jsx)(we.b,{icon:"copy",getText:lt.onGetMarkdownForClipboard,children:"Copy to clipboard"}):(0,m.jsxs)(O.$n,{icon:"download-alt",onClick:lt.onDownloadDashboard,children:["Download (",jn,")"]})]}),(0,m.jsx)(Me.Ay,{disableWidth:!0,children:({height:ps})=>(0,m.jsx)(be.B,{width:"100%",height:ps,language:an===Kt.GithubComment?"markdown":"json",showLineNumbers:!0,showMiniMap:!0,value:an===Kt.GithubComment?Xn:ds,readOnly:!1,onBlur:lt.onSetSnapshotText})})]}),Nt===Mt.Support&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(N.D,{label:"Randomize data",description:"Modify the original data to hide sensitive information.  Note the lengths will stay the same, and duplicate values will be equal.",children:(0,m.jsxs)(B.B,{children:[(0,m.jsx)(w.K,{label:"Labels",id:"randomize-labels",showLabel:!0,value:!!$n.labels,onChange:()=>lt.onToggleRandomize("labels")}),(0,m.jsx)(w.K,{label:"Field names",id:"randomize-field-names",showLabel:!0,value:!!$n.names,onChange:()=>lt.onToggleRandomize("names")}),(0,m.jsx)(w.K,{label:"String values",id:"randomize-string-values",showLabel:!0,value:!!$n.values,onChange:()=>lt.onToggleRandomize("values")})]})}),(0,m.jsx)(N.D,{label:"Support snapshot",description:`Panel: ${is}`,children:(0,m.jsxs)(B.B,{children:[(0,m.jsxs)(O.$n,{icon:"download-alt",onClick:lt.onDownloadDashboard,children:["Dashboard (",jn,")"]}),(0,m.jsx)(we.b,{icon:"github",getText:lt.onGetMarkdownForClipboard,title:"Copy a complete GitHub comment to the clipboard",children:"Copy to clipboard"})]})}),(0,m.jsx)(Me.Ay,{disableWidth:!0,children:({height:ps})=>(0,m.jsx)("div",{style:{height:ps,overflow:"auto"},children:gs&&(0,m.jsx)(gs.Component,{model:gs})})})]})]})}const ln=ke=>({code:(0,Se.css)({flexGrow:1,height:"100%",overflow:"scroll"}),field:(0,Se.css)({width:"100%"}),opts:(0,Se.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end","& button":{marginLeft:ke.spacing(1)}})});var pn=e(61453);class In extends i.Bs{constructor(Re){super({...Re,options:{withTransforms:!1,withFieldConfig:!0}}),this.onOptionsChange=Ye=>{this.setState({options:Ye})}}getTabLabel(){return(0,M.t)("dashboard.inspect.data-tab","Data")}getTabValue(){return Kn.q.Data}static{this.Component=({model:Re})=>{const{options:Ye}=Re.useState(),lt=Re.state.panelRef.resolve(),At=i.jh.getData(lt),{data:Nt}=qn(At,Ye.withTransforms).useState(),Wt=i.jh.getTimeRange(lt);return(0,m.jsx)(pn.q,{isLoading:Nt?.state===Un.Gu.Loading,data:Nt?.series,options:Ye,hasTransformations:Rn(At),timeZone:Wt.getTimeZone(),panelPluginId:lt.state.pluginId,dataName:lt.state.title,fieldConfig:lt.state.fieldConfig,onOptionsChange:Re.onOptionsChange})}}}function Rn(ke){return ke instanceof i.Es?ke.state.transformations.length>0:!1}function qn(ke,Re){return!Re&&ke instanceof i.Es&&ke.state.$data?ke.state.$data:ke}var os=e(18803),cs=e(26323),hs=e(77938),Ss=e(6204);class Os extends i.Bs{constructor(Re){super({...Re,source:"panel-json",jsonText:ka("panel-json",Re.panelRef.resolve())}),this.onChangeSource=Ye=>{this.setState({source:Ye.value,jsonText:ka(Ye.value,this.state.panelRef.resolve())})},this.onApplyChange=()=>{const Ye=this.state.panelRef.resolve(),lt=(0,Fe.YQ)(Ye),At=JSON.parse(this.state.jsonText),Nt=new p.a(At),Wt=(0,bt.tt)(Nt),Ht=i.Go.cloneSceneObjectState(Wt.state);if(!(Ye.parent instanceof Xe.U)){console.error("Cannot update state of panel",Ye,Wt);return}this.state.onClose(),lt.state.isEditing||lt.onEnterEditMode(),Ye.parent.setState(Ht),(0,Ss.B9)(Kn.q.JSON,"apply",{panel_type_changed:Ye.state.pluginId!==Nt.type,panel_id_changed:(0,Fe.Cs)(Ye)!==Nt.id,panel_grid_pos_changed:Oa(Ye.parent.state,Ht),panel_targets_changed:ba((0,Fe.un)(Ye),(0,Fe.un)(Ht.$data))})},this.onCodeEditorBlur=Ye=>{this.setState({jsonText:Ye})}}getTabLabel(){return(0,M.t)("dashboard.inspect.json-tab","JSON")}getTabValue(){return Kn.q.JSON}getOptions(){const Re=this.state.panelRef.resolve(),Ye=Re.state.$data??Re.parent?.state.$data,lt=[{label:(0,M.t)("dashboard.inspect-json.panel-json-label","Panel JSON"),description:(0,M.t)("dashboard.inspect-json.panel-json-description","The model saved in the dashboard JSON that configures how everything works."),value:"panel-json"}];return Ye&&(lt.push({label:(0,M.t)("dashboard.inspect-json.panel-data-label","Panel data"),description:(0,M.t)("dashboard.inspect-json.panel-data-description","The raw model passed to the panel visualization"),value:"panel-data"}),lt.push({label:(0,M.t)("dashboard.inspect-json.dataframe-label","DataFrame JSON (from Query)"),description:(0,M.t)("dashboard.inspect-json.dataframe-description","Raw data without transformations and field config applied. "),value:"data-frames"})),lt}isEditable(){if(this.state.source!=="panel-json")return!1;const Re=this.state.panelRef.resolve();return(0,Fe.ME)(Re)||Re.parent instanceof Xe.U&&Re.parent.isRepeated()?!1:(0,Fe.YQ)(Re).state.meta.canEdit}static{this.Component=({model:Re})=>{const{source:Ye,jsonText:lt}=Re.useState(),At=(0,dt.of)(cs.A),Nt=Re.getOptions();return(0,m.jsxs)("div",{className:At.wrap,children:[(0,m.jsxs)("div",{className:At.toolbar,"data-testid":S.Tp.components.PanelInspector.Json.content,children:[(0,m.jsx)(N.D,{label:(0,M.t)("dashboard.inspect-json.select-source","Select source"),className:"flex-grow-1",children:(0,m.jsx)(bn.l6,{inputId:"select-source-dropdown",options:Nt,value:Nt.find(Wt=>Wt.value===Ye)??Nt[0].value,onChange:Re.onChangeSource})}),Re.isEditable()&&(0,m.jsx)(O.$n,{className:At.toolbarItem,onClick:Re.onApplyChange,children:"Apply"})]}),(0,m.jsx)("div",{className:At.content,children:(0,m.jsx)(Me.Ay,{disableWidth:!0,children:({height:Wt})=>(0,m.jsx)(be.B,{width:"100%",height:Wt,language:"json",showLineNumbers:!0,showMiniMap:lt.length>100,value:lt,readOnly:!Re.isEditable(),onBlur:Re.onCodeEditorBlur})})})]})}}}function ka(ke,Re){let Ye={};switch(ke){case"panel-json":{(0,Ss.B9)(Kn.q.JSON,"panelData");const lt=(0,Fe.ME)(Re),At=Re.parent;if(lt){Ye=na(Re);break}At instanceof Xe.U&&(Ye=(0,Ve.ZB)(At));break}case"panel-data":{(0,Ss.B9)(Kn.q.JSON,"panelJSON");const lt=i.jh.getData(Re);lt.state.data&&(Ye=Re.applyFieldConfig(lt.state.data));break}case"data-frames":{(0,Ss.B9)(Kn.q.JSON,"dataFrame");const lt=i.jh.getData(Re);lt.state.data&&(lt instanceof i.Es&&lt.state.$data?.state.data?Ye=(0,os.B6)(lt.state.$data.state.data):Ye=(0,os.B6)(lt.state.data))}}return(0,hs.p)(Ye)}function na(ke){if(!(0,Fe.ME)(ke))throw"Panel not a library panel";const Re=ke.parent;if(!(Re instanceof Xe.U))throw"LibraryPanel not child of DashboardGridItem";const Ye={x:Re.state.x||0,y:Re.state.y||0,h:Re.state.height||0,w:Re.state.width||0},lt=_a(ke),At=(0,Ve.Z6)(ke.clone({$behaviors:void 0}),Ye,!1,Re);return{libraryPanel:{...lt},...At}}function _a(ke){if(!(0,Fe.ME)(ke))throw new Error("Panel not a Library panel");const Re=(0,Fe.iL)(ke);if(!Re)throw new Error("Library panel behavior not found");if(!Re.state._loadedPanel)throw new Error("Library panel not loaded");return Re.state._loadedPanel}function Oa(ke,Re){return ke.x!==Re.x||ke.y!==Re.y||ke.width!==Re.width||ke.height!==Re.height}function ba(ke,Re){return ke===void 0||Re===void 0?!1:!(0,sn.isEqual)(ke.state.queries,Re.state.queries)}class Rs extends i.Bs{getTabLabel(){return(0,M.t)("dashboard.inspect.meta-tab","Meta data")}getTabValue(){return Kn.q.Meta}static{this.Component=({model:Re})=>{const{panelRef:Ye,dataSource:lt}=Re.state,At=i.jh.getData(Ye.resolve()),Nt=lt.components?.MetadataInspector;return!At.state.data||!Nt?null:(0,m.jsx)(Nt,{datasource:lt,data:At.state.data.series})}}}var Aa=e(90820);class va extends i.Bs{constructor(){super(...arguments),this.onRefreshQuery=()=>{const Re=(0,Fe.un)(this.state.panelRef.resolve());Re&&Re.runQueries()}}getTabLabel(){return(0,M.t)("dashboard.inspect.query-tab","Query")}getTabValue(){return Kn.q.Query}static{this.Component=({model:Re})=>{const Ye=i.jh.getData(Re.state.panelRef.resolve()).useState();return Ye.data?(0,m.jsx)(Aa.e,{data:Ye.data,onRefreshQuery:Re.onRefreshQuery}):null}}}var la=e(32067);class or extends i.Bs{getTabLabel(){return(0,M.t)("dashboard.inspect.stats-tab","Stats")}getTabValue(){return Kn.q.Stats}static{this.Component=({model:Re})=>{const Ye=i.jh.getData(Re.state.panelRef.resolve()).useState(),lt=i.jh.getTimeRange(Re.state.panelRef.resolve());return Ye.data?(0,m.jsx)(la.N,{data:Ye.data,timeZone:lt.getTimeZone()}):null}}}class Dr extends i.Bs{constructor(Re){super(Re),this.onClose=()=>{const Ye=(0,Fe.YQ)(this);s.Ny.push((0,Qe.uZ)({uid:Ye.state.uid,slug:Ye.state.meta.slug,currentQueryParams:s.Ny.getLocation().search,updateQuery:{inspect:null,inspectTab:null}}))},this.addActivationHandler(()=>this._activationHandler())}static{this.Component=Cr}_activationHandler(){this.buildTabs(0)}async buildTabs(Re){const Ye=this.state.panelRef,lt=Ye.resolve()?.getPlugin(),At=[];if(lt||(Re<2e3?setTimeout(()=>this.buildTabs(Re+100),100):this.setState({pluginNotLoaded:!0})),Ye){if((0,Gn.$)(lt)){const Nt=i.jh.getData(Ye.resolve());At.push(new In({panelRef:Ye})),At.push(new or({panelRef:Ye})),At.push(new va({panelRef:Ye}));const Wt=await(0,kn.BN)(Nt.state.data);Wt&&At.push(new Rs({panelRef:Ye,dataSource:Wt}))}At.push(new Os({panelRef:Ye,onClose:this.onClose}))}this.setState({tabs:At})}getDrawerTitle(){const Re=this.state.panelRef?.resolve();return Re?i.jh.interpolate(Re,`Inspect: ${Re.state.title}`):"Inspect panel"}}function Cr({model:ke}){const{tabs:Re,pluginNotLoaded:Ye,panelRef:lt}=ke.useState(),At=(0,_e.zy)(),Nt=new URLSearchParams(At.search);if(!Re)return null;const Wt=Nt.get("inspectTab"),Ht=Re.find(an=>an.getTabValue()===Wt)??Re[0],un=lt.resolve();return Wt===Kn.q.Help?(0,m.jsx)(Qt,{panel:un,onClose:ke.onClose}):(0,m.jsxs)(E._,{title:ke.getDrawerTitle(),onClose:ke.onClose,size:"md",tabs:(0,m.jsx)(D.U,{children:Re.map(an=>(0,m.jsx)(x.o,{label:an.getTabLabel(),active:an===Ht,href:t.I.getUrlForPartial(At,{inspectTab:an.getTabValue()})},an.state.key))}),children:[Ye&&(0,m.jsx)(j.F,{title:"Panel plugin not loaded",children:"Make sure the panel you want to inspect is visible and has been displayed before opening inspect."}),Ht&&Ht.Component&&(0,m.jsx)(Ht.Component,{model:Ht})]})}var Fa=e(34865),Ka=e(22391),wa=e(19347),xt=e(38477);class wt{constructor(Re){this._scene=Re}getKeys(){return["editIndex"]}getUrlState(){const Re=this._scene.state;return{editIndex:Re.editIndex!==void 0?String(Re.editIndex):void 0}}updateFromUrl(Re){let Ye={};typeof Re.editIndex=="string"?Ye={editIndex:Number(Re.editIndex)}:Ye={editIndex:void 0},Object.keys(Ye).length>0&&this._scene.setState(Ye)}}var Zt=e(16817),cn=e(84167),dn=e(77268),Tn=e(82241),Qn=e(51612),On=e(46502);const ys="New annotation",Ns=({annotation:ke,editIndex:Re,panels:Ye,onUpdate:lt,onBackToList:At,onDelete:Nt})=>{const Wt=(0,dt.of)(xs),Ht=(0,A.useMemo)(()=>ke.filter?ke.filter.exclude?2:1:0,[ke.filter]),{value:un}=(0,Zt.A)(()=>(0,wa.l)().get(ke.datasource),[ke.datasource]),an=(0,wa.l)().getInstanceSettings(ke.datasource),jn=ns=>{lt({...ke,name:ns.currentTarget.value},Re)},Xn=ns=>{const Bs=(0,Ka.p$)(ns);ke.datasource?.type!==Bs.type?lt({datasource:Bs,builtIn:ke.builtIn,enable:ke.enable,iconColor:ke.iconColor,name:ke.name,hide:ke.hide,filter:ke.filter,mappings:ke.mappings,type:ke.type},Re):lt({...ke,datasource:Bs},Re)},ds=ns=>{const Bs=ns.currentTarget;lt({...ke,[Bs.name]:Bs.type==="checkbox"?Bs.checked:Bs.value},Re)},$n=ns=>{lt({...ke,iconColor:ns},Re)},is=ns=>{let Bs=ns.value===0?void 0:{exclude:ns.value===2,ids:ke.filter?.ids??[]};lt({...ke,filter:Bs},Re)},gs=ns=>{if(!Array.isArray(ns))return;const Bs={exclude:Ht===2,ids:[]};ns.forEach(Js=>Js.value&&Bs.ids.push(Js.value)),lt({...ke,filter:Bs},Re)},ss=()=>{Nt(Re),At()},us=ke.name===ys,ps=(ns,Bs)=>ns.label&&Bs.label?ns.label.toLowerCase().localeCompare(Bs.label.toLowerCase()):-1,Is=(0,A.useMemo)(()=>Ye.filter(ns=>a.$.panels[ns.state.pluginId]).map(ns=>({value:(0,Fe.Cs)(ns),label:ns.state.title??`Panel ${(0,Fe.Cs)(ns)}`,description:ns.state.description,imgUrl:a.$.panels[ns.state.pluginId].info.logos.small})).sort(ps)??[],[Ye]);return(0,m.jsxs)("div",{children:[(0,m.jsxs)(cn.n,{className:Wt.settingsForm,children:[(0,m.jsx)(N.D,{label:"Name",children:(0,m.jsx)(I.p,{"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.Settings.name,name:"name",id:"name",autoFocus:us,value:ke.name,onChange:jn})}),(0,m.jsx)(N.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,m.jsx)(Qn.s,{annotations:!0,variables:!0,current:ke.datasource,onChange:Xn})}),!un?.meta.annotations&&(0,m.jsx)(j.F,{title:"No annotation support for this data source",severity:"error",children:(0,m.jsx)(M.x6,{i18nKey:"errors.dashboard-settings.annotations.datasource",children:"The selected data source does not support annotations. Please select a different data source."})}),(0,m.jsx)(N.D,{label:"Enabled",description:"When enabled the annotation query is issued every dashboard refresh",children:(0,m.jsx)(Pe.S,{name:"enable",id:"enable",value:ke.enable,onChange:ds,"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.enable})}),(0,m.jsx)(N.D,{label:"Hidden",description:"Annotation queries can be toggled on or off at the top of the dashboard. With this option checked this toggle will be hidden.",children:(0,m.jsx)(Pe.S,{name:"hide",id:"hide",value:ke.hide,onChange:ds,"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.hide})}),(0,m.jsx)(N.D,{label:"Color",description:"Color to use for the annotation event markers",children:(0,m.jsx)(B.B,{children:(0,m.jsx)(dn.a,{value:ke?.iconColor,onChange:$n})})}),(0,m.jsx)(N.D,{label:"Show in","data-testid":S.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.showInLabel,children:(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(bn.l6,{options:$s,value:Ht,onChange:is,"data-testid":S.Tp.components.Annotations.annotationsTypeInput}),Ht!==0&&(0,m.jsx)(bn.KF,{options:Is,value:Is.filter(ns=>ke.filter?.ids.includes(ns.value)),onChange:gs,isClearable:!0,placeholder:"Choose panels",width:100,closeMenuOnSelect:!1,className:Wt.select,"data-testid":S.Tp.components.Annotations.annotationsChoosePanelInput})]})})]}),(0,m.jsxs)(cn.n,{children:[(0,m.jsx)("h3",{className:"page-heading",children:"Query"}),un?.annotations&&an&&(0,m.jsx)(Tn.A,{datasource:un,datasourceInstanceSettings:an,annotation:ke,onChange:ns=>lt(ns,Re)}),un&&!un.annotations&&(0,m.jsx)(On.F,{datasource:un,annotation:ke,onChange:ns=>lt(ns,Re)})]}),(0,m.jsxs)(B.B,{children:[!ke.builtIn&&(0,m.jsx)(O.$n,{variant:"destructive",onClick:ss,"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.delete,children:"Delete"}),(0,m.jsx)(O.$n,{variant:"secondary",onClick:At,"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.NewAnnotation.apply,children:"Back to list"})]})]})},xs=ke=>({settingsForm:(0,Se.css)({maxWidth:ke.spacing(60),marginBottom:ke.spacing(2)}),select:(0,Se.css)({marginTop:"8px"})});var Ks=(ke=>(ke[ke.AllPanels=0]="AllPanels",ke[ke.IncludePanels=1]="IncludePanels",ke[ke.ExcludePanels=2]="ExcludePanels",ke))(Ks||{});const $s=[{label:"All panels",value:0,description:"Send the annotation data to all panels that support annotations"},{label:"Selected panels",value:1,description:"Send the annotations to the explicitly listed panels"},{label:"All panels except",value:2,description:"Do not send annotation data to the following panels"}];var fs=e(29158),aa=e(91605),Kr=e(69529),wr=e(72109),fo=e(46991);const xi="Add annotation query",br=({annotations:ke,onNew:Re,onEdit:Ye,onMove:lt,onDelete:At})=>{const Nt=(0,dt.of)($r),Wt=ke.length===0||ke.length===1&&ke[0].builtIn,Ht=an=>an.enable===!1?(0,m.jsxs)("em",{className:"muted",children:["(Disabled) \xA0 ",an.name]}):an.builtIn?(0,m.jsxs)("em",{className:"muted",children:[an.name," \xA0 (Built-in)"]}):(0,m.jsx)(m.Fragment,{children:an.name}),un=(0,wa.l)();return(0,m.jsxs)(B.B,{direction:"column",children:[ke.length>0&&(0,m.jsx)("div",{className:Nt.table,children:(0,m.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Query name"}),(0,m.jsx)("th",{children:"Data source"}),(0,m.jsx)("th",{colSpan:3})]})}),(0,m.jsx)("tbody",{"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.List.annotations,children:ke.map((an,jn)=>(0,m.jsxs)("tr",{children:[an.builtIn?(0,m.jsx)("td",{role:"gridcell",style:{width:"90%"},className:"pointer",onClick:()=>Ye(jn),children:(0,m.jsx)(O.$n,{size:"sm",fill:"text",variant:"secondary",children:Ht(an)})}):(0,m.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ye(jn),children:(0,m.jsx)(O.$n,{size:"sm",fill:"text",variant:"secondary",children:Ht(an)})}),(0,m.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>Ye(jn),children:un.getInstanceSettings(an.datasource)?.name||an.datasource?.uid}),(0,m.jsx)("td",{role:"gridcell",style:{width:"1%"},children:jn!==0&&(0,m.jsx)(fs.K,{name:"arrow-up",onClick:()=>lt(jn,Ya.UP),tooltip:"Move up"})}),(0,m.jsx)("td",{role:"gridcell",style:{width:"1%"},children:ke.length>1&&jn!==ke.length-1?(0,m.jsx)(fs.K,{name:"arrow-down",onClick:()=>lt(jn,Ya.DOWN),tooltip:"Move down"}):null}),(0,m.jsx)("td",{role:"gridcell",style:{width:"1%"},children:!an.builtIn&&(0,m.jsx)(aa.e,{size:"sm",onConfirm:()=>At(jn),"aria-label":`Delete query with title "${an.name}"`})})]},`${an.name}-${jn}`))})]})}),Wt&&(0,m.jsx)(B.B,{direction:"column",children:(0,m.jsxs)(Kr.p,{variant:"call-to-action",button:(0,m.jsx)(O.$n,{"data-testid":S.Tp.components.CallToActionCard.buttonV2("Add annotation query"),icon:"comment-alt",onClick:Re,size:"lg",children:(0,m.jsx)(M.x6,{i18nKey:"annotations.empty-state.button-title",children:"Add annotation query"})}),message:(0,M.t)("annotations.empty-state.title","There are no custom annotation queries added yet"),children:[(0,m.jsx)(M.x6,{i18nKey:"annotations.empty-state.info-box-content",children:(0,m.jsx)("p",{children:"Annotations provide a way to integrate event data into your graphs. They are visualized as vertical lines and icons on all graph panels. When you hover over an annotation icon you can get event text & tags for the event. You can add annotation events directly from grafana by holding CTRL or CMD + click on graph (or drag region). These will be stored in Grafana's annotation database."})}),(0,m.jsxs)(M.x6,{i18nKey:"annotations.empty-state.info-box-content-2",children:["Checkout the"," ",(0,m.jsx)(wr.Y,{external:!0,href:"http://docs.grafana.org/reference/annotations/",children:"Annotations documentation"})," ","for more information."]})]})}),!Wt&&(0,m.jsx)(fo.d,{"data-testid":S.Tp.pages.Dashboard.Settings.Annotations.List.addAnnotationCTAV2,onClick:Re,children:"New query"})]})},$r=()=>({table:(0,Se.css)({width:"100%",overflowX:"auto"})});var Ya=(ke=>(ke[ke.UP=-1]="UP",ke[ke.DOWN=1]="DOWN",ke))(Ya||{});class go extends i.Bs{constructor(){super(...arguments),this._urlSync=new wt(this),this.getDataSourceRefForAnnotation=()=>{const Re=(0,wa.l)().getInstanceSettings(null);if(!Re||!Re.meta.annotations){console.error("Default datasource does not support annotations");return}return(0,Ka.p$)(Re)},this.onNew=async()=>{const Re={name:ys,enable:!0,datasource:this.getDataSourceRefForAnnotation(),iconColor:"red"},Ye=new xt.g({query:Re,name:Re.name,isEnabled:!!Re.enable,isHidden:!!Re.hide}),lt=Te.b4.getDataLayers(this._dashboard);lt.addAnnotationLayer(Ye),this.setState({editIndex:lt.state.annotationLayers.length-1})},this.onEdit=Re=>{this.setState({editIndex:Re})},this.onBackToList=()=>{this.setState({editIndex:void 0})},this.onMove=(Re,Ye)=>{const lt=Te.b4.getDataLayers(this._dashboard),At=[...lt.state.annotationLayers],[Nt]=At.splice(Re,1);At.splice(Re+Ye,0,Nt),lt.setState({annotationLayers:At})},this.onDelete=Re=>{const Ye=Te.b4.getDataLayers(this._dashboard),lt=[...Ye.state.annotationLayers];lt.splice(Re,1),Ye.setState({annotationLayers:lt})},this.onUpdate=(Re,Ye)=>{const lt=this.getDataLayer(Ye);lt.setState({name:Re.name,isEnabled:!!Re.enable,isHidden:!!Re.hide,query:Re}),lt.runLayer()}}static{this.Component=po}getUrlKey(){return"annotations"}get _dashboard(){return(0,Fe.YQ)(this)}getDataLayer(Re){const lt=Te.b4.getDataLayers(this._dashboard).state.annotationLayers[Re];if(!(lt instanceof i.tV.g))throw new Error("AnnotationsDataLayer not found at index "+Re);return lt}getDashboard(){return this._dashboard}}function po({model:ke}){const Re=ke.getDashboard(),{annotationLayers:Ye}=Te.b4.getDataLayers(Re).useState(),{navModel:lt,pageNav:At}=Ta(Re,ke.getUrlKey()),{editIndex:Nt}=ke.useState(),Wt=Te.b4.getVizPanels(Re),Ht=a.$.featureToggles.singleTopNav,un=(0,Ce.O)(Ye);return Nt!=null&&Nt<Ye.length?(0,m.jsx)(mo,{annotationLayer:ke.getDataLayer(Nt),pageNav:At,panels:Wt,editIndex:Nt,navModel:lt,dashboard:Re,onUpdate:ke.onUpdate,onBackToList:ke.onBackToList,onDelete:ke.onDelete}):(0,m.jsxs)(Oe.YW,{navModel:lt,pageNav:At,layout:et.k.Standard,toolbar:Ht?(0,m.jsx)(qe.v,{dashboard:Re}):void 0,children:[!Ht&&(0,m.jsx)(qe.c,{dashboard:Re}),(0,m.jsx)(br,{annotations:un,onNew:ke.onNew,onEdit:ke.onEdit,onDelete:ke.onDelete,onMove:ke.onMove})]})}function mo({annotationLayer:ke,pageNav:Re,navModel:Ye,panels:lt,editIndex:At,dashboard:Nt,onUpdate:Wt,onBackToList:Ht,onDelete:un}){const{name:an,query:jn}=ke.useState(),Xn=a.$.featureToggles.singleTopNav,ds={text:an,parentItem:Re};return(0,m.jsxs)(Oe.YW,{navModel:Ye,pageNav:ds,layout:et.k.Standard,toolbar:Xn?(0,m.jsx)(qe.v,{dashboard:Nt}):void 0,children:[!Xn&&(0,m.jsx)(qe.c,{dashboard:Nt}),(0,m.jsx)(Ns,{annotation:jn,editIndex:At,panels:lt,onUpdate:Wt,onBackToList:Ht,onDelete:un})]})}var vo=e(14588),yo=e(65857),$a=e(6199),xo=e(4588);class Eo extends i.Bs{constructor(){super(...arguments),this._urlSync=new wt(this),this.onNewLink=()=>{this.links=[...this.links,xo.q],this.setState({editIndex:this.links.length-1})},this.onDelete=Re=>{this.links=[...this.links.slice(0,Re),...this.links.slice(Re+1)],this.setState({editIndex:void 0})},this.onDuplicate=Re=>{this.links=[...this.links,{...Re}]},this.onOrderChange=(Re,Ye)=>{this.links=vo.moveItemImmutably(this.links,Re,Re+Ye)},this.onEdit=Re=>{this.setState({editIndex:Re})},this.onUpdateLink=Re=>{const Ye=this.state.editIndex;Ye!==void 0&&(this.links=[...this.links.slice(0,Ye),Re,...this.links.slice(Ye+1)])},this.onGoBack=()=>{this.setState({editIndex:void 0})}}static{this.Component=Ys}getUrlKey(){return"links"}get dashboard(){return(0,Fe.YQ)(this)}get links(){return this.dashboard.state.links}set links(Re){this.dashboard.setState({links:Re})}}function Ys({model:ke}){const{editIndex:Re}=ke.useState(),Ye=(0,Fe.YQ)(ke),{links:lt}=Ye.useState(),{navModel:At,pageNav:Nt}=Ta(Ye,ke.getUrlKey()),Wt=Re!==void 0?lt[Re]:void 0,Ht=a.$.featureToggles.singleTopNav;return Wt?(0,m.jsx)(Po,{pageNav:Nt,navModel:At,link:Wt,dashboard:Ye,onChange:ke.onUpdateLink,onGoBack:ke.onGoBack}):(0,m.jsxs)(Oe.YW,{navModel:At,pageNav:Nt,layout:et.k.Standard,toolbar:Ht?(0,m.jsx)(qe.v,{dashboard:Ye}):void 0,children:[!Ht&&(0,m.jsx)(qe.c,{dashboard:Ye}),(0,m.jsx)($a.X,{links:lt,onNew:ke.onNewLink,onEdit:ke.onEdit,onDelete:ke.onDelete,onDuplicate:ke.onDuplicate,onOrderChange:ke.onOrderChange})]})}function Po({pageNav:ke,link:Re,navModel:Ye,dashboard:lt,onChange:At,onGoBack:Nt}){const Wt={text:"Edit link",parentItem:ke},Ht=a.$.featureToggles.singleTopNav;return(0,m.jsxs)(Oe.YW,{navModel:Ye,pageNav:Wt,layout:et.k.Standard,toolbar:Ht?(0,m.jsx)(qe.v,{dashboard:lt}):void 0,children:[!Ht&&(0,m.jsx)(qe.c,{dashboard:lt}),(0,m.jsx)(yo.d,{link:Re,onUpdate:At,onGoBack:Nt})]})}var Do=e(79924),Ja=e(94354),ir=e(57418),Co=e(75590),bo=e(81394),To=e(27966),lr=e(77431),Mo=e(24466);const So=[{label:"Editable",value:!0},{label:"Read-only",value:!1}],Oo=[{value:0,label:"Default"},{value:1,label:"Shared crosshair"},{value:2,label:"Shared Tooltip"}];class Ao extends i.Bs{constructor(){super(...arguments),this.onTitleChange=Re=>{this._dashboard.setState({title:Re})},this.onDescriptionChange=Re=>{this._dashboard.setState({description:Re})},this.onTagsChange=Re=>{this._dashboard.setState({tags:Re})},this.onFolderChange=async(Re,Ye)=>{const lt={...this._dashboard.state.meta,folderUid:Re||this._dashboard.state.meta.folderUid,folderTitle:Ye||this._dashboard.state.meta.folderTitle};lt.folderUid&&await(0,lr.Q)(lt.folderUid),this._dashboard.setState({meta:lt})},this.onEditableChange=Re=>{this._dashboard.setState({editable:Re})},this.onTimeZoneChange=Re=>{this.getTimeRange().setState({timeZone:Re})},this.onWeekStartChange=Re=>{this.getTimeRange().setState({weekStart:Re})},this.onRefreshIntervalChange=Re=>{this.getRefreshPicker()?.setState({intervals:Re})},this.onNowDelayChange=Re=>{this.getTimeRange()?.setState({UNSAFE_nowDelay:Re})},this.onHideTimePickerChange=Re=>{this.getDashboardControls()?.setState({hideTimeControls:Re})},this.onLiveNowChange=Re=>{try{const Ye=this.getLiveNowTimer();Re?Ye.enable():Ye.disable()}catch(Ye){console.error(Ye)}},this.onTooltipChange=Re=>{this.getCursorSync()?.setState({sync:Re})},this.onPreloadChange=Re=>{this._dashboard.setState({preload:Re})},this.onDeleteDashboard=()=>{}}get _dashboard(){return(0,Fe.YQ)(this)}getUrlKey(){return"settings"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}getRefreshPicker(){return this.getDashboardControls().state.refreshPicker}getCursorSync(){return Te.b4.getCursorSync(this._dashboard)}getLiveNowTimer(){const Re=i.jh.findObject(this._dashboard,Ye=>Ye instanceof i.Gg.en);if(Re instanceof i.Gg.en)return Re;throw new Error("LiveNowTimer could not be found")}getDashboardControls(){return this._dashboard.state.controls}static{this.Component=({model:Re})=>{const Ye=Re.getDashboard(),{navModel:lt,pageNav:At}=Ta(Ye,Re.getUrlKey()),{title:Nt,description:Wt,tags:Ht,meta:un,editable:an}=Ye.useState(),{sync:jn}=Re.getCursorSync()?.useState()||{},{timeZone:Xn,weekStart:ds,UNSAFE_nowDelay:$n}=Re.getTimeRange().useState(),{intervals:is}=Re.getRefreshPicker().useState(),{hideTimeControls:gs}=Re.getDashboardControls().useState(),{enabled:ss}=Re.getLiveNowTimer().useState(),us=a.$.featureToggles.singleTopNav;return(0,m.jsxs)(Oe.YW,{navModel:lt,pageNav:At,layout:et.k.Standard,toolbar:us?(0,m.jsx)(qe.v,{dashboard:Ye}):void 0,children:[!us&&(0,m.jsx)(qe.c,{dashboard:Ye}),(0,m.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,m.jsxs)(U.a,{marginBottom:5,children:[(0,m.jsx)(N.D,{label:(0,m.jsxs)(B.B,{justifyContent:"space-between",children:[(0,m.jsx)(W.J,{htmlFor:"title-input",children:(0,m.jsx)(M.x6,{i18nKey:"dashboard-settings.general.title-label",children:"Title"})}),a.$.featureToggles.dashgpt&&(0,m.jsx)(To.Z,{onGenerate:ps=>Re.onTitleChange(ps)})]}),children:(0,m.jsx)(I.p,{id:"title-input",name:"title",value:Nt,onChange:ps=>Re.onTitleChange(ps.target.value)})}),(0,m.jsx)(N.D,{label:(0,m.jsxs)(B.B,{justifyContent:"space-between",children:[(0,m.jsx)(W.J,{htmlFor:"description-input",children:(0,M.t)("dashboard-settings.general.description-label","Description")}),a.$.featureToggles.dashgpt&&(0,m.jsx)(bo.V,{onGenerate:ps=>Re.onDescriptionChange(ps)})]}),children:(0,m.jsx)(K.f,{id:"description-input",name:"description",value:Wt,onChange:ps=>Re.onDescriptionChange(ps.target.value)})}),(0,m.jsx)(N.D,{label:(0,M.t)("dashboard-settings.general.tags-label","Tags"),children:(0,m.jsx)(Do.u,{id:"tags-input",tags:Ht,onChange:Re.onTagsChange,width:40})}),(0,m.jsx)(N.D,{label:(0,M.t)("dashboard-settings.general.folder-label","Folder"),children:(0,m.jsx)(H.d,{value:un.folderUid,onChange:Re.onFolderChange,initialTitle:un.folderTitle,inputId:"dashboard-folder-input",enableCreateNew:!0,skipInitialLoad:!0})}),(0,m.jsx)(N.D,{label:(0,M.t)("dashboard-settings.general.editable-label","Editable"),description:(0,M.t)("dashboard-settings.general.editable-description","Set to read-only to disable all editing. Reload the dashboard for changes to take effect"),children:(0,m.jsx)(Ja.z,{value:an,options:So,onChange:Re.onEditableChange})})]}),(0,m.jsx)(Co.p,{onTimeZoneChange:Re.onTimeZoneChange,onWeekStartChange:Re.onWeekStartChange,onRefreshIntervalChange:Re.onRefreshIntervalChange,onNowDelayChange:Re.onNowDelayChange,onHideTimePickerChange:Re.onHideTimePickerChange,onLiveNowChange:Re.onLiveNowChange,refreshIntervals:is,timePickerHidden:gs,nowDelay:$n||"",liveNow:ss,timezone:Xn||"",weekStart:ds||""}),(0,m.jsxs)(ir.M,{label:(0,M.t)("dashboard-settings.general.panel-options-label","Panel options"),isOpen:!0,children:[(0,m.jsx)(N.D,{label:(0,M.t)("dashboard-settings.general.panel-options-graph-tooltip-label","Graph tooltip"),description:(0,M.t)("dashboard-settings.general.panel-options-graph-tooltip-description","Controls tooltip and hover highlight behavior across different panels. Reload the dashboard for changes to take effect"),children:(0,m.jsx)(Ja.z,{onChange:Re.onTooltipChange,options:Oo,value:jn})}),(0,m.jsx)(N.D,{label:(0,M.t)("dashboard-settings.general.panels-preload-label","Preload panels"),description:(0,M.t)("dashboard-settings.general.panels-preload-description","When enabled all panels will start loading as soon as the dashboard has been loaded."),children:(0,m.jsx)(w.d,{id:"preload-panels-dashboards-toggle",value:Ye.state.preload,onChange:ps=>Re.onPreloadChange(ps.currentTarget.checked)})})]}),(0,m.jsx)(U.a,{marginTop:3,children:un.canDelete&&(0,m.jsx)(Mo.c,{dashboard:Ye})})]})]})}}}class Io extends i.Bs{constructor(Re){super({...Re,jsonText:""}),this.onCodeEditorBlur=Ye=>{this.setState({jsonText:Ye})},this.onSaveSuccess=Ye=>{const lt=JSON.parse(this.state.jsonText),At=this.getDashboard();lt.version=Ye.version;const Nt={dashboard:lt,meta:At.state.meta},Wt=(0,bt.wM)(Nt),Ht=i.Go.cloneSceneObjectState(Wt.state);At.pauseTrackingChanges(),At.setInitialSaveModel(Nt.dashboard),At.setState(Ht),this.setState({jsonText:this.getJsonText()})},this.addActivationHandler(()=>this.setState({jsonText:this.getJsonText()}))}getUrlKey(){return"json-model"}getDashboard(){return(0,Fe.YQ)(this)}getSaveModel(){const Re=this.getDashboard();return(0,Ve.Uy)(Re)}getJsonText(){const Re=this.getSaveModel();return(0,hs.p)(Re)}static{this.Component=({model:Re})=>{const{state:Ye,onSaveDashboard:lt}=le(!1),[At,Nt]=(0,A.useState)(!1),Wt=Re.getDashboard(),{navModel:Ht,pageNav:un}=Ta(Wt,Re.getUrlKey()),an=Wt.useState().meta.canSave,{jsonText:jn}=Re.useState(),Xn=a.$.featureToggles.singleTopNav,ds=async us=>{const ps=await lt(Wt,JSON.parse(Re.state.jsonText),{folderUid:Wt.state.meta.folderUid,overwrite:us});Nt(!0),ps.status==="success"?(Re.onSaveSuccess(ps),Nt(!1)):Nt(!0)},$n=us=>(0,m.jsx)(O.$n,{type:"submit",onClick:()=>{ds(us)},variant:us?"destructive":"primary",children:us?"Save and overwrite":(0,m.jsx)(M.x6,{i18nKey:"dashboard-settings.json-editor.save-button",children:"Save changes"})}),is=(0,m.jsx)(O.$n,{variant:"secondary",onClick:()=>Nt(!1),fill:"outline",children:"Cancel"}),gs=(0,dt.of)(Ro);function ss(us){if(us&&At){if(Q(us))return(0,m.jsxs)(j.F,{title:"Someone else has updated this dashboard",severity:"error",children:[(0,m.jsx)("p",{children:"Would you still like to save this dashboard?"}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsxs)(B.B,{alignItems:"center",children:[is,$n(!0)]})})]});if(Y(us))return(0,m.jsx)(te,{saveButton:$n,cancelButton:is});if(q(us))return(0,m.jsxs)(j.F,{title:"Plugin dashboard",severity:"error",children:[(0,m.jsxs)("p",{children:["Your changes will be lost when you update the plugin. Use ",(0,m.jsx)("strong",{children:"Save As"})," to create custom version."]}),(0,m.jsx)(U.a,{paddingTop:2,children:(0,m.jsx)(B.B,{alignItems:"center",children:$n(!0)})})]})}return(0,m.jsxs)(m.Fragment,{children:[us&&At&&(0,m.jsx)(j.F,{title:"Failed to save dashboard",severity:"error",children:(0,m.jsx)("p",{children:us.message})}),(0,m.jsx)(B.B,{alignItems:"center",children:$n(!1)})]})}return(0,m.jsxs)(Oe.YW,{navModel:Ht,pageNav:un,layout:et.k.Standard,toolbar:Xn?(0,m.jsx)(qe.v,{dashboard:Wt}):void 0,children:[!Xn&&(0,m.jsx)(qe.c,{dashboard:Wt}),(0,m.jsxs)("div",{className:gs.wrapper,children:[(0,m.jsx)(M.x6,{i18nKey:"dashboard-settings.json-editor.subtitle",children:"The JSON model below is the data structure that defines the dashboard. This includes dashboard settings, panel settings, layout, queries, and so on."}),(0,m.jsx)(be.B,{width:"100%",value:jn,language:"json",showLineNumbers:!0,showMiniMap:!0,containerStyles:gs.codeEditor,onBlur:Re.onCodeEditorBlur}),an&&(0,m.jsx)(U.a,{paddingTop:2,children:ss(Ye.error)})]})]})}}}const Ro=ke=>({wrapper:(0,Se.css)({display:"flex",height:"100%",flexDirection:"column",gap:ke.spacing(2)}),codeEditor:(0,Se.css)({flexGrow:1})});var Lo=e(5108);class jo extends i.Bs{static{this.Component=Vs}get _dashboard(){return(0,Fe.YQ)(this)}getUrlKey(){return"permissions"}getDashboard(){return this._dashboard}}function Vs({model:ke}){const Re=ke.getDashboard(),{uid:Ye}=Re.useState(),{navModel:lt,pageNav:At}=Ta(Re,ke.getUrlKey()),Nt=Zn.TP.hasPermission(se.AccessControlAction.DashboardsPermissionsWrite),Wt=a.$.featureToggles.singleTopNav;return(0,m.jsxs)(Oe.YW,{navModel:lt,pageNav:At,layout:et.k.Standard,toolbar:Wt?(0,m.jsx)(qe.v,{dashboard:Re}):void 0,children:[!Wt&&(0,m.jsx)(qe.c,{dashboard:Re}),(0,m.jsx)(Lo.x,{resource:"dashboards",resourceId:Ye??"",canSetPermissions:Nt})]})}var Vr=e(75505),zr=e(79422),Bo=e(71678),cr=e(96374),Uo=e(39558),No=e(8964),Xa=e(58975),ra=e(85140),Hr=e(14329),Wo=e(41820),Fo=e(85830),Ko=e(89458),ya=e(17663);function wo({onChange:ke,type:Re}){const Ye=(0,A.useMemo)(()=>(0,ya.B$)(),[]),lt=(0,A.useMemo)(()=>Ye.find(At=>At.value===Re)??Ye[0],[Ye,Re]);return(0,m.jsx)(Ko.v,{name:"Select variable type",value:lt,options:Ye,onChange:ke,testId:S.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalTypeSelectV2})}function Gr({variable:ke,onTypeChange:Re,onGoBack:Ye,onDelete:lt,onValidateVariableName:At}){const Nt=(0,dt.of)($o),[Wt,Ht]=(0,A.useState)(null),{name:un,type:an,label:jn,description:Xn,hide:ds,key:$n}=ke.useState(),is=(0,ya.bZ)(an)?(0,ya.CD)(an):void 0,[gs,ss]=(0,ee.A)(async()=>{await(0,Vr.s)(ke.validateAndUpdate())},[ke]),us=Ls=>{Ls.value&&Re(Ls.value)},ps=(0,A.useCallback)(Ls=>{const[,Ia]=At(Ls.currentTarget.value,$n);Wt!==Ia&&Ht(Ia)},[$n,Wt,At]),Is=Ls=>{Wt||ke.setState({name:Ls.currentTarget.value})},ns=Ls=>ke.setState({label:Ls.currentTarget.value}),Bs=Ls=>ke.setState({description:Ls.currentTarget.value}),Js=Ls=>ke.setState({hide:Ls}),ws=(0,ya.n_)(ke),Ws=Ls=>()=>{(0,ne.rR)("Delete variable"),lt(un),Ls()};return(0,m.jsxs)("form",{"aria-label":"Variable editor Form",children:[(0,m.jsx)(wo,{onChange:us,type:an}),(0,m.jsx)(Xa.Y,{children:"General"}),(0,m.jsx)(Hr._,{name:"Name",description:"The name of the template variable. (Max. 50 characters)",placeholder:"Variable name",defaultValue:un??"",onChange:ps,onBlur:Is,testId:S.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalNameInputV2,maxLength:Fo.M.MaxSize,required:!0,invalid:!!Wt,error:Wt}),(0,m.jsx)(Hr._,{name:"Label",description:"Optional display name",placeholder:"Label name",defaultValue:jn??"",onBlur:ns,testId:S.Tp.pages.Dashboard.Settings.Variables.Edit.General.generalLabelInputV2}),(0,m.jsx)(ra.Z,{name:"Description",defaultValue:Xn??"",placeholder:"Descriptive text",onBlur:Bs,width:52}),(0,m.jsx)(No.D,{onChange:Js,hide:ds||zr.rw.hide,type:an}),is&&(0,m.jsx)(is,{variable:ke,onRunQuery:ss}),ws&&(0,m.jsx)(Wo.j,{options:ke.getOptionsForSelect()}),(0,m.jsx)("div",{className:Nt.buttonContainer,children:(0,m.jsxs)(B.B,{gap:2,children:[(0,m.jsx)(Bo.$s,{children:({showModal:Ls,hideModal:Ia})=>(0,m.jsx)(O.$n,{variant:"destructive",fill:"outline",onClick:()=>{Ls(cr.u,{title:"Delete variable",body:`Are you sure you want to delete: ${un}?`,confirmText:"Delete variable",onConfirm:Ws(Ia),onDismiss:Ia,isOpen:!0})},children:"Delete"})}),(0,m.jsx)(O.$n,{variant:"secondary","data-testid":S.Tp.pages.Dashboard.Settings.Variables.Edit.General.applyButton,onClick:Ye,children:"Back to list"}),ws&&(0,m.jsx)(O.$n,{disabled:gs.loading,variant:"secondary","data-testid":S.Tp.pages.Dashboard.Settings.Variables.Edit.General.submitButton,onClick:ss,children:gs.loading?(0,m.jsx)(Uo._,{className:Nt.loadingPlaceHolder,text:"Running query..."}):"Run query"})]})})]})}const $o=ke=>({buttonContainer:(0,Se.css)({marginTop:ke.spacing(2)}),loadingPlaceHolder:(0,Se.css)({marginBottom:0})});var Tr=e(91076),Vo=e(2223);function Qr(ke){return ke.map(Re=>({id:Re.state.name,label:`${Re.state.name}`}))}function zo(ke,Re){return ke.filter(Ye=>Re.some(lt=>lt.from===Ye.id||lt.to===Ye.id))}const Ho=ke=>{const Re=[];for(const Ye of ke)for(const lt of ke){if(Ye===lt)continue;Ye.variableDependency?.hasDependencyOn(lt.state.name)&&Re.push({from:Ye.state.name,to:lt.state.name})}return Re},dr=({variables:ke})=>{const Re=(0,A.useMemo)(()=>Qr(ke),[ke]),Ye=(0,A.useMemo)(()=>Ho(ke),[ke]);return Ye.length?(0,m.jsx)(Vo.i,{show:!1,title:(0,M.t)("dashboards.settings.variables.dependencies.title","Dependencies"),nodes:zo(Re,Ye),edges:Ye,children:({showModal:lt})=>(0,m.jsx)(O.$n,{onClick:()=>{(0,ne.rR)("Show variable dependencies"),lt()},icon:"channel-add",variant:"secondary",children:(0,m.jsx)(M.x6,{i18nKey:"dashboards.settings.variables.dependencies.button",children:"Show dependencies"})})}):null};function Va({index:ke,variable:Re,onEdit:Ye,onDuplicate:lt,onDelete:At}){const Nt=(0,dt.$j)(),Wt=(0,dt.of)(Go),Ht=(0,ya.Ao)(Re),un=Re.state,an=un.name,[jn,Xn]=(0,A.useState)(!1),ds=is=>()=>{Xn(is)},$n=()=>{(0,ne.rR)("Delete variable"),At(an)};return(0,m.jsx)(Tr.sx,{draggableId:JSON.stringify(an),index:ke,children:(is,gs)=>(0,m.jsxs)("tr",{ref:is.innerRef,...is.draggableProps,style:{userSelect:gs.isDragging?"none":"auto",background:gs.isDragging?Nt.colors.background.secondary:void 0,...is.draggableProps.style},children:[(0,m.jsx)("td",{role:"gridcell",className:Wt.column,children:(0,m.jsx)(O.$n,{size:"xs",fill:"text",onClick:ss=>{ss.preventDefault(),Ye(an)},className:Wt.nameLink,"data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.tableRowNameFields(un.name),children:un.name})}),(0,m.jsx)("td",{role:"gridcell",className:Wt.definitionColumn,onClick:ss=>{ss.preventDefault(),Ye(an)},"data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.tableRowDefinitionFields(un.name),children:Ht}),(0,m.jsx)("td",{role:"gridcell",className:Wt.column,children:(0,m.jsxs)("div",{className:Wt.icons,children:[(0,m.jsx)(fs.K,{onClick:ss=>{ss.preventDefault(),(0,ne.rR)("Duplicate variable"),lt(an)},name:"copy",tooltip:"Duplicate variable","data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.tableRowDuplicateButtons(un.name)}),(0,m.jsx)(fs.K,{onClick:ss=>{ss.preventDefault(),Xn(!0)},name:"trash-alt",tooltip:"Remove variable","data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.tableRowRemoveButtons(un.name)}),(0,m.jsx)(cr.u,{isOpen:jn,title:"Delete variable",body:`Are you sure you want to delete: ${un.name}?`,confirmText:"Delete variable",onConfirm:$n,onDismiss:ds(!1)}),(0,m.jsx)("div",{...is.dragHandleProps,className:Wt.dragHandle,children:(0,m.jsx)(wn.I,{name:"draggabledots",size:"lg"})})]})})]})})}function Go(ke){return{dragHandle:(0,Se.css)({cursor:"grab",marginLeft:ke.spacing(1)}),column:(0,Se.css)({width:"1%"}),nameLink:(0,Se.css)({cursor:"pointer",color:ke.colors.primary.text}),definitionColumn:(0,Se.css)({width:"100%",maxWidth:"200px",cursor:"pointer",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),iconPassed:(0,Se.css)({color:ke.v1.palette.greenBase,marginRight:ke.spacing(2)}),iconFailed:(0,Se.css)({color:ke.v1.palette.orange,marginRight:ke.spacing(2)}),icons:(0,Se.css)({display:"flex",gap:ke.spacing(2),alignItems:"center"})}}function ur({variables:ke,onChangeOrder:Re,onDelete:Ye,onDuplicate:lt,onAdd:At,onEdit:Nt}){const Wt=(0,dt.of)(kr),Ht=un=>{!un.destination||!un.source||((0,ne.rR)("Variable drag and drop"),Re(un.source.index,un.destination.index))};return(0,m.jsx)("div",{children:(0,m.jsxs)("div",{children:[ke.length===0&&(0,m.jsx)(Qo,{onAdd:At}),ke.length>0&&(0,m.jsxs)(B.B,{direction:"column",gap:3,children:[(0,m.jsx)("div",{className:Wt.tableContainer,children:(0,m.jsxs)("table",{className:"filter-table filter-table--hover","data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.table,role:"grid",children:[(0,m.jsx)("thead",{children:(0,m.jsxs)("tr",{children:[(0,m.jsx)("th",{children:"Variable"}),(0,m.jsx)("th",{children:"Definition"}),(0,m.jsx)("th",{colSpan:5})]})}),(0,m.jsx)(Tr.JY,{onDragEnd:Ht,children:(0,m.jsx)(Tr.gL,{droppableId:"variables-list",direction:"vertical",children:un=>(0,m.jsxs)("tbody",{ref:un.innerRef,...un.droppableProps,children:[ke.map((an,jn)=>{const Xn=an.state;return(0,m.jsx)(Va,{index:jn,variable:an,onDelete:Ye,onDuplicate:lt,onEdit:Nt},`${Xn.name}-${jn}`)}),un.placeholder]})})})]})}),(0,m.jsxs)(B.B,{children:[(0,m.jsx)(dr,{variables:ke}),(0,m.jsx)(O.$n,{"data-testid":S.Tp.pages.Dashboard.Settings.Variables.List.newButton,onClick:At,icon:"plus",children:"New variable"})]})]})]})})}function Qo({onAdd:ke}){return(0,m.jsx)(B.B,{direction:"column",children:(0,m.jsxs)(Kr.p,{variant:"call-to-action",button:(0,m.jsx)(O.$n,{"data-testid":S.Tp.components.CallToActionCard.buttonV2("Add variable"),icon:"calculator-alt",onClick:ke,size:"lg",children:(0,m.jsx)(M.x6,{i18nKey:"variables.empty-state.button-title",children:"Add variable"})}),message:(0,M.t)("variables.empty-state.title","There are no variables added yet"),children:[(0,m.jsx)("p",{children:(0,m.jsx)(M.x6,{i18nKey:"variables.empty-state.info-box-content",children:"Variables enable more interactive and dynamic dashboards. Instead of hard-coding things like server or sensor names in your metric queries you can use variables in their place. Variables are shown as list boxes at the top of the dashboard. These drop-down lists make it easy to change the data being displayed in your dashboard."})}),(0,m.jsxs)(M.x6,{i18nKey:"variables.empty-state.info-box-content-2",children:["Check out the"," ",(0,m.jsx)(wr.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/variables/",children:"Templates and variables documentation"})," ","for more information."]})]})})}const kr=()=>({tableContainer:(0,Se.css)({overflow:"scroll",width:"100%"})});class ko extends i.Bs{constructor(){super(...arguments),this._urlSync=new wt(this),this.getVariableIndex=Re=>this.getVariables().findIndex(lt=>lt.state.name===Re),this.replaceEditVariable=Re=>{const Ye=this.state.editIndex??-1,{variables:lt}=this.getVariableSet().state;if(!lt[Ye]){console.error("Variable not found");return}const Nt=[...lt.slice(0,Ye),Re,...lt.slice(Ye+1)];this.getVariableSet().setState({variables:Nt})},this.onDelete=Re=>{const Ye=this.getVariableIndex(Re),{variables:lt}=this.getVariableSet().state;if(Ye===-1){console.error("Variable not found");return}const At=[...lt.slice(0,Ye),...lt.slice(Ye+1)];this.getVariableSet().setState({variables:At}),this.setState({editIndex:void 0})},this.onDuplicated=Re=>{const Ye=this.getVariableIndex(Re),lt=this.getVariableSet().state.variables;if(Ye===-1){console.error("Variable not found");return}const At=lt[Ye];let Nt=0,Wt=`copy_of_${At.state.name}`;for(;lt.some(an=>an.state.name===Wt);)Nt++,Wt=`copy_of_${At.state.name}_${Nt}`;const Ht=At.clone(At.state);Ht.setState({name:Wt});const un=[...lt.slice(0,Ye+1),Ht,...lt.slice(Ye+1)];this.getVariableSet().setState({variables:un})},this.onOrderChanged=(Re,Ye)=>{const lt=this.getVariableSet().state.variables;if(!this.getVariableSet())return;if(Re<0||Re>=lt.length||Ye<0||Ye>=lt.length){console.error("Invalid index");return}const At=[...lt],Nt=At.splice(Re,1);At.splice(Ye,0,Nt[0]),this.getVariableSet().setState({variables:At})},this.onEdit=Re=>{const Ye=this.getVariableIndex(Re);if(Ye===-1){console.error("Variable not found");return}this.setState({editIndex:Ye})},this.onAdd=()=>{const Re=this.getVariables(),Ye=Re.length,lt=(0,ya.kh)(Re);this.getVariableSet().setState({variables:[...this.getVariables(),lt]}),this.setState({editIndex:Ye})},this.onTypeChange=Re=>{const Ye=this.state.editIndex??-1,{variables:lt}=this.getVariableSet().state,At=lt[Ye];if(!At){console.error("Variable not found");return}const{name:Nt,label:Wt}=At.state,Ht=(0,ya.No)(Re,{name:Nt,label:Wt});this.replaceEditVariable(Ht)},this.onGoBack=()=>{this.setState({editIndex:void 0})},this.onValidateVariableName=(Re,Ye)=>{let lt=null;ya.cH.test(Re)||(lt="Template names cannot begin with '__', that's reserved for Grafana's global variables"),ya.mJ.test(Re)||(lt="Only word characters are allowed in variable names");const At=this.getVariableSet().getByName(Re)?.state;return At&&At.key!==Ye&&(lt="Variable with the same name already exists"),lt?[!0,lt]:[!1,null]}}static{this.Component=hr}getUrlKey(){return"variables"}getDashboard(){return(0,Fe.YQ)(this)}getVariableSet(){return i.jh.getVariables(this.getDashboard())}getVariables(){return this.getVariableSet().state.variables}}function hr({model:ke}){const Re=ke.getDashboard(),{navModel:Ye,pageNav:lt}=Ta(Re,ke.getUrlKey()),{onDelete:At,onDuplicated:Nt,onOrderChanged:Wt,onEdit:Ht,onTypeChange:un,onGoBack:an,onAdd:jn}=ke,{variables:Xn}=ke.getVariableSet().useState(),{editIndex:ds}=ke.useState(),$n=a.$.featureToggles.singleTopNav;if(ds!==void 0&&Xn[ds]){const is=Xn[ds];if(is)return(0,m.jsx)(Mr,{variable:is,onTypeChange:un,onGoBack:an,pageNav:lt,navModel:Ye,dashboard:Re,onDelete:At,onValidateVariableName:ke.onValidateVariableName})}return(0,m.jsxs)(Oe.YW,{navModel:Ye,pageNav:lt,layout:et.k.Standard,toolbar:$n?(0,m.jsx)(qe.v,{dashboard:Re}):void 0,children:[!$n&&(0,m.jsx)(qe.c,{dashboard:Re}),(0,m.jsx)(ur,{variables:Xn,onDelete:At,onDuplicate:Nt,onChangeOrder:Wt,onAdd:jn,onEdit:Ht})]})}function Mr({variable:ke,pageNav:Re,navModel:Ye,dashboard:lt,onTypeChange:At,onGoBack:Nt,onDelete:Wt,onValidateVariableName:Ht}){const{name:un}=ke.useState(),an=a.$.featureToggles.singleTopNav,jn={text:un,parentItem:Re};return(0,m.jsxs)(Oe.YW,{navModel:Ye,pageNav:jn,layout:et.k.Standard,toolbar:an?(0,m.jsx)(qe.v,{dashboard:lt}):void 0,children:[!an&&(0,m.jsx)(qe.c,{dashboard:lt}),(0,m.jsx)(Gr,{variable:ke,onTypeChange:At,onGoBack:Nt,onDelete:Wt,onValidateVariableName:Ht},ke.state.key)]})}const _o=10;class Yo extends i.Bs{constructor(Re){super({...Re,versions:[],isLoading:!0,isAppending:!0,viewMode:"list",isNewLatest:!1,diffData:{lhs:"",rhs:""}}),this._limit=_o,this._start=0,this.fetchVersions=(Ye=!1)=>{const lt=this._dashboard.state.uid;lt&&(this.setState({isAppending:Ye}),Tt.wL.getHistoryList(lt,{limit:this._limit,start:this._start}).then(At=>{this.setState({isLoading:!1,versions:[...this.state.versions??[],...this.decorateVersions(At)]}),this._start+=this._limit}).catch(At=>console.log(At)).finally(()=>this.setState({isAppending:!1})))},this.getDiff=async()=>{const Ye=this.versions.filter(un=>un.checked),[lt,At]=Ye,Nt=lt.version===this._dashboard.state.version;if(this.setState({isLoading:!0}),!this._dashboard.state.uid)return;const Wt=await Tt.wL.getDashboardVersion(this._dashboard.state.uid,At.version),Ht=await Tt.wL.getDashboardVersion(this._dashboard.state.uid,lt.version);this.setState({baseInfo:At,isLoading:!1,isNewLatest:Nt,newInfo:lt,viewMode:"compare",diffData:{lhs:Wt.data,rhs:Ht.data}})},this.reset=()=>{this.setState({baseInfo:void 0,diffData:{lhs:"",rhs:""},isNewLatest:!1,newInfo:void 0,versions:this.versions.map(Ye=>({...Ye,checked:!1})),viewMode:"list"})},this.onCheck=(Ye,lt)=>{this.setState({versions:this.versions.map(At=>At.id===lt?{...At,checked:Ye.currentTarget.checked}:At)})},this.addActivationHandler(()=>{this.fetchVersions()})}static{this.Component=Jo}get _dashboard(){return(0,Fe.YQ)(this)}get diffData(){return this.state.diffData??{lhs:"",rhs:""}}get versions(){return this.state.versions??[]}get limit(){return this._limit}get start(){return this._start}getUrlKey(){return"versions"}getDashboard(){return this._dashboard}getTimeRange(){return i.jh.getTimeRange(this._dashboard)}decorateVersions(Re){const Ye=this.getTimeRange().getTimeZone();return Re.map(lt=>({...lt,createdDateString:(0,Ee.LE)(lt.created,{timeZone:Ye}),ageString:(0,Ee.fq)(lt.created,{timeZone:Ye}),checked:!1}))}}function Jo({model:ke}){const Re=ke.getDashboard(),{isLoading:Ye,isAppending:lt,viewMode:At,baseInfo:Nt,newInfo:Wt,isNewLatest:Ht}=ke.useState(),{navModel:un,pageNav:an}=Ta(Re,ke.getUrlKey()),jn=ke.versions.filter(us=>us.checked).length===2,Xn=ke.versions.length>1,ds=ke.versions.length>=ke.limit,$n=ke.versions.find(us=>us.version===1),is=a.$.featureToggles.singleTopNav,gs=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Tt.me,{onClick:ke.reset,baseVersion:Nt?.version,newVersion:Wt?.version,isNewLatest:Ht}),Ye?(0,m.jsx)(Sr,{msg:"Fetching changes\u2026"}):(0,m.jsx)(Tt.Cc,{newInfo:Wt,baseInfo:Nt,isNewLatest:Ht,diffData:ke.diffData,onRestore:Re.onRestore})]}),ss=(0,m.jsxs)(m.Fragment,{children:[Ye?(0,m.jsx)(Sr,{msg:"Fetching history list\u2026"}):(0,m.jsx)(Tt.bS,{versions:ke.versions,onCheck:ke.onCheck,canCompare:jn,onRestore:Re.onRestore}),lt&&(0,m.jsx)(Sr,{msg:"Fetching more entries\u2026"}),Xn&&(0,m.jsx)(Tt.rJ,{hasMore:ds,canCompare:jn,getVersions:ke.fetchVersions,getDiff:ke.getDiff,isLastPage:!!$n})]});return(0,m.jsxs)(Oe.YW,{navModel:un,pageNav:an,layout:et.k.Standard,toolbar:is?(0,m.jsx)(qe.v,{dashboard:Re}):void 0,children:[!is&&(0,m.jsx)(qe.c,{dashboard:Re}),At==="compare"?gs:ss]})}const Sr=({msg:ke})=>(0,m.jsxs)(B.B,{children:[(0,m.jsx)(Jn.y,{}),(0,m.jsx)("em",{children:ke})]});function Ta(ke,Re){const Ye=(0,_e.zy)(),lt=(0,se.useSelector)(Ht=>Ht.navIndex),At=(0,o.tc)(lt,"dashboards/browse"),Nt=ke.getPageNav(Ye,lt),Wt={text:"Settings",url:t.I.getUrlForPartial(Ye,{editview:"settings",editIndex:null}),children:[],parentItem:Nt};return ke.state.meta.canEdit&&(Wt.children.push({text:(0,M.t)("dashboard-settings.general.title","General"),url:t.I.getUrlForPartial(Ye,{editview:"settings",editIndex:null}),active:Re==="settings"}),Wt.children.push({text:(0,M.t)("dashboard-settings.annotations.title","Annotations"),url:t.I.getUrlForPartial(Ye,{editview:"annotations",editIndex:null}),active:Re==="annotations"}),Wt.children.push({text:(0,M.t)("dashboard-settings.variables.title","Variables"),url:t.I.getUrlForPartial(Ye,{editview:"variables",editIndex:null}),active:Re==="variables"}),Wt.children.push({text:(0,M.t)("dashboard-settings.links.title","Links"),url:t.I.getUrlForPartial(Ye,{editview:"links",editIndex:null}),active:Re==="links"})),ke.state.id&&ke.state.meta.canSave&&Wt.children.push({text:(0,M.t)("dashboard-settings.versions.title","Versions"),url:t.I.getUrlForPartial(Ye,{editview:"versions",editIndex:null}),active:Re==="versions"}),ke.state.id&&ke.state.meta.canAdmin&&Zn.TP.hasPermission(se.AccessControlAction.DashboardsPermissionsRead)&&Wt.children.push({text:(0,M.t)("dashboard-settings.permissions.title","Permissions"),url:t.I.getUrlForPartial(Ye,{editview:"permissions",editIndex:null}),active:Re==="permissions"}),Wt.children.push({text:(0,M.t)("dashboard-settings.json-editor.title","JSON Model"),url:t.I.getUrlForPartial(Ye,{editview:"json-model",editIndex:null}),active:Re==="json-model"}),{navModel:At,pageNav:Wt}}function za(ke){switch(ke){case"annotations":return new go({});case"variables":return new ko({});case"links":return new Eo({});case"versions":return new Yo({});case"json-model":return new Io({});case"permissions":return new jo({});case"settings":default:return new Ao({})}}var ts=e(97246),Za=e(11675);class _r extends i.Bs{constructor(Re){super(Re),this.addActivationHandler(this._activationHandler.bind(this))}_activationHandler(){const Re=this.state.panelRef.resolve();return(0,Fe.M6)(Re)}getUrlKey(){return this.state.panelRef.resolve().state.key}static{this.Component=({model:Re})=>{const{panelRef:Ye}=Re.useState(),lt=Ye.resolve();return(0,m.jsx)(lt.Component,{model:lt})}}}var Yr=e(30195);class Or{constructor(Re){this._scene=Re}getKeys(){return["inspect","viewPanel","editPanel","editview","autofitpanels","kiosk","shareView"]}getUrlState(){const Re=this._scene.state;return{inspect:Re.inspectPanelKey,autofitpanels:this.getAutoFitPanels(),viewPanel:Re.viewPanelScene?.getUrlKey(),editview:Re.editview?.getUrlKey(),editPanel:Re.editPanel?.getUrlKey()||void 0,kiosk:Re.kioskMode===se.KioskMode.Full?"":Re.kioskMode===se.KioskMode.TV?"tv":void 0,shareView:Re.shareView,orgId:Zn.TP.user.orgId.toString()}}getAutoFitPanels(){if(this._scene.state.body instanceof Ot.D)return this._scene.state.body.state.grid.state.UNSAFE_fitPanels?"true":void 0}updateFromUrl(Re){const{inspectPanelKey:Ye,viewPanelScene:lt,isEditing:At,editPanel:Nt,shareView:Wt}=this._scene.state,Ht={};if(typeof Re.editview=="string"&&this._scene.canEditDashboard()?(Ht.editview=za(Re.editview),At||(this._scene.state.editable?setTimeout(()=>this._scene.onEnterEditMode()):Ht.editview=void 0)):Re.hasOwnProperty("editview")&&(Ht.editview=void 0),typeof Re.inspect=="string"){let an=(0,Fe.vL)(this._scene,Re.inspect);if(!an){l.A.emit(n.r1.alertError,["Panel not found"]),s.Ny.partial({inspect:null});return}Ht.inspectPanelKey=Re.inspect,Ht.overlay=new Dr({panelRef:an.getRef()})}else Ye&&(Ht.inspectPanelKey=void 0,Ht.overlay=void 0);if(typeof Re.viewPanel=="string"){const an=(0,Fe.vL)(this._scene,Re.viewPanel);if(!an){if((0,Fe.SN)(Re.viewPanel)){this._handleViewRepeatClone(Re.viewPanel);return}l.A.emit(n.r1.alertError,["Panel not found"]),s.Ny.partial({viewPanel:null});return}Ht.viewPanelScene=new _r({panelRef:an.getRef()})}else lt&&Re.viewPanel===null&&(Ht.viewPanelScene=void 0);if(typeof Re.editPanel=="string"){const an=(0,Fe.vL)(this._scene,Re.editPanel);if(!an){console.warn(`Panel ${Re.editPanel} not found`);return}this._scene.state.viewPanelScene&&this._scene.setState({viewPanelScene:void 0}),At||this._scene.onEnterEditMode();const jn=(0,Fe.iL)(an);if(jn&&!jn?.state.isLoaded){this._waitForLibPanelToLoadBeforeEnteringPanelEdit(an,jn);return}Ht.editPanel=(0,Fa.L)(an)}else Nt&&Re.editPanel===null&&(Ht.editPanel=void 0);typeof Re.shareView=="string"?(Ht.shareView=Re.shareView,Ht.overlay=a.$.featureToggles.newDashboardSharingComponent?new ts.j({shareView:Re.shareView}):new Za.Z({activeTab:Re.shareView})):Wt&&Re.shareView===null&&(Ht.overlay=void 0,Ht.shareView=void 0);const un=this._scene.state.body;if(un instanceof Ot.D){const an=typeof Re.autofitpanels=="string";!!un.state.grid.state.UNSAFE_fitPanels!==an&&un.state.grid.setState({UNSAFE_fitPanels:an})}typeof Re.kiosk=="string"&&(Re.kiosk==="true"||Re.kiosk===""?Ht.kioskMode=se.KioskMode.Full:Re.kiosk==="tv"&&(Ht.kioskMode=se.KioskMode.TV)),Object.keys(Ht).length>0&&this._scene.setState(Ht)}_handleViewRepeatClone(Re){this._eventSub||(this._eventSub=this._scene.subscribeToEvent(Yr.d,()=>{const Ye=(0,Fe.vL)(this._scene,Re);Ye&&(this._eventSub?.unsubscribe(),this._scene.setState({viewPanelScene:new _r({panelRef:Ye.getRef()})}))}))}_waitForLibPanelToLoadBeforeEnteringPanelEdit(Re,Ye){const lt=Ye.subscribeToState(At=>{At.isLoaded&&(this._scene.setState({editPanel:(0,Fa.L)(Re)}),lt.unsubscribe())})}}var qa=e(79284),Ma=e(20485),Jr=e(69129),Ar=e(4898);class Xo{constructor(){this._binds=[]}addBinding(Re){Ar.R.bind(Re.key,Ye=>{Ye.preventDefault(),Ye.stopPropagation(),Ye.returnValue=!1,Re.onTrigger()},"keydown"),this._binds.push(Re)}removeAll(){this._binds.forEach(Re=>{Ar.R.unbind(Re.key,Re.type)}),this._binds=[]}}var Ir=e(22699),Rr=e(7196);function Zo(ke){const Re=new Xo;let Ye=null;const lt=ke.canEditDashboard(),At=l.A.subscribe(Jr.Tp,Wt=>{typeof Wt.payload.panelId=="string"&&(Ye=Wt.payload.panelId)});function Nt(Wt,Ht){return()=>{const un=i.jh.findObject(Wt,an=>an.state.key===Ye);if(un&&un instanceof i.Eb){Ht(un);return}}}return Re.addBinding({key:"v",onTrigger:Nt(ke,Wt=>{if(!ke.state.viewPanelScene){const Ht=t.I.stripBaseFromUrl((0,Qe.r7)(Wt));s.Ny.push(Ht)}})}),a.$.featureToggles.newDashboardSharingComponent?(Re.addBinding({key:"p u",onTrigger:Nt(ke,async Wt=>{const Ht=new ts.j({shareView:Ir.wr.link,panelRef:Wt.getRef()});ke.showModal(Ht)})}),Re.addBinding({key:"p e",onTrigger:Nt(ke,async Wt=>{const Ht=new ts.j({shareView:Ir.wr.embed,panelRef:Wt.getRef()});ke.showModal(Ht)})}),Pt.TP.isSignedIn&&a.$.snapshotEnabled&&ke.canEditDashboard()&&Re.addBinding({key:"p s",onTrigger:Nt(ke,async Wt=>{const Ht=new ts.j({shareView:Ir.wr.snapshot,panelRef:Wt.getRef()});ke.showModal(Ht)})})):Re.addBinding({key:"p s",onTrigger:Nt(ke,async Wt=>{ke.showModal(new Za.Z({panelRef:Wt.getRef()}))})}),Re.addBinding({key:"i",onTrigger:Nt(ke,async Wt=>{s.Ny.push((0,Qe.Uu)(Wt))})}),Re.addBinding({key:"p x",onTrigger:Nt(ke,async Wt=>{const Ht=await(0,Qe.Lp)(Wt);Ht&&s.Ny.push(Ht)})}),Re.addBinding({key:"p l",onTrigger:Nt(ke,Rr.vR)}),Re.addBinding({key:"d r",onTrigger:()=>i.jh.getTimeRange(ke).onRefresh()}),Re.addBinding({key:"t z",onTrigger:()=>{Xr(ke)}}),Re.addBinding({key:"ctrl+z",onTrigger:()=>{Xr(ke)}}),Re.addBinding({key:"t a",onTrigger:()=>{Te.b4.getTimePicker(ke)?.toAbsolute()}}),Re.addBinding({key:"t left",onTrigger:()=>{Zr(ke,"left")}}),Re.addBinding({key:"t right",onTrigger:()=>{Zr(ke,"right")}}),lt&&(Re.addBinding({key:"e",onTrigger:Nt(ke,async Wt=>{if(Wt.getRoot()instanceof fr){const un=(0,Fe.Cs)(Wt);if(!ke.state.editPanel){const an=t.I.stripBaseFromUrl((0,Qe.e0)(un));s.Ny.push(an)}}})}),Re.addBinding({key:"d s",onTrigger:ke.onOpenSettings}),Re.addBinding({key:"mod+s",onTrigger:()=>ke.openSaveDrawer({})}),Re.addBinding({key:"p r",onTrigger:Nt(ke,Wt=>{ke.state.isEditing&&(0,Rr.MI)(ke,Wt)})}),Re.addBinding({key:"p d",onTrigger:Nt(ke,Wt=>{ke.state.isEditing&&ke.duplicatePanel(Wt)})}),Re.addBinding({key:"d shift+c",onTrigger:()=>{ke.state.body instanceof Ot.D&&ke.state.body.collapseAllRows()}}),Re.addBinding({key:"d shift+e",onTrigger:()=>{ke.state.body instanceof Ot.D&&ke.state.body.expandAllRows()}})),()=>{Re.removeAll(),At.unsubscribe()}}function Xr(ke){Te.b4.getTimePicker(ke)?.onZoom()}function Zr(ke,Re){const Ye=Te.b4.getTimePicker(ke);Ye&&(Re==="left"&&Ye.onMoveBackward(),Re==="right"&&Ye.onMoveForward())}const qo=["title","description","tags","editable","graphTooltip","links","meta","preload"],Lr="systemPanelFilterVar",ca="systemDynamicRowSizeVar";class fr extends i.Bs{constructor(Re){super({title:"Dashboard",meta:{},editable:!0,$timeRange:Re.$timeRange??new i.JZ({}),body:Re.body??Ot.D.fromVizPanels(),links:Re.links??[],...Re}),this._urlSync=new Or(this),this._variableDependency=new xa(this),this._fromExplore=!1,this.onEnterEditMode=(Ye=!1)=>{this._fromExplore=Ye,this._initialState=i.Go.cloneSceneObjectState(this.state),this._initialUrlState=s.Ny.getLocation(),this.setState({isEditing:!0}),this.state.body.editModeChanged(!0),this._scopesFacade?.enterReadOnly(),this._changeTracker.startTrackingChanges()},this.onRestore=async Ye=>{const lt=await Tt.wL.restoreDashboard(Ye.uid,Ye.version);if(!Number.isInteger(lt.version))return!1;const At={dashboard:new p.G(Ye.data),meta:this.state.meta},Nt=(0,bt.wM)(At),Wt=i.Go.cloneSceneObjectState(Nt.state);return Wt.version=lt.version,this.setState(Wt),this.exitEditMode({skipConfirm:!0,restoreInitialState:!1}),!0},this.onOpenSettings=()=>{s.Ny.partial({editview:"settings"})},this.onSetScrollRef=Ye=>{this._scrollRef=Ye},this._scopesFacade=(0,y.DF)(this),this._changeTracker=new P.l(this),this.addActivationHandler(()=>this._activationHandler())}static{this.Component=es}_activationHandler(){let Re=window.__grafanaSceneContext;window.__grafanaSceneContext=this,this._initializePanelSearch(),this.state.isEditing&&(this._initialUrlState=s.Ny.getLocation(),this._changeTracker.startTrackingChanges()),this.state.meta.isNew&&(this.onEnterEditMode(),this.setState({isDirty:!0})),!this.state.meta.isEmbedded&&this.state.uid&&h.t.watch(this.state.uid);let Ye=()=>{};a.$.publicDashboardAccessToken||(Ye=Zo(this));const lt=new Ue(this);return(0,c.UA)().setCurrent(lt),()=>{window.__grafanaSceneContext=Re,Ye(),this._changeTracker.terminate(),lt.destroy(),h.t.leave()}}_initializePanelSearch(){const Re=i.jh.lookupVariable(Lr,this)?.getValue();typeof Re=="string"&&this.setState({panelSearch:Re});const Ye=i.jh.lookupVariable(ca,this)?.getValue();if(typeof Ye=="string"){const lt=Number.parseInt(Ye,10);this.setState({panelsPerRow:Number.isInteger(lt)?lt:void 0})}}saveCompleted(Re,Ye,lt){this._initialSaveModel={...Re,id:Ye.id,uid:Ye.uid,version:Ye.version},this._changeTracker.stopTrackingChanges(),this.setState({version:Ye.version,isDirty:!1,uid:Ye.uid,id:Ye.id,meta:{...this.state.meta,uid:Ye.uid,url:Ye.url,slug:Ye.slug,folderUid:lt,isNew:!1}}),this.state.editPanel?.dashboardSaved(),this._changeTracker.startTrackingChanges()}exitEditMode({skipConfirm:Re,restoreInitialState:Ye}){if(!this.canDiscard()){console.error("Trying to discard back to a state that does not exist, initialState undefined");return}if(!this.state.isDirty||Re){this.exitEditModeConfirmed(Ye||this.state.isDirty),this._scopesFacade?.exitReadOnly();return}l.A.publish(new v.bY({title:"Discard changes to dashboard?",text:"You have unsaved changes to this dashboard. Are you sure you want to discard them?",icon:"trash-alt",yesText:"Discard",onConfirm:()=>{this.exitEditModeConfirmed(),this._scopesFacade?.exitReadOnly()}}))}exitEditModeConfirmed(Re=!0){this._changeTracker.stopTrackingChanges();const Ye=t.I.getUrlForPartial(this._initialUrlState,{editPanel:null,editview:null,inspect:null,inspectTab:null,shareView:null});s.Ny.replace(t.I.stripBaseFromUrl(Ye)),this._fromExplore&&this.cleanupStateFromExplore(),Re?this.setState({...this._initialState,isEditing:!1}):this.setState({isEditing:!1}),this.state.editPanel&&this.state.editPanel.onDiscard(),this.state.body.editModeChanged(!1)}cleanupStateFromExplore(){this._fromExplore=!1,this._initialSaveModel?.panels&&(this._initialSaveModel.panels=this._initialSaveModel.panels.slice(1)),this._initialState&&this._initialState.body.cleanUpStateFromExplore?.()}canDiscard(){return this._initialState!==void 0}pauseTrackingChanges(){this._changeTracker.stopTrackingChanges()}resumeTrackingChanges(){this._changeTracker.startTrackingChanges()}openSaveDrawer({saveAsCopy:Re,onSaveSuccess:Ye}){this.state.isEditing&&this.setState({overlay:new pt({dashboardRef:this.getRef(),saveAsCopy:Re,onSaveSuccess:Ye})})}getPageNav(Re,Ye){const{meta:lt,viewPanelScene:At,editPanel:Nt}=this.state;if(lt.dashboardNotFound)return{text:"Not found"};let Wt={text:this.state.title,url:(0,Qe.uZ)({uid:this.state.uid,slug:lt.slug,currentQueryParams:Re.search,updateQuery:{viewPanel:null,inspect:null,editview:null,editPanel:null,tab:null,shareView:null},isHomeDashboard:!lt.url&&!lt.slug&&!lt.isNew})};const{folderUid:Ht}=lt;if(Ht){const un=(0,o.tc)(Ye,`folder-dashboards-${Ht}`).main;un.id!=="not-found"&&(Wt={...Wt,parentItem:un})}return At&&(Wt={text:"View panel",parentItem:Wt,url:(0,Qe.r7)(At.state.panelRef.resolve())}),Nt&&(Wt={text:"Edit panel",parentItem:Wt}),Wt}getBodyToRender(){return this.state.viewPanelScene??this.state.body}getInitialState(){return this._initialState}addPanel(Re){this.state.isEditing||this.onEnterEditMode(),this.state.body.addPanel(Re)}createLibraryPanel(Re,Ye){const lt=Re.clone({$behaviors:[new ot.u({uid:Ye.uid,name:Ye.name})]}),At=Re.parent;if(!(At instanceof Xe.U))throw new Error("Trying to replace a panel that doesn't have a parent grid item");At.setState({body:lt})}duplicatePanel(Re){this.state.body.duplicatePanel(Re)}copyPanel(Re){if(!Re.parent)return;let Ye=Re.parent;if(!(Ye instanceof Xe.U))throw console.error("Trying to copy a panel that is not DashboardGridItem child"),new Error("Trying to copy a panel that is not DashboardGridItem child");const lt=(0,Ve.ZB)(Ye);u.A.set(d.tH,JSON.stringify(lt)),l.A.emit(n.r1.alertSuccess,["Panel copied. Use **Paste panel** toolbar action to paste."])}pastePanel(){const Re=u.A.get(d.tH),Ye=JSON.parse(Re),lt=new p.a(Ye),At=(0,bt.tt)(lt),Nt=Te.b4.getNextPanelId(this),Wt=At.state.body;Wt.setState({key:(0,Fe.XA)(Nt)}),Wt.clearParent(),this.state.body.addPanel(Wt),u.A.delete(d.tH)}removePanel(Re){this.state.body.removePanel(Re)}unlinkLibraryPanel(Re){if(!Re.parent)return;const Ye=Re.parent;if(!(Ye instanceof Xe.U)){console.error("Trying to unlink a lib panel in a layout that is not DashboardGridItem");return}Ye.state.body.setState({$behaviors:void 0})}showModal(Re){this.setState({overlay:Re})}closeModal(){this.setState({overlay:void 0})}async onStarDashboard(){const{meta:Re,uid:Ye}=this.state;if(Ye)try{const lt=await(0,c.UA)().starDashboard(Ye,!!Re.isStarred);this.setState({meta:{...Re,isStarred:lt}})}catch(lt){console.error("Failed to star dashboard",lt)}}onShowAddLibraryPanelDrawer(Re){this.setState({overlay:new ft({panelToReplaceRef:Re})})}onCreateNewRow(){this.state.body.addNewRow()}onCreateNewPanel(){const Re=(0,Fe.O8)(this);return this.addPanel(Re),Re}enrichDataRequest(Re){const Ye=(0,Fe.YQ)(Re);let lt=(0,Fe.xz)(Re);Ye.state.isEditing&&Ye.state.editPanel&&(lt=Ye.state.editPanel.state.panelRef.resolve());let At=0;return lt&&lt.state.key&&((0,Fe.SN)(lt.state.key)?At=Ge(lt?.state.key):At=(0,Fe.Cs)(lt)),{app:r.Jk.Dashboard,dashboardUID:this.state.uid,panelId:At,panelPluginId:lt?.state.pluginId,scopes:this._scopesFacade?.value}}enrichFiltersRequest(){return{scopes:this._scopesFacade?.value}}canEditDashboard(){const{meta:Re}=this.state;return!!(Re.canEdit||Re.canMakeEditable)}getInitialSaveModel(){return this._initialSaveModel}setInitialSaveModel(Re){this._initialSaveModel=Re}async onDashboardDelete(){this.setState({isDirty:!1}),s.Ny.replace("/")}getDashboardPanels(){return Te.b4.getVizPanels(this)}hasDashboardAngularPlugins(){const Re=this.state.body;return Re instanceof Ot.D?Re.state.grid.state.children.some(At=>{if(!(At instanceof Xe.U))return!1;const Nt=(0,Ma.Wu)(At.state.body),Wt=(0,Ma.Tr)(At.state.body);return Nt||Wt}):!1}rememberScrollPos(){this._prevScrollPos=this._scrollRef?.scrollTop}restoreScrollPos(){this._prevScrollPos!==void 0&&this._scrollRef?.scrollTo(0,this._prevScrollPos)}}class xa{constructor(Re){this._dashboard=Re,this._emptySet=new Set}getNames(){return this._emptySet}hasDependencyOn(){return!1}variableUpdateCompleted(Re,Ye){if(Ye&&(l.A.publish(new f.og({refreshAll:!0,panelIds:[]})),this._dashboard.publishEvent(new g._)),Re.state.name===Lr){const At=Re.getValue();typeof At=="string"&&this._dashboard.setState({panelSearch:At})}else if(Re.state.name===ca){const At=Re.getValue();if(typeof At=="string"){const Nt=Number.parseInt(At,10);this._dashboard.setState({panelsPerRow:Number.isInteger(Nt)?Nt:void 0})}}const lt=this._dashboard.state.body;if(lt instanceof Ot.D){for(const At of lt.state.grid.state.children)if(!(!(At instanceof i.tI)||!At.state.$behaviors))for(const Nt of At.state.$behaviors)Nt instanceof qa.L&&(Nt.isWaitingForVariables||Nt.state.variableName===Re.state.name&&Ye?Nt.performRepeat(!0):!Nt.isWaitingForVariables&&Nt.state.variableName===Re.state.name&&Nt.notifyRepeatedPanelsWaitingForVariables(Re))}}}},68435:(_,L,e)=>{"use strict";e.d(L,{u:()=>u});var t=e(74848),n=e(65158),r=e(81887),s=e(67061),a=e(8484),g=e(34214),i=e(57767),l=e(96556),d=e(41507),o=e(7928);class u extends r.Bs{static{this.LOADING_VIZ_PANEL_PLUGIN_ID="library-panel-loading-plugin"}constructor(y){super(y),this.addActivationHandler(()=>this._activationHandler())}_activationHandler(){this.state.isLoaded||this.loadLibraryPanelFromPanelModel()}setPanelFromLibPanel(y){if(this.state._loadedPanel?.version===y.version)return;const f=this.parent;if(!(f instanceof r.Eb))return;const v=new g.a(y.model),P={title:v.title,options:v.options??{},fieldConfig:v.fieldConfig,pluginId:v.type,pluginVersion:v.pluginVersion,displayMode:v.transparent?"transparent":void 0,description:v.description,$data:(0,l.w)(v)};(v.timeFrom||v.timeShift)&&(P.$timeRange=new o.v({timeFrom:v.timeFrom,timeShift:v.timeShift,hideTimeOverride:v.hideTimeOverride})),f.setState(P),f.changePluginType(v.type,P.options,P.fieldConfig),this.setState({_loadedPanel:y,isLoaded:!0,name:y.name,title:v.title});const m=f.parent;v.repeat&&m instanceof d.U&&(m.setState({variableName:v.repeat,repeatDirection:v.repeatDirection==="h"?"h":"v",maxPerRow:v.maxPerRow,itemHeight:m.state.height??10}),m.performRepeat())}unlink(){const y=this.parent;y instanceof r.Eb&&y.setState({$behaviors:y.state.$behaviors?.filter(f=>f!==this)})}async loadLibraryPanelFromPanelModel(){let y=this.parent;if(y instanceof r.Eb)try{const f=await(0,i.Yr)(this.state.uid,!0);this.setPanelFromLibPanel(f)}catch{y.setState({_pluginLoadError:`Unable to load library panel: ${this.state.uid}`})}}}const c=new n.m(p);function p(h){return(0,t.jsx)(s.B,{direction:"column",justifyContent:"space-between",children:(0,t.jsx)(a.x6,{i18nKey:"library-panels.loading-panel-text",children:"Loading library panel"})})}r.Go.registerRuntimePanelPlugin({pluginId:u.LOADING_VIZ_PANEL_PLUGIN_ID,plugin:c})},61086:(_,L,e)=>{"use strict";e.d(L,{c:()=>le,v:()=>he});var t=e(74848),n=e(96540),r=e(32196),s=e(68941),a=e(13544),g=e(32264),i=e(39601),l=e(40845),d=e(27746),o=e(14578),u=e(39938),c=e(83122),p=e(38138),h=e(55852),y=e(19727),f=e(67061),v=e(15068),P=e(75269),m=e(10804),D=e(15054),x=e(10096),E=e(8484),C=e(14792),b=e(2609),T=e(53001),A=e(22699),R=e(34865),S=e(7758);const O=a.Tp.pages.Dashboard.DashNav.NewExportButton.Menu,j=[];function B(pe){j.push(pe)}function N({dashboard:pe}){const Pe=Se=>{i.Ny.partial({shareView:Se})},Ie=(0,n.useCallback)(()=>{const Se=[];return j.forEach(De=>Se.push(De)),Se.push({shareId:A.wr.export,testId:O.exportAsJson,icon:"arrow",label:(0,E.t)("share-dashboard.menu.export-json-title","Export as JSON"),renderCondition:!0,onClick:()=>Pe(A.wr.export)}),Se.filter(De=>De.renderCondition)},[]),ge=Se=>{S.c.sharingCategoryClicked({item:Se.shareId,shareResource:(0,A.hD)()}),Se.onClick(pe)};return(0,t.jsx)(p.W,{"data-testid":O.container,children:Ie().map(Se=>(0,t.jsx)(p.W.Item,{testId:Se.testId,label:Se.label,icon:Se.icon,description:Se.description,onClick:()=>ge(Se)},Se.label))})}const I=a.Tp.pages.Dashboard.DashNav.NewExportButton;function K({dashboard:pe}){const[Pe,Ie]=(0,n.useState)(!1),ge=(0,n.useCallback)(De=>{Ie(De)},[]),Se=()=>(0,t.jsx)(N,{dashboard:pe});return(0,t.jsx)(y.e,{"data-testid":I.container,children:(0,t.jsx)(c.m,{overlay:Se,placement:"bottom-end",onVisibleChange:ge,children:(0,t.jsxs)(h.$n,{"data-testid":I.arrowMenu,size:"sm",variant:"secondary",fill:"solid",tooltip:(0,E.t)("export.menu.export-as-json-tooltip","Export"),children:[(0,t.jsx)(E.x6,{i18nKey:"export.menu.export-as-json-label",children:"Export"}),"\xA0",(0,t.jsx)(o.I,{name:Pe?"angle-up":"angle-down",size:"sm"})]})})})}var w=e(41053),U=e(72254);const W=a.Tp.pages.Dashboard.DashNav.newShareButton.menu;let H=[];function z(pe){H.push(pe)}function G(){H=[]}function M({dashboard:pe,panel:Pe}){const Ie=De=>{i.Ny.partial({shareView:De})},ge=(0,n.useCallback)(()=>{const De=[];return De.push({shareId:A.wr.link,testId:W.shareInternally,icon:"building",label:(0,E.t)("share-dashboard.menu.share-internally-title","Share internally"),renderCondition:!0,onClick:()=>Ie(A.wr.link)}),De.push({shareId:A.wr.publicDashboard,testId:W.shareExternally,icon:"share-alt",label:(0,E.t)("share-dashboard.menu.share-externally-title","Share externally"),renderCondition:!Pe&&(0,U.iR)(),onClick:()=>{Ie(A.wr.publicDashboard)}}),H.forEach(Ke=>De.push(Ke)),De.push({shareId:A.wr.snapshot,testId:W.shareSnapshot,icon:"camera",label:(0,E.t)("share-dashboard.menu.share-snapshot-title","Share snapshot"),renderCondition:x.TP.isSignedIn&&g.$.snapshotEnabled&&pe.canEditDashboard(),onClick:()=>{Ie(A.wr.snapshot)}}),De.filter(Ke=>Ke.renderCondition)},[Pe,pe]),Se=De=>{S.c.sharingCategoryClicked({item:De.shareId,shareResource:(0,A.hD)(Pe?.getRef())}),De.onClick(pe)};return(0,t.jsx)(p.W,{"data-testid":W.container,children:ge().map(De=>(0,t.jsx)(p.W.Item,{testId:De.testId,label:De.label,icon:De.icon,description:De.description,onClick:()=>Se(De)},De.shareId))})}var Q=e(70439);const Y=a.Tp.pages.Dashboard.DashNav.newShareButton;function q({dashboard:pe,panel:Pe}){const Ie=(0,l.of)(te),[ge,Se]=(0,n.useState)(!1),[De,Ke]=(0,w.A)(async()=>(S.c.toolbarShareClick(),await(0,Q.Xe)(pe,Pe)),[pe]),Me=(0,n.useCallback)(we=>{Se(we)},[]),be=()=>(0,t.jsx)(M,{dashboard:pe});return(0,t.jsxs)(y.e,{"data-testid":Y.container,className:Ie.container,children:[(0,t.jsx)(h.$n,{"data-testid":Y.shareLink,size:"sm",tooltip:(0,E.t)("share-dashboard.share-button-tooltip","Copy link"),onClick:Ke,children:(0,t.jsx)(E.x6,{i18nKey:"share-dashboard.share-button",children:"Share"})}),(0,t.jsx)(c.m,{overlay:be,placement:"bottom-end",onVisibleChange:Me,children:(0,t.jsx)(h.$n,{"data-testid":Y.arrowMenu,size:"sm",icon:ge?"angle-up":"angle-down"})})]})}function te(pe){return{container:(0,r.css)({gap:1})}}var X=e(99246),ee=e(74730),ne=e(80997),Z=e(96374),ae=e(28138),re=e(28444);function se(pe){return(0,t.jsx)(d.I,{"data-testid":"button-snapshot",tooltip:(0,E.t)("dashboard.toolbar.open-original","Open original dashboard"),icon:"link",onClick:()=>de(pe.originalURL)},"button-snapshot")}const de=pe=>{const Pe=pe??"",Ie=ne.sQ.sanitizeUrl(Pe);try{const ge=new URL(Ie,g.$.appUrl),Se=new URL(g.$.appUrl);ge.host!==Se.host?ae.A.publish(new re.S8({component:Z.u,props:{title:"Proceed to external site?",modalClass:(0,r.css)({width:"max-content",maxWidth:"80vw"}),body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:Pe})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:()=>{window.location.href=ge.href}}})):i.Ny.push(Ie)}catch(ge){console.error("Failed to open original dashboard",ge)}},le=n.memo(({dashboard:pe})=>{const Pe=(0,n.useId)(),Ie=(0,t.jsx)(he,{dashboard:pe},Pe);return(0,t.jsx)(P.H,{actions:Ie})});le.displayName="NavToolbarActions";function he({dashboard:pe}){const{isEditing:Pe,viewPanelScene:Ie,isDirty:ge,uid:Se,meta:De,editview:Ke,editPanel:Me,editable:be}=pe.useState(),{isPlaying:we}=b._o.useState(),[Be,He]=(0,n.useState)(!1),Ve=x.TP.hasEditPermissionInFolders,Je=[],nt=(0,l.of)(ce),pt=!!Me,bt=!!Ie,Tt=J(Me),ye=Me&&(0,ee.ME)(Me.state.panelRef.resolve()),je=s.M.exists(D.tH),ue=!Ke&&!bt&&!pt,Ee=Pe&&ue,Ce=g.$.featureToggles.singleTopNav&&g.$.featureToggles.scopeFilters;pt||ie(Je,X.C.left,"left-actions"),Je.push({group:"icon-actions",condition:Se&&!!De.canStar&&ue&&!Pe,render:()=>{let Te=De.isStarred?(0,E.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,E.t)("dashboard.toolbar.mark-favorite","Mark as favorite");return(0,t.jsx)(d.I,{tooltip:Te,icon:(0,t.jsx)(o.I,{name:De.isStarred?"favorite":"star",size:"lg",type:De.isStarred?"mono":"default"}),"data-testid":a.Tp.components.NavToolbar.markAsFavorite,onClick:()=>{S.c.toolbarFavoritesClick(),pe.onStarDashboard()}},"star-dashboard-button")}}),De.publicDashboardEnabled&&Je.push({group:"icon-actions",condition:Se&&!!De.canStar&&ue&&!Pe,render:()=>(0,t.jsx)(u.E,{color:"blue",text:"Public",className:nt.publicBadge,"data-testid":a.Tp.pages.Dashboard.DashNav.publicDashboardTag},"public-dashboard-button-badge")});const Ne=g.$.buildInfo.env==="development";Je.push({group:"icon-actions",condition:Ne&&Se&&ue&&!Pe,render:()=>(0,t.jsx)(d.I,{tooltip:"Switch to old dashboard page",icon:"apps",onClick:()=>{i.Ny.partial({scenes:!1})}},"view-in-old-dashboard-button")}),Je.push({group:"icon-actions",condition:De.isSnapshot&&!De.dashboardNotFound&&!Pe,render:()=>(0,t.jsx)(se,{originalURL:pe.getInitialSaveModel()?.snapshot?.originalUrl??""},"go-to-snapshot-origin")}),!pt&&!Pe&&ie(Je,X.C.right,"icon-actions"),Je.push({group:"add-panel",condition:Ee,render:()=>(0,t.jsx)(c.m,{onVisibleChange:Te=>{He(Te),S.c.toolbarAddClick()},overlay:()=>(0,t.jsxs)(p.W,{children:[(0,t.jsx)(p.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,E.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const Te=pe.onCreateNewPanel();S.c.toolbarAddButtonClicked({item:"add_visualization"}),pe.setState({editPanel:(0,R.L)(Te,!0)})}},"add-visualization"),(0,t.jsx)(p.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,E.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{pe.onShowAddLibraryPanelDrawer(),S.c.toolbarAddButtonClicked({item:"add_library_panel"})}},"add-panel-lib"),(0,t.jsx)(p.W.Item,{testId:a.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,E.t)("dashboard.add-menu.row","Row"),onClick:()=>{pe.onCreateNewRow(),S.c.toolbarAddButtonClicked({item:"add_row"})}},"add-row"),(0,t.jsx)(p.W.Item,{disabled:!je,testId:a.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,E.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{pe.pastePanel(),S.c.toolbarAddButtonClicked({item:"paste_panel"})}},"paste-panel")]}),placement:"bottom",offset:[0,6],children:(0,t.jsxs)(h.$n,{variant:"primary",size:"sm",fill:"outline","data-testid":a.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(o.I,{name:Be?"angle-up":"angle-down",size:"lg"})]},"add-panel-button")},"add-panel-dropdown")}),Je.push({group:"playlist-actions",condition:we&&ue&&!Pe,render:()=>(0,t.jsx)(d.I,{"data-testid":a.Tp.pages.Dashboard.DashNav.playlistControls.prev,tooltip:(0,E.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:()=>b._o.prev()},"play-list-prev")}),Je.push({group:"playlist-actions",condition:we&&ue&&!Pe,render:()=>(0,t.jsx)(d.I,{onClick:()=>b._o.stop(),"data-testid":a.Tp.pages.Dashboard.DashNav.playlistControls.stop,children:(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})},"play-list-stop")}),Je.push({group:"playlist-actions",condition:we&&ue&&!Pe,render:()=>(0,t.jsx)(d.I,{"data-testid":a.Tp.pages.Dashboard.DashNav.playlistControls.next,tooltip:(0,E.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:()=>b._o.next(),narrow:!0},"play-list-next")}),Je.push({group:"back-button",condition:(bt||pt)&&!ye,render:()=>(0,t.jsx)(h.$n,{onClick:()=>{i.Ny.partial({viewPanel:null,editPanel:null})},tooltip:"",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":a.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")}),Je.push({group:"back-button",condition:!!Ke,render:()=>(0,t.jsx)(h.$n,{onClick:()=>{i.Ny.partial({editview:null})},tooltip:"",fill:"text",variant:"secondary",size:"sm",icon:"arrow-left","data-testid":a.Tp.components.NavToolbar.editDashboard.backToDashboardButton,children:"Back to dashboard"},"back")});const Fe=Se&&!Pe&&!De.isSnapshot&&!we;Je.push({group:"main-buttons",condition:!g.$.featureToggles.newDashboardSharingComponent&&Fe,render:()=>(0,t.jsx)(h.$n,{tooltip:(0,E.t)("dashboard.toolbar.share","Share dashboard"),size:"sm",className:nt.buttonWithExtraMargin,fill:"outline",onClick:()=>{S.c.toolbarShareClick(),i.Ny.partial({shareView:A.wr.link})},"data-testid":a.Tp.components.NavToolbar.shareDashboard,children:"Share"},"share-dashboard-button")}),Je.push({group:"main-buttons",condition:!Pe&&pe.canEditDashboard()&&!bt&&!we&&be,render:()=>(0,t.jsx)(h.$n,{onClick:()=>{pe.onEnterEditMode()},tooltip:"Enter edit mode",className:nt.buttonWithExtraMargin,variant:g.$.featureToggles.newDashboardSharingComponent?"secondary":"primary",size:"sm","data-testid":a.Tp.components.NavToolbar.editDashboard.editButton,children:"Edit"},"edit")}),Je.push({group:"main-buttons",condition:!Pe&&pe.canEditDashboard()&&!bt&&!we&&!be,render:()=>(0,t.jsx)(h.$n,{onClick:()=>{pe.onEnterEditMode(),pe.setState({editable:!0,meta:{...De,canEdit:!0}})},tooltip:"This dashboard was marked as read only",className:nt.buttonWithExtraMargin,variant:"secondary",size:"sm","data-testid":a.Tp.components.NavToolbar.editDashboard.editButton,children:"Make editable"},"edit")}),Je.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&Fe,render:()=>(0,t.jsx)(K,{dashboard:pe},"new-export-dashboard-button")}),Je.push({group:"new-share-dashboard-buttons",condition:g.$.featureToggles.newDashboardSharingComponent&&Fe,render:()=>(0,t.jsx)(q,{dashboard:pe},"new-share-dashboard-button")}),Je.push({group:"settings",condition:Pe&&pe.canEditDashboard()&&ue,render:()=>(0,t.jsx)(h.$n,{onClick:()=>{pe.onOpenSettings()},tooltip:"Dashboard settings",fill:"text",size:"sm",variant:"secondary","data-testid":a.Tp.components.NavToolbar.editDashboard.settingsButton,children:"Settings"},"settings")}),Je.push({group:"main-buttons",condition:Pe&&!De.isNew&&ue,render:()=>(0,t.jsx)(h.$n,{onClick:()=>pe.exitEditMode({skipConfirm:!1}),tooltip:"Exits edit mode and discards unsaved changes",size:"sm",fill:"text",variant:"primary","data-testid":a.Tp.components.NavToolbar.editDashboard.exitButton,children:"Exit edit"},"discard")}),Je.push({group:"main-buttons",condition:pt&&!ye&&!Ke&&!bt,render:()=>(0,t.jsx)(h.$n,{onClick:Me?.onDiscard,tooltip:Me?.state.isNewPanel?"Discard panel":"Discard panel changes",size:"sm",disabled:!Tt,fill:"outline",variant:"destructive","data-testid":a.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:Me?.state.isNewPanel?"Discard panel":"Discard panel changes"},"discard")}),Je.push({group:"main-buttons",condition:pt&&ye&&!Ke&&!bt,render:()=>(0,t.jsx)(h.$n,{onClick:Me?.onDiscard,tooltip:"Discard library panel changes",size:"sm",fill:"outline",variant:"destructive","data-testid":a.Tp.components.NavToolbar.editDashboard.discardChangesButton,children:"Discard library panel changes"},"discardLibraryPanel")}),Je.push({group:"main-buttons",condition:pt&&ye&&!Ke&&!bt,render:()=>(0,t.jsx)(h.$n,{onClick:Me?.onUnlinkLibraryPanel,tooltip:"Unlink library panel",size:"sm",fill:"outline",variant:"secondary","data-testid":a.Tp.components.NavToolbar.editDashboard.unlinkLibraryPanelButton,children:"Unlink library panel"},"unlinkLibraryPanel")}),Je.push({group:"main-buttons",condition:pt&&ye&&!Ke&&!bt,render:()=>(0,t.jsx)(h.$n,{onClick:Me?.onSaveLibraryPanel,tooltip:"Save library panel",size:"sm",fill:"outline",variant:"primary","data-testid":a.Tp.components.NavToolbar.editDashboard.saveLibraryPanelButton,children:"Save library panel"},"saveLibraryPanel")}),Je.push({group:"main-buttons",condition:Pe&&!ye&&(De.canSave||Ve),render:()=>{if(De.isNew)return(0,t.jsx)(h.$n,{onClick:()=>{pe.openSaveDrawer({})},className:nt.buttonWithExtraMargin,tooltip:"Save changes",size:"sm",variant:"primary","data-testid":a.Tp.components.NavToolbar.editDashboard.saveButton,children:"Save dashboard"},"save");if(Ve&&!De.canSave&&!De.canMakeEditable)return(0,t.jsx)(h.$n,{onClick:()=>{pe.openSaveDrawer({saveAsCopy:!0})},className:nt.buttonWithExtraMargin,tooltip:"Save as copy",size:"sm",variant:ge?"primary":"secondary",children:"Save as copy"},"save");const Te=(0,t.jsxs)(p.W,{children:[(0,t.jsx)(p.W.Item,{label:"Save",icon:"save",onClick:()=>{pe.openSaveDrawer({})}}),(0,t.jsx)(p.W.Item,{label:"Save as copy",icon:"copy",onClick:()=>{pe.openSaveDrawer({saveAsCopy:!0})}})]});return(0,t.jsxs)(y.e,{className:nt.buttonWithExtraMargin,children:[(0,t.jsx)(h.$n,{onClick:()=>{pe.openSaveDrawer({})},tooltip:"Save changes",size:"sm","data-testid":a.Tp.components.NavToolbar.editDashboard.saveButton,variant:ge?"primary":"secondary",children:"Save dashboard"}),(0,t.jsx)(c.m,{overlay:Te,children:(0,t.jsx)(h.$n,{"aria-label":"More save options",icon:"angle-down",variant:ge?"primary":"secondary",size:"sm"})})]},"save")}});const Ue=[];let fe="";for(const Te of Je)Te.condition&&(fe&&fe!==Te.group&&fe&&Ue.push((0,t.jsx)(m.K,{},`${Te.group}-separator`)),Ue.push(Te.render()),fe=Te.group);return(0,t.jsxs)(f.B,{flex:1,minWidth:0,justifyContent:Ce?"space-between":"flex-end",children:[Ce&&(0,t.jsx)(T.Dh,{}),(0,t.jsx)(v.U,{alignment:"right",children:Ue})]})}function ie(pe,Pe,Ie){if(Pe.length>0)for(const ge of Pe){const Se={dashboard:(0,C.UA)().getCurrent()};if(ge.show(Se)){const De=ge.component;pe.push({group:Ie,condition:!0,render:()=>(0,n.createElement)(De,{...Se,key:pe.length})})}}}function J(pe){const[Pe,Ie]=(0,n.useState)();return(0,n.useEffect)(()=>{if(pe){const ge=pe.subscribeToState(Se=>{Se.isDirty!==Pe&&Ie(Se.isDirty)});return()=>ge.unsubscribe()}},[pe,Pe]),Pe}function ce(pe){return{buttonWithExtraMargin:(0,r.css)({margin:pe.spacing(0,.5)}),publicBadge:(0,r.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})}}},42397:(_,L,e)=>{"use strict";e.d(L,{$:()=>d,m:()=>u});var t=e(74848),n=e(81887),r=e(91052),s=e(14578),a=e(83122),g=e(27746),i=e(38138),l=e(7196);class d extends n.Bs{static{this.Component=o}}function o({model:p}){const{menu:h,rawLinks:y}=p.useState();if(!(p.parent instanceof n.Eb))throw new Error("VizPanelLinks must be a child of VizPanel");if(!y||y.length===0)return null;if(y.length===1){const f=(0,l.eQ)(p.parent)[0];return(0,t.jsx)(r.NR.TitleItem,{href:f.href,onClick:f.onClick,target:f.target,title:f.title,children:(0,t.jsx)(s.I,{name:"external-link-alt",size:"md"})})}return(0,t.jsx)(a.m,{overlay:()=>(0,t.jsx)(h.Component,{model:h},h.state.key),children:(0,t.jsx)(g.I,{icon:"external-link-alt",iconSize:"md","aria-label":"panel links"})})}class u extends n.Bs{static{this.Component=c}}function c({model:p}){const{links:h}=p.useState();return h?(0,t.jsx)(i.W,{children:h?.map((y,f)=>(0,t.jsx)(i.W.Item,{label:y.title,url:y.href,target:y.target,onClick:y.onClick},f))}):null}},7196:(_,L,e)=>{"use strict";e.d(L,{eQ:()=>pe,MI:()=>Ie,oV:()=>ce,_i:()=>le,t0:()=>he,vR:()=>Se});var t=e(74135),n=e(1933),r=e(76885),s=e(32264),a=e(4402),g=e(39601),i=e(81887),l=e(28138),d=e(8484),o=e(16233),u=e(63066),c=e(22699),p=e(16560),h=e(32349),y=e(75462),f=e(19347),v=e(74730),P=e(24243),m=e(40588),D=e(74848),x=e(73145);class E extends i.Bs{static{this.Component=C}constructor(be){super(be),this.trail=b(be)}}function C({model:Me}){return(0,D.jsx)(Me.trail.Component,{model:Me.trail})}function b({metric:Me,filters:be,dataSourceUid:we,timeRangeState:Be}){return new x.b({$timeRange:new i.JZ(Be),metric:Me,initialDS:we,initialFilters:be,embedded:!0})}var T=e(32196),A=e(40845),R=e(87978),S=e(28444);function O(Me){const{scene:be,title:we,onDismiss:Be}=Me,He=(0,A.of)(N);return(0,D.jsx)(R._,{title:we,onClose:Be,size:"lg",children:(0,D.jsx)("div",{className:He.drawerInnerWrapper,children:(0,D.jsx)(be.Component,{model:be})})})}class j extends i.Bs{constructor(be){super(be)}static Component({model:be}){const we=be.useState();return(0,D.jsx)(O,{...we})}}function B(Me){const be={component:O,props:Me};appEvents.publish(new ShowModalReactEvent(be))}function N(Me){return{drawerInnerWrapper:(0,T.css)({display:"flex",padding:Me.spacing(2),background:Me.isDark?Me.colors.background.canvas:Me.colors.background.primary,position:"absolute",left:0,right:0,top:0})}}var I=e(76040);function K(Me){return Me.op==="="}function w(Me){return Me.state.$timeRange.state}function U({metric:Me,labelFilters:be}){if(be.length===0)return Me;const we=`{${be.map(({label:Be,op:He,value:Ve})=>`${Be}${He}"${Ve}"`)}}`;return`${Me}${we}`}function W(Me){return Me?.map(be=>({key:be.label,value:be.value,operator:be.op}))}function H(Me){const be=[];return Me.forEach(we=>{const Be=(0,I.u)(we);if(Be.errors.length>0)return;const{metric:He,labels:Ve}=Be.query;be.push({metric:He,labelFilters:Ve.filter(K),query:we}),Be.query.binaryQueries?.forEach(({query:{metric:Je,labels:nt}})=>{be.push({metric:Je,labelFilters:nt.filter(K),query:we})})}),be}async function z(Me,be,we){if(be.state.pluginId!=="timeseries")return;const Be=(0,v.un)(be);if(Be==null)return;const{queries:He,datasource:Ve,data:Je}=Be.state;if(Ve==null||Ve.type!=="prometheus")return;const nt=await(0,f.l)().get(Ve);if(nt.interpolateVariablesInQueries==null)return;const pt=nt.interpolateVariablesInQueries(He,{__sceneObject:{value:be}},Je?.request?.filters).filter(q),Tt=H(pt.map(ye=>ye.expr)).map(ye=>({text:U(ye),onClick:Y(ye,Me,nt)}));Tt.length>0&&we.push({text:"Explore metrics",iconClassName:"code-branch",subMenu:G(Tt)})}function G(Me){const be=new Set;function we({text:Be}){const He=be.size;return be.add(Be),be.size>He}return Me.filter(we)}function M({metric:Me,labelFilters:be,query:we},Be,He){return{metric:Me,filters:W(be),dataSourceUid:He,timeRangeState:Be}}function Q(Me,be,we){const Be=w(be),He=M(Me,Be,we.uid),Ve=new E(He);return Ve.trail.addActivationHandler(()=>{Ve.trail.state.topScene instanceof P.R&&Ve.trail.state.topScene.setActionView("breakdown")}),{scene:Ve,title:"Explore metrics"}}function Y(Me,be,we){return()=>{const Be=Q(Me,be,we),He=new j({...Be,onDismiss:()=>be.closeModal()});(0,m.z)("exploration_started",{cause:"dashboard_panel"}),be.showModal(He)}}function q(Me){return"expr"in Me}var te=e(97246),X=e(11675),ee=e(7758),ne=e(11982),Z=e(55600),ae=e(42397),re=e(54174);class se extends i.Bs{constructor(){super(...arguments),this.onDismiss=()=>{(0,v.YQ)(this).closeModal()},this.onConfirm=()=>{const be=(0,v.YQ)(this);be.unlinkLibraryPanel(this.state.panelRef.resolve()),be.closeModal()}}static{this.Component=de}}function de({model:Me}){return(0,D.jsx)(re.l,{isOpen:!0,onConfirm:()=>{Me.onConfirm(),Me.onDismiss()},onDismiss:Me.onDismiss})}function le(Me,be=!1){(async()=>{const Be=Me.parent,He=Be.getPlugin(),Ve=[],Je=[],nt=(0,v.YQ)(Be),{isEmbedded:pt}=nt.state.meta,bt=await ie(Be);if(pt){bt&&Me.setState({items:[bt]});return}const Tt=!!nt.state.editPanel;if(Tt||Ve.push({text:(0,d.t)("panel.header-menu.view","View"),iconClassName:"eye",shortcut:"v",href:(0,ne.r7)(Be)}),nt.canEditDashboard()&&nt.state.editable&&!be&&!Tt&&Ve.push({text:(0,d.t)("panel.header-menu.edit","Edit"),iconClassName:"edit",shortcut:"e",href:(0,ne.e0)((0,v.Cs)(Be))}),s.$.featureToggles.newDashboardSharingComponent){const je=[];je.push({text:(0,d.t)("share-panel.menu.share-link-title","Share link"),iconClassName:"link",shortcut:"p u",onClick:()=>{const ue=new te.j({shareView:c.wr.link,panelRef:Be.getRef()});nt.showModal(ue)}}),je.push({text:(0,d.t)("share-panel.menu.share-embed-title","Share embed"),iconClassName:"arrow",shortcut:"p e",onClick:()=>{const ue=new te.j({shareView:c.wr.embed,panelRef:Be.getRef()});nt.showModal(ue)}}),o.TP.isSignedIn&&s.$.snapshotEnabled&&nt.canEditDashboard()&&je.push({text:(0,d.t)("share-panel.menu.share-snapshot-title","Share snapshot"),iconClassName:"camera",shortcut:"p s",onClick:()=>{const ue=new te.j({shareView:c.wr.snapshot,panelRef:Be.getRef()});nt.showModal(ue)}}),Ve.push({type:"submenu",text:(0,d.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",subMenu:je,onClick:ue=>{ue.preventDefault()}})}else Ve.push({text:(0,d.t)("panel.header-menu.share","Share"),iconClassName:"share-alt",onClick:()=>{nt.showModal(new X.Z({panelRef:Be.getRef()}))},shortcut:"p s"});nt.state.isEditing&&!be&&!Tt&&Je.push({text:(0,d.t)("panel.header-menu.duplicate","Duplicate"),iconClassName:"file-copy-alt",onClick:()=>{nt.duplicatePanel(Be)},shortcut:"p d"}),Tt||Je.push({text:(0,d.t)("panel.header-menu.copy","Copy"),iconClassName:"copy",onClick:()=>{nt.copyPanel(Be)}}),nt.state.isEditing&&!be&&!Tt&&((0,v.ME)(Be)?(Je.push({text:(0,d.t)("panel.header-menu.unlink-library-panel","Unlink library panel"),iconClassName:"link-broken",onClick:()=>{nt.showModal(new se({panelRef:Be.getRef()}))}}),Je.push({text:(0,d.t)("panel.header-menu.replace-library-panel","Replace library panel"),iconClassName:"library-panel",onClick:()=>{nt.onShowAddLibraryPanelDrawer(Be.getRef())}})):s.$.featureToggles.newDashboardSharingComponent?Je.push({text:(0,d.t)("share-panel.menu.new-library-panel-title","New library panel"),iconClassName:"plus-square",onClick:()=>{const je=new te.j({shareView:c.wr.libraryPanel,panelRef:Be.getRef()});nt.showModal(je)}}):Je.push({text:(0,d.t)("panel.header-menu.create-library-panel","Create library panel"),onClick:()=>{nt.showModal(new X.Z({panelRef:Be.getRef(),activeTab:c.wr.libraryPanel}))}})),Je.push({text:(0,d.t)("panel.header-menu.new-alert-rule","New alert rule"),iconClassName:"bell",onClick:je=>ge(Be)}),De(Be.state.options)&&!Tt&&Je.push({text:Be.state.options.legend.showLegend?(0,d.t)("panel.header-menu.hide-legend","Hide legend"):(0,d.t)("panel.header-menu.show-legend","Show legend"),iconClassName:Be.state.options.legend.showLegend?"legend-hide":"legend-show",onClick:je=>{je.preventDefault(),Se(Be)},shortcut:"p l"}),nt.canEditDashboard()&&He&&!He.meta.skipDataQuery&&!be&&Je.push({text:(0,d.t)("panel.header-menu.get-help","Get help"),iconClassName:"question-circle",onClick:je=>{je.preventDefault(),Ke(Be,p.q.Help)}}),s.$.featureToggles.exploreMetrics&&await z(nt,Be,Ve),bt&&Ve.push(bt),Ve.push(J(He,Be,nt));const{extensions:ye}=(0,a.Kf)({extensionPointId:t.S.DashboardPanelMenu,context:Pe(Be,nt),limitPerPlugin:3});ye.length>0&&!nt.state.isEditing&&Ve.push({text:"Extensions",iconClassName:"plug",type:"submenu",subMenu:(0,y.N9)(ye)}),Je.length&&Ve.push({type:"submenu",text:(0,d.t)("panel.header-menu.more","More..."),iconClassName:"cube",subMenu:Je,onClick:je=>{je.preventDefault()}}),nt.state.isEditing&&!be&&!Tt&&(Ve.push({text:"",type:"divider"}),Ve.push({text:(0,d.t)("panel.header-menu.remove","Remove"),iconClassName:"trash-alt",onClick:()=>{Ie(nt,Be)},shortcut:"p r"})),Me.setState({items:Ve})})()}const he=Me=>le(Me,!0);async function ie(Me){const be=await(0,ne.Lp)(Me);if(be)return{text:(0,d.t)("panel.header-menu.explore","Explore"),iconClassName:"compass",shortcut:"p x",href:be}}function J(Me,be,we){const Be=[];return Me&&!Me.meta.skipDataQuery&&(Be.push({text:(0,d.t)("panel.header-menu.inspect-data","Data"),href:(0,ne.Uu)(be,p.q.Data),onClick:He=>{He.preventDefault(),g.Ny.partial({inspect:be.state.key,inspectTab:p.q.Data})}}),we instanceof Z.H$&&we.state.meta.canEdit&&Be.push({text:(0,d.t)("panel.header-menu.query","Query"),href:(0,ne.Uu)(be,p.q.Query),onClick:He=>{He.preventDefault(),g.Ny.partial({inspect:be.state.key,inspectTab:p.q.Query})}})),Be.push({text:(0,d.t)("panel.header-menu.inspect-json","Panel JSON"),href:(0,ne.Uu)(be,p.q.JSON),onClick:He=>{He.preventDefault(),g.Ny.partial({inspect:be.state.key,inspectTab:p.q.JSON})}}),{text:(0,d.t)("panel.header-menu.inspect","Inspect"),iconClassName:"info-circle",shortcut:"i",href:(0,ne.Uu)(be),onClick:He=>{He.isDefaultPrevented()||g.Ny.partial({inspect:be.state.key,inspectTab:p.q.Data})},subMenu:Be.length>0?Be:void 0}}function ce(Me){if(!(Me.parent instanceof ae.$))throw new Error("parent of VizPanelLinksMenu must be VizPanelLinks");const be=Me.parent.parent;if(!(be instanceof i.Eb))throw new Error("parent of VizPanelLinks must be VizPanel");Me.setState({links:pe(be)})}function pe(Me){const be=(He,Ve)=>i.jh.interpolate(Me,He,Ve),we=(0,h.CH)(Me,be);if(!we)return[];const Be=we.getLinks(be);return Be.map(He=>({...He,onClick:(Je,nt)=>{ee.c.panelLinkClicked({has_multiple_links:Be.length>1}),He.onClick?.(Je,nt)}}))}function Pe(Me,be){const we=i.jh.getTimeRange(Me);let Be=(0,v.un)(Me);const He=Be?.state.queries,Ve=(0,v.Cs)(Me);let Je={};if(Me.state.$variables&&Me.state.$variables.state.variables.forEach(nt=>{nt instanceof i.xc&&(Je={...Je,[nt.state.name]:{value:nt.getValue(),text:nt.getValueText()}})}),Me.parent?.parent instanceof i.tI){const nt=Me.parent.parent;nt.state.$variables&&nt.state.$variables.state.variables.forEach(pt=>{pt instanceof i.xc&&(Je={...Je,[pt.state.name]:{value:pt.getValue(),text:pt.getValueText()}})})}return{id:Ve,pluginId:Me.state.pluginId,title:Me.state.title,timeRange:we.state.value.raw,timeZone:(0,n.O)({timeZone:we.getTimeZone()}),dashboard:{uid:be.state.uid,title:be.state.title,tags:be.state.tags||[]},targets:He,scopedVars:Je,data:Be?.state.data}}function Ie(Me,be){l.A.publish(new S.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",yesText:"Remove",onConfirm:()=>Me.removePanel(be)}))}const ge=async Me=>{const be=await(0,u.J6)(Me),we=r.kM.renderUrl("/alerting/new",{defaults:JSON.stringify(be),returnTo:location.pathname+location.search});g.Ny.push(we)};function Se(Me){const be=Me.state.options;De(be)&&typeof be.legend.showLegend=="boolean"&&Me.onOptionsChange({legend:{showLegend:!be.legend.showLegend}})}function De(Me){return Me!=null&&typeof Me=="object"&&"legend"in Me}const Ke=(Me,be)=>{g.Ny.partial({inspect:Me.state.key,inspectTab:be})}},7928:(_,L,e)=>{"use strict";e.d(L,{v:()=>c});var t=e(74848),n=e(32196),r=e(43127),s=e(65879),a=e(85858),g=e(81887),i=e(40845),l=e(56034),d=e(15666),o=e(91052),u=e(14578);class c extends g.XQ{static{this.Component=p}constructor(f={}){super({...f,from:"now-6h",to:"now",value:(0,r.E2)()}),this.addActivationHandler(()=>this._onActivate())}_onActivate(){this._subs.add(this.subscribeToState((f,v)=>{if(f.timeFrom!==v.timeFrom||f.timeShift!==v.timeShift){const{timeInfo:P,timeRange:m}=this.getTimeOverride(this.getAncestorTimeRange().state.value);this.setState({timeInfo:P,value:m})}}))}ancestorTimeRangeChanged(f){const v=this.getTimeOverride(f.value);this.setState({value:v.timeRange,timeInfo:v.timeInfo})}getTimeOverride(f){const{timeFrom:v,timeShift:P}=this.state,m={timeInfo:"",timeRange:f};if(v){const D=g.jh.interpolate(this,this.state.timeFrom),x=s.describeTextRange(D);if(x.invalid)return m.timeInfo="invalid time override",m;s.isRelativeTimeRange(f.raw)&&(m.timeInfo=x.display,m.timeRange={from:a.parse(x.from),to:a.parse(x.to),raw:{from:x.from,to:x.to}})}if(P){const D=g.jh.interpolate(this,this.state.timeShift);if(s.describeTextRange(D).invalid)return m.timeInfo="invalid timeshift",m;const E="-"+D;m.timeInfo+=" timeshift "+E;const C=a.parseDateMath(E,m.timeRange.from,!1),b=a.parseDateMath(E,m.timeRange.to,!0);m.timeRange={from:C,to:b,raw:{from:C,to:b}}}return m}}function p({model:y}){const{timeInfo:f,hideTimeOverride:v}=y.useState(),P=(0,i.of)(h);return!f||v?null:(0,t.jsx)(l.m,{content:(0,t.jsx)(d.xS,{timeRange:y.state.value,timeZone:y.getTimeZone()}),children:(0,t.jsxs)(o.NR.TitleItem,{className:P.timeshift,children:[(0,t.jsx)(u.I,{name:"clock-nine",size:"sm"})," ",f]})})}const h=y=>({timeshift:(0,n.css)({color:y.colors.text.link,gap:y.spacing(.5),whiteSpace:"nowrap"})})},79284:(_,L,e)=>{"use strict";e.d(L,{L:()=>l});var t=e(2543),n=e.n(t),r=e(81887),s=e(74730),a=e(41507),g=e(7196),i=e(30195);class l extends r.Bs{constructor(h){super(h),this._variableDependency=new r.Sh(this,{variableNames:[this.state.variableName],onVariableUpdateCompleted:()=>{}}),this.isWaitingForVariables=!1,this.addActivationHandler(()=>this._activationHandler())}notifyRepeatedPanelsWaitingForVariables(h){const y=[this._getRow(),...this._clonedRows??[]];for(const f of y)for(const v of f.state.children){if(!(v instanceof a.U))continue;const P=(0,s.un)(v.state.body);P&&P.variableDependency?.variableUpdateCompleted(h,!1)}}_activationHandler(){this.performRepeat();const h=this._getLayout(),y=this._getRow(),f=y.state.key+"-clone-",v=h.subscribeToState(()=>{const P=h.state.children.filter(m=>m instanceof r.tI&&m.state.key?.includes(f));for(const m of P){if(!(m instanceof r.tI)||m.state.children.length===y.state.children.length)continue;const D=m.state.children.find(x=>!x.state.key?.includes("clone"));if(D){const x=D.clone();if(m.setState({children:m.state.children.filter(E=>E!==D)}),y.state.children.find(E=>E.state.key===x.state.key))return;y.setState({children:[...y.state.children,x]}),this.performRepeat(!0)}}});return()=>{v.unsubscribe()}}_getRow(){if(!(this.parent instanceof r.tI))throw new Error("RepeatedRowBehavior: Parent is not a SceneGridRow");return this.parent}_getLayout(){const h=r.jh.getLayout(this);if(!(h instanceof r.hy))throw new Error("RepeatedRowBehavior: Layout is not a SceneGridLayout");return h}performRepeat(h=!1){if(this.isWaitingForVariables=this._variableDependency.hasDependencyInLoadingState(),this.isWaitingForVariables)return;const y=r.jh.lookupVariable(this.state.variableName,this.parent?.parent);if(!y){console.error("RepeatedRowBehavior: Variable not found");return}if(!(y instanceof r.n8)){console.error("RepeatedRowBehavior: Variable is not a MultiValueVariable");return}const f=this._getRow(),v=this._getLayout(),{values:P,texts:m}=(0,s.a7)(y);if((0,t.isEqual)(this._prevRepeatValues,P)&&!h)return;this._prevRepeatValues=P,this._clonedRows=[];const D=f.state.children,x=d(D);let E=0;const C={values:[""],texts:y.hasAllValue()?["All"]:["None"]},b=P.length?P:C.values,T=m.length?m:C.texts;for(let A=0;A<b.length;A++){const R=[],S=b[A];for(const j of D){const N=(j.state.y??0)+(x+1)*A,I=A>0?`${j.state.key}-clone-${S}`:j.state.key,K=j.clone({key:I,y:N});A>0&&(c(K,S),K instanceof a.U&&(K.setState({isDraggable:!1}),K.state.body.setState({menu:new r.Lw({$behaviors:[g.t0]})}))),R.push(K),E<N+K.state.height&&(E=N+K.state.height)}const O=this.getRowClone(f,A,S,T[A],x,R,y);this._clonedRows.push(O)}o(v,this._clonedRows,E,f),this.publishEvent(new i.d({source:this}),!0)}getRowClone(h,y,f,v,P,m,D){if(y===0)return h.setState({$variables:new r.Pj({variables:[new r.xc({name:this.state.variableName,value:f,text:String(v),isMulti:D.state.isMulti,includeAll:D.state.includeAll})]}),children:m}),h;const x=h.state.y??0;return h.clone({key:`${h.state.key}-clone-${f}`,$variables:new r.Pj({variables:[new r.xc({name:this.state.variableName,value:f,text:String(v),isMulti:D.state.isMulti,includeAll:D.state.includeAll})]}),$behaviors:[],children:m,y:x+P*y+y,actions:void 0})}removeBehavior(){const h=this._getRow(),y=this._getLayout(),f=u(this._getLayout(),this._getRow());y.setState({children:f}),h.setState({$behaviors:h.state.$behaviors.filter(v=>v!==this),$variables:void 0})}}function d(p){let h=0,y=Number.MAX_VALUE;if(p.length===0)return 0;for(const f of p)f.state.y+f.state.height>h&&(h=f.state.y+f.state.height),f.state.y<y&&(y=f.state.y);return h-y}function o(p,h,y,f){const v=u(p,f),P=v.indexOf(f);if(P===-1)throw new Error("RowRepeaterBehavior: Parent row not found in layout children");const m=[...v.slice(0,P),...h,...v.slice(P+1)];if(v.length>P+1){const D=v.slice(P+1),x=D[0].state.y,E=y-x;for(const C of D)if(C.setState({y:C.state.y+E}),C instanceof r.tI)for(const b of C.state.children)b.setState({y:b.state.y+E})}p.setState({children:m})}function u(p,h){return p.state.children.filter(y=>!y.state.key?.startsWith(`${h.state.key}-clone-`))}function c(p,h){p.forEachChild(y=>{y.setState({key:`${y.state.key}-clone-${h}`}),c(y,h)})}},54174:(_,L,e)=>{"use strict";e.d(L,{l:()=>r});var t=e(74848),n=e(96374);const r=({isOpen:s,onConfirm:a,onDismiss:g})=>(0,t.jsx)(n.u,{title:"Do you really want to unlink this panel?",icon:"question-circle",body:`If you unlink this panel, you will be able to edit it without affecting any other dashboards.
            However, once you make a change you will not be able to revert to its original reusable panel.`,confirmText:"Yes, unlink",onConfirm:()=>{a(),g()},onDismiss:g,isOpen:s})},20485:(_,L,e)=>{"use strict";e.d(L,{$L:()=>c,Tr:()=>f,Wu:()=>y});var t=e(74848),n=e(32196),r=e(32264),s=e(81887),a=e(40845),g=e(56034),i=e(91052),l=e(14578),d=e(84423),o=e(8480),u=e(74730);class c extends s.Bs{constructor(){super({}),this.onActivate=()=>{const D=this.parent;if(!D||!(D instanceof s.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=p}getPanel(){const D=this.parent;return D&&D instanceof s.Eb?D:null}}function p({model:m}){const D=m.getPanel(),x=(0,a.of)(P);if(!D)return null;if(v(D)){const b=`This ${h(f(D),y(D))} requires Angular (deprecated).`;return(0,t.jsx)(g.m,{content:b,children:(0,t.jsx)(i.NR.TitleItem,{className:x.angularNotice,"data-testid":"angular-deprecation-icon",children:(0,t.jsx)(l.I,{name:"exclamation-triangle",size:"md"})})})}return null}function h(m,D){return D?"panel":m?"data source":"panel or data source"}function y(m){return(r.$.panels[m.state.pluginId]?.angular?.detected||d.vI.includes(m.state.pluginId))&&!r.$.panels[m.state.pluginId]?.angular?.hideDeprecation}function f(m){const x=(0,u.un)(m)?.state.datasource;return x?.uid?(0,o.Hv)(x?.uid):!1}function v(m){return(r.$.featureToggles.angularDeprecationUI??!1)&&(f(m)||y(m))}function P(m){return{angularNotice:(0,n.css)({color:m.colors.warning.text})}}},77517:(_,L,e)=>{"use strict";e.d(L,{D:()=>l});var t=e(74848),n=e(81887),r=e(15054),s=e(74730),a=e(41507),g=e(79284),i=e(58029);class l extends n.Bs{editModeChanged(o){this.state.grid.setState({isDraggable:o,isResizable:o}),(0,s.X0)(this.state.grid,!0)}cleanUpStateFromExplore(){this.state.grid.setState({children:this.state.grid.state.children.slice(1)})}addPanel(o){const u=(0,s.Cs)(o),c=new a.U({height:s.sw,width:s.vm,x:0,y:0,body:o,key:`grid-item-${u}`});this.state.grid.setState({children:[c,...this.state.grid.state.children]})}addNewRow(){const o=this.getNextPanelId(),u=new n.tI({key:(0,s.XA)(o),title:"Row title",actions:new i.u({}),y:0}),c=this.state.grid,p=c.state.children.findIndex(y=>y instanceof n.tI),h=c.state.children.splice(0,p===-1?c.state.children.length:p).map(y=>y.clone());return h&&u.setState({children:h}),c.setState({children:[u,...c.state.children]}),u}removeRow(o,u=!1){const c=this.state.grid,p=c.state.children.filter(h=>h.state.key!==o.state.key);if(!u){const h=o.state.children.map(f=>f.clone()),y=c.state.children.findIndex(f=>f.state.key===o.state.key);p.splice(y,0,...h)}c.setState({children:p})}removePanel(o){const u=o.parent;if(!(u instanceof a.U))throw new Error("Trying to remove panel that is not inside a DashboardGridItem");const c=this.state.grid;let p;try{p=n.jh.getAncestor(u,n.tI)}catch{p=void 0}if(p){p.setState({children:p.state.children.filter(h=>h!==u)}),c.forceRender();return}this.state.grid.setState({children:c.state.children.filter(h=>h!==u)})}duplicatePanel(o){const u=o.parent;if(!(u instanceof a.U)){console.error("Trying to duplicate a panel that is not inside a DashboardGridItem");return}let c,p,h;const y=this.getNextPanelId(),f=this.state.grid;if(u instanceof a.U?(c=n.Go.cloneSceneObjectState(u.state.body.state),p=n.jh.getData(u.state.body).clone()):(c=n.Go.cloneSceneObjectState(o.state),p=n.jh.getData(o).clone()),delete p.state.data?.alertState,h=new a.U({x:u.state.x,y:u.state.y,height:u.state.height,width:u.state.width,variableName:u.state.variableName,repeatDirection:u.state.repeatDirection,maxPerRow:u.state.maxPerRow,key:`grid-item-${y}`,body:new n.Eb({...c,$data:p,key:(0,s.XA)(y)})}),u.parent instanceof n.tI){const v=u.parent;v.setState({children:[...v.state.children,h]}),f.forceRender();return}f.setState({children:[...f.state.children,h]})}getVizPanels(){const o=[];return this.state.grid.forEachChild(u=>{if(!(u instanceof a.U)&&!(u instanceof n.tI))throw new Error("Child is not a DashboardGridItem or SceneGridRow, invalid scene");u instanceof a.U?u.state.body instanceof n.Eb&&o.push(u.state.body):u instanceof n.tI&&u.forEachChild(c=>{c instanceof a.U&&c.state.body instanceof n.Eb&&o.push(c.state.body)})}),o}getNextPanelId(){let o=0;for(const u of this.state.grid.state.children){if(u instanceof a.U){const c=u.state.body;if(c){const p=(0,s.Cs)(c);p>o&&(o=p)}}if(u instanceof n.tI){const c=(0,s.Cs)(u);c>o&&(o=c);for(const p of u.state.children)if(p instanceof a.U){const h=p.state.body;if(h){const y=(0,s.Cs)(h);y>o&&(o=y)}}}}return o+1}collapseAllRows(){this.state.grid.state.children.forEach(o=>{o instanceof n.tI&&(o.state.isCollapsed||this.state.grid.toggleRow(o))})}expandAllRows(){this.state.grid.state.children.forEach(o=>{o instanceof n.tI&&o.state.isCollapsed&&this.state.grid.toggleRow(o)})}activateRepeaters(){this.state.grid.forEachChild(o=>{if(o instanceof a.U&&!o.isActive){o.activate();return}if(o instanceof n.tI&&o.state.$behaviors){for(const u of o.state.$behaviors)if(u instanceof g.L&&!o.isActive){o.activate();break}o.state.children.forEach(u=>{if(u instanceof a.U&&!u.isActive){u.activate();return}})}})}static fromVizPanels(o=[]){const u=[],p=r.cV/3;let h=0,y=0;for(let f of o)u.push(new a.U({key:`griditem-${(0,s.Cs)(f)}`,x:y,y:h,width:p,height:10,body:f})),y+=p,y+p>=r.cV&&(y=0,h+=10);return new l({grid:new n.hy({children:u,isDraggable:!1,isResizable:!1})})}static{this.Component=({model:o})=>(0,t.jsx)(o.state.grid.Component,{model:o.state.grid})}}},58029:(_,L,e)=>{"use strict";e.d(L,{u:()=>S});var t=e(74848),n=e(32196),r=e(81887),s=e(72109),a=e(40845),g=e(14578),i=e(28138),l=e(14348),d=e(28444),o=e(74730),u=e(41507),c=e(79284),p=e(77517),h=e(71678),y=e(37390),f=e(96540),v=e(49785),P=e(13544),m=e(88575),D=e(10354),x=e(42418),E=e(55852),C=e(92378);const b=({repeat:j,title:B,sceneContext:N,warning:I,onUpdate:K,onCancel:w})=>{const[U,W]=(0,f.useState)(j),H=(0,f.useCallback)(Q=>W(Q),[W]),{handleSubmit:z,register:G}=(0,v.mN)({defaultValues:{title:B}}),M=Q=>{K(Q.title,U)};return(0,t.jsxs)("form",{onSubmit:z(M),children:[(0,t.jsx)(m.D,{label:"Title",children:(0,t.jsx)(D.p,{...G("title"),type:"text"})}),(0,t.jsx)(m.D,{label:"Repeat for",children:(0,t.jsx)(C.U,{sceneContext:N,repeat:U,onChange:H})}),I&&(0,t.jsx)(x.F,{"data-testid":P.Tp.pages.Dashboard.Rows.Repeated.ConfigSection.warningMessage,severity:"warning",title:"",topSpacing:3,bottomSpacing:0,children:I}),(0,t.jsxs)(y.a.ButtonRow,{children:[(0,t.jsx)(E.$n,{type:"button",variant:"secondary",onClick:w,fill:"outline",children:"Cancel"}),(0,t.jsx)(E.$n,{type:"submit",children:"Update"})]})]})},T=({repeat:j,title:B,parent:N,onDismiss:I,onUpdate:K,warning:w})=>{const U=(0,a.of)(A);return(0,t.jsx)(y.a,{isOpen:!0,title:"Row options",onDismiss:I,className:U.modal,children:(0,t.jsx)(b,{sceneContext:N,repeat:j,title:B,onCancel:I,onUpdate:K,warning:w})})},A=()=>({modal:(0,n.css)({label:"RowOptionsModal",width:"500px"})}),R=({repeat:j,title:B,parent:N,onUpdate:I,warning:K})=>{const w=U=>(W,H)=>{I(W,H),U()};return(0,t.jsx)(h.$s,{children:({showModal:U,hideModal:W})=>(0,t.jsx)("button",{type:"button",className:"pointer","aria-label":"Row options",onClick:()=>{U(T,{title:B,repeat:j,parent:N,onDismiss:W,onUpdate:w(W),warning:K})},children:(0,t.jsx)(g.I,{name:"cog"})})})};R.displayName="RowOptionsButton";class S extends r.Bs{constructor(){super(...arguments),this.onUpdate=(B,N)=>{const I=this.getParent();let K;if(I.state.$behaviors)for(let w of I.state.$behaviors)w instanceof c.L&&(K=w);B!==I.state.title&&I.setState({title:B}),N?(K&&K.removeBehavior(),K=new c.L({variableName:N}),I.setState({$behaviors:[...I.state.$behaviors??[],K]})):K?.removeBehavior()},this.onDelete=()=>{i.A.publish(new d.bY({title:"Delete row",text:"Are you sure you want to remove this row and all its panels?",altActionText:"Delete row only",icon:"trash-alt",onConfirm:()=>this.removeRow(!0),onAltAction:()=>this.removeRow()}))},this.getWarning=()=>{if(this.getParent().state.children.some(K=>{if(!(K instanceof u.U))return!1;const w=K.state.body;return w instanceof r.Eb?(0,o.un)(w)?.state.datasource?.uid===l.K:!1}))return(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["Panels in this row use the ",l.K," data source. These panels will reference the panel in the original row, not the ones in the repeated rows."]}),(0,t.jsx)(s.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/create-dashboard/#configure-repeating-rows",children:"Learn more"})]})}}getParent(){if(!(this.parent instanceof r.tI))throw new Error("RowActions must have a SceneGridRow parent");return this.parent}getDashboard(){return(0,o.YQ)(this)}removeRow(B){r.jh.getAncestor(this,p.D).removeRow(this.getParent(),B)}static{this.Component=({model:B})=>{const N=B.getDashboard(),I=B.getParent(),{title:K}=I.useState(),{meta:w,isEditing:U}=N.useState(),W=(0,a.of)(O),H=I.state.$behaviors?.find(z=>z instanceof c.L);return(0,t.jsx)(t.Fragment,{children:w.canEdit&&U&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:W.rowActions,children:[(0,t.jsx)(R,{title:K,repeat:H instanceof c.L?H.state.variableName:void 0,parent:N,onUpdate:B.onUpdate,warning:B.getWarning()}),(0,t.jsx)("button",{type:"button",onClick:B.onDelete,"aria-label":"Delete row",children:(0,t.jsx)(g.I,{name:"trash-alt"})})]})})})}}}const O=j=>({rowActions:(0,n.css)({color:j.colors.text.secondary,lineHeight:"27px",button:{color:j.colors.text.secondary,paddingLeft:j.spacing(2),background:"transparent",border:"none","&:hover":{color:j.colors.text.maxContrast}}})})},30195:(_,L,e)=>{"use strict";e.d(L,{d:()=>r});var t=e(65463);function n(s){return"switchLayout"in s}class r extends t.x{static{this.type="dashboard-repeats-processed"}}},71176:(_,L,e)=>{"use strict";e.d(L,{X:()=>s});var t=e(32264),n=e(79422),r=e(31193);async function s(a){let g=n.Ye.templating?.list;if(t.$.featureToggles.newDashboardWithFiltersAndGroupBy){const l=await(0,r.tR)().get();if(l.getTagKeys){const d={type:l.meta.id,uid:l.uid},o={datasource:d,filters:[],name:"Filter",type:"adhoc"},u={datasource:d,name:"Group by",type:"groupby"};g=(g||[]).concat([o,u])}}const i={meta:{canStar:!1,canShare:!1,canDelete:!1,isNew:!0,folderUid:""},dashboard:{...n.Ye,uid:"",title:"New dashboard",panels:[],timezone:t.$.bootData.user?.timezone||n.Ye.timezone}};return g&&(i.dashboard.templating={list:g}),a&&(i.meta.folderUid=a),i}},70665:(_,L,e)=>{"use strict";e.d(L,{x:()=>t});const t={name:"grafana",uid:"grafana"}},13989:(_,L,e)=>{"use strict";e.d(L,{O:()=>n});var t=e(81887);function n(r){const s=[];for(const a of r){if(!(a instanceof t.tV.g))continue;const g={...a.state.query,enable:!!a.state.isEnabled,hide:!!a.state.isHidden};s.push(g)}return s}},53287:(_,L,e)=>{"use strict";e.d(L,{C:()=>g});var t=e(32264),n=e(81887),r=e(79422),s=e(73134),a=e(74730);function g(l,d){const o=[];for(const u of l.state.variables){const c={name:u.state.name,label:u.state.label,description:u.state.description??void 0,skipUrlSync:!!u.state.skipUrlSync,hide:u.state.hide||r.zL.dontHide,type:u.state.type};if(n.Go.isQueryVariable(u)){let p=[];(u.state.refresh===s.CO.never||d)&&(p=i(u.state)),o.push({...c,current:{value:u.state.value,text:u.state.text},options:p,query:u.state.query,definition:u.state.definition,datasource:u.state.datasource,sort:u.state.sort,refresh:u.state.refresh,regex:u.state.regex,allValue:u.state.allValue,includeAll:u.state.includeAll,multi:u.state.isMulti,skipUrlSync:u.state.skipUrlSync})}else if(n.Go.isCustomVariable(u))o.push({...c,current:{text:u.state.value,value:u.state.value},options:i(u.state),query:u.state.query,multi:u.state.isMulti,allValue:u.state.allValue,includeAll:u.state.includeAll});else if(n.Go.isDataSourceVariable(u))o.push({...c,current:{value:u.state.value,text:u.state.text},options:[],regex:u.state.regex,refresh:s.CO.onDashboardLoad,query:u.state.pluginId,multi:u.state.isMulti,allValue:u.state.allValue,includeAll:u.state.includeAll});else if(n.Go.isConstantVariable(u))o.push({...c,current:{value:u.state.value,text:u.state.value},query:u.state.value,hide:r.zL.hideVariable});else if(n.Go.isIntervalVariable(u)){const p=(0,a.bx)(u.state.intervals);o.push({...c,current:{text:u.state.value,value:u.state.value},query:p,refresh:u.state.refresh,options:u.state.intervals.map(h=>({value:h,text:h,selected:h===u.state.value})),auto:u.state.autoEnabled,auto_min:u.state.autoMinInterval,auto_count:u.state.autoStepCount})}else if(n.Go.isTextBoxVariable(u)){const p={text:u.state.value,value:u.state.value};o.push({...c,current:p,options:[{...p,selected:!0}],query:u.state.value})}else if(n.Go.isGroupByVariable(u)&&t.$.featureToggles.groupByVariable)o.push({...c,datasource:u.state.datasource,options:u.state.defaultOptions?.map(p=>({text:p.text,value:String(p.value)})),current:{text:u.state.text,value:u.state.value}});else if(n.Go.isAdHocVariable(u))o.push({...c,name:u.state.name,type:"adhoc",datasource:u.state.datasource,baseFilters:u.state.baseFilters,filters:u.state.filters,defaultKeys:u.state.defaultKeys});else throw new Error("Unsupported variable type")}for(const u of o)u.hide===r.zL.dontHide&&delete u.hide,u.skipUrlSync||delete u.skipUrlSync,u.label===""&&delete u.label,u.multi||delete u.multi,u.sort===s.ZG.disabled&&delete u.sort;return o}function i(l){return l.options.map(d=>({value:String(d.value),text:d.label,selected:Array.isArray(l.value)?l.value.includes(d.value):l.value===d.value}))}},19997:(_,L,e)=>{"use strict";e.d(L,{tt:()=>J,EH:()=>ie,wM:()=>de});var t=e(2543),n=e(32264),r=e(81887),s=e(34214),a=e(91309),g=e(38477),i=e(33278),l=e(16279),d=e(41507),o=e(74730);class u{constructor(Se,De){this._sceneObject=De,this.state={name:Se,type:"dashboard_macro"}}getValue(Se){const De=(0,o.YQ)(this._sceneObject);switch(Se){case"uid":return De.state.uid||"";case"title":case"name":case"id":default:return De.state.title}}getValueText(){return""}}function c(){const ge=r.Go.registerVariableMacro("__dashboard",u);return()=>ge()}var p=e(55600),h=e(39601),y=e(53001);class f extends y.mN{constructor({reloadOnScopesChange:Se,uid:De}){super({handler:Ke=>{Se&&De?h.Ny.reload():r.jh.getTimeRange(Ke).onRefresh()}})}}var v=e(68435),P=e(42397),m=e(7196),D=e(74848),x=e(2038);class E extends r.Bs{constructor(){super({}),this.onActivate=()=>{const Se=this.parent;if(!Se||!(Se instanceof r.Eb))throw new Error("PanelNotices can be used only as title items for VizPanel")},this.addActivationHandler(this.onActivate)}static{this.Component=C}getPanel(){const Se=this.parent;return Se&&Se instanceof r.Eb?Se:null}}function C({model:ge}){const Se=ge.getPanel(),Ke=r.jh.getData(ge).useState();if(!Se)return null;const Me=(0,o.Cs)(Se);return Ke.data?.series?(0,D.jsx)(x.Z,{frames:Ke.data?.series,panelId:Me}):null}var b=e(7928),T=e(79284),A=e(20485),R=e(77517),S=e(58029),O=e(41987),j=e(69129),B=e(19347),N=e(10154),I=e(32023);function K(ge,Se){Se.app=O.Jk.Dashboard,Se.canAddAnnotations=()=>{const De=(0,o.YQ)(ge);return!w(De)||!De.canEditDashboard()?!1:!!De.state.meta.annotationsPermissions?.dashboard.canAdd},Se.canEditAnnotations=De=>{const Ke=(0,o.YQ)(ge);return Ke.canEditDashboard()?De?!!Ke.state.meta.annotationsPermissions?.dashboard.canEdit:!!Ke.state.meta.annotationsPermissions?.organization.canEdit:!1},Se.canDeleteAnnotations=De=>{const Ke=(0,o.YQ)(ge);return Ke.canEditDashboard()?De?!!Ke.state.meta.annotationsPermissions?.dashboard.canDelete:!!Ke.state.meta.annotationsPermissions?.organization.canDelete:!1},Se.onAnnotationCreate=async De=>{const Ke=(0,o.YQ)(ge),Me=De.from!==De.to,be={dashboardUID:Ke.state.uid,panelId:(0,o.Cs)(ge),isRegion:Me,time:De.from,timeEnd:Me?De.to:0,tags:De.tags,text:De.description};await(0,N.vJ)(be),U(Ke),Se.eventBus.publish(new j.We(be))},Se.onAnnotationUpdate=async De=>{const Ke=(0,o.YQ)(ge),Me=De.from!==De.to,be={id:De.id,dashboardUID:Ke.state.uid,panelId:(0,o.Cs)(ge),isRegion:Me,time:De.from,timeEnd:Me?De.to:0,tags:De.tags,text:De.description};await(0,N.rJ)(be),U(Ke),Se.eventBus.publish(new j.We(be))},Se.onAnnotationDelete=async De=>{await(0,N.Xm)({id:De}),U((0,o.YQ)(ge)),Se.eventBus.publish(new j.We({id:De}))},Se.onAddAdHocFilter=De=>{const Ke=(0,o.YQ)(ge),Me=(0,o.un)(ge);if(!Me)return;const be=W(Ke,Me.state.datasource);H(be,De)},Se.onUpdateData=De=>Promise.resolve(!0)}function w(ge){const Se=I.b4.getDataLayers(ge);for(const De of Se.state.annotationLayers)if(De instanceof r.tV.g&&De.state.isEnabled&&De.state.query.builtIn)return De}function U(ge){const Se=w(ge);Se&&Se.runLayer()}function W(ge,Se){const De=r.jh.getVariables(ge);for(const Me of De.state.variables)if(r.Go.isAdHocVariable(Me)){const be=Me.state.datasource;if(be===Se||be?.uid===Se?.uid)return Me}const Ke=new r.H9({name:"Filters",datasource:Se,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(Se)?.meta.multiValueFilterOperators,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0});return De.setState({variables:[...De.state.variables,Ke]}),Ke}function H(ge,Se){for(const De of ge.state.filters)if(De.key===Se.key){ge.setState({filters:ge.state.filters.map(Ke=>Ke.key===Se.key?Se:Ke)});return}ge.setState({filters:[...ge.state.filters,Se]})}var z=e(96556),G=e(27734),M=e(7758),Q=e(62467),Y=e(81160);class q extends r.n8{constructor(Se){super({name:"",type:"snapshot",isReadOnly:!0,query:"",value:"",text:"",options:[],...Se}),this._variableDependency=new r.Sh(this,{statePaths:[]})}getValueOptions(Se){const Me=(r.jh.interpolate(this,this.state.query).match(/(?:\\,|[^,])+/g)??[]).map(be=>{be=be.replace(/\\,/g,",");const we=/^(.+)\s:\s(.+)$/g.exec(be)??[];if(we.length===3){const[,Be,He]=we;return{label:Be.trim(),value:He.trim()}}else return{label:be.trim(),value:be.trim()}});return(0,Q.of)(Me)}validateAndUpdate(){return this.getValueOptions({}).pipe((0,Y.T)(Se=>(this.state.options!==Se&&this._updateValueGivenNewOptions(Se),{})))}static{this.Component=({model:Se})=>(0,r.yC)(Se)}_updateValueGivenNewOptions(Se){const{value:De,text:Ke}=this.state,Me={options:Se,loading:!1,value:De??[],text:Ke??[]};this.setState(Me)}}const te="default";function X(ge){const Se=ge.templating.list.map(De=>{try{return Z(De)}catch(Ke){return console.error(Ke),null}}).filter(De=>!!De);return new r.Pj({variables:Se})}function ee(ge){const Se=ge.templating.list.map(De=>{try{return De.type==="adhoc"?new r.H9({name:De.name,label:De.label,readOnly:!0,description:De.description,skipUrlSync:De.skipUrlSync,hide:De.hide,datasource:De.datasource,applyMode:"auto",filters:De.filters??[],baseFilters:De.baseFilters??[],defaultKeys:De.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(De.datasource)?.meta.multiValueFilterOperators}):ne(De)}catch(Ke){return console.error(Ke),null}}).filter(De=>!!De);return new r.Pj({variables:Se})}function ne(ge){let Se,De;if(ge.type==="interval"){const Ke=(0,o.Sm)(ge.query),Me=(0,o.pk)(ge,Ke);return Se=new q({name:ge.name,label:ge.label,description:ge.description,value:Me,text:Me,hide:ge.hide}),Se}return ge.type==="system"||ge.type==="constant"||ge.type==="adhoc"?De={value:"",text:""}:De={value:ge.current?.value??"",text:ge.current?.text??""},Se=new q({name:ge.name,label:ge.label,description:ge.description,value:De?.value??"",text:De?.text??"",hide:ge.hide}),Se}function Z(ge){const Se={name:ge.name,label:ge.label,description:ge.description};if(ge.type==="adhoc")return new r.H9({...Se,description:ge.description,skipUrlSync:ge.skipUrlSync,hide:ge.hide,datasource:ge.datasource,applyMode:"auto",filters:ge.filters??[],baseFilters:ge.baseFilters??[],defaultKeys:ge.defaultKeys,useQueriesAsFilterForOptions:!0,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0,supportsMultiValueOperators:!!(0,B.l)().getInstanceSettings(ge.datasource)?.meta.multiValueFilterOperators});if(ge.type==="custom")return new r.yP({...Se,value:ge.current?.value??"",text:ge.current?.text??"",query:ge.query,isMulti:ge.multi,allValue:ge.allValue||void 0,includeAll:ge.includeAll,defaultToAll:!!ge.includeAll,skipUrlSync:ge.skipUrlSync,hide:ge.hide});if(ge.type==="query")return new r.fS({...Se,value:ge.current?.value??"",text:ge.current?.text??"",query:ge.query,datasource:ge.datasource,sort:ge.sort,refresh:ge.refresh,regex:ge.regex,allValue:ge.allValue||void 0,includeAll:ge.includeAll,defaultToAll:!!ge.includeAll,isMulti:ge.multi,skipUrlSync:ge.skipUrlSync,hide:ge.hide,definition:ge.definition});if(ge.type==="datasource")return new r.mI({...Se,value:ge.current?.value??"",text:ge.current?.text??"",regex:ge.regex,pluginId:ge.query,allValue:ge.allValue||void 0,includeAll:ge.includeAll,defaultToAll:!!ge.includeAll,skipUrlSync:ge.skipUrlSync,isMulti:ge.multi,hide:ge.hide,defaultOptionEnabled:ge.current?.value===te&&ge.current?.text==="default"});if(ge.type==="interval"){const De=(0,o.Sm)(ge.query),Ke=(0,o.pk)(ge,De);return new r.Yj({...Se,value:Ke,intervals:De,autoEnabled:ge.auto,autoStepCount:ge.auto_count,autoMinInterval:ge.auto_min,refresh:ge.refresh,skipUrlSync:ge.skipUrlSync,hide:ge.hide})}else{if(ge.type==="constant")return new r.x0({...Se,value:ge.query,skipUrlSync:ge.skipUrlSync,hide:ge.hide});if(ge.type==="textbox"){let De;return ge?.current?.value?typeof ge.current.value=="string"?De=ge.current.value:De=ge.current.value[0]:De=ge.query,new r.TS({...Se,value:De,skipUrlSync:ge.skipUrlSync,hide:ge.hide})}else{if(n.$.featureToggles.groupByVariable&&ge.type==="groupby")return new r.ZG({...Se,datasource:ge.datasource,value:ge.current?.value||[],text:ge.current?.text||[],skipUrlSync:ge.skipUrlSync,hide:ge.hide,defaultOptions:ge.options});throw new Error(`Scenes: Unsupported variable type ${ge.type}`)}}}var ae=e(84423);function re(ge){return function(De,Ke){if(Ke.angularPanelCtrl){De.options={angularOptions:ge.getOptionsToRemember()};return}if(!ge.options||Object.keys(ge.options).length===0){(0,t.defaults)(De,ge.getOptionsToRemember());const Me=(0,t.cloneDeep)(ge.targets);Object.defineProperty(De,"targets",{get:function(){return console.warn("Accessing the targets property when migrating a panel plugin is deprecated. Changes to this property will be ignored."),Me}})}if(ge.autoMigrateFrom){const Me=ae.NB[ge.autoMigrateFrom]!=null,be=ge.getOptionsToRemember(),we=ge.autoMigrateFrom;if(Ke.onPanelTypeChanged){const Be=Me?{angular:be}:be.options;Object.assign(De.options,Ke.onPanelTypeChanged(De,we,Be,De.fieldConfig))}}}}var se=e(70665);function de(ge){const Se=new s.G(ge.dashboard,ge.meta),De=ie(Se,ge.dashboard);return De.setInitialSaveModel(ge.dashboard),De}function le(ge){const Se=[];let De=null,Ke=[];for(const Me of ge)if(Me.type==="row")De?De.id!==Me.id&&(Se.push(he(De,Ke)),Me.collapsed?(Se.push(he(Me,[])),De=null):De=Me,Ke=[]):Me.collapsed?Se.push(he(Me,[])):De=Me;else{Me.snapshotData&&Pe(Me);const be=J(Me);De?Ke.push(be):Se.push(be)}return De&&Se.push(he(De,Ke)),Se}function he(ge,Se){ge.collapsed&&ge.panels&&(Se=ge.panels.map(Me=>(Me instanceof s.a||(Me=new s.a(Me)),J(Me))));let De,Ke=Se;return ge.repeat&&(De=[new T.L({variableName:ge.repeat})]),new r.tI({key:(0,o.XA)(ge.id),title:ge.title,y:ge.gridPos.y,isCollapsed:ge.collapsed,children:Ke,$behaviors:De,actions:new S.u({})})}function ie(ge,Se){let De,Ke=[],Me;ge.templating?.list?.length?ge.meta.isSnapshot?De=ee(ge):De=X(ge):De=new r.Pj({variables:[]}),ge.annotations?.list?.length&&!ge.isSnapshot()&&(Ke=ge.annotations?.list.map(Be=>new g.g({key:(0,t.uniqueId)("annotations-"),query:Be,name:Be.name,isEnabled:!!Be.enable,isHidden:!!Be.hide})));let be=n.$.unifiedAlertingEnabled;return be||ge.panels.find(Be=>!!Be.alert)&&(be=!0),be&&(Me=new a.C({key:"alert-states",name:"Alert States"})),new p.H$({description:ge.description,editable:ge.editable,preload:Se.preload??!1,id:ge.id,isDirty:!1,links:ge.links||[],meta:ge.meta,tags:ge.tags||[],title:ge.title,uid:ge.uid,version:ge.version,body:new R.D({grid:new r.hy({isLazy:!Se.preload,children:le(ge.panels),$behaviors:[Ie]})}),$timeRange:new r.JZ({from:ge.time.from,to:ge.time.to,fiscalYearStartMonth:ge.fiscalYearStartMonth,timeZone:ge.timezone,weekStart:ge.weekStart,UNSAFE_nowDelay:ge.timepicker?.nowDelay}),$variables:De,$behaviors:[new r.Gg.K2({sync:ge.graphTooltip}),new r.Gg.Hf,c,ce,new r.Gg.en({enabled:ge.liveNow}),G.zf,new f({reloadOnScopesChange:ge.meta.reloadOnScopesChange,uid:ge.uid})],$data:new l.s({annotationLayers:Ke,alertStatesLayer:Me}),controls:new i.x({variableControls:[new r.K8({}),new r.i7],timePicker:new r.KE({}),refreshPicker:new r.WM({refresh:ge.refresh,intervals:ge.timepicker.refresh_intervals,withText:!0}),hideTimeControls:ge.timepicker.hidden})})}function J(ge){const Se=ge.repeat?{variableName:ge.repeat,repeatDirection:ge.repeatDirection==="v"?"v":"h"}:{},De=[];n.$.featureToggles.angularDeprecationUI&&De.push(new A.$L),De.push(new P.$({rawLinks:ge.links,menu:new P.m({$behaviors:[m.oV]})})),De.push(new E);const Ke={key:(0,o.XA)(ge.id),title:ge.title,description:ge.description,pluginId:ge.type??"timeseries",options:ge.options??{},fieldConfig:ge.fieldConfig,pluginVersion:ge.pluginVersion,displayMode:ge.transparent?"transparent":void 0,hoverHeader:!ge.title&&!ge.timeFrom&&!ge.timeShift,hoverHeaderOffset:0,$data:(0,z.w)(ge),titleItems:De,$behaviors:[],extendPanelContext:K,_UNSAFE_customMigrationHandler:re(ge)};ge.libraryPanel&&(Ke.$behaviors.push(new v.u({uid:ge.libraryPanel.uid,name:ge.libraryPanel.name})),Ke.pluginId=v.u.LOADING_VIZ_PANEL_PLUGIN_ID,Ke.$data=void 0),n.$.publicDashboardAccessToken||(Ke.menu=new r.Lw({$behaviors:[m._i]})),(ge.timeFrom||ge.timeShift)&&(Ke.$timeRange=new b.v({timeFrom:ge.timeFrom,timeShift:ge.timeShift,hideTimeOverride:ge.hideTimeOverride}));const Me=new r.Eb(Ke);return new d.U({key:`grid-item-${ge.id}`,x:ge.gridPos.x,y:ge.gridPos.y,width:Se.repeatDirection==="h"?24:ge.gridPos.w,height:ge.gridPos.h,itemHeight:ge.gridPos.h,body:Me,maxPerRow:ge.maxPerRow,...Se})}function ce(ge){ge.subscribeToEvent(r.Kw,Se=>{const{interaction:De}=Se.payload;switch(De){case"panel-status-message-clicked":M.c.panelStatusMessageClicked();break;case"panel-cancel-query-clicked":M.c.panelCancelQueryClicked();break}})}const pe=ge=>ge.map(Se=>({data:{values:Se.fields.map(De=>De.values).filter(De=>De!==void 0)},schema:{fields:Se.fields.map(De=>({name:De.name,type:De.type,config:De.config}))}})),Pe=ge=>{ge.snapshotData&&(ge.datasource=se.x,ge.targets=[{refId:ge.snapshotData[0]?.refId??"",datasource:ge.datasource,queryType:"snapshot",snapshot:pe(ge.snapshotData)}],ge.snapshotData=[])};function Ie(ge){(0,o.YQ)(ge).setState({isEmpty:ge.state.children.length===0});const Se=ge.subscribeToState((De,Ke)=>{(De.children.length!==Ke.children.length||De.children!==Ke.children)&&(0,o.YQ)(ge).setState({isEmpty:De.children.length===0})});return()=>{Se.unsubscribe()}}},20455:(_,L,e)=>{"use strict";e.d(L,{Uy:()=>x,Z6:()=>C,ZB:()=>E,c:()=>R});var t=e(2543),n=e.n(t),r=e(92041),s=e(81887),a=e(79422),g=e(73134),i=e(28874),l=e(18803),d=e(79056),o=e(68706),u=e(16279),c=e(41507),p=e(7928),h=e(79284),y=e(77517),f=e(32023),v=e(74730),P=e(70665),m=e(13989),D=e(53287);function x(O,j=!1){const B=O.state,N=B.$timeRange.state,I=B.$data,K=B.$variables,w=B.body;let U=[],W=[];if(w instanceof y.D){for(const te of w.state.grid.state.children)if(te instanceof c.U&&(te.state.variableName?U=U.concat(T(te,j)):U.push(E(te,j))),te instanceof s.tI){if(te.state.key.indexOf("-clone-")>0&&!j)continue;A(te,U,j)}}let H=[];I instanceof u.s&&(H=(0,m.O)(I.state.annotationLayers)),K instanceof s.Pj&&(W=(0,D.C)(K));const z=B.controls?.state,G=z?.refreshPicker,M=S({refresh_intervals:G?.state.intervals,hidden:z?.hideTimeControls,nowDelay:N.UNSAFE_nowDelay},a.lt),Q=B.$behaviors?.find(te=>te instanceof s.Gg.K2)?.state.sync??a.Ye.graphTooltip,Y=B.$behaviors?.find(te=>te instanceof s.Gg.en)?.isEnabled||void 0,q={...a.Ye,title:B.title,description:B.description||void 0,uid:B.uid,id:B.id,editable:B.editable,preload:B.preload,time:{from:N.from,to:N.to},timepicker:M,panels:U,annotations:{list:H},templating:{list:W},version:B.version,timezone:N.timeZone,fiscalYearStartMonth:N.fiscalYearStartMonth,weekStart:N.weekStart,tags:B.tags,links:B.links,graphTooltip:Q,liveNow:Y,schemaVersion:d.O2,refresh:G?.state.refresh};return(0,i.v)(q)}function E(O,j=!1){let B,N=0,I=0,K=0,w=0,U=O;if(!(U.state.body instanceof s.Eb))throw new Error("DashboardGridItem body expected to be VizPanel");if(B=U.state.body,N=U.state.x??0,I=U.state.y??0,K=U.state.width??0,w=(U.state.variableName?U.state.itemHeight:U.state.height)??0,!B)throw new Error("Unsupported grid item type");return C(B,{x:N,y:I,h:w,w:K},j,U)}function C(O,j,B=!1,N){let I;if((0,v.ME)(O)){const U=(0,v.iL)(O);return I={id:(0,v.Cs)(O),title:U.state.title,gridPos:j,libraryPanel:{name:U.state.name,uid:U.state.uid}},I}else I={id:(0,v.Cs)(O),type:O.state.pluginId,title:O.state.title,description:O.state.description??void 0,gridPos:j,fieldConfig:O.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:O.state.displayMode==="transparent",pluginVersion:O.state.pluginVersion,...b(O,B)};if(O.state.options){const{angularOptions:U,...W}=O.state.options;I.options=W,U&&(0,t.defaults)(I,U)}const K=O.state.$timeRange;K instanceof p.v&&(I.timeFrom=K.state.timeFrom,I.timeShift=K.state.timeShift,I.hideTimeOverride=K.state.hideTimeOverride),N instanceof c.U&&(N.state.variableName&&(I.repeat=N.state.variableName),N.state.maxPerRow&&(I.maxPerRow=N.state.maxPerRow),N.state.repeatDirection&&(I.repeatDirection=N.getRepeatDirection()));const w=f.b4.getPanelLinks(O);return I.links=w?.state.rawLinks??[],I.links.length===0&&delete I.links,I.transformations?.length===0&&delete I.transformations,I.transparent||delete I.transparent,I}function b(O,j=!1){const B=O.state.$data,N={},I=(0,v.un)(O);if(I&&(N.targets=I.state.queries,N.maxDataPoints=I.state.maxDataPoints,N.datasource=I.state.datasource,I.state.cacheTimeout&&(N.cacheTimeout=I.state.cacheTimeout),I.state.queryCachingTTL&&(N.queryCachingTTL=I.state.queryCachingTTL),I.state.minInterval&&(N.interval=I.state.minInterval)),B instanceof s.Es&&(N.transformations=B.state.transformations),B&&j){N.datasource=P.x;let K=(0,l.B6)(B.state.data);B instanceof s.Es&&(K=(0,l.B6)(B.state.$data.state.data)),N.targets=[{refId:"A",datasource:N.datasource,queryType:o.nj.Snapshot,snapshot:K}]}return N}function T(O,j=!1){if(j){if(O.state.body instanceof s.Eb&&(0,v.ME)(O.state.body)){const{x:B=0,y:N=0,width:I=0,height:K=0}=O.state;return[C(O.state.body,{x:B,y:N,w:I,h:K},j)]}if(O.state.repeatedPanels){const B=O.state.itemHeight??10,N=Math.ceil(O.state.repeatedPanels.length/O.getMaxPerRow()),I=Math.ceil(O.state.repeatedPanels.length/N),K=24/I,w=B;return O.state.repeatedPanels.map((W,H)=>{let z=0,G=0;O.state.repeatDirection==="v"?(z=O.state.x,G=H*w):(z=H%I*K,G=O.state.y+Math.floor(H/I)*w);const M={x:z,y:G,w:K,h:w},Q=W.state.$variables.getByName(O.state.variableName);return{id:(0,v.Cs)(W),type:W.state.pluginId,title:W.state.title,gridPos:M,options:W.state.options,fieldConfig:W.state.fieldConfig??{defaults:{},overrides:[]},transformations:[],transparent:W.state.displayMode==="transparent",scopedVars:{[O.state.variableName]:{text:Q?.state.text,value:Q?.state.value}},...b(W,j)}})}return[]}else return[E(O)]}function A(O,j,B=!1){const N=!!O.state.isCollapsed,I={type:"row",id:(0,v.Cs)(O),title:O.state.title,gridPos:{x:O.state.x??0,y:O.state.y??0,w:O.state.width??24,h:O.state.height??1},collapsed:N,panels:[]};if(O.state.$behaviors?.length){const w=O.state.$behaviors[0];w instanceof h.L&&(I.repeat=w.state.variableName)}if(B&&O.state.$variables){const U=O.state.$variables.state.variables.reduce((W,H)=>({...W,[H.state.name]:{text:H.state.text,value:H.state.value}}),{});I.scopedVars=U}j.push(I);let K=[];B?O.state.children.forEach(w=>{w instanceof c.U&&(w.state.variableName?K=K.concat(T(w,!N)):K.push(E(w,!N)))}):K=O.state.children.map(w=>{if(!(w instanceof c.U))throw new Error("Row child expected to be DashboardGridItem");return E(w)}),O.state.isCollapsed?I.panels=K:j.push(...K)}function R(O,j,B,N){let I={...B,title:O,time:{from:j.from.toISOString(),to:j.to.toISOString()},links:[]};if(N){const K=B.panels?.find(w=>w.id===(0,v.Cs)(N));K&&(K.gridPos={w:24,x:0,y:0,h:20},I={...I,panels:[K]})}if(I.panels?.forEach(K=>{"links"in K&&(K.links=[])}),I.annotations){const w=(I.annotations.list?.filter(U=>U.enable)||[]).map(U=>({name:U.name,enable:U.enable,iconColor:U.iconColor,type:U.type,builtIn:U.builtIn,hide:U.hide,snapshotData:[]}));I.annotations.list=w}return I.templating&&I.templating.list?.forEach(K=>{"query"in K&&(K.query=""),"options"in K&&(K.options=K.current&&!(0,r.R)(K.current)?[K.current]:[]),"refresh"in K&&(K.refresh=g.CO.never)}),I}function S(O,j){const B={...O};for(const N in j)(0,t.isEqual)(B[N],j[N])&&delete B[N];return B}},24466:(_,L,e)=>{"use strict";e.d(L,{c:()=>h,h:()=>y});var t=e(74848),n=e(42941),r=e(41053),s=e(13544),a=e(14110),g=e(32264),i=e(55852),l=e(96374),d=e(94753),o=e(68402),u=e(37390),c=e(8484),p=e(55314);function h({dashboard:v}){const[P,m]=(0,n.A)(!1),[D]=(0,p.uz)(),[,x]=(0,r.A)(async()=>{(0,a.rR)("grafana_manage_dashboards_delete_clicked",{item_counts:{dashboard:1},source:"dashboard_scene_settings",restore_enabled:g.$.featureToggles.dashboardRestoreUI}),m(),v.state.uid&&await D({selectedItems:{dashboard:{[v.state.uid]:!0},folder:{}}}),await v.onDashboardDelete()},[v,m]);return v.state.meta.provisioned&&P?(0,t.jsx)(f,{dashboardId:v.state.meta.provisionedExternalId,onClose:m}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.$n,{variant:"destructive",onClick:m,"data-testid":s.Tp.pages.Dashboard.Settings.General.deleteDashBoard,children:(0,t.jsx)(c.x6,{i18nKey:"dashboard-settings.dashboard-delete-button",children:"Delete dashboard"})}),P&&(0,t.jsx)(y,{dashboardTitle:v.state.title,onConfirm:x,onClose:m})]})}function y({dashboardTitle:v,onConfirm:P,onClose:m}){return(0,t.jsx)(l.u,{isOpen:!0,body:(0,t.jsxs)(t.Fragment,{children:[g.$.featureToggles.dashboardRestore&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(c.x6,{i18nKey:"dashboard-settings.delete-modal-restore-dashboards-text",children:"This action will mark the dashboard for deletion in 30 days. Your organization administrator can restore it anytime before the 30 days expire."})}),(0,t.jsx)(o.$,{v:1})]}),(0,t.jsx)(d.E,{element:"p",children:(0,t.jsx)(c.x6,{i18nKey:"dashboard-settings.delete-modal-text",children:"Do you want to delete this dashboard?"})}),(0,t.jsx)(d.E,{element:"p",children:v}),(0,t.jsx)(o.$,{v:2})]}),onConfirm:P,onDismiss:m,title:(0,c.t)("dashboard-settings.delete-modal.title","Delete"),icon:"trash-alt",confirmText:(0,c.t)("dashboard-settings.delete-modal.delete-button","Delete"),confirmationText:(0,c.t)("dashboard-settings.delete-modal.confirmation-text","Delete")})}function f({dashboardId:v,onClose:P}){return(0,t.jsxs)(u.a,{isOpen:!0,title:"Cannot delete provisioned dashboard",icon:"trash-alt",onDismiss:P,children:[(0,t.jsx)("p",{children:"This dashboard is managed by Grafana provisioning and cannot be deleted. Remove the dashboard from the config file to delete it."}),(0,t.jsxs)("p",{children:[(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{}),"File path: ",v]}),(0,t.jsx)(u.a.ButtonRow,{children:(0,t.jsx)(i.$n,{variant:"primary",onClick:P,children:"OK"})})]})}},46502:(_,L,e)=>{"use strict";e.d(L,{F:()=>a});var t=e(74848),n=e(96540),r=e(32264),s=e(7376);class a extends n.PureComponent{constructor(){super(...arguments),this.ref=null}componentWillUnmount(){this.angularComponent&&this.angularComponent.destroy()}componentDidMount(){const i=r.$.angularSupportEnabled;this.ref&&i&&this.loadAngular()}componentDidUpdate(i){i.datasource!==this.props.datasource&&this.loadAngular(),this.scopeProps&&this.scopeProps.ctrl.currentAnnotation!==this.props.annotation&&(this.scopeProps.ctrl.ignoreNextWatcherFiring=!0,this.scopeProps.ctrl.currentAnnotation=this.props.annotation,this.angularComponent?.digest())}loadAngular(){this.angularComponent&&(this.angularComponent.destroy(),this.scopeProps=void 0);const i=(0,s.E)(),l='<plugin-component type="annotations-query-ctrl"> </plugin-component>',d={ctrl:{currentDatasource:this.props.datasource,currentAnnotation:this.props.annotation,ignoreNextWatcherFiring:!1}};this.angularComponent=i.load(this.ref,d,l),this.angularComponent.digest(),this.angularComponent.getScope().$watch(()=>{if(d.ctrl.ignoreNextWatcherFiring){d.ctrl.ignoreNextWatcherFiring=!1;return}this.props.onChange(d.ctrl.currentAnnotation)}),this.scopeProps=d}render(){return(0,t.jsx)("div",{ref:i=>this.ref=i})}}},65857:(_,L,e)=>{"use strict";e.d(L,{d:()=>c});var t=e(74848),n=e(88575),r=e(10354),s=e(90182),a=e(79924),g=e(57418),i=e(10880),l=e(55852),d=e(4588);const o=[{value:"dashboards",label:"Dashboards"},{value:"link",label:"Link"}],u=Object.keys(d.G).map(p=>({label:p,value:p}));function c({link:p,onUpdate:h,onGoBack:y}){const f=x=>{h({...p,tags:x})},v=x=>{const E={...p,type:x.value};E.type==="dashboards"?(E.url="",E.tooltip=""):E.tags=[],h(E)},P=x=>{h({...p,icon:x.value})},m=x=>{const E=x.currentTarget;h({...p,[E.name]:E.type==="checkbox"?E.checked:E.value})},D=p.title===d.q.title;return(0,t.jsxs)("div",{style:{maxWidth:"600px"},children:[(0,t.jsx)(n.D,{label:"Title",children:(0,t.jsx)(r.p,{name:"title",id:"title",value:p.title,onChange:m,autoFocus:D})}),(0,t.jsx)(n.D,{label:"Type",children:(0,t.jsx)(s.l6,{inputId:"link-type-input",value:p.type,options:o,onChange:v})}),p.type==="dashboards"&&(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(n.D,{label:"With tags",children:(0,t.jsx)(a.u,{tags:p.tags,onChange:f})})}),p.type==="link"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.D,{label:"URL",children:(0,t.jsx)(r.p,{name:"url",value:p.url,onChange:m})}),(0,t.jsx)(n.D,{label:"Tooltip",children:(0,t.jsx)(r.p,{name:"tooltip",value:p.tooltip,onChange:m,placeholder:"Open dashboard"})}),(0,t.jsx)(n.D,{label:"Icon",children:(0,t.jsx)(s.l6,{value:p.icon,options:u,onChange:P})})]}),(0,t.jsxs)(g.M,{label:"Options",isOpen:!0,children:[p.type==="dashboards"&&(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Show as dropdown",name:"asDropdown",value:p.asDropdown,onChange:m})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Include current time range",name:"keepTime",value:p.keepTime,onChange:m})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Include current template variable values",name:"includeVars",value:p.includeVars,onChange:m})}),(0,t.jsx)(n.D,{children:(0,t.jsx)(i.S,{label:"Open link in new tab",name:"targetBlank",value:p.targetBlank,onChange:m})})]}),(0,t.jsx)(l.$n,{variant:"secondary",onClick:y,children:"Back to list"})]})}},6199:(_,L,e)=>{"use strict";e.d(L,{X:()=>p});var t=e(74848),n=e(32196),r=e(40845),s=e(67061),a=e(69529),g=e(55852),i=e(72109),l=e(14578),d=e(64149),o=e(29158),u=e(91605),c=e(8484);function p({links:y,onNew:f,onOrderChange:v,onEdit:P,onDuplicate:m,onDelete:D}){const x=(0,r.of)(h);return y.length===0?(0,t.jsx)(s.B,{direction:"column",children:(0,t.jsx)(a.p,{variant:"call-to-action",button:(0,t.jsx)(g.$n,{onClick:f,size:"lg",children:(0,t.jsx)(c.x6,{i18nKey:"dashboard-links.empty-state.button-title",children:"Add dashboard link"})}),message:(0,c.t)("dashboard-links.empty-state.title","There are no dashboard links added yet"),children:(0,t.jsxs)(c.x6,{i18nKey:"dashboard-links.empty-state.info-box-content",children:["Dashboard links allow you to place links to other dashboards and web sites directly below the dashboard header."," ",(0,t.jsx)(i.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-dashboard-links/",children:"Learn more"})]})})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("table",{role:"grid",className:"filter-table filter-table--hover",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"Type"}),(0,t.jsx)("th",{children:"Info"}),(0,t.jsx)("th",{colSpan:3})]})}),(0,t.jsx)("tbody",{children:y.map((C,b)=>(0,t.jsxs)("tr",{children:[(0,t.jsxs)("td",{role:"gridcell",className:"pointer",onClick:()=>P(b),children:[(0,t.jsx)(l.I,{name:"external-link-alt"})," \xA0 ",C.type]}),(0,t.jsx)("td",{role:"gridcell",className:"pointer",onClick:()=>P(b),children:(0,t.jsxs)(s.B,{children:[C.title&&(0,t.jsx)("span",{className:x.titleWrapper,children:C.title}),C.type==="link"&&(0,t.jsx)("span",{className:x.urlWrapper,children:C.url}),C.type==="dashboards"&&(0,t.jsx)(d.L,{tags:C.tags??[]})]})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:b!==0&&(0,t.jsx)(o.K,{name:"arrow-up",onClick:()=>v(b,-1),tooltip:"Move link up"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:y.length>1&&b!==y.length-1?(0,t.jsx)(o.K,{name:"arrow-down",onClick:()=>v(b,1),tooltip:"Move link down"}):null}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(o.K,{name:"copy",onClick:()=>m(C),tooltip:"Copy link"})}),(0,t.jsx)("td",{style:{width:"1%"},role:"gridcell",children:(0,t.jsx)(u.e,{"aria-label":`Delete link with title "${C.title}"`,size:"sm",onConfirm:()=>D(b)})})]},`${C.title}-${b}`))})]}),(0,t.jsx)(g.$n,{className:x.newLinkButton,icon:"plus",onClick:f,children:"New link"})]})}const h=y=>({titleWrapper:(0,n.css)({width:"20vw",textOverflow:"ellipsis",overflow:"hidden"}),urlWrapper:(0,n.css)({width:"40vw",textOverflow:"ellipsis",overflow:"hidden"}),newLinkButton:(0,n.css)({marginTop:y.spacing(3)})})},4588:(_,L,e)=>{"use strict";e.d(L,{G:()=>n,q:()=>t});const t={icon:"external link",title:"New link",tooltip:"",type:"dashboards",url:"",asDropdown:!1,tags:[],targetBlank:!1,keepTime:!1,includeVars:!1},n={"external link":"external-link-alt",dashboard:"apps",question:"question-circle",info:"info-circle",bolt:"bolt",doc:"file-alt",cloud:"cloud"}},27803:(_,L,e)=>{"use strict";e.d(L,{Q:()=>u});var t=e(74848),n=e(96540),r=e(72436),s=e(13544),a=e(88575),g=e(42418),i=e(15292),l=e(32372),d=e(51612),o=e(58975);function u({datasource:c,infoText:p,onDataSourceChange:h,onDefaultKeysChange:y,defaultKeys:f}){const v=(0,n.useCallback)(P=>{const m=(0,r.Jh)(`key,value
`+P)[0],D=[];for(let x=0;x<m.length;x++)D.push({text:m.fields[0].values[x],value:m.fields[1].values[x]});y?.(D)},[y]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Y,{children:"Ad-hoc options"}),(0,t.jsx)(a.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(d.s,{current:c,onChange:h,width:30,variables:!0,noDefault:!0})}),p?(0,t.jsx)(g.F,{title:p,severity:"info","data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.infoText}):null,y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.D,{label:"Use static key dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,t.jsx)(i.d,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.AdHocFiltersVariable.modeToggle,value:f!==void 0,onChange:P=>{y(f===void 0?[]:void 0)}})}),f!==void 0&&(0,t.jsx)(l.B,{height:300,language:"csv",value:f.map(P=>`${P.text},${P.value}`).join(`
`),onBlur:v,onSave:v,showMiniMap:!1,showLineNumbers:!0})]})]})}},95802:(_,L,e)=>{"use strict";e.d(L,{d:()=>a});var t=e(74848),n=e(13544),r=e(58975),s=e(14329);function a({onChange:g,constantValue:i}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Y,{children:"Constant options"}),(0,t.jsx)(s._,{defaultValue:i,name:"Value",placeholder:"your metric prefix",onBlur:g,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.ConstantVariable.constantOptionsQueryInputV2,width:30})]})}},58711:(_,L,e)=>{"use strict";e.d(L,{w:()=>g});var t=e(74848),n=e(13544),r=e(58975),s=e(85140),a=e(94618);function g({query:i,multi:l,allValue:d,includeAll:o,onQueryChange:u,onMultiChange:c,onIncludeAllChange:p,onAllValueChange:h}){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.Y,{children:"Custom options"}),(0,t.jsx)(s.Z,{name:"Values separated by comma",defaultValue:i,placeholder:"1, 10, mykey : myvalue, myvalue, escaped\\,value",onBlur:u,required:!0,width:52,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.CustomVariable.customValueInput}),(0,t.jsx)(r.Y,{children:"Selection options"}),(0,t.jsx)(a.B,{multi:l,includeAll:o,allValue:d,onMultiChange:c,onIncludeAllChange:p,onAllValueChange:h})]})}},98917:(_,L,e)=>{"use strict";e.d(L,{y:()=>i});var t=e(74848),n=e(13544),r=e(94618),s=e(58975),a=e(89458),g=e(14329);function i({query:l,regex:d,optionTypes:o,onChange:u,onRegExBlur:c,multi:p,includeAll:h,allValue:y,onMultiChange:f,onIncludeAllChange:v,onAllValueChange:P}){const m=o.find(D=>D.value===l)??o[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Y,{children:"Data source options"}),(0,t.jsx)(a.v,{name:"Type",value:m,options:o,onChange:u,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.DatasourceVariable.datasourceSelect}),(0,t.jsx)(g._,{defaultValue:d,name:"Instance name filter",placeholder:"/.*-(.*)-.*/",onBlur:c,description:(0,t.jsxs)("div",{children:["Regex filter for which data source instances to choose from in the variable value list. Leave empty for all.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"/^prod/"})]})}),(0,t.jsx)(s.Y,{children:"Selection options"}),(0,t.jsx)(r.B,{multi:p,includeAll:h,allValue:y,onMultiChange:f,onIncludeAllChange:v,onAllValueChange:P})]})}},49317:(_,L,e)=>{"use strict";e.d(L,{s:()=>d});var t=e(74848),n=e(32196),r=e(13544),s=e(40845),a=e(99615),g=e(58975),i=e(89458),l=e(14329);function d({intervals:u,onIntervalsChange:c,onAutoEnabledChange:p,onAutoMinIntervalChanged:h,onAutoCountChanged:y,autoEnabled:f,autoMinInterval:v,autoStepCount:P}){const m=[1,2,3,4,5,10,20,30,40,50,100,200,300,400,500].map(E=>({label:`${E}`,value:E})),D=(0,s.of)(o),x=m.find(E=>E.value===P)??m[0];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.Y,{children:"Interval options"}),(0,t.jsx)(l._,{defaultValue:u,name:"Values",placeholder:"1m,10m,1h,6h,1d,7d",onBlur:c,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.intervalsValueInput,width:32,required:!0}),(0,t.jsx)(a.c,{value:f,name:"Auto option",description:"Dynamically calculates interval by dividing time range by the count specified",onChange:p,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.autoEnabledCheckbox}),f&&(0,t.jsxs)("div",{className:D.autoFields,children:[(0,t.jsx)(i.v,{name:"Step count",description:"How many times the current time range should be divided to calculate the value",value:x,options:m,onChange:y,width:9,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.stepCountIntervalSelect}),(0,t.jsx)(l._,{value:v,name:"Min interval",description:"The calculated value will not go below this threshold",placeholder:"10s",onChange:h,width:11,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.IntervalVariable.minIntervalInput})]})]})}const o=u=>({autoFields:(0,n.css)({marginTop:u.spacing(2),display:"flex",flexDirection:"column"})})},44890:(_,L,e)=>{"use strict";e.d(L,{u:()=>R});var t=e(74848),n=e(16817),r=e(13544),s=e(19347),a=e(88575),g=e(39070),i=e(72574),l=e(90613),d=e(94753),o=e(24240);function u({query:S,datasource:O,VariableQueryEditor:j,onLegacyQueryChange:B,onQueryChange:N,timeRange:I}){let K;return typeof S=="string"?K=S||(O.variables?.getDefaultQuery?.()??""):K={...O.variables?.getDefaultQuery?.(),...S},j&&(0,o.VN)(j,O)?(0,t.jsxs)(l.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(l.a,{marginTop:1,children:(0,t.jsx)(j,{datasource:O,query:K,templateSrv:(0,i.w)(),onChange:B},O.uid)})]}):j&&(0,o.CH)(j,O)?(0,t.jsxs)(l.a,{marginBottom:2,children:[(0,t.jsx)(d.E,{element:"h4",children:"Query"}),(0,t.jsx)(l.a,{marginTop:1,children:(0,t.jsx)(j,{datasource:O,query:K,onChange:N,onRunQuery:()=>{},data:{series:[],state:g.Gu.Done,timeRange:I},range:I,onBlur:()=>{},history:[]},O.uid)})]}):null}var c=e(94618),p=e(51612),h=e(70766),y=e(96540),f=e(12470),v=e(40845),P=e(94354),m=e(60619);const D=[{label:"On dashboard load",value:f.CO.onDashboardLoad},{label:"On time range change",value:f.CO.onTimeRangeChanged}];function x({onChange:S,refresh:O,testId:j}){const B=(0,v.$j)(),[N,I]=(0,y.useState)(!1);(0,m.Y)({breakpoint:B.breakpoints.values.sm,onChange:w=>{I(!w.matches)}});const K=(0,y.useMemo)(()=>D.find(w=>w.value===O)?.value??D[0].value,[O]);return(0,t.jsx)(a.D,{label:"Refresh",description:"When to update the values of this variable","data-testid":j,children:(0,t.jsx)(P.z,{options:D,onChange:S,value:K,size:N?"sm":"md"})})}var E=e(89458);const C=[{label:"Disabled",value:f.ZG.disabled},{label:"Alphabetical (asc)",value:f.ZG.alphabeticalAsc},{label:"Alphabetical (desc)",value:f.ZG.alphabeticalDesc},{label:"Numerical (asc)",value:f.ZG.numericalAsc},{label:"Numerical (desc)",value:f.ZG.numericalDesc},{label:"Alphabetical (case-insensitive, asc)",value:f.ZG.alphabeticalCaseInsensitiveAsc},{label:"Alphabetical (case-insensitive, desc)",value:f.ZG.alphabeticalCaseInsensitiveDesc},{label:"Natural (asc)",value:f.ZG.naturalAsc},{label:"Natural (desc)",value:f.ZG.naturalDesc}];function b({onChange:S,sort:O,testId:j}){const B=(0,y.useMemo)(()=>C.find(N=>N.value===O)??C[0],[O]);return(0,t.jsx)(E.v,{name:"Sort",description:"How to sort the values of this variable",value:B,options:C,onChange:S,testId:j,width:25})}var T=e(58975),A=e(85140);function R({datasource:S,onDataSourceChange:O,query:j,onQueryChange:B,onLegacyQueryChange:N,timeRange:I,regex:K,onRegExChange:w,sort:U,onSortChange:W,refresh:H,onRefreshChange:z,isMulti:G,onMultiChange:M,includeAll:Q,onIncludeAllChange:Y,allValue:q,onAllValueChange:te}){const{value:X}=(0,n.A)(async()=>{const Z=await(0,s.l)().get(S??""),ae=await(0,h.y)(Z);return{datasource:Z,VariableQueryEditor:ae}},[S]),{datasource:ee,VariableQueryEditor:ne}=X??{};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(T.Y,{children:"Query options"}),(0,t.jsx)(a.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,t.jsx)(p.s,{current:S,onChange:O,variables:!0,width:30})}),ee&&ne&&(0,t.jsx)(u,{onQueryChange:B,onLegacyQueryChange:N,datasource:ee,query:j,VariableQueryEditor:ne,timeRange:I}),(0,t.jsx)(A.Z,{defaultValue:K??"",name:"Regex",description:(0,t.jsxs)("div",{children:["Optional, if you want to extract part of a series name or metric node segment.",(0,t.jsx)("br",{}),"Named capture groups can be used to separate the display text and value (",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/variables/filter-variables-with-regex#filter-and-modify-using-named-text-and-value-capture-groups",target:"__blank",children:"see examples"}),")."]}),placeholder:"/.*-(?<text>.*)-(?<value>.*)-.*/",onBlur:w,testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRegExInputV2,width:52}),(0,t.jsx)(b,{testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsSortSelectV2,onChange:W,sort:U}),(0,t.jsx)(x,{testId:r.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsRefreshSelectV2,onChange:z,refresh:H}),(0,t.jsx)(T.Y,{children:"Selection options"}),(0,t.jsx)(c.B,{multi:!!G,includeAll:!!Q,allValue:q,onMultiChange:M,onIncludeAllChange:Y,onAllValueChange:te})]})}},94618:(_,L,e)=>{"use strict";e.d(L,{B:()=>g});var t=e(74848),n=e(13544),r=e(67061),s=e(99615),a=e(14329);function g({multi:i,includeAll:l,allValue:d,onMultiChange:o,onIncludeAllChange:u,onAllValueChange:c}){return(0,t.jsxs)(r.B,{direction:"column",gap:2,height:"inherit",alignItems:"start",children:[(0,t.jsx)(s.c,{value:i,name:"Multi-value",description:"Enables multiple values to be selected at the same time",onChange:o,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsMultiSwitch}),(0,t.jsx)(s.c,{value:l,name:"Include All option",description:"Enables an option to include all variables",onChange:u,testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsIncludeAllSwitch}),l&&(0,t.jsx)(a._,{defaultValue:d??"",onBlur:c,name:"Custom all value",placeholder:"blank = auto",testId:n.Tp.pages.Dashboard.Settings.Variables.Edit.General.selectionOptionsCustomAllInput})]})}},99615:(_,L,e)=>{"use strict";e.d(L,{c:()=>s});var t=e(74848),n=e(92145),r=e(10880);function s({value:a,name:g,description:i,onChange:l,ariaLabel:d,testId:o}){const u=(0,n.Bi)();return(0,t.jsx)(r.S,{id:u,label:g,description:i,value:a,onChange:l,"aria-label":d,"data-testid":o})}},8964:(_,L,e)=>{"use strict";e.d(L,{D:()=>i});var t=e(74848),n=e(96540),r=e(12470),s=e(88575),a=e(94354);const g=[{label:"Label and value",value:r.zL.dontHide},{label:"Value",value:r.zL.hideLabel},{label:"Nothing",value:r.zL.hideVariable}];function i({onChange:l,hide:d,type:o}){const u=(0,n.useMemo)(()=>g.find(c=>c.value===d)?.value??g[0].value,[d]);return o==="constant"?null:(0,t.jsx)(s.D,{label:"Show on dashboard",children:(0,t.jsx)(a.z,{options:g,onChange:l,value:u})})}},58975:(_,L,e)=>{"use strict";e.d(L,{Y:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(17408);function a({className:i,...l}){const d=(0,r.of)(g);return(0,t.jsx)(s.s,{...l,className:(0,n.cx)(d.legend,i)})}function g(i){return{legend:(0,n.css)({marginTop:i.spacing(3),marginBottom:i.spacing(1)})}}},89458:(_,L,e)=>{"use strict";e.d(L,{v:()=>i});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(88575),g=e(90182);function i({name:d,description:o,value:u,options:c,onChange:p,testId:h,width:y}){const f=(0,s.of)(l),v=(0,r.useId)(),P=`variable-select-input-${d}-${v}`;return(0,t.jsx)(a.D,{label:d,description:o,htmlFor:P,children:(0,t.jsx)(g.l6,{"data-testid":h,inputId:P,onChange:p,value:u,width:y??30,options:c,className:f.selectContainer})})}function l(d){return{selectContainer:(0,n.css)({marginRight:d.spacing(.5)})}}},85140:(_,L,e)=>{"use strict";e.d(L,{$:()=>l,Z:()=>i});var t=e(74848),n=e(32196),r=e(92145),s=e(40845),a=e(88575),g=e(21744);function i({value:d,defaultValue:o,name:u,description:c,placeholder:p,onChange:h,onBlur:y,ariaLabel:f,required:v,width:P,testId:m}){const D=(0,s.of)(l),x=(0,r.Bi)();return(0,t.jsx)(a.D,{label:u,description:c,htmlFor:x,children:(0,t.jsx)(g.f,{id:x,rows:2,value:d,defaultValue:o,onChange:h,onBlur:y,placeholder:p,required:v,"aria-label":f,cols:P,className:D.textarea,"data-testid":m})})}function l(d){return{textarea:(0,n.css)({whiteSpace:"pre-wrap",minHeight:d.spacing(4),height:"auto",overflow:"auto",padding:`${d.spacing(.75)} ${d.spacing(1)}`,width:"inherit",[d.breakpoints.down("sm")]:{width:"100%"}})}}},14329:(_,L,e)=>{"use strict";e.d(L,{_:()=>a});var t=e(74848),n=e(92145),r=e(88575),s=e(10354);function a({value:g,defaultValue:i,name:l,placeholder:d="",onChange:o,testId:u,width:c,required:p,onBlur:h,grow:y,description:f,invalid:v,error:P,maxLength:m}){const D=(0,n.Bi)(l);return(0,t.jsx)(r.D,{label:l,description:f,invalid:v,error:P,htmlFor:D,children:(0,t.jsx)(s.p,{type:"text",id:D,placeholder:d,value:g,defaultValue:i,onChange:o,onBlur:h,width:y?void 0:c??30,"data-testid":u,maxLength:m,required:p})})}},41820:(_,L,e)=>{"use strict";e.d(L,{j:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(40845),g=e(39268),i=e(76892),l=e(55852);const d=({options:u})=>{const[c,p]=(0,r.useState)(20),[h,y]=(0,r.useState)([]),f=(0,r.useCallback)(P=>{P.preventDefault(),p(c+20)},[c,p]),v=(0,a.of)(o);return(0,r.useEffect)(()=>y(u.slice(0,c)),[c,u]),h.length?(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",marginTop:"16px"},children:[(0,t.jsx)("h5",{children:"Preview of values"}),(0,t.jsx)(g.C,{children:h.map((P,m)=>(0,t.jsx)(g.C,{className:v.optionContainer,children:(0,t.jsx)(i.c,{"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.General.previewOfValuesOption,children:(0,t.jsx)("div",{className:v.label,children:P.label})})},`${P.value}-${m}`))}),u.length>c&&(0,t.jsx)(g.C,{className:v.optionContainer,children:(0,t.jsx)(l.$n,{onClick:f,variant:"secondary",size:"sm","aria-label":"Variable editor Preview of Values Show More link",children:"Show more"})})]}):null};d.displayName="VariableValuesPreview";function o(u){return{wrapper:(0,n.css)({display:"flex",flexDirection:"column",marginTop:u.spacing(2)}),optionContainer:(0,n.css)({marginLeft:u.spacing(.5),marginBottom:u.spacing(.5)}),label:(0,n.css)({whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"50vw"})}}},17663:(_,L,e)=>{"use strict";e.d(L,{cH:()=>Z,mJ:()=>ae,Ao:()=>te,e4:()=>X,kh:()=>Q,CD:()=>G,No:()=>M,B$:()=>z,n_:()=>q,bZ:()=>U,c7:()=>ne});var t=e(2543),n=e(32264),r=e(19347),s=e(81887),a=e(79422),g=e(74730),i=e(74848),l=e(16817),d=e(22391),o=e(27803);function u(re){const{variable:se}=re,{datasource:de,defaultKeys:le}=se.useState(),{value:he}=(0,l.A)(async()=>await(0,r.l)().get(de),[de]),ie=he?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.",J=pe=>{const Pe=(0,d.p$)(pe);se.setState({datasource:Pe,supportsMultiValueOperators:pe.meta.multiValueFilterOperators})},ce=pe=>{se.setState({defaultKeys:pe})};return(0,i.jsx)(o.Q,{datasource:de??void 0,infoText:ie,onDataSourceChange:J,defaultKeys:le,onDefaultKeysChange:ce})}var c=e(95802);function p({variable:re}){const{value:se}=re.useState(),de=le=>{re.setState({value:le.currentTarget.value})};return(0,i.jsx)(c.d,{constantValue:String(se),onChange:de})}var h=e(58711);function y({variable:re,onRunQuery:se}){const{query:de,isMulti:le,allValue:he,includeAll:ie}=re.useState(),J=Ie=>{re.setState({isMulti:Ie.currentTarget.checked})},ce=Ie=>{re.setState({includeAll:Ie.currentTarget.checked})},pe=Ie=>{re.setState({query:Ie.currentTarget.value}),se()},Pe=Ie=>{re.setState({allValue:Ie.currentTarget.value})};return(0,i.jsx)(h.w,{query:de??"",multi:!!le,allValue:he??"",includeAll:!!ie,onMultiChange:J,onIncludeAllChange:ce,onQueryChange:pe,onAllValueChange:Pe})}var f=e(98917);function v({variable:re,onRunQuery:se}){const{pluginId:de,regex:le,isMulti:he,allValue:ie,includeAll:J}=re.useState(),ce=X(),pe=De=>{re.setState({pluginId:De.value}),se()},Pe=De=>{re.setState({regex:De.currentTarget.value}),se()},Ie=De=>{re.setState({isMulti:De.currentTarget.checked})},ge=De=>{re.setState({includeAll:De.currentTarget.checked})},Se=De=>{re.setState({allValue:De.currentTarget.value})};return(0,i.jsx)(f.y,{query:de,regex:le,multi:he||!1,allValue:ie,includeAll:J||!1,optionTypes:ce,onChange:pe,onRegExBlur:Pe,onMultiChange:Ie,onIncludeAllChange:ge,onAllValueChange:Se})}var P=e(96540),m=e(72436),D=e(13544),x=e(88575),E=e(42418),C=e(15292),b=e(32372),T=e(51612),A=e(58975);function R({datasource:re,defaultOptions:se,infoText:de,onDataSourceChange:le,onDefaultOptionsChange:he}){const ie=(0,P.useCallback)(J=>{const ce=(0,m.Jh)(`key,value
`+J)[0],pe=[];for(let Pe=0;Pe<ce.length;Pe++)pe.push({text:ce.fields[0].values[Pe],value:ce.fields[1].values[Pe]});he(pe)},[he]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.Y,{children:"Group by options"}),(0,i.jsx)(x.D,{label:"Data source",htmlFor:"data-source-picker",children:(0,i.jsx)(T.s,{current:re,onChange:le,width:30,variables:!0,noDefault:!0})}),de?(0,i.jsx)(E.F,{title:de,severity:"info","data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.infoText}):null,(0,i.jsx)(x.D,{label:"Use static Group By dimensions",description:"Provide dimensions as CSV: dimensionName, dimensionId",children:(0,i.jsx)(C.d,{"data-testid":D.Tp.pages.Dashboard.Settings.Variables.Edit.GroupByVariable.modeToggle,value:se!==void 0,onChange:J=>{he(se===void 0?[]:void 0)}})}),se!==void 0&&(0,i.jsx)(b.B,{height:300,language:"csv",value:se.map(J=>`${J.text},${J.value}`).join(`
`),onBlur:ie,onSave:ie,showMiniMap:!1,showLineNumbers:!0})]})}function S(re){const{variable:se,onRunQuery:de}=re,{datasource:le,defaultOptions:he}=se.useState(),{value:ie}=(0,l.A)(async()=>await(0,r.l)().get(le),[se.state]),J=ie?.getTagKeys?"Group by dimensions are applied automatically to all queries that target this data source":"This data source does not support group by variable yet.",ce=async Pe=>{const Ie=(0,d.p$)(Pe);se.setState({datasource:Ie}),de()},pe=async Pe=>{se.setState({defaultOptions:Pe}),de()};return(0,i.jsx)(R,{defaultOptions:he,datasource:le??void 0,infoText:le?J:void 0,onDataSourceChange:ce,onDefaultOptionsChange:pe})}var O=e(49317);function j({variable:re,onRunQuery:se}){const{intervals:de,autoStepCount:le,autoEnabled:he,autoMinInterval:ie,value:J}=re.useState(),ce=(0,g.bx)(de),pe=Se=>{const De=(0,g.Sm)(Se.currentTarget.value),Ke=De.includes(J)?J:De[0];re.setState({intervals:De,value:Ke}),se()},Pe=Se=>{re.setState({autoStepCount:Se.value})},Ie=Se=>{re.setState({autoEnabled:Se.target.checked})},ge=Se=>{re.setState({autoMinInterval:Se.currentTarget.value})};return(0,i.jsx)(O.s,{intervals:ce,autoStepCount:le,autoEnabled:he,onAutoCountChanged:Pe,onIntervalsChange:pe,onAutoEnabledChange:Ie,onAutoMinIntervalChanged:ge,autoMinInterval:ie})}var B=e(44890);function N({variable:re,onRunQuery:se}){const{datasource:de,regex:le,sort:he,refresh:ie,isMulti:J,includeAll:ce,allValue:pe,query:Pe}=re.useState(),{value:Ie}=s.jh.getTimeRange(re).useState(),ge=He=>{re.setState({regex:He.currentTarget.value})},Se=He=>{re.setState({sort:He.value})},De=He=>{re.setState({refresh:He})},Ke=He=>{re.setState({isMulti:He.currentTarget.checked})},Me=He=>{re.setState({includeAll:He.currentTarget.checked})},be=He=>{re.setState({allValue:He.currentTarget.value})},we=He=>{const Ve=(0,d.p$)(He);if(re.state.datasource&&re.state.datasource.type!==Ve.type){re.setState({datasource:Ve,query:"",definition:""});return}re.setState({datasource:Ve})},Be=He=>{let Ve;typeof He=="string"?Ve=He:He.hasOwnProperty("query")&&typeof He.query=="string"?Ve=He.query:Ve="",re.setState({query:He,definition:Ve}),se()};return(0,i.jsx)(B.u,{datasource:de??void 0,onDataSourceChange:we,query:Pe,onQueryChange:Be,onLegacyQueryChange:Be,timeRange:Ie,regex:le,onRegExChange:ge,sort:he,onSortChange:Se,refresh:ie,onRefreshChange:De,isMulti:!!J,onMultiChange:Ke,includeAll:!!ce,onIncludeAllChange:Me,allValue:pe??"",onAllValueChange:be})}var I=e(14329);function K({defaultValue:re,value:se,onChange:de,onBlur:le}){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(A.Y,{children:"Text options"}),(0,i.jsx)(I._,{value:se,defaultValue:re,name:"Default value",placeholder:"default value, if any",onChange:de,onBlur:le,width:30,testId:D.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function w({variable:re}){const{value:se}=re.useState(),de=le=>{re.setState({value:le.currentTarget.value})};return(0,i.jsx)(K,{defaultValue:se,onBlur:de})}function U(re){return re!=="system"}const W={custom:{name:"Custom",description:"Define variable values manually",editor:y},query:{name:"Query",description:"Variable values are fetched from a datasource query",editor:N},constant:{name:"Constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share",editor:p},interval:{name:"Interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",editor:j},datasource:{name:"Data source",description:"Enables you to dynamically switch the data source for multiple panels",editor:v},adhoc:{name:"Ad hoc filters",description:"Add key/value filters on the fly",editor:u},groupby:{name:"Group by",description:"Add keys to group by on the fly",editor:S},textbox:{name:"Textbox",description:"Define a textbox variable, where users can enter any arbitrary string",editor:w}},H=["query","custom","textbox","constant","datasource","interval","adhoc","groupby"];function z(){const re=H.map(se=>({label:W[se].name,value:se,description:W[se].description}));return n.$.featureToggles.groupByVariable?re:re.filter(se=>se.value!=="groupby")}function G(re){return W[re].editor}function M(re,se){switch(re){case"custom":return new s.yP(se);case"query":return new s.fS(se);case"constant":return new s.x0({...se,hide:a.zL.hideVariable});case"interval":return new s.Yj(se);case"datasource":return new s.mI(se);case"adhoc":return new s.H9({...se,layout:n.$.featureToggles.newFiltersUI?"combobox":void 0});case"groupby":return new s.ZG(se);case"textbox":return new s.TS(se)}}function Q(re){const de=Y("query",re);return new s.fS({name:de})}function Y(re,se){let de=0,le=`${re}${de}`;for(;se.find(he=>he.state.name===le);)le=`${re}${++de}`;return le}function q(re){return"options"in re.state||"intervals"in re.state}function te(re){let se="";return re instanceof s.fS?se=re.state.definition||(typeof re.state.query=="string"?re.state.query:""):re instanceof s.mI?se=String(re.state.pluginId):re instanceof s.yP?se=re.state.query:re instanceof s.Yj?se=(0,g.bx)(re.state.intervals):(re instanceof s.TS||re instanceof s.x0)&&(se=String(re.state.value)),se}function X(){const re=(0,r.l)().getList({metrics:!0,variables:!0}),se=(0,t.chain)(re).uniqBy("meta.id").map(de=>({label:de.meta.name,value:de.meta.id})).value();return se.unshift({label:"",value:""}),se}function ee(re){return"type"in re.state&&"getValue"in re}function ne(re){return ee(re)?s.Go.isAdHocVariable(re)||s.Go.isConstantVariable(re)||s.Go.isCustomVariable(re)||s.Go.isDataSourceVariable(re)||s.Go.isIntervalVariable(re)||s.Go.isQueryVariable(re)||s.Go.isTextBoxVariable(re)||s.Go.isGroupByVariable(re):!1}const Z=/^(?!__).*$/,ae=/^\w+$/},19626:(_,L,e)=>{"use strict";e.d(L,{D:()=>c});var t=e(74848),n=e(32196),r=e(2543),s=e(40845),a=e(14578);const g=({diff:h})=>{const y=(0,s.of)(i),f=!(0,r.isUndefined)(h.originalValue)&&!(0,r.isArray)(h.originalValue)&&!(0,r.isObject)(h.originalValue),v=!(0,r.isUndefined)(h.value)&&!(0,r.isArray)(h.value)&&!(0,r.isObject)(h.value);return(0,t.jsxs)(t.Fragment,{children:[f&&(0,t.jsx)("span",{className:y,children:String(h.originalValue)}),f&&v?(0,t.jsx)(a.I,{name:"arrow-right"}):null,v&&(0,t.jsx)("span",{className:y,children:String(h.value)})]})},i=h=>(0,n.css)({backgroundColor:h.colors.action.hover,borderRadius:h.shape.radius.default,color:h.colors.text.primary,fontSize:h.typography.body.fontSize,margin:h.spacing(0,.5),padding:h.spacing(.25,.5)});var l=e(56596);const d={op:"replace",originalValue:void 0,path:[""],value:void 0,startLineNumber:0,endLineNumber:0},o=({diff:h,title:y})=>{const f=(0,s.of)(u);return h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.I,{type:"mono",name:"circle",className:f[h.op],size:"xs"})," ",(0,t.jsx)("span",{className:f.embolden,children:y})," ",(0,t.jsx)("span",{children:(0,l.Fl)(h,h.path.length>1)})," ",(0,t.jsx)(g,{diff:h})]}):(0,t.jsxs)("div",{className:f.withoutDiff,children:[(0,t.jsx)(a.I,{type:"mono",name:"circle",className:f.replace,size:"xs"})," ",(0,t.jsx)("span",{className:f.embolden,children:y})," ",(0,t.jsx)("span",{children:(0,l.Fl)(d,!1)})]})},u=h=>({embolden:(0,n.css)({fontWeight:h.typography.fontWeightBold}),add:(0,n.css)({color:h.colors.success.main}),replace:(0,n.css)({color:h.colors.success.main}),move:(0,n.css)({color:h.colors.success.main}),copy:(0,n.css)({color:h.colors.success.main}),_get:(0,n.css)({color:h.colors.success.main}),test:(0,n.css)({color:h.colors.success.main}),remove:(0,n.css)({color:h.colors.success.main}),withoutDiff:(0,n.css)({marginBottom:h.spacing(1)})}),c=({diffs:h,title:y})=>{const f=(0,s.of)(p);return h.length===1?(0,t.jsx)("div",{className:f.container,"data-testid":"diffGroup",children:(0,t.jsx)(o,{title:y,diff:h[0]})}):(0,t.jsxs)("div",{className:f.container,"data-testid":"diffGroup",children:[(0,t.jsx)(o,{title:y}),(0,t.jsx)("ul",{className:f.list,children:h.map((v,P)=>(0,t.jsxs)("li",{className:f.listItem,children:[(0,t.jsx)("span",{children:(0,l.Fl)(v)})," ",(0,t.jsx)(g,{diff:v})]},`${(0,r.last)(v.path)}__${P}`))})]})},p=h=>({container:(0,n.css)({}),list:(0,n.css)({marginLeft:h.spacing(4)}),listItem:(0,n.css)({marginBottom:h.spacing(1),"&:last-child":{marginBottom:0}})})},22764:(_,L,e)=>{"use strict";e.d(L,{M:()=>i});var t=e(74848),n=e(32196),r=e(24773),s=e.n(r),a=e(84140),g=e(40845);const i=({oldValue:l,newValue:d,...o})=>{const u=(0,g.$j)(),c={variables:{dark:{diffViewerBackground:u.colors.background.canvas,diffViewerColor:u.colors.text.primary,addedBackground:(0,a.A)(u.v1.palette.greenShade).setAlpha(.3).toString(),addedColor:"white",removedBackground:(0,a.A)(u.v1.palette.redShade).setAlpha(.3).toString(),removedColor:"white",wordAddedBackground:(0,a.A)(u.v1.palette.greenBase).setAlpha(.4).toString(),wordRemovedBackground:(0,a.A)(u.v1.palette.redBase).setAlpha(.4).toString(),addedGutterBackground:(0,a.A)(u.v1.palette.greenShade).setAlpha(.2).toString(),removedGutterBackground:(0,a.A)(u.v1.palette.redShade).setAlpha(.2).toString(),gutterBackground:u.colors.background.primary,gutterBackgroundDark:u.colors.background.primary,highlightBackground:(0,a.A)(u.colors.primary.main).setAlpha(.4).toString(),highlightGutterBackground:(0,a.A)(u.colors.primary.shade).setAlpha(.2).toString(),codeFoldGutterBackground:u.colors.background.secondary,codeFoldBackground:u.colors.background.secondary,emptyLineBackground:u.colors.background.secondary,gutterColor:u.colors.text.disabled,addedGutterColor:u.colors.text.primary,removedGutterColor:u.colors.text.primary,codeFoldContentColor:u.colors.text.disabled,diffViewerTitleBackground:u.colors.background.secondary,diffViewerTitleColor:u.colors.text.disabled,diffViewerTitleBorderColor:u.colors.border.strong}},codeFold:{fontSize:u.typography.bodySmall.fontSize},gutter:{pre:{color:(0,a.A)(u.colors.text.disabled).setAlpha(1).toString(),opacity:.61}}};return(0,t.jsx)("div",{className:(0,n.css)({fontSize:u.typography.bodySmall.fontSize,pre:{all:"revert"}}),children:(0,t.jsx)(s(),{styles:c,oldValue:l,newValue:d,splitView:!1,compareMethod:r.DiffMethod.CSS,useDarkTheme:u.isDark,...o})})}},57714:(_,L,e)=>{"use strict";e.d(L,{Cc:()=>O,me:()=>m,bS:()=>h,rJ:()=>C,wL:()=>r});var t=e(17172);class n{getHistoryList(N,I){return typeof N!="string"?Promise.resolve([]):(0,t.AI)().get(`api/dashboards/uid/${N}/versions`,I)}getDashboardVersion(N,I){return typeof N!="string"?Promise.resolve({}):(0,t.AI)().get(`api/dashboards/uid/${N}/versions/${I}`)}restoreDashboard(N,I){if(typeof N!="string")return Promise.resolve({});const K=`api/dashboards/uid/${N}/restore`;return(0,t.AI)().post(K,{version:I})}}const r=new n;var s=e(74848),a=e(32196),g=e(40845),i=e(10880),l=e(78369),d=e(71678),o=e(55852),u=e(96374),c=e(3169);const p=({hideModal:B,onRestore:N,version:I})=>{const K=(0,c._2)(),w=async()=>{await N(I)?K.success("Dashboard restored",`Restored from version ${I.version}`):K.error("Dashboard restore failed",`Failed to restore from version ${I.version}`),B()};return(0,s.jsx)(u.u,{isOpen:!0,title:"Restore Version",icon:"history",onDismiss:B,onConfirm:w,body:(0,s.jsxs)("p",{children:["Are you sure you want to restore the dashboard to version ",I.version,"? All unsaved changes will be lost."]}),confirmText:`Yes, restore to version ${I.version}`})},h=({versions:B,canCompare:N,onCheck:I,onRestore:K})=>{const w=(0,g.of)(y);return(0,s.jsx)("div",{className:w.margin,children:(0,s.jsxs)("table",{className:"filter-table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"width-4"}),(0,s.jsx)("th",{className:"width-4",children:"Version"}),(0,s.jsx)("th",{className:"width-14",children:"Date"}),(0,s.jsx)("th",{className:"width-10",children:"Updated by"}),(0,s.jsx)("th",{children:"Notes"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:B.map((U,W)=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)(i.S,{"aria-label":`Toggle selection of version ${U.version}`,className:(0,a.css)({display:"inline"}),checked:U.checked,onChange:H=>I(H,U.id),disabled:!U.checked&&N})}),(0,s.jsx)("td",{children:U.version}),(0,s.jsx)("td",{children:U.createdDateString}),(0,s.jsx)("td",{children:U.createdBy}),(0,s.jsx)("td",{children:U.message}),(0,s.jsx)("td",{className:"text-right",children:W===0?(0,s.jsx)(l.v,{name:"Latest",colorIndex:17}):(0,s.jsx)(d.$s,{children:({showModal:H,hideModal:z})=>(0,s.jsx)(o.$n,{variant:"secondary",size:"sm",icon:"history",onClick:()=>{H(p,{version:U,hideModal:z,onRestore:K})},children:"Restore"})})})]},U.id))})]})})};function y(B){return{margin:(0,a.css)({marginBottom:B.spacing(4)})}}var f=e(2543),v=e(29158),P=e(14578);const m=({onClick:B=f.noop,baseVersion:N=0,newVersion:I=0,isNewLatest:K=!1})=>{const w=(0,g.of)(D);return(0,s.jsxs)("h3",{className:w.header,children:[(0,s.jsx)(v.K,{name:"arrow-left",size:"xl",onClick:B,tooltip:"Reset version"}),(0,s.jsxs)("span",{children:["Comparing ",N," ",(0,s.jsx)(P.I,{name:"arrows-h"})," ",I," ",K&&(0,s.jsx)("cite",{className:"muted",children:"(Latest)"})]})]})},D=B=>({header:(0,a.css)({fontSize:B.typography.h3.fontSize,display:"flex",gap:B.spacing(2),marginBottom:B.spacing(2)})});var x=e(67061),E=e(56034);const C=({hasMore:B,canCompare:N,getVersions:I,getDiff:K,isLastPage:w})=>(0,s.jsxs)(x.B,{children:[B&&(0,s.jsx)(o.$n,{type:"button",onClick:()=>I(!0),variant:"secondary",disabled:w,children:"Show more versions"}),(0,s.jsx)(E.m,{content:"Select two versions to start comparing",placement:"bottom",children:(0,s.jsx)(o.$n,{type:"button",disabled:!N,onClick:K,icon:"code-branch",children:"Compare versions"})})]});var b=e(90613),T=e(57418),A=e(19626),R=e(22764),S=e(56596);const O=({baseInfo:B,newInfo:N,diffData:I,isNewLatest:K,onRestore:w})=>{const U=(0,S.G4)(I.lhs,I.rhs),W=(0,g.of)(j);return(0,s.jsxs)(x.B,{direction:"column",gap:1,children:[(0,s.jsxs)(x.B,{justifyContent:"space-between",alignItems:"center",children:[(0,s.jsxs)(x.B,{alignItems:"center",children:[(0,s.jsxs)("span",{className:(0,a.cx)(W.versionInfo,W.noMarginBottom),children:[(0,s.jsxs)("strong",{children:["Version ",B.version]})," updated by ",B.createdBy," ",B.ageString,B.message]}),(0,s.jsx)(P.I,{name:"arrow-right",size:"sm"}),(0,s.jsxs)("span",{className:W.versionInfo,children:[(0,s.jsxs)("strong",{children:["Version ",N.version]})," updated by ",N.createdBy," ",N.ageString,N.message]})]}),K&&(0,s.jsx)(d.$s,{children:({showModal:H,hideModal:z})=>(0,s.jsxs)(o.$n,{variant:"destructive",icon:"history",onClick:()=>{H(p,{version:B,onRestore:w,hideModal:z})},children:["Restore to version ",B.version]})})]}),Object.entries(U).map(([H,z])=>(0,s.jsx)(A.D,{diffs:z,title:H},H)),(0,s.jsx)(b.a,{paddingTop:2,children:(0,s.jsx)(T.M,{isOpen:!1,label:"View JSON Diff",children:(0,s.jsx)(R.M,{oldValue:JSON.stringify(I.lhs,null,2),newValue:JSON.stringify(I.rhs,null,2)})})})]})},j=B=>({versionInfo:(0,a.css)({color:B.colors.text.secondary,fontSize:B.typography.bodySmall.fontSize}),noMarginBottom:(0,a.css)({marginBottom:0})})},56596:(_,L,e)=>{"use strict";e.d(L,{Fl:()=>g,G4:()=>a});var t=e(16111),n=e(25504),r=e(2543),s=e.n(r);const a=(d,o)=>{const u=(0,t.UD)(d,o),c=n.stringify(d,null,2),p=n.stringify(o,null,2),h=v=>v.map(P=>{let m,D,x=0,E=0;const C=(0,r.tail)(P.path.split("/"));return P.op==="replace"&&p.pointers[P.path]&&(m=(0,r.get)(d,C),D=P.value,x=p.pointers[P.path].value.line,E=p.pointers[P.path].valueEnd.line),P.op==="add"&&p.pointers[P.path]&&(D=P.value,x=p.pointers[P.path].value.line,E=p.pointers[P.path].valueEnd.line),P.op==="remove"&&c.pointers[P.path]&&(m=(0,r.get)(d,C),x=c.pointers[P.path].value.line,E=c.pointers[P.path].valueEnd.line),{op:P.op,value:D,path:C,originalValue:m,startLineNumber:x,endLineNumber:E}}),y=v=>(0,r.sortBy)(v,"startLineNumber"),f=v=>v.reduce((P,m)=>{const D=m.path[0];return P[D]||(P[D]=[]),P[D].push(m),P},{});return(0,r.flow)([h,y,f])(u)},g=(d,o=!0)=>{const u=(0,r.last)(d.path),c=i(u),p=d.op==="remove"?d.originalValue:d.value;let h=l(d.op);return o&&(c?h+=` item ${u}`:(0,r.isArray)(p)&&!(0,r.isEmpty)(p)?h+=` ${p.length} ${u}`:h+=` ${u}`),h},i=d=>!(0,r.isNaN)((0,r.toNumber)(d)),l=d=>d==="add"?"added":d==="remove"?"deleted":"changed"},70439:(_,L,e)=>{"use strict";e.d(L,{F7:()=>d,Xe:()=>g,yk:()=>l});var t=e(7030),n=e(22699),r=e(33390),s=e(7758);const a={useAbsoluteTimeRange:!0,useShortUrl:!0,theme:"current"},g=async(o,u)=>{const{useAbsoluteTimeRange:c,useShortUrl:p,theme:h}=l();return s.c.shareLinkCopied({currentTimeRange:c,theme:h,shortenURL:p,shareResource:(0,n.hD)(u?.getRef())}),await(0,t.Sp)(o,{useAbsoluteTimeRange:c,theme:h,useShortUrl:p})},i="grafana.dashboard.link.shareConfiguration";function l(){return r.A.exists(i)&&r.A.getObject(i)||a}function d(o){r.A.setObject(i,o)}},97246:(_,L,e)=>{"use strict";e.d(L,{j:()=>on});var t=e(74848),n=e(39601),r=e(81887),s=e(87978),a=e(22699),g=e(74730),i=e(32196),l=e(16817),d=e(70713),o=e(13544),u=e(40845),c=e(67061),p=e(15292),h=e(60029),y=e(32372),f=e(62930),v=e(55852),P=e(10534),m=e(82467),D=e(3169),x=e(8484),E=e(99140),C=e(50056);const b=o.Tp.pages.ExportDashboardDrawer.ExportAsJson;class T extends C.N{static{this.Component=A}getTabLabel(){return(0,x.t)("export.json.title","Export dashboard JSON")}}function A({model:St}){const kt=(0,u.of)(R),{isSharingExternally:en}=St.useState(),tn=(0,l.A)(async()=>{const Ct=await St.getExportableDashboardJson();return JSON.stringify(Ct,null,2)},[en]),gn=async()=>{await St.onSaveAsFile();const Ct=(0,x.t)("export.json.download-successful_toast_message","Your JSON has been downloaded");(0,E.JD)((0,m.dx)((0,D.tZ)(Ct)))},Nn=(0,x.t)("export.json.export-externally-label","Export the dashboard to use in another instance");return(0,t.jsxs)("div",{"data-testid":b.container,className:kt.container,children:[(0,t.jsx)("p",{children:(0,t.jsx)(x.x6,{i18nKey:"export.json.info-text",children:"Copy or download a JSON file containing the JSON of your dashboard"})}),(0,t.jsxs)(c.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(p.d,{label:Nn,"data-testid":b.exportExternallyToggle,id:"export-externally-toggle",value:en,onChange:St.onShareExternallyChange}),(0,t.jsx)(h.J,{children:Nn})]}),(0,t.jsx)("div",{className:kt.codeEditorBox,children:(0,t.jsx)(d.Ay,{"data-testid":b.codeEditor,children:({width:Ct,height:Rt})=>tn.value?(0,t.jsx)(y.B,{value:tn.value,language:"json",showMiniMap:!1,height:Rt,width:Ct,readOnly:!0}):tn.loading&&(0,t.jsx)(f.y,{})})}),(0,t.jsx)("div",{className:kt.buttonsContainer,children:(0,t.jsxs)(c.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(v.$n,{"data-testid":b.saveToFileButton,variant:"primary",icon:"download-alt",onClick:gn,children:(0,t.jsx)(x.x6,{i18nKey:"export.json.download-button",children:"Download file"})}),(0,t.jsx)(P.b,{"data-testid":b.copyToClipboardButton,variant:"secondary",icon:"copy",disabled:tn.loading,getText:()=>tn.value??"",children:(0,t.jsx)(x.x6,{i18nKey:"export.json.copy-button",children:"Copy to clipboard"})}),(0,t.jsx)(v.$n,{"data-testid":b.cancelButton,variant:"secondary",onClick:St.useState().onDismiss,fill:"outline",children:(0,t.jsx)(x.x6,{i18nKey:"export.json.cancel-button",children:"Cancel"})})]})})]})}function R(St){return{container:(0,i.css)({height:"100%"}),codeEditorBox:(0,i.css)({margin:`${St.spacing(2,0)}`,height:"75%"}),buttonsContainer:(0,i.css)({paddingBottom:St.spacing(2)})}}var S=e(96540),O=e(25994),j=e(10096),B=e(72686),N=e(4785),I=e(72254),K=e(7758),w=e(31678),U=e(94753),W=e(29158),H=e(45014);function z({onConfirm:St,onDismiss:kt,description:en,confirmButtonLabel:tn,title:gn,isActionLoading:Nn}){const Ct=(0,u.of)(G),Rt=()=>(0,t.jsx)("div",{className:Ct.bodyContainer,children:(0,t.jsxs)(c.B,{justifyContent:"space-between",children:[(0,t.jsxs)(c.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(W.K,{size:"xl",name:"angle-left","aria-label":(0,x.t)("share-drawer.confirm-action.back-arrow-button","Back button"),onClick:kt}),(0,t.jsx)(U.E,{variant:"h4",children:gn})]}),Nn&&(0,t.jsx)(f.y,{})]})});return(0,t.jsx)(H.k,{body:(0,t.jsx)(Rt,{}),description:en,confirmButtonLabel:tn,confirmButtonVariant:"destructive",dismissButtonLabel:(0,x.t)("share-drawer.confirm-action.cancel-button","Cancel"),dismissButtonVariant:"secondary",justifyButtons:"flex-start",onConfirm:St,onDismiss:kt})}const G=St=>({bodyContainer:(0,i.css)({marginBottom:St.spacing(2)})}),M=(0,S.createContext)(void 0),Q=()=>{const St=(0,S.useContext)(M);if(St===void 0)throw new Error("useShareDrawerContext must be used within a DrawerContext");return St};var Y=e(49785),q=e(84167),te=e(88575),X=e(56034),ee=e(14578),ne=e(10354),Z=e(3799);const ae=o.Tp.pages.ShareDashboardDrawer.ShareExternally.Configuration;function re(){const St=(0,u.of)(se),{dashboard:kt}=Q(),[en,{isLoading:tn}]=(0,B.T2)(),{data:gn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(kt.state.uid),Nn=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),Ct=tn||!Nn,Mt=r.jh.getTimeRange(kt).useState(),{handleSubmit:Kt,setValue:nn,control:Qt}=(0,Y.mN)({defaultValues:{isAnnotationsEnabled:gn?.annotationsEnabled,isTimeSelectionEnabled:gn?.timeSelectionEnabled}}),ln=async(In,Rn)=>{nn(In,Rn),await Kt(qn=>pn({...qn,[In]:Rn}))()},pn=In=>{const{isAnnotationsEnabled:Rn,isTimeSelectionEnabled:qn}=In;en({dashboard:kt,payload:{...gn,annotationsEnabled:Rn,timeSelectionEnabled:qn}})};return(0,t.jsxs)(c.B,{direction:"column",gap:2,children:[(0,t.jsx)(U.E,{element:"p",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.settings-label",children:"Settings"})}),(0,t.jsxs)(c.B,{justifyContent:"space-between",children:[(0,t.jsx)("form",{onSubmit:Kt(pn),children:(0,t.jsx)(q.n,{disabled:Ct,children:(0,t.jsxs)(c.B,{direction:"column",gap:2,children:[(0,t.jsxs)(c.B,{gap:1,children:[(0,t.jsx)(Y.xI,{render:({field:{ref:In,...Rn}})=>(0,t.jsx)(p.d,{...Rn,"data-testid":ae.enableTimeRangeSwitch,onChange:qn=>{K.c.publicDashboardTimeSelectionChanged({enabled:qn.currentTarget.checked}),ln("isTimeSelectionEnabled",qn.currentTarget.checked)},label:(0,x.t)("public-dashboard.configuration.enable-time-range-label","Enable time range")}),control:Qt,name:"isTimeSelectionEnabled"}),(0,t.jsx)(h.J,{description:(0,x.t)("public-dashboard.configuration.enable-time-range-description","Allow people to change time range"),children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.enable-time-range-label",children:"Enable time range"})})]}),(0,t.jsxs)(c.B,{gap:1,children:[(0,t.jsx)(Y.xI,{render:({field:{ref:In,...Rn}})=>(0,t.jsx)(p.d,{...Rn,"data-testid":ae.enableAnnotationsSwitch,onChange:qn=>{K.c.publicDashboardAnnotationsSelectionChanged({enabled:qn.currentTarget.checked}),ln("isAnnotationsEnabled",qn.currentTarget.checked)},label:(0,x.t)("public-dashboard.configuration.display-annotations-label","Display annotations")}),control:Qt,name:"isAnnotationsEnabled"}),(0,t.jsx)(h.J,{style:{flex:1},description:(0,x.t)("public-dashboard.configuration.display-annotations-description","Present annotations on this dashboard"),children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.display-annotations-label",children:"Display annotations"})})]}),(0,t.jsxs)(c.B,{gap:1,alignItems:"flex-start",children:[(0,t.jsx)("div",{className:St.timeRange,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.configuration.time-range-label",children:"Time range"})}),(0,t.jsx)("div",{className:(0,i.cx)(St.timeRange,St.timeRangeValue),children:(0,t.jsx)(Z.f,{value:Mt.value})}),(0,t.jsx)(X.m,{placement:"right",content:(0,x.t)("public-dashboard.configuration.time-range-tooltip","The shared dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(ee.I,{name:"info-circle",size:"md"})})]})]})})}),tn&&(0,t.jsx)(f.y,{})]})]})}const se=St=>({timeRange:(0,i.css)({fontSize:St.typography.bodySmall.fontSize,fontWeight:St.typography.bodySmall.fontWeight}),timeRangeValue:(0,i.css)({color:St.colors.text.secondary})});var de=e(38138),le=e(83122);const he=o.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,ie=({onDelete:St,onReshare:kt})=>(0,t.jsxs)(de.W,{children:[(0,t.jsx)(de.W.Item,{label:(0,x.t)("public-dashboard.email-sharing.resend-invite-label","Resend invite"),onClick:kt}),(0,t.jsx)(de.W.Item,{label:(0,x.t)("public-dashboard.email-sharing.revoke-access-label","Revoke access"),destructive:!0,onClick:St})]}),J=({recipients:St,dashboardUid:kt,publicDashboard:en})=>{const tn=(0,u.of)(pe),[gn,{isLoading:Nn}]=(0,B.$L)(),[Ct,{isLoading:Rt}]=(0,B.NA)(),Mt=Nn||Rt,Kt=(Qt,ln)=>{K.c.revokePublicDashboardEmailClicked(),gn({recipientUid:Qt,recipientEmail:ln,dashboardUid:kt,uid:en.uid})},nn=Qt=>{K.c.resendPublicDashboardEmailClicked(),Ct({recipientUid:Qt,uid:en.uid})};return(0,t.jsx)("table",{"data-testid":he.EmailSharingList,className:tn.table,children:(0,t.jsx)("tbody",{children:St.map((Qt,ln)=>(0,t.jsxs)("tr",{className:tn.listItem,children:[(0,t.jsx)("td",{className:tn.user,children:(0,t.jsxs)(c.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)("div",{className:tn.icon,children:(0,t.jsx)(ee.I,{name:"user"})}),(0,t.jsx)(U.E,{children:Qt.recipient})]})}),(0,t.jsx)("td",{children:Mt&&(0,t.jsx)(f.y,{})}),(0,t.jsx)("td",{children:(0,t.jsx)(le.m,{overlay:(0,t.jsx)(ie,{onDelete:()=>Kt(Qt.uid,Qt.recipient),onReshare:()=>nn(Qt.uid)}),children:(0,t.jsx)(W.K,{name:"ellipsis-v","aria-label":"email-menu",variant:"secondary",size:"lg"})})})]},Qt.uid))})})},ce=({dashboard:St})=>{const kt=(0,u.of)(pe),{data:en}=B.Sm.endpoints?.getPublicDashboard.useQueryState(St.state.uid);return(0,t.jsx)(te.D,{label:(0,x.t)("public-dashboard.email-sharing.recipient-list-title","People with access"),description:(0,x.t)("public-dashboard.email-sharing.recipient-list-description","Only people you've directly invited can access this dashboard"),className:kt.listField,children:en?.recipients?.length?(0,t.jsx)("div",{className:kt.listContainer,children:(0,t.jsx)(J,{recipients:en.recipients,dashboardUid:St.state.uid,publicDashboard:en})}):(0,t.jsx)(t.Fragment,{})})},pe=St=>({listField:(0,i.css)({marginBottom:0}),listContainer:(0,i.css)({maxHeight:"140px",overflowY:"auto"}),table:(0,i.css)({width:"100%"}),listItem:(0,i.css)({display:"flex",alignItems:"center",gap:St.spacing(.5),padding:St.spacing(.75,1),color:St.colors.text.secondary}),user:(0,i.css)({flex:1}),icon:(0,i.css)({border:`${St.spacing(.25)} solid ${St.colors.text.secondary}`,padding:St.spacing(.125,.5),borderRadius:St.shape.radius.circle,color:St.colors.text.secondary})}),Pe=o.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,Ie=()=>{const{dashboard:St}=Q(),{data:kt,isError:en}=B.Sm.endpoints?.getPublicDashboard.useQueryState(St.state.uid),[tn,{isLoading:gn}]=(0,B.NY)(),Nn=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),{register:Ct,handleSubmit:Rt,formState:{errors:Mt,isValid:Kt},reset:nn}=(0,Y.mN)({defaultValues:{email:""},mode:"onSubmit"}),Qt=async ln=>{K.c.publicDashboardEmailInviteClicked(),await tn({recipient:ln.email,uid:kt.uid,dashboardUid:St.state.uid}).unwrap(),nn({email:""})};return(0,t.jsxs)("div",{children:[(0,t.jsx)("form",{onSubmit:Rt(Qt),children:(0,t.jsx)(q.n,{disabled:!Nn||en,children:(0,t.jsx)(te.D,{label:(0,t.jsxs)(c.B,{gap:1,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"}),(0,t.jsx)(X.m,{placement:"right",content:(0,x.t)("public-dashboard.email-sharing.recipient-invitation-tooltip","This dashboard contains sensitive data. By using this feature you will be sharing with external people."),children:(0,t.jsx)(ee.I,{name:"info-circle",size:"sm"})})]}),description:(0,x.t)("public-dashboard.email-sharing.recipient-invitation-description","Invite someone by email"),error:Mt.email?.message,invalid:!!Mt.email?.message,children:(0,t.jsxs)(c.B,{direction:"row",children:[(0,t.jsx)(ne.p,{placeholder:(0,x.t)("public-dashboard.email-sharing.recipient-email-placeholder","Email"),autoCapitalize:"none",loading:gn,...Ct("email",{required:(0,x.t)("public-dashboard.email-sharing.recipient-required-email-text","Email is required"),pattern:{value:I._l,message:(0,x.t)("public-dashboard.email-sharing.recipient-invalid-email-text","Invalid email")}}),"data-testid":Pe.EmailSharingInput}),(0,t.jsx)(v.$n,{type:"submit",variant:"primary",disabled:gn||!Kt,"data-testid":Pe.EmailSharingInviteButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.recipient-invitation-button",children:"Invite"})})]})})})}),(0,t.jsx)(ce,{dashboard:St}),(0,t.jsx)(O.c,{}),(0,t.jsx)(re,{})]})};var ge=e(10880),Se=e(42418);const De="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#share-externally-with-specific-people",Ke=o.Tp.pages.ShareDashboardDrawer.ShareExternally;function Me(){return(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Ke.emailSharingAlert,children:(0,t.jsxs)(c.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.alert-text",children:"Sharing dashboards by email is billed per user for the duration of the 30-day token, regardless of how many dashboards are shared. Billing stops after 30 days unless you renew the token."}),(0,t.jsx)(v.$n,{variant:"secondary",onClick:()=>window.open(De,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.learn-more-button",children:"Learn more"})})]})})}const be=o.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation,we=({hasError:St})=>{const{dashboard:kt,onDismiss:en}=Q(),tn=(0,u.of)(Be),[gn,{isLoading:Nn,isError:Ct}]=(0,B.U9)(),Rt=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),Mt=!Rt||Nn||Ct||St,{handleSubmit:Kt,register:nn,formState:{isValid:Qt}}=(0,Y.mN)({mode:"onChange"}),ln=()=>{K.c.generatePublicDashboardUrlClicked({share:I.Xo.EMAIL}),gn({dashboard:kt,payload:{share:I.Xo.EMAIL,isEnabled:!0}})};return(0,t.jsxs)(t.Fragment,{children:[Rt&&(0,t.jsx)(Me,{}),(0,t.jsx)("form",{onSubmit:Kt(ln),children:(0,t.jsxs)(q.n,{disabled:Mt,children:[(0,t.jsx)("div",{className:tn.checkbox,children:(0,t.jsx)(ge.S,{...nn("billAcknowledgment",{required:!0}),label:(0,x.t)("public-dashboard.email-sharing.bill-ack","I understand that adding users requires payment.*")})}),(0,t.jsxs)(c.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(v.$n,{type:"submit",disabled:!Qt,"data-testid":be.EmailShare.createButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(v.$n,{variant:"secondary",onClick:en,"data-testid":be.EmailShare.cancelButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.email-sharing.cancel-button",children:"Cancel"})}),Nn&&(0,t.jsx)(f.y,{})]})]})})]})},Be=St=>({checkbox:(0,i.css)({marginBottom:St.spacing(2)})}),He=()=>{const{dashboard:St}=Q(),{data:kt,isError:en}=B.Sm.endpoints?.getPublicDashboard.useQueryState(St.state.uid);return(0,t.jsx)(t.Fragment,{children:kt?(0,t.jsx)(Ie,{}):(0,t.jsx)(we,{hasError:en})})},Ve="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards",Je=o.Tp.pages.ShareDashboardDrawer.ShareExternally,nt=()=>(0,t.jsx)(Se.F,{title:"",severity:"info",bottomSpacing:0,"data-testid":Je.publicAlert,children:(0,t.jsxs)(c.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.alert-text",children:"Sharing this dashboard externally makes it entirely accessible to anyone with the link."}),(0,t.jsx)(v.$n,{variant:"secondary",onClick:()=>window.open(Ve,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.learn-more-button",children:"Learn more"})})]})}),pt=o.Tp.pages.ShareDashboardDrawer.ShareExternally.Creation;function bt({hasError:St}){const{dashboard:kt,onDismiss:en}=Q(),tn=(0,u.of)(Tt),gn=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),{handleSubmit:Nn,register:Ct,formState:{isValid:Rt}}=(0,Y.mN)({mode:"onChange"}),[Mt,{isLoading:Kt,isError:nn}]=(0,B.U9)(),Qt=()=>{K.c.generatePublicDashboardUrlClicked({share:I.Xo.PUBLIC}),Mt({dashboard:kt,payload:{share:I.Xo.PUBLIC,isEnabled:!0}})},ln=!gn||Kt||nn||St;return(0,t.jsxs)(t.Fragment,{children:[gn&&(0,t.jsx)(nt,{}),(0,t.jsx)("form",{onSubmit:Nn(Qt),children:(0,t.jsxs)(q.n,{disabled:ln,children:[(0,t.jsx)("div",{className:tn.checkbox,children:(0,t.jsx)(ge.S,{...Ct("publicAcknowledgment",{required:!0}),label:(0,x.t)("public-dashboard.public-sharing.public-ack","I understand that this entire dashboard will be public.*"),"data-testid":pt.willBePublicCheckbox})}),(0,t.jsxs)(c.B,{direction:"row",gap:1,alignItems:"center",children:[(0,t.jsx)(v.$n,{type:"submit",disabled:!Rt,"data-testid":pt.PublicShare.createButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.accept-button",children:"Accept"})}),(0,t.jsx)(v.$n,{variant:"secondary",onClick:en,"data-testid":pt.PublicShare.cancelButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.public-sharing.cancel-button",children:"Cancel"})}),Kt&&(0,t.jsx)(f.y,{})]})]})})]})}const Tt=St=>({checkbox:(0,i.css)({marginBottom:St.spacing(2)})});function ye(){const{dashboard:St}=Q(),{data:kt,isError:en}=B.Sm.endpoints?.getPublicDashboard.useQueryState(St.state.uid);return(0,t.jsx)(t.Fragment,{children:kt?(0,t.jsx)(re,{}):(0,t.jsx)(bt,{hasError:en})})}var je=e(12257),ue=e(10872),Ee=e(6923),Ce=e(59995);function Ne({publicDashboard:St}){const{dashboard:kt}=Q(),en=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),tn=(0,Ce.b)(kt),gn=(kt.state.$variables?.state.variables.length??0)>0;return(0,t.jsxs)(t.Fragment,{children:[en&&gn&&(0,t.jsx)(ue.D,{showDescription:!1}),!en&&(0,t.jsx)(Ee.t,{mode:St?"edit":"create"}),en&&!!tn?.length&&(0,t.jsx)(je.s,{unsupportedDataSources:tn.join(", ")}),St?.share===I.Xo.EMAIL&&(0,I.AY)()&&(0,t.jsx)(Me,{}),St?.share===I.Xo.PUBLIC&&(0,t.jsx)(nt,{})]})}var Fe=e(8887),Ue=e(90182);const fe=()=>({label:(0,x.t)("public-dashboard.share-externally.public-share-type-option-label","Anyone with the link"),description:(0,x.t)("public-dashboard.share-externally.public-share-type-option-description","Anyone with the link can access dashboard"),value:I.Xo.PUBLIC,icon:"globe"}),Te=()=>({label:(0,x.t)("public-dashboard.share-externally.email-share-type-option-label","Only specific people"),description:(0,x.t)("public-dashboard.share-externally.email-share-type-option-description","Only people with the link can access dashboard"),value:I.Xo.EMAIL,icon:"users-alt"}),Ge=o.Tp.pages.ShareDashboardDrawer.ShareExternally;function Qe({setShareType:St,options:kt,value:en}){const{dashboard:tn}=Q(),gn=(0,u.of)(st),{data:Nn}=B.Sm.endpoints?.getPublicDashboard.useQueryState(tn.state.uid),[Ct,{isLoading:Rt}]=(0,B.ft)(),Mt=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite),Kt=fe(),nn=Qt=>{if(!Nn)return;K.c.publicDashboardShareTypeChange({shareType:Qt===I.Xo.EMAIL?"email":"public"});const ln={dashboard:tn,payload:{...Nn,share:Qt}};Ct(ln)};return(0,t.jsxs)("div",{children:[(0,t.jsxs)(c.B,{justifyContent:"space-between",children:[(0,t.jsx)(h.J,{description:en.description,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-configuration.share-type-label",children:"Link access"})}),Rt&&(0,t.jsx)(f.y,{})]}),(0,I.AY)()?(0,t.jsx)(Ue.l6,{"data-testid":Ge.shareTypeSelect,options:kt,value:en,disabled:!Mt,onChange:Qt=>{St(Qt),nn(Qt.value)},className:gn.select}):(0,t.jsxs)(c.B,{gap:1,alignItems:"center",children:[(0,Fe.Uo)(Kt.icon)&&(0,t.jsx)(ee.I,{name:(0,Fe.Uo)(Kt.icon)}),(0,t.jsx)(U.E,{children:Kt.label})]})]})}const st=()=>({select:(0,i.css)({flex:1})}),Xe=o.Tp.pages.ShareDashboardDrawer.ShareExternally,ot=()=>(0,I.AY)()?[Te(),fe()]:[fe()];class ft extends r.Bs{static{this.Component=_e}getTabLabel(){return(0,x.t)("share-dashboard.menu.share-externally-title","Share externally")}}function _e({model:St}){const[kt,en]=(0,S.useState)(!1),tn=(0,u.of)(dt),gn=(0,g.YQ)(St),{data:Nn,isLoading:Ct}=(0,B.Bs)(gn.state.uid),[Rt,{isLoading:Mt}]=(0,B.bN)(),Kt=()=>{en(!0)},nn=async()=>{K.c.revokePublicDashboardClicked(),await Rt({dashboard:gn,uid:Nn.uid,dashboardUid:gn.state.uid}).unwrap(),en(!1)};return Ct?(0,t.jsx)(N.a,{}):kt?(0,t.jsx)(z,{title:(0,x.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),confirmButtonLabel:(0,x.t)("public-dashboard.share-externally.revoke-access-button","Revoke access"),onConfirm:nn,onDismiss:()=>en(!1),description:(0,x.t)("public-dashboard.share-externally.revoke-access-description","Are you sure you want to revoke this access? The dashboard can no longer be shared."),isActionLoading:Mt}):(0,t.jsx)("div",{className:tn.container,children:(0,t.jsx)(et,{publicDashboard:Nn,onRevokeClick:Kt})})}function et({publicDashboard:St,onRevokeClick:kt}){const en=ot(),tn=(0,S.useMemo)(()=>St&&(0,I.AY)()?en.find(Mt=>Mt.value===St?.share)??en[0]:en[0],[St,en]),[gn,Nn]=(0,S.useState)(tn),Ct=(0,S.useMemo)(()=>gn.value===I.Xo.EMAIL&&(0,I.AY)()?(0,t.jsx)(He,{}):(0,t.jsx)(ye,{}),[gn]);return(0,t.jsxs)(c.B,{direction:"column",gap:2,"data-testid":Xe.container,children:[(0,t.jsx)(Ne,{publicDashboard:St}),(0,t.jsx)(Qe,{setShareType:Nn,value:gn,options:en}),Ct,St&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O.c,{spacing:0}),(0,t.jsx)(it,{publicDashboard:St,onRevokeClick:kt})]})]})}function it({publicDashboard:St,onRevokeClick:kt}){const{dashboard:en}=Q(),[tn,{isLoading:gn}]=(0,B.eq)(),Nn=(0,u.of)(dt),Ct=j.TP.hasPermission(w.AccessControlAction.DashboardsPublicWrite);function Rt(){K.c.publicDashboardUrlCopied()}const Mt=async()=>{K.c.publicDashboardPauseSharingClicked({paused:!St.isEnabled}),tn({dashboard:en,payload:{...St,isEnabled:!St.isEnabled}})};return(0,t.jsxs)(c.B,{alignItems:"center",direction:{xs:"column",sm:"row"},children:[(0,t.jsx)("div",{className:Nn.actionsContainer,children:(0,t.jsxs)(c.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(P.b,{"data-testid":Xe.Configuration.copyUrlButton,variant:"primary",fill:"outline",icon:"link",getText:()=>(0,I.mL)(St.accessToken),onClipboardCopy:Rt,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.copy-link-button",children:"Copy external link"})}),(0,t.jsx)(v.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",disabled:gn||!Ct,onClick:kt,"data-testid":Xe.Configuration.revokeAccessButton,children:(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.revoke-access-button",children:"Revoke access"})}),(0,t.jsx)(v.$n,{icon:St.isEnabled?"pause":"play",variant:"secondary",fill:"outline",tooltip:St.isEnabled?(0,x.t)("public-dashboard.share-externally.pause-access-tooltip","Pausing will temporarily disable access to this dashboard for all users"):"",onClick:Mt,disabled:gn||!Ct,"data-testid":Xe.Configuration.toggleAccessButton,children:St.isEnabled?(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.pause-access-button",children:"Pause access"}):(0,t.jsx)(x.x6,{i18nKey:"public-dashboard.share-externally.resume-access-button",children:"Resume access"})})]})}),gn&&(0,t.jsx)(f.y,{})]})}const dt=St=>({container:(0,i.css)({paddingBottom:St.spacing(2)}),actionsContainer:(0,i.css)({width:"100%"})});var ze=e(87895);const xe=o.Tp.pages.ShareDashboardDrawer.ShareInternally;function Oe({useLockedTime:St,onToggleLockedTime:kt,useShortUrl:en,onUrlShorten:tn,onChangeTheme:gn,selectedTheme:Nn,isLoading:Ct}){return(0,t.jsxs)(c.B,{justifyContent:"space-between",children:[(0,t.jsxs)(c.B,{gap:2,direction:"column",children:[(0,t.jsxs)(c.B,{gap:1,direction:"column",children:[(0,t.jsxs)(c.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(p.d,{label:(0,x.t)("link.share.time-range-label","Lock time range"),id:"share-current-time-range",value:St,onChange:kt,"data-testid":xe.lockTimeRangeSwitch}),(0,t.jsx)(h.J,{description:(0,x.t)("link.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(x.x6,{i18nKey:"link.share.time-range-label",children:"Lock time range"})})]}),(0,t.jsxs)(c.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(p.d,{id:"share-short-url",value:en,label:(0,x.t)("link.share.short-url-label","Shorten link"),onChange:tn,"data-testid":xe.shortenUrlSwitch}),(0,t.jsx)(h.J,{children:(0,t.jsx)(x.x6,{i18nKey:"link.share.short-url-label",children:"Shorten link"})})]})]}),(0,t.jsx)(ze.w,{selectedTheme:Nn,onChange:gn})]}),Ct&&(0,t.jsx)(f.y,{})]})}var Le=e(58398),Ze=e(70439);const qe=o.Tp.pages.ShareDashboardDrawer.ShareInternally;class rt extends Le.R{static{this.Component=vt}constructor(kt){const{useAbsoluteTimeRange:en,useShortUrl:tn,theme:gn}=(0,Ze.yk)();super({...kt,useLockedTime:en,useShortUrl:tn,selectedTheme:gn}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}getTabLabel(){return(0,x.t)("share-dashboard.menu.share-internally-title","Share internally")}async onToggleLockedTime(){const kt=!this.state.useLockedTime;(0,Ze.F7)({useAbsoluteTimeRange:kt,useShortUrl:this.state.useShortUrl,theme:this.state.selectedTheme}),await super.onToggleLockedTime()}async onUrlShorten(){const kt=!this.state.useShortUrl;(0,Ze.F7)({useShortUrl:kt,useAbsoluteTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme}),await super.onUrlShorten()}async onThemeChange(kt){(0,Ze.F7)({theme:kt,useShortUrl:this.state.useShortUrl,useAbsoluteTimeRange:this.state.useLockedTime}),await super.onThemeChange(kt)}}function vt({model:St}){const kt=(0,u.of)(Ot),{useLockedTime:en,useShortUrl:tn,selectedTheme:gn,isBuildUrlLoading:Nn}=St.useState();return(0,t.jsxs)("div",{className:qe.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:(0,x.t)("link.share.config-alert-title","Link settings"),children:(0,t.jsx)(x.x6,{i18nKey:"link.share.config-alert-description",children:"Updating your settings will modify the default copy link to include these changes. Please note that these settings are saved within your current browser scope."})}),(0,t.jsx)("div",{className:kt.configDescription,children:(0,t.jsx)(U.E,{variant:"body",children:(0,t.jsx)(x.x6,{i18nKey:"link.share.config-description",children:"Create a personalized, direct link to share your dashboard within your organization, with the following customization settings:"})})}),(0,t.jsx)(Oe,{useLockedTime:en,onToggleLockedTime:St.onToggleLockedTime,useShortUrl:tn,onUrlShorten:St.onUrlShorten,selectedTheme:gn,onChangeTheme:St.onThemeChange,isLoading:Nn}),(0,t.jsx)(O.c,{spacing:1}),(0,t.jsx)(c.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:(0,t.jsx)(P.b,{icon:"link",variant:"primary",fill:"outline",disabled:Nn,getText:St.getShareUrl,onClipboardCopy:St.onCopy,className:kt.copyButtonContainer,"data-testid":qe.copyUrlButton,children:(0,t.jsx)(x.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})})})]})}const Ot=St=>({configDescription:(0,i.css)({marginBottom:St.spacing(2)}),copyButtonContainer:(0,i.css)({marginTop:St.spacing(2)})});var jt=e(5805),Ut=e(72109),zt=e(12962),qt=e(94354),fn=e(76412);const Sn="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#share-a-snapshot",An="https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/#panel-snapshot";function Hn({name:St,onNameChange:kt,onExpireChange:en,selectedExpireOption:tn,panelRef:gn,disableInputs:Nn,children:Ct}){const Rt=(0,u.of)(es);return(0,t.jsxs)("div",{className:Rt.container,children:[(0,t.jsx)(Se.F,{severity:"info",title:"",children:(0,t.jsxs)(c.B,{justifyContent:"space-between",gap:2,alignItems:"center",children:[(0,t.jsx)(U.E,{children:gn?(0,t.jsx)(x.x6,{i18nKey:"snapshot.share-panel.info-alert",children:"A Grafana panel snapshot publicly shares a panel while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."}):(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.info-alert",children:"A Grafana dashboard snapshot publicly shares a dashboard while removing sensitive data such as queries and panel links, leaving only visible metrics and series names. Anyone with the link can access the snapshot."})}),(0,t.jsx)(v.$n,{variant:"secondary",onClick:()=>window.open(gn?An:Sn,"_blank"),type:"button",children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.learn-more-button",children:"Learn more"})})]})}),(0,t.jsxs)("fieldset",{disabled:Nn,children:[(0,t.jsx)(te.D,{label:(0,fn.t)("snapshot.share.name-label","Snapshot name"),children:(0,t.jsx)(ne.p,{id:"snapshot-name-input",value:St,onChange:Mt=>kt(Mt.currentTarget.value)})}),(0,t.jsx)(te.D,{label:(0,fn.t)("snapshot.share.expiration-label","Expires in"),children:(0,t.jsx)(qt.z,{id:"expire-select-input",options:(0,zt.u)(),value:tn?.value,onChange:en})})]}),(0,t.jsx)(O.c,{}),Ct]})}const es=St=>({container:(0,i.css)({paddingBottom:St.spacing(2)})}),rs=o.Tp.pages.ShareDashboardDrawer.ShareSnapshot;class Zn extends zt.l{static{this.Component=kn}getTabLabel(){return(0,x.t)("share-dashboard.menu.share-snapshot-title","Share snapshot")}}function kn({model:St}){const[kt,en]=(0,S.useState)(!1),[tn,gn]=(0,S.useState)(!1),[Nn,Ct]=(0,S.useState)(1),{snapshotName:Rt,snapshotSharingOptions:Mt,selectedExpireOption:Kt,panelRef:nn,onDismiss:Qt,dashboardRef:ln}=St.useState(),[pn,In]=(0,jt.default)(async(Ss=!1)=>{const Os=await St.onSnapshotCreate(Ss);return Ct(2),Os}),[Rn,qn]=(0,jt.default)(async Ss=>{const Os=await St.onSnapshotDelete(Ss);return Ct(1),en(!1),gn(!0),Os}),os=()=>{Qt?.()},cs=()=>{St.onSnasphotNameChange(ln.resolve().state.title),Ct(1)},hs=async()=>{await qn(pn.value?.deleteUrl),cs()};return kt?(0,t.jsx)(z,{title:(0,x.t)("snapshot.share.delete-title","Delete snapshot"),confirmButtonLabel:(0,x.t)("snapshot.share.delete-button","Delete snapshot"),onConfirm:hs,onDismiss:()=>en(!1),description:(0,x.t)("snapshot.share.delete-description","Are you sure you want to delete this snapshot?"),isActionLoading:Rn.loading}):(0,t.jsx)("div",{"data-testid":rs.container,children:(0,t.jsxs)(t.Fragment,{children:[Nn===1&&tn&&(0,t.jsx)(Se.F,{severity:"info",title:"",onRemove:()=>gn(!1),children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.deleted-alert",children:"Snapshot deleted. It could take an hour to be cleared from CDN caches."})}),(0,t.jsx)(Hn,{name:Rt??"",selectedExpireOption:Kt,onNameChange:St.onSnasphotNameChange,onExpireChange:St.onExpireChange,disableInputs:Nn===2,panelRef:nn,children:(0,t.jsxs)(c.B,{justifyContent:"space-between",gap:{xs:2},direction:{xs:"column",xl:"row"},children:[Nn===1?(0,t.jsx)(Gn,{onCreateClick:In,isLoading:pn.loading,onCancelClick:os,sharingOptions:Mt}):Nn===2&&pn.value&&(0,t.jsx)(Kn,{url:pn.value.url,onDeleteClick:()=>en(!0),onNewSnapshotClick:cs}),(0,t.jsx)(Ut.Y,{icon:"external-link-alt",href:"/dashboard/snapshots",external:!0,children:(0,x.t)("snapshot.share.view-all-button","View all snapshots")})]})})]})})}const Gn=({isLoading:St,onCreateClick:kt,onCancelClick:en,sharingOptions:tn})=>(0,t.jsxs)(c.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(v.$n,{variant:"primary",disabled:St,onClick:()=>kt(),"data-testid":rs.publishSnapshot,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.local-button",children:"Publish snapshot"})}),tn?.externalEnabled&&(0,t.jsx)(v.$n,{variant:"secondary",disabled:St,onClick:()=>kt(!0),children:tn?.externalSnapshotName}),(0,t.jsx)(v.$n,{variant:"secondary",fill:"outline",onClick:en,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})}),St&&(0,t.jsx)(f.y,{})]}),Kn=({url:St,onDeleteClick:kt,onNewSnapshotClick:en})=>(0,t.jsxs)(c.B,{justifyContent:"flex-start",gap:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(P.b,{icon:"link",variant:"primary",fill:"outline",getText:()=>St,"data-testid":rs.copyUrlButton,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(v.$n,{icon:"trash-alt",variant:"destructive",fill:"outline",onClick:kt,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.delete-button",children:"Delete snapshot"})}),(0,t.jsx)(v.$n,{variant:"secondary",fill:"solid",onClick:en,children:(0,t.jsx)(x.x6,{i18nKey:"snapshot.share.new-snapshot-button",children:"New snapshot"})})]});var yn=e(1397),wn=e(3293),Jn=e(32264);class bn extends Le.R{static{this.Component=Pt}constructor(kt){super(kt)}getTabLabel(){return(0,x.t)("share-panel.drawer.share-link-title","Link settings")}}function Pt({model:St}){const kt=(0,u.of)(Ft),{useLockedTime:en,useShortUrl:tn,selectedTheme:gn,isBuildUrlLoading:Nn,imageUrl:Ct}=St.useState(),Mt=!!(0,g.YQ)(St).state.uid;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:kt.configDescription,children:(0,t.jsx)(U.E,{variant:"body",children:(0,t.jsx)(x.x6,{i18nKey:"link.share-panel.config-description",children:"Create a personalized, direct link to share your panel within your organization, with the following customization settings:"})})}),(0,t.jsx)(Oe,{useLockedTime:en,onToggleLockedTime:()=>St.onToggleLockedTime(),useShortUrl:tn,onUrlShorten:()=>St.onUrlShorten(),selectedTheme:gn,onChangeTheme:Kt=>St.onThemeChange(Kt),isLoading:Nn}),(0,t.jsx)(O.c,{spacing:1}),(0,t.jsxs)(c.B,{gap:2,direction:"column",children:[(0,t.jsx)("div",{className:kt.buttonsContainer,children:(0,t.jsxs)(c.B,{gap:1,flex:1,direction:{xs:"column",sm:"row"},children:[(0,t.jsx)(P.b,{icon:"link",variant:"primary",fill:"outline",disabled:Nn,getText:St.getShareUrl,onClipboardCopy:St.onCopy,children:(0,t.jsx)(x.x6,{i18nKey:"link.share.copy-link-button",children:"Copy link"})}),(0,t.jsx)(v.z9,{href:Ct,icon:"external-link-alt",target:"_blank",variant:"secondary",fill:"solid",disabled:!Jn.$.rendererAvailable||!Mt,children:(0,t.jsx)(x.x6,{i18nKey:"link.share-panel.render-image",children:"Render image"})})]})}),!Mt&&(0,t.jsx)(Se.F,{severity:"info",title:(0,x.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(x.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})}),!Jn.$.rendererAvailable&&(0,t.jsx)(Se.F,{severity:"info",title:(0,x.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(x.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})]})}const Ft=St=>({configDescription:(0,i.css)({marginBottom:St.spacing(2)}),buttonsContainer:(0,i.css)({marginTop:St.spacing(2)})}),Xt=[];function sn(St){Xt.push(St)}class on extends r.Bs{constructor(kt){super({...kt}),this.onDismiss=()=>{this.state.panelRef?(0,g.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.addActivationHandler(()=>this.buildActiveShare(kt.shareView))}static{this.Component=xn}buildActiveShare(kt){const{panelRef:en}=this.state,tn=(0,g.YQ)(this),gn=en?hn(kt,this.onDismiss,tn.getRef(),en):Un(kt,this.onDismiss,tn.getRef(),en);this.setState({activeShare:gn})}}function xn({model:St}){const{activeShare:kt}=St.useState(),en=(0,g.YQ)(St);return(0,t.jsx)(s._,{title:kt?.getTabLabel(),onClose:St.onDismiss,size:"md",children:(0,t.jsx)(M.Provider,{value:{dashboard:en,onDismiss:St.onDismiss},children:kt&&(0,t.jsx)(kt.Component,{model:kt})})})}function Un(St,kt,en,tn){const gn=Xt.find(Nn=>Nn.id===St);if(gn)return new gn.shareOption({onDismiss:kt});switch(St){case a.wr.link:return new rt({onDismiss:kt});case a.wr.publicDashboard:return new ft({onDismiss:kt});case a.wr.snapshot:return new Zn({dashboardRef:en,panelRef:tn,onDismiss:kt});case a.wr.export:return new T({onDismiss:kt});default:return new rt({onDismiss:kt})}}function hn(St,kt,en,tn){switch(St){case a.wr.link:return new bn({panelRef:tn,onDismiss:kt});case a.wr.snapshot:return new Zn({dashboardRef:en,panelRef:tn,onDismiss:kt});case a.wr.embed:return new wn.c({panelRef:tn,onDismiss:kt});case a.wr.libraryPanel:return new yn.S({panelRef:tn,onDismiss:kt});default:return new bn({panelRef:tn,onDismiss:kt})}}},50056:(_,L,e)=>{"use strict";e.d(L,{N:()=>E});var t=e(74848),n=e(4213),r=e.n(n),s=e(16817),a=e(70713),g=e(81887),i=e(67061),l=e(88575),d=e(15292),o=e(37390),u=e(55852),c=e(32372),p=e(10534),h=e(8484),y=e(15858),f=e(22699),v=e(34214),P=e(20455),m=e(73788),D=e(7758),x=e(74730);class E extends g.Bs{constructor(T){super({isSharingExternally:!1,isViewingJSON:!1,...T}),this.tabId=f.wr.export,this._exporter=new y.M,this.onShareExternallyChange=()=>{this.setState({isSharingExternally:!this.state.isSharingExternally})},this.onViewJSON=()=>{this.setState({isViewingJSON:!this.state.isViewingJSON})},this.getExportableDashboardJson=async()=>{const{isSharingExternally:A}=this.state,R=(0,P.Uy)((0,x.YQ)(this));return A?await this._exporter.makeExportable(new v.G(R,void 0,{getVariablesFromState:()=>(0,m.E)(window.__grafanaSceneContext)})):R},this.onSaveAsFile=async()=>{const A=await this.getExportableDashboardJson(),R=JSON.stringify(A,null,2),{isSharingExternally:S}=this.state,O=new Blob([R],{type:"application/json;charset=utf-8"}),j=new Date().getTime();let B="dashboard";"title"in A&&A.title&&(B=A.title),r()(O,`${B}-${j}.json`),D.c.exportDownloadJsonClicked({externally:S})}}static{this.Component=C}getTabLabel(){return(0,h.t)("share-modal.tab-title.export","Export")}getClipboardText(){}}function C({model:b}){const{isSharingExternally:T,isViewingJSON:A,modalRef:R}=b.useState(),S=(0,s.A)(async()=>{if(A){const j=await b.getExportableDashboardJson();return JSON.stringify(j,null,2)}return""},[A]),O=(0,h.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[!A&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(i.B,{gap:2,direction:"column",children:(0,t.jsx)(l.D,{label:O,children:(0,t.jsx)(d.d,{id:"share-externally-toggle",value:T,onChange:b.onShareExternallyChange})})}),(0,t.jsxs)(o.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",onClick:()=>{R?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(u.$n,{variant:"secondary",icon:"brackets-curly",onClick:b.onViewJSON,children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(u.$n,{variant:"primary",icon:"save",onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]}),A&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Ay,{disableHeight:!0,children:({width:j})=>S.value?(0,t.jsx)(c.B,{value:S.value??"",language:"json",showMiniMap:!1,height:"500px",width:j}):S.loading?(0,t.jsx)("div",{children:"Loading..."}):null}),(0,t.jsxs)(o.a.ButtonRow,{children:[(0,t.jsx)(u.$n,{variant:"secondary",fill:"outline",onClick:b.onViewJSON,icon:"arrow-left",children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.back-button",children:"Back to export config"})}),(0,t.jsx)(p.b,{variant:"secondary",icon:"copy",disabled:S.loading,getText:()=>S.value??"",children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})}),(0,t.jsx)(u.$n,{variant:"primary",icon:"save",disabled:S.loading,onClick:()=>b.onSaveAsFile(),children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})]})}},1397:(_,L,e)=>{"use strict";e.d(L,{S:()=>u});var t=e(74848),n=e(32264),r=e(81887),s=e(8484),a=e(86394),g=e(22699),i=e(34214),l=e(41507),d=e(20455),o=e(74730);class u extends r.Bs{constructor(){super(...arguments),this.tabId=g.wr.libraryPanel}static{this.Component=c}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,s.t)("share-panel.drawer.new-library-panel-title","New library panel"):(0,s.t)("share-modal.tab-title.library-panel","Library panel")}}function c({model:p}){const{panelRef:h,modalRef:y}=p.useState();if(!h)return null;const f=h.resolve(),v=f.parent;if(v instanceof l.U){const P=(0,o.YQ)(p),m=(0,d.ZB)(v),D=new i.a(m),x=(0,d.Uy)(P),E=new i.G(x);return(0,t.jsx)(a.j,{initialFolderUid:P.state.meta.folderUid,dashboard:E,panel:D,onDismiss:()=>{y?y.resolve().onDismiss():P.closeModal()},onCreateLibraryPanel:C=>P.createLibraryPanel(f,C)})}return null}},58398:(_,L,e)=>{"use strict";e.d(L,{R:()=>D});var t=e(74848),n=e(47232),r=e(13544),s=e(32264),a=e(81887),g=e(84167),i=e(88575),l=e(15292),d=e(10354),o=e(10534),u=e(14578),c=e(42418),p=e(8484),h=e(7030),y=e(87895),f=e(22699),v=e(7758),P=e(11982),m=e(74730);class D extends a.Bs{constructor(b){super({...b,useLockedTime:b.useLockedTime??!0,useShortUrl:b.useShortUrl??!1,selectedTheme:b.selectedTheme??"current",shareUrl:"",imageUrl:"",isBuildUrlLoading:!1}),this.tabId=f.wr.link,this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{v.c.shareLinkCopied({currentTimeRange:this.state.useLockedTime,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,f.hD)(this.state.panelRef)})},this.addActivationHandler(()=>{this.buildUrl()}),this.onToggleLockedTime=this.onToggleLockedTime.bind(this),this.onUrlShorten=this.onUrlShorten.bind(this),this.onThemeChange=this.onThemeChange.bind(this)}static{this.Component=x}async buildUrl(){this.setState({isBuildUrlLoading:!0});const{panelRef:b,useLockedTime:T,useShortUrl:A,selectedTheme:R}=this.state,S=(0,m.YQ)(this),O=b?.resolve(),j={useAbsoluteTimeRange:T,theme:R,useShortUrl:A};let B=(0,h.VN)(S,j,O);A&&(B=await(0,h.fn)(B));const N=a.jh.getTimeRange(O??S),I=(0,h.$l)(j,N,O);let K=I;O&&(delete K.viewPanel,K.panelId=O.state.key,K["__feature.dashboardSceneSolo"]=!0);const w=(0,P.uZ)({uid:S.state.uid,currentQueryParams:location.search,updateQuery:{...I,panelId:O?.state.key},absolute:!0,soloRoute:!0,render:!0,timeZone:E(N.getTimeZone())});this.setState({shareUrl:B,imageUrl:w,isBuildUrlLoading:!1})}getTabLabel(){return(0,p.t)("share-modal.tab-title.link","Link")}async onToggleLockedTime(){const b=!this.state.useLockedTime;this.setState({useLockedTime:b}),await this.buildUrl()}async onUrlShorten(){const b=!this.state.useShortUrl;this.setState({useShortUrl:b}),await this.buildUrl()}async onThemeChange(b){this.setState({selectedTheme:b}),await this.buildUrl()}}function x({model:C}){const b=C.useState(),{panelRef:T}=b,A=(0,m.YQ)(C),R=T?.resolve(),O=a.jh.getTimeRange(R??A).state.to==="now",{useLockedTime:j,useShortUrl:B,selectedTheme:N,shareUrl:I,imageUrl:K}=b,w=r.Tp.pages.SharePanelModal,U=!!A.state.uid,W=(0,p.t)("share-modal.link.time-range-label","Lock time range"),H=(0,p.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),z=(0,p.t)("share-modal.link.shorten-url","Shorten URL"),G=(0,p.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(g.n,{children:[(0,t.jsx)(i.D,{label:W,description:O?H:"",children:(0,t.jsx)(l.d,{id:"share-current-time-range",value:j,onChange:C.onToggleLockedTime})}),(0,t.jsx)(y.w,{selectedTheme:N,onChange:C.onThemeChange}),(0,t.jsx)(i.D,{label:z,children:(0,t.jsx)(l.d,{id:"share-shorten-url",value:B,onChange:C.onUrlShorten})}),(0,t.jsx)(i.D,{label:G,children:(0,t.jsx)(d.p,{id:"link-url-input",value:I,readOnly:!0,addonAfter:(0,t.jsx)(o.b,{icon:"copy",variant:"primary",getText:C.getShareUrl,onClipboardCopy:C.onCopy,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),R&&s.$.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[U&&(0,t.jsx)("div",{className:"gf-form",children:(0,t.jsxs)("a",{href:K,target:"_blank",rel:"noreferrer","aria-label":w.linkToRenderedImage,children:[(0,t.jsx)(u.I,{name:"camera"}),"\xA0",(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.rendered-image",children:"Direct link rendered image"})]})}),!U&&(0,t.jsx)(c.F,{severity:"info",title:(0,p.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(p.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),R&&!s.$.rendererAvailable&&(0,t.jsx)(c.F,{severity:"info",title:(0,p.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(p.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}function E(C){const b="UTC"+encodeURIComponent((0,n.KQ)().format("Z"));if(C==="utc")return"UTC";if(C==="browser"){if(!window.Intl)return b;const A=window.Intl.DateTimeFormat().resolvedOptions();return A.timeZone?A.timeZone:b}return C}},11675:(_,L,e)=>{"use strict";e.d(L,{Z:()=>W});var t=e(74848),n=e(39601),r=e(32264),s=e(81887),a=e(25897),g=e(37390),i=e(40980),l=e(10096),d=e(8484),o=e(72254),u=e(22699),c=e(7758),p=e(74730),h=e(50056),y=e(1397),f=e(58398),v=e(3293),P=e(12962),m=e(72686),D=e(4785),x=e(32196),E=e(40845),C=e(59037),b=e(31678),T=e(96374);class A extends s.Bs{static{this.Component=R}constructor(G){super({confirmVariant:"destructive",dismissText:"Cancel",dismissVariant:"secondary",icon:"exclamation-triangle",confirmButtonVariant:"destructive",...G})}onDismiss(){}}function R({model:z}){const G=z.useState();return(0,t.jsx)(T.u,{...G})}var S=e(59995);function O({model:z,publicDashboard:G,isGetLoading:M}){const Q=(0,E.of)(j),Y=l.TP.hasPermission(b.AccessControlAction.DashboardsPublicWrite),q=(0,p.YQ)(z),{isDirty:te}=q.useState(),[X]=(0,m.bN)(),ee=(q.state.$variables?.state.variables.length??0)>0,ne=(0,S.b)(q),ae=s.jh.getTimeRange(z).useState();return(0,t.jsx)(C.b,{dashboard:q,publicDashboard:G,unsupportedDatasources:ne,onRevoke:()=>{q.showModal(new A({isOpen:!0,title:"Revoke public URL",icon:"trash-alt",confirmText:"Revoke public URL",body:(0,t.jsx)("p",{className:Q.description,children:"Are you sure you want to revoke this URL? The dashboard will no longer be public."}),onDismiss:()=>{q.showModal(new W({activeTab:u.wr.publicDashboard}))},onConfirm:()=>{X({dashboard:q,dashboardUid:q.state.uid,uid:G.uid}),q.closeModal()}}))},timeRange:ae.value,showSaveChangesAlert:Y&&te,hasTemplateVariables:ee})}const j=z=>({description:(0,x.css)({fontSize:z.typography.body.fontSize})});var B=e(22234);function N({model:z}){const G=(0,p.YQ)(z),M=(0,S.b)(G),Q=(G.state.$variables?.state.variables.length??0)>0;return(0,t.jsx)(B.D,{dashboard:G,unsupportedDatasources:M,unsupportedTemplateVariables:Q})}class I extends s.Bs{constructor(){super(...arguments),this.tabId=u.wr.publicDashboard}static{this.Component=K}getTabLabel(){return(0,d.t)("share-modal.tab-title.public-dashboard","Public Dashboard")}}function K({model:z}){const{data:G,isLoading:M}=(0,m.Bs)((0,p.YQ)(z).state.uid);return(0,t.jsx)(t.Fragment,{children:M?(0,t.jsx)(D.a,{}):(0,o.lI)(G)?(0,t.jsx)(O,{model:z,publicDashboard:G,isGetLoading:M}):(0,t.jsx)(N,{model:z})})}const w=[];function U(z){w.push(z)}class W extends s.Bs{constructor(G){super({activeTab:"link",...G}),this.onDismiss=()=>{this.state.panelRef?(0,p.YQ)(this).closeModal():n.Ny.partial({shareView:null})},this.onChangeTab=M=>{c.c.sharingCategoryClicked({item:M.value,shareResource:(0,u.hD)(this.state.panelRef)}),this.setState({activeTab:M.value})},this.addActivationHandler(()=>this.buildTabs(G.activeTab))}static{this.Component=H}buildTabs(G){const{panelRef:M}=this.state,Q=this.getRef(),Y=[new f.R({panelRef:M,modalRef:Q})],q=(0,p.YQ)(this);if(M||Y.push(new h.N({modalRef:Q})),l.TP.isSignedIn&&r.$.snapshotEnabled&&q.canEditDashboard()&&Y.push(new P.l({panelRef:M,dashboardRef:q.getRef(),modalRef:Q})),M){Y.push(new v.c({panelRef:M}));const X=M.resolve();X instanceof s.Eb&&((0,p.ME)(X)||Y.push(new y.S({panelRef:M,modalRef:Q})))}M||(Y.push(...w.map(X=>new X({modalRef:Q}))),(0,o.iR)()&&Y.push(new I({modalRef:Q})));const te=Y.find(X=>X.tabId===G);this.setState({activeTab:te?.tabId??Y[0].tabId,tabs:Y})}}function H({model:z}){const{panelRef:G,tabs:M,activeTab:Q}=z.useState(),Y=G?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share");if(!M)return;const q=M?.map(ee=>({label:ee.getTabLabel(),value:ee.tabId})),te=(0,t.jsx)(a.J,{title:Y,icon:"share-alt",tabs:q,activeTab:Q,onChangeTab:z.onChangeTab}),X=M.find(ee=>ee.tabId===Q);return(0,t.jsx)(g.a,{isOpen:!0,title:te,onDismiss:z.onDismiss,children:(0,t.jsx)(i.J,{children:X&&(0,t.jsx)(X.Component,{model:X})})})}},3293:(_,L,e)=>{"use strict";e.d(L,{c:()=>o});var t=e(74848),n=e(32264),r=e(81887),s=e(8484),a=e(35280),g=e(22699),i=e(7928),l=e(11982),d=e(74730);class o extends r.Bs{constructor(h){super(h),this.tabId=g.wr.embed}static{this.Component=u}getTabLabel(){return n.$.featureToggles.newDashboardSharingComponent?(0,s.t)("share-panel.drawer.share-embed-title","Share embed"):(0,s.t)("share-modal.tab-title.panel-embed","Embed")}}function u({model:p}){const{panelRef:h}=p.useState(),y=h.resolve(),f=(0,d.YQ)(p),{uid:v}=f.useState(),P=(0,d.Cs)(y),m=r.jh.getTimeRange(y),D=m instanceof i.v?m.state.timeFrom:void 0;return(0,t.jsx)(a.D,{panel:{id:P,timeFrom:D},range:m.state.value,dashboard:{uid:v??"",time:m.state.value},buildIframe:c(f),onCancelClick:()=>f.closeModal()})}const c=p=>(h,y,f,v,P)=>{const m=(0,g.XV)({useCurrentTimeRange:h,selectedTheme:f,panel:v,range:P}),D=m.get("editPanel")??m.get("viewPanel")??"";return m.set("panelId",D),m.delete("editPanel"),m.delete("viewPanel"),m.set("__feature.dashboardSceneSolo","true"),`<iframe src="${(0,l.uZ)({absolute:!0,soloRoute:!0,uid:p.state.uid,slug:p.state.meta.slug,currentQueryParams:m.toString()})}" width="450" height="200" frameborder="0"></iframe>`}},12962:(_,L,e)=>{"use strict";e.d(L,{l:()=>b,u:()=>E});var t=e(74848),n=e(5805),r=e(13544),s=e(17172),a=e(81887),g=e(88575),i=e(10354),l=e(94354),d=e(37390),o=e(55852),u=e(67061),c=e(10534),p=e(82467),h=e(3169),y=e(8484),f=e(22699),v=e(69064),P=e(99140),m=e(20455),D=e(7758);const x=r.Tp.pages.ShareDashboardModal.SnapshotScene,E=()=>{const A={label:(0,y.t)("share-modal.snapshot.expire-week","1 Week"),value:604800};return[{label:(0,y.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,y.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},A,{label:(0,y.t)("share-modal.snapshot.expire-never","Never"),value:0}]},C=()=>E()[2];class b extends a.Bs{constructor(R){super({...R,snapshotName:R.dashboardRef.resolve().state.title,selectedExpireOption:C()}),this.tabId=f.wr.snapshot,this.onSnasphotNameChange=S=>{this.setState({snapshotName:S})},this.onExpireChange=S=>{this.setState({selectedExpireOption:E().find(O=>O.value===S)})},this.onSnapshotCreate=async(S=!1)=>{const{selectedExpireOption:O}=this.state,j=this.prepareSnapshot(),B={dashboard:j,name:j.title,expires:O?.value,external:S};try{const N=await(0,v.s)().create(B);return(0,P.JD)((0,p.dx)((0,h.tZ)((0,y.t)("snapshot.share.success-creation","Your snapshot has been created")))),N}finally{S?D.c.publishSnapshotClicked({expires:B.expires,shareResource:(0,f.hD)(this.state.panelRef)}):D.c.publishSnapshotLocalClicked({expires:B.expires,shareResource:(0,f.hD)(this.state.panelRef)})}},this.onSnapshotDelete=async S=>{const O=await(0,s.AI)().get(S);return(0,P.JD)((0,p.dx)((0,h.tZ)((0,y.t)("snapshot.share.success-delete","Your snapshot has been deleted")))),O},this.addActivationHandler(()=>{this._onActivate()})}static{this.Component=T}_onActivate(){(0,v.s)().getSharingOptions().then(R=>{this.isActive&&this.setState({snapshotSharingOptions:R})})}getTabLabel(){return(0,y.t)("share-modal.tab-title.snapshot","Snapshot")}prepareSnapshot(){const R=a.jh.getTimeRange(this),{dashboardRef:S,panelRef:O}=this.state,j=(0,m.Uy)(S.resolve(),!0);return(0,m.c)(this.state.snapshotName.trim()||"",R.state.value,j,O?.resolve())}}function T({model:A}){const{snapshotName:R,selectedExpireOption:S,modalRef:O,snapshotSharingOptions:j}=A.useState(),[B,N]=(0,n.default)(async(w=!1)=>A.onSnapshotCreate(w)),[I,K]=(0,n.default)(async w=>await(0,s.AI)().get(w));return I.value?(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."}):(0,t.jsxs)(t.Fragment,{children:[!B.value&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(y.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(g.D,{label:(0,y.t)("share-modal.snapshot.name","Snapshot name"),children:(0,t.jsx)(i.p,{id:"snapshot-name-input",width:30,defaultValue:R,onBlur:w=>A.onSnasphotNameChange(w.target.value)})}),(0,t.jsx)(g.D,{label:(0,y.t)("share-modal.snapshot.expire","Expire"),children:(0,t.jsx)(l.z,{id:"expire-select-input",options:E(),value:S?.value,onChange:A.onExpireChange})}),(0,t.jsxs)(d.a.ButtonRow,{children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:()=>{O?.resolve().onDismiss()},fill:"outline",children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),j?.externalEnabled&&(0,t.jsx)(o.$n,{variant:"secondary",disabled:B.loading,onClick:()=>N(!0),children:j?.externalSnapshotName}),(0,t.jsx)(o.$n,{variant:"primary",disabled:B.loading,onClick:()=>N(),"data-testid":x.PublishSnapshot,children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]}),B.value&&(0,t.jsxs)(u.B,{direction:"column",gap:0,children:[(0,t.jsx)(g.D,{label:(0,y.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(i.p,{"data-testid":x.CopyUrlInput,id:"snapshot-url-input",value:B.value.url,readOnly:!0,addonAfter:(0,t.jsx)(c.b,{"data-testid":x.CopyUrlButton,icon:"copy",variant:"primary",getText:()=>B.value.url,children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(o.$n,{fill:"outline",size:"md",variant:"destructive",onClick:()=>{K(B.value.deleteUrl)},children:(0,t.jsx)(y.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})]})}},59995:(_,L,e)=>{"use strict";e.d(L,{b:()=>d});var t=e(16817),n=e(26657),r=e(31204),s=e(31193),a=e(74730);const g=async o=>{let u=new Set;for(const c of o)r.z.has(c)&&await(0,s.tR)().get(c)instanceof n.iy||u.add(c);return Array.from(u)};function i(o){const u=new Set,c=o.state.body.getVizPanels();for(const p of c){const h=l(p);for(const y of h)u.add(y)}return Array.from(u).sort()}function l(o){const u=new Set,c=(0,a.un)(o);if(c)for(const p of c.state.queries)u.add(p.datasource?.type??"");return Array.from(u)}function d(o){const{value:u}=(0,t.A)(async()=>{const c=i(o);return g(c)},[]);return u}},53543:(_,L,e)=>{"use strict";e.d(L,{R:()=>r});var t=e(81887),n=e(74730);class r{constructor(a){this._vizPanel=a}get id(){const a=(0,n.Cs)(this._vizPanel);return isNaN(a)?(console.error("VizPanel key could not be translated to a legacy numeric panel id",this._vizPanel),0):a}get description(){return this._vizPanel.state.description}get type(){return this._vizPanel.state.pluginId}get title(){return this._vizPanel.state.title}get transformations(){return this._vizPanel.state.$data instanceof t.Es?this._vizPanel.state.$data.state.transformations:[]}get targets(){const a=(0,n.un)(this._vizPanel);return a?a.state.queries:[]}get datasource(){return(0,n.un)(this._vizPanel)?.state.datasource}get options(){return this._vizPanel.state.options}get fieldConfig(){return this._vizPanel.state.fieldConfig}get pluginVersion(){return this._vizPanel.state.pluginVersion}}},96556:(_,L,e)=>{"use strict";e.d(L,{w:()=>s});var t=e(32264),n=e(81887),r=e(39820);function s(a){if(!a.targets?.length||t.$.panels[a.type]?.skipDataQuery)return;let g;return g=new n.dt({datasource:a.datasource??void 0,queries:a.targets,maxDataPoints:a.maxDataPoints??void 0,maxDataPointsFromWidth:!0,cacheTimeout:a.cacheTimeout,queryCachingTTL:a.queryCachingTTL,minInterval:a.interval??void 0,dataLayerFilter:{panelId:a.id},$behaviors:[new r.L({})]}),new n.Es({$data:g,transformations:a.transformations||[]})}},32023:(_,L,e)=>{"use strict";e.d(L,{b4:()=>u});var t=e(81887),n=e(16279),r=e(42397);function s(c){return c.state.controls?.state.timePicker}function a(c){return c.state.controls?.state.refreshPicker}function g(c){return c.state.titleItems&&Array.isArray(c.state.titleItems)?c.state.titleItems.find(h=>h instanceof r.$)??null:null}function i(c){return c.state.body.getVizPanels()}function l(c){const p=t.jh.getData(c);if(!(p instanceof n.s))throw new Error("DashboardDataLayerSet not found");return p}function d(c){const p=c.state.$behaviors?.find(h=>h instanceof t.Gg.K2);if(p instanceof t.Gg.K2)return p}function o(c){return c.state.body.getNextPanelId()}const u={getTimePicker:s,getRefreshPicker:a,getPanelLinks:g,getVizPanels:i,getDataLayers:l,getNextPanelId:o,getCursorSync:d}},27734:(_,L,e)=>{"use strict";e.d(L,{Gq:()=>g,zf:()=>i});var t=e(76885),n=e(39601),r=e(32264),s=e(81887);const a="grafana.dashboard.preservedUrlFiltersState";function g(l){const d=window.sessionStorage.getItem(a);if(d){const o=new URLSearchParams(d),u=n.Ny.getSearch();o.forEach((p,h)=>{u.has(h)||u.append(h,p)});for(const p of Array.from(u.keys()))p.startsWith("var-")&&(l.state.$variables?.getByName(p.replace("var-",""))||u.delete(p));const c=u.toString();c&&n.Ny.replace({search:c})}}function i(l){if(r.$.featureToggles.preserveDashboardStateWhenNavigating)return()=>{if(!l.state.uid)return;const d=Object.fromEntries(Object.entries(new s.g5().getUrlState(l)).filter(([u])=>u.startsWith("var-")||u==="from"||u==="to"||u==="timezone")),o=Object.fromEntries(Object.entries(d).filter(([u,c])=>!(Array.isArray(c)&&c.length===0)));Object.keys(o).length>0?window.sessionStorage.setItem(a,t.kM.renderUrl("",o)):window.sessionStorage.removeItem(a)}}},73788:(_,L,e)=>{"use strict";e.d(L,{E:()=>r});var t=e(81887),n=e(53287);function r(s){const a=t.jh.getVariables(s);return(0,n.C)(a,!0)}},7758:(_,L,e)=>{"use strict";e.d(L,{c:()=>r});var t=e(14110);let n=!1;const r={dashboardInitialized:a=>{s("init_dashboard_completed",{...a})},panelLinkClicked:a=>{s("panelheader_datalink_clicked",a)},panelStatusMessageClicked:a=>{s("panelheader_statusmessage_clicked",a)},panelCancelQueryClicked:a=>{s("panelheader_cancelquery_clicked",a)},toolbarFavoritesClick:()=>{s("toolbar_actions_clicked",{item:"favorites"})},toolbarSettingsClick:()=>{s("toolbar_actions_clicked",{item:"settings"})},toolbarShareClick:()=>{s("toolbar_actions_clicked",{item:"share"})},toolbarAddClick:()=>{s("toolbar_actions_clicked",{item:"add"})},sharingCategoryClicked:a=>{s("sharing_category_clicked",a)},shareLinkCopied:a=>{s("sharing_link_copy_clicked",a)},embedSnippetCopy:a=>{s("sharing_embed_copy_clicked",a)},publishSnapshotClicked:a=>{s("sharing_snapshot_publish_clicked",a)},publishSnapshotLocalClicked:a=>{s("sharing_snapshot_local_clicked",a)},exportDownloadJsonClicked:a=>{s("sharing_export_download_json_clicked",a)},exportCopyJsonClicked:a=>{s("sharing_export_copy_json_clicked",a)},exportSaveJsonClicked:a=>{s("sharing_export_save_json_clicked",a)},exportViewJsonClicked:a=>{s("sharing_export_view_json_clicked",a)},generatePublicDashboardUrlClicked:a=>{s("sharing_public_generate_url_clicked",a)},revokePublicDashboardEmailClicked:a=>{s("sharing_public_email_revoke_clicked",a)},resendPublicDashboardEmailClicked:a=>{s("sharing_public_email_resend_clicked",a)},publicDashboardEmailInviteClicked:a=>{s("sharing_public_email_invite_clicked",a)},publicDashboardShareTypeChange:a=>{s("sharing_public_can_view_clicked",a)},publicDashboardTimeSelectionChanged:a=>{s("sharing_public_time_picker_clicked",a)},publicDashboardAnnotationsSelectionChanged:a=>{s("sharing_public_annotations_clicked",a)},publicDashboardUrlCopied:a=>{s("sharing_public_copy_url_clicked",a)},publicDashboardPauseSharingClicked:a=>{s("sharing_public_pause_clicked",a)},revokePublicDashboardClicked:a=>{s("sharing_public_revoke_clicked",a)},emptyDashboardButtonClicked:a=>{s("emptydashboard_clicked",a)},toolbarAddButtonClicked:a=>{s("toolbar_add_clicked",a)},setScenesContext:()=>(n=!0,()=>{n=!1})},s=(a,g)=>{const i=n?{scenesView:!0}:{};g?(0,t.rR)(`dashboards_${a}`,{...g,...i}):(0,t.rR)(`dashboards_${a}`)}},99246:(_,L,e)=>{"use strict";e.d(L,{C:()=>t,Y:()=>n});const t={left:[],right:[]};function n(r,s){t[r].push(s)}},11982:(_,L,e)=>{"use strict";e.d(L,{Lp:()=>p,Uu:()=>c,e0:()=>u,r7:()=>o,uZ:()=>d});var t=e(76885),n=e(71733),r=e(39601),s=e(32264),a=e(81887),g=e(10096),i=e(87490),l=e(74730);function d(h){let y=`/d/${h.uid}`;h.uid||(y="/dashboard/new"),h.soloRoute&&(y=`/d-solo/${h.uid}`),h.slug&&(y+=`/${h.slug}`),h.subPath&&(y+=h.subPath),h.render&&(y="/render"+y,h.updateQuery={...h.updateQuery,width:1e3,height:500,tz:h.timeZone}),h.isHomeDashboard&&(y="/");const f=h.currentQueryParams?(0,r.SE)(h.currentQueryParams):{};if(delete f.shareView,h.updateQuery)for(const P in h.updateQuery)h.updateQuery[P]===null||h.updateQuery[P]===void 0?delete f[P]:f[P]=h.updateQuery[P];const v=t.kM.renderUrl(y,f);return h.absolute?s.$.appUrl+v.slice(1):v}function o(h){return n.I.getUrlForPartial(r.Ny.getLocation(),{viewPanel:h.state.key,editPanel:void 0})}function u(h){return n.I.getUrlForPartial(r.Ny.getLocation(),{editPanel:h,viewPanel:void 0})}function c(h,y){const f=h.state.key?.replace("-view","");return n.I.getUrlForPartial(r.Ny.getLocation(),{inspect:f,inspectTab:y})}function p(h){const y=h.getPlugin(),f=(0,l.un)(h);if(!g.TP.hasAccessToExplore()||y?.meta.skipDataQuery||!f)return Promise.resolve(void 0);const v=a.jh.getTimeRange(h);return(0,i.Xe)({queries:f.state.queries,dsRef:f.state.datasource,timeRange:v.state.value,scopedVars:{__sceneObject:{value:h}},adhocFilters:f.state.data?.request?.filters})}},74730:(_,L,e)=>{"use strict";e.d(L,{Cs:()=>h,M6:()=>O,ME:()=>R,O8:()=>A,SN:()=>T,Sm:()=>m,X0:()=>v,XA:()=>p,YQ:()=>C,a7:()=>P,bx:()=>D,iL:()=>S,pk:()=>x,sw:()=>u,un:()=>E,vL:()=>y,vm:()=>c,xz:()=>b});var t=e(22391),n=e(19347),r=e(81887),s=e(81515),a=e(39820),g=e(55600),i=e(68435),l=e(42397),d=e(7196),o=e(32023);const u=8,c=12;function p(j){return`panel-${j}`}function h(j){return parseInt(j.state.key.replace("panel-",""),10)}function y(j,B){if(!B)return null;const N=f(j,B);if(N)return N;const I=parseInt(B,10);return isNaN(I)?null:f(j,p(I))}function f(j,B){if(!B)return null;const N=r.jh.findObject(j,I=>I.state.key===B?!0:(I instanceof r.Eb,!1));if(N){if(N instanceof r.Eb)return N;throw new Error(`Found panel with key ${B} but it was not a VizPanel`)}return null}function v(j,B){j.forEachChild(N=>{N.isActive&&(N.forceRender(),v(N,B))})}function P(j){const{value:B,text:N,options:I}=j.state;return j.hasAllValue()?{values:I.map(K=>K.value),texts:I.map(K=>K.label)}:{values:Array.isArray(B)?B:[B],texts:Array.isArray(N)?N:[N]}}function m(j){const B=j.match(/(["'])(.*?)\1|\w+/g);if(!B)return s.Ez.query?.split(",")??[];const N=new Set,I=B.reduce((K,w)=>{const U=w.replace(/["']+/g,"");return U.startsWith("$__auto_interval_")||K.add(U),K},N);return Array.from(I)}function D(j){return Array.isArray(j)?j.join(","):""}function x(j,B){const N=Array.isArray(j.current.value)?j.current.value[0]:j.current.value;return N.startsWith("$__auto_interval_")?"$__auto":B.includes(N)?N:B[0]}function E(j){if(!j)return;const B=j.state.$data??j.parent?.state.$data;if(B instanceof r.dt)return B;if(B instanceof r.Es)return E(B)}function C(j){const B=j.getRoot();if(B instanceof g.H$)return B;throw new Error("SceneObject root is not a DashboardScene")}function b(j){return j instanceof r.Eb?j:j.parent?b(j.parent):null}function T(j){return j.includes("clone")}function A(j){const B=o.b4.getNextPanelId(j);return new r.Eb({title:"Panel Title",key:p(B),pluginId:"timeseries",titleItems:[new l.$({menu:new l.m({})})],hoverHeaderOffset:0,menu:new r.Lw({$behaviors:[d._i]}),$data:new r.Es({$data:new r.dt({queries:[{refId:"A"}],datasource:(0,t.p$)((0,n.l)().getInstanceSettings(null)),$behaviors:[new a.L({})]}),transformations:[]})})}function R(j){return S(j)!==void 0}function S(j){const B=j.state.$behaviors?.find(N=>N instanceof i.u);if(B)return B}function O(j){let B,N;return j.isActive?B:(j.parent&&(N=O(j.parent)),B=j.activate(),()=>{N?.(),B()})}},28676:(_,L,e)=>{"use strict";e.d(L,{n:()=>o});var t=e(17172),n=e(32264),r=e(2468),s=e(48814),a=e(6473),g=e(53001);class i{constructor(){}saveDashboard(p){return a.t.ignoreNextSave(),(0,t.AI)().post("/api/dashboards/db/",{dashboard:p.dashboard,message:p.message??"",overwrite:p.overwrite??!1,folderUid:p.folderUid})}deleteDashboard(p,h){return(0,t.AI)().delete(`/api/dashboards/uid/${p}`,{showSuccessAlert:h})}getDashboardDTO(p){const h=n.$.featureToggles.passScopeToDashboardApi?(0,g.F_)():[],y=h.length>0?{scopes:h}:void 0;return(0,t.AI)().get(`/api/dashboards/uid/${p}`,y)}}class l{constructor(){this.client=new r.w({group:"dashboard.grafana.app",version:"v0alpha1",resource:"dashboards"})}saveDashboard(p){const h=p.dashboard,y={metadata:{...p?.k8s},spec:{...h}};return p.message?y.metadata.annotations={...y.metadata.annotations,[s.fY]:p.message}:y.metadata.annotations&&delete y.metadata.annotations[s.fY],p.folderUid&&(y.metadata.annotations={...y.metadata.annotations,[s.ew]:p.folderUid}),h.uid?(y.metadata.name=h.uid,this.client.update(y).then(f=>this.asSaveDashboardResponseDTO(f))):this.client.create(y).then(f=>this.asSaveDashboardResponseDTO(f))}asSaveDashboardResponseDTO(p){return{uid:p.metadata.name,version:p.spec.version??0,id:p.spec.id??0,status:"success",slug:"",url:""}}deleteDashboard(p,h){return this.client.delete(p).then(y=>({id:0,message:y.message,title:"deleted"}))}async getDashboardDTO(p){const h=await this.client.subresource(p,"dto");return{meta:{...h.access,isNew:!1,isFolder:!1,uid:h.metadata.name,k8s:h.metadata},dashboard:h.spec}}}let d;function o(){return d||(d=n.$.featureToggles.kubernetesDashboards?new l:new i),d}function u(c){throw new Error("dashboardAPI can be only overridden in test environment")}},72686:(_,L,e)=>{"use strict";e.d(L,{$L:()=>D,AK:()=>E,Bs:()=>h,NA:()=>x,NY:()=>m,Sm:()=>p,T2:()=>f,U9:()=>y,_e:()=>P,bN:()=>v,eq:()=>T,ft:()=>A,g9:()=>b,kd:()=>C});var t=e(75816),n=e(75505),r=e(17172),s=e(32264),a=e(82467),g=e(3169),i=e(8484),l=e(72254),d=e(55600);function o(R){return typeof R=="object"&&R!=null&&"error"in R}const u=({baseUrl:R})=>async S=>{try{const{data:O,...j}=await(0,n.s)((0,r.AI)().fetch({...S,url:R+S.url,showErrorAlert:S.showErrorAlert}));return{data:O,meta:j}}catch(O){return S.manageError?S.manageError(O):{error:O}}},c=R=>({error:(0,r.NF)(R)&&R.data.messageId!=="publicdashboards.notFound"?R:null}),p=(0,t.xP)({reducerPath:"publicDashboardApi",baseQuery:u({baseUrl:"/api"}),tagTypes:["PublicDashboard","AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"],refetchOnMountOrArgChange:!0,endpoints:R=>({getPublicDashboard:R.query({query:S=>({url:`/dashboards/uid/${S}/public-dashboards`,manageError:c,showErrorAlert:!1}),async onQueryStarted(S,{dispatch:O,queryFulfilled:j}){try{await j}catch(B){o(B)&&(0,r.NF)(B.error)&&O((0,a.dx)((0,g.gi)(B.error.data.message)))}},providesTags:(S,O,j)=>[{type:"PublicDashboard",id:j}]}),createPublicDashboard:R.mutation({query:S=>({url:`/dashboards/uid/${S.dashboard instanceof d.H$?S.dashboard.state.uid:S.dashboard.uid}/public-dashboards`,method:"POST",data:S.payload}),async onQueryStarted({dashboard:S,payload:{share:O}},{dispatch:j,queryFulfilled:B}){const{data:N}=await B;let I=(0,i.t)("public-dashboard.sharing.success-creation","Dashboard is public!");s.$.featureToggles.newDashboardSharingComponent&&(I=O===l.Xo.PUBLIC?(0,i.t)("public-dashboard.public-sharing.success-creation","Your dashboard is now publicly accessible"):(0,i.t)("public-dashboard.email-sharing.success-creation","Your dashboard is ready for external sharing")),j((0,a.dx)((0,g.tZ)(I))),S instanceof d.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:N.isEnabled}}):S.updateMeta({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(S,O,{dashboard:j})=>[{type:"PublicDashboard",id:j instanceof d.H$?j.state.uid:j.uid}]}),updatePublicDashboard:R.mutation({query:({payload:S,dashboard:O})=>({url:`/dashboards/uid/${O instanceof d.H$?O.state.uid:O.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S},{dispatch:O,queryFulfilled:j}){await j,O((0,a.dx)((0,g.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,i.t)("public-dashboard.configuration.success-update","Settings have been successfully updated"):(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!"))))},invalidatesTags:(S,O,{payload:j})=>[{type:"PublicDashboard",id:j.dashboardUid},"AuditTablePublicDashboard"]}),pauseOrResumePublicDashboard:R.mutation({query:({payload:S,dashboard:O})=>({url:`/dashboards/uid/${O instanceof d.H$?O.state.uid:O.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S,payload:{isEnabled:O}},{dispatch:j,queryFulfilled:B}){const{data:N}=await B;let I=(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(I=O?(0,i.t)("public-dashboard.configuration.success-resume","Your dashboard access has been resumed"):(0,i.t)("public-dashboard.configuration.success-pause","Your dashboard access has been paused")),j((0,a.dx)((0,g.tZ)(I))),S instanceof d.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:N.isEnabled}}):S.updateMeta?.({publicDashboardEnabled:N.isEnabled})},invalidatesTags:(S,O,{payload:j})=>[{type:"PublicDashboard",id:j.dashboardUid},"AuditTablePublicDashboard"]}),updatePublicDashboardAccess:R.mutation({query:({payload:S,dashboard:O})=>({url:`/dashboards/uid/${O instanceof d.H$?O.state.uid:O.uid}/public-dashboards/${S.uid}`,method:"PATCH",data:S}),async onQueryStarted({dashboard:S,payload:{share:O}},{dispatch:j,queryFulfilled:B}){await B;let N=(0,i.t)("public-dashboard.configuration.success-update-old","Public dashboard updated!");s.$.featureToggles.newDashboardSharingComponent&&(N=O===l.Xo.PUBLIC?(0,i.t)("public-dashboard.public-sharing.success-share-type-change","Dashboard access updated: Anyone with the link can now access"):(0,i.t)("public-dashboard.email-sharing.success-share-type-change","Dashboard access updated: Only specific people can now access with the link")),j((0,a.dx)((0,g.tZ)(N)))},invalidatesTags:(S,O,{payload:j})=>[{type:"PublicDashboard",id:j.dashboardUid},"AuditTablePublicDashboard"]}),addRecipient:R.mutation({query:()=>({url:""})}),deleteRecipient:R.mutation({query:()=>({url:""})}),reshareAccessToRecipient:R.mutation({query:()=>({url:""})}),getActiveUsers:R.query({query:()=>({url:"/"}),providesTags:["UsersWithActiveSessions"]}),getActiveUserDashboards:R.query({query:()=>({url:""}),providesTags:(S,O,j)=>[{type:"ActiveUserDashboards",id:j}]}),listPublicDashboards:R.query({query:(S=1)=>({url:`/dashboards/public-dashboards?page=${S}&perpage=8`}),transformResponse:S=>({...S,totalPages:Math.ceil(S.totalCount/S.perPage)}),providesTags:["AuditTablePublicDashboard"]}),deletePublicDashboard:R.mutation({query:S=>({url:`/dashboards/uid/${S.dashboardUid}/public-dashboards/${S.uid}`,method:"DELETE"}),async onQueryStarted({dashboard:S},{dispatch:O,queryFulfilled:j}){await j,O((0,a.dx)((0,g.tZ)(s.$.featureToggles.newDashboardSharingComponent?(0,i.t)("public-dashboard.share.success-delete","Your dashboard is no longer shareable"):(0,i.t)("public-dashboard.share.success-delete-old","Public dashboard deleted!")))),O(p.util?.resetApiState()),S instanceof d.H$?S.setState({meta:{...S.state.meta,publicDashboardEnabled:!1}}):S?.updateMeta({publicDashboardEnabled:!1})},invalidatesTags:(S,O,{dashboardUid:j})=>[{type:"PublicDashboard",id:j},"AuditTablePublicDashboard","UsersWithActiveSessions","ActiveUserDashboards"]}),revokeAllAccess:R.mutation({query:()=>({url:""})})})}),{useGetPublicDashboardQuery:h,useCreatePublicDashboardMutation:y,useUpdatePublicDashboardMutation:f,useDeletePublicDashboardMutation:v,useListPublicDashboardsQuery:P,useAddRecipientMutation:m,useDeleteRecipientMutation:D,useReshareAccessToRecipientMutation:x,useGetActiveUsersQuery:E,useGetActiveUserDashboardsQuery:C,useRevokeAllAccessMutation:b,usePauseOrResumePublicDashboardMutation:T,useUpdatePublicDashboardAccessMutation:A}=p},15858:(_,L,e)=>{"use strict";e.d(L,{M:()=>u});var t=e(2543),n=e(12470),r=e(19347),s=e(2913),a=e(57767),g=e(75096),i=e(82792),l=e(98796),d=e(24240);function o(c){return!!(c.libraryPanel?.name&&c.libraryPanel?.uid)}class u{async makeExportable(p){p.cleanUpRepeats();const h=p.getSaveModelCloneOld();h.id=null,p.processRepeats();const y=[],f={},v={},P={},m=new Map;for(const C of h.getVariables())P[C.name]=C;const D=(C,b)=>{if(C.datasource===void 0){C.datasource=b;return}let T=C.datasource,A=null;const R=T?.uid,S=R&&g.SY.exec(R);if(S){const O=S[1]||S[2]||S[4];A=P[O],A&&A.current&&(T=A.current.value)}return(0,r.l)().get(T).then(O=>{if(O.meta?.builtIn||(f["datasource"+O.meta?.id]={type:"datasource",id:O.meta.id,name:O.meta.name,version:O.meta.info.version||"1.0.0"},A))return;const j=C.libraryPanel,B=j?"-for-library-panel":"";let N="DS_"+O.name.replace(" ","_").toUpperCase()+B.toUpperCase();if(v[N]={name:N,label:O.name,description:"",type:"datasource",pluginId:O.meta?.id,pluginName:O.meta?.name,usage:v[N]?.usage},j){const I=v[N]?.usage?.libraryPanels||[];I.push({name:j.name,uid:j.uid}),v[N].usage={libraryPanels:I}}C.datasource={type:O.meta.id,uid:"${"+N+"}"}})},x=async C=>{if(C.type!=="row"){if(await D(C),C.targets)for(const T of C.targets)await D(T,C.datasource);const b=s.Ay.panels[C.type];b&&(f["panel"+b.id]={type:"panel",id:b.id,name:b.name,version:b.info.version})}},E=async C=>{if((0,i.X)(C)){const{name:b,uid:T}=C.libraryPanel;let A=C.libraryPanel.model;A||(A=(await(0,a.Yr)(T,!0)).model),await D(A);const{gridPos:R,id:S,...O}=A;m.has(T)||m.set(T,{name:b,uid:T,kind:l.i.Panel,model:O})}};try{for(const T of h.panels)if(await x(T),T.collapsed!==void 0&&T.collapsed===!0&&T.panels)for(const A of T.panels)await x(A);for(const T of h.getVariables())T.type==="query"?(await D(T),T.options=[],T.current={},T.refresh=T.refresh!==n.CO.never?T.refresh:n.CO.onDashboardLoad):T.type==="datasource"&&(T.current={});for(const T of h.annotations.list)await D(T);f.grafana={type:"grafana",id:"grafana",name:"Grafana",version:s.Ay.buildInfo.version};for(const T of h.panels)if(await E(T),T.collapsed!==void 0&&T.collapsed===!0&&T.panels)for(const A of T.panels)await E(A);(0,t.each)(v,T=>{y.push(T)});for(const T of h.getVariables())if((0,d.VO)(T)){const A="VAR_"+T.name.replace(" ","_").toUpperCase();y.push({name:A,type:"constant",label:T.label||T.name,value:T.query,description:""}),T.query="${"+A+"}",T.current={value:T.query,text:T.query,selected:!1},T.options=[T.current]}const C=[...m.entries()].reduce((T,[A,R])=>(T[A]=R,T),{}),b=(0,t.defaults)({__inputs:y,__elements:C,__requires:(0,t.sortBy)(f,["id"])},h);for(let T=0;T<b.panels.length;T++){const A=b.panels[T];o(A)&&(b.panels[T]={gridPos:A.gridPos,id:A.id,libraryPanel:{uid:A.libraryPanel.uid,name:A.libraryPanel.name}})}return b}catch(C){return console.error("Export failed:",C),{error:C}}}}},20120:(_,L,e)=>{"use strict";e.d(L,{fP:()=>de,Ay:()=>he});var t=e(74848),n=e(96540),r=e(32196),s=e(71468),a=e(54148),g=e(80997),i=e(13544),l=e(39601),d=e(69731),o=e(96374),u=e(39938),c=e(19727),p=e(27746),h=e(71678),y=e(15068),f=e(82467),v=e(10804),P=e(2913),m=e(3169),D=e(10096),x=e(16021),E=e(8484),C=e(91219),b=e(28215),T=e(83122),A=e(55852),R=e(14578),S=e(32264),O=e(38138),j=e(36974),B=e(7758),N=e(31678),I=e(28601);const w=({dashboard:ce})=>{const pe=(0,n.useMemo)(()=>(0,j._u)(),[]),Pe=(0,N.useDispatch)(),Ie=(0,N.useSelector)(ge=>ge.dashboard.initialDatasource);return(0,t.jsxs)(O.W,{children:[(0,t.jsx)(O.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new visualization menu item"),label:(0,E.t)("dashboard.add-menu.visualization","Visualization"),onClick:()=>{const ge=(0,j.OK)(ce,Ie);B.c.toolbarAddButtonClicked({item:"add_visualization"}),l.Ny.partial({editPanel:ge}),Pe((0,I.Ub)(void 0))}},"add-visualisation"),S.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(O.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new widget menu item"),label:(0,E.t)("dashboard.add-menu.widget","Widget"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_widget"}),l.Ny.partial({addWidget:!0})}},"add-widget"),(0,t.jsx)(O.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new row menu item"),label:(0,E.t)("dashboard.add-menu.row","Row"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"add_row"}),(0,j.SD)(ce)}},"add-row"),(0,t.jsx)(O.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from panel library menu item"),label:(0,E.t)("dashboard.add-menu.import","Import from library"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"import_from_library"}),(0,j.s3)(ce)}},"add-panel-lib"),(0,t.jsx)(O.W.Item,{testId:i.Tp.pages.AddDashboard.itemButton("Add new panel from clipboard menu item"),label:(0,E.t)("dashboard.add-menu.paste-panel","Paste panel"),onClick:()=>{B.c.toolbarAddButtonClicked({item:"paste_panel"}),(0,j.no)(ce,pe)},disabled:!pe},"add-panel-clipboard")]})},W=({dashboard:ce,onToolbarAddMenuOpen:pe})=>{const[Pe,Ie]=(0,n.useState)(!1);return(0,n.useEffect)(()=>{Pe&&pe&&pe()},[Pe,pe]),(0,t.jsx)(T.m,{overlay:()=>(0,t.jsx)(w,{dashboard:ce}),placement:"bottom",offset:[0,6],onVisibleChange:Ie,children:(0,t.jsxs)(A.$n,{variant:"secondary",size:"sm",fill:"outline","data-testid":i.Tp.components.PageToolbar.itemButton("Add button"),children:[(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.add",children:"Add"}),(0,t.jsx)(R.I,{name:Pe?"angle-up":"angle-down",size:"lg"})]})})};var H=e(70497),z=e(14792),G=e(2609),M=e(81862),Q=e(28444),Y=e(99246),q=e(93030),te=e(62367),X=e(22699);const ee=({dashboard:ce})=>(0,t.jsx)(A.$n,{"data-testid":i.Tp.pages.Dashboard.DashNav.shareButton,variant:"primary",size:"sm",onClick:()=>{B.c.toolbarShareClick(),l.Ny.partial({shareView:X.wr.link})},children:(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.share-button",children:"Share"})}),ne={removeNavIndex:b.Im,setStarred:C.ci,updateTimeZoneForSession:M.Cj,updateNavIndex:f.Vz},Z=ce=>({navIndex:ce.navIndex}),ae=(0,s.connect)(Z,ne),re=i.Tp.pages.Dashboard.DashNav;function se(ce){registerDynamicDashNavAction("left",ce)}function de(ce){(0,Y.Y)("right",ce)}const le=(0,n.memo)(ce=>{(0,a.zy)();const pe=(0,d.C)(),Pe=P.Ay.featureToggles.singleTopNav;(0,x.u)(ce.dashboard.events,Q.Cf);const Ie=ce.dashboard.snapshot?.originalUrl??"",ge=()=>{window.location.href=g.sQ.sanitizeUrl(ce.dashboard.snapshot.originalUrl)},Se=(0,m._2)(),De=()=>{try{const Tt=new URL(g.sQ.sanitizeUrl(Ie),P.Ay.appUrl),ye=new URL(P.Ay.appUrl);Tt.host!==ye.host?D.lE.publish(new Q.S8({component:o.u,props:{title:"Proceed to external site?",modalClass:ie,body:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("p",{children:["This link connects to an external website at"," ",(0,t.jsx)("code",{children:Ie})]}),(0,t.jsx)("p",{children:"Are you sure you'd like to proceed?"})]}),confirmVariant:"primary",confirmText:"Proceed",onConfirm:ge}})):ge()}catch(Tt){Se.error("Invalid URL",Tt instanceof Error?Tt.message:void 0)}},Ke=()=>{B.c.toolbarFavoritesClick();const Tt=(0,z.UA)(),{dashboard:ye,navIndex:je,removeNavIndex:ue,setStarred:Ee,updateNavIndex:Ce}=ce;Tt.starDashboard(ye.uid,!!ye.meta.isStarred).then(Ne=>{Ee({id:ye.uid,title:ye.title,url:ye.meta.url??"",isStarred:Ne});const Fe=je.starred;if(Ne)Fe.children?.push({id:C.L1+ye.uid,text:ye.title,url:ye.meta.url??"",parentItem:Fe});else{ue(C.L1+ye.uid);const Ue=Fe.children?.findIndex(fe=>fe.id===C.L1+ye.uid);Ue&&Fe.children?.splice(Ue,1)}Ce(Fe),ye.meta.isStarred=Ne,pe()})},Me=()=>{B.c.toolbarSettingsClick(),l.Ny.partial({editview:"settings"})},be=()=>{G._o.prev()},we=()=>{G._o.next()},Be=()=>{G._o.stop(),pe()},He=(Tt,ye)=>{Tt.map((je,ue)=>{const Ee=je.component,Ce=(0,n.createElement)(Ee,{...ce,key:`button-custom-${ue}`});typeof je.index=="number"?ye.splice(je.index,0,Ce):ye.push(Ce)})},Ve=()=>G._o.state.isPlaying,Je=()=>{const Tt=P.Ay.buildInfo.env==="development",{dashboard:ye,kioskMode:je}=ce,{canStar:ue,isStarred:Ee}=ye.meta,Ce=[];if(je||Ve())return[];if(ue){let Ne=Ee?(0,E.t)("dashboard.toolbar.unmark-favorite","Unmark as favorite"):(0,E.t)("dashboard.toolbar.mark-favorite","Mark as favorite");Ce.push((0,t.jsx)(q._,{tooltip:Ne,icon:Ee?"favorite":"star",iconType:Ee?"mono":"default",iconSize:"lg",onClick:Ke},"button-star"))}return ye.meta.publicDashboardEnabled&&Ce.push((0,t.jsx)(u.E,{color:"blue",text:"Public",className:J,"data-testid":re.publicDashboardTag},"public-dashboard-button-badge")),Tt&&P.Ay.featureToggles.dashboardScene&&Ce.push((0,t.jsx)(q._,{tooltip:"View as Scene",icon:"apps",onClick:()=>{l.Ny.partial({scenes:!0})}},"button-scenes")),He(Y.C.left,Ce),Ce},nt=()=>(0,t.jsxs)(c.e,{children:[(0,t.jsx)(p.I,{tooltip:(0,E.t)("dashboard.toolbar.playlist-previous","Go to previous dashboard"),icon:"backward",onClick:be,narrow:!0}),(0,t.jsx)(p.I,{onClick:Be,children:(0,t.jsx)(E.x6,{i18nKey:"dashboard.toolbar.playlist-stop",children:"Stop playlist"})}),(0,t.jsx)(p.I,{tooltip:(0,E.t)("dashboard.toolbar.playlist-next","Go to next dashboard"),icon:"forward",onClick:we,narrow:!0})]},"playlist-buttons"),pt=()=>{const{dashboard:Tt,updateTimeZoneForSession:ye,hideTimePicker:je}=ce;return je?null:(0,t.jsx)(te.$,{dashboard:Tt,onChangeTimeZone:ye},"time-controls")},bt=()=>{const{dashboard:Tt,isFullscreen:ye,kioskMode:je,hideTimePicker:ue}=ce,{canSave:Ee,canEdit:Ce,showSettings:Ne,canShare:Fe}=Tt.meta,{snapshot:Ue}=Tt,fe=Ue&&Ue.originalUrl,Te=[];return Ve()?[nt(),pt()]:je===N.KioskMode.TV?[pt()]:(fe&&Te.push((0,t.jsx)(p.I,{tooltip:(0,E.t)("dashboard.toolbar.open-original","Open original dashboard"),onClick:De,icon:"link"},"button-snapshot")),Ee&&!ye&&Te.push((0,t.jsx)(h.$s,{children:({showModal:Ge,hideModal:Qe})=>(0,t.jsx)(p.I,{tooltip:(0,E.t)("dashboard.toolbar.save","Save dashboard"),icon:"save",onClick:()=>{Ge(H.$,{dashboard:Tt,onDismiss:Qe})}})},"button-save")),He(Y.C.right,Te),Ne&&Te.push((0,t.jsx)(p.I,{tooltip:(0,E.t)("dashboard.toolbar.settings","Dashboard settings"),icon:"cog",onClick:Me},"button-settings")),Ce&&!ye&&Te.push((0,t.jsx)(W,{onToolbarAddMenuOpen:B.c.toolbarAddClick,dashboard:Tt},"panel-add-dropdown")),Fe&&Te.push((0,t.jsx)(ee,{dashboard:Tt},"button-share")),ue||Te.push((0,t.jsx)(v.K,{},"toolbar-separator")),Te.push(pt()),Te)};return(0,t.jsxs)(t.Fragment,{children:[Je(),!Pe&&(0,t.jsx)(v.K,{leftActionsSeparator:!0}),(0,t.jsx)(y.U,{alignment:"right",children:bt()})]})});le.displayName="DashNav";const he=ae(le),ie=(0,r.css)({width:"max-content",maxWidth:"80vw"}),J=(0,r.css)({color:"grey",backgroundColor:"transparent",border:"1px solid"})},93030:(_,L,e)=>{"use strict";e.d(L,{_:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(29158);const a=({icon:i,iconType:l,iconSize:d,tooltip:o,onClick:u,children:c})=>{const p=(0,r.of)(g);return(0,t.jsxs)("div",{className:p.noBorderContainer,children:[i&&(0,t.jsx)(s.K,{name:i,size:d,iconType:l,tooltip:o,tooltipPlacement:"bottom",onClick:u}),c]})},g=i=>({noBorderContainer:(0,n.css)({padding:`0 ${i.spacing(.5)}`,display:"flex"})})},62367:(_,L,e)=>{"use strict";e.d(L,{$:()=>c});var t=e(74848),n=e(96540),r=e(85858),s=e(3591),a=e(11134),g=e(25573),i=e(10096),l=e(8484),d=e(16233),o=e(74856),u=e(28444);class c extends n.Component{constructor(){super(...arguments),this.onChangeRefreshInterval=h=>{(0,o.jG)().setAutoRefresh(h),this.forceUpdate()},this.onRefresh=()=>((0,o.jG)().refreshTimeModel(),Promise.resolve()),this.onMoveBack=()=>{i.lE.publish(new u.Io({direction:u.xL.Left}))},this.onMoveForward=()=>{i.lE.publish(new u.Io({direction:u.xL.Right}))},this.onChangeTimePicker=h=>{const{dashboard:y}=this.props,f=y.timepicker,v=f.nowDelay&&h.raw.to==="now",P=r.isMathString(h.raw.from)?h.raw.from:h.from,m=r.isMathString(h.raw.to)?h.raw.to:h.to,D={from:P,to:v?"now-"+f.nowDelay:m};(0,o.jG)().setTime(D)},this.onChangeTimeZone=h=>{this.props.dashboard.timezone=h,this.props.onChangeTimeZone(h),this.onRefresh()},this.onChangeFiscalYearStartMonth=h=>{this.props.dashboard.fiscalYearStartMonth=h,this.onRefresh()},this.onZoom=()=>{this.props.onToolbarZoomClick&&this.props.onToolbarZoomClick(),i.lE.publish(new u.U0({scale:2}))},this.onRefreshClick=()=>{this.props.onToolbarRefreshClick&&this.props.onToolbarRefreshClick(),this.onRefresh()}}componentDidMount(){this.sub=this.props.dashboard.events.subscribe(s.sR,()=>this.forceUpdate())}componentWillUnmount(){this.sub?.unsubscribe()}render(){const{dashboard:h,isOnCanvas:y}=this.props,{refresh_intervals:f}=h.timepicker,v=(0,o.jG)().getValidIntervals(f||a.cb),P=(0,o.jG)().timeRange(),m=h.getTimezone(),D=h.fiscalYearStartMonth,x=h.panelInEdit?.isEditing,E=h.weekStart;let C;return h.refresh===d.SM&&(C=(0,o.jG)().getAutoRefreshInteval().interval),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.m,{value:P,onChange:this.onChangeTimePicker,timeZone:m,fiscalYearStartMonth:D,onMoveBackward:this.onMoveBack,onMoveForward:this.onMoveForward,onZoom:this.onZoom,onChangeTimeZone:this.onChangeTimeZone,onChangeFiscalYearStartMonth:this.onChangeFiscalYearStartMonth,isOnCanvas:y,onToolbarTimePickerClick:this.props.onToolbarTimePickerClick,weekStart:E}),(0,t.jsx)(a.cC,{onIntervalChanged:this.onChangeRefreshInterval,onRefresh:this.onRefreshClick,value:h.refresh,intervals:v,isOnCanvas:y,tooltip:(0,l.t)("dashboard.toolbar.refresh","Refresh dashboard"),noIntervalPicker:x,showAutoInterval:!0,text:C})]})}}},46991:(_,L,e)=>{"use strict";e.d(L,{d:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(55852);const a=({children:i,...l})=>{const d=(0,r.of)(g);return(0,t.jsx)("div",{className:d.buttonWrapper,children:(0,t.jsx)(s.$n,{icon:"plus",...l,children:i})})},g=i=>({buttonWrapper:(0,n.css)({padding:`${i.spacing(3)} 0`})})},75590:(_,L,e)=>{"use strict";e.d(L,{p:()=>P});var t=e(74848),n=e(2543),r=e(96540),s=e(65879),a=e(13544),g=e(57418),i=e(88575),l=e(20333),d=e(15648),o=e(10354),u=e(15292),c=e(8484),p=e(11134),h=e(74856);const y=({refreshIntervals:m,onRefreshIntervalChange:D,getIntervalsFunc:x=v,validateIntervalsFunc:E=f})=>{const[C,b]=(0,r.useState)(x(m??p.cb)),[T,A]=(0,r.useState)(null);(0,r.useEffect)(()=>{const j=x(m??p.cb);b(j)},[x,m]);const R=(0,r.useMemo)(()=>Array.isArray(C)?C.join(","):"",[C]),S=(0,r.useCallback)(j=>{const B=j.currentTarget.value?j.currentTarget.value.split(","):[];b(B)},[b]),O=(0,r.useCallback)(j=>{const B=E(C);B===null&&D(x(C)),A(B)},[x,C,D,E]);return(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.general.auto-refresh-label","Auto refresh"),description:(0,c.t)("dashboard-settings.general.auto-refresh-description","Define the auto refresh intervals that should be available in the auto refresh list. Use the format '5s' for seconds, '1m' for minutes, '1h' for hours, and '1d' for days (e.g.: '5s,10s,30s,1m,5m,15m,30m,1h,2h,1d')."),error:T,invalid:!!T,children:(0,t.jsx)(o.p,{id:"auto-refresh-input",invalid:!!T,value:R,onChange:S,onBlur:O})})},f=(m,D={getTimeSrv:h.jG})=>{try{return v(m,D),null}catch(x){return x instanceof Error?x.message:"Invalid intervals"}},v=(m,D={getTimeSrv:h.jG})=>{const x=m.filter(E=>E.trim()!=="").map(E=>E.replace(/\s+/g,""));return[...new Set(D.getTimeSrv().getValidIntervals(x))]};class P extends r.PureComponent{constructor(){super(...arguments),this.state={isNowDelayValid:!0},this.onNowDelayChange=D=>{const x=D.currentTarget.value;if((0,n.isEmpty)(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);if(s.isValidTimeSpan(x))return this.setState({isNowDelayValid:!0}),this.props.onNowDelayChange(x);this.setState({isNowDelayValid:!1})},this.onHideTimePickerChange=()=>{this.props.onHideTimePickerChange(!this.props.timePickerHidden)},this.onLiveNowChange=()=>{this.props.onLiveNowChange(!this.props.liveNow)},this.onTimeZoneChange=D=>{typeof D=="string"&&this.props.onTimeZoneChange(D)},this.onWeekStartChange=D=>{this.props.onWeekStartChange(D)}}render(){return(0,t.jsxs)(g.M,{label:(0,c.t)("dashboard-settings.time-picker.time-options-label","Time options"),isOpen:!0,children:[(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.time-picker.time-zone-label","Time zone"),"data-testid":a.Tp.components.TimeZonePicker.containerV2,children:(0,t.jsx)(l.U,{inputId:"time-options-input",includeInternal:!0,value:this.props.timezone,onChange:this.onTimeZoneChange,width:40})}),(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.time-picker.week-start-label","Week start"),"data-testid":a.Tp.components.WeekStartPicker.containerV2,children:(0,t.jsx)(d.l,{inputId:"week-start-input",width:40,value:this.props.weekStart,onChange:this.onWeekStartChange})}),(0,t.jsx)(y,{refreshIntervals:this.props.refreshIntervals,onRefreshIntervalChange:this.props.onRefreshIntervalChange}),(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.time-picker.now-delay-label","Now delay"),description:(0,c.t)("dashboard-settings.time-picker.now-delay-description","Exclude recent data that may be incomplete."),children:(0,t.jsx)(o.p,{id:"now-delay-input",invalid:!this.state.isNowDelayValid,placeholder:"0m",onChange:this.onNowDelayChange,defaultValue:this.props.nowDelay})}),(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.time-picker.hide-time-picker","Hide time picker"),children:(0,t.jsx)(u.d,{id:"hide-time-picker-toggle",value:!!this.props.timePickerHidden,onChange:this.onHideTimePickerChange})}),(0,t.jsx)(i.D,{label:(0,c.t)("dashboard-settings.time-picker.refresh-live-dashboards-label","Refresh live dashboards"),description:(0,c.t)("dashboard-settings.time-picker.refresh-live-dashboards-description","Continuously re-draw panels where the time range references 'now'"),children:(0,t.jsx)(u.d,{id:"refresh-live-dashboards-toggle",value:!!this.props.liveNow,onChange:this.onLiveNowChange})})]})}}},10740:(_,L,e)=>{"use strict";e.d(L,{n:()=>H,C:()=>W});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(94753),i=e(60782),l=e(62930),d=e(56034),o=e(42418),u=e(67061),c=e(10354),p=e(14578),h=e(72109),y=e(8484),f=e(29158);const v=({currentPage:G,numberOfPages:M,onNavigate:Q,hideWhenSinglePage:Y,className:q})=>{const te=(0,s.of)(P);return Y&&M<=1?null:(0,t.jsxs)("div",{className:(0,n.cx)(te.wrapper,q),children:[(0,t.jsx)(f.K,{name:"angle-left",size:"md",tooltip:"Previous",onClick:()=>Q(G-1),disabled:G===1}),G," of ",M,(0,t.jsx)(f.K,{name:"angle-right",size:"md",tooltip:"Next",onClick:()=>Q(G+1),disabled:G===M})]})},P=G=>({wrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:16,userSelect:"none"})}),m=({history:G,index:M,onNavigate:Q})=>{const Y=(0,s.of)(D),q=G.length;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:Y.contentWrapper,children:(0,t.jsx)(g.E,{element:"p",color:"secondary",children:G[M-1]})}),(0,t.jsx)(v,{currentPage:M,numberOfPages:q,onNavigate:Q,hideWhenSinglePage:!1,className:Y.paginationWrapper})]})},D=G=>({paginationWrapper:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"flex-end",marginTop:15}),contentWrapper:(0,n.css)({display:"flex",flexBasis:"100%",flexGrow:3,whiteSpace:"pre-wrap",maxHeight:110,overflowY:"scroll",backgroundColor:G.colors.background.secondary,border:`1px solid ${G.colors.border.weak}`,padding:G.spacing(1),minHeight:60})});var x=e(3363);const E=({onSuggestionClick:G,isGenerating:M})=>{const Q=(0,s.of)(C);return(0,t.jsxs)("div",{className:Q.quickSuggestionsWrapper,children:[(0,t.jsx)(a.$n,{onClick:()=>G(x.HG.Shorter),size:"sm",variant:"secondary",icon:"paragraph",disabled:M,children:x.HG.Shorter}),(0,t.jsx)(a.$n,{onClick:()=>G(x.HG.MoreDescriptive),size:"sm",variant:"secondary",icon:"document-layout-left",disabled:M,children:x.HG.MoreDescriptive}),(0,t.jsx)(a.$n,{onClick:()=>G(x.HG.Regenerate),icon:"sync",size:"sm",variant:"secondary",disabled:M,children:"Regenerate"})]})},C=G=>({quickSuggestionsWrapper:(0,n.css)({display:"flex",flexDirection:"row",gap:8})});var b=e(16817),T=e(65418),A=e(34867),R=e(3169);const S=(0,A.DW)("features.dashboards.genai");var O=(G=>(G.IDLE="idle",G.GENERATING="generating",G.COMPLETED="completed",G))(O||{});const j=1e4,B={model:x.C4,temperature:1};function N({model:G,temperature:M,onResponse:Q}=B){const[Y,q]=(0,r.useState)([]),[te,X]=(0,r.useState)(""),[ee,ne]=(0,r.useState)("idle"),[Z,ae]=(0,r.useState)(),{error:re}=(0,R._2)();let se="";const de=(0,r.useCallback)(pe=>{ne("idle"),q([]),ae(pe),re("Failed to generate content using OpenAI","Please try again or if the problem persists, contact your organization admin."),console.error(pe),S.logError(pe,{messages:JSON.stringify(Y),model:G,temperature:String(M)})},[Y,G,M,re]);(0,r.useEffect)(()=>{Y.length>0&&X("")},[Y]);const{error:le,value:he}=(0,b.A)(async()=>await(0,x.QX)(),[x.QX]),{error:ie,value:J}=(0,b.A)(async()=>{if(!he||!Y.length)return{enabled:he};ne("generating"),ae(void 0);const pe=T.qH({model:G,temperature:M,messages:Y}).pipe(T.qA());return{enabled:he,stream:pe.subscribe({next:Pe=>{se=Pe},error:de,complete:()=>{X(se),ne("completed"),Q?.(se),q([]),ae(void 0)}})}},[Y,he]);(0,r.useEffect)(()=>()=>{J?.stream?.unsubscribe()},[J]);const ce=(0,r.useCallback)(()=>{J?.stream?.unsubscribe(),ne("idle"),ae(void 0),q([])},[J]);return(0,r.useEffect)(()=>{let pe;return ee==="generating"&&te===""&&(pe=setTimeout(()=>{de(new Error(`OpenAI stream timed out after ${j}ms`))},j)),()=>{clearTimeout(pe)}},[ee,te,de]),(ie||le)&&ae(ie||le),{setMessages:q,stopGeneration:ce,messages:Y,reply:te,streamStatus:ee,error:Z,value:J}}var I=e(57725);const K=.5,w=({eventTrackingSrc:G,history:M,messages:Q,onApplySuggestion:Y,updateHistory:q})=>{const te=(0,s.of)(U),[X,ee]=(0,r.useState)(1),[ne,Z]=(0,r.useState)(""),ae=(0,r.useCallback)(we=>{q((0,x.Kb)(we))},[q]),{setMessages:re,stopGeneration:se,reply:de,streamStatus:le,error:he}=N({model:x.C4,temperature:K,onResponse:ae}),ie=(we,Be)=>(0,I.XX)(G,we,Be),J=we=>{Ie(we),ie(I.KR.customFeedback,{customFeedback:we})},ce=()=>{se(),de&&ae(de)},pe=()=>{Y(M[X-1])},Pe=we=>{ee(we),ie(we>X?I.KR.backHistoryItem:I.KR.forwardHistoryItem)},Ie=we=>{re(Be=>[...Be,...(0,x.To)(M[X-1],we)]),we in x.HG&&ie(I.KR.quickFeedback,{quickFeedbackItem:we})},ge=we=>we.key==="Enter"&&J(ne),Se=we=>Z(we.currentTarget.value),De=()=>J(ne),Ke=()=>ie(I.KR.linkToDocs),Me=le===O.GENERATING,be=he&&!Me;return(0,t.jsxs)("div",{className:te.container,children:[be&&(0,t.jsx)(o.F,{title:"",children:(0,t.jsx)(u.B,{direction:"column",children:(0,t.jsx)("p",{children:(0,t.jsx)(y.x6,{i18nKey:"gen-ai.incomplete-request-error",children:"Sorry, I was unable to complete your request. Please try again."})})})}),(0,t.jsx)(m,{history:M,index:X,onNavigate:Pe}),(0,t.jsx)("div",{className:te.actionButtons,children:(0,t.jsx)(E,{onSuggestionClick:Ie,isGenerating:Me})}),(0,t.jsx)(c.p,{placeholder:"Tell AI what to do next...",suffix:(0,t.jsx)(a.$n,{icon:"enter",variant:"secondary",fill:"text","aria-label":"Send custom feedback",onClick:De,disabled:!ne,children:(0,t.jsx)(y.x6,{i18nKey:"gen-ai.send-custom-feedback",children:"Send"})}),value:ne,onChange:Se,onKeyDown:ge}),(0,t.jsx)("div",{className:te.applySuggestion,children:(0,t.jsx)(u.B,{justifyContent:"flex-end",direction:"row",children:Me?(0,t.jsx)(a.$n,{icon:"fa fa-spinner",onClick:ce,children:W}):(0,t.jsx)(a.$n,{icon:"check",onClick:pe,children:(0,t.jsx)(y.x6,{i18nKey:"gen-ai.apply-suggestion",children:"Apply"})})})}),(0,t.jsxs)("div",{className:te.footer,children:[(0,t.jsx)(p.I,{name:"exclamation-circle","aria-label":"exclamation-circle",className:te.infoColor}),(0,t.jsxs)(g.E,{variant:"bodySmall",color:"secondary",children:["This content is AI-generated using the"," ",(0,t.jsx)(h.Y,{variant:"bodySmall",inline:!0,href:"https://grafana.com/docs/grafana-cloud/alerting-and-irm/machine-learning/llm-plugin/",external:!0,onClick:Ke,children:"Grafana LLM plugin"})]})]})]})},U=G=>({container:(0,n.css)({display:"flex",flexDirection:"column",width:520,maxHeight:350,paddingBottom:25}),applySuggestion:(0,n.css)({paddingTop:G.spacing(2)}),actions:(0,n.css)({display:"flex",flexDirection:"row",flexWrap:"wrap"}),footer:(0,n.css)({position:"absolute",bottom:0,left:0,width:"100%",display:"flex",flexDirection:"row",margin:0,padding:G.spacing(1),paddingLeft:G.spacing(2),alignItems:"center",gap:G.spacing(1),borderTop:`1px solid ${G.colors.border.weak}`,marginTop:G.spacing(2)}),infoColor:(0,n.css)({color:G.colors.info.main}),actionButtons:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-between",padding:"24px 0 8px 0"})}),W="Stop generating",H=({text:G="Auto-generate",toggleTipTitle:M="",onClick:Q,model:Y=x.C4,messages:q,onGenerate:te,temperature:X=1,eventTrackingSrc:ee,disabled:ne,tooltip:Z})=>{const ae=(0,s.of)(z),[re,se]=(0,r.useState)([]),de=(0,r.useCallback)(Tt=>{se(ye=>[Tt,...ye])},[]),le=(0,r.useCallback)(Tt=>{const ye=(0,x.Kb)(Tt);te(ye),de(ye)},[te,de]),{setMessages:he,stopGeneration:ie,value:J,error:ce,streamStatus:pe}=N({model:Y,temperature:X,onResponse:le}),[Pe,Ie]=(0,r.useState)(!1),ge=re.length>0,Se=!ge,De=pe===O.GENERATING,Ke=ne||J&&!J.enabled&&!ce,Me=(0,r.useCallback)(Tt=>(0,I.XX)(ee,Tt),[ee]),be=ce||Z?void 0:!1,we=ce?"Failed to generate content using OpenAI. Please try again or if the problem persists, contact your organization admin.":Z||"",Be=Tt=>{pe===O.GENERATING?ie():ge?Ie(!0):(Q?.(Tt),he(pt()));const ye=ce?I.KR.erroredRetryButton:De?I.KR.stopGenerationButton:Se?I.KR.autoGenerateButton:I.KR.improveButton;Me(ye)};if(!J?.enabled)return null;const He=Tt=>{Me(I.KR.applySuggestion),te(Tt),Ie(!1)},Ve=()=>{if(!De)return ce||J&&!J.enabled?"exclamation-circle":"ai"},Je=()=>{let Tt=G;return ce&&(Tt="Retry"),De&&(Tt=W),ge&&(Tt="Improve"),Tt},nt=(0,t.jsx)(a.$n,{icon:Ve(),onClick:Be,fill:"text",size:"sm",disabled:Ke,variant:ce?"destructive":"primary",children:Je()}),pt=()=>typeof q=="function"?q():q,bt=()=>{if(ge){const Tt=(0,t.jsx)(g.E,{element:"p",children:M});return(0,t.jsx)(i.G,{title:Tt,content:(0,t.jsx)(w,{history:re,messages:pt(),onApplySuggestion:He,updateHistory:de,eventTrackingSrc:ee}),placement:"left-start",fitContent:!0,show:Pe,onClose:()=>Ie(!1),onOpen:()=>Ie(!0),children:nt})}return nt};return(0,t.jsxs)("div",{className:ae.wrapper,children:[De&&(0,t.jsx)(l.y,{size:"sm",className:ae.spinner}),Se?(0,t.jsx)(d.m,{show:be,interactive:!0,content:we,children:nt}):bt()]})},z=G=>({wrapper:(0,n.css)({display:"flex"}),spinner:(0,n.css)({color:G.colors.text.link})})},81394:(_,L,e)=>{"use strict";e.d(L,{V:()=>l});var t=e(74848),n=e(14792),r=e(10740),s=e(57725),a=e(3363);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a descriptive and concise dashboard description.
You will be given the title and description of the dashboard's panels.
The dashboard description is meant to explain the purpose of the dashboard and what its panels show.
If the dashboard has no panels, the description should be "Empty dashboard"
There should be no numbers in the description except where they are important.
The dashboard description should not have the dashboard title or any quotation marks in it.
The description should be, at most, 300 characters.
Respond with only the description of the dashboard.`,l=({onGenerate:o})=>{const u=(0,n.UA)().getCurrent(),c=(0,a.N3)(u);return(0,t.jsx)(r.n,{messages:d(u),onGenerate:o,eventTrackingSrc:s.ec.dashboardDescription,toggleTipTitle:"Improve your dashboard description",disabled:c.length===0,tooltip:c.length===0?a.ZN:void 0})};function d(o){return[{content:i,role:a.Xh.system},{content:`The title of the dashboard is "${o.title}"
${(0,a.BB)(o)}`,role:a.Xh.user}]}},27966:(_,L,e)=>{"use strict";e.d(L,{Z:()=>l});var t=e(74848),n=e(14792),r=e(10740),s=e(57725),a=e(3363);const i=`You are an expert in creating Grafana Dashboards.
Your goal is to write a concise dashboard title.
You will be given the title and description of the dashboard's panels.
The dashboard title is meant to say what it shows on one line for users to navigate to it.
If the dashboard has no panels, the title should be "Empty dashboard"
There should be no numbers in the title.
The dashboard title should not have quotation marks in it.
The title should be, at most, 50 characters.
Respond with only the title of the dashboard.`,l=({onGenerate:o})=>{const u=(0,n.UA)().getCurrent(),c=(0,a.N3)(u);return(0,t.jsx)(r.n,{messages:d(u),onGenerate:o,eventTrackingSrc:s.ec.dashboardTitle,toggleTipTitle:"Improve your dashboard title",disabled:c.length===0,tooltip:c.length===0?a.ZN:void 0})};function d(o){return[{content:i,role:a.Xh.system},{content:`The panels in the dashboard are: ${(0,a.BB)(o)}`,role:a.Xh.user}]}},20214:(_,L,e)=>{"use strict";e.d(L,{t:()=>l});var t=e(74848),n=e(14792),r=e(10740),s=e(57725),a=e(3363);const i=`You are an expert in creating Grafana Panels.
You will be given the title and description of the dashboard the panel is in as well as the JSON for the panel.
Your goal is to write a descriptive and concise panel description.
The panel description is meant to explain the purpose of the panel, not just its attributes.
Do not refer to the panel; simply describe its purpose.
There should be no numbers in the description except for thresholds.
The description should be, at most, 200 characters.`,l=({onGenerate:o,panel:u})=>(0,t.jsx)(r.n,{messages:()=>d(u),onGenerate:o,eventTrackingSrc:s.ec.panelDescription,toggleTipTitle:"Improve your panel description"});function d(o){const u=(0,n.UA)().getCurrent(),c=(0,a.hn)(o);return[{content:i,role:a.Xh.system},{content:`The panel is part of a dashboard with the title: ${u.title}
The panel is part of a dashboard with the description: ${u.description}
This is the JSON which defines the panel: ${c}`,role:a.Xh.user}]}},74410:(_,L,e)=>{"use strict";e.d(L,{h:()=>i});var t=e(74848),n=e(10740),r=e(57725),s=e(3363);const g="You are an expert in creating Grafana Panels.Your goal is to write short, descriptive, and concise panel title.The title should be shorter than 50 characters.",i=({onGenerate:d,panel:o,dashboard:u})=>(0,t.jsx)(n.n,{messages:()=>l(o,u),onGenerate:d,eventTrackingSrc:r.ec.panelTitle,toggleTipTitle:"Improve your panel title"});function l(d,o){const u=(0,s.hn)(d);return[{content:g,role:s.Xh.system},{content:`The panel is part of a dashboard with the title: ${o.title}
The panel is part of a dashboard with the description: ${o.description}
Use this JSON object which defines the panel: ${u}`,role:s.Xh.user}]}},57725:(_,L,e)=>{"use strict";e.d(L,{KR:()=>s,XX:()=>a,ec:()=>r});var t=e(14110);const n="dashboards_autogenerate_clicked";var r=(g=>(g.panelDescription="panel-description",g.panelTitle="panel-title",g.dashboardChanges="dashboard-changes",g.dashboardTitle="dashboard-title",g.dashboardDescription="dashboard-description",g.unknown="unknown",g))(r||{}),s=(g=>(g.autoGenerateButton="auto-generate-button",g.erroredRetryButton="errored-retry-button",g.stopGenerationButton="stop-generating-button",g.improveButton="improve-button",g.backHistoryItem="back-history-item",g.forwardHistoryItem="forward-history-item",g.quickFeedback="quick-feedback",g.linkToDocs="link-to-docs",g.customFeedback="custom-feedback",g.applySuggestion="apply-suggestion",g))(s||{});function a(g,i,l){(0,t.rR)(n,{src:g,item:i,...l})}},3363:(_,L,e)=>{"use strict";e.d(L,{ZN:()=>A,C4:()=>P,HG:()=>v,Xh:()=>f,Yy:()=>D,BB:()=>b,To:()=>C,hn:()=>T,N3:()=>R,QX:()=>E,Kb:()=>m});var t=e(2543),n=e(65418),r=e(32264),s=e(36974),a=e(90254),g=e(34214);function i(O,j){return O===j?j:Array.isArray(O)&&Array.isArray(j)?o(O,j):l(O)&&l(j)?d(O,j):j}function l(O){return typeof O=="object"&&!Array.isArray(O)&&O!==null}function d(O,j){const B=Object.keys(O),N={};for(const I of B)j.hasOwnProperty(I)&&(Array.isArray(O[I])&&Array.isArray(j[I])||typeof O[I]=="object"&&typeof j[I]=="object"?N[I]=i(O[I],j[I]):N[I]=j[I]);return N}function o(O,j){const B=new Array(O.length).fill(void 0),N=new Set([...Array(O.length).keys()]),I=new Set([...Array(j.length).keys()]);for(let K=0;K<O.length&&I.size!==0;K++){let w=O[K];for(let U=0;U<j.length;U++){if(!I.has(U))continue;let W=j[U];W=i(w,W),JSON.stringify(w)===JSON.stringify(W)&&(N.delete(K),I.delete(U),B[K]=W)}}return u(O,j,B,N,I),B.filter(K=>K!==void 0)}function u(O,j,B,N,I){let K={};I.forEach(U=>{let W=j[U];if(typeof W!="object"||Array.isArray(W)){B.push(W),I.delete(U);return}N.forEach(H=>{let z=O[H];if(typeof z!="object"||Array.isArray(z)){N.delete(H);return}let G=0;for(const M in z){let Q=z[M];if(!W.hasOwnProperty(M))continue;let Y=W[M];typeof Q!="string"&&typeof Q!="number"||typeof Q!=typeof Y||Q===Y&&(M==="id"&&(G+=1e3),G++)}G!==0&&(K[G]===void 0&&(K[G]=[]),K[G].push([H,U]))})});const w=Object.keys(K).map(Number);w.sort((U,W)=>W-U);for(const U of w){let W=K[U];for(const H of W){const[z,G]=H;N.has(z)&&I.has(G)&&(B[z]=j[G],N.delete(z),I.delete(G))}}for(const U of I)B.push(j[U])}function c(O){const j=O.split(`
`);let B=O[0].startsWith("Index")?4:3,N=j.slice(0,B);const I=/("title"|Title|\{|\}|\[|\])/i;for(let K=B;K<j.length;K++){let w=j[K];(I.test(w)||w.startsWith("+")||w.startsWith("-"))&&N.push(w)}return N.join(`
`)+`
`}function p(O){if(O===null||O==="")return null;if(Array.isArray(O)){const B=O.map(N=>p(N)).filter(N=>N!==null);return B.length>0?B:null}if(typeof O!="object")return O;const j={};for(const B in O){const N=p(O[B]);if(N!==null){if(Array.isArray(N)&&N.length===0||typeof N=="object"&&Object.keys(N).length===0)continue;j[B]=N}}return Object.keys(j).length>0?j:null}function h(O){return JSON.parse(JSON.stringify(O,null,2))}function y(O){let j=h(O.getOriginalDashboard()),B=h(new g.G(j).getSaveModelClone()),N=h(O.getSaveModelClone());B=p(i(j,B)),N=p(i(B,N)),j=p(j);let I=(0,a.ss)("Before migration changes","After migration changes",JSON.stringify(j,null,2),JSON.stringify(B,null,2),"","",{context:20}),K=(0,a.ss)("Before user changes","After user changes",JSON.stringify(B,null,2),JSON.stringify(N,null,2),"","",{context:20});return I=c(I),K=c(K),{migrationDiff:I,userDiff:K}}var f=(O=>(O.system="system",O.user="user",O))(f||{}),v=(O=>(O.Shorter="Even shorter",O.MoreDescriptive="More descriptive",O.Regenerate="Please, regenerate",O))(v||{});const P="gpt-4",m=O=>O.replace(/^"|"$/g,"");function D(O){const{migrationDiff:j,userDiff:B}=y(O);return{userChanges:B,migrationChanges:j}}let x;async function E(){return r.$.apps["grafana-llm-app"]?x||(x=new Promise(O=>{n.vK().then(j=>{j.ok||(x=void 0),O(j.ok)})}),x):!1}const C=(O,j)=>[{role:"system",content:`Your previous response was: ${O}. The user has provided the following feedback: ${j}. Re-generate your response according to the provided feedback.`}];function b(O){const j=R(O);let B;if(j.length<=10)B=`The panels in the dashboard are:
${j.join(`
`)}`;else{const N=O.panels.filter(w=>w.description),I=O.panels.filter(w=>!w.description);let K;N.length>=10?K=N.slice(10).map(S).join(`
`):(K=N.map(S).join(`
`),K+=`
`,K+=I.slice(10-N.length).map(S).join("n")),B=`There are ${j.length} panels.
Due to space constraints, only the information for ten of them is presented.
These ten are not necessarily the first ten, but prioritized to those with descriptions.
The panels in the dashboard are:
${K}`}return B}function T(O){const j=["datasource","title","description","targets","type"],B={...(0,t.pick)(O,j),options:(0,t.pick)(O.options,["content"])};return JSON.stringify(B,null,2)}const A="To generate this content your dashboard must contain at least one panel with a valid title or description.";function R(O){return O.panels.filter(B=>B.title.length>0&&B.title!==s.LH||B.description&&B.description.length>0).map(S)}const S=(O,j)=>`- Panel ${j}
- Title: ${O.title}${O.description?`
- Description: ${O.description}`:""}`},18803:(_,L,e)=>{"use strict";e.d(L,{B6:()=>u,E_:()=>p,jD:()=>c});var t=e(2543),n=e.n(t),r=e(72985),s=e(89667),a=e(52622),g=e(72724),i=e(39070),l=e(32264),d=e(41524),o=e(68706);function u(P){const m=[];if(P?.series)for(const D of P.series)m.push((0,s.Nw)(D));if(P?.annotations)for(const D of P.annotations){const x=(0,s.Nw)(D);x.schema?.meta||(x.schema.meta={}),x.schema.meta.dataTopic=a.QR.Annotations,m.push(x)}return m}function c(P,m){const D=P.getSaveModel(),x={panelType:D.type,datasource:"??"},E=l.$.buildInfo.versionString;let C=`| Key | Value |
|--|--|
| Panel | ${x.panelType} @ ${D.pluginVersion??E} |
| Grafana | ${E} // ${l.$.buildInfo.edition} |
`;return m&&(C+="<details><summary>Panel debug snapshot dashboard</summary>\n\n```json\n"+m+"\n```\n</details>"),C}async function p(P,m,D){const x=P.getSaveModel(),E=(0,t.cloneDeep)(v),C={panelType:x.type,datasource:"??"},b=await(0,r._)(P.getQueryRunner().getData({withFieldConfig:!1,withTransforms:!1})),T=P.datasource,A=(0,d.W)(u(b),m),R=l.$.buildInfo.versionString,S=x?.targets??[],O=`<table width="100%">
    <tr>
      <th width="2%">Panel</th>
      <td >${C.panelType} @ ${x.pluginVersion??R}</td>
    </tr>
    <tr>
      <th>Queries</th>
      <td>${S.map(j=>{const B=j.datasource??T;return`${j.refId}[${B?.type}]`}).join(", ")}</td>
    </tr>
    ${h(x)}
    ${y(b,A)}
    ${f(b)}
    <tr>
      <th>Grafana</th>
      <td>${R} // ${l.$.buildInfo.edition}</td>
    </tr>
  </table>`.trim();if(E.panels[0]={...x,...E.panels[0],targets:[{refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:o.nj.Snapshot,snapshot:A}]},x.transformations?.length){const j=E.panels[E.panels.length-1];j.title=j.title+" (after transformations)";const B=(0,t.cloneDeep)(j);B.id=100,B.title="Data (before transformations)",B.gridPos.w=24,B.targets[0].withTransforms=!1,E.panels.push(B)}return b.annotations?.length&&E.panels.push({id:7,gridPos:{h:6,w:24,x:0,y:20},type:"table",title:"Annotations",datasource:{type:"datasource",uid:"-- Dashboard --"},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,topic:a.QR.Annotations,refId:"A"}]}),E.panels[1].options.content=O,E.panels[2].options.content=JSON.stringify(x,null,2),E.title=`Debug: ${x.title} // ${(0,g.LE)(new Date)}`,E.tags=["debug",`debug-${C.panelType}`],E.time={from:D.from.toISOString(),to:D.to.toISOString()},E}function h(P){return P.transformations?`<tr>
      <th>Transform</th>
      <td>${P.transformations.map(m=>m.id).join(", ")}</td>
  </tr>`:""}function y(P,m){let D=P.series.length??0,x=0,E=0;for(const C of P.series)x+=C.fields.length,E+=C.length;return`<tr><th>Data</th><td>${P.state!==i.Gu.Done?P.state:""} ${D} frames, ${x} fields, ${E} rows </td></tr>`}function f(P){return P.annotations?.length?`<tr>
  <th>Annotations</th>
  <td>${P.annotations.map((m,D)=>`<span>${m.length}</span>`)}</td>
</tr>`:""}const v={panels:[{id:2,title:"Reproduced with embedded data",datasource:{type:"grafana",uid:"grafana"},gridPos:{h:13,w:15,x:0,y:0}},{gridPos:{h:7,w:9,x:15,y:0},id:5,options:{content:"...",mode:"html"},title:"Debug info",type:"text"},{id:6,title:"Original Panel JSON",type:"text",gridPos:{h:13,w:9,x:15,y:7},options:{content:"...",mode:"code",code:{language:"json",showLineNumbers:!0,showMiniMap:!0}}},{id:3,title:"Data from panel above",type:"table",datasource:{type:"datasource",uid:"-- Dashboard --"},gridPos:{h:7,w:15,x:0,y:13},options:{showTypeIcons:!0},targets:[{datasource:{type:"datasource",uid:"-- Dashboard --"},panelId:2,withTransforms:!0,refId:"A"}]}],schemaVersion:37}},65123:(_,L,e)=>{"use strict";e.d(L,{BN:()=>l,kx:()=>d,sd:()=>i});var t=e(96540),n=e(24705),r=e(19347),s=e(8484),a=e(16560),g=e(54612);const i=o=>(0,n.A)(async()=>l(o),[o]).value;async function l(o){const u=o?.request?.targets||[];if(o&&o.series&&u.length){for(const c of o.series)if(c.meta&&c.meta.custom){const p=await(0,r.l)().get(u[0].datasource);if(p&&p.components?.MetadataInspector)return p}}}const d=(o,u,c,p,h)=>(0,t.useMemo)(()=>{const y=[];return(0,g.$)(c)&&(y.push({label:(0,s.t)("dashboard.inspect.data-tab","Data"),value:a.q.Data}),y.push({label:(0,s.t)("dashboard.inspect.stats-tab","Stats"),value:a.q.Stats})),h&&y.push({label:(0,s.t)("dashboard.inspect.meta-tab","Meta data"),value:a.q.Meta}),y.push({label:(0,s.t)("dashboard.inspect.json-tab","JSON"),value:a.q.JSON}),p&&y.push({label:(0,s.t)("dashboard.inspect.error-tab","Error"),value:a.q.Error}),u.meta.canEdit&&(0,g.$)(c)&&y.push({label:(0,s.t)("dashboard.inspect.query-tab","Query"),value:a.q.Query}),y},[c,h,u,p])},57755:(_,L,e)=>{"use strict";e.d(L,{D:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(78685),a=e(13544),g=e(53402),i=e(40845),l=e(55852),d=e(83277),o=e(53466);const u="showCategory",c=r.memo(({id:y,title:f,children:v,forceOpen:P,isOpenDefault:m=!0,renderTitle:D,className:x,itemsCount:E,isNested:C=!1,sandboxId:b})=>{const[T,A]=(0,s.A)(h(y),{isExpanded:m}),[R,S]=(0,r.useState)(T?.isExpanded??m),O=(0,r.useRef)(0),j=(0,r.useRef)(null),[B,N]=(0,d.s)(),I=B[u]===y;(0,r.useEffect)(()=>{O.current&&Date.now()-O.current<200||(I||P)&&(R||S(!0),I&&j.current?.scrollIntoView())},[P,R,I]);const K=(0,r.useCallback)(()=>{O.current=Date.now(),N({[u]:R?void 0:y},!0),A({isExpanded:!R}),S(!R)},[A,S,N,R,y]);D||(D=function(G){return G||E===void 0||E===0?f:(0,t.jsxs)("span",{children:[f," ",(0,t.jsx)(g.p,{value:E})]})});const w=(0,i.of)(p),U=(0,n.cx)({[w.box]:!0,[w.boxNestedExpanded]:C&&R},x),W=(0,n.cx)(w.header,{[w.headerExpanded]:R,[w.headerNested]:C}),H=(0,n.cx)(w.body,{[w.bodyNested]:C});return(0,t.jsxs)("div",{className:U,"data-plugin-sandbox":b,"data-testid":a.Tp.components.OptionsGroup.group(y),ref:j,children:[(0,t.jsxs)("div",{className:W,onClick:K,children:[(0,t.jsx)(l.$n,{"data-testid":a.Tp.components.OptionsGroup.toggle(y),type:"button",fill:"text",size:"sm",variant:"secondary","aria-expanded":R,className:w.toggleButton,icon:R?"angle-down":"angle-right",onClick:K}),(0,t.jsx)("h6",{id:`button-${y}`,className:w.title,children:D(R)})]}),R&&(0,t.jsx)("div",{className:H,id:y,"aria-labelledby":`button-${y}`,children:v})]})});c.displayName="OptionsPaneCategory";const p=y=>({box:(0,n.css)({borderTop:`1px solid ${y.colors.border.weak}`}),boxNestedExpanded:(0,n.css)({marginBottom:y.spacing(2)}),title:(0,n.css)({flexGrow:1,overflow:"hidden",lineHeight:1.5,fontSize:"1rem",paddingLeft:"6px",fontWeight:y.typography.fontWeightMedium,margin:0}),header:(0,n.css)({display:"flex",cursor:"pointer",alignItems:"center",padding:y.spacing(.5),color:y.colors.text.primary,fontWeight:y.typography.fontWeightMedium,"&:hover":{background:y.colors.emphasize(y.colors.background.primary,.03)}}),toggleButton:(0,n.css)({alignSelf:"baseline"}),headerExpanded:(0,n.css)({color:y.colors.text.primary}),headerNested:(0,n.css)({padding:y.spacing(.5,0,.5,0)}),body:(0,n.css)({padding:y.spacing(1,2,1,4)}),bodyNested:(0,n.css)({position:"relative",paddingRight:0,"&:before":{content:"''",position:"absolute",top:0,left:"8px",width:"1px",height:"100%",background:y.colors.border.weak}})}),h=y=>`${o.wi}.optionGroup[${y}]`},48192:(_,L,e)=>{"use strict";e.d(L,{C:()=>r});var t=e(74848),n=e(57755);class r{constructor(a){this.props=a,this.items=[],this.categories=[]}addItem(a){return a.parent=this,this.items.push(a),this}addCategory(a){return a.props.isNested=!0,a.parent=this,this.categories.push(a),this}getCategory(a){let g=this.categories.find(i=>i.props.id===a);return g||(g=new r({title:a,id:a}),this.addCategory(g)),g}render(a){return this.props.customRender?this.props.customRender():(0,t.jsxs)(n.D,{...this.props,children:[this.items.map(g=>g.render(a)),this.categories.map(g=>g.render(a))]},this.props.title)}}},74097:(_,L,e)=>{"use strict";e.d(L,{v:()=>c});var t=e(74848),n=e(32196),r=e(23257),s=e.n(r),a=e(13544),g=e(60029),i=e(88575),l=e(40845),d=e(56034);function o({overrides:y}){const f=(0,l.of)(u);return(0,t.jsx)("div",{className:f.wrapper,children:y.map((v,P)=>(0,t.jsx)(d.m,{content:v.tooltip,placement:"top",children:(0,t.jsx)("div",{"aria-label":v.description,className:f[v.type]})},P.toString()))})}const u=y=>{const f={width:8,height:8,borderRadius:y.shape.radius.circle,marginLeft:y.spacing(1),top:"-1px"};return{wrapper:(0,n.css)({display:"flex"}),rule:(0,n.css)({...f,position:"relative",backgroundColor:y.colors.primary.main}),data:(0,n.css)({...f,position:"relative",backgroundColor:y.colors.warning.main})}};class c{constructor(f){this.props=f}getLabel(f){const{title:v,description:P,overrides:m,addon:D}=this.props;if(!f)return this.parent.props.title===v&&!m?.length?null:(0,t.jsx)(p,{title:v,description:P,overrides:m,addon:D});const x=[];return this.parent.parent&&x.push(this.highlightWord(this.parent.parent.props.title,f)),this.parent.props.title!==v&&x.push(this.highlightWord(this.parent.props.title,f)),(0,t.jsxs)(g.J,{description:P&&this.highlightWord(P,f),category:x,children:[this.highlightWord(v,f),m&&m.length>0&&(0,t.jsx)(o,{overrides:m})]})}highlightWord(f,v){return(0,t.jsx)(s(),{textToHighlight:f,searchWords:[v],highlightClassName:"search-fragment-highlight"})}renderOverrides(){const{overrides:f}=this.props;!f||f.length}render(f){const{title:v,description:P,render:m,showIf:D,skipField:x}=this.props,E=`${this.parent.props.id} ${v}`;return D&&!D()?null:x?m():(0,t.jsx)(i.D,{label:this.getLabel(f),description:P,"aria-label":a.Tp.components.PanelEditor.OptionsPane.fieldLabel(E),children:m()},E)}}function p({title:y,description:f,overrides:v,addon:P}){const m=(0,l.of)(h);return(0,t.jsxs)("div",{className:m.container,children:[(0,t.jsxs)(g.J,{description:f,children:[y,v&&v.length>0&&(0,t.jsx)(o,{overrides:v})]}),P]})}function h(y){return{container:(0,n.css)({display:"flex",justifyContent:"space-between"})}}},26443:(_,L,e)=>{"use strict";e.d(L,{gs:()=>ee,Ff:()=>te,Po:()=>ne});var t=e(74848),n=e(32196),r=e(96540),s=e(32264),a=e(40845),g=e(67647),i=e(94354),l=e(40276),d=e(74106),o=e(82792),u=e(71468),c=e(7376),p=e(79971),h=e(40334),y=e(33390);function f(ae,re){y.A.set(`panel-edit-section-${ae}`,re?"true":"false")}function v(ae,re){return y.A.getBool(`panel-edit-section-${ae}`,re)}const P=(ae,re)=>({angularPanelComponent:(0,h.U)(ae,re.panel)?.angularComponent}),m={changePanelPlugin:p.gW},D=(0,u.connect)(P,m);class x extends r.PureComponent{constructor(re){super(re)}componentDidMount(){this.loadAngularOptions()}componentDidUpdate(re){(this.props.plugin!==re.plugin||this.props.angularPanelComponent!==re.angularPanelComponent)&&this.cleanUpAngularOptions(),this.loadAngularOptions()}componentWillUnmount(){this.cleanUpAngularOptions()}cleanUpAngularOptions(){this.angularOptions&&(this.angularOptions.destroy(),this.angularOptions=null)}loadAngularOptions(){const{panel:re,angularPanelComponent:se,changePanelPlugin:de}=this.props;if(!this.element||!se||this.angularOptions)return;const le=se.getScope();if(!le.$$childHead){setTimeout(()=>{this.forceUpdate()});return}const he=le.$$childHead.ctrl;he.initEditMode(),he.onPluginTypeChange=pe=>{de({panel:re,pluginId:pe.id})};let ie="";for(let pe=0;pe<he.editorTabs.length;pe++){const Pe=he.editorTabs[pe];Pe.isOpen=v(Pe.title,pe===0),ie+=`
      <div class="panel-options-group" ng-cloak>
        <div class="panel-options-group__header" ng-click="toggleOptionGroup(${pe})" aria-label="${Pe.title} section">
          <div class="panel-options-group__icon">
            <icon name="ctrl.editorTabs[${pe}].isOpen ? 'angle-down' : 'angle-right'"></icon>
          </div>
          <div class="panel-options-group__title">${Pe.title}</div>
        </div>
        <div class="panel-options-group__body" ng-if="ctrl.editorTabs[${pe}].isOpen">
          <panel-editor-tab editor-tab="ctrl.editorTabs[${pe}]" ctrl="ctrl"></panel-editor-tab>
        </div>
      </div>
      `}const J=(0,c.E)(),ce={ctrl:he,toggleOptionGroup:pe=>{const Pe=he.editorTabs[pe];Pe.isOpen=!Pe.isOpen,f(Pe.title,!!Pe.isOpen)}};this.angularOptions=J.load(this.element,ce,ie),this.angularOptions.digest()}render(){return(0,t.jsx)("div",{ref:re=>this.element=re})}}const E=(0,u.connect)(P,m)(x);var C=e(57755),b=e(22290),T=e(10354);const A=({panel:ae,formatDate:re})=>{const se=(0,a.of)(R),de=ae.libraryPanel?.meta;return de?(0,t.jsxs)("div",{className:se.info,children:[(0,t.jsxs)("div",{className:se.libraryPanelInfo,children:[`Used on ${de.connectedDashboards} `,de.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:se.libraryPanelInfo,children:["Last edited on ",re?.(de.updated,"L")??de.updated," by",de.updatedBy.avatarUrl&&(0,t.jsx)("img",{width:"22",height:"22",className:se.userAvatar,src:de.updatedBy.avatarUrl,alt:`Avatar for ${de.updatedBy.name}`}),de.updatedBy.name]})]}):null},R=ae=>({info:(0,n.css)`
      line-height: 1;
    `,libraryPanelInfo:(0,n.css)`
      color: ${ae.colors.text.secondary};
      font-size: ${ae.typography.bodySmall.fontSize};
    `,userAvatar:(0,n.css)`
      border-radius: ${ae.shape.radius.circle};
      box-sizing: content-box;
      width: 22px;
      height: 22px;
      padding-left: ${ae.spacing(1)};
      padding-right: ${ae.spacing(1)};
    `});var S=e(48192),O=e(74097);function j(ae){const{panel:re,onPanelConfigChange:se,dashboard:de}=ae,le=new S.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return(0,o.X)(re)&&le.addItem(new O.v({title:"Name",value:re.libraryPanel.name,popularRank:1,render:function(){return(0,t.jsx)(T.p,{id:"LibraryPanelFrameName",defaultValue:re.libraryPanel.name,onBlur:ie=>se("libraryPanel",{...re.libraryPanel,name:ie.currentTarget.value})})}})).addItem(new O.v({title:"Information",render:function(){return(0,t.jsx)(A,{panel:re,formatDate:de.formatDate})}})),le}var B=e(13544),N=e(21744),I=e(15292),K=e(64919),w=e(90182),U=e(29304),W=e(20214),H=e(74410),z=e(92378);function G(ae){const{dashboard:re,panel:se,onPanelConfigChange:de}=ae,le=new S.C({title:"Panel options",id:"Panel options",isOpenDefault:!0}),he=J=>{const ce=document.getElementById("PanelFrameTitle");ce instanceof HTMLInputElement&&(ce.value=J,de("title",J))},ie=J=>{const ce=document.getElementById("description-text-area");ce instanceof HTMLTextAreaElement&&(ce.value=J,de("description",J))};return le.addItem(new O.v({title:"Title",value:se.title,popularRank:1,render:function(){return(0,t.jsx)(T.p,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Title"),id:"PanelFrameTitle",defaultValue:se.title,onBlur:ce=>de("title",ce.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(H.h,{onGenerate:he,panel:se.getSaveModel(),dashboard:re.getSaveModelClone()})})).addItem(new O.v({title:"Description",description:se.description,value:se.description,render:function(){return(0,t.jsx)(N.f,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Description"),id:"description-text-area",defaultValue:se.description,onBlur:ce=>de("description",ce.currentTarget.value)})},addon:s.$.featureToggles.dashgpt&&(0,t.jsx)(W.t,{onGenerate:ie,panel:se.getSaveModel()})})).addItem(new O.v({title:"Transparent background",render:function(){return(0,t.jsx)(I.d,{"data-testid":B.Tp.components.PanelEditor.OptionsPane.fieldInput("Transparent background"),value:se.transparent,id:"transparent-background",onChange:ce=>de("transparent",ce.currentTarget.checked)})}})).addCategory(new S.C({title:"Panel links",id:"Panel links",isOpenDefault:!1,itemsCount:se.links?.length}).addItem(new O.v({title:"Panel links",render:function(){return(0,t.jsx)(K.e,{links:se.links,onChange:ce=>de("links",ce),getSuggestions:U.Fq,data:[]})}}))).addCategory(new S.C({title:"Repeat options",id:"Repeat options",isOpenDefault:!1}).addItem(new O.v({title:"Repeat by variable",description:"Repeat this panel for each value in the selected variable. This is not visible while in edit mode. You need to go back to dashboard and then update the variable or reload the dashboard.",render:function(){return(0,t.jsx)(z.G,{id:"repeat-by-variable-select",repeat:se.repeat,onChange:ce=>{de("repeat",ce)}})}})).addItem(new O.v({title:"Repeat direction",showIf:()=>!!se.repeat,render:function(){const ce=[{label:"Horizontal",value:"h"},{label:"Vertical",value:"v"}];return(0,t.jsx)(i.z,{options:ce,value:se.repeatDirection||"h",onChange:pe=>de("repeatDirection",pe)})}})).addItem(new O.v({title:"Max per row",showIf:()=>!!(se.repeat&&se.repeatDirection==="h"),render:function(){const ce=[2,3,4,6,8,12].map(pe=>({label:pe.toString(),value:pe}));return(0,t.jsx)(w.l6,{options:ce,value:se.maxPerRow,onChange:pe=>de("maxPerRow",pe.value)})}})))}var M=e(66211);class Q{constructor(re,se){this.categories=re,this.overrides=se}search(re){const se=new RegExp(re,"i"),le=this.collectHits(this.categories,se,[]).sort(Y).map(J=>J.item),ie=this.collectHits(this.overrides,se,[]).sort(Y).map(J=>J.item);return{optionHits:le,overrideHits:this.buildOverrideHitCategories(ie),totalCount:this.getAllOptionsCount(this.categories)}}collectHits(re,se,de){for(const le of re){const he=se.test(le.props.title);for(const ie of le.items){if(se.test(ie.props.title)){de.push({item:ie,rank:1});continue}if(ie.props.description&&se.test(ie.props.description)){de.push({item:ie,rank:2});continue}he&&de.push({item:ie,rank:3})}le.categories.length>0&&this.collectHits(le.categories,se,de)}return de}getAllOptionsCount(re){let se=0;for(const de of re)se+=de.items.length,de.categories.length>0&&(se+=this.getAllOptionsCount(de.categories));return se}buildOverrideHitCategories(re){const se={};for(const de of re){let le=se[de.parent.props.title];le||(le=se[de.parent.props.title]=new S.C(de.parent.props),le.addItem(de.parent.items[0])),le.items[0].props.title!==de.props.title&&le.addItem(de)}return Object.values(se)}}function Y(ae,re){return ae.rank-re.rank}function q(ae){const re=[];for(const se of ae)for(const de of se.items)de.props.title==="Unit"&&(de.props.popularRank=2),de.props.title==="Min"&&(de.props.popularRank=3),de.props.title==="Max"&&(de.props.popularRank=4),de.props.title==="Display name"&&(de.props.popularRank=5),de.props.popularRank&&re.push(de);return re.sort((se,de)=>se.props.popularRank-de.props.popularRank)}const te=ae=>{const{plugin:re,dashboard:se,panel:de}=ae,[le,he]=(0,r.useState)(""),[ie,J]=(0,r.useState)("All"),ce=(0,a.of)(Z),[pe,Pe,Ie]=(0,r.useMemo)(()=>[G(ae),(0,M.Zm)(ae),j(ae)],[de.configRev,ae.data,ae.instanceState,le]),ge=(0,r.useMemo)(()=>(0,b.v)(ae.panel.fieldConfig,ae.plugin.fieldConfigRegistry,ae.data?.series??[],le,ae.onFieldConfigsChange),[de.configRev,ae.data,ae.instanceState,le]),Se=[],De=le.length>0,Ke=(0,r.useMemo)(X,[]),Me=(0,o.X)(de)?[Ie,pe,...Pe]:[pe,...Pe];if(De)Se.push(ne(Me,ge,le)),ae.plugin.angularPanelCtrl&&Se.push((0,t.jsx)("div",{className:ce.searchNotice,children:"This is an old visualization type that does not support searching all options."},"Search notice"));else switch(ie){case"All":(0,o.X)(de)&&Se.push(Ie.render()),Se.push(pe.render()),ae.plugin.angularPanelCtrl&&Se.push((0,t.jsx)(E,{plugin:re,dashboard:se,panel:de},"AngularOptions"));for(const we of Pe)Se.push(we.render());for(const we of ge)Se.push(we.render());break;case"Overrides":for(const we of ge)Se.push(we.render());break;case"Recent":Se.push((0,t.jsx)(C.D,{id:"Recent options",title:"Recent options",forceOpen:1,children:q(Me).map(we=>we.render())},"Recent options"));break}const be=!De&&!re.fieldConfigRegistry.isEmpty();return(0,t.jsxs)("div",{className:ce.wrapper,children:[(0,t.jsxs)("div",{className:ce.formBox,children:[de.isAngularPlugin()&&!re.meta.angular?.hideDeprecation&&(0,t.jsx)(d.c,{className:ce.angularDeprecationWrapper,showPluginDetailsLink:!0,pluginId:re.meta.id,pluginType:re.meta.type,angularSupportEnabled:s.$?.angularSupportEnabled,interactionElementId:"panel-options"}),(0,t.jsx)("div",{className:ce.formRow,children:(0,t.jsx)(g.Z,{width:0,value:le,onChange:he,placeholder:"Search options"})}),be&&(0,t.jsx)("div",{className:ce.formRow,children:(0,t.jsx)(i.z,{options:Ke,value:ie,fullWidth:!0,onChange:J})})]}),(0,t.jsx)("div",{className:ce.scrollWrapper,children:(0,t.jsx)(l.E,{autoHeightMin:"100%",children:(0,t.jsx)("div",{className:ce.mainBox,children:Se})})})]})};function X(){return[{label:"All",value:"All"},{label:"Overrides",value:"Overrides"}]}var ee=(ae=>(ae.All="All",ae.Overrides="Overrides",ae.Recent="Recent",ae))(ee||{});function ne(ae,re,se){const de=new Q(ae,re),{optionHits:le,totalCount:he,overrideHits:ie}=de.search(se);return(0,t.jsxs)("div",{children:[(0,t.jsx)(C.D,{id:"Found options",title:`Matched ${le.length}/${he} options`,forceOpen:1,children:le.map(J=>J.render(se))},"Normal options"),ie.map(J=>J.render(se))]},"search results")}const Z=ae=>({wrapper:(0,n.css)({height:"100%",display:"flex",flexDirection:"column",flex:"1 1 0",".search-fragment-highlight":{color:ae.colors.warning.text,background:"transparent"}}),searchBox:(0,n.css)({display:"flex",flexDirection:"column",minHeight:0}),formRow:(0,n.css)({marginBottom:ae.spacing(1)}),formBox:(0,n.css)({padding:ae.spacing(1),background:ae.colors.background.primary,border:`1px solid ${ae.components.panel.borderColor}`,borderTopLeftRadius:ae.shape.borderRadius(1.5),borderBottom:"none"}),closeButton:(0,n.css)({marginLeft:ae.spacing(1)}),searchHits:(0,n.css)({padding:ae.spacing(1,1,0,1)}),scrollWrapper:(0,n.css)({flexGrow:1,minHeight:0}),searchNotice:(0,n.css)({fontSize:ae.typography.size.sm,color:ae.colors.text.secondary,padding:ae.spacing(1),textAlign:"center"}),mainBox:(0,n.css)({background:ae.colors.background.primary,border:`1px solid ${ae.components.panel.borderColor}`,borderTop:"none",flexGrow:1}),angularDeprecationWrapper:(0,n.css)({padding:ae.spacing(1)})})},22290:(_,L,e)=>{"use strict";e.d(L,{v:()=>A});var t=e(74848),n=e(32196),r=e(2543),s=e(85200),a=e(37055),g=e(84349),i=e(51986),l=e(40845),d=e(29304),o=e(96540),u=e(23257),c=e.n(u),p=e(66864),h=e(60029),y=e(53402),f=e(29158),v=e(88575),P=e(57755);const m=({property:j,context:B,registry:N,onChange:I,onRemove:K,isSystemOverride:w,searchQuery:U})=>{const W=(0,l.of)(D),H=N?.getIfExists(j.id),z=(0,o.useId)();if(!H)return null;const G=Array.isArray(j.value)||j.id===a.uo.Thresholds||j.id===a.uo.Links||j.id===a.uo.Mappings,M=H.category?.filter(q=>q!==H.name);let Q;const Y=(q=!0,te=!1)=>(X=!1)=>(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsxs)(h.J,{category:M,description:q?H.description:void 0,htmlFor:z,children:[(0,t.jsx)(c(),{textToHighlight:H.name,searchWords:[U],highlightClassName:"search-fragment-highlight"}),!X&&te&&H.getItemsCount&&(0,t.jsx)(y.p,{value:H.getItemsCount(j.value)})]}),!w&&(0,t.jsx)("div",{children:(0,t.jsx)(f.K,{name:"times",onClick:K,tooltip:"Remove label"})})]});return G?Q=(0,t.jsx)(P.D,{id:H.name,renderTitle:Y(!1,!0),className:(0,n.css)({paddingLeft:0,paddingRight:0}),isNested:!0,isOpenDefault:j.value!==void 0,children:(0,t.jsx)(H.override,{value:j.value,onChange:q=>{I(q)},item:H,context:B})}):Q=(0,t.jsx)("div",{children:(0,t.jsx)(v.D,{label:Y()(),description:H.description,children:(0,t.jsx)(H.override,{value:j.value,onChange:q=>{I(q)},item:H,context:B,id:z})})}),(0,t.jsx)("div",{className:(0,n.cx)(G&&W.collapsibleOverrideEditor,!G&&"dynamicConfigValueEditor--nonCollapsible"),children:Q})},D=j=>({collapsibleOverrideEditor:(0,n.css)({label:"collapsibleOverrideEditor","& + .dynamicConfigValueEditor--nonCollapsible":{marginTop:j.spacing(1)}})});var x=e(48192),E=e(74097),C=e(14578);const b=({isExpanded:j,registry:B,matcherUi:N,overrideName:I,override:K,onOverrideRemove:w})=>{const U=(0,l.of)(T),H=K.properties.map(G=>B.getIfExists(G.id)).filter(G=>!!G).map(G=>G?.name).join(", "),z=N.optionsToLabel(K.matcher.options);return(0,t.jsxs)("div",{children:[(0,t.jsxs)(p.Gy,{justify:"space-between",children:[(0,t.jsx)("div",{children:I}),(0,t.jsx)(f.K,{name:"trash-alt",onClick:w,tooltip:"Remove override"})]}),!j&&(0,t.jsx)("div",{className:U.overrideDetails,children:(0,t.jsxs)("div",{className:U.options,title:z,children:[z," ",(0,t.jsx)(C.I,{name:"angle-right"})," ",H]})})]})};b.displayName="OverrideTitle";const T=j=>({matcherUi:(0,n.css)({padding:j.spacing(1)}),propertyPickerWrapper:(0,n.css)({marginTop:j.spacing(2)}),overrideDetails:(0,n.css)({fontSize:j.typography.bodySmall.fontSize,color:j.colors.text.secondary,fontWeight:j.typography.fontWeightRegular}),options:(0,n.css)({overflow:"hidden",paddingRight:j.spacing(4)}),unknownLabel:(0,n.css)({marginBottom:0})});function A(j,B,N,I,K){const w=[],U=j;if(!B||B.isEmpty())return[];const W=(M,Q)=>{let Y=(0,r.cloneDeep)(U.overrides);Y[M]=Q,K({...U,overrides:Y})},H=M=>{let Q=(0,r.cloneDeep)(U.overrides);Q.splice(M,1),K({...U,overrides:Q})},z=M=>{const Q=s.sJ.get(M.value);Q&&K({...U,overrides:[...U.overrides,{matcher:{id:Q.id,options:Q.defaultOptions},properties:[]}]})},G={data:N,getSuggestions:M=>(0,d.Hf)(N,M),isOverride:!0};for(let M=0;M<U.overrides.length;M++){const Q=U.overrides[M],Y=`Override ${M+1}`,q=g.g.get(Q.matcher.id),te=R(B),X=(0,a.Ow)(Q),ee=Q.properties.length===0?1:0,ne=new x.C({title:Y,id:Y,forceOpen:ee,renderTitle:function(se){return(0,t.jsx)(b,{override:Q,isExpanded:se,registry:B,overrideName:Y,matcherUi:q,onOverrideRemove:()=>H(M)})}}),Z=re=>{W(M,{...Q,matcher:{...Q.matcher,options:re}})},ae=(re,se)=>{const de=B.get(se.value),le={id:de.id,value:de.defaultValue},he=re.properties??[];he.push(le),W(M,{...re,properties:he})};ne.addItem(new E.v({title:q.name,render:function(){return(0,t.jsx)(q.component,{id:`${q.matcher.id}-${M}`,matcher:q.matcher,data:N??[],options:Q.matcher.options,onChange:Z})}}));for(let re=0;re<Q.properties.length;re++){const se=Q.properties[re],de=B.getIfExists(se.id);if(!de)continue;const le=ie=>{W(M,{...Q,properties:Q.properties.map((J,ce)=>ce===re?{...J,value:ie}:J)})},he=()=>{W(M,{...Q,properties:Q.properties.filter((ie,J)=>J!==re)})};ne.addItem(new E.v({title:de.name,skipField:!0,render:function(){return(0,t.jsx)(m,{isSystemOverride:X,onChange:le,onRemove:he,property:se,registry:B,context:G,searchQuery:I},`${se.id}/${re}`)}}))}!X&&Q.matcher.options&&ne.addItem(new E.v({title:"----------",skipField:!0,render:function(){return(0,t.jsx)(i.i,{label:"Add override property",variant:"secondary",isFullWidth:!0,icon:"plus",menuPlacement:"auto",options:te,onChange:se=>ae(Q,se)},"Add override property")}})),w.push(ne)}return w.push(new x.C({title:"add button",id:"add button",customRender:function(){return(0,t.jsx)(S,{children:(0,t.jsx)(i.i,{icon:"plus",label:"Add field override",variant:"secondary",menuPlacement:"auto",isFullWidth:!0,size:"md",options:g.g.list().filter(Q=>!Q.excludeFromPicker).map(Q=>({label:Q.name,value:Q.id,description:Q.description})),onChange:Q=>z(Q)})},"Add override")}})),w}function R(j){return j.list().filter(B=>!B.hideFromOverrides).map(B=>{let N=B.name;return B.category&&(N=[...B.category,B.name].join(" > ")),{label:N,value:B.id,description:B.description}})}function S({children:j}){const B=(0,l.of)(O);return(0,t.jsx)("div",{className:B,children:j})}function O(j){return(0,n.css)({borderTop:`1px solid ${j.colors.border.weak}`,padding:`${j.spacing(2)}`,display:"flex"})}},66211:(_,L,e)=>{"use strict";e.d(L,{g5:()=>x,tN:()=>m,Zm:()=>P,Z4:()=>D});var t=e(74848),n=e(2543),r=e(60264),s=e(10354),a=e(32196),g=e(72724),i=e(40845);const l=({libraryPanel:E})=>{const C=(0,i.of)(d),b=E.useState(),T=b.$timeRange?.getTimeZone(),A=b._loadedPanel?.meta;return A?(0,t.jsxs)("div",{className:C.info,children:[(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[`Used on ${A.connectedDashboards} `,A.connectedDashboards===1?"dashboard":"dashboards"]}),(0,t.jsxs)("div",{className:C.libraryPanelInfo,children:[(0,g.LE)(A.updated,{format:"L",timeZone:T})," by",A.updatedBy.avatarUrl&&(0,t.jsx)("img",{className:C.userAvatar,src:A.updatedBy.avatarUrl,alt:`Avatar for ${A.updatedBy.name}`}),A.updatedBy.name]})]}):null},d=E=>({info:(0,a.css)({lineHeight:1}),libraryPanelInfo:(0,a.css)({color:E.colors.text.secondary,fontSize:E.typography.bodySmall.fontSize}),userAvatar:(0,a.css)({borderRadius:E.shape.radius.circle,boxSizing:"content-box",width:"22px",height:"22px",paddingLeft:E.spacing(1),paddingRight:E.spacing(1)})});var o=e(29304),u=e(48192),c=e(74097);const p="Some data fields have this option pre-configured. Add a field override rule to override the pre-configured value.",h="An override rule exists for this property";function y(E,C,b){const T=[];if(b){for(const R of b)for(const S of R.fields)if((0,n.get)(S.config,E.path)!=null){T.push({type:"data",description:p,tooltip:p});break}}return C.overrides.some(R=>R.properties.some(S=>S.id===E.id))&&T.push({type:"rule",description:h,tooltip:h}),T}var f=e(54612);function v({data:E,replaceVariables:C,options:b,eventBus:T,instanceState:A}){const R=E?.series??[];return{data:R,replaceVariables:C,options:b,eventBus:T,getSuggestions:O=>(0,o.Hf)(R,O),instanceState:A}}function P(E){const{plugin:C,panel:b,onPanelOptionsChanged:T,onFieldConfigsChange:A,data:R,dashboard:S,instanceState:O}=E,j=b.getOptions(),B=b.fieldConfig,N={},I=v({data:R,replaceVariables:b.replaceVariables,options:j,eventBus:S.events,instanceState:O}),K=U=>{const W=(U&&U[0])??`${C.meta.name}`,H=N[W];return H||(N[W]=new u.C({title:W,id:W,sandboxId:C.meta.id}))},w={getValue:U=>(0,n.get)(j,U),onChange:(U,W)=>{const H=(0,f.Sf)(j,U,W);T(H)}};x(C.getPanelOptionsSupplier(),w,K,I);for(const U of C.fieldConfigRegistry.list()){if(U.isCustom){if(U.showIf&&!U.showIf(B.defaults.custom,R?.series))continue}else if(U.showIf&&!U.showIf(B.defaults,R?.series))continue;if(U.hideFromDefaults)continue;const W=K(U.category),H=U.editor,z=B.defaults,G=U.isCustom?z.custom?(0,n.get)(z.custom,U.path):void 0:(0,n.get)(z,U.path);U.getItemsCount&&(W.props.itemsCount=U.getItemsCount(G)),W.addItem(new c.v({title:U.name,description:U.description,overrides:y(U,B,R?.series),render:function(){const Q=Y=>{A((0,f.EQ)(B,U.path,Y,U.isCustom))};return(0,t.jsx)(H,{value:G,onChange:Q,item:U,context:I,id:U.id})}}))}return Object.values(N)}function m(E){const C=new u.C({title:"Library panel options",id:"Library panel options",isOpenDefault:!0});return C.addItem(new c.v({title:"Name",value:E,popularRank:1,render:function(){return(0,t.jsx)(s.p,{id:"LibraryPanelFrameName","data-testid":"library panel name input",defaultValue:E.state.name,onBlur:T=>E.setState({name:T.currentTarget.value})})}})).addItem(new c.v({title:"Information",render:function(){return(0,t.jsx)(l,{libraryPanel:E})}})),C}function D(E){const{plugin:C,panel:b,data:T,eventBus:A,instanceState:R}=E,S={},O=K=>{const w=K?.[0]??C.meta.name,U=S[w];return U||(S[w]=new u.C({title:w,id:w,sandboxId:C.meta.id}))},j=b.state.options,B={getValue:K=>(0,n.get)(j,K),onChange:(K,w)=>{const U=(0,f.Sf)(j,K,w);b.onOptionsChange(U)}},N=v({data:T,replaceVariables:b.interpolate,options:j,eventBus:A,instanceState:R});x(C.getPanelOptionsSupplier(),B,O,N);const I=b.state.fieldConfig;for(const K of C.fieldConfigRegistry.list()){const w=K.showIf&&(K.isCustom?!K.showIf(I.defaults.custom,T?.series):!K.showIf(I.defaults,T?.series));if(K.hideFromDefaults||w)continue;const U=O(K.category),W=K.editor,H=I.defaults,z=K.isCustom?H.custom?(0,n.get)(H.custom,K.path):void 0:(0,n.get)(H,K.path);K.getItemsCount&&(U.props.itemsCount=K.getItemsCount(z)),U.addItem(new c.v({title:K.name,description:K.description,overrides:y(K,I,T?.series),render:function(){const M=Q=>{b.onFieldConfigChange((0,f.EQ)(I,K.path,Q,K.isCustom),!0)};return(0,t.jsx)(W,{value:z,onChange:M,item:K,context:N,id:K.id})}}))}return Object.values(S)}function x(E,C,b,T,A){const R=new r.pv;E(R,T);for(const S of R.getItems()){if(S.showIf&&!S.showIf(T.options,T.data))continue;let O=A;if(O?S.category?.[0]?.length&&(O=O.getCategory(S.category[0])):O=b(S.category),(0,r.iF)(S)){const B=S.getNestedValueAccess(C),N=B.getContext?B.getContext(T):{...T,options:C.getValue(S.path)};x(S.getBuilder(),B,b,N,O);continue}const j=S.editor;O.addItem(new c.v({title:S.name,description:S.description,render:function(){return(0,t.jsx)(j,{value:C.getValue(S.path),onChange:N=>{C.onChange(S.path,N)},item:S,context:T,id:S.id})}}))}}},53466:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>m,GU:()=>u,MJ:()=>p,Ox:()=>h,eK:()=>f,fR:()=>y,kw:()=>v,wi:()=>i});var t=e(65307),n=e(39070),r=e(43127),s=e(33390),a=e(84423),g=e(32696);const i="grafana.dashboard.editor.ui",l={isPanelOptionsVisible:!0,rightPaneSize:400,topPaneSize:.45,mode:g.q5.Fill},d=()=>{const D=s.A.getObject(i,l);let x={...D};return typeof D.topPaneSize=="string"&&(x={...D,topPaneSize:parseFloat(D.topPaneSize)/100}),{getPanel:()=>new a.a9({}),getSourcePanel:()=>new a.a9({}),getData:()=>({state:n.Gu.NotStarted,series:[],timeRange:(0,r.E2)()}),initDone:!1,shouldDiscardChanges:!1,isOpen:!1,isVizPickerOpen:!1,tableViewEnabled:!1,ui:{...l,...x}}},o=(0,t.Z0)({name:"panelEditor",initialState:d(),reducers:{updateEditorInitState:(D,x)=>{D.getPanel=()=>x.payload.panel,D.getSourcePanel=()=>x.payload.sourcePanel,D.initDone=!0,D.isOpen=!0,D.shouldDiscardChanges=!1},setEditorPanelData:(D,x)=>{D.getData=()=>x.payload},setDiscardChanges:(D,x)=>{D.shouldDiscardChanges=x.payload},setPanelEditorUIState:(D,x)=>{D.ui={...D.ui,...x.payload},!D.ui.isPanelOptionsVisible&&D.isVizPickerOpen&&(D.isVizPickerOpen=!1)},toggleVizPicker:(D,x)=>{D.isVizPickerOpen=x.payload,D.isVizPickerOpen&&(D.ui.isPanelOptionsVisible=!0)},toggleTableView(D){D.tableViewEnabled=!D.tableViewEnabled},closeEditor:D=>{D.getPanel=()=>new a.a9({}),D.getSourcePanel=()=>new a.a9({}),D.isOpen=!1,D.initDone=!1,D.isVizPickerOpen=!1,D.tableViewEnabled=!1}}}),{updateEditorInitState:u,setEditorPanelData:c,setDiscardChanges:p,closeEditor:h,setPanelEditorUIState:y,toggleVizPicker:f,toggleTableView:v}=o.actions,m={panelEditor:o.reducer}},32696:(_,L,e)=>{"use strict";e.d(L,{M8:()=>t,Nt:()=>s,__:()=>g,q5:()=>n});var t=(i=>(i.Query="query",i.Transform="transform",i.Visualize="visualize",i.Alert="alert",i))(t||{}),n=(i=>(i[i.Fill=0]="Fill",i[i.Fit=1]="Fit",i[i.Exact=2]="Exact",i))(n||{}),r=(i=>(i[i.Off=0]="Off",i[i.Table=1]="Table",i))(r||{});const s=[{value:0,label:"Fill",description:"Use all available space"},{value:2,label:"Actual",description:"Make same size as on the dashboard"}],a=[{value:0,label:"Visualization",description:"Show using selected visualization"},{value:1,label:"Table",description:"Show raw data in table form"}];var g=(i=>(i[i.Visualizations=0]="Visualizations",i[i.LibraryPanels=1]="LibraryPanels",i[i.Suggestions=2]="Suggestions",i[i.Widgets=3]="Widgets",i))(g||{})},54612:(_,L,e)=>{"use strict";e.d(L,{$:()=>g,A:()=>a,EQ:()=>i,Sf:()=>l});var t=e(2543),n=e.n(t),r=e(15054),s=e(32696);function a(d,o,u,c){if(d===s.q5.Fill)return{width:o,height:u};const p=8*6,f=(window.innerWidth-60-r.dU*4)/r.cV*c.gridPos.w,v=r.sD*c.gridPos.h+p,P=Math.min(o/f,u/v);return f<=o&&v<=u?{width:f,height:v}:{width:f*P,height:v*P}}function g(d){return d?.meta.skipDataQuery===!1}const i=(d,o,u,c)=>{let p={...d.defaults};const h=u==null||u==="";return c?p.custom?h?p.custom=(0,t.omit)(p.custom,o):p.custom=l(p.custom,o,u):h||(p.custom=l(p.custom,o,u)):h?p=(0,t.omit)(p,o):p=l(p,o,u),{...d,defaults:p}};function l(d,o,u){const c=Array.isArray(o)?o:o.split("."),p=c.shift();if(p.endsWith("]")){const y=p.lastIndexOf("["),f=+p.substring(y+1,p.length-1),v=p.substring(0,y);let P=d[v];const m=Array.isArray(P)?[...P]:[];return c.length&&(P=m[f],(P==null||typeof P!="object")&&(P={}),u=l(P,c,u)),m[f]=u,{...d,[v]:m}}if(!c.length)return{...d,[p]:u};let h=d[p];return(h==null||typeof h!="object")&&(h={}),{...d,[p]:l(h,c,u)}}},92378:(_,L,e)=>{"use strict";e.d(L,{G:()=>i,U:()=>l});var t=e(74848),n=e(96540),r=e(81887),s=e(90182),a=e(31678),g=e(87421);const i=({repeat:d,onChange:o,id:u})=>{const c=(0,a.useSelector)(y=>(0,g.SS)((0,g.y7)(y),y)),p=(0,n.useMemo)(()=>{const y=c.map(f=>({label:f.name,value:f.name}));return y.length===0&&y.unshift({label:"No template variables found",value:null}),y.unshift({label:"Disable repeating",value:null}),y},[c]),h=(0,n.useCallback)(y=>o(y.value),[o]);return(0,t.jsx)(s.l6,{inputId:u,value:d,onChange:h,options:p})},l=({sceneContext:d,repeat:o,id:u,onChange:c})=>{const h=(0,n.useMemo)(()=>r.jh.getVariables(d.getRoot()),[d]).useState().variables,y=(0,n.useMemo)(()=>{const v=h.map(P=>({label:P.state.name,value:P.state.name}));return v.length===0&&v.unshift({label:"No template variables found",value:null}),v.unshift({label:"Disable repeating",value:null}),v},[h]),f=(0,n.useCallback)(v=>c(v.value),[c]);return(0,t.jsx)(s.l6,{inputId:u,value:o,onChange:f,options:y})}},78050:(_,L,e)=>{"use strict";e.d(L,{C:()=>i,m:()=>l});var t=e(74848),n=e(13544),r=e(14110),s=e(71678),a=e(55852),g=e(70497);const i=({dashboard:d,onSaveSuccess:o,size:u})=>(0,t.jsx)(s.$s,{children:({showModal:c,hideModal:p})=>(0,t.jsx)(a.$n,{size:u,onClick:()=>{c(g.$,{dashboard:d,onSaveSuccess:o,onDismiss:p})},"aria-label":n.Tp.pages.Dashboard.Settings.General.saveDashBoard,children:"Save dashboard"})}),l=({dashboard:d,onClick:o,onSaveSuccess:u,variant:c,size:p})=>(0,t.jsx)(s.$s,{children:({showModal:h,hideModal:y})=>(0,t.jsx)(a.$n,{size:p,onClick:()=>{(0,r.rR)("grafana_dashboard_save_as_clicked"),o?.(),h(g.$,{dashboard:d,onSaveSuccess:u,onDismiss:y,isCopy:!0})},variant:c,"aria-label":n.Tp.pages.Dashboard.Settings.General.saveAsDashBoard,children:"Save as"})})},54943:(_,L,e)=>{"use strict";e.d(L,{l:()=>l});var t=e(74848),n=e(16817),r=e(67061),s=e(62930),a=e(90613),g=e(19626),i=e(22764);const l=({diff:d,oldValue:o,newValue:u,hasFolderChanges:c,oldFolder:p,newFolder:h})=>{const y=(0,n.A)(async()=>{const v=JSON.stringify(o??{},null,2),P=JSON.stringify(u??{},null,2);let m;const D=[];let x=0;if(d)for(const[E,C]of Object.entries(d)){const b=(0,t.jsx)(g.D,{diffs:C,title:E},E);E==="schemaVersion"?m=b:D.push(b),x+=C.length}return{schemaChange:m,diffs:D,count:x,showDiffs:x<15,jsonView:(0,t.jsx)(i.M,{oldValue:v,newValue:P})}},[d,o,u]),{value:f}=y;return(0,t.jsxs)(r.B,{direction:"column",gap:1,children:[c&&(0,t.jsx)(g.D,{diffs:[{op:"replace",value:h,originalValue:p,path:[],startLineNumber:0,endLineNumber:0}],title:"folder"},"folder"),(!f||!o)&&(0,t.jsx)(s.y,{}),f&&f.count>=1?(0,t.jsxs)(t.Fragment,{children:[f&&f.schemaChange&&f.schemaChange,f&&f.showDiffs&&f.diffs,(0,t.jsxs)(a.a,{paddingTop:1,children:[(0,t.jsx)("h4",{children:"Full JSON diff"}),f.jsonView]})]}):(0,t.jsx)(a.a,{paddingTop:1,children:"No changes in the dashboard JSON"})]})}},70497:(_,L,e)=>{"use strict";e.d(L,{$:()=>He});var t=e(74848),n=e(96540),r=e(17172),s=e(32264),a=e(87978),g=e(63021),i=e(40675),l=e(56596),d=e(32196),o=e(16817),u=e(40845),c=e(42418),p=e(27677);function h({dashboard:Ve}){const Je=(0,u.of)(y),{loading:nt,value:pt,error:bt}=(0,o.A)(async()=>{const ye=Ve.getSaveModelCloneOld();return p.IB.validateDashboard(ye).catch(ue=>{if(ue.status>=500)throw ue;return ue.data})},[Ve]);let Tt;if(nt)Tt=(0,t.jsx)(c.F,{severity:"info",title:"Checking dashboard validity"});else if(pt)pt.isValid||(Tt=(0,t.jsxs)(c.F,{severity:"warning",title:"Dashboard failed schema validation",children:[(0,t.jsx)("p",{children:"Validation is provided for development purposes and should be safe to ignore. If you are a Grafana developer, consider checking and updating the dashboard schema"}),(0,t.jsx)("div",{className:Je.error,children:pt.message})]}));else{const ye=bt?.message??"Unknown error";Tt=(0,t.jsx)(c.F,{severity:"info",title:"Error checking dashboard validity",children:(0,t.jsx)("p",{className:Je.error,children:ye})})}return Tt?(0,t.jsx)("div",{className:Je.root,children:Tt}):null}const y=Ve=>({root:(0,d.css)({marginTop:Ve.spacing(1)}),error:(0,d.css)({fontFamily:Ve.typography.fontFamilyMonospace,whiteSpace:"pre-wrap",overflowX:"auto",maxWidth:"100%"})}),f=h;var v=e(54943),P=e(96374),m=e(37390),D=e(55852),x=e(8484),E=e(78050),C=e(41053),b=e(71733),T=e(14110),A=e(39601),R=e(28138),S=e(3169),O=e(91219),j=e(55314),B=e(31678),N=e(28444),I=e(36974);const K=async(Ve,Je,nt,pt)=>{const bt=await pt({dashboard:Ve,folderUid:Je.folderUid??nt.meta.folderUid??Ve.meta?.folderUid,message:Je.message,overwrite:Je.overwrite,k8s:nt.meta.k8s});if("error"in bt)throw bt.error;return bt.data},w=(Ve=!1)=>{const Je=(0,B.useDispatch)(),nt=(0,S._2)(),[pt]=(0,j.e8)(),[bt,Tt]=(0,C.A)(async(ye,je,ue)=>{try{const Ee=await K(ye,je,ue,pt);ue.version=Ee.version,ye.version=Ee.version,ue.clearUnsavedChanges(ye,je),R.A.publish(new N.Eu),nt.success("Dashboard saved"),(0,I.ko)(Ee.uid),Ve?(0,T.rR)("grafana_dashboard_copied",{name:ue.title,url:Ee.url}):(0,T.rR)(`grafana_dashboard_${ue.id?"saved":"created"}`,{name:ue.title,url:Ee.url});const Ce=A.Ny.getLocation().pathname,Ne=b.I.stripBaseFromUrl(Ee.url);return Ne!==Ce&&Ee.url&&setTimeout(()=>A.Ny.replace(Ne)),ue.meta.isStarred&&Je((0,O.TU)({id:ue.uid,title:ue.title,url:Ne})),Ee}catch(Ee){throw Ee instanceof Error&&nt.error(Ee.message??"Error saving dashboard"),Ee}},[Je,nt]);return{state:bt,onDashboardSave:Tt}},U=({dashboard:Ve,dashboardSaveModel:Je,error:nt,onDismiss:pt,setErrorIsHandled:bt})=>{const{onDashboardSave:Tt}=w(),ye=s.$.featureToggles.dashboardRestore&&s.$.featureToggles.dashboardRestoreUI;return(0,t.jsxs)(t.Fragment,{children:[nt.data&&nt.data.status==="version-mismatch"&&(0,t.jsx)(P.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["Someone else has updated this dashboard ",(0,t.jsx)("br",{})," ",(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await Tt(Je,{overwrite:!0},Ve),pt()},onDismiss:pt}),nt.data&&nt.data.status==="name-exists"&&(0,t.jsx)(t.Fragment,{children:ye?(0,t.jsxs)(m.a,{isOpen:!0,title:(0,x.t)("save-dashboards.name-exists.title","Dashboard name already exists"),onDismiss:pt,children:[(0,t.jsx)("p",{children:(0,t.jsx)(x.x6,{i18nKey:"save-dashboards.name-exists.message-info",children:"A dashboard with the same name in the selected folder already exists, including recently deleted dashboards."})}),(0,t.jsx)("p",{children:(0,t.jsx)(x.x6,{i18nKey:"save-dashboards.name-exists.message-suggestion",children:"Please choose a different name or folder."})})]}):(0,t.jsx)(P.u,{isOpen:!0,title:"Conflict",body:(0,t.jsxs)("div",{children:["A dashboard with the same name in selected folder already exists. ",(0,t.jsx)("br",{}),(0,t.jsx)("small",{children:"Would you still like to save this dashboard?"})]}),confirmText:"Save and overwrite",onConfirm:async()=>{await Tt(Je,{overwrite:!0},Ve),pt()},onDismiss:pt})}),nt.data&&nt.data.status==="plugin-dashboard"&&(0,t.jsx)(W,{dashboard:Ve,onDismiss:()=>{bt(!0),pt()}})]})},W=({onDismiss:Ve,dashboard:Je})=>{const{onDashboardSave:nt}=w(),pt=(0,u.of)(z);return(0,t.jsxs)(m.a,{className:pt.modal,title:"Plugin dashboard",icon:"copy",isOpen:!0,onDismiss:Ve,children:[(0,t.jsxs)("div",{className:pt.modalText,children:["Your changes will be lost when you update the plugin.",(0,t.jsx)("br",{}),(0,t.jsxs)("small",{children:["Use ",(0,t.jsx)("strong",{children:"Save As"})," to create custom version."]})]}),(0,t.jsxs)(m.a.ButtonRow,{children:[(0,t.jsx)(D.$n,{variant:"secondary",onClick:Ve,fill:"outline",children:"Cancel"}),(0,t.jsx)(E.m,{onClick:Ve,dashboard:Je,onSaveSuccess:Ve}),(0,t.jsx)(D.$n,{variant:"destructive",onClick:async()=>{await nt(Je.getSaveModelClone(),{overwrite:!0},Je),Ve()},children:"Overwrite"})]})]})},H=Ve=>{switch(Ve){case"version-mismatch":case"name-exists":case"plugin-dashboard":return!0;default:return!1}},z=Ve=>({modal:(0,d.css)({width:"500px"}),modalText:(0,d.css)({fontSize:Ve.typography.h4.fontSize,color:Ve.colors.text.primary,marginBottom:Ve.spacing(4),paddingTop:Ve.spacing(2)}),modalButtonRow:(0,d.css)({marginBottom:"14px","a, button":{marginRight:Ve.spacing(2)}})});var G=e(51253),M=e(16504),Q=e(88575),Y=e(67061),q=e(60029),te=e(10354),X=e(21744),ee=e(15292),ne=e(36607),Z=e(71500),ae=e(81394),re=e(27966);const se=Ve=>{const Je=Ve.getSaveModelClone();return Je.id=null,Je.uid="",Je.title+=" Copy",Je.editable=!0,Ve.id>0&&Je.panels&&Je.panels.forEach(nt=>{nt.type==="graph"&&nt.alert&&delete nt.thresholds,delete nt.alert}),Je},de=({dashboard:Ve,isLoading:Je,isNew:nt,onSubmit:pt,onCancel:bt,onSuccess:Tt})=>{const ye={title:nt?Ve.title:`${Ve.title} Copy`,description:Ve.description,$folder:{uid:Ve.meta.folderUid,title:Ve.meta.folderTitle},copyTags:!1},je=ue=>async Ee=>{if(Ee&&Ee===ue().$folder.title?.trim())return"Dashboard name cannot be the same as folder name";try{return await Z.P.validateNewDashboardName(ue().$folder.uid??"general",Ee),!0}catch(Ce){return Ce instanceof Error?Ce.message:"Dashboard name is invalid"}};return(0,t.jsx)(G.l,{defaultValues:ye,onSubmit:async ue=>{if(!pt)return;const Ee=se(Ve);Ee.title=ue.title,Ee.description=ue.description,!nt&&!ue.copyTags&&(Ee.tags=[]),(await pt(Ee,{folderUid:ue.$folder.uid},Ve)).status==="success"&&Tt()},children:({register:ue,control:Ee,errors:Ce,getValues:Ne})=>(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(M.e,{render:({field:{ref:Fe,...Ue}})=>(0,t.jsx)(Q.D,{label:(0,t.jsxs)(Y.B,{justifyContent:"space-between",children:[(0,t.jsx)(q.J,{htmlFor:"title",children:"Title"}),s.$.featureToggles.dashgpt&&nt&&(0,t.jsx)(re.Z,{onGenerate:fe=>Ue.onChange(fe)})]}),invalid:!!Ce.title,error:Ce.title?.message,children:(0,t.jsx)(te.p,{...Ue,onChange:fe=>Ue.onChange(fe.target.value),"aria-label":"Save dashboard title field",autoFocus:!0})}),control:Ee,name:"title",rules:{validate:je(Ne)}}),(0,t.jsx)(M.e,{render:({field:{ref:Fe,...Ue}})=>(0,t.jsx)(Q.D,{label:(0,t.jsxs)(Y.B,{justifyContent:"space-between",children:[(0,t.jsx)(q.J,{htmlFor:"description",children:"Description"}),s.$.featureToggles.dashgpt&&nt&&(0,t.jsx)(ae.V,{onGenerate:fe=>Ue.onChange(fe)})]}),invalid:!!Ce.description,error:Ce.description?.message,children:(0,t.jsx)(X.f,{...Ue,onChange:fe=>Ue.onChange(fe.target.value),"aria-label":"Save dashboard description field",autoFocus:!0})}),control:Ee,name:"description"}),(0,t.jsx)(Q.D,{label:"Folder",children:(0,t.jsx)(M.e,{render:({field:{ref:Fe,...Ue}})=>(0,t.jsx)(ne.d,{...Ue,onChange:(fe,Te)=>Ue.onChange({uid:fe,title:Te}),value:Ue.value?.uid,initialTitle:Ve.meta.folderTitle,dashboardId:Ve.id,enableCreateNew:!0}),control:Ee,name:"$folder"})}),!nt&&(0,t.jsx)(Q.D,{label:"Copy tags",children:(0,t.jsx)(ee.d,{...ue("copyTags")})}),(0,t.jsxs)(Y.B,{children:[(0,t.jsx)(D.$n,{type:"button",variant:"secondary",onClick:bt,fill:"outline",children:"Cancel"}),(0,t.jsx)(D.$n,{disabled:Je,type:"submit","aria-label":"Save dashboard button",children:Je?"Saving...":"Save"})]})]})})};var le=e(13544),he=e(10880),ie=e(10740),J=e(57725),ce=e(3363);const pe=["You are an expert in Grafana Dashboards","Your goal is to write a description of the changes for a dashboard to display to the user","You will be given human-readable diffs with most irrelevant lines filtered out"].join(`.
`),Pe=["Respond only with the diff description, which is meant to be loaded directly into the application for the user.",'If there are no substantial user or migration changes, the correct description is "Minor changes only"',`If there are too many changes of either kind, and those changes have a message saying 'too long', the correct response for that section is "Too many changes to auto-summarize"`,"In a diff, lines beginning with - are removed, and lines beginning with + are added.","Lines with neither + nor - are included for context. Be careful not to mark them as added or removed if they do not start with + or -.","If a line is changed, it will show a previous version removed and a new version added","When referring to panel changes, use the panel title","When using panel title, wrap it with double quotes","When the panel changes position, just mention that the panel has changed position","When an entire panel is added or removed, use the panel title and only say it was added or removed and disregard the rest of the changes for that panel","Group together similar changes into one line when multiple panels are affected","Refer to templating elements as variables","Try to make the response as short as possible"].join(`.
`),Ie=({dashboard:Ve,onGenerate:Je,disabled:nt})=>{const pt=(0,n.useCallback)(()=>ge(Ve),[Ve]);return(0,t.jsx)(ie.n,{messages:pt,onGenerate:Je,temperature:0,model:"gpt-3.5-turbo-16k",eventTrackingSrc:J.ec.dashboardChanges,toggleTipTitle:"Improve your dashboard changes summary",disabled:nt})};function ge(Ve){let{userChanges:Je,migrationChanges:nt}=(0,ce.Yy)(Ve);return Je.length>8e3&&(Je="User changes were too long, fill in the user changes section with 'User changes too long to auto-summarize'"),nt.split(`
`).length<10?nt="No significant migration changes":nt.length>8e3&&(nt="Migration changes were too long, fill in the migration changes section with 'Migration changes too long to auto-summarize'"),[{content:pe,role:ce.Xh.system},{content:`Summarize the following user changes diff under "User changes":
${Je}`,role:ce.Xh.system},{content:`Be sure to only include substantial user changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Do not include "User Changes" section if there are no substantial user changes to report.`,role:ce.Xh.system},{content:`Summarize the following migration changes diff under "Migration changes":
${nt}`,role:ce.Xh.system},{content:`Be sure to only include substantial migration changes, such as adding or removing entire panels, changing panel titles or descriptions, etc.
Ignore any threshold step changes or templating list changes.
Ignore other changes and do not include them in the summary. Do not include "Migration Changes" section if there are no substantial migration changes to report.
If there are substantial migration changes, add "Some autogenerated changes are included to update the dashboard to the latest valid schema version" at the end.`,role:ce.Xh.system},{content:Pe,role:ce.Xh.system}]}const Se=({dashboard:Ve,isLoading:Je,saveModel:nt,options:pt,onSubmit:bt,onCancel:Tt,onSuccess:ye,onOptionsChange:je})=>{const ue=(0,n.useMemo)(()=>Ve.hasTimeChanged(),[Ve]),Ee=(0,n.useMemo)(()=>Ve.hasVariablesChanged(),[Ve]),[Ce,Ne]=(0,n.useState)(!1),[Fe,Ue]=(0,n.useState)(pt.message),fe=(0,u.of)(De);return(0,t.jsx)("form",{onSubmit:async Te=>{if(Te.preventDefault(),!bt)return;Ne(!0),pt={...pt,message:Fe},(await bt(nt.clone,pt,Ve)).status==="success"?ye():Ne(!1)},style:{maxWidth:600},children:(0,t.jsxs)(Y.B,{gap:2,direction:"column",alignItems:"flex-start",children:[ue&&(0,t.jsx)(he.S,{checked:!!pt.saveTimerange,onChange:()=>je({...pt,saveTimerange:!pt.saveTimerange}),label:"Save current time range as dashboard default","aria-label":le.Tp.pages.SaveDashboardModal.saveTimerange}),Ee&&(0,t.jsx)(he.S,{checked:!!pt.saveVariables,onChange:()=>je({...pt,saveVariables:!pt.saveVariables}),label:"Save current variable values as dashboard default","aria-label":le.Tp.pages.SaveDashboardModal.saveVariables}),(0,t.jsxs)("div",{className:fe.message,children:[s.$.featureToggles.aiGeneratedDashboardChanges&&(0,t.jsx)(Ie,{dashboard:Ve,onGenerate:Te=>{je({...pt,message:Te}),Ue(Te)},disabled:!nt.hasChanges}),(0,t.jsx)(X.f,{"aria-label":"message",value:Fe,onChange:Te=>{je({...pt,message:Te.currentTarget.value}),Ue(Te.currentTarget.value)},placeholder:"Add a note to describe your changes.",autoFocus:!0,rows:5})]}),(0,t.jsxs)(Y.B,{alignItems:"center",children:[(0,t.jsx)(D.$n,{variant:"secondary",onClick:Tt,fill:"outline",children:"Cancel"}),(0,t.jsx)(D.$n,{type:"submit",disabled:!nt.hasChanges||Je,icon:Ce?"spinner":void 0,"aria-label":le.Tp.pages.SaveDashboardModal.save,children:Je?"Saving...":"Save"}),!nt.hasChanges&&(0,t.jsx)("div",{children:"No changes to save"})]})]})})};function De(Ve){return{message:(0,d.css)({display:"flex",alignItems:"end",flexDirection:"column",width:"100%"})}}var Ke=e(4213),Me=e(66864),be=e(10534);const we=({dashboard:Ve,onCancel:Je})=>{const[nt,pt]=(0,n.useState)(()=>{const Tt=Ve.getSaveModelClone();return delete Tt.id,JSON.stringify(Tt,null,2)}),bt=(0,n.useCallback)(()=>{const Tt=new Blob([nt],{type:"application/json;charset=utf-8"});(0,Ke.saveAs)(Tt,Ve.title+"-"+new Date().getTime()+".json")},[Ve.title,nt]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(Y.B,{direction:"column",gap:2,children:[(0,t.jsxs)("div",{children:["This dashboard cannot be saved from the Grafana UI because it has been provisioned from another source. Copy the JSON or save it to a file below, then you can update your dashboard in the provisioning source.",(0,t.jsx)("br",{}),(0,t.jsxs)("i",{children:["See"," ",(0,t.jsx)("a",{className:"external-link",href:"https://grafana.com/docs/grafana/latest/administration/provisioning/#dashboards",target:"_blank",rel:"noreferrer",children:"documentation"})," ","for more information about provisioning."]}),(0,t.jsx)("br",{})," ",(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"File path: "})," ",Ve.meta.provisionedExternalId]}),(0,t.jsx)(X.f,{spellCheck:!1,value:nt,onChange:Tt=>{pt(Tt.currentTarget.value)},className:Be.json}),(0,t.jsxs)(Me.Gy,{children:[(0,t.jsx)(D.$n,{variant:"secondary",onClick:Je,fill:"outline",children:"Cancel"}),(0,t.jsx)(be.b,{icon:"copy",getText:()=>nt,children:"Copy JSON to clipboard"}),(0,t.jsx)(D.$n,{type:"submit",onClick:bt,children:"Save JSON to file"})]})]})})},Be={json:(0,d.css)({height:"400px",width:"100%",overflow:"auto",resize:"none",fontFamily:"monospace"})},He=({dashboard:Ve,onDismiss:Je,onSaveSuccess:nt,isCopy:pt})=>{const[bt,Tt]=(0,n.useState)({}),ye=Ve.getOriginalDashboard(),je=Ve.meta.provisioned,ue=Ve.version===0,Ee=!!Ve.meta.hasUnsavedFolderChange,[Ce,Ne]=(0,n.useState)(!1),Fe=(0,n.useMemo)(()=>{const ot=Ve.getSaveModelClone({saveTimerange:!!bt.saveTimerange,saveVariables:!!bt.saveVariables});if(!ye)return{clone:ot,diff:{},diffCount:0,hasChanges:!1};const ft=(0,l.G4)(ye,ot);let _e=0;for(const et of Object.values(ft))_e+=et.length;return{clone:ot,diff:ft,diffCount:_e,hasChanges:(_e>0||Ee)&&!ue}},[Ve,ye,bt,ue,Ee]),[Ue,fe]=(0,n.useState)(!1),{state:Te,onDashboardSave:Ge}=w(pt),Qe=nt?()=>{Je(),nt()}:Je,st=()=>Ue?(0,t.jsx)(v.l,{diff:Fe.diff,oldValue:ye,newValue:Fe.clone}):ue||pt?(0,t.jsx)(de,{dashboard:Ve,isLoading:Te.loading,onCancel:Je,onSuccess:Qe,onSubmit:Ge,isNew:ue}):je?(0,t.jsx)(we,{dashboard:Ve,onCancel:Je,onSuccess:Qe}):(0,t.jsx)(Se,{dashboard:Ve,isLoading:Te.loading,saveModel:Fe,onCancel:Je,onSuccess:Qe,onSubmit:Ge,options:bt,onOptionsChange:Tt});if(Te.error&&!Ce&&(0,r.NF)(Te.error)&&H(Te.error.data.status))return(0,t.jsx)(U,{error:Te.error,dashboard:Ve,dashboardSaveModel:Fe.clone,onDismiss:Je,setErrorIsHandled:Ne});let Xe="Save dashboard";return pt?Xe="Save dashboard copy":je&&(Xe="Provisioned dashboard"),(0,t.jsxs)(a._,{title:Xe,onClose:Je,subtitle:Ve.title,tabs:(0,t.jsxs)(g.U,{children:[(0,t.jsx)(i.o,{label:"Details",active:!Ue,onChangeTab:()=>fe(!1)}),Fe.hasChanges&&(0,t.jsx)(i.o,{label:"Changes",active:Ue,onChangeTab:()=>fe(!0),counter:Fe.diffCount})]}),children:[st(),s.$.featureToggles.showDashboardValidationWarnings&&(0,t.jsx)(f,{dashboard:Ve})]})}},35280:(_,L,e)=>{"use strict";e.d(L,{D:()=>P});var t=e(74848),n=e(96540),r=e(94701),s=e(14110),a=e(32264),g=e(10534),i=e(88575),l=e(67061),d=e(15292),o=e(60029),u=e(21744),c=e(55852),p=e(37390),h=e(8484),y=e(7758),f=e(87895),v=e(22699);function P({panel:m,dashboard:D,range:x,onCancelClick:E,buildIframe:C=v.CF}){const[b,T]=(0,n.useState)(!0),[A,R]=(0,n.useState)("current"),[S,O]=(0,n.useState)("");(0,r.A)(()=>{(0,s.rR)("grafana_dashboards_embed_share_viewed",{shareResource:(0,v.hD)(m)})}),(0,n.useEffect)(()=>{const K=C(b,D.uid,A,m,x);O(K)},[A,b,D,m,x,C]);const j=K=>{O(K.currentTarget.value)},B=()=>{T(K=>!K)},N=K=>{R(K)},I=(0,t.jsx)(g.b,{icon:"copy",variant:"primary",getText:()=>S,onClipboardCopy:()=>{y.c.embedSnippetCopy({currentTimeRange:b,theme:A,shareResource:(0,v.hD)(m)})},children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.copy",children:"Copy to clipboard"})});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(h.x6,{i18nKey:"share-modal.embed.info",children:"Generate HTML for embedding an iframe with this panel"})}),(0,t.jsx)(i.D,{children:(0,t.jsxs)(l.B,{gap:1,alignItems:"start",children:[(0,t.jsx)(d.d,{label:(0,h.t)("share-modal.embed.time-range","Lock time range"),id:"share-current-time-range",value:b,onChange:B}),(0,t.jsx)(o.J,{description:(0,h.t)("embed.share.time-range-description","Change the current relative time range to an absolute time range"),children:(0,t.jsx)(h.x6,{i18nKey:"embed.share.time-range-label",children:"Lock time range"})})]})}),(0,t.jsx)(f.w,{selectedTheme:A,onChange:N}),(0,t.jsx)(i.D,{label:(0,h.t)("share-modal.embed.html","Embed HTML"),description:(0,h.t)("share-modal.embed.html-description","The HTML code below can be pasted and included in another web page. Unless anonymous access is enabled, the users viewing that page need to be signed into Grafana for the graph to load."),children:(0,t.jsx)(u.f,{"data-testid":"share-embed-html",id:"share-panel-embed-embed-html-textarea",rows:5,value:S,onChange:j})}),a.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(l.B,{gap:1,justifyContent:"start",children:[I,(0,t.jsx)(c.$n,{variant:"secondary",fill:"outline",onClick:E,children:(0,t.jsx)(h.x6,{i18nKey:"snapshot.share.cancel-button",children:"Cancel"})})]}):(0,t.jsx)(p.a.ButtonRow,{children:I})]})}},86394:(_,L,e)=>{"use strict";e.d(L,{j:()=>i});var t=e(74848),n=e(96540),r=e(14110),s=e(8484),a=e(96227),g=e(22699);const i=({panel:l,initialFolderUid:d,onCreateLibraryPanel:o,onDismiss:u})=>((0,n.useEffect)(()=>{(0,r.rR)("grafana_dashboards_library_panel_share_viewed",{shareResource:(0,g.hD)(l)})},[l]),l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(s.x6,{i18nKey:"share-modal.library.info",children:"Create library panel."})}),(0,t.jsx)(a.b,{panel:l,initialFolderUid:d,onCreateLibraryPanel:o,onDismiss:u})]}):null)},7686:(_,L,e)=>{"use strict";e.d(L,{Zy:()=>re});var t=e(74848),n=e(96540),r=e(25897),s=e(37390),a=e(40980),g=e(40845),i=e(2913),l=e(10096),d=e(8484),o=e(4785),u=e(72254),c=e(7758),p=e(82792),h=e(35280),y=e(4213),f=e(88575),v=e(15292),P=e(55852),m=e(15858),D=e(28444),x=e(70713),E=e(32372),C=e(10534);function b({json:se,onDismiss:de}){const le=(0,n.useCallback)(()=>se,[se]);return(0,t.jsxs)(s.a,{title:"JSON",onDismiss:de,onClickBackdrop:de,isOpen:!0,children:[(0,t.jsx)(x.Ay,{disableHeight:!0,children:({width:he})=>(0,t.jsx)(E.B,{value:se,language:"json",showMiniMap:!1,height:"500px",width:he})}),(0,t.jsx)(s.a.ButtonRow,{children:(0,t.jsx)(C.b,{icon:"copy",getText:le,onClipboardCopy:()=>{c.c.exportCopyJsonClicked()},children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.view-json.copy-button",children:"Copy to Clipboard"})})})]})}var T=e(22699);class A extends n.PureComponent{constructor(de){super(de),this.onShareExternallyChange=()=>{this.setState({shareExternally:!this.state.shareExternally})},this.onSaveAsFile=()=>{const{dashboard:le}=this.props,{shareExternally:he}=this.state;c.c.exportSaveJsonClicked({externally:he,shareResource:(0,T.hD)(this.props.panel)}),he?this.exporter.makeExportable(le).then(ie=>{this.openSaveAsDialog(ie)}):this.openSaveAsDialog(le.getSaveModelClone())},this.onViewJson=()=>{const{dashboard:le}=this.props,{shareExternally:he}=this.state;c.c.exportViewJsonClicked({externally:he,shareResource:(0,T.hD)(this.props.panel)}),he?this.exporter.makeExportable(le).then(ie=>{this.openJsonModal(ie)}):this.openJsonModal(le.getSaveModelClone())},this.openSaveAsDialog=le=>{const he=JSON.stringify(le,null,2),ie=new Blob([he],{type:"application/json;charset=utf-8"}),J=new Date().getTime();(0,y.saveAs)(ie,`${le.title}-${J}.json`)},this.openJsonModal=le=>{l.lE.publish(new D.S8({props:{json:JSON.stringify(le,null,2)},component:b})),this.props.onDismiss?.()},this.state={shareExternally:!1},this.exporter=new m.M}render(){const{onDismiss:de}=this.props,{shareExternally:le}=this.state,he=(0,d.t)("share-modal.export.share-externally-label","Export for sharing externally");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.info-text",children:"Export this dashboard."})}),(0,t.jsx)(f.D,{label:he,children:(0,t.jsx)(v.d,{id:"share-externally-toggle",value:le,onChange:this.onShareExternallyChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:de,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.cancel-button",children:"Cancel"})}),(0,t.jsx)(P.$n,{variant:"secondary",onClick:this.onViewJson,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.view-button",children:"View JSON"})}),(0,t.jsx)(P.$n,{variant:"primary",onClick:this.onSaveAsFile,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.export.save-button",children:"Save to file"})})]})]})}}var R=e(86394),S=e(13544),O=e(84167),j=e(10354),B=e(72109),N=e(42418),I=e(87895);class K extends n.PureComponent{constructor(de){super(de),this.buildUrl=async()=>{const{panel:le,dashboard:he}=this.props,{useCurrentTimeRange:ie,useShortUrl:J,selectedTheme:ce}=this.state,pe=await(0,T.Xe)(ie,ce,le,J),Pe=(0,T.Lb)(ie,he.uid,ce,le);this.setState({shareUrl:pe,imageUrl:Pe})},this.onUseCurrentTimeRangeChange=()=>{this.setState({useCurrentTimeRange:!this.state.useCurrentTimeRange})},this.onUrlShorten=()=>{this.setState({useShortUrl:!this.state.useShortUrl})},this.onThemeChange=le=>{this.setState({selectedTheme:le})},this.getShareUrl=()=>this.state.shareUrl,this.onCopy=()=>{c.c.shareLinkCopied({currentTimeRange:this.state.useCurrentTimeRange,theme:this.state.selectedTheme,shortenURL:this.state.useShortUrl,shareResource:(0,T.hD)(this.props.panel)})},this.state={useCurrentTimeRange:!0,useShortUrl:!1,selectedTheme:"current",shareUrl:"",imageUrl:""}}componentDidMount(){this.buildUrl()}componentDidUpdate(de,le){const{useCurrentTimeRange:he,useShortUrl:ie,selectedTheme:J}=this.state;(le.useCurrentTimeRange!==he||le.selectedTheme!==J||le.useShortUrl!==ie)&&this.buildUrl()}render(){const{panel:de,dashboard:le}=this.props,he=le?le.time.to==="now":!1,{useCurrentTimeRange:ie,useShortUrl:J,selectedTheme:ce,shareUrl:pe,imageUrl:Pe}=this.state,Ie=S.Tp.pages.SharePanelModal,ge=!!le.id,Se=(0,d.t)("share-modal.link.time-range-label","Lock time range"),De=(0,d.t)("share-modal.link.time-range-description","Transforms the current relative time range to an absolute time range"),Ke=(0,d.t)("share-modal.link.shorten-url","Shorten URL"),Me=(0,d.t)("share-modal.link.link-url","Link URL");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.info-text",children:"Create a direct link to this dashboard or panel, customized with the options below."})}),(0,t.jsxs)(O.n,{children:[(0,t.jsx)(f.D,{label:Se,description:he?De:"",children:(0,t.jsx)(v.d,{id:"share-current-time-range",value:ie,onChange:this.onUseCurrentTimeRangeChange})}),(0,t.jsx)(I.w,{selectedTheme:ce,onChange:this.onThemeChange}),(0,t.jsx)(f.D,{label:Ke,children:(0,t.jsx)(v.d,{id:"share-shorten-url",value:J,onChange:this.onUrlShorten})}),(0,t.jsx)(f.D,{label:Me,children:(0,t.jsx)(j.p,{id:"link-url-input",value:pe,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getShareUrl,onClipboardCopy:this.onCopy,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.copy-link-button",children:"Copy"})})})})]}),de&&i.Ay.rendererAvailable&&(0,t.jsxs)(t.Fragment,{children:[ge&&(0,t.jsx)(B.Y,{href:Pe,external:!0,icon:"camera","aria-label":Ie.linkToRenderedImage,children:(0,d.t)("share-modal.link.rendered-image","Direct link rendered image")}),!ge&&(0,t.jsx)(N.F,{severity:"info",title:(0,d.t)("share-modal.link.save-alert","Dashboard is not saved"),bottomSpacing:0,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.link.save-dashboard",children:"To render a panel image, you must save the dashboard first."})})]}),de&&!i.Ay.rendererAvailable&&(0,t.jsx)(N.F,{severity:"info",title:(0,d.t)("share-modal.link.render-alert","Image renderer plugin not installed"),bottomSpacing:0,children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.link.render-instructions",children:["To render a panel image, you must install the"," ",(0,t.jsx)(B.Y,{href:"https://grafana.com/grafana/plugins/grafana-image-renderer",external:!0,children:"Grafana image renderer plugin"}),". Please contact your Grafana administrator to install the plugin."]})})]})}}var w=e(92041),U=e(12470),W=e(17172),H=e(90182),z=e(67061),G=e(62930),M=e(74856),Q=e(69064);class Y extends n.PureComponent{constructor(de){super(de),this.createSnapshot=le=>()=>{const{timeoutSeconds:he}=this.state;this.dashboard.snapshot={timestamp:new Date},this.setState({isLoading:!0}),this.dashboard.startRefresh(),setTimeout(()=>{this.saveSnapshot(this.dashboard,le)},he*1e3)},this.saveSnapshot=async(le,he)=>{const{snapshotExpires:ie,timeoutSeconds:J}=this.state,ce=this.dashboard.getSaveModelCloneOld();this.scrubDashboard(ce);const pe={dashboard:ce,name:ce.title,expires:ie,external:he};try{const Pe=await(0,Q.s)().create(pe);this.setState({deleteUrl:Pe.deleteUrl,snapshotUrl:Pe.url,step:2})}finally{he?c.c.publishSnapshotClicked({expires:ie,timeout:J,shareResource:(0,T.hD)(this.props.panel)}):c.c.publishSnapshotLocalClicked({expires:ie,timeout:J,shareResource:(0,T.hD)(this.props.panel)}),this.setState({isLoading:!1})}},this.scrubDashboard=le=>{const{panel:he}=this.props,{snapshotName:ie}=this.state;le.title=ie,le.time=(0,M.jG)().timeRange(),le.links=[],le.panels.forEach(ce=>{ce.targets=[],ce.links=[],ce.datasource=null});const J=le.annotations.list.filter(ce=>ce.enable);if(le.annotations.list=J.map(ce=>({name:ce.name,enable:ce.enable,iconColor:ce.iconColor,snapshotData:ce.snapshotData,type:ce.type,builtIn:ce.builtIn,hide:ce.hide})),le.getVariables().forEach(ce=>{"query"in ce&&(ce.query=""),"options"in ce&&(ce.options=ce.current&&!(0,w.R)(ce.current)?[ce.current]:[]),"refresh"in ce&&(ce.refresh=U.CO.never)}),he){const ce=he.getSaveModel();ce.gridPos.w=24,ce.gridPos.x=0,ce.gridPos.y=0,ce.gridPos.h=20,le.panels=[ce]}delete this.dashboard.snapshot,this.dashboard.forEachPanel(ce=>{delete ce.snapshotData}),this.dashboard.annotations.list.forEach(ce=>{delete ce.snapshotData})},this.deleteSnapshot=async()=>{const{deleteUrl:le}=this.state;await(0,W.AI)().get(le),this.setState({step:3})},this.getSnapshotUrl=()=>this.state.snapshotUrl,this.onSnapshotNameChange=le=>{this.setState({snapshotName:le.target.value})},this.onTimeoutChange=le=>{this.setState({timeoutSeconds:Number(le.target.value)})},this.onExpireChange=le=>{this.setState({selectedExpireOption:le,snapshotExpires:le.value})},this.dashboard=de.dashboard,this.expireOptions=[{label:(0,d.t)("share-modal.snapshot.expire-hour","1 Hour"),value:60*60},{label:(0,d.t)("share-modal.snapshot.expire-day","1 Day"),value:60*60*24},{label:(0,d.t)("share-modal.snapshot.expire-week","1 Week"),value:60*60*24*7},{label:(0,d.t)("share-modal.snapshot.expire-never","Never"),value:0}],this.state={isLoading:!1,step:1,selectedExpireOption:this.expireOptions[2],snapshotExpires:this.expireOptions[2].value,snapshotName:de.dashboard.title,timeoutSeconds:4,snapshotUrl:"",deleteUrl:"",externalEnabled:!1,sharingButtonText:""}}componentDidMount(){this.getSnaphotShareOptions()}async getSnaphotShareOptions(){const de=await(0,Q.s)().getSharingOptions();this.setState({sharingButtonText:de.externalSnapshotName,externalEnabled:de.externalEnabled})}renderStep1(){const{onDismiss:de}=this.props,{snapshotName:le,selectedExpireOption:he,timeoutSeconds:ie,isLoading:J,sharingButtonText:ce,externalEnabled:pe}=this.state,Pe=(0,d.t)("share-modal.snapshot.name","Snapshot name"),Ie=(0,d.t)("share-modal.snapshot.expire","Expire"),ge=(0,d.t)("share-modal.snapshot.timeout","Timeout (seconds)"),Se=(0,d.t)("share-modal.snapshot.timeout-description","You might need to configure the timeout value if it takes a long time to collect your dashboard metrics.");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.info-text-1",children:"A snapshot is an instant way to share an interactive dashboard publicly. When created, we strip sensitive data like queries (metric, template, and annotation) and panel links, leaving only the visible metric data and series names embedded in your dashboard."})}),(0,t.jsx)("p",{children:(0,t.jsxs)(d.x6,{i18nKey:"share-modal.snapshot.info-text-2",children:["Keep in mind, your snapshot ",(0,t.jsx)("em",{children:"can be viewed by anyone"})," that has the link and can access the URL. Share wisely."]})})]}),(0,t.jsx)(f.D,{label:Pe,children:(0,t.jsx)(j.p,{id:"snapshot-name-input",width:30,value:le,onChange:this.onSnapshotNameChange})}),(0,t.jsx)(f.D,{label:Ie,children:(0,t.jsx)(H.l6,{inputId:"expire-select-input",width:30,options:this.expireOptions,value:he,onChange:this.onExpireChange})}),(0,t.jsx)(f.D,{label:ge,description:Se,children:(0,t.jsx)(j.p,{id:"timeout-input",type:"number",width:21,value:ie,onChange:this.onTimeoutChange})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(P.$n,{variant:"secondary",onClick:de,fill:"outline",children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.cancel-button",children:"Cancel"})}),pe&&(0,t.jsx)(P.$n,{variant:"secondary",disabled:J,onClick:this.createSnapshot(!0),children:ce}),(0,t.jsx)(P.$n,{variant:"primary",disabled:J,onClick:this.createSnapshot(),children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.local-button",children:"Publish Snapshot"})})]})]})}renderStep2(){const{snapshotUrl:de}=this.state;return(0,t.jsxs)(z.B,{direction:"column",gap:0,children:[(0,t.jsx)(f.D,{label:(0,d.t)("share-modal.snapshot.url-label","Snapshot URL"),children:(0,t.jsx)(j.p,{id:"snapshot-url-input",value:de,readOnly:!0,addonAfter:(0,t.jsx)(C.b,{icon:"copy",variant:"primary",getText:this.getSnapshotUrl,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.copy-link-button",children:"Copy"})})})}),(0,t.jsxs)("div",{style:{alignSelf:"flex-end",padding:"5px"},children:[(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.mistake-message",children:"Did you make a mistake? "}),"\xA0",(0,t.jsx)(P.z9,{fill:"text",target:"_blank",onClick:this.deleteSnapshot,children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.delete-button",children:"Delete snapshot."})})]})]})}renderStep3(){return(0,t.jsx)("p",{children:(0,t.jsx)(d.x6,{i18nKey:"share-modal.snapshot.deleted-message",children:"The snapshot has been deleted. If you have already accessed it once, then it might take up to an hour before before it is removed from browser caches or CDN caches."})})}render(){const{isLoading:de,step:le}=this.state;return(0,t.jsxs)(t.Fragment,{children:[le===1&&this.renderStep1(),le===2&&this.renderStep2(),le===3&&this.renderStep3(),de&&(0,t.jsx)(G.y,{inline:!0})]})}}const q=[],te=[];function X(se){q.push(se)}function ee(se){te.push(se)}function ne(se,de,le){const ie=[{label:(0,d.t)("share-modal.tab-title.link","Link"),value:T.wr.link,component:K}];if(l.TP.isSignedIn&&i.$W.snapshotEnabled&&se){const ce=(0,d.t)("share-modal.tab-title.snapshot","Snapshot");ie.push({label:ce,value:T.wr.snapshot,component:Y})}if(de){const ce=(0,d.t)("share-modal.tab-title.embed","Embed");if(ie.push({label:ce,value:T.wr.embed,component:h.D}),!(0,p.X)(de)){const pe=(0,d.t)("share-modal.tab-title.library-panel","Library panel");ie.push({label:pe,value:T.wr.libraryPanel,component:R.j})}ie.push(...te)}else{const ce=(0,d.t)("share-modal.tab-title.export","Export");ie.push({label:ce,value:T.wr.export,component:A}),ie.push(...q),(0,u.iR)()&&ie.push({label:(0,d.t)("share-modal.tab-title.public-dashboard-title","Public dashboard"),value:T.wr.publicDashboard,component:o.b})}const J=ie.find(ce=>ce.value===le);return{tabs:ie,activeTab:J?.value??ie[0].value}}function Z(se){const{tabs:de,activeTab:le}=ne(se.dashboard.canEditDashboard(),se.panel,se.activeTab);return{tabs:de,activeTab:le}}class ae extends n.Component{constructor(de){super(de),this.onSelectTab=le=>{this.setState(he=>({...he,activeTab:le.value})),c.c.sharingCategoryClicked({item:le.value,shareResource:(0,T.hD)(this.props.panel)})},this.state=Z(de)}getActiveTab(){const{tabs:de,activeTab:le}=this.state;return de.find(he=>he.value===le)}renderTitle(){const{panel:de}=this.props,{activeTab:le}=this.state,he=de?(0,d.t)("share-modal.panel.title","Share Panel"):(0,d.t)("share-modal.dashboard.title","Share"),ie=this.props.dashboard.canEditDashboard(),J=ne(ie,this.props.panel,this.state.activeTab).tabs;return(0,t.jsx)(r.J,{title:he,icon:"share-alt",tabs:J,activeTab:le,onChangeTab:this.onSelectTab})}render(){const{dashboard:de,panel:le}=this.props,ie=this.getActiveTab().component;return(0,t.jsx)(s.a,{isOpen:!0,title:this.renderTitle(),onDismiss:this.props.onDismiss,children:(0,t.jsx)(a.J,{children:(0,t.jsx)(ie,{dashboard:de,panel:le,onDismiss:this.props.onDismiss})})})}}const re=(0,g.cV)(ae)},59037:(_,L,e)=>{"use strict";e.d(L,{K:()=>he,b:()=>le});var t=e(74848),n=e(32196),r=e(49785),s=e(13544),a=e(40845),g=e(88575),i=e(10354),l=e(10534),d=e(15292),o=e(60029),u=e(66864),c=e(55852),p=e(71678),h=e(8484),y=e(72686),f=e(21380),v=e(7758),P=e(90591),m=e(16233),D=e(31678),x=e(52908);const E=()=>{const{width:J}=(0,x.A)();return J>1024};var C=e(7686),b=e(22699),T=e(6923),A=e(42418);const R=()=>(0,t.jsx)(A.F,{title:(0,h.t)("public-dashboard.modal-alerts.save-dashboard-changes-alert-title","Please save your dashboard changes before updating the public configuration"),severity:"warning",bottomSpacing:0});var S=e(12257),O=e(10872),j=e(72254),B=e(84167),N=e(54230);const I=s.Tp.pages.ShareDashboardModal.PublicDashboard,K=({disabled:J,onChange:ce,register:pe,timeRange:Pe})=>(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(B.n,{disabled:J,children:(0,t.jsxs)(u.gW,{spacing:"md",children:[(0,t.jsxs)(u.PE,{orientation:1,spacing:"xs",justify:"space-between",children:[(0,t.jsx)(o.J,{description:(0,h.t)("public-dashboard.settings-configuration.default-time-range-label-desc","The public dashboard uses the default time range settings of the dashboard"),children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.settings-configuration.default-time-range-label",children:"Default time range"})}),(0,t.jsx)(N.b,{value:Pe,disabled:!0,onChange:()=>{}})]}),(0,t.jsxs)(u.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...pe("isTimeSelectionEnabled"),"data-testid":I.EnableTimeRangeSwitch,onChange:Ie=>{ce("isTimeSelectionEnabled",Ie.currentTarget.checked),v.c.publicDashboardTimeSelectionChanged({enabled:Ie.currentTarget.checked})}}),(0,t.jsx)(o.J,{description:(0,h.t)("public-dashboard.settings-configuration.time-range-picker-label-desc","Allow viewers to change time range"),children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.settings-configuration.time-range-picker-label",children:"Time range picker enabled"})})]}),(0,t.jsxs)(u.PE,{orientation:0,spacing:"sm",children:[(0,t.jsx)(d.d,{...pe("isAnnotationsEnabled"),onChange:Ie=>{ce("isAnnotationsEnabled",Ie.currentTarget.checked),v.c.publicDashboardAnnotationsSelectionChanged({enabled:Ie.currentTarget.checked})},"data-testid":I.EnableAnnotationsSwitch}),(0,t.jsx)(o.J,{description:(0,h.t)("public-dashboard.settings-configuration.show-annotations-label-desc","Show annotations on public dashboard"),children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.settings-configuration.show-annotations-label",children:"Show annotations"})})]})]})})});var w=e(19727),U=e(94354),W=e(62930),H=e(55600);const z=s.Tp.pages.ShareDashboardModal.PublicDashboard.EmailSharingConfiguration,G=({recipients:J,dashboardUid:ce,publicDashboardUid:pe})=>{const Pe=(0,a.of)(Q),[Ie,{isLoading:ge}]=(0,y.$L)(),[Se,{isLoading:De}]=(0,y.NA)(),Ke=ge||De,Me=(we,Be)=>{v.c.revokePublicDashboardEmailClicked(),Ie({recipientUid:we,recipientEmail:Be,dashboardUid:ce,uid:pe})},be=we=>{v.c.resendPublicDashboardEmailClicked(),Se({recipientUid:we,uid:pe})};return(0,t.jsx)("table",{className:Pe.table,"data-testid":z.EmailSharingList,children:(0,t.jsx)("tbody",{children:J.map((we,Be)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:we.recipient}),(0,t.jsx)("td",{children:(0,t.jsxs)(w.e,{className:Pe.tableButtonsContainer,children:[(0,t.jsx)(c.$n,{type:"button",variant:"destructive",fill:"text",title:(0,h.t)("public-dashboard.email-sharing.revoke-button-title","Revoke"),size:"sm",disabled:Ke,onClick:()=>Me(we.uid,we.recipient),"data-testid":`${z.DeleteEmail}-${Be}`,children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.email-sharing.revoke-button",children:"Revoke"})}),(0,t.jsx)(c.$n,{type:"button",variant:"primary",fill:"text",title:(0,h.t)("public-dashboard.email-sharing.resend-button-title","Resend"),size:"sm",disabled:Ke,onClick:()=>be(we.uid),"data-testid":`${z.ReshareLink}-${Be}`,children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.email-sharing.resend-button",children:"Resend"})})]})})]},we.uid))})})},M=({dashboard:J})=>{const{width:ce}=(0,x.A)(),pe=(0,a.of)(Q),Pe=J instanceof H.H$?J.state.uid:J.uid,{data:Ie}=(0,y.Bs)(Pe),[ge]=(0,y.ft)(),[Se,{isLoading:De}]=(0,y.NY)(),Ke=m.TP.hasPermission(D.AccessControlAction.DashboardsPublicWrite),{register:Me,setValue:be,control:we,watch:Be,handleSubmit:He,formState:{errors:Ve},reset:Je}=(0,r.mN)({defaultValues:{shareType:Ie?.share||j.Xo.PUBLIC,email:""},mode:"onSubmit"}),nt=bt=>{const Tt={dashboard:J,payload:{...Ie,share:bt}};ge(Tt)},pt=async bt=>{v.c.publicDashboardEmailInviteClicked(),await Se({recipient:bt.email,uid:Ie.uid,dashboardUid:Pe}).unwrap(),Je({email:"",shareType:j.Xo.EMAIL})};return(0,t.jsx)("form",{onSubmit:He(pt),children:(0,t.jsxs)(B.n,{disabled:!Ke,"data-testid":z.Container,className:pe.container,children:[(0,t.jsx)(g.D,{label:(0,h.t)("public-dashboard.config.can-view-dashboard-radio-button-label","Can view dashboard"),className:pe.field,children:(0,t.jsx)(r.xI,{name:"shareType",control:we,render:({field:bt})=>{const{ref:Tt,...ye}=bt,je=[{label:(0,h.t)("public-dashboard.config.public-share-type-option-label","Anyone with a link"),value:j.Xo.PUBLIC},{label:(0,h.t)("public-dashboard.config.email-share-type-option-label","Only specified people"),value:j.Xo.EMAIL}];return(0,t.jsx)(U.z,{...ye,size:ce<480?"sm":"md",options:je,onChange:ue=>{v.c.publicDashboardShareTypeChange({shareType:ue===j.Xo.EMAIL?"email":"public"}),be("shareType",ue),nt(ue)}})}})}),Be("shareType")===j.Xo.EMAIL&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.D,{label:(0,h.t)("public-dashboard.email-sharing.invite-field-label","Invite"),description:(0,h.t)("public-dashboard.email-sharing.invite-field-desc","Invite people by email"),error:Ve.email?.message,invalid:!!Ve.email?.message||void 0,className:pe.field,children:(0,t.jsxs)("div",{className:pe.emailContainer,children:[(0,t.jsx)(i.p,{className:pe.emailInput,placeholder:"email",autoCapitalize:"none",...Me("email",{required:(0,h.t)("public-dashboard.email-sharing.input-required-email-text","Email is required"),pattern:{value:j._l,message:(0,h.t)("public-dashboard.email-sharing.input-invalid-email-text","Invalid email")}}),"data-testid":z.EmailSharingInput}),(0,t.jsxs)(c.$n,{type:"submit",variant:"primary",disabled:De,"data-testid":z.EmailSharingInviteButton,children:[(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.email-sharing.invite-button",children:"Invite"}),De&&(0,t.jsx)(W.y,{})]})]})}),!!Ie?.recipients?.length&&(0,t.jsx)(G,{recipients:Ie.recipients,dashboardUid:Pe,publicDashboardUid:Ie.uid})]})]})})},Q=J=>({container:(0,n.css)({label:"emailConfigContainer",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:J.spacing(3)}),field:(0,n.css)({label:"field-noMargin",marginBottom:0}),emailContainer:(0,n.css)({label:"emailContainer",display:"flex",gap:J.spacing(1)}),emailInput:(0,n.css)({label:"emailInput",flexGrow:1}),table:(0,n.css)({label:"table",display:"flex",maxHeight:"220px",overflowY:"scroll","& tbody":{display:"flex",flexDirection:"column",flexGrow:1},"& tr":{minHeight:"40px",display:"flex",alignItems:"center",justifyContent:"space-between",padding:J.spacing(.5,1),":nth-child(odd)":{background:J.colors.background.secondary}}}),tableButtonsContainer:(0,n.css)({display:"flex",justifyContent:"end"})});var Y=e(96540),q=e(67892),te=e(29158);function X({headerElement:J,isContentVisible:ce=!1,onRowToggle:pe,title:Pe,...Ie}){const ge=(0,a.of)(ee),Se=J&&q.renderOrCallToRender(J,{className:ge.summaryWrapper});return(0,t.jsx)("div",{className:ge.wrapper,children:(0,t.jsxs)("div",{className:ge.header,children:[(0,t.jsx)(te.K,{name:ce?"angle-down":"angle-right",tooltip:ce?(0,h.t)("public-dashboard.settings-bar-header.collapse-settings-tooltip","Collapse settings"):(0,h.t)("public-dashboard.settings-bar-header.expand-settings-tooltip","Expand settings"),className:ge.collapseIcon,onClick:pe,"aria-expanded":ce,...Ie}),Pe&&(0,t.jsx)("div",{className:ge.titleWrapper,onClick:pe,children:(0,t.jsx)("span",{className:ge.title,children:Pe})}),Se]})})}X.displayName="SettingsBarHeader";function ee(J){return{wrapper:(0,n.css)({label:"header",padding:J.spacing(.5,.5),borderRadius:J.shape.radius.default,background:J.colors.background.secondary,minHeight:J.spacing(4),"&:focus":{outline:"none"}}),header:(0,n.css)({label:"column",display:"flex",alignItems:"center",whiteSpace:"nowrap"}),collapseIcon:(0,n.css)({marginLeft:J.spacing(.5),color:J.colors.text.disabled}),titleWrapper:(0,n.css)({display:"flex",alignItems:"center",cursor:"pointer",overflow:"hidden",marginRight:`${J.spacing(.5)}`,[J.breakpoints.down("sm")]:{flex:"1 1"}}),title:(0,n.css)({fontWeight:J.typography.fontWeightBold,marginLeft:J.spacing(.5),overflow:"hidden",textOverflow:"ellipsis"}),summaryWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",[J.breakpoints.down("sm")]:{flex:"2 2"}})}}function ne({children:J,title:ce,headerElement:pe,...Pe}){const Ie=(0,a.of)(Z),[ge,Se]=(0,Y.useState)(!1);function De(){Se(Ke=>!Ke)}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X,{onRowToggle:De,isContentVisible:ge,title:ce,headerElement:pe,...Pe}),ge&&(0,t.jsx)("div",{className:Ie.content,children:J})]})}ne.displayName="SettingsBar";const Z=J=>({content:(0,n.css)({marginTop:J.spacing(1),marginLeft:J.spacing(4)})});var ae=e(3799);function re({className:J,isDataLoading:ce=!1,timeRange:pe,timeSelectionEnabled:Pe,annotationsEnabled:Ie}){const ge=(0,a.of)(se),Se=(0,h.t)("public-dashboard.settings-summary.time-range-picker-enabled-text","Time range picker = enabled"),De=(0,h.t)("public-dashboard.settings-summary.time-range-picker-disabled-text","Time range picker = disabled"),Ke=(0,h.t)("public-dashboard.settings-summary.annotations-show-text","Annotations = show"),Me=(0,h.t)("public-dashboard.settings-summary.annotations-hide-text","Annotations = hide");return ce?(0,t.jsx)("div",{className:(0,n.cx)(ge.summaryWrapper,J),children:(0,t.jsx)(W.y,{className:ge.summary,inline:!0,size:"sm"})}):(0,t.jsxs)("div",{className:(0,n.cx)(ge.summaryWrapper,J),children:[(0,t.jsxs)("span",{className:ge.summary,children:[(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.settings-summary.time-range-text",children:"Time range = "}),(0,t.jsx)(ae.f,{className:ge.timeRange,value:pe})]}),(0,t.jsx)("span",{className:ge.summary,children:Pe?Se:De}),(0,t.jsx)("span",{className:ge.summary,children:Ie?Ke:Me})]})}re.displayName="SettingsSummary";const se=J=>({summaryWrapper:(0,n.css)({display:"flex"}),summary:(0,n.css)({label:"collapsedText",marginLeft:`${J.spacing.gridSize*2}px`,fontSize:J.typography.bodySmall.fontSize,color:J.colors.text.secondary}),timeRange:(0,n.css)({display:"inline-block"})}),de=s.Tp.pages.ShareDashboardModal.PublicDashboard;function le({onRevoke:J,timeRange:ce,hasTemplateVariables:pe=!1,showSaveChangesAlert:Pe=!1,unsupportedDatasources:Ie=[],publicDashboard:ge,dashboard:Se}){const De=(0,a.of)(ie),Ke=E(),[Me,{isLoading:be}]=(0,y.T2)(),[we,{isLoading:Be}]=(0,y.eq)(),He=m.TP.hasPermission(D.AccessControlAction.DashboardsPublicWrite),Ve=!He||be||Be,{handleSubmit:Je,setValue:nt,register:pt}=(0,r.mN)({defaultValues:{isAnnotationsEnabled:ge?.annotationsEnabled,isTimeSelectionEnabled:ge?.timeSelectionEnabled,isPaused:!ge?.isEnabled}}),bt=async Ee=>{const{isAnnotationsEnabled:Ce,isTimeSelectionEnabled:Ne,isPaused:Fe}=Ee;Me({dashboard:Se,payload:{...ge,annotationsEnabled:Ce,timeSelectionEnabled:Ne,isEnabled:!Fe}})},Tt=async Ee=>{const{isAnnotationsEnabled:Ce,isTimeSelectionEnabled:Ne,isPaused:Fe}=Ee;we({dashboard:Se,payload:{...ge,annotationsEnabled:Ce,timeSelectionEnabled:Ne,isEnabled:!Fe}})},ye=async(Ee,Ce)=>{nt(Ee,Ce),await Je(Ne=>bt(Ne))()},je=async Ee=>{nt("isPaused",Ee),await Je(Ce=>Tt(Ce))()};function ue(){v.c.publicDashboardUrlCopied()}return(0,t.jsxs)("div",{className:De.configContainer,children:[Pe&&(0,t.jsx)(R,{}),!He&&(0,t.jsx)(T.t,{mode:"edit"}),pe&&(0,t.jsx)(O.D,{}),Ie.length>0&&(0,t.jsx)(S.s,{unsupportedDataSources:Ie.join(", ")}),(0,j.AY)()&&(0,t.jsx)(M,{dashboard:Se}),(0,t.jsx)(g.D,{label:(0,h.t)("public-dashboard.config.dashboard-url-field-label","Dashboard URL"),className:De.fieldSpace,children:(0,t.jsx)(i.p,{value:(0,j.mL)(ge.accessToken),readOnly:!0,disabled:!ge?.isEnabled,"data-testid":de.CopyUrlInput,addonAfter:(0,t.jsx)(l.b,{"data-testid":de.CopyUrlButton,variant:"primary",disabled:!ge?.isEnabled,getText:()=>(0,j.mL)(ge.accessToken),onClipboardCopy:ue,children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.config.copy-button",children:"Copy"})})})}),(0,t.jsx)(g.D,{className:De.fieldSpace,children:(0,t.jsxs)(u.PE,{children:[(0,t.jsx)(d.d,{...pt("isPaused"),disabled:Ve,onChange:Ee=>{v.c.publicDashboardPauseSharingClicked({paused:Ee.currentTarget.checked}),je(Ee.currentTarget.checked)},"data-testid":de.PauseSwitch}),(0,t.jsx)(o.J,{className:(0,n.css)({marginBottom:0}),children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.config.pause-sharing-dashboard-label",children:"Pause sharing dashboard"})})]})}),(0,t.jsx)(g.D,{className:De.fieldSpace,children:(0,t.jsx)(ne,{title:(0,h.t)("public-dashboard.config.settings-title","Settings"),headerElement:({className:Ee})=>(0,t.jsx)(re,{className:Ee,isDataLoading:be,timeRange:ce,timeSelectionEnabled:ge?.timeSelectionEnabled,annotationsEnabled:ge?.annotationsEnabled}),"data-testid":de.SettingsDropdown,children:(0,t.jsx)(K,{disabled:Ve,onChange:ye,register:pt,timeRange:ce})})}),(0,t.jsx)(u.PE,{orientation:Ke?0:1,justify:Ke?"flex-end":"flex-start",align:Ke?"center":"normal",children:(0,t.jsx)(u.Gy,{justify:"flex-end",children:(0,t.jsx)(c.$n,{title:(0,h.t)("public-dashboard.config.revoke-public-URL-button-title","Revoke public URL"),onClick:J,type:"button",disabled:Ve,"data-testid":de.DeleteButton,variant:"destructive",fill:"outline",children:(0,t.jsx)(h.x6,{i18nKey:"public-dashboard.config.revoke-public-URL-button",children:"Revoke public URL"})})})})]})}function he({publicDashboard:J,unsupportedDatasources:ce}){const Pe=(0,D.useSelector)(Me=>Me.dashboard).getModel(),Ie=(0,f.z)(Pe.getDefaultTime(),Pe),ge=m.TP.hasPermission(D.AccessControlAction.DashboardsPublicWrite),Se=(0,j.kD)(Pe.getVariables()),[De]=(0,y.bN)(),Ke=Me=>{De({dashboard:Pe,uid:J.uid,dashboardUid:Pe.uid}),Me()};return(0,t.jsx)(p.$s,{children:({showModal:Me,hideModal:be})=>(0,t.jsx)(le,{publicDashboard:J,dashboard:Pe,unsupportedDatasources:ce,timeRange:Ie,showSaveChangesAlert:ge&&Pe.hasUnsavedChanges(),hasTemplateVariables:Se,onRevoke:()=>{v.c.revokePublicDashboardClicked(),Me(P.m,{onConfirm:()=>Ke(be),onDismiss:()=>{Me(C.Zy,{dashboard:Pe,onDismiss:be,activeTab:b.wr.publicDashboard})}})}})})}const ie=J=>({configContainer:(0,n.css)({label:"config container",display:"flex",flexDirection:"column",flexWrap:"wrap",gap:J.spacing(3)}),fieldSpace:(0,n.css)({label:"field space",width:"100%",marginBottom:0}),timeRange:(0,n.css)({display:"inline-block"})})},22234:(_,L,e)=>{"use strict";e.d(L,{M:()=>A,D:()=>T});var t=e(74848),n=e(32196),r=e(49785),s=e(13544),a=e(40845),g=e(55852),i=e(62930),l=e(8484),d=e(16233),o=e(72686),u=e(7758),c=e(31678),p=e(6923),h=e(12257),y=e(10872),f=e(72254),v=e(71415),P=e(84167),m=e(66864),D=e(10880);const x=s.Tp.pages.ShareDashboardModal.PublicDashboard,E=({disabled:S,register:O})=>{const j=(0,a.of)(C),B=[{type:"publicAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-desc","Your entire dashboard will be public*"),testId:x.WillBePublicCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/dashboards/dashboard-public/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.public-ack-tooltip","Learn more about public dashboards")}},{type:"dataSourcesAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-desc","Publishing currently only works with a subset of data sources*"),testId:x.LimitedDSCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/datasources/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.data-src-ack-tooltip","Learn more about public datasources")}},{type:"usageAcknowledgment",description:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc","Making a dashboard public will cause queries to run each time it is viewed, which may increase costs*"),testId:x.CostIncreaseCheckbox,info:{href:"https://grafana.com/docs/grafana/latest/enterprise/query-caching/",tooltip:(0,l.t)("public-dashboard.acknowledgment-checkboxes.usage-ack-desc-tooltip","Learn more about query caching")}}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("p",{className:j.title,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.acknowledgment-checkboxes.ack-title",children:"Before you make the dashboard public, acknowledge the following:"})}),(0,t.jsx)(P.n,{disabled:S,children:(0,t.jsx)(m.gW,{spacing:"md",children:B.map(N=>(0,t.jsxs)(m.Gy,{spacing:"none",align:"center",children:[(0,t.jsx)(D.S,{...O(N.type,{required:!0}),label:N.description,"data-testid":N.testId}),(0,t.jsx)(g.z9,{variant:"primary",href:N.info.href,target:"_blank",fill:"text",icon:"info-circle",rel:"noopener noreferrer",tooltip:N.info.tooltip})]},N.type))})})]})},C=S=>({title:(0,n.css)({fontWeight:S.typography.fontWeightBold})}),b=s.Tp.pages.ShareDashboardModal.PublicDashboard,T=({unsupportedDatasources:S=[],unsupportedTemplateVariables:O=!1,dashboard:j,hasError:B=!1})=>{const N=(0,a.of)(R),I=d.TP.hasPermission(c.AccessControlAction.DashboardsPublicWrite),[K,{isLoading:w,isError:U}]=(0,o.U9)(),W=()=>{K({dashboard:j,payload:{isEnabled:!0}}),u.c.generatePublicDashboardUrlClicked({})},{handleSubmit:H,register:z,formState:{isValid:G}}=(0,r.mN)({mode:"onChange"}),M=!I||w||U||B;return(0,t.jsxs)("div",{className:N.container,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:N.title,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.welcome-title",children:"Welcome to public dashboards!"})}),(0,t.jsx)("p",{className:N.description,children:(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.unsupported-features-desc",children:"Currently, we don\u2019t support template variables or frontend data sources"})})]}),!I&&(0,t.jsx)(p.t,{mode:"create"}),O&&(0,t.jsx)(y.D,{}),S.length>0&&(0,t.jsx)(h.s,{unsupportedDataSources:S.join(", ")}),(0,t.jsxs)("form",{onSubmit:H(W),children:[(0,t.jsx)("div",{className:N.checkboxes,children:(0,t.jsx)(E,{disabled:M,register:z})}),(0,t.jsx)("div",{className:N.buttonContainer,children:(0,t.jsxs)(g.$n,{type:"submit",disabled:M||!G,"data-testid":b.CreateButton,children:[(0,t.jsx)(l.x6,{i18nKey:"public-dashboard.create-page.generate-public-url-button",children:"Generate public URL"}),w&&(0,t.jsx)(i.y,{className:N.loadingSpinner})]})})]})]})};function A({hasError:S}){const j=(0,c.useSelector)(I=>I.dashboard).getModel(),{unsupportedDataSources:B}=(0,v.Z)(j),N=(0,f.kD)(j.getVariables());return(0,t.jsx)(T,{dashboard:j,unsupportedDatasources:B,unsupportedTemplateVariables:N,hasError:S})}const R=S=>({container:(0,n.css)({display:"flex",flexDirection:"column",gap:S.spacing(4)}),title:(0,n.css)({fontSize:S.typography.h4.fontSize,margin:S.spacing(0,0,2)}),description:(0,n.css)({color:S.colors.text.secondary,marginBottom:S.spacing(0)}),checkboxes:(0,n.css)({margin:S.spacing(0,0,4)}),buttonContainer:(0,n.css)({display:"flex",justifyContent:"end"}),loadingSpinner:(0,n.css)({marginLeft:S.spacing(1)})})},6923:(_,L,e)=>{"use strict";e.d(L,{t:()=>i});var t=e(74848),n=e(13544),r=e(32264),s=e(42418),a=e(8484);const g=n.Tp.pages.ShareDashboardModal.PublicDashboard,i=({mode:l})=>{const d=r.$.featureToggles.newDashboardSharingComponent?(0,a.t)("public-dashboard.share-externally.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a shared dashboard",{mode:l}):(0,a.t)("public-dashboard.modal-alerts.no-upsert-perm-alert-title","You don\u2019t have permission to {{ mode }} a public dashboard",{mode:l});return(0,t.jsx)(s.F,{severity:"warning",title:d,"data-testid":g.NoUpsertPermissionsWarningAlert,bottomSpacing:0,children:r.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(a.x6,{i18nKey:"public-dashboard.share-externally.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:l}," shared dashboards"]}):(0,t.jsxs)(a.x6,{i18nKey:"public-dashboard.modal-alerts.no-upsert-perm-alert-desc",children:["Contact your admin to get permission to ",{mode:l}," public dashboards"]})})}},12257:(_,L,e)=>{"use strict";e.d(L,{s:()=>u});var t=e(74848),n=e(32196),r=e(46942),s=e.n(r),a=e(13544),g=e(32264),i=e(40845),l=e(42418),d=e(8484);const o=a.Tp.pages.ShareDashboardModal.PublicDashboard,u=({unsupportedDataSources:p})=>{const h=(0,i.of)(c);return(0,t.jsxs)(l.F,{severity:"warning",title:(0,d.t)("public-dashboard.modal-alerts.unsupported-data-source-alert-title","Unsupported data sources"),"data-testid":o.UnsupportedDataSourcesWarningAlert,bottomSpacing:0,children:[(0,t.jsx)("p",{className:h.unsupportedDataSourceDescription,children:g.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.share-externally.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for shared dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:p},"."]}):(0,t.jsxs)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-data-source-alert-desc",children:["There are data sources in this dashboard that are unsupported for public dashboards. Panels that use these data sources may not function properly: ",{unsupportedDataSources:p},"."]})}),(0,t.jsx)("a",{href:g.$.featureToggles.newDashboardSharingComponent?"https://grafana.com/docs/grafana/next/dashboards/share-dashboards-panels/shared-dashboards/#supported-data-sources":"https://grafana.com/docs/grafana/v11.2/dashboards/dashboard-public/#supported-data-sources",target:"blank",className:s()("text-link",h.unsupportedDataSourceDescription),children:(0,t.jsx)(d.x6,{i18nKey:"public-dashboard.modal-alerts.unsupport-data-source-alert-readmore-link",children:"Read more about supported data sources"})})]})},c=p=>({unsupportedDataSourceDescription:(0,n.css)({color:p.colors.text.secondary,marginBottom:p.spacing(1)})})},10872:(_,L,e)=>{"use strict";e.d(L,{D:()=>g});var t=e(74848),n=e(13544),r=e(42418),s=e(8484);const a=n.Tp.pages.ShareDashboardModal.PublicDashboard,g=({showDescription:i=!0})=>(0,t.jsx)(r.F,{severity:"warning",title:(0,s.t)("public-dashboard.modal-alerts.unsupported-template-variable-alert-title","Template variables are not supported"),"data-testid":a.TemplateVariablesWarningAlert,bottomSpacing:0,children:i&&(0,t.jsx)(s.x6,{i18nKey:"public-dashboard.modal-alerts.unsupported-template-variable-alert-desc",children:"This public dashboard may not work since it uses template variables"})})},4785:(_,L,e)=>{"use strict";e.d(L,{a:()=>c,b:()=>p});var t=e(74848),n=e(32196),r=e(40845),s=e(62930),a=e(72686),g=e(72254),i=e(31678),l=e(42930),d=e(59037),o=e(22234),u=e(71415);const c=()=>{const y=(0,r.of)(h);return(0,t.jsx)(l.G,{className:y.loadingContainer,children:(0,t.jsxs)(t.Fragment,{children:["Loading configuration",(0,t.jsx)(s.y,{size:"lg",className:y.spinner})]})})},p=y=>{const{data:f,isLoading:v,isError:P}=(0,a.Bs)(y.dashboard.uid),D=(0,i.useSelector)(E=>E.dashboard).getModel(),{unsupportedDataSources:x}=(0,u.Z)(D);return(0,t.jsx)(t.Fragment,{children:v?(0,t.jsx)(c,{}):(0,g.lI)(f)?(0,t.jsx)(d.K,{publicDashboard:f,unsupportedDatasources:x}):(0,t.jsx)(o.M,{hasError:P})})},h=y=>({loadingContainer:(0,n.css)({height:"280px",alignItems:"center",justifyContent:"center",gap:y.spacing(1)}),spinner:(0,n.css)({marginBottom:y.spacing(0)})})},72254:(_,L,e)=>{"use strict";e.d(L,{AY:()=>f,Xo:()=>l,_A:()=>u,_l:()=>h,gN:()=>p,iR:()=>y,kD:()=>d,lI:()=>o,mL:()=>c});var t=e(26657),n=e(32264),r=e(33378),s=e(2913),a=e(31193),g=e(22699),i=e(31204),l=(v=>(v.PUBLIC="public",v.EMAIL="email",v))(l||{});const d=v=>v.length>0,o=v=>v?.uid!==""&&v?.uid!==void 0,u=async v=>{let P=new Set;for(const m of v)for(const D of m.targets){const x=D?.datasource?.type;x&&(i.z.has(x)&&await(0,a.tR)().get(D.datasource)instanceof t.iy||P.add(x))}return Array.from(P).sort()},c=v=>`${(0,s.zj)().appUrl}public-dashboards/${v}`,p=(v,P)=>`/d/${v}/${P}?shareView=${g.wr.publicDashboard}`,h=/^[A-Z\d._%+-]+@[A-Z\d.-]+\.[A-Z]{2,}$/i,y=()=>!!n.$.featureToggles.publicDashboards&&n.$.publicDashboardsEnabled,f=()=>y()&&!!n.$.featureToggles.publicDashboardsEmailSharing&&(0,r.a)("publicDashboardsEmailSharing")},31204:(_,L,e)=>{"use strict";e.d(L,{z:()=>t});const t=new Set(["__expr__","aggregations-io-datasource","apache-iotdb-datasource","aquaqanalytics-kdbbackend-datasource","axiomhq-axiom-datasource","cloudwatch","cnos-cnosdb-datasource","datasource","dlopes7-appdynamics-datasource","dvelop-odata-datasource","elasticsearch","factry-historian-datasource","fiskaly-surrealdb-datasource","frser-sqlite-datasource","grafadruid-druid-datasource","grafana-athena-datasource","grafana-azure-data-explorer-datasource","grafana-azure-monitor-datasource","grafana-azurecosmosdb-datasource","grafana-bigquery-datasource","grafana-catchpoint-datasource","grafana-clickhouse-datasource","grafana-databricks-datasource","grafana-datadog-datasource","grafana-dynamodb-datasource","grafana-dynatrace-datasource","grafana-falconlogscale-datasource","grafana-github-datasource","grafana-gitlab-datasource","grafana-honeycomb-datasource","grafana-iot-sitewise-datasource","grafana-jira-datasource","grafana-looker-datasource","grafana-mock-datasource","grafana-mongodb-datasource","grafana-newrelic-datasource","grafana-odbc-datasource","grafana-opensearch-datasource","grafana-oracle-datasource","grafana-orbit-datasource","grafana-pagerduty-datasource","grafana-redshift-datasource","grafana-salesforce-datasource","grafana-saphana-datasource","grafana-sentry-datasource","grafana-servicenow-datasource","grafana-snowflake-datasource","grafana-splunk-datasource","grafana-splunk-monitoring-datasource","grafana-sumologic-datasource","grafana-surrealdb-datasource","grafana-testdata-datasource","grafana-timestream-datasource","grafana-wavefront-datasource","grafana-x-ray-datasource","graphite","hadesarchitect-cassandra-datasource","highlightinc-highlight-datasource","ibm-aql-datasource","ibm-kql-datasource","influxdata-flightsql-datasource","influxdb","innius-grpc-datasource","kniepdennis-neo4j-datasource","loki","manassehzhou-maxcompute-datasource","marcusolsson-csv-datasource","mssql","mysql","nagasudhirpulla-api-datasource","needleinajaystack-haystack-datasource","oci-metrics-datasource","opentsdb","parseable-parseable-datasource","postgres","prometheus","questdb-questdb-datasource","quickwit-quickwit-datasource","redis-datasource","retrodaredevil-wildgraphql-datasource","stackdriver","tdengine-datasource","timeplus-proton-datasource","trino-datasource","vertamedia-clickhouse-datasource","vertica-grafana-datasource","ydbtech-ydb-datasource","yesoreyeram-infinity-datasource"])},71415:(_,L,e)=>{"use strict";e.d(L,{Z:()=>r});var t=e(96540),n=e(72254);const r=s=>{const[a,g]=(0,t.useState)([]);return(0,t.useEffect)(()=>{(async()=>await(0,n._A)(s.panels))().then(l=>{g(l)})},[s.panels]),{unsupportedDataSources:a}}},87895:(_,L,e)=>{"use strict";e.d(L,{w:()=>a});var t=e(74848),n=e(88575),r=e(94354),s=e(8484);const a=({selectedTheme:g="current",onChange:i})=>{const l=[{label:(0,s.t)("share-modal.theme-picker.current","Current"),value:"current"},{label:(0,s.t)("share-modal.theme-picker.dark","Dark"),value:"dark"},{label:(0,s.t)("share-modal.theme-picker.light","Light"),value:"light"}];return(0,t.jsx)(n.D,{label:(0,s.t)("share-modal.theme-picker.field-name","Theme"),children:(0,t.jsx)(r.z,{options:l,value:g,onChange:i})})}},1702:(_,L,e)=>{"use strict";e.d(L,{ShareModal:()=>t.Zy});var t=e(7686)},22699:(_,L,e)=>{"use strict";e.d(L,{CF:()=>p,Lb:()=>c,P_:()=>d,XV:()=>l,Xe:()=>o,hD:()=>y,wr:()=>f});var t=e(65879),n=e(76885),r=e(71733),s=e(47232),a=e(32264),g=e(7030),i=e(74856);function l({useCurrentTimeRange:v,selectedTheme:P,panel:m,search:D=window.location.search,range:x=(0,i.jG)().timeRange(),orgId:E=a.$.bootData.user.orgId}){const C=new URLSearchParams(D),b=m?.timeFrom;if(b){const{from:T,to:A}=t.describeTextRange(b);C.set("from",T),C.set("to",A)}else C.set("from",String(x.from.valueOf())),C.set("to",String(x.to.valueOf()));return C.set("orgId",String(E)),v||(C.delete("from"),C.delete("to")),P!=="current"&&C.set("theme",P),m&&!C.has("editPanel")&&C.set("viewPanel",String(m.id)),C.delete("auth_token"),C.delete("shareView"),C}function d(){let v=window.location.href;const P=v.indexOf("?");return P!==-1&&(v=v.substring(0,P)),v}async function o(v,P,m,D){const x=d(),E=l({useCurrentTimeRange:v,selectedTheme:P,panel:m}),C=n.kM.appendQueryToUrl(x,E.toString());return D?await(0,g.fn)(C):C}function u(v,P,m,D,x){const E=d(),C=l({useCurrentTimeRange:v,selectedTheme:m,panel:D,range:x});let b=E.replace(a.$.appSubUrl+"/dashboard/",a.$.appSubUrl+"/dashboard-solo/");b=b.replace(a.$.appSubUrl+"/d/",a.$.appSubUrl+"/d-solo/"),r.I.stripBaseFromUrl(E)==="/"&&(b=`${a.$.appUrl}d-solo/${P}`);const A=C.get("editPanel")??C.get("viewPanel")??"";return C.set("panelId",A),C.delete("editPanel"),C.delete("viewPanel"),n.kM.appendQueryToUrl(b,C.toString())}function c(v,P,m,D){let E=u(v,P,m,D).replace(a.$.appSubUrl+"/dashboard-solo/",a.$.appSubUrl+"/render/dashboard-solo/");return E=E.replace(a.$.appSubUrl+"/d-solo/",a.$.appSubUrl+"/render/d-solo/"),E+=`&width=${a.$.rendererDefaultImageWidth}&height=${a.$.rendererDefaultImageHeight}&scale=${a.$.rendererDefaultImageScale}`+h(),E}function p(v,P,m,D,x){return`<iframe src="${u(v,P,m,D,x)}" width="450" height="200" frameborder="0"></iframe>`}function h(){const v="&tz=UTC"+encodeURIComponent((0,s.KQ)().format("Z"));if(!window.Intl)return v;const P=window.Intl.DateTimeFormat();if(!P.resolvedOptions)return v;const m=P.resolvedOptions();return m.timeZone?"&tz="+encodeURIComponent(m.timeZone):v}const y=v=>v?"panel":"dashboard",f={link:"link",snapshot:"snapshot",export:"export",embed:"embed",libraryPanel:"library_panel",pdf:"pdf",report:"report",publicDashboard:"public_dashboard"}},52424:(_,L,e)=>{"use strict";e.d(L,{Zx:()=>x,aK:()=>f});var t=e(74848),n=e(32196),r=e(96540),s=e(16817),a=e(80997),g=e(13544),i=e(40845),l=e(38138),d=e(40276),o=e(83122),u=e(14578),c=e(55852),p=e(27677),h=e(29304);function y({dashboardUID:E,link:C}){const b=(0,i.of)(D),T=v({dashboardUID:E,link:C});return!T||m.length===0?null:(0,t.jsx)(l.W,{children:(0,t.jsx)("div",{className:b.dropdown,children:(0,t.jsx)(d.E,{children:T.map((A,R)=>(0,t.jsx)(l.W.Item,{url:A.url,target:C.targetBlank?"_blank":void 0,label:A.title,testId:g.Tp.components.DashboardLinks.link,"aria-label":`${A.title} dashboard`},`dashlinks-dropdown-item-${A.uid}-${R}`))})})})}const f=E=>{const{link:C,linkInfo:b,dashboardUID:T}=E,A=v(E),R=(0,i.of)(D);return C.asDropdown?(0,t.jsx)(o.m,{overlay:(0,t.jsx)(y,{link:C,dashboardUID:T}),children:(0,t.jsxs)(x,{"data-placement":"bottom","data-toggle":"dropdown","aria-controls":"dropdown-list","aria-haspopup":"menu",fill:"outline",variant:"secondary","data-testid":g.Tp.components.DashboardLinks.dropDown,children:[(0,t.jsx)(u.I,{"aria-hidden":!0,name:"bars",className:R.iconMargin}),(0,t.jsx)("span",{children:b.title})]})}):(0,t.jsx)(t.Fragment,{children:A.length>0&&A.map((S,O)=>(0,t.jsx)(x,{icon:"apps",variant:"secondary",fill:"outline",href:S.url,target:C.targetBlank?"_blank":void 0,rel:"noreferrer","data-testid":g.Tp.components.DashboardLinks.link,children:S.title},`dashlinks-list-item-${S.uid}-${O}`))})},v=({link:E,dashboardUID:C})=>{const{tags:b}=E,T=(0,s.A)(()=>P(b),[b]);return T.value?m(C,E,T.value):[]};async function P(E,C={getBackendSrv:p.AI}){return await C.getBackendSrv().search({tag:E,limit:100})}function m(E,C,b,T={getLinkSrv:h.mQ,sanitize:a.aj,sanitizeUrl:a.Jf}){return b.filter(A=>A.uid!==E).map(A=>{const R=A.uid,S=T.sanitize(A.title),O=T.getLinkSrv().getLinkUrl({...C,url:A.url}),j=T.sanitizeUrl(O);return{uid:R,title:S,url:j}})}function D(E){return{iconMargin:(0,n.css)({marginRight:E.spacing(.5)}),dropdown:(0,n.css)({maxWidth:"max(30vw, 300px)",maxHeight:"70vh",overflowY:"auto"}),button:(0,n.css)({color:E.colors.text.primary}),dashButton:(0,n.css)({fontSize:E.typography.bodySmall.fontSize,paddingLeft:E.spacing(1),paddingRight:E.spacing(1)})}}const x=(0,r.forwardRef)(({className:E,...C},b)=>{const T=(0,i.of)(D),A=C.href?c.z9:c.$n;return(0,t.jsx)(A,{...C,variant:"secondary",fill:"outline",className:(0,n.cx)(E,T.dashButton),ref:b})});x.displayName="DashboardLinkButton"},57650:(_,L,e)=>{"use strict";e.d(L,{A:()=>K});var t=e(74848),n=e(97497),r=e(96540),s=e(42941),a=e(1173),g=e(52622),i=e(13544),l=e(14110),d=e(96374),o=e(10343),u=e(7788),c=e(2913),p=e(10803),h=e(32196),y=e(69862),f=e(85200),v=e(2514),P=e(72574),m=e(40845),D=e(87978),x=e(24022),E=e(14578);const C=({debugMode:w,index:U,data:W,uiConfig:H,configs:z,onChange:G,toggleShowDebug:M})=>{const Q=(0,m.of)(b),[Y,q]=(0,r.useState)([]),[te,X]=(0,r.useState)([]),ee=(0,r.useMemo)(()=>z[U],[z,U]);(0,r.useEffect)(()=>{const Z=z[U].transformation,ae=Z.filter?.options?(0,f.Dq)(Z.filter):void 0,re=z.slice(0,U).map(ie=>ie.transformation),se=z.slice(U,U+1).map(ie=>ie.transformation),de={interpolate:ie=>(0,P.w)().replace(ie)},le=(0,v.m)(re,W,de).subscribe(ie=>{ae&&(ie=W.filter(J=>ae(J))),q(ie)}),he=(0,v.m)(re,W,de).pipe((0,y.Z)(ie=>(0,v.m)(se,ie,de))).subscribe(X);return function(){le.unsubscribe(),he.unsubscribe()}},[U,W,z]);const ne=(0,r.useMemo)(()=>(0,r.createElement)(H.editor,{options:{...H.transformation.defaultOptions,...ee.transformation.options},input:Y,onChange:Z=>{G(U,{...ee.transformation,options:Z})}}),[H.editor,H.transformation.defaultOptions,ee.transformation,Y,G,U]);return(0,t.jsxs)("div",{"data-testid":i.Tp.components.TransformTab.transformationEditor(H.name),children:[ne,w&&(0,t.jsx)(D._,{title:"Debug transformation",subtitle:H.name,onClose:M,children:(0,t.jsxs)("div",{className:Q.debugWrapper,"data-testid":i.Tp.components.TransformTab.transformationEditorDebugger(H.name),children:[(0,t.jsxs)("div",{className:Q.debug,children:[(0,t.jsx)("div",{className:Q.debugTitle,children:"Input data"}),(0,t.jsx)("div",{className:Q.debugJson,children:(0,t.jsx)(x.B,{json:Y})})]}),(0,t.jsx)("div",{className:Q.debugSeparator,children:(0,t.jsx)(E.I,{name:"arrow-right"})}),(0,t.jsxs)("div",{className:Q.debug,children:[(0,t.jsx)("div",{className:Q.debugTitle,children:"Output data"}),(0,t.jsx)("div",{className:Q.debugJson,children:te&&(0,t.jsx)(x.B,{json:te})})]})]})})]})},b=w=>({title:(0,h.css)({display:"flex",padding:"4px 8px 4px 8px",position:"relative",height:"35px",borderRadius:"4px 4px 0 0",flexWrap:"nowrap",justifyContent:"space-between",alignItems:"center"}),name:(0,h.css)({fontWeight:w.typography.fontWeightMedium,color:w.colors.primary.text}),iconRow:(0,h.css)({display:"flex"}),icon:(0,h.css)({background:"transparent",border:"none",boxShadow:"none",cursor:"pointer",color:w.colors.text.secondary,marginLeft:w.spacing(1),"&:hover":{color:w.colors.text.primary}}),debugWrapper:(0,h.css)({display:"flex",flexDirection:"row"}),debugSeparator:(0,h.css)({width:"48px",minHeight:"300px",display:"flex",alignItems:"center",alignSelf:"stretch",justifyContent:"center",margin:`0 ${w.spacing(.5)}`,color:w.colors.primary.text}),debugTitle:(0,h.css)({padding:`${w.spacing(1)} ${w.spacing(.25)}`,fontFamily:w.typography.fontFamilyMonospace,fontSize:w.typography.bodySmall.fontSize,color:w.colors.text.primary,borderBottom:`1px solid ${w.colors.border.weak}`,flexGrow:0,flexShrink:1}),debug:(0,h.css)({marginTop:w.spacing(1),padding:`0 ${w.spacing(1,1,1)}`,border:`1px solid ${w.colors.border.weak}`,background:`${w.isLight?w.v1.palette.white:w.v1.palette.gray05}`,borderRadius:w.shape.radius.default,width:"100%",minHeight:"300px",display:"flex",flexDirection:"column",alignSelf:"stretch"}),debugJson:(0,h.css)({flexGrow:1,height:"100%",overflow:"hidden",padding:w.spacing(.5)})});var T=e(22214),A=e(91847);const R=({isOpen:w,onCloseClick:U,transformer:W})=>{const{transformation:{name:H},help:z}=W,G=z||(0,A.$n)(),M=(0,t.jsx)(D._,{title:H,subtitle:"Transformation help",onClose:()=>U(!1),children:(0,t.jsx)(T.j,{markdown:G,styleOverrides:{borderTop:"2px solid"}})});return w?M:null};var S=e(88575),O=e(90182),j=e(19743);const B=({index:w,data:U,config:W,onChange:H})=>{const z=(0,m.of)(N),G=(0,r.useMemo)(()=>({context:{data:U.series},showTopic:!0,showFilter:W.topic!==g.QR.Annotations,source:[{value:g.QR.Series,label:"Query results"},{value:g.QR.Annotations,label:"Annotation data"}]}),[U,W.topic]);return(0,t.jsx)("div",{className:z.wrapper,children:(0,t.jsx)(S.D,{label:"Apply transformation to",children:(0,t.jsxs)(t.Fragment,{children:[G.showTopic&&(0,t.jsx)(O.l6,{isClearable:!0,options:G.source,value:G.source.find(M=>M.value===W.topic),placeholder:G.source[0].label,className:z.padded,onChange:M=>{H(w,{...W,topic:M?.value})}}),G.showFilter&&(0,t.jsx)(j.x,{value:W.filter,context:G.context,item:{},onChange:M=>H(w,{...W,filter:M})})]})})})},N=w=>{const U=w.shape.radius.default;return{wrapper:(0,h.css)({padding:w.spacing(2),border:`2px solid ${w.colors.background.secondary}`,borderTop:"none",borderRadius:`0 0 ${U} ${U}`,position:"relative",top:"-4px"}),padded:(0,h.css)({marginBottom:w.spacing(1)})}},I=({onRemove:w,index:U,id:W,data:H,configs:z,uiConfig:G,onChange:M})=>{const[Q,Y]=(0,s.A)(!1),[q,te]=(0,s.A)(!1),[X,ee]=(0,s.A)(!1),ne=!!z[U].transformation.disabled,Z=z[U].transformation.topic,ae=z[U].transformation.filter!=null||Z!=null,re=ae||H.series.length>0||(H.annotations?.length??0)>0,se=(0,r.useCallback)(ie=>{const J=z[ie].transformation;M(ie,{...J,disabled:J.disabled?void 0:!0})},[M,z]),de=(0,r.useCallback)(()=>{let ie={...z[U].transformation};ie.filter?delete ie.filter:ie.filter={id:a.jR.byRefId,options:""},M(U,ie)},[M,U,z]),le=(0,r.useCallback)((ie,J,ce)=>pe=>{let Pe="panel_editor_tabs_transformations_toggle";c.Ay.featureToggles.transformationsRedesign&&(Pe="transformations_redesign_"+Pe),(0,l.rR)(Pe,{action:ce?"off":"on",toggleId:J,transformationId:z[U].transformation.id}),ie(pe)},[z,U]),he=()=>(0,t.jsxs)(t.Fragment,{children:[G.state&&(0,t.jsx)(p.p,{state:G.state}),(0,t.jsx)(o.A,{title:"Show transform help",icon:"info-circle",onClick:le(ee,"help",X),active:X}),re&&(0,t.jsx)(o.A,{title:"Filter",icon:"filter",onClick:le(de,"filter",ae),active:ae}),(0,t.jsx)(o.A,{title:"Debug",icon:"bug",onClick:le(te,"debug",q),active:q}),(0,t.jsx)(o.A,{title:"Disable transformation",icon:ne?"eye-slash":"eye",onClick:le(()=>se(U),"disabled",ne),active:ne,dataTestId:i.Tp.components.Transforms.disableTransformationButton}),(0,t.jsx)(o.q,{title:"Remove",icon:"trash-alt",onClick:()=>c.Ay.featureToggles.transformationsRedesign?Y(!0):w(U)}),c.Ay.featureToggles.transformationsRedesign&&(0,t.jsx)(d.u,{isOpen:Q,title:`Delete ${G.name}?`,body:"Note that removing one transformation may break others. If there is only a single transformation, you will go back to the main selection screen.",confirmText:"Delete",onConfirm:()=>{Y(!1),w(U)},onDismiss:()=>Y(!1)})]});return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(u.u,{id:W,index:U,title:`${U+1} - ${G.name}`,draggable:!0,actions:he,disabled:ne,expanderMessages:{close:"Collapse transformation row",open:"Expand transformation row"},children:[ae&&(0,t.jsx)(B,{index:U,config:z[U].transformation,data:H,onChange:M}),(0,t.jsx)(C,{debugMode:q,index:U,data:Z===g.QR.Annotations?H.annotations??[]:H.series,configs:z,uiConfig:G,onChange:M,toggleShowDebug:te})]}),(0,t.jsx)(R,{transformer:G,isOpen:X,onCloseClick:ee})]})},K=({data:w,onChange:U,onRemove:W,configs:H})=>(0,t.jsx)(t.Fragment,{children:H.map((z,G)=>{const M=n.h.getIfExists(z.transformation.id);return M?(0,t.jsx)(I,{index:G,id:`${z.id}`,data:w,configs:H,uiConfig:M,onRemove:W,onChange:U},`${z.id}`):null})})},21427:(_,L,e)=>{"use strict";e.d(L,{R:()=>x});var t=e(74848),n=e(32196),r=e(96540),s=e(81010),a=e(18282),g=e(97497),i=e(13544),l=e(40845),d=e(87978),o=e(10354),u=e(15292),c=e(92174),p=e(10860),h=e(29158),y=e(2913),f=e(10803),v=e(94397);const D=[["viewAll","View all"],...Object.entries(v.eJ)];function x(S){const O=(0,l.of)(E),{suffix:j,xforms:B,search:N,onSearchChange:I,onSearchKeyDown:K,showIllustrations:w,onTransformationAdd:U,selectedFilter:W,data:H,onClose:z,onShowIllustrationsChange:G,onSelectedFilterChange:M}=S,Q=(0,r.useCallback)(Y=>{Y?.click()},[]);return(0,t.jsxs)(d._,{size:"md",onClose:()=>{z&&z()},title:"Add another transformation",children:[(0,t.jsxs)("div",{className:O.searchWrapper,children:[(0,t.jsx)(o.p,{"data-testid":i.Tp.components.Transforms.searchInput,className:O.searchInput,value:N??"",placeholder:"Search for transformation",onChange:I,onKeyDown:K,suffix:j,ref:Q}),(0,t.jsxs)("div",{className:O.showImages,children:[(0,t.jsx)("span",{className:O.illustationSwitchLabel,children:"Show images"})," ",(0,t.jsx)(u.d,{value:w,onChange:()=>G&&G(!w)})]})]}),(0,t.jsx)("div",{className:O.filterWrapper,children:D.map(([Y,q])=>(0,t.jsx)(c.m,{onClick:()=>M&&M(Y),label:q,selected:W===Y},Y))}),(0,t.jsx)(C,{showIllustrations:w,transformations:B,data:H,onClick:Y=>{U({value:Y})}})]})}function E(S){return{showImages:(0,n.css)({flexBasis:"0",display:"flex",gap:"8px",alignItems:"center"}),pickerInformationLine:(0,n.css)({fontSize:"16px",marginBottom:`${S.spacing(2)}`}),pickerInformationLineHighlight:(0,n.css)({verticalAlign:"middle"}),searchWrapper:(0,n.css)({display:"flex",flexWrap:"wrap",columnGap:"27px",rowGap:"16px",width:"100%"}),searchInput:(0,n.css)({flexGrow:"1",width:"initial"}),illustationSwitchLabel:(0,n.css)({whiteSpace:"nowrap"}),filterWrapper:(0,n.css)({padding:`${S.spacing(1)} 0`,display:"flex",flexWrap:"wrap",rowGap:`${S.spacing(1)}`,columnGap:`${S.spacing(.5)}`})}}function C({showIllustrations:S,transformations:O,onClick:j,data:B}){const N=(0,l.of)(b);return(0,t.jsx)("div",{className:N.grid,children:O.map(I=>{let K=s.M.Applicable;I.transformation.isApplicable!==void 0&&(K=I.transformation.isApplicable(B));const w=K>0;let U=null;I.transformation.isApplicableDescription!==void 0&&(typeof I.transformation.isApplicableDescription=="function"?U=I.transformation.isApplicableDescription(B):U=I.transformation.isApplicableDescription);let W=N.newCard;return w||(W=(0,n.cx)(N.newCard,N.cardDisabled)),(0,t.jsxs)(p.Z,{className:W,"data-testid":i.Tp.components.TransformTab.newTransform(I.name),onClick:()=>j(I.id),children:[(0,t.jsxs)(p.Z.Heading,{className:N.heading,children:[(0,t.jsx)("span",{children:I.name}),(0,t.jsx)("span",{className:N.pluginStateInfoWrapper,children:(0,t.jsx)(f.p,{state:I.state})})]}),(0,t.jsxs)(p.Z.Description,{className:N.description,children:[(0,t.jsx)("span",{children:R(I.id)}),S&&(0,t.jsx)("span",{children:(0,t.jsx)("img",{className:N.image,src:T(I.id,!w),alt:I.name})}),!w&&U!==null&&(0,t.jsx)(h.K,{className:N.cardApplicableInfo,name:"info-circle",tooltip:U})]})]},I.id)})})}function b(S){return{heading:(0,n.css)({fontWeight:400,"> button":{width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"nowrap"}}),description:(0,n.css)({fontSize:"12px",display:"flex",flexDirection:"column",justifyContent:"space-between"}),image:(0,n.css)({display:"block",maxEidth:"100%`",marginTop:`${S.spacing(2)}`}),grid:(0,n.css)({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gridAutoRows:"1fr",gap:`${S.spacing(2)} ${S.spacing(1)}`,width:"100%"}),cardDisabled:(0,n.css)({backgroundColor:"rgb(204, 204, 220, 0.045)",color:`${S.colors.text.disabled} !important`,img:{filter:"grayscale(100%)",opacity:.33}}),cardApplicableInfo:(0,n.css)({position:"absolute",bottom:`${S.spacing(1)}`,right:`${S.spacing(1)}`}),newCard:(0,n.css)({gridTemplateRows:"min-content 0 1fr 0"}),pluginStateInfoWrapper:(0,n.css)({marginLeft:"5px"})}}const T=(S,O)=>`public/img/transformations/${y.Ay.theme2.isDark?"dark":"light"}/${S}.svg`,A={[a.F.concatenate]:"Combine all fields into a single frame.",[a.F.configFromData]:"Set unit, min, max and more.",[a.F.fieldLookup]:"Use a field value to lookup countries, states, or airports.",[a.F.filterFieldsByName]:"Remove parts of the query results using a regex pattern.",[a.F.filterByRefId]:"Remove rows from the data based on origin query",[a.F.filterByValue]:"Remove rows from the query results using user-defined filters.",[a.F.groupBy]:"Group data by a field value and create aggregate data.",[a.F.groupingToMatrix]:"Summarize and reorganize data based on three fields.",[a.F.joinByField]:"Combine rows from 2+ tables, based on a related field.",[a.F.labelsToFields]:"Group series by time and return labels or tags as fields.",[a.F.merge]:"Merge multiple series. Values will be combined into one row.",[a.F.organize]:"Re-order, hide, or rename fields.",[a.F.partitionByValues]:"Split a one-frame dataset into multiple series.",[a.F.prepareTimeSeries]:"Stretch data frames from the wide format into the long format.",[a.F.reduce]:"Reduce all rows or data points to a single value (ex. max, mean).",[a.F.renameByRegex]:"Rename parts of the query results using a regular expression and replacement pattern.",[a.F.seriesToRows]:"Merge multiple series. Return time, metric and values as a row."},R=S=>A[S]||g.h.getIfExists(S)?.description||""},66879:(_,L,e)=>{"use strict";e.d(L,{o:()=>U,e:()=>K});var t=e(74848),n=e(91076),r=e(96540),s=e(97497),a=e(13544),g=e(14110),i=e(29158),l=e(55852),d=e(96374),o=e(19727),u=e(40276),c=e(66864),p=e(40845),h=e(2913),y=e(79280),f=e(39601),v=e(32696);function P({message:W}){const H=(0,r.useCallback)(()=>{f.Ny.partial({tab:v.M8.Query})},[]);return(0,t.jsx)(c.PE,{justify:"center",style:{marginTop:"100px"},children:(0,t.jsxs)(c.gW,{spacing:"md",children:[(0,t.jsx)("h2",{children:W}),(0,t.jsx)("div",{children:(0,t.jsx)(l.$n,{size:"md",variant:"secondary",icon:"arrow-left",onClick:H,children:"Go back to Queries"})})]})})}var m=e(57650),D=e(32196),x=e(87885),E=e(42418),C=e(10354),b=e(10860),T=e(61680);const A={[x.f.Transformations]:"https://grafana.com/docs/grafana/latest/panels/transformations",[x.f.FieldConfig]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/",[x.f.FieldConfigOverrides]:"https://grafana.com/docs/grafana/latest/panels/field-configuration-options/#override-a-field"},R=W=>A[W];var S=e(10803);const O="dashboard.components.TransformationEditor.featureInfoBox.isDismissed";function j(W){const{noTransforms:H,search:z,xforms:G,onSearchChange:M,onSearchKeyDown:Q,onTransformationAdd:Y,suffix:q}=W;return(0,t.jsxs)(c.gW,{children:[H&&(0,t.jsx)(c.mc,{grow:1,children:(0,t.jsx)(T.b,{storageKey:O,defaultValue:!1,children:(te,X)=>te?null:(0,t.jsxs)(E.F,{title:"Transformations",severity:"info",onRemove:()=>{X(!0)},children:[(0,t.jsxs)("p",{children:["Transformations allow you to join, calculate, re-order, hide, and rename your query results before they are visualized. ",(0,t.jsx)("br",{}),"Many transforms are not suitable if you're using the Graph visualization, as it currently only supports time series data. ",(0,t.jsx)("br",{}),"It can help to switch to the Table visualization to understand what a transformation is doing."," "]}),(0,t.jsx)("a",{href:R(x.f.Transformations),className:"external-link",target:"_blank",rel:"noreferrer",children:"Read more"})]})})}),(0,t.jsx)(C.p,{"data-testid":a.Tp.components.Transforms.searchInput,value:z??"",autoFocus:!H,placeholder:"Search for transformation",onChange:M,onKeyDown:Q,suffix:q}),G.map(te=>(0,t.jsx)(B,{transform:te,onClick:()=>{Y({value:te.id})}},te.name))]})}function B({transform:W,onClick:H}){const z=(0,p.of)(N);return(0,t.jsxs)(b.Z,{className:z.card,"data-testid":a.Tp.components.TransformTab.newTransform(W.name),onClick:H,children:[(0,t.jsx)(b.Z.Heading,{children:W.name}),(0,t.jsx)(b.Z.Description,{children:W.description}),W.state&&(0,t.jsx)(b.Z.Tags,{children:(0,t.jsx)(S.p,{state:W.state})})]})}function N(W){return{card:(0,D.css)({margin:"0",padding:`${W.spacing(1)}`})}}var I=e(21427);const K="viewAll";class w extends r.PureComponent{constructor(H){super(H),this.onSearchChange=M=>{this.setState({search:M.target.value})},this.onSearchKeyDown=M=>{if(M.key==="Enter"){const{search:Q}=this.state;if(Q){const Y=Q.toLowerCase(),q=s.h.list().filter(te=>(te.name+te.description).toLowerCase().indexOf(Y)>=0);q.length>0&&this.onTransformationAdd({value:q[0].id})}}else M.keyCode===27&&(this.setState({search:"",showPicker:!1}),M.stopPropagation())},this.getTransformationNextId=M=>{const{transformations:Q}=this.state;let Y=0;const q=Q.filter(te=>te.id.startsWith(M)).map(te=>te.id);return q.length!==0&&(Y=Math.max(...q.map(te=>parseInt(te.match(/\d+/)[0],10)))+1),`${M}-${Y}`},this.onTransformationAdd=M=>{let Q="panel_editor_tabs_transformations_management";h.Ay.featureToggles.transformationsRedesign&&(Q="transformations_redesign_"+Q),(0,g.rR)(Q,{action:"add",transformationId:M.value});const{transformations:Y}=this.state,q=this.getTransformationNextId(M.value);this.setState({search:"",showPicker:!1}),this.onChange([...Y,{id:q,transformation:{id:M.value,options:{}}}])},this.onTransformationChange=(M,Q)=>{const{transformations:Y}=this.state,q=Array.from(Y);let te="panel_editor_tabs_transformations_management";h.Ay.featureToggles.transformationsRedesign&&(te="transformations_redesign_"+te),(0,g.rR)(te,{action:"change",transformationId:q[M].transformation.id}),q[M].transformation=Q,this.onChange(q)},this.onTransformationRemove=M=>{const{transformations:Q}=this.state,Y=Array.from(Q);let q="panel_editor_tabs_transformations_management";h.Ay.featureToggles.transformationsRedesign&&(q="transformations_redesign_"+q),(0,g.rR)(q,{action:"remove",transformationId:Y[M].transformation.id}),Y.splice(M,1),this.onChange(Y)},this.onTransformationRemoveAll=()=>{this.onChange([]),this.setState({showRemoveAllModal:!1})},this.onDragEnd=M=>{const{transformations:Q}=this.state;if(!M||!M.destination)return;const Y=M.source.index,q=M.destination.index;if(Y===q)return;const te=Array.from(Q),[X]=te.splice(Y,1);te.splice(q,0,X),this.onChange(te)},this.renderEmptyMessage=()=>(0,t.jsx)(y.p,{onShowPicker:()=>{this.setState({showPicker:!0})}}),this.renderTransformationEditors=()=>{const{data:M,transformations:Q}=this.state;return(0,t.jsx)(n.JY,{onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:Y=>(0,t.jsxs)("div",{ref:Y.innerRef,...Y.droppableProps,children:[(0,t.jsx)(m.A,{configs:Q,data:M,onRemove:this.onTransformationRemove,onChange:this.onTransformationChange}),Y.placeholder]})})})};const z=H.panel.transformations||[],G=this.buildTransformationIds(z);this.state={transformations:z.map((M,Q)=>({transformation:M,id:G[Q]})),data:{series:[]},search:"",selectedFilter:K,showIllustrations:!0}}buildTransformationIds(H){const z={},G=[];for(let M=0;M<H.length;M++){const Q=H[M];z[Q.id]===void 0?z[Q.id]=0:z[Q.id]+=1,G.push(`${H[M].id}-${z[H[M].id]}`)}return G}componentDidMount(){this.subscription=this.props.panel.getQueryRunner().getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:H=>this.setState({data:H})})}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}componentDidUpdate(H,z){if(h.Ay.featureToggles.transformationsRedesign){const M=!(z.transformations.length>0)||z.showPicker,Y=!(this.state.transformations.length>0)||this.state.showPicker;if(M!==Y){const q=Math.random()/2;this.setState({scrollTop:Y?q:Number.MAX_SAFE_INTEGER})}}}onChange(H){this.setState({transformations:H}),this.props.panel.setTransformations(H.map(z=>z.transformation))}renderTransformsPicker(){let{showPicker:H}=this.state;const{transformations:z,search:G}=this.state,{transformationsRedesign:M}=h.Ay.featureToggles,Q=!z?.length,Y=z.length>0;let q=null,te=s.h.list().sort((Z,ae)=>Z.name>ae.name?1:ae.name>Z.name?-1:0);if(!M&&Q&&(H=!0),this.state.selectedFilter!==K&&(te=te.filter(Z=>Z.categories&&this.state.selectedFilter&&Z.categories.has(this.state.selectedFilter))),G){const Z=G.toLowerCase(),ae=te.filter(re=>(re.name+re.description).toLowerCase().indexOf(Z)>=0);q=(0,t.jsxs)(t.Fragment,{children:[ae.length," / ",te.length," \xA0\xA0",(0,t.jsx)(i.K,{name:"times",onClick:()=>{this.setState({search:""})},tooltip:"Clear search"})]}),te=ae}!q&&H&&!Q&&(q=(0,t.jsx)(i.K,{name:"times",onClick:()=>{this.setState({showPicker:!1})},tooltip:"Close picker"}));let X=null,ee=null;M?(X=(0,t.jsx)(I.R,{noTransforms:Q,search:G,suffix:q,xforms:te,onClose:()=>this.setState({showPicker:!1}),onSelectedFilterChange:Z=>this.setState({selectedFilter:Z}),onShowIllustrationsChange:Z=>this.setState({showIllustrations:Z}),onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd,data:this.state.data.series,selectedFilter:this.state.selectedFilter,showIllustrations:this.state.showIllustrations}),ee=(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.$n,{icon:"times",variant:"secondary",onClick:()=>this.setState({showRemoveAllModal:!0}),style:{marginLeft:this.props.theme.spacing.md},children:"Delete all transformations"}),(0,t.jsx)(d.u,{isOpen:!!this.state.showRemoveAllModal,title:"Delete all transformations?",body:"By deleting all transformations, you will go back to the main selection screen.",confirmText:"Delete all",onConfirm:()=>this.onTransformationRemoveAll(),onDismiss:()=>this.setState({showRemoveAllModal:!1})})]})):X=(0,t.jsx)(j,{noTransforms:Q,search:G,suffix:q,xforms:te,onSearchChange:this.onSearchChange,onSearchKeyDown:this.onSearchKeyDown,onTransformationAdd:this.onTransformationAdd});const ne=(0,t.jsxs)(o.e,{children:[(0,t.jsx)(l.$n,{icon:"plus",variant:"secondary",onClick:()=>{this.setState({showPicker:!0})},"data-testid":a.Tp.components.Transforms.addTransformationButton,children:"Add another transformation"}),ee]});return(0,t.jsxs)(t.Fragment,{children:[H&&X,M&&Y&&ne||!M&&!H&&Y&&ne]})}render(){const{panel:{alert:H}}=this.props,{transformations:z}=this.state,G=z.length>0;if(H){const M=G?"Transformations can't be used on a panel with alerts":"Transformations can't be used on a panel with existing alerts";return(0,t.jsx)(P,{message:M})}return(0,t.jsx)(u.E,{scrollTop:this.state.scrollTop,autoHeightMin:"100%",children:(0,t.jsx)(c.mc,{padding:"lg",children:(0,t.jsxs)("div",{"data-testid":a.Tp.components.TransformTab.content,children:[!G&&h.Ay.featureToggles.transformationsRedesign&&this.renderEmptyMessage(),G&&this.renderTransformationEditors(),this.renderTransformsPicker()]})})})}}const U=(0,p.SL)(w)},68064:(_,L,e)=>{"use strict";e.d(L,{A:()=>m});var t=e(74848),n=e(32196),r=e(13544),s=e(39601),a=e(32264),g=e(40845),i=e(67061),l=e(90613),d=e(94753),o=e(55852),u=e(8484),c=e(36974),p=e(34865),h=e(55600),y=e(7758),f=e(31678),v=e(28601);const m=({dashboard:x,canCreate:E})=>{const C=(0,g.of)(D),b=(0,f.useDispatch)(),T=(0,f.useSelector)(S=>S.dashboard.initialDatasource),A=()=>{let S;if(x instanceof h.H$){const O=x.onCreateNewPanel();x.setState({editPanel:(0,p.L)(O,!0)}),s.Ny.partial({firstPanel:!0})}else S=(0,c.OK)(x,T),b((0,v.Ub)(void 0)),s.Ny.partial({editPanel:S,firstPanel:!0});y.c.emptyDashboardButtonClicked({item:"add_visualization"})},R=()=>{y.c.emptyDashboardButtonClicked({item:"import_from_library"}),x instanceof h.H$?x.onShowAddLibraryPanelDrawer():(0,c.s3)(x)};return(0,t.jsx)(i.B,{alignItems:"center",justifyContent:"center",children:(0,t.jsx)("div",{className:C.wrapper,children:(0,t.jsxs)(i.B,{alignItems:"stretch",justifyContent:"center",gap:4,direction:"column",children:[(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:4,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:2,children:[(0,t.jsx)(d.E,{element:"h1",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-header",children:"Start your new dashboard by adding a visualization"})}),(0,t.jsx)(l.a,{marginBottom:2,paddingX:4,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-body",children:"Select a data source and then query and visualize your data with charts, stats and tables or create lists, markdowns and other widgets."})})}),(0,t.jsx)(o.$n,{size:"lg",icon:"plus","data-testid":r.Tp.pages.AddDashboard.itemButton("Create new panel button"),onClick:A,disabled:!E,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-visualization-button",children:"Add visualization"})})]})}),(0,t.jsxs)(i.B,{direction:{xs:"column",md:"row"},wrap:"wrap",gap:4,children:[a.$.featureToggles.vizAndWidgetSplit&&(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-widget-header",children:"Add a widget"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-widget-body",children:"Create lists, markdowns and other widgets"})})}),(0,t.jsx)(o.$n,{icon:"plus",fill:"outline","data-testid":r.Tp.pages.AddDashboard.itemButton("Create new widget button"),onClick:()=>{y.c.emptyDashboardButtonClicked({item:"add_widget"}),s.Ny.partial({addWidget:!0})},disabled:!E,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-widget-button",children:"Add widget"})})]})}),(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-header",children:"Import panel"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-body",children:"Add visualizations that are shared with other dashboards."})})}),(0,t.jsx)(o.$n,{icon:"plus",fill:"outline","data-testid":r.Tp.pages.AddDashboard.itemButton("Add a panel from the panel library button"),onClick:R,disabled:!E,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.add-library-panel-button",children:"Add library panel"})})]})}),(0,t.jsx)(l.a,{borderColor:"strong",borderStyle:"dashed",padding:3,flex:1,children:(0,t.jsxs)(i.B,{direction:"column",alignItems:"center",gap:1,children:[(0,t.jsx)(d.E,{element:"h3",textAlignment:"center",weight:"medium",children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.import-a-dashboard-header",children:"Import a dashboard"})}),(0,t.jsx)(l.a,{marginBottom:2,children:(0,t.jsx)(d.E,{element:"p",textAlignment:"center",color:"secondary",children:(0,t.jsxs)(u.x6,{i18nKey:"dashboard.empty.import-a-dashboard-body",children:["Import dashboards from files or ",(0,t.jsx)("a",{href:"https://grafana.com/grafana/dashboards/",children:"grafana.com"}),"."]})})}),(0,t.jsx)(o.$n,{icon:"upload",fill:"outline","data-testid":r.Tp.pages.AddDashboard.itemButton("Import dashboard button"),onClick:()=>{y.c.emptyDashboardButtonClicked({item:"import_dashboard"}),(0,c.VF)()},disabled:!E,children:(0,t.jsx)(u.x6,{i18nKey:"dashboard.empty.import-dashboard-button",children:"Import dashboard"})})]})})]})]})})})};function D(x){return{wrapper:(0,n.css)({label:"dashboard-empty-wrapper",flexDirection:"column",maxWidth:"890px",gap:x.spacing.gridSize*4,paddingTop:x.spacing(2),[x.breakpoints.up("sm")]:{paddingTop:x.spacing(12)}})}}},2038:(_,L,e)=>{"use strict";e.d(L,{Z:()=>c});var t=e(74848),n=e(96540),r=e(39601),s=e(32196),a=e(40845),g=e(27746),i=e(14578),l=e(56034),d=e(16797);const o=({notice:p,onClick:h})=>{const y=(0,a.of)(u),f=p.severity==="error"||p.severity==="warning"?"exclamation-triangle":"file-landscape-alt";return p.inspect&&h?(0,t.jsx)(g.I,{className:y.notice,icon:f,iconSize:"md",tooltip:p.text,onClick:v=>h(v,p.inspect)},p.severity):p.link?(0,t.jsx)("a",{className:y.notice,"aria-label":p.text,href:p.link,target:"_blank",rel:"noreferrer",children:(0,t.jsx)(i.I,{name:f,style:{marginRight:"8px"},size:"md"})}):(0,t.jsx)(l.m,{content:p.text,children:(0,t.jsx)("span",{className:y.iconTooltip,children:(0,t.jsx)(i.I,{name:f,size:"md"})})},p.severity)},u=p=>({notice:(0,s.css)({background:"inherit",border:"none",borderRadius:p.shape.radius.default}),iconTooltip:(0,s.css)({color:`${p.colors.text.secondary}`,backgroundColor:"inherit",cursor:"auto",border:"none",borderRadius:`${p.shape.radius.default}`,padding:`${p.spacing(0,1)}`,height:` ${p.spacing(p.components.height.md)}`,display:"flex",alignItems:"center",justifyContent:"center","&:focus, &:focus-visible":{...(0,d.getFocusStyles)(p),zIndex:1},"&: focus:not(:focus-visible)":(0,d.getMouseFocusStyles)(p),"&:hover ":{boxShadow:`${p.shadows.z1}`,color:`${p.colors.text.primary}`,background:`${p.colors.background.secondary}`}})}),c=({frames:p,panelId:h})=>{const y=(0,n.useCallback)((v,P)=>{v.stopPropagation(),r.Ny.partial({inspect:h,inspectTab:P})},[h]),f={};for(const v of p)if(!(!v.meta||!v.meta.notices))for(const P of v.meta.notices)f[P.severity]=P;return(0,t.jsx)(t.Fragment,{children:Object.values(f).map(v=>(0,t.jsx)(o,{notice:v,onClick:y},v.severity))})}},91126:(_,L,e)=>{"use strict";e.d(L,{M:()=>o});var t=e(37055),n=e(58972),r=e(1173),s=e(11261),a=e(28240),g=e(85200),i=e(88895);const l="hideSeriesFrom",d=(0,t.ZW)(l);function o(v,P,m,D){const{overrides:x}=m,E=v,C=x.findIndex(d);if(C<0){if(P===i.B.ToggleSelection){const O=u([E,...f(x,D)]);return{...m,overrides:[...m.overrides,O]}}const R=y(D,E),S=u(R);return{...m,overrides:[...m.overrides,S]}}const b=Array.from(x),[T]=b.splice(C,1);if(P===i.B.ToggleSelection){let R=p(T);const S=f(b,D);if(S.length>0&&(R=R.filter(j=>S.indexOf(j)<0)),R[0]===E&&R.length===1)return{...m,overrides:b};const O=u([E,...S]);return{...m,overrides:[...b,O]}}const A=c(T,E);return h(A,D)?{...m,overrides:b}:{...m,overrides:[...b,A]}}function u(v,P=n.PP.exclude,m){return m=m??{id:"custom.hideFrom",value:{viz:!0,legend:!1,tooltip:!1}},{__systemRef:l,matcher:{id:r.Ct.byNames,options:{mode:P,names:v,prefix:P===n.PP.exclude?"All except:":void 0,readOnly:!0}},properties:[{...m,value:{viz:!0,legend:!1,tooltip:!1}}]}}const c=(v,P,m=n.PP.exclude)=>{const D=v.properties.find(C=>C.id==="custom.hideFrom"),x=p(v),E=x.findIndex(C=>C===P);return E<0?x.push(P):x.splice(E,1),u(x,m,D)},p=v=>{const P=v.matcher.options?.names;return Array.isArray(P)?[...P]:[]},h=(v,P)=>p(v).length===y(P).length,y=(v,P)=>{const m=new Set;for(const D of v)for(const x of D.fields){if(x.type!==s.PU.number)continue;const E=(0,a.Ct)(x,D,v);E!==P&&m.add(E)}return Array.from(m)},f=(v,P)=>{let m=[];for(const D of v){const x=D.properties.find(E=>E.id==="custom.hideFrom");if(x!==void 0&&x.value?.legend===!0){const C=g.sJ.get(D.matcher.id).get(D.matcher.options);for(const b of P)for(const T of b.fields){if(T.type!==s.PU.number)continue;const A=(0,a.Ct)(T,b,P);C(T,b,P)&&m.push(A)}}}return m}},61582:(_,L,e)=>{"use strict";e.d(L,{a:()=>l});var t=e(49426),n=e(47232),r=e(85858);const s=100;class a{constructor(){this.listeners=[],this.budget=1,this.threshold=1.5,this.ok=new t.t(!0),this.lastUpdate=Date.now(),this.isLive=!1,this.liveTimeOffset=0,this.measure=()=>{const o=Date.now();this.budget=(o-this.lastUpdate)/s;const u=this.ok.getValue(),c=this.budget<=this.threshold;if(u!==c&&this.ok.next(c),this.lastUpdate=o,this.isLive&&this.ok.getValue()&&this.timeRange){let p;for(const h of this.listeners){if(!h.panel.props.isInView)continue;if(o-h.last>=h.intervalMs){if(!p){const{raw:f}=this.timeRange;p={raw:f,from:(0,n.KQ)(o-this.liveTimeOffset),to:(0,n.KQ)(o)}}h.panel.liveTimeChanged(p),h.last=o}}}}}setLiveTimeRange(o){if(this.timeRange=o,this.isLive=o?.raw?.to==="now",this.isLive){const u=r.parse(o.raw.from,!1)?.valueOf(),c=r.parse(o.raw.to,!0)?.valueOf();this.liveTimeOffset=c-u;for(const p of this.listeners)p.intervalMs=i(this.liveTimeOffset,p.panel.props.width)}}listen(o){this.listeners.push({last:this.lastUpdate,panel:o,intervalMs:i(6e4,o.props.width)})}remove(o){this.listeners=this.listeners.filter(u=>u.panel!==o)}updateInterval(o){if(!(!this.timeRange||!this.isLive)){for(const u of this.listeners)if(u.panel===o){u.intervalMs=i(this.liveTimeOffset,u.panel.props.width);return}}}}const g=5*60*1e3;function i(d,o){const u=Math.ceil(d/o/100)*100;return u>g?g:u}const l=new a;setInterval(l.measure,s)},17493:(_,L,e)=>{"use strict";e.d(L,{Fu:()=>D,np:()=>x});var t=e(34796),n=e.n(t),r=e(2543),s=e.n(r),a=e(95093),g=e.n(a),i=e(26272),l=e(85858),d=e(17172),o=e(39601),u=e(27677),c=e(62301),p=e(68576),h=e(72255),y=e(31193),f=e(10096),v=e(28676),P=e(14792),m=e(69064);class D{constructor(){}_dashboardLoadFailed(b,T){return T=T||!1,{meta:{canStar:!1,isSnapshot:T,canDelete:!1,canSave:!1,canEdit:!1,canShare:!1,dashboardNotFound:!0},dashboard:{title:b,uid:b,schemaVersion:0}}}loadDashboard(b,T,A){const R=(0,h.sP)();let S;if(b==="script"&&T)S=this._loadScriptedDashboard(T);else if(b==="snapshot"&&T)S=(0,m.s)().getSnapshot(T).catch(()=>this._dashboardLoadFailed("Snapshot not found",!0));else if(b==="ds"&&T)S=this._loadFromDatasource(T);else if(b==="public"&&A)S=u.IB.getPublicDashboardByUid(A).then(O=>O).catch(O=>{const j=O.data.statusCode===403&&O.data.messageId==="publicdashboards.notEnabled",B=O.data.statusCode===404&&O.data.messageId==="publicdashboards.notFound",N=O.data.statusCode===404&&O.data.messageId==="publicdashboards.dashboardNotFound",I=this._dashboardLoadFailed(j?"Public Dashboard paused":"Public Dashboard Not found",!0);return{...I,meta:{...I.meta,publicDashboardEnabled:B?void 0:!j,dashboardNotFound:B||N}}});else if(A){const O=R.getDashboardFromCache(A);if(O)return Promise.resolve(O);S=(0,v.n)().getDashboardDTO(A).then(j=>{if(j.meta.isFolder)throw f.lE.emit(i.r1.alertError,["Dashboard not found"]),new Error("Dashboard not found");return j}).catch(()=>{const j=this._dashboardLoadFailed("Not found",!0);return j.dashboard.uid=A,j})}else throw new Error("Dashboard uid or slug required");return S.then(O=>(O.meta.dashboardNotFound!==!0&&c.A.addDashboardImpression(O.dashboard.uid),O)),S}_loadScriptedDashboard(b){const T="public/dashboards/"+b.replace(/\.(?!js)/,"/")+"?"+new Date().getTime();return(0,d.AI)().get(T).then(this._executeScript.bind(this)).then(A=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:A.data}),A=>(console.error("Script dashboard error "+A),f.lE.emit(i.r1.alertError,["Script Error","Please make sure it exists and returns a valid dashboard"]),this._dashboardLoadFailed("Scripted dashboard")))}async _loadFromDatasource(b){const T=await(0,y.tR)().get(b);if(!T)return Promise.reject("can not find datasource: "+b);const A=new URLSearchParams(window.location.search),R=A.get("path");if(!R)return Promise.reject("expecting path parameter");const S={};return A.forEach((O,j)=>{S[j]=O}),(0,d.AI)().get(`/api/datasources/uid/${T.uid}/resources/${R}`,S).then(O=>({meta:{fromScript:!0,canDelete:!1,canSave:!1,canStar:!1},dashboard:O}))}_executeScript(b){const T={dashboardSrv:(0,P.UA)(),datasourceSrv:(0,y.tR)()},R=new Function("ARGS","kbn","dateMath","_","moment","window","document","$","jQuery","services",b)(o.Ny.getSearchObject(),p.A,l,s(),g(),window,document,n(),n(),T);return(0,r.isFunction)(R)?new Promise(S=>{R(O=>{S({data:O})})}):{data:R}}}let x=new D;const E=C=>{throw new Error("dashboardLoaderSrv can be only overriden in test environment")}},14792:(_,L,e)=>{"use strict";e.d(L,{UA:()=>c});var t=e(26272),n=e(28138),r=e(8484),s=e(27677),a=e(28676),g=e(28444),i=e(98365),l=e(19752);class d{constructor(){this.onRemovePanel=h=>{const y=this.getCurrent();y&&(0,l.FC)(y,y.getPanelById(h),!0)},n.l.subscribe(g.Vz,h=>this.onRemovePanel(h.payload))}create(h,y){return new i.G(h,y)}setCurrent(h){this.dashboard=h}getCurrent(){return this.dashboard}saveJSONDashboard(h){const y=JSON.parse(h);return(0,a.n)().saveDashboard({dashboard:y,folderUid:this.dashboard?.meta.folderUid||y.folderUid})}saveDashboard(h,y){return(0,a.n)().saveDashboard({message:h.message,folderUid:h.folderUid,dashboard:h.dashboard.getSaveModelClone(),showErrorAlert:y?.showErrorAlert})}starDashboard(h,y){const f=(0,s.AI)(),v={showSuccessAlert:!1,url:"/api/user/stars/dashboard/uid/"+h,method:y?"DELETE":"POST"};return f.request(v).then(()=>{const P=!y;this.dashboard?.uid===h&&(this.dashboard.meta.isStarred=P);const m=P?(0,r.t)("notifications.starred-dashboard","Dashboard starred"):(0,r.t)("notifications.unstarred-dashboard","Dashboard unstarred");return n.l.emit(t.r1.alertSuccess,[m]),P})}}let o;function u(p){o=p}function c(){return o||(o=new d),o}},69064:(_,L,e)=>{"use strict";e.d(L,{s:()=>l});var t=e(75505),n=e(81160),r=e(17172),s=e(32264),a=e(10096);const g={create:d=>(0,r.AI)().post("/api/snapshots",d),getSnapshots:()=>(0,r.AI)().get("/api/dashboard/snapshots"),getSharingOptions:()=>(0,r.AI)().get("/api/snapshot/shared-options"),deleteSnapshot:d=>(0,r.AI)().delete("/api/snapshots/"+d),getSnapshot:async d=>{const o=await(0,r.AI)().get("/api/snapshots/"+d);return o.meta.canShare=!1,o}};class i{constructor(){this.apiVersion="dashboardsnapshot.grafana.app/v0alpha1",this.url=`/apis/${this.apiVersion}/namespaces/${s.$.namespace}/dashboardsnapshots`}async create(o){return(0,r.AI)().post(this.url+"/create",o)}async getSnapshots(){return(await(0,r.AI)().get(this.url)).items.map(u=>({key:u.metadata.name,name:u.spec.title,external:u.spec.externalUrl!=null,externalUrl:u.spec.externalUrl}))}deleteSnapshot(o){return(0,r.AI)().delete(this.url+"/"+o)}async getSharingOptions(){return(0,r.AI)().get("/api/snapshot/shared-options")}async getSnapshot(o){const u={};if(!a.TP.isSignedIn){alert("TODO... need a barer token for anonymous use case");const c=`??? TODO, get anon token for snapshots (${a.TP.user?.name}) ???`;u.Authorization=`Bearer ${c}`}return(0,t.s)((0,r.AI)().fetch({url:this.url+"/"+o+"/body",method:"GET",headers:u}).pipe((0,n.T)(c=>({dashboard:c.data.dashboard,meta:{isSnapshot:!0,canSave:!1,canEdit:!1,canAdmin:!1,canStar:!1,canShare:!1,canDelete:!1,isFolder:!1,provisioned:!1}}))))}}function l(){return s.$.featureToggles.kubernetesSnapshots?new i:g}},74856:(_,L,e)=>{"use strict";e.d(L,{jG:()=>x});var t=e(2543),n=e(47232),r=e(43127),s=e(65879),a=e(26272),g=e(85858),i=e(39601),l=e(81887),d=e(76412),o=e(28138),u=e(2913),c=e(16233),p=e(80582),h=e(21380),y=e(28444),f=e(11134);function v({urlRefresh:E,currentRefresh:C,isAllowedIntervalFn:b,minRefreshInterval:T,refreshIntervals:A=f.cb}){if(!E)return C;const R=b(E),S=A.find(O=>O===E);if(!R||!S){const O=T?A.find(B=>B===T):void 0,j=A?.length?A[0]:void 0;return O??j??C}return E||C}class P{constructor(C){this.contextSrv=C,this.timeRangeForUrl=()=>{const b=this.timeRange().raw;return(0,n.Ar)(b.from)&&(b.from=b.from.valueOf().toString()),(0,n.Ar)(b.to)&&(b.to=b.to.valueOf().toString()),b},this.time=(0,r.E2)().raw,this.timeAtLoad=(0,r.E2)().raw,this.refreshTimeModel=this.refreshTimeModel.bind(this),o.A.subscribe(y.U0,b=>{this.zoomOut(b.payload.scale,b.payload.updateUrl)}),o.A.subscribe(y.Io,b=>{this.shiftTime(b.payload.direction,b.payload.updateUrl)}),o.A.subscribe(y.Rh,b=>{this.makeAbsoluteTime(b.payload.updateUrl)}),o.A.subscribe(y.Bt,()=>{this.copyTimeRangeToClipboard()}),o.A.subscribe(y.VZ,b=>{this.pasteTimeRangeFromClipboard(b.payload.updateUrl)}),document.addEventListener("visibilitychange",()=>{this.autoRefreshBlocked&&document.visibilityState==="visible"&&(this.autoRefreshBlocked=!1,this.refreshTimeModel())})}init(C){this.timeModel=C,this.time=C.time,this.refresh=C.refresh,this.initTimeFromUrl(),this.parseTime(),this.timeAtLoad=(0,t.cloneDeep)(this.time),this.refresh&&this.setAutoRefresh(this.refresh)}getValidIntervals(C){return this.contextSrv.getValidIntervals(C)}parseTime(){(0,t.isString)(this.time.from)&&this.time.from.indexOf("Z")>=0&&(this.time.from=(0,n.KQ)(this.time.from).utc()),(0,t.isString)(this.time.to)&&this.time.to.indexOf("Z")>=0&&(this.time.to=(0,n.KQ)(this.time.to).utc())}parseUrlParam(C,b){if(C.indexOf("now")!==-1)return C;if(C.length===8){const T=(0,n.yT)(C,"YYYYMMDD");if(T.isValid())return T}else if(C.length===15){const T=(0,n.yT)(C,"YYYYMMDDTHHmmss");if(T.isValid())return T}if(!isNaN(Number(C))){const T=parseInt(C,10);return b?(0,n.oZ)(b,T):(0,n.yT)(T)}return null}getTimeWindow(C,b){const T=parseInt(C,10);let A;return b.match(/^\d+$/)&&parseInt(b,10)?A=parseInt(b,10):A=s.intervalToMs(b),{from:(0,n.yT)(T-A/2),to:(0,n.yT)(T+A/2)}}initTimeFromUrl(){if(u.$W.publicDashboardAccessToken&&this.timeModel?.timepicker?.hidden)return;const C=i.Ny.getSearch();C.get("time")&&C.get("time.window")&&(this.time=this.getTimeWindow(C.get("time"),C.get("time.window")));const b=this.timeModel?.getTimezone();C.get("from")&&(this.time.from=this.parseUrlParam(C.get("from"),b)||this.time.from),C.get("to")&&(this.time.to=this.parseUrlParam(C.get("to"),b)||this.time.to),C.get("to")&&C.get("to").indexOf("now")===-1&&(this.refresh=!1,this.timeModel&&(this.timeModel.refresh=void 0)),this.refresh=v({urlRefresh:C.get("refresh"),currentRefresh:this.refresh,refreshIntervals:Array.isArray(this.timeModel?.timepicker?.refresh_intervals)?this.timeModel?.timepicker?.refresh_intervals:void 0,isAllowedIntervalFn:this.contextSrv.isAllowedInterval,minRefreshInterval:u.$W.minRefreshInterval})}updateTimeRangeFromUrl(){const C=i.Ny.getSearch();if(C.get("left"))return;const b=this.timeRangeForUrl(),T=C.get("from"),A=C.get("to");T&&A?(T!==b.from||A!==b.to)&&(this.initTimeFromUrl(),this.setTime(this.time,!1)):this.timeHasChangedSinceLoad()&&this.setTime(this.timeAtLoad,!0)}timeHasChangedSinceLoad(){return this.timeAtLoad&&(this.timeAtLoad.from!==this.time.from||this.timeAtLoad.to!==this.time.to)}setAutoRefresh(C){this.timeModel&&(this.timeModel.refresh=C),this.stopAutoRefresh();const b=i.Ny.getSearchObject();if(!C){b.refresh&&i.Ny.partial({refresh:null},!0);return}let T=C,A=60*1e3;C===c.SM?A=this.getAutoRefreshInteval().intervalMs:(T=this.contextSrv.getValidInterval(C),A=s.intervalToMs(T)),this.refreshMS=A,this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(A),this.refreshTimeModel()},A),b.refresh!==T&&i.Ny.partial({refresh:T},!0)}getAutoRefreshInteval(){const C=window?.innerWidth??2e3;return s.calculateInterval(this.timeRange(),C,u.$W.minRefreshInterval)}refreshTimeModel(){this.timeModel?.timeRangeUpdated(this.timeRange())}startNextRefreshTimer(C){this.refreshTimer=window.setTimeout(()=>{this.startNextRefreshTimer(C),this.contextSrv.isGrafanaVisible()?this.refreshTimeModel():this.autoRefreshBlocked=!0},C)}stopAutoRefresh(){clearTimeout(this.refreshTimer),this.refreshTimer=void 0,this.refreshMS=void 0}resumeAutoRefresh(){this.timeModel?.refresh&&this.setAutoRefresh(this.timeModel.refresh)}setTime(C,b=!0){if((0,t.extend)(this.time,C),(0,n.Ar)(C.to)?(this.oldRefresh=this.timeModel?.refresh||this.oldRefresh,this.setAutoRefresh("")):this.oldRefresh&&this.oldRefresh!==this.timeModel?.refresh&&(this.setAutoRefresh(this.oldRefresh),this.oldRefresh=void 0),b===!0){const T=this.timeRangeForUrl(),A=i.Ny.getSearchObject();if(A.from===T.from.toString()&&A.to===T.to.toString())return;A.from=T.from.toString(),A.to=T.to.toString(),i.Ny.partial(A)}this.timeModel?.refresh===c.SM&&this.getAutoRefreshInteval().intervalMs!==this.refreshMS&&this.setAutoRefresh(c.SM),this.refreshTimeModel()}timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?l.jh.getTimeRange(window.__grafanaSceneContext).state.value:(0,h.z)(this.time,this.timeModel)}zoomOut(C,b=!0){const T=this.timeRange(),{from:A,to:R}=(0,p.Zk)(T,C);this.setTime({from:(0,n.yT)(A),to:(0,n.yT)(R)},b)}shiftTime(C,b=!0){const T=this.timeRange(),{from:A,to:R}=(0,p.Wb)(C,T);this.setTime({from:(0,n.yT)(A),to:(0,n.yT)(R)},b)}makeAbsoluteTime(C){const{from:b,to:T}=this.timeRange();this.setTime({from:b,to:T},C)}copyTimeRangeToClipboard(){const{raw:C}=this.timeRange();navigator.clipboard.writeText(JSON.stringify({from:C.from,to:C.to})),o.A.emit(a.r1.alertSuccess,[(0,d.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}async pasteTimeRangeFromClipboard(C=!0){const{range:b,isError:T}=await(0,p.zG)();if(T===!0){o.A.emit(a.r1.alertError,[(0,d.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,d.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:b})]);return}const{from:A,to:R}=b;this.setTime({from:A,to:R},C)}isRefreshOutsideThreshold(C,b=.05){const T=this.timeRange();if(g.isMathString(T.raw.from)){const A=T.to.diff(T.from),R=Date.now()-C,S=A*b;return R>=S}return!1}}let m;function D(E){m=E}function x(){return m||(m=new P(c.TP)),m}},79056:(_,L,e)=>{"use strict";e.d(L,{O2:()=>K,SW:()=>w,og:()=>M});var t=e(2543),n=e(69550),r=e(92041),s=e(12470),a=e(22391),g=e(76885),i=e(6709),l=e(25019),d=e(47737),o=e(1173),u=e(11261),c=e(6829),p=e(58140),h=e(19347),y=e(52622),f=e(57021),v=e(79648),P=e(2913),m=e(15054);function D(Z){return Array.from(new Array(Z+1),(ae,re)=>re).filter(ae=>Z%ae===0)}var x=e(68576),E=e(31193),C=e(24240),b=e(86886),T=e(14678),A=e(14738),R=e(36373),S=e(77789),O=e(25640);function j(Z,ae){const re=[];if(Z?.statistics&&Z?.statistics.length){Z.statistic=Z.statistics[0];for(const se of Z.statistics.splice(1))re.push({...Z,statistic:se})}for(const se of re)se.refId=(0,S.M)(ae),delete se.statistics,ae.push(se);return delete Z.statistics,re}function B(Z){const ae=[];if(Z&&"statistics"in Z&&Z?.statistics?.length){for(const re of Z.statistics.splice(1)){const{statistics:se,name:de,...le}=Z;ae.push({...le,statistic:re,name:`${de} - ${re}`})}Z.statistic=Z.statistics[0],ae.length!==0&&(Z.name=`${Z.name} - ${Z.statistic}`),delete Z.statistics}return ae}function N(Z){Z.hasOwnProperty("metricQueryType")||(Z.metricQueryType=O.d$.Search),Z.hasOwnProperty("metricEditorMode")||(Z.metricQueryType===O.d$.Insights?Z.metricEditorMode=O.Rx.Code:Z.metricEditorMode=Z.expression?O.Rx.Code:O.Rx.Builder)}var I=e(84423);n.D.setInit(v.H),n.G.setInit(v.u);const K=40;class w{constructor(ae){this.dashboard=ae,(0,h.l)()||(0,h.h)(new E.xq)}updateSchema(ae){let re,se,de,le;const he=this.dashboard.schemaVersion,ie=[];if(this.dashboard.schemaVersion=K,he!==this.dashboard.schemaVersion){if(he<2&&(ae.services&&ae.services.filter&&(this.dashboard.time=ae.services.filter.time,this.dashboard.templating.list=ae.services.filter.list||[]),ie.push(J=>(J.type==="graphite"&&(J.type="graph"),J.type!=="graph"||((0,t.isBoolean)(J.legend)&&(J.legend={show:J.legend}),J.grid&&(J.grid.min&&(J.grid.leftMin=J.grid.min,delete J.grid.min),J.grid.max&&(J.grid.leftMax=J.grid.max,delete J.grid.max)),J.y_format&&(J.y_formats||(J.y_formats=[]),J.y_formats[0]=J.y_format,delete J.y_format),J.y2_format&&(J.y_formats||(J.y_formats=[]),J.y_formats[1]=J.y2_format,delete J.y2_format)),J))),he<3){let J=this.dashboard.getNextPanelId();ie.push(ce=>(ce.id||(ce.id=J,J+=1),ce))}if(he<4&&ie.push(J=>(J.type!=="graph"||((0,t.each)(J.aliasYAxis,(ce,pe)=>{J.seriesOverrides=[{alias:pe,yaxis:ce}]}),delete J.aliasYAxis),J)),he<6){const J=(0,t.find)(ae.pulldowns,{type:"annotations"});for(J&&(this.dashboard.annotations={list:J.annotations||[]}),re=0;re<this.dashboard.templating.list.length;re++){const ce=this.dashboard.templating.list[re];ce.datasource===void 0&&(ce.datasource=null),ce.type==="filter"&&(ce.type="query"),ce.type===void 0&&(ce.type="query"),ce.allFormat===void 0&&delete ce.allFormat}}if(he<7&&(ae.nav&&ae.nav.length&&(this.dashboard.timepicker=ae.nav[0]),ie.push(J=>((0,t.each)(J.targets,ce=>{ce.refId||(ce.refId=J.getNextQueryLetter&&J.getNextQueryLetter())}),J))),he<8&&ie.push(J=>((0,t.each)(J.targets,ce=>{ce.fields&&ce.tags&&ce.groupBy&&(ce.rawQuery?(delete ce.fields,delete ce.fill):(ce.select=(0,t.map)(ce.fields,pe=>{const Pe=[];return Pe.push({type:"field",params:[pe.name]}),Pe.push({type:pe.func,params:[]}),pe.mathExpr&&Pe.push({type:"math",params:[pe.mathExpr]}),pe.asExpr&&Pe.push({type:"alias",params:[pe.asExpr]}),Pe}),delete ce.fields,(0,t.each)(ce.groupBy,pe=>{pe.type==="time"&&pe.interval&&(pe.params=[pe.interval],delete pe.interval),pe.type==="tag"&&pe.key&&(pe.params=[pe.key],delete pe.key)}),ce.fill&&(ce.groupBy.push({type:"fill",params:[ce.fill]}),delete ce.fill)))}),J)),he<9&&ie.push(J=>{if(J.type!=="singlestat"&&J.thresholds!=="")return J;if(J.thresholds){const ce=J.thresholds.split(",");ce.length>=3&&(ce.shift(),J.thresholds=ce.join(","))}return J}),he<10&&ie.push(J=>(J.type!=="table"||(0,t.each)(J.styles,ce=>{if(ce.thresholds&&ce.thresholds.length>=3){const pe=ce.thresholds;pe.shift(),ce.thresholds=pe}}),J)),he<12&&(0,t.each)(this.dashboard.getVariables(),J=>{"refresh"in J&&(J.refresh&&(J.refresh=1),J.refresh||(J.refresh=0)),"hideVariable"in J&&J.hideVariable?J.hide=2:"hideLabel"in J&&J.hideLabel&&(J.hide=1)}),he<12&&ie.push(J=>(J.type!=="graph"||!J.grid||J.yaxes||(J.yaxes=[{show:J["y-axis"],min:J.grid.leftMin,max:J.grid.leftMax,logBase:J.grid.leftLogBase,format:J.y_formats[0],label:J.leftYAxisLabel},{show:J["y-axis"],min:J.grid.rightMin,max:J.grid.rightMax,logBase:J.grid.rightLogBase,format:J.y_formats[1],label:J.rightYAxisLabel}],J.xaxis={show:J["x-axis"]},delete J.grid.leftMin,delete J.grid.leftMax,delete J.grid.leftLogBase,delete J.grid.rightMin,delete J.grid.rightMax,delete J.grid.rightLogBase,delete J.y_formats,delete J.leftYAxisLabel,delete J.rightYAxisLabel,delete J["y-axis"],delete J["x-axis"]),J)),he<13&&ie.push(J=>{if(J.type!=="graph"||!J.grid)return J;J.thresholds||(J.thresholds=[]);const ce={},pe={};return J.grid.threshold1!==null&&(ce.value=J.grid.threshold1,J.grid.thresholdLine?(ce.line=!0,ce.lineColor=J.grid.threshold1Color,ce.colorMode="custom"):(ce.fill=!0,ce.fillColor=J.grid.threshold1Color,ce.colorMode="custom")),J.grid.threshold2!==null&&(pe.value=J.grid.threshold2,J.grid.thresholdLine?(pe.line=!0,pe.lineColor=J.grid.threshold2Color,pe.colorMode="custom"):(pe.fill=!0,pe.fillColor=J.grid.threshold2Color,pe.colorMode="custom")),(0,t.isNumber)(ce.value)&&((0,t.isNumber)(pe.value)?ce.value>pe.value?(ce.op=pe.op="lt",J.thresholds.push(ce),J.thresholds.push(pe)):(ce.op=pe.op="gt",J.thresholds.push(ce),J.thresholds.push(pe)):(ce.op="gt",J.thresholds.push(ce))),delete J.grid.threshold1,delete J.grid.threshold1Color,delete J.grid.threshold2,delete J.grid.threshold2Color,delete J.grid.thresholdLine,J}),he<14&&(this.dashboard.graphTooltip=ae.sharedCrosshair?1:0),he<16&&this.upgradeToGridLayout(ae),he<17&&ie.push(J=>{if(J.minSpan){const ce=m.cV/J.minSpan,pe=D(m.cV);J.maxPerRow=pe[(0,t.findIndex)(pe,Pe=>Pe>ce)-1]}return delete J.minSpan,J}),he<18&&ie.push(J=>(J["options-gauge"]&&(J.options=J["options-gauge"],J.options.valueOptions={unit:J.options.unit,stat:J.options.stat,decimals:J.options.decimals,prefix:J.options.prefix,suffix:J.options.suffix},J.options.thresholds&&J.options.thresholds.reverse(),delete J.options.options,delete J.options.unit,delete J.options.stat,delete J.options.decimals,delete J.options.prefix,delete J.options.suffix,delete J["options-gauge"]),J)),he<19&&ie.push(J=>(J.links&&(0,t.isArray)(J.links)&&(J.links=J.links.map(H)),J)),he<20){const J=ce=>({...ce,url:z(ce.url)});ie.push(ce=>(ce.options&&ce.options.dataLinks&&(0,t.isArray)(ce.options.dataLinks)&&(ce.options.dataLinks=ce.options.dataLinks.map(J)),ce.options&&ce.options.fieldOptions&&ce.options.fieldOptions.defaults&&(ce.options.fieldOptions.defaults.links&&(0,t.isArray)(ce.options.fieldOptions.defaults.links)&&(ce.options.fieldOptions.defaults.links=ce.options.fieldOptions.defaults.links.map(J)),ce.options.fieldOptions.defaults.title&&(ce.options.fieldOptions.defaults.title=z(ce.options.fieldOptions.defaults.title))),ce))}if(he<21){const J=ce=>({...ce,url:ce.url.replace(/__series.labels/g,"__field.labels")});ie.push(ce=>(ce.options&&ce.options.dataLinks&&(0,t.isArray)(ce.options.dataLinks)&&(ce.options.dataLinks=ce.options.dataLinks.map(J)),ce.options&&ce.options.fieldOptions&&ce.options.fieldOptions.defaults&&ce.options.fieldOptions.defaults.links&&(0,t.isArray)(ce.options.fieldOptions.defaults.links)&&(ce.options.fieldOptions.defaults.links=ce.options.fieldOptions.defaults.links.map(J)),ce))}if(he<22&&ie.push(J=>(J.type!=="table"||(0,t.each)(J.styles,ce=>{ce.align="auto"}),J)),he<23)for(const J of this.dashboard.templating.list){if(!(0,C.iv)(J))continue;const{multi:ce,current:pe}=J;(0,r.R)(pe)||(J.current=(0,b.C)(pe,ce))}if(he<24&&ie.push(J=>{const ce=J.type==="table";if(ce&&!J.styles)return J;const pe=J.table==="table2";return!ce||pe||(J.type=ce?"table-old":"table"),J}),he<25,he<26&&ie.push(J=>(J.type==="text2"&&(J.type="text",delete J.options.angular),J)),he<27&&(this.removeRepeatedPanels(),this.dashboard.templating.list=this.dashboard.templating.list.map(J=>{if(!(0,C.VO)(J))return J;const ce={...J};return ce.current={selected:!0,text:ce.query??"",value:ce.query??""},ce.options=[ce.current],ce.hide===s.zL.dontHide||ce.hide===s.zL.hideLabel?{...ce,type:"textbox"}:ce})),he<28){ie.push(J=>J.type==="singlestat"?G(J):J);for(const J of this.dashboard.templating.list)J.tags&&delete J.tags,J.tagsQuery&&delete J.tagsQuery,J.tagValuesQuery&&delete J.tagValuesQuery,J.useTags&&delete J.useTags}if(he<29)for(const J of this.dashboard.templating.list)J.type==="query"&&(J.refresh!==1&&J.refresh!==2&&(J.refresh=1),J.options?.length&&(J.options=[]));if(he<30&&(ie.push(Y),ie.push(ee)),he<31&&ie.push(J=>{if(J.transformations){for(const ce of J.transformations)if(ce.id===c.V.id)return Q(J,c.V.id,{id:p.o.id,options:{}})}return J}),he<32,he<33&&ie.push(J=>{if(J.datasource=M(J.datasource,{returnDefaultAsNull:!0}),!J.targets)return J;for(const ce of J.targets){const pe=M(ce.datasource,{returnDefaultAsNull:!0});pe!=null&&(ce.datasource=pe)}return J}),he<34&&(ie.push(J=>(this.migrateCloudWatchQueries(J),J)),this.migrateCloudWatchAnnotationQuery()),he<35&&ie.push(ne),he<36){for(const ce of this.dashboard.annotations.list)ce.datasource=M(ce.datasource,{returnDefaultAsNull:!1});const J=(0,h.l)().getInstanceSettings(null);if(J){for(const ce of this.dashboard.templating.list)ce.type==="query"&&ce.datasource===null&&(ce.datasource=(0,a.p$)(J));ie.push(ce=>{if(ce.targets){let pe=!1;ce.datasource==null&&ce.targets.length>0&&(ce.datasource=(0,a.p$)(J),pe=!0);for(const Pe of ce.targets)(Pe.datasource==null||Pe.datasource.uid==null)&&(ce.datasource?.uid!==T.uv?Pe.datasource={...ce.datasource}:Pe.datasource=M(Pe.datasource,{returnDefaultAsNull:!1})),pe&&Pe.datasource?.uid!=="__expr__"&&(ce.datasource=Pe.datasource)}return ce})}}if(he<37&&ie.push(J=>(J.options?.legend&&(J.options.legend.displayMode==="hidden"||J.options.legend.showLegend===!1)?(J.options.legend.displayMode="list",J.options.legend.showLegend=!1):J.options?.legend&&(J.options.legend={...J.options?.legend,showLegend:!0}),J)),he<38&&ie.push(J=>{if(J.type==="table"&&J.fieldConfig!==void 0){const ce=J.fieldConfig.defaults?.custom?.displayMode;if(ce!==void 0&&(J.fieldConfig.defaults.custom.cellOptions=(0,f.o7)(ce),delete J.fieldConfig.defaults.custom.displayMode),J.fieldConfig?.overrides)for(const pe of J.fieldConfig.overrides)for(let Pe=0;Pe<pe.properties?.length;Pe++){let Ie=pe.properties[Pe].value;pe.properties[Pe].id==="custom.displayMode"&&(pe.properties[Pe].id="custom.cellOptions",pe.properties[Pe].value=(0,f.o7)(Ie))}}return J}),he<39&&ie.push(J=>(J.transformations?.forEach(ce=>{if(ce.id==="timeSeriesTable"&&ce.options!==void 0&&ce.options.refIdToStat!==void 0){let pe={};for(const[Pe,Ie]of Object.entries(ce.options.refIdToStat)){let ge={};ge.stat=Ie,pe[Pe]=ge}ce.options=pe}}),J)),he<40&&typeof this.dashboard.refresh!="string"&&(this.dashboard.refresh=""),ie.length!==0)for(se=0;se<this.dashboard.panels.length;se++)for(de=0;de<ie.length;de++){this.dashboard.panels[se]=ie[de].call(this,this.dashboard.panels[se]);const J=this.dashboard.panels[se].panels;if(J)for(le=0;le<J.length;le++)J[le]=ie[de].call(this,J[le])}}}removeRepeatedPanels(){const ae=[];for(const re of this.dashboard.panels)re.repeatPanelId||re.repeatByRow||(re.type==="row"&&Array.isArray(re.panels)&&(re.panels=re.panels.filter(se=>!se.repeatPanelId)),ae.push(re));this.dashboard.panels=ae}migrateCloudWatchQueries(ae){for(const re of ae.targets||[])if(q(re)&&(N(re),re.hasOwnProperty("statistics"))){const se=j(re,[...ae.targets]);for(const de of se)ae.targets.push(de)}}migrateCloudWatchAnnotationQuery(){for(const ae of this.dashboard.annotations.list)if(te(ae)){const re=B(ae);for(const se of re)this.dashboard.annotations.list.push(se)}}upgradeToGridLayout(ae){let re=0;const se=m.cV/12;let le=(0,t.max)((0,t.flattenDeep)((0,t.map)(ae.rows,ie=>(0,t.map)(ie.panels,"id"))))+1;if(!ae.rows)return;const he=(0,t.some)(ae.rows,ie=>ie.collapse||ie.showTitle||ie.repeat);for(const ie of ae.rows){if(ie.repeatIteration)continue;const J=ie.height||m.bJ,ce=U(J),pe={};let Pe;he&&(pe.id=le,pe.type="row",pe.title=ie.title,pe.collapsed=ie.collapse,pe.repeat=ie.repeat,pe.panels=[],pe.gridPos={x:0,y:re,w:m.cV,h:ce},Pe=new I.a9(pe),le++,re++);const Ie=new W(ce,m.cV,re);for(const ge of ie.panels){ge.span=ge.span||m.o9,ge.minSpan&&(ge.minSpan=Math.min(m.cV,m.cV/12*ge.minSpan));const Se=Math.floor(ge.span)*se,De=ge.height?U(ge.height):ce,Ke=Ie.getPanelPosition(De,Se);re=Ie.yPos,ge.gridPos={x:Ke.x,y:re+Ke.y,w:Se,h:De},Ie.addPanel(ge.gridPos),delete ge.span,Pe&&pe.collapsed?Pe.panels?.push(ge):this.dashboard.panels.push(new I.a9(ge))}Pe&&this.dashboard.panels.push(Pe),Pe&&pe.collapsed||(re+=ce)}}}function U(Z){return(0,t.isString)(Z)&&(Z=parseInt(Z.replace("px",""),10)),Z<m.cx&&(Z=m.cx),Math.ceil(Z/(m.sD+m.dU))}class W{constructor(ae,re=m.cV,se=0){this.area=new Array(re).fill(0),this.yPos=se,this.height=ae}reset(){this.area.fill(0)}addPanel(ae){for(let re=ae.x;re<ae.x+ae.w;re++)(!this.area[re]||ae.y+ae.h-this.yPos>this.area[re])&&(this.area[re]=ae.y+ae.h-this.yPos);return this.area}getPanelPosition(ae,re,se=!1){let de,le,he;for(let ie=this.area.length-1;ie>=0&&this.height-this.area[ie]>0;ie--)if(le===void 0)le=ie;else if(ie<this.area.length-1&&this.area[ie]<=this.area[ie+1])de=ie;else break;if(de!==void 0&&le!==void 0&&le-de>=re-1){const ie=(0,t.max)(this.area.slice(de));he={x:de,y:ie}}else return se?null:(this.yPos+=this.height,this.reset(),this.getPanelPosition(ae,re,!0));return he}}function H(Z){let ae=Z.url;return!ae&&Z.dashboard&&(ae=`dashboard/db/${x.A.slugifyForUrl(Z.dashboard)}`),!ae&&Z.dashUri&&(ae=`dashboard/${Z.dashUri}`),ae||(ae="/"),Z.keepTime&&(ae=g.kM.appendQueryToUrl(ae,`$${i.c.keepTime}`)),Z.includeVars&&(ae=g.kM.appendQueryToUrl(ae,`$${i.c.includeVars}`)),Z.params&&(ae=g.kM.appendQueryToUrl(ae,Z.params)),{url:ae,title:Z.title,targetBlank:Z.targetBlank}}function z(Z){const ae=/(__series_name)|(\$__series_name)|(__value_time)|(__field_name)|(\$__field_name)/g;return Z.replace(ae,(re,se,de,le,he,ie)=>se?"__series.name":de?"${__series.name}":le?"__value.time":he?"__field.name":ie?"${__field.name}":re)}function G(Z){if(P.$W.panels["grafana-singlestat-panel"])return Z.type="grafana-singlestat-panel",Z;let ae=!1;return Z.changePlugin||(ae=!0,Z=new I.a9(Z)),Z.plugin={angularPanelCtrl:{}},Z.gauge?.show?(A.plugin.meta=P.$W.panels.gauge,Z.changePlugin(A.plugin)):(R.plugin.meta=P.$W.panels.stat,Z.changePlugin(R.plugin)),ae?Z.getSaveModel():Z}function M(Z,ae){if(ae.returnDefaultAsNull&&(Z==null||Z==="default"))return null;if((0,a.fN)(Z))return Z;const re=(0,h.l)().getInstanceSettings(Z);return re?(0,a.p$)(re):{uid:Z||void 0}}function Q(Z,ae,re){if(Z.transformations){const se=[];for(const de of Z.transformations)se.push(de),de.id===ae&&se.push({...re});Z.transformations=se}return Z}function Y(Z){const ae=Z.fieldConfig;if(!ae)return Z;if(ae.defaults&&ae.defaults.mappings&&(ae.defaults.mappings=X(ae.defaults.mappings,ae.defaults.thresholds)),Array.isArray(ae.overrides))for(const re of ae.overrides)for(const se of re.properties)se.id==="mappings"&&(se.value=X(se.value));return Z}function q(Z){return Z.hasOwnProperty("dimensions")&&Z.hasOwnProperty("namespace")&&Z.hasOwnProperty("region")&&Z.hasOwnProperty("metricName")}function te(Z){return Z.hasOwnProperty("dimensions")&&Z.hasOwnProperty("namespace")&&Z.hasOwnProperty("region")&&Z.hasOwnProperty("prefixMatching")&&Z.hasOwnProperty("statistics")}function X(Z,ae){if(!Z)return;const re={type:l.d.ValueToText,options:{}},se=[];for(const de of Z){if(de.type&&de.options){de.type===l.d.ValueToText?re.options={...re.options,...de.options}:se.push(de);continue}let le;const he=parseFloat(de.text);if(ae&&!isNaN(he)){const ie=(0,d.yQ)(he,ae.steps);ie&&ie.color&&(le=ie.color)}switch(de.type){case 1:de.value!=null&&(de.value==="null"?se.push({type:l.d.SpecialValue,options:{match:l.W.Null,result:{text:de.text,color:le}}}):re.options[String(de.value)]={text:de.text,color:le});break;case 2:se.push({type:l.d.RangeToText,options:{from:+de.from,to:+de.to,result:{text:de.text,color:le}}});break}}return Object.keys(re.options).length>0&&se.unshift(re),se}function ee(Z){return(Z.type==="timeseries"||Z.type==="xychart"||Z.type==="xychart2")&&Z.options.tooltipOptions&&(Z.options={...Z.options,tooltip:Z.options.tooltipOptions},delete Z.options.tooltipOptions),Z}function ne(Z){return Z.type==="timeseries"&&Z.fieldConfig?.defaults.custom?.axisPlacement===y.vM.Hidden&&(Z.fieldConfig={...Z.fieldConfig,overrides:[...Z.fieldConfig.overrides,{matcher:{id:o.Ct.byType,options:u.PU.time},properties:[{id:"custom.axisPlacement",value:y.vM.Auto}]}]}),Z}},98365:(_,L,e)=>{"use strict";e.d(L,{G:()=>N});var t=e(2543),n=e(64423),r=e(18226),s=e(72724),a=e(47232),g=e(3591),i=e(32264),l=e(24284),d=e(15054),o=e(16233),u=e(28874),c=e(8480),p=e(20601),h=e(72401),y=e(87421),f=e(31678),v=e(28444),P=e(10096),m=e(99140),D=e(80484),x=e(75096),E=e(74856),C=e(34214);const b=new Set(["gridPos","title","description","transparent"]);function T(w,U){const W=[],H={changed:!1,actions:{add:[],remove:[],replace:[],update:[],noop:[]},panels:W};let z=0;const G=new Map;for(let M of U){let{id:Q}=M;Q||(z||(z=R([w,U])),Q=z++,M={...M,id:Q}),G.set(Q,M)}for(const M of w){const Q=G.get(M.id);if(!Q){H.changed=!0,H.actions.remove.push(M.id),M.destroy();continue}if(G.delete(M.id),Q===M){W.push(M),H.actions.noop.push(M.id);continue}if(M.type===Q.type){const q=M.getSaveModel();let te=!0,X=!1;for(const[ee,ne]of Object.entries(Q))if(!(0,t.isEqualWith)(ne,q[ee],A))if(H.changed=!0,te=!1,b.has(ee))M[ee]=ne,X=!0;else{X=!1;break}if(te){W.push(M),H.actions.noop.push(M.id);continue}if(X){W.push(M),H.actions.update.push(M.id);continue}}M.destroy();const Y=new C.a(Q);Y.key=`${Y.id}-update-${Date.now()}`,W.push(Y),H.changed=!0,H.actions.replace.push(M.id)}for(const M of G.values())W.push(new C.a(M)),H.changed=!0,H.actions.add.push(M.id);return H}function A(w,U){if(w==null&&(U===1/0||U===-1/0||U==null)||U==null&&(w===1/0||w===-1/0||w==null))return!0}function R(w){let U=0;for(const W of w)for(const H of W)H.id>U&&(U=H.id);return U+1}var S=e(79056),O=e(84423);function j(w,U){return w.repeatDirection===d.HG?!1:U.gridPos.x>=w.gridPos.x+w.gridPos.w&&U.gridPos.y===w.gridPos.y}function B(w){for(const U of w)if(delete U.scopedVars,U.panels?.length)for(const W of U.panels)delete W.scopedVars}class N{constructor(U,W,H){this.timeRangeUpdatedDuringEditOrView=!1,this.originalDashboard=null,this.getVariablesFromState=H?.getVariablesFromState??y.SS,this.events=new r.o,this.id=U.id||null,this.uid=U.uid||null,this.revision=U.revision??void 0,this.title=U.title??"No Title",this.description=U.description,this.tags=U.tags??[],this.timezone=U.timezone??"",this.weekStart=U.weekStart??"",this.editable=U.editable!==!1,this.graphTooltip=U.graphTooltip||0,this.time=U.time??{from:"now-6h",to:"now"},this.timepicker=U.timepicker??{},this.liveNow=U.liveNow,this.templating=this.removeNullValuesFromVariables(this.ensureListExist(U.templating)),this.annotations=this.ensureListExist(U.annotations),this.refresh=U.refresh,this.snapshot=U.snapshot,this.schemaVersion=U.schemaVersion??0,this.fiscalYearStartMonth=U.fiscalYearStartMonth??0,this.version=U.version??0,this.links=U.links??[],this.gnetId=U.gnetId||null,this.panels=(0,t.map)(U.panels??[],z=>new O.a9(z)),this.originalDashboard=(0,t.cloneDeep)(U),this.originalTemplating=(0,t.cloneDeep)(this.templating),this.originalTime=(0,t.cloneDeep)(this.time),this.ensurePanelsHaveUniqueIds(),this.formatDate=this.formatDate.bind(this),this.initMeta(W),this.updateSchema(U),this.addBuiltInAnnotationQuery(),this.sortPanelsByGridPos(),this.panelsAffectedByVariableChange=null,this.appEventsSubscription=new n.yU,this.lastRefresh=Date.now(),this.appEventsSubscription.add(P.lE.subscribe(D.og,this.variablesChangedHandler.bind(this))),this.appEventsSubscription.add(P.lE.subscribe(D.BS,this.variablesTimeRangeProcessDoneHandler.bind(this))),this.appEventsSubscription.add(P.lE.subscribe(D.eF,this.variablesChangedInUrlHandler.bind(this)))}static{this.nonPersistedProperties={events:!0,meta:!0,panels:!0,templating:!0,originalTime:!0,originalTemplating:!0,originalLibraryPanels:!0,panelInEdit:!0,panelInView:!0,getVariablesFromState:!0,formatDate:!0,appEventsSubscription:!0,panelsAffectedByVariableChange:!0,lastRefresh:!0,timeRangeUpdatedDuringEditOrView:!0,originalDashboard:!0}}addBuiltInAnnotationQuery(){this.annotations.list.some(W=>W.builtIn===1)||this.annotations.list.unshift({datasource:{uid:"-- Grafana --",type:"grafana"},name:"Annotations & Alerts",type:"dashboard",iconColor:l.Mk,enable:!0,hide:!0,builtIn:1})}initMeta(U){U=U||{},U.canShare=U.canShare!==!1,U.canSave=U.canSave!==!1,U.canStar=U.canStar!==!1,U.canEdit=U.canEdit!==!1,U.canDelete=U.canDelete!==!1,U.showSettings=U.canEdit,U.canMakeEditable=U.canSave&&!this.editable,U.hasUnsavedFolderChange=!1,this.editable||(U.canEdit=!1,U.canDelete=!1,U.canSave=!1),this.meta=U}getSaveModelCloneOld(U){const W=(0,t.defaults)(U||{},{saveVariables:!0,saveTimerange:!0});let H={};for(const z in this)N.nonPersistedProperties[z]||!this.hasOwnProperty(z)||(H[z]=(0,t.cloneDeep)(this[z]));return H.templating=this.getTemplatingSaveModel(W),W.saveTimerange||(H.time=this.originalTime),H.panels=this.getPanelSaveModels(),H=(0,u.v)(H),H.getVariables=()=>H.templating.list,H}getSaveModelClone(U){const W=this.getSaveModelCloneOld(U),H=JSON.stringify(W);return JSON.parse(H)}updatePanels(U){const W=T(this.panels,U??[]);return W.changed&&(this.panels=W.panels??[],this.sortPanelsByGridPos(),this.events.publish(new v.Q$)),W}getPanelSaveModels(){return this.panels.filter(U=>this.isSnapshotTruthy()||!(U.repeatPanelId||U.repeatedByRow)).map(U=>{if(U.libraryPanel){const{id:W,title:H,libraryPanel:z,gridPos:G}=U;return{id:W,title:H,gridPos:G,libraryPanel:{uid:z.uid,name:z.name}}}return this.panelInEdit&&this.panelInEdit.id===U.id?this.panelInEdit.getSaveModel():U.getSaveModel()}).map(U=>(this.isSnapshotTruthy()||(delete U.scopedVars,U.type==="row"&&U.panels&&U.panels.length>0&&(U.panels=U.panels.filter(W=>!W.repeatPanelId).map(W=>(delete W.scopedVars,W)))),U))}getTemplatingSaveModel(U){const W=this.originalTemplating?.list??[],z=this.getVariablesFromState(this.uid).map(M=>{const Q=p.B.get(M.type).getSaveModel(M,U.saveVariables);if(!U.saveVariables){const Y=W.find(({name:q,type:te})=>q===M.name&&te===M.type);if(!Y)return Q;M.type==="adhoc"?Q.filters=Y.filters:(Q.current=Y.current,Q.options=Y.options)}return Q});return{list:(0,u.v)(z)}}timeRangeUpdated(U){this.events.publish(new g.sR(U)),(0,m.JD)((0,h.RK)(this.uid,U)),(this.panelInEdit||this.panelInView)&&(this.timeRangeUpdatedDuringEditOrView=!0)}startRefresh(U={refreshAll:!0,panelIds:[]}){if(this.events.publish(new g._),this.lastRefresh=Date.now(),this.panelInEdit&&(U.refreshAll||U.panelIds.includes(this.panelInEdit.id))){this.panelInEdit.refresh();return}const W=this.panels.filter(H=>!this.otherPanelInFullscreen(H)&&(U.refreshAll||U.panelIds.includes(H.id)));if(!this.isSnapshot())for(const H of W)H.refreshWhenInView=!0;for(const H of W)H.refresh()}render(){this.events.publish(new v.XM);for(const U of this.panels)U.render()}panelInitialized(U){const W=U.getQueryRunner().getLastResult();!this.otherPanelInFullscreen(U)&&!W&&U.refresh()}otherPanelInFullscreen(U){return(this.panelInEdit||this.panelInView)&&!(U.isViewing||U.isEditing)}initEditPanel(U){return(0,E.jG)().stopAutoRefresh(),this.panelInEdit=U.getEditClone(),this.timeRangeUpdatedDuringEditOrView=!1,this.panelInEdit}exitPanelEditor(){this.panelInEdit.destroy(),this.panelInEdit=void 0,(0,E.jG)().resumeAutoRefresh(),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}initViewPanel(U){this.panelInView=U,this.timeRangeUpdatedDuringEditOrView=!1,U.setIsViewing(!0)}exitViewPanel(U){this.panelInView=void 0,U.setIsViewing(!1),this.refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged()}refreshIfPanelsAffectedByVariableChangeOrTimeRangeChanged(){(this.panelsAffectedByVariableChange||this.timeRangeUpdatedDuringEditOrView)&&(this.startRefresh({panelIds:this.panelsAffectedByVariableChange??[],refreshAll:this.timeRangeUpdatedDuringEditOrView}),this.panelsAffectedByVariableChange=null,this.timeRangeUpdatedDuringEditOrView=!1)}ensurePanelsHaveUniqueIds(){const U=new Set;let W=this.getNextPanelId();for(const H of this.panelIterator())(!H.id||U.has(H.id))&&(H.id=W++),U.add(H.id)}removeNullValuesFromVariables(U){if(!U.list.length)return U;for(const W of U.list)W.current&&(W.current.value===null||Array.isArray(W.current.value)&&W.current.value.includes(null))&&(W.current=void 0);return U}ensureListExist(U={}){return U.list??=[],U}getNextPanelId(){let U=0;for(const W of this.panelIterator())W.id>U&&(U=W.id);return U+1}*panelIterator(){for(const U of this.panels){yield U;const W=U.panels??[];for(const H of W)yield H}}forEachPanel(U){for(let W=0;W<this.panels.length;W++)U(this.panels[W],W)}getPanelById(U,W=!1){if(this.panelInEdit&&this.panelInEdit.id===U)return this.panelInEdit;if(W){for(const H of this.panelIterator())if(H.id===U)return H;return null}else return this.panels.find(H=>H.id===U)??null}canEditPanel(U){return!!(this.meta.canEdit&&U&&!U.repeatPanelId&&U.type!=="row")}canEditPanelById(U){return this.canEditPanel(this.getPanelById(U))}addPanel(U){U.id=this.getNextPanelId(),this.panels.unshift(new O.a9(U)),this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}updateMeta(U){this.meta={...this.meta,...U},this.events.publish(new v.Cf)}makeEditable(){this.editable=!0,this.updateMeta({canMakeEditable:!1,canEdit:!0,canSave:!0})}sortPanelsByGridPos(){this.panels.sort((U,W)=>U.gridPos.y===W.gridPos.y?U.gridPos.x-W.gridPos.x:U.gridPos.y-W.gridPos.y)}clearUnsavedChanges(U,W){for(const H of this.panels)H.configRev=0;this.panelInEdit&&(this.panelInEdit.hasSavedPanelEditChange=this.panelInEdit.configRev>0,this.panelInEdit.configRev=0),this.originalDashboard=U,this.originalTemplating=U.templating,W.saveTimerange&&(this.originalTime=U.time)}hasUnsavedChanges(){return!!this.panels.find(W=>W.hasChanged)}cleanUpRepeats(){if(this.isSnapshotTruthy()||!this.hasVariables())return;B(this.panels);const U=this.panels.filter(W=>(!W.repeat||W.repeatedByRow)&&W.repeatPanelId);(0,t.pull)(this.panels,...U),U.map(W=>W.destroy()),this.sortPanelsByGridPos()}processRepeats(){if(!(this.isSnapshotTruthy()||!this.hasVariables()||this.panelInView)){this.cleanUpRepeats();for(let U=0;U<this.panels.length;U++){const W=this.panels[U];W.repeat&&this.repeatPanel(W,U)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}}cleanUpRowRepeats(U){const W=U.map(z=>z.id),H=U.filter(z=>!z.repeat&&z.repeatPanelId&&W.includes(z.repeatPanelId));(0,t.pull)(U,...H),(0,t.pull)(this.panels,...H)}processRowRepeats(U){if(this.isSnapshotTruthy()||!this.hasVariables())return;let W=U.panels??[];if(!U.collapsed){const H=this.panels.findIndex(z=>z.id===U.id);W=this.getRowPanels(H)}this.cleanUpRowRepeats(W);for(const H of W)if(H.repeat){const z=this.panels.findIndex(G=>G.id===H.id);this.repeatPanel(H,z)}}getPanelRepeatClone(U,W,H){if(W===0)return U;const z=U.getSaveModel();z.id=this.getNextPanelId();const G=new O.a9(z);return this.panels.splice(H+W,0,G),G.repeatPanelId=U.id,G.repeat=void 0,this.panelInView?.id===G.id&&(G.setIsViewing(!0),this.panelInView=G),G}getRowRepeatClone(U,W,H){if(W===0){if(!U.collapsed){const Q=this.getRowPanels(H);U.panels=Q}return U}const z=new O.a9(U.getSaveModel());let G,M;return U.collapsed?(G=(0,t.cloneDeep)(U.panels)??[],z.panels=G,M=H+W):(G=this.getRowPanels(H),z.panels=G.map(Q=>Q.getSaveModel()),M=H+(G.length+1)*W),this.panels.splice(M,0,z),this.updateRepeatedPanelIds(z),z}repeatPanel(U,W){const H=this.getPanelRepeatVariable(U);if(!H)return;if(U.type==="row"){this.repeatRow(U,W,H);return}const z=this.getSelectedVariableOptions(H),G=U.maxPerRow||4;let M=0,Q=U.gridPos.y;for(let q=0;q<z.length;q++){const te=z[q];let X;X=this.getPanelRepeatClone(U,q,W),X.scopedVars??={},X.scopedVars[H.name]=te,U.repeatDirection===d.Pz?(q>0&&(Q+=X.gridPos.h),X.gridPos.y=Q):(X.gridPos.w=Math.max(d.cV/z.length,d.cV/G),X.gridPos.x=M,X.gridPos.y=Q,M+=X.gridPos.w,M+X.gridPos.w>d.cV&&(M=0,Q+=X.gridPos.h))}const Y=Q-U.gridPos.y;if(Y>0){const q=W+z.length;for(const te of this.panels.slice(q))j(U,te)||(te.gridPos.y+=Y)}}repeatRow(U,W,H){const z=this.getSelectedVariableOptions(H);for(let G=0;G<z.length;G++){const M=z[G],Q=this.getRowRepeatClone(U,G,W);K(Q,H,M);const Y=this.getRowHeight(Q),q=Q.panels||[];let te;if(U.collapsed){for(const X of q)K(X,H,M),G>0&&this.updateRepeatedPanelIds(X,!0);Q.gridPos.y+=G,te=W+G+1}else{const X=W+(q.length+1)*G+1;q.forEach((ee,ne)=>{if(K(ee,H,M),G>0){const Z=new O.a9(ee);this.updateRepeatedPanelIds(Z,!0),Z.gridPos.y+=Y*G,this.panels.splice(X+ne,0,Z)}}),Q.panels=[],Q.gridPos.y+=Y*G,te=X+q.length}if(z.length>1)for(const X of this.panels.slice(te))X.gridPos.y+=Y}}updateRepeatedPanelIds(U,W){return U.repeatPanelId=U.id,U.id=this.getNextPanelId(),W?U.repeatedByRow=!0:U.repeat=void 0,U}getSelectedVariableOptions(U){let W;return(0,x.ML)(U)?W=U.options.slice(1,U.options.length):W=(0,t.filter)(U.options,{selected:!0}),W}getRowHeight(U){if(!U.panels||U.panels.length===0)return 0;if(U.collapsed)return 1;const W=(0,t.maxBy)(U.panels,({gridPos:H})=>H.y+H.h).gridPos;return W.y+W.h-U.gridPos.y}removePanel(U){this.panels=this.panels.filter(W=>W!==U),U.destroy(),this.events.publish(new v.Q$)}removeRow(U,W){(!W&&U.collapsed||W&&!U.collapsed)&&this.toggleRow(U),this.removePanel(U)}expandRows(){const U=this.panels.filter(W=>W.type==="row"&&W.collapsed);for(const W of U)this.toggleRow(W)}collapseRows(){const U=this.panels.filter(W=>W.type==="row"&&!W.collapsed);for(const W of U)this.toggleRow(W)}isSubMenuVisible(){return this.links.length>0||this.getVariables().some(U=>U.hide!==2)||this.annotations.list.some(U=>!U.hide)}getPanelInfoById(U){const W=this.panels.findIndex(H=>H.id===U);return W>=0?{panel:this.panels[W],index:W}:null}duplicatePanel(U){const W=U.getSaveModel();return W.id=this.getNextPanelId(),delete W.repeat,delete W.repeatIteration,delete W.repeatPanelId,delete W.scopedVars,W.alert&&delete W.thresholds,delete W.alert,U.gridPos.x+U.gridPos.w*2<=d.cV?W.gridPos.x+=U.gridPos.w:W.gridPos.y+=U.gridPos.h,this.addPanel(W),W}formatDate(U,W){return(0,s.LE)(U,{format:W,timeZone:this.getTimezone()})}destroy(){this.appEventsSubscription.unsubscribe(),this.events.removeAllListeners();for(const U of this.panels)U.destroy()}toggleRow(U){const W=(0,t.indexOf)(this.panels,U);if(!U.collapsed){const M=this.getRowPanels(W);(0,t.pull)(this.panels,...M),U.panels=M.map(Q=>Q.getSaveModel()),U.collapsed=!0,M.some(Q=>Q.hasChanged)&&U.configRev++,this.events.publish(new v.Q$);return}U.collapsed=!1;const H=U.panels??[],z=H.some(M=>M.repeat),G=U.repeat;if(H.length>0){const Q=(H[0].gridPos.y??U.gridPos.y)-(U.gridPos.y+U.gridPos.h);let Y=W+1,q=U.gridPos.y;for(const X of H){if(G){const ee=this.getPanelRepeatVariable(U);if(X.scopedVars??={},ee){const ne=this.getSelectedVariableOptions(ee);X.scopedVars={...X.scopedVars,[ee.name]:ne[0]}}}X.gridPos.y??(X.gridPos.y=U.gridPos.y),X.gridPos.y-=Q,this.panels.splice(Y,0,new O.a9(X)),Y+=1,q=Math.max(q,X.gridPos.y+X.gridPos.h)}const te=q-U.gridPos.y-1;for(const X of this.panels.slice(Y))X.gridPos.y+=te;U.panels=[],z&&this.processRowRepeats(U)}this.sortPanelsByGridPos(),this.events.publish(new v.Q$)}getRowPanels(U){const W=this.panels.slice(U+1),H=W.findIndex(G=>G.type==="row");return W.slice(0,H>=0?H:this.panels.length)}on(U,W){console.log("DashboardModel.on is deprecated use events.subscribe"),this.events.on(U,W)}off(U,W){console.log("DashboardModel.off is deprecated"),this.events.off(U,W)}cycleGraphTooltip(){this.graphTooltip=(this.graphTooltip+1)%3}sharedTooltipModeEnabled(){return this.graphTooltip>0}sharedCrosshairModeOnly(){return this.graphTooltip===1}getRelativeTime(U){return(0,s.fq)(U,{timeZone:this.getTimezone()})}isSnapshot(){return this.snapshot!==void 0}getTimezone(){return this.timezone?this.timezone:o.TP?.user?.timezone}updateSchema(U){new S.SW(this).updateSchema(U)}hasTimeChanged(){const{time:U,originalTime:W}=this;return!((0,t.isEqual)(U,W)||(0,t.isEqual)((0,a.KQ)(U?.from),(0,a.KQ)(W?.from))&&(0,t.isEqual)((0,a.KQ)(U?.to),(0,a.KQ)(W?.to)))}autoFitPanels(U,W){const H=Math.max(...this.panels.map(q=>q.gridPos.h+q.gridPos.y)),z=55;let M=U-z-20;W&&W!==f.KioskMode.TV&&(M+=z);const Q=Math.floor(M/(d.sD+d.dU)),Y=H/Q;for(const q of this.panels)q.gridPos.y=Math.round(q.gridPos.y/Y)||1,q.gridPos.h=Math.round(q.gridPos.h/Y)||1}templateVariableValueUpdated(){this.processRepeats(),this.events.emit(f.CoreEvents.bG)}getPanelByUrlId(U){const W=parseInt(U??"0",10),H=this.panels.filter(z=>z.collapsed);for(const z of H)z.panels?.some(M=>M.id===W)&&this.toggleRow(z);return this.getPanelById(W)}toggleLegendsForAll(){const U=this.panels.filter(I),W=U.filter(G=>G.legend.show).length,H=U.length-W,z=W>=H;for(const G of U)G.legend.show=!z,G.render()}toggleExemplarsForAll(){for(const U of this.panels)for(const W of U.targets){if(!(W.datasource&&W.datasource.type==="prometheus"))continue;const H=W;H.exemplar=!H.exemplar}this.startRefresh()}getVariables(){return this.getVariablesFromState(this.uid)}canEditAnnotations(U){let W=!0;return U?W=!!this.meta.annotationsPermissions?.dashboard.canEdit:W=!!this.meta.annotationsPermissions?.organization.canEdit,(i.$.featureToggles.annotationPermissionUpdate||this.canEditDashboard())&&W}canDeleteAnnotations(U){let W=!0;return U?W=!!this.meta.annotationsPermissions?.dashboard.canDelete:W=!!this.meta.annotationsPermissions?.organization.canDelete,i.$.featureToggles.annotationPermissionUpdate?W:W&&this.canEditDashboard()}canAddAnnotations(){return this.annotations.list.find(W=>W.builtIn===1)?.enable===!1?!1:i.$.featureToggles.annotationPermissionUpdate?!!this.meta.annotationsPermissions?.dashboard.canAdd:!!this.meta.annotationsPermissions?.dashboard.canAdd&&this.canEditDashboard()}canEditDashboard(){return!!(this.meta.canEdit||this.meta.canMakeEditable)}shouldUpdateDashboardPanelFromJSON(U,W){!(0,t.isEqual)(U?.gridPos,W?.gridPos)&&this.events.publish(new v.Q$)}getDefaultTime(){return this.originalTime}getPanelRepeatVariable(U){return this.getVariablesFromState(this.uid).find(W=>W.name===U.repeat)}isSnapshotTruthy(){return this.snapshot}hasVariables(){return this.getVariablesFromState(this.uid).length>0}hasVariablesChanged(){const U=this.originalTemplating?.list??[],W=this.getTemplatingSaveModel({saveVariables:!0}).list;return U.length!==W.length?!1:!(0,t.isEqual)(W,U)}variablesTimeRangeProcessDoneHandler(U){const W=U.payload.variableIds.length>0;this.variablesChangedHandler(new D.og({panelIds:[],refreshAll:!0}),W)}variablesChangedHandler(U,W=!0){if(W&&this.processRepeats(),U.payload.refreshAll||(0,E.jG)().isRefreshOutsideThreshold(this.lastRefresh)){this.startRefresh({refreshAll:!0,panelIds:[]});return}(this.panelInEdit||this.panelInView)&&(this.panelsAffectedByVariableChange=U.payload.panelIds.filter(H=>H!==(this.panelInEdit?.id??this.panelInView?.id))),this.startRefresh(U.payload)}variablesChangedInUrlHandler(U){this.templateVariableValueUpdated(),this.startRefresh(U.payload)}getOriginalDashboard(){return this.originalDashboard}hasAngularPlugins(){return this.panels.some(U=>{const W=(i.$.panels[U.type]?.angular?.detected||O.vI.includes(U.type))&&!i.$.panels[U.type]?.angular?.hideDeprecation;let H=!1;return U.datasource?.uid&&(H=(0,c.Hv)(U.datasource?.uid)),W||H})}}function I(w){return!!w.legend}function K(w,U,W){w.scopedVars??={},w.scopedVars[U.name]=W}},84423:(_,L,e)=>{"use strict";e.d(L,{NB:()=>m,a9:()=>x,tD:()=>D,tw:()=>C,vI:()=>P});var t=e(2543),n=e.n(t),r=e(62938),s=e(18226),a=e(77789),g=e(41987),i=e(581),l=e(3591),d=e(72574),o=e(2913),u=e(87490),c=e(28444),p=e(80924),h=e(96382);const y={events:!0,isViewing:!0,isEditing:!0,isInView:!0,hasRefreshed:!0,cachedPluginOptions:!0,plugin:!0,queryRunner:!0,replaceVariables:!0,configRev:!0,hasSavedPanelEditChange:!0,getDisplayTitle:!0,dataSupport:!0,key:!0,isNew:!0,refreshWhenInView:!0},f={id:!0,gridPos:!0,type:!0,title:!0,scopedVars:!0,repeat:!0,repeatPanelId:!0,repeatDirection:!0,repeatedByRow:!0,minSpan:!0,collapsed:!0,panels:!0,targets:!0,datasource:!0,timeFrom:!0,timeShift:!0,hideTimeOverride:!0,description:!0,links:!0,fullscreen:!0,isEditing:!0,isViewing:!0,hasRefreshed:!0,events:!0,cacheTimeout:!0,queryCachingTTL:!0,cachedPluginOptions:!0,transparent:!0,pluginVersion:!0,queryRunner:!0,transformations:!0,fieldConfig:!0,maxDataPoints:!0,interval:!0,replaceVariables:!0,libraryPanel:!0,getDisplayTitle:!0,configRev:!0,key:!0},v={gridPos:{x:0,y:0,h:3,w:6},targets:[{refId:"A"}],cachedPluginOptions:{},transparent:!1,options:{},links:[],transformations:[],fieldConfig:{defaults:{},overrides:[]},title:""},P=["graph","table-old","grafana-piechart-panel","grafana-worldmap-panel","singlestat","grafana-singlestat-panel"],m={graph:"timeseries","table-old":"table",singlestat:"stat","grafana-singlestat-panel":"stat","grafana-piechart-panel":"piechart","grafana-worldmap-panel":"geomap"},D={"heatmap-new":"heatmap"};class x{constructor(T){this.datasource=null,this.isViewing=!1,this.isEditing=!1,this.isInView=!1,this.configRev=0,this.refreshWhenInView=!0,this.cachedPluginOptions={},this.events=new s.o,this.restoreModel(T),this.replaceVariables=this.replaceVariables.bind(this),this.key=(0,r.A)()}restoreModel(T){for(const R in this)y[R]||!this.hasOwnProperty(R)||T[R]||typeof this[R]!="function"&&typeof this[R]!="symbol"&&delete this[R];for(const R in T)this[R]=T[R];const A=(0,h.p)(this);A&&(this.autoMigrateFrom=this.type,this.type=A),(0,t.defaultsDeep)(this,(0,t.cloneDeep)(v)),this.ensureQueryIds()}generateNewKey(){this.key=(0,r.A)()}ensureQueryIds(){if(this.targets&&(0,t.isArray)(this.targets))for(const T of this.targets)T.refId||(T.refId=(0,a.M)(this.targets))}getOptions(){return this.options}get hasChanged(){return this.configRev>0}updateOptions(T){this.options=T,this.configRev++,this.events.publish(new c.PR),this.render()}updateFieldConfig(T){this.fieldConfig=T,this.configRev++,this.events.publish(new c.PR),this.resendLastResult(),this.render()}getSaveModel(){const T={};for(const A in this)y[A]||!this.hasOwnProperty(A)||(0,t.isEqual)(this[A],v[A])||(T[A]=(0,t.cloneDeep)(this[A]));return this.type==="row"&&this.panels&&this.panels.length>0&&(T.panels=this.panels.map(A=>{if(A.libraryPanel){const{id:R,title:S,libraryPanel:O,gridPos:j}=A;return{id:R,title:S,gridPos:j,libraryPanel:{uid:O.uid,name:O.name}}}return A})),T}setIsViewing(T){this.isViewing=T}updateGridPos(T,A=!0){T.x===this.gridPos.x&&T.y===this.gridPos.y&&T.h===this.gridPos.h&&T.w===this.gridPos.w||(this.gridPos.x=T.x,this.gridPos.y=T.y,this.gridPos.w=T.w,this.gridPos.h=T.h,A&&this.configRev++,this.render())}runAllPanelQueries({dashboardUID:T,dashboardTimezone:A,timeData:R,width:S}){this.getQueryRunner().run({datasource:this.datasource,queries:this.targets,panelId:this.id,panelPluginId:this.type,dashboardUID:T,timezone:A,timeRange:R.timeRange,timeInfo:R.timeInfo,maxDataPoints:this.maxDataPoints||Math.floor(S),minInterval:this.interval,scopedVars:this.scopedVars,cacheTimeout:this.cacheTimeout,queryCachingTTL:this.queryCachingTTL,transformations:this.transformations,app:this.isEditing?g.Jk.PanelEditor:this.isViewing?g.Jk.PanelViewer:g.Jk.Dashboard})}refresh(){this.hasRefreshed=!0,this.events.publish(new l._)}render(){this.hasRefreshed?this.events.publish(new c.XM):this.refresh()}getOptionsToRemember(){return Object.keys(this).reduce((T,A)=>y[A]||f[A]?T:{...T,[A]:this[A]},{})}restorePanelOptions(T){const A=this.cachedPluginOptions[T];A&&(Object.keys(A.properties).map(R=>{this[R]=A.properties[R]}),this.fieldConfig=(0,i.H9)(this.fieldConfig,A.fieldConfig))}applyPluginOptionDefaults(T,A){const R=(0,i.F)({plugin:T,currentOptions:this.options,currentFieldConfig:this.fieldConfig,isAfterPluginChange:A});this.fieldConfig=R.fieldConfig,this.options=R.options}async pluginLoaded(T){this.plugin=T;const A=E(T);if(this.autoMigrateFrom){const R=m[this.autoMigrateFrom]!=null,S=this.getOptionsToRemember(),O=this.autoMigrateFrom,j=this.type;this.clearPropertiesBeforePluginChange(),this.type=j,this.plugin=T,this.callPanelTypeChangeHandler(T,O,S,R)}if(T.onPanelMigration&&A!==this.pluginVersion){const R=T.onPanelMigration(this);this.options=await R,this.pluginVersion=A}this.applyPluginOptionDefaults(T,!1),this.resendLastResult()}clearPropertiesBeforePluginChange(){for(const T in this)f[T]||delete this[T];this.options={},this.fieldConfig={defaults:{...this.fieldConfig.defaults,custom:{}},overrides:(0,i.aW)(this.fieldConfig.overrides,i.nx)}}callPanelTypeChangeHandler(T,A,R,S){if(T.onPanelTypeChanged){const O=S?{angular:R}:R.options;Object.assign(this.options,T.onPanelTypeChanged(this,A,O,this.fieldConfig))}}changePlugin(T){const A=T.meta.id,R=this.getOptionsToRemember(),S=this.fieldConfig,O=this.type,j=this.isAngularPlugin()||!!m[O];this.cachedPluginOptions[O]={properties:R,fieldConfig:S},this.clearPropertiesBeforePluginChange(),this.restorePanelOptions(A),this.callPanelTypeChangeHandler(T,O,R,j),this.type=A,this.plugin=T,this.configRev++,this.applyPluginOptionDefaults(T,!0),T.onPanelMigration&&(this.pluginVersion=E(T))}updateQueries(T){const{dataSource:A}=T;this.datasource=A,this.cacheTimeout=T.cacheTimeout,this.queryCachingTTL=T.queryCachingTTL,this.timeFrom=T.timeRange?.from,this.timeShift=T.timeRange?.shift,this.hideTimeOverride=T.timeRange?.hide,this.interval=T.minInterval,this.maxDataPoints=T.maxDataPoints,this.targets=T.queries,this.configRev++,this.events.publish(new c.zq)}addQuery(T){T=T||{refId:"A"},T.refId=(0,a.M)(this.targets),this.targets.push(T),this.configRev++}changeQuery(T,A){T.refId=this.targets[A].refId,this.configRev++,this.targets=this.targets.map((R,S)=>S===A?T:R)}getEditClone(){const T=this.getSaveModel(),A=new x(T);A.isEditing=!0,A.plugin=this.plugin;const R=this.getQueryRunner();return A.getQueryRunner().useLastResultFrom(R),A}getTransformations(){return this.transformations}getFieldOverrideOptions(){if(this.plugin)return{fieldConfig:this.fieldConfig,replaceVariables:this.replaceVariables,fieldConfigRegistry:this.plugin.fieldConfigRegistry,theme:o.Ay.theme2}}getDataSupport(){return this.plugin?.dataSupport??{annotations:!1,alertStates:!1}}getQueryRunner(){return this.queryRunner||(this.queryRunner=new p.Z(this)),this.queryRunner}hasTitle(){return this.title&&this.title.length>0}isAngularPlugin(){return(this.plugin&&this.plugin.angularPanelCtrl)!==void 0||(this.plugin?.meta?.angular?.detected??!1)}destroy(){this.events.removeAllListeners(),this.queryRunner&&this.queryRunner.destroy()}setTransformations(T){this.transformations=T,this.resendLastResult(),this.configRev++,this.events.publish(new c.JI)}setProperty(T,A){this[T]=A,this.configRev++,T==="repeat"&&(this.repeat&&!this.repeatDirection?this.repeatDirection="h":this.repeat||(delete this.repeatDirection,delete this.maxPerRow))}replaceVariables(T,A,R){const S=this.getQueryRunner().getLastRequest(),O=Object.assign({},this.scopedVars,S?.scopedVars,A);return(0,d.w)().replace(T,O,R)}resendLastResult(){this.plugin&&this.getQueryRunner().resendLastResult()}getDisplayTitle(){return this.replaceVariables(this.title,void 0,"text")}initLibraryPanel(T){for(const[A,R]of Object.entries(T.model)){switch(A){case"id":case"gridPos":case"libraryPanel":continue}this[A]=R}this.libraryPanel=T}unlinkLibraryPanel(){delete this.libraryPanel,this.configRev++,this.render()}}function E(b){return b&&b.meta.info.version?b.meta.info.version:o.Ay.buildInfo.version}function C(b){const T={};return Object.entries(b).filter(([A,R])=>!y[A]&&b.hasOwnProperty(A)&&!(0,t.isEqual)(R,v[A])).forEach(([A,R])=>{T[A]=R}),(0,u.MA)(T)}},41176:(_,L,e)=>{"use strict";e.d(L,{B:()=>r});var t=e(61298),n=e(14110);function r(s){const a={dashboardId:s.id,dashboardName:s.title,dashboardUid:s.uid,folderName:s.meta.folderTitle,eventName:t.n_.DashboardView};(0,n.G$)(a)}},96382:(_,L,e)=>{"use strict";e.d(L,{p:()=>r});var t=e(2913),n=e(84423);function r(s,a){if(n.tD[s.type])return n.tD[s.type];const g=l=>{const d="__feature."+l,u=new URLSearchParams(window.location.search).get(d);return u==="true"||u===""},i=a||!t.Ay.angularSupportEnabled||t.Ay.featureToggles.autoMigrateOldPanels||g("autoMigrateOldPanels")||g("disableAngular");if(s.type==="graph"&&(i||t.Ay.featureToggles.autoMigrateGraphPanel||g("autoMigrateGraphPanel")))return s.xaxis?.mode==="series"?s.legend?.values?"bargauge":"barchart":s.xaxis?.mode==="histogram"?"histogram":"timeseries";if(i)return n.NB[s.type];if(s.type==="table-old"&&(t.Ay.featureToggles.autoMigrateTablePanel||g("autoMigrateTablePanel")))return"table";if(s.type==="grafana-piechart-panel"&&(t.Ay.featureToggles.autoMigratePiechartPanel||g("autoMigratePiechartPanel")))return"piechart";if(s.type==="grafana-worldmap-panel"&&(t.Ay.featureToggles.autoMigrateWorldmapPanel||g("autoMigrateWorldmapPanel")))return"geomap";if((s.type==="singlestat"||s.type==="grafana-singlestat-panel")&&t.Ay.featureToggles.autoMigrateStatPanel||g("autoMigrateStatPanel"))return"stat"}},34214:(_,L,e)=>{"use strict";e.d(L,{G:()=>t.G,a:()=>n.a9});var t=e(98365),n=e(84423)},20470:(_,L,e)=>{"use strict";e.d(L,{us:()=>U,vR:()=>w,yZ:()=>H,OI:()=>W});var t=e(71733),n=e(47232),r=e(69129),s=e(39601),a=e(17172),g=e(32264),i=e(82467),l=e(28138),d=e(3169),o=e(27677),u=e(33390),c=e(78160),p=e(17493),h=e(14792),y=e(74856),f=e(72255),v=e(71176),P=e(71101),m=e(54650);function D(z){return async G=>{const M=await o.IB.getFolderByUid(z);return G((0,m.jl)(M)),G((0,i.Vz)((0,P.R4)(M))),M}}var x=e(6473),E=e(2609),C=e(75096),b=e(31678),T=e(42972),A=e(72401),R=e(87421),S=e(16833),O=e(98365),j=e(41176),B=e(28601);const N="initDashboard";async function I(z,G,M){const Q=u.A.getObject(U);if(Q)return H(),Q;try{switch(z.routeName){case b.DashboardRoutes.Home:{const q=(0,f.sP)().getDashboardFromCache(f.m6);if(q)return q;const te=await o.IB.get("/api/dashboards/home");if(te.redirectUri){const X=t.I.stripBaseFromUrl(te.redirectUri);return s.Ny.replace(X),null}return te.meta.canSave=!1,te.meta.canShare=!1,te.meta.canStar=!1,te}case b.DashboardRoutes.Public:return await p.np.loadDashboard("public",z.urlSlug,z.accessToken);case b.DashboardRoutes.Normal:{const Y=await p.np.loadDashboard(z.urlType,z.urlSlug,z.urlUid);if(Y.meta.folderUid)try{await G(D(Y.meta.folderUid))}catch(q){console.warn("Error fetching parent folder",Y.meta.folderUid,"for dashboard",q)}if(z.fixUrl&&Y.meta.url&&!E._o.state.isPlaying){const q=t.I.stripBaseFromUrl(Y.meta.url),te=s.Ny.getLocation().pathname;q!==te&&(s.Ny.replace({...s.Ny.getLocation(),pathname:q}),console.log("not correct url correcting",q,te))}return Y}case b.DashboardRoutes.New:return z.urlFolderUid&&await G(D(z.urlFolderUid)),await(0,v.X)(z.urlFolderUid);case b.DashboardRoutes.Path:{const Y=z.urlSlug??"";return await p.np.loadDashboard(b.DashboardRoutes.Path,Y,Y)}default:throw{message:"Unknown route "+z.routeName}}}catch(Y){return(0,a.NF)(Y)&&Y.cancelled||(G((0,B.ig)({message:"Failed to fetch dashboard",error:Y})),console.error(Y)),null}}const K=(z,G={})=>(z.forEach(M=>{M.panels?K(M.panels,G):M.targets&&M.targets.forEach(Q=>{Q.datasource?.type&&(G[Q.datasource.type]?G[Q.datasource.type].push(Q):G[Q.datasource.type]=[Q])})}),G);function w(z){return async(G,M)=>{(0,c.j)(N),G((0,B.xS)());const Q=await I(z,G,M),Y=Q?.dashboard?.version;if(!Q)return;G((0,B.X1)());let q;try{q=new O.G(Q.dashboard,Q.meta)}catch(se){G((0,B.ig)({message:"Failed create dashboard model",error:se})),console.error(se);return}const te=M(),X=s.Ny.getSearchObject();X.orgId||s.Ny.partial({orgId:te.user.orgId},!0);const ee=(0,y.jG)();(0,h.UA)().setCurrent(q),ee.init(q);const Z=(0,C.q4)(z.urlUid??q.uid);if(await G((0,A._q)(Z,q)),(0,T.nm)({dashboard:q,timeSrv:ee}).run({dashboard:q,range:ee.timeRange()}),(0,R.Tk)(M())!==Z||M().dashboard.initPhase!==b.DashboardInitPhase.Services)return;try{q.processRepeats(),X.autofitpanels&&q.autoFitPanels(window.innerHeight,X.kiosk),g.$.publicDashboardAccessToken||z.keybindingSrv.setupDashboardBindings(q)}catch(se){se instanceof Error&&G((0,i.dx)((0,d.gi)("Dashboard init failed",se))),console.error(se)}z.routeName!==b.DashboardRoutes.New?((0,j.B)(q),x.t.watch(q.uid)):x.t.leave(),q.weekStart!==""?(0,n.$D)(q.weekStart):(0,n.$D)(g.$.bootData.user.weekStart),l.A.publish(new r.gc({dashboardId:q.uid,orgId:te.user.orgId,userId:te.user.user?.id,grafanaVersion:g.$.buildInfo.version,queries:K(q.panels)}));const re=(0,c.z)(N);(0,S.d)(q,re?.duration,Y),G((0,B.O9)(q))}}const U="DASHBOARD_FROM_LS_KEY";function W(z){u.A.setObject(U,z)}function H(){u.A.delete(U)}},28601:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>y,O9:()=>d,Ub:()=>p,X1:()=>o,ig:()=>l,p0:()=>u,xS:()=>i});var t=e(65307),n=e(79422),r=e(31678),s=e(98365);const a={initPhase:r.DashboardInitPhase.NotStarted,getModel:()=>null,initError:null,initialDatasource:void 0},g=(0,t.Z0)({name:"dashboard",initialState:a,reducers:{dashboardInitFetching:f=>{f.initPhase=r.DashboardInitPhase.Fetching},dashboardInitServices:f=>{f.initPhase=r.DashboardInitPhase.Services},dashboardInitCompleted:(f,v)=>{f.getModel=()=>v.payload,f.initPhase=r.DashboardInitPhase.Completed},dashboardInitFailed:(f,v)=>{f.initPhase=r.DashboardInitPhase.Failed,f.initError=v.payload,f.getModel=()=>new s.G({...n.Ye,title:"Dashboard init failed"},{canSave:!1,canEdit:!1})},cleanUpDashboard:f=>{f.initPhase=r.DashboardInitPhase.NotStarted,f.initError=null,f.getModel=()=>null},addPanel:(f,v)=>{},setInitialDatasource:(f,v)=>{f.initialDatasource=v.payload}}}),{dashboardInitFetching:i,dashboardInitFailed:l,dashboardInitCompleted:d,dashboardInitServices:o,cleanUpDashboard:u,addPanel:c,setInitialDatasource:p}=g.actions,y={dashboard:g.reducer}},36974:(_,L,e)=>{"use strict";e.d(L,{B1:()=>m,CW:()=>v,LH:()=>l,OK:()=>d,SD:()=>u,VF:()=>c,_u:()=>y,dH:()=>D,ko:()=>P,no:()=>h,ob:()=>o,s3:()=>p});var t=e(2543),n=e.n(t),r=e(39601),s=e(2913),a=e(15054),g=e(33390),i=e(19752);const l="Panel Title";function d(E,C){const b={type:"timeseries",title:l,gridPos:(0,i.Ft)(E),datasource:C?{uid:C}:null,isNew:!0};return E.addPanel(b),b.id}function o(E,C){const b={type:C,title:"Widget title",gridPos:(0,i.Ft)(E),datasource:null,isNew:!0};return E.addPanel(b),b.id}function u(E){const C={type:"row",title:"Row title",gridPos:{x:0,y:0}};E.addPanel(C)}function c(){r.Ny.push("/dashboard/import")}function p(E){const C={type:"add-library-panel",gridPos:(0,i.Ft)(E)};E.addPanel(C)}function h(E,C){if(!C)return;const b=(0,i.Ft)(E),T={type:C.id,title:l,gridPos:{x:b.x,y:b.y,w:C.defaults.gridPos.w,h:C.defaults.gridPos.h}};C.defaults&&((0,t.defaults)(T,C.defaults),T.title=C.defaults.title,g.A.delete(a.tH)),E.addPanel(T)}function y(){const E=(0,t.chain)(s.Ay.panels).filter({hideFromList:!1}).map(b=>b).value(),C=g.A.get(a.tH);if(C){const b=JSON.parse(C),T=(0,t.find)(E,{id:b.type});if(T){const A=(0,t.cloneDeep)(T);return A.name=b.title,A.sort=-1,{...A,defaults:{...b}}}}}const f="grafana.dashboards.panelEdit.lastUsedDatasource";function v(E){if(g.A.exists(f)){const C=g.A.getObject(f);if(C?.dashboardUid===E)return C}}function P(E){if(!g.A.exists(f))return;const b=g.A.getObject(f)?.datasourceUid??"";x(E,b)}function m(E){g.A.setObject(f,{dashboardUid:E,datasourceUid:""})}function D(E,C){const b=v(E);if(!b)x(E,C);else{const T=b?.dashboardUid??"";x(T,C)}}function x(E,C){g.A.setObject(f,{dashboardUid:E,datasourceUid:C})}},19752:(_,L,e)=>{"use strict";e.d(L,{ET:()=>A,FC:()=>m,Ft:()=>j,KJ:()=>x,Mc:()=>E,ZY:()=>b,d7:()=>C,iU:()=>D,nk:()=>R});var t=e(2543),n=e.n(t),r=e(26272),s=e(65879),a=e(47232),g=e(85858),i=e(72574),l=e(28138),d=e(2913),o=e(15054),u=e(33390),c=e(1702),p=e(84423),h=e(54174),y=e(96227),f=e(79971),v=e(99140),P=e(28444);const m=(B,N,I)=>{if(I!==!1){const K=N.alert?"YES":void 0;l.A.publish(new P.bY({title:"Remove panel",text:"Are you sure you want to remove this panel?",icon:"trash-alt",confirmText:K,yesText:"Remove",onConfirm:()=>m(B,N,!1)}));return}B.removePanel(N),(0,v.JD)((0,f.O6)(N.key))},D=(B,N)=>{B.duplicatePanel(N)},x=B=>{let N=B;B instanceof p.a9&&(N=B.getSaveModel()),u.A.set(o.tH,JSON.stringify(N)),l.A.emit(r.r1.alertSuccess,["Panel copied. Click **Add panel** icon to paste."])},E=(B,N)=>{l.A.publish(new P.S8({component:c.ShareModal,props:{dashboard:B,panel:N}}))},C=(B,N)=>{l.A.publish(new P.S8({component:y.o,props:{panel:N,initialFolderUid:B.meta.folderUid,isOpen:!0}}))},b=B=>{l.A.publish(new P.S8({component:h.l,props:{onConfirm:()=>B.unlinkLibraryPanel(),isOpen:!0}}))},T=B=>{B.refresh()},A=B=>{const N={...B.options};N.legend.showLegend===!0?N.legend.showLegend=!1:N.legend.showLegend=!0,B.updateOptions(N)};function R(B,N){const I={timeInfo:"",timeRange:N};if(B.timeFrom){const K=(0,i.w)().replace(B.timeFrom,B.scopedVars),w=s.describeTextRange(K);if(w.invalid)return I.timeInfo="invalid time override",I;if((0,t.isString)(N.raw.from)){const U=(0,a.AN)(N.from).tz(),W=(0,a.AN)(N.to).tz(),H=g.parse(w.from,void 0,U);I.timeInfo=w.display,I.timeRange={from:H,to:g.parse(w.to,void 0,W),raw:{from:w.from,to:w.to}}}}if(B.timeShift){const K=(0,i.w)().replace(B.timeShift,B.scopedVars);if(s.describeTextRange(K).invalid)return I.timeInfo="invalid timeshift",I;const U="-"+K;I.timeInfo+=" timeshift "+U;const W=g.parseDateMath(U,I.timeRange.from,!1),H=g.parseDateMath(U,I.timeRange.to,!0);I.timeRange={from:W,to:H,raw:{from:W,to:H}}}return B.hideTimeOverride&&(I.timeInfo=""),I}function S(B){const I=document.getElementsByTagName("html")[0].getBoundingClientRect().width;return B.maxDataPoints?B.maxDataPoints:Math.ceil(I*(B.gridPos.w/24))}function O(B,N){const I=B.plugin&&B.plugin.noPadding?0:config.theme.panelPadding*2,K=B.hasTitle()?config.theme.panelHeaderHeight:0;return N-K-I-PANEL_BORDER}function j(B){for(const I of B.panelIterator())I.gridPos.y+=8;return{x:0,y:0,w:12,h:8}}},21380:(_,L,e)=>{"use strict";e.d(L,{z:()=>r});var t=e(47232),n=e(85858);const r=(s,a)=>{const g={from:(0,t.Ar)(s.from)?(0,t.KQ)(s.from):s.from,to:(0,t.Ar)(s.to)?(0,t.KQ)(s.to):s.to},i=a?a.getTimezone():void 0;return{from:n.parse(g.from,!1,i,a?.fiscalYearStartMonth),to:n.parse(g.to,!0,i,a?.fiscalYearStartMonth),raw:g}}},16833:(_,L,e)=>{"use strict";e.d(L,{D:()=>r,d:()=>n});var t=e(7758);function n(l,d,o){const u=a(l.templating.list),c=s(l.panels);t.c.dashboardInitialized({uid:l.uid,title:l.title,theme:l.style,schemaVersion:l.schemaVersion,version_before_migration:o,panels_count:l.panels.length,...c,...u,settings_nowdelay:l.timepicker.nowDelay,settings_livenow:!!l.liveNow,duration:d,isScene:!1})}function r(l,d){const o=l.getInitialSaveModel();if(o){const u=s(o.panels||[]),c=a(o.templating?.list||[]);t.c.dashboardInitialized({uid:o.uid,title:o.title,theme:void 0,schemaVersion:o.schemaVersion,version_before_migration:o.version,panels_count:o.panels?.length||0,...u,...c,settings_nowdelay:void 0,settings_livenow:!!o.liveNow,duration:d,isScene:!0})}}function s(l){return l.map(d=>d.type).reduce((d,o)=>(d[i(o)]=1+d[i(o)]||1,d),{})}function a(l){return l.map(d=>d.type).reduce((d,o)=>(d[g(o)]=1+d[g(o)]||1,d),{})}const g=l=>`variable_type_${l}_count`,i=l=>`panel_type_${l}_count`},40489:(_,L,e)=>{"use strict";e.d(L,{ZF:()=>g,vI:()=>a,o2:()=>i});var t=e(88483),n=e(14236);function r(l){const d=new Set;return Object.keys(l).forEach(o=>{l[o].forEach(u=>{d.add(u)})}),d}function s(l){const d=Array.from(r(l));return d.length===1?d[0]:`${d.slice(0,-1).join(", ")} or ${d.slice(-1)}`}function a(l){return new t.c(d=>{let o=0;Promise.all([e.e(2136),e.e(3686)]).then(e.bind(e,22136)).then(u=>{l.forEach(c=>{const p=new FileReader;p.readAsArrayBuffer(c),p.onload=()=>{const h=p.result;if(h&&h instanceof ArrayBuffer){if(c.type==="application/json"){const y=new TextDecoder("utf-8"),f=JSON.parse(y.decode(h));d.next({dataFrames:[(0,n.Vc)(f)],file:c})}else d.next({dataFrames:u.readSpreadsheet(h),file:c});++o>=l.length&&d.complete()}}})}).catch(()=>{throw"Failed to load sheets module"})})}const g={"text/plain":[".csv",".txt"],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.ms-excel":[".xls"],"application/vnd.apple.numbers":[".numbers"],"application/vnd.oasis.opendocument.spreadsheet":[".ods"],"application/json":[".json"]},i=5e5},32738:(_,L,e)=>{"use strict";e.d(L,{r:()=>l});var t=e(74848),n=e(71733),r=e(55852),s=e(10096),a=e(8484),g=e(6320),i=e(31678);function l({variant:d,onClick:o}){const u=s.TP.hasPermission(i.AccessControlAction.DataSourcesCreate),c=n.I.assureBaseUrl(g.b.DataSourcesNew);return(0,t.jsx)(r.z9,{variant:d||"primary",href:c,disabled:!u,tooltip:u?void 0:"You do not have permission to configure new data sources",onClick:o,target:"_blank",children:(0,t.jsx)(a.x6,{i18nKey:"data-source-picker.add-new-data-source",children:"Configure a new data source"})})}},2221:(_,L,e)=>{"use strict";e.d(L,{A:()=>g});var t=e(74848),n=e(32196),r=e(40845),s=e(10860),a=e(64149);function g({ds:l,onClick:d,selected:o,description:u,...c}){const p=(0,r.$j)(),h=i(p,l.meta.builtIn);return(0,t.jsxs)(s.Z,{onClick:d,className:(0,n.cx)(h.card,o?h.selected:void 0),...c,children:[(0,t.jsx)(s.Z.Heading,{className:h.heading,children:(0,t.jsxs)("div",{className:h.headingContent,children:[(0,t.jsxs)("span",{className:h.name,children:[l.name," ",l.isDefault?(0,t.jsx)(a.L,{tags:["default"]}):null]}),(0,t.jsx)("small",{className:h.type,children:u||l.meta.name})]})}),(0,t.jsx)(s.Z.Figure,{className:h.logo,children:(0,t.jsx)("img",{src:l.meta.info.logos.small,alt:`${l.meta.name} Logo`})})]},l.uid)}function i(l,d=!1){return{card:(0,n.css)`
      cursor: pointer;
      background-color: ${l.colors.background.primary};
      border-bottom: 1px solid ${l.colors.border.weak};
      // Move to list component
      margin-bottom: 0;
      border-radius: 0;
      padding: ${l.spacing(1)};
    `,heading:(0,n.css)`
      width: 100%;
      overflow: hidden;
      // This is needed to enable ellipsis when text overlfows
      > button {
        width: 100%;
      }
    `,headingContent:(0,n.css)`
      color: ${l.colors.text.secondary};
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      justify-content: space-between;
    `,logo:(0,n.css)`
      width: 32px;
      height: 32px;
      padding: ${l.spacing(0,1)};
      display: flex;
      align-items: center;

      > img {
        max-height: 100%;
        min-width: 24px;
        filter: invert(${d&&l.isLight?1:0});
      }
    `,name:(0,n.css)`
      color: ${l.colors.text.primary};
      display: flex;
      gap: ${l.spacing(2)};
    `,type:(0,n.css)`
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      display: flex;
      align-items: center;
    `,separator:(0,n.css)`
      margin: 0 ${l.spacing(1)};
      color: ${l.colors.border.weak};
    `,selected:(0,n.css)`
      background-color: ${l.colors.background.secondary};
    `,meta:(0,n.css)`
      display: block;
      overflow-wrap: unset;
      white-space: nowrap;
      width: 100%;
      overflow: hidden;
      text-overflow: ellipsis;
    `}}},11219:(_,L,e)=>{"use strict";e.d(L,{S:()=>c});var t=e(74848),n=e(32196),r=e(96540),s=e(13544),a=e(72574),g=e(40845),i=e(8484),l=e(87282),d=e(32738),o=e(2221),u=e(47311);function c(v){const P=(0,r.useRef)(null),[m,D]=(0,l.dR)({keyboardEvents:v.keyboardEvents,containerRef:P}),x=(0,g.$j)(),E=f(x,D),{className:C,current:b,onChange:T,enableKeyboardNavigation:A,onClickEmptyStateCTA:R}=v,S=(0,l.Kr)({alerting:v.alerting,annotations:v.annotations,dashboard:v.dashboard,logs:v.logs,metrics:v.metrics,mixed:v.mixed,pluginId:v.pluginId,tracing:v.tracing,type:v.type,variables:v.variables}),[O,j]=(0,l.TX)(),B=v.filter?S.filter(v.filter):S;return(0,t.jsxs)("div",{ref:P,className:(0,n.cx)(C,E.container),"data-testid":s.Tp.components.DataSourcePicker.dataSourceList,children:[B.length===0&&(0,t.jsx)(p,{className:E.emptyState,onClickCTA:R}),B.sort((0,u.Tj)(b,O,y())).map(N=>(0,t.jsx)(o.A,{"data-testid":"data-source-card",ds:N,onClick:()=>{j(N),T(N)},selected:(0,u.Df)(N,b),...A?m:{}},N.uid))]})}function p({className:v,onClickCTA:P}){const m=(0,g.of)(h);return(0,t.jsxs)("div",{className:(0,n.cx)(v,m.container),children:[(0,t.jsx)("p",{className:m.message,children:(0,t.jsx)(i.x6,{i18nKey:"data-source-picker.list.no-data-source-message",children:"No data sources found"})}),(0,t.jsx)(d.r,{onClick:P})]})}function h(v){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    `,message:(0,n.css)`
      margin-bottom: ${v.spacing(3)};
    `}}function y(){return(0,a.w)().getVariables().filter(P=>P.type==="datasource").map(P=>`\${${P.id}}`)}function f(v,P){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      ${P} {
        background-color: ${v.colors.background.secondary};
      }
    `,emptyState:(0,n.css)`
      height: 100%;
      flex: 1;
    `}}},50481:(_,L,e)=>{"use strict";e.d(L,{p:()=>A});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(14110),g=e(32264),i=e(40845),l=e(37390),d=e(10354),o=e(14578),u=e(40276),c=e(37270),p=e(8484),h=e(40489),y=e(90478),f=e(87282),v=e(32738),P=e(13544),m=e(2221),D=e(47311);function x(S){switch(S){case"grafana":return(0,p.t)("data-source-picker.built-in-list.description-grafana","Discover visualizations using mock data");case"-- Mixed --":return(0,p.t)("data-source-picker.built-in-list.description-mixed","Use multiple data sources");case"-- Dashboard --":return(0,p.t)("data-source-picker.built-in-list.description-dashboard","Reuse query results from other visualizations");default:return""}}function E({className:S,current:O,onChange:j,tracing:B,dashboard:N,mixed:I,metrics:K,type:w,annotations:U,variables:W,alerting:H,pluginId:z,logs:G,filter:M}){const Y=(0,f.Kr)({tracing:B,dashboard:N,mixed:I,metrics:K,type:w,annotations:U,variables:W,alerting:H,pluginId:z,logs:G}).filter(q=>(M?M?.(q):!0)&&!!q.meta.builtIn);return(0,t.jsx)("div",{className:S,"data-testid":P.Tp.components.DataSourcePicker.advancedModal.builtInDataSourceList,children:Y.map(q=>(0,t.jsx)(m.A,{ds:q,description:x(q.uid),selected:(0,D.Df)(q,O),onClick:()=>j(q)},q.uid))})}var C=e(11219);const b="dashboards_dspickermodal_clicked",T={SELECT_DS:"select_ds",UPLOAD_FILE:"upload_file",CONFIG_NEW_DS:"config_new_ds",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state",SEARCH:"search",DISMISS:"dismiss"};function A({tracing:S,dashboard:O,mixed:j,metrics:B,type:N,annotations:I,variables:K,alerting:w,pluginId:U,logs:W,uploadFile:H,filter:z,onChange:G,current:M,onDismiss:Q,reportedInteractionFrom:Y}){const q=(0,i.of)(R),[te,X]=(0,s.useState)(""),ee=Y||"modal",ne=()=>{Q(),(0,a.rR)(b,{item:T.DISMISS,src:ee})},Z=le=>{G(le),(0,a.rR)(b,{item:T.SELECT_DS,ds_type:le.type,src:ee})},ae=(0,s.useMemo)(()=>(0,r.once)(()=>{(0,a.rR)(b,{item:"search",src:ee})}),[ee]),re=(0,f.ps)("-- Grafana --"),se=(0,y.j)((le,he)=>{re&&(G(re,[le]),(0,a.rR)(b,{item:T.UPLOAD_FILE,src:ee}),he.length<1&&Q())}),de=({className:le})=>(0,t.jsx)(E,{className:le,onChange:Z,current:M,filter:z,variables:K,tracing:S,metrics:B,type:N,annotations:I,alerting:w,pluginId:U,logs:W,dashboard:O,mixed:j});return(0,t.jsxs)(l.a,{title:(0,p.t)("data-source-picker.modal.title","Select data source"),closeOnEscape:!0,closeOnBackdropClick:!0,isOpen:!0,className:q.modal,contentClassName:q.modalContent,onClickBackdrop:ne,onDismiss:ne,children:[(0,t.jsxs)("div",{className:q.leftColumn,children:[(0,t.jsx)(d.p,{type:"search",autoFocus:!0,className:q.searchInput,value:te,prefix:(0,t.jsx)(o.I,{name:"search"}),placeholder:(0,p.t)("data-source-picker.modal.input-placeholder","Select data source"),onChange:le=>{X(le.currentTarget.value),ae()}}),(0,t.jsxs)(u.E,{children:[(0,t.jsx)(C.S,{onChange:Z,current:M,onClickEmptyStateCTA:()=>(0,a.rR)(b,{item:T.CONFIG_NEW_DS_EMPTY_STATE,src:ee}),filter:le=>(z?z?.(le):!0)&&(0,D.Zn)(le,te)&&!le.meta.builtIn,variables:K,tracing:S,metrics:B,type:N,annotations:I,alerting:w,pluginId:U,logs:W,dashboard:O,mixed:j}),(0,t.jsx)(de,{className:q.appendBuiltInDataSourcesList})]})]}),(0,t.jsxs)("div",{className:q.rightColumn,children:[(0,t.jsxs)("div",{className:q.builtInDataSources,children:[(0,t.jsx)(u.E,{className:q.builtInDataSourcesList,children:(0,t.jsx)(de,{})}),H&&g.$.featureToggles.editPanelCSVDragAndDrop&&(0,t.jsx)(c.gH,{readAs:"readAsArrayBuffer",fileListRenderer:()=>{},options:{maxSize:h.o2,multiple:!1,accept:h.ZF,onDrop:se},children:(0,t.jsx)(c.wI,{})})]}),(0,t.jsxs)("div",{className:q.newDSSection,children:[(0,t.jsx)("span",{className:q.newDSDescription,children:(0,t.jsx)(p.x6,{i18nKey:"data-source-picker.modal.configure-new-data-source",children:"Open a new tab and configure a data source"})}),(0,t.jsx)(v.r,{variant:"secondary",onClick:()=>{(0,a.rR)(b,{item:T.CONFIG_NEW_DS,src:ee}),Q()}})]})]})]})}function R(S){return{modal:(0,n.css)`
      width: 80%;
      height: 80%;
      max-width: 1200px;
      max-height: 900px;

      ${S.breakpoints.down("md")} {
        width: 100%;
      }
    `,modalContent:(0,n.css)`
      display: flex;
      flex-direction: row;
      height: 100%;

      ${S.breakpoints.down("md")} {
        flex-direction: column;
      }
    `,leftColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      padding-right: ${S.spacing(4)};
      border-right: 1px solid ${S.colors.border.weak};

      ${S.breakpoints.down("md")} {
        width: 100%;
        border-right: 0;
        padding-right: 0;
        flex: 1;
        overflow-y: auto;
      }
    `,rightColumn:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 50%;
      height: 100%;
      justify-items: space-evenly;
      align-items: stretch;
      padding-left: ${S.spacing(4)};

      ${S.breakpoints.down("md")} {
        width: 100%;
        padding-left: 0;
        flex: 0;
      }
    `,builtInDataSources:(0,n.css)`
      flex: 1 1;
      margin-bottom: ${S.spacing(4)};

      ${S.breakpoints.down("md")} {
        flex: 0;
      }
    `,builtInDataSourcesList:(0,n.css)`
      ${S.breakpoints.down("md")} {
        display: none;
        margin-bottom: 0;
      }

      margin-bottom: ${S.spacing(4)};
    `,appendBuiltInDataSourcesList:(0,n.css)`
      ${S.breakpoints.up("md")} {
        display: none;
      }
    `,newDSSection:(0,n.css)`
      display: flex;
      flex-direction: row;
      width: 100%;
      justify-content: space-between;
      align-items: center;
    `,newDSDescription:(0,n.css)`
      flex: 1 0;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      color: ${S.colors.text.secondary};
    `,searchInput:(0,n.css)`
      width: 100%;
      min-height: 32px;
      margin-bottom: ${S.spacing(1)};
    `}}},51612:(_,L,e)=>{"use strict";e.d(L,{s:()=>N});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(18828),i=e(85690),l=e(93225),d=e(96540),o=e(13544),u=e(14110),c=e(40845),p=e(10354),h=e(14578),y=e(17464),f=e(40276),v=e(71678),P=e(55852),m=e(2913),D=e(8484),x=e(97427),E=e(68706),C=e(87282),b=e(11219);function T(H){const{dataSource:z}=H,G=(0,c.$j)(),M=R(G,z?.meta.builtIn);return z?(0,t.jsx)("img",{className:M.pickerDSLogo,alt:`${z.meta.name} logo`,src:z.meta.info.logos.small}):A()}function A(){const H=(0,c.of)(R);return(0,t.jsx)("div",{className:H.pickerDSLogo})}function R(H,z=!1){return{pickerDSLogo:(0,n.css)`
      height: 20px;
      width: 20px;
      filter: invert(${z&&H.isLight?1:0});
    `}}var S=e(50481),O=e(47311);const j="dashboards_dspicker_clicked",B={OPEN_DROPDOWN:"open_dspicker",SELECT_DS:"select_ds",ADD_FILE:"add_file",OPEN_ADVANCED_DS_PICKER:"open_advanced_ds_picker",CONFIG_NEW_DS_EMPTY_STATE:"config_new_ds_empty_state"};function N(H){const{current:z,onChange:G,hideTextValue:M=!1,width:Q,inputId:Y,noDefault:q=!1,disabled:te=!1,placeholder:X="Select data source",...ee}=H,ne=(0,c.of)(I,H),[Z,ae]=(0,d.useState)(!1),[re,se]=(0,d.useState)(!1),[de,le]=(0,d.useState)(""),{onKeyDown:he,keyboardEvents:ie}=(0,x.d)(),J=(0,d.useRef)(null),[ce,pe]=(0,d.useState)(),[Pe,Ie]=(0,d.useState)(),ge=(0,C.ps)(z),Se=(0,C.ps)("-- Grafana --"),De=!z&&q?void 0:ge,Ke=de&&Z?(0,t.jsx)(A,{}):(0,t.jsx)(T,{dataSource:De}),Me=[(0,r.cY)(4),(0,r.Ej)({apply({availableHeight:je,elements:ue}){ue.floating.style.maxHeight=`${Math.max(200,je-20)}px`,ue.floating.style.minHeight="200px"}}),(0,r.UU)({fallbackStrategy:"initialPlacement",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:be,floatingStyles:we}=(0,s.we)({open:Z,placement:"bottom-start",onOpenChange:ae,middleware:Me,whileElementsMounted:a.ll,strategy:"fixed"}),Be=(0,d.useCallback)(je=>{be.setReference(je),pe(je)},[be]),He=(0,d.useCallback)(()=>{le(""),ae(!1),ce?.focus()},[ae,ce]),{overlayProps:Ve,underlayProps:Je}=(0,l.e)({onClose:He,isDismissable:!0,isOpen:Z,shouldCloseOnInteractOutside:je=>ce?!ce.isSameNode(je):!1},J),{dialogProps:nt}=(0,g.s)({"aria-label":"Opened data source picker list"},J);function pt(){(0,u.rR)(j,{item:B.OPEN_DROPDOWN}),ae(!0),ce?.focus()}function bt(){Se&&G(Se,[E.dx])}function Tt(je){je.key==="Tab"&&!je.shiftKey&&Z&&(je.preventDefault(),Pe?.focus()),je.key==="Tab"&&je.shiftKey&&Z&&He(),he(je)}function ye(je){je.shiftKey?(je.preventDefault(),ce?.focus()):He()}return(0,d.useEffect)(()=>{const je=ie.subscribe({next:ue=>{switch(ue?.code){case"ArrowDown":pt(),ue.preventDefault();break;case"ArrowUp":pt(),ue.preventDefault();break;case"Escape":He(),ue.preventDefault();break}}});return()=>je.unsubscribe()}),(0,t.jsxs)("div",{className:ne.container,"data-testid":o.Tp.components.DataSourcePicker.container,children:[(0,t.jsx)("div",{className:ne.trigger,onClick:pt,children:(0,t.jsx)(p.p,{id:Y||"data-source-picker",className:re?void 0:ne.input,"data-testid":o.Tp.components.DataSourcePicker.inputV2,"aria-label":"Select a data source",autoComplete:"off",prefix:De?Ke:void 0,suffix:(0,t.jsx)(h.I,{name:Z?"search":"angle-down"}),placeholder:M?"":(0,O.q7)(De)||X,onFocus:()=>{se(!0)},onBlur:()=>{se(!1)},onKeyDown:Tt,value:de,onChange:je=>{pt(),le(je.currentTarget.value)},ref:Be,disabled:te})}),Z?(0,t.jsxs)(y.ZL,{children:[(0,t.jsx)("div",{...Je}),(0,t.jsx)("div",{ref:J,...Ve,...nt,children:(0,t.jsx)(K,{...ee,style:we,ref:be.setFloating,footerRef:Ie,current:De,filterTerm:de,keyboardEvents:ie,onChange:(je,ue)=>{He(),je.uid!==De?.uid&&(G(je,ue),(0,u.rR)(j,{item:B.SELECT_DS,ds_type:je.type}))},onClose:He,onClickAddCSV:bt,onDismiss:He,onNavigateOutsiteFooter:ye})})]}):null]})}function I(H,z){return{container:(0,n.css)({position:"relative",cursor:z.disabled?"not-allowed":"pointer",width:H.spacing(z.width||"auto")}),trigger:(0,n.css)({cursor:"pointer",pointerEvents:z.disabled?"none":"auto"}),input:(0,n.css)({"input::placeholder":{color:z.disabled?H.colors.action.disabledText:H.colors.text.primary}})}}const K=d.forwardRef((H,z)=>{const{filterTerm:G,onChange:M,onClose:Q,onClickAddCSV:Y,current:q,filter:te}=H,X=(0,d.useCallback)(Z=>{M(Z)},[M]),ee=(0,d.useCallback)(()=>{Y?.(),Q(),(0,u.rR)(j,{item:B.ADD_FILE})},[Y,Q]),ne=(0,c.of)(w);return(0,t.jsxs)("div",{style:H.style,ref:z,className:ne.container,children:[(0,t.jsx)(f.E,{children:(0,t.jsx)(b.S,{...H,enableKeyboardNavigation:!0,className:ne.dataSourceList,current:q,onChange:X,filter:Z=>(te?te?.(Z):!0)&&(0,O.Zn)(Z,G),onClickEmptyStateCTA:()=>(0,u.rR)(j,{item:B.CONFIG_NEW_DS_EMPTY_STATE})})}),(0,t.jsx)(i.n1,{children:(0,t.jsx)(U,{...H,onClickAddCSV:ee,onChange:X,onNavigateOutsiteFooter:H.onNavigateOutsiteFooter})})]})});K.displayName="PickerContent";function w(H){return{container:(0,n.css)({display:"flex",flexDirection:"column",background:H.colors.background.primary,boxShadow:H.shadows.z3}),picker:(0,n.css)({background:H.colors.background.secondary}),dataSourceList:(0,n.css)({flex:1}),footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:H.spacing(1.5),borderTop:`1px solid ${H.colors.border.weak}`,backgroundColor:H.colors.background.secondary})}}function U({onClose:H,onChange:z,onClickAddCSV:G,...M}){const Q=(0,c.of)(W),Y=M.uploadFile&&m.Ay.featureToggles.editPanelCSVDragAndDrop,q=X=>{X.key==="Tab"&&M.onNavigateOutsiteFooter(X)},te=X=>{X.key==="Tab"&&X.shiftKey&&M.onNavigateOutsiteFooter(X)};return(0,t.jsxs)("div",{className:Q.footer,children:[(0,t.jsx)(v.$s,{children:({showModal:X,hideModal:ee})=>(0,t.jsxs)(P.$n,{size:"sm",variant:"secondary",fill:"text",onClick:()=>{H(),X(S.p,{reportedInteractionFrom:"ds_picker",tracing:M.tracing,dashboard:M.dashboard,mixed:M.mixed,metrics:M.metrics,type:M.type,annotations:M.annotations,variables:M.variables,alerting:M.alerting,pluginId:M.pluginId,logs:M.logs,filter:M.filter,uploadFile:M.uploadFile,current:M.current,onDismiss:ee,onChange:(ne,Z)=>{z(ne,Z),ee()}}),(0,u.rR)(j,{item:B.OPEN_ADVANCED_DS_PICKER})},ref:M.footerRef,onKeyDown:Y?te:q,children:[(0,t.jsx)(D.x6,{i18nKey:"data-source-picker.open-advanced-button",children:"Open advanced data source picker"}),(0,t.jsx)(h.I,{name:"arrow-right"})]})}),Y&&(0,t.jsx)(P.$n,{variant:"secondary",size:"sm",onClick:G,onKeyDown:q,children:"Add csv or spreadsheet"})]})}function W(H){return{footer:(0,n.css)({flex:0,display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",padding:H.spacing(1.5),borderTop:`1px solid ${H.colors.border.weak}`,backgroundColor:H.colors.background.secondary})}}},47311:(_,L,e)=>{"use strict";e.d(L,{Df:()=>s,Tj:()=>g,Zn:()=>i,q7:()=>a,tw:()=>l});var t=e(14792),n=e(36974),r=e(14678);function s(d,o){return!d||!o?!1:typeof o=="string"?d.uid===o:d.uid===o.uid}function a(d){if(d){if(typeof d=="string")return`${d} - not found`;if("name"in d)return d.name;if(d.uid)return`${d.uid} - not found`}}function g(d,o,u){return(p,h)=>{const y=p.name.toUpperCase(),f=h.name.toUpperCase();if(d&&s(p,d))return-1;if(d&&s(h,d))return 1;const v=o.indexOf(p.uid),P=o.indexOf(h.uid);if(v>-1&&v>P)return-1;if(P>-1&&P>v)return 1;const m=u.includes(p.uid),D=u.includes(h.uid);return m&&!D?-1:D&&!m||p.meta.builtIn&&!h.meta.builtIn?1:h.meta.builtIn&&!p.meta.builtIn||y<f?-1:1}}function i(d,o=""){return d.name.toLowerCase().includes(o.toLowerCase())}function l(d){if(!d.uid)return;const o=(0,t.UA)().getCurrent()?.uid??"";if(d.uid===r.uv)return(0,n.B1)(o);(0,n.dH)(o,d.uid)}},83883:(_,L,e)=>{"use strict";e.d(L,{I:()=>t});const t={List:"/datasources",Edit:"/datasources/edit/:uid",Dashboards:"/datasources/edit/:uid/dashboards",New:"/datasources/new"}},87282:(_,L,e)=>{"use strict";e.d(L,{Kr:()=>g,TX:()=>a,dR:()=>l,ps:()=>i});var t=e(96540),n=e(78685),r=e(19347);const s="grafana.features.datasources.components.picker.DataSourceDropDown.history";function a(){const[d=[],o]=(0,n.A)(s,[]),u=(0,t.useCallback)(c=>{c.meta.builtIn||(d.includes(c.uid)?(d.splice(d.findIndex(p=>c.uid===p),1),o([...d,c.uid])):o([...d,c.uid].slice(1,6)))},[d,o]);return[d,u]}function g(d){return(0,r.l)().getList(d)}function i(d){const o=(0,r.l)();return o.getInstanceSettings(d)}function l(d){const{keyboardEvents:o,containerRef:u}=d,c=(0,t.useRef)(0),p="data-role",h="keyboardSelectableItem",y={[p]:h},f=`[${p}="${h}"`,v="data-selectedItem",P=`[${v}="true"]`,m=(0,t.useCallback)(x=>{const E=u?.current?.querySelectorAll(f),C=E?.item(x%E?.length);E?.forEach(b=>b.setAttribute(v,"false")),C&&(C.scrollIntoView({block:"center"}),C.setAttribute(v,"true"))},[u,f]),D=(0,t.useCallback)(()=>{u?.current?.querySelector(P)?.querySelector("button")?.click()},[u,P]);return(0,t.useEffect)(()=>{if(!o)return;const x=o.subscribe({next:E=>{switch(E?.code){case"ArrowDown":{m(++c.current),E.preventDefault();break}case"ArrowUp":c.current=c.current>0?c.current-1:c.current,m(c.current),E.preventDefault();break;case"Enter":D();break}}});return()=>x.unsubscribe()},[o,m,D]),(0,t.useEffect)(()=>{const x=new MutationObserver(E=>{E.some(b=>b.addedNodes&&b.addedNodes.length>0||b.removedNodes&&b.removedNodes.length>0)&&m(0)});return u.current&&x.observe(u.current,{childList:!0}),()=>{x.disconnect()}},[u,f,m]),[y,P]}},36227:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>b,Bs:()=>o,C_:()=>h,E1:()=>g,Gc:()=>l,IJ:()=>v,Ks:()=>P,QZ:()=>D,TN:()=>a,Tk:()=>y,UP:()=>E,eB:()=>c,f$:()=>d,gZ:()=>i,jz:()=>s,lg:()=>x,qR:()=>m,rb:()=>p});var t=e(65307),n=e(19484);const r={dataSources:[],plugins:[],categories:[],dataSource:{},layoutMode:n.R.List,searchQuery:"",dataSourcesCount:0,dataSourceTypeSearchQuery:"",isLoadingDataSources:!1,isLoadingDataSourcePlugins:!1,dataSourceMeta:{},isSortAscending:!0},s=(0,t.VP)("dataSources/dataSourceLoaded"),a=(0,t.VP)("dataSources/dataSourcesLoad"),g=(0,t.VP)("dataSources/dataSourcesLoaded"),i=(0,t.VP)("dataSources/dataSourceMetaLoaded"),l=(0,t.VP)("dataSources/dataSourcePluginsLoad"),d=(0,t.VP)("dataSources/dataSourcePluginsLoaded"),o=(0,t.VP)("dataSources/setDataSourcesSearchQuery"),u=(0,t.VP)("dataSources/setDataSourcesLayoutMode"),c=(0,t.VP)("dataSources/setDataSourceTypeSearchQuery"),p=(0,t.VP)("dataSources/setDataSourceName"),h=(0,t.VP)("dataSources/setIsDefault"),y=(0,t.VP)("dataSources/setIsSortAscending"),f=(T=r,A)=>a.match(A)?{...T,isLoadingDataSources:!0}:g.match(A)?{...T,isLoadingDataSources:!1,dataSources:A.payload,dataSourcesCount:A.payload.length}:s.match(A)?{...T,dataSource:A.payload}:o.match(A)?{...T,searchQuery:A.payload}:u.match(A)?{...T,layoutMode:A.payload}:l.match(A)?{...T,plugins:[],isLoadingDataSourcePlugins:!0}:d.match(A)?{...T,plugins:A.payload.plugins,categories:A.payload.categories,isLoadingDataSourcePlugins:!1}:c.match(A)?{...T,dataSourceTypeSearchQuery:A.payload}:i.match(A)?{...T,dataSourceMeta:A.payload}:p.match(A)?{...T,dataSource:{...T.dataSource,name:A.payload}}:h.match(A)?{...T,dataSource:{...T.dataSource,isDefault:A.payload}}:y.match(A)?{...T,isSortAscending:A.payload}:T,v={testingStatus:{},loadError:null,loading:!0,plugin:null},P=(0,t.VP)("dataSourceSettings/initDataSourceSettingsSucceeded"),m=(0,t.VP)("dataSourceSettings/initDataSourceSettingsFailed"),D=(0,t.VP)("dataSourceSettings/testDataSourceStarting"),x=(0,t.VP)("dataSourceSettings/testDataSourceSucceeded"),E=(0,t.VP)("dataSourceSettings/testDataSourceFailed"),b={dataSources:f,dataSourceSettings:(T=v,A)=>P.match(A)?{...T,plugin:A.payload,loadError:null,loading:!1}:m.match(A)?{...T,plugin:null,loadError:A.payload.message,loading:!1}:D.match(A)?{...T,testingStatus:{message:"Testing... this could take up to a couple of minutes",status:"info"}}:x.match(A)?{...T,testingStatus:{status:A.payload?.status,message:A.payload?.message,details:A.payload?.details}}:E.match(A)?{...T,testingStatus:{status:"error",message:A.payload?.message,details:A.payload?.details}}:T}},38074:()=>{"use strict"},25148:(_,L,e)=>{"use strict";e.d(L,{n:()=>f});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(55852),g=e(39268),i=e(14186),l=e(10354),d=e(95868),o=e(13840),u=e(40321),c=e(47694),p=e(21813),h=e(80744),y=e(19448);const f=m=>{const{value:D,src:x,name:E,placeholder:C,onChange:b,onClear:T,mediaType:A,folderName:R,size:S,color:O,maxFiles:j}=m,B=(0,s.of)(P),N=(0,s.$j)(),I=(0,r.createRef)(),K=(0,t.jsx)(y.i,{onChange:b,value:D,mediaType:A,folderName:R,maxFiles:j});let w=x;!w&&D&&(w=(0,p.D)(D));const U=O&&{fill:N.visualization.getColorByName(O)},W=()=>D&&w?(0,t.jsx)(c.y,{src:w,className:B.icon,style:{...U}}):(0,t.jsx)(a.z9,{variant:"primary",fill:"text",size:"sm",children:"Set icon"}),H=()=>(0,t.jsx)(g.C,{children:(0,t.jsx)(i.I,{label:null,grow:!0,children:(0,t.jsx)(l.p,{value:v(x,E),placeholder:C,readOnly:!0,prefix:w&&(0,t.jsx)(c.y,{src:w,className:B.icon,style:{...U}}),suffix:(0,t.jsx)(a.$n,{icon:"times",variant:"secondary",fill:"text",size:"sm",onClick:T})})})});return(0,t.jsx)(d.I,{content:K,children:(z,G,M)=>(0,t.jsxs)(t.Fragment,{children:[I.current&&(0,t.jsx)(o.A,{...M,referenceElement:I.current,onMouseEnter:z,onKeyDown:Q=>{(0,u.Q)(Q,G)}}),(0,t.jsxs)("div",{ref:I,className:B.pointer,onClick:z,onKeyDown:Q=>{Q.key==="Enter"&&z()},role:"button",tabIndex:0,children:[S===h.Iy.SMALL&&W(),S===h.Iy.NORMAL&&H()]})]})})};function v(m,D){if(m?.startsWith("public/img/icons")){const x=D?.lastIndexOf(".svg")??0;if(x>0)return D.substring(0,x)}return D}const P=m=>({pointer:(0,n.css)`
    cursor: pointer;
    input[readonly] {
      cursor: pointer;
    }
  `,icon:(0,n.css)`
    vertical-align: middle;
    display: inline-block;
    fill: currentColor;
    width: 25px;
  `})},19448:(_,L,e)=>{"use strict";e.d(L,{i:()=>w});var t=e(74848),n=e(32196),r=e(18828),s=e(85690),a=e(93225),g=e(96540),i=e(17172),l=e(40845),d=e(55852),o=e(2913),u=e(80744),c=e(88575),p=e(37270),h=e(47694);function y({secondaryText:W="Drag and drop here or browse"}){const H=(0,l.of)(v);return(0,t.jsxs)("div",{className:H.iconWrapper,children:[(0,t.jsx)("small",{className:H.small,children:W}),(0,t.jsx)(d.$n,{type:"button",icon:"upload",children:"Upload"})]})}const f=({mediaType:W,setFormData:H,setUpload:z,error:G})=>{const M=(0,l.of)(v),[Q,Y]=(0,g.useState)(!1),[q,te]=(0,g.useState)(""),X=()=>(0,t.jsx)(c.D,{label:"Preview",children:(0,t.jsxs)("div",{className:M.iconPreview,children:[W===u.zu.Icon&&(0,t.jsx)(h.y,{src:q,className:M.img}),W===u.zu.Image&&(0,t.jsx)("img",{src:q,alt:"Preview of the uploaded file",className:M.img})]})}),ee=Z=>{fetch(`/api/storage/delete/upload/${Z.file.name}`,{method:"DELETE"}).catch(ae=>console.error("cannot delete file",ae))},ne=W==="icon"?{"image/*":[".svg",".xml"]}:{"image/*":[".jpeg",".png",".gif",".webp"]};return(0,t.jsx)(p.gH,{readAs:"readAsBinaryString",onFileRemove:ee,options:{accept:ne,multiple:!1,onDrop:Z=>{let ae=new FormData;ae.append("file",Z[0]),te(URL.createObjectURL(Z[0])),Y(!0),H(ae),z(!0)}},children:G.message!==""&&Q?(0,t.jsx)("p",{children:G.message}):Q?(0,t.jsx)(X,{}):(0,t.jsx)(y,{})})};function v(W,H){return{container:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 100%;
    `,dropzone:(0,n.css)`
      display: flex;
      flex: 1;
      flex-direction: column;
      align-items: center;
      padding: ${W.spacing(6)};
      border-radius: 2px;
      border: 2px dashed ${W.colors.border.medium};
      background-color: ${H?W.colors.background.secondary:W.colors.background.primary};
      cursor: pointer;
    `,iconWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,acceptMargin:(0,n.css)`
      margin: ${W.spacing(2,0,1)};
    `,small:(0,n.css)`
      color: ${W.colors.text.secondary};
      margin-bottom: ${W.spacing(2)};
    `,iconContainer:(0,n.css)`
      display: flex;
      flex-direction: column;
      width: 80%;
      align-items: center;
      align-self: center;
    `,iconPreview:(0,n.css)`
      width: 238px;
      height: 198px;
      border: 1px solid ${W.colors.border.medium};
      display: flex;
      align-items: center;
      justify-content: center;
    `,img:(0,n.css)`
      width: 147px;
      height: 147px;
      fill: ${W.colors.text.primary};
    `}}var P=e(90182),m=e(67647),D=e(31193),x=e(70713),E=e(91793);const C=(0,g.memo)(function(H){const{columnIndex:z,rowIndex:G,style:M,data:Q}=H,{cards:Y,columnCount:q,onChange:te,selected:X}=Q,ee=z+G*q,ne=Y[ee],Z=(0,l.of)(T);return(0,t.jsx)("div",{style:M,children:ne&&(0,t.jsxs)("div",{className:X===ne.value?(0,n.cx)(Z.card,Z.selected):Z.card,onClick:()=>te(ne.value),onKeyDown:ae=>{ae.key==="Enter"&&te(ne.value)},role:"button",tabIndex:0,children:[ne.imgUrl.endsWith(".svg")?(0,t.jsx)(h.y,{src:ne.imgUrl,className:Z.img}):(0,t.jsx)("img",{src:ne.imgUrl,alt:"",className:Z.img}),(0,t.jsx)("h6",{className:Z.text,children:ne.label.slice(0,-4)})]},ne.value)})},E.t7),b=W=>{const{onChange:H,cards:z,value:G}=W,M=(0,l.of)(T);return(0,t.jsx)(x.Ay,{defaultWidth:680,children:({width:Q,height:Y})=>{const X=Math.floor(Q/90),ee=Math.ceil(z.length/X);return(0,t.jsx)(E.yi,{width:Q,height:Y,columnCount:X,columnWidth:90,rowCount:ee,rowHeight:90,itemData:{cards:z,columnCount:X,onChange:H,selected:G},className:M.grid,children:C})}})},T=W=>({card:(0,n.css)`
    display: inline-block;
    width: 90px;
    height: 90px;
    margin: 0.75rem;
    margin-left: 15px;
    text-align: center;
    cursor: pointer;
    position: relative;
    background-color: transparent;
    border: 1px solid transparent;
    border-radius: 8px;
    padding-top: 6px;
    :hover {
      border-color: ${W.colors.action.hover};
      box-shadow: ${W.shadows.z2};
    }
  `,selected:(0,n.css)`
    border: 2px solid ${W.colors.primary.main};
    :hover {
      border-color: ${W.colors.primary.main};
    }
  `,img:(0,n.css)`
    width: 40px;
    height: 40px;
    object-fit: cover;
    vertical-align: middle;
    fill: ${W.colors.text.primary};
  `,text:(0,n.css)`
    color: ${W.colors.text.primary};
    white-space: nowrap;
    font-size: 12px;
    text-overflow: ellipsis;
    display: block;
    overflow: hidden;
  `,grid:(0,n.css)`
    border: 1px solid ${W.colors.border.medium};
  `}),A=W=>W===u.zu.Icon?[u.Iu.Icon,u.Iu.IOT,u.Iu.Marker]:[u.Iu.BG],R=(W,H)=>W.find(z=>H.startsWith(z.value))??W[0],S=W=>{const{value:H,mediaType:z,folderName:G,newValue:M,setNewValue:Q,maxFiles:Y}=W,q=(0,l.of)(O),te=A(z).map(he=>({label:he,value:he})),[X,ee]=(0,g.useState)(),[ne,Z]=(0,g.useState)(R(te,H?.length?H:G)),[ae,re]=(0,g.useState)([]),[se,de]=(0,g.useState)([]),le=he=>{he?(he=he.toLowerCase(),de(ae.filter(ie=>ie.search.includes(he)))):de(ae)};return(0,g.useEffect)(()=>{const he=ne?.value;if(he){const ie=z===u.zu.Icon?J=>J.name.endsWith(".svg"):J=>J.name.endsWith(".png")||J.name.endsWith(".gif");(0,D.tR)().get("-- Grafana --").then(J=>{J.listFiles(he,Y).subscribe({next:ce=>{const pe=[];ce.forEach(Pe=>{if(ie(Pe)){const Ie=Pe.name.lastIndexOf(".");pe.push({value:`${he}/${Pe.name}`,label:Pe.name,search:(Ie?Pe.name.substring(0,Ie):Pe.name).toLowerCase(),imgUrl:`public/${he}/${Pe.name}`})}}),re(pe),de(pe)}})})}},[z,ne,Y]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.D,{children:(0,t.jsx)(P.l6,{options:te,onChange:Z,value:ne,menuShouldPortal:!1})}),(0,t.jsx)(c.D,{children:(0,t.jsx)(m.Z,{value:X??"",placeholder:"Search",onChange:he=>{le(he),ee(he)}})}),se&&(0,t.jsx)("div",{className:q.cardsWrapper,children:(0,t.jsx)(b,{cards:se,onChange:he=>Q(he),value:M})})]})},O=W=>({cardsWrapper:(0,n.css)`
    height: 30vh;
    min-height: 50px;
    margin-top: 5px;
    max-width: 680px;
  `});var j=e(10354),B=e(60029),N=e(21813);const I=W=>{const{newValue:H,setNewValue:z,mediaType:G}=W,M=(0,l.of)(K),Q=(0,N.D)(H);let Y=H?.substring(H.lastIndexOf("/")+1,H.lastIndexOf("."));return Y.length>20&&(Y=Y.substring(0,20)+"..."),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.D,{children:(0,t.jsx)(j.p,{onChange:q=>z(q.currentTarget.value),value:H})}),(0,t.jsxs)("div",{className:M.iconContainer,children:[(0,t.jsx)(c.D,{label:"Preview",children:(0,t.jsxs)("div",{className:M.iconPreview,children:[G===u.zu.Icon&&(0,t.jsx)(h.y,{src:Q,className:M.img}),G===u.zu.Image&&H&&(0,t.jsx)("img",{src:Q,alt:"Preview of the selected URL",className:M.img})]})}),(0,t.jsx)(B.J,{children:Y})]})]})},K=W=>({iconContainer:(0,n.css)`
    display: flex;
    flex-direction: column;
    width: 80%;
    align-items: center;
    align-self: center;
  `,iconPreview:(0,n.css)`
    width: 238px;
    height: 198px;
    border: 1px solid ${W.colors.border.medium};
    display: flex;
    align-items: center;
    justify-content: center;
  `,img:(0,n.css)`
    width: 147px;
    height: 147px;
    fill: ${W.colors.text.primary};
  `}),w=W=>{const{value:H,onChange:z,mediaType:G,folderName:M,maxFiles:Q}=W,Y=(0,l.of)(U),q=()=>{z(H)},te=(0,g.createRef)(),{dialogProps:X}=(0,r.s)({},te),{overlayProps:ee}=(0,a.e)({onClose:q,isDismissable:!0,isOpen:!0},te),ne=H&&H.includes("://"),[Z,ae]=(0,g.useState)(H??""),[re,se]=(0,g.useState)(ne?u.QC.URL:u.QC.Folder),[de,le]=(0,g.useState)(new FormData),[he,ie]=(0,g.useState)(!1),[J,ce]=(0,g.useState)({message:""}),pe=De=>`${Y.resourcePickerPopoverTab} ${re===De&&Y.resourcePickerPopoverActiveTab}`,Pe=()=>(0,t.jsx)(S,{value:H,mediaType:G,folderName:M,newValue:Z,setNewValue:ae,maxFiles:Q}),Ie=()=>(0,t.jsx)(I,{newValue:Z,setNewValue:ae,mediaType:G}),ge=()=>(0,t.jsx)(f,{mediaType:G,setFormData:le,setUpload:ie,newValue:Z,error:J}),Se=()=>{switch(re){case u.QC.Folder:return Pe();case u.QC.URL:return Ie();case u.QC.Upload:return ge();default:return Pe()}};return(0,t.jsx)(s.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,t.jsx)("section",{ref:te,...ee,...X,children:(0,t.jsxs)("div",{className:Y.resourcePickerPopover,children:[(0,t.jsxs)("div",{className:Y.resourcePickerPopoverTabs,children:[(0,t.jsx)("button",{className:pe(u.QC.Folder),onClick:()=>se(u.QC.Folder),children:"Folder"}),(0,t.jsx)("button",{className:pe(u.QC.URL),onClick:()=>se(u.QC.URL),children:"URL"})]}),(0,t.jsxs)("div",{className:Y.resourcePickerPopoverContent,children:[Se(),(0,t.jsxs)("div",{className:Y.buttonRow,children:[(0,t.jsx)(d.$n,{variant:"secondary",onClick:()=>q(),fill:"outline",children:"Cancel"}),(0,t.jsx)(d.$n,{variant:Z&&Z!==H?"primary":"secondary",onClick:()=>{he?fetch("/api/storage/upload",{method:"POST",body:de}).then(De=>{if(De.status>=400){De.json().then(Ke=>ce(Ke));return}else return De.json()}).then(De=>{(0,i.AI)().get(`api/storage/read/${De.path}`).then(()=>ae(`${o.$W.appUrl}api/storage/read/${De.path}`)).then(()=>z(`${o.$W.appUrl}api/storage/read/${De.path}`))}).catch(De=>console.error(De)):z(Z)},children:"Select"})]})]})]})})})},U=W=>({resourcePickerPopover:(0,n.css)`
    border-radius: ${W.shape.radius.default};
    box-shadow: ${W.shadows.z3};
    background: ${W.colors.background.primary};
    border: 1px solid ${W.colors.border.weak};
  `,resourcePickerPopoverTab:(0,n.css)`
    width: 50%;
    text-align: center;
    padding: ${W.spacing(1,0)};
    background: ${W.colors.background.secondary};
    color: ${W.colors.text.secondary};
    font-size: ${W.typography.bodySmall.fontSize};
    cursor: pointer;
    border: none;

    &:focus:not(:focus-visible) {
      outline: none;
      box-shadow: none;
    }

    :focus-visible {
      position: relative;
    }
  `,resourcePickerPopoverActiveTab:(0,n.css)`
    color: ${W.colors.text.primary};
    font-weight: ${W.typography.fontWeightMedium};
    background: ${W.colors.background.primary};
  `,resourcePickerPopoverContent:(0,n.css)`
    width: 315px;
    font-size: ${W.typography.bodySmall.fontSize};
    min-height: 184px;
    padding: ${W.spacing(1)};
    display: flex;
    flex-direction: column;
  `,resourcePickerPopoverTabs:(0,n.css)`
    display: flex;
    width: 100%;
    border-radius: ${W.shape.radius.default} ${W.shape.radius.default} 0 0;
  `,buttonRow:(0,n.css)({display:"flex",justifyContent:"center",gap:W.spacing(2),padding:W.spacing(1)})})},63577:(_,L,e)=>{"use strict";e.d(L,{MediaType:()=>t.zu,ResourceFolderName:()=>t.Iu,findField:()=>a.UI,findFieldIndex:()=>a.gG,getColorDimension:()=>g,getPublicOrAbsoluteUrl:()=>h.D,getResourceDimension:()=>h.$,getScalarDimension:()=>f.H,getScaledDimension:()=>l.hX,getScaledDimensionForField:()=>l.qx,getTextDimension:()=>c});var t=e(80744),n=e(8066),r=e(58563),s=e(57875),a=e(33924);function g(v,P,m){return i((0,a.UI)(v,P.field),P,m)}function i(v,P,m){if(!v){const E=m.visualization.getColorByName(P.fixed??"grey");return{isAssumed:!!P.field?.length||!P.fixed,fixed:E,value:()=>E,get:C=>E}}const D=(0,n.Qi)(v);if(D.isByValue||v.config.mappings?.length){const E=(0,r.xg)(v,!0);E!==v.config&&(v={...v,config:E},v.state=void 0);const C=(0,s.J)({field:v,theme:m}),b=T=>C(T).color??"#ccc";return{field:v,get:T=>b(v.values[T]),value:()=>b((0,a.sB)(v))}}const x=D.getCalculator(v,m)(0,0);return{fixed:x,value:()=>x,get:E=>x,field:v}}var l=e(18379),d=e(11261),o=e(83195),u=e(52622);function c(v,P){const m=P.field?(0,a.UI)(v,P.field):v?.fields.find(D=>D.type===d.PU.string);return p(m,P)}function p(v,P){let m=P.fixed;const D=P.mode??u.RU.Fixed;if(D===u.RU.Fixed)return{isAssumed:!m,fixed:m,value:()=>m,get:E=>m};if(D===u.RU.Template){const E=C=>`TEMPLATE[${P.fixed} // ${C}]`;return v?{field:v,get:C=>E(v.values[C]),value:()=>E((0,a.sB)(v))}:(m=E(""),{isAssumed:!0,fixed:m,value:()=>m,get:C=>m})}if(!v)return{isAssumed:!0,fixed:m,value:()=>m,get:E=>m};let x=E=>(0,o.cN)(v.display(E));return{field:v,get:E=>x(v.values[E]),value:()=>x((0,a.sB)(v))}}var h=e(21813),y=e(38074),f=e(26781)},21813:(_,L,e)=>{"use strict";e.d(L,{$:()=>s,D:()=>r});var t=e(52622),n=e(33924);function r(a){return a?a.indexOf(":/")>0?a:window.__grafana_public_path__+a:""}function s(a,g){const i=g.mode??t.q_.Fixed;if(i===t.q_.Fixed){const o=r(g.fixed);return{isAssumed:!o,fixed:o,value:()=>o,get:u=>o}}const l=(0,n.UI)(a,g.field);if(!l){const o="";return{isAssumed:!0,fixed:o,value:()=>o,get:u=>o}}if(i===t.q_.Mapping){const o=u=>r(`${u}`);return{field:l,get:u=>o(l.values[u]),value:()=>o((0,n.sB)(l))}}const d=o=>{if(l&&l.display){const u=l.display(o).icon;return r(u??"")}return""};return{field:l,get:o=>d(l.values[o]),value:()=>d((0,n.sB)(l))}}},26781:(_,L,e)=>{"use strict";e.d(L,{H:()=>r});var t=e(52622),n=e(33924);function r(a,g){return s((0,n.UI)(a,g?.field),g)}function s(a,g){if(!a){const d=g.fixed??0;return{isAssumed:!!g.field?.length||!g.fixed,fixed:d,value:()=>d,get:()=>d}}let i=d=>d%g.max;return g.mode===t.WQ.Clamped&&(i=d=>d<g.min?g.min:d>g.max?g.max:d),{field:a,get:d=>{const o=a.values[d];return o===null||typeof o!="number"?0:i(o)},value:()=>(0,n.sB)(a)}}},18379:(_,L,e)=>{"use strict";e.d(L,{Nn:()=>g,Ru:()=>i,hX:()=>s,qx:()=>a});var t=e(58563),n=e(52622),r=e(33924);function s(l,d){return a((0,r.UI)(l,d?.field),d)}function a(l,d,o){if(!l){const f=d.fixed??0;return{isAssumed:!!d.field?.length||!d.fixed,fixed:f,value:()=>f,get:()=>f}}const u=(0,t.AP)(l),c=d.max-d.min;if(l.values.length<1||c<=0||u.delta<=0)return{fixed:d.min,value:()=>d.min,get:()=>d.min};let h=f=>d.min+f*c;if(o===n.QH.Quad){const f=Math.PI*(d.max/2)**2,v=Math.PI*(d.min/2)**2,P=f-v;h=m=>{let D=v+P*m;return Math.sqrt(D/Math.PI)*2}}const y=f=>{const v=l.values[f];let P=0;return v!==-1/0&&(P=(v-u.min)/u.delta),P>1?P=1:P<0&&(P=0),h(P)};return{get:y,value:()=>y((0,r.sB)(l)),field:l}}function g(l){return l||(l={min:0,max:1}),l.min==null&&(l.min=0),l.max==null&&(l.max=1),l}function i(l,d){let{min:o,max:u}=g(d);if(l||(l={}),l.max==null&&(l.max=u),l.min==null&&(l.min=o),l.min>l.max){const c=l.max;l.max=l.min,l.min=c}return l.min<o&&(l.min=o),l.max>u&&(l.max=u),l.fixed==null&&(l.fixed=l.min+(l.max-l.min)/2),l.field||(l.fixed>u?l.fixed=u:l.fixed<o&&(l.fixed=o)),l}},80744:(_,L,e)=>{"use strict";e.d(L,{Iu:()=>r,Iy:()=>g,QC:()=>a,nG:()=>n,zu:()=>s});var t=e(52622);const n=Object.freeze({fixed:"",mode:t.RU.Field,field:""});var r=(i=>(i.Icon="img/icons/unicons",i.IOT="img/icons/iot",i.Marker="img/icons/marker",i.BG="img/bg",i))(r||{}),s=(i=>(i.Icon="icon",i.Image="image",i))(s||{}),a=(i=>(i.Folder="folder",i.URL="url",i.Upload="upload",i))(a||{}),g=(i=>(i.SMALL="small",i.NORMAL="normal",i))(g||{})},33924:(_,L,e)=>{"use strict";e.d(L,{B_:()=>d,UI:()=>u,Wb:()=>g,XV:()=>i,b5:()=>l,gG:()=>c,sB:()=>p,wv:()=>o});var t=e(28240),n=e(75059),r=e(32264),s=e(63577),a=e(26781);function g(h,y){if(h?.series&&y.field)for(const f of h.series){const v=(0,s.getColorDimension)(f,y,r.$.theme2);if(!v.isAssumed||h.series.length===1)return v}return(0,s.getColorDimension)(void 0,y,r.$.theme2)}function i(h,y){if(h?.series&&y.field)for(const f of h.series){const v=(0,s.getScaledDimension)(f,y);if(!v.isAssumed||h.series.length===1)return v}return(0,s.getScaledDimension)(void 0,y)}function l(h,y){if(h?.series&&y.field)for(const f of h.series){const v=(0,a.H)(f,y);if(!v.isAssumed||h.series.length===1)return v}return(0,a.H)(void 0,y)}function d(h,y){if(h?.series&&y.field)for(const f of h.series){const v=(0,s.getResourceDimension)(f,y);if(!v.isAssumed||h.series.length===1)return v}return(0,s.getResourceDimension)(void 0,y)}function o(h,y){if(h?.series&&y.field)for(const f of h.series){const v=(0,s.getTextDimension)(f,y);if(!v.isAssumed||h.series.length===1)return v}return(0,s.getTextDimension)(void 0,y)}function u(h,y){const f=c(y,h);return f==null?void 0:h.fields[f]}function c(h,y,f){if(!(!y||!h?.length))for(let v=0;v<y.fields.length;v++){const P=y.fields[v];if(h===P.name)return v;const m=(0,t.Ct)(P,y,f);if(h===m)return v}}function p(h){const y=h.state?.calcs;if(y){const P=y[n.gy.lastNotNull];if(P!=null)return P}const f=h.values;let v=f.length-1;for(;v>=0;){const P=f[v--];if(P!=null)return P}}},9791:(_,L,e)=>{"use strict";e.d(L,{k:()=>C});var t=e(74848),n=e(2543),r=e(96540),s=e(28528),a=e(24293),g=e(90708),i=e(28240),l=e(94624),d=e(24308),o=e(52622),u=e(40845),c=e(79041),p=e(41706),h=e(91126),y=e(33368),f=e(1932);function v(b,T,A){return(0,f.jM)(b,R=>{R.defaults.custom===void 0&&(R.defaults.custom={}),R.defaults.max=A;const{custom:S}=R.defaults;switch(S.stacking===void 0&&(S.stacking={group:"A"}),T){case"lines":S.drawStyle=o.GR.Line,S.stacking.mode=o.gs.None,S.fillOpacity=0;break;case"bars":S.drawStyle=o.GR.Bars,S.stacking.mode=o.gs.None,S.fillOpacity=100;break;case"points":S.drawStyle=o.GR.Points,S.stacking.mode=o.gs.None,S.fillOpacity=0;break;case"stacked_lines":S.drawStyle=o.GR.Line,S.stacking.mode=o.gs.Normal,S.fillOpacity=100,S.axisSoftMin=0;break;case"stacked_bars":S.drawStyle=o.GR.Bars,S.stacking.mode=o.gs.Normal,S.fillOpacity=100,S.axisSoftMin=0;break;default:{const O=T;throw new Error(`Invalid graph-style: ${O}`)}}})}function P(b,T,A){return(0,f.jM)(b,R=>{R.defaults.thresholds=A,R.defaults.custom=R.defaults.custom??{},R.defaults.custom.thresholdsStyle=T})}var m=e(56737),D=e(84596),x=e(21423);function E(b){const[T,{inc:A}]=(0,m.A)(1),R=(0,D.A)(b);return(0,r.useMemo)(()=>{R&&!(0,x.J3)(b,R,x.bW)&&A()},[b,R,A]),T}function C({data:b,height:T,width:A,timeZone:R,timeRange:S,onChangeTime:O,loadingState:j,annotations:B,onHiddenSeriesChanged:N,splitOpenFn:I,graphStyle:K,tooltipDisplayMode:w=o.$N.Single,anchorToZero:U=!1,yAxisMaximum:W,thresholdsConfig:H,thresholdsStyle:z,eventBus:G,vizLegendOverrides:M,toggleLegendRef:Q}){const Y=(0,u.$j)(),q=(0,r.useMemo)(()=>(0,s.O)((0,p.V)(p.S),"Explore"),[]),[te,X]=(0,r.useState)({defaults:{min:U?0:void 0,max:W||void 0,unit:"short",color:{mode:a.Y.PaletteClassic},custom:{drawStyle:o.GR.Line,fillOpacity:0,pointSize:5}},overrides:[]}),ee=(0,r.useMemo)(()=>{const J=v(te,K,W);return P(J,z,H)},[te,K,W,H,z]),ne=(0,y.h)(I,S),Z=(0,r.useMemo)(()=>(0,g.we)({fieldConfig:ee,data:b,timeZone:R,replaceVariables:J=>J,theme:Y,fieldConfigRegistry:q,dataLinkPostProcessor:ne}),[q,b,R,Y,ee,ne]),ae=(0,r.useMemo)(()=>(0,g.we)({fieldConfig:{defaults:{},overrides:[]},data:B,timeZone:R,replaceVariables:J=>J,theme:Y,dataLinkPostProcessor:ne}),[B,R,Y,ne]),re=E(Z),se=(0,r.useRef)(N),de=(0,r.useRef)(void 0);(0,r.useEffect)(()=>{if(se.current){const J=[];Z.forEach(ce=>{ce.fields.map(Pe=>Pe.config?.custom?.hideFrom?.viz).every(n.identity)&&J.push((0,i.Ri)(ce))}),(de.current===void 0||!(0,n.isEqual)((0,n.sortBy)(J),(0,n.sortBy)(de.current)))&&(de.current=J,se.current(J))}},[Z]);const le={eventsScope:"explore",eventBus:G,sync:()=>l.y.Off,onToggleSeriesVisibility(J,ce){X((0,h.M)(J,ce,te,b))},dataLinkPostProcessor:ne};function he(J,ce){X((0,h.M)(J,ce,te,b))}Q&&(Q.current=he);const ie=(0,r.useMemo)(()=>({tooltip:{mode:w,sort:o.xB.None},legend:{displayMode:o.lm.List,showLegend:!0,placement:"bottom",calcs:[],...M}}),[w,M]);return(0,t.jsx)(c.XF,{value:le,children:(0,t.jsx)(d.m,{data:{series:Z,timeRange:S,state:j,annotations:ae,structureRev:re},pluginId:"timeseries",title:"",width:A,height:T,onChangeTimeRange:O,timeZone:R,options:ie})})}},72519:(_,L,e)=>{"use strict";e.d(L,{y:()=>b});var t=e(74848),n=e(32196),r=e(96540),s=e(42941),a=e(40845),g=e(91052),i=e(14578),l=e(56034),d=e(55852),o=e(8484),u=e(34028),c=e(9791),p=e(94354),h=e(31678);const y=h.EXPLORE_GRAPH_STYLES.map(A=>({value:A,label:A[0].toUpperCase()+A.slice(1).replace(/_/," ")}));function f(A){const{graphStyle:R,onChangeGraphStyle:S}=A;return(0,t.jsx)(p.z,{size:"sm",options:y,value:R,onChange:S})}var v=e(33390);const P="grafana.explore.style.graph",m=A=>{store.set(P,A)},D=()=>E(v.A.get(P)),x="lines",E=A=>h.EXPLORE_GRAPH_STYLES.find(S=>S===A)??x,C=20,b=({data:A,eventBus:R,height:S,width:O,timeRange:j,timeZone:B,annotations:N,onChangeTime:I,splitOpenFn:K,thresholdsConfig:w,thresholdsStyle:U,loadingState:W,statusMessage:H})=>{const[z,G]=(0,s.A)(!1),[M,Q]=(0,r.useState)(D),Y=(0,a.of)(T),q=(0,r.useCallback)(X=>{(0,u.ng)(X),Q(X)},[]),te=(0,r.useMemo)(()=>z?A:A.slice(0,C),[A,z]);return(0,t.jsx)(g.NR,{title:(0,o.t)("graph.container.title","Graph"),titleItems:[!z&&C<A.length&&(0,t.jsxs)("div",{className:Y.timeSeriesDisclaimer,children:[(0,t.jsxs)("span",{className:Y.warningMessage,children:[(0,t.jsx)(i.I,{name:"exclamation-triangle","aria-hidden":"true"}),(0,t.jsxs)(o.x6,{i18nKey:"graph.container.show-only-series",children:["Showing only ",{MAX_NUMBER_OF_TIME_SERIES:C}," series"]})]}),(0,t.jsx)(l.m,{content:(0,o.t)("graph.container.content","Rendering too many series in a single panel may impact performance and make data harder to read. Consider refining your queries."),children:(0,t.jsx)(d.$n,{variant:"secondary",size:"sm",onClick:G,children:(0,t.jsxs)(o.x6,{i18nKey:"graph.container.show-all-series",children:["Show all ",{length:A.length}]})})})]},"disclaimer")].filter(Boolean),width:O,height:S,loadingState:W,statusMessage:H,actions:(0,t.jsx)(f,{graphStyle:M,onChangeGraphStyle:q}),children:(X,ee)=>(0,t.jsx)(c.k,{graphStyle:M,data:te,height:ee,width:X,timeRange:j,onChangeTime:I,timeZone:B,annotations:N,splitOpenFn:K,loadingState:W,thresholdsConfig:w,thresholdsStyle:U,eventBus:R})})},T=A=>({timeSeriesDisclaimer:(0,n.css)({label:"time-series-disclaimer",display:"flex",alignItems:"center",gap:A.spacing(1)}),warningMessage:(0,n.css)({display:"flex",alignItems:"center",gap:A.spacing(.5),color:A.colors.warning.main,fontSize:A.typography.bodySmall.fontSize})})},9651:(_,L,e)=>{"use strict";e.d(L,{a:()=>i,d:()=>l});var t=e(74848),n=e(32196),r=e(75212),s=e(40845),a=e(9663);const g=(d,o)=>({valueNavigation:(0,n.css)`
      width: ${a.QH};
      font-weight: bold;
    `,valueNavigationWrapper:(0,n.css)`
      display: flex;
      justify-content: flex-end;
    `,itemLabelsWrap:(0,n.css)`
      ${o?"":`border-bottom: 1px solid ${d.colors.border.medium}`};
    `}),i=d=>d.includes(r.gs)?d.replace(r.gs,""):d,l=({valueLabels:d,expanded:o})=>{const u=(0,s.of)(g,o);return(0,t.jsx)("div",{className:u.itemLabelsWrap,children:(0,t.jsx)("div",{className:u.valueNavigationWrapper,children:d.map((c,p)=>(0,t.jsx)("span",{className:u.valueNavigation,children:i(c.name)},c.name))})})}},9663:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>D,QH:()=>y,Jd:()=>f});var t=e(74848),n=e(32196),r=e(73287),s=e(14110),a=e(40845),g=e(29158),i=e(9651),l=e(57408);const d=(x,E)=>({rowWrapper:(0,n.css)`
    position: relative;
    min-width: ${y};
    padding-right: 5px;
  `,rowValue:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    display: block;
    padding-right: 10px;

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:before {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(to right, transparent calc(100% - 25px), ${x.colors.background.primary});
    }
  `,rowValuesWrap:(0,n.css)`
    padding-left: ${f};
    width: calc(${E} * ${y});
    display: flex;
  `}),o=({totalNumberOfValues:x,values:E,hideFieldsWithoutValues:C})=>{const b=(0,a.of)(d,x);return(0,t.jsx)("div",{role:"cell",className:b.rowValuesWrap,children:E?.map(T=>C&&(T.value===void 0||T.value===l.M)?null:(0,t.jsx)("span",{className:b.rowWrapper,children:(0,t.jsx)("span",{className:b.rowValue,children:T.value})},T.key))})},u=x=>{const E=x.isDark?"#ce9178":"#a31515",C=x.isDark?"#73bf69":"#56a64b";return{metricName:(0,n.css)`
      color: ${C};
    `,metricValue:(0,n.css)`
      color: ${E};
    `,expanded:(0,n.css)`
      display: block;
      text-indent: 1em;
    `}},p=({value:x,index:E,length:C,isExpandedView:b})=>{const T=(0,a.of)(u),A=x.key,R=x.value;return(0,t.jsxs)("span",{className:b?T.expanded:"",children:[(0,t.jsx)("span",{className:T.metricName,children:A}),(0,t.jsx)("span",{children:"="}),(0,t.jsx)("span",{children:'"'}),(0,t.jsx)("span",{className:T.metricValue,children:R}),(0,t.jsx)("span",{children:'"'}),E<C-1&&(0,t.jsx)("span",{children:", "})]},E)},h="20px",y="80px",f="25px",v=(x,E,C)=>({rowWrapper:(0,n.css)`
    border-bottom: 1px solid ${x.colors.border.medium};
    display: flex;
    position: relative;
    padding-left: 22px;
    ${C?"":"align-items: center;"}
    ${C?"":"height: 100%;"}
  `,copyToClipboardWrapper:(0,n.css)`
    position: absolute;
    left: 0;
    ${C?"":"bottom: 0;"}
    ${C?"top: 4px;":"top: 0;"}
    margin: auto;
    z-index: 1;
    height: 16px;
    width: 16px;
  `,rowLabelWrapWrap:(0,n.css)`
    position: relative;
    width: calc(100% - (${E} * ${y}) - ${f});
  `,rowLabelWrap:(0,n.css)`
    white-space: nowrap;
    overflow-x: auto;
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
    padding-right: ${h};

    &::-webkit-scrollbar {
      display: none; /* Chrome, Safari and Opera */
    }

    &:after {
      pointer-events: none;
      content: '';
      width: 100%;
      height: 100%;
      position: absolute;
      left: 0;
      top: 0;
      background: linear-gradient(
        to right,
        transparent calc(100% - ${h}),
        ${x.colors.background.primary}
      );
    }
  `});function P(x){let E=[],C=[];for(const b in x)b in x&&x[b]&&!b.includes("Value")?E.push({key:b,value:x[b]}):b in x&&x[b]&&b.includes("Value")&&C.push({key:b,value:x[b]});return{values:C,attributeValues:E}}const D=({listItemData:x,listKey:E,totalNumberOfValues:C,valueLabels:b,isExpandedView:T})=>{const{__name__:A,...R}=x,[S,O]=(0,r.A)(),j=b?.length??C,B=(0,a.of)(v,j,T),{values:N,attributeValues:I}=P(R),K=W=>W==="\u221E"||W==="Infinity"?"+Inf":W,w=`${A}{${I.map(W=>`${W.key}="${K(W.value)}"`)}}`,U=!!(b&&b?.length);return(0,t.jsxs)(t.Fragment,{children:[b!==void 0&&T&&(0,t.jsx)(i.d,{valueLabels:b,expanded:T}),(0,t.jsxs)("div",{className:B.rowWrapper,children:[(0,t.jsx)("span",{className:B.copyToClipboardWrapper,children:(0,t.jsx)(g.K,{tooltip:"Copy to clipboard",onClick:()=>{(0,s.rR)("grafana_explore_prometheus_instant_query_ui_raw_toggle_expand"),O(w)},name:"copy"})}),(0,t.jsx)("span",{role:"cell",className:B.rowLabelWrapWrap,children:(0,t.jsxs)("div",{className:B.rowLabelWrap,children:[(0,t.jsx)("span",{children:A}),(0,t.jsx)("span",{children:"{"}),(0,t.jsx)("span",{children:I.map((W,H)=>(0,t.jsx)(p,{isExpandedView:T,value:W,index:H,length:I.length},H))}),(0,t.jsx)("span",{children:"}"})]})}),(0,t.jsx)(o,{hideFieldsWithoutValues:U,totalNumberOfValues:j,values:N})]},E)]})}},57408:(_,L,e)=>{"use strict";e.d(L,{E:()=>r,M:()=>n});var t=e(83195);const n=" ",r=s=>{const a={},g=[],i=s.fields.filter(o=>!["Time"].includes(o.name));let l=i.find(o=>o.name==="__name__")?.values??[];!l.length&&i.length&&i[0].values.length&&(l=Array(i[0].values.length).fill(""));const d=s.fields.filter(o=>!["__name__"].includes(o.name));return l.forEach(function(o,u){a[o]={};const c=a[o][u]??{};for(const p of d){const h=p.name;if(h!=="Time")if(typeof p?.display=="function"){const y=p?.display(p.values[u]);if(!isNaN(y.numeric))c[h]=y.numeric.toString(10);else{const f=(0,t.cN)(y);f?c[h]=f:h.includes("Value #")&&(c[h]=n)}}else console.warn("Field display method is missing!")}g.push({...c,__name__:o})}),g}},97814:(_,L,e)=>{"use strict";e.d(L,{g:()=>r});var t=e(74848),n=e(47232);const r=({timeInMs:a,className:g,humanize:i})=>(0,t.jsx)("span",{className:g,children:s(a,i)}),s=(a,g=!1)=>{const i=a/1e3;if(!g)return`${i.toFixed(1)}s`;const l=(0,n.Ah)(i,"seconds"),d=l.hours(),o=l.minutes(),u=l.seconds();return d?`${d}h ${o}m ${u}s`:o?`${o}m ${u}s`:`${u}s`}},11140:(_,L,e)=>{"use strict";e.d(L,{v:()=>B});var t=e(74848),n=e(2543),r=e(96540),s=e(49785),a=e(71733),g=e(14110),i=e(39601),l=e(32264),d=e(88575),o=e(94354),u=e(42418),c=e(37390),p=e(55852),h=e(59429),y=e(16233),f=e(20470),v=e(31678),P=e(9955),m=e(28676),D=e(71176),x=(N=>(N.FETCH_DASHBOARD="fetch-dashboard",N.SET_DASHBOARD_LS="set-dashboard-ls-error",N))(x||{});function E(N,I){let K=[];return N==="table"&&I.panelState?.logs?.columns&&(I.panelState.logs?.labelFieldName&&K.push({id:"extractFields",options:{source:I.panelState.logs.labelFieldName}}),K.push({id:"organize",options:{indexByName:Object.values(I.panelState.logs.columns).reduce((w,U,W)=>({...w,[U]:W}),{}),includeByName:Object.values(I.panelState.logs.columns).reduce((w,U)=>({...w,[U]:!0}),{})}})),K}async function C(N){const I=A(N.queries,N.queryResponse,N?.panelState),K={targets:N.queries,type:I,title:"New Panel",gridPos:{x:0,y:0,w:12,h:8},datasource:N.datasource,transformations:E(I,N)};let w;if(N.dashboardUid)try{w=await(0,m.n)().getDashboardDTO(N.dashboardUid)}catch{throw"fetch-dashboard"}else w=await(0,D.X)();w.dashboard.panels=[K,...w.dashboard.panels??[]],w.dashboard.time=N.time;try{(0,f.OI)(w)}catch{throw"set-dashboard-ls-error"}}const b=N=>!N.hide,T=N=>I=>I.refId===N;function A(N,I,K){for(const{refId:w}of N.filter(b)){const U=T(w);if(I.flameGraphFrames.some(U))return"flamegraph";if(I.graphFrames.some(U))return"timeseries";if(I.logsFrames.some(U))return K?.logs?.visualisationType?K.logs.visualisationType:"logs";if(I.nodeGraphFrames.some(U))return"nodeGraph";if(I.traceFrames.some(U))return"traces";if(I.customFrames.some(U))return I.customFrames.find(U)?.meta?.preferredVisualisationPluginId??"table"}return"table"}var R=(N=>(N.NewDashboard="new-dashboard",N.ExistingDashboard="existing-dashboard",N))(R||{});function S(N){}function O(N){return N?`d/${N}`:"dashboard/new"}var j=(N=>(N.UNKNOWN="unknown-error",N.NAVIGATION="navigation-error",N))(j||{});function B(N){const{exploreId:I,onClose:K}=N,w=(0,v.useSelector)((0,P.qq)(I)),[U,W]=(0,r.useState)(),{handleSubmit:H,control:z,formState:{errors:G},watch:M}=(0,s.mN)({defaultValues:{saveTarget:"new-dashboard"}}),Q=y.TP.hasPermission(v.AccessControlAction.DashboardsCreate),Y=y.TP.hasPermission(v.AccessControlAction.DashboardsWrite),q=[];Q&&q.push({label:"New dashboard",value:"new-dashboard"}),Y&&q.push({label:"Existing dashboard",value:"existing-dashboard"});const te=q.length>1?M("saveTarget"):q[0].value,X=async(ee,ne)=>{W(void 0);const Z=ne.saveTarget==="existing-dashboard"?ne.dashboardUid:void 0;(0,g.rR)("e_2_d_submit",{newTab:ee,saveTarget:ne.saveTarget,queries:w.queries.length});const{from:ae,to:re}=w.range.raw;try{await C({dashboardUid:Z,datasource:w.datasourceInstance?.getRef(),queries:w.queries,queryResponse:w.queryResponse,panelState:w?.panelsState,time:{from:typeof ae=="string"?ae:ae.toISOString(),to:typeof re=="string"?re:re.toISOString()}})}catch(le){switch(le){case x.FETCH_DASHBOARD:W({error:le,message:"Could not fetch dashboard information. Please try again."});break;case x.SET_DASHBOARD_LS:W({error:le,message:"Could not add panel to dashboard. Please try again."});break;default:W({error:"unknown-error",message:"Something went wrong. Please try again."})}return}const se=O(Z);if(!ee){K(),i.Ny.push(a.I.stripBaseFromUrl(se));return}if(!!!e.g.open(l.$.appUrl+se,"_blank")){W({error:"navigation-error",message:"Could not navigate to the selected dashboard. Please try again."}),(0,f.yZ)();return}K()};return(0,r.useEffect)(()=>{(0,g.rR)("e_2_d_open")},[]),(0,t.jsxs)("form",{children:[q.length>1&&(0,t.jsx)(s.xI,{control:z,render:({field:{ref:ee,...ne}})=>(0,t.jsx)(d.D,{label:"Target dashboard",description:"Choose where to add the panel.",children:(0,t.jsx)(o.z,{options:q,...ne,id:"e2d-save-target"})}),name:"saveTarget"}),te==="existing-dashboard"&&(0,t.jsx)(s.xI,{render:({field:{ref:ee,value:ne,onChange:Z,...ae}})=>(0,t.jsx)(d.D,{label:"Dashboard",description:"Select in which dashboard the panel will be created.",error:G.dashboardUid?.message,invalid:!!G.dashboardUid,children:(0,t.jsx)(h.b,{...ae,inputId:"e2d-dashboard-picker",defaultOptions:!0,onChange:re=>Z(re?.uid)})}),control:z,name:"dashboardUid",shouldUnregister:!0,rules:{required:{value:!0,message:"This field is required."}}}),U&&(0,t.jsx)(u.F,{severity:"error",title:"Error adding the panel",children:U.message}),(0,t.jsxs)(c.a.ButtonRow,{children:[(0,t.jsx)(p.$n,{type:"reset",onClick:K,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(p.$n,{type:"submit",variant:"secondary",onClick:H((0,n.partial)(X,!0)),icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(p.$n,{type:"submit",variant:"primary",onClick:H((0,n.partial)(X,!1)),icon:"apps",children:"Open dashboard"})]})]})}},12881:(_,L,e)=>{"use strict";e.d(L,{t:()=>r});var t=e(16233),n=e(31678);function r(){const s=t.TP.hasPermission(n.AccessControlAction.DashboardsCreate),a=t.TP.hasPermission(n.AccessControlAction.DashboardsWrite);return s&&!a?"Add panel to new dashboard":a&&!s?"Add panel to existing dashboard":"Add panel to dashboard"}},24401:(_,L,e)=>{"use strict";e.d(L,{s:()=>i});var t=e(74848),n=e(71733),r=e(39601),s=e(37390),a=e(67061),g=e(55852);function i(l){const{onDismiss:d,path:o,title:u}=l,c=()=>{e.g.open(n.I.assureBaseUrl(o),"_blank"),d()},p=()=>r.Ny.push(o);return(0,t.jsxs)(s.a,{title:u,isOpen:!0,onDismiss:d,children:[(0,t.jsx)(a.B,{direction:"column",gap:1,children:(0,t.jsx)("p",{children:"Do you want to proceed in the current tab or open a new tab?"})}),(0,t.jsxs)(s.a.ButtonRow,{children:[(0,t.jsx)(g.$n,{onClick:d,fill:"outline",variant:"secondary",children:"Cancel"}),(0,t.jsx)(g.$n,{type:"submit",variant:"secondary",onClick:c,icon:"external-link-alt",children:"Open in new tab"}),(0,t.jsx)(g.$n,{type:"submit",variant:"primary",onClick:p,icon:"apps",children:"Open"})]})]})}},30973:(_,L,e)=>{"use strict";e.d(L,{w:()=>a});var t=e(74848),n=e(96540),r=e(38138),s=e(75462);function a({extensions:l,onSelect:d}){const{categorised:o,uncategorised:u}=i(l),c=u.length>0&&Object.keys(o).length>0;return(0,t.jsx)(r.W,{children:(0,t.jsxs)(t.Fragment,{children:[Object.keys(o).map(p=>(0,t.jsx)(r.W.Group,{label:(0,s.pL)(p,25),children:g(o[p],d)},p)),c&&(0,t.jsx)(r.W.Divider,{},"divider"),g(u,d)]})})}function g(l,d){return l.map(o=>(0,t.jsx)(r.W.Item,{ariaLabel:o.title,icon:o?.icon||"plug",label:(0,s.pL)(o.title,25),onClick:u=>{if(o.path)return d(o);o.onClick?.(u)}},o.id))}function i(l){return(0,n.useMemo)(()=>{const d=[],o={};for(const u of l){if(!u.category){d.push(u);continue}Array.isArray(o[u.category])||(o[u.category]=[]),o[u.category].push(u)}return{uncategorised:d,categorised:o}},[l])}},33368:(_,L,e)=>{"use strict";e.d(L,{h:()=>r});var t=e(96540),n=e(96192);const r=(s,a)=>(0,t.useMemo)(()=>(0,n.YV)(s,a),[s,a])},39590:(_,L,e)=>{"use strict";e.d(L,{m:()=>q,s:()=>X});var t=e(96540),n=e(76888),r=e(3169),s=e(31678),a=e(9955),g=e(34028);const i={parse:ee=>{if(!ee.left&&!ee.right)return{to:{left:{datasource:null,queries:[],range:{from:g.kn.from,to:g.kn.to}},schemaVersion:0},error:!1};let ne,Z,ae,re;return typeof ee.left=="string"&&([ne,ae]=u(ee.left)),typeof ee.right=="string"?[Z,re]=u(ee.right):ee.right&&(Z=o,re=!0),ne||(ne=o),{to:{schemaVersion:0,left:ne,...Z&&{right:Z}},error:!!ae||!!re}}},l=(ee,...ne)=>ne.some(Z=>ee.hasOwnProperty(Z));var d=(ee=>(ee[ee.RangeFrom=0]="RangeFrom",ee[ee.RangeTo=1]="RangeTo",ee[ee.Datasource=2]="Datasource",ee[ee.SegmentsStart=3]="SegmentsStart",ee))(d||{});const o={datasource:null,queries:[],range:g.kn};function u(ee){let ne;try{ne=JSON.parse(ee)}catch{return[o,!0]}if(!Array.isArray(ne))return[{queries:[],range:g.kn,...ne},!1];if(ne.length<=3)return[o,!0];const Z={from:ne[0],to:ne[1]},ae=ne[2],re=ne.slice(3),se=re.filter(le=>!l(le,"ui","mode","__panelsState")),de=re.find(le=>l(le,"__panelsState"))?.__panelsState;return[{datasource:ae,queries:se,range:Z,panelsState:de},!1]}var c=e(87490),p=e(15961);const h={parse:ee=>{if(!ee||!ee.panes||typeof ee.panes!="string")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:y}},error:!1};let ne;try{ne=JSON.parse(ee.panes)}catch{}if(ne==null||typeof ne!="object")return{to:{schemaVersion:1,panes:{[(0,c.o$)()]:y}},error:!0};const Z=Object.entries(ne).map(([ae,re])=>[ae,f(re)]).reduce((ae,[re,se])=>{let de=re;return(de.length!==3||/^\d+$/.test(de)||de.split("").some(le=>c.WP.indexOf(le)===-1))&&(de=(0,c.o$)()),{...ae,[de]:se}},{});return Object.keys(Z).length||(Z[(0,c.o$)()]=y),{to:{schemaVersion:1,panes:Z},error:!1}},migrate:ee=>({schemaVersion:1,panes:{[(0,c.o$)()]:ee.left,...ee.right&&{[(0,c.o$)()]:ee.right}}})},y={datasource:null,queries:[],range:g.kn};function f(ee){return!ee||typeof ee!="object"?y:{...y,...(0,p.C)("queries",ee)&&Array.isArray(ee.queries)&&{queries:ee.queries},...(0,p.C)("datasource",ee)&&typeof ee.datasource=="string"&&{datasource:ee.datasource},...(0,p.C)("panelsState",ee)&&!!ee.panelsState&&typeof ee.panelsState=="object"&&{panelsState:ee.panelsState},...(0,p.C)("range",ee)&&!!ee.range&&typeof ee.range=="object"&&(0,p.C)("from",ee.range)&&(0,p.C)("to",ee.range)&&typeof ee.range.from=="string"&&typeof ee.range.to=="string"&&{range:{from:ee.range.from,to:ee.range.to}}}}const v=ee=>m(ee),P=[i,h],m=ee=>{const ne=D(ee),[Z,...ae]=P.slice(ne),{error:re,to:se}=Z.parse(ee);return[ae.reduce((le,he)=>he.migrate?he.migrate(le):le,se),re]};function D(ee){return!ee||!("schemaVersion"in ee)||!ee.schemaVersion?0:typeof ee.schemaVersion=="number"?ee.schemaVersion:typeof ee.schemaVersion=="string"?Number.parseInt(ee.schemaVersion,10):0}var x=e(2543),E=e(18226),C=e(62860),b=e(62256),T=e(29436),A=e(23994),R=e(89224),S=e(27649),O=e(39070),j=e(41987),B=e(31193),N=e(14678);const I=(ee,ne)=>{const Z=!(0,x.isEqual)(ne?.datasource,ee?.datasource),ae=!(0,x.isEqual)(ne?.queries,ee?.queries),re=!(0,x.isEqual)(ne?.range||g.kn,ee?.range||g.kn),se=!(0,x.isEqual)(ne?.panelsState,ee?.panelsState);return{datasource:Z,queries:ae,range:re,panelsState:se}};async function K(ee,ne,Z){if(ee)try{return await(0,B.tR)().get(ee)}catch{}const ae=[...new Set(ne.map(re=>re.datasource).filter(O.zz).map(re=>typeof re=="string"?re:re.uid))];try{if(ae.length>=1){const re=(await Promise.allSettled(ae.map(se=>(0,B.tR)().get(se)))).filter(p.s);if(re.length>1)return await(0,B.tR)().get(N.uv);if(re.length===1)return await(0,B.tR)().get(ae[0])}}catch{}return(0,B.tR)().get((0,c.HQ)(Z)).catch(()=>(0,B.tR)().get()).catch(()=>{})}function w(ee){return{...ee.getDefaultQuery?.(j.Jk.Explore),refId:"A",datasource:ee.getRef()}}function U(ee){return ee.name===N.uv}function W(ee){return ee&&U(ee)?ne=>!!ne.datasource:ne=>ne.datasource?typeof ne.datasource=="string"?ne.datasource===ee?.uid||ne.datasource===ee?.name:ne.datasource.uid===ee?.uid:!0}async function H(ee){return(await Promise.allSettled(ee.map(Z=>(0,B.tR)().get(Z.datasource).then(ae=>({query:Z,ds:ae}))))).filter(p.s).map(({value:Z})=>Z.query)}function z(ee,ne,Z){const ae=Object.values(ee.panes);if(ae.length>1){const re=ae.some(({range:se},de,[{range:le}])=>!(0,x.isEqual)(se,le));Z((0,T.qz)({syncedTimes:!re}))}Object.entries(ee.panes).forEach(async([re,se],de)=>{const{datasource:le,queries:he,range:ie,panelsState:J}=se,ce=ne[re];if(ce!==void 0){const pe=I(se,q(ce));Promise.resolve().then(async()=>{pe.datasource&&le&&await Z((0,C.wh)({exploreId:re,datasource:le}))}).then(async()=>{pe.range&&Z((0,R.JA)({exploreId:re,rawRange:(0,g.Z9)(ie)})),pe.queries&&Z((0,A.h9)({exploreId:re,queries:(0,S.v)(he)})),(pe.queries||pe.range)&&(await Z((0,A.hS)(re)),Z((0,A.Od)({exploreId:re}))),pe.panelsState&&J&&Z((0,b.fx)({exploreId:re,panelsState:J}))})}else Z((0,b.Gd)({exploreId:re,datasource:le||"",queries:(0,S.v)(he),range:(0,g.Z9)(ie),panelsState:J,position:de,eventBridge:new E.o}))}),Object.keys(ne).filter(re=>!Object.keys(ee.panes).includes(re)).forEach(re=>Z((0,T.J8)(re)))}function G(ee,ne,Z,ae,re){ae((0,T.Ve)()),Promise.all(Object.entries(ee.panes).map(([se,{datasource:de,queries:le,range:he,panelsState:ie}])=>K(de,le,Z).then(J=>Promise.resolve(J?le.length?(0,S.v)(le).filter(W(J)).map(U(J)?x.identity:ce=>({...ce,datasource:J.getRef()})):(0,B.tR)().get(U(J)?void 0:J.getRef()).then(ce=>[w(ce)]):[]).then(async ce=>{let pe=await H(ce);return!pe.length&&J&&(pe=[w(U(J)?await(0,B.tR)().get():J)]),{exploreId:se,range:he,panelsState:ie,queries:pe,datasource:J}})))).then(async se=>{const de=await Promise.all(se.map(({exploreId:ce,range:pe,panelsState:Pe,queries:Ie,datasource:ge})=>ae((0,b.Gd)({exploreId:ce,datasource:ge,queries:Ie,range:(0,g.Z9)(pe),panelsState:Pe,eventBridge:new E.o})).unwrap()));if(de.length>1){const ce=de.some(({state:pe},Pe,[{state:Ie}])=>!(0,x.isEqual)(pe.range.raw,Ie.range.raw));ae((0,T.qz)({syncedTimes:!ce}))}const le=de.reduce((ce,{exploreId:pe,state:Pe})=>({...ce,[pe]:q(Pe)}),{}),he=re.getSearchObject();let ie={};for(const[ce,pe]of Object.entries(he).filter(([Pe])=>!["schemaVersion","panes","orgId","left","right"].includes(Pe)))ie[ce]=pe;const J=new URLSearchParams({schemaVersion:`${ee.schemaVersion}`,panes:JSON.stringify(le),orgId:`${Z}`,...ie});re.replace({pathname:re.getLocation().pathname,search:J.toString()}),ne.current="done"})}function M(ee,ne){return ee.current=C.wh.pending.type===ne.type,[T.J8.type,T.ve.fulfilled.type,A.Od.pending.type,R.eM.type,b.fx.type,C.wh.fulfilled.type].includes(ne.type)&&!ee.current}function Q(ee,ne,Z,ae){const re=Object.entries(ee.panes).reduce((se,[de,le])=>le?{...se,[de]:q(le)}:se,{});if(!(0,x.isEqual)(ne.current.panes,JSON.stringify(re))){const se=!!ne.current.panes&&Object.values(ne.current.panes).filter(Boolean).length===0||Z.current==="pending";ne.current={panes:JSON.stringify(re)},ae.partial({panes:ne.current.panes},se)}}var Y=e(76885);function q(ee){return{datasource:ee.datasourceInstance?.uid||"",queries:ee.queries.map(c.w4),range:(0,Y.sQ)(ee.range.raw),panelsState:te(ee.panelsState)}}function te(ee){let ne=(0,x.mapValues)(ee,Z=>(0,x.isObject)(Z)?te(Z):Z);if(ne=(0,x.omitBy)(ne,x.isEmpty),!(0,x.isEmpty)(ne))return ne}function X(ee){const{location:ne}=(0,n.Il)(),Z=(0,s.useDispatch)(),ae=(0,s.useSelector)(a.Qb),re=(0,t.useRef)(ae),se=(0,s.useSelector)(J=>J.user.orgId),de=(0,t.useRef)(ee),le=(0,t.useRef)("notstarted"),he=(0,t.useRef)(!1),{warning:ie}=(0,r._2)();(0,t.useEffect)(()=>{ee.panes||(le.current="notstarted",de.current=ee)},[ee]),(0,t.useEffect)(()=>{const J=Z((0,s.addListener)({predicate:ce=>M(he,ce),effect:async(ce,{cancelActiveListeners:pe,delay:Pe,getState:Ie})=>{pe(),await Pe(200),Q(Ie().explore,de,le,ne)}}));return()=>J()},[Z,ne]),(0,t.useEffect)(()=>{re.current=ae},[ae]),(0,t.useEffect)(()=>{const J=de.current?.panes!==ee.panes,[ce,pe]=v(ee);pe&&ie("Could not parse Explore URL","The requested URL contains invalid parameters, a default Explore state has been loaded."),!J&&le.current==="notstarted"&&(le.current="pending",G(ce,le,se,Z,ne)),de.current=ee,J&&le.current==="done"&&z(ce,re.current,Z)},[Z,se,ne,ee,ie])}},15961:(_,L,e)=>{"use strict";e.d(L,{C:()=>n,s:()=>t});const t=r=>r.status==="fulfilled";function n(r,s){return r in s}},324:(_,L,e)=>{"use strict";e.d(L,{M:()=>u,v:()=>p});var t=e(88483),n=e(19347),r=e(14110),s=e(82467),a=e(3169),g=e(18380),i=e(99140),l=e(62256),d=e(29436),o=e(23994);const u=h=>new t.c(y=>{const f=i.M_.getState().explore.panes[h]?.correlations;if(f)y.next(f),y.complete();else{const v=i.M_.subscribe(()=>{const P=i.M_.getState().explore.panes[h]?.correlations;P&&(v(),y.next(P),y.complete())})}});function c(h){return async(y,f)=>{const v=f().explore.panes[h];if(v.datasourceInstance?.uid!==void 0){let P=v.datasourceInstance.meta.mixed?v.queries.map(D=>D.datasource?.uid).filter(D=>D!==null):[v.datasourceInstance.uid];const m=await(0,g.J6)(P);y((0,l.Fb)({exploreId:h,correlations:m.correlations||[]}))}}}function p(h,y,f){return async(v,P)=>{const m=Object.keys(P().explore?.panes),D=P().explore?.panes[m[0]],x=P().explore?.panes[m[1]];if(!D||!x)return;const E=D.datasourceInstance?.meta.mixed?D.queries[0].datasource:D.datasourceInstance?.getRef(),C=x.datasourceInstance?.meta.mixed?x.queries[0].datasource:x.datasourceInstance?.getRef(),[b,T]=await Promise.all([(0,n.l)().get(E),(0,n.l)().get(C)]);if(b?.uid&&T?.uid&&x.correlationEditorHelperData?.resultField){const A={sourceUID:b.uid,targetUID:T.uid,label:h||await(0,g.tZ)(D,x),description:y,type:"query",config:{field:x.correlationEditorHelperData.resultField,target:x.queries[0],transformations:f}};await(0,g.$q)(b.uid,A).then(async()=>{v((0,d.J8)(m[1])),await v(c(m[0])),await v((0,o.Od)({exploreId:m[0]})),(0,r.rR)("grafana_explore_correlation_editor_saved",{sourceDatasourceType:b.type,targetDataSourceType:T.type})}).catch(R=>{v((0,s.dx)((0,a.gi)("Error creating correlation",R))),console.error(R)})}}}},62860:(_,L,e)=>{"use strict";e.d(L,{YR:()=>h,wh:()=>p});var t=e(65307),n=e(14110),r=e(11134),s=e(87490),a=e(18380),g=e(31678),i=e(57288),l=e(62256),d=e(23994),o=e(89224),u=e(34028);const c=(0,t.VP)("explore/updateDatasourceInstance"),p=(0,g.createAsyncThunk)("explore/changeDatasource",async({datasource:y,exploreId:f,options:v},{getState:P,dispatch:m})=>{const D=P().user.orgId,{history:x,instance:E}=await(0,u.BE)(D,y),C=P().explore.panes[f].datasourceInstance;(0,n.rR)("explore_change_ds",{from:(C?.meta?.mixed?"mixed":C?.type)||"unknown",to:E.meta.mixed?"mixed":E.type,exploreId:f}),m(c({exploreId:f,datasourceInstance:E,history:x}));const b=P().explore.panes[f].queries,T=(0,u.dq)(E.uid,b),A=await(0,a.J6)(T);m((0,l.Fb)({exploreId:f,correlations:A.correlations||[]})),v?.importQueries&&await m((0,d.y2)(f,b,C,E)),P().explore.panes[f].isLive&&m((0,o.hO)({exploreId:f,refreshInterval:r.cC.offOption.value})),v?.importQueries&&m((0,d.Od)({exploreId:f}))}),h=(y,f)=>{if(c.match(f)){const{datasourceInstance:v,history:P}=f.payload;return(0,s._u)(y.querySubscription),{...y,datasourceInstance:v,graphResult:null,tableResult:null,logsResult:null,supplementaryQueries:(0,i.Ez)(),queryResponse:(0,u.RA)(),queryKeys:[],history:P}}return y}},62256:(_,L,e)=>{"use strict";e.d(L,{EA:()=>c,Fb:()=>f,Gd:()=>P,LJ:()=>m,QZ:()=>v,fx:()=>u,nE:()=>p});var t=e(65307),n=e(87490),r=e(18380),s=e(32901),a=e(31678),g=e(62860),i=e(23994),l=e(89224),d=e(34028);const o=(0,t.VP)("explore/changeSize"),u=(0,t.VP)("explore/changePanels");function c(D,x,E){return async(C,b)=>{const T=b().explore.panes[D];if(T===void 0)return;const{panelsState:A}=T;C(u({exploreId:D,panelsState:{...A,[x]:E}}))}}const p=(0,t.VP)("explore/changeCorrelationHelperData"),h=(0,t.VP)("explore/initializeExploreAction"),y=(0,t.VP)("explore/setUrlReplaced"),f=(0,t.VP)("explore/saveCorrelationsAction");function v(D,{width:x}){return o({exploreId:D,width:x})}const P=(0,a.createAsyncThunk)("explore/initializeExplore",async({exploreId:D,datasource:x,queries:E,range:C,panelsState:b,correlationHelperData:T,eventBridge:A},{dispatch:R,getState:S,fulfillWithValue:O})=>{let j,B=[];if(x){const N=S().user.orgId,I=await(0,d.BE)(N,x);j=I.instance,B=I.history}if(R(h({exploreId:D,queries:E,range:(0,d.eO)(C,(0,s.O)(S().user)),datasourceInstance:j,history:B,eventBridge:A})),b!==void 0&&R(u({exploreId:D,panelsState:b})),R((0,l.JA)({exploreId:D})),j){const N=(0,d.dq)(j.uid,E),I=await(0,r.J6)(N);R(f({exploreId:D,correlations:I.correlations||[]})),R((0,i.Od)({exploreId:D}))}return T!==void 0&&S().explore.correlationEditorDetails?.editorMode&&R(p({exploreId:D,correlationEditorHelperData:T})),O({exploreId:D,state:S().explore.panes[D]})}),m=(D=(0,d.HZ)(),x)=>{if(D=(0,i.JQ)(D,x),D=(0,g.YR)(D,x),D=(0,l.QP)(D,x),o.match(x)){const E=x.payload.width;return{...D,containerWidth:E}}if(u.match(x)){const{panelsState:E}=x.payload;return{...D,panelsState:E}}if(p.match(x)){const{correlationEditorHelperData:E}=x.payload;return{...D,correlationEditorHelperData:E}}if(f.match(x))return{...D,correlations:x.payload.correlations};if(h.match(x)){const{queries:E,range:C,datasourceInstance:b,history:T,eventBridge:A}=x.payload;return{...D,range:C,queries:E,initialized:!0,eventBridge:A,queryKeys:(0,n.dY)(E),datasourceInstance:b,history:T,queryResponse:(0,d.RA)(),cache:[],correlations:[]}}return D}},72433:(_,L,e)=>{"use strict";e.d(L,{Bj:()=>v,H9:()=>d,PA:()=>y,Uu:()=>p,VM:()=>o,fP:()=>f,jX:()=>c,ri:()=>i,s1:()=>u,sh:()=>l,wk:()=>h});var t=e(65307),n=e(81523),r=e(11401),s=e(29436);const a=(0,t.VP)("explore/historyUpdated"),g=({updatedQuery:P,deletedId:m})=>async(D,x)=>{const E=x().explore.richHistory,C=E.map(T=>T.id===P?.id?P:T).filter(T=>T.id!==m),b=E.length-C.length;D((0,s.U2)({richHistoryResults:{richHistory:C,total:x().explore.richHistoryTotal-b}}))},i=(P,m,D,x,E)=>async(C,b)=>{const T=E?{quotaExceededError:!1,limitExceededWarning:!1,otherErrors:!1}:{quotaExceededError:!b().explore.richHistoryStorageFull,limitExceededWarning:!b().explore.richHistoryLimitExceededWarningShown},{richHistoryStorageFull:A,limitExceeded:R}=await(0,n.l0)({localOverride:P,datasource:{uid:m,name:D},queries:x,starred:!1,showNotif:T});E||(A&&C((0,s.fj)()),R&&C((0,s.D)()))},l=(P,m)=>async(D,x)=>{const E=await(0,n.oU)(P,m);D(g({updatedQuery:E}))},d=(P,m)=>async D=>{const x=await(0,n.cX)(P,m);D(g({updatedQuery:x}))},o=P=>async m=>{const D=await(0,n.NC)(P);m(g({deletedId:D}))},u=()=>async P=>{await(0,n.X1)(),P((0,s.U2)({richHistoryResults:{richHistory:[],total:0}})),P((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},c=()=>async(P,m)=>{const D=m().explore.richHistorySearchFilters;if(D){const x=await(0,n.DI)(D);P((0,s.U2)({richHistoryResults:x}))}},p=()=>async(P,m)=>{const D=m().explore.richHistorySearchFilters,x=m().explore.richHistory;if(D&&x){const E={...D,page:(D?.page||1)+1},C=await(0,n.DI)(E),b=[...x,...C.richHistory];P((0,s.Ju)({filters:E})),P((0,s.U2)({richHistoryResults:{richHistory:b,total:C.total}}))}},h=()=>async P=>{P((0,s.Ju)({filters:void 0})),P((0,s.U2)({richHistoryResults:{richHistory:[],total:0}}))},y=()=>async(P,m)=>{let D=m().explore.richHistorySettings;D||(D=await(0,n.Gx)(),P((0,s.bZ)(D)))},f=P=>async m=>{m((0,s.bZ)(P)),await(0,n.rs)(P)},v=P=>async(m,D)=>{await m((0,s.Ju)({filters:{...P}}));const x=D().explore.richHistorySettings;(0,r.gQ)().lastUsedDataSourcesAvailable&&await m(f({...x,lastUsedDatasourceFilters:P.datasourceFilters}))}},29436:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>B,D:()=>y,J8:()=>x,JA:()=>D,Ju:()=>v,U2:()=>p,Ve:()=>C,am:()=>A,bZ:()=>f,fj:()=>h,nD:()=>P,ow:()=>R,qz:()=>c,tP:()=>m,ve:()=>b});var t=e(65307),n=e(2543),r=e.n(n),s=e(18226),a=e(39601),g=e(87490),i=e(23989),l=e(31678),d=e(27649),o=e(62256),u=e(34028);const c=(0,t.VP)("explore/syncTimes"),p=(0,t.VP)("explore/richHistoryUpdated"),h=(0,t.VP)("explore/richHistoryStorageFullAction"),y=(0,t.VP)("explore/richHistoryLimitExceededAction"),f=(0,t.VP)("explore/richHistorySettingsUpdated"),v=(0,t.VP)("explore/richHistorySearchFiltersUpdatedAction"),P=(0,t.VP)("explore/splitSizeUpdateAction"),m=(0,t.VP)("explore/maximizePaneAction"),D=(0,t.VP)("explore/evenPaneResizeAction"),x=(0,t.VP)("explore/splitClose"),E=(0,t.VP)("explore/setPaneState"),C=(0,t.VP)("explore/clearPanes"),b=(0,l.createAsyncThunk)("explore/splitOpen",async(N,{getState:I,dispatch:K})=>{const w=Object.values(I().explore.panes)[0],U=N?.queries??w?.queries??[];Object.keys(I().explore.panes).forEach((z,G)=>{G>=1&&K(x(z))});const W=N?.range||w?.range.raw||u.kn;let H=(0,g.o$)();for(;I().explore.panes[H];)H=(0,g.o$)();await K(T({exploreId:H,datasource:N?.datasourceUid||w?.datasourceInstance?.getRef(),queries:(0,d.v)(U),range:W,panelsState:N?.panelsState||w?.panelsState,correlationHelperData:N?.correlationHelperData,eventBridge:new s.o})),w?.range&&await K(c({syncedTimes:(0,n.isEqual)(w.range.raw,W)}))}),T=(0,l.createAsyncThunk)("explore/createNewSplitOpen",async(N,{dispatch:I})=>{await I((0,o.Gd)(N))}),A=(0,t.VP)("explore/changeCorrelationEditorDetails"),R=(N,I)=>async K=>{const{timeRange:w,getExploreUrl:U,openInNewWindow:W}=I,H=await U({queries:N.targets,dsRef:N.datasource,scopedVars:N.scopedVars,timeRange:w,adhocFilters:(0,i.w)().getAdhocFilters(N.datasource?.uid??"",!0)});if(W&&H){W(H);return}a.Ny.push(H)},S=(0,u.HZ)(),O={syncedTimes:!1,panes:{},correlationEditorDetails:{editorMode:!1,correlationDirty:!1,queryEditorDirty:!1,isExiting:!1},richHistoryStorageFull:!1,richHistoryLimitExceededWarningShown:!1,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,richHistory:[]},B={explore:(N=O,I)=>{if(x.match(I)){const{[I.payload]:w,...U}={...N.panes};return{...N,panes:U,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0,syncedTimes:!1}}if(P.match(I)){const{largerExploreId:w}=I.payload;return{...N,largerExploreId:w,maxedExploreId:void 0,evenSplitPanes:w===void 0}}if(m.match(I)){const{exploreId:w}=I.payload;return{...N,largerExploreId:w,maxedExploreId:w,evenSplitPanes:!1}}if(D.match(I))return{...N,largerExploreId:void 0,maxedExploreId:void 0,evenSplitPanes:!0};if(c.match(I))return{...N,syncedTimes:I.payload.syncedTimes};if(h.match(I))return{...N,richHistoryStorageFull:!0};if(y.match(I))return{...N,richHistoryLimitExceededWarningShown:!0};if(f.match(I)){const w=I.payload;return{...N,richHistorySettings:w}}if(p.match(I)){const{richHistory:w,total:U}=I.payload.richHistoryResults;return{...N,richHistory:w,richHistoryTotal:U}}if(v.match(I)){const w=I.payload.filters;return{...N,richHistorySearchFilters:w}}if(T.pending.match(I))return{...N,panes:{...N.panes,[I.meta.arg.exploreId]:S}};if(o.Gd?.pending.match(I)){const w=Object.entries(N.panes),U=w.slice(0,I.meta.arg.position),W=w.slice(U.length),H=[...U,[I.meta.arg.exploreId,S],...W].reduce((z,[G,M])=>({...z,[G]:M}),{});return{...N,panes:H}}if(C.match(I))return{...N,panes:{}};if(A.match(I)){const{editorMode:w,label:U,description:W,canSave:H,correlationDirty:z,queryEditorDirty:G,isExiting:M,postConfirmAction:Q,transformations:Y}=I.payload;return{...N,correlationEditorDetails:{editorMode:!!(w??N.correlationEditorDetails?.editorMode),canSave:!!(H??N.correlationEditorDetails?.canSave),label:U??N.correlationEditorDetails?.label,description:W??N.correlationEditorDetails?.description,transformations:Y??N.correlationEditorDetails?.transformations,correlationDirty:!!(z??N.correlationEditorDetails?.correlationDirty),queryEditorDirty:!!(G??N.correlationEditorDetails?.queryEditorDirty),isExiting:!!(M??N.correlationEditorDetails?.isExiting),postConfirmAction:Q}}}const K=I.payload?.exploreId;return typeof K=="string"?{...N,panes:Object.entries(N.panes).reduce((w,[U,W])=>({...w,[U]:U===K?(0,o.LJ)(W,I):W}),{})}:N}}},23994:(_,L,e)=>{"use strict";e.d(L,{_0:()=>Tt,He:()=>ft,hS:()=>ye,bO:()=>Ee,IL:()=>_e,rR:()=>Ve,y2:()=>Ce,Az:()=>et,PD:()=>Ne,JQ:()=>dt,S6:()=>Te,Od:()=>fe,GI:()=>ot,q9:()=>nt,h1:()=>he,qk:()=>He,Rk:()=>Xe,h9:()=>we,TO:()=>it});var t=e(65307),n=e(32017),r=e.n(n),s=e(2543),a=e(49510),g=e(62467),i=e(58307),l=e(69862),d=e(99165),o=e(39070),u=e(73372),c=e(47232),p=e(9557),h=e(40187),y=e(26272),f=e(14236),v=e(80822),P=e(19347),m=e(32264),D=e(87490),x=e(80582),E=e(18380),C=e(31193),b=e(32901),T=e(13137),A=e(14678),R=e(31678),S=e(82467),O=e(3169),j=e(39374),B=e(81160),N=e(57875),I=e(91890),K=e(97522),w=e(11261),U=e(69147),W=e(91002),H=e(15162);const z=xe=>{const Oe=[],Le=[],Ze=[],qe=[],rt=[],vt=[],Ot=[],jt=[];for(const Ut of xe.series){if(ee(Ut)){jt.push(Ut);continue}switch(Ut.meta?.preferredVisualisationType){case"logs":qe.push(Ut);break;case"graph":Oe.push(Ut);break;case"trace":rt.push(Ut);break;case"table":Le.push(Ut);break;case"rawPrometheus":Ze.push(Ut);break;case"nodeGraph":vt.push(Ut);break;case"flamegraph":Ot.push(Ut);break;default:X(Ut)&&Oe.push(Ut),Le.push(Ut)}}return{...xe,graphFrames:Oe,tableFrames:Le,logsFrames:qe,traceFrames:rt,nodeGraphFrames:vt,customFrames:jt,flameGraphFrames:Ot,rawPrometheusFrames:Ze,graphResult:null,tableResult:null,logsResult:null,rawPrometheusResult:null}},G=({showCorrelationEditorLinks:xe,queries:Oe,correlations:Le,defaultTargetDatasource:Ze})=>qe=>{if(xe&&Ze)for(const rt of qe.series)for(const vt of rt.fields){vt.config.links=[],vt.display=vt.display||(0,N.H)();const Ot={};rt.fields.map(jt=>{Ot[`${jt.name}`]=`\${__data.fields.['${jt.name}']}`}),vt.config.links.push({url:"",origin:I.x0.ExploreCorrelationsEditor,title:`Correlate with ${vt.name}`,internal:{datasourceUid:Ze.uid,datasourceName:Ze.name,query:{datasource:{uid:Ze.uid}}},meta:{correlationData:{resultField:vt.name,vars:Ot,origVars:Ot}}})}else if(Oe?.length&&Le?.length){const rt=(0,s.mapValues)((0,s.groupBy)(Oe,"refId"),"0.datasource.uid");(0,E.cA)(qe.series,Le,rt)}return qe},M=xe=>xe.graphFrames.length?{...xe,graphResult:xe.graphFrames}:{...xe,graphResult:null},Q=xe=>{if(xe.tableFrames.length===0)return(0,g.of)({...xe,tableResult:null});xe.tableFrames.sort((qe,rt)=>{const vt=qe.refId,Ot=rt.refId;return vt>Ot?1:vt<Ot?-1:0});const Oe=xe.tableFrames.every(qe=>X(qe)),Le={interpolate:qe=>qe};return(Oe?(0,g.of)(xe.tableFrames).pipe(K.c.joinByFieldTransformer.operator({},Le)):(0,g.of)(xe.tableFrames).pipe(K.c.mergeTransformer.operator({},Le))).pipe((0,B.T)(qe=>{for(const rt of qe)for(const vt of rt.fields)vt.display=vt.display??(0,N.J)({field:vt,theme:m.$.theme2,timeZone:xe.request?.timezone??"browser"});return{...xe,tableResult:qe}}))},Y=xe=>{const Oe=xe.rawPrometheusFrames;if(!Oe||Oe.length===0)return(0,g.of)({...xe,tableResult:null});Oe.sort((rt,vt)=>{const Ot=rt.refId,jt=vt.refId;return Ot>jt?1:Ot<jt?-1:0});const Le=Oe.every(rt=>X(rt)),Ze={interpolate:rt=>rt};return(Le?(0,g.of)(Oe).pipe(K.c.joinByFieldTransformer.operator({},Ze)):(0,g.of)(Oe).pipe(K.c.mergeTransformer.operator({},Ze))).pipe((0,B.T)(rt=>{const vt=rt[0];for(const Ot of vt.fields)Ot.display=Ot.display??(0,N.J)({field:Ot,theme:m.$.theme2,timeZone:xe.request?.timezone??"browser"});return{...xe,rawPrometheusResult:vt}}))},q=(xe={})=>Oe=>{if(Oe.logsFrames.length===0)return{...Oe,logsResult:null};const Le=Oe.request?.intervalMs,Ze=(0,U.HT)(Oe.logsFrames,Le,xe.absoluteRange,xe.queries,xe.deduplicate),qe=(0,D.uE)(xe.refreshInterval),rt=(0,W.zy)(Ze,qe),vt=rt.rows,Ot=rt.series,jt={...rt,rows:vt,series:Ot};return{...Oe,logsResult:jt}};function te(xe,Oe,Le,Ze,qe,rt,vt){return(0,g.of)(xe).pipe((0,B.T)(Ot=>(0,f.N$)(Ot,Oe)),(0,B.T)(G({defaultTargetDatasource:vt,showCorrelationEditorLinks:rt,queries:Ze,correlations:qe})),(0,B.T)(z),(0,B.T)(M),(0,B.T)(Le),(0,l.Z)(Y),(0,l.Z)(Q))}function X(xe){const Oe=(0,s.groupBy)(xe.fields,Le=>Le.type);return!!(Object.keys(Oe).length===2&&Oe[w.PU.time]?.length===1&&Oe[w.PU.number])}function ee(xe){return xe.meta?.preferredVisualisationPluginId?(0,H.oZ)(xe.meta?.preferredVisualisationPluginId):!1}var ne=e(57288),Z=e(324),ae=e(62256),re=e(72433),se=e(29436),de=e(89224),le=e(34028);const he=xe=>Oe=>{const Le=Oe.explore.panes[xe];return Le&&Le.queryResponse?Le.queryResponse.state===o.Gu.Loading||Le.queryResponse.state===o.Gu.Streaming:!1},ie=(0,t.VP)("explore/addQueryRow"),J=(0,t.VP)("explore/changeQueries"),ce=(0,t.VP)("explore/cancelQueries"),pe=(0,t.VP)("explore/queriesImported"),Pe=(0,t.VP)("explore/queryStoreSubscription"),Ie=(0,t.VP)("explore/setSupplementaryQueryEnabledAction"),ge=(0,t.VP)("explore/storeSupplementaryQueryDataProviderAction"),Se=(0,t.VP)("explore/cleanSupplementaryQueryDataProviderAction"),De=(0,t.VP)("explore/cleanSupplementaryQueryAction"),Ke=(0,t.VP)("explore/storeSupplementaryQueryDataSubscriptionAction"),Me=(0,t.VP)("explore/updateSupplementaryQueryDataAction"),be=(0,t.VP)("explore/queryStreamUpdated"),we=(0,t.VP)("explore/setQueries"),Be=(0,t.VP)("changeLoadingState"),He=(0,t.VP)("explore/setPausedState"),Ve=(0,t.VP)("explore/clearLogs"),Je=(0,t.VP)("explore/scanStart"),nt=(0,t.VP)("explore/scanStop"),pt=(0,t.VP)("explore/addResultsToCache"),bt=(0,t.VP)("explore/clearCache");function Tt(xe,Oe){return async(Le,Ze)=>{const qe=Ze().explore.panes[xe];let rt;qe.datasourceInstance?.meta.mixed?rt=(0,s.findLast)(qe.queries,Ot=>!!Ot.datasource)?.datasource||void 0:rt=qe.datasourceInstance?.getRef();const vt=await(0,D.Ll)(qe.queries,Oe,rt);Le(ie({exploreId:xe,index:Oe,query:vt}))}}function ye(xe){return(Oe,Le)=>{Oe(nt({exploreId:xe})),Oe(ce({exploreId:xe}));const Ze=Le().explore.panes[xe].supplementaryQueries;for(const qe of ne.VW)Oe(Se({exploreId:xe,type:qe})),Ze[qe]?.data?.state!==o.Gu.Done&&Oe(De({exploreId:xe,type:qe}))}}const je=(xe,Oe)=>{const Le=xe.getRef();return Oe.map(Ze=>({...Ze,datasource:Le}))},ue=async(xe,Oe,Le)=>{let Ze=[];if(Oe.meta?.id===xe.meta?.id)Ze=Le;else if((0,u.Ee)(Oe)&&(0,u.FL)(xe)){const qe=await Oe.exportToAbstractQueries(Le);Ze=await xe.importFromAbstractQueries(qe)}else xe.importQueries&&(Ze=await xe.importQueries(Le,Oe));return je(xe,Ze)},Ee=(0,R.createAsyncThunk)("explore/changeQueries",async({queries:xe,exploreId:Oe},{getState:Le,dispatch:Ze})=>{let qe=!1;const rt=Le().explore.panes[Oe].queries,vt=Le().explore.panes[Oe].datasourceInstance?.uid,Ot=Le().explore.correlationEditorDetails,jt=Ot?.editorMode||!1;!(Object.keys(Le().explore.panes)[0]===Oe)&&jt&&!Ot?.queryEditorDirty&&Ze((0,se.am)({queryEditorDirty:!0}));for(const zt of xe)for(const qt of rt){if(zt.refId===qt.refId&&zt.datasource?.type!==qt.datasource?.type){const fn=await(0,P.l)().get(qt.datasource),Sn=await(0,P.l)().get({uid:zt.datasource?.uid});await Ze(Ce(Oe,rt,fn,Sn,zt.refId)),qe=!0}if(vt===A.uv&&zt.refId===qt.refId&&zt.datasource?.uid!==qt.datasource?.uid){const fn=(0,le.dq)(A.uv,xe),Sn=await(0,E.J6)(fn);Ze((0,ae.Fb)({exploreId:Oe,correlations:Sn.correlations||[]}))}}qe||Ze(J({queries:xe,exploreId:Oe})),xe.length<rt.length&&Ze(fe({exploreId:Oe}))}),Ce=(xe,Oe,Le,Ze,qe)=>async rt=>{if(!Le){rt(pe({exploreId:xe,queries:Oe}));return}let vt=Oe;if(Ze.uid===A.uv)vt=Oe.map(jt=>({...jt,datasource:Le.getRef()}));else if(Le.uid===A.uv){const jt=(0,s.groupBy)(Oe,zt=>zt.datasource?.uid),Ut=await Promise.all(Object.keys(jt).map(async zt=>{const qt=await(0,P.l)().get({uid:zt});return await ue(Ze,qt,jt[zt])}));vt=(0,s.flatten)(Ut.filter(zt=>zt.length>0))}else{let jt=Oe;if(qe!==void 0){const Ut=Oe.find(zt=>zt.refId===qe);Ut&&(jt=[Ut])}vt=await ue(Ze,Le,jt)}let Ot=await(0,D.di)(vt,Ze.getRef());if(qe!==void 0){vt.length===0&&(vt=[await(0,D.Ll)([],void 0,Ze.getRef())]);const jt=Oe.findIndex(zt=>zt.refId===qe),Ut={...Ot[0],refId:Oe[jt].refId};Ot=[...Oe],Ot[jt]=Ut}return rt(pe({exploreId:xe,queries:Ot})),Ot};function Ne(xe,Oe,Le){return async(Ze,qe)=>{const rt=qe().explore.panes[xe],{queries:vt}=rt,jt=(await Promise.all(vt.map(Ut=>Le({...Ut},Oe)))).map((Ut,zt)=>(0,D.eF)(Ut,vt,zt));Ze(we({exploreId:xe,queries:jt})),Oe.preventSubmit||Ze(fe({exploreId:xe}))}}function Fe(xe,Oe){if(!(xe.filterQuery&&!xe.filterQuery(Oe)))return Oe}async function Ue(xe,Oe,Le,Ze){const rt=(await Promise.all(Ze.map(async vt=>{if(vt.datasource?.uid===Le.uid)return Fe(Le,vt);{const Ot=await(0,C.tR)().get(vt.datasource);return Fe(Ot,vt)}}))).filter(vt=>!!vt);rt.length>0&&(xe((0,re.ri)(!0,Le.uid,Le.name,rt,m.$.queryHistoryEnabled)),m.$.queryHistoryEnabled&&xe((0,re.ri)(!1,Le.uid,Le.name,rt,!1)),await xe((0,re.jX)()))}const fe=(0,R.createAsyncThunk)("explore/runQueries",async({exploreId:xe,preserveCache:Oe},{dispatch:Le,getState:Ze})=>{Le(ye(xe));const{defaultCorrelationEditorDatasource:qe,scopedVars:rt,showCorrelationEditorLinks:vt}=await(0,le.aj)(Ze(),xe),Ot=(0,Z.M)(xe);Le((0,de.JA)({exploreId:xe})),Oe!==!0&&Le(_e(xe));const Ut=Ze().explore.panes[xe],{datasourceInstance:zt,containerWidth:qt,isLive:fn,range:Sn,scanning:An,queryResponse:Hn,querySubscription:es,refreshInterval:rs,absoluteRange:Zn,cache:kn,supplementaryQueries:Gn}=Ut;let Kn,yn;const wn=Ut.queries.map(bn=>({...bn,datasource:bn.datasource||zt?.getRef()}));zt!=null&&Ue(Le,Ze().explore,zt,wn);const Jn=(0,le.rk)(kn,Zn);if(Jn)Kn=(0,a.z)([(0,g.of)(Jn),Ot]).pipe((0,l.Z)(([bn,Pt])=>te(bn,Hn,q({absoluteRange:Zn,refreshInterval:rs,queries:wn}),wn,Pt,vt,qe))),yn=Kn.subscribe(bn=>{Le(be({exploreId:xe,response:bn}))});else{if(!(0,D.zT)(wn)||!zt)return;const bn=zt?.interval;(0,D._u)(es);const Pt={minInterval:bn,maxDataPoints:qt,liveStreaming:fn},Ft=(0,b.O)(Ze().user),Xt=(0,D.bI)(xe,wn,Pt,Sn,An,Ft,rt);if(Le(Be({exploreId:xe,loadingState:o.Gu.Loading})),Kn=(0,a.z)([(0,j.BN)(zt,Xt.request).pipe(fn?(0,d.c)(500):i.D),Ot]).pipe((0,l.Z)(([sn,on])=>te(sn,Hn,q({absoluteRange:Zn,refreshInterval:rs,queries:wn}),wn,on,vt,qe))),yn=Kn.subscribe({next(sn){const on=Ze().explore.panes[xe];if(Le(be({exploreId:xe,response:sn})),on.scanning)if(sn.state===o.Gu.Done&&sn.series.length===0){const xn=(0,x.Wb)(-1,on.range);Le((0,de.JA)({exploreId:xe,absoluteRange:xn})),Le(fe({exploreId:xe}))}else Le(nt({exploreId:xe}))},error(sn){Le((0,S.dx)((0,O.gi)("Query processing error",sn))),Le(Be({exploreId:xe,loadingState:o.Gu.Error})),console.error(sn)},complete(){Ze().explore.panes[xe].queryResponse.state===o.Gu.Loading&&Le(Be({exploreId:xe,loadingState:o.Gu.Done}))}}),fn)for(const sn of ne.VW)Le(Se({exploreId:xe,type:sn})),Le(De({exploreId:xe,type:sn}));else Le(Qe({exploreId:xe,datasourceInstance:zt,transaction:Xt,newQuerySource:Kn,supplementaryQueries:Gn,queries:wn,absoluteRange:Zn}))}Le(Pe({exploreId:xe,querySubscription:yn}))}),Te=(0,R.createAsyncThunk)("explore/runLoadMoreQueries",async({exploreId:xe,absoluteRange:Oe},{dispatch:Le,getState:Ze})=>{Le(ye(xe));const{datasourceInstance:qe,containerWidth:rt,queryResponse:vt}=Ze().explore.panes[xe],{defaultCorrelationEditorDatasource:Ot,scopedVars:jt,showCorrelationEditorLinks:Ut}=await(0,le.aj)(Ze(),xe),zt=(0,Z.M)(xe);let qt;const fn=vt.logsResult?.queries||[],Sn=vt.logsFrames.map(kn=>kn.refId),An=fn.filter(kn=>Sn.includes(kn.refId)).map(kn=>({...kn,datasource:kn.datasource||qe?.getRef(),refId:kn.refId,supportingQueryType:T.Q$.InfiniteScroll}));if(!(0,D.zT)(An)||!qe)return;const Hn={minInterval:qe?.interval,maxDataPoints:rt},es=(0,b.O)(Ze().user),rs=(0,D.zq)(es,{from:(0,c.oZ)(es,Oe.from),to:(0,c.oZ)(es,Oe.to)},(0,b.q)(Ze().user)),Zn=(0,D.bI)(xe,An,Hn,rs,!1,es,jt);Le(Be({exploreId:xe,loadingState:o.Gu.Loading})),qt=(0,a.z)([(0,j.BN)(qe,Zn.request),zt]).pipe((0,l.Z)(([kn,Gn])=>kn.state!==o.Gu.Done?(0,g.of)({...vt,state:o.Gu.Loading}):te((0,v._k)(vt,kn),vt,q({absoluteRange:Oe,queries:fn,deduplicate:!0}),An,Gn,Ut,Ot))),qt.subscribe({next(kn){Le(be({exploreId:xe,response:kn}))},error(kn){Le((0,S.dx)((0,O.gi)("Query processing error",kn))),Le(Be({exploreId:xe,loadingState:o.Gu.Error})),console.error(kn)},complete(){Le(Be({exploreId:xe,loadingState:o.Gu.Done}))}})}),Ge=async(xe,Oe)=>{const Le=xe.filter(qe=>qe.datasource?.uid!==A.uv),Ze=(0,s.groupBy)(Le,"datasource.uid");return await Promise.all(Object.values(Ze).map(async qe=>({datasource:await(0,P.l)().get(qe[0].datasource,Oe),targets:qe})))},Qe=(0,R.createAsyncThunk)("explore/handleSupplementaryQueries",async({datasourceInstance:xe,exploreId:Oe,transaction:Le,newQuerySource:Ze,supplementaryQueries:qe,queries:rt,absoluteRange:vt},{dispatch:Ot})=>{let jt;xe.meta.mixed?jt=await Ge(Le.request.targets,Le.request.scopedVars):jt=[{datasource:xe,targets:Le.request.targets}];for(const Ut of ne.VW){const zt=(0,ne.Pm)(jt,Ut,{...Le.request,requestId:`${Le.request.requestId}_${(0,s.snakeCase)(Ut)}`},Ze);zt?(Ot(ge({exploreId:Oe,type:Ut,dataProvider:zt})),st(qe[Ut].data,rt,vt)||(Ot(De({exploreId:Oe,type:Ut})),qe[Ut].enabled&&Ot(et(Oe,Ut)))):Ot(Se({exploreId:Oe,type:Ut}))}});function st(xe,Oe,Le){if(!xe)return!1;const Ze=(0,s.zipObject)((0,s.map)(Oe,"refId"),Oe),qe=(0,s.mapValues)((0,s.groupBy)(xe.data.map(jt=>jt.meta?.custom?.sourceQuery),"refId"),s.head),rt=xe.data.every(jt=>jt.meta?.custom?.logsVolumeType===p.Aj.FullRange),vt=r()(Ze,qe),Ot=xe.data.every(jt=>{const Ut=jt.meta?.custom?.absoluteRange;return Ut?Ut&&Ut.from<=Le.from&&Le.to<=Ut.to:!0});return rt&&vt&&Ot}function Xe(xe,Oe){return(Le,Ze)=>{const qe=Ze().explore.panes[xe].queries,rt=Oe.map((vt,Ot)=>(0,D.eF)(vt,qe,Ot));Le(we({exploreId:xe,queries:rt})),Le(fe({exploreId:xe}))}}function ot(xe){return(Oe,Le)=>{Oe(Je({exploreId:xe}));const Ze=(0,x.Wb)(-1,Le().explore.panes[xe].range);Oe((0,de.JA)({exploreId:xe,absoluteRange:Ze})),Oe(fe({exploreId:xe}))}}function ft(xe){return(Oe,Le)=>{const Ze=Le().explore.panes[xe].queryResponse,qe=Le().explore.panes[xe].absoluteRange,rt=(0,le.O2)(qe);Ze.state===o.Gu.Done&&Oe(pt({exploreId:xe,cacheKey:rt,queryResponse:Ze}))}}function _e(xe){return(Oe,Le)=>{Oe(bt({exploreId:xe}))}}function et(xe,Oe){return(Le,Ze)=>{const{supplementaryQueries:qe}=Ze().explore.panes[xe],rt=qe[Oe].dataProvider;if(rt){const vt=rt.subscribe({next:Ot=>{Le(Me({exploreId:xe,type:Oe,data:Ot}))}});Le(Ke({exploreId:xe,type:Oe,dataSubscription:vt}))}}}function it(xe,Oe,Le){return(Ze,qe)=>{Ze(Ie({exploreId:xe,enabled:Oe,type:Le})),(0,ne.Oi)(Oe,Le),Oe&&Ze(et(xe,Le))}}const dt=(xe,Oe)=>{if(ie.match(Oe)){const{queries:Le}=xe,{index:Ze,query:qe}=Oe.payload,rt=[...Le.slice(0,Ze+1),{...qe},...Le.slice(Ze+1)];return{...xe,queries:rt,queryKeys:(0,D.dY)(rt)}}if(J.match(Oe)){const{queries:Le}=Oe.payload;return{...xe,queries:Le}}if(ce.match(Oe))return(0,D._u)(xe.querySubscription),{...xe,...xe.queryResponse?{queryResponse:{...xe.queryResponse,state:o.Gu.Done}}:{}};if(we.match(Oe)){const{queries:Le}=Oe.payload;return{...xe,queries:Le.slice(),queryKeys:(0,D.dY)(Le)}}if(Pe.match(Oe)){const{querySubscription:Le}=Oe.payload;return{...xe,querySubscription:Le}}if(Ie.match(Oe)){const{enabled:Le,type:Ze}=Oe.payload,{supplementaryQueries:qe}=xe,rt=qe[Ze].dataSubscription;!Le&&rt&&rt.unsubscribe();const vt={...qe,[Ze]:{...qe[Ze],enabled:Le,data:void 0}};return{...xe,supplementaryQueries:vt}}if(ge.match(Oe)){const{dataProvider:Le,type:Ze}=Oe.payload,{supplementaryQueries:qe}=xe,rt=qe[Ze];rt?.dataSubscription&&rt.dataSubscription.unsubscribe();const vt={...qe,[Ze]:{...rt,dataProvider:Le,dataSubscription:void 0}};return{...xe,supplementaryQueries:vt}}if(Se.match(Oe)){const{type:Le}=Oe.payload,{supplementaryQueries:Ze}=xe,qe=Ze[Le];qe?.dataSubscription&&qe.dataSubscription.unsubscribe();const rt={...Ze,[Le]:{...qe,dataProvider:void 0,dataSubscription:void 0}};return{...xe,supplementaryQueries:rt}}if(De.match(Oe)){const{type:Le}=Oe.payload,{supplementaryQueries:Ze}=xe,qe={...Ze,[Le]:{...Ze[Le],data:void 0}};return{...xe,supplementaryQueries:qe}}if(Ke.match(Oe)){const{dataSubscription:Le,type:Ze}=Oe.payload,{supplementaryQueries:qe}=xe,rt={...qe,[Ze]:{...qe[Ze],dataSubscription:Le}};return{...xe,supplementaryQueries:rt}}if(Me.match(Oe)){let{data:Le,type:Ze}=Oe.payload;const{supplementaryQueries:qe}=xe,rt={...qe,[Ze]:{...qe[Ze],data:Le}};return{...xe,supplementaryQueries:rt}}if(be.match(Oe))return ze(xe,Oe);if(pe.match(Oe)){const{queries:Le}=Oe.payload;return{...xe,queries:Le,queryKeys:(0,D.dY)(Le)}}if(Be.match(Oe)){const{loadingState:Le}=Oe.payload;return{...xe,queryResponse:{...xe.queryResponse,state:Le}}}if(He.match(Oe)){const{isPaused:Le}=Oe.payload;return{...xe,isPaused:Le}}if(Je.match(Oe))return{...xe,scanning:!0};if(nt.match(Oe))return{...xe,scanning:!1,scanRange:void 0};if(pt.match(Oe)){const{cache:Ze}=xe,{queryResponse:qe,cacheKey:rt}=Oe.payload;let vt=[...Ze];return vt.some(jt=>jt.key===rt)||(vt=[{key:rt,value:qe},...vt].slice(0,5)),{...xe,cache:vt}}if(bt.match(Oe))return{...xe,cache:[]};if(Ve.match(Oe)){if(!xe.logsResult)return{...xe,clearedAtIndex:null};if(xe.queryResponse.state===o.Gu.Loading)return{...xe,clearedAtIndex:null,logsResult:{...xe.logsResult,rows:[]}};const Le=xe.clearedAtIndex?xe.clearedAtIndex+xe.logsResult.rows.length:xe.logsResult.rows.length-1;return{...xe,clearedAtIndex:Le,logsResult:{...xe.logsResult,rows:[]}}}return xe},ze=(xe,Oe)=>{const{response:Le}=Oe.payload,{request:Ze,series:qe,error:rt,graphResult:vt,logsResult:Ot,tableResult:jt,rawPrometheusResult:Ut,traceFrames:zt,nodeGraphFrames:qt,flameGraphFrames:fn,rawPrometheusFrames:Sn,customFrames:An}=Le;if(rt){if(rt.type===h.v2.Timeout||rt.type===h.v2.Cancelled)return{...xe};m.$.angularSupportEnabled&&xe.datasourceInstance?.components?.QueryCtrl&&xe.eventBridge.emit(y.ee.dataError,rt)}if(!Ze)return{...xe};if(m.$.angularSupportEnabled&&xe.datasourceInstance?.components?.QueryCtrl){const Hn=qe.map(es=>(0,f.w3)(es));xe.eventBridge.emit(y.ee.dataReceived,Hn)}return{...xe,queryResponse:Le,graphResult:vt,tableResult:jt,rawPrometheusResult:Ut,logsResult:xe.isLive&&Ot?{...Ot,rows:(0,le.pg)(xe.clearedAtIndex,Ot.rows)}:Ot,showLogs:!!Ot,showMetrics:!!vt,showTable:!!jt?.length,showTrace:!!zt.length,showNodeGraph:!!qt.length,showRawPrometheus:!!Sn.length,showFlameGraph:!!fn.length,showCustom:!!An?.length,clearedAtIndex:xe.isLive?xe.clearedAtIndex:null}}},9955:(_,L,e)=>{"use strict";e.d(L,{Jr:()=>o,K6:()=>i,Kl:()=>p,Qb:()=>s,i6:()=>g,pF:()=>l,qq:()=>u,st:()=>d,vC:()=>c});var t=e(25508),n=e(2543),r=e.n(n);const s=h=>h.explore.panes,a=h=>h.explore,g=h=>h.explore.richHistorySettings,i=(0,t.Mz)(s,Object.entries),l=(0,t.Mz)(i,h=>h.length>1),d=(0,t.Mz)(i,h=>h.some(y=>y[1].correlationEditorHelperData!==void 0)),o=h=>(0,t.Mz)(s,y=>Object.keys(y)[0]===h),u=h=>(0,t.Mz)(s,y=>y[h]),c=(0,t.Mz)(a,h=>h.correlationEditorDetails),p=(0,t.Mz)(i,h=>{const y=h.map(([P,m])=>{const D=[m?.datasourceInstance?.getRef()],x=m?.queries.map(C=>C.datasource)||[],E=[...D,...x].filter(C=>!!C);if(!(E===void 0||E.length===0))return{exploreId:P,datasources:(0,n.uniqBy)(E,C=>C.uid)}}).filter(P=>!!P),v=(0,n.uniqBy)((0,n.flatten)(y.map(P=>P.datasources)),P=>P.uid).map(P=>{let m=[];return y.forEach(D=>{D.datasources.some(x=>x.uid===P.uid)&&m.push(D.exploreId)}),{datasource:P,exploreIds:m}});return{exploreToDS:y,dsToExplore:v}})},89224:(_,L,e)=>{"use strict";e.d(L,{$_:()=>C,GA:()=>R,GH:()=>P,Iy:()=>b,JA:()=>D,QP:()=>S,Xk:()=>A,eM:()=>f,hO:()=>v,iO:()=>x,ke:()=>T,zY:()=>m});var t=e(65307),n=e(47232),r=e(26272),s=e(39070),a=e(72574),g=e(11134),i=e(76412),l=e(28138),d=e(87490),o=e(80582),u=e(74856),c=e(91002),p=e(32901),h=e(29436),y=e(23994);const f=(0,t.VP)("explore/changeRange"),v=(0,t.VP)("explore/changeRefreshInterval"),P=O=>(j,B)=>{const{syncedTimes:N}=B().explore;N?Object.keys(B().explore.panes).forEach(I=>{j(D({...O,exploreId:I})),j((0,y.Od)({exploreId:I,preserveCache:!0}))}):(j(D({...O})),j((0,y.Od)({exploreId:O.exploreId,preserveCache:!0})))},m=O=>j=>{j((0,y.S6)({...O}))},D=O=>(j,B)=>{const{exploreId:N,absoluteRange:I,rawRange:K}=O,w=B().explore.panes[N],U=(0,p.O)(B().user),W=(0,p.q)(B().user),{range:H}=w;let z=H.raw;I&&(z={from:(0,n.oZ)(U,I.from),to:(0,n.oZ)(U,I.to)}),K&&(z=K);const G=(0,d.zq)(U,z,W),M={from:G.from.valueOf(),to:G.to.valueOf()};(0,u.jG)().init({timepicker:{},getTimezone:()=>U,timeRangeUpdated(Q){},time:G.raw}),(0,a.w)().updateTimeRange(G),j(f({exploreId:N,range:G,absoluteRange:M}))};function x(O){return(j,B)=>{const N=B().explore.panes[O].range.raw;Object.keys(B().explore.panes).filter(K=>K!==O).forEach(K=>{j(P({exploreId:K,rawRange:N}))});const I=B().explore.syncedTimes;j((0,h.qz)({syncedTimes:!I}))}}function E(O){return(j,B)=>{const N=(0,p.O)(B().user),I=(0,p.q)(B().user);Object.entries(B().explore.panes).forEach(([K,w])=>{const U=(0,d.zq)(N,w.range.raw,I);O(K,w,U,j)})}}function C(){return E((O,j,B,N)=>{const I={from:B.from.valueOf(),to:B.to.valueOf()};N(P({exploreId:O,absoluteRange:I}))})}function b(O){return E((j,B,N,I)=>{const K=(0,o.Wb)(O,N);I(P({exploreId:j,absoluteRange:K}))})}function T(O){return E((j,B,N,I)=>{const K=(0,o.Zk)(N,O);I(P({exploreId:j,absoluteRange:K}))})}function A(){return(O,j)=>{const B=j().explore.panes[Object.keys(j().explore.panes)[0]].range.raw;navigator.clipboard.writeText(JSON.stringify(B)),l.A.emit(r.r1.alertSuccess,[(0,i.t)("time-picker.copy-paste.copy-success-message","Time range copied to clipboard")])}}function R(){return async(O,j)=>{const{range:B,isError:N}=await(0,o.zG)();if(N===!0){l.A.emit(r.r1.alertError,[(0,i.t)("time-picker.copy-paste.default-error-title","Invalid time range"),(0,i.t)("time-picker.copy-paste.default-error-message","{{error}} is not a valid time range",{error:B})]);return}if(j().explore.syncedTimes){O(P({exploreId:Object.keys(j().explore.panes)[0],rawRange:B})),O(P({exploreId:Object.keys(j().explore.panes)[1],rawRange:B}));return}O(P({exploreId:Object.keys(j().explore.panes)[0],rawRange:B}))}}const S=(O,j)=>{if(v.match(j)){const{refreshInterval:B}=j.payload,N=g.cC.isLive(B),I=(0,d.uE)(B),K=(0,c.zy)(O.logsResult,I);return g.cC.isLive(O.refreshInterval)&&!N&&(0,d._u)(O.querySubscription),{...O,refreshInterval:B,queryResponse:{...O.queryResponse,state:N?s.Gu.Streaming:s.Gu.Done},isLive:N,isPaused:N?!1:O.isPaused,logsResult:K}}if(f.match(j)){const{range:B,absoluteRange:N}=j.payload;return{...O,range:B,absoluteRange:N}}return O}},34028:(_,L,e)=>{"use strict";e.d(L,{BE:()=>E,HZ:()=>D,O2:()=>C,RA:()=>x,Z9:()=>A,aj:()=>j,dq:()=>O,eO:()=>T,kn:()=>v,ng:()=>m,pg:()=>S,rk:()=>b});var t=e(2543),n=e.n(t),r=e(39070),s=e(43127),a=e(85858),g=e(47232),i=e(32264),l=e(19347),d=e(11401),o=e(81523),u=e(14678),c=e(33390),p=e(87490),h=e(31193),y=e(57288);const f=100,v={from:`now-${i.$.exploreDefaultTimeOffset}`,to:"now"},P="grafana.explore.style.graph",m=B=>{c.A.set(P,B)},D=B=>({containerWidth:0,datasourceInstance:null,history:[],queries:[],initialized:!1,range:{from:null,to:null,raw:v},absoluteRange:{from:null,to:null},scanning:!1,queryKeys:[],isLive:!1,isPaused:!1,queryResponse:x(),tableResult:null,graphResult:null,logsResult:null,clearedAtIndex:null,rawPrometheusResult:null,eventBridge:null,cache:[],supplementaryQueries:(0,y.Ez)(),panelsState:{},correlations:void 0,...B}),x=()=>({state:r.Gu.NotStarted,series:[],timeRange:(0,s.E2)(),graphFrames:[],logsFrames:[],traceFrames:[],nodeGraphFrames:[],flameGraphFrames:[],customFrames:[],tableFrames:[],rawPrometheusFrames:[],rawPrometheusResult:null,graphResult:null,logsResult:null,tableResult:null});async function E(B,N){let I;try{I=await(0,h.tR)().get(N)}catch{I=await(0,h.tR)().get()}if(I.init)try{I.init()}catch(W){console.error(W)}let K=[];const w=(0,d.tU)(),U=await w.getRichHistory({search:"",sortOrder:o.xB.Ascending,datasourceFilters:[I.name],starred:!1});if((U.total||0)>0&&U.richHistory.forEach(W=>{W.queries.forEach(H=>{K.push({ts:parseInt(W.id,10),query:H})})}),K.length<f){const W=await w.getRichHistory({search:"",sortOrder:o.xB.Ascending,datasourceFilters:[u.uv],starred:!1});(W.total||0)>0&&W.richHistory.forEach(H=>{H.queries.forEach(z=>{z?.datasource?.uid===I.uid&&K.push({ts:parseInt(H.id,10),query:z})})})}if(K.length<f){const W=`grafana.explore.history.${I.meta?.id}`;K=[...K,...c.A.getObject(W,[])]}return K.length>f&&(K.length=f),(0,p.dr)(B,I.uid),{history:K,instance:I}}function C(B){const N={from:B.from,to:B.to};return Object.entries(N).map(([K,w])=>`${encodeURIComponent(K)}=${encodeURIComponent(w.toString())}`).join("&")}function b(B,N){const I=C(N),K=B.findIndex(U=>U.key===I);return K>=0?B[K].value:void 0}function T(B,N){return{from:a.parse(B.from,!1,N),to:a.parse(B.to,!0,N),raw:B}}function A(B){let N=v,I={from:R(B.from),to:R(B.to)};return I.from!==null&&I.to!==null&&(N={from:I.from,to:I.to}),N}function R(B){if(B===null)return null;if((0,g.Ar)(B))return B;if(typeof B!="string")return null;const N=B;if(N.indexOf("now")!==-1)return N;if(N.length===8)return(0,g.yT)(N,"YYYYMMDD");if(N.length===15)return(0,g.yT)(N,"YYYYMMDDTHHmmss");if(N.length===19)return(0,g.yT)(N,"YYYY-MM-DD HH:mm:ss");if(N.match(/^\d+$/)){const K=parseInt(N,10);return(0,g.yT)(K)}const I=(0,g.yT)(N);return I.isValid()?I:null}const S=(B,N)=>N?B?N.slice(B+1):N:[],O=(B,N)=>B===u.uv?(0,t.uniq)(N.map(I=>I.datasource?.uid).filter(I=>!!I)):[B];async function j(B,N){const I=B.explore.panes[N].correlationEditorHelperData,K=B.explore.correlationEditorDetails?.editorMode||!1,w=Object.keys(B.explore.panes)[0]===N,U=K&&w,W=U?await(0,l.l)().get():void 0,H=K&&!w&&I!==void 0;let z={};return H&&I!==void 0&&Object.entries(I?.vars).forEach(G=>{z[G[0]]={value:G[1]}}),{defaultCorrelationEditorDatasource:W,scopedVars:z,showCorrelationEditorLinks:U}}},96192:(_,L,e)=>{"use strict";e.d(L,{JQ:()=>x,O1:()=>C,QL:()=>m,YV:()=>P,_O:()=>A});var t=e(2543),n=e.n(t),r=e(96540),s=e(92461),a=e(91890),g=e(41987),i=e(6709),l=e(76885),d=e(72574),o=e(14110),u=e(16233),c=e(67023),p=e(29304),h=e(39590);const f=[R=>!R.internal||u.TP.hasAccessToExplore()],v="grafana_data_link_clicked",P=(R,S)=>j=>{const{field:B,dataLinkScopedVars:N,frame:I,link:K,linkModel:w}=j,{valueRowIndex:U}=j.config;if(U===void 0)return w;const W=m({field:B,rowIndex:U,splitOpenFn:R,range:S,vars:N,dataFrame:I,linksToProcess:[K]});return W.length?(0,t.first)(W):void 0},m=R=>{const{field:S,vars:O,splitOpenFn:j,range:B,rowIndex:N,dataFrame:I}=R,K={...O||{}};K.__value={value:{raw:S.values[N]},text:"Raw value"};let w;I&&(w=(0,s.F)({frame:I,rowIndex:N}),K.__data={value:{name:I.name,refId:I.refId,fields:w},text:"Data"},I.fields.forEach(W=>{w&&w[W.name]&&(K[W.name]={value:w[W.name]})}),K.__targetField={value:w[S.name]});const U=R.linksToProcess||S.config.links;return U?U.filter(z=>f.every(G=>G(z,K))).map(z=>{let G={};z.meta?.transformations&&z.meta?.transformations.forEach(q=>{let te;q.field?te=I?.fields.find(ee=>ee.name===q.field)?.values[N]:te=S.values[N],G={...G,...(0,c.k)(q,te,S.name)}});const M={...K,...G},Q=C(z,M);let Y=[];if(Q.variables.length===0){const q=S.name.toString();Y.push({variableName:q,value:"",match:""})}else Y=Q.variables;if(Q.allVariablesDefined)if(z.internal){const q=X=>{(0,o.rR)(v,{origin:z.origin||a.x0.Datasource,app:g.Jk.Explore,internal:!0}),j?.(X)};return{...(0,i.u)({link:z,internalLink:z.internal,scopedVars:M,range:B,field:S,onClickFn:R.splitOpenFn?X=>q(X):void 0,replaceVariables:(0,d.w)().replace.bind((0,d.w)())}),variables:Y}}else{const q=(X,ee)=>(0,d.w)().replace(X,{...ee,...M,...K}),te=(0,p.mQ)().getDataLinkUIModel(z,q,S);return te.title||(te.title=D(te.href)),te.target="_blank",{...te,variables:Y}}else return}).filter(z=>!!z):[]};function D(R){R.indexOf("://")<0&&(R=`http://${R}`);let S;try{S=new URL(R).hostname}catch{S=R}return S}function x(R,S){return(0,r.useCallback)((O,j)=>O.fields.flatMap(B=>B.config?.links&&B.config?.links.length?m({field:B,rowIndex:j,range:R,dataFrame:O,splitOpenFn:S}):[]),[R,S])}const E=["__from","__to","__interval","__interval_ms","__org","__user","__range","__rate_interval","__timeFilter","timeFilter"];function C(R,S){let O=[];return(0,d.w)().replace.bind((0,d.w)())(b(R),S,void 0,O),O=(0,t.uniqBy)(O,"variableName"),{variables:O,allVariablesDefined:O.filter(B=>!E.includes(B.variableName)).every(B=>B.found)}}function b(R){let S="",O;for(O in R)typeof R[O]=="string"?S+=" "+R[O]:typeof R[O]=="object"&&(S+=" "+b(R[O]));return S}const T=R=>R[1]!==void 0,A=R=>{const S=Object.entries(R).filter(T).map(([O,j])=>{const B=(0,h.m)(j);return B.range={to:j.range.to.valueOf().toString(),from:j.range.from.valueOf().toString()},[O,B]}).reduce((O,[j,B])=>({...O,[j]:B}),{});return l.kM.renderUrl("/explore",{schemaVersion:1,panes:JSON.stringify(S)})}},27649:(_,L,e)=>{"use strict";e.d(L,{v:()=>n});var t=e(77789);function n(r){const s=new Set(r.map(a=>a.refId).filter(Boolean));return s.size===r.length?r:(s.clear(),r.map(a=>{if(a.refId&&!s.has(a.refId))return s.add(a.refId),a;const g=(0,t.M)(r);return s.add(g),{...a,refId:g}}))}},57288:(_,L,e)=>{"use strict";e.d(L,{Ez:()=>h,Oi:()=>p,Pm:()=>v,VW:()=>u});var t=e(2543),n=e.n(t),r=e(88483),s=e(44240),a=e(6276),g=e(29405),i=e(9557),l=e(39070),d=e(33390),o=e(69147);const u=[i.cF.LogsVolume,i.cF.LogsSample],c=P=>`grafana.explore.logs.enable${P}`,p=(P,m)=>{d.A.set(c(m),P?"true":"false")},h=()=>{let P={[i.cF.LogsVolume]:{enabled:!0},[i.cF.LogsSample]:{enabled:!1}};for(const m of u){if(m===i.cF.LogsSample)continue;d.A.get(c(m))==="false"&&(P[m]={enabled:!1})}return P},y=(P,m,D)=>new r.c(x=>P.subscribe(E=>{if(E.logsResult&&E.logsResult.rows&&E.logsResult.visibleRange&&E.logsResult.bucketSize!==void 0&&E.state===l.Gu.Done){const C=E.logsResult.bucketSize,b=m.map(R=>R.refId),T=(0,t.groupBy)(E.logsResult.rows,"dataFrame.refId");let A=[];b.forEach(R=>{if(T[R]?.length){const S=(0,o.J9)(T[R],C);A=[...A,...S];const O={logsVolumeType:i.Aj.Limited,absoluteRange:E.logsResult?.visibleRange,datasourceName:D,sourceQuery:m.find(j=>j.refId===R)};x.next({data:A.map(j=>{const B=j.meta?.custom||{};return{...j,meta:{custom:{...B,...O}}}}),state:E.state})}}),x.complete()}})),f=(P,m,D,x)=>{if(P===i.cF.LogsVolume)return y(m,D,x)},v=(P,m,D,x)=>{const C=P.map(({datasource:b,targets:T},A)=>{const R=(0,t.cloneDeep)(D);if(R.requestId=`${R.requestId||""}_${A}`,R.targets=T,(0,i.Nc)(b,m)){if(b.getDataProvider)return b.getDataProvider(m,R);if(b.getSupplementaryRequest){const S=b.getSupplementaryRequest(m,R);return S?m===i.cF.LogsVolume?(0,o.sg)(b,S,{targets:R.targets}):(0,o.Wr)(b,S):void 0}else return}else return f(m,x,T,b.name)}).filter(l.zz);if(C.length!==0)return C.length===1?C[0]:(0,s.h)(...C).pipe((0,g.S)((b,T)=>b.errors&&b.errors.length||T.state===l.Gu.NotStarted?b:T.state===l.Gu.Loading&&b.state===l.Gu.NotStarted?{...b,state:l.Gu.Loading}:T.state&&T.state!==l.Gu.Done?b:{...b,data:[...b.data,...T.data],state:l.Gu.Done},{data:[],state:l.Gu.NotStarted}),(0,a.d)())}},53478:(_,L,e)=>{"use strict";e.d(L,{Ex:()=>b,$i:()=>C});var t=e(65474),n=e(69862),r=e(43429),s=e(26657),a=e(72574),g=e(19347),i=e(74848),l=e(96540),d=e(14186),o=e(90182),u=e(98808),c=e(71680),p=e(1712),h=e(34263),y=e(18225),f=e(76658),v=e(66718),P=e(76942);const m=15;function D(){const T=(0,l.useRef)({}),A=(0,l.useCallback)(S=>{switch(S){case v.Tz.math:case v.Tz.reduce:case v.Tz.resample:case v.Tz.threshold:case v.Tz.sql:return T.current[S];case v.Tz.classic:return}},[]),R=(0,l.useCallback)((S,O)=>{switch(S){case v.Tz.math:T.current.math=O;break;case v.Tz.reduce:case v.Tz.resample:case v.Tz.resample:T.current.reduce=O,T.current.resample=O,T.current.threshold=O;break;case v.Tz.sql:T.current.sql=O}},[]);return{getCachedExpression:A,setCachedExpression:R}}function x(T){const{query:A,queries:R,onRunQuery:S,onChange:O}=T,{getCachedExpression:j,setCachedExpression:B}=D();(0,l.useEffect)(()=>{B(A.type,A.expression)},[A.expression,A.type,B]);const N=(0,l.useCallback)(w=>{const U=j(w.value),W=(0,P.rV)({...A,type:w.value});O({...W,expression:U??W.expression})},[A,O,j]),I=()=>{const w=R.filter(U=>A.refId!==U.refId).map(U=>({value:U.refId,label:U.refId}));switch(A.type){case v.Tz.math:return(0,i.jsx)(c.z,{onChange:O,query:A,labelWidth:m,onRunQuery:S});case v.Tz.reduce:return(0,i.jsx)(p.Z,{refIds:w,onChange:O,labelWidth:m,query:A});case v.Tz.resample:return(0,i.jsx)(h.C,{query:A,labelWidth:m,onChange:O,refIds:w});case v.Tz.classic:return(0,i.jsx)(u.z,{onChange:O,query:A,refIds:w});case v.Tz.threshold:return(0,i.jsx)(f.O,{onChange:O,query:A,labelWidth:m,refIds:w});case v.Tz.sql:return(0,i.jsx)(y.k,{onChange:O,query:A,refIds:w})}},K=v.uQ.find(w=>w.value===A.type);return(0,i.jsxs)("div",{children:[(0,i.jsx)(d.I,{label:"Operation",labelWidth:m,children:(0,i.jsx)(o.l6,{options:v.uQ,value:K,onChange:N,width:25})}),I()]})}class E extends s.iy{constructor(A){super(A),this.instanceSettings=A}applyTemplateVariables(A,R){const S=(0,a.w)();return{...A,expression:S.replace(A.expression,R),window:S.replace(A.window,R)}}getCollapsedText(A){return`Expression: ${A.type}`}query(A){let R=A.targets.map(async O=>{const j=await(0,g.l)().get(O.datasource);return j.interpolateVariablesInQueries?j?.interpolateVariablesInQueries([O],A.scopedVars,A.filters)[0]:O});return(0,t.H)(Promise.all(R)).pipe((0,n.Z)(O=>super.query({...A,targets:O})))}newQuery(A){return{refId:"--",datasource:s.dR,type:A?.type??v.Tz.math,...A}}}const C={id:-100,uid:v.Uj,name:s.dR.name,type:s.dR.type,access:"proxy",meta:{baseUrl:"",module:"",type:r.QE.datasource,name:s.dR.type,id:s.dR.type,info:{author:{name:"Grafana Labs"},logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"},description:"Adds expression support to Grafana",screenshots:[],links:[],updated:"",version:""}},jsonData:{},readOnly:!0},b=new E(C);b.meta={id:s.dR.type,info:{logos:{small:"public/img/icn-datasource.svg",large:"public/img/icn-datasource.svg"}}},b.components={QueryEditor:x}},98808:(_,L,e)=>{"use strict";e.d(L,{z:()=>m});var t=e(74848),n=e(39268),r=e(14186),s=e(55852),a=e(14578),g=e(76942),i=e(32196),l=e(40845),d=e(67061),o=e(9261),u=e(90182),c=e(10354),p=e(55907);const h=p.A.reducerTypes.map(D=>({label:D.text,value:D.value})),y=p.A.evalOperators.map(D=>({label:D.text,value:D.value})),f=p.A.evalFunctions.map(D=>({label:D.text,value:D.value})),v=({condition:D,index:x,onChange:E,onRemoveCondition:C,refIds:b})=>{const T=(0,l.of)(P),A=I=>{E({...D,operator:{type:I.value}})},R=I=>{E({...D,reducer:{type:I.value,params:[]}})},S=I=>{E({...D,query:{params:[I.value]}})},O=I=>{E({...D,evaluator:{params:D.evaluator.params,type:I.value}})},j=(I,K)=>{const w=parseFloat(I.currentTarget.value),U=[...D.evaluator.params];U[K]=w,E({...D,evaluator:{...D.evaluator,params:U}})},B=(0,i.css)`
    width: 75px;
  `,N=D.evaluator.type===p.p.IsWithinRange||D.evaluator.type===p.p.IsOutsideRange;return(0,t.jsxs)(d.B,{children:[(0,t.jsxs)("div",{style:{flex:1},children:[(0,t.jsxs)(n.C,{children:[x===0?(0,t.jsx)("div",{className:(0,i.cx)(T.button,B),children:"WHEN"}):(0,t.jsx)(o.f,{className:(0,i.cx)(T.buttonSelectText,B),options:y,onChange:A,value:y.find(I=>I.value===D.operator.type)}),(0,t.jsx)(u.l6,{options:h,onChange:R,width:20,value:h.find(I=>I.value===D.reducer.type)}),(0,t.jsx)("div",{className:T.button,children:"OF"}),(0,t.jsx)(u.l6,{onChange:S,options:b,width:"auto",value:b.find(I=>I.value===D.query.params[0])})]}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(o.f,{className:T.buttonSelectText,options:f,onChange:O,value:f.find(I=>I.value===D.evaluator.type)}),N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.p,{type:"number",width:10,onChange:I=>j(I,0),value:D.evaluator.params[0]}),(0,t.jsx)("div",{className:T.button,children:"TO"}),(0,t.jsx)(c.p,{type:"number",width:10,onChange:I=>j(I,1),value:D.evaluator.params[1]})]}):D.evaluator.type!==p.p.HasNoValue?(0,t.jsx)(c.p,{type:"number",width:10,onChange:I=>j(I,0),value:D.evaluator.params[0]}):null]})]}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:()=>C(x),children:(0,t.jsx)(a.I,{name:"trash-alt"})})]})},P=D=>{const x=(0,i.css)`
    color: ${D.colors.primary.text};
    font-size: ${D.typography.bodySmall.fontSize};
  `;return{buttonSelectText:x,button:(0,i.cx)((0,i.css)`
        display: flex;
        align-items: center;
        border-radius: ${D.shape.radius.default};
        font-weight: ${D.typography.fontWeightMedium};
        border: 1px solid ${D.colors.border.weak};
        white-space: nowrap;
        padding: 0 ${D.spacing(1)};
        background-color: ${D.colors.background.canvas};
      `,x)}},m=({onChange:D,query:x,refIds:E})=>{const C=(A,R)=>{x.conditions&&D({...x,conditions:[...x.conditions.slice(0,R),A,...x.conditions.slice(R+1)]})},b=()=>{if(x.conditions){const A=x.conditions.at(-1)?.query?.params??[],R={...g.P0,query:{params:A}};D({...x,conditions:x.conditions.length>0?[...x.conditions,R]:[R]})}},T=A=>{if(x.conditions){const R=x.conditions[A],S=x.conditions.filter(O=>O!==R).map((O,j)=>j===0?{...O,operator:{type:"when"}}:O);D({...x,conditions:S})}};return(0,t.jsxs)("div",{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(r.I,{label:"Conditions",labelWidth:14,children:(0,t.jsx)("div",{children:x.conditions?.map((A,R)=>{if(A)return(0,t.jsx)(v,{index:R,condition:A,onChange:S=>C(S,R),onRemoveCondition:T,refIds:E},R)})})})}),(0,t.jsx)(s.$n,{variant:"secondary",type:"button",onClick:b,children:(0,t.jsx)(a.I,{name:"plus-circle"})})]})}},71680:(_,L,e)=>{"use strict";e.d(L,{z:()=>u});var t=e(74848),n=e(32196),r=e(40845),s=e(67061),a=e(14186),g=e(76892),i=e(60782),l=e(14578),d=e(21744);const o="Math operations on one or more queries. You reference the query by ${refId} ie. $A, $B, $C etc\nThe sum of two scalar values: $A + $B > 10",u=({labelWidth:y,onChange:f,query:v,onRunQuery:P})=>{const m=E=>{f({...v,expression:E.target.value})},D=(0,r.of)(p),x=()=>{v.expression&&P()};return(0,t.jsx)(s.B,{children:(0,t.jsx)(a.I,{label:(0,t.jsx)(g.c,{width:"auto",children:(0,t.jsx)(i.G,{fitContent:!0,content:(0,t.jsxs)("div",{className:D.documentationContainer,children:[(0,t.jsxs)("div",{children:["Run math operations on one or more queries. You reference the query by ","${refId}"," ie. $A, $B, $C etc.",(0,t.jsx)("br",{}),"Example: ",(0,t.jsx)("code",{children:"$A + $B"})]}),(0,t.jsx)("header",{className:D.documentationHeader,children:"Available Math functions"}),(0,t.jsxs)("div",{className:D.documentationFunctions,children:[(0,t.jsx)(c,{name:"abs",description:"returns the absolute value of its argument which can be a number or a series"}),(0,t.jsx)(c,{name:"is_inf",description:"returns 1 for Inf values (negative or positive) and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(c,{name:"is_nan",description:"returns 1 for NaN values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(c,{name:"is_null",description:"returns 1 for null values and 0 for other values. It's able to operate on series or scalar values."}),(0,t.jsx)(c,{name:"is_number",description:"returns 1 for all real number values and 0 for non-number. It's able to operate on series or scalar values."}),(0,t.jsx)(c,{name:"log",description:"returns the natural logarithm of its argument, which can be a number or a series"}),(0,t.jsx)(c,{name:"inf, infn, nan, and null",description:"The inf for infinity positive, infn for infinity negative, nan, and null functions all return a single scalar value that matches its name."}),(0,t.jsx)(c,{name:"round",description:"returns a rounded integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(c,{name:"ceil",description:"rounds the number up to the nearest integer value. It's able to operate on series or escalar values."}),(0,t.jsx)(c,{name:"floor",description:"rounds the number down to the nearest integer value. It's able to operate on series or escalar values."})]})]}),title:(0,t.jsxs)(s.B,{gap:1,direction:"row",children:[(0,t.jsx)(l.I,{name:"book-open"})," Math operator"]}),footer:(0,t.jsxs)("div",{children:["See our additional documentation on"," ",(0,t.jsxs)("a",{className:D.documentationLink,target:"_blank",href:"https://grafana.com/docs/grafana/latest/panels/query-a-data-source/use-expressions-to-manipulate-data/about-expressions/#math",rel:"noreferrer",children:[(0,t.jsx)(l.I,{size:"xs",name:"external-link-alt"})," Math expressions"]}),"."]}),closeButton:!0,placement:"bottom-start",children:(0,t.jsxs)("div",{className:D.info,children:["Expression ",(0,t.jsx)(l.I,{name:"info-circle"})]})})}),labelWidth:y,grow:!0,shrink:!0,children:(0,t.jsx)(d.f,{value:v.expression,onChange:m,rows:1,placeholder:o,onBlur:x,style:{minWidth:250,lineHeight:"26px",minHeight:32}})})})},c=({name:y,description:f})=>{const v=(0,r.of)(h);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:v.name,children:y}),(0,t.jsx)("span",{className:v.description,children:f})]})},p=y=>({documentationHeader:(0,n.css)`
    font-size: ${y.typography.h5.fontSize};
    font-weight: ${y.typography.h5.fontWeight};
  `,documentationLink:(0,n.css)`
    color: ${y.colors.text.link};
  `,documentationContainer:(0,n.css)`
    display: flex;
    flex: 1;
    flex-direction: column;
    gap: ${y.spacing(2)};

    padding: ${y.spacing(1)} ${y.spacing(2)};
  `,documentationFunctions:(0,n.css)`
    display: grid;
    grid-template-columns: max-content auto;
    column-gap: ${y.spacing(2)};
  `,info:(0,n.css)`
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: pointer;
    gap: ${y.spacing(1)};
  `}),h=y=>({name:(0,n.css)`
    font-weight: ${y.typography.fontWeightBold};
  `,description:(0,n.css)`
    font-size: ${y.typography.bodySmall.fontSize};
    color: ${y.colors.text.disabled};
  `})},1712:(_,L,e)=>{"use strict";e.d(L,{Z:()=>i});var t=e(74848),n=e(14186),r=e(10354),s=e(39268),a=e(90182),g=e(66718);const i=({labelWidth:l="auto",onChange:d,refIds:o,query:u})=>{const c=g.Cu.find(D=>D.value===u.reducer),p=D=>{d({...u,expression:D.value})},h=D=>{d({...u,reducer:D.value})},y=D=>{d({...u,settings:D})},f=D=>{let x;switch(D.value){case g.Mt.ReplaceNonNumbers:let E=0;u.settings?.mode===g.Mt.ReplaceNonNumbers&&(E=u.settings?.replaceWithValue??0),x={mode:g.Mt.ReplaceNonNumbers,replaceWithValue:E};break;default:x={mode:D.value}}y(x)},v=D=>{const x=D.currentTarget.valueAsNumber;y({mode:g.Mt.ReplaceNonNumbers,replaceWithValue:x??0})},P=u.settings?.mode??g.Mt.Strict,m=()=>{if(P===g.Mt.ReplaceNonNumbers)return(0,t.jsx)(n.I,{label:"Replace With",labelWidth:l,children:(0,t.jsx)(r.p,{type:"number",width:10,onChange:v,value:u.settings?.replaceWithValue??0})})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.C,{children:(0,t.jsx)(n.I,{label:"Input",labelWidth:l,children:(0,t.jsx)(a.l6,{onChange:p,options:o,value:u.expression,width:"auto"})})}),(0,t.jsxs)(s.C,{children:[(0,t.jsx)(n.I,{label:"Function",labelWidth:l,children:(0,t.jsx)(a.l6,{options:g.Cu,value:c,onChange:h,width:20})}),(0,t.jsx)(n.I,{label:"Mode",labelWidth:l,children:(0,t.jsx)(a.l6,{onChange:f,options:g.HZ,value:P,width:25})}),m()]})]})}},34263:(_,L,e)=>{"use strict";e.d(L,{C:()=>i});var t=e(74848),n=e(39268),r=e(14186),s=e(90182),a=e(10354),g=e(66718);const i=({labelWidth:l="auto",onChange:d,refIds:o,query:u})=>{const c=g.PN.find(P=>P.value===u.downsampler),p=g.iX.find(P=>P.value===u.upsampler),h=P=>{d({...u,window:P.target.value})},y=P=>{d({...u,expression:P.value})},f=P=>{d({...u,downsampler:P.value})},v=P=>{d({...u,upsampler:P.value})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.C,{children:(0,t.jsx)(r.I,{label:"Input",labelWidth:l,children:(0,t.jsx)(s.l6,{onChange:y,options:o,value:u.expression,width:20})})}),(0,t.jsxs)(n.C,{children:[(0,t.jsx)(r.I,{label:"Resample to",labelWidth:l,tooltip:"10s, 1m, 30m, 1h",children:(0,t.jsx)(a.p,{onChange:h,value:u.window,width:15})}),(0,t.jsx)(r.I,{label:"Downsample",children:(0,t.jsx)(s.l6,{options:g.PN,value:c,onChange:f,width:25})}),(0,t.jsx)(r.I,{label:"Upsample",children:(0,t.jsx)(s.l6,{options:g.iX,value:p,onChange:v,width:25})})]})]})}},18225:(_,L,e)=>{"use strict";e.d(L,{k:()=>s});var t=e(74848),n=e(96540),r=e(6867);const s=({onChange:a,refIds:g,query:i})=>{const d=`select * from ${(0,n.useMemo)(()=>g.map(u=>u.value),[g])[0]} limit 1`,o=u=>{a({...i,expression:u})};return(0,t.jsx)(r.Y,{query:i.expression||d,onChange:o})}},76658:(_,L,e)=>{"use strict";e.d(L,{O:()=>A});var t=e(74848),n=e(32196),r=e(96540),s=e(46819),a=e(40845),g=e(39268),i=e(14186),l=e(90182),d=e(9261),o=e(10354),u=e(15292),c=e(2913),p=e(55907),h=e(66718),y=e(65307);const f=(0,y.VP)("thresold/updateRefId"),v=(0,y.VP)("thresold/updateThresholdType"),P=(0,y.VP)("thresold/updateThresholdParams"),m=(0,y.VP)("thresold/updateHysteresis"),D=(0,y.VP)("thresold/updateUnloadParams"),x=(0,y.vy)({type:h.Tz.threshold,refId:"",conditions:[]},O=>{O.addCase(f,(j,B)=>{j.expression=B.payload}),O.addCase(v,(j,B)=>{const N=B.payload.evalFunction,I=B.payload.onError;if(j.conditions[0].evaluator.type=N,!!j.conditions[0].unloadEvaluator){const w=E(j.conditions[0].evaluator.type);I&&I(void 0),j.conditions[0].evaluator.type=N;const U={type:w,params:j.conditions[0].evaluator?.params??[0,0]};j.conditions[0].unloadEvaluator=U}}),O.addCase(P,(j,B)=>{const{param:N,index:I}=B.payload;j.conditions[0].evaluator.params[I]=N}),O.addCase(m,(j,B)=>{const{hysteresisChecked:N,onError:I}=B.payload;N?j.conditions[0].unloadEvaluator={type:E(j.conditions[0].evaluator.type),params:j.conditions[0].evaluator?.params??[0,0]}:(j.conditions[0].unloadEvaluator=void 0,I&&I(void 0))}),O.addCase(D,(j,B)=>{const{param:N,index:I,onError:K}=B.payload;j.conditions[0].unloadEvaluator?j.conditions[0].unloadEvaluator.params[I]=N:j.conditions[0].unloadEvaluator={type:E(j.conditions[0].evaluator.type),params:j.conditions[0].evaluator?.params??[0,0]};const w=C(j.conditions[0]),{errorMsg:U,errorMsgFrom:W,errorMsgTo:H}=w??{};K&&K(U||W||H)})});function E(O){return O===p.p.IsAbove?p.p.IsBelow:O===p.p.IsBelow?p.p.IsAbove:O===p.p.IsWithinRange?p.p.IsOutsideRange:O===p.p.IsOutsideRange?p.p.IsWithinRange:p.p.IsBelow}function C(O){const{unloadEvaluator:j,evaluator:B}=O;if(!B)return;if(j?.params[0]===void 0||Number.isNaN(j?.params[0]))return{errorMsg:"This value cannot be empty"};const{type:N,params:I}=B,{params:K}=j;if(N===p.p.IsWithinRange||N===p.p.IsOutsideRange){if(K[0]===void 0||Number.isNaN(K[0]))return{errorMsgFrom:"This value cannot be empty"};if(K[1]===void 0||Number.isNaN(K[1]))return{errorMsgTo:"This value cannot be empty"}}const[w,U]=j.params,[W,H]=I;switch(N){case p.p.IsAbove:if(w>W)return{errorMsg:`Enter a number less than or equal to ${W}`};break;case p.p.IsBelow:if(w<W)return{errorMsg:`Enter a number more than or equal to ${W}`};break;case p.p.IsOutsideRange:if(w<W)return{errorMsgFrom:`Enter a number more than or equal to ${W}`};if(U>H)return{errorMsgTo:`Enter a number less than or equal to ${H}`};break;case p.p.IsWithinRange:if(w>W)return{errorMsgFrom:`Enter a number less than or equal to ${W}`};if(U<H)return{errorMsgTo:`Enter a number be more than or equal to ${H}`};break;default:throw new Error(`evaluator function type ${N} not supported.`)}}const b=p.p.IsAbove,T={type:"query",evaluator:{type:b,params:[0,0]},query:{params:[]},reducer:{params:[],type:"last"}},A=({labelWidth:O,onChange:j,refIds:B,query:N,onError:I,useHysteresis:K=!1})=>{const w=(0,a.of)(S),U={...N,conditions:N.conditions?.length?N.conditions:[T]},[W,H]=(0,r.useReducer)(x,U),z=W.conditions[0],G=h.zd.find(ee=>ee.value===W.conditions[0].evaluator?.type),M=ee=>{H(f(ee.value))};(0,r.useEffect)(()=>{W&&j(W)},[W]);const Q=ee=>{H(v({evalFunction:ee.value??b,onError:I}))},Y=(ee,ne)=>{H(P({param:parseFloat(ee.currentTarget.value),index:ne}))},q=z.evaluator.type===p.p.IsWithinRange||z.evaluator.type===p.p.IsOutsideRange,te=!!c.$W.featureToggles?.recoveryThreshold&&K;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.C,{children:(0,t.jsx)(i.I,{label:"Input",labelWidth:O,children:(0,t.jsx)(l.l6,{onChange:M,options:B,value:N.expression,width:20})})}),(0,t.jsxs)(g.C,{children:[(0,t.jsx)(d.f,{className:w.buttonSelectText,options:h.zd,onChange:Q,value:G}),q?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.p,{type:"number",width:10,onChange:ee=>Y(ee,0),defaultValue:z.evaluator.params[0]}),(0,t.jsx)("div",{className:w.button,children:"TO"}),(0,t.jsx)(o.p,{type:"number",width:10,onChange:ee=>Y(ee,1),defaultValue:z.evaluator.params[1]})]}):(0,t.jsx)(o.p,{type:"number",width:10,onChange:ee=>Y(ee,0),defaultValue:z.evaluator.params[0]||0})]}),te&&(0,t.jsx)(X,{isRange:q,onError:I})]});function X({isRange:ee,onError:ne}){const Z=!!z.unloadEvaluator,ae=de=>{H(m({hysteresisChecked:de.currentTarget.checked,onError:ne})),re.current=!0},re=r.useRef(!0),se=()=>{re.current=!1};return(0,t.jsxs)("div",{className:w.hysteresis,children:[(0,t.jsx)("div",{onMouseDown:se,children:(0,t.jsx)(u.K,{showLabel:!0,label:"Custom recovery threshold",value:Z,onChange:ae,className:w.switch})}),Z&&(0,t.jsx)(R,{isRange:ee,condition:z,onError:ne,dispatch:H,allowOnblur:re})]})}};function R({isRange:O,condition:j,onError:B,dispatch:N,allowOnblur:I}){const K=(0,a.of)(S),w=(Q,Y)=>{const q=parseFloat(Q.currentTarget.value);N(D({param:q,index:Y,onError:B}))},U=C(j),{errorMsg:W,errorMsgFrom:H,errorMsgTo:z}=U??{};if(O)return(0,t.jsx)(G,{allowOnblur:I});return(0,t.jsx)(M,{allowOnblur:I});function G({allowOnblur:Q}){return j.evaluator.type===p.p.IsWithinRange?(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when outside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!H,error:H,className:K.noMargin,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>Q.current&&w(Y,0),defaultValue:j.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:K.button,children:"TO"}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!z,error:z,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>Q.current&&w(Y,1),defaultValue:j.unloadEvaluator?.params[1]})})})]})})}):(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when inside range",labelWidth:"auto",children:(0,t.jsxs)(s.B,{direction:"row",gap:0,children:[(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!H,error:H,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>Q.current&&w(Y,0),defaultValue:j.unloadEvaluator?.params[0]})})}),(0,t.jsx)("div",{className:K.button,children:"TO"}),(0,t.jsx)("div",{className:K.range,children:(0,t.jsx)(i.I,{invalid:!!z,error:z,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>Q.current&&w(Y,1),defaultValue:j.unloadEvaluator?.params[1]})})})]})})})}function M({allowOnblur:Q}){return j.evaluator.type===p.p.IsAbove?(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when below",labelWidth:"auto",invalid:!!W,error:W,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>{Q.current&&w(Y,0)},defaultValue:j.unloadEvaluator?.params[0]})})}):(0,t.jsx)(g.C,{className:K.hysteresis,children:(0,t.jsx)(i.I,{label:"Stop alerting when above",labelWidth:"auto",invalid:!!W,error:W,children:(0,t.jsx)(o.p,{type:"number",width:10,onBlur:Y=>{Q.current&&w(Y,0)},defaultValue:j.unloadEvaluator?.params[0]})})})}}const S=O=>({buttonSelectText:(0,n.css)({color:O.colors.primary.text,fontSize:O.typography.bodySmall.fontSize,textTransform:"uppercase",padding:`0 ${O.spacing(1)}`}),button:(0,n.css)({height:"32px",color:O.colors.primary.text,fontSize:O.typography.bodySmall.fontSize,textTransform:"uppercase",display:"flex",alignItems:"center",borderRadius:O.shape.radius.default,fontWeight:O.typography.fontWeightBold,border:`1px solid ${O.colors.border.medium}`,whiteSpace:"nowrap",padding:`0 ${O.spacing(1)}`,backgroundColor:O.colors.background.primary}),range:(0,n.css)({width:"min-content"}),hysteresis:(0,n.css)({marginTop:O.spacing(2)}),switch:(0,n.css)({paddingLeft:O.spacing(1)}),noMargin:(0,n.css)({margin:0})})},69437:(_,L,e)=>{"use strict";e.d(L,{f:()=>r,z:()=>s});var t=e(26657),n=e(66718);const r=a=>{if(!a)return!1;if((0,t.s9)(a.datasource))return!0;const g=a;return typeof g.type!="string"?!1:Object.values(n.Tz).includes(g.type)};function s(a){return["avg","min","max","sum","count","last","median","diff","diff_abs","percent_diff","percent_diff_abs","count_non_null"].includes(a)}},66718:(_,L,e)=>{"use strict";e.d(L,{Cu:()=>l,HZ:()=>o,Mt:()=>d,NI:()=>g,PN:()=>u,Tz:()=>a,Uj:()=>s,iX:()=>c,uQ:()=>i,zd:()=>p});var t=e(75059),n=e(2913),r=e(55907);const s="__expr__";var a=(h=>(h.math="math",h.reduce="reduce",h.resample="resample",h.classic="classic_conditions",h.threshold="threshold",h.sql="sql",h))(a||{});const g=h=>{switch(h){case"math":return"Math";case"reduce":return"Reduce";case"resample":return"Resample";case"classic_conditions":return"Classic condition (legacy)";case"threshold":return"Threshold";case"sql":return"SQL"}},i=[{value:"math",label:"Math",description:"Free-form math formulas on time series or number data."},{value:"reduce",label:"Reduce",description:"Takes one or more time series returned from a query or an expression and turns each series into a single number."},{value:"resample",label:"Resample",description:"Changes the time stamps in each time series to have a consistent time interval."},{value:"classic_conditions",label:"Classic condition (legacy)",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the condition. Disables multi-dimensional alerts for this rule."},{value:"threshold",label:"Threshold",description:"Takes one or more time series returned from a query or an expression and checks if any of the series match the threshold condition."},{value:"sql",label:"SQL",description:"Transform data using SQL. Supports Aggregate/Analytics functions from DuckDB"}].filter(h=>h.value==="sql"?n.$W.featureToggles?.sqlExpressions:!0),l=[{value:t.gy.min,label:"Min",description:"Get the minimum value"},{value:t.gy.max,label:"Max",description:"Get the maximum value"},{value:t.gy.mean,label:"Mean",description:"Get the average value"},{value:t.gy.median,label:"Median",description:"Get the median value"},{value:t.gy.sum,label:"Sum",description:"Get the sum of all values"},{value:t.gy.count,label:"Count",description:"Get the number of values"},{value:t.gy.last,label:"Last",description:"Get the last value"}];var d=(h=>(h.Strict="",h.ReplaceNonNumbers="replaceNN",h.DropNonNumbers="dropNN",h))(d||{});const o=[{value:"",label:"Strict",description:"Result can be NaN if series contains non-numeric data"},{value:"dropNN",label:"Drop Non-numeric Values",description:"Drop NaN, +/-Inf and null from input series before reducing"},{value:"replaceNN",label:"Replace Non-numeric Values",description:"Replace NaN, +/-Inf and null with a constant value before reducing"}],u=[{value:t.gy.last,label:"Last",description:"Fill with the last value"},{value:t.gy.min,label:"Min",description:"Fill with the minimum value"},{value:t.gy.max,label:"Max",description:"Fill with the maximum value"},{value:t.gy.mean,label:"Mean",description:"Fill with the average value"},{value:t.gy.sum,label:"Sum",description:"Fill with the sum of all values"}],c=[{value:"pad",label:"pad",description:"fill with the last known value"},{value:"backfilling",label:"backfilling",description:"fill with the next known value"},{value:"fillna",label:"fillna",description:"Fill with NaNs"}],p=[{value:r.p.IsAbove,label:"Is above"},{value:r.p.IsBelow,label:"Is below"},{value:r.p.IsWithinRange,label:"Is within range"},{value:r.p.IsOutsideRange,label:"Is outside range"}]},76942:(_,L,e)=>{"use strict";e.d(L,{H3:()=>i,P0:()=>g,rV:()=>a});var t=e(75059),n=e(55907),r=e(69437),s=e(66718);const a=l=>{switch(l.type){case s.Tz.reduce:l.reducer||(l.reducer=t.gy.mean);break;case s.Tz.resample:l.downsampler||(l.downsampler=t.gy.mean),l.upsampler||(l.upsampler="fillna"),l.reducer=void 0;break;case s.Tz.math:l.expression=void 0;break;case s.Tz.classic:l.conditions||(l.conditions=[g]);break;default:l.reducer=void 0}return l},g={type:"query",reducer:{params:[],type:"avg"},operator:{type:"and"},query:{params:[]},evaluator:{params:[0,0],type:n.p.IsAbove}};function i(l){if((0,r.z)(l))return l}},71101:(_,L,e)=>{"use strict";e.d(L,{Cg:()=>i,Fk:()=>d,R4:()=>c,Rj:()=>g,pq:()=>l});var t=e(32264),n=e(8484),r=e(16233),s=e(36689),a=e(31678);const g="manage-folder",i=h=>`folder-dashboards-${h}`,l=h=>`folder-library-panels-${h}`,d=h=>`folder-alerting-${h}`,o=h=>`folder-permissions-${h}`,u=h=>`folder-settings-${h}`;function c(h,y){const f=y??("parents"in h?h.parents:void 0),v={icon:"folder",id:g,subTitle:(0,s.o)("manage-folder"),url:h.url,text:h.title,children:[{active:!1,icon:"apps",id:i(h.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.dashboards","Dashboards"),url:h.url}]};if(f&&f.length>0){const P=f[f.length-1],m=f.slice(0,f.length-1);v.parentItem=c(P,m)}return v.children.push({active:!1,icon:"library-panel",id:l(h.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.panels","Panels"),url:`${h.url}/library-panels`}),r.TP.hasPermission(a.AccessControlAction.AlertingRuleRead)&&t.$.unifiedAlertingEnabled&&v.children.push({active:!1,icon:"bell",id:d(h.uid),text:(0,n.t)("browse-dashboards.manage-folder-nav.alert-rules","Alert rules"),url:`${h.url}/alerting`}),v}function p(h){const y=c({created:"",createdBy:"",hasAcl:!1,updated:"",updatedBy:"",id:1,uid:"loading",title:"Loading",url:"url",canSave:!0,canEdit:!0,canAdmin:!0,canDelete:!0,version:0});return y.children[h].active=!0,{main:y,node:y.children[h]}}},54650:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>d,jl:()=>g});var t=e(65307),n=e(55314);const r={id:0,uid:"loading",title:"loading",url:"",canSave:!1,canDelete:!1,hasChanged:!1,version:1},s=(o,u)=>({...o,...u.payload,hasChanged:!1}),a=(0,t.Z0)({name:"folder",initialState:r,reducers:{loadFolder:s,setFolderTitle:(o,u)=>({...o,title:u.payload,hasChanged:u.payload.trim().length>0})},extraReducers:o=>{o.addMatcher(n.vZ.getFolder.matchFulfilled,s)}}),{loadFolder:g,setFolderTitle:i}=a.actions,d={folder:a.reducer}},84350:(_,L,e)=>{"use strict";e.d(L,{G:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(40845),a=e(90182),g=e(42418),i=e(67140);const l=[{label:"Countries",description:"Lookup countries by name, two letter code, or three letter code",value:i.fx},{label:"USA States",description:"Lookup states by name or 2 ",value:"public/gazetteer/usa-states.json"},{label:"Airports",description:"Lookup airports by id or code",value:"public/gazetteer/airports.geojson"}],d=({value:u,onChange:c,context:p,item:h})=>{const y=(0,s.of)(o),[f,v]=(0,r.useState)(),P=h.settings;(0,r.useEffect)(()=>{async function x(){const E=await(0,i.q3)(u);v(E)}x()},[u,v]);const{current:m,options:D}=(0,r.useMemo)(()=>{let x=P?.options?[...P.options]:[...l],E=x?.find(C=>C.value===f?.path);return!E&&f&&(E={label:f.path,value:f.path},x.push(E)),{options:x,current:E}},[f,P?.options]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.l6,{value:m,options:D,onChange:x=>c(x.value),allowCustomValue:!0,formatCreateLabel:x=>`Load from URL: ${x}`}),f&&(0,t.jsxs)(t.Fragment,{children:[f.error&&(0,t.jsx)(g.F,{title:f.error,severity:"warning"}),f.count&&(0,t.jsxs)("div",{className:y.keys,children:[(0,t.jsxs)("b",{children:["(",f.count,")"]}),f.examples(10).map(x=>(0,t.jsxs)("span",{children:[x,","]},x)),f.count>10&&" ..."]})]})]})},o=()=>({keys:(0,n.css)`
    margin-top: 4px;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;

    > span {
      margin-left: 4px;
    }
  `})},61983:(_,L,e)=>{"use strict";e.d(L,{G:()=>P});var t=e(11261),n=e(52622),r=e(84350),s=e(74848),a=e(32196),g=e(96540),i=e(13544),l=e(40845),d=e(42418),o=e(14578),u=e(90182),c=e(66864),p=e(31484);const h=[{value:n.aG.Auto,label:"Auto",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.autoOption,description:"Automatically identify location data based on default field names"},{value:n.aG.Coords,label:"Coords",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.coords.option,description:"Specify latitude and longitude fields"},{value:n.aG.Geohash,label:"Geohash",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.geohash.option,description:"Specify geohash field"},{value:n.aG.Lookup,label:"Lookup",ariaLabel:i.Tp.components.Transforms.SpatialOperations.location.lookup.option,description:"Specify Gazetteer and lookup field"}],y="https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/geomap/#location",f=({value:m,onChange:D,context:x,item:E})=>{const[C,b]=(0,g.useState)();(0,g.useEffect)(()=>{E.settings?.source&&E.settings?.data?.length&&E.settings.data[0]&&(0,p.nE)(E.settings.source).then(R=>{E.settings&&E.settings.data&&b((0,p.FM)(E.settings.data[0],R))})},[E.settings]);const T=(0,l.of)(v),A=()=>{if(C){if(C.warning)return(0,s.jsx)(d.F,{title:C.warning,severity:"warning",buttonContent:(0,s.jsx)(o.I,{name:"question-circle",size:"xl"}),className:T.alert,onRemove:()=>{const R=window.open(y,"_blank","noopener,noreferrer");R&&(R.opener=null)}});if(m===n.aG.Auto&&C.description)return(0,s.jsx)("span",{children:C.description})}return null};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.l6,{options:h,value:m,onChange:R=>{D(R.value)}}),(0,s.jsx)(c.Gy,{className:T.hGroup,children:A()})]})},v=m=>({alert:(0,a.css)`
      & div {
        padding: 4px;
      }
      margin-bottom: 0px;
      margin-top: 5px;
      padding: 2px;
    `,hGroup:(0,a.css)`
      & div {
        width: 100%;
      }
    `});function P(m,D,x,E,C){switch(x.addCustomEditor({id:"modeEditor",path:`${D}mode`,name:"Location Mode",editor:f,settings:{data:C,source:E}}),E?.mode){case n.aG.Coords:x.addFieldNamePicker({path:`${D}latitude`,name:"Latitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}}).addFieldNamePicker({path:`${D}longitude`,name:"Longitude field",settings:{filter:b=>b.type===t.PU.number,noFieldsMessage:"No numeric fields found"}});break;case n.aG.Geohash:x.addFieldNamePicker({path:`${D}geohash`,name:"Geohash field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}});break;case n.aG.Lookup:x.addFieldNamePicker({path:`${D}lookup`,name:"Lookup field",settings:{filter:b=>b.type===t.PU.string,noFieldsMessage:"No strings fields found"}}).addCustomEditor({id:"gazetteer",path:`${D}gazetteer`,name:"Gazetteer",editor:r.G})}}},96606:(_,L,e)=>{"use strict";e.d(L,{RA:()=>c,XR:()=>p,Dc:()=>u,qy:()=>d,Pz:()=>o});var t=e(44294),n=e(34338),r=e(11217),s=e(22796),a=e(11261),g=e(78134);function i(y){if(!y?.length)return;const f=[16,8,4,2,1],v="0123456789bcdefghjkmnpqrstuvwxyz";let P=!0;const m=[],D=[];m[0]=-90,m[1]=90,D[0]=-180,D[1]=180;let x;y.split("").forEach(b=>{x=v.indexOf(b),f.forEach(T=>{l(P?D:m,x,T),P=!P})});const E=(m[0]+m[1])/2;return[(D[0]+D[1])/2,E]}function l(y,f,v){f&v?y[0]=(y[0]+y[1])/2:y[1]=(y[0]+y[1])/2}function d(y){return{name:y.name??"Point",type:a.PU.geo,values:y.values.map(f=>{const v=i(f);if(v)return new t.A((0,s.Rb)(v))}),config:h}}function o(y,f){const v=new Array(y.values.length);for(let P=0;P<y.values.length;P++){const m=y.values[P],D=f.values[P];m===null||D===null||(v[P]=new t.A((0,s.Rb)([m,D])))}return{name:"Point",type:a.PU.geo,values:v,config:h}}function u(y,f){const v=f.values.length,P=new Array(v);for(let m=0;m<v;m++)P[m]=y.find(f.values[m])?.geometry();return{name:"Geometry",type:a.PU.geo,values:P,config:h}}function c(y,f){const v=y.values,P=f.values;if(!v||!P)throw"missing src/dest";if(v.length!==P.length)throw"Source and destination field lengths do not match";const m=y.values.length,D=new Array(m);for(let x=0;x<m;x++){const E=v[x],C=P[x];E&&C?D[x]=new n.A([E,C]):E?D[x]=E:C&&(D[x]=C)}return{name:"Geometry",type:a.PU.geo,values:D,config:h}}function p(y,f){const v=y.values,P=f.values;if(!v||!P)throw"missing src/dest";if(v.length!==P.length)throw"Source and destination field lengths do not match";const m=y.values.length,D=new Array(m);for(let x=0;x<m;x++){const E=v[x],C=P[x];E&&C&&(D[x]=new r.A([(0,g.EX)(E),(0,g.EX)(C)]))}return{name:"Geometry",type:a.PU.geo,values:D,config:h}}const h=Object.freeze({custom:{hideFrom:{tooltip:!0}}})},67140:(_,L,e)=>{"use strict";e.d(L,{fx:()=>y,q3:()=>f});var t=e(70915),n=e(44294),r=e(14236),s=e(11261),a=e(17172),g=e(11365);function i(v){const P=new g.A().readFeatures(v,{featureProjection:"EPSG:3857"}),m=P.length,D=new Array(m).fill(null),x=[],E=new Map,C=R=>{let S=E.get(R);return S||(S={types:new Set,values:new Array(m).fill(null),count:0},x.push(R),E.set(R,S)),S},b=(...R)=>{for(const S of R)if(!E.has(S))return S;return"___"+R[0]},T={types:new Set,values:new Array(m).fill(null),count:0};for(let R=0;R<m;R++){const S=P[R];D[R]=S.getGeometry();const O=S.getId();O!=null&&(T.values[R]=O,T.types.add((0,r.oE)(O)),T.count++);for(const j of S.getKeys()){const B=S.get(j);if(B===D[R]||B==null)continue;const N=C(j);N.values[R]=B,N.types.add((0,r.oE)(B)),N.count++}}const A=[];if(T.count>0){const R=l(T);A.push({name:b("id","_id","__id"),type:R,values:T.values,config:{}})}A.push({name:b("geo","geometry"),type:s.PU.geo,values:D,config:{}});for(const R of x){const S=E.get(R);if(!S)continue;const O=l(S);A.push({name:R,type:O,values:S.values,config:{}})}return{fields:A,length:m}}function l(v){return v.count<1?s.PU.other:v.types.size>1?(v.values=v.values.map(P=>P!=null?`${P}`:P),s.PU.string):v.types.values().next().value}var d=e(96606),o=e(22796);function u(v,P){let m=0;const D=new Map;for(const x of P){const E=new n.A((0,o.Rb)([x.longitude,x.latitude])),C={point:()=>E,geometry:()=>E};if(x.name&&(D.set(x.name,C),D.set(x.name.toUpperCase(),C)),x.key&&(D.set(x.key,C),D.set(x.key.toUpperCase(),C)),x.keys)for(const b of x.keys)D.set(b,C),D.set(b.toUpperCase(),C);m++}return{path:v,find:x=>{let E=D.get(x);return!E&&typeof x=="string"&&(E=D.get(x.toUpperCase())),E},count:m,examples:x=>{const E=[];if(D.size<1)E.push("no values found");else for(const C of D.keys())if(E.push(C),E.length>=x)break;return E}}}function c(v,P){let m;if(Array.isArray(P)){const D=P[0];if(D.latitude&&D.longitude&&(D.key||D.keys))return u(v,P)}else Array.isArray(P?.features)&&P?.type==="FeatureCollection"&&(m=i(P));if(!m)try{m=(0,r.Vc)(P)}catch(D){return{path:v,error:`${D}`,find:x=>{},examples:x=>[]}}return p(m,{path:v})}function p(v,P){const m=[];let D,x,E,C,b;for(const R of v.fields)if(R.type===s.PU.geo&&(D=R),!b&&R.type===s.PU.string&&(b=R),R.name){P.keys&&P.keys.includes(R.name)&&m.push(R);const S=R.name.toUpperCase();switch(S){case"LAT":case"LATITUTE":x=R;break;case"LON":case"LNG":case"LONG":case"LONGITUE":E=R;break;case"GEOHASH":C=R;break;case"ID":case"UID":case"KEY":case"CODE":P.keys||m.push(R);break;default:P.keys||(S.endsWith("_ID")||S.endsWith("_CODE"))&&m.push(R)}}!m.length&&b&&m.push(b);let T=!1;D?T=D.values[0]?.getType()==="Point":C?(D=(0,d.qy)(C),T=!0):x&&E&&(D=(0,d.Pz)(E,x),T=!0);const A=new Map;return m.forEach(R=>{R.values.forEach((S,O)=>{const j=`${S}`;A.set(j.toUpperCase(),O),A.set(j,O)})}),{path:P.path,find:R=>{const S=A.get(R);if(S!=null){const O=D?.values[S];return{frame:v,index:S,point:()=>!O||T?O:new n.A((0,t.q1)(O.getExtent())),geometry:()=>O}}},examples:R=>{const S=[];for(let O of A.keys())if(S.push(O),S.length>R)break;return S},frame:()=>v,count:v.length}}const h={},y="public/gazetteer/countries.json";async function f(v){v||(v=y);let P=h[v];if(!P){try{const m=await(0,a.AI)().get(v);P=c(v,m)}catch(m){console.warn("Error loading placename lookup",v,m),P={path:v,error:"Error loading URL",find:D=>{},examples:D=>[]}}h[v]=P}return P}},31484:(_,L,e)=>{"use strict";e.d(L,{FM:()=>p,nE:()=>u});var t=e(28240),n=e(11261),r=e(85200),s=e(1173),a=e(52622),g=e(96606),i=e(67140);function l(h){return y=>{for(const f of y.fields)if(h(f,y,[]))return f}}function d(h){return y=>{for(const f of y.fields){if(h.has(f.name.toLowerCase()))return f;const v=(0,t.Ct)(f,y);if(h.has(v))return f}}}const o={mode:a.aG.Auto,geohash:d(new Set(["geohash"])),latitude:d(new Set(["latitude","lat"])),longitude:d(new Set(["longitude","lon","lng"])),h3:d(new Set(["h3"])),wkt:d(new Set(["wkt"])),lookup:d(new Set(["lookup"])),geo:h=>h.fields.find(y=>y.type===n.PU.geo)};async function u(h){const y={...o,mode:h?.mode??a.aG.Auto};switch(y.gazetteer=await(0,i.q3)(h?.gazetteer),y.mode){case a.aG.Geohash:h?.geohash?y.geohash=l((0,r.NS)({id:s.Ct.byName,options:h.geohash})):y.geohash=()=>{};break;case a.aG.Lookup:const f=h?.lookup?.length?(0,r.NS)({id:s.Ct.byName,options:h.lookup}):(0,r.NS)({id:s.Ct.byType,options:n.PU.string});y.lookup=l(f);break;case a.aG.Coords:h?.latitude?y.latitude=l((0,r.NS)({id:s.Ct.byName,options:h.latitude})):y.latitude=()=>{},h?.longitude?y.longitude=l((0,r.NS)({id:s.Ct.byName,options:h.longitude})):y.longitude=()=>{};break}return y}function c(h,y){const f={mode:y.mode??a.aG.Auto};if(f.mode===a.aG.Auto){if(f.geo=y.geo(h),f.geo)return f;if(f.latitude=y.latitude(h),f.longitude=y.longitude(h),f.latitude&&f.longitude)return f.mode=a.aG.Coords,f;if(f.geohash=y.geohash(h),f.geohash)return f.mode=a.aG.Geohash,f;if(f.lookup=y.lookup(h),f.lookup)return f.mode=a.aG.Lookup,f}switch(f.mode){case a.aG.Coords:f.latitude=y.latitude(h),f.longitude=y.longitude(h);break;case a.aG.Geohash:f.geohash=y.geohash(h);break;case a.aG.Lookup:f.lookup=y.lookup(h);break}return f}function p(h,y){const f=c(h,y);switch(f.mode){case a.aG.Auto:return f.geo?{field:f.geo}:{warning:"Unable to find location fields"};case a.aG.Coords:return f.latitude&&f.longitude?{field:(0,g.Pz)(f.longitude,f.latitude),derived:!0,description:`${f.mode}: ${f.latitude.name}, ${f.longitude.name}`}:{warning:"Select latitude/longitude fields"};case a.aG.Geohash:return f.geohash?{field:(0,g.qy)(f.geohash),derived:!0,description:`${f.mode}`}:{warning:"Select geohash field"};case a.aG.Lookup:return f.lookup?y.gazetteer?{field:(0,g.Dc)(y.gazetteer,f.lookup),derived:!0,description:`${f.mode}: ${y.gazetteer.path}`}:{warning:"Gazetteer not found"}:{warning:"Select lookup field"}}return{warning:"unable to find geometry"}}},61453:(_,L,e)=>{"use strict";e.d(L,{q:()=>j});var t=e(74848),n=e(2543),r=e(96540),s=e(70713),a=e(18282),g=e(2514),i=e(90708),l=e(13544),d=e(14110),o=e(72574),u=e(55852),c=e(62930),p=e(77093),h=e(2913),y=e(8484),f=e(69147),v=e(28240),P=e(40845),m=e(66864),D=e(88575),x=e(90182),E=e(15292),C=e(7788),b=e(32196);const T=N=>(0,b.css)`
  padding: ${N.spacing(0,2)};
  font-size: ${N.typography.bodySmall.fontSize};
  color: ${N.colors.text.secondary};
  overflow: hidden;
  text-overflow: ellipsis;
`,A=({children:N})=>{const I=(0,P.of)(T);return(0,t.jsx)("div",{className:I,children:N})};var R=e(26323);const S=({options:N,actions:I,formattedDataDescription:K,onOptionsChange:w,hasTransformations:U,data:W,dataFrames:H,transformationOptions:z,selectedDataFrame:G,onDataFrameChange:M,downloadForExcel:Q,toggleDownloadForExcel:Y})=>{const q=(0,P.of)(R.A);let te=H;G===a.F.joinByField&&(te=W);const X=te.map((Z,ae)=>({value:ae,label:`${(0,v.Ri)(Z)} (${ae})`})),ee=[...z,...X];function ne(){let Z="";if(!W)return Z;const ae=[];return G===a.F.joinByField?ae.push((0,y.t)("dashboard.inspect-data.series-to-columns","Series joined by time")):W.length>1&&ae.push((0,v.Ri)(W[G])),(N.withTransforms||N.withFieldConfig)&&(N.withTransforms&&ae.push((0,y.t)("dashboard.inspect-data.panel-transforms","Panel transforms")),N.withTransforms&&N.withFieldConfig,N.withFieldConfig&&ae.push((0,y.t)("dashboard.inspect-data.formatted","Formatted data"))),Q&&ae.push((0,y.t)("dashboard.inspect-data.excel-header","Excel header")),ae.join(", ")}return(0,t.jsx)("div",{className:q.dataDisplayOptions,children:(0,t.jsx)(C.u,{id:"Data options",index:0,title:(0,y.t)("dashboard.inspect-data.data-options","Data options"),headerElement:(0,t.jsx)(A,{children:ne()}),isOpen:!1,actions:I,children:(0,t.jsx)("div",{className:q.options,"data-testid":"dataOptions",children:(0,t.jsxs)(m.gW,{spacing:"none",children:[W.length>1&&(0,t.jsx)(D.D,{label:(0,y.t)("dashboard.inspect-data.dataframe-label","Show data frame"),children:(0,t.jsx)(x.l6,{options:ee,value:G,onChange:M,width:30,"aria-label":(0,y.t)("dashboard.inspect-data.dataframe-aria-label","Select dataframe")})}),(0,t.jsxs)(m.Gy,{children:[U&&w&&(0,t.jsx)(D.D,{label:(0,y.t)("dashboard.inspect-data.transformations-label","Apply panel transformations"),description:(0,y.t)("dashboard.inspect-data.transformations-description","Table data is displayed with transformations defined in the panel Transform tab."),children:(0,t.jsx)(E.d,{value:!!N.withTransforms,onChange:()=>w({...N,withTransforms:!N.withTransforms})})}),w&&(0,t.jsx)(D.D,{label:(0,y.t)("dashboard.inspect-data.formatted-data-label","Formatted data"),description:K||(0,y.t)("dashboard.inspect-data.formatted-data-description","Table data is formatted with options defined in the Field and Override tabs."),children:(0,t.jsx)(E.d,{id:"formatted-data-toggle",value:!!N.withFieldConfig,onChange:()=>w({...N,withFieldConfig:!N.withFieldConfig})})}),(0,t.jsx)(D.D,{label:(0,y.t)("dashboard.inspect-data.download-excel-label","Download for Excel"),description:(0,y.t)("dashboard.inspect-data.download-excel-description","Adds header to CSV for use with Excel"),children:(0,t.jsx)(E.d,{id:"excel-toggle",value:Q,onChange:Y})})]})]})})})})};var O=e(18358);class j extends r.PureComponent{constructor(I){super(I),this.onExportLogsAsTxt=()=>{const{data:K,dataName:w,app:U}=this.props;(0,d.rR)("grafana_logs_download_logs_clicked",{app:U,format:"logs",area:"inspector"});const W=(0,f.HT)(K||[]);(0,O.Zy)(W,w)},this.onExportTracesAsJson=()=>{const{data:K,dataName:w,app:U}=this.props;if(K)for(const W of K){if(W.meta?.preferredVisualisationType!=="trace")continue;const H=(0,O.ek)(W,w+"-traces");(0,d.rR)("grafana_traces_download_traces_clicked",{app:U,grafana_version:h.$W.buildInfo.version,trace_format:H,location:"inspector"})}},this.onExportServiceGraph=()=>{const{data:K,dataName:w,app:U}=this.props;(0,d.rR)("grafana_traces_download_service_graph_clicked",{app:U,grafana_version:h.$W.buildInfo.version,location:"inspector"}),K&&(0,O.ny)(K,w)},this.onDataFrameChange=K=>{this.setState({transformId:K.value===a.F.joinByField?a.F.joinByField:a.F.noop,dataFrameIndex:typeof K.value=="number"?K.value:0,selectedDataFrame:K.value})},this.onToggleDownloadForExcel=()=>{this.setState(K=>({downloadForExcel:!K.downloadForExcel}))},this.state={selectedDataFrame:0,dataFrameIndex:0,transformId:a.F.noop,transformationOptions:B(),transformedData:I.data??[],downloadForExcel:!1}}componentDidUpdate(I,K){if(!this.props.data){this.setState({transformedData:[]});return}if(this.props.options.withTransforms){this.setState({transformedData:this.props.data});return}if(I.data!==this.props.data||K.transformId!==this.state.transformId){const w=this.state.transformationOptions.find(U=>U.value===this.state.transformId);if(w&&w.transformer.id!==a.F.noop){const U=this.state.selectedDataFrame,W=this.state.dataFrameIndex,H=(0,g.m)([w.transformer],this.props.data).subscribe(z=>{this.setState({transformedData:z,selectedDataFrame:U,dataFrameIndex:W},()=>H.unsubscribe())});return}this.setState({transformedData:this.props.data});return}}exportCsv(I,K){const{dataName:w}=this.props,{transformId:U}=this.state,W=I[this.state.dataFrameIndex];K&&(0,d.rR)("grafana_logs_download_clicked",{app:this.props.app,format:"csv"}),(0,O.EM)(W,w,{useExcelHeader:this.state.downloadForExcel},U)}getProcessedData(){const{options:I,panelPluginId:K,fieldConfig:w,timeZone:U}=this.props,W=this.state.transformedData;if(!I.withFieldConfig)return(0,i.K3)(W);let H=w??{defaults:{},overrides:[]};return K==="table"&&w&&(H=this.cleanTableConfigFromFieldConfig(w)),(0,i.we)({data:W,theme:h.$W.theme2,fieldConfig:H,timeZone:U,replaceVariables:(z,G,M)=>(0,o.w)().replace(z,G,M)})}cleanTableConfigFromFieldConfig(I){I=(0,n.cloneDeep)(I),I.defaults.custom={};for(const K of I.overrides)for(const w of K.properties)if(w.id.startsWith("custom.")){const U=K.properties.indexOf(w);K.properties.slice(U,1)}return I}renderActions(I,K,w,U){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.$n,{variant:"primary",onClick:()=>this.exportCsv(I,K),size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-csv",children:"Download CSV"})}),K&&(0,t.jsx)(u.$n,{variant:"primary",onClick:this.onExportLogsAsTxt,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-logs",children:"Download logs"})}),w&&(0,t.jsx)(u.$n,{variant:"primary",onClick:this.onExportTracesAsJson,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-traces",children:"Download traces"})}),U&&(0,t.jsx)(u.$n,{variant:"primary",onClick:this.onExportServiceGraph,size:"sm",children:(0,t.jsx)(y.x6,{i18nKey:"dashboard.inspect-data.download-service",children:"Download service graph"})})]})}render(){const{isLoading:I,options:K,data:w,formattedDataDescription:U,onOptionsChange:W,hasTransformations:H}=this.props,{dataFrameIndex:z,transformationOptions:G,selectedDataFrame:M,downloadForExcel:Q}=this.state,Y=(0,R.c)();if(I)return(0,t.jsxs)("div",{children:[(0,t.jsx)(c.y,{inline:!0})," Loading"]});const q=this.getProcessedData();if(!q||!q.length)return(0,t.jsx)("div",{children:"No Data"});const te=q[z]?z:0,X=q[te],ee=q.some(ae=>ae?.meta?.preferredVisualisationType==="logs"),ne=q.some(ae=>ae?.meta?.preferredVisualisationType==="trace"),Z=q.some(ae=>ae?.meta?.preferredVisualisationType==="nodeGraph");return(0,t.jsxs)("div",{className:Y.wrap,"aria-label":l.Tp.components.PanelInspector.Data.content,children:[(0,t.jsx)("div",{className:Y.toolbar,children:(0,t.jsx)(S,{data:w,hasTransformations:H,options:K,dataFrames:q,transformationOptions:G,selectedDataFrame:M,downloadForExcel:Q,formattedDataDescription:U,onOptionsChange:W,onDataFrameChange:this.onDataFrameChange,toggleDownloadForExcel:this.onToggleDownloadForExcel,actions:this.renderActions(q,ee,ne,Z)})}),(0,t.jsx)("div",{className:Y.content,children:(0,t.jsx)(s.Ay,{children:({width:ae,height:re})=>ae===0?null:(0,t.jsx)(p.X,{width:ae,height:re,data:X,showTypeIcons:!0})})})]})}}function B(){return[{value:a.F.joinByField,label:(0,y.t)("dashboard.inspect-data.transformation","Series joined by time"),transformer:{id:a.F.joinByField,options:{byField:void 0}}}]}},32067:(_,L,e)=>{"use strict";e.d(L,{N:()=>h});var t=e(74848),n=e(32196),r=e(13544),s=e(8484),a=e(57875),g=e(11261),i=e(83195),l=e(40845);const d=({timeZone:f,name:v,stats:P})=>{const m=(0,l.$j)(),D=(0,l.of)(u);return!P||!P.length?null:(0,t.jsxs)("div",{className:D.wrapper,children:[(0,t.jsx)("div",{className:D.heading,children:v}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:P.map((x,E)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:x.displayName}),(0,t.jsx)("td",{className:D.cell,children:o(x,f,m)})]},`${x.displayName}-${E}`))})})]})};function o(f,v,P){const m=(0,a.J)({field:{type:g.PU.number,config:f},theme:P,timeZone:v});return(0,i.cN)(m(f.value))}const u=f=>({heading:(0,n.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,n.css)({paddingBottom:f.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),c=({name:f,traceIds:v})=>{const P=(0,l.of)(p);return v.length===0?null:(0,t.jsxs)("div",{className:P.wrapper,children:[(0,t.jsx)("div",{className:P.heading,children:f}),(0,t.jsx)("table",{className:"filter-table width-30",children:(0,t.jsx)("tbody",{children:v.map((m,D)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:m})},`${m}-${D}`))})})]})},p=f=>({heading:(0,n.css)({fontSize:f.typography.body.fontSize,marginBottom:f.spacing(1)}),wrapper:(0,n.css)({paddingBottom:f.spacing(2)}),cell:(0,n.css)({textAlign:"right"})}),h=({data:f,timeZone:v})=>{if(!f.request)return null;let P=[];const m=f.request.endTime?f.request.endTime-f.request.startTime:-1,D=f.timings?.dataProcessingTime||-1;let x=0;for(const A of f.series)x+=A.length;m>0&&P.push({displayName:(0,s.t)("dashboard.inspect-stats.request-time","Total request time"),value:m,unit:"ms"}),D>0&&P.push({displayName:(0,s.t)("dashboard.inspect-stats.processing-time","Data processing time"),value:D,unit:"ms"}),P.push({displayName:(0,s.t)("dashboard.inspect-stats.queries","Number of queries"),value:f.request.targets?.length??0}),P.push({displayName:(0,s.t)("dashboard.inspect-stats.rows","Total number rows"),value:x});let E=[];for(const A of f.series)A.meta&&A.meta.stats&&(E=E.concat(A.meta.stats));const C=(0,s.t)("dashboard.inspect-stats.table-title","Stats"),b=(0,s.t)("dashboard.inspect-stats.data-title","Data source stats"),T=(0,s.t)("dashboard.inspect-stats.data-traceids","Trace IDs");return(0,t.jsxs)("div",{"aria-label":r.Tp.components.PanelInspector.Stats.content,className:y,children:[(0,t.jsx)(d,{timeZone:v,name:C,stats:P}),(0,t.jsx)(d,{timeZone:v,name:b,stats:E}),(0,t.jsx)(c,{name:T,traceIds:f.traceIds??[]})]})},y=(0,n.css)`
  height: 100%;
  overflow-y: scroll;
`},90820:(_,L,e)=>{"use strict";e.d(L,{e:()=>f});var t=e(74848),n=e(32196),r=e(96540),s=e(64423),a=e(39070),g=e(13544),i=e(32264),l=e(67061),d=e(55852),o=e(10534),u=e(39558),c=e(24022),p=e(8484),h=e(27677),y=e(26323);class f extends r.PureComponent{constructor(P){super(P),this.subs=new s.yU,this.setFormattedJson=m=>{this.formattedJson=m},this.getTextForClipboard=()=>JSON.stringify(this.formattedJson,null,2),this.onToggleExpand=()=>{this.setState(m=>({...m,allNodesExpanded:!this.state.allNodesExpanded}))},this.onToggleMocking=()=>{this.setState(m=>({...m,isMocking:!this.state.isMocking}))},this.getNrOfOpenNodes=()=>this.state.allNodesExpanded===null?3:this.state.allNodesExpanded?20:1,this.state={executedQueries:[],allNodesExpanded:null,isMocking:!1,mockedResponse:"",response:{}}}componentDidMount(){this.subs.add(h.IB.getInspectorStream().subscribe({next:P=>{let m=!0;if(this.props.instanceId&&P?.requestId&&(m=P.requestId.startsWith(this.props.instanceId)),m)return this.onDataSourceResponse(P.response)}}))}componentDidUpdate(P){this.props.data!==P.data&&this.updateQueryList()}updateQueryList(){const{data:P}=this.props,m=P.series,D=[];if(m?.length){let x;m.forEach((E,C)=>{const b=E.meta?.executedQueryString;if(b){const T=E.refId||"?";x?.refId===T?(x.frames++,x.rows+=E.length):(x={refId:T,frames:0,rows:E.length,query:b},D.push(x))}})}this.setState({executedQueries:D})}componentWillUnmount(){this.subs.unsubscribe()}onDataSourceResponse(P){P.config?.hideFromInspector||(P={...P},P.headers&&delete P.headers,P.config&&(P.request=P.config,delete P.config,delete P.request.transformRequest,delete P.request.transformResponse,delete P.request.paramSerializer,delete P.request.jsonpCallbackParam,delete P.request.headers,delete P.request.requestId,delete P.request.inspect,delete P.request.retry,delete P.request.timeout),P.data&&(P.response=P.data,delete P.config,delete P.data,delete P.status,delete P.statusText,delete P.ok,delete P.url,delete P.redirected,delete P.type,delete P.$$config),this.setState({response:P}))}renderExecutedQueries(P){if(!P.length)return null;const m={refId:(0,n.css)`
        font-weight: ${i.$.theme.typography.weight.semibold};
        color: ${i.$.theme.colors.textBlue};
        margin-right: 8px;
      `};return(0,t.jsx)("div",{children:P.map(D=>(0,t.jsxs)(l.B,{gap:1,direction:"column",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("span",{className:m.refId,children:[D.refId,":"]}),D.frames>1&&(0,t.jsxs)("span",{children:[D.frames," frames, "]}),(0,t.jsxs)("span",{children:[D.rows," rows"]})]}),(0,t.jsx)("pre",{children:D.query})]},D.refId))})}render(){const{allNodesExpanded:P,executedQueries:m,response:D}=this.state,{onRefreshQuery:x,data:E}=this.props,C=this.getNrOfOpenNodes(),b=(0,y.A)(i.$.theme2),T=Object.keys(D).length>0,A=E.state===a.Gu.Loading;return(0,t.jsxs)("div",{className:b.wrap,children:[(0,t.jsxs)("div",{"aria-label":g.Tp.components.PanelInspector.Query.content,children:[(0,t.jsx)("h3",{className:b.heading,children:"Query inspector"}),(0,t.jsx)("p",{className:"small muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.description",children:"Query inspector allows you to view raw request and response. To collect this data Grafana needs to issue a new query. Click refresh button below to trigger a new query."})})]}),this.renderExecutedQueries(m),(0,t.jsxs)("div",{className:b.toolbar,children:[(0,t.jsx)(d.$n,{icon:"sync",onClick:x,"aria-label":g.Tp.components.PanelInspector.Query.refreshButton,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.refresh",children:"Refresh"})}),T&&P&&(0,t.jsx)(d.$n,{icon:"minus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.collapse-all",children:"Collapse all"})}),T&&!P&&(0,t.jsx)(d.$n,{icon:"plus",variant:"secondary",className:b.toolbarItem,onClick:this.onToggleExpand,children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.expand-all",children:"Expand all"})}),T&&(0,t.jsx)(o.b,{getText:this.getTextForClipboard,className:b.toolbarItem,icon:"copy",variant:"secondary",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.copy-to-clipboard",children:"Copy to clipboard"})}),(0,t.jsx)("div",{className:"flex-grow-1"})]}),(0,t.jsxs)("div",{className:b.content,children:[A&&(0,t.jsx)(u._,{text:"Loading query inspector..."}),!A&&T&&(0,t.jsx)(c.B,{json:D,open:C,onDidRender:this.setFormattedJson}),!A&&!T&&(0,t.jsx)("p",{className:"muted",children:(0,t.jsx)(p.x6,{i18nKey:"inspector.query.no-data",children:"No request and response collected yet. Hit refresh button"})})]})]})}}},26323:(_,L,e)=>{"use strict";e.d(L,{A:()=>a,c:()=>s});var t=e(32196),n=e(3911),r=e(2913);const s=(0,n.N)(()=>a(r.$W.theme2)),a=g=>({heading:(0,t.css)({fontSize:g.typography.body.fontSize,marginBottom:g.spacing(1)}),wrap:(0,t.css)({display:"flex",flexDirection:"column",height:"100%",width:"100%",flex:"1 1 0",minHeight:0}),toolbar:(0,t.css)({display:"flex",width:"100%",flexGrow:0,alignItems:"center",justifyContent:"flex-end",marginBottom:g.v1.spacing.sm}),toolbarItem:(0,t.css)({marginLeft:g.v1.spacing.md}),content:(0,t.css)({flexGrow:1,height:"100%"}),editor:(0,t.css)({fontFamily:"monospace",height:"100%",flexGrow:1}),viewer:(0,t.css)({overflow:"scroll"}),dataFrameSelect:(0,t.css)({flexGrow:2}),leftActions:(0,t.css)({display:"flex",flexGrow:1,maxWidth:"85%","@media (max-width: 1345px)":{maxWidth:"75%"}}),options:(0,t.css)({paddingTop:g.v1.spacing.sm}),dataDisplayOptions:(0,t.css)({flexGrow:1,minWidth:"300px",marginRight:g.v1.spacing.sm}),selects:(0,t.css)({display:"flex","> *":{marginRight:g.v1.spacing.sm}})})},16560:(_,L,e)=>{"use strict";e.d(L,{q:()=>t});var t=(n=>(n.Data="data",n.Meta="meta",n.Error="error",n.Stats="stats",n.JSON="json",n.Query="query",n.Help="help",n))(t||{})},18358:(_,L,e)=>{"use strict";e.d(L,{ny:()=>N,EM:()=>B,Zy:()=>j,ek:()=>I});var t=e(4213),n=e.n(t),r=e(72724),s=e(18282),a=e(72436),g=e(37471),i=e(19071),l=e(2543);const o=Object.defineProperty({archiveEnabled:!1,dependencies:{dagMaxNumServices:100,menuEnabled:!0},linkPatterns:[],search:{maxLookback:{label:"2 Days",value:"2d"},maxLimit:1500},tracking:{gaID:null,trackErrors:!0}},"__mergeFields",{value:["dependencies","search","tracking"]});function u(){return defaultConfig}function c(K){return _get(u(),K)}function p(K){let w;const U=new Set(K.map(({spanID:W})=>W));for(let W=0;W<K.length;W++){if(K[W].references&&K[W].references.some(({traceID:M,spanID:Q})=>M===K[W].traceID&&U.has(Q)))continue;if(!w){w=K[W];continue}const z=K[W].references&&K[W].references.length||0,G=w.references&&w.references.length||0;(z<G||z===G&&K[W].startTime<w.startTime)&&(w=K[W])}return w?`${w.process.serviceName}: ${w.operationName}`:""}const h=(0,l.memoize)(p,K=>K.length?K[0].traceID:0);function y(K){const w=new Map,U=K.reduce((H,z)=>(H.some(G=>G.key===z.key&&G.value===z.value)?w.set(`${z.key}:${z.value}`,`Duplicate tag "${z.key}:${z.value}"`):H.push(z),H),[]),W=Array.from(w.values());return{dedupedTags:U,warnings:W}}function f(K,w){const U=K?.slice()??[],W=(w||[]).map(H=>H.toLowerCase());return U.sort((H,z)=>{const G=H.key.toLowerCase(),M=z.key.toLowerCase();for(let Q=0;Q<W.length;Q++){const Y=W[Q];if(G.startsWith(Y)&&!M.startsWith(Y))return-1;if(!G.startsWith(Y)&&M.startsWith(Y))return 1}return G>M?1:G<M?-1:0}),U}function v(K){if(!K?.traceID)return null;const w=K.traceID.toLowerCase();let U=0,W=Number.MAX_SAFE_INTEGER;const H=new Map,z=new Map;K.spans=K.spans.filter(X=>!!X.startTime),K.processes=Object.entries(K.processes).reduce((X,[ee,ne])=>(X[ee]={...ne,tags:f(ne.tags)},X),{});const G=K.spans.length;for(let X=0;X<G;X++){const ee=K.spans[X],{startTime:ne,duration:Z,processID:ae}=ee;let re=ee.spanID;ne<W&&(W=ne),ne+Z>U&&(U=ne+Z);const se=H.get(re);se!=null?(console.warn(`Dupe spanID, ${se+1} x ${re}`,ee,z.get(re)),_isEqual(ee,z.get(re))&&console.warn("	 two spans with same ID have `isEqual(...) === true`"),H.set(re,se+1),re=`${re}_${se}`,ee.spanID=re):H.set(re,1),ee.process=K.processes[ae],z.set(re,ee)}const M=getTraceSpanIdsAsTree(K,z),Q=[],Y={};M.walk((X,ee,ne=0)=>{if(X==="__root__"||typeof X!="string")return;const Z=z.get(X);if(!Z)return;const{serviceName:ae}=Z.process;Y[ae]=(Y[ae]||0)+1,Z.relativeStartTime=Z.startTime-W,Z.depth=ne-1,Z.hasChildren=ee.children.length>0,Z.childSpanCount=ee.children.length,Z.warnings=Z.warnings||[],Z.tags=Z.tags||[],Z.references=Z.references||[],Z.childSpanIds=ee.children.slice().sort((se,de)=>{const le=z.get(se.value),he=z.get(de.value);return he.startTime+he.duration-(le.startTime+le.duration)}).map(se=>se.value);const re=y(Z.tags);Z.tags=f(re.dedupedTags,getConfigValue("topTagPrefixes")),Z.warnings=Z.warnings.concat(re.warnings),Z.references.forEach((se,de)=>{const le=z.get(se.spanID);le&&(se.span=le,de>0&&(le.subsidiarilyReferencedBy=le.subsidiarilyReferencedBy||[],le.subsidiarilyReferencedBy.push({spanID:X,traceID:w,span:Z,refType:se.refType})))}),Q.push(Z)});const q=getTraceName(Q);return{services:Object.keys(Y).map(X=>({name:X,numberOfSpans:Y[X]})),spans:Q,traceID:w,traceName:q,processes:K.processes,duration:U-W,startTime:W,endTime:U}}function P(K){const w=K.spans.map(W=>m(W,K.processes)),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string},{name:"spanID",type:FieldType.string},{name:"parentSpanID",type:FieldType.string},{name:"operationName",type:FieldType.string},{name:"serviceName",type:FieldType.string},{name:"serviceTags",type:FieldType.other},{name:"startTime",type:FieldType.number},{name:"duration",type:FieldType.number},{name:"logs",type:FieldType.other},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other},{name:"warnings",type:FieldType.other},{name:"stackTraces",type:FieldType.other}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"jaeger"}}});for(const W of w)U.add(W);return U}function m(K,w){const U=K.references?.find(W=>W.refType==="CHILD_OF")?.spanID;return{spanID:K.spanID,traceID:K.traceID,parentSpanID:U,operationName:K.operationName,startTime:K.startTime/1e3,duration:K.duration/1e3,logs:K.logs.map(W=>({...W,timestamp:W.timestamp/1e3})),tags:K.tags,warnings:K.warnings??void 0,stackTraces:K.stackTraces,references:K.references?.filter(W=>W.spanID!==U)??[],serviceName:w[K.processID].serviceName,serviceTags:w[K.processID].tags}}function D(K,w){const U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:w.uid,datasourceName:w.name,query:{query:"${__value.raw}"}}}]}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace name"}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"\xB5s"}}],meta:{preferredVisualisationType:"table"}}),W=K.map(x).sort((H,z)=>z?.startTime-H?.startTime);for(const H of W)U.add(H);return U}function x(K){const w=transformTraceData(K);if(w)return{traceID:w.traceID,startTime:w.startTime/1e3,duration:w.duration,traceName:w.traceName}}function E(K){let w={traceID:"",spans:[],processes:{},warnings:null},U=[];for(let W=0;W<K.length;W++){const H=K.get(W);w.traceID||(w.traceID=H.traceID),U.find(z=>z===H.serviceName)||(U.push(H.serviceName),w.processes[`p${U.length}`]={serviceName:H.serviceName,tags:H.serviceTags}),w.spans.push({traceID:H.traceID,spanID:H.spanID,duration:H.duration*1e3,references:H.parentSpanID?[{refType:"CHILD_OF",spanID:H.parentSpanID,traceID:H.traceID}]:[],flags:0,logs:H.logs.map(z=>({...z,timestamp:z.timestamp*1e3})),operationName:H.operationName,processID:Object.keys(w.processes).find(z=>w.processes[z].serviceName===H.serviceName)||"",startTime:H.startTime*1e3,tags:H.tags,warnings:H.warnings?H.warnings:null})}return{data:[w],total:0,limit:0,offset:0,errors:null}}function C(K){const w=K.map(b),U=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"zipkin"}}});for(const W of w)U.add(W);return U}function b(K){const w={traceID:K.traceId,spanID:K.id,parentSpanID:K.parentId,operationName:K.name,serviceName:K.localEndpoint?.serviceName||K.remoteEndpoint?.serviceName||"unknown",serviceTags:A(K),startTime:K.timestamp/1e3,duration:K.duration/1e3,logs:K.annotations?.map(T)??[],tags:Object.keys(K.tags||{}).reduce((U,W)=>W==="error"?(U.push({key:"error",value:!0}),U.push({key:"errorValue",value:K.tags.error}),U):(U.push({key:W,value:K.tags[W]}),U),[])};return K.kind&&(w.tags=[{key:"kind",value:K.kind},...w.tags??[]]),K.shared&&(w.tags=[{key:"shared",value:K.shared},...w.tags??[]]),w}function T(K){return{timestamp:K.timestamp,fields:[{key:"annotation",value:K.value}]}}function A(K){const w=K.localEndpoint||K.remoteEndpoint;return w?[R("ipv4",w.ipv4),R("ipv6",w.ipv6),R("port",w.port),R("endpointType",K.localEndpoint?"local":"remote")].filter(U=>!!U):[]}function R(K,w){if(w)return{key:K,value:w}}const S=K=>{let w=[];for(let U=0;U<K.length;U++){const W=K.get(U);w.push({traceId:W.traceID,parentId:W.parentSpanID,name:W.operationName,id:W.spanID,timestamp:W.startTime*1e3,duration:W.duration*1e3,...O(W),annotations:W.logs.length?W.logs.map(H=>({timestamp:H.timestamp,value:H.fields[0].value})):void 0,tags:W.tags.length?W.tags.filter(H=>H.key!=="kind"&&H.key!=="endpointType"&&H.key!=="shared").reduce((H,z)=>z.key==="error"?{...H,[z.key]:W.tags.find(G=>G.key==="errorValue").value||""}:{...H,[z.key]:z.value},{}):void 0,kind:W.tags.find(H=>H.key==="kind")?.value,shared:W.tags.find(H=>H.key==="shared")?.value})}return w},O=K=>{const w=K.serviceTags.find(U=>U.key==="endpointType")?.value==="local"?"localEndpoint":"remoteEndpoint";return K.serviceName!=="unknown"?{[w]:{serviceName:K.serviceName,ipv4:K.serviceTags.find(U=>U.key==="ipv4")?.value,ipv6:K.serviceTags.find(U=>U.key==="ipv6")?.value,port:K.serviceTags.find(U=>U.key==="port")?.value}}:void 0};function j(K,w){let U="";K.meta?.forEach(z=>{const G=`${z.label}: ${JSON.stringify(z.value)}
`;U=U+G}),U=U+`

`,K.rows.forEach(z=>{const G=(0,r.LE)(z.timeEpochMs,{defaultWithMS:!0})+"	"+z.entry+`
`;U=U+G});const W=new Blob([U],{type:"text/plain;charset=utf-8"}),H=`${w}-logs-${(0,r.LE)(new Date)}.txt`;n()(W,H)}function B(K,w,U,W=s.F.noop){const H=(0,a._O)([K],U),z=U?.useExcelHeader?"\uFEFF":"",G=new Blob([z,H],{type:"text/csv;charset=utf-8"}),M=W!==s.F.noop?"-as-"+W.toLocaleLowerCase():"",Q=`${w}-data${M}-${(0,r.LE)(new Date)}.csv`;n()(G,Q)}function N(K,w){const U=new Blob([JSON.stringify(K)],{type:"application/json"}),W=`${w}-${(0,r.LE)(new Date)}.json`;n()(U,W)}function I(K,w){let U="otlp";switch(K.meta?.custom?.traceFormat){case"jaeger":{let W=E(new g.k(K));N(W,w),U="jaeger";break}case"zipkin":{let W=S(new g.k(K));N(W,w),U="zipkin";break}case"otlp":default:{let W=(0,i.xw)(new g.k(K));N(W,w);break}}return U}},77938:(_,L,e)=>{"use strict";e.d(L,{p:()=>r});var t=e(26272),n=e(28138);function r(a){let g="";try{g=JSON.stringify(a,s(),2)}catch(i){i instanceof Error&&(i.toString().includes("RangeError")||i.toString().includes("allocation size overflow"))?n.A.emit(t.r1.alertError,[i.toString(),"Cannot display JSON, the object is too big."]):n.A.emit(t.r1.alertError,[i instanceof Error?i.toString():i])}return g}function s(){const a=new WeakSet;return(g,i)=>{if(g==="__dataContext"||g==="__sceneObject")return"Filtered out in JSON serialization";if(typeof i=="object"&&i!==null){if(a.has(i))return;a.add(i)}return i}}},47259:(_,L,e)=>{"use strict";e.d(L,{G7:()=>s,KU:()=>a,eb:()=>g});var t=e(17172),n=e(10096),r=e(31678);const s=(0,r.createAsyncThunk)("users/fetchInvitees",async()=>n.TP.hasPermission(r.AccessControlAction.OrgUsersAdd)?await(0,t.AI)().get("/api/org/invites"):[]),a=(0,r.createAsyncThunk)("users/addInvitee",async(i,{dispatch:l})=>{await(0,t.AI)().post("/api/org/invites",i),await l(s())}),g=(0,r.createAsyncThunk)("users/revokeInvite",async i=>(await(0,t.AI)().patch(`/api/org/invites/${i}/revoke`,{}),i))},40823:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>l,Tp:()=>s});var t=e(65307),n=e(47259);const r=(0,t.pU)({selectId:d=>d.code}),s=r.getSelectors(),a=r.getInitialState({status:"idle"}),l={invites:(0,t.Z0)({name:"invites",initialState:a,reducers:{},extraReducers:d=>{d.addCase(n.G7.pending,o=>{o.status="loading"}).addCase(n.G7.fulfilled,(o,{payload:u})=>{r.setAll(o,u),o.status="succeeded"}).addCase(n.G7.rejected,o=>{o.status="failed"}).addCase(n.eb.fulfilled,(o,{payload:u})=>{r.removeOne(o,u),o.status="succeeded"})}}).reducer}},96227:(_,L,e)=>{"use strict";e.d(L,{b:()=>f,o:()=>v});var t=e(74848),n=e(96540),r=e(40996),s=e(16817),a=e(17172),g=e(32264),i=e(88575),l=e(10354),d=e(67061),o=e(55852),u=e(37390),c=e(36607),p=e(8484),h=e(57767),y=e(88861);const f=({panel:P,initialFolderUid:m,onCreateLibraryPanel:D,onDismiss:x})=>{const[E,C]=(0,n.useState)(m),[b,T]=(0,n.useState)(P.title),[A,R]=(0,n.useState)(P.title),[S,O]=(0,n.useState)(!1);(0,n.useEffect)(()=>O(!0),[b]),(0,r.A)(()=>R(b),350,[b]);const{saveLibraryPanel:j}=(0,y.b)(),B=(0,n.useCallback)(()=>{P.libraryPanel={uid:"",name:b},j(P,E).then(K=>{(0,a.NF)(K)?P.libraryPanel=void 0:(x?.(),D?.(K))})},[P,b,j,E,x,D]),N=(0,s.A)(async()=>{try{return!(await(0,h.e9)(b)).some(K=>K.folderUid===E)}catch(K){return(0,a.NF)(K)&&(K.isHandled=!0),!0}finally{O(!1)}},[A,E]);console.log("isValidName:",N);const I=!N?.value&&N.value!==void 0&&b===A&&!S;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.D,{label:(0,p.t)("library-panel.add-modal.name","Library panel name"),invalid:I,error:I?(0,p.t)("library-panel.add-modal.error","Library panel with this name already exists"):"",children:(0,t.jsx)(l.p,{id:"share-panel-library-panel-name-input",name:"name",value:b,onChange:K=>T(K.currentTarget.value)})}),(0,t.jsx)(i.D,{label:(0,p.t)("library-panel.add-modal.folder","Save in folder"),description:(0,p.t)("library-panel.add-modal.folder-description","Library panel permissions are derived from the folder permissions"),children:(0,t.jsx)(c.d,{onChange:K=>C(K),value:E,inputId:"share-panel-library-panel-folder-picker"})}),g.$.featureToggles.newDashboardSharingComponent?(0,t.jsxs)(d.B,{gap:1,justifyContent:"start",children:[(0,t.jsx)(o.$n,{onClick:B,disabled:I,children:(0,t.jsx)(p.x6,{i18nKey:"share-panel.new-library-panel.create-button",children:"Create library panel"})}),(0,t.jsx)(o.$n,{variant:"secondary",onClick:x,fill:"outline",children:(0,t.jsx)(p.x6,{i18nKey:"share-panel.new-library-panel.cancel-button",children:"Cancel"})})]}):(0,t.jsxs)(u.a.ButtonRow,{children:[(0,t.jsx)(o.$n,{variant:"secondary",onClick:x,fill:"outline",children:(0,t.jsx)(p.x6,{i18nKey:"library-panel.add-modal.cancel",children:"Cancel"})}),(0,t.jsx)(o.$n,{onClick:B,disabled:I,children:(0,t.jsx)(p.x6,{i18nKey:"library-panel.add-modal.create",children:"Create library panel"})})]})]})},v=({isOpen:P=!1,panel:m,initialFolderUid:D,...x})=>(0,t.jsx)(u.a,{title:"Create library panel",isOpen:P,onDismiss:x.onDismiss,children:(0,t.jsx)(f,{panel:m,initialFolderUid:D,onDismiss:x.onDismiss})})},86474:(_,L,e)=>{"use strict";e.d(L,{E:()=>O});var t=e(74848),n=e(32196),r=e(96540),s=e(70255),a=e(32264),g=e(40845),i=e(14578),l=e(50720),d=e(72129),o=e(41394),u=e(25701),c=e(39070),p=e(37390),h=e(55852),y=e(43535),f=e(38928),v=e(57767),P=e(65307);const m={loadingState:c.Gu.Loading,dashboardTitles:[]},D=(0,P.VP)("libraryPanels/delete/searchCompleted"),x=(N=m,I)=>D.match(I)?{...N,dashboardTitles:I.payload.dashboards.map(K=>K.title),loadingState:c.Gu.Done}:N;function E(N){return async function(I){const K=await(0,v.xV)(N.uid);I(D({dashboards:K}))}}const C=({libraryPanel:N,onDismiss:I,onConfirm:K})=>{const w=(0,g.of)(y.o),[{dashboardTitles:U,loadingState:W},H]=(0,r.useReducer)(x,m),z=(0,r.useMemo)(()=>(0,f.QC)(H),[H]);(0,r.useEffect)(()=>{z(E(N))},[z,N]);const G=!!U.length,M=W===c.Gu.Done;return(0,t.jsxs)(p.a,{className:w.modal,title:"Delete library panel",icon:"trash-alt",onDismiss:I,isOpen:!0,children:[M?null:(0,t.jsx)(b,{}),M?(0,t.jsxs)("div",{children:[G?(0,t.jsx)(A,{dashboardTitles:U}):null,G?null:(0,t.jsx)(T,{}),(0,t.jsxs)(p.a.ButtonRow,{children:[(0,t.jsx)(h.$n,{variant:"secondary",onClick:I,fill:"outline",children:"Cancel"}),(0,t.jsx)(h.$n,{variant:"destructive",onClick:K,disabled:G,children:"Delete"})]})]}):null]})},b=()=>(0,t.jsx)("span",{children:"Loading library panel..."}),T=()=>{const N=(0,g.of)(y.o);return(0,t.jsx)("div",{className:N.modalText,children:"Do you want to delete this panel?"})},A=({dashboardTitles:N})=>{const I=(0,g.of)(y.o),K=N.length===1?"dashboard.":"dashboards.",w=`${N.length} ${K}`;return N.length===0?null:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{className:I.textInfo,children:["This library panel can not be deleted because it is connected to ",(0,t.jsx)("strong",{children:w})," Remove the library panel from the dashboards listed below and retry."]}),(0,t.jsxs)("table",{className:I.myTable,children:[(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{children:(0,t.jsx)("th",{children:"Dashboard name"})})}),(0,t.jsx)("tbody",{children:N.map((U,W)=>(0,t.jsx)("tr",{children:(0,t.jsx)("td",{children:U})},`dash-title-${W}`))})]})]})},R=({libraryPanel:N,onClick:I,onDelete:K,showSecondaryActions:w})=>{const[U,W]=(0,r.useState)(!1),H=()=>{K?.(N),W(!1)},z=a.$.panels[N.model.type]??(0,o.$)(N.model.type).meta;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.b,{isCurrent:!1,title:N.name,description:N.description,plugin:z,onClick:()=>I?.(N),onDelete:w?()=>W(!0):void 0,children:(0,t.jsx)(j,{libraryPanel:N})}),U&&(0,t.jsx)(C,{libraryPanel:N,onConfirm:H,onDismiss:()=>W(!1)})]})},S=({showSecondaryActions:N,rootProps:I})=>{const K=(0,g.of)(B);return(0,t.jsx)(u.b.Skeleton,{hasDelete:N,...I,children:(0,t.jsx)(s.A,{containerClassName:K.metaContainer,width:80})})},O=(0,d.j)(R,S);function j({libraryPanel:N}){const I=(0,g.of)(B);return!N.meta?.folderUid&&!N.meta?.folderName?null:N.meta.folderUid?(0,t.jsx)("span",{className:I.metaContainer,children:(0,t.jsxs)(l.N,{href:`/dashboards/f/${N.meta.folderUid}`,children:[(0,t.jsx)(i.I,{name:"folder-upload",size:"sm"}),(0,t.jsx)("span",{children:N.meta.folderName})]})}):(0,t.jsxs)("span",{className:I.metaContainer,children:[(0,t.jsx)(i.I,{name:"folder",size:"sm"}),(0,t.jsx)("span",{children:"Dashboards"})]})}function B(N){return{metaContainer:(0,n.css)({display:"flex",alignItems:"center",color:N.colors.text.secondary,fontSize:N.typography.bodySmall.fontSize,paddingTop:N.spacing(.5),svg:{marginRight:N.spacing(.5),marginBottom:3}})}}},16678:(_,L,e)=>{"use strict";e.d(L,{j:()=>b,s:()=>C});var t=e(74848),n=e(32196),r=e(96540),s=e(40996),a=e(40845),g=e(66864),i=e(67647),l=e(76459),d=e.n(l),o=e(55852),u=e(90182),c=e(14578),p=e(27677),h=e(64161),y=e(31678);function f({onChange:S,maxMenuHeight:O}){const j=(0,a.of)(P),[B,N]=(0,r.useState)(!1),I=(0,r.useCallback)(H=>v(H,N),[]),K=(0,r.useMemo)(()=>d()(I,300),[I]),[w,U]=(0,r.useState)([]),W=(0,r.useCallback)(H=>{const z=H.filter(G=>!!G.value).map(G=>G.value);S(z),U(H)},[S]);return(0,t.jsxs)("div",{className:j.container,children:[w.length>0&&(0,t.jsx)(o.$n,{size:"xs",icon:"trash-alt",fill:"text",className:j.clear,onClick:()=>S([]),"aria-label":"Clear folders",children:"Clear folders"}),(0,t.jsx)(u.Iv,{value:w,onChange:W,isLoading:B,loadOptions:K,maxMenuHeight:O,placeholder:"Filter by folder",noOptionsMessage:"No folders found",prefix:(0,t.jsx)(c.I,{name:"filter"}),"aria-label":"Folder filter",defaultOptions:!0})]})}async function v(S,O){O(!0);const j={query:S,type:h.G.DashFolder,permission:y.PermissionLevelString.View},N=(await(0,p.AI)().search(j)).map(I=>({label:I.title,value:{uid:I.uid,title:I.title}}));return(!S||"dashboards".includes(S.toLowerCase()))&&N.unshift({label:"Dashboards",value:{uid:"general",title:"Dashboards"}}),O(!1),N}function P(S){return{container:(0,n.css)({label:"container",position:"relative",minWidth:"180px",flexGrow:1}),clear:(0,n.css)({label:"clear",fontSize:S.spacing(1.5),position:"absolute",top:-S.spacing(4.5),right:0})}}var m=e(68313),D=e(73725),x=e(15054),E=e(83791),C=(S=>(S.Tight="tight",S.Spacious="spacious",S))(C||{});const b=({onClick:S,variant:O="spacious",currentPanelId:j,currentFolderUID:B,perPage:N=x.FG,showPanelFilter:I=!1,showFolderFilter:K=!1,showSort:w=!1,showSecondaryActions:U=!1})=>{const W=(0,a.of)(T,O),[H,z]=(0,r.useState)(""),[G,M]=(0,r.useState)("");(0,s.A)(()=>M(H),200,[H]);const[Q,Y]=(0,r.useState)({}),[q,te]=(0,r.useState)(B?[B]:[]),[X,ee]=(0,r.useState)([]),ne=w||I||K,Z=O==="tight"?"lg":"xs";return(0,t.jsx)("div",{className:W.container,children:(0,t.jsxs)(g.gW,{spacing:Z,children:[(0,t.jsxs)("div",{className:(0,n.cx)(W.gridContainer,{[W.tightLayout]:O==="tight"}),children:[(0,t.jsx)("div",{className:W.filterInputWrapper,children:(0,t.jsx)(i.Z,{value:H,onChange:z,placeholder:"Search by name or description",width:0,escapeRegex:!1})}),ne&&(0,t.jsx)(A,{showSort:w,showPanelFilter:I,showFolderFilter:K,onSortChange:Y,onFolderFilterChange:te,onPanelFilterChange:ee,sortDirection:Q.value,variant:O})]}),(0,t.jsx)("div",{className:W.libraryPanelsView,children:(0,t.jsx)(E.y,{onClickCard:S,searchString:G,sortDirection:Q.value,panelFilter:X,folderFilter:q,currentPanelId:j,showSecondaryActions:U,perPage:N})})]})})};function T(S,O){return{filterInputWrapper:(0,n.css)({flexGrow:O==="tight"?1:"initial"}),container:(0,n.css)({width:"100%",overflowY:"auto",padding:S.spacing(1)}),libraryPanelsView:(0,n.css)({width:"100%"}),gridContainer:(0,n.css)({display:"flex",flexDirection:"column",width:"100%",columnGap:S.spacing(1),rowGap:S.spacing(1),paddingBottom:S.spacing(2)}),tightLayout:(0,n.css)({flexDirection:"row",rowGap:S.spacing(1)})}}const A=(0,r.memo)(({variant:S="spacious",showSort:O,showPanelFilter:j,showFolderFilter:B,sortDirection:N,onSortChange:I,onFolderFilterChange:K,onPanelFilterChange:w})=>{const U=(0,a.of)(R),W=(0,r.useCallback)(z=>w(z.map(G=>G.id)),[w]),H=(0,r.useCallback)(z=>K(z.map(G=>G.uid??"")),[K]);return(0,t.jsxs)("div",{className:(0,n.cx)(U.container,{[U.containerTight]:S==="tight"}),children:[O&&(0,t.jsx)(D.r,{value:N,onChange:I,filter:["alpha-asc","alpha-desc"]}),(B||j)&&(0,t.jsxs)("div",{className:(0,n.cx)(U.filterContainer,{[U.filterContainerTight]:S==="tight"}),children:[B&&(0,t.jsx)(f,{onChange:H}),j&&(0,t.jsx)(m.$,{onChange:W})]})]})});A.displayName="SearchControls";function R(S){return{container:(0,n.css)({display:"flex",gap:S.spacing(1),flexGrow:1,flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"}),containerTight:(0,n.css)({flexGrow:"initial",flexDirection:"column",justifyContent:"normal"}),filterContainer:(0,n.css)({display:"flex",flexDirection:"row",gap:S.spacing(1)}),filterContainerTight:(0,n.css)({flexDirection:"column",marginLeft:"initial"})}}},83791:(_,L,e)=>{"use strict";e.d(L,{y:()=>y});var t=e(74848),n=e(32196),r=e(96540),s=e(40996),a=e(39070),g=e(40845),i=e(69529),l=e(72109),d=e(67061),o=e(19384),u=e(8484),c=e(86474),p=e(38928),h=e(8184);const y=({onClickCard:v,searchString:P,sortDirection:m,panelFilter:D,folderFilter:x,showSecondaryActions:E,currentPanelId:C,perPage:b=40,isWidget:T})=>{const A=(0,g.of)(f),[{libraryPanels:R,page:S,perPage:O,numberOfPages:j,loadingState:B,currentPanelId:N},I]=(0,r.useReducer)(h.w_,{...h.Xb,currentPanelId:C,perPage:b}),K=(0,r.useMemo)(()=>(0,p.QC)(I),[I]);(0,s.A)(()=>K((0,p.IF)({searchString:P,sortDirection:m,panelFilter:D,folderFilterUIDs:x,page:S,perPage:O,currentPanelId:N,isWidget:T})),300,[P,m,D,x,S,K]);const w=({uid:H})=>K((0,p.h4)(H,{searchString:P,sortDirection:m,panelFilter:D,folderFilterUIDs:x,page:S,perPage:O})),U=H=>K((0,h.yd)({page:H}));return!(P||D?.length||x?.length)&&B===a.Gu.Done&&R.length<1?(0,t.jsx)(i.p,{variant:"call-to-action",message:(0,u.t)("library-panel.empty-state.message","You haven't created any library panels yet"),children:(0,t.jsxs)(u.x6,{i18nKey:"library-panel.empty-state.more-info",children:["Create a library panel from any existing dashboard panel through the panel context menu."," ",(0,t.jsx)(l.Y,{external:!0,href:"https://grafana.com/docs/grafana/latest/dashboards/build-dashboards/manage-library-panels/#create-a-library-panel",children:"Learn more"})]})}):(0,t.jsxs)(d.B,{direction:"column",wrap:"nowrap",children:[B===a.Gu.Loading?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.E.Skeleton,{showSecondaryActions:E}),(0,t.jsx)(c.E.Skeleton,{showSecondaryActions:E}),(0,t.jsx)(c.E.Skeleton,{showSecondaryActions:E})]}):R.length<1?(0,t.jsx)(i.p,{variant:"not-found",message:(0,u.t)("library-panels.empty-state.message","No library panels found")}):R?.map((H,z)=>(0,t.jsx)(c.E,{libraryPanel:H,onDelete:w,onClick:v,showSecondaryActions:E},`library-panel=${z}`)),R.length?(0,t.jsx)("div",{className:A.pagination,children:(0,t.jsx)(o.d,{currentPage:S,numberOfPages:j,onNavigate:U,hideWhenSinglePage:!0})}):null]})},f=v=>({pagination:(0,n.css)({alignSelf:"center",marginTop:v.spacing(1)})})},38928:(_,L,e)=>{"use strict";e.d(L,{IF:()=>f,QC:()=>P,h4:()=>v});var t=e(64423),n=e(65474),r=e(62467),s=e(44240),a=e(39697),g=e(69862),i=e(66847),l=e(69850),d=e(1005),o=e(65961),u=e(67791),c=e(32264),p=e(17706),h=e(57767),y=e(8184);function f(m){const D=(E,C)=>E.id===C.type,x=(E,C)=>{const b=(0,p.A4)();return E.filter(T=>{const A=b.find(R=>D(R,T));return C?!!A?.skipDataQuery:!A?.skipDataQuery})};return function(E){const C=new t.yU,b=(0,n.H)((0,h.dq)({searchString:m.searchString,perPage:m.perPage,page:m.page,excludeUid:m.currentPanelId,sortDirection:m.sortDirection,typeFilter:m.panelFilter,folderFilterUIDs:m.folderFilterUIDs})).pipe((0,g.Z)(T=>{const{elements:A}=T;if(c.$.featureToggles.vizAndWidgetSplit&&m.isWidget!==void 0){const R=x(A,m.isWidget);return(0,r.of)({...T,elements:R})}return(0,r.of)({...T,elements:A})}),(0,g.Z)(({perPage:T,elements:A,page:R,totalCount:S})=>(0,r.of)((0,y.c4)({libraryPanels:A,page:R,perPage:T,totalCount:S}))),(0,i.W)(T=>(console.error(T),(0,r.of)((0,y.c4)({...y.Xb,page:m.page,perPage:m.perPage})))),(0,l.j)(()=>C.unsubscribe()),(0,d.u)());C.add((0,s.h)((0,a.O)(50).pipe((0,o.u)((0,y.d9)()),(0,u.Q)(b)),b).subscribe(E))}}function v(m,D){return async function(x){try{await(0,h.h4)(m),f(D)(x)}catch(E){console.error(E)}}}function P(m){return function(D){return D instanceof Function?D(m):m(D)}}},8184:(_,L,e)=>{"use strict";e.d(L,{Xb:()=>r,c4:()=>a,d9:()=>s,w_:()=>i,yd:()=>g});var t=e(65307),n=e(39070);const r={loadingState:n.Gu.Loading,libraryPanels:[],totalCount:0,perPage:40,page:1,numberOfPages:0,currentPanelId:void 0},s=(0,t.VP)("libraryPanels/view/initSearch"),a=(0,t.VP)("libraryPanels/view/searchCompleted"),g=(0,t.VP)("libraryPanels/view/changePage"),i=(l,d)=>{if(s.match(d))return{...l,loadingState:n.Gu.Loading};if(a.match(d)){const{libraryPanels:o,page:u,perPage:c,totalCount:p}=d.payload,h=Math.ceil(p/c);return{...l,libraryPanels:o,perPage:c,totalCount:p,loadingState:n.Gu.Done,numberOfPages:h,page:u>h?u-1:u}}return g.match(d)?{...l,page:d.payload.page}:l}},82792:(_,L,e)=>{"use strict";e.d(L,{X:()=>t});function t(n){return!!n.libraryPanel?.uid}},57767:(_,L,e)=>{"use strict";e.d(L,{DW:()=>m,GN:()=>y,Yr:()=>o,d7:()=>c,dq:()=>d,e9:()=>u,h4:()=>h,jc:()=>p,xV:()=>f});var t=e(75505),n=e(79422),r=e(34214),s=e(41507),a=e(20455),g=e(74730),i=e(27677),l=e(98796);async function d({searchString:D="",perPage:x=100,page:E=1,excludeUid:C="",sortDirection:b="",typeFilter:T=[],folderFilterUIDs:A=[]}={}){const R=new URLSearchParams;R.append("searchString",D),R.append("sortDirection",b),R.append("typeFilter",T.join(",")),R.append("folderFilterUIDs",A.join(",")),R.append("excludeUid",C),R.append("perPage",x.toString(10)),R.append("page",E.toString(10)),R.append("kind",l.i.Panel.toString(10));const{result:S}=await(0,i.AI)().get(`/api/library-elements?${R.toString()}`);return S}async function o(D,x=!1){const E=await(0,t.s)((0,i.AI)().fetch({method:"GET",url:`/api/library-elements/${D}`,showSuccessAlert:!x,showErrorAlert:!x})),{result:C}=E.data,b=new r.G({...n.Ye,schemaVersion:35,panels:[C.model]}),{scopedVars:T,...A}=b.panels[0].getSaveModel();return delete A.gridPos,delete A.id,delete A.libraryPanel,b.destroy(),{...C,model:A}}async function u(D){const{result:x}=await(0,i.AI)().get(`/api/library-elements/name/${D}`);return x}async function c(D,x){const{result:E}=await(0,i.AI)().post("/api/library-elements",{folderUid:x,name:D.libraryPanel.name,model:D,kind:l.i.Panel});return E}async function p(D){const{libraryPanel:x,...E}=D,{uid:C,name:b,version:T,folderUid:A}=x,R=l.i.Panel,{result:S}=await(0,i.AI)().patch(`/api/library-elements/${C}`,{folderUid:A,name:b,model:E,version:T,kind:R});return S}function h(D){return(0,i.AI)().delete(`/api/library-elements/${D}`)}async function y(D){const{result:x}=await(0,i.AI)().get(`/api/library-elements/${D}/connections`);return x}async function f(D){const x=await y(D);return x.length===0?[]:await(0,i.AI)().search({dashboardUIDs:x.map(C=>C.connectionUid)})}function v(D){const x=(0,g.iL)(D),{uid:E,name:C,_loadedPanel:b}=x.state;let T=D.parent;if(!T||!(T instanceof s.U))throw new Error("Trying to save a library panel that does not have a DashboardGridItem parent");return{...b,uid:E,name:C,type:D.state.pluginId,model:(0,a.Z6)(D.clone({$behaviors:void 0}),{x:T.state.x??0,y:T.state.y??0,w:T.state.width??0,h:T.state.height??0},!1,T),kind:l.i.Panel,version:b?.version||0}}async function P(D){const{uid:x,folderUid:E,name:C,model:b,version:T,kind:A}=v(D),{result:R}=await(0,i.AI)().patch(`/api/library-elements/${x}`,{folderUid:E,name:C,model:b,version:T,kind:A});return R}async function m(D){const x=await P(D),E=(0,g.iL)(D);if(!E)throw new Error("Could not find library panel behavior for panel");E.setPanelFromLibPanel(x)}},43535:(_,L,e)=>{"use strict";e.d(L,{o:()=>n});var t=e(32196);function n(r){return{myTable:(0,t.css)`
      max-height: 204px;
      overflow-y: auto;
      margin-top: 11px;
      margin-bottom: 28px;
      border-radius: ${r.shape.radius.default};
      border: 1px solid ${r.colors.action.hover};
      background: ${r.colors.background.primary};
      color: ${r.colors.text.secondary};
      font-size: ${r.typography.h6.fontSize};
      width: 100%;

      thead {
        color: #538ade;
        font-size: ${r.typography.bodySmall.fontSize};
      }

      th,
      td {
        padding: 6px 13px;
        height: ${r.spacing(4)};
      }

      tbody > tr:nth-child(odd) {
        background: ${r.colors.background.secondary};
      }
    `,noteTextbox:(0,t.css)`
      margin-bottom: ${r.spacing(4)};
    `,textInfo:(0,t.css)`
      color: ${r.colors.text.secondary};
      font-size: ${r.typography.size.sm};
    `,dashboardSearch:(0,t.css)`
      margin-top: ${r.spacing(2)};
    `,modal:(0,t.css)`
      width: 500px;
    `,modalText:(0,t.css)`
      font-size: ${r.typography.h4.fontSize};
      color: ${r.colors.text.primary};
      margin-bottom: ${r.spacing(4)};
      padding-top: ${r.spacing(2)};
    `}}},98796:(_,L,e)=>{"use strict";e.d(L,{i:()=>t});var t=(r=>(r[r.Panel=1]="Panel",r))(t||{}),n=(r=>(r[r.Dashboard=1]="Dashboard",r))(n||{})},88861:(_,L,e)=>{"use strict";e.d(L,{b:()=>o});var t=e(5805),n=e(17172),r=e(3169),s=e(8484),a=e(57767);async function g(u,c){const p=i(u),h=await d(p,c);return l(u,h),h}function i(u){let{scopedVars:c,...p}=u.getSaveModel();return p={libraryPanel:{name:u.title,uid:void 0},...p},p}function l(u,c){u.restoreModel({...c.model,configRev:0,libraryPanel:c,title:u.title}),u.hasSavedPanelEditChange=!0,u.refresh()}function d(u,c){return u.libraryPanel?u.libraryPanel&&u.libraryPanel.uid===""?(0,a.d7)(u,c):(0,a.jc)(u):Promise.reject()}const o=()=>{const u=(0,r._2)(),[c,p]=(0,t.default)(async(h,y)=>{try{const f=await g(h,y);return u.success((0,s.t)("library-panels.save.success","Library panel saved")),f}catch(f){throw(0,n.NF)(f)&&(f.isHandled=!0,u.error((0,s.t)("library-panels.save.error",'Error saving library panel: "{{errorMsg}}"',{errorMsg:f.message??f.data.message}))),f}},[]);return{state:c,saveLibraryPanel:p}}},6473:(_,L,e)=>{"use strict";e.d(L,{t:()=>m});var t=e(62938),n=e(55004),r=e(26272),s=e(78731),a=e(39601),g=e(10096),i=e(28444),l=e(14792),d=e(74848),o=e(32196),u=e(40845),c=e(37390),p=e(55852),h=(D=>(D.Saved="saved",D.EditingStarted="editing-started",D.EditingCanceled="editing-cancelled",D.Deleted="deleted",D))(h||{});function y({onDismiss:D,event:x}){const E=(0,u.of)(f),C=()=>{if(x?.action===h.Deleted){a.Ny.push("/");return}m.reloadPage(),D()};return(0,d.jsxs)(c.a,{isOpen:!0,title:"Dashboard changed",icon:"copy",onDismiss:D,onClickBackdrop:()=>{},className:E.modal,children:[(0,d.jsx)("div",{className:E.description,children:"The dashboad has been updated by another session. Do you want to continue editing or discard your local changes?"}),(0,d.jsxs)(c.a.ButtonRow,{children:[(0,d.jsx)(p.$n,{onClick:D,variant:"secondary",fill:"outline",children:"Continue editing"}),(0,d.jsx)(p.$n,{onClick:C,variant:"destructive",children:"Discard local changes"})]})]})}const f=D=>({modal:(0,o.css)({width:"600px"}),description:(0,o.css)({color:D.colors.text.secondary,paddingBottom:D.spacing(1)})}),v=(0,t.A)();class P{constructor(){this.editing=!1,this.observer={next:x=>{if((0,n.ew)(x)&&this.editing&&x.state===n.ZF.Connected&&this.sendEditingState(),(0,n.Z7)(x)){if(x.message.sessionId===v)return;const{action:E}=x.message;switch(E){case h.EditingStarted:case h.Saved:{if(this.ignoreSave){this.ignoreSave=!1;return}const C=(0,l.UA)().getCurrent();if(C?.uid!==x.message.uid){console.log("dashboard event for different dashboard?",x,C);return}const b=this.editing||C.hasUnsavedChanges();if(E===h.Saved)b?g.lE.publish(new i.S8({component:y,props:{event:x}})):(g.lE.emit(r.r1.alertSuccess,["Dashboard updated"]),this.reloadPage());else if(b&&E===h.EditingStarted&&!this.hasSeenNotice){const T=x.message,A=this.getRecentEditingEvent();(!A||A.message!==T.message)&&(this.hasSeenNotice=!0,g.lE.emit(r.r1.alertWarning,["Another session is editing this dashboard",T.message])),this.lastEditing=T}return}}}}}}setEditingState(x){const E=this.editing=x;this.editing=x,this.hasSeenNotice=!1,E&&g.TP.isEditor&&this.sendEditingState()}sendEditingState(){const{channel:x,uid:E}=this;x&&E&&(0,s.oF)().publish(x,{sessionId:v,uid:E,action:this.editing?h.EditingStarted:h.EditingCanceled,timestamp:Date.now()})}watch(x){const E=(0,s.oF)();E&&x!==this.uid&&(this.channel={scope:n.qD.Grafana,namespace:"dashboard",path:`uid/${x}`},this.leave(),x&&(this.subscription=E.getStream(this.channel).subscribe(this.observer)),this.uid=x)}leave(){this.subscription&&this.subscription.unsubscribe(),this.subscription=void 0,this.uid=void 0}ignoreNextSave(){this.ignoreSave=!0}getRecentEditingEvent(){return this.lastEditing&&this.lastEditing.timestamp&&Date.now()-this.lastEditing.timestamp>5e3&&(this.lastEditing=void 0),this.lastEditing}reloadPage(){a.Ny.reload()}}const m=new P},47118:(_,L,e)=>{"use strict";e.d(L,{_w:()=>n,o$:()=>g,ot:()=>r});var t=e(14236),n=(i=>(i.NewValuesSameSchema="NewValuesSameSchema",i.FullFrame="FullFrame",i))(n||{});const r=(i,l)=>"type"in i&&i.type===l,s=Object.values(n),a=i=>"type"in i&&s.includes(i.type),g=i=>(0,t.ci)(i)&&"packetInfo"in i},70377:(_,L,e)=>{"use strict";e.d(L,{FE:()=>i,jE:()=>a,qE:()=>g});var t=e(2543),n=e.n(t),r=e(87490),s=e(98101);const a=(u,c)=>i(u,c),g=u=>{let c=[];return u.forEach(p=>{p.links?.forEach(h=>{if("variables"in h&&h.variables.length>0){const y={href:h.href,title:h.title,origin:h.origin,onClick:h.onClick,target:h.target},f=h.variables.map(P=>{const m=P.variableName,D=P.fieldPath?`.${P.fieldPath}`:"";return`${m}${D}`}),v=h.variables.map(P=>P.found?P.value:"");c.push({keys:f,values:v,links:[y],fieldIndex:p.fieldIndex})}})}),c},i=(u,c)=>o(u).map(h=>{const y=c?c(h,u.rowIndex,u.dataFrame):[],f=h.values[u.rowIndex],v=typeof f=="string"||typeof f=="number"?f.toString():(0,r.MA)(f);return{keys:[h.name],values:[v],links:y,fieldIndex:h.index}});function l(u,c){const p=(0,s.O)(u);if(p===null)return new Set;const h=new Set(p.extraFields.map(y=>y.index));return p.severityField!==null&&h.add(p.severityField.index),c.keepBody&&h.add(p.bodyField.index),c.keepTimestamp&&h.add(p.timeField.index),h}function d(u,c){const p=u.fields.map((v,P)=>({...v,index:P})),h=l(u,c??{}),[y,f]=partition(p,v=>v.config.custom?.hidden?!1:(v.config.links??[]).length>0?!0:h.has(v.index));return{visible:y,hidden:f}}function o(u,c){const p=u.dataFrame,h=l(p,c??{}),y=[];for(let f=0;f<p.fields.length;f++){const v=p.fields[f];v.values[u.rowIndex]!=null&&(v.config.custom?.hidden||(v.config.links&&v.config.links.length>0||h.has(f))&&y.push({...v,index:f}))}return y}},98101:(_,L,e)=>{"use strict";e.d(L,{n:()=>p,O:()=>y});var t=e(85404),n=e(11261),r=e(41260);function s(f,v){const P=f.labels;if(P!==void 0){const m=new Array(v);return m.fill(P),m}else return null}function a(f,v,P){const m=f.getFieldByName("labels");if(m!==void 0&&m.type===n.PU.other){const D=m.values.map(p);return[m,()=>D]}else return[null,()=>s(v,P.length)]}function g(f){const v=new t.L(f),P=v.getFirstFieldOfType(n.PU.time),m=v.getFirstFieldOfType(n.PU.string);if(P===void 0||m===void 0)return null;const D=v.getFieldByName("tsNs")??null,x=v.getFieldByName("detected_level")??v.getFieldByName("level")??null,E=v.getFieldByName("id")??null,[C,b]=a(v,m,f),T=v.fields.filter((A,R)=>R!==P.index&&R!==m.index&&R!==D?.index&&R!==x?.index&&R!==E?.index&&R!==C?.index);return{timeField:P,bodyField:m,timeNanosecondField:D,severityField:x,idField:E,getLogFrameLabels:b,getLogFrameLabelsAsLabels:b,getLabelFieldName:()=>C?.name??null,extraFields:T}}function i(f,v,P){const m=f.getFieldByName(v);if(m!==void 0)return m.type===P?m:void 0}const l="timestamp",d="body",o="severity",u="id",c="labels";function p(f){const v={};return Object.entries(f).forEach(([P,m])=>{v[P]=typeof m=="string"?m:JSON.stringify(m)}),v}function h(f){const v=new t.L(f),P=i(v,l,n.PU.time),m=i(v,d,n.PU.string);if(P===void 0||m===void 0)return null;const D=i(v,o,n.PU.string)??null,x=i(v,u,n.PU.string)??null,E=i(v,c,n.PU.other)??null,C=E===null?null:E.values,b=v.fields.filter((T,A)=>A!==P.index&&A!==m.index&&A!==D?.index&&A!==x?.index&&A!==E?.index);return{timeField:P,bodyField:m,severityField:D,idField:x,getLogFrameLabels:()=>C,timeNanosecondField:null,getLogFrameLabelsAsLabels:()=>C!==null?C.map(p):null,getLabelFieldName:()=>E!==null?E.name:null,extraFields:b}}function y(f){return f.meta?.type===r.m.LogLines?h(f):g(f)}},69147:(_,L,e)=>{"use strict";e.d(L,{yR:()=>A,cZ:()=>R,HT:()=>z,M0:()=>w,ct:()=>U,f8:()=>se,J9:()=>W,Wr:()=>ae,sg:()=>Z});var t=e(2543),n=e(88483),r=e(50832),s=e(65474),a=e(9557),g=e(52622),i=e(14236),l=e(85404),d=e(11261),o=e(24293),u=e(47232),c=e(8249),p=e(80997),h=e(72724),y=e(65879),f=e(39070),v=e(26517),P=e(32264),m=e(24284),D=e(88838),x=e(2913);function E(de,le){return x.Ay.bootData?.user?.lightTheme?le:de}var C=e(98101),b=e(91002);const T="Line limit",A="Common labels",R={[a.$b.critical]:m.Tj[7],[a.$b.error]:m.Tj[4],[a.$b.warning]:m.Tj[1],[a.$b.info]:m.Tj[0],[a.$b.debug]:m.Tj[5],[a.$b.trace]:m.Tj[2],[a.$b.unknown]:E("#8e8e8e","#bdc4cd")},S=1,O=1e3*S,j=60*O,B=60*j,N=24*B,I=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-6]\d[,\.]\d+([+-][0-2]\d:[0-5]\d|Z)/g;function K(de,le,he){switch(he){case g.fY.exact:return de.entry.replace(I,"")===le.entry.replace(I,"");case g.fY.numbers:return de.entry.replace(/\d/g,"")===le.entry.replace(/\d/g,"");case g.fY.signature:return de.entry.replace(/\w/g,"")===le.entry.replace(/\w/g,"");default:return!1}}function w(de,le){return le===g.fY.none?de:de.reduce((he,ie,J)=>{const ce={...ie},pe=he[he.length-1];return J>0&&K(ie,pe,le)?pe.duplicates++:(ce.duplicates=0,he.push(ce)),he},[])}function U(de,le){return le.size===0?de:de.filter(he=>!le.has(he.logLevel))}function W(de,le){const he={},ie=[];for(const J of de){let ce=he[J.logLevel];ce||(he[J.logLevel]=ce={lastTs:null,datapoints:[],target:J.logLevel,color:R[J.logLevel]},ie.push(ce));const pe=Math.floor(J.timeEpochMs/le)*le;pe===ce.lastTs?ce.datapoints[ce.datapoints.length-1][0]++:(ce.datapoints.push([1,pe]),ce.lastTs=pe);for(const Pe of ie)Pe!==ce&&Pe.lastTs!==pe&&(Pe.datapoints.push([0,pe]),Pe.lastTs=pe)}return ie.map((J,ce)=>{J.datapoints.sort((ge,Se)=>ge[1]-Se[1]);const pe=(0,i.Vc)(J),Ie=new l.L(pe).getFirstFieldOfType(d.PU.number);return pe.fields[Ie.index].config.min=0,pe.fields[Ie.index].config.decimals=0,pe.fields[Ie.index].config.color={mode:o.Y.Fixed,fixedColor:J.color},pe.fields[Ie.index].config.custom={drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,barWidthFactor:.9,barMaxWidth:5,lineColor:J.color,pointColor:J.color,fillColor:J.color,lineWidth:0,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}},pe})}function H(de){return de.fields.some(le=>le.type===d.PU.time)&&de.fields.some(le=>le.type===d.PU.string)}function z(de,le,he,ie,J){const{logSeries:ce}=M(de),pe=Y(ce,ie,!!J);if(pe){if(le&&pe.rows.length>0){const Pe=pe.rows.sort(b.M1),{visibleRange:Ie,bucketSize:ge,visibleRangeMs:Se,requestedRangeMs:De}=G(Pe,le,he);pe.visibleRange=Ie,pe.bucketSize=ge,pe.series=W(Pe,ge),pe.meta&&(pe.meta=q(pe,Se,De))}else pe.series=[];return pe.queries=ie,pe}return{hasUniqueLabels:!1,rows:[],meta:[],series:[],queries:ie}}function G(de,le,he,ie=20,J=1e3){let ce=he,pe=le,Pe=Math.max(pe*ie,J),Ie,ge;if(he){const Se=de[0].timeEpochMs;if(ge=he.to-he.from,Ie=he.to-Se,Ie>0){const De=Ie/ge;pe*=De,Pe=Math.max(Math.ceil(pe*ie),J),ce={from:Math.floor(Se/Pe)*Pe,to:he.to}}else Ie=1}return{bucketSize:Pe,visibleRange:ce,visibleRangeMs:Ie,requestedRangeMs:ge}}function M(de){const le=[],he=[];for(const ie of de){if(H(ie)||!ie.fields.length){he.push(ie);continue}ie.length>0&&le.push(ie)}return{logSeries:he,metricSeries:le}}function Q(de,le,he){const ie=de.values[he],ce=(0,u.yT)(ie).valueOf();if(le)return{ts:ie,timeEpochMs:ce,timeEpochNs:le.values[he]};if(de.nanos!==void 0){const pe=de.nanos[he].toString().padStart(6,"0"),Pe=`${ce}${pe}`;return{ts:ie,timeEpochMs:ce,timeEpochNs:Pe}}return{ts:ie,timeEpochMs:ce,timeEpochNs:ce+"000000"}}function Y(de,le=[],he=!1){if(de.length===0)return;const ie=[];let J=[];const ce=de.filter(Ve=>Ve.fields.length);ce.length&&ce.forEach(Ve=>{const Je=(0,C.O)(Ve);if(Je!=null){const nt=Je.getLogFrameLabelsAsLabels()??void 0,pt={rawFrame:Ve,logsFrame:Je,frameLabels:nt};J.push(pt),nt&&nt.length>0&&ie.push(nt)}});const pe=ie.flat(),Pe=pe.length>0?(0,c.yO)(pe):{};let Ie=[],ge=!1;const Se=(0,b.kA)();for(const Ve of J){const{logsFrame:Je,rawFrame:nt,frameLabels:pt}=Ve,{timeField:bt,timeNanosecondField:Tt,bodyField:ye,severityField:je,idField:ue}=Je;for(let Ee=0;Ee<nt.length;Ee++){const{ts:Ce,timeEpochMs:Ne,timeEpochNs:Fe}=Q(bt,Tt??void 0,Ee),Ue=ye.values[Ee]??"",fe=typeof Ue=="string"?Ue:JSON.stringify(Ue),Te=p.sQ.hasAnsiCodes(fe),Ge=!!fe.match(/\\n|\\t|\\r/),Qe=nt.meta?.custom?.searchWords??nt.meta?.searchWords??[],st=Te?D.DB.strip(fe):fe,Xe=pt?.[Ee],ot=(0,c.s6)(Xe,Pe);Object.keys(ot).length>0&&(ge=!0);let ft=a.$b.unknown;const _e=je&&je.values[Ee]||(Xe?.detected_level??Xe?.level);typeof _e=="number"||typeof _e=="string"?ft=(0,b.EK)(_e):ft=(0,b.XM)(st);const et=le.find(dt=>dt.refId===nt.refId)?.datasource?.type,it={entryFieldIndex:ye.index,rowIndex:Ee,dataFrame:nt,logLevel:ft,timeFromNow:(0,h.fq)(Ce),timeEpochMs:Ne,timeEpochNs:Fe,timeLocal:(0,h.LE)(Ce,{timeZone:"browser"}),timeUtc:(0,h.LE)(Ce,{timeZone:"utc"}),uniqueLabels:ot,hasAnsi:Te,hasUnescapedContent:Ge,searchWords:Qe,entry:st,raw:fe,labels:Xe||{},uid:`${nt.refId}_${ue?ue.values[Ee]:Ee.toString()}`,datasourceType:et};ue!==null&&(it.rowId=ue.values[Ee]),!(he&&Se(it))&&Ie.push(it)}}const De=[];(0,t.size)(Pe)>0&&De.push({label:A,value:Pe,kind:a.tG.LabelsMap});const Me=de.filter(Ve=>Ve?.meta?.custom?.limit??Ve?.meta?.limit).reduce((Ve,Je)=>(Ve[Je.refId??""]=Je.meta?.custom?.limit??Je.meta?.limit??0,Ve),{}),be=Object.values(Me).reduce((Ve,Je)=>Ve+=Je,0);be>0&&De.push({label:T,value:be,kind:a.tG.Number});let we=0;const Be={};let He=!1;for(const Ve of de){const Je=Ve.meta?.custom?.lokiQueryStatKey,{refId:nt}=Ve;if(!He&&Ve.meta?.custom?.error&&(De.push({label:"",value:Ve.meta?.custom.error,kind:a.tG.Error}),He=!0),nt&&!Be[nt]){if(Je&&Ve.meta?.stats){const pt=Ve.meta.stats.find(bt=>bt.displayName===Je);pt&&(we+=pt.value)}Be[nt]=!0}}if(we>0){const{text:Ve,suffix:Je}=(0,v.rT)("B")(we);De.push({label:"Total bytes processed",value:`${Ve} ${Je}`,kind:a.tG.String})}return{hasUniqueLabels:ge,meta:De,rows:Ie}}function q(de,le,he){if(!de.meta)return[];let ie=[...de.meta];const J=ie.findIndex(pe=>pe.label===T),ce=J>=0&&ie[J]?.value;if(ce&&typeof ce=="number"&&ce>0){let pe;if(ce===de.rows.length&&le&&he){const Pe=(le/he*100).toFixed(2);pe=`${ce} reached, received logs cover ${Pe}% (${y.msRangeToTimeString(le)}) of your selected time range (${y.msRangeToTimeString(he)})`}else{const Pe=P.$.featureToggles.logsInfiniteScrolling?"displayed":"returned";pe=`${ce} (${de.rows.length} ${Pe})`}ie[J]={label:T,value:pe,kind:a.tG.String}}return ie}function te(de,le){const he=le&&de===a.$b.unknown?"logs":de,ie=R[de];return{displayNameFromDS:he,color:{mode:o.Y.Fixed,fixedColor:ie},custom:{drawStyle:g.GR.Bars,barAlignment:g.Nj.Center,lineColor:ie,pointColor:ie,fillColor:ie,lineWidth:1,fillOpacity:100,stacking:{mode:g.gs.Normal,group:"A"}}}}const X=(de,le,he)=>(de.fields=de.fields.map(ie=>(ie.type===d.PU.number&&(ie.config={...ie.config,...te(le(de),he)}),ie)),de);function ee(de){let le;try{le=new l.L(de).getFirstFieldOfType(d.PU.number)}catch{}return le?.labels?ne(le.labels):a.$b.unknown}function ne(de){const le=de.detected_level??de.level??de.lvl??de.loglevel??"";return le?(0,b.EK)(le):a.$b.unknown}function Z(de,le,he){const ie=le.range,J=he.targets,ce=ee,pe=ie.to.valueOf()-ie.from.valueOf(),Pe=re(le.scopedVars,pe);return le.interval=Pe.interval,le.scopedVars.__interval={value:Pe.interval,text:Pe.interval},Pe.intervalMs!==void 0&&(le.intervalMs=Pe.intervalMs,le.scopedVars.__interval_ms={value:Pe.intervalMs,text:Pe.intervalMs}),le.hideFromInspector=!0,new n.c(Ie=>{let ge=[];Ie.next({state:f.Gu.Loading,error:void 0,data:[]});const Se=de.query(le),Ke=((0,r.A)(Se)?Se:(0,s.H)(Se)).subscribe({complete:()=>{Ie.complete()},next:Me=>{const{error:be}=Me;if(be!==void 0)Ie.next({state:f.Gu.Error,error:be,data:[]}),Ie.error(be);else{const we=(0,t.groupBy)(Me.data,"refId");ge=Me.data.map(Be=>{if(Be.meta?.dataTopic===g.QR.Annotations)return Be;let He=Be.refId||"";He.startsWith("log-volume-")&&(He=He.substr(11));const Ve={logsVolumeType:a.Aj.FullRange,absoluteRange:{from:ie.from.valueOf(),to:ie.to.valueOf()},datasourceName:de.name,sourceQuery:J.find(Je=>Je.refId===He)};return Be.meta={...Be.meta,custom:{...Be.meta?.custom,...Ve}},X(Be,ce,we[Be.refId].length===1)}),Ie.next({state:Me.state,error:void 0,data:ge})}},error:Me=>{Ie.next({state:f.Gu.Error,error:Me,data:[]}),Ie.error(Me)}});return()=>{Ke?.unsubscribe()}})}function ae(de,le){return le.hideFromInspector=!0,new n.c(he=>{let ie=[];he.next({state:f.Gu.Loading,error:void 0,data:[]});const J=de.query(le),pe=((0,r.A)(J)?J:(0,s.H)(J)).subscribe({complete:()=>{he.next({state:f.Gu.Done,error:void 0,data:ie}),he.complete()},next:Pe=>{const{error:Ie}=Pe;Ie!==void 0?(he.next({state:f.Gu.Error,error:Ie,data:[]}),he.error(Ie)):ie=Pe.data.map(ge=>{const Se=(0,i.Vc)(ge),{timeIndex:De}=(0,i.KR)(Se);return(0,i.ES)(Se,De)})},error:Pe=>{he.next({state:f.Gu.Error,error:Pe,data:[]}),he.error(Pe)}});return()=>{pe?.unsubscribe()}})}function re(de,le){if(de.__interval_ms){let he=de.__interval_ms.value,ie="";return le<O*5?(he=S,ie="1ms"):he>B?(he=N,ie="1d"):he>j?(he=B,ie="1h"):he>O?(he=j,ie="1m"):(he=O,ie="1s"),{interval:ie,intervalMs:he}}else return{interval:"$__interval"}}function se(de){const le=de.dataFrame;return le.length===0||le.length<=de.rowIndex?null:(0,i.EI)({fields:le.fields.map(ie=>({...ie,values:[ie.values[de.rowIndex]]})),refId:le.refId})}},91002:(_,L,e)=>{"use strict";e.d(L,{Dg:()=>x,Dk:()=>A,Dm:()=>b,Dx:()=>E,EK:()=>o,Ei:()=>P,Hw:()=>D,M1:()=>h,Tj:()=>u,XM:()=>d,a8:()=>S,e3:()=>T,kA:()=>O,oR:()=>v,oT:()=>C,qR:()=>m,s2:()=>c,tX:()=>R,zy:()=>f});var t=e(2543),n=e.n(t),r=e(9557),s=e(52622),a=e(37471),g=e(11261),i=e(85404),l=e(70377);function d(j){if(!j)return r.$b.unknown;let B=r.$b.unknown,N;for(const[I,K]of Object.entries(r.$b)){const U=new RegExp(`\\b${I}\\b`,"i").exec(j);U&&(N===void 0||U.index<N)&&(B=K,N=U.index)}return B}function o(j){const B=r.$b[j.toString().toLowerCase()];if(B)return B;if(typeof j=="string"){const N=parseInt(j,10);if(j.length===N.toString().length)return r.s5[j]||r.$b.unknown}else if(typeof j=="number")return r.s5[j]||r.$b.unknown;return r.$b.unknown}function u(j,B){const N=j.filter(w=>w.labels[B]!==void 0),I=N.length,K=(0,t.countBy)(N,w=>w.labels[B]);return p(K,I)}function c(j){const B=j.filter(I=>I!=null),N=(0,t.countBy)(B);return p(N,B.length)}const p=(j,B)=>(0,t.chain)(j).map((N,I)=>({count:N,value:I,proportion:N/B})).sortBy("count").reverse().value(),h=(j,B)=>j.timeEpochMs<B.timeEpochMs?-1:j.timeEpochMs>B.timeEpochMs?1:j.timeEpochNs<B.timeEpochNs?-1:j.timeEpochNs>B.timeEpochNs?1:0,y=(j,B)=>j.timeEpochMs>B.timeEpochMs?-1:j.timeEpochMs<B.timeEpochMs?1:j.timeEpochNs>B.timeEpochNs?-1:j.timeEpochNs<B.timeEpochNs?1:0,f=(j,B)=>{const N=j?v(j.rows,B):[];return j?{...j,rows:N}:{hasUniqueLabels:!1,rows:N}},v=(j,B)=>B===s.uH.Ascending?j.sort(h):j.sort(y),P=j=>j.labels.__error__?{hasError:!0,errorMessage:j.labels.__error__}:{hasError:!1},m=j=>j.labels.__adaptive_logs_sampled__?{isSampled:!0,sampleMessage:j.labels.__adaptive_logs_sampled__==="true"?"Logs like this one have been dropped by Adaptive Logs":`${j.labels.__adaptive_logs_sampled__}% of logs like this one have been dropped by Adaptive Logs`}:{isSampled:!1},D=j=>j.replace(/\\r\\n|\\n|\\t|\\r/g,B=>B.slice(1)==="t"?"	":`
`);function x(j){return j.map(B=>{const N=(0,l.FE)(B).reduce((I,K)=>{const w=K.keys[0];return I[w]=K.values[0],I},{});return{line:B.entry,timestamp:B.timeEpochNs,fields:{...N,...B.labels}}})}const E=j=>{let B={from:1/0,to:-1/0};return j.forEach(N=>{const I=N.meta?.custom||{};I.absoluteRange?.from&&I.absoluteRange?.to&&(B={from:Math.min(B.from,I.absoluteRange.from),to:Math.max(B.to,I.absoluteRange.to)})}),B},C=j=>{if(j.length===0)throw new Error("Cannot aggregate data frames: there must be at least one data frame to aggregate");const B={},N={};let I=-1/0;const K={};let w=[];return j.forEach(U=>{const{level:W,valueField:H,timeField:z,length:G}=R(U);K[W]={meta:U.meta,valueFieldConfig:H.config,timeFieldConfig:z.config};for(let M=0;M<G;M++){const Q=z.values[M],Y=H.values[M];B[W]??={},B[W][Q]=(B[W][Q]||0)+Y,N[Q]=(N[Q]||0)+Y,I=Math.max(N[Q],I)}}),Object.keys(B).forEach(U=>{const W=new a.k,{meta:H,timeFieldConfig:z,valueFieldConfig:G}=K[U];W.name=U,W.meta=H,W.addField({name:"Time",type:g.PU.time,config:z}),W.addField({name:"Value",type:g.PU.number,config:G}),Object.entries(B[U]).sort((M,Q)=>Number(M[0])-Number(Q[0])).forEach(([M,Q])=>{W.add({Time:Number(M),Value:Q})}),w.push(W)}),{dataFrames:w,maximum:I}},b=j=>{const B=j[0]?.meta?.custom;return B&&B.datasourceName?{name:B.datasourceName}:null},T=j=>j[0]?.meta?.custom?.logsVolumeType===r.Aj.Limited,A=async(j,B)=>{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(j);{const N=document.createElement("textarea");B.current?.appendChild(N),N.value=j,N.focus(),N.select(),document.execCommand("copy"),N.remove()}};function R(j){const B=new i.L(j),N=B.getFirstFieldOfType(g.PU.time),I=B.getFirstFieldOfType(g.PU.number);if(!N)throw new Error("Missing time field");if(!I)throw new Error("Missing value field");const K=I.config.displayNameFromDS||j.name||"logs",w=I.values.length;return{level:K,valueField:I,timeField:N,length:w}}function S(j){return j instanceof Element}function O(){const j=new Set;return function(B){let N=`${B.dataFrame.refId}_${B.rowId?B.rowId:`${B.timeEpochNs}_${B.entry}`}`;return j.has(N)?!0:(j.add(N),!1)}}},90591:(_,L,e)=>{"use strict";e.d(L,{m:()=>l});var t=e(74848),n=e(32196),r=e(32264),s=e(40845),a=e(96374),g=e(8484);const i=()=>{const o=(0,s.of)(d);return(0,t.jsx)("p",{className:o.description,children:r.$.featureToggles.newDashboardSharingComponent?(0,g.t)("shared-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this access? The dashboard can no longer be shared."):(0,g.t)("public-dashboard.delete-modal.revoke-body-text","Are you sure you want to revoke this URL? The dashboard will no longer be public.")})},l=({onConfirm:o,onDismiss:u})=>{const c=r.$.featureToggles.newDashboardSharingComponent?(0,g.t)("shared-dashboard.delete-modal.revoke-title","Revoke access"):(0,g.t)("public-dashboard.delete-modal.revoke-title","Revoke public URL");return(0,t.jsx)(a.u,{isOpen:!0,body:(0,t.jsx)(i,{}),onConfirm:o,onDismiss:u,title:c,icon:"trash-alt",confirmText:c})},d=o=>({title:(0,n.css)`
    margin-bottom: ${o.spacing(1)};
  `,description:(0,n.css)`
    font-size: ${o.typography.body.fontSize};
  `})},71500:(_,L,e)=>{"use strict";e.d(L,{P:()=>s});var t=e(65812);class n extends Error{constructor(g,i){super(i),this.type=g}}class r{constructor(){this.rootName="general"}validateNewDashboardName(g,i){return this.validate(g,i,"A dashboard or a folder with the same name already exists")}validateNewFolderName(g){return this.validate(this.rootName,g,"A folder or dashboard in the general folder with the same name already exists")}async validate(g,i,l){i=(i||"").trim();const d=i.toLowerCase();if(i.length===0)throw new n("REQUIRED","Name is required");if(d===this.rootName)throw new n("EXISTING","This is a reserved name and cannot be used for a folder.");const u=await(0,t.getGrafanaSearcher)().search({kind:["dashboard"],query:i,location:g||"general"});for(const c of u.view)if(d===c.name.toLowerCase())throw new n("EXISTING",l)}}const s=new r},11230:(_,L,e)=>{"use strict";e.d(L,{FG:()=>m,Q9:()=>D,Ql:()=>A,c0:()=>T,iP:()=>u,rw:()=>o,vV:()=>C});var t=e(17172),n=e(19347),r=e(82467),s=e(3169),a=e(55314),g=e(31678),i=e(57767),l=e(98796),d=e(88264);function o(S){return async O=>{try{O((0,d.f7)());const j=await(0,t.AI)().get(`/api/gnet/dashboards/${S}`);await O(v(j.json)),await O(h(j)),O(f())}catch(j){O((0,d.oQ)()),(0,t.NF)(j)&&O((0,r.dx)((0,s.gi)(j.data.message||j)))}}}function u(S){return async O=>{await O(v(S)),await O(y(S)),O(f())}}const c=(S,O)=>S?.usage?.libraryPanels?.filter(j=>O.inputs.libraryPanels.some(B=>B.state!==d.J7.Exists&&B.model.uid===j.uid));function p(S,O){let j=S.__inputs;if(O.inputs.libraryPanels?.length){const B=[];S.__inputs?.forEach(N=>{if(!N?.usage?.libraryPanels){B.push(N);return}const I=c(N,O);N.usage={libraryPanels:I},!!I?.length&&B.push(N)}),j=B}return{...S,__inputs:j}}function h(S){return(O,j)=>{const B=j().importDashboard,N=p(S.json,B);O((0,d.Rp)({...S,json:N}))}}function y(S){return(O,j)=>{const B=j().importDashboard,N=p(S,B);O((0,d.dd)(N))}}function f(){return(S,O)=>{const j=O().importDashboard.dashboard;if(j&&j.__inputs){const B=[];j.__inputs.forEach(N=>{const I={name:N.name,label:N.label,info:N.description,value:N.value,type:N.type,pluginId:N.pluginId,options:[]};I.description=E(N),N.type===d.NZ.DataSource?x(N,I):I.info||(I.info="Specify a string constant"),B.push(I)}),S((0,d.y3)(B))}}}function v(S){return async function(O){const j=await P(S);O((0,d.dW)(j))}}async function P(S){if(!S||!S.__elements)return[];const O=[];for(const j of Object.values(S.__elements)){if(j.kind!==l.i.Panel)continue;const B=j.model,{type:N,description:I}=B,{uid:K,name:w}=j,U={model:{model:B,uid:K,name:w,version:0,type:N,kind:l.i.Panel,description:I},state:d.J7.New};try{const W=await(0,i.Yr)(K,!0);U.state=d.J7.Exists,U.model=W}catch(W){if(W.status!==404)throw W}O.push(U)}return O}function m(){return S=>{S((0,d.SN)())}}function D(S){return async(O,j)=>{const B=j().importDashboard.dashboard,N=j().importDashboard.inputs,I=[];S.dataSources?.forEach((K,w)=>{const U=N.dataSources[w];I.push({name:U.name,type:U.type,pluginId:U.pluginId,value:K.uid})}),S.constants?.forEach((K,w)=>{const U=N.constants[w];I.push({value:K,name:U.name,type:U.type})}),O(a.cU.endpoints.importDashboard.initiate({dashboard:{...B,title:S.title,uid:S.uid||B.uid},overwrite:!0,inputs:I,folderUid:S.folder.uid}))}}const x=(S,O)=>{(0,n.l)().getList({pluginId:S.pluginId}).length===0?O.info="No data sources of type "+S.pluginName+" found":O.info||(O.info="Select a "+S.pluginName+" data source")},E=S=>{if(S.usage&&S.usage.libraryPanels)return`List of affected library panels: ${S.usage.libraryPanels.reduce((j,B,N)=>N===0?B.name:`${j}, ${B.name}`,"")}`};function C(S){return(0,t.AI)().post("/api/folders",S)}const b=1e3;function T(S,O,j=g.SearchQueryType.Folder){return(0,t.AI)().get("/api/search",{query:S,type:j,permission:O,limit:b})}function A(S){return(0,t.AI)().get(`/api/folders/${S}`)}function R(S){return getBackendSrv().get(`/api/folders/id/${S}`)}},88264:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>f,J7:()=>a,NZ:()=>s,Rp:()=>o,SN:()=>l,V9:()=>g,dW:()=>c,dd:()=>u,f7:()=>h,oQ:()=>p,qx:()=>r,y3:()=>d});var t=e(65307),n=e(39070),r=(v=>(v[v.Gcom=0]="Gcom",v[v.Json=1]="Json",v))(r||{}),s=(v=>(v.DataSource="datasource",v.Constant="constant",v.LibraryPanel="libraryPanel",v))(s||{}),a=(v=>(v.New="new",v.Exists="exists",v.Different="different",v))(a||{});const g={meta:{updatedAt:"",orgName:""},dashboard:{},source:1,inputs:{},state:n.Gu.NotStarted},i=(0,t.Z0)({name:"manageDashboards",initialState:g,reducers:{setGcomDashboard:(v,P)=>{v.dashboard={...P.payload.json,id:null},v.meta={updatedAt:P.payload.updatedAt,orgName:P.payload.orgName},v.source=0,v.state=n.Gu.Done},setJsonDashboard:(v,P)=>{v.dashboard={...P.payload,id:null},v.meta=g.meta,v.source=1,v.state=n.Gu.Done},clearDashboard:v=>{v.dashboard={},v.state=n.Gu.NotStarted},setInputs:(v,P)=>{v.inputs={dataSources:P.payload.filter(m=>m.type==="datasource"),constants:P.payload.filter(m=>m.type==="constant"),libraryPanels:v.inputs.libraryPanels||[]}},setLibraryPanelInputs:(v,P)=>{v.inputs.libraryPanels=P.payload},fetchFailed:v=>{v.dashboard={},v.state=n.Gu.Error},fetchDashboard:v=>{v.state=n.Gu.Loading}}}),{clearDashboard:l,setInputs:d,setGcomDashboard:o,setJsonDashboard:u,setLibraryPanelInputs:c,fetchFailed:p,fetchDashboard:h}=i.actions,f={importDashboard:i.reducer}},59120:(_,L,e)=>{"use strict";e.d(L,{O5:()=>x,r3:()=>p,dX:()=>v,hZ:()=>l,ri:()=>u,WH:()=>P,AC:()=>d,YX:()=>f,bM:()=>m,A_:()=>D,SM:()=>i,M8:()=>y,YD:()=>c,aD:()=>h});var t=e(75816),n=e(75505),r=e(17172);function s({baseURL:C}){async function b(T){try{const{data:A,...R}=await(0,n.s)((0,r.AI)().fetch({...T,url:C+T.url,showErrorAlert:!1,data:T.body}));return{data:A,meta:R}}catch(A){return T.manageError?T.manageError(A):{error:A}}}return b}const g=(0,t.xP)({reducerPath:"migrateToCloudGeneratedAPI",baseQuery:s({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:C=>({getSessionList:C.query({query:()=>({url:"/cloudmigration/migration"})}),createSession:C.mutation({query:b=>({url:"/cloudmigration/migration",method:"POST",body:b.cloudMigrationSessionRequestDto})}),deleteSession:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}`,method:"DELETE"})}),getSession:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}`})}),createSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot`,method:"POST"})}),getSnapshot:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}`,params:{resultPage:b.resultPage,resultLimit:b.resultLimit}})}),cancelSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/cancel`,method:"POST"})}),uploadSnapshot:C.mutation({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshot/${b.snapshotUid}/upload`,method:"POST"})}),getShapshotList:C.query({query:b=>({url:`/cloudmigration/migration/${b.uid}/snapshots`,params:{page:b.page,limit:b.limit,sort:b.sort}})}),getCloudMigrationToken:C.query({query:()=>({url:"/cloudmigration/token"})}),createCloudMigrationToken:C.mutation({query:()=>({url:"/cloudmigration/token",method:"POST"})}),deleteCloudMigrationToken:C.mutation({query:b=>({url:`/cloudmigration/token/${b.uid}`,method:"DELETE"})}),getDashboardByUid:C.query({query:b=>({url:`/dashboards/uid/${b.uid}`})}),getLibraryElementByUid:C.query({query:b=>({url:`/library-elements/${b.libraryElementUid}`})})}),overrideExisting:!1}),{useGetSessionListQuery:i,useCreateSessionMutation:l,useDeleteSessionMutation:d,useGetSessionQuery:o,useCreateSnapshotMutation:u,useGetSnapshotQuery:c,useCancelSnapshotMutation:p,useUploadSnapshotMutation:h,useGetShapshotListQuery:y,useGetCloudMigrationTokenQuery:f,useCreateCloudMigrationTokenMutation:v,useDeleteCloudMigrationTokenMutation:P,useGetDashboardByUidQuery:m,useGetLibraryElementByUidQuery:D}=g,x=g.enhanceEndpoints({addTagTypes:["cloud-migration-token","cloud-migration-session","cloud-migration-snapshot"],endpoints:{getCloudMigrationToken:{providesTags:["cloud-migration-token"]},createCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},deleteCloudMigrationToken:{invalidatesTags:["cloud-migration-token"]},getSessionList:{providesTags:["cloud-migration-session"]},getSession:{providesTags:["cloud-migration-session"]},createSession:{invalidatesTags:["cloud-migration-session"]},deleteSession:{invalidatesTags:["cloud-migration-session","cloud-migration-snapshot"]},getShapshotList:{providesTags:["cloud-migration-snapshot"]},getSnapshot:{providesTags:["cloud-migration-snapshot"]},createSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},uploadSnapshot:{invalidatesTags:["cloud-migration-snapshot"]},getDashboardByUid:E,getLibraryElementByUid:E}});function E(C){if(!C.query)return;const b=C.query;C.query=(...T)=>{const A=b(...T);return A.showErrorAlert=!1,A}}},32931:(_,L,e)=>{"use strict";e.d(L,{EC:()=>i,L_:()=>a,YS:()=>s,bA:()=>g,wV:()=>l});var t=e(17172),n=e(82467),r=e(10943);function s(d={getBackendSrv:t.AI}){return async o=>{const u=await d.getBackendSrv().get("/api/org");return o((0,r.bK)(u)),u}}function a(d={getBackendSrv:t.AI}){return async(o,u)=>{const c=u().organization.organization;await d.getBackendSrv().put("/api/org",{name:c.name}),o((0,n.YA)(c.name)),o(s(d))}}function g(d,o={getBackendSrv:t.AI}){return async u=>{const c=await o.getBackendSrv().post("/api/user/using/"+d);u((0,n.YA)(c.name))}}function i(d,o={getBackendSrv:t.AI}){return async u=>{const c=await o.getBackendSrv().post("/api/orgs/",d);u(g(c.orgId))}}function l(d={getBackendSrv:t.AI}){return async o=>{const u=await d.getBackendSrv().get("/api/user/orgs");return o((0,r.Bz)(u)),u}}},10943:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>l,Bz:()=>g,bK:()=>a,n:()=>s});var t=e(65307);const n={organization:{},userOrgs:[]},r=(0,t.Z0)({name:"organization",initialState:n,reducers:{organizationLoaded:(d,o)=>({...d,organization:o.payload}),setOrganizationName:(d,o)=>({...d,organization:{...d.organization,name:o.payload}}),userOrganizationsLoaded:(d,o)=>({...d,userOrgs:o.payload})}}),{setOrganizationName:s,organizationLoaded:a,userOrganizationsLoaded:g}=r.actions,l={organization:r.reducer}},17888:(_,L,e)=>{"use strict";e.d(L,{a:()=>D});var t=e(74848),n=e(32196),r=e(47070),s=e(41987),a=e(13544),g=e(39601),i=e(40845),l=e(79041),d=e(96540),o=e(14578);const u=d.forwardRef(({icon:C,children:b,onClick:T,...A},R)=>{const S=(0,i.of)(c);return(0,t.jsxs)("button",{...A,className:S.action,onClick:T,children:[(0,t.jsx)(o.I,{name:C,size:"xl"}),b]})});u.displayName="CardButton";const c=C=>({action:(0,n.css)({display:"flex",flexDirection:"column",height:"100%",justifySelf:"center",cursor:"pointer",background:C.colors.background.secondary,borderRadius:C.shape.radius.default,color:C.colors.text.primary,border:"unset",width:"100%",justifyContent:"center",alignItems:"center",textAlign:"center","&:hover":{background:C.colors.emphasize(C.colors.background.secondary)}})});var p=e(15054),h=e(33390),y=e(53466),f=e(32696),v=e(14792),P=e(31678),m=e(79971);function D(C){const b=(0,i.of)(E),T=(0,l.d2)(),A=new r.v2(C.data),{dataSummary:R}=A,S=x(C,R),O=(0,P.useDispatch)(),j=(0,v.UA)().getCurrent()?.getPanelById(C.panelId),B=()=>{h.A.setObject(p.wV,f.__.Suggestions),O((0,y.eK)(!0))},N=()=>{j&&O((0,m.gW)({panel:j,pluginId:"table"}))},I=K=>{j&&(O((0,m.gW)({...K,panel:j})),K.transformations&&setTimeout(()=>{g.Ny.partial({tab:"transform"})},100))};return(0,t.jsxs)("div",{className:b.wrapper,children:[(0,t.jsx)("div",{className:b.message,"data-testid":a.Tp.components.Panels.Panel.PanelDataErrorMessage,children:S}),T.app===s.Jk.PanelEditor&&R.hasData&&j&&(0,t.jsxs)("div",{className:b.actions,children:[C.suggestions&&(0,t.jsx)(t.Fragment,{children:C.suggestions.map(K=>(0,t.jsx)(u,{icon:"process",onClick:()=>I(K),children:K.name},K.name))}),(0,t.jsx)(u,{icon:"table",onClick:N,children:"Switch to table"}),(0,t.jsx)(u,{icon:"chart-line",onClick:B,children:"Open visualization suggestions"})]})]})}function x({data:C,fieldConfig:b,message:T,needsNumberField:A,needsTimeField:R,needsStringField:S},O){return T||(!C.series||C.series.length===0||C.series.every(j=>j.length===0)?b?.defaults.noValue??"No data":S&&!O.hasStringField?"Data is missing a string field":A&&!O.hasNumberField?"Data is missing a number field":R&&!O.hasTimeField?"Data is missing a time field":"Cannot visualize data")}const E=C=>({wrapper:(0,n.css)({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%"}),message:(0,n.css)({textAlign:"center",color:C.colors.text.secondary,fontSize:C.typography.size.lg,width:"100%"}),actions:(0,n.css)({marginTop:C.spacing(2),display:"flex",height:"50%",maxHeight:"150px",columnGap:C.spacing(1),rowGap:C.spacing(1),width:"100%",maxWidth:"600px"})})},41394:(_,L,e)=>{"use strict";e.d(L,{$:()=>d,W:()=>l});var t=e(74848),n=e(96540),r=e(65158),s=e(43429),a=e(42418),g=e(31678);class i extends n.PureComponent{constructor(u){super(u)}render(){const u={display:"flex",alignItems:"center",justifyContent:"center",height:"100%"};return(0,t.jsx)("div",{style:u,children:(0,t.jsx)(a.F,{severity:g.AppNotificationSeverity.Error,...this.props})})}}function l(o,u){const c=class extends n.PureComponent{render(){const y=(0,t.jsxs)(t.Fragment,{children:["Check the server startup logs for more information. ",(0,t.jsx)("br",{}),"If this plugin was loaded from Git, then make sure it was compiled."]});return(0,t.jsx)(i,{title:`Error loading: ${o.id}`,text:y})}},p=new r.m(c);return p.meta=o,p.loadError=!0,p}function d(o,u){const c=class extends n.PureComponent{render(){return(0,t.jsx)(i,{title:`Panel plugin not found: ${o}`})}},p=new r.m(u?()=>null:c);return p.meta={id:o,name:o,sort:100,type:s.QE.panel,module:"",baseUrl:"",info:{author:{name:""},description:"",links:[],logos:{large:"",small:"public/img/grafana_icon.svg"},screenshots:[],updated:"",version:""}},p}},20726:(_,L,e)=>{"use strict";e.d(L,{m:()=>h});var t=e(74848),n=e(96540),r=e(1933),s=e(90708),a=e(13834),g=e(581),i=e(72574),l=e(40845),d=e(79041),o=e(66602),u=e(10096),c=e(15162);const p={defaults:{},overrides:[]};function h(f){const{pluginId:v,data:P,timeZone:m=(0,r.O)(),options:D={},width:x,height:E,title:C,onOptionsChange:b=()=>{},onChangeTimeRange:T=()=>{},onFieldConfigChange:A=()=>{},fieldConfig:R=p}=f,S=(0,l.$j)(),O=(0,i.w)(),j=(0,n.useMemo)(()=>O.replace.bind(O),[O]),[B,N]=(0,n.useState)((0,c.PY)(v)),[I,K]=(0,n.useState)(),w=y(B,D,R),{dataLinkPostProcessor:U}=(0,d.d2)(),W=(0,s.rJ)(B,w?.fieldConfig,P,m,S,j,U);if((0,n.useEffect)(()=>{B&&B.hasPluginId(v)||(0,c.TV)(v).then(z=>N(z)).catch(z=>{K(z.message)})},[v,B]),I)return(0,t.jsxs)("div",{children:["Failed to load plugin: ",I]});if(!B||!B.hasPluginId(v))return(0,t.jsx)("div",{children:"Loading plugin panel..."});if(!B.panel)return(0,t.jsx)("div",{children:"Seems like the plugin you are trying to load does not have a panel component."});if(!W)return(0,t.jsx)("div",{children:"No panel data"});const H=B.panel;return(0,t.jsx)(o.Xw,{dependencies:[B,P],children:(0,t.jsx)(a.a,{meta:B.meta,children:(0,t.jsx)(H,{id:1,data:W,title:C,timeRange:W.timeRange,timeZone:m,options:w.options,fieldConfig:R,transparent:!1,width:x,height:E,renderCounter:0,replaceVariables:z=>z,onOptionsChange:b,onFieldConfigChange:A,onChangeTimeRange:T,eventBus:u.lE})})})}function y(f,v,P){return(0,n.useMemo)(()=>{if(f)return(0,g.F)({plugin:f,currentOptions:v,currentFieldConfig:P,isAfterPluginChange:!1})},[f,P,v])}},25701:(_,L,e)=>{"use strict";e.d(L,{b:()=>y});var t=e(74848),n=e(32196),r=e(70255),s=e(43429),a=e(51527),g=e(13544),i=e(40845),l=e(29158),d=e(98624),o=e(72129),u=e(10803);const c=38,p=({isCurrent:m,title:D,plugin:x,onClick:E,onDelete:C,disabled:b,showBadge:T,description:A,children:R})=>{const S=(0,i.of)(v),O=b||x.state===s.pn.deprecated,j=(0,n.cx)({[S.item]:!0,[S.itemDisabled]:O,[S.current]:m});return(0,t.jsxs)("div",{className:j,"aria-label":g.Tp.components.PluginVisualization.item(x.name),"data-testid":g.Tp.components.PluginVisualization.item(x.name),onClick:O?void 0:E,title:m?"Click again to close this section":x.name,children:[(0,t.jsx)("img",{className:(0,n.cx)(S.img,{[S.disabled]:O}),src:x.info.logos.small,alt:""}),(0,t.jsxs)("div",{className:(0,n.cx)(S.itemContent,{[S.disabled]:O}),children:[(0,t.jsx)("div",{className:S.name,children:D}),A?(0,t.jsx)("span",{className:S.description,children:A}):null,R]}),T&&(0,t.jsx)("div",{className:(0,n.cx)(S.badge,{[S.disabled]:O}),children:(0,t.jsx)(P,{plugin:x})}),C&&(0,t.jsx)(l.K,{name:"trash-alt",onClick:B=>{B.stopPropagation(),C()},className:S.deleteButton,"aria-label":"Delete button on panel type card",tooltip:"Delete"})]})};p.displayName="PanelTypeCard";const h=({children:m,hasDescription:D,hasDelete:x,rootProps:E})=>{const C=(0,i.of)(v),b=(0,i.of)(f);return(0,t.jsxs)("div",{className:C.item,...E,children:[(0,t.jsx)(r.A,{className:(0,n.cx)(C.img,b.image),width:c,height:c}),(0,t.jsxs)("div",{className:C.itemContent,children:[(0,t.jsx)("div",{className:C.name,children:(0,t.jsx)(r.A,{width:160})}),D?(0,t.jsx)(r.A,{containerClassName:C.description,width:80}):null,m]}),x&&(0,t.jsx)(r.A,{containerClassName:(0,n.cx)(C.deleteButton,b.deleteButton),width:16,height:16})]})},y=(0,o.j)(p,h),f=()=>({deleteButton:(0,n.css)({lineHeight:1}),image:(0,n.css)({lineHeight:1})}),v=m=>({item:(0,n.css)({position:"relative",display:"flex",flexShrink:0,cursor:"pointer",background:m.colors.background.secondary,borderRadius:m.shape.radius.default,boxShadow:m.shadows.z1,border:`1px solid ${m.colors.background.secondary}`,alignItems:"center",padding:m.spacing(1),width:"100%",overflow:"hidden",[m.transitions.handleMotion("no-preference","reduce")]:{transition:m.transitions.create(["background"],{duration:m.transitions.duration.short})},"&:hover":{background:m.colors.emphasize(m.colors.background.secondary,.03)}}),itemContent:(0,n.css)({overflow:"hidden",position:"relative",padding:m.spacing(0,1)}),itemDisabled:(0,n.css)({cursor:"default","&, &:hover":{background:m.colors.action.disabledBackground}}),current:(0,n.css)({label:"currentVisualizationItem",border:`1px solid ${m.colors.primary.border}`,background:m.colors.action.selected}),disabled:(0,n.css)({opacity:.6,filter:"grayscale(1)",cursor:"default",pointerEvents:"none"}),name:(0,n.css)({textOverflow:"ellipsis",overflow:"hidden",fontSize:m.typography.size.sm,fontWeight:m.typography.fontWeightMedium,width:"100%"}),description:(0,n.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",color:m.colors.text.secondary,fontSize:m.typography.bodySmall.fontSize,fontWeight:m.typography.fontWeightLight,width:"100%",maxHeight:"4.5em"}),img:(0,n.css)({maxHeight:c,width:c,display:"flex",alignItems:"center"}),badge:(0,n.css)({background:m.colors.background.primary}),deleteButton:(0,n.css)({cursor:"pointer",marginLeft:"auto"})}),P=({plugin:m})=>(0,a.x)(m.signature)?(0,t.jsx)(d.B,{status:m.signature}):(0,t.jsx)(u.p,{state:m.state});P.displayName="PanelPluginBadge"},56707:(_,L,e)=>{"use strict";e.d(L,{a:()=>P});var t=e(74848),n=e(32196),r=e(16817),s=e(70713),a=e(40845),g=e(47070),i=e(32264),l=e(15162);const d=["timeseries","barchart","gauge","stat","piechart","bargauge","table","state-timeline","status-history","logs","candlestick","flamegraph","traces","nodeGraph"];async function o(x,E){const C=new g.v2(x,E);for(const T of d){const R=(await(0,l.TV)(T)).getSuggestionsSupplier();R&&R.getSuggestionsForData(C)}const b=C.getList();if(!i.$.featureToggles.vizAndWidgetSplit&&C.dataSummary.fieldCount===0)for(const T of Object.values(i.$.panels))!T.skipDataQuery||T.hideFromList||b.push({name:T.name,pluginId:T.id,description:T.info.description,cardOptions:{imgSrc:T.info.logos.small}});return b.sort((T,A)=>{if(C.dataSummary.preferredVisualisationType){if(T.pluginId===C.dataSummary.preferredVisualisationType)return-1;if(A.pluginId===C.dataSummary.preferredVisualisationType)return 1}return(A.score??g.nQ.OK)-(T.score??g.nQ.OK)})}var u=e(2543),c=e(13544),p=e(56034),h=e(20726);function y({data:x,suggestion:E,onChange:C,width:b}){const T=(0,a.of)(f),{innerStyles:A,outerStyles:R,renderWidth:S,renderHeight:O}=v(b),j=E.cardOptions??{},B={"aria-label":E.name,className:T.vizBox,"data-testid":c.Tp.components.VisualizationPreview.card(E.name),style:R,onClick:()=>{C({pluginId:E.pluginId,options:E.options,fieldConfig:E.fieldConfig})}};if(j.imgSrc)return(0,t.jsx)(p.m,{content:E.description??E.name,children:(0,t.jsxs)("button",{...B,className:(0,n.cx)(T.vizBox,T.imgBox),children:[(0,t.jsx)("div",{className:T.name,children:E.name}),(0,t.jsx)("img",{className:T.img,src:j.imgSrc,alt:E.name})]})});let N=E;return E.cardOptions?.previewModifier&&(N=(0,u.cloneDeep)(E),E.cardOptions.previewModifier(N)),(0,t.jsx)("button",{...B,children:(0,t.jsx)(p.m,{content:E.name,children:(0,t.jsxs)("div",{style:A,className:T.renderContainer,children:[(0,t.jsx)(h.m,{title:"",data:x,pluginId:E.pluginId,width:S,height:O,options:N.options,fieldConfig:N.fieldConfig}),(0,t.jsx)("div",{className:T.hoverPane})]})})})}const f=x=>({hoverPane:(0,n.css)({position:"absolute",top:0,right:0,left:0,borderRadius:x.spacing(2),bottom:0}),vizBox:(0,n.css)`
      position: relative;
      background: none;
      border-radius: ${x.shape.radius.default};
      cursor: pointer;
      border: 1px solid ${x.colors.border.medium};

      transition: ${x.transitions.create(["background"],{duration:x.transitions.duration.short})};

      &:hover {
        background: ${x.colors.background.secondary};
      }
    `,imgBox:(0,n.css)`
      display: flex;
      flex-direction: column;
      height: 100%;

      justify-self: center;
      color: ${x.colors.text.primary};
      width: 100%;
      display: flex;

      justify-content: center;
      align-items: center;
      text-align: center;
    `,name:(0,n.css)`
      padding-bottom: ${x.spacing(.5)};
      margin-top: ${x.spacing(-1)};
      font-size: ${x.typography.bodySmall.fontSize};
      white-space: nowrap;
      overflow: hidden;
      color: ${x.colors.text.secondary};
      font-weight: ${x.typography.fontWeightMedium};
      text-overflow: ellipsis;
    `,img:(0,n.css)`
      max-width: ${x.spacing(8)};
      max-height: ${x.spacing(8)};
    `,renderContainer:(0,n.css)`
      position: absolute;
      transform-origin: left top;
      top: 6px;
      left: 6px;
    `});function v(x){const C=x,b=x*(1/1.6),T=350,A=T*(1/1.6),R=6,S=(C-R*2)/T,O=(b-R*2)/A;return{renderHeight:A,renderWidth:T,outerStyles:{width:C,height:b},innerStyles:{width:T,height:A,transform:`scale(${S}, ${O})`}}}function P({searchQuery:x,onChange:E,data:C,panel:b}){const T=(0,a.of)(D),{value:A}=(0,r.A)(()=>o(C,b),[C,b]),R=m(x,A);return(0,t.jsx)("div",{children:(0,t.jsx)(s.Ay,{disableHeight:!0,style:{width:"100%",height:"100%"},children:({width:S})=>{if(!S)return null;S=S-1;const O=Math.floor(S/200),j=8*(O-1),B=Math.floor((S-j)/O);return(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:T.filterRow,children:(0,t.jsx)("div",{className:T.infoText,children:"Based on current data"})}),(0,t.jsxs)("div",{className:T.grid,style:{gridTemplateColumns:`repeat(auto-fill, ${B}px)`},children:[R.map((N,I)=>(0,t.jsx)(y,{data:C,suggestion:N,onChange:E,width:B-1},I)),x&&R.length===0&&(0,t.jsx)("div",{className:T.infoText,children:"No results matched your query"})]})]})}})})}function m(x,E){if(!x||!E)return E||[];const C=new RegExp(x,"i");return E.filter(b=>C.test(b.name)||C.test(b.pluginId))}const D=x=>({heading:(0,n.css)({...x.typography.h5,margin:x.spacing(0,.5,1)}),filterRow:(0,n.css)({display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center",paddingBottom:"8px"}),infoText:(0,n.css)({fontSize:x.typography.bodySmall.fontSize,color:x.colors.text.secondary,fontStyle:"italic"}),grid:(0,n.css)({display:"grid",gridGap:x.spacing(1),gridTemplateColumns:"repeat(auto-fill, 144px)",marginBottom:x.spacing(1),justifyContent:"space-evenly"})})},86292:(_,L,e)=>{"use strict";e.d(L,{G:()=>d});var t=e(74848),n=e(32196),r=e(96540),s=e(32264),a=e(40845),g=e(41670),i=e(17706),l=e(48889);function d({pluginId:u,searchQuery:c,onChange:p,isWidget:h=!1}){const y=(0,a.of)(o),f=(0,r.useMemo)(()=>s.$.featureToggles.vizAndWidgetSplit?h?(0,i.nr)():(0,i.if)():(0,i.A4)(),[h]),v=(0,r.useMemo)(()=>(0,i.CO)(f,c,u),[f,c,u]);return v.length===0?(0,t.jsx)(g.Z,{children:"Could not find anything matching your query"}):(0,t.jsx)("div",{className:y.grid,children:v.map(P=>(0,t.jsx)(l.f,{disabled:!1,isCurrent:P.id===u,plugin:P,onClick:m=>p({pluginId:P.id,withModKey:m.metaKey||m.ctrlKey||m.altKey})},P.id))})}const o=u=>({grid:(0,n.css)({maxWidth:"100%",display:"grid",gridGap:u.spacing(.5)}),heading:(0,n.css)({...u.typography.h5,margin:u.spacing(0,.5,1)})})},48889:(_,L,e)=>{"use strict";e.d(L,{f:()=>r});var t=e(74848),n=e(25701);const r=({isCurrent:s,plugin:a,onClick:g,disabled:i})=>(0,t.jsx)(n.b,{title:a.name,plugin:a,description:a.info.description,onClick:g,isCurrent:s,disabled:i,showBadge:!0});r.displayName="VizTypePickerPlugin"},32349:(_,L,e)=>{"use strict";e.d(L,{CH:()=>l,E7:()=>i,EO:()=>g});var t=e(14236),n=e(83195),r=e(92461),s=e(32023),a=e(29304);const g=d=>{const o=d.field.links;if(!(!o||o.length===0))return{getLinks:u=>{const c={};if(d.view){const{dataFrame:h}=d.view;c.__series={value:{name:h.name,refId:h.refId},text:"Series"};const y=d.colIndex!==void 0?h.fields[d.colIndex]:void 0;if(y){if(c.__field={value:{name:y.name,labels:y.labels},text:"Field"},d.rowIndex!==void 0&&d.rowIndex>=0){const{timeField:f}=(0,t.KR)(h);c.__value={value:{raw:y.values[d.rowIndex],numeric:d.display.numeric,text:(0,n.cN)(d.display),time:f?f.values[d.rowIndex]:void 0},text:"Value"}}d.view&&(c.__data={value:{name:h.name,refId:h.refId,fields:(0,r.F)({frame:h,rowIndex:d.rowIndex})},text:"Data"})}else c.__value={value:{raw:d.display.numeric,numeric:d.display.numeric,text:(0,n.cN)(d.display),calc:d.name},text:"Value"}}else console.log("VALUE",d);const p=(h,y,f)=>{const v={...c,...y};return u(h,v,f)};return o.map(h=>(0,a.mQ)().getDataLinkUIModel(h,p,d))}}},i=(d,o)=>{const u=d.links;if(!(!u||u.length===0))return{getLinks:()=>u.map(c=>(0,a.mQ)().getDataLinkUIModel(c,o||d.replaceVariables,d))}},l=(d,o)=>{const u=s.b4.getPanelLinks(d)?.state.rawLinks;if(!(!u||u.length===0))return{getLinks:()=>u.map(c=>(0,a.mQ)().getDataLinkUIModel(c,o,d))}}},29304:(_,L,e)=>{"use strict";e.d(L,{Fq:()=>P,Hf:()=>x,mQ:()=>A});var t=e(2543),n=e.n(t),r=e(6709),s=e(91890),a=e(28240),g=e(11261),i=e(71733),l=e(80997),d=e(76885),o=e(95344),u=e(72574),c=e(52622),p=e(2913);const h=[{value:`${r.c.keepTime}`,label:"Time range",documentation:"Adds current time range",origin:s.$0.BuiltIn},{value:`${r.c.timeRangeFrom}`,label:"Time range: from",documentation:"Adds current time range's from value",origin:s.$0.BuiltIn},{value:`${r.c.timeRangeTo}`,label:"Time range: to",documentation:"Adds current time range's to value",origin:s.$0.BuiltIn}],y=[{value:`${r.c.seriesName}`,label:"Name",documentation:"Name of the series",origin:s.$0.Series}],f=[{value:`${r.c.valueNumeric}`,label:"Numeric",documentation:"Numeric representation of selected value",origin:s.$0.Value},{value:`${r.c.valueText}`,label:"Text",documentation:"Text representation of selected value",origin:s.$0.Value},{value:`${r.c.valueRaw}`,label:"Raw",documentation:"Raw value",origin:s.$0.Value}],v=R=>R.includes(".")||R.trim().includes(" ")?`["${R}"]`:`.${R}`,P=()=>[...(0,u.w)().getVariables().map(R=>({value:R.name,label:R.name,origin:s.$0.Template})),{value:`${r.c.includeVars}`,label:"All variables",documentation:"Adds current variables",origin:s.$0.Template},...h],m=R=>{const S=[];for(const j of R)for(const B of j.fields)if(B.labels)for(const N of Object.keys(B.labels))S.push(N);const O=(0,t.chain)(S).flatten().uniq().value();return[{value:`${r.c.fieldName}`,label:"Name",documentation:"Field name of the clicked datapoint (in ms epoch)",origin:s.$0.Field},...O.map(j=>({value:`__field.labels${v(j)}`,label:`labels.${j}`,documentation:`${j} label value`,origin:s.$0.Field}))]},D=R=>{let S,O;const j=[],B={};if(R.length!==1)return[];const N=R[0];for(const I of N.fields){const K=(0,a.Ct)(I,N,R);B[K]||(j.push({value:`__data.fields${v(K)}`,label:`${K}`,documentation:`Formatted value for ${K} on the same row`,origin:s.$0.Fields}),B[K]=!0,!S&&I.type===g.PU.number&&(S={...I,name:K}),!O&&I.config.displayName&&I.config.displayName!==I.name&&(O={...I,name:K}))}return j.length&&j.push({value:"__data.fields[0]",label:"Select by index",documentation:"Enter the field order",origin:s.$0.Fields}),S&&(j.push({value:`__data.fields${v(S.name)}.numeric`,label:"Show numeric value",documentation:"the numeric field value",origin:s.$0.Fields}),j.push({value:`__data.fields${v(S.name)}.text`,label:"Show text value",documentation:"the text value",origin:s.$0.Fields})),O&&j.push({value:`__data.fields${v(O.name)}`,label:"Select by title",documentation:"Use the title to pick the field",origin:s.$0.Fields}),j},x=(R,S)=>{const O={value:`${r.c.valueTime}`,label:"Time",documentation:"Time value of the clicked datapoint (in ms epoch)",origin:s.$0.Value};return S===s.uP.Values?[...y,...m(R),...f,O,...D(R),...P()]:[...y,...m(R),...D(R),...P()]},E=R=>{const S=m(R),O={value:`${DataLinkBuiltInVars.valueCalc}`,label:"Calculation name",documentation:"Name of the calculation the value is a result of",origin:VariableOrigin.Value};return[...y,...S,...f,O,...P()]};class C{constructor(){this.getDataLinkUIModel=(S,O,j)=>{let B=S.url;S.onBuildUrl&&(B=S.onBuildUrl({origin:j,replaceVariables:O}));const N={href:i.I.assureBaseUrl(B.replace(/\n/g,"")),title:S.title??"",target:S.targetBlank?"_blank":void 0,origin:j};return O&&(N.href=O(N.href,void 0,c.$m.UriEncode),N.title=O(S.title)),S.onClick&&(N.onClick=I=>{S.onClick({origin:j,replaceVariables:O,e:I})}),N.href=(0,p.zj)().disableSanitizeHtml?N.href:l.sQ.sanitizeUrl(N.href),N}}getLinkUrl(S){let O={};S.keepTime&&(O[`$${r.c.keepTime}`]=!0),S.includeVars&&(O[`$${r.c.includeVars}`]=!0);let j=i.I.assureBaseUrl(d.kM.appendQueryToUrl(S.url||"",d.kM.toUrlParams(O)));return j=(0,u.w)().replace(j),(0,p.zj)().disableSanitizeHtml?j:l.sQ.sanitizeUrl(j)}getAnchorInfo(S){const O=(0,u.w)();return{href:this.getLinkUrl(S),title:O.replace(S.title||""),tooltip:O.replace(S.tooltip||"")}}getPanelLinkAnchorInfo(S,O){(0,o.l)("link_srv.ts","getPanelLinkAnchorInfo","getDataLinkUIModel");const j=(B,N,I)=>(0,u.w)().replace(B,{...O,...N},I);return this.getDataLinkUIModel(S,j,{})}}let b;function T(R){b=R}function A(){return b||(b=new C),b}},79971:(_,L,e)=>{"use strict";e.d(L,{Ap:()=>i,O6:()=>l,Xk:()=>o,gW:()=>d});var t=e(581),n=e(57767),r=e(41394),s=e(20701),a=e(28444),g=e(80095);function i(c){return async(p,h)=>{if(c.libraryPanel?.uid&&!("model"in c.libraryPanel)){p(u(c));return}c.maxDataPoints&&(c.maxDataPoints=Number(c.maxDataPoints));let y=c.type,f=h().plugins.panels[y];if(!f)try{f=await p((0,s.y7)(y))}catch{f=(0,r.$)(y,y==="row")}c.plugin||await c.pluginLoaded(f),p((0,g.XM)({key:c.key,plugin:f}))}}function l(c){return p=>{p((0,g.FC)({key:c}))}}function d({panel:c,pluginId:p,options:h,fieldConfig:y,transformations:f}){return async(v,P)=>{if(c.type===p&&!h&&!y&&!f)return;let D=P().plugins.panels[p];if(D||(D=await v((0,s.y7)(p))),c.type!==p&&c.changePlugin(D),h||y||f){const x=(0,t.F)({plugin:D,currentOptions:h||c.options,currentFieldConfig:y||c.fieldConfig,isAfterPluginChange:!1});c.options=x.options,c.fieldConfig=x.fieldConfig,c.transformations=f||c.transformations,c.configRev++}c.generateNewKey(),v((0,g.XM)({key:c.key,plugin:D}))}}function o(c,p){return async(h,y)=>{const f=p.model.type,v=c.type;if(c.restoreModel({...p.model,gridPos:c.gridPos,id:c.id,libraryPanel:p}),c.getQueryRunner().clearLastResult(),v!==f){let m=y().plugins.panels[f];m||(m=await h((0,s.y7)(f))),await c.pluginLoaded(m),c.generateNewKey(),await h((0,g.XM)({key:c.key,plugin:m}))}else{const P=c.key;c.generateNewKey(),h((0,g.io)({oldKey:P,newKey:c.key}))}c.configRev=0,c.hasSavedPanelEditChange=!0,c.refresh(),c.events.publish(a.zq),c.events.publish(a.PR)}}function u(c){return async(p,h)=>{const y=c.libraryPanel.uid;try{const f=await(0,n.Yr)(y,!0);c.initLibraryPanel(f);const v=h().dashboard.getModel();if(c.repeat&&v){const P=v.panels.findIndex(m=>m.id===c.id);v.repeatPanel(c,P),v.sortPanelsByGridPos(),v.events.publish(new a.Q$)}await p(i(c))}catch(f){console.log("ERROR: ",f),p((0,g.XM)({key:c.key,plugin:(0,r.$)("Unable to load library panel: "+y,!1)}))}}}},80095:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>u,FC:()=>l,S3:()=>a,XM:()=>s,io:()=>i,nF:()=>g,rG:()=>d});var t=e(65307);const n={},r=(0,t.Z0)({name:"panels",initialState:n,reducers:{panelModelAndPluginReady:(c,p)=>{c[p.payload.key]={plugin:p.payload.plugin}},changePanelKey:(c,p)=>{c[p.payload.newKey]=c[p.payload.oldKey],delete c[p.payload.oldKey]},removePanel:(c,p)=>{delete c[p.payload.key]},removeAllPanels:c=>{Object.keys(c).forEach(p=>delete c[p])},setPanelInstanceState:(c,p)=>{c[p.payload.key].instanceState=p.payload.value},setPanelAngularComponent:(c,p)=>{const h=c[p.payload.key];h.angularComponent=p.payload.angularComponent}}}),{panelModelAndPluginReady:s,setPanelAngularComponent:a,setPanelInstanceState:g,changePanelKey:i,removePanel:l,removeAllPanels:d}=r.actions,u={panels:r.reducer}},40334:(_,L,e)=>{"use strict";e.d(L,{U:()=>t});function t(n,r){return n.panels[r.key]}},17706:(_,L,e)=>{"use strict";e.d(L,{A4:()=>s,CO:()=>i,if:()=>g,nr:()=>a});var t=e(43429),n=e(54479),r=e(2913);function s(){const l=r.$W.panels;return Object.keys(l).filter(d=>l[d].hideFromList===!1).map(d=>l[d]).sort((d,o)=>d.sort-o.sort)}function a(){return s().filter(l=>!!l.skipDataQuery)}function g(){return s().filter(l=>!l.skipDataQuery)}function i(l,d,o){if(!d.length)return l.filter(y=>y.state===t.pn.deprecated?o===y.id:!0);const u=(0,n.xb)(d).toLowerCase(),c=[],p=[],h="graph".startsWith(u);for(const y of l){if(y.state===t.pn.deprecated&&o!==y.id)continue;const v=y.name.toLowerCase().indexOf(u);v===0?c.push(y):v>0?p.push(y):h&&y.id==="timeseries"&&c.push(y)}return c.concat(p)}},2609:(_,L,e)=>{"use strict";e.d(L,{_o:()=>u});var t=e(2543),n=e.n(t),r=e(71733),s=e(76885),a=e(65879),g=e(39601),i=e(2619),l=e(86022);const d={kiosk:!0,autofitpanels:!0,orgId:!0,"_dash.hideTimePicker":!0,"_dash.hideVariables":!0,"_dash.hideLinks":!0};class o extends i.Q{constructor(){super({isPlaying:!1}),this.urls=[],this.index=0,this.numberOfLoops=0,this.locationUpdated=this.locationUpdated.bind(this),this.api=(0,l.NF)()}next(){if(clearTimeout(this.nextTimeoutId),this.index>this.urls.length-1){if(this.numberOfLoops++,this.numberOfLoops>=3){window.location.href=this.startUrl;return}this.index=0}const h=this.urls[this.index],y=g.Ny.getSearchObject(),f=(0,t.pickBy)(y,(P,m)=>d[m]),v=r.I.stripBaseFromUrl(h);this.index++,this.validPlaylistUrl=v,this.nextTimeoutId=setTimeout(()=>this.next(),this.interval),g.Ny.push(v+"?"+s.kM.toUrlParams(f))}prev(){this.index=Math.max(this.index-2,0),this.next()}locationUpdated(p){p.pathname!==this.validPlaylistUrl&&this.stop()}async start(p){this.stop(),this.startUrl=window.location.href,this.index=0,this.setState({isPlaying:!0}),this.locationListenerUnsub=g.Ny.getHistory().listen(this.locationUpdated);const h=[];let y=await this.api.getPlaylist(p);if(!y.items?.length)return;this.interval=a.intervalToMs(y.interval);const f=await(0,l.qY)(y.items);for(const v of f)if(v.dashboards)for(const P of v.dashboards)h.push(P.url);h.length&&(this.urls=h,this.setState({isPlaying:!0}),this.next())}stop(){this.state.isPlaying&&(this.index=0,this.setState({isPlaying:!1}),this.locationListenerUnsub&&this.locationListenerUnsub(),this.nextTimeoutId&&clearTimeout(this.nextTimeoutId),g.Ny.getSearchObject().kiosk&&g.Ny.partial({kiosk:null}))}}const u=new o},86022:(_,L,e)=>{"use strict";e.d(L,{GM:()=>m,NF:()=>D,aV:()=>P,qY:()=>v});var t=e(75505),n=e(78368),r=e(17172),s=e(32264),a=e(82467),g=e(3169),i=e(90183),l=e(68706),d=e(99140),o=e(2468),u=e(65812);class c{async getAllPlaylist(){return(0,r.AI)().get("/api/playlists/")}async getPlaylist(E){const C=await(0,r.AI)().get(`/api/playlists/${E}`);return await y(C),C}async createPlaylist(E){await f(()=>(0,r.AI)().post("/api/playlists",E))}async updatePlaylist(E){await f(()=>(0,r.AI)().put(`/api/playlists/${E.uid}`,E))}async deletePlaylist(E){await f(()=>(0,r.AI)().delete(`/api/playlists/${E}`),"Playlist deleted")}}class p{constructor(){this.playlistAsK8sResource=E=>({metadata:{name:E.uid},spec:{title:E.name,interval:E.interval,items:E.items??[]}}),this.server=new o.w({group:"playlist.grafana.app",version:"v0alpha1",resource:"playlists"})}async getAllPlaylist(){return(await this.server.list()).items.map(h)}async getPlaylist(E){const C=await this.server.get(E),b=h(C);return await y(b),b}async createPlaylist(E){const C=this.playlistAsK8sResource(E);await f(async()=>{await this.server.create(C)})}async updatePlaylist(E){const C=this.playlistAsK8sResource(E);await f(()=>this.server.update(C).then(()=>{}))}async deletePlaylist(E){await f(()=>this.server.delete(E).then(()=>{}),"Playlist deleted")}}function h(x){const{spec:E,metadata:C}=x;return{uid:C.name,name:E.title,interval:E.interval,items:E.items}}async function y(x){if(x?.items){for(const E of x.items)if(E.type==="dashboard_by_id"){E.type="dashboard_by_uid";const C=await(0,r.AI)().get(`/api/dashboards/ids/${E.value}`);C?.length&&(E.value=C[0])}}}async function f(x,E="Playlist saved"){try{await x(),(0,d.JD)((0,a.dx)((0,g.tZ)(E)))}catch(C){C instanceof Error&&(0,d.JD)((0,a.dx)((0,g.gi)("Unable to save playlist",C)))}}async function v(x){let E=0;if(!x?.length)return[];const C=[];for(const A of x){const R={query:"*",kind:["dashboard"],limit:1e3};switch(A.type){case"dashboard_by_id":throw new Error("invalid item (with id)");case"dashboard_by_uid":R.uid=[A.value];break;case"dashboard_by_tag":R.tags=[A.value];break}C.push({refId:`${E++}`,queryType:l.nj.Search,search:R})}if(!s.$.featureToggles.panelTitleSearch){const A=(0,u.getGrafanaSearcher)(),R=[];for(let S=0;S<C.length;S++){const O=(await A.search(C[S].search)).view;R.push({...x[S],dashboards:O.map(j=>({...j}))})}return R}const b=await(0,i.o)(),T=await(0,t.s)(b.query({targets:C}));if(T.data.length!==x.length)throw new Error("unexpected result size");return x.map((A,R)=>{const S=new n.R(T.data[R]);return{...A,dashboards:S.map(O=>({...O}))}})}function P(){return{items:[],interval:"5m",name:"",uid:""}}function m(x,E){return E?.length?(E=E.toLowerCase(),x.filter(C=>C.name.toLowerCase().includes(E))):x}function D(){return s.$.featureToggles.kubernetesPlaylists?new p:new c}},84684:(_,L,e)=>{"use strict";e.d(L,{Ap:()=>h,Bj:()=>l,CB:()=>g,Gd:()=>p,T_:()=>i,XP:()=>y,cu:()=>v,ij:()=>P,xZ:()=>f});var t=e(36663),n=e(17172),r=e(80714),s=e(6745),a=e(5129);async function g(D){const x=await d(D),E=!!x,[C,b,T,A]=await Promise.all([p(),o(D,E),u(D),c(D)]),R=C.find(O=>O.id===D),S=R?.dependencies||x?.json?.dependencies;return{grafanaDependency:S?.grafanaDependency??S?.grafanaVersion??"",pluginDependencies:S?.plugins||[],links:R?.info.links||x?.json?.info.links||[],readme:T||x?.readme,versions:b,statusContext:x?.statusContext??"",iam:x?.json?.iam,changelog:A||x?.changelog}}async function i(){try{const{items:D}=await(0,n.AI)().get(`${s.P5}/plugins`,{includeDeprecated:!0});return D.filter(a.hY)}catch(D){if((0,n.NF)(D))return D.isHandled=!0,console.error("Failed to fetch plugins from catalog (default https://grafana.com/api/plugins)"),[];throw D}}async function l(){try{return await(0,n.AI)().get(`${s.Sw}/errors`)}catch{return[]}}async function d(D){try{return await(0,n.AI)().get(`${s.P5}/plugins/${D}`,{})}catch(x){(0,n.NF)(x)&&(x.isHandled=!0);return}}async function o(D,x){try{return x?((await(0,n.AI)().get(`${s.P5}/plugins/${D}/versions`)).items||[]).map(C=>({version:C.version,createdAt:C.createdAt,isCompatible:C.isCompatible,grafanaDependency:C.grafanaDependency})):[]}catch(E){return(0,n.NF)(E)&&(E.isHandled=!0),[]}}async function u(D){try{const x=await(0,n.AI)().get(`${s.Sw}/${D}/markdown/README`);return x?(0,t.G)(x):""}catch(x){return(0,n.NF)(x)&&(x.isHandled=!0),""}}async function c(D){try{const x=await(0,n.AI)().get(`${s.Sw}/${D}/markdown/CHANGELOG`);return x?(0,t.G)(x):""}catch(x){return(0,n.NF)(x)&&(x.isHandled=!0),""}}async function p(){return(await(0,n.AI)().get(`${s.Sw}`,(0,r.F)({embedded:0}))).filter(a.Sq)}async function h(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/plugins`);return D}async function y(){const{items:D}=await(0,n.AI)().get(`${s.Mi}/provisioned-plugins`);return D.map(x=>({slug:x.type}))}async function f(D){return await(0,n.AI)().post(`${s.Sw}/${D}/install`,void 0,{showErrorAlert:!1})}async function v(D){return await(0,n.AI)().post(`${s.Sw}/${D}/uninstall`)}async function P(D,x){return(await(0,n.AI)().datasourceRequest({url:`/api/plugins/${D}/settings`,method:"POST",data:x}))?.data}const m={getRemotePlugins:i,getInstalledPlugins:p,installPlugin:f,uninstallPlugin:v}},42930:(_,L,e)=>{"use strict";e.d(L,{G:()=>s});var t=e(74848),n=e(32196),r=e(40845);const s=({children:g,wrap:i,className:l})=>{const d=(0,r.$j)(),o=a(d,i);return(0,t.jsx)("div",{className:(0,n.cx)(o.container,l),children:g})},a=(g,i)=>({container:(0,n.css)`
    display: flex;
    flex-direction: row;
    flex-wrap: ${i?"wrap":"no-wrap"};
    & > * {
      margin-bottom: ${g.spacing()};
      margin-right: ${g.spacing()};
    }
    & > *:last-child {
      margin-right: 0;
    }
  `})},6745:(_,L,e)=>{"use strict";e.d(L,{Mi:()=>n,P5:()=>r,Sw:()=>t,fu:()=>s});const t="/api/plugins",n="/api/instance",r="/api/gnet",s="plugins"},5129:(_,L,e)=>{"use strict";e.d(L,{Gl:()=>E,H2:()=>f,N6:()=>b,R7:()=>w,Sq:()=>T,TD:()=>K,Xc:()=>P,by:()=>v,hY:()=>A,j_:()=>C,kH:()=>h,td:()=>u,tr:()=>x});var t=e(53076),n=e(43429),r=e(53531),s=e(32264),a=e(33378),g=e(2913),i=e(10096),l=e(27677),d=e(31678),o=e(66253);function u({local:U=[],remote:W=[],instance:H=[],provisioned:z=[],pluginErrors:G}){const M=[],Q=m(G),Y=H.reduce((te,X)=>(te.set(X.pluginSlug,X),te),new Map),q=z.reduce((te,X)=>(te.add(X.slug),te),new Set);return U.forEach(te=>{const X=W.find(ne=>ne.slug===te.id),ee=Q[te.id];X||M.push(c(te,void 0,ee))}),W.forEach(te=>{const X=U.find(Z=>Z.id===te.slug),ee=Q[te.slug];if(!(te.status===o.Uy.Deprecated&&!X)){const Z=c(X,te,ee);if(g.Ay.featureToggles.managedPluginsInstall&&s.$.pluginAdminExternalManageEnabled){Z.isFullyInstalled=Z.isCore?!0:(Y.has(te.slug)||q.has(te.slug))&&Z.isInstalled,Z.isInstalled=Y.has(te.slug)||Z.isInstalled;const ae=Y.get(te.slug);Z.isUpdatingFromInstance=Y.has(te.slug)&&Z.hasUpdate&&Z.installedVersion!==ae?.version,ae?.version&&ae?.version!==te.version&&(Z.hasUpdate=!0),Z.isUninstallingFromInstance=!!X&&!Y.has(te.slug),Z.isProvisioned=q.has(te.slug)}M.push(Z)}}),M}function c(U,W,H){return!U&&W?p(W,H):U&&!W?h(U,H):y(U,W,H)}function p(U,W){const{name:H,slug:z,description:G,version:M,orgName:Q,popularity:Y,downloads:q,typeCode:te,updatedAt:X,createdAt:ee,status:ne,angularDetected:Z,keywords:ae}=U,re=!!W||j(te);return{description:G,downloads:q,id:z,info:{logos:{small:`${s.$.appSubUrl}/api/gnet/plugins/${z}/versions/${M}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${z}/versions/${M}/logos/large`},keywords:ae},name:H,orgName:Q,popularity:Y,publishedAt:ee,signature:D({remote:U,error:W}),updatedAt:X,hasUpdate:!1,isPublished:!0,isInstalled:re,isDisabled:re,isManaged:S(z),isPreinstalled:O(z),isDeprecated:ne===o.Uy.Deprecated,isCore:U.internal,isDev:!1,isEnterprise:ne===o.Uy.Enterprise,type:te,error:W?.errorCode,angularDetected:Z,isFullyInstalled:re,latestVersion:U.version}}function h(U,W){const{name:H,info:{description:z,version:G,logos:M,updated:Q,author:Y,keywords:q},id:te,dev:X,type:ee,signature:ne,signatureOrg:Z,signatureType:ae,hasUpdate:re,accessControl:se,angularDetected:de}=U,le=!!W||j(ee);return{description:z,downloads:0,id:te,info:{logos:M,keywords:q},name:H,orgName:Y.name,popularity:0,publishedAt:"",signature:D({local:U,error:W}),signatureOrg:Z,signatureType:ae,updatedAt:Q,installedVersion:G,hasUpdate:re,isInstalled:!0,isDisabled:le,isCore:ne==="internal",isPublished:!1,isDeprecated:!1,isDev:!!X,isEnterprise:!1,isManaged:S(te),isPreinstalled:O(te),type:ee,error:W?.errorCode,accessControl:se,angularDetected:de,isFullyInstalled:!0,iam:U.iam,latestVersion:U.latestVersion}}function y(U,W,H){const z=U?.info.version,G=W?.slug||U?.id||"",M=U?.type||W?.typeCode,Q=!!H||j(M),Y=W?.keywords||U?.info.keywords||[];let q={small:`/public/img/icn-${M}.svg`,large:`/public/img/icn-${M}.svg`};return W?q={small:`${s.$.appSubUrl}/api/gnet/plugins/${G}/versions/${W.version}/logos/small`,large:`${s.$.appSubUrl}/api/gnet/plugins/${G}/versions/${W.version}/logos/large`}:U&&U.info.logos&&(q=U.info.logos),{description:U?.info.description||W?.description||"",downloads:W?.downloads||0,hasUpdate:U?.hasUpdate||!1,id:G,info:{logos:q,keywords:Y},isCore:!!(W?.internal||U?.signature===n.Ac.internal),isDev:!!U?.dev,isEnterprise:W?.status===o.Uy.Enterprise,isInstalled:!!U||Q,isDisabled:Q,isDeprecated:W?.status===o.Uy.Deprecated,isPublished:!0,isManaged:S(G),isPreinstalled:O(G),name:W?.name||U?.name||"",orgName:W?.orgName||U?.info.author.name||"",popularity:W?.popularity||0,publishedAt:W?.createdAt||"",type:M,signature:D({local:U,remote:W,error:H}),signatureOrg:U?.signatureOrg||W?.versionSignedByOrgName,signatureType:U?.signatureType||W?.versionSignatureType||W?.signatureType||void 0,updatedAt:W?.updatedAt||U?.info.updated||"",installedVersion:z,error:H?.errorCode,accessControl:U?.accessControl,angularDetected:U?.angularDetected??W?.angularDetected,isFullyInstalled:!!U||Q,iam:U?.iam,latestVersion:U?.latestVersion||W?.version||""}}const f=U=>`${s.$.pluginCatalogURL}${U}`;var v=(U=>(U.nameAsc="nameAsc",U.nameDesc="nameDesc",U.updated="updated",U.published="published",U.downloads="downloads",U))(v||{});const P=(U,W)=>{const H={nameAsc:(z,G)=>z.name.localeCompare(G.name),nameDesc:(z,G)=>G.name.localeCompare(z.name),updated:(z,G)=>(0,r.b)(G.updatedAt).valueOf()-(0,r.b)(z.updatedAt).valueOf(),published:(z,G)=>(0,r.b)(G.publishedAt).valueOf()-(0,r.b)(z.publishedAt).valueOf(),downloads:(z,G)=>G.downloads-z.downloads};return H[W]?U.sort(H[W]):U};function m(U=[]){return U.reduce((W,H)=>(W[H.pluginId]=H,W),{})}function D(U){const{error:W,local:H,remote:z}=U;if(W)switch(W.errorCode){case n.ZK.invalidSignature:return n.Ac.invalid;case n.ZK.missingSignature:return n.Ac.missing;case n.ZK.modifiedSignature:return n.Ac.modified}return H?.signature?H.signature:z?.signatureType&&z?.versionSignatureType?n.Ac.valid:n.Ac.missing}const x=()=>(0,l.AI)().get("/api/frontend/settings").then(U=>{s.$.panels=U.panels});function E(U){if(!U)return;const[W]=U.filter(H=>!!H.isCompatible);return W}const C=()=>s.$.pluginAdminEnabled,b=(U,W,H)=>{const z=s.$.pluginAdminExternalManageEnabled,G=i.TP.hasPermission(d.AccessControlAction.PluginsInstall),M=!!H;return U.type===n.QE.renderer||U.type===n.QE.secretsmanager||U.isEnterprise&&!(0,a.a)("enterprise.plugins")||U.isDev||!G&&!z||!U.isPublished||!M||!W},T=U=>R(U.id),A=U=>R(U.slug);function R(U){const{pluginCatalogHiddenPlugins:W}=s.$;return!W.includes(U)}function S(U){const{pluginCatalogManagedPlugins:W}=s.$;return W?.includes(U)}function O(U){const{pluginCatalogPreinstalledPlugins:W}=s.$,H=W?.find(z=>z.id===U);return{found:!!H?.id,withVersion:!!H?.version}}function j(U){return U===n.QE.secretsmanager&&!s.$.secretsManagerPluginEnabled}function B(U){return U?.signature==="internal"}function N(U){return U.split(" - ")[0]}function I(U){return U.reduce((W,{id:H,name:z,type:G,orgName:M,info:Q})=>{const Y=Q.keywords?.join(" ").toLowerCase(),q=`${H} - ${z} - ${G} - ${M} - ${Y}`;return W.push(q),W},[])}function K(U,W){const H=I(U);let G=new t.A({intraMode:1,intraSub:0}).filter(H,W);return G===null?null:G.map(M=>N(H[M]))}function w(U){return!(!U.hasUpdate||U.isProvisioned||U.isCore||U.type===n.QE.renderer||U.isPreinstalled.withVersion||U.isUpdatingFromInstance||U.isManaged)}},20701:(_,L,e)=>{"use strict";e.d(L,{JC:()=>A,JJ:()=>P,LR:()=>v,NJ:()=>S,aU:()=>D,ai:()=>b,h9:()=>R,mj:()=>f,nT:()=>T,t5:()=>m,y7:()=>O});var t=e(65307),n=e(65474),r=e(62467),s=e(66847),a=e(45650),g=e(90593),i=e(75505),l=e(32264),d=e(17172),o=e(2913),u=e(15162),c=e(81900),p=e(84684),h=e(6745),y=e(5129);const f=(0,t.zD)(`${h.fu}/fetchAll`,async(j,B)=>{try{B.dispatch({type:`${h.fu}/fetchLocal/pending`}),B.dispatch({type:`${h.fu}/fetchRemote/pending`});const N=l.$.pluginAdminExternalManageEnabled&&o.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.Ap)()):(0,r.of)(void 0),I=l.$.pluginAdminExternalManageEnabled&&o.Ay.featureToggles.managedPluginsInstall?(0,n.H)((0,p.XP)()):(0,r.of)(void 0),K=500,w=(0,n.H)((0,p.Bj)()),U=(0,n.H)((0,p.Gd)()),W=(0,n.H)((0,p.T_)()).pipe((0,s.W)(H=>(B.dispatch({type:`${h.fu}/fetchRemote/rejected`}),console.error(H),(0,r.of)([]))));return(0,a.p)({local:U,remote:W,instance:N,provisioned:I,pluginErrors:w}).pipe((0,g.w)({each:K,with:()=>(W.subscribe(async H=>{if(B.dispatch({type:`${h.fu}/fetchRemote/fulfilled`}),H.length>0){const z=await(0,i.s)(U),G=await(0,i.s)(N),M=await(0,i.s)(I),Q=await(0,i.s)(w);B.dispatch(D((0,y.td)({local:z,remote:H,instance:G,provisioned:M,pluginErrors:Q})))}}),(0,a.p)({local:U,instance:N,provisioned:I,pluginErrors:w}))})).subscribe(({local:H,remote:z,instance:G,provisioned:M,pluginErrors:Q})=>{H&&z?(B.dispatch({type:`${h.fu}/fetchLocal/fulfilled`}),B.dispatch({type:`${h.fu}/fetchRemote/fulfilled`}),B.dispatch(D((0,y.td)({local:H,remote:z,instance:G,provisioned:M,pluginErrors:Q})))):H&&(B.dispatch({type:`${h.fu}/fetchLocal/fulfilled`}),B.dispatch(D((0,y.td)({local:H,pluginErrors:Q}))))},H=>(console.log(H),B.dispatch({type:`${h.fu}/fetchLocal/rejected`}),B.dispatch({type:`${h.fu}/fetchRemote/rejected`}),B.rejectWithValue("Unknown error."))),null}catch{return B.rejectWithValue("Unknown error.")}}),v=(0,t.zD)(`${h.fu}/fetchAllLocal`,async(j,B)=>{try{return(await(0,p.Gd)()).map(I=>(0,y.kH)(I))}catch{return B.rejectWithValue("Unknown error.")}}),P=(0,t.zD)(`${h.fu}/fetchRemotePlugins`,async(j,B)=>{try{return await(0,p.T_)()}catch(N){return(0,d.NF)(N)&&(N.isHandled=!0),B.rejectWithValue([])}}),m=(0,t.zD)(`${h.fu}/fetchDetails`,async(j,B)=>{try{const N=await(0,p.CB)(j);return{id:j,changes:{details:N}}}catch{return B.rejectWithValue("Unknown error.")}}),D=(0,t.VP)(`${h.fu}/addPlugins`),x=(0,t.VP)(`${h.fu}/addLocalPlugins`),E=(0,t.VP)(`${h.fu}/addLocalPlugins`),C=(0,t.VP)(`${h.fu}/addLocalPlugins`),b=(0,t.zD)(`${h.fu}/install`,async({id:j,version:B,isUpdating:N=!1},I)=>{const K=N?{isInstalled:!0,installedVersion:B,hasUpdate:!1}:{isInstalled:!0,installedVersion:B};try{return await(0,p.xZ)(j),await(0,y.tr)(),N&&(0,c.sk)(j),{id:j,changes:K}}catch(w){return console.error(w),(0,d.NF)(w)?(w.data.id=j,I.rejectWithValue(w.data)):I.rejectWithValue("Unknown error.")}}),T=(0,t.zD)(`${h.fu}/install`,async()=>({})),A=(0,t.zD)(`${h.fu}/uninstall`,async(j,B)=>{try{return await(0,p.cu)(j),await(0,y.tr)(),(0,c.sk)(j),{id:j,changes:{isInstalled:!1,installedVersion:void 0,isFullyInstalled:!1}}}catch(N){return console.error(N),B.rejectWithValue("Unknown error.")}}),R=(0,t.zD)(`${h.fu}/loadPluginDashboards`,async(j,B)=>{const K=`api/plugins/${B.getState().dataSources.dataSource.type}/dashboards`;return(0,d.AI)().get(K)}),S=(0,t.VP)(`${h.fu}/panelPluginLoaded`),O=j=>async(B,N)=>{let I=N().plugins.panels[j];return I||(I=await(0,u.TV)(j),N().plugins.panels[j]||B(S(I))),I}},31326:(_,L,e)=>{"use strict";e.d(L,{AI:()=>a,Ff:()=>c});var t=e(65307),n=e(6745),r=e(66253),s=e(20701);const a=(0,t.pU)(),g=p=>new RegExp(`${n.fu}/(.*)/pending`).test(p.type),i=p=>new RegExp(`${n.fu}/(.*)/fulfilled`).test(p.type),l=p=>new RegExp(`${n.fu}/(.*)/rejected`).test(p.type),d=p=>{const h=p.lastIndexOf("/");return p.substring(0,h)},o={items:a.getInitialState(),requests:{},plugins:[],errors:[],searchQuery:"",hasFetched:!1,dashboards:[],isLoadingPluginDashboards:!1,panels:{}},c=(0,t.Z0)({name:"plugins",initialState:o,reducers:{},extraReducers:p=>p.addCase(s.aU,(h,y)=>{a.upsertMany(h.items,y.payload)}).addCase(s.LR.fulfilled,(h,y)=>{a.upsertMany(h.items,y.payload)}).addCase(s.t5.fulfilled,(h,y)=>{a.updateOne(h.items,y.payload)}).addCase(s.ai.fulfilled,(h,y)=>{a.updateOne(h.items,y.payload)}).addCase(s.JC.fulfilled,(h,y)=>{a.updateOne(h.items,y.payload)}).addCase(s.NJ,(h,y)=>{h.panels[y.payload.meta.id]=y.payload}).addCase(s.h9.pending,(h,y)=>{h.isLoadingPluginDashboards=!0,h.dashboards=[]}).addCase(s.h9.fulfilled,(h,y)=>{h.isLoadingPluginDashboards=!1,h.dashboards=y.payload}).addMatcher(g,(h,y)=>{h.requests[d(y.type)]={status:r.IZ.Pending}}).addMatcher(i,(h,y)=>{h.requests[d(y.type)]={status:r.IZ.Fulfilled}}).addMatcher(l,(h,y)=>{h.requests[d(y.type)]={status:r.IZ.Rejected,error:y.payload}})}).reducer},66253:(_,L,e)=>{"use strict";e.d(L,{IZ:()=>i,Ip:()=>n,LZ:()=>g,Uy:()=>r,og:()=>a,u8:()=>s,vk:()=>t});var t=(l=>(l.Home="plugins-home",l.Browse="plugins-browse",l.Details="plugins-details",l))(t||{}),n=(l=>(l.app="apps",l.datasource="database",l.panel="credit-card",l.renderer="capture",l.secretsmanager="key-skeleton-alt",l))(n||{}),r=(l=>(l.Deleted="deleted",l.Active="active",l.Pending="pending",l.Deprecated="deprecated",l.Enterprise="enterprise",l))(r||{}),s=(l=>(l.INSTALL="INSTALL",l.UNINSTALL="UNINSTALL",l.UPDATE="UPDATE",l.REINSTALL="REINSTALL",l))(s||{}),a=(l=>(l.OVERVIEW="Overview",l.VERSIONS="Version history",l.CONFIG="Config",l.DASHBOARDS="Dashboards",l.USAGE="Usage",l.IAM="IAM",l.CHANGELOG="Changelog",l))(a||{}),g=(l=>(l.OVERVIEW="overview",l.VERSIONS="version-history",l.CONFIG="config",l.DASHBOARDS="dashboards",l.USAGE="usage",l.IAM="iam",l.CHANGELOG="changelog",l))(g||{}),i=(l=>(l.Pending="Pending",l.Fulfilled="Fulfilled",l.Rejected="Rejected",l))(i||{})},66827:(_,L,e)=>{"use strict";e.d(L,{j:()=>d});var t=e(74848),n=e(14110),r=e(42418),s=e(55852),a=e(61680);const g="grafana.angularDeprecation.dashboardNoticeAndMigration.isDismissed";function i(o){return g+"."+o}function l(){const o="__feature.autoMigrateOldPanels",u=new URL(window.location.toString());u.searchParams.has(o)||u.searchParams.append(o,"true"),window.open(u.toString(),"_self")}function d({dashboardUid:o,showAutoMigrateLink:u}){return(0,t.jsx)(a.b,{storageKey:i(o),defaultValue:!1,children:(c,p)=>c?null:(0,t.jsx)("div",{children:(0,t.jsx)(r.F,{severity:"warning",title:"This dashboard depends on Angular, which is deprecated and will stop working in future releases of Grafana.",onRemove:()=>{(0,n.rR)("angular_deprecation_notice_dismissed"),p(!0)},children:(0,t.jsxs)("div",{className:"markdown-html",children:[(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",children:"Read our deprecation notice and migration advice."}),(0,t.jsx)("br",{}),u&&(0,t.jsx)(s.$n,{fill:"outline",size:"sm",onClick:l,style:{marginTop:10},children:"Try migration"})]})})})})}},74106:(_,L,e)=>{"use strict";e.d(L,{c:()=>i});var t=e(74848),n=e(96540),r=e(43429),s=e(14110),a=e(42418);function g(l,d){let o;switch(l){case r.QE.app:o="app plugin";break;case r.QE.panel:o="panel plugin";break;case r.QE.datasource:o="data source plugin";break;default:o="plugin"}let u=`This ${o} uses a deprecated, legacy platform based on AngularJS and `;return d===void 0?u+" may be incompatible depending on your Grafana configuration.":d?u+" will stop working in future releases of Grafana.":u+" is incompatible with your current Grafana configuration."}function i(l){const{className:d,angularSupportEnabled:o,pluginId:u,pluginType:c,showPluginDetailsLink:p,interactionElementId:h,children:y}=l,[f,v]=(0,n.useState)(!1),P={};return u&&(P.pluginId=u),h&&(P.elementId=h),f?null:(0,t.jsxs)(a.F,{severity:"warning",title:"Angular plugin",className:d,onRemove:()=>v(!0),children:[(0,t.jsx)("p",{children:g(c,o)}),(0,t.jsx)("div",{className:"markdown-html",children:(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:"https://grafana.com/docs/grafana/latest/developers/angular_deprecation/",className:"external-link",target:"_blank",rel:"noreferrer",onClick:()=>{(0,s.rR)("angular_deprecation_docs_clicked",P)},children:"Read our deprecation notice and migration advice."})}),p&&u?(0,t.jsx)("li",{children:(0,t.jsx)("a",{href:`plugins/${encodeURIComponent(u)}`,className:"external-link",target:"_blank",rel:"noreferrer",children:"View plugin details"})}):null]})}),y&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("hr",{}),y]})]})}},8480:(_,L,e)=>{"use strict";e.d(L,{Hv:()=>s,mz:()=>a});var t=e(32264);function n(g){return Object.values(t.$.datasources).find(i=>i.uid===g)??null}function r(g){return n(g)?.meta.angular?.detected??!1}function s(g){const i=n(g);return(i?.meta.angular?.detected&&!i?.meta.angular.hideDeprecation)??!1}const a=new Set(["autoMigrateOldPanels","autoMigrateGraphPanel","autoMigrateTablePanel","autoMigratePiechartPanel","autoMigrateWorldmapPanel","autoMigrateStatPanel","disableAngular"])},10803:(_,L,e)=>{"use strict";e.d(L,{p:()=>s});var t=e(74848),n=e(43429),r=e(39938);const s=g=>{const i=a(g.state);return i?(0,t.jsx)(r.E,{className:g.className,color:i.color,title:i.tooltip,text:i.text,icon:i.icon}):null};function a(g){switch(g){case n.pn.deprecated:return{text:"Deprecated",color:"red",tooltip:"This feature is deprecated and will be removed in a future release"};case n.pn.alpha:return{text:"Alpha",color:"blue",tooltip:"This feature is experimental and future updates might not be backward compatible"};case n.pn.beta:return{text:"Beta",color:"blue",tooltip:"This feature is close to complete but not fully tested"};default:return null}}},31193:(_,L,e)=>{"use strict";e.d(L,{tR:()=>v,xq:()=>h});var t=e(40187),n=e(26272),r=e(80147),s=e(72574),a=e(81634),g=e(17172),i=e(19347),l=e(26657),d=e(28138),o=e(2913),u=e(53478),c=e(66718),p=e(1682);class h{constructor(m=(0,s.w)()){this.templateSrv=m,this.datasources={},this.settingsMapByName={},this.settingsMapByUid={},this.settingsMapById={},this.defaultName=""}init(m,D){this.datasources={},this.settingsMapByUid={},this.settingsMapByName=m,this.defaultName=D;for(const x of Object.values(m))x.uid||(x.uid=x.name),this.settingsMapByUid[x.uid]=x,this.settingsMapById[x.id]=x;this.datasources[l.dR.type]=u.Ex,this.datasources[c.Uj]=u.Ex,this.settingsMapByUid[l.dR.uid]=u.$i,this.settingsMapByUid[c.Uj]=u.$i}getDataSourceSettingsByUid(m){return this.settingsMapByUid[m]}getInstanceSettings(m,D){let x=y(m);if((0,l.s9)(x))return u.$i;if(x==="default"||x==null)return this.settingsMapByUid[this.defaultName]??this.settingsMapByName[this.defaultName];if(x[0]==="$"){const E=this.templateSrv.replace(x,D,f);let C;return E==="default"?C=this.settingsMapByName[this.defaultName]:C=this.settingsMapByUid[E]??this.settingsMapByName[E],C?{...C,isDefault:!1,name:x,uid:x,rawRef:{type:C.type,uid:C.uid}}:void 0}return this.settingsMapByUid[x]??this.settingsMapByName[x]??this.settingsMapById[x]}get(m,D){let x=y(m);if(!x)return this.get(this.defaultName);if((0,l.s9)(m))return Promise.resolve(this.datasources[c.Uj]);const E=this.settingsMapByName[x];return E&&(x=E.uid),this.datasources[x]?Promise.resolve(this.datasources[x]):(x=this.templateSrv.replace(x,D,f),x==="default"&&this.defaultName!=="default"?this.get(this.defaultName):this.datasources[x]?Promise.resolve(this.datasources[x]):this.loadDatasource(x))}async loadDatasource(m){if(this.datasources[m])return Promise.resolve(this.datasources[m]);const D=this.getInstanceSettings(m);if(!D)return Promise.reject({message:`Datasource ${m} was not found`});try{const x=await(0,p.cS)(D.meta);if(this.datasources[m])return this.datasources[m];const E=x.DataSourceClass.length!==1;let C;if(E?C=(0,a.C)().instantiate(x.DataSourceClass,{instanceSettings:D}):C=new x.DataSourceClass(D),C.components=x.components,!(C instanceof t.mA)){const b=C;b.name=D.name,b.id=D.id,b.type=D.type,b.meta=D.meta,b.uid=D.uid,b.getRef=t.mA.prototype.getRef}return this.datasources[m]=C,this.datasources[C.uid]=C,C}catch(x){return x instanceof Error&&d.A.emit(n.r1.alertError,[D.name+" plugin failed",x.toString()]),Promise.reject({message:`Datasource: ${m} was not found`})}}getAll(){return Object.values(this.settingsMapByName)}getList(m={}){const D=Object.values(this.settingsMapByName).filter(E=>!(E.meta.id==="grafana"||E.meta.id==="mixed"||E.meta.id==="dashboard"||m.metrics&&!E.meta.metrics||m.tracing&&!E.meta.tracing||m.logs&&E.meta.category!=="logging"&&!E.meta.logs||m.annotations&&!E.meta.annotations||m.alerting&&!E.meta.alerting||m.pluginId&&!(0,r._)(m.pluginId,E.meta)||m.filter&&!m.filter(E)||m.type&&(Array.isArray(m.type)?!m.type.includes(E.type):m.type!==E.type)||!m.all&&E.meta.metrics!==!0&&E.meta.annotations!==!0&&E.meta.tracing!==!0&&E.meta.logs!==!0&&E.meta.alerting!==!0));if(m.variables)for(const E of this.templateSrv.getVariables()){if(E.type!=="datasource")continue;let C=E.current.value==="default"?this.defaultName:E.current.value;Array.isArray(C)&&(C=C[0]);const b=!Array.isArray(C)&&(this.settingsMapByName[C]||this.settingsMapByUid[C]);if(b){const T=`\${${E.name}}`;D.push({...b,isDefault:!1,name:T,uid:T})}}const x=D.sort((E,C)=>E.name.toLowerCase()>C.name.toLowerCase()?1:E.name.toLowerCase()<C.name.toLowerCase()?-1:0);if(!m.pluginId&&!m.alerting){if(m.mixed){const E=this.getInstanceSettings("-- Mixed --");E&&D.push(E)}if(m.dashboard){const E=this.getInstanceSettings("-- Dashboard --");E&&D.push(E)}if(!m.tracing){const E=this.getInstanceSettings("-- Grafana --");E&&m.filter?.(E)!==!1&&D.push(E)}}return x}getExternal(){return this.getList()}getAnnotationSources(){return this.getList({annotations:!0,variables:!0}).map(m=>({name:m.name,value:m.name,meta:m.meta}))}getMetricSources(m){return this.getList({metrics:!0,variables:!m?.skipVariables}).map(D=>({name:D.name,value:D.name,meta:D.meta}))}async reload(){const m=await(0,g.AI)().get("/api/frontend/settings");o.Ay.datasources=m.datasources,o.Ay.defaultDatasource=m.defaultDatasource,this.init(m.datasources,m.defaultDatasource)}}function y(P){return(0,l.s9)(P)?l.dR.uid:typeof P=="string"?P:P?.uid}function f(P){return Array.isArray(P)?P[0]:P}const v=()=>(0,i.l)()},75462:(_,L,e)=>{"use strict";e.d(L,{$Y:()=>A,FF:()=>v,N9:()=>N,OO:()=>Q,PW:()=>G,V2:()=>z,YS:()=>w,dt:()=>Y,dx:()=>K,hS:()=>I,nl:()=>q,nv:()=>x,ol:()=>C,pL:()=>B,xJ:()=>O,xM:()=>M,yt:()=>b});var t=e(74848),n=e(32196),r=e(2543),s=e.n(r),a=e(16817),g=e(13834),i=e(47232),l=e(76885),d=e(14110),o=e(32264),u=e(37390),c=e(28138),p=e(11848),h=e(27716),y=e(28444),f=e(87092);function v(te){console.warn(`[Plugin Extensions] ${te}`)}function P(te){return typeof te=="object"&&"type"in te&&te.type===PluginExtensionTypes.link}function m(te,X=""){return(...ee)=>{try{return te(...ee)}catch(ne){ne instanceof Error&&console.warn(`${X}${ne.message}`)}}}function D(te){return async X=>{const{title:ee,body:ne,width:Z,height:ae}=X;c.A.publish(new y.S8({component:x(te,E({title:ee,body:ne,width:Z,height:ae}))}))}}const x=(te,X)=>ne=>{const{error:Z,loading:ae,value:re}=(0,a.A)(()=>(0,h.x)(te,{showErrorAlert:!1}));return ae?null:Z?(v(`Could not fetch plugin meta information for "${te}", aborting. (${Z.message})`),null):re?(0,t.jsx)(g.a,{meta:re,children:(0,t.jsx)(X,{...ne})}):(v(`Fetched plugin meta information is empty for "${te}", aborting.`),null)},E=({title:te,body:X,width:ee,height:ne})=>{const Z=(0,n.css)({width:ee,height:ne});return({onDismiss:re})=>(0,t.jsx)(u.a,{title:te,className:Z,isOpen:!0,onDismiss:re,onClickBackdrop:re,children:(0,t.jsx)(X,{onDismiss:re})})};function C(te,X=new Map){if(!te||typeof te!="object"||Object.isFrozen(te))return te;const ee=Array.isArray(te)?[...te]:{...te};if(X.has(te))return X.get(te);X.set(te,ee);const ne=Reflect.ownKeys(ee);for(const Z of ne){const ae=Array.isArray(ee)?ee[Number(Z)]:ee[Z];ae&&(typeof ae=="object"||typeof ae=="function")&&(Array.isArray(ee)?ee[Number(Z)]=C(ae,X):ee[Z]=C(ae,X))}return Object.freeze(ee)}function b(te,X,ee){const ne=`${te}${X}${ee}`;return Array.from(ne).reduce((Z,ae)=>Math.imul(31,Z)+ae.charCodeAt(0)|0,0).toString()}const T=Symbol("isReadOnlyProxy");function A(te){if(!te||typeof te!="object"||S(te))return te;const X=new WeakMap;return new Proxy(te,{defineProperty:()=>!1,deleteProperty:()=>!1,isExtensible:()=>!1,set:()=>!1,get(ee,ne,Z){if(ne===T)return!0;const ae=Reflect.get(ee,ne,Z);return(0,i.Ar)(ae)?(0,i.KQ)(ae):(0,r.isObject)(ae)||(0,r.isArray)(ae)?(X.has(ae)||X.set(ae,A(ae)),X.get(ae)):ae}})}function R(te){return typeof te=="object"&&te!==null}function S(te){return R(te)&&te[T]===!0}function O(te){const X={...te};return X}function j(te){}function B(te,X){return te.length<X?te:`${te.slice(0,X-3).trimEnd()}...`}function N(te){const X={},ee=[];for(const Z of te){const ae=Z.category;if(!ae){ee.push({text:B(Z.title,25),href:Z.path,onClick:Z.onClick});continue}Array.isArray(X[ae])||(X[ae]=[]),X[ae].push({text:B(Z.title,25),href:Z.path,onClick:Z.onClick})}const ne=Object.keys(X).reduce((Z,ae)=>(Z.push({text:B(ae,25),type:"group",subMenu:X[ae]}),Z),[]);return ee.length>0&&(ne.length>0&&ne.push({text:"divider",type:"divider"}),Array.prototype.push.apply(ne,ee)),ne}function I(te,X,ee){try{const ne=X.configure?.(ee,{isAppOpened:()=>H(te)});if(ne===void 0)return;let{title:Z=X.title,description:ae=X.description,path:re=X.path,icon:se=X.icon,category:de=X.category,...le}=ne;return(0,f.lq)(ne,`The configure() function for "${X.title}" returned a promise, skipping updates.`),re&&(0,f.wy)(te,re),(0,f.aY)({title:Z,description:ae},["title","description"]),Object.keys(le).length>0&&v(`Extension "${X.title}", is trying to override restricted properties: ${Object.keys(le).join(", ")} which will be ignored.`),{title:Z,description:ae,path:re,icon:se,category:de}}catch(ne){ne instanceof Error&&v(ne.message);return}}function K(te,X,ee,ne){const{onClick:Z}=ee;if(Z)return function(re){try{(0,d.rR)("ui_extension_link_clicked",{pluginId:te,extensionPointId:X,title:ee.title,category:ee.category});const se={context:ne,openModal:D(te),isAppOpened:()=>H(te),openAppInSideview:()=>U(te),closeAppInSideview:()=>W(te)},de=Z(re,se);(0,f.yL)(de)&&de.catch(le=>{le instanceof Error&&v(le.message)})}catch(se){se instanceof Error&&v(se.message)}}}function w(te,X,ee){return l.kM.appendQueryToUrl(X,l.kM.toUrlParams({uel_pid:te,uel_epid:ee}))}const U=te=>p.L.openApp(te),W=te=>p.L.closeApp(te),H=te=>p.L.isAppOpened(te),z=()=>o.$.buildInfo.env==="development",G=(te,X)=>{const ee=X.meta?.id,ne=X.meta?.extensions?.extensionPoints;return!ne||!ne.some(Z=>Z.id===te)?(v(`Extension point "${te}" - it's not recorded in the "plugin.json" for "${ee}". Please add it under "extensions.extensionPoints[]".`),!0):!1},M=(te,X)=>{const ee=X.meta?.id,ne=X.meta?.dependencies?.extensions?.exposedComponents;return!ne||!ne.includes(te)?(v(`Using exposed component "${te}" - it's not recorded in the "plugin.json" for "${ee}". Please add it under "dependencies.extensions.exposedComponents[]".`),!0):!1},Q=(te,X)=>{const ee=o.$.apps[te],ne=`Added-link "${X.title}" from "${te}" -`,Z=ee?ee.extensions.addedLinks.find(({title:re})=>re===X.title):null;return ee?Z?(Array.isArray(X.targets)?X.targets:[X.targets]).every(re=>Z.targets.includes(re))?Z.description!==X.description?(v(`${ne} the "description" doesn't match with one in the plugin.json under "extensions.addedLinks[]".`),!0):!1:(v(`${ne} the "targets" don't match with ones in the plugin.json under "extensions.addedLinks[]".`),!0):(v(`${ne} not registered in the plugin.json under "extensions.addedLinks[]".`),!0):(v(`${ne} couldn't find app plugin "${te}"`),!0)},Y=(te,X)=>{const ee=o.$.apps[te],ne=`Added component "${X.title}" -`,Z=ee?ee.extensions.addedComponents.find(({title:re})=>re===X.title):null;return ee?Z?(Array.isArray(X.targets)?X.targets:[X.targets]).every(re=>Z.targets.includes(re))?Z.description!==X.description?(v(`${ne} the "description" doesn't match with one in the plugin.json under "extensions.addedComponents[]".`),!0):!1:(v(`${ne} the "targets" don't match with ones in the plugin.json under "extensions.addedComponents[]".`),!0):(v(`${ne} not registered in the plugin.json under "extensions.addedComponents[]".`),!0):(v(`${ne} couldn't find app plugin "${te}"`),!0)},q=(te,X)=>{const ee=o.$.apps[te],ne=`Exposed component "${X.id}" -`,Z=ee?ee.extensions.exposedComponents.find(({id:ae})=>ae===X.id):null;return ee?Z?Z.title!==X.title?(v(`${ne} the "title" doesn't match with one in the plugin.json under "extensions.exposedComponents[]".`),!0):Z.description!==X.description?(v(`${ne} the "description" doesn't match with one in the plugin.json under "extensions.exposedComponents[]".`),!0):!1:(v(`${ne} not registered in the plugin.json under "extensions.exposedComponents[]".`),!0):(v(`${ne} couldn't find app plugin: "${te}"`),!0)}},87092:(_,L,e)=>{"use strict";e.d(L,{Fe:()=>d,Fk:()=>u,aY:()=>g,jk:()=>c,kl:()=>l,lq:()=>i,lr:()=>y,w_:()=>o,wy:()=>r,yL:()=>h});var t=e(74135);function n(f,v="extension is not a link extension"){if(!isPluginExtensionLink(f))throw new Error(v)}function r(f,v){if(!l(f,v))throw new Error(`Invalid link extension. The "path" is required and should start with "/a/${f}/" (currently: "${v}"). Skipping the extension.`)}function s(f){if(!y(f))throw new Error('Invalid component extension, the "component" property needs to be a valid React component.')}function a(f){if(!c(f.configure))throw new Error(`Invalid extension "${f.title}". The "configure" property must be a function. Skipping the extension.`)}function g(f,v){for(const P of v)if(!p(f[P]))throw new Error(`Invalid extension "${f.title}". Property "${P}" must be a string and cannot be empty. Skipping the extension.`)}function i(f,v="The provided value is a Promise."){if(h(f))throw new Error(v)}function l(f,v){return!!(typeof v=="string"&&v.length>0&&v.startsWith(`/a/${f}/`))}function d({extensionPointId:f,pluginId:v}){return f.startsWith("grafana/")?!0:!!(f.startsWith(`plugins/${v}/`)||f.startsWith(`${v}/`))}function o(f){return f.match(/.*\/v\d+$/)}function u(f){return Object.values(t.S).map(v=>v.toString()).includes(f)}function c(f){return f?typeof f=="function":!0}function p(f){return typeof f=="string"&&f.length>0}function h(f){return f instanceof Promise||typeof f=="object"&&f!==null&&"then"in f&&"catch"in f}function y(f){const v=m=>typeof m=="object"&&m!==null&&"$$typeof"in m;return typeof f=="function"||(m=>v(m)&&m.$$typeof===Symbol.for("react.memo"))(f)}},15162:(_,L,e)=>{"use strict";e.d(L,{Kk:()=>u,PY:()=>c,TV:()=>l,d4:()=>o,f7:()=>y,oZ:()=>d});var t=e(43429),n=e(65158),r=e(2913),s=e(41394),a=e(1682);const g={},i={};function l(f){const v=g[f];if(v)return v;const P=o(f);if(!P)throw new Error(`Plugin ${f} not found`);return g[f]=p(P),f!==P.type&&(g[P.type]=g[f]),g[f]}function d(f){return!!o(f)}function o(f){const v=r.Ay.panels[f];if(!v){for(const P of Object.values(r.Ay.panels))if(P.aliasIDs?.includes(f))return P}return v}function u(f){return p(f)}function c(f){return i[f]}function p(f){const v=f.loadingStrategy??t.xf.fetch;return(0,a.j4)({path:f.module,version:f.info?.version,isAngular:f.angular?.detected,loadingStrategy:v,pluginId:f.id,moduleHash:f.moduleHash}).then(P=>{if(P.plugin)return P.plugin;if(P.PanelCtrl){const m=new n.m(null);return m.angularPanelCtrl=P.PanelCtrl,m}throw new Error("missing export: plugin or PanelCtrl")}).then(P=>(P.meta=f,i[f.id]=P,!P.panel&&P.angularPanelCtrl&&(P.panel=h(P)),P)).catch(P=>(console.warn("Error loading panel plugin: "+f.id,P),(0,s.W)(f,P)))}let h=f=>null;function y(f){h=f}},81900:(_,L,e)=>{"use strict";e.d(L,{GD:()=>s,QO:()=>i,ni:()=>g,sk:()=>a});var t=e(27716),n=e(45179);const r={};function s({path:o,version:u,loadingStrategy:c}){const p=l(o);p&&!r[p]&&(r[p]={version:encodeURI(u),loadingStrategy:c})}function a(o){const u=o;r[u]&&delete r[u],(0,t.o)(o)}function g(o,u=n.x8){const c=d(o);if(!c)return`${o}?_cache=${u}`;const h=r[c]?.version||u;return`${o}?_cache=${h}`}function i(o){const u=d(o);if(u)return r[u]}function l(o){const u=/\/?public\/plugins\/([^\/]+)\//,c=o.match(u);return c?c[1]:null}function d(o){const u=Object.keys(r).find(c=>o.includes(c));if(u)return u}},45179:(_,L,e)=>{"use strict";e.d(L,{$b:()=>n,Bu:()=>r,XV:()=>t,x8:()=>s});const t="package",n=/^plugins.+\.css$/i,r=/^(text|application)\/(x-)?javascript(;|$)/,s=Date.now()},63770:(_,L,e)=>{"use strict";e.d(L,{z:()=>d});var t=e(59511),n=e.n(t),r=e(65024),s=e.n(r),a=e(82093),g=e.n(a),i=e(57516),l=e.n(i);const d=window.System},87815:(_,L,e)=>{"use strict";e.d(L,{Av:()=>l,OD:()=>i,kB:()=>a});var t=e(32264),n=e(66161),r=e(45179),s=e(63770);function a(d){return Object.keys(d).reduce((o,u)=>{const c=`${r.XV}:${u}`;return g(c,d[u]),n.s.set(u,d[u]),o[u]=c,o},{})}function g(d,o){if(s.z.has(d))return;let u;try{u=s.z.resolve(d)}catch(p){console.log(p)}if(u&&s.z.has(u))return;const c=u||d;typeof o=="function"?s.z.register(d,[],p=>({execute:async function(){const h=await o();p(h)}})):s.z.set(c,o)}function i(d){return!!t.$.pluginsCDNBaseURL&&d.startsWith(t.$.pluginsCDNBaseURL)}function l(d){return d.startsWith("http")||d.startsWith("/")?d:`${t.$.appSubUrl??""}/${d}`}},27716:(_,L,e)=>{"use strict";e.d(L,{o:()=>s,x:()=>r});var t=e(17172);const n={};function r(a,g){const i=n[a];return i?Promise.resolve(i):(0,t.AI)().get(`/api/plugins/${a}/settings`,void 0,void 0,g).then(l=>(n[a]=l,l)).catch(l=>typeof l=="object"&&l!==null&&"status"in l&&l.status===403?(l.isHandled=!0,Promise.reject(l)):Promise.reject(new Error("Unknown Plugin")))}const s=a=>a?delete n[a]:Object.keys(n).forEach(g=>delete n[g])},1682:(_,L,e)=>{"use strict";e.d(L,{ui:()=>wa,cS:()=>Ka,j4:()=>Fa});var t=e(43429),n=e(40187),r=e(41987),s=e(32264);const Z={"core:plugin/graphite":async()=>await e.e(6134).then(e.bind(e,8652)),"core:plugin/cloudwatch":async()=>await Promise.all([e.e(3346),e.e(6119),e.e(3766)]).then(e.bind(e,36119)),"core:plugin/dashboard":async()=>await e.e(2058).then(e.bind(e,92058)),"core:plugin/elasticsearch":async()=>await Promise.all([e.e(3346),e.e(6144),e.e(8747),e.e(1717)]).then(e.bind(e,18747)),"core:plugin/opentsdb":async()=>await e.e(747).then(e.bind(e,24989)),"core:plugin/grafana":async()=>await e.e(3648).then(e.bind(e,62391)),"core:plugin/influxdb":async()=>await Promise.all([e.e(7445),e.e(9404)]).then(e.bind(e,20322)),"core:plugin/loki":async()=>await Promise.all([e.e(6144),e.e(7049),e.e(1477)]).then(e.bind(e,27049)),"core:plugin/mixed":async()=>await e.e(2513).then(e.bind(e,12870)),"core:plugin/prometheus":async()=>await Promise.all([e.e(3346),e.e(6144),e.e(8314),e.e(9546)]).then(e.bind(e,88314)),"core:plugin/alertmanager":async()=>await Promise.all([e.e(3346),e.e(4737)]).then(e.bind(e,27013)),"core:plugin/text":async()=>await e.e(404).then(e.bind(e,31984)),"core:plugin/timeseries":async()=>await Promise.all([e.e(4007),e.e(3397),e.e(94),e.e(6965),e.e(563)]).then(e.bind(e,32307)),"core:plugin/trend":async()=>await Promise.all([e.e(94),e.e(2666)]).then(e.bind(e,32475)),"core:plugin/state-timeline":async()=>await Promise.all([e.e(8895),e.e(3397),e.e(4606),e.e(6199)]).then(e.bind(e,17665)),"core:plugin/status-history":async()=>await Promise.all([e.e(8895),e.e(3397),e.e(4606),e.e(8259)]).then(e.bind(e,98337)),"core:plugin/candlestick":async()=>await Promise.all([e.e(4007),e.e(3397),e.e(94),e.e(6965),e.e(3090)]).then(e.bind(e,4782)),"core:plugin/graph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(9362),e.e(8068)]).then(e.bind(e,229)),"core:plugin/xychart":async()=>s.$.featureToggles.autoMigrateXYChartPanel?await Promise.all([e.e(9739),e.e(8891),e.e(3772)]).then(e.bind(e,80983)):await Promise.all([e.e(707),e.e(9739),e.e(5594)]).then(e.bind(e,31552)),"core:plugin/geomap":async()=>await Promise.all([e.e(4007),e.e(8895),e.e(1698),e.e(707),e.e(9654),e.e(190)]).then(e.bind(e,7734)),"core:plugin/canvas":async()=>await Promise.all([e.e(707),e.e(7523)]).then(e.bind(e,30507)),"core:plugin/dashlist":async()=>await e.e(8995).then(e.bind(e,72739)),"core:plugin/alertlist":async()=>await e.e(3375).then(e.bind(e,73235)),"core:plugin/annolist":async()=>await e.e(4979).then(e.bind(e,3658)),"core:plugin/heatmap":async()=>await Promise.all([e.e(4007),e.e(407),e.e(5995),e.e(3397),e.e(8891),e.e(5857)]).then(e.bind(e,26235)),"core:plugin/table":async()=>await e.e(3525).then(e.bind(e,55312)),"core:plugin/table-old":async()=>await e.e(8777).then(e.bind(e,78491)),"core:plugin/news":async()=>await e.e(4940).then(e.bind(e,18918)),"core:plugin/live":async()=>await e.e(5413).then(e.bind(e,45850)),"core:plugin/stat":async()=>await Promise.resolve().then(e.bind(e,36373)),"core:plugin/datagrid":async()=>await Promise.all([e.e(7445),e.e(7229),e.e(5939)]).then(e.bind(e,97229)),"core:plugin/debug":async()=>await Promise.all([e.e(4007),e.e(2770)]).then(e.bind(e,73756)),"core:plugin/flamegraph":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(5686)]).then(e.bind(e,41513)),"core:plugin/gettingstarted":async()=>await e.e(9142).then(e.bind(e,96485)),"core:plugin/gauge":async()=>await Promise.resolve().then(e.bind(e,14738)),"core:plugin/piechart":async()=>await e.e(6105).then(e.bind(e,82169)),"core:plugin/bargauge":async()=>await e.e(3851).then(e.bind(e,72738)),"core:plugin/barchart":async()=>await Promise.all([e.e(8895),e.e(3124)]).then(e.bind(e,82590)),"core:plugin/logs":async()=>await Promise.all([e.e(1166),e.e(7884)]).then(e.bind(e,66642)),"core:plugin/traces":async()=>await Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(500),e.e(4301)]).then(e.bind(e,82892)),"core:plugin/welcome":async()=>await e.e(8463).then(e.bind(e,55005)),"core:plugin/nodeGraph":async()=>await Promise.all([e.e(1698),e.e(5511),e.e(7317)]).then(e.bind(e,68403)),"core:plugin/histogram":async()=>await e.e(323).then(e.bind(e,20634))};var ae=e(81900),re=e(63770),se=e(34796),de=e.n(se),le=e(54087),he=e(80851),ie=e(32176),J=e(31221),ce=e(91520),pe=e(92275),Pe=e(82013),Ie=e(2341),ge=e(19538),Se=e(65158),De=e(33459),Ke=e(85858),Me=e(7117),be=e(8984),we=e(91950),Be=e(2913),He=e(10096),Ve=e(27677),Je=e(62301),nt=e(31140),pt=e(78827),bt=e(68576),Tt=e(92247);const ye=be;ye.PanelPlugin=Se.m,ye.DataSourcePlugin=n.tD,ye.AppPlugin=r.hX,ye.DataSourceApi=n.mA;const je=["jquery.flot.crosshair","jquery.flot.events","jquery.flot.fillbelow","jquery.flot.gauge","jquery.flot.pie","jquery.flot.selection","jquery.flot.stack","jquery.flot.stackpercent","jquery.flot.time","jquery.flot"].reduce((xt,wt)=>({...xt,[wt]:{fakeDep:1}}),{}),ue={"@emotion/css":()=>Promise.resolve().then(e.bind(e,32196)),"@emotion/react":()=>Promise.resolve().then(e.bind(e,52762)),"@grafana/data":De,"@grafana/runtime":Me,"@grafana/slate-react":()=>Promise.resolve().then(e.bind(e,29317)),"@grafana/ui":ye,"@kusto/monaco-kusto":()=>Promise.all([e.e(630),e.e(1460),e.e(6938)]).then(e.bind(e,20582)),"app/core/app_events":{default:He.lE,__useDefault:!0},"app/core/config":{default:Be.Ay,__useDefault:!0},"app/core/core":{appEvents:He.lE,contextSrv:He.TP},"app/core/services/backend_srv":{BackendSrv:Ve.Mf,getBackendSrv:Ve.AI},"app/core/table_model":{default:we.A,__useDefault:!0},"app/core/time_series":{default:nt.A,__useDefault:!0},"app/core/time_series2":{default:nt.A,__useDefault:!0},"app/core/utils/datemath":Ke,"app/core/utils/flatten":pt,"app/core/utils/kbn":{default:bt.A,__useDefault:!0},"app/core/utils/ticks":Tt,"app/features/dashboard/impression_store":{impressions:Je.A},d3:()=>Promise.all([e.e(407),e.e(5995)]).then(e.bind(e,55995)),emotion:()=>Promise.resolve().then(e.bind(e,32196)),i18next:()=>Promise.resolve().then(e.bind(e,72635)),jquery:{default:de(),__useDefault:!0},...je,lodash:()=>Promise.resolve().then(e.t.bind(e,2543,23)).then(xt=>({...xt,__useDefault:!0})),moment:()=>Promise.resolve().then(e.t.bind(e,95093,23)).then(xt=>({...xt,__useDefault:!0})),prismjs:()=>Promise.resolve().then(e.t.bind(e,28848,23)),react:()=>Promise.resolve().then(e.t.bind(e,96540,19)),"react-dom":()=>Promise.resolve().then(e.t.bind(e,40961,19)),"react-inlinesvg":()=>Promise.resolve().then(e.bind(e,8867)),"react-redux":()=>Promise.resolve().then(e.bind(e,71468)),"react-router-dom":()=>Promise.resolve().then(e.bind(e,54625)),"react-router":()=>Promise.resolve().then(e.bind(e,35557)),redux:()=>Promise.resolve().then(e.bind(e,14644)),rxjs:()=>Promise.all([e.e(7315),e.e(5091)]).then(e.bind(e,75091)),"rxjs/operators":()=>Promise.all([e.e(7315),e.e(2975)]).then(e.bind(e,32975)),slate:()=>Promise.resolve().then(e.bind(e,82611)),"slate-plain-serializer":()=>Promise.resolve().then(e.bind(e,52845)),"slate-react":()=>Promise.resolve().then(e.bind(e,29317))};function Ee({url:xt,source:wt,transformSourceMapURL:Zt=!1,transformAssets:cn=!0}){const dn=xt.split("/public/plugins/"),Tn=dn[0],Qn=dn[1].split("/")[0];let On=wt;return cn&&(On=On.replace(/(\/?)(public\/plugins)/g,`${Tn}/$2`),On=On.replace(/(["|'])(plugins\/.+?.css)(["|'])/g,`$1${Tn}/public/$2$3`)),Zt&&(On=On.replace(/(\/\/#\ssourceMappingURL=)(.+)\.map/g,`$1${Tn}/public/plugins/${Qn}/$2.map`)),On}var Ce=e(45179),Ne=e(87815);async function Fe(xt,wt,Zt){const cn=await xt(wt,Zt),dn=cn.headers.get("content-type")||"";if(Ce.Bu.test(dn)){let Qn=await cn.text();if((0,Ne.OD)(cn.url)){const On=Ee({url:cn.url,source:Qn});return new Response(new Blob([On],{type:"text/javascript"}))}return new Response(new Blob([Qn],{type:"text/javascript"}))}return cn}function Ue(xt,wt,Zt){try{const cn=xt.apply(this,[wt,Zt]),dn=Te(cn);return(dn.endsWith(".js")||dn.endsWith(".css"))&&!(0,Ne.OD)(dn)?(0,ae.ni)(dn):dn}catch{if(Ce.$b.test(wt)){const dn=Ge(wt),Tn=xt.apply(this,[dn,Zt]);return(0,ae.ni)(Tn)}return console.warn(`SystemJS: failed to resolve '${wt}'`),wt}}function fe(xt,wt){if(new URL(wt,window.location.origin).pathname.endsWith(".css")&&!xt){const dn=re.z.get(wt)?.default;dn&&(document.adoptedStyleSheets=[...document.adoptedStyleSheets,dn])}}function Te(xt){return xt.startsWith(`${Ce.XV}:`)?xt:(xt.endsWith("!")&&(xt=xt.slice(0,-1)),["css","js","json","wasm"].some(cn=>xt.endsWith(cn))?xt:xt+".js")}function Ge(xt){const wt=xt.split("/")[1];let Zt="";for(const[Tn]of re.z.entries())if(Tn.includes(wt)){Zt=Tn;break}const cn=Zt.lastIndexOf("/plugins");return cn===-1?`${s.$.appSubUrl??""}/public/${xt}`:`${Zt.substring(0,cn)}/${xt}`}var Qe=e(22055),st=e(6262),Xe=e(35853);function ot(xt){const wt=new URL(window.location.href),Zt=new URL(xt);return wt.host===Zt.host}async function ft(xt,wt){let Zt="";if(ot(xt)?(Zt=await(await fetch(xt)).text(),Zt=Ee({url:xt,source:Zt,transformSourceMapURL:!0,transformAssets:!1})):(0,Ne.OD)(xt)&&(Zt=await(await fetch(xt)).text(),Zt=Ee({url:xt,source:Zt,transformSourceMapURL:!0,transformAssets:!0})),Zt.length===0)throw new Error("Only same domain scripts are allowed in sandboxed plugins");Zt=et(Zt),wt.evaluate(Zt)}async function _e(xt){if((0,Ne.OD)(xt.module)){const wt=xt.module;let cn=await(await fetch(wt)).text();return cn=Ee({url:wt,source:cn,transformSourceMapURL:!0,transformAssets:!0}),cn}else{let wt=(0,Ne.Av)(xt.module);const Zt=(0,ae.ni)(wt);let dn=await(await fetch(Zt)).text();return dn=Ee({url:Zt,source:dn,transformSourceMapURL:!0,transformAssets:!1}),dn=et(dn),dn}}function et(xt){return xt.replace(/window\.location/gi,"window.locationSandbox")}function it(xt){xt.evaluate(`${Xe.V.toString()};${Xe.V.name}()`)}function dt(xt){for(const wt of Object.values(s.$.datasources))if(wt.type===xt)return wt.meta;for(const wt of Object.values(s.$.panels))if(wt.id===xt)return wt;for(const wt of Object.values(s.$.apps))if(wt.id===xt)return{id:xt,type:t.QE.app,module:wt.path};throw new Error(`Could not find plugin ${xt}`)}var ze=e(2543);const xe=["iframe"];var Oe=e(7077),Le=e(28848),Ze=e.n(Le),qe=e(29505),rt=e(96540),vt=e(34867),Ot=e(27716);const jt=!!s.$.featureToggles.frontendSandboxMonitorOnly;function Ut(xt){return!!xt&&typeof xt=="object"&&xt?.hasOwnProperty("plugin")}function zt(xt){throw new Error(`Unexpected object: ${xt}. This should never happen.`)}const qt=(0,vt.DW)("sandbox",{monitorOnly:String(jt)});function fn(xt){return xt instanceof rt.Component}function Sn(xt,wt){qt.logWarning(xt,wt)}function An(xt,wt){qt.logError(xt,wt)}function Hn(xt,wt){qt.logInfo(xt,wt)}async function es({isAngular:xt,pluginId:wt}){if(!s.$.featureToggles.pluginsFrontendSandbox||xt||location.search.includes("nosandbox")&&s.$.buildInfo.env==="development"||s.$.disableFrontendSandboxForPlugins.includes(wt))return!1;const dn=await(0,Ot.x)(wt);return!(dn.type===t.QE.app&&dn.signatureType===t.kv.grafana)}function rs(xt){return xt?.constructor?.name==="RegExp"}function Zn(xt){return xt&&(rs(xt)&&(0,Oe.U)(xt)?new RegExp(xt):Array.isArray(xt)?xt.map(Zn):typeof xt=="object"?Object.keys(xt).reduce((wt,Zt)=>(Reflect.set(wt,Zt,Zn(Reflect.get(xt,Zt))),wt),{}):xt)}function kn(xt){return xt&&((0,Oe.U)(xt)?(0,ze.cloneDeep)(xt):Array.isArray(xt)?xt.map(kn):typeof xt=="object"?Object.keys(xt).reduce((wt,Zt)=>(Reflect.set(wt,Zt,kn(Reflect.get(xt,Zt))),wt),{}):xt)}const Gn=Symbol.for("@@SANDBOX_LIVE_VALUE"),Kn=!!s.$.featureToggles.frontendSandboxMonitorOnly;function yn(xt,wt){const Zt=Reflect.get(xt,"nodeName");if(Zt==="body"||xt===document.body)return document.body;if(Zt==="head"||xt===document.head||xt===document.documentElement)return xt;if(xe.includes(Zt)&&(Sn("<"+Zt+"> is not allowed in sandboxed plugins",{pluginId:wt,param:Zt}),!Kn))throw new Error("<"+Zt+"> is not allowed in sandboxed plugins");if(sn(xt,wt)||xt.parentNode===document.body||xt.closest("#reactRoot")===null||Kn)return xt;{const cn=document.createElement(Zt);return cn.dataset.grafanaPluginSandboxElement="true",cn}}function wn(xt){if(typeof xt=="object"&&xt instanceof Element)try{return xt.nodeName!==void 0}catch{return!1}return!1}function Jn(xt){const wt=Reflect.get(xt,"style");Object.hasOwn(wt,Gn)||Reflect.defineProperty(wt,Gn,{})}function bn(xt){xt&&(Array.isArray(xt)?(xt.forEach(bn),Pt(xt)):typeof xt=="object"&&(Object.values(xt).forEach(bn),Pt(xt)))}function Pt(xt){if(xt)return Object.hasOwn(xt,Gn)||Reflect.defineProperty(xt,Gn,{}),xt}function Ft(xt){xt&&(Object.hasOwn(xt,Gn)||((0,Oe.U)(xt)&&!(xt instanceof Function)&&(fn(xt)||xt instanceof n.mA||xt instanceof qe.f5)?Reflect.defineProperty(xt,Gn,{}):xt===Ze().languages&&Object.defineProperty(xt,Gn,{})))}function Xt(xt){return Object.hasOwn(xt,Gn)}function sn(xt,wt){return!document.contains(xt)||xt.closest(`[data-plugin-sandbox=${wt}]`)!==null}let on;function xn(){return on||(on=document.createElement("div"),on.setAttribute("id","grafana-plugin-sandbox-body"),on.setAttribute("data-plugin-sandbox","true"),on.dataset.pluginSandbox="sandboxed-plugin",on.style.width="100%",on.style.height="0%",on.style.overflow="hidden",on.style.top="0",on.style.left="0",document.body.appendChild(on)),on}let Un=!1;function hn(){Un||(Un=!0,kt(),St())}function St(){const xt=Worker.prototype.postMessage;Object.defineProperty(Worker.prototype,"postMessage",{value:function(...wt){return xt.apply(this,kn(wt))}})}function kt(){const xt=window.history.replaceState;Object.defineProperty(window.history,"replaceState",{value:function(...wt){let Zt=wt;try{Zt=(0,ze.cloneDeep)(wt)}catch(cn){Sn("Error cloning args in window.history.replaceState",{error:String(cn)})}return Reflect.apply(xt,this,Zt)},writable:!0,configurable:!0,enumerable:!1})}const en=new Map,tn=!!s.$.featureToggles.frontendSandboxMonitorOnly,gn=Symbol.for("@SANDBOX_LIVE_API_PATCHED");function Nn(){return en.size===0&&(Rt(en),Mt(en),Kt(en),pn(en),ln(en),nn(en),Qt(en),In(en),Rn(en),qn(en),os(en),hs(en)),en}function Ct(xt,wt){return Sn(`Plugin ${wt.id} tried to set a sandboxed property`,{pluginId:wt.id,attrOrMethod:String(xt),entity:"window"}),tn?xt:()=>{throw new Error("Plugins are not allowed to set sandboxed properties")}}function Rt(xt){const wt=["contentDocument","contentWindow","src","srcdoc","srcObject","srcset"];for(const cn of wt){const dn=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,cn);if(dn){let Tn=function(Qn,On){const ys=On.id;return Sn(`Plugin ${ys} tried to access iframe.${cn}`,{pluginId:ys,attrOrMethod:cn,entity:"iframe"}),tn?Qn:()=>{throw new Error("iframe."+cn+" is not allowed in sandboxed plugins")}};var Zt=Tn;dn.value&&xt.set(dn.value,Tn),dn.set&&xt.set(dn.set,Tn),dn.get&&xt.set(dn.get,Tn)}}}function Mt(xt){const wt=Object.getOwnPropertyDescriptor(window,"console");if(wt?.value){let cn=function(dn,Tn){const Qn=Tn.id;if(tn)return dn;function On(...ys){console.log(`[plugin ${Qn}]`,...ys)}return{log:On,warn:On,error:On,info:On,debug:On,table:On}};var Zt=cn;xt.set(wt.value,cn)}wt?.set&&xt.set(wt.set,Ct)}function Kt(xt){function wt(cn,dn){const Tn=dn.id;return Sn(`Plugin ${Tn} accessed window.alert`,{pluginId:Tn,attrOrMethod:"alert",entity:"window"}),tn?cn:function(...Qn){console.log(`[plugin ${Tn}]`,...Qn)}}const Zt=Object.getOwnPropertyDescriptor(window,"alert");Zt?.value&&xt.set(Zt.value,wt),Zt?.set&&xt.set(Zt.set,Ct)}function nn(xt){function wt(cn,dn){const Tn=dn.id;return function(...On){for(const ys of On){const Ns=String(ys||"").toLowerCase();for(const xs of xe)if(Ns.includes("<"+xs)){if(Sn(`Plugin ${Tn} tried to set ${xs} in innerHTML`,{pluginId:Tn,attrOrMethod:"innerHTML",param:xs,entity:"HTMLElement"}),tn)continue;throw new Error("<"+xs+"> is not allowed in sandboxed plugins")}}if((0,ze.isFunction)(cn))return cn.apply(this,On)}}const Zt=[Object.getOwnPropertyDescriptor(Element.prototype,"innerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"outerHTML"),Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentHTML"),Object.getOwnPropertyDescriptor(DOMParser.prototype,"parseFromString")];for(const cn of Zt)cn?.set&&xt.set(cn.set,wt),cn?.value&&xt.set(cn.value,wt)}function Qt(xt){function wt(cn,dn){const Tn=dn.id;return function(On,ys){if(On&&xe.includes(On)&&(Sn(`Plugin ${Tn} tried to create ${On}`,{pluginId:Tn,attrOrMethod:"createElement",param:On,entity:"document"}),!tn))return document.createDocumentFragment();if((0,ze.isFunction)(cn))return cn.apply(this,[On,ys])}}const Zt=Object.getOwnPropertyDescriptor(Document.prototype,"createElement");Zt?.value&&xt.set(Zt.value,wt)}function ln(xt){function wt(Tn,Qn){const On=Qn.id;return function(Ns,xs){const Ks=Ns?.nodeName?.toLowerCase()||"";if(Ns&&xe.includes(Ks)&&(Sn(`Plugin ${On} tried to insert ${Ks}`,{pluginId:On,attrOrMethod:"insertChild",param:Ks,entity:"HTMLElement"}),!tn))return document.createDocumentFragment();if((0,ze.isFunction)(Tn))return Tn.call(this,Ns,xs)}}function Zt(Tn,Qn){const On=Qn.id;return function(Ns,xs){const Ks=xs?.nodeName?.toLowerCase()||"";if(xs&&xe.includes(Ks)&&(Sn(`Plugin ${On} tried to insert ${Ks}`,{pluginId:On,attrOrMethod:"insertAdjacentElement",param:Ks,entity:"HTMLElement"}),!tn))return document.createDocumentFragment();if((0,ze.isFunction)(Tn))return Tn.call(this,Ns,xs)}}const cn=[Object.getOwnPropertyDescriptor(Node.prototype,"insertBefore"),Object.getOwnPropertyDescriptor(Node.prototype,"replaceChild")];for(const Tn of cn)Tn?.value&&xt.set(Tn.set,wt);const dn=Object.getOwnPropertyDescriptor(Element.prototype,"insertAdjacentElement");dn?.value&&xt.set(dn.set,Zt)}function pn(xt){function wt(Tn,Qn){const On=Qn.id;return function(...Ns){let xs=Ns;const Ks=Ns?.filter($s=>!xe.includes($s.nodeName.toLowerCase()));tn||(xs=Ks),xs.length!==Ks.length&&Sn(`Plugin ${On} tried to append fobiddenElements`,{pluginId:On,attrOrMethod:"append",param:Ns?.filter($s=>xe.includes($s.nodeName.toLowerCase()))?.join(",")||"",entity:"HTMLElement"}),(0,ze.isFunction)(Tn)&&Tn.apply(this,xs)}}function Zt(Tn,Qn,On){const ys=Qn.id;return function(xs){const Ks=xs?.nodeName?.toLowerCase()||"";if(xs&&xe.includes(Ks)&&(Sn(`Plugin ${ys} tried to append ${Ks}`,{pluginId:ys,attrOrMethod:"appendChild",param:Ks,entity:"HTMLElement"}),!tn))return document.createDocumentFragment();if(On&&xs&&Ks==="script"&&xs instanceof HTMLScriptElement){ft(xs.src,On).then(()=>{xs.onload?.call(xs,new Event("load"))}).catch($s=>{xs.onerror?.call(xs,new ErrorEvent("error",{error:$s}))});return}if((0,ze.isFunction)(Tn))return Tn.call(this,xs)}}const cn=[Object.getOwnPropertyDescriptor(Element.prototype,"append"),Object.getOwnPropertyDescriptor(Element.prototype,"prepend"),Object.getOwnPropertyDescriptor(Element.prototype,"after"),Object.getOwnPropertyDescriptor(Element.prototype,"before"),Object.getOwnPropertyDescriptor(Document.prototype,"append"),Object.getOwnPropertyDescriptor(Document.prototype,"prepend")];for(const Tn of cn)Tn?.value&&xt.set(Tn.value,wt);const dn=Object.getOwnPropertyDescriptor(Node.prototype,"appendChild");dn?.value&&xt.set(dn.value,Zt)}function In(xt){const wt=Object.getOwnPropertyDescriptor(Worker.prototype,"postMessage");function Zt(cn){return function(...Tn){try{const Qn=(0,ze.cloneDeep)(Tn);(0,ze.isFunction)(cn)&&cn.apply(this,Qn)}catch{throw new Error("postMessage arguments are invalid objects")}}}wt?.value&&xt.set(wt.value,Zt)}function Rn(xt){const wt=Object.getOwnPropertyDescriptor(Document.prototype,"defaultView");wt?.get&&xt.set(wt.get,()=>()=>window);const Zt=["write"];for(const cn of Zt){const dn=Object.getOwnPropertyDescriptor(Document.prototype,cn);dn?.set&&xt.set(dn.set,Ct),dn?.value&&xt.set(dn.value,Ct)}}async function qn(xt){const wt=Reflect.get(window,"monaco");if(!wt||Object.hasOwn(wt,gn))return;const Zt=wt.languages.setMonarchTokensProvider;function cn(){return function(...dn){return dn.length!==2?Zt.apply(wt,dn):Zt.call(wt,dn[0],Zn(dn[1]))}}xt.set(wt.languages.setMonarchTokensProvider,cn),Reflect.set(wt,gn,{})}async function os(xt){const wt=Object.getOwnPropertyDescriptor(window,"postMessage");function Zt(cn){return function(...Tn){try{const Qn=(0,ze.cloneDeep)(Tn);(0,ze.isFunction)(cn)&&cn.apply(this,Qn)}catch{throw new Error("postMessage arguments are invalid objects")}}}wt?.value&&xt.set(wt.value,Zt)}function cs(xt){qn(en)}function hs(xt){function wt(Zt){return(0,ze.isFunction)(Zt)?function(...cn){const dn=Zt.apply(this,cn);return bn(dn),dn}:Zt}xt.set(ze.cloneDeep,wt)}var Ss=e(66161),Os=e(74848);async function ka(xt,wt){if(!Ut(xt))return xt;const Zt=await Promise.resolve(xt.plugin);if(Reflect.has(Zt,"panel")&&Reflect.set(Zt,"panel",na(Reflect.get(Zt,"panel"),wt)),Reflect.has(Zt,"components")){const cn=Reflect.get(Zt,"components");Object.entries(cn).forEach(([dn,Tn])=>{Reflect.set(cn,dn,na(Tn,wt))}),Reflect.set(Zt,"components",cn)}if(Reflect.has(Zt,"root")&&Reflect.set(Zt,"root",na(Reflect.get(Zt,"root"),wt)),Reflect.has(Zt,"extensionConfigs")){const cn=Reflect.get(Zt,"extensionConfigs");for(const dn of cn)Reflect.has(dn,"component")&&Reflect.set(dn,"component",na(Reflect.get(dn,"component"),wt));Reflect.set(Zt,"extensionConfigs",cn)}if(Reflect.has(Zt,"configPages")){const cn=Reflect.get(Zt,"configPages")??[];for(const[dn,Tn]of Object.entries(cn))!Tn.body||!(0,ze.isFunction)(Tn.body)||Reflect.set(cn,dn,{...Tn,body:na(Tn.body,wt)});Reflect.set(Zt,"configPages",cn)}return xt}const na=(xt,wt)=>{const Zt=rt.memo(cn=>(0,Os.jsx)("div",{"data-plugin-sandbox":wt.id,style:{height:wt.type===t.QE.app||wt.type===t.QE.panel?"100%":"auto"},children:(0,Os.jsx)(xt,{...cn})}));return Zt.displayName=`GrafanaSandbox(${xt.displayName||xt.name||"Component"})`,Zt},_a=new Map,Oa={};async function ba({pluginId:xt}){hn();try{const wt=dt(xt);return _a.has(xt)||_a.set(xt,Rs(wt)),_a.get(xt)}catch(wt){const Zt=new Error(`Could not import plugin ${xt} inside sandbox: `+wt);throw An(Zt,{pluginId:xt,error:String(wt)}),Zt}}async function Rs(xt){return Hn("Loading with sandbox",{pluginId:xt.id}),new Promise(async(wt,Zt)=>{const cn=Nn();let dn;function Tn(On){if(wn(On)){const xs=yn(On,xt.id);return Jn(xs),xs}else Ft(On);const ys=cn.get(On);if(ys)return ys(On,xt,dn);const Ns=cs(On);return Ns||On}dn=(0,Qe.A)(window,{distortionCallback:Tn,defaultPolicy:st.G,liveTargetCallback:Xt,endowments:Object.getOwnPropertyDescriptors({locationSandbox:window.location,setImmediate:function(On,...ys){return setTimeout(On,0,...ys)},get monaco(){return Reflect.get(window,"monaco")},get Prism(){return Reflect.get(window,"Prism")},get jQuery(){return Reflect.get(window,"jQuery")},get $(){return Reflect.get(window,"jQuery")},get grafanaBootData(){if(Oa[xt.id+"-grafanaBootData"]||(Oa[xt.id+"-grafanaBootData"]=!0,Hn("Plugin using window.grafanaBootData",{sandbox:"true",pluginId:xt.id,guessedPluginName:xt.id,parent:"window",packageName:"window",key:"grafanaBootData"})),s.$.buildInfo.env==="development")throw new Error(`Error in ${xt.id}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`);return console.error(`${xt.id.toUpperCase()}: Plugins should not use window.grafanaBootData. Use "config" from "@grafana/runtime" instead.`),s.$.bootData},async define(On,ys,Ns){let xs,Ks;Array.isArray(On)?(xs=On,Ks=ys):(xs=ys,Ks=Ns);try{const $s=await Aa(xs,xt),fs=Ks.apply(null,$s),aa=await ka(fs,xt);wt(aa)}catch($s){const fs=new Error(`Could not execute plugin's define ${xt.id}: `+$s);An(fs,{pluginId:xt.id,error:String($s)}),Zt(fs)}}})}),it(dn);let Qn="";try{Qn=await _e(xt)}catch(On){const ys=new Error(`Could not load plugin code ${xt.id}: `+On);An(ys,{pluginId:xt.id,error:String(On)}),Zt(ys)}try{dn.evaluate(Qn)}catch(On){const ys=new Error(`Could not run plugin ${xt.id} inside sandbox: `+On);An(ys,{pluginId:xt.id,error:String(On)}),Zt(ys)}})}async function Aa(xt,wt){const Zt={},cn={id:wt.id,uri:wt.module,exports:Zt},dn=[];for(const Tn of xt){let Qn=Ss.s.get(Tn);if(typeof Qn=="function"&&(Qn=await Qn()),Qn?.__useDefault&&(Qn=Qn.default),Tn==="module"&&(Qn=cn),Tn==="exports"&&(Qn=Zt),!Qn){const On=new Error(`[sandbox] Could not resolve dependency ${Tn}`);throw An(On,{pluginId:wt.id,dependency:Tn,error:String(On)}),On}dn.push(Qn)}return dn}const va=(0,Ne.kB)(ue);re.z.addImportMap({imports:va});const la=re.z.constructor.prototype;la.shouldFetch=function(xt){const wt=(0,ae.QO)(xt);return/^[^#?]+\.(js)([?#].*)?$/.test(xt)?wt?.loadingStrategy!==t.xf.script:!0};const or=la.import;la.import=function(...xt){return or.apply(this,xt).then(wt=>wt&&wt.__useDefault?wt.default:wt)};const Dr=la.fetch;la.fetch=function(xt,wt){return Fe(Dr,xt,wt)};const Cr=la.resolve;la.resolve=Ue.bind(la,Cr),la.onload=fe;async function Fa({path:xt,pluginId:wt,loadingStrategy:Zt,version:cn,isAngular:dn,moduleHash:Tn}){cn&&(0,ae.GD)({path:xt,version:cn,loadingStrategy:Zt});const Qn=Z[xt];if(Qn)return typeof Qn=="function"?await Qn():Qn;const On=(0,Ne.Av)(xt);if(s.$.featureToggles.pluginsSriChecks){const ys=System.resolve(On),Ns=System.getImportMap().integrity;Tn&&Ns&&!Ns[ys]&&re.z.addImportMap({integrity:{[ys]:Tn}})}return await es({isAngular:dn,pluginId:wt})?ba({pluginId:wt}):re.z.import(On)}function Ka(xt){const wt=xt.angular?.detected??xt.angularDetected,Zt=xt.loadingStrategy??t.xf.fetch;return Fa({path:xt.module,version:xt.info?.version,isAngular:wt,loadingStrategy:Zt,pluginId:xt.id,moduleHash:xt.moduleHash}).then(cn=>{if(cn.plugin){const dn=cn.plugin;return dn.meta=xt,dn}if(cn.Datasource){const dn=new n.tD(cn.Datasource);return dn.setComponentsFromLegacyExports(cn),dn.meta=xt,dn}throw new Error("Plugin module is missing DataSourcePlugin or Datasource constructor export")})}function wa(xt){const wt=xt.angular?.detected??xt.angularDetected,Zt=xt.loadingStrategy??t.xf.fetch;return Fa({path:xt.module,version:xt.info?.version,isAngular:wt,loadingStrategy:Zt,pluginId:xt.id,moduleHash:xt.moduleHash}).then(cn=>{const dn=cn.plugin?cn.plugin:new r.hX;return dn.init(xt),dn.meta=xt,dn.setComponentsFromLegacyExports(cn),dn})}},66161:(_,L,e)=>{"use strict";e.d(L,{s:()=>t});const t=new Map([])},60677:(_,L,e)=>{"use strict";e.d(L,{W3:()=>g,Wy:()=>i,z4:()=>l});var t=e(43429),n=e(34867),r=e(15162),s=e(27716),a=e(1682);async function g(d){const o=await(0,s.x)(d);let u;if(o.type===t.QE.app&&(u=await(0,a.ui)(o)),o.type===t.QE.datasource&&(u=await(0,a.cS)(o)),o.type===t.QE.panel&&(u=await(0,r.Kk)(o)),o.type===t.QE.renderer&&(u={meta:o}),!u)throw new Error("Unknown Plugin type: "+o.type);return u}function i(d,o){if(!o)return;const u=10;let c={...o},p;function h(f,v){return!v.startsWith(f.url??"")||p&&(p.url?.length??0)>(f.url?.length??0)?f:(p&&(p.active=!1),p={...f,active:!0},p)}function y(f,v=0){if(v>u)return f;if(f.children){const P=f.children.map(m=>y(m,v+1));return{...h(f,d),children:P}}return h(f,d)}return c.children=(c?.children??[]).map(y),{main:c,node:p??c}}const l=(0,n.DW)("features.plugins")},8856:(_,L,e)=>{"use strict";e.d(L,{Pj:()=>o,o:()=>u,Aj:()=>p});var t=e(75816),n=e(75505),r=e(17172);function s({baseURL:h}){async function y(f){try{const{data:v,...P}=await(0,n.s)((0,r.AI)().fetch({...f,url:h+f.url,showErrorAlert:f.showErrorAlert,data:f.body}));return{data:v,meta:P}}catch(v){return f.manageError?f.manageError(v):{error:v}}}return y}const g=(0,t.xP)({reducerPath:"userPreferencesAPI",baseQuery:s({baseURL:"/api"}),endpoints:()=>({})}).injectEndpoints({endpoints:h=>({getUserPreferences:h.query({query:()=>({url:"/user/preferences"})}),patchUserPreferences:h.mutation({query:y=>({url:"/user/preferences",method:"PATCH",body:y.patchPrefsCmd})}),updateUserPreferences:h.mutation({query:y=>({url:"/user/preferences",method:"PUT",body:y.updatePrefsCmd})})}),overrideExisting:!1}),{useGetUserPreferencesQuery:i,usePatchUserPreferencesMutation:l,useUpdateUserPreferencesMutation:d}=g,{useGetUserPreferencesQuery:o,usePatchUserPreferencesMutation:u,useUpdateUserPreferencesMutation:c}=g,p=g.enhanceEndpoints({addTagTypes:["UserPreferences"],endpoints:{getUserPreferences:{providesTags:["UserPreferences"]},updateUserPreferences:{invalidatesTags:["UserPreferences"]},patchUserPreferences:{invalidatesTags:["UserPreferences"]}}})},81862:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>A,Cj:()=>u,HO:()=>P,Mj:()=>h,Nm:()=>p,Q9:()=>v,RS:()=>x,c1:()=>o,g$:()=>m,ny:()=>y,ri:()=>f,uh:()=>D,xu:()=>c});var t=e(65307),n=e(2543),r=e.n(n),s=e(72724),a=e(47232),g=e(2913),i=e(10096);const l={orgId:g.Ay.bootData.user.orgId,timeZone:g.Ay.bootData.user.timezone,weekStart:g.Ay.bootData.user.weekStart,fiscalYearStartMonth:0,orgsAreLoading:!1,sessionsAreLoading:!1,teamsAreLoading:!1,isUpdating:!1,orgs:[],sessions:[],teams:[],user:null},d=(0,t.Z0)({name:"user/profile",initialState:l,reducers:{updateTimeZone:(R,S)=>{R.timeZone=S.payload.timeZone},updateWeekStart:(R,S)=>{R.weekStart=S.payload.weekStart},updateFiscalYearStartMonth:(R,S)=>{R.fiscalYearStartMonth=S.payload.fiscalYearStartMonth},setUpdating:(R,S)=>{R.isUpdating=S.payload.updating},userLoaded:(R,S)=>{R.user=S.payload.user},initLoadTeams:(R,S)=>{R.teamsAreLoading=!0},teamsLoaded:(R,S)=>{R.teams=S.payload.teams,R.teamsAreLoading=!1},initLoadOrgs:(R,S)=>{R.orgsAreLoading=!0},orgsLoaded:(R,S)=>{R.orgs=S.payload.orgs,R.orgsAreLoading=!1},initLoadSessions:(R,S)=>{R.sessionsAreLoading=!0},sessionsLoaded:(R,S)=>{const O=S.payload.sessions.sort((j,B)=>Number(B.isActive)-Number(j.isActive));R.sessions=O.map(j=>({id:j.id,isActive:j.isActive,seenAt:(0,s.fq)(j.seenAt),createdAt:j.createdAt,clientIp:j.clientIp,browser:j.browser,browserVersion:j.browserVersion,os:j.os,osVersion:j.osVersion,device:j.device})),R.sessionsAreLoading=!1},userSessionRevoked:(R,S)=>{R.sessions=R.sessions.filter(O=>O.id!==S.payload.tokenId),R.isUpdating=!1}}}),o=R=>async S=>{(0,n.set)(i.TP,"user.fiscalYearStartMonth",R),S(b({fiscalYearStartMonth:R}))},u=R=>async S=>{(!(0,n.isString)(R)||(0,n.isEmpty)(R))&&(R=g.Ay?.bootData?.user?.timezone),(0,n.set)(i.TP,"user.timezone",R),S(E({timeZone:R}))},c=R=>async S=>{(!(0,n.isString)(R)||(0,n.isEmpty)(R))&&(R=g.Ay?.bootData?.user?.weekStart),(0,n.set)(i.TP,"user.weekStart",R),S(C({weekStart:R})),(0,a.$D)(R)},{setUpdating:p,initLoadOrgs:h,orgsLoaded:y,initLoadTeams:f,teamsLoaded:v,userLoaded:P,userSessionRevoked:m,initLoadSessions:D,sessionsLoaded:x,updateTimeZone:E,updateWeekStart:C,updateFiscalYearStartMonth:b}=d.actions,T=d.reducer,A={user:d.reducer}},32901:(_,L,e)=>{"use strict";e.d(L,{O:()=>t,q:()=>n});const t=r=>r.timeZone,n=r=>r.fiscalYearStartMonth},2858:(_,L,e)=>{"use strict";e.d(L,{g:()=>l});var t=e(75816),n=e(62938),r=e(56389);const s="grafana.app/createdBy",a=d=>d.items?d.items.map(o=>({uid:o.metadata.name||"",title:o.spec.title,targets:o.spec.targets.map(u=>u.properties),createdAtTimestamp:new Date(o.metadata.creationTimestamp||"").getTime(),user:{uid:o.metadata.annotations?.[s]||""}})):[],g=d=>{const{title:o,targets:u}=d;return{apiVersion:r.mG,kind:r.GY.QueryTemplate,metadata:{generateName:(0,n.A)()},spec:{title:o,vars:[],targets:u.map(c=>({variables:{},properties:c}))}}},i=1e3,l=(0,t.xP)({baseQuery:r.Su,tagTypes:["QueryTemplatesList"],endpoints:d=>({allQueryTemplates:d.query({query:()=>({url:`?limit=${i}`}),transformResponse:a,providesTags:["QueryTemplatesList"]}),addQueryTemplate:d.mutation({query:o=>({method:"POST",data:g(o)}),invalidatesTags:["QueryTemplatesList"]}),deleteQueryTemplate:d.mutation({query:({uid:o})=>({url:`/${o}`,method:"DELETE"}),invalidatesTags:["QueryTemplatesList"]}),editQueryTemplate:d.mutation({query:o=>({url:`/${o.uid}`,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},data:{spec:o.partialSpec}}),invalidatesTags:["QueryTemplatesList"]})}),reducerPath:"queryLibrary"})},56389:(_,L,e)=>{"use strict";e.d(L,{C1:()=>g,GY:()=>a,Su:()=>i,mG:()=>s});var t=e(75505),n=e(32264),r=e(17172);const s="peakq.grafana.app/v0alpha1";var a=(l=>(l.QueryTemplate="QueryTemplate",l))(a||{});const g=`/apis/${s}/namespaces/${n.$.namespace}/querytemplates`,i=async l=>{try{const d=(0,r.AI)().fetch({url:`${g}${l.url??""}`,showErrorAlert:!0,method:l.method||"GET",data:l.data,headers:{...l.headers}});return await(0,t.s)(d)}catch(d){return(0,r.NF)(d)?{error:new Error(d.data.message)}:d instanceof Error?{error:d}:{error:new Error("Unknown error")}}}},64152:(_,L,e)=>{"use strict";e.d(L,{d:()=>r,m:()=>n});class t{constructor(){this.extraRenderActions=[],this.keyedScopedExtraRenderActions=new Map}addExtraRenderAction(a){this.extraRenderActions=this.extraRenderActions.concat(a)}addKeyedExtraRenderAction(a,g){this.keyedScopedExtraRenderActions.set(a,g)}getAllExtraRenderAction(){return this.extraRenderActions}getScopedExtraRenderAction(a){return Array.from(this.keyedScopedExtraRenderActions,i=>i[1]).filter(i=>i.scope===a).map(i=>i.queryActionComponent)}}const n=new t,r=new t},48514:(_,L,e)=>{"use strict";e.d(L,{c:()=>H,E:()=>G});var t=e(74848),n=e(46942),r=e.n(n),s=e(2543),a=e(55127),g=e.n(a),i=e(96540),l=e(41987),d=e(76287),o=e(22391),u=e(18226),c=e(39070),p=e(14236),h=e(26272),y=e(13544),f=e(19347),v=e(7376),P=e(14110),m=e(39938),D=e(66602),x=e(22214),E=e(10343),C=e(7788),b=e(8484),T=e(74856),A=e(84423),R=e(64152),S=e(32196),O=e(40845),j=e(14578),B=e(10354),N=e(72093),I=e(51612);const K=M=>{const{query:Q,queries:Y,onChange:q,collapsedText:te,renderExtras:X,hidden:ee,hideRefId:ne=!1}=M,Z=(0,O.of)(U),[ae,re]=(0,i.useState)(!1),[se,de]=(0,i.useState)(null),le=Pe=>{re(!0)},he=Pe=>{if(re(!1),se){de(null);return}Q.refId!==Pe&&q({...Q,refId:Pe})},ie=Pe=>{const Ie=Pe.currentTarget.value.trim();if(Ie.length===0){de("An empty query name is not allowed");return}for(const ge of Y)if(ge!==Q&&Ie===ge.refId){de("Query name already exists");return}se&&de(null)},J=Pe=>{he(Pe.currentTarget.value.trim())},ce=Pe=>{Pe.key==="Enter"&&he(Pe.currentTarget.value)},pe=Pe=>{Pe.target.select()};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Z.wrapper,children:[!ne&&!ae&&(0,t.jsxs)("button",{className:Z.queryNameWrapper,"aria-label":y.Tp.components.QueryEditorRow.title(Q.refId),title:"Edit query name",onClick:le,"data-testid":"query-name-div",type:"button",children:[(0,t.jsx)("span",{className:Z.queryName,children:Q.refId}),(0,t.jsx)(j.I,{name:"pen",className:Z.queryEditIcon,size:"sm"})]}),!ne&&ae&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(B.p,{type:"text",defaultValue:Q.refId,onBlur:J,autoFocus:!0,onKeyDown:ce,onFocus:pe,invalid:se!==null,onChange:ie,className:Z.queryNameInput,"data-testid":"query-name-input"}),se&&(0,t.jsx)(N.P,{horizontal:!0,children:se})]}),w(M,Z),X&&(0,t.jsx)("div",{className:Z.itemWrapper,children:X()}),ee&&(0,t.jsx)("em",{className:Z.contextInfo,children:"Hidden"})]}),te&&(0,t.jsx)("div",{className:Z.collapsedText,children:te})]})},w=(M,Q)=>{const{alerting:Y,dataSource:q,onChangeDataSource:te}=M;return te?(0,t.jsx)("div",{className:Q.itemWrapper,children:(0,t.jsx)(I.s,{variables:!0,alerting:Y,current:q.name,onChange:te})}):(0,t.jsxs)("em",{className:Q.contextInfo,children:["(",q.name,")"]})},U=M=>({wrapper:(0,S.css)`
      label: Wrapper;
      display: flex;
      align-items: center;
      margin-left: ${M.spacing(.5)};
      overflow: hidden;
    `,queryNameWrapper:(0,S.css)`
      display: flex;
      cursor: pointer;
      border: 1px solid transparent;
      border-radius: ${M.shape.borderRadius(2)};
      align-items: center;
      padding: 0 0 0 ${M.spacing(.5)};
      margin: 0;
      background: transparent;
      overflow: hidden;

      &:hover {
        background: ${M.colors.action.hover};
        border: 1px dashed ${M.colors.border.strong};
      }

      &:focus {
        border: 2px solid ${M.colors.primary.border};
      }

      &:hover,
      &:focus {
        .query-name-edit-icon {
          visibility: visible;
        }
      }
    `,queryName:(0,S.css)`
      font-weight: ${M.typography.fontWeightMedium};
      color: ${M.colors.primary.text};
      cursor: pointer;
      overflow: hidden;
      margin-left: ${M.spacing(.5)};
    `,queryEditIcon:(0,S.cx)((0,S.css)`
        margin-left: ${M.spacing(2)};
        visibility: hidden;
      `,"query-name-edit-icon"),queryNameInput:(0,S.css)`
      max-width: 300px;
      margin: -4px 0;
    `,collapsedText:(0,S.css)`
      font-weight: ${M.typography.fontWeightRegular};
      font-size: ${M.typography.bodySmall.fontSize};
      color: ${M.colors.text.secondary};
      padding-left: ${M.spacing(1)};
      align-items: center;
      overflow: hidden;
      font-style: italic;
      white-space: nowrap;
      text-overflow: ellipsis;
    `,contextInfo:(0,S.css)`
      font-size: ${M.typography.bodySmall.fontSize};
      font-style: italic;
      color: ${M.colors.text.secondary};
      padding-left: 10px;
      padding-right: 10px;
    `,itemWrapper:(0,S.css)`
      display: flex;
      margin-left: 4px;
    `});var W=e(84959);class H extends i.PureComponent{constructor(){super(...arguments),this.element=null,this.angularScope=null,this.angularQueryEditor=null,this.dataSourceSrv=(0,f.l)(),this.id="",this.state={datasource:null,hasTextEditMode:!1,data:void 0,isOpen:!0,showingHelp:!1},this.renderAngularQueryEditor=()=>{if(!this.element)return;this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null);const Q=(0,v.E)(),Y='<plugin-component type="query-ctrl" />',q={ctrl:this.getAngularQueryComponentScope()};this.angularQueryEditor=Q.load(this.element,q,Y),this.angularScope=q.ctrl},this.onOpen=()=>{this.renderAngularQueryEditor()},this.renderPluginEditor=()=>{const{query:Q,onChange:Y,queries:q,onRunQuery:te,onAddQuery:X,app:ee=l.Jk.PanelEditor,history:ne}=this.props,{datasource:Z,data:ae}=this.state;if(this.isWaitingForDatasourceToLoad())return null;if(Z?.components?.QueryCtrl)return(0,t.jsx)("div",{ref:re=>this.element=re});if(Z){let re=this.getReactQueryEditor(Z);if(re)return(0,t.jsx)(d.p,{instanceSettings:this.props.dataSource,children:(0,t.jsx)(re,{query:Q,datasource:Z,onChange:Y,onRunQuery:te,onAddQuery:X,data:ae,range:(0,T.jG)().timeRange(),queries:q,app:ee,history:ne},Z?.name)})}return(0,t.jsx)("div",{children:(0,t.jsx)(b.x6,{i18nKey:"query-operation.query-editor-not-exported",children:"Data source plugin does not export any Query Editor component"})})},this.onToggleEditMode=(Q,Y)=>{Q.stopPropagation(),this.angularScope&&this.angularScope.toggleEditorMode&&(this.angularScope.toggleEditorMode(),this.angularQueryEditor?.digest(),Y.isOpen||Y.onOpen())},this.onRemoveQuery=()=>{const{onRemoveQuery:Q,query:Y,onQueryRemoved:q}=this.props;Q(Y),q&&q()},this.onCopyQuery=()=>{const{query:Q,onAddQuery:Y,onQueryCopied:q}=this.props,te=(0,s.cloneDeep)(Q);Y(te),q&&q()},this.onHideQuery=()=>{const{query:Q,onChange:Y,onRunQuery:q,onQueryToggled:te}=this.props;Y({...Q,hide:!Q.hide}),q(),te&&te(Q.hide),(0,P.rR)("query_editor_row_hide_query_clicked",{hide:!Q.hide})},this.onToggleHelp=()=>{this.setState(Q=>({showingHelp:!Q.showingHelp}))},this.onClickExample=Q=>{Q.datasource===void 0&&(Q.datasource=(0,o.p$)(this.props.dataSource)),this.props.onChange({...Q,refId:this.props.query.refId}),this.onToggleHelp()},this.renderWarnings=()=>{const{data:Q,query:Y}=this.props,te=(G(Q,Y.refId)?.series??[]).reduce((Z,ae)=>{if(!ae.meta?.notices)return Z;const re=(0,s.filter)(ae.meta.notices,{severity:"warning"})??[];return Z.concat(re)},[]),X=(0,s.uniqBy)(te,"text");if(!(X.length>0))return null;const ne=X.map(Z=>Z.text).join(`
`);return(0,t.jsx)(m.E,{color:"orange",icon:"exclamation-triangle",text:(0,t.jsxs)(t.Fragment,{children:[X.length," ",g()("warning",X.length)]}),tooltip:ne},"query-warning")},this.renderExtraActions=()=>{const{query:Q,queries:Y,data:q,onAddQuery:te,dataSource:X,app:ee}=this.props,ne=R.d.getAllExtraRenderAction();let Z=[];ee!==void 0&&(Z=R.d.getScopedExtraRenderAction(ee));const ae=[...ne,...Z].map((re,se)=>re({query:Q,queries:Y,timeRange:q.timeRange,onAddQuery:te,dataSource:X,key:se})).filter(Boolean);return ae.push(this.renderWarnings()),ae},this.renderActions=Q=>{const{query:Y,hideHideQueryButton:q=!1}=this.props,{hasTextEditMode:te,datasource:X,showingHelp:ee}=this.state,ne=!!Y.hide,Z=X?.components?.QueryEditorHelp;return(0,t.jsxs)(t.Fragment,{children:[Z&&(0,t.jsx)(E.A,{title:(0,b.t)("query-operation.header.datasource-help","Show data source help"),icon:"question-circle",onClick:this.onToggleHelp,active:ee}),te&&(0,t.jsx)(E.q,{title:(0,b.t)("query-operation.header.toggle-edit-mode","Toggle text edit mode"),icon:"pen",onClick:ae=>{this.onToggleEditMode(ae,Q)}}),this.renderExtraActions(),(0,t.jsx)(E.q,{title:(0,b.t)("query-operation.header.duplicate-query","Duplicate query"),icon:"copy",onClick:this.onCopyQuery}),q?null:(0,t.jsx)(E.A,{dataTestId:y.Tp.components.QueryEditorRow.actionButton("Hide response"),title:Y.hide?(0,b.t)("query-operation.header.show-response","Show response"):(0,b.t)("query-operation.header.hide-response","Hide response"),icon:ne?"eye-slash":"eye",active:ne,onClick:this.onHideQuery}),(0,t.jsx)(E.q,{title:(0,b.t)("query-operation.header.remove-query","Remove query"),icon:"trash-alt",onClick:this.onRemoveQuery})]})},this.renderHeader=Q=>{const{alerting:Y,query:q,dataSource:te,onChangeDataSource:X,onChange:ee,queries:ne,renderHeaderExtras:Z,hideRefId:ae}=this.props;return(0,t.jsx)(K,{query:q,queries:ne,onChangeDataSource:X,dataSource:te,hidden:q.hide,onClick:re=>this.onToggleEditMode(re,Q),onChange:ee,collapsedText:Q.isOpen?null:this.renderCollapsedText(),renderExtras:Z,alerting:Y,hideRefId:ae})}}componentDidMount(){const{data:Q,query:Y,id:q}=this.props,te=G(Q,Y.refId);this.id=(0,s.uniqueId)(q+"_"),this.setState({data:te}),this.loadDatasource()}componentWillUnmount(){this.angularQueryEditor&&this.angularQueryEditor.destroy()}getAngularQueryComponentScope(){const{query:Q,queries:Y}=this.props,{datasource:q}=this.state,te=new A.a9({targets:Y}),X={},ee=this;return{datasource:q,target:Q,panel:te,dashboard:X,refresh:()=>{Q.hide!==ee.props.query.hide&&(Q.hide=ee.props.query.hide),this.props.onChange(Q),this.props.onRunQuery()},render:()=>()=>console.log("legacy render function called, it does nothing"),events:this.props.eventBus||new u.o,range:(0,T.jG)().timeRange()}}getInterpolatedDataSourceUID(){if(this.props.query.datasource){const Q=this.dataSourceSrv.getInstanceSettings(this.props.query.datasource);return Q?.rawRef?.uid??Q?.uid}return this.props.dataSource.rawRef?.uid??this.props.dataSource.uid}async loadDatasource(){let Q;const Y=this.getInterpolatedDataSourceUID();try{Q=await this.dataSourceSrv.get(Y)}catch{Q=await this.dataSourceSrv.get()}typeof this.props.onDataSourceLoaded=="function"&&this.props.onDataSourceLoaded(Q),this.setState({datasource:Q,queriedDataSourceIdentifier:Y,hasTextEditMode:(0,s.has)(Q,"components.QueryCtrl.prototype.toggleEditorMode")})}componentDidUpdate(Q){const{datasource:Y,queriedDataSourceIdentifier:q}=this.state,{data:te,query:X}=this.props;if(Q.id!==this.props.id&&(this.id=(0,s.uniqueId)(this.props.id+"_")),te!==Q.data){const ee=G(te,X.refId);this.setState({data:ee}),this.angularScope&&(this.angularScope.range=(0,T.jG)().timeRange()),this.angularQueryEditor&&ee&&z(this.angularScope,ee,this.angularQueryEditor)}if(Y&&q!==this.getInterpolatedDataSourceUID()){this.angularQueryEditor&&(this.angularQueryEditor.destroy(),this.angularQueryEditor=null),this.loadDatasource();return}!this.element||this.angularQueryEditor||this.renderAngularQueryEditor()}getReactQueryEditor(Q){if(Q)switch(this.props.app){case l.Jk.Explore:return Q.components?.ExploreMetricsQueryField||Q.components?.ExploreLogsQueryField||Q.components?.ExploreQueryField||Q.components?.QueryEditor;case l.Jk.PanelEditor:case l.Jk.Dashboard:default:return Q.components?.QueryEditor}}isWaitingForDatasourceToLoad(){return this.getInterpolatedDataSourceUID()!==this.state.queriedDataSourceIdentifier}renderCollapsedText(){const{datasource:Q}=this.state;return Q?.getQueryDisplayText?Q.getQueryDisplayText(this.props.query):this.angularScope&&this.angularScope.getCollapsedText?this.angularScope.getCollapsedText():null}render(){const{query:Q,index:Y,visualization:q,collapsable:te,hideActionButtons:X}=this.props,{datasource:ee,showingHelp:ne,data:Z}=this.state,ae=Q.hide,re=Z?.error&&Z.error.refId===Q.refId?Z.error:Z?.errors?.find(he=>he.refId===Q.refId),se=r()("query-editor-row",{"query-editor-row--disabled":ae,"gf-form-disabled":ae});if(!ee)return null;const de=this.renderPluginEditor(),le=ee.components?.QueryEditorHelp;return(0,t.jsx)("div",{"data-testid":"query-editor-row","aria-label":y.Tp.components.QueryEditorRows.rows,children:(0,t.jsx)(C.u,{id:this.id,draggable:!X,collapsable:te,index:Y,headerElement:this.renderHeader,actions:X?void 0:this.renderActions,onOpen:this.onOpen,children:(0,t.jsxs)("div",{className:se,id:this.id,children:[(0,t.jsxs)(D.Xw,{children:[ne&&le&&(0,t.jsx)(x.j,{children:(0,t.jsx)(le,{onClickExample:he=>this.onClickExample(he),query:this.props.query,datasource:ee})}),de]}),re&&(0,t.jsx)(W.x,{error:re}),q]})})})}}function z(M,Q,Y){if(Q.state===c.Gu.Done){const q=Q.series.map(te=>(0,p.w3)(te));M.events.emit(h.ee.dataReceived,q)}else Q.state===c.Gu.Error&&M.events.emit(h.ee.dataError,Q.error);setTimeout(Y.digest)}function G(M,Q){const Y=M.series.filter(ee=>ee.refId===Q);if(M.state!==c.Gu.Loading&&(M.error||M.errors?.length)&&!M.series.length)return{...M,state:c.Gu.Error};let q=M.state,te=M.errors?.find(ee=>ee.refId===Q);!te&&M.error&&(te=M.error.refId===Q?M.error:void 0),q!==c.Gu.Loading&&(te?q=c.Gu.Error:M.state===c.Gu.Error&&(q=c.Gu.Done));const X=M.timeRange;return{...M,state:q,series:Y,error:te,errors:te?[te]:void 0,timeRange:X}}},44932:(_,L,e)=>{"use strict";e.d(L,{L:()=>l});var t=e(74848),n=e(91076),r=e(96540),s=e(22391),a=e(14110),g=e(19347),i=e(48514);class l extends r.PureComponent{constructor(){super(...arguments),this.onRemoveQuery=u=>{this.props.onQueriesChange(this.props.queries.filter(c=>c!==u))},this.onDragStart=u=>{const{queries:c,dsSettings:p}=this.props;(0,a.rR)("query_row_reorder_started",{startIndex:u.source.index,numberOfQueries:c.length,datasourceType:p.type})},this.onDragEnd=u=>{const{queries:c,onQueriesChange:p,dsSettings:h}=this.props;if(!u||!u.destination)return;const y=u.source.index,f=u.destination.index;if(y===f){(0,a.rR)("query_row_reorder_canceled",{startIndex:y,endIndex:f,numberOfQueries:c.length,datasourceType:h.type});return}const v=Array.from(c),[P]=v.splice(y,1);v.splice(f,0,P),p(v),(0,a.rR)("query_row_reorder_ended",{startIndex:y,endIndex:f,numberOfQueries:c.length,datasourceType:h.type})}}onChangeQuery(u,c){const{queries:p,onQueriesChange:h}=this.props;h(p.map((y,f)=>f===c?u:y))}onDataSourceChange(u,c){const{queries:p,onQueriesChange:h}=this.props;h(p.map((y,f)=>{if(f!==c)return y;const v=(0,s.p$)(u);return y.datasource&&(0,g.l)().getInstanceSettings(y.datasource)?.type===u.type?{...y,datasource:v}:{refId:y.refId,hide:y.hide,datasource:v}}))}render(){const{dsSettings:u,data:c,queries:p,app:h,history:y,eventBus:f,onAddQuery:v,onRunQueries:P,onQueryCopied:m,onQueryRemoved:D,onQueryToggled:x,queryRowWrapper:E}=this.props;return(0,t.jsx)(n.JY,{onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,children:(0,t.jsx)(n.gL,{droppableId:"transformations-list",direction:"vertical",children:C=>(0,t.jsxs)("div",{"data-testid":"query-editor-rows",ref:C.innerRef,...C.droppableProps,children:[p.map((b,T)=>{const A=d(b,u),R=u.meta.mixed?O=>this.onDataSourceChange(O,T):void 0,S=(0,t.jsx)(i.c,{id:b.refId,index:T,data:c,query:b,dataSource:A,onChangeDataSource:R,onChange:O=>this.onChangeQuery(O,T),onRemoveQuery:this.onRemoveQuery,onAddQuery:v,onRunQuery:P,onQueryCopied:m,onQueryRemoved:D,onQueryToggled:x,queries:p,app:h,history:y,eventBus:f},b.refId);return E?E(S,b.refId):S}),C.placeholder]})})})}}const d=(o,u)=>o.datasource&&(0,g.l)().getInstanceSettings(o.datasource)||u},84959:(_,L,e)=>{"use strict";e.d(L,{x:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(14578);function a({error:i}){const l=(0,r.of)(g),d=i?.message??i?.data?.message??"Query error";return(0,t.jsxs)("div",{className:l.wrapper,children:[(0,t.jsx)("div",{className:l.icon,children:(0,t.jsx)(s.I,{name:"exclamation-triangle"})}),(0,t.jsxs)("div",{className:l.message,children:[d,i.traceId!=null&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("br",{})," ",(0,t.jsxs)("span",{children:["(Trace ID: ",i.traceId,")"]})]})]})]})}const g=i=>({wrapper:(0,n.css)({marginTop:i.spacing(.5),background:i.colors.background.secondary,display:"flex"}),icon:(0,n.css)({background:i.colors.error.main,color:i.colors.error.contrastText,padding:i.spacing(1)}),message:(0,n.css)({fontSize:i.typography.bodySmall.fontSize,fontFamily:i.typography.fontFamilyMonospace,padding:i.spacing(1)})})},37464:(_,L,e)=>{"use strict";e.d(L,{g:()=>q,K:()=>X});var t=e(74848),n=e(32196),r=e(96540),s=e(39070),a=e(43127),g=e(22391),i=e(41987),l=e(43429),d=e(13544),o=e(19347),u=e(39601),c=e(66864),p=e(55852),h=e(40276),y=e(37390),f=e(3911),v=e(38894),P=e(16817),m=e(36663),D=e(17172),x=e(39558);function E({pluginId:ne}){const{value:Z,loading:ae,error:re}=(0,P.A)(async()=>(0,D.AI)().get(`/api/plugins/${ne}/markdown/query_help`),[]),se=(0,m.G)(Z);return ae?(0,t.jsx)(x._,{text:"Loading help..."}):re?(0,t.jsx)("h3",{children:"An error occurred when loading help."}):Z===""?(0,t.jsx)("h3",{children:"No query help could be found."}):(0,t.jsx)("div",{className:"markdown-html",dangerouslySetInnerHTML:{__html:se}})}var C=e(2913),b=e(27677),T=e(21969),A=e(50481),R=e(51612),S=e(53478),O=e(74106),j=e(14348),B=e(8480),N=e(93117),I=e(64152),K=e(44932),w=e(65879),U=e(10354),W=e(39268),H=e(15292),z=e(7788);class G extends r.PureComponent{constructor(Z){super(Z),this.onRelativeTimeChange=re=>{this.setState({timeRangeFrom:re.target.value})},this.onTimeShiftChange=re=>{this.setState({timeRangeShift:re.target.value})},this.onOverrideTime=re=>{const{options:se,onChange:de}=this.props,le=Q(re.target.value),he=M(le);he&&se.timeRange?.from!==le&&de({...se,timeRange:{...se.timeRange??{},from:le}}),this.setState({relativeTimeIsValid:he})},this.onTimeShift=re=>{const{options:se,onChange:de}=this.props,le=Q(re.target.value),he=M(le);he&&se.timeRange?.shift!==le&&de({...se,timeRange:{...se.timeRange??{},shift:le}}),this.setState({timeShiftIsValid:he})},this.onToggleTimeOverride=()=>{const{onChange:re,options:se}=this.props;this.setState({timeRangeHide:!this.state.timeRangeHide},()=>{re({...se,timeRange:{...se.timeRange??{},hide:this.state.timeRangeHide}})})},this.onCacheTimeoutBlur=re=>{const{options:se,onChange:de}=this.props;de({...se,cacheTimeout:Q(re.target.value)})},this.onQueryCachingTTLBlur=re=>{const{options:se,onChange:de}=this.props;let le=parseInt(re.target.value,10);(isNaN(le)||le===0)&&(le=null),de({...se,queryCachingTTL:le})},this.onMaxDataPointsBlur=re=>{const{options:se,onChange:de}=this.props;let le=parseInt(re.currentTarget.value,10);(isNaN(le)||le===0)&&(le=null),le!==se.maxDataPoints&&de({...se,maxDataPoints:le})},this.onMinIntervalBlur=re=>{const{options:se,onChange:de}=this.props,le=Q(re.target.value);le!==se.minInterval&&de({...se,minInterval:le})},this.onOpenOptions=()=>{this.setState({isOpen:!0})},this.onCloseOptions=()=>{this.setState({isOpen:!1})};const{options:ae}=Z;this.state={timeRangeFrom:ae.timeRange?.from||"",timeRangeShift:ae.timeRange?.shift||"",timeRangeHide:ae.timeRange?.hide??!1,isOpen:!1,relativeTimeIsValid:!0,timeShiftIsValid:!0}}renderCacheTimeoutOption(){const{dataSource:Z,options:ae}=this.props,re=`If your time series store has a query cache this option can override the default cache timeout. Specify a
    numeric value in seconds.`;return Z.meta.queryOptions?.cacheTimeout?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:re,children:"Cache timeout"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"60",spellCheck:!1,onBlur:this.onCacheTimeoutBlur,defaultValue:ae.cacheTimeout??""})]})}):null}renderQueryCachingTTLOption(){const{dataSource:Z,options:ae}=this.props,re="Cache time-to-live: How long results from this queries in this panel will be cached, in milliseconds. Defaults to the TTL in the caching configuration for this datasource.";return Z.cachingConfig?.enabled?(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:re,children:"Cache TTL"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${Z.cachingConfig.TTLMs}`,spellCheck:!1,onBlur:this.onQueryCachingTTLBlur,defaultValue:ae.queryCachingTTL??void 0})]})}):null}renderMaxDataPointsOption(){const{data:Z,options:ae}=this.props,re=Z.request?.maxDataPoints,se=ae.maxDataPoints??"",de=se==="";return(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsx)(t.Fragment,{children:"The maximum data points per series. Used directly by some data sources and used in calculation of auto interval. With streaming data this value is used for the rolling buffer."}),children:"Max data points"}),(0,t.jsx)(U.p,{type:"number",className:"width-6",placeholder:`${re}`,spellCheck:!1,onBlur:this.onMaxDataPointsBlur,defaultValue:se}),de&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Width of panel"})]})]})})}renderIntervalOption(){const{data:Z,dataSource:ae,options:re}=this.props,se=Z.request?.interval,de=ae.interval??"No limit";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["A lower limit for the interval. Recommended to be set to write frequency, for example ",(0,t.jsx)("code",{children:"1m"})," ","if your data is written every minute. Default value can be set in data source settings for most data sources."]}),children:"Min interval"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:`${de}`,spellCheck:!1,onBlur:this.onMinIntervalBlur,defaultValue:re.minInterval??""})]})}),(0,t.jsx)("div",{className:"gf-form-inline",children:(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["The evaluated interval that is sent to data source and is used in ",(0,t.jsx)("code",{children:"$__interval"})," and"," ",(0,t.jsx)("code",{children:"$__interval_ms"}),". This value is not exactly equal to"," ",(0,t.jsx)("code",{children:"Time range / max data points"}),", it will approximate a series of magic number."]}),children:"Interval"}),(0,t.jsx)(v.I,{width:6,children:se}),(0,t.jsx)("div",{className:"gf-form-label query-segment-operator",children:"="}),(0,t.jsx)("div",{className:"gf-form-label",children:"Time range / max data points"})]})})]})}renderCollapsedText(Z){const{data:ae,options:re}=this.props,{isOpen:se}=this.state;if(se)return;let de=re.maxDataPoints??"";de===""&&ae.request&&(de=`auto = ${ae.request.maxDataPoints}`);let le=re.minInterval;return ae.request&&(le=`${ae.request.interval}`),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:Z.collapsedText,children:["MD = ",de]}),(0,t.jsxs)("div",{className:Z.collapsedText,children:["Interval = ",le]})]})}render(){const{timeRangeHide:Z,relativeTimeIsValid:ae,timeShiftIsValid:re}=this.state,{timeRangeFrom:se,timeRangeShift:de,isOpen:le}=this.state,he=Y();return(0,t.jsxs)(z.u,{id:"Query options",index:0,title:"Query options",headerElement:this.renderCollapsedText(he),isOpen:le,onOpen:this.onOpenOptions,onClose:this.onCloseOptions,children:[this.renderMaxDataPointsOption(),this.renderIntervalOption(),this.renderCacheTimeoutOption(),this.renderQueryCachingTTLOption(),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the relative time range for individual panels, which causes them to be different than what is selected in the dashboard time picker in the top-right corner of the dashboard. For example to configure the Last 5 minutes the Relative time should be ",(0,t.jsx)("code",{children:"now-5m"})," and ",(0,t.jsx)("code",{children:"5m"}),", or variables like ",(0,t.jsx)("code",{children:"$_relativeTime"}),"."]}),children:"Relative time"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onRelativeTimeChange,onBlur:this.onOverrideTime,invalid:!ae,value:se})]}),(0,t.jsxs)("div",{className:"gf-form",children:[(0,t.jsx)(v.I,{width:9,tooltip:(0,t.jsxs)(t.Fragment,{children:["Overrides the time range for individual panels by shifting its start and end relative to the time picker. For example to configure the Last 1h the Time shift should be ",(0,t.jsx)("code",{children:"now-1h"})," and"," ",(0,t.jsx)("code",{children:"1h"}),", or variables like ",(0,t.jsx)("code",{children:"$_timeShift"}),"."]}),children:"Time shift"}),(0,t.jsx)(U.p,{type:"text",className:"width-6",placeholder:"1h",onChange:this.onTimeShiftChange,onBlur:this.onTimeShift,invalid:!re,value:de})]}),(de||se)&&(0,t.jsxs)(W.C,{children:[(0,t.jsx)(v.I,{width:9,children:"Hide time info"}),(0,t.jsx)(H.K,{value:Z,onChange:this.onToggleTimeOverride})]})]})}}const M=ne=>ne?w.isValidTimeSpan(ne):!0,Q=ne=>ne===""?null:ne,Y=(0,f.N)(()=>{const{theme:ne}=C.$W;return{collapsedText:(0,n.css)`
      margin-left: ${ne.spacing.md};
      font-size: ${ne.typography.size.sm};
      color: ${ne.colors.textWeak};
    `}});class q extends r.PureComponent{constructor(){super(...arguments),this.backendSrv=b.IB,this.dataSourceSrv=(0,o.l)(),this.querySubscription=null,this.state={isDataSourceModalOpen:!!u.Ny.getSearchObject().firstPanel,isLoadingHelp:!1,helpContent:null,isPickerOpen:!1,isHelpOpen:!1,queries:[],data:{state:s.Gu.NotStarted,series:[],timeRange:(0,a.E2)()}},this.onChangeDataSource=async(Z,ae)=>{const{dsSettings:re}=this.state,se=re?await(0,o.l)().get(re.uid):void 0,de=await(0,o.l)().get(Z.uid),le=ae||await(0,N.y)(de,Z.uid,this.state.queries,se),he=await this.dataSourceSrv.get(Z.name);this.onChange({queries:le,dataSource:{name:Z.name,uid:Z.uid,...(0,g.p$)(Z)}}),this.setState({queries:le,dataSource:he,dsSettings:Z}),ae&&this.props.onRunQueries()},this.onAddQueryClick=()=>{const{queries:Z}=this.state;this.onQueriesChange((0,T.U7)(Z,this.newQuery())),this.onScrollBottom()},this.onAddExpressionClick=()=>{this.onQueriesChange((0,T.U7)(this.state.queries,S.Ex.newQuery())),this.onScrollBottom()},this.onScrollBottom=()=>{setTimeout(()=>{this.state.scrollElement&&this.state.scrollElement.scrollTo({top:1e4})},20)},this.onUpdateAndRun=Z=>{this.props.onOptionsChange(Z),this.props.onRunQueries()},this.onOpenHelp=()=>{this.setState({isHelpOpen:!0})},this.onCloseHelp=()=>{this.setState({isHelpOpen:!1})},this.onCloseDataSourceModal=()=>{this.setState({isDataSourceModalOpen:!1})},this.onAddQuery=Z=>{const{dsSettings:ae,queries:re}=this.state;this.onQueriesChange((0,T.U7)(re,Z,ae?(0,g.p$)(ae):{type:void 0,uid:void 0})),this.onScrollBottom()},this.onQueriesChange=Z=>{this.onChange({queries:Z}),this.setState({queries:Z})},this.setScrollRef=Z=>{this.setState({scrollElement:Z})}}async componentDidMount(){const{options:Z,queryRunner:ae}=this.props;this.querySubscription=ae.getData({withTransforms:!1,withFieldConfig:!1}).subscribe({next:re=>this.onPanelDataUpdate(re)}),this.setNewQueriesAndDatasource(Z)}componentWillUnmount(){this.querySubscription&&(this.querySubscription.unsubscribe(),this.querySubscription=null)}async componentDidUpdate(){const{options:Z}=this.props,ae=await(0,o.l)().get(Z.dataSource);this.state.dataSource&&ae.uid!==this.state.dataSource?.uid&&this.setNewQueriesAndDatasource(Z)}async setNewQueriesAndDatasource(Z){try{const ae=await this.dataSourceSrv.get(Z.dataSource),re=this.dataSourceSrv.getInstanceSettings(Z.dataSource),se=await this.dataSourceSrv.get(),de=ae.getRef(),le=Z.queries.map(he=>({...(0,T.Ih)(he)&&ae?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:de,...he}));this.setState({queries:le,dataSource:ae,dsSettings:re,defaultDataSource:se})}catch(ae){console.error("failed to load data source",ae)}}onPanelDataUpdate(Z){this.setState({data:Z})}newQuery(){const{dsSettings:Z,defaultDataSource:ae}=this.state,re=Z&&!Z.meta.mixed?(0,g.p$)(Z):ae?ae.getRef():{type:void 0,uid:void 0};return{...this.state.dataSource?.getDefaultQuery?.(i.Jk.PanelEditor),datasource:re}}onChange(Z){this.props.onOptionsChange({...this.props.options,...Z})}renderTopSection(Z){const{onOpenQueryInspector:ae,options:re}=this.props,{dataSource:se,data:de,dsSettings:le}=this.state;return!le||!se?null:(0,t.jsx)(X,{data:de,dataSource:se,options:re,dsSettings:le,onOptionsChange:this.onUpdateAndRun,onDataSourceChange:this.onChangeDataSource,onOpenQueryInspector:ae})}renderQueries(Z){const{onRunQueries:ae}=this.props,{data:re,queries:se}=this.state;return(0,t.jsx)("div",{"aria-label":d.Tp.components.QueryTab.content,children:(0,t.jsx)(K.L,{queries:se,dsSettings:Z,onQueriesChange:this.onQueriesChange,onAddQuery:this.onAddQuery,onRunQueries:ae,data:re})})}isExpressionsSupported(Z){return(Z.meta.alerting||Z.meta.mixed)===!0}renderExtraActions(){return I.m.getAllExtraRenderAction().map((Z,ae)=>Z({onAddQuery:this.onAddQuery,onChangeDataSource:this.onChangeDataSource,key:ae})).filter(Boolean)}renderAddQueryRow(Z,ae){const re=!(0,j.kN)(Z.name);return(0,t.jsxs)(c.Gy,{spacing:"md",align:"flex-start",children:[re&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddQueryClick,variant:"secondary","data-testid":d.Tp.components.QueryTab.addQuery,children:"Add query"}),C.Ay.expressionsEnabled&&this.isExpressionsSupported(Z)&&(0,t.jsx)(p.$n,{icon:"plus",onClick:this.onAddExpressionClick,variant:"secondary",className:ae.expressionButton,"data-testid":"query-tab-add-expression",children:(0,t.jsx)("span",{children:"Expression\xA0"})}),this.renderExtraActions()]})}render(){const{isHelpOpen:Z,dsSettings:ae}=this.state,re=te();return(0,t.jsx)(h.E,{autoHeightMin:"100%",scrollRefCallback:this.setScrollRef,children:(0,t.jsxs)("div",{className:re.innerWrapper,children:[this.renderTopSection(re),ae&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:re.queriesWrapper,children:this.renderQueries(ae)}),this.renderAddQueryRow(ae,re),Z&&(0,t.jsx)(y.a,{title:"Data source help",isOpen:!0,onDismiss:this.onCloseHelp,children:(0,t.jsx)(E,{pluginId:ae.meta.id})})]})]})})}}const te=(0,f.N)(()=>{const{theme:ne}=C.Ay;return{innerWrapper:(0,n.css)`
      display: flex;
      flex-direction: column;
      padding: ${ne.spacing.md};
    `,dataSourceRow:(0,n.css)`
      display: flex;
      margin-bottom: ${ne.spacing.md};
    `,dataSourceRowItem:(0,n.css)`
      margin-right: ${ne.spacing.inlineFormMargin};
    `,dataSourceRowItemOptions:(0,n.css)`
      flex-grow: 1;
      margin-right: ${ne.spacing.inlineFormMargin};
    `,queriesWrapper:(0,n.css)`
      padding-bottom: 16px;
    `,expressionWrapper:(0,n.css)``,expressionButton:(0,n.css)`
      margin-right: ${ne.spacing.sm};
    `}});function X({dataSource:ne,options:Z,data:ae,dsSettings:re,onDataSourceChange:se,onOptionsChange:de,onOpenQueryInspector:le}){const he=te(),[ie,J]=(0,r.useState)(!1);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{"data-testid":d.Tp.components.QueryTab.queryGroupTopSection,children:[(0,t.jsxs)("div",{className:he.dataSourceRow,children:[(0,t.jsx)(v.I,{htmlFor:"data-source-picker",width:"auto",children:"Data source"}),(0,t.jsx)("div",{className:he.dataSourceRowItem,children:(0,t.jsx)(ee,{options:Z,onChange:async(ce,pe)=>await se?.(ce,pe),isDataSourceModalOpen:!!u.Ny.getSearchObject().firstPanel})}),ne&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:he.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",icon:"question-circle",title:"Open data source help",onClick:()=>J(!0),"data-testid":"query-tab-help-button"})}),(0,t.jsx)("div",{className:he.dataSourceRowItemOptions,children:(0,t.jsx)(G,{options:Z,dataSource:ne,data:ae,onChange:ce=>{de?.(ce)}})}),le&&(0,t.jsx)("div",{className:he.dataSourceRowItem,children:(0,t.jsx)(p.$n,{variant:"secondary",onClick:le,"aria-label":d.Tp.components.QueryTab.queryInspectorButton,children:"Query inspector"})})]})]}),ne&&(0,B.Hv)(ne.uid)&&(0,t.jsx)(O.c,{pluginId:ne.type,pluginType:l.QE.datasource,angularSupportEnabled:C.Ay?.angularSupportEnabled,showPluginDetailsLink:!0,interactionElementId:"datasource-query"})]}),ie&&(0,t.jsx)(y.a,{title:"Data source help",isOpen:!0,onDismiss:()=>J(!1),children:(0,t.jsx)(E,{pluginId:re.meta.id})})]})}function ee({options:ne,onChange:Z,...ae}){const[re,se]=(0,r.useState)(!!ae.isDataSourceModalOpen);(0,r.useEffect)(()=>{u.Ny.getSearchObject().firstPanel&&u.Ny.partial({firstPanel:null},!0)},[]);const de={metrics:!0,mixed:!0,dashboard:!0,variables:!0,current:ne.dataSource,uploadFile:!0,onChange:async(le,he)=>{await Z(le,he),se(!1)}};return(0,t.jsxs)(t.Fragment,{children:[re&&(0,t.jsx)(A.p,{...de,onDismiss:()=>se(!1)}),(0,t.jsx)(R.s,{...de})]})}},42972:(_,L,e)=>{"use strict";e.d(L,{nm:()=>re,Dh:()=>ne});var t=e(39741),n=e(13752),r=e(64423),s=e(44240),a=e(39697),g=e(81160),i=e(67791),l=e(93031),d=e(71030),o=e(69850),u=e(1005),c=e(65961),p=e(3591),h=e(2543);function y(se){let de=[];const le=(0,h.partition)(se,"id"),he=(0,h.groupBy)(le[0],"id");return de=(0,h.map)(he,ie=>ie.length>1&&!(0,h.every)(ie,f)?(0,h.find)(ie,J=>J.eventType!=="panel-alert"):(0,h.head)(ie)),de=(0,h.concat)(de,le[1]),de}function f(se){return se.eventType==="panel-alert"}var v=e(74856),P=e(62467),m=e(65474),D=e(66847),x=e(69862),E=e(16126),C=e(32264),b=e(19347),T=e(90569),A=e(28444),R=e(27302),S=e(7436);class O{canRun(de){return de?!!(!de.annotationQuery||de.annotations):!1}run({annotation:de,datasource:le,dashboard:he,range:ie}){if(!this.canRun(le))return(0,P.of)([]);const J={};return(0,R.b)({dashboard:he,range:ie,panel:J},le,de).pipe((0,g.T)(ce=>ce.events??[]),(0,D.W)(S.SD))}}var j=e(42493);class B{canRun(de){return de?(0,j.E7)(de)?!0:!!(de.annotationQuery&&!de.annotations):!1}run({annotation:de,datasource:le,dashboard:he,range:ie}){return this.canRun(le)?(0,m.H)(le.annotationQuery({range:ie,rangeRaw:ie.raw,annotation:de,dashboard:he})).pipe((0,D.W)(S.SD)):(0,P.of)([])}}class N{constructor(de=[new B,new O]){this.runners=de}canWork({dashboard:de}){return!!de.annotations.list.find(N.getAnnotationsToProcessFilter)}work(de){if(!this.canWork(de))return(0,S.$)();const{dashboard:le,range:he}=de;let ie=le.annotations.list.filter(N.getAnnotationsToProcessFilter);C.$.publicDashboardAccessToken&&ie.length>0&&(ie=[ie[0]]);const J=ie.map(ce=>{let pe;if(C.$.publicDashboardAccessToken){const Pe=new T.X;pe=(0,P.of)(Pe).pipe((0,D.W)(S.H0))}else pe=(0,m.H)((0,b.l)().get(ce.datasource)).pipe((0,D.W)(S.H0));return pe.pipe((0,x.Z)(Pe=>{const Ie=this.runners.find(ge=>ge.canRun(Pe));return Ie?(le.events.publish(new A.xc(ce)),Ie.run({annotation:ce,datasource:Pe,dashboard:le,range:he}).pipe((0,i.Q)(ne().cancellations().pipe((0,E.p)(ge=>ge===ce))),(0,g.T)(ge=>(le.snapshot&&(ce.snapshotData=(0,h.cloneDeep)(ge)),C.$.publicDashboardAccessToken?ge:(0,S.G9)(ce,ge))),(0,o.j)(()=>{le.events.publish(new A.yj(ce))}))):(0,P.of)([])}))});return(0,s.h)(J).pipe((0,l.U)(),(0,d.T)((ce,pe)=>ce.concat(pe)),(0,g.T)(ce=>({annotations:ce,alertStates:[]})))}static getAnnotationsToProcessFilter(de){return de.enable&&!de.snapshotData}}var I=e(85595),K=e(43585),w=e(16233),U=e(79938),W=e(49498),H=e(55740),z=e(57220),G=e(23662),M=e(91309),Q=e(99140),Y=e(31678);class q{constructor(){this.hasAlertRules={}}canWork({dashboard:de,range:le}){return!(!de.uid||C.$.publicDashboardAccessToken||le.raw.to!=="now"||this.hasAlertRules[de.uid]===!1||!(w.TP.hasPermission(Y.AccessControlAction.AlertingRuleRead)&&w.TP.hasPermission(Y.AccessControlAction.AlertingRuleExternalRead)))}work(de){if(!this.canWork(de))return(0,S.$)();const{dashboard:le}=de,he=async()=>(await(0,Q.JD)(U.hK.endpoints.prometheusRuleNamespaces.initiate({ruleSourceName:z.hY,dashboardUid:le.uid},{forceRefetch:!0}))).data;return(0,m.H)(he()).pipe((0,g.T)(J=>(0,W.Kw)(J))).pipe((0,g.T)(J=>{this.hasAlertRules[le.uid]=!1;const ce={};return J.forEach(pe=>pe.rules.forEach(Pe=>{if((0,G.Z8)(Pe)&&Pe.annotations&&Pe.annotations[H.YH.panelID]){this.hasAlertRules[le.uid]=!0;const Ie=Number(Pe.annotations[H.YH.panelID]),ge=(0,M.S)(Pe.state);ce[Ie]?ge===K.O.Alerting&&ce[Ie].state!==K.O.Alerting?ce[Ie].state=K.O.Alerting:ge===K.O.Pending&&ce[Ie].state!==K.O.Alerting&&ce[Ie].state!==K.O.Pending&&(ce[Ie].state=K.O.Pending):ce[Ie]={state:ge,id:Object.keys(ce).length,panelId:Ie,dashboardId:le.id}}})),{alertStates:Object.values(ce),annotations:[]}}),(0,D.W)(S.Zr))}}class te{constructor(de,le=(0,v.jG)(),he=[new q,new I.F,new N]){this.dashboard=de,this.timeSrv=le,this.workers=he,this.run=this.run.bind(this),this.getResult=this.getResult.bind(this),this.cancel=this.cancel.bind(this),this.destroy=this.destroy.bind(this),this.executeRun=this.executeRun.bind(this),this.results=new t.m(1),this.runs=new n.B,this.cancellationStream=new n.B,this.runsSubscription=this.runs.subscribe(ie=>this.executeRun(ie)),this.eventsSubscription=de.events.subscribe(p._,ie=>{this.run({dashboard:this.dashboard,range:this.timeSrv.timeRange()})})}run(de){this.runs.next(de)}getResult(de){return this.results.asObservable().pipe((0,g.T)(le=>{const he=(0,S.FK)(le.annotations,de),ie=le.alertStates.find(J=>!!de&&J.panelId===de);return{annotations:y(he),alertState:ie}}))}executeRun(de){const he=this.workers.filter(Pe=>Pe.canWork(de)).map(Pe=>Pe.work(de)),ie=new r.yU,J=(0,s.h)(he).pipe((0,i.Q)(this.runs.asObservable()),(0,l.U)(),(0,d.T)((Pe,Ie)=>(Pe.annotations=Pe.annotations.concat(Ie.annotations),Pe.alertStates=Pe.alertStates.concat(Ie.alertStates),Pe)),(0,o.j)(()=>{ie.unsubscribe()}),(0,u.u)()),ce=new r.yU,pe=(0,a.O)(200).pipe((0,c.u)({annotations:[],alertStates:[]}),(0,i.Q)(J),(0,o.j)(()=>{ce.unsubscribe()}));ce.add(pe.subscribe(Pe=>{this.results.next(Pe)})),ie.add(J.subscribe(Pe=>{this.results.next(Pe)}))}cancel(de){this.cancellationStream.next(de)}cancellations(){return this.cancellationStream.asObservable().pipe((0,u.u)())}destroy(){this.results.complete(),this.runs.complete(),this.cancellationStream.complete(),this.runsSubscription.unsubscribe(),this.eventsSubscription.unsubscribe()}}let X;function ee(se){X&&X.destroy(),X=se}function ne(){if(!X)throw new Error("getDashboardQueryRunner can only be used after Grafana instance has started.");return X}let Z;function ae(se){Z=se}function re(se){Z||(Z=({dashboard:le,timeSrv:he,workers:ie})=>new te(le,he,ie));const de=Z(se);return ee(de),de}},90569:(_,L,e)=>{"use strict";e.d(L,{X:()=>o});var t=e(62467),n=e(65474),r=e(40187),s=e(14236),a=e(17172),g=e(32264),i=e(57220),l=e(68706);const d="-- Public --";class o extends r.mA{constructor(){let c={};super({name:"public-ds",id:0,type:"public-ds",meta:c,uid:d,jsonData:{},access:"proxy",readOnly:!0}),this.annotations={prepareQuery(p){return{...p,queryType:l.nj.Annotations,refId:"anno"}}}}query(c){return c.targets.length?c.targets[0]?.datasource?.uid===i.vv?(0,n.H)(this.getAnnotations(c)):(0,t.of)({data:[]}):(0,t.of)({data:[]})}async getAnnotations(c){const{range:{to:p,from:h}}=c,y={from:h.valueOf(),to:p.valueOf()},f=await(0,a.AI)().get(`/api/public/dashboards/${g.$.publicDashboardAccessToken}/annotations`,y);return{data:[(0,s.Vc)(f)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}},85595:(_,L,e)=>{"use strict";e.d(L,{F:()=>r});var t=e(62467),n=e(7436);class r{canWork({dashboard:a}){return a?.annotations?.list?.some(g=>g.enable&&!!g.snapshotData)}work(a){if(!this.canWork(a))return(0,n.$)();const g=this.getAnnotationsFromSnapshot(a.dashboard);return(0,t.of)({annotations:g,alertStates:[]})}getAnnotationsFromSnapshot(a){return(a?.annotations?.list?.filter(d=>d.enable)).filter(d=>!!d.snapshotData).reduce((d,o)=>d.concat((0,n.G9)(o,o.snapshotData)),[])}getAnnotationsInSnapshot(a,g){const i=this.getAnnotationsFromSnapshot(a);return(0,n.FK)(i,g)}}},7436:(_,L,e)=>{"use strict";e.d(L,{$:()=>c,FK:()=>y,G9:()=>f,H:()=>v,H0:()=>u,SD:()=>o,Zr:()=>p});var t=e(2543),n=e.n(t),r=e(62467),s=e(78368),a=e(12091),g=e(32264),i=e(99140),l=e(3169),d=e(16001);function o(P){return P.cancelled?(0,r.of)([]):(h("AnnotationQueryRunner failed",P),(0,r.of)([]))}function u(P){return h("Failed to retrieve datasource",P),(0,r.of)(void 0)}const c=()=>(0,r.of)({annotations:[],alertStates:[]});function p(P){return P.cancelled||h("DashboardQueryRunner failed",P),c()}function h(P,m){const D=(0,a.u)(m);console.error("handleAnnotationQueryRunnerError",D);const x=(0,l.gi)(P,D.message);(0,i.JD)((0,d.dx)(x))}function y(P,m){return m==null?P:P.filter(D=>{let x;if(x=D.source,!x)return!0;if(x.filter){const E=(x.filter.ids??[]).includes(m);if(x.filter.exclude){if(E)return!1}else if(!E)return!1}return D.panelId&&D.source.type==="dashboard"?D.panelId===m:!0})}function f(P,m){P.snapshotData&&(P=(0,t.cloneDeep)(P),delete P.snapshotData);for(const D of m)switch(D.source=P,D.color=g.$.theme2.visualization.getColorByName(P.iconColor),D.type=P.name,D.isRegion=!!(D.timeEnd&&D.time!==D.timeEnd),D.newState?.toLowerCase()){case"pending":D.color="yellow";break;case"alerting":D.color="red";break;case"ok":D.color="green";break;case"normal":D.color="green";break;case"no_data":D.color="gray";break;case"nodata":D.color="gray";break}return m}function v(P){if(!P||!P.length)return[];const m=[];for(const D of P){const x=new s.R(D);for(let E=0;E<D.length;E++){const C=(0,t.cloneDeep)(x.get(E));m.push(C)}}return m}},80924:(_,L,e)=>{"use strict";e.d(L,{Z:()=>j,S:()=>O});var t=e(2543),n=e(39741),r=e(62467),s=e(69862),a=e(81160),g=e(66847),i=e(39070),l=e(14236),d=e(43127),o=e(90708),u=e(21423),c=e(52622),p=e(2514),h=e(41987),y=e(65879),f=e(12091),v=e(26657),P=e(47118),m=e(31193),D=e(23989),x=e(14348),E=e(42972),C=e(49510),b=e(33948);function T(N=[]){N.forEach(I=>{I.meta={...I.meta,dataTopic:c.QR.Annotations}})}function A(N,I){return(0,C.z)([N,I]).pipe((0,s.Z)(K=>{const[w,U]=K;if(U.annotations?.length||U.alertState){w.annotations||(w.annotations=[]);const W=w.annotations.concat((0,b.I)(U.annotations));T(W);const H=U.alertState;return(0,r.of)({...w,annotations:W,alertState:H})}return T(w.annotations),(0,r.of)(w)}))}var R=e(39374);let S=100;function O(){return"Q"+S++}class j{constructor(I){this.templateSrv=(0,D.w)(),this.resendLastResult=()=>{this.lastResult&&this.subject.next(this.lastResult)},this.subject=new n.m(1),this.dataConfigSource=I}getData(I){const{withFieldConfig:K,withTransforms:w}=I;let U=1,W,H=[],z=[],G,M=!0,Q=-1;if(this.dataConfigSource.snapshotData){const Y={state:i.Gu.Done,series:this.dataConfigSource.snapshotData.map(q=>(0,l.Vc)(q)),timeRange:(0,d.E2)(),structureRev:U};return(0,r.of)(Y)}return this.subject.pipe((0,s.Z)(Y=>{let q=this.dataConfigSource.getFieldOverrideOptions(),te=this.dataConfigSource.getTransformations();if(Y.series===z&&W?.fieldConfig===q?.fieldConfig&&G===te)return(0,r.of)({...Y,structureRev:U,series:H});W=q,G=te,z=Y.series;let X=(0,r.of)(Y);return w&&(X=this.applyTransformations(Y)),X.pipe((0,a.T)(ee=>{let ne=ee,Z=!1;if(K&&ee.series?.length){if(Q===this.dataConfigSource.configRev){let ae;for(const re of ee.series)if((0,P.o$)(re)){ae=re;break}ae&&!ae.packetInfo.schemaChanged&&H[0].fields.length===ae.fields.length&&(ne={...ne,series:H.map((re,se)=>({...re,length:ee.series[se].length,fields:re.fields.map((de,le)=>({...de,values:ee.series[se].fields[le].values,state:{...de.state,calcs:void 0,range:void 0}}))}))},Z=!0)}q!=null&&(M||!Z)&&(Q=this.dataConfigSource.configRev,ne={...ne,series:(0,o.we)({timeZone:ee.request?.timezone??"browser",data:ne.series,...q})},ne.annotations&&(ne.annotations=(0,o.we)({data:ne.annotations,...q,fieldConfig:{defaults:{},overrides:[]}})),M=!1)}return!Z&&!(0,u.J3)(H,ne.series,u.bW)&&U++,H=ne.series,{...ne,structureRev:U}}))}))}applyTransformations(I){const K=this.dataConfigSource.getTransformations();if(K&&K.every(M=>M.disabled)||!K||K.length===0)return(0,r.of)(I);const U={interpolate:M=>this.templateSrv.replace(M,I?.request?.scopedVars)};let W=K.filter(M=>M.topic==null||M.topic===c.QR.Series),H=K.filter(M=>M.topic===c.QR.Annotations),z=(0,p.m)(W,I.series,U),G=(0,p.m)(H,I.annotations??[],U);return(0,t.merge)(z,G).pipe((0,a.T)(M=>{let Y=M.some(q=>q.meta?.dataTopic===c.QR.Annotations)?{annotations:M}:{series:M};return{...I,...Y}}),(0,g.W)(M=>(console.warn("Error running transformation:",M),(0,r.of)({...I,state:i.Gu.Error,errors:[(0,f.u)(M)]}))))}async run(I){const{queries:K,timezone:w,datasource:U,panelId:W,panelPluginId:H,dashboardUID:z,timeRange:G,timeInfo:M,cacheTimeout:Q,queryCachingTTL:Y,maxDataPoints:q,scopedVars:te,minInterval:X,app:ee}=I;if((0,x.kN)(U)){this.pipeToSubject((0,x.mw)(I,K[0]),W,!0);return}const ne=this.shouldAddErrorWhenDatasourceVariableIsMultiple(U,te),Z={app:ee??h.Jk.Dashboard,requestId:O(),timezone:w,panelId:W,panelPluginId:H,dashboardUID:z,range:G,timeInfo:M,interval:"",intervalMs:0,targets:(0,t.cloneDeep)(K),maxDataPoints:q,scopedVars:te||{},cacheTimeout:Q,queryCachingTTL:Y,startTime:Date.now(),rangeRaw:G.raw};try{const ae=await B(U,Z.scopedVars),re=ae.meta?.mixed;Z.targets=Z.targets.map(le=>{const he=le.datasource?.type===v.dR.type;return(!le.datasource||le.datasource.uid!==ae.uid&&!re&&!he)&&(le.datasource=ae.getRef()),le});const se=X?this.templateSrv.replace(X,Z.scopedVars):ae.interval,de=y.calculateInterval(G,q,se);Z.scopedVars=Object.assign({},Z.scopedVars,{__interval:{text:de.interval,value:de.interval},__interval_ms:{text:de.intervalMs.toString(),value:de.intervalMs}}),Z.interval=de.interval,Z.intervalMs=de.intervalMs,Z.filters=this.templateSrv.getAdhocFilters(ae.name,!0),this.lastRequest=Z,this.pipeToSubject((0,R.BN)(ae,Z),W,!1,ne)}catch(ae){this.pipeToSubject((0,r.of)({state:i.Gu.Error,error:(0,f.u)(ae),series:[],timeRange:Z.range}),W)}}pipeToSubject(I,K,w=!1,U=!1){this.subscription&&this.subscription.unsubscribe();let W=I;const H=this.dataConfigSource.getDataSupport();if(H.alertStates||H.annotations){const z=this.dataConfigSource;W=A(I,(0,E.Dh)().getResult(z.id))}this.subscription=W.subscribe({next:z=>{const G=this.lastResult,M=w?z:(0,l.N$)(z,G);if(G!=null&&M.state!==i.Gu.Streaming){let Q=(0,u.J3)(G.series??[],M.series??[],(te,X)=>te===X),Y=(0,u.J3)(G.annotations??[],M.annotations??[],(te,X)=>te===X),q=G.state===M.state;if(Q&&(M.series=G.series),Y&&(M.annotations=G.annotations),Q&&Y&&q)return}this.lastResult=M,U&&(M.errors=[{message:"Panel is using a variable datasource with multiple values without repeat option. Please configure the panel to be repeated by the same datasource variable."}],M.state=i.Gu.Error),this.subject.next(M)}})}cancelQuery(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&(this.lastResult.state===i.Gu.Loading||this.lastResult.state===i.Gu.Streaming)&&this.subject.next({...this.lastResult,state:i.Gu.Done}))}clearLastResult(){this.lastResult=void 0,this.subject=new n.m(1)}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}useLastResultFrom(I){this.lastResult=I.getLastResult(),this.lastResult&&this.subject.next(this.lastResult)}setLastResult(I){this.lastResult=I}getLastResult(){return this.lastResult}getLastRequest(){return this.lastRequest}shouldAddErrorWhenDatasourceVariableIsMultiple(I,K){let w=!1;return I?.uid?.startsWith("${")&&this.templateSrv.replace(I.uid,K,U=>(Array.isArray(U)&&U.length>1&&(w=!0),"")),w}}async function B(N,I){return N&&typeof N=="object"&&"query"in N?N:await(0,m.tR)().get(N,I)}},81583:(_,L,e)=>{"use strict";e.d(L,{N:()=>n});var t=e(69850);function n(r,s){return(0,t.j)(()=>{s&&r.resolveCancelerIfExists(s)})}},72955:(_,L,e)=>{"use strict";e.d(L,{B:()=>n});var t=e(21423);const n=(r,s)=>{let a=1;return s?.structureRev&&s.series&&(a=s.structureRev,(0,t.J3)(r.series,s.series,t.bW)||a++),r.structureRev=a,r}},39374:(_,L,e)=>{"use strict";e.d(L,{BN:()=>I});var t=e(2543),n=e(62467),r=e(44240),s=e(39697),a=e(65474),g=e(81160),i=e(66847),l=e(59099),d=e(1005),o=e(65961),u=e(67791),c=e(39070),p=e(52622),h=e(85858),y=e(41987),f=e(12091),v=e(32264),P=e(26657),m=e(27677),D=e(21969),x=e(53478),E=e(34867);const C=(0,E.DW)("features.query");var b=e(81583),T=e(76885),A=e(61298),R=e(14110),S=e(14792);function O(w){let U=!1;return H=>{if(!H.request||U||T.kM.getUrlSearchParams().editPanel!=null||H.state!==c.Gu.Done&&H.state!==c.Gu.Error)return;const G={eventName:A.n_.DataRequest,source:H.request.app,datasourceName:w.name,datasourceId:w.id,datasourceUid:w.uid,datasourceType:w.type,dataSize:0,panelId:0,panelPluginId:H.request?.panelPluginId,duration:H.request.endTime-H.request.startTime};W(G,H),H.request.app!==y.Jk.Explore&&H.request.app!==y.Jk.Correlations&&j(G,H),H.series&&H.series.length>0&&(G.dataSize=H.series.length),(0,R.G$)(G),U=!0};function W(H,z){const G={};for(let Q=0;Q<z.series.length;Q++){const Y=z.series[Q].refId;Y&&!G[Y]&&(G[Y]=z.series[Q].meta?.isCachedResponse??!1)}H.totalQueries=Object.keys(G).length,H.cachedQueries=Object.values(G).filter(Q=>Q===!0).length,z.request&&Number.isInteger(z.request.panelId)&&(H.panelId=z.request.panelId);const M=(0,S.UA)().getCurrent();M&&(H.dashboardId=M.id,H.dashboardName=M.title,H.dashboardUid=M.uid,H.folderName=M.meta.folderTitle)}}function j(w,U){U.errors?.length?w.error=U.errors.join(", "):U.error&&(w.error=U.error.message)}function B(w,U){const W=U.panelData.request,H={...U.packets},z=w.key??w.data?.[0]?.refId??"A";H[z]=w;let G=w.state||c.Gu.Done,M,Q;const Y=[],q=[];for(const ne in H){const Z=H[ne];if((Z.error||Z.errors?.length)&&(G=c.Gu.Error,M=Z.error,Q=Z.errors),Z.data&&Z.data.length)for(const ae of Z.data){if(ae.meta?.dataTopic===p.QR.Annotations){q.push(ae);continue}Y.push(ae)}}const te=N(W,G),X={state:G,series:Y,annotations:q,error:M,errors:Q,request:W,timeRange:te},ee=new Set([...U.panelData.traceIds??[],...w.traceIds??[]]);return ee.size>0&&(X.traceIds=Array.from(ee)),{packets:H,panelData:X}}function N(w,U){const W=w.range;return!(0,t.isString)(W.raw.from)||U!==c.Gu.Streaming?W:{...W,from:h.parse(W.raw.from,!1),to:h.parse(W.raw.to,!0)}}function I(w,U,W){let H={panelData:{state:c.Gu.Loading,series:[],request:U,timeRange:U.range},packets:{}};if(!U.targets.length)return U.endTime=Date.now(),H.panelData.state=c.Gu.Done,(0,n.of)(H.panelData);const z=K(w,U,W).pipe((0,g.T)(G=>{if(!(0,t.map)(G.data))throw new Error(`Expected response data to be array, got ${typeof G.data}.`);const M=U.targets.filter(Q=>Q.hide);for(const Q of M)G.data=G.data.filter(Y=>Y.refId!==Q.refId);return U.endTime=Date.now(),H=B(G,H),H.panelData}),(0,i.W)(G=>(console.error("runRequest.catchError",G),C.logError(G),(0,n.of)({...H.panelData,state:c.Gu.Error,error:(0,f.u)(G)}))),(0,l.M)(O(w)),(0,b.N)(m.IB,U.requestId),(0,d.u)());return(0,r.h)((0,s.O)(200).pipe((0,o.u)(H.panelData),(0,u.Q)(z)),z)}function K(w,U,W){if(U.targets=U.targets.map(z=>(0,D.Ih)(z)?{...w?.getDefaultQuery?.(y.Jk.PanelEditor),...z}:z),v.$.publicDashboardAccessToken)return(0,a.H)(w.query(U));for(const z of U.targets)if((0,P.s9)(z.datasource))return x.Ex.query(U);if(W||(U.targets=U.targets.filter(z=>w.filterQuery?.(z)??!0)),U.targets.length===0)return(0,n.of)({data:[]});const H=W?W(U):w.query(U);return(0,a.H)(H)}},93117:(_,L,e)=>{"use strict";e.d(L,{y:()=>g});var t=e(41987),n=e(73372),r=e(77789),s=e(72574),a=e(26657);async function g(i,l,d,o){let u=d;const c={...i.getRef(),uid:l},p={...i?.getDefaultQuery?.(t.Jk.PanelEditor),datasource:c,refId:"A"};if(o?.meta.id!==i.meta.id){if(i.meta.mixed)return d;if((0,n.Ee)(o)&&(0,n.FL)(i)){const h=await o.exportToAbstractQueries(d);u=await i.importFromAbstractQueries(h)}else if(o&&i.importQueries)u=await i.importQueries(d,o);else{if(o){const h=(0,s.w)(),y=[];let f=i.uid;const v=h.containsTemplate(l);v&&(f=h.replace(i.uid));const P=d.reduce((m,D)=>{if(D.datasource){let x=D.datasource.uid;const E=h.containsTemplate(x);if(E&&(x=h.replace(D.datasource.uid)),x===f&&E===v)return D.refId=(0,r.M)(m),m.concat([D])}return m},y);if(P.length>0)return P}return[p]}}return u.length===0?[p]:u.map(h=>(!(0,a.s9)(h.datasource)&&!i.meta.mixed&&(h.datasource=c),h))}},53001:(_,L,e)=>{"use strict";e.d(L,{T3:()=>Ne,mN:()=>Xe,Dh:()=>ot,DF:()=>st,F_:()=>Ue,sq:()=>Ce,fX:()=>ft});var t=e(32264),n=e(81887),r=e(74848),s=e(32196),a=e(2543),g=e(40845),i=e(39558),l=e(40276),d=e(55852),o=e(8484),u=e(54625),c=e(76885),p=e(14578),h=e(83277);function y({dashboard:_e}){const et=(0,g.of)(f),[it]=(0,h.s)();return(0,r.jsxs)(u.Link,{to:c.kM.renderUrl(`/d/${_e.dashboard}/`,it),className:et.container,"data-testid":`scopes-dashboards-${_e.dashboard}`,role:"treeitem",children:[(0,r.jsx)(p.I,{name:"apps",className:et.icon})," ",_e.dashboardTitle]},_e.dashboard)}const f=_e=>({container:(0,s.css)({display:"flex",alignItems:"flex-start",gap:_e.spacing(1),padding:_e.spacing(.5,0),textAlign:"left",wordBreak:"break-word","&:last-child":(0,s.css)({paddingBottom:0})}),icon:(0,s.css)({marginTop:_e.spacing(.25)})});function v({folder:_e,folderPath:et,folders:it,onFolderUpdate:dt}){const ze=(0,g.of)(P);return(0,r.jsxs)("div",{className:ze.container,role:"treeitem","aria-selected":_e.isExpanded,children:[(0,r.jsxs)("button",{className:ze.expand,"data-testid":`scopes-dashboards-${_e.title}-expand`,"aria-label":_e.isExpanded?(0,o.t)("scopes.dashboards.collapse","Collapse"):(0,o.t)("scopes.dashboards.expand","Expand"),onClick:()=>{dt(et,!_e.isExpanded)},children:[(0,r.jsx)(p.I,{name:_e.isExpanded?"angle-down":"angle-right",className:ze.icon}),_e.title]}),_e.isExpanded&&(0,r.jsx)("div",{className:ze.children,children:(0,r.jsx)(m,{folders:it,folderPath:et,onFolderUpdate:dt})})]})}const P=_e=>({container:(0,s.css)({display:"flex",flexDirection:"column",padding:_e.spacing(.5,0)}),expand:(0,s.css)({alignItems:"flex-start",background:"none",border:0,display:"flex",gap:_e.spacing(1),margin:0,padding:0,textAlign:"left",wordBreak:"break-word"}),icon:(0,s.css)({marginTop:_e.spacing(.25)}),children:(0,s.css)({paddingLeft:_e.spacing(4)})});function m({folders:_e,folderPath:et,onFolderUpdate:it}){const dt=et[et.length-1],ze=_e[dt];return(0,r.jsxs)("div",{role:"tree",children:[Object.entries(ze.folders).map(([xe,Oe])=>(0,r.jsx)(v,{folder:Oe,folders:ze.folders,folderPath:[...et,xe],onFolderUpdate:it},xe)),Object.values(ze.dashboards).map(xe=>(0,r.jsx)(y,{dashboard:xe},xe.dashboard))]})}var D=e(96540),x=e(40996),E=e(67647);function C({disabled:_e,query:et,onChange:it}){const dt=(0,g.of)(b),[ze,xe]=(0,D.useState)({value:et,isDirty:!1}),[Oe]=(0,x.A)(()=>{ze.isDirty&&it(ze.value)},500,[ze.isDirty,ze.value]);return(0,D.useEffect)(()=>{(Oe()||!ze.isDirty)&&ze.value!==et&&xe({value:et,isDirty:!1})},[Oe,ze,et]),(0,r.jsx)("div",{className:dt.container,children:(0,r.jsx)(E.Z,{disabled:_e,placeholder:(0,o.t)("scopes.dashboards.search","Search"),value:ze.value,"data-testid":"scopes-dashboards-search",onChange:Le=>xe({value:Le,isDirty:!0})})})}const b=_e=>({container:(0,s.css)({flex:"0 1 auto"})});var T=e(17172),A=e(2468),R=(_e=>(_e[_e.Persisted=0]="Persisted",_e[_e.Result=1]="Result",_e))(R||{});function S(_e){return{metadata:{name:_e},spec:{filters:[],title:_e,type:"",category:"",description:""}}}function O(_e,et){return{..._e,metadata:{..._e.metadata,...et.metadata},spec:{..._e.spec,...et.spec}}}function j(_e){return _e.map(({scope:et,path:it})=>({scopeName:et.metadata.name,path:it}))}function B(_e){return _e.map(({scope:et})=>et)}function N(_e){return _e.map(({scope:et})=>et.metadata.name)}function I(_e){return _e.reduce((et,it)=>{const dt=et[""],ze=it.status.groups??[];return ze.forEach(Oe=>{Oe&&!dt.folders[Oe]&&(dt.folders[Oe]={title:Oe,isExpanded:!1,folders:{},dashboards:{}})}),(ze.length>0?ze.map(Oe=>Oe===""?dt.dashboards:dt.folders[Oe].dashboards):[dt.dashboards]).forEach(Oe=>{Oe[it.spec.dashboard]||(Oe[it.spec.dashboard]={dashboard:it.spec.dashboard,dashboardTitle:it.status.dashboardTitle,items:[]}),Oe[it.spec.dashboard].items.push(it)}),et},{"":{title:"",isExpanded:!0,folders:{},dashboards:{}}})}function K(_e,et){return et=(et??"").toLowerCase(),Object.entries(_e).reduce((it,[dt,ze])=>{if(ze.title.toLowerCase().includes(et))return it[dt]={...ze,isExpanded:!0},it;const xe=K(ze.folders,et),Oe=Object.entries(ze.dashboards).filter(([Le,Ze])=>Ze.dashboardTitle.toLowerCase().includes(et));return(Object.keys(xe).length>0||Oe.length>0)&&(it[dt]={...ze,isExpanded:!0,folders:xe,dashboards:Object.fromEntries(Oe)}),it},{})}const w="scope.grafana.app",U="v0alpha1",W=t.$.namespace??"default",H=`/apis/${w}/${U}/namespaces/${W}/find/scope_node_children`,z=`/apis/${w}/${U}/namespaces/${W}/find/scope_dashboard_bindings`,G=new A.w({group:w,version:U,resource:"scopes"}),M=new Map;async function Q(_e,et){try{return(await(0,T.AI)().get(H,{parent:_e,query:et}))?.items??[]}catch{return[]}}async function Y(_e,et){return(await Q(_e,et)).reduce((it,{metadata:{name:dt},spec:ze})=>(it[dt]={name:dt,...ze,isExpandable:ze.nodeType==="container",isSelectable:ze.linkType==="scope",isExpanded:!1,query:"",reason:R.Result,nodes:{}},it),{})}async function q(_e){if(M.has(_e))return M.get(_e);const et=new Promise(async it=>{const dt=S(_e);try{const ze=await G.get(_e),xe=O(dt,ze);it(xe)}catch{M.delete(_e),it(dt)}});return M.set(_e,et),et}async function te(_e){return await Promise.all(_e.map(q))}async function X(_e){return(await te(_e.map(({scopeName:it})=>it))).reduce((it,dt,ze)=>(it.push({scope:dt,path:_e[ze].path}),it),[])}async function ee(_e){try{return(await(0,T.AI)().get(z,{scope:_e}))?.items??[]}catch{return[]}}const ne="grafana.scopes.dashboards.opened",Z=()=>({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,isPanelOpened:localStorage.getItem(ne)==="true",isEnabled:!1,scopesSelected:!1,searchQuery:""});class ae extends n.Bs{static{this.Component=re}constructor(){super({selector:null,...Z()}),this.addActivationHandler(()=>{this.state.isEnabled&&this.state.isPanelOpened&&this.fetchDashboards();const et=this.state.selector?.resolve();et&&this._subs.add(et.subscribeToState((it,dt)=>{this.state.isEnabled&&this.state.isPanelOpened&&!it.isLoadingScopes&&(dt.isLoadingScopes||it.scopes!==dt.scopes)&&this.fetchDashboards()}))})}async fetchDashboards(){const et=N(this.state.selector?.resolve().state.scopes??[]);if((0,a.isEqual)(et,this.state.forScopeNames))return;if(et.length===0)return this.setState({dashboards:[],folders:{},filteredFolders:{},forScopeNames:[],isLoading:!1,scopesSelected:!1});this.setState({isLoading:!0});const it=await ee(et),dt=I(it),ze=K(dt,this.state.searchQuery);this.setState({dashboards:it,folders:dt,filteredFolders:ze,forScopeNames:et,isLoading:!1,scopesSelected:et.length>0})}changeSearchQuery(et){et=et??"",this.setState({filteredFolders:K(this.state.folders,et),searchQuery:et})}updateFolder(et,it){let dt={...this.state.folders},ze={...this.state.filteredFolders},xe=dt,Oe=ze;for(let rt=0;rt<et.length-1;rt++)xe=xe[et[rt]].folders,Oe=Oe[et[rt]].folders;const Le=et[et.length-1],Ze=xe[Le],qe=Oe[Le];Ze.isExpanded=it,qe.isExpanded=it,this.setState({folders:dt,filteredFolders:ze})}togglePanel(){this.state.isPanelOpened?this.closePanel():this.openPanel()}openPanel(){this.fetchDashboards(),this.setState({isPanelOpened:!0}),localStorage.setItem(ne,JSON.stringify(!0))}closePanel(){this.setState({isPanelOpened:!1}),localStorage.setItem(ne,JSON.stringify(!1))}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}}function re({model:_e}){const{dashboards:et,filteredFolders:it,isLoading:dt,isPanelOpened:ze,isEnabled:xe,searchQuery:Oe,scopesSelected:Le}=_e.useState(),Ze=(0,g.of)(se);if(!xe||!ze)return null;if(!dt)if(Le){if(et.length===0)return(0,r.jsx)("div",{className:(0,s.cx)(Ze.container,Ze.noResultsContainer),"data-testid":"scopes-dashboards-notFoundForScope",children:(0,r.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForScopes",children:"No dashboards found for the selected scopes"})})}else return(0,r.jsx)("div",{className:(0,s.cx)(Ze.container,Ze.noResultsContainer),"data-testid":"scopes-dashboards-notFoundNoScopes",children:(0,r.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsNoScopes",children:"No scopes selected"})});return(0,r.jsxs)("div",{className:Ze.container,"data-testid":"scopes-dashboards-container",children:[(0,r.jsx)(C,{disabled:dt,query:Oe,onChange:qe=>_e.changeSearchQuery(qe)}),dt?(0,r.jsx)(i._,{className:Ze.loadingIndicator,text:(0,o.t)("scopes.dashboards.loading","Loading dashboards"),"data-testid":"scopes-dashboards-loading"}):it[""]?(0,r.jsx)(l.E,{children:(0,r.jsx)(m,{folders:it,folderPath:[""],onFolderUpdate:(qe,rt)=>_e.updateFolder(qe,rt)})}):(0,r.jsxs)("p",{className:Ze.noResultsContainer,"data-testid":"scopes-dashboards-notFoundForFilter",children:[(0,r.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForFilter",children:"No results found for your query"}),(0,r.jsx)(d.$n,{variant:"secondary",onClick:()=>_e.changeSearchQuery(""),"data-testid":"scopes-dashboards-notFoundForFilter-clear",children:(0,r.jsx)(o.x6,{i18nKey:"scopes.dashboards.noResultsForFilterClear",children:"Clear search"})})]})]})}const se=_e=>({container:(0,s.css)({backgroundColor:_e.colors.background.primary,borderRight:`1px solid ${_e.colors.border.weak}`,display:"flex",flexDirection:"column",height:"100%",gap:_e.spacing(1),padding:_e.spacing(2),width:_e.spacing(37.5)}),noResultsContainer:(0,s.css)({alignItems:"center",display:"flex",flexDirection:"column",gap:_e.spacing(1),height:"100%",justifyContent:"center",margin:0,textAlign:"center"}),loadingIndicator:(0,s.css)({alignSelf:"center"})});var de=e(65474),le=e(69850),he=e(29158),ie=e(87978),J=e(62930),ce=e(76888),pe=e(10354),Pe=e(56034);function Ie({nodes:_e,scopes:et,isDisabled:it,isLoading:dt,onInputClick:ze,onRemoveAllClick:xe}){const Oe=(0,g.of)(ge),[Le,Ze]=(0,D.useState)(!1);(0,D.useEffect)(()=>{Ze(!1)},[et]);const qe=(0,D.useMemo)(()=>{const Ot=et.map(({scope:zt,path:qt})=>{let fn=_e,Sn;qt.length>0?(Sn=qt.reduce((Hn,es)=>{const rs=fn[es];if(!rs)return Hn;const{title:Zn,nodes:kn}=rs;return fn=kn,Hn.push(Zn),Hn},[]),Sn[0]===""&&Sn.splice(0,1)):Sn=[zt.spec.title];const An=Sn.pop();return[Sn.join(" > "),An]}),jt=(0,a.groupBy)(Ot,([zt])=>zt),Ut=Object.entries(jt).map(([zt,qt])=>{const fn=qt.map(([,Sn])=>Sn).join(", ");return(zt?[zt,fn]:[fn]).join(" > ")}).map(zt=>(0,r.jsx)("p",{className:Oe.scopePath,children:zt},zt));return(0,r.jsx)(r.Fragment,{children:Ut})},[_e,et,Oe]),rt=(0,D.useMemo)(()=>et.map(({scope:Ot})=>Ot.spec.title).join(", "),[et]),vt=(0,D.useMemo)(()=>(0,r.jsx)(pe.p,{readOnly:!0,placeholder:(0,o.t)("scopes.selector.input.placeholder","Select scopes..."),disabled:it,loading:dt,value:rt,"aria-label":(0,o.t)("scopes.selector.input.placeholder","Select scopes..."),"data-testid":"scopes-selector-input",suffix:et.length>0&&!it?(0,r.jsx)(he.K,{"aria-label":(0,o.t)("scopes.selector.input.removeAll","Remove all scopes"),name:"times",onClick:()=>xe()}):void 0,onMouseOver:()=>Ze(!0),onMouseOut:()=>Ze(!1),onClick:()=>{it||ze()}}),[it,dt,ze,xe,et,rt]);return(0,r.jsx)(Pe.m,{content:qe,show:et.length===0?!1:Le,children:vt})}const ge=_e=>({scopePath:(0,s.css)({color:_e.colors.text.primary,fontSize:_e.typography.pxToRem(12),margin:_e.spacing(0,0)})});function Se({anyChildExpanded:_e,query:et,resultsNodes:it}){const dt=(0,g.of)(De);return _e?null:(0,r.jsx)("h6",{className:dt.container,"data-testid":"scopes-tree-headline",children:et?it.length===0?(0,r.jsx)(o.x6,{i18nKey:"scopes.tree.headline.noResults",children:"No results found for your query"}):(0,r.jsx)(o.x6,{i18nKey:"scopes.tree.headline.results",children:"Results"}):(0,r.jsx)(o.x6,{i18nKey:"scopes.tree.headline.recommended",children:"Recommended"})})}const De=_e=>({container:(0,s.css)({color:_e.colors.text.secondary,margin:_e.spacing(1,0)})});var Ke=e(79569),Me=e(10880);function be({anyChildExpanded:_e,loadingNodeName:et,node:it,nodePath:dt,nodes:ze,scopeNames:xe,scopes:Oe,type:Le,onNodeSelectToggle:Ze,onNodeUpdate:qe}){const rt=(0,g.of)(we);return(0,r.jsx)("div",{role:"tree",children:ze.map(vt=>{const Ot=vt.isSelectable&&xe.includes(vt.linkId);if(_e&&!vt.isExpanded)return null;const jt=[...dt,vt.name],Ut=jt.join(".");return(0,r.jsxs)("div",{role:"treeitem","aria-selected":vt.isExpanded,children:[(0,r.jsxs)("div",{className:rt.title,children:[vt.isSelectable&&!vt.isExpanded?it.disableMultiSelect?(0,r.jsx)(Ke.J,{id:Ut,name:Ut,checked:Ot,label:"","data-testid":`scopes-tree-${Le}-${vt.name}-radio`,onClick:()=>{Ze(jt)}}):(0,r.jsx)(Me.S,{checked:Ot,"data-testid":`scopes-tree-${Le}-${vt.name}-checkbox`,onChange:()=>{Ze(jt)}}):null,vt.isExpandable?(0,r.jsxs)("button",{className:rt.expand,"data-testid":`scopes-tree-${Le}-${vt.name}-expand`,"aria-label":vt.isExpanded?(0,o.t)("scopes.tree.collapse","Collapse"):(0,o.t)("scopes.tree.expand","Expand"),onClick:()=>{qe(jt,!vt.isExpanded,vt.query)},children:[(0,r.jsx)(p.I,{name:vt.isExpanded?"angle-down":"angle-right"}),vt.title]}):(0,r.jsx)("span",{"data-testid":`scopes-tree-${Le}-${vt.name}-title`,children:vt.title})]}),(0,r.jsx)("div",{className:rt.children,children:vt.isExpanded&&(0,r.jsx)(pt,{nodes:it.nodes,nodePath:jt,loadingNodeName:et,scopes:Oe,onNodeUpdate:qe,onNodeSelectToggle:Ze})})]},vt.name)})})}const we=_e=>({title:(0,s.css)({alignItems:"center",display:"flex",gap:_e.spacing(1),fontSize:_e.typography.pxToRem(14),lineHeight:_e.typography.pxToRem(22),padding:_e.spacing(.5,0),"& > label":(0,s.css)({gap:0})}),expand:(0,s.css)({alignItems:"center",background:"none",border:0,display:"flex",gap:_e.spacing(1),margin:0,padding:0}),children:(0,s.css)({paddingLeft:_e.spacing(4)})});var Be=e(70255);function He({children:_e,isNodeLoading:et}){const it=(0,g.of)(Ve);return et?(0,r.jsx)(Be.A,{count:5,className:it.loader}):_e}const Ve=_e=>({loader:(0,s.css)({margin:_e.spacing(.5,0)})});function Je({anyChildExpanded:_e,nodePath:et,query:it,onNodeUpdate:dt}){const ze=(0,g.of)(nt),[xe,Oe]=(0,D.useState)({value:it,isDirty:!1});return(0,D.useEffect)(()=>{!xe.isDirty&&xe.value!==it&&Oe({value:it,isDirty:!1})},[xe,it]),(0,x.A)(()=>{xe.isDirty&&dt(et,!0,xe.value)},500,[xe.isDirty,xe.value]),_e?null:(0,r.jsx)(E.Z,{placeholder:(0,o.t)("scopes.tree.search","Search"),value:xe.value,className:ze.input,"data-testid":"scopes-tree-search",onChange:Le=>{Oe({value:Le,isDirty:!0})}})}const nt=_e=>({input:(0,s.css)({margin:_e.spacing(1,0)})});function pt({nodes:_e,nodePath:et,loadingNodeName:it,scopes:dt,onNodeUpdate:ze,onNodeSelectToggle:xe}){const Oe=et[et.length-1],Le=_e[Oe],Ze=Object.values(Le.nodes),qe=it===Oe,rt=dt.map(({scopeName:jt})=>jt),vt=Ze.some(({isExpanded:jt})=>jt),Ot=(0,D.useMemo)(()=>(0,a.groupBy)(Ze,"reason"),[Ze]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Je,{anyChildExpanded:vt,nodePath:et,query:Le.query,onNodeUpdate:ze}),(0,r.jsxs)(He,{isNodeLoading:qe,children:[(0,r.jsx)(be,{anyChildExpanded:vt,isNodeLoading:qe,loadingNodeName:it,node:Le,nodePath:et,nodes:Ot[R.Persisted]??[],scopes:dt,scopeNames:rt,type:"persisted",onNodeSelectToggle:xe,onNodeUpdate:ze}),(0,r.jsx)(Se,{anyChildExpanded:vt,query:Le.query,resultsNodes:Ot[R.Result]??[]}),(0,r.jsx)(be,{anyChildExpanded:vt,isNodeLoading:qe,loadingNodeName:it,node:Le,nodePath:et,nodes:Ot[R.Result]??[],scopes:dt,scopeNames:rt,type:"result",onNodeSelectToggle:xe,onNodeUpdate:ze})]})]})}const bt={nodes:{"":{name:"",reason:R.Result,nodeType:"container",title:"",isExpandable:!0,isSelectable:!1,isExpanded:!0,query:"",nodes:{}}},loadingNodeName:void 0,scopes:[],treeScopes:[],isReadOnly:!1,isLoadingScopes:!1,isPickerOpened:!1,isEnabled:!1};class Tt extends n.Bs{constructor(){super({dashboards:null,...bt}),this._urlSync=new n.So(this,{keys:["scopes"]}),this.addActivationHandler(()=>(this.fetchBaseNodes(),()=>{this.nodesFetchingSub?.unsubscribe()}))}static{this.Component=ye}getUrlState(){return{scopes:this.state.isEnabled?N(this.state.scopes):[]}}updateFromUrl(et){let it=et.scopes??[];it=Array.isArray(it)?it:[it],this.updateScopes(it.map(dt=>({scopeName:dt,path:[]})))}fetchBaseNodes(){return this.updateNode([""],!0,"")}async updateNode(et,it,dt){this.nodesFetchingSub?.unsubscribe();let ze={...this.state.nodes},xe=ze;for(let qe=0;qe<et.length-1;qe++)xe=xe[et[qe]].nodes;const Oe=et[et.length-1],Le=xe[Oe],Ze=Le.query!==dt;Le.isExpanded=it,Le.query=dt,it||Ze?(this.setState({nodes:ze,loadingNodeName:Oe}),this.nodesFetchingSub=(0,de.H)(Y(Oe,dt)).pipe((0,le.j)(()=>{this.setState({loadingNodeName:void 0})})).subscribe(qe=>{const rt=this.state.treeScopes.map(({path:vt})=>vt[vt.length-1]).filter(vt=>vt in Le.nodes&&!(vt in qe)).reduce((vt,Ot)=>(vt[Ot]={...Le.nodes[Ot],reason:R.Persisted},vt),{});Le.nodes={...rt,...qe},this.setState({nodes:ze}),this.nodesFetchingSub?.unsubscribe()})):this.setState({nodes:ze,loadingNodeName:void 0})}toggleNodeSelect(et){let it=[...this.state.treeScopes],dt=this.state.nodes[""];for(let Le=1;Le<et.length-1;Le++)dt=dt.nodes[et[Le]];const ze=et[et.length-1],{linkId:xe}=dt.nodes[ze],Oe=it.findIndex(({scopeName:Le})=>Le===xe);if(Oe===-1){q(xe);const Le=it.length===0||Object.values(dt.nodes).some(({linkId:qe})=>qe===it[0].scopeName),Ze={scopeName:xe,path:et};this.setState({treeScopes:dt?.disableMultiSelect||!Le?[Ze]:[...it,Ze]})}else it.splice(Oe,1),this.setState({treeScopes:it})}openPicker(){if(!this.state.isReadOnly){let et={...this.state.nodes};et=this.closeNodes(et);let it=[...this.state.scopes[0]?.path??["",""]];it.splice(it.length-1,1),et=this.expandNodes(et,it),this.setState({isPickerOpened:!0,nodes:et})}}closePicker(){this.setState({isPickerOpened:!1})}async updateScopes(et=this.state.treeScopes){if((0,a.isEqual)(et,j(this.state.scopes)))return;this.setState({scopes:et.map(({scopeName:dt,path:ze})=>({scope:S(dt),path:ze})),treeScopes:et,isLoadingScopes:!0});const it=await X(et);this.setState({scopes:it,isLoadingScopes:!1})}resetDirtyScopeNames(){this.setState({treeScopes:j(this.state.scopes)})}removeAllScopes(){this.setState({scopes:[],treeScopes:[],isLoadingScopes:!1})}enterReadOnly(){this.setState({isReadOnly:!0,isPickerOpened:!1})}exitReadOnly(){this.setState({isReadOnly:!1})}enable(){this.setState({isEnabled:!0})}disable(){this.setState({isEnabled:!1})}closeNodes(et){return Object.entries(et).reduce((it,[dt,ze])=>(it[dt]={...ze,isExpanded:!1,nodes:this.closeNodes(ze.nodes)},it),{})}expandNodes(et,it){et={...et};let dt=et;for(let ze=0;ze<it.length;ze++){const xe=it[ze];dt[xe]={...dt[xe],isExpanded:!0},dt=dt[xe].nodes}return et}}function ye({model:_e}){const{chrome:et}=(0,ce.Il)(),it=et.useState(),dt=!it.chromeless&&it.megaMenuDocked&&it.megaMenuOpen,ze=(0,g.of)(je,dt),{dashboards:xe,nodes:Oe,loadingNodeName:Le,scopes:Ze,treeScopes:qe,isReadOnly:rt,isLoadingScopes:vt,isPickerOpened:Ot,isEnabled:jt}=_e.useState(),Ut=xe?.resolve(),{isPanelOpened:zt}=Ut?.useState()??{};if(!jt)return null;const qt=rt?(0,o.t)("scopes.dashboards.toggle.disabled","Suggested dashboards list is disabled due to read only mode"):zt?(0,o.t)("scopes.dashboards.toggle.collapse","Collapse suggested dashboards list"):(0,o.t)("scopes.dashboards.toggle..expand","Expand suggested dashboards list");return(0,r.jsxs)("div",{className:ze.container,children:[(0,r.jsx)(he.K,{name:"dashboard",className:ze.dashboards,"aria-label":qt,tooltip:qt,"data-testid":"scopes-dashboards-expand",disabled:rt,onClick:()=>Ut?.togglePanel()}),(0,r.jsx)(Ie,{nodes:Oe,scopes:Ze,isDisabled:rt,isLoading:vt,onInputClick:()=>_e.openPicker(),onRemoveAllClick:()=>_e.removeAllScopes()}),Ot&&(0,r.jsxs)(ie._,{title:(0,o.t)("scopes.selector.title","Select scopes"),size:"sm",onClose:()=>{_e.closePicker(),_e.resetDirtyScopeNames()},children:[vt?(0,r.jsx)(J.y,{"data-testid":"scopes-selector-loading"}):(0,r.jsx)(pt,{nodes:Oe,nodePath:[""],loadingNodeName:Le,scopes:qe,onNodeUpdate:(fn,Sn,An)=>_e.updateNode(fn,Sn,An),onNodeSelectToggle:fn=>_e.toggleNodeSelect(fn)}),(0,r.jsxs)("div",{className:ze.buttonGroup,children:[(0,r.jsx)(d.$n,{variant:"primary","data-testid":"scopes-selector-apply",onClick:()=>{_e.closePicker(),_e.updateScopes()},children:(0,r.jsx)(o.x6,{i18nKey:"scopes.selector.apply",children:"Apply"})}),(0,r.jsx)(d.$n,{variant:"secondary","data-testid":"scopes-selector-cancel",onClick:()=>{_e.closePicker(),_e.resetDirtyScopeNames()},children:(0,r.jsx)(o.x6,{i18nKey:"scopes.selector.cancel",children:"Cancel"})})]})]})]})}const je=(_e,et)=>({container:(0,s.css)({display:"flex",flexDirection:"row",paddingLeft:et?_e.spacing(2):"unset",...!t.$.featureToggles.singleTopNav&&{paddingLeft:_e.spacing(2),borderLeft:`1px solid ${_e.colors.border.weak}`}}),dashboards:(0,s.css)({color:_e.colors.text.secondary,marginRight:_e.spacing(2),"&:hover":(0,s.css)({color:_e.colors.text.primary})}),buttonGroup:(0,s.css)({display:"flex",gap:_e.spacing(1),marginTop:_e.spacing(8)})});let ue=null,Ee=null;function Ce(){t.$.featureToggles.scopeFilters&&(Ee=new Tt,ue=new ae,Ee.setState({dashboards:ue.getRef()}),ue.setState({selector:Ee.getRef()}),new n.g5().initSync(Ee))}function Ne(){return ue?(0,r.jsx)(ue.Component,{model:ue}):null}function Fe(){return B(Ee?.state.scopes??[])}function Ue(){return Fe().map(_e=>_e.metadata.name)}function fe(){Ee?.enable(),ue?.enable()}function Te(){Ee?.disable(),ue?.disable()}function Ge(){Ee?.exitReadOnly(),ue?.enable()}function Qe(){Ee?.enterReadOnly(),ue?.disable()}function st(_e){return n.jh.findObject(_e,et=>et instanceof Xe)}class Xe extends n.Bs{constructor(et){super(et),this._activationHandler=()=>(this.enable(),this._subs.add(Ee?.subscribeToState((it,dt)=>{!it.isLoadingScopes&&(dt.isLoadingScopes||!(0,a.isEqual)(it.scopes,dt.scopes))&&this.state.handler?.(this)})),()=>{this.disable()}),this.addActivationHandler(this._activationHandler)}get value(){return Fe()}enable(){fe()}disable(){Te()}enterReadOnly(){Qe()}exitReadOnly(){Ge()}}function ot(){return Ee?(0,r.jsx)(Ee.Component,{model:Ee}):null}const ft=()=>ue?.useState()},53477:(_,L,e)=>{"use strict";e.d(L,{G3:()=>g,TF:()=>d,XJ:()=>h,YU:()=>c,d7:()=>u,if:()=>y,r4:()=>a,w7:()=>p});var t=e(64161);const n=null,r=58,s=8,a={label:"A\u2013Z",value:"alpha-asc"},g="search.sections",i="grafana.search.expanded-folder",l=0,d="general",o="Dashboards",u="grafana.search.include.panels",c="grafana.search.layout",p="grafana.search.sort",h={dashboard:t.G.DashDB,folder:t.G.DashFolder,home:t.G.DashHome},y=1e3},97427:(_,L,e)=>{"use strict";e.d(L,{d:()=>a,n:()=>g});var t=e(96540),n=e(13752),r=e(71733),s=e(39601);function a(){const i=(0,t.useRef)(new n.B);return{keyboardEvents:i.current,onKeyDown:l=>{switch(l.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":case"Enter":i.current.next(l);default:}}}}function g(i,l,d){const o=(0,t.useRef)({x:0,y:-1}),[u,c]=(0,t.useState)({x:0,y:-1}),p=(0,t.useRef)();return(0,t.useEffect)(()=>{p.current=d.view.fields.url,o.current.x=0,o.current.y=-1,c({...o.current})},[d]),(0,t.useEffect)(()=>{const h=i.subscribe({next:y=>{switch(y?.code){case"ArrowDown":{o.current.y++,c({...o.current});break}case"ArrowUp":o.current.y=Math.max(0,o.current.y-1),c({...o.current});break;case"ArrowRight":{l>0&&(o.current.x=Math.min(l,o.current.x+1),c({...o.current}));break}case"ArrowLeft":{l>0&&(o.current.x=Math.max(0,o.current.x-1),c({...o.current}));break}case"Enter":if(!p.current)break;const f=o.current.x*l+o.current.y;if(f<0){o.current.x=0,o.current.y=0,c({...o.current});break}const v=p.current.values?.[f];typeof v=="string"&&s.Ny.push(r.I.stripBaseFromUrl(v))}}});return()=>h.unsubscribe()},[i,l]),u}},6204:(_,L,e)=>{"use strict";e.d(L,{B9:()=>g,J$:()=>s,KZ:()=>a,MK:()=>r,Pf:()=>n});var t=e(14110);const n=(l,d)=>{(0,t.rR)(`${l}_viewed`,i(d))},r=(l,d)=>{(0,t.rR)(`${l}_result_clicked`,i(d))},s=(l,d)=>{(0,t.rR)(`${l}_query_submitted`,i(d))},a=(l,{error:d,...o})=>{(0,t.rR)(`${l}_query_failed`,{...i(o),error:d})},g=(l,d,o)=>{(0,t.rR)(`grafana_panel_inspect_${l}_${d}_clicked`,o)},i=l=>({layout:l.layout,starredFilter:l.starred??!1,sort:l.sortValue??"",tagCount:l.tagCount??0,queryLength:l.query?.length??0,includePanels:l.includePanels??!1,deleted:l.deleted??!1})},65812:(_,L,e)=>{"use strict";e.d(L,{getGrafanaSearcher:()=>w});var t=e(32264),n=e(78368),r=e(14236),s=e(57875),a=e(17172),g=e(40957);const i="Loading",l="api/search-v2",d="name_sort";class o{constructor(W){this.fallbackSearcher=W}async search(W){if(W.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(W)}async starred(W){if(W.facet?.length)throw new Error("facets not supported!");const H=await(0,a.AI)().get("api/user/stars");return H?.length?this.doSearchQuery({uid:H,query:W.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(z,G)=>{},isItemLoaded:z=>!0}}async tags(W){const H={...W,query:W.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},G=(await(0,a.AI)().post(l,H)).frames.map(M=>(0,r.Vc)(M));if(G[0]?.name===i)return this.fallbackSearcher.tags(W);for(const M of G)if(M.fields[0].name==="tag")return p(M);return[]}getSortOptions(){const W=[{value:d,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const H of h)W.push({value:`-${H.name}`,label:`${H.display} (most)`}),W.push({value:`${H.name}`,label:`${H.display} (least)`});for(const H of y)W.push({value:`-${H.name}`,label:`${H.display} (recent)`}),W.push({value:`${H.name}`,label:`${H.display} (oldest)`})}return Promise.resolve(W)}async doSearchQuery(W){W=await(0,g.u4)(W);const H={...W,query:W.query??"*",limit:W.limit??u},G=(await(0,a.AI)().post(l,H)).frames.map(ee=>(0,r.Vc)(ee)),M=G.length?(0,r.Vc)(G[0]):{fields:[],length:0};if(M.name===i)return this.fallbackSearcher.search(W);for(const ee of M.fields)ee.display=(0,s.J)({field:ee,theme:t.$.theme2});M.meta?.custom||(M.meta={...M.meta,custom:{count:M.length,max_score:1}});const Q=M.meta.custom;if(Q.locationInfo||(Q.locationInfo={}),Q.sortBy?.length){const ee=M.fields.find(ne=>ne.name===Q.sortBy);if(ee){const ne=f(ee.name);Q.sortBy=ne,ee.name=ne}}let Y=0,q;const te=async()=>{for(;Y>X.dataFrame.length;){const ee=X.dataFrame.length;if(ee>=Q.count)return;const ne=await(0,a.AI)().post(l,{...H??{},from:ee,limit:c}),Z=(0,r.Vc)(ne.frames[0]);if(!Z){console.log("no results",Z);return}if(Z.fields.length!==X.dataFrame.fields.length){console.log("invalid shape",Z,X.dataFrame);return}const ae=Z.length+X.dataFrame.length;for(let se=0;se<Z.fields.length;se++)X.dataFrame.fields[se].values.push(...Z.fields[se].values);X.dataFrame.length=ae;const re=Z.meta?.custom;if(re?.locationInfo&&Q)for(const[se,de]of Object.entries(re.locationInfo))Q.locationInfo[se]=de}q=void 0},X=new n.R(M);return{totalRows:Q.count??M.length,view:X,loadMoreItems:async(ee,ne)=>(Y=Math.max(Y,ne),q||(q=te()),q),isItemLoaded:ee=>ee<X.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const u=50,c=100;function p(U){const W=U.fields[0].values,H=U.fields[1].values,z=[];for(let G=0;G<U.length;G++)z.push({term:W[G],count:H[G]});return z}const h=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],y=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function f(U){for(const W of h)if(W.name===U)return W.display;for(const W of y)if(W.name===U)return W.display;return U}var v=e(53076);class P{constructor(W){this.parent=W,this.cache=new Map,this.sortPlaceholder="Default (Relevance)"}async search(W){if(W.facet?.length)throw new Error("facets not supported!");if(W.sort!=null)throw new Error("custom sorting is not supported yet");if(W.tags?.length||W.ds_uid?.length)return this.parent.search(W);const z=(await this.getCache(W.kind)).search(W.query);return{isItemLoaded:()=>!0,loadMoreItems:async(G,M)=>{},totalRows:z.length,view:z}}async getCache(W){const H=W?W.sort().join(","):"*",z=this.cache.get(H);if(z)try{return await z}catch{return this.cache.delete(H),new m(new n.R({name:"error",fields:[],length:0}))}const G=this.parent.search({kind:W,limit:5e3}).then(M=>new m(M.view));return this.cache.set(H,G),G}async starred(W){return this.parent.starred(W)}async getSortOptions(){return this.parent.getSortOptions()}async tags(W){return this.parent.tags(W)}getFolderViewSort(){return this.parent.getFolderViewSort()}}class m{constructor(W){this.full=W,this.ufuzzy=new v.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),this.names=this.full.fields.name.values,this.empty=new n.R({...this.full.dataFrame,fields:this.full.dataFrame.fields.map(H=>({...H,values:[]})),length:0})}search(W){if(!W?.length||W==="*")return this.full;const H=this.full.dataFrame.fields,z=this.names,G=H.map(q=>[]);let[M,Q,Y]=this.ufuzzy.search(z,W,5);for(let q=0;q<H.length;q++){let te=H[q].values,X=G[q];if(Q&&Y)for(let ee=0;ee<Y.length;ee++){let ne=Q.idx[Y[ee]];X.push(te[ne])}else if(M)for(let ee=0;ee<M.length;ee++){let ne=M[ee];X.push(te[ne])}}return this.empty.dataFrame.fields.forEach((q,te)=>{q.values=G[te]}),this.empty.dataFrame.length=this.empty.dataFrame.fields[0].values.length,this.empty}}var D=e(11261),x=e(27677),E=e(53477);class C{constructor(){this.locationInfo={general:{kind:"folder",name:"Dashboards",url:"/dashboards"}},this.getFolderViewSort=()=>""}async composeQuery(W,H){const z=await(0,g.u4)(H);return z.query?.length&&z.query!=="*"&&(W.query=z.query),z.kind?.length===1&&E.XJ[z.kind[0]]&&(W.type=E.XJ[z.kind[0]]),z.uid?W.dashboardUID=z.uid:z.location?.length&&(W.folderUIDs=[z.location]),W}async search(W){if(W.facet?.length)throw new Error("facets not supported!");if(W.from!==void 0){if(!W.limit)throw new Error("Must specify non-zero limit parameter when using from");if(W.from/W.limit%1!==0)throw new Error("From parameter must be a multiple of limit")}const H=W.limit??(W.from!==void 0?1:E.if),z=W.from!==void 0?W.from/H+1:void 0,G=await this.composeQuery({limit:H,tag:W.tags,sort:W.sort,permission:W.permission,page:z,deleted:W.deleted},W);return this.doAPIQuery(G)}async starred(W){if(W.facet?.length)throw new Error("facets not supported!");const H=await this.composeQuery({limit:W.limit??E.if,tag:W.tags,sort:W.sort,starred:W.starred},W);return this.doAPIQuery(H)}async getSortOptions(){return(await x.IB.get("/api/search/sorting")).sortOptions.map(H=>({value:H.name,label:H.displayName}))}async tags(W){return(await x.IB.get("/api/dashboards/tags")).sort((z,G)=>G.count-z.count)}async doAPIQuery(W){const H=await x.IB.get("/api/search",W),z=[],G=[],M=[],Q=[],Y=[],q=[],te=[],X=[],ee=[];let ne;for(let re of H){const se=re.type==="dash-folder"?"folder":"dashboard";z.push(se),G.push(re.title),M.push(re.uid),Q.push(re.url),Y.push(re.tags),te.push(re.sortMeta),X.push(re.isDeleted??!1),ee.push(re.permanentlyDeleteDate?new Date(re.permanentlyDeleteDate):void 0);let de=re.folderUid;!de&&se==="dashboard"&&(de=E.TF),q.push(de),re.sortMetaName?.length&&(ne=re.sortMetaName),re.folderUid&&re.folderTitle?this.locationInfo[re.folderUid]={kind:"folder",name:re.folderTitle,url:re.folderUrl,folderUid:re.folderUid}:se==="folder"&&(this.locationInfo[re.uid]={kind:se,name:re.title,url:re.url,folderUid:re.folderUid})}const Z={fields:[{name:"kind",type:D.PU.string,config:{},values:z},{name:"name",type:D.PU.string,config:{},values:G},{name:"uid",type:D.PU.string,config:{},values:M},{name:"url",type:D.PU.string,config:{},values:Q},{name:"tags",type:D.PU.other,config:{},values:Y},{name:"location",type:D.PU.string,config:{},values:q},{name:"isDeleted",type:D.PU.boolean,config:{},values:X},{name:"permanentlyDeleteDate",type:D.PU.time,config:{},values:ee}],length:G.length,meta:{custom:{count:G.length,max_score:1,locationInfo:this.locationInfo}}};ne?.length&&te.length&&(Z.meta.custom.sortBy=ne,Z.fields.push({name:ne,type:D.PU.number,config:{},values:te}));for(const re of Z.fields)re.display=(0,s.J)({field:re,theme:t.$.theme2});const ae=new n.R(Z);return{totalRows:Z.length,view:ae,loadMoreItems:async(re,se)=>{},isItemLoaded:re=>!0}}}const b="Loading",T="api/unified-search",A="name_sort";class R{constructor(W){this.fallbackSearcher=W}async search(W){if(W.facet?.length)throw new Error("facets not supported!");return this.doSearchQuery(W)}async starred(W){if(W.facet?.length)throw new Error("facets not supported!");const H=await(0,a.AI)().get("api/user/stars");return H?.length?this.doSearchQuery({uid:H,query:W.query??"*"}):{view:new n.R({length:0,fields:[]}),totalRows:0,loadMoreItems:async(z,G)=>{},isItemLoaded:z=>!0}}async tags(W){const H={...W,query:W.query??"*",sort:void 0,facet:[{field:"tag"}],limit:1},G=(await(0,a.AI)().post(T,H)).frames.map(M=>(0,r.Vc)(M));if(G[0]?.name===b)return this.fallbackSearcher.tags(W);for(const M of G)if(M.fields[0].name==="tag")return j(M);return[]}getSortOptions(){const W=[{value:A,label:"Alphabetically (A-Z)"},{value:"-name_sort",label:"Alphabetically (Z-A)"}];if(t.$.licenseInfo.enabledFeatures.analytics){for(const H of B)W.push({value:`-${H.name}`,label:`${H.display} (most)`}),W.push({value:`${H.name}`,label:`${H.display} (least)`});for(const H of N)W.push({value:`-${H.name}`,label:`${H.display} (recent)`}),W.push({value:`${H.name}`,label:`${H.display} (oldest)`})}return Promise.resolve(W)}async doSearchQuery(W){W=await(0,g.u4)(W);const H={...W,query:W.query??"*",limit:W.limit??S},G=(await(0,a.AI)().post(T,H)).frames.map(ee=>(0,r.Vc)(ee)),M=G.length?(0,r.Vc)(G[0]):{fields:[],length:0};if(M.name===b)return this.fallbackSearcher.search(W);for(const ee of M.fields)ee.display=(0,s.J)({field:ee,theme:t.$.theme2});M.meta?.custom||(M.meta={...M.meta,custom:{count:M.length,max_score:1}});const Q=M.meta.custom||{};if(Q.locationInfo||(Q.locationInfo={}),Q.sortBy?.length){const ee=M.fields.find(ne=>ne.name===Q.sortBy);if(ee){const ne=I(ee.name);Q.sortBy=ne,ee.name=ne}}let Y=0,q;const te=async()=>{for(;Y>X.dataFrame.length;){const ee=X.dataFrame.length;if(ee>=Q.count)return;const ne=await(0,a.AI)().post(T,{...H??{},from:ee,limit:O}),Z=(0,r.Vc)(ne.frames[0]);if(!Z){console.log("no results",Z);return}if(Z.fields.length!==X.dataFrame.fields.length){console.log("invalid shape",Z,X.dataFrame);return}const ae=Z.length+X.dataFrame.length;for(let se=0;se<Z.fields.length;se++)X.dataFrame.fields[se].values.push(...Z.fields[se].values);X.dataFrame.length=ae;const re=Z.meta?.custom;if(re?.locationInfo&&Q)for(const[se,de]of Object.entries(re.locationInfo))Q.locationInfo[se]=de}q=void 0},X=new n.R(M);return{totalRows:Q.count??M.length,view:X,loadMoreItems:async(ee,ne)=>(Y=Math.max(Y,ne),q||(q=te()),q),isItemLoaded:ee=>ee<X.dataFrame.length}}getFolderViewSort(){return"name_sort"}}const S=50,O=100;function j(U){const W=U.fields[0].values,H=U.fields[1].values,z=[];for(let G=0;G<U.length;G++)z.push({term:W[G],count:H[G]});return z}const B=[{name:"views_total",display:"Views total"},{name:"views_last_30_days",display:"Views 30 days"},{name:"errors_total",display:"Errors total"},{name:"errors_last_30_days",display:"Errors 30 days"}],N=[{name:"created_at",display:"Created time"},{name:"updated_at",display:"Updated time"}];function I(U){for(const W of B)if(W.name===U)return W.display;for(const W of N)if(W.name===U)return W.display;return U}let K;function w(){if(!K){const U=new C,W=t.$.featureToggles.panelTitleSearch;K=W?new o(U):U,t.$.featureToggles.unifiedStorageSearch&&(K=new R(U)),W&&location.search.includes("do-frontend-query")&&(K=new P(K))}return K}},40957:(_,L,e)=>{"use strict";e.d(L,{TM:()=>g,cu:()=>i,hI:()=>d,u4:()=>r});var t=e(49952),n=e(14792);async function r(o){return o.query&&o.query.indexOf("folder:current")>=0&&(o={...o,location:await s(),query:o.query.replace("folder:current","").trim()},o.query?.length||(o.query="*")),Promise.resolve(o)}async function s(){try{let o=(0,n.UA)().getCurrent();return o||(await a(500),o=(0,n.UA)().getCurrent()),Promise.resolve(o?.meta?.folderUid)}catch(o){console.error(o)}}function a(o){return new Promise(u=>setTimeout(u,o))}function g(o,u){return o==="dashboard"?"apps":o==="folder"?u?"folder-open":"folder":"question-circle"}function i(o,u){return o&&(0,t.I)(o.uid)?"users-alt":g(o.kind,u)}function l(o){switch(o){case"dashboard":case"folder":case"panel":return o;default:return"dashboard"}}function d(o,u){const c=u?.dataFrame.meta?.custom,p={kind:l(o.kind),uid:o.uid,title:o.name,url:o.url,tags:o.tags??[]},h=c?.sortBy;if(h){const y=o[h];(typeof y=="string"||typeof y=="number")&&(p.sortMetaName=h,p.sortMeta=y)}if(o.location){const y=o.location.split("/"),f=y[y.length-1],v=c?.locationInfo[f];v&&(p.parentTitle=v.name,p.parentKind=v.kind,p.parentUID=f)}return p}},64161:(_,L,e)=>{"use strict";e.d(L,{G:()=>t,P:()=>n});var t=(r=>(r.DashDB="dash-db",r.DashHome="dash-home",r.DashFolder="dash-folder",r))(t||{}),n=(r=>(r.List="list",r.Folders="folders",r))(n||{})},16757:(_,L,e)=>{"use strict";e.d(L,{N1:()=>a,W1:()=>r});var t=e(53477);const n=g=>g?!!(g.query||g.tag?.length>0||g.starred||g.sort):!1,r=()=>{const g=t.G3+".";for(let i=0;i<window.localStorage.length;i++){const l=window.localStorage.key(i);l?.startsWith(g)&&window.localStorage.removeItem(l)}},s=(g="General")=>`${SECTION_STORAGE_KEY}.${g.toLowerCase()}`,a=g=>{const i=Object.entries(g).reduce((l,[d,o])=>{if(o){if(d==="tag"&&!Array.isArray(o))return{...l,tag:[o]}}else return l;return{...l,[d]:o}},{});if(g.folder){const l=`folder:${g.folder}`;return{...i,query:`${l} ${(i.query??"").replace(l,"")}`}}return{...i}}},1936:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>E,EC:()=>m,FW:()=>y,G3:()=>l,L5:()=>x,QM:()=>g,Yh:()=>f,aD:()=>d,c3:()=>D,ch:()=>i,dJ:()=>o,ew:()=>P,jE:()=>u,zh:()=>v});var t=e(65307),n=e(31678);const r={serviceAccount:{},isLoading:!0,tokens:[]},s=(0,t.Z0)({name:"serviceaccount",initialState:r,reducers:{serviceAccountFetchBegin:C=>({...C,isLoading:!0}),serviceAccountFetchEnd:C=>({...C,isLoading:!1}),serviceAccountLoaded:(C,b)=>({...C,serviceAccount:b.payload,isLoading:!1}),serviceAccountTokensLoaded:(C,b)=>({...C,tokens:b.payload,isLoading:!1}),rolesFetchBegin:C=>({...C,rolesLoading:!0}),rolesFetchEnd:C=>({...C,rolesLoading:!1})}}),a=s.reducer,{serviceAccountLoaded:g,serviceAccountTokensLoaded:i,serviceAccountFetchBegin:l,serviceAccountFetchEnd:d,rolesFetchBegin:o,rolesFetchEnd:u}=s.actions,c={serviceAccounts:[],isLoading:!0,roleOptions:[],query:"",page:0,perPage:50,totalPages:1,showPaging:!1,serviceAccountStateFilter:n.ServiceAccountStateFilter.All},p=(0,t.Z0)({name:"serviceaccounts",initialState:c,reducers:{serviceAccountsFetched:(C,b)=>{const{totalCount:T,perPage:A,...R}=b.payload,S=Math.ceil(T/A);return{...C,...R,totalPages:S,perPage:A,showPaging:S>1,isLoading:!1}},serviceAccountsFetchBegin:C=>({...C,isLoading:!0}),serviceAccountsFetchEnd:C=>({...C,isLoading:!1}),acOptionsLoaded:(C,b)=>({...C,roleOptions:b.payload}),queryChanged:(C,b)=>({...C,query:b.payload,page:0}),pageChanged:(C,b)=>({...C,page:b.payload}),stateFilterChanged:(C,b)=>({...C,serviceAccountStateFilter:b.payload})}}),h=p.reducer,{serviceAccountsFetchBegin:y,serviceAccountsFetchEnd:f,serviceAccountsFetched:v,acOptionsLoaded:P,pageChanged:m,stateFilterChanged:D,queryChanged:x}=p.actions,E={serviceAccountProfile:a,serviceAccounts:h}},8212:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>p,NV:()=>u,Y1:()=>l,j7:()=>i,kH:()=>g,pB:()=>o,s7:()=>d,sF:()=>a,sJ:()=>s});var t=e(65307);const n={supportBundles:[],isLoading:!1,supportBundleCollectors:[],createBundlePageLoading:!1,loadBundlesError:"",createBundleError:""},r=(0,t.Z0)({name:"supportBundles",initialState:n,reducers:{supportBundlesLoaded:(h,y)=>({...h,supportBundles:y.payload,isLoading:!1}),fetchBegin:h=>({...h,isLoading:!0}),fetchEnd:h=>({...h,isLoading:!1}),collectorsFetchBegin:h=>({...h,createBundlePageLoading:!0}),collectorsFetchEnd:h=>({...h,createBundlePageLoading:!1}),supportBundleCollectorsLoaded:(h,y)=>({...h,supportBundleCollectors:y.payload,createBundlePageLoading:!1}),setLoadBundleError:(h,y)=>({...h,loadBundlesError:y.payload,supportBundleCollectors:[]}),setCreateBundleError:(h,y)=>({...h,createBundleError:y.payload})}}),{supportBundlesLoaded:s,fetchBegin:a,fetchEnd:g,supportBundleCollectorsLoaded:i,collectorsFetchBegin:l,collectorsFetchEnd:d,setLoadBundleError:o,setCreateBundleError:u}=r.actions,p={supportBundles:r.reducer}},34655:(_,L,e)=>{"use strict";e.d(L,{$T:()=>p,$u:()=>i,Ay:()=>P,EC:()=>g,L5:()=>a,Q9:()=>s,dJ:()=>l,jE:()=>d,tC:()=>h});var t=e(65307);const n={teams:[],page:1,query:"",perPage:30,totalPages:0,noTeams:!1,hasFetched:!1},r=(0,t.Z0)({name:"teams",initialState:n,reducers:{teamsLoaded:(m,D)=>{const{totalCount:x,perPage:E,...C}=D.payload,b=Math.ceil(x/E);return{...m,...C,totalPages:b,perPage:E,hasFetched:!0}},queryChanged:(m,D)=>({...m,page:1,query:D.payload}),pageChanged:(m,D)=>({...m,page:D.payload}),sortChanged:(m,D)=>({...m,sort:D.payload,page:1}),rolesFetchBegin:m=>({...m,rolesLoading:!0}),rolesFetchEnd:m=>({...m,rolesLoading:!1})}}),{teamsLoaded:s,queryChanged:a,pageChanged:g,sortChanged:i,rolesFetchBegin:l,rolesFetchEnd:d}=r.actions,o=r.reducer,u={team:{},members:[],groups:[],searchMemberQuery:""},c=(0,t.Z0)({name:"team",initialState:u,reducers:{teamLoaded:(m,D)=>({...m,team:D.payload}),teamMembersLoaded:(m,D)=>({...m,members:D.payload}),setSearchMemberQuery:(m,D)=>({...m,searchMemberQuery:D.payload}),teamGroupsLoaded:(m,D)=>({...m,groups:D.payload})}}),{teamLoaded:p,teamGroupsLoaded:h,teamMembersLoaded:y,setSearchMemberQuery:f}=c.actions,v=c.reducer,P={teams:o,team:v}},23989:(_,L,e)=>{"use strict";e.d(L,{w:()=>ee});var t=e(2543),n=e(95344),r=e(19347),s=e(72574),a=e(81887),g=e(52622),i=e(73788),l=e(20601),d=e(13344),o=e(24240),u=e(87421),c=e(75096);let p={};function h(ne){const Z=p[ne];return Z||(p[ne]=(0,t.property)(ne))}class y{constructor(Z,ae,re){this.state={name:Z.name,value:ae,text:re,type:Z.type}}getValue(Z){let{value:ae}=this.state;return ae==="string"||ae==="number"||ae==="boolean"?ae:String(ae)}getValueText(){const{value:Z,text:ae}=this.state;return typeof ae=="string"?Z===d.To?d.Zm:ae:Array.isArray(ae)?ae.join(" + "):(console.log("value",ae),String(ae))}}let f;function v(ne,Z,ae){return f?(f.state.name=ne.name,f.state.type=ne.type,f.state.value=Z,f.state.text=ae):f=new y(ne,Z,ae),f}function P(ne,Z,ae,re){if(ae=ae||{},ne==null||(0,o.EW)(ae)&&Z!==g.$m.QueryParam)return"";if(!Array.isArray(ne)&&typeof ne=="object"&&(ne=`${ne}`),typeof Z=="function")return Z(ne,ae,P);Z||(Z=g.$m.Glob);let se=Z.split(":");se.length>1?(Z=se[0],se=se.slice(1)):se=[];let de=a.vz.getIfExists(Z);de||(console.error(`Variable format ${Z} not found. Using glob format as fallback.`),de=a.vz.get(g.$m.Glob));const le=v(ae,ne,re??ne);return de.formatter(ne,se,le)}var m=e(84743),D=e.n(m),x=e(6709),E=e(76885),C=e(1933),b=e(74856),T=e(25304),A=e(83195),R=e(11261),S=e(92461),O=e(57875),j=e(28240),B=e(8249);function N(ne,Z,ae){return new Proxy({},{get:(re,se)=>{if(se==="name")return ne.name;if(se==="displayName")return(0,j.Ct)(ne,Z,ae);if(se==="labels"||se==="formattedLabels")return ne.labels?{...ne.labels,__values:Object.values(ne.labels).sort().join(", "),toString:()=>(0,B.h6)(ne.labels,"",!0)}:""}})}function I(ne,Z,ae,re){const se=K(ne,Z,ae);return P(se,re)}function K(ne,Z,ae){const re=ae?.__dataContext;if(!re)return ne;const{frame:se,rowIndex:de,field:le,calculatedValue:he}=re.value;if(he)switch(Z){case"numeric":return he.numeric.toString();case"raw":return he.numeric;case"time":return"";case"text":default:return(0,A.cN)(he)}if(de===void 0)return ne;if(Z==="time"){const pe=se.fields.find(Pe=>Pe.type===R.PU.time);return pe?pe.values[de]:void 0}const ie=le.values[de];if(Z==="raw")return ie;const ce=(le.display??W())(ie);switch(Z){case"numeric":return ce.numeric;case"text":return ce.text;default:return(0,A.cN)(ce)}}function w(ne,Z,ae,re){const se=ae?.__dataContext;if(!se||!Z)return ne;const{frame:de,rowIndex:le}=se.value;if(le===void 0||Z===void 0)return ne;const he={name:de.name,refId:de.refId,fields:(0,S.F)({frame:de,rowIndex:le})},ie=h(Z)(he)??"";return P(ie,re)}let U;function W(){return U||(U=(0,O.J)()),U}function H(ne,Z,ae,re){const se=ae?.__dataContext;if(!se||Z!=="name")return ne;const{frame:de,frameIndex:le}=se.value,he=(0,j.Ri)(de,le);return P(he,re)}function z(ne,Z,ae,re){const se=ae?.__dataContext;if(!se||Z===void 0||Z==="")return ne;const{frame:de,field:le,data:he}=se.value,ie=N(le,de,he),J=h(Z)(ie)??"";return P(J,re)}const G={__value:I,__data:w,__series:H,__field:z,[x.c.includeVars]:M,[x.c.keepTime]:Q,__timezone:Y};function M(ne,Z,ae){const re=(0,T.z)(ae);return E.kM.toUrlParams(re)}function Q(){return E.kM.toUrlParams((0,b.jG)().timeRangeForUrl())}function Y(){const ne=(0,C.O)({timeZone:(0,b.jG)().timeModel?.getTimezone()});return ne==="browser"?D().tz.guess():ne}const q={getFilteredVariables:u.bZ,getVariables:u.UN,getVariableWithName:u._2};class te{constructor(Z=q){this.dependencies=Z,this.regex=c.SY,this.index={},this.grafanaVariables=new Map,this._timeRange=null,this._adhocFiltersDeprecationWarningLogged=new Map,this._variables=[]}init(Z,ae){this._variables=Z,this._timeRange=ae,this.updateIndex()}get variables(){return(0,n.l)("template_srv.ts","variables","getVariables"),this.getVariables()}getVariables(){return window.__grafanaSceneContext?(0,i.E)(window.__grafanaSceneContext):this.dependencies.getVariables()}get timeRange(){return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?a.jh.getTimeRange(window.__grafanaSceneContext).state.value:this._timeRange}updateIndex(){const Z=ae=>ae||ae==="";if(this.index=this._variables.reduce((ae,re)=>(re.current&&(re.current.isNone||Z(re.current.value))&&(ae[re.name]=re),ae),{}),this.timeRange){const ae=this.timeRange.from.valueOf().toString(),re=this.timeRange.to.valueOf().toString();this.index={...this.index,__from:{current:{value:ae,text:ae}},__to:{current:{value:re,text:re}}}}}updateTimeRange(Z){this._timeRange=Z,this.updateIndex()}variableInitialized(Z){this.index[Z.name]=Z}getAdhocFilters(Z,ae){let re=[],se=(0,r.l)().getInstanceSettings(Z);if(!se)return[];!ae&&!this._adhocFiltersDeprecationWarningLogged.get(se.type)&&((0,n.l)(`DataSource ${se.type}`,"templateSrv.getAdhocFilters","filters property on the request (DataQueryRequest). Or if this is called from interpolateVariablesInQueries or applyTemplateVariables it is passed as a new argument"),this._adhocFiltersDeprecationWarningLogged.set(se.type,!0));for(const de of this.getAdHocVariables()){const le=de.datasource?.uid;(le===se.uid||le?.indexOf("$")===0&&this.replace(le)===se.uid)&&(re=re.concat(de.filters))}return re}setGrafanaVariable(Z,ae){this.grafanaVariables.set(Z,ae)}setGlobalVariable(Z,ae){(0,n.l)("template_srv.ts","setGlobalVariable",""),this.index={...this.index,[Z]:{current:ae}}}getVariableName(Z){this.regex.lastIndex=0;const ae=this.regex.exec(Z);return ae?ae.slice(1).find(se=>se!==void 0):null}containsTemplate(Z){if(!Z)return!1;const ae=this.getVariableName(Z),re=ae&&this.getVariableAtIndex(ae);return re!=null}variableExists(Z){return(0,n.l)("template_srv.ts","variableExists","containsTemplate"),this.containsTemplate(Z)}highlightVariablesAsHtml(Z){return!Z||!(0,t.isString)(Z)?Z:(Z=(0,t.escape)(Z),this._replaceWithVariableRegex(Z,void 0,(ae,re)=>this.getVariableAtIndex(re)?'<span class="template-variable">'+ae+"</span>":ae))}getAllValue(Z){if(Z.allValue)return Z.allValue;const ae=[];for(let re=1;re<Z.options.length;re++)ae.push(Z.options[re].value);return ae}getVariableValue(Z,ae){return ae?h(ae)(Z.value):Z.value}getVariableText(Z,ae){return Z.value===ae||typeof ae!="string"?Z.text:ae}replace(Z,ae,re,se){if(ae&&ae.__sceneObject){const de=ae.__sceneObject.value.valueOf();return a.jh.interpolate(de,Z,ae,re,se)}return window.__grafanaSceneContext&&window.__grafanaSceneContext.isActive?a.jh.interpolate(window.__grafanaSceneContext,Z,ae,re,se):Z?(this.regex.lastIndex=0,this._replaceWithVariableRegex(Z,re,(de,le,he,ie)=>{const J=this._evaluateVariableExpression(de,le,he,ie,ae);return se&&se.push({match:de,variableName:le,fieldPath:he,format:ie,value:J,found:J!==de}),J})):Z??""}_evaluateVariableExpression(Z,ae,re,se,de){const le=this.getVariableAtIndex(ae),he=de?.[ae];if(he){const pe=this.getVariableValue(he,re),Pe=this.getVariableText(he,pe);if(pe!=null)return P(pe,se,le,Pe)}if(!le){const pe=G[ae];return pe?pe(Z,re,de,se):Z}if(se===g.$m.QueryParam||(0,o.EW)(le)){const pe=l.B.get(le.type).getValueForUrl(le),Pe=(0,o.EW)(le)?le.id:le.current.text;return P(pe,se,le,Pe)}const ie=this.grafanaVariables.get(le.current.value);if(ie)return P(ie,se,le);let J=le.current.value,ce=le.current.text;if(this.isAllValue(J)&&(J=this.getAllValue(le),ce=d.Zm,le.allValue&&se!==g.$m.Text&&se!==g.$m.PercentEncode))return this.replace(J);if(re){const pe=this.getVariableValue({value:J,text:ce},re);if(pe!=null)return P(pe,se,le,ce)}return P(J,se,le,ce)}_replaceWithVariableRegex(Z,ae,re){return this.regex.lastIndex=0,Z.replace(this.regex,(se,de,le,he,ie,J,ce)=>re(se,de||le||ie,J,he||ce||ae))}isAllValue(Z){return Z===d.To||Array.isArray(Z)&&Z[0]===d.To}replaceWithText(Z,ae){return(0,n.l)("template_srv.ts","replaceWithText()","replace(), and specify the :text format"),this.replace(Z,ae,"text")}getVariableAtIndex(Z){if(Z)return this.index[Z]?this.index[Z]:this.dependencies.getVariableWithName(Z)}getAdHocVariables(){return this.dependencies.getFilteredVariables(o.EW)}}const X=new te;(0,s.d)(X);const ee=()=>X},47241:(_,L,e)=>{"use strict";e.d(L,{v:()=>S});var t=e(4200),n=e(8620);const r=`${t.Rp}${t.ui}`,s=`rate(${r}[$__rate_interval])`;function a(O){return O?`${s} ${t.tM}`:`${r} ${t.tM}`}var g=e(81887),i=e(52622);function l({title:O,unit:j}){return g.d0.timeseries().setTitle(O).setUnit(j).setOption("legend",{showLegend:!1}).setOption("tooltip",{mode:i.$N.Multi,sort:i.xB.Descending}).setCustomFieldConfig("fillOpacity",9)}function d({description:O,mainQueryExpr:j,breakdownQueryExpr:B,unit:N}){const I={title:`${t.Rp}`,unit:N},K={refId:"A",expr:j,legendFormat:O},w={...I,title:O,queries:[K],variant:"main",vizBuilder:()=>l({...w})},U={...w,title:`${t.Rp}`,queries:[{...K,legendFormat:O}],vizBuilder:()=>l(U),variant:"preview"},W={...I,queries:[{refId:"A",expr:B,legendFormat:`{{${t.aZ}}}`}],vizBuilder:()=>l(W),variant:"breakdown"};return{preview:U,main:w,breakdown:W,variants:[]}}const o=new Set(["count","total"]),u=new Set(["sum","bucket"]),c={count:"sum",total:"sum"};function p(O){return O==="total"}const h={avg:"average",sum:"overall"};function y(O){return h[O]||O}function f({agg:O,rate:j,unit:B}){const N=a(j),I=j?`${y(O)} per-second rate`:`${y(O)}`,K=`${t.Rp} (${I})`,w=`${O}(${N})`,U=`${O}(${N})by(${t.aZ})`;return d({description:K,mainQueryExpr:w,breakdownQueryExpr:U,unit:B})}function v(O){const j=O.at(-1);if(j==null||u.has(j))throw new Error(`This function does not support a metric suffix of "${j}"`);const B=o.has(j),N=c[j]||"avg",I=p(j)?O.at(-2):j,K=B?(0,n.MM)(I):(0,n.l_)(I);return f({agg:N,unit:K,rate:B})}var P=e(52995);function m({title:O,unit:j}){return g.d0.heatmap().setTitle(O).setUnit(j).setOption("calculate",!1).setOption("color",{mode:P.P7.Scheme,exponent:.5,scheme:"Spectral",steps:32,reverse:!1})}function D({title:O,unit:j}){return g.d0.timeseries().setTitle(O).setUnit(j).setCustomFieldConfig("fillOpacity",9).setOption("tooltip",{mode:i.$N.Multi,sort:i.xB.Descending}).setOption("legend",{showLegend:!1})}function x(O){const j=`${t.Rp}`,B=O.at(-2),N=(0,n.l_)(B),I={title:j,unit:N},K={...I,variant:"p50",queries:[T(50)],vizBuilder:()=>l(K)},w={...I,variant:"p50",queries:[T(50,[t.aZ])],vizBuilder:()=>l(w)},U={...I,variant:"percentiles",queries:[99,90,50].map(H=>T(H)),vizBuilder:()=>D(U)},W={...I,variant:"heatmap",queries:[b()],vizBuilder:()=>m(W)};return{preview:W,main:W,variants:[U,W],breakdown:w}}const E=`rate(${t.Rp}${t.ui}[$__rate_interval])${t.tM}`;function C(O=[]){return`sum by(${["le",...O].join(", ")}) (${E})`}function b(O=[]){return{refId:"Heatmap",expr:C(O),format:"heatmap"}}function T(O,j=[]){const B=O/100;let N=`${O}th Percentile`;return j[0]&&(N=`{{${j[0]}}}`),{refId:`Percentile${O}`,expr:`histogram_quantile(${B}, ${C(j)})`,legendFormat:N}}function A(O){if(O.at(-1)!=="sum")throw new Error('createSummaryMetricQueryDefs is only to be used for metrics that end in "_sum"');const B=O.at(-2),N=(0,n.l_)(B),K=a(!0),w=O.slice(0,-1).join("_"),U=G(`sum(${K})`),W=G(`sum(${K})by(${t.aZ})`),z=`${w} (average)`;function G(M){const Q=M.replace(t.Rp,`${w}_sum`),Y=M.replace(t.Rp,`${w}_count`);return`${Q}/${Y}`}return d({description:z,mainQueryExpr:U,breakdownQueryExpr:W,unit:N})}function R(O){return O==="sum"?A:O==="bucket"?x:v}function S(O){const j=O.split("_"),B=j.at(-1),N=R(B);if(!N)throw new Error(`Unable to generate queries for metric "${O}" due to issues with derived suffix "${B}"`);return N(j)}},8620:(_,L,e)=>{"use strict";e.d(L,{MM:()=>l,l_:()=>r,vL:()=>n});const t="short";function n(d){const o=d.split("_"),u=o.at(-1)??"",c=o.at(-2)??"";return a.includes(u)?u:a.includes(c)?c:null}function r(d){return d&&s[d]||t}const s={bytes:"bytes",seconds:"s"},a=["bytes","seconds"],g={bytes:"Bps",seconds:"short"},i="cps";function l(d){return d&&g[d]||i}},73145:(_,L,e)=>{"use strict";e.d(L,{b:()=>w,B:()=>U});var t=e(74848),n=e(32196),r=e(96540),s=e(76885),a=e(12470),g=e(39601),i=e(23172),l=e(81887),d=e(40845),o=e(15292),u=e(83122),c=e(27746),p=e(76412),h=e(24243),y=e(21028),f=e(40588),v=e(51080);class P extends l.Bs{constructor(M){super({stickyMainGraph:M.stickyMainGraph??!0,isOpen:M.isOpen??!1}),this.onToggleStickyMainGraph=()=>{const Q=!this.state.stickyMainGraph;(0,f.z)("settings_changed",{stickyMainGraph:Q}),this.setState({stickyMainGraph:Q})},this.onToggleOpen=Q=>{this.setState({isOpen:Q})},this.onTogglePreviews=()=>{const Q=(0,v.kj)(this);Q.setState({showPreviews:!Q.state.showPreviews})}}static{this.Component=({model:M})=>{const{stickyMainGraph:Q,isOpen:Y}=M.useState(),q=(0,d.of)(m),te=(0,v.kj)(M),{showPreviews:X,topScene:ee}=te.useState(),ne=()=>(0,t.jsxs)("div",{className:q.popover,onClick:Z=>Z.stopPropagation(),children:[(0,t.jsx)("div",{className:q.heading,children:"Settings"}),ee instanceof h.R&&(0,t.jsxs)("div",{className:q.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(p.x,{i18nKey:"trails.settings.always-keep-selected-metric-graph-in-view",children:"Always keep selected metric graph in-view"})}),(0,t.jsx)(o.d,{value:Q,onChange:M.onToggleStickyMainGraph})]}),ee instanceof y.t&&(0,t.jsxs)("div",{className:q.options,children:[(0,t.jsx)("div",{children:(0,t.jsx)(p.x,{i18nKey:"trails.settings.show-previews-of-metric-graphs",children:"Show previews of metric graphs"})}),(0,t.jsx)(o.d,{value:X,onChange:M.onTogglePreviews})]})]});return(0,t.jsx)(u.m,{overlay:ne,placement:"bottom",onVisibleChange:M.onToggleOpen,children:(0,t.jsx)(c.I,{icon:"cog",variant:"canvas",isOpen:Y})})}}}function m(G){return{popover:(0,n.css)({display:"flex",padding:G.spacing(2),flexDirection:"column",background:G.colors.background.primary,boxShadow:G.shadows.z3,borderRadius:G.shape.borderRadius(),border:`1px solid ${G.colors.border.weak}`,zIndex:1,marginRight:G.spacing(2)}),heading:(0,n.css)({fontWeight:G.typography.fontWeightMedium,paddingBottom:G.spacing(2)}),options:(0,n.css)({display:"grid",gridTemplateColumns:"1fr 50px",rowGap:G.spacing(1),columnGap:G.spacing(2)})}}var D=e(13054),x=e(90623),E=e(74764),C=e(88434),b=e(81996),T=e(17172);const A=null,R=G=>`count(target_info{${G??""}}) by (job, instance)`,S={key:"__name__",value:"target_info",operator:"="};async function O(G,M,Q,Y){const q=(Q??[]).concat(A),te=getPrometheusTime(M.from,!1),X=getPrometheusTime(M.to,!0),ee=`/api/datasources/uid/${G}/resources/api/v1/labels`,ne={start:te,end:X,"match[]":`{__name__="target_info"${Y?`,${Y}`:""}}`};return(await getBackendSrv().get(ee,ne,"explore-metrics-otel-resources")).data?.filter(re=>!q.includes(re)).map(re=>re)}async function j(G,M,Q){const Y=(0,b.mv)(M.from,!1),q=(0,b.mv)(M.to,!0),te=`/api/datasources/uid/${G}/resources/api/v1/query`,X={start:Y,end:q,query:R(Q)},ee=await(0,T.AI)().get(te,X,"explore-metrics-otel-check-total");let ne=[],Z=[];return ee.data.result.forEach(re=>{re.metric.job&&re.metric.instance&&(ne.push(re.metric.job),Z.push(re.metric.instance))}),{jobs:ne,instances:Z}}async function B(G,M,Q){const Y=`/api/datasources/uid/${G}/resources/api/v1/query`,q=getPrometheusTime(M.from,!1),te=getPrometheusTime(M.to,!0),X={start:q,end:te,query:`${R()} > 1`};return!((await getBackendSrv().get(Y,X,"explore-metrics-otel-check-standard")).data.result.length>0)}async function N(G,M){const Q=(0,b.mv)(M.from,!1),Y=(0,b.mv)(M.to,!0),q=`/api/datasources/uid/${G}/resources/api/v1/label/deployment_environment/values`,te={start:Q,end:Y,"match[]":'{__name__="target_info"}'};return(await(0,T.AI)().get(q,te,"explore-metrics-otel-resources-deployment-env")).data}var I=e(84086),K=e(4200);class w extends l.Bs{constructor(M){super({$timeRange:M.$timeRange??new l.JZ({}),$variables:M.$variables??W(M.initialDS,M.metric,M.initialFilters,M.otelJoinQuery),controls:M.controls??[new l.K8({layout:"vertical"}),new l.N0,new l.KE({}),new l.WM({})],history:M.history??new D.LR({}),settings:M.settings??new P({}),createdAt:M.createdAt??new Date().getTime(),useOtelExperience:M.useOtelExperience??!1,otelJoinQuery:M.otelJoinQuery??"",showPreviews:!0,...M}),this._urlSync=new l.So(this,{keys:["metric","metricSearch"]}),this._variableDependency=new l.Sh(this,{variableNames:[K.EY,K.DU,K.p4,K.Xt],onReferencedVariableValueChanged:async Q=>{const{name:Y}=Q.state;if(Y===K.EY){this.datasourceHelper.reset(),this.checkDataSourceForOTelResources();const q=l.jh.lookupVariable(K.Ao,this);q instanceof l.H9&&q.setState({filters:[]})}if(this.state.useOtelExperience&&(Y===K.p4||Y===K.DU)){const q=this.state.$timeRange?.state,te=l.jh.interpolate(this,K.gR),X=l.jh.lookupVariable(K.p4,this),ee=l.jh.lookupVariable(K.DU,this),ne=l.jh.lookupVariable(K.Xt,this);q&&ee instanceof l.H9&&ne instanceof l.x0&&X instanceof l.yP&&this.updateOtelData(te,q,X,ee,ne)}}}),this._addingFilterWithoutReportingInteraction=!1,this.datasourceHelper=new C.q(this),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.topScene||this.setState({topScene:U(this.state.metric)}),this.subscribeToEvent(K.OO,this._handleMetricSelectedEvent.bind(this));const M=l.jh.lookupVariable(K.Ao,this);M instanceof l.H9&&this._subs.add(M?.subscribeToState((Y,q)=>{this._addingFilterWithoutReportingInteraction||(0,f.h)(Y.filters,q.filters)}));const Q=()=>(0,E._r)().setRecentTrail(this);return window.addEventListener("unload",Q),()=>{this.state.embedded||Q(),window.removeEventListener("unload",Q)}}addFilterWithoutReportingInteraction(M){const Q=l.jh.lookupVariable("filters",this);Q instanceof l.H9&&(this._addingFilterWithoutReportingInteraction=!0,Q.setState({filters:[...Q.state.filters,M]}),this._addingFilterWithoutReportingInteraction=!1)}getMetricMetadata(M){return this.datasourceHelper.getMetricMetadata(M)}getCurrentMetricMetadata(){return this.getMetricMetadata(this.state.metric)}restoreFromHistoryStep(M){!M.topScene&&!M.metric&&(M.topScene=new y.t({})),this.setState(l.Go.cloneSceneObjectState(M,{history:this.state.history,metric:M.metric?M.metric:void 0,metricSearch:M.metricSearch?M.metricSearch:void 0}));const Q=new l.g5().getUrlState(this),Y=s.kM.renderUrl(g.Ny.getLocation().pathname,Q);g.Ny.replace(Y)}_handleMetricSelectedEvent(M){this.setState(this.getSceneUpdatesForNewMetricValue(M.payload));const Q=l.jh.lookupVariable(K.Ao,this);Q instanceof l.H9&&Q.setState({baseFilters:z(M.payload)})}getSceneUpdatesForNewMetricValue(M){const Q={};return Q.metric=M,Q.topScene=U(M),Q}getUrlState(){const{metric:M,metricSearch:Q}=this.state;return{metric:M,metricSearch:Q}}updateFromUrl(M){const Q={};typeof M.metric=="string"?this.state.metric!==M.metric&&Object.assign(Q,this.getSceneUpdatesForNewMetricValue(M.metric)):M.metric==null&&(Q.metric=void 0,Q.topScene=new y.t({})),typeof M.metricSearch=="string"?Q.metricSearch=M.metricSearch:M.metric==null&&(Q.metricSearch=void 0),this.setState(Q)}async checkDataSourceForOTelResources(){const M=(0,v.kj)(this),Q=M.state.$timeRange?.state;if(Q){const Y=l.jh.lookupVariable(K.DU,this),q=l.jh.lookupVariable(K.p4,this),te=l.jh.lookupVariable(K.Xt,this),X=l.jh.lookupVariable(K.Ao,this),ee=l.jh.interpolate(M,K.gR),ne=await j(ee,Q),Z=await N(ee,Q),ae=ne.jobs.length>0&&ne.instances.length>0;if(Y instanceof l.H9&&q instanceof l.yP&&te instanceof l.x0&&X instanceof l.H9)if(ae&&Z.length>0){X.setState({addFilterButtonText:"Select metric attributes",label:"Select metric attribute"});let re="";const se=Z.map(J=>(re+=J+",",{value:J,label:J})),de=se[0].value,le=q.state.text,ie=le!==""&&le.toLocaleString()!==""?le:de;q?.setState({value:ie,options:se,hide:a.zL.dontHide}),this.updateOtelData(ee,Q,q,Y,te,Z,ae)}else this.resetOtelExperience(Y,q,te,X,ae,Z)}}async updateOtelData(M,Q,Y,q,te,X,ee){let ne=[S];const Z=""+Y?.getValue();if(Z){const he=Z.includes(",")?"=~":"=",ie={key:"deployment_environment",value:Z.split(",").join("|"),operator:he};ne.push(ie)}q.getValue()&&q.state.filters.length>0&&(ne=ne.concat(q.state.filters));const re=this.datasourceHelper;q.setState({getTagKeysProvider:async(he,ie)=>{let J=await re.getTagKeys({filters:ne});return J=(0,I.ql)(J,ne.map(ce=>ce.key).concat(ie??"")),{replace:!0,values:J}},getTagValuesProvider:async(he,ie)=>(ne=ne.filter(ce=>ce.key!==ie.key),{replace:!0,values:await re.getTagValues({key:ie.key,filters:ne})}),hide:a.zL.hideLabel});const se=(0,I.Dz)(this),de=(0,I.L4)(se);te.setState({value:de});const le=await j(M,Q,se.filters);ee&&X?this.setState({otelTargets:le,otelJoinQuery:de,hasOtelResources:ee,isStandardOtel:X.length>0,useOtelExperience:!0}):this.setState({otelTargets:le,otelJoinQuery:de})}resetOtelExperience(M,Q,Y,q,te,X){q.setState({addFilterButtonText:"Add label",label:"Select label"}),M.setState({defaultKeys:[],hide:a.zL.hideVariable}),Q.setState({value:"",hide:a.zL.hideVariable}),Y.setState({value:""}),te&&X?this.setState({hasOtelResources:te,isStandardOtel:X.length>0,useOtelExperience:!1,otelTargets:{jobs:[],instances:[]},otelJoinQuery:""}):this.setState({otelTargets:{jobs:[],instances:[]},otelJoinQuery:"",useOtelExperience:!1})}static{this.Component=({model:M})=>{const{controls:Q,topScene:Y,history:q,settings:te,useOtelExperience:X,hasOtelResources:ee}=M.useState(),ne=(0,i.k)(),Z=(0,d.of)(H,ne??0),ae=(0,E._r)().recent.length<2;return(0,r.useEffect)(()=>{if(X)M.checkDataSourceForOTelResources();else{const re=l.jh.lookupVariable(K.DU,M),se=l.jh.lookupVariable(K.p4,M),de=l.jh.lookupVariable(K.Xt,M),le=l.jh.lookupVariable(K.Ao,M);re instanceof l.H9&&se instanceof l.yP&&de instanceof l.x0&&le instanceof l.H9&&M.resetOtelExperience(re,se,de,le)}},[M,ee,X]),(0,r.useEffect)(()=>{const re=l.jh.lookupVariable(K.Ao,M),se=M.datasourceHelper;(0,v.FG)(re,se)},[M]),(0,t.jsxs)("div",{className:Z.container,children:[ae&&(0,t.jsx)(x.p,{}),(0,t.jsx)(q.Component,{model:q}),Q&&(0,t.jsxs)("div",{className:Z.controls,children:[Q.map(re=>(0,t.jsx)(re.Component,{model:re},re.state.key)),(0,t.jsx)(te.Component,{model:te})]}),(0,t.jsx)("div",{className:Z.body,children:Y&&(0,t.jsx)(Y.Component,{model:Y})})]})}}}function U(G){return G?new h.R({metric:G}):new y.t({})}function W(G,M,Q,Y){return new l.Pj({variables:[new l.mI({name:K.EY,label:"Data source",description:"Only prometheus data sources are supported",value:G,pluginId:"prometheus"}),new l.yP({name:K.p4,label:"Deployment environment",hide:a.zL.hideVariable,value:void 0,placeholder:"Select",isMulti:!0}),new l.H9({name:K.DU,label:"Select resource attributes",addFilterButtonText:"Select resource attributes",datasource:K.GH,hide:a.zL.hideVariable,layout:"vertical",defaultKeys:[],applyMode:"manual"}),new l.H9({name:K.Ao,addFilterButtonText:"Add label",datasource:K.GH,hide:a.zL.hideLabel,layout:"vertical",filters:Q??[],baseFilters:z(M),applyMode:"manual",supportsMultiValueOperators:!0}),...(0,K.Mi)(Y??"")]})}function H(G,M){return{container:(0,n.css)({flexGrow:1,display:"flex",gap:G.spacing(1),flexDirection:"column",background:G.isLight?G.colors.background.primary:G.colors.background.canvas,padding:G.spacing(2,3,2,3)}),body:(0,n.css)({flexGrow:1,display:"flex",flexDirection:"column"}),controls:(0,n.css)({display:"flex",gap:G.spacing(1),padding:G.spacing(1,0),alignItems:"flex-end",flexWrap:"wrap",position:"sticky",background:G.isDark?G.colors.background.canvas:G.colors.background.primary,zIndex:G.zIndex.navbarFixed,top:M})}}function z(G){return G?[{key:"__name__",operator:"=",value:G}]:[]}},13054:(_,L,e)=>{"use strict";e.d(L,{LR:()=>x,hi:()=>y});var t=e(74848),n=e(32196),r=e(96540),s=e(91410),a=e(43127),g=e(65879),i=e(81887),l=e(67061),d=e(40845),o=e(56034),u=e(73145),c=e(40588),p=e(4200),h=e(51080);function y(O){return"currentStep"in O&&"steps"in O}function f(O){return!!O}const v=O=>typeof O=="string",P=" $2 ",m=/(\|)(=|=~|!=|>|<|!~)(\|)/g,D={start:"Start of history",metric:"Metric selected:",metric_page:"Metric select page",filters:"Filter applied:",time:"Time range changed:",dep_env:"Deployment environment selected:",resource:"Resource attribute selected:"};class x extends i.Bs{constructor(j){super({steps:j.steps??[],currentStep:j.currentStep??0,filtersApplied:[],otelResources:[],otelDepEnvs:[]}),this.stepTransitionInProgress=!1,this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const j=(0,h.kj)(this);if(this.state.steps.length===0)if(this.addTrailStep(j,"start"),j.state.metric){const{metric:B,...N}=j.state;N.topScene=(0,u.B)(void 0),this.state.steps[0].trailState=N,this.addTrailStep(j,"metric",j.state.metric)}else this.addTrailStep(j,"metric_page");j.subscribeToState((B,N)=>{B.metric!==N.metric&&(this.state.steps.length===1&&(this.state.steps[0].trailState=i.Go.cloneSceneObjectState(N,{history:this})),B.metric?this.addTrailStep(j,"metric",B.metric):this.addTrailStep(j,"metric_page"))}),j.subscribeToEvent(i.oh,B=>{if(B.payload.state.name===p.Ao){const N=this.state.filtersApplied,I=i.Go.getUrlState(j);this.addTrailStep(j,"filters",C(I,N)),this.setState({filtersApplied:N})}if(B.payload.state.name===p.p4){const N=this.state.otelDepEnvs,I=i.Go.getUrlState(j);this.addTrailStep(j,"dep_env",T(I,N)),this.setState({otelDepEnvs:N})}if(B.payload.state.name===p.DU){const N=this.state.otelResources,I=i.Go.getUrlState(j);this.addTrailStep(j,"resource",b(I,N)),this.setState({otelResources:N})}}),j.subscribeToEvent(i.bZ,B=>{if(B.payload.changedObject instanceof i.JZ){const{prevState:N,newState:I}=B.payload;if((0,h.iG)(N)&&(0,h.iG)(I)){if(N.from===I.from&&N.to===I.to)return;this.addTrailStep(j,"time",E({from:I.from,to:I.to,timeZone:I.timeZone}))}}})}addTrailStep(j,B,N=""){if(this.stepTransitionInProgress)return;const I=this.state.steps.length,K=B==="start"?-1:this.state.currentStep;this.setState({currentStep:I,steps:[...this.state.steps,{type:B,detail:N,description:D[B],trailState:i.Go.cloneSceneObjectState(j.state,{history:this}),parentIndex:K}]})}addTrailStepFromStorage(j,B){if(this.stepTransitionInProgress)return;const N=B.type,I=this.state.steps.length,K=N==="start"?-1:this.state.currentStep,w=this.state.filtersApplied,U=this.state.otelResources,W=this.state.otelDepEnvs;let H="";switch(B.type){case"metric":H=B.urlValues.metric?.toString()??"";break;case"filters":H=C(B.urlValues,w);break;case"time":H=E(B.urlValues);break;case"dep_env":H=T(B.urlValues,W);case"resource":H=b(B.urlValues,U)}this.setState({filtersApplied:w,otelDepEnvs:W,otelResources:U,currentStep:I,steps:[...this.state.steps,{type:N,detail:H,description:D[N],trailState:i.Go.cloneSceneObjectState(j.state,{history:this}),parentIndex:K}]})}goBackToStep(j){if(j===this.state.currentStep)return;const B=this.state.steps[j],N=B.type==="metric"&&B.trailState.metric===void 0?"metric-clear":B.type;(0,c.z)("history_step_clicked",{type:N,step:j,numberOfSteps:this.state.steps.length}),this.stepTransitionInProgress=!0,this.setState({currentStep:j}),(0,h.kj)(this).restoreFromHistoryStep(B.trailState),this.stepTransitionInProgress=!1}renderStepTooltip(j){return(0,t.jsxs)(l.B,{direction:"column",children:[(0,t.jsx)("div",{children:j.description}),j.detail!==""&&(0,t.jsx)("div",{children:j.detail})]})}static{this.Component=({model:j})=>{const{steps:B,currentStep:N}=j.useState(),I=(0,d.of)(A),{ancestry:K,alternatePredecessorStyle:w}=(0,r.useMemo)(()=>{const U=new Set;let W=N;for(;W>=0;){const z=B[W];if(!z)break;U.add(W),W=z.parentIndex}const H=new Map;return U.forEach(z=>{const G=B[z].parentIndex;G+1!==z&&H.set(z,S(z,G))}),{ancestry:U,alternatePredecessorStyle:H}},[N,B]);return(0,t.jsxs)("div",{className:I.container,children:[(0,t.jsx)("div",{className:I.heading,children:"History"}),B.map((U,W)=>{let H=U.type;return H==="metric"&&U.trailState.metric===void 0&&(H="start"),(0,t.jsx)(o.m,{content:()=>j.renderStepTooltip(U),children:(0,t.jsx)("button",{className:(0,n.cx)(I.step,I.stepTypes[H],N===W?I.stepSelected:"",w.get(W)??"",W!==U.parentIndex+1?I.stepOmitsDirectLeftLink:"",W===0?I.stepOmitsDirectLeftLink:"",K.has(W)?"":I.stepIsNotAncestorOfCurrent),onClick:()=>j.goBackToStep(W)})},W)})]})}}}function E(O){if(!(0,h.iG)(O))return"";const j=(0,g.convertRawToRange)({from:O.from,to:O.to}),B=v(O.timeZone)?O.timeZone:s.g$.localBrowserTime,N=(0,s.QZ)(B,Date.now()),I=j.from.subtract(N?.offsetInMins??0,"minute").format(a.G$),K=j.to.subtract(N?.offsetInMins??0,"minute").format(a.G$);return`${I} - ${K}`}function C(O,j){let B="";const N=O["var-filters"];return f(N)&&(B=N.filter(I=>I!==""&&!j.includes(I)?(j.push(I),!0):!1)[0]??""),B.replace(m,P)}function b(O,j){let B="";const N=O["var-otel_resources"];return f(N)&&(B=N.filter(I=>I!==""&&!j.includes(I)?(j.push(I),!0):!1)[0]??""),B.replace(m,P)}function T(O,j){let B="";const N=O["var-deployment_environment"];return typeof N=="string"?N:(f(N)&&(B=N?.filter(I=>I!==""&&!j.includes(I)?(j.push(I),!0):!1)[0]??""),B)}function A(O){const j=O.visualization;return{container:(0,n.css)({display:"flex",gap:10,alignItems:"center"}),heading:(0,n.css)({}),step:(0,n.css)({flexGrow:0,cursor:"pointer",border:"none",boxShadow:"none",padding:0,margin:0,width:8,height:8,opacity:.7,borderRadius:O.shape.radius.circle,background:O.colors.primary.main,position:"relative","&:hover":{opacity:1},"&:hover:before":{opacity:.7},"&:before":{content:'""',position:"absolute",width:10,height:2,left:-10,top:3,background:O.colors.primary.border,pointerEvents:"none"}}),stepSelected:(0,n.css)({"&:after":{content:'""',borderStyle:"solid",borderWidth:2,borderRadius:"50%",position:"absolute",width:16,height:16,left:-4,top:-4,boxShadow:`0px 0px 0px 2px inset ${O.colors.background.canvas}`}}),stepOmitsDirectLeftLink:(0,n.css)({"&:before":{background:"none"}}),stepIsNotAncestorOfCurrent:(0,n.css)({opacity:.2,"&:hover:before":{opacity:.2}}),stepTypes:{start:R(j.getColorByName("green")),filters:R(j.getColorByName("purple")),metric:R(j.getColorByName("orange")),metric_page:R(j.getColorByName("orange")),time:R(O.colors.primary.main),resource:R(j.getColorByName("purple")),dep_env:R(j.getColorByName("purple"))}}}function R(O){return(0,n.css)({background:O,"&:before":{background:O,borderColor:O},"&:after":{borderColor:O}})}function S(O,j){const I=(O-j)*18;return(0,n.css)({"&:before":{content:'""',width:I+2,height:10,borderStyle:"solid",borderWidth:2,borderBottom:"none",borderTopLeftRadius:8,borderTopRightRadius:8,top:-10,left:3-I,background:"none"}})}},24243:(_,L,e)=>{"use strict";e.d(L,{k:()=>et,R:()=>ft});var t=e(74848),n=e(32196),r=e(32264),s=e(81887),a=e(40845),g=e(90613),i=e(67061),l=e(27746),d=e(14578),o=e(55852),u=e(63021),c=e(40675),p=e(56034),h=e(87490),y=e(94753),f=e(72109),v=e(8484),P=e(8620),m=e(69096),D=e(40588),x=e(4200),E=e(51080);class C extends s.Bs{constructor(xe){super({...xe}),this._variableDependency=new s.Sh(this,{variableNames:[x.gR],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this.addActivationHandler(this._onActivate.bind(this))}getVariable(){const xe=s.jh.lookupVariable(x.yr,this);if(!(xe instanceof s.fS))throw new Error("Group by variable not found");return xe}_onActivate(){this.updateMetadata()}onReferencedVariableValueChanged(){this.updateMetadata()}async updateMetadata(){this.setState({metadataLoading:!0,metadata:void 0});const Oe=(0,E.aM)(this).state.metric,Ze=await(0,E.kj)(this).getMetricMetadata(Oe);this.setState({metadata:Ze,metadataLoading:!1})}static{this.Component=({model:xe})=>{const{metadata:Oe,metadataLoading:Le}=xe.useState(),Ze=xe.getVariable(),{loading:qe,options:rt}=Ze.useState(),{useOtelExperience:vt}=(0,E.kj)(xe).useState(),jt=(0,E.aM)(xe).state.metric;let Ut=(0,P.vL)(jt)??"Unknown";return(0,t.jsx)(m.O,{isLoading:qe||Le,children:(0,t.jsx)(i.B,{gap:6,children:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(y.E,{weight:"medium",children:(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.description-label",children:"Description"})}),(0,t.jsx)("div",{style:{maxWidth:360},children:Oe?.help?(0,t.jsx)("div",{children:Oe?.help}):(0,t.jsx)("i",{children:(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.no-description",children:"No description available"})})})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(y.E,{weight:"medium",children:(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.type-label",children:"Type"})}),Oe?.type?(0,t.jsx)("div",{children:Oe?.type}):(0,t.jsx)("i",{children:(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.unknown-type",children:"Unknown"})})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(y.E,{weight:"medium",children:(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.unit-label",children:"Unit"})}),Oe?.unit?(0,t.jsx)("div",{children:Oe?.unit}):(0,t.jsx)("i",{children:Ut})]}),(0,t.jsxs)(i.B,{direction:"column",gap:.5,children:[(0,t.jsx)(y.E,{weight:"medium",children:vt?(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.metric-attributes",children:"Metric attributes"}):(0,t.jsx)(v.x6,{i18nKey:"trails.metric-overview.labels",children:"Labels"})}),rt.length===0&&"Unable to fetch labels.",rt.map(zt=>(0,t.jsx)(f.Y,{href:`#View breakdown for ${zt.label}`,title:`View breakdown for ${zt.label}`,onClick:qt=>{qt.preventDefault(),qt.stopPropagation(),s.jh.getAncestor(xe,ft).setActionView("breakdown");const fn=s.jh.lookupVariable(x.yr,xe);return fn instanceof s.fS&&zt.label!=null&&((0,D.z)("label_selected",{label:zt.label,cause:"overview_link"}),fn.setState({value:zt.value})),!1},children:zt.label},zt.label))]})]})})})}}}function b(){return new C({})}var T=e(21028);function A(){return new T.t({})}var R=e(47241),S=e(2543),O=e(11261),j=e(52622),B=e(88575),N=e(39558),I=e(90182);function K({options:ze,value:xe,onChange:Oe}){const Le=(0,a.of)(w);return(0,t.jsx)(I.l6,{options:ze,value:xe,onChange:Ze=>Oe(Ze.value),className:Le.select})}function w(ze){return{select:(0,n.css)({maxWidth:ze.spacing(16)})}}const U="$__all";class W extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{if(!(s.jh.lookupVariable("filters",this)instanceof s.H9))return;const Oe=this.state.frame.fields[1]?.labels??{};if(Object.keys(Oe).length!==1)return;const Le=Object.keys(Oe)[0];(0,D.z)("label_filter_changed",{label:Le,action:"added",cause:"breakdown"});const Ze=(0,E.kj)(this),qe={key:Le,operator:"=",value:Oe[Le]};Ze.addFilterWithoutReportingInteraction(qe)}}static{this.Component=({model:xe})=>{const Le=xe.useState().frame.fields[1]?.labels||{};return Object.keys(Le).length!==0?(0,t.jsx)(o.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:xe.onClick,children:"Add to filters"}):null}}}var H=e(65463),z=e(39070),G=e(42418);function M(ze){const xe=ze.fields[1]?.labels;if(!xe)return null;const Oe=Object.keys(xe);return Oe.length===0?null:xe[Oe[0]]}var Q=e(53076);const Y=new Q.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1});function q(ze,xe,Oe){const[Le,Ze,qe]=Y.search(ze,xe,0,1e5);let rt=[],vt=new Set;if(Le&&qe){const Ot=(jt,Ut)=>{Ut&&vt.add(jt)};for(let jt=0;jt<qe.length;jt++){let Ut=qe[jt];Q.A.highlight(ze[Ze.idx[Ut]],Ze.ranges[Ut],Ot),rt.push(ze[Ze.idx[Ut]])}Oe([rt,[...vt]])}else xe||Oe([])}const te=(0,S.debounce)(q,300);function X(ze,xe){const Oe=s.jh.lookupVariable(x.Ao,ze),Le=[];if(!(Oe instanceof s.H9))return[];const Ze=Oe.state.filters;for(const qe of xe.getOptionsForSelect()){const rt=Ze.find(vt=>vt.key===qe.value);qe.label!=="le"&&(rt||Le.push({label:qe.label,value:String(qe.value)}))}return Le}function ee(ze,xe){const Oe=sceneGraph.findObject(ze,Le=>Le instanceof xe);return Oe instanceof xe?Oe:null}function ne(ze,xe){function Oe(Ze){return Ze instanceof xe}return s.jh.findAllObjects(ze,Oe).filter(Oe)}class Z extends s.Bs{constructor({getFilter:xe,...Oe}){super(Oe),this.unfilteredChildren=[],this.series=[],this.filterByString=Le=>{let Ze=[];this.iterateFrames((qe,rt)=>{const vt=se(qe[rt]);Ze.push(vt)}),q(Ze,Le,qe=>{qe&&qe[0]?this.filterFrames(rt=>{const vt=se(rt);return qe[0].includes(vt)}):this.filterFrames(()=>!0)})},this.iterateFrames=Le=>{if(s.jh.getData(this).state.data)for(let qe=0;qe<this.series.length;qe++)Le(this.series,qe)},this.filterFrames=Le=>{const Ze=[];this.iterateFrames((qe,rt)=>{Le(qe[rt])&&Ze.push(this.unfilteredChildren[rt])}),Ze.length===0?this.state.body.setState({children:[ae(this.getFilter(),this.clearFilter)]}):this.state.body.setState({children:Ze})},this.clearFilter=()=>{this.publishEvent(new ie,!0)},this.getFilter=xe,this.addActivationHandler(()=>{const Le=s.jh.getData(this);this._subs.add(Le.subscribeToState((Ze,qe)=>{if(Ze.data===void 0)return;const rt=Ze.data;Ze.data?.state!==qe.data?.state&&ne(this,s.Zv).forEach(vt=>{vt.setState({data:{...vt.state.data,state:rt.state}})}),rt.state===z.Gu.Done&&this.performRepeat(rt)})),Le.state.data&&this.performRepeat(Le.state.data)})}performRepeat(xe){const Oe=[];this.series=xe.series;for(let Le=0;Le<this.series.length;Le++){const Ze=this.state.getLayoutChild(xe,this.series[Le],Le);Oe.push(Ze)}this.unfilteredChildren=Oe,this.getFilter()?(this.state.body.setState({children:[]}),this.filterByString(this.getFilter())):this.state.body.setState({children:Oe})}static{this.Component=({model:xe})=>{const{body:Oe}=xe.useState();return(0,t.jsx)(Oe.Component,{model:Oe})}}}function ae(ze,xe){return new s.G1({direction:"row",children:[new s.vA({body:new s.dM({reactNode:(0,t.jsx)("div",{className:re.alertContainer,children:(0,t.jsxs)(G.F,{title:"",severity:"info",className:re.noResultsAlert,children:[(0,t.jsxs)(v.x6,{i18nKey:"explore-metrics.breakdown.noMatchingValue",children:["No values found matching; ",{filter:ze}]}),(0,t.jsx)(o.$n,{className:re.clearButton,onClick:xe,children:(0,t.jsx)(v.x6,{i18nKey:"explore-metrics.breakdown.clearFilter",children:"Clear filter"})})]})})})})]})}const re={alertContainer:(0,n.css)({flexGrow:1,display:"flex",justifyContent:"center",alignItems:"center"}),noResultsAlert:(0,n.css)({minWidth:"30vw",flexGrow:0}),clearButton:(0,n.css)({marginLeft:"1.5rem"})};function se(ze){return M(ze)??"No labels"}var de=e(10354);const le=({value:ze,onChange:xe,placeholder:Oe,onClear:Le,...Ze})=>(0,t.jsx)(de.p,{value:ze,onChange:xe,suffix:ze?(0,t.jsx)(d.I,{onClick:Le,title:"Clear search",name:"times",className:he.clearIcon}):void 0,prefix:(0,t.jsx)(d.I,{name:"search"}),placeholder:Oe,...Ze}),he={clearIcon:(0,n.css)({cursor:"pointer"})};class ie extends H.a{static{this.type="breakdown-search-reset"}}const J={};class ce extends s.Bs{constructor(xe){super({filter:J[xe]??""}),this.onValueFilterChange=Oe=>{this.setState({filter:Oe.target.value}),this.filterValues(Oe.target.value)},this.clearValueFilter=()=>{this.setState({filter:""}),this.filterValues("")},this.reset=()=>{this.setState({filter:""}),J[this.cacheKey]=""},this.cacheKey=xe}static{this.Component=({model:xe})=>{const{filter:Oe}=xe.useState();return(0,t.jsx)(le,{value:Oe,onChange:xe.onValueFilterChange,onClear:xe.clearValueFilter,placeholder:"Search for value"})}}filterValues(xe){this.parent instanceof we&&(J[this.cacheKey]=xe,this.parent.state.body?.forEachChild(Le=>{Le instanceof Z&&Le.state.body.isActive&&Le.filterByString(xe)}))}}var pe=e(94354);function Pe(){return localStorage.getItem(x.Pp)??"grid"}function Ie(ze){return localStorage.setItem(x.Pp,ze??"grid")}const ge=["single","grid","rows"];function Se(ze){return ge.includes(ze)}class De extends s.Bs{constructor(xe){const Oe=Pe();super({activeBreakdownLayout:Se(Oe)?Oe:"grid",...xe}),this._urlSync=new s.So(this,{keys:["breakdownLayout"]}),this.onLayoutChange=Le=>{this.state.activeBreakdownLayout!==Le&&((0,D.z)("breakdown_layout_changed",{layout:Le}),Ie(Le),this.setState({activeBreakdownLayout:Le}),this.state.onBreakdownLayoutChange(Le))}}getUrlState(){return{breakdownLayout:this.state.activeBreakdownLayout}}updateFromUrl(xe){const Oe=xe.breakdownLayout;Oe==="string"&&Se(Oe)&&this.state.activeBreakdownLayout!==Oe&&this.setState({activeBreakdownLayout:Oe})}Selector({model:xe}){const{activeBreakdownLayout:Oe,breakdownLayoutOptions:Le}=xe.useState();return(0,t.jsx)(pe.z,{options:Le,value:Oe,onChange:xe.onLayoutChange})}static{this.Component=({model:xe})=>{const{breakdownLayouts:Oe,breakdownLayoutOptions:Le,activeBreakdownLayout:Ze}=xe.useState(),qe=Le.findIndex(vt=>vt.value===Ze);if(qe===-1)return null;const rt=Oe[qe];return(0,t.jsx)(rt.Component,{model:rt})}}}class Ke extends H.x{static{this.type="selected-metric-query-results-event"}}const Me=ze=>{const xe=s.jh.getAncestor(ze,we);ne(ze,s.Eb).forEach(Ze=>{Ze.isActive?Oe(Ze.state.$data):Ze.addActivationHandler(()=>{Oe(Ze.state.$data)})}),ne(ze,s.Eb).forEach(Ze=>Oe(Ze.state.$data));function Oe(Ze){Ze&&(Ze.isActive||Ze.addActivationHandler(()=>{Oe(Ze)}),Ze.state.data&&xe.reportBreakdownPanelData(Ze.state.data),Ze.subscribeToState(({data:qe},rt)=>{xe.reportBreakdownPanelData(qe)}))}const Le=xe.subscribeToEvent(Ke,Ze=>{if(!ze.isActive){Le.unsubscribe();return}const qe=s.No.timeseries().setCustomFieldConfig("axisSoftMin",Ze.payload.min).setCustomFieldConfig("axisSoftMax",Ze.payload.max).build();ne(ze,s.Eb).forEach(rt=>{function vt(){rt.onFieldConfigChange(qe)}rt.isActive?vt():rt.addActivationHandler(vt)})})},be=60;class we extends s.Bs{constructor(xe){super({...xe,labels:xe.labels??[],search:new ce("labels")}),this._variableDependency=new s.Sh(this,{variableNames:[x.Ao],onReferencedVariableValueChanged:this.onReferencedVariableValueChanged.bind(this)}),this._triggerAxisChangedEvent=(0,S.throttle)(()=>{const{breakdownPanelMinValue:Oe,breakdownPanelMaxValue:Le}=this;Oe!==void 0&&Le!==void 0&&this.publishEvent(new Ke({min:Oe,max:Le}))},1e3),this.onBreakdownLayoutChange=Oe=>{this.clearBreakdownPanelAxisValues()},this.onChange=Oe=>{if(!Oe)return;(0,D.z)("label_selected",{label:Oe,cause:"selector"}),this.getVariable().changeValueTo(Oe)},this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){const xe=this.getVariable();xe.subscribeToState((qe,rt)=>{(qe.options!==rt.options||qe.value!==rt.value||qe.loading!==rt.loading)&&this.updateBody(xe)}),this._subs.add(this.subscribeToEvent(ie,()=>{this.state.search.clearValueFilter()}));const Le=s.jh.getAncestor(this,ft).state.metric;this._query=(0,R.v)(Le).breakdown,(0,E.kj)(this).state.$timeRange?.subscribeToState(()=>{this.clearBreakdownPanelAxisValues()}),this.updateBody(xe)}reportBreakdownPanelData(xe){if(!xe)return;let Oe=this.breakdownPanelMinValue,Le=this.breakdownPanelMaxValue;xe.series.forEach(Ze=>{Ze.fields.forEach(qe=>{if(qe.type!==O.PU.number)return;const rt=qe.values.filter(S.isNumber),vt=(0,S.max)(rt),Ot=(0,S.min)(rt);Le=(0,S.max)([Le,vt].filter(S.isNumber)),Oe=(0,S.min)([Oe,Ot].filter(S.isNumber))})}),!(Le===void 0||Oe===void 0||!Number.isFinite(Le+Oe))&&(this.breakdownPanelMaxValue===Le&&this.breakdownPanelMinValue===Oe||(this.breakdownPanelMaxValue=Le,this.breakdownPanelMinValue=Oe,this._triggerAxisChangedEvent()))}clearBreakdownPanelAxisValues(){this.breakdownPanelMaxValue=void 0,this.breakdownPanelMinValue=void 0}getVariable(){const xe=s.jh.lookupVariable(x.yr,this);if(!(xe instanceof s.fS))throw new Error("Group by variable not found");return xe}onReferencedVariableValueChanged(){const xe=this.getVariable();xe.changeValueTo(U),this.updateBody(xe)}updateBody(xe){const Oe=X(this,xe),Le={loading:xe.state.loading,value:String(xe.state.value),labels:Oe,error:xe.state.error,blockingMessage:void 0};!xe.state.loading&&xe.state.options.length?Le.body=xe.hasAllValue()?He(Oe,this._query,this.onBreakdownLayoutChange):Je(this._query,this.onBreakdownLayoutChange,this.state.search):xe.state.loading||(Le.body=void 0,Le.blockingMessage="Unable to retrieve label options for currently selected metric."),this.clearBreakdownPanelAxisValues(),this.setState(Le)}static{this.Component=({model:xe})=>{const{labels:Oe,body:Le,search:Ze,loading:qe,value:rt,blockingMessage:vt}=xe.useState(),Ot=(0,a.of)(Be),{useOtelExperience:jt}=(0,E.kj)(xe).useState();return(0,t.jsx)("div",{className:Ot.container,children:(0,t.jsxs)(m.O,{isLoading:qe,blockingMessage:vt,children:[(0,t.jsxs)("div",{className:Ot.controls,children:[!qe&&!!Oe.length&&(0,t.jsx)(B.D,{label:jt?"By metric attribute":"By label",children:(0,t.jsx)(K,{options:Oe,value:rt,onChange:xe.onChange})}),rt!==U&&(0,t.jsx)(B.D,{label:"Search",className:Ot.searchField,children:(0,t.jsx)(Ze.Component,{model:Ze})}),Le instanceof De&&(0,t.jsx)(B.D,{label:"View",children:(0,t.jsx)(Le.Selector,{model:Le})})]}),(0,t.jsx)("div",{className:Ot.content,children:Le&&(0,t.jsx)(Le.Component,{model:Le})})]})})}}}function Be(ze){return{container:(0,n.css)({flexGrow:1,display:"flex",minHeight:"100%",flexDirection:"column",paddingTop:ze.spacing(1)}),content:(0,n.css)({flexGrow:1,display:"flex",paddingTop:ze.spacing(0)}),searchField:(0,n.css)({flexGrow:1}),controls:(0,n.css)({flexGrow:0,display:"flex",alignItems:"flex-end",gap:ze.spacing(2),justifyContent:"space-between"})}}function He(ze,xe,Oe){const Le=[];for(const Ze of ze){if(Ze.value===U)continue;if(Le.length===be)break;const qe=xe.queries[0].expr.replaceAll(x.aZ,String(Ze.value)),rt=xe.unit,vt=s.d0.timeseries().setOption("tooltip",{mode:j.$N.Multi,sort:j.xB.Descending}).setOption("legend",{showLegend:!1}).setTitle(Ze.label).setData(new s.dt({maxDataPoints:x.up,datasource:x.GH,queries:[{refId:`A-${Ze.label}`,expr:qe,legendFormat:`{{${Ze.label}}}`}]})).setHeaderActions(new bt({labelName:String(Ze.value)})).setUnit(rt).setBehaviors([ye]).build();Le.push(new s.xK({$behaviors:[Me],body:vt}))}return new De({breakdownLayoutOptions:[{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:Oe,breakdownLayouts:[new s.gF({templateColumns:Ve,autoRows:"200px",children:Le,isLazy:!0}),new s.gF({templateColumns:"1fr",autoRows:"200px",children:Le.map(Ze=>Ze.clone()),isLazy:!0})]})}const Ve="repeat(auto-fit, minmax(400px, 1fr))";function Je(ze,xe,Oe){const Le=ze.unit;function Ze(rt,vt,Ot){const jt=ze.vizBuilder().setTitle(nt(vt)).setData(new s.Zv({data:{...rt,series:[vt]}})).setColor({mode:"fixed",fixedColor:(0,E.Vy)(Ot)}).setHeaderActions(new W({frame:vt})).setUnit(Le).build(),Ut=vt.length<=1;return new s.xK({$behaviors:[Me],body:jt,isHidden:Ut})}const qe=()=>Oe.state.filter??"";return new De({$data:new s.dt({datasource:x.GH,maxDataPoints:x.up,queries:ze.queries}),breakdownLayoutOptions:[{value:"single",label:"Single"},{value:"grid",label:"Grid"},{value:"rows",label:"Rows"}],onBreakdownLayoutChange:xe,breakdownLayouts:[new s.G1({direction:"column",children:[new s.vA({minHeight:300,body:s.d0.timeseries().setOption("tooltip",{mode:j.$N.Multi,sort:j.xB.Descending}).setOption("legend",{showLegend:!1}).setTitle("$metric").build()})]}),new Z({body:new s.gF({templateColumns:Ve,autoRows:"200px",children:[new s.vA({body:new s.dM({reactNode:(0,t.jsx)(N._,{text:"Loading..."})})})]}),getLayoutChild:Ze,getFilter:qe}),new Z({body:new s.gF({templateColumns:"1fr",autoRows:"200px",children:[]}),getLayoutChild:Ze,getFilter:qe})]})}function nt(ze){const xe=ze.fields[1]?.labels||{},Oe=Object.keys(xe);return Oe.length===0?"<unspecified>":xe[Oe[0]]}function pt(){return new we({})}class bt extends s.Bs{constructor(){super(...arguments),this.onClick=()=>{const xe=this.state.labelName;(0,D.z)("label_selected",{label:xe,cause:"breakdown_panel"}),Tt(this).onChange(xe)}}static{this.Component=({model:xe})=>(0,t.jsx)(o.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:xe.onClick,children:(0,t.jsx)(v.x6,{i18nKey:"explore-metrics.breakdown.labelSelect",children:"Select"})})}}function Tt(ze){if(ze instanceof we)return ze;if(ze.parent)return Tt(ze.parent);throw new Error("Unable to find breakdown scene")}function ye(ze){ze.state.$data?.subscribeToState((xe,Oe)=>{const Le=xe.data?.request?.targets[0];if(je(Le)){const{legendFormat:Ze}=Le,qe=Ze.slice(2,-2);xe.data?.series.forEach(rt=>{if(!rt.fields[1].labels?.[qe]){const vt=rt.fields[1].labels;vt&&(vt[qe]=`<unspecified ${qe}>`)}})}})}function je(ze){return ze!==void 0&&"legendFormat"in ze&&typeof ze.legendFormat=="string"}var ue=e(94624),Ee=e(23172);class Ce extends s.Bs{constructor(xe){super(xe),this.onChangeQuery=Oe=>{const Le=(0,E.aM)(this),Ze=Le.state.autoQuery.variants.find(qe=>qe.variant===Oe);this.setState({panel:this.getVizPanelFor(Ze)}),Le.setState({queryDef:Ze})},this.addActivationHandler(this.onActivate.bind(this))}onActivate(){if(!this.state.panel){const{autoQuery:xe}=(0,E.aM)(this).state;this.setState({panel:this.getVizPanelFor(xe.main)})}}getQuerySelector(xe){const{autoQuery:Oe}=(0,E.aM)(this).state;if(Oe.variants.length===0)return;const Le=Oe.variants.map(Ze=>({label:Ze.variant,value:Ze.variant}));return(0,t.jsx)(pe.z,{size:"sm",options:Le,value:xe.variant,onChange:this.onChangeQuery})}getVizPanelFor(xe){return xe.vizBuilder().setData(new s.dt({datasource:x.GH,maxDataPoints:x.dc,queries:xe.queries})).setHeaderActions(this.getQuerySelector(xe)).build()}static{this.Component=({model:xe})=>{const{panel:Oe}=xe.useState();if(Oe)return(0,t.jsx)(Oe.Component,{model:Oe})}}}const Ne=280,Fe="40%";class Ue extends s.Bs{constructor(xe){super({topView:xe.topView??Te(),...xe})}static{this.Component=({model:xe})=>{const{topView:Oe,selectedTab:Le}=xe.useState(),{stickyMainGraph:Ze}=(0,E.KE)(xe).useState(),qe=(0,Ee.k)(),rt=(0,a.of)(fe,qe??0);return(0,t.jsxs)("div",{className:rt.container,children:[(0,t.jsx)("div",{className:Ze?rt.sticky:rt.nonSticky,children:(0,t.jsx)(Oe.Component,{model:Oe})}),Le&&(0,t.jsx)(Le.Component,{model:Le})]})}}}function fe(ze,xe){return{container:(0,n.css)({display:"flex",flexDirection:"column",position:"relative"}),sticky:(0,n.css)({display:"flex",flexDirection:"row",background:ze.isLight?ze.colors.background.primary:ze.colors.background.canvas,position:"sticky",top:`${xe+70}px`,zIndex:10}),nonSticky:(0,n.css)({display:"flex",flexDirection:"row"})}}function Te(){return new s.G1({direction:"column",$behaviors:[new s.Gg.K2({key:"metricCrosshairSync",sync:ue.y.Crosshair})],children:[new s.vA({minHeight:Ne,maxHeight:Fe,body:new Ce({})}),new s.vA({ySizing:"content",body:new et({})})]})}var Ge=e(96540);const Qe=({trail:ze})=>{const[xe,Oe]=(0,Ge.useState)("Copy url"),Le=()=>{if(navigator.clipboard){(0,D.z)("selected_metric_action_clicked",{action:"share_url"});const qe=(r.$.appUrl.endsWith("/")?r.$.appUrl.slice(0,-1):r.$.appUrl)+(0,E.xi)(ze);navigator.clipboard.writeText(qe),Oe("Copied!"),setTimeout(()=>{Oe("Copy url")},2e3)}};return(0,t.jsx)(l.I,{variant:"canvas",icon:"share-alt",tooltip:xe,onClick:Le})};var st=e(13054),Xe=e(74764);function ot(ze){const xe=()=>(0,Xe._r)().getBookmarkIndex(ze),Oe=xe(),[Le,Ze]=(0,Ge.useState)(Oe);(0,Ge.useEffect)(()=>{const Ot=ze.subscribeToEvent(s.bZ,({payload:{prevState:jt,newState:Ut}})=>{(0,st.hi)(jt)&&(0,st.hi)(Ut)&&Ut.steps.length>jt.steps.length&&Ze((0,Xe._r)().getBookmarkIndex(ze))});return()=>Ot.unsubscribe()},[ze]),Oe!==Le&&Ze(Oe);const qe=Le!=null;return[qe,()=>{if((0,D.z)("bookmark_changed",{action:qe?"toggled_off":"toggled_on"}),qe){let Ot=xe();for(;Ot!=null;)(0,Xe._r)().removeBookmark(Ot),Ot=xe()}else(0,Xe._r)().addBookmark(ze);Ze(xe())}]}class ft extends s.Bs{constructor(xe){const Oe=xe.autoQuery??(0,R.v)(xe.metric);super({$variables:xe.$variables??dt(xe.metric),body:xe.body??new Ue({}),autoQuery:Oe,queryDef:xe.queryDef??Oe.main,...xe}),this._urlSync=new s.So(this,{keys:["actionView"]}),this.addActivationHandler(this._onActivate.bind(this))}_onActivate(){this.state.actionView===void 0&&this.setActionView("overview")}getUrlState(){return{actionView:this.state.actionView}}updateFromUrl(xe){if(typeof xe.actionView=="string"){if(this.state.actionView!==xe.actionView){const Oe=_e.find(Le=>Le.value===xe.actionView);Oe&&this.setActionView(Oe.value)}}else xe.actionView===null&&this.setActionView(void 0)}setActionView(xe){const{body:Oe}=this.state,Le=_e.find(Ze=>Ze.value===xe);Le&&Le.value!==this.state.actionView?(Oe.state.topView.state.children[0].setState({maxHeight:Ne}),Oe.setState({selectedTab:Le.getScene()}),this.setState({actionView:Le.value})):(Oe.state.topView.state.children[0].setState({maxHeight:Fe}),Oe.setState({selectedTab:void 0}),this.setState({actionView:void 0}))}static{this.Component=({model:xe})=>{const{body:Oe}=xe.useState();return(0,t.jsx)(Oe.Component,{model:Oe})}}}const _e=[{displayName:"Overview",value:"overview",getScene:b},{displayName:"Breakdown",value:"breakdown",getScene:pt},{displayName:"Related metrics",value:"related",getScene:A,description:"Relevant metrics based on current label filters"}];class et extends s.Bs{constructor(){super(...arguments),this.getLinkToExplore=async()=>{const xe=s.jh.getAncestor(this,ft),Oe=(0,E.kj)(this),Le=(0,E.U4)(Oe),Ze=xe.state.queryDef?.queries||[],qe=s.jh.getTimeRange(this);return(0,h.Xe)({queries:Ze,dsRef:{uid:Le},timeRange:qe.state.value,scopedVars:{__sceneObject:{value:xe}}})},this.openExploreLink=async()=>{(0,D.z)("selected_metric_action_clicked",{action:"open_in_explore"}),this.getLinkToExplore().then(xe=>{const Oe=`${r.$.appSubUrl}${xe}`;window.open(Oe,"_blank")})}}static{this.Component=({model:xe})=>{const Oe=s.jh.getAncestor(xe,ft),Le=(0,a.of)(it),Ze=(0,E.kj)(xe),[qe,rt]=ot(Ze),{actionView:vt}=Oe.useState();return(0,t.jsxs)(g.a,{paddingY:1,children:[(0,t.jsx)("div",{className:Le.actions,children:(0,t.jsxs)(i.B,{gap:1,children:[(0,t.jsx)(l.I,{variant:"canvas",tooltip:"Remove existing metric and choose a new metric",onClick:()=>{(0,D.z)("selected_metric_action_clicked",{action:"unselect"}),Ze.publishEvent(new x.OO(void 0))},children:"Select new metric"}),(0,t.jsx)(l.I,{variant:"canvas",icon:"compass",tooltip:"Open in explore",onClick:xe.openExploreLink}),(0,t.jsx)(Qe,{trail:Ze}),(0,t.jsx)(l.I,{variant:"canvas",icon:qe?(0,t.jsx)(d.I,{name:"favorite",type:"mono",size:"lg"}):(0,t.jsx)(d.I,{name:"star",type:"default",size:"lg"}),tooltip:"Bookmark",onClick:rt}),Ze.state.embedded&&(0,t.jsx)(o.z9,{href:(0,E.xi)(Ze),variant:"secondary",onClick:()=>(0,D.z)("selected_metric_action_clicked",{action:"open_from_embedded"}),children:"Open"})]})}),(0,t.jsx)(u.U,{children:_e.map((Ot,jt)=>{const Ut=(0,t.jsx)(c.o,{label:Ot.displayName,active:vt===Ot.value,onChangeTab:()=>{(0,D.z)("metric_action_view_changed",{view:Ot.value}),Oe.setActionView(Ot.value)}},jt);return Ot.description?(0,t.jsx)(p.m,{content:Ot.description,placement:"bottom-start",theme:"info",children:Ut},jt):Ut})})]})}}}function it(ze){return{actions:(0,n.css)({[ze.breakpoints.up(ze.breakpoints.values.md)]:{position:"absolute",right:0,top:16,zIndex:2}})}}function dt(ze){return new s.Pj({variables:[...(0,x.ym)(ze),new s.fS({name:x.yr,label:"Group by",datasource:x.GH,includeAll:!0,defaultToAll:!0,query:{query:`label_names(${x.Rp})`,refId:"A"},value:"",text:""})]})}},21028:(_,L,e)=>{"use strict";e.d(L,{t:()=>re});var t=e(74848),n=e(32196),r=e(2543),s=e(96540),a=e(17172),g=e(81887),i=e(40845),l=e(56034),d=e(14578),o=e(88575),u=e(10354),c=e(29158),p=e(90182),h=e(15292),y=e(42418),f=e(8484),v=e(24243),P=e(69096);class m{constructor(){this.config={minGroupSize:3,idealMaxGroupSize:30,maxDepth:100}}parse(ie){if(this.config.maxDepth<=0)throw new Error("Max depth must be greater than 0");if(this.config.minGroupSize<1)throw new Error("Min group size must be greater than 0");if(this.config.idealMaxGroupSize<this.config.minGroupSize)throw new Error("Max group size must be greater than min group size");if(this.config.miscGroupKey&&this.config.miscGroupKey==="")throw new Error("miscGroupKey cannot be empty");return{root:this.parseStrings(ie,0)}}parseStrings(ie,J){const ce={groups:new Map,values:[],descendants:0};for(const Pe of ie){if(Pe.trim()==="")continue;const Ie=D(Pe,J);let ge=ce.groups.get(Ie);ge||(ge={groups:new Map,values:[],descendants:0},ce.groups.set(Ie,ge)),ge.values.push(Pe),ge.descendants++}const pe=[];for(let[Pe,Ie]of ce.groups.entries())Ie.values.length<this.config.minGroupSize?(this.config.miscGroupKey?pe.push(...Ie.values):ce.values.push(...Ie.values),ce.descendants+=Ie.values.length,ce.groups.delete(Pe)):(Ie.values.length>this.config.idealMaxGroupSize&&J<this.config.maxDepth-1&&(Ie=this.parseStrings(Ie.values,J+1),ce.groups.set(Pe,Ie)),ce.descendants+=Ie.descendants);if(this.config.miscGroupKey&&pe.length>0){const Pe={groups:new Map,values:pe,descendants:pe.length};ce.groups.set(this.config.miscGroupKey,Pe)}return ce}}function D(he,ie){let J=0;for(let ce=0;ce<he.length;ce++){const pe=he.charCodeAt(ce);if(!(pe>=48&&pe<=57||pe>=65&&pe<=90||pe>=97&&pe<=122||pe>=192&&pe<=214||pe>=216&&pe<=246||pe>=248&&pe<=255||pe>=256&&pe<=383)&&(J++,J>ie))return he.slice(0,ce)}return he}var x=e(88434),E=e(40588),C=e(84086),b=e(4200),T=e(51080),A=e(55852);class R extends g.Bs{constructor(){super(...arguments),this.onClick=()=>{this.publishEvent(new b.OO(this.state.metric),!0)}}static{this.Component=({model:ie})=>{const{title:J}=ie.useState();return(0,t.jsx)(A.$n,{variant:"secondary",size:"sm",fill:"solid",onClick:ie.onClick,children:J})}}}var S=e(81996);const O="results truncated due to limit";async function j(he,ie,J,ce){const pe=`/api/datasources/uid/${he}/resources/api/v1/label/__name__/values`,Pe={start:(0,S.mv)(ie.from,!1),end:(0,S.mv)(ie.to,!0),...J&&J!=="{}"?{"match[]":J}:{},...ce?{limit:ce}:{}},Ie=await(0,a.AI)().get(pe,Pe,"explore-metrics-names");return ce&&Ie.warnings?.includes(O)?{...Ie,limitReached:!0}:{...Ie,limitReached:!1}}var B=e(47241),N=e(39070),I=e(11261);function K(he){return ie=>{const J=g.jh.getData(ie);J&&J.subscribeToState(ce=>{if(ce.data?.state===N.Gu.Loading||ce.data?.state===N.Gu.Error)return;const pe=g.jh.getAncestor(ie,re);if(!ce.data?.series.length){pe.updateMetricPanel(he,!0,!0);return}let Pe=!1;for(const Ie of ce.data.series){for(const ge of Ie.fields)if(ge.type===I.PU.number&&(Pe=ge.values.some(Se=>Se!=null&&!isNaN(Se)&&Se!==0),Pe))break;if(Pe)break}pe.updateMetricPanel(he,!0,!Pe)})}}function w(he,ie,J,ce){const pe=(0,B.v)(he),Pe=pe.preview.vizBuilder().setColor({mode:"fixed",fixedColor:(0,T.Vy)(ie)}).setDescription(ce).setHeaderActions(new R({metric:he,title:"Select"})).build(),Ie=pe.preview.queries.map(ge=>U(ge,J));return new g.xK({$variables:new g.Pj({variables:(0,b.ym)(he)}),$behaviors:[K(he)],$data:new g.dt({datasource:b.GH,maxDataPoints:b.up,queries:Ie}),body:Pe})}function U(he,ie){const J=ie>0?'${filters},__ignore_usage__=""':'__ignore_usage__=""',ce=he.expr?.replace("${filters}",J);return{...he,expr:ce}}var W=e(51088);function H(he,ie){return he.sort((J,ce)=>{const pe=G(J,ie),Pe=G(ce,ie);return pe.halfLeven+pe.wholeLeven-(Pe.halfLeven+Pe.wholeLeven)})}const z=new Map;function G(he,ie){let J=z.get(he);J||(J=new Map,z.set(he,J));let ce=J.get(ie);if(!ce){const pe=he.split("_"),Pe=pe.slice(0,pe.length/2).join("_"),Ie=(0,W.A)(Pe,ie)||0,ge=(0,W.A)(he,ie)||0;ce={halfLeven:Ie,wholeLeven:ge},J.set(ie,ce)}return ce}const M=/[^a-z0-9_:]+/;function Q(he){return he?.toLowerCase().split(M).filter(ie=>ie.length>0)||[]}function Y(he){const ie=Q(he).map(ce=>`(?=(.*${ce.toLowerCase()}.*))`);if(ie.length===0)return null;const J=ie.join("");return new RegExp(J,"igy")}function q(he){const ie=te(Q(he)).filter(pe=>pe.length>0).map(pe=>`(.*${pe.toLowerCase()}.*)`),J=ie.length;return ie.length===0?null:`(?i:${ie.join("|")}){${J}}`}function te(he=[]){const ie=new Set(he.map(J=>J.toLowerCase().trim()));return Array.from(ie)}const X="175px",ee="64px",ne="all",Z=2e4,ae="View by the metric prefix. A metric prefix is a single word at the beginning of the metric name, relevant to the domain the metric belongs to.";class re extends g.Bs{constructor(ie){super({$variables:ie.$variables,metricPrefix:ie.metricPrefix??ne,body:ie.body??new g.gF({children:[],templateColumns:"repeat(auto-fill, minmax(450px, 1fr))",autoRows:X,isLazy:!0}),...ie}),this.previewCache={},this.ignoreNextUpdate=!1,this._debounceRefreshMetricNames=(0,r.debounce)(()=>this._refreshMetricNames(),1e3),this._urlSync=new g.So(this,{keys:["metricPrefix"]}),this._variableDependency=new g.Sh(this,{variableNames:[b.EY,b.Ao],onReferencedVariableValueChanged:J=>{this._debounceRefreshMetricNames()}}),this.updateMetricPanel=(J,ce,pe)=>{const Pe=this.previewCache[J];Pe&&(Pe.isEmpty=pe,Pe.loaded=ce,this.previewCache[J]=Pe,this.state.metricPrefix==="All"&&this.buildLayout())},this.onSearchQueryChange=J=>{const ce=J.currentTarget.value;(0,T.kj)(this).setState({metricSearch:ce})},this.onPrefixFilterChange=J=>{this.setState({metricPrefix:J.value}),this._refreshMetricNames()},this.reportPrefixFilterInteraction=J=>{const ce=(0,T.kj)(this),{steps:pe,currentStep:Pe}=ce.state.history.state,ge=pe[Pe]?.trailState.metric!==void 0;(0,E.z)("prefix_filter_clicked",{from:ge?"related_metrics":"metric_list",action:J?"open":"close"})},this.onToggleOtelExperience=()=>{const J=(0,T.kj)(this),ce=J.state.useOtelExperience;J.setState({useOtelExperience:!ce})},this.addActivationHandler(this._onActivate.bind(this))}getUrlState(){return{metricPrefix:this.state.metricPrefix}}updateFromUrl(ie){typeof ie.metricPrefix=="string"&&this.state.metricPrefix!==ie.metricPrefix&&this.setState({metricPrefix:ie.metricPrefix})}_onActivate(){this.state.body.state.children.length===0?this.buildLayout():this.ignoreNextUpdate=!0;const ie=(0,T.kj)(this);this._subs.add(ie.subscribeToEvent(b.OO,J=>{const{steps:ce,currentStep:pe}=ie.state.history.state,Pe=ce[pe].parentIndex,ge=ce[Pe].trailState.metric!==void 0;if(J.payload!==void 0){const Se=le(ie),De=Q(Se).length;(0,E.z)("metric_selected",{from:ge?"related_metrics":"metric_list",searchTermCount:De})}})),this._subs.add(ie.subscribeToEvent(g.bZ,J=>{if(J.payload.changedObject instanceof g.JZ){const{prevState:ce,newState:pe}=J.payload;if((0,T.iG)(ce)&&(0,T.iG)(pe)&&ce.from===pe.from&&ce.to===pe.to)return}})),this._subs.add(ie.subscribeToState(({metricSearch:J},ce)=>{const pe=Q(ce.metricSearch),Pe=Q(J);(0,r.isEqual)(pe,Pe)||this._debounceRefreshMetricNames()})),this.subscribeToState((J,ce)=>{J.metricNames!==ce.metricNames&&this.onMetricNamesChanged()}),this._subs.add(ie.subscribeToState(({otelTargets:J},ce)=>{J?.instances!==ce.otelTargets?.instances&&J?.jobs!==ce.otelTargets?.jobs&&this._debounceRefreshMetricNames()})),this._subs.add(ie.subscribeToState(({useOtelExperience:J},ce)=>{this._debounceRefreshMetricNames()})),this._subs.add(ie.subscribeToState(({showPreviews:J},ce)=>{this.buildLayout()})),this._debounceRefreshMetricNames()}async _refreshMetricNames(){const ie=(0,T.kj)(this),J=ie.state.$timeRange?.state;if(!J)return;const ce=[],pe=g.jh.lookupVariable(b.Ao,this);pe instanceof g.H9&&pe.getValue()?.valueOf()&&ce.push(g.jh.interpolate(ie,"${filters}"));const Ie=q(ie.state.metricSearch);Ie&&ce.push(`__name__=~"${Ie}"`);let ge=!1,Se=!1;if(ie.state.useOtelExperience){const Me=ie.state.otelTargets?.jobs,be=ie.state.otelTargets?.instances;if(Me&&Me.length>0&&be&&be.length>0){const we=(0,C.GX)(ce,Me,be,Se);Se=we.missingOtelTargets,ce.push(we.jobsRegex),ce.push(we.instancesRegex)}else ge=!0}const De=`{${ce.join(",")}}`,Ke=g.jh.interpolate(ie,b.gR);this.setState({metricNamesLoading:!0,metricNamesError:void 0,metricNamesWarning:void 0});try{const Me=await j(Ke,J,De,Z),be=Y(le(this));let we=be?Me.data.filter(pt=>!be||be.test(pt)):Me.data;const Be=we,He=this.state.metricPrefix;if(He&&He!=="all"){const pt=new RegExp(`(^${He}.*)`,"igy");we=we.filter(bt=>!pt||pt.test(bt))}let Ve=Me.limitReached?`This feature will only return up to ${Z} metric names for performance reasons. This limit is being exceeded for the current data source. Add search terms or label filters to narrow down the number of metric names returned.`:void 0;ge&&(we=[],Ve=void 0),Se&&(Ve=`${Ve??""} The list of metrics is not complete. Select more OTel resource attributes to see a full list of metrics.`);let Je=this.state.body,nt=this.state.rootGroup;nt=await this.generateGroups(Be),this.setState({metricNames:we,rootGroup:nt,body:Je,metricNamesLoading:!1,metricNamesWarning:Ve,metricNamesError:Me.error})}catch(Me){let be="Unknown error";(0,a.NF)(Me)&&(Me.cancelled?be="Request cancelled":Me.statusText&&(be=Me.statusText)),this.setState({metricNames:void 0,metricNamesLoading:!1,metricNamesError:be})}}async generateGroups(ie=[]){const J=new m;J.config={...J.config,maxDepth:2,minGroupSize:2,miscGroupKey:"misc"};const{root:ce}=J.parse(ie);return ce}onMetricNamesChanged(){const ie=this.state.metricNames||[],J=new Set(ie);Object.values(this.previewCache).forEach(ge=>{J.has(ge.name)||(ge.isEmpty=!0)});const ce=(0,T.kj)(this),pe=ce.state.metric!==void 0?H(ie,ce.state.metric):ie,Pe={},Ie=120;Object.keys(this.previewCache).forEach(ge=>{J.has(ge)||delete this.previewCache[ge]});for(let ge=0;ge<pe.length;ge++){const Se=pe[ge];if(Object.keys(Pe).length>Ie)break;const Ke=this.previewCache[Se]||{name:Se,index:ge,loaded:!1};Pe[Se]=Ke}try{const ge=g.jh.getAncestor(this,v.R).state.metric;delete Pe[ge]}catch{}this.previewCache=Pe,this.buildLayout()}sortedPreviewMetrics(){return Object.values(this.previewCache).sort((ie,J)=>ie.isEmpty&&J.isEmpty?ie.index-J.index:ie.isEmpty?1:J.isEmpty?-1:ie.index-J.index)}async buildLayout(){const ie=(0,T.kj)(this),J=ie.state.showPreviews;if(this.ignoreNextUpdate){this.ignoreNextUpdate=!1;return}const ce=[],pe=this.sortedPreviewMetrics(),Ie=(0,T.gA)(this)?.length||0;for(let Se=0;Se<pe.length;Se++){const De=pe[Se],Ke=await ie.getMetricMetadata(De.name),Me=(0,x.R)(Ke);if(J){if(De.itemRef&&De.isPanel){ce.push(De.itemRef.resolve());continue}const be=w(De.name,Se,Ie,Me);De.itemRef=be.getRef(),De.isPanel=!0,ce.push(be)}else{const be=new g.xK({$variables:new g.Pj({variables:(0,b.ym)(De.name)}),body:se(De.name,Me)});De.itemRef=be.getRef(),De.isPanel=!1,ce.push(be)}}const ge=J?X:ee;this.state.body.setState({children:ce,autoRows:ge})}static{this.Component=({model:ie})=>{const{body:J,metricNames:ce,metricNamesError:pe,metricNamesLoading:Pe,metricNamesWarning:Ie,rootGroup:ge,metricPrefix:Se}=ie.useState(),{children:De}=J.useState(),Ke=(0,T.kj)(ie),Me=(0,i.of)(de),[be,we]=(0,s.useReducer)(()=>!0,!1),{metricSearch:Be,useOtelExperience:He,hasOtelResources:Ve,isStandardOtel:Je}=Ke.useState(),nt=De.length===0&&Be,pt=!Pe&&ce&&ce.length===0,bt=Pe&&De.length===0,Tt=bt?void 0:pt&&"There are no results found. Try a different time range or a different data source."||nt&&"There are no results found. Try adjusting your search or filters."||void 0,ye=Ie?(0,t.jsx)(l.m,{content:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:"Unable to retrieve metric names"}),(0,t.jsx)("p",{children:Ie})]}),children:(0,t.jsx)(d.I,{className:Me.warningIcon,name:"exclamation-triangle"})}):void 0;return(0,t.jsxs)("div",{className:Me.container,children:[(0,t.jsxs)("div",{className:Me.header,children:[(0,t.jsx)(o.D,{label:"Search metrics",className:Me.searchField,children:(0,t.jsx)(u.p,{placeholder:"Search metrics",prefix:(0,t.jsx)(d.I,{name:"search"}),value:Be,onChange:ie.onSearchQueryChange,suffix:ye})}),(0,t.jsx)(o.D,{label:(0,t.jsxs)("div",{className:Me.displayOptionTooltip,children:[(0,t.jsx)(f.x6,{i18nKey:"explore-metrics.viewBy",children:"View by"}),(0,t.jsx)(c.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:ae})]}),className:Me.displayOption,children:(0,t.jsx)(p.l6,{value:Se,onChange:ie.onPrefixFilterChange,onOpenMenu:()=>ie.reportPrefixFilterInteraction(!0),onCloseMenu:()=>ie.reportPrefixFilterInteraction(!1),options:[{label:"All metric names",value:ne},...Array.from(ge?.groups.keys()??[]).map(je=>({label:`${je}_`,value:je}))]})}),Ve&&(0,t.jsx)(o.D,{label:(0,t.jsxs)("div",{className:Me.displayOptionTooltip,children:[(0,t.jsx)(f.x6,{i18nKey:"trails.metric-select.filter-by",children:"Filter by"}),(0,t.jsx)(c.K,{name:"info-circle",size:"sm",variant:"secondary",tooltip:(0,t.jsx)(f.x6,{i18nKey:"trails.metric-select.otel-switch",children:"This switch enables filtering by OTel resources for OTel native data sources."})})]}),className:Me.displayOption,children:(0,t.jsx)("div",{title:Je?"":"This setting is disabled because this is not an OTel native data source.",children:(0,t.jsx)(h.K,{disabled:!Je,showLabel:!0,label:"Otel experience",value:He,onChange:ie.onToggleOtelExperience})})})]}),pe&&(0,t.jsxs)(y.F,{title:"Unable to retrieve metric names",severity:"error",children:[(0,t.jsx)("div",{children:"We are unable to connect to your data source. Double check your data source URL and credentials."}),(0,t.jsxs)("div",{children:["(",pe,")"]})]}),Ie&&!be&&(0,t.jsx)(y.F,{title:"Unable to retrieve all metric names",severity:"warning",onSubmit:we,onRemove:we,children:(0,t.jsx)("div",{children:Ie})}),(0,t.jsxs)(P.O,{isLoading:bt,blockingMessage:Tt,children:[J instanceof g.G1&&(0,t.jsx)(J.Component,{model:J}),J instanceof g.gF&&(0,t.jsx)(J.Component,{model:J})]})]})}}}function se(he,ie){return g.d0.text().setTitle(he).setDescription(ie).setHeaderActions(new R({metric:he,title:"Select"})).setOption("content","").build()}function de(he){return{container:(0,n.css)({display:"flex",flexDirection:"column"}),headingWrapper:(0,n.css)({marginBottom:he.spacing(.5)}),header:(0,n.css)({flexGrow:0,display:"flex",gap:he.spacing(2),marginBottom:he.spacing(2),alignItems:"flex-end"}),searchField:(0,n.css)({flexGrow:1,marginBottom:0}),metricTabGroup:(0,n.css)({marginBottom:he.spacing(2)}),displayOption:(0,n.css)({flexGrow:0,marginBottom:0,minWidth:"184px"}),displayOptionTooltip:(0,n.css)({display:"flex",gap:he.spacing(1)}),warningIcon:(0,n.css)({color:he.colors.warning.main})}}function le(he){return(0,T.kj)(he).state.metricSearch||""}},90623:(_,L,e)=>{"use strict";e.d(L,{p:()=>s});var t=e(74848),n=e(67061),r=e(94753);const s=()=>(0,t.jsxs)(n.B,{direction:"column",gap:1,children:[(0,t.jsx)(r.E,{variant:"h1",children:"Metrics"}),(0,t.jsx)(r.E,{color:"secondary",children:"Explore your Prometheus-compatible metrics without writing a query"})]})},69096:(_,L,e)=>{"use strict";e.d(L,{O:()=>a});var t=e(74848),n=e(32196),r=e(40845),s=e(39558);function a({blockingMessage:i,isLoading:l,children:d}){const o=(0,r.of)(g);return l&&!i&&(i="Loading..."),l?(0,t.jsx)(s._,{className:o.statusMessage,text:i}):i?(0,t.jsx)("div",{className:o.statusMessage,children:i}):d}function g(i){return{statusMessage:(0,n.css)({fontStyle:"italic",marginTop:i.spacing(7),textAlign:"center",width:"100%"})}}},74764:(_,L,e)=>{"use strict";e.d(L,{yn:()=>P,_r:()=>D});var t=e(2543),n=e(76885),r=e(81887),s=e(99140),a=e(16001),g=e(73145),i=e(4200),l=e(51080),d=e(74848),o=e(67061),u=e(55852),c=e(3169);function p(){const E=(0,c.tZ)("Bookmark created");return E.component=(0,d.jsxs)(o.B,{gap:2,direction:"row",children:[(0,d.jsxs)("div",{children:["You can view bookmarks under ",(0,d.jsx)("i",{children:"Explore > Metrics"})]}),(0,d.jsx)(u.z9,{fill:"solid",variant:"secondary",href:i.QX,children:"View bookmarks"})]}),E}const h=20;class y{constructor(){this._recent=[],this._bookmarks=[],this._bookmarkIndexMap=new Map,this.load();const C=()=>{const b=this._recent.slice(0,h).map(T=>this._serializeTrail(T.resolve()));localStorage.setItem(i.sQ,JSON.stringify(b)),localStorage.setItem(i.jT,JSON.stringify(this._bookmarks))};this._save=(0,t.debounce)(C,1e3),window.addEventListener("beforeunload",b=>{this._save=C})}_loadRecentTrailsFromStorage(){const C=[],b=localStorage.getItem(i.sQ);if(b){const T=JSON.parse(b);for(const A of T){const R=this._deserializeTrail(A);C.push(R.getRef())}}return C}_loadBookmarksFromStorage(){const C=localStorage.getItem(i.jT);return(C?JSON.parse(C):[]).map(T=>{if(x(T)){const A=T.currentStep!=null?T.currentStep:T.history.length-1;return{urlValues:T.history[A].urlValues,createdAt:T.createdAt||Date.now()}}return T})}_deserializeTrail(C){const b=new g.b({createdAt:C.createdAt});C.history.map(A=>{this._loadFromUrl(b,A.urlValues);const R=A.parentIndex??b.state.history.state.steps.length-1;b.state.history.setState({currentStep:R}),b.state.history.addTrailStepFromStorage(b,A)});const T=C.currentStep??b.state.history.state.steps.length-1;return b.state.history.setState({currentStep:T}),b.setState(r.Go.cloneSceneObjectState(b.state.history.state.steps[T].trailState,{history:b.state.history})),b}_serializeTrail(C){return{history:C.state.history.state.steps.map(T=>{const A=new g.b(r.Go.cloneSceneObjectState(T.trailState));return{urlValues:r.Go.getUrlState(A),type:T.type,description:T.description,parentIndex:T.parentIndex}}),currentStep:C.state.history.state.currentStep,createdAt:C.state.createdAt}}getTrailForBookmarkIndex(C){const b=this._bookmarks[C];return b?this.getTrailForBookmark(b):(0,l.ef)()}getTrailForBookmark(C){const b=P(C);for(const A of this._recent){const R=A.resolve();if(P(R)===b)return R}const T=new g.b({});return this._loadFromUrl(T,C.urlValues),T}_loadFromUrl(C,b){const T=n.kM.renderUrl("",b);r.Go.syncStateFromSearchParams(C,new URLSearchParams(T))}get recent(){return this._recent}load(){this._recent=this._loadRecentTrailsFromStorage(),this._bookmarks=this._loadBookmarksFromStorage(),this._refreshBookmarkIndexMap()}setRecentTrail(C){const{steps:b}=C.state.history.state;if(b.length===0||b.length===1&&b[0].type==="start")return;this._recent=this._recent.filter(A=>A!==C.getRef());const T=f(C);this._recent=this._recent.filter(A=>{const R=f(A.resolve());return!(0,t.isEqual)(T,R)}),this._recent.unshift(C.getRef()),this._save()}get bookmarks(){return this._bookmarks}addBookmark(C){const T={urlValues:r.Go.getUrlState(C),createdAt:Date.now()};this._bookmarks.unshift(T),this._refreshBookmarkIndexMap(),this._save(),(0,s.JD)((0,a.dx)(p()))}removeBookmark(C){C<this._bookmarks.length&&(this._bookmarks.splice(C,1),this._refreshBookmarkIndexMap(),this._save())}getBookmarkIndex(C){const b=P(C);return this._bookmarkIndexMap.get(b)}_refreshBookmarkIndexMap(){this._bookmarkIndexMap.clear(),this._bookmarks.forEach((C,b)=>{const T=P(C);this._bookmarkIndexMap.set(T,b)})}}function f(E){const C=r.Go.getUrlState(E);return v(C),C}function v(E){return delete E.actionView,delete E.layout,delete E.metricSearch,delete E.refresh,(E["var-groupby"]===""||E["var-groupby"]===void 0)&&(E["var-groupby"]="$__all"),typeof E["var-filters"]!="string"&&(E["var-filters"]=E["var-filters"]?.filter(C=>C!=="")),E}function P(E){return E instanceof g.b?JSON.stringify(f(E)):JSON.stringify(v({...E.urlValues}))}let m;function D(){return m||(m=new y),m}function x(E){return E!=null&&typeof E=="object"&&"history"in E}},88434:(_,L,e)=>{"use strict";e.d(L,{R:()=>g,q:()=>a});var t=e(75212),n=e(50556),r=e(19347),s=e(4200);class a{constructor(l){this._trail=l}reset(){this._datasource=void 0,this._metricsMetadata=void 0}async getDatasource(){return this._datasource||(this._datasource=(0,r.l)().get(s.gR,{__sceneObject:{value:this._trail}})),await this._datasource}async _getMetricsMetadata(){const l=await this.getDatasource();if(l.languageProvider instanceof n.Ay)return l.languageProvider.metricsMetadata||await l.languageProvider.loadMetricsMetadata(),l.languageProvider.metricsMetadata}async getMetricMetadata(l){return l?(this._metricsMetadata||(this._metricsMetadata=this._getMetricsMetadata()),(await this._metricsMetadata)?.[l]):void 0}async getTagKeys(l){const d=await this.getDatasource();return d instanceof t.UD?await d.getTagKeys(l):[]}async getTagValues(l){const d=await this.getDatasource();return d instanceof t.UD?await d.getTagValues(l):[]}}function g(i){if(!i)return;const{type:l,help:d,unit:o}=i;return[d,l&&`**Type:** *${l}*`,o&&`**Unit:** ${o}`].join(`

`)}},40588:(_,L,e)=>{"use strict";e.d(L,{h:()=>s,z:()=>r});var t=e(14110);const n="grafana_explore_metrics_";function r(a,g){(0,t.rR)(`${n}${a}`,g)}function s(a,g){if(a.length===g.length)for(const i of g)for(const l of a)i.key===l.key&&i.value!==l.value&&r("label_filter_changed",{label:i.key,action:"changed",cause:"adhoc_filter"});else if(a.length<g.length)for(const i of g){let l=!1;for(const d of a)if(i.key===d.key){l=!0;break}l||r("label_filter_changed",{label:i.key,action:"removed",cause:"adhoc_filter"})}else for(const i of a){let l=!1;for(const d of g)if(d.key===i.key){l=!0;break}l||r("label_filter_changed",{label:i.key,action:"added",cause:"adhoc_filter"})}}},84086:(_,L,e)=>{"use strict";e.d(L,{Dz:()=>g,GX:()=>i,L4:()=>a,ql:()=>s});var t=e(81887),n=e(4200);const r=()=>({cloud_availability_zone:0,cloud_region:0,container_name:0,k8s_cluster_name:0,k8s_container_name:0,k8s_cronjob_name:0,k8s_daemonset_name:0,k8s_deployment_name:0,k8s_job_name:0,k8s_namespace_name:0,k8s_pod_name:0,k8s_replicaset_name:0,k8s_statefulset_name:0,service_instance_id:0,service_name:0,service_namespace:0});function s(l,d){const o=r(),u=Object.keys(o);return l=l.filter(p=>{const h=(p.value??"").toString();return u.includes(h)?(o[h]=1,!1):!0}),Object.keys(o).filter(p=>o[p]&&!d.includes(p)).map(p=>({text:p})).concat(l)}function a(l){let d="";return l.filters&&l.labels&&(d=`* on (job, instance) group_left(${l.labels}) topk by (job, instance) (1, target_info{${l.filters}})`),d}function g(l,d){const o=t.jh.lookupVariable(n.DU,l),u=t.jh.lookupVariable(n.p4,l);let c={labels:"",filters:""};if(o instanceof t.H9&&u instanceof t.yP){const p=o.state.filters;let h=String(u.getValue());const y=h.includes(",");let f="=",v=d||h;y&&(f="=~",v=v.split(",").join("|"));let P=`deployment_environment${f}"${v}"`,m="deployment_environment";for(let D=0;D<p?.length;D++){const x=p[D].key,E=p[D].operator,C=p[D].value;P+=`,${x}${E}"${C}"`,x!=="job"&&x!=="instance"&&(m+=`,${x}`)}return c.labels=m,c.filters=P,c}return c}function i(l,d,o,u){let p=l.join(",").length,h='job=~"',y='instance=~"';for(let f=0;f<d.length;f++){const v=f===0?0:2;if(p+h.length+d[f].length+y.length+o[f].length+v<=2e3)f===0?(h+=`${d[f]}`,y+=`${o[f]}`):(h+=`|${d[f]}`,y+=`|${o[f]}`);else{u=!0;break}}return h+='"',y+='"',{missingOtelTargets:u,jobsRegex:h,instancesRegex:y}}},4200:(_,L,e)=>{"use strict";e.d(L,{Ao:()=>g,DU:()=>f,EY:()=>c,GH:()=>b,Mi:()=>B,OO:()=>N,Pp:()=>R,QX:()=>a,Rp:()=>d,Xt:()=>D,aZ:()=>u,dc:()=>O,gR:()=>p,jT:()=>A,km:()=>s,p4:()=>P,sQ:()=>T,tM:()=>x,td:()=>E,ui:()=>i,up:()=>S,ym:()=>j,yr:()=>o});var t=e(65463),n=e(81887),r=e(79422);const s="/explore/metrics/trail",a="/explore/metrics",g="filters",i="{${filters}}",l="metric",d="${metric}",o="groupby",u="${groupby}",c="ds",p="${ds}",h="logsDs",y="${logsDs}",f="otel_resources",v="${otel_resources}",P="deployment_environment",m="${deployment_environment}",D="otel_join_query",x="${otel_join_query}",E="$__logs__",C="sqr-metric-viz-query",b={uid:p},T="grafana.trails.recent",A="grafana.trails.bookmarks",R="grafana.trails.breakdown.view",S=250,O=500;function j(I){return[new n.x0({name:l,value:I,hide:r.zL.hideVariable})]}function B(I){return[new n.x0({name:D,value:I,hide:r.zL.hideVariable})]}class N extends t.x{static{this.type="metric-selected-event"}}},51080:(_,L,e)=>{"use strict";e.d(L,{FG:()=>b,KE:()=>u,U4:()=>f,Vy:()=>D,aM:()=>y,aO:()=>P,ef:()=>c,gA:()=>E,hR:()=>m,iG:()=>x,kj:()=>o,nH:()=>v,xi:()=>p});var t=e(76885),n=e(19347),r=e(32264),s=e(81887),a=e(31193),g=e(73145),i=e(24243),l=e(74764),d=e(4200);function o(T){return s.jh.getAncestor(T,g.b)}function u(T){return s.jh.getAncestor(T,g.b).state.settings}function c(T){return new g.b({initialDS:T,$timeRange:new s.JZ({from:"now-1h",to:"now"}),embedded:!1})}function p(T){const A=s.Go.getUrlState(T);return h(A)}function h(T){return t.kM.renderUrl(d.km,T)}function y(T){if(T instanceof i.R)return T;if(T.parent)return y(T.parent);throw console.error("Unable to find graph view for",T),new Error("Unable to find trail")}function f(T){return s.jh.interpolate(T,d.gR)}function v(T){return(0,n.l)().getInstanceSettings(T)?.name||T}function P(T){return T?T===d.td?"Logs":T:"Select metric"}function m(){const T=(0,l._r)().recent[0];if(T){const R=s.jh.interpolate(T.resolve(),d.gR);if(typeof R=="string"&&R.length>0)return R}const A=(0,a.tR)().getList({type:"prometheus"});if(A.length>0)return A.find(R=>R.uid===r.$.defaultDatasource)?.uid??A[0].uid}function D(T){const A=r.$.theme2.visualization;return A.getColorByName(A.palette[T%8])}function x(T){const A=Object.keys(T);return A.includes("from")&&A.includes("to")}function E(T){const A=s.jh.lookupVariable("filters",T);return A instanceof s.H9?A.state.filters:null}const C=1e4;function b(T,A){T instanceof s.H9&&T.setState({getTagKeysProvider:async(R,S)=>{const O=T.state.filters;return{replace:!0,values:(await A.getTagKeys({filters:O})).slice(0,C)}},getTagValuesProvider:async(R,S)=>{const j=T.state.filters.filter(N=>N.key!==S.key);return{replace:!0,values:(await A.getTagValues({key:S.key,filters:j})).slice(0,C)}}})}},27825:(_,L,e)=>{"use strict";e.d(L,{J:()=>f});var t=e(52622),n=e(38248),r=e(74848),s=e(96540),a=e(91890),g=e(72574),i=e(32264),l=e(66864),d=e(94354),o=e(10354),u=e(88841),c=e(94397);const p=[{label:"Size",value:t.J1.Size,description:"Split the buckets based on size"},{label:"Count",value:t.J1.Count,description:"Split the buckets based on count"}],h=[{label:"Split",value:t.J1.Size,description:"Split the buckets based on size"}],y=({value:v,onChange:P,item:m})=>{const[D,x]=(0,s.useState)(!1),E=T=>{x(!(0,c.N_)(T)),P({...v,value:T})},b=(0,g.w)().getVariables().map(T=>({value:T.name,label:T.label||T.name,origin:a.$0.Template}));return(0,r.jsxs)(l.Gy,{children:[(0,r.jsx)(d.z,{value:v?.mode||t.J1.Size,options:v?.scale?.type===t.L4.Log?h:p,onChange:T=>{P({...v,mode:T})}}),i.$.featureToggles.transformationsVariableSupport?(0,r.jsx)(u.y,{invalid:D,error:"Value needs to be an integer or a variable",value:v?.value??"",placeholder:"Auto",onChange:E,suggestions:b}):(0,r.jsx)(o.p,{value:v?.value??"",placeholder:"Auto",onChange:T=>{P({...v,value:T.currentTarget.value})}})]})};function f(v,P,m,D){P.addCustomEditor({id:"xBuckets",path:`${v}xBuckets`,name:"X Bucket",editor:y,category:D,defaultValue:{mode:t.J1.Size}}),P.addCustomEditor({id:"yBuckets",path:`${v}yBuckets`,name:"Y Bucket",editor:y,category:D,defaultValue:{mode:t.J1.Size}}),P.addCustomEditor({id:"yBuckets-scale",path:`${v}yBuckets.scale`,name:"Y Bucket scale",category:D,editor:n.W,defaultValue:{type:t.L4.Linear}})}},80909:(_,L,e)=>{"use strict";e.d(L,{VQ:()=>H,wY:()=>B,Nb:()=>w,eE:()=>K,yJ:()=>U});var t=e(81160),n=e(18282),r=e(81010),s=e(11261),a=e(28240),g=e(83195),i=e(41260),l=e(70416),d=e(77678),o=e(73060),u=e(32264),c=e(52622),p=e(97706);const{abs:h,pow:y}=Math,f=new Map;function v(Q,Y,q,te){let X=[],ee=te.map(p.E);for(let ne=Y;ne<q;ne++){let Z=h(ne),ae=(0,p.h)(y(Q,ne),Z);for(let re=0;re<te.length;re++){let se=te[re]*ae,de=(se>=0&&ne>=0?0:Z)+(ne>=ee[re]?0:ee[re]),le=(0,p.h)(se,de);X.push(le),f.set(le,de)}}return X}const P=Q=>Q%1===0,m=[1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8,8.5,9,9.5],D=v(10,-16,0,m),x=v(10,0,16,m),E=x.filter(P),C=D.concat(x),b=D.concat(E),T=1*1e3,A=60*T,R=60*A,S=24*R,O=365*S,j=[1,2,4,5,10,20,25,40,50,100,200,250,400,500,T,2*T,4*T,5*T,10*T,15*T,20*T,30*T,A,2*A,4*A,5*A,10*A,15*A,20*A,30*A,R,2*R,4*R,6*R,8*R,12*R,18*R,S,2*S,3*S,4*S,5*S,6*S,7*S,10*S,15*S,30*S,45*S,60*S,90*S,180*S,O,2*O,3*O,4*O,5*O,6*O,7*O,8*O,9*O,10*O],B={id:n.F.heatmap,name:"Create heatmap",description:"Generate heatmap data from source data.",defaultOptions:{},isApplicable:Q=>{const{xField:Y,yField:q,xs:te,ys:X}=z(Q);return Y||q||!te.length||!X.length?r.M.NotPossible:r.M.Applicable},isApplicableDescription:"The Heatmap transformation requires fields with Heatmap compatible data. No fields with Heatmap data could be found.",operator:(Q,Y)=>q=>q.pipe((0,t.T)(te=>{if(u.$.featureToggles.transformationsVariableSupport){const X={...Q,xBuckets:{...Q.xBuckets},yBuckets:{...Q.yBuckets}};return X.xBuckets?.value&&(X.xBuckets.value=Y.interpolate(X.xBuckets.value)),X.yBuckets?.value&&(X.yBuckets.value=Y.interpolate(X.yBuckets.value)),B.transformer(X,Y)(te)}else return B.transformer(Q,Y)(te)})),transformer:Q=>Y=>{const q=H(Y,Q);return Q.keepOriginalData?[q,...Y]:[q]}};function N(Q){return Q==="+Inf"?1/0:Q==="-Inf"?-1/0:+(Q??0)}function I(Q,Y){return N(Q)-N(Y)}function K(Q){return Q?.meta?.custom??{}}function w(Q){let Y=!1;for(let q of Q.fields)switch(q.name){case"y":case"yMin":case"yMax":if(Y)return!1;Y=!0}return Y}function U(Q){const Y=Q.frame.fields[0],q=Y.values,te=Q.frame.fields.filter((he,ie)=>he.type===s.PU.number&&ie>0),X=q.length*te.length,ee=new Array(X),ne=new Array(X),Z=new Array(X),ae=te.map(he=>he.values.slice());ae.forEach((he,ie)=>{for(let J=0;J<he.length;J++)Z[ae.length*J+ie]=he[J]});const re=Array.from({length:te.length},(he,ie)=>ie);for(let he=0,ie=0,J=0;he<X;ie=++he%re.length)ne[he]=re[ie],ie===0&&he>=re.length&&J++,ee[he]=q[J];let se=te[0].labels?.le!=null?"yMax":"y";switch(Q.layout){case c.D7.le:se="yMax";break;case c.D7.ge:se="yMin";break;case c.D7.unknown:se="y";break}const de={yOrdinalDisplay:te.map(he=>(0,a.Ct)(he,Q.frame)),yMatchWithLabel:Object.keys(te[0].labels??{})[0]};if(de.yMatchWithLabel&&(de.yOrdinalLabel=te.map(he=>he.labels?.[de.yMatchWithLabel]??""),de.yMatchWithLabel==="le"&&(de.yMinDisplay="0.0")),Q.unit?.length||Q.decimals!=null){const he=(0,g.j_)(Q.unit??"short");de.yMinDisplay&&(de.yMinDisplay=(0,g.cN)(he(0,Q.decimals))),de.yOrdinalDisplay=de.yOrdinalDisplay.map(ie=>{let J=+ie;return Number.isNaN(J)?ie:(0,g.cN)(he(J,Q.decimals))})}const le={...te[0].config};return le.displayNameFromDS&&delete le.displayNameFromDS,{length:ee.length,refId:Q.frame.refId,meta:{type:i.m.HeatmapCells,custom:de},fields:[{name:Y.type===s.PU.time?"xMax":"x",type:Y.type,values:ee,config:Y.config},{name:se,type:s.PU.number,values:ne,config:{unit:"short"}},{name:Q.value?.length?Q.value:"Value",type:s.PU.number,values:Z,config:le,display:te[0].display}]}}function W(Q){Q=Q.slice(),Q.sort((q,te)=>I(q.name,te.name));const Y=Q.map(q=>q.fields[1].values.slice());return Y.reverse(),Y.forEach((q,te)=>{if(te<Y.length-1)for(let X=0;X<q.length;X++)q[X]-=Y[te+1][X]}),Y.reverse(),Q.map((q,te)=>({...q,fields:[q.fields[0],{...q.fields[1],values:Y[te]}]}))}function H(Q,Y){const{xField:q,yField:te,xs:X,ys:ee}=z(Q);if(!q||!te)throw"no heatmap fields found";if(!X.length||!ee.length)throw"no values found";const ne=Y.xBuckets??{},Z=Y.yBuckets??{};if(ne.scale?.type===c.L4.Log)throw"X axis only supports linear buckets";const ae=Y.yBuckets?.scale??{type:c.L4.Linear},re=G(X,ee,{xSorted:(0,o.g2)(X),xTime:q.type===s.PU.time,xMode:ne.mode,xSize:ne.mode===c.J1.Size?(0,l.WT)((0,l.E9)(ne.value??"")):ne.value?+ne.value:void 0,yMode:Z.mode,ySize:Z.value?+Z.value:void 0,yLog:ae?.type===c.L4.Log?ae?.log:void 0,xMin:Y.timeRange?.from.valueOf(),xMax:Y.timeRange?.to.valueOf()});return{length:re.x.length,name:(0,a.Ct)(te),meta:{type:i.m.HeatmapCells},fields:[{name:"xMin",type:q.type,values:re.x,config:q.config},{name:"yMin",type:s.PU.number,values:re.y,config:{...te.config,custom:{scaleDistribution:ae}}},{name:"Count",type:s.PU.number,values:re.count,config:{unit:"short"}}]}}function z(Q){let Y,q,te=0;for(let Z of Q)Z.fields.find(re=>re.type===s.PU.time)&&(te+=Z.length);let X=Array(te),ee=Array(te),ne=0;for(let Z of Q){const ae=Z.fields.find(se=>se.type===s.PU.time);if(!ae)continue;Y||(Y=ae);const re=ae.values;for(let se of Z.fields)if(se!==ae&&se.type===s.PU.number){const de=se.values;for(let le=0;le<re.length;le++,ne++)X[ne]=re[le],ee[ne]=de[le];q||(q=se)}}return{xField:Y,yField:q,xs:X,ys:ee}}function G(Q,Y,q){let te=Q.length,X=q?.xSorted??!1,ee=q?.ySorted??!1,ne=q?.xMin??(X?Q[0]:1/0),Z=ee?Y[0]:1/0,ae=q?.xMax??(X?Q[te-1]:-1/0),re=ee?Y[te-1]:-1/0,se=q?.yLog,de=q?.xMin!=null&&q?.xMax!=null,le=q?.yMin!=null&&q?.yMax!=null;for(let He=0;He<te;He++)!X&&!de&&(ne=Math.min(ne,Q[He]),ae=Math.max(ae,Q[He])),!ee&&!le&&(!se||Y[He]>0)&&(Z=Math.min(Z,Y[He]),re=Math.max(re,Y[He]));let he=q?.xSize??0,ie=q?.ySize??0,J=q?.xMode,ce=q?.yMode;if((!Number.isFinite(he)||he<=0)&&(J=c.J1.Count,he=20),(!Number.isFinite(ie)||ie<=0)&&(ce=c.J1.Count,ie=10),J===c.J1.Count){let He=(ae-ne)/Math.max(he-1,1),Ve=q?.xTime?j:b,Je=Ve.findIndex(nt=>nt>He)-1;he=Ve[Math.max(Je,0)]}if(ce===c.J1.Count){let He=(re-Z)/Math.max(ie-1,1),Ve=q?.yTime?j:b,Je=Ve.findIndex(nt=>nt>He)-1;ie=Ve[Math.max(Je,0)]}let pe=q?.xCeil?He=>(0,d.Uh)(He,he):He=>(0,d.rs)(He,he),Pe=q?.yCeil?He=>(0,d.Uh)(He,ie):He=>(0,d.rs)(He,ie);if(se){ie=1/(q?.ySize??1);let He=se===2?Math.log2:Math.log10;Pe=q?.yCeil?Ve=>(0,d.Uh)(He(Ve),ie):Ve=>(0,d.rs)(He(Ve),ie)}let Ie=pe(ne),ge=pe(ae),Se=Pe(Z),De=Pe(re),Ke=Math.round((ge-Ie)/he)+1,Me=Math.round((De-Se)/ie)+1,[be,we,Be]=M(Ke,Me,Ie,he,Se,ie,se);for(let He=0;He<te;He++){if(se&&Y[He]<=0)continue;const Ve=(pe(Q[He])-Ie)/he,Je=(Pe(Y[He])-Se)/ie,nt=Ve*Me+Je;Be[nt]++}return{x:be,y:we,count:Be}}function M(Q,Y,q,te,X,ee,ne){const Z=Q*Y,ae=new Array(Z),re=new Array(Z),se=new Array(Z);for(let de=0,le=0,he=q;de<Z;le=++de%Y)se[de]=0,ne?re[de]=ne**(X+le*ee):re[de]=X+le*ee,le===0&&de>=Y&&(he+=te),ae[de]=he;return[ae,re,se]}},91847:(_,L,e)=>{"use strict";e.d(L,{$n:()=>r,g_:()=>t,uk:()=>n});var t=(a=>(a.ShortcodeFigure="shortcodeFigure",a.UIImage="uiImage",a))(t||{});const n={calculateField:{name:"Add field from calculation",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to add a new field calculated from two other fields. Each transformation allows you to add one new field.

- **Mode** - Select a mode:
  - **Reduce row** - Apply selected calculation on each row of selected fields independently.
  - **Binary operation** - Apply basic binary operations (for example, sum or multiply) on values in a single row from two selected fields.
  - **Unary operation** - Apply basic unary operations on values in a single row from a selected field. The available operations are:
    - **Absolute value (abs)** - Returns the absolute value of a given expression. It represents its distance from zero as a positive number.
    - **Natural exponential (exp)** - Returns _e_ raised to the power of a given expression.
    - **Natural logarithm (ln)** - Returns the natural logarithm of a given expression.
    - **Floor (floor)** - Returns the largest integer less than or equal to a given expression.
    - **Ceiling (ceil)** - Returns the smallest integer greater than or equal to a given expression.
  - **Cumulative functions** - Apply functions on the current row and all preceding rows.
    - **Total** - Calculates the cumulative total up to and including the current row.
    - **Mean** - Calculates the mean up to and including the current row.
  - **Window functions** - Apply window functions. The window can either be **trailing** or **centered**.
    With a trailing window the current row will be the last row in the window.
    With a centered window the window will be centered on the current row.
    For even window sizes, the window will be centered between the current row, and the previous row.
    - **Mean** - Calculates the moving mean or running average.
    - **Stddev** - Calculates the moving standard deviation.
    - **Variance** - Calculates the moving variance.
  - **Row index** - Insert a field with the row index.
- **Field name** - Select the names of fields you want to use in the calculation for the new field.
- **Calculation** - If you select **Reduce row** mode, then the **Calculation** field appears. Click in the field to see a list of calculation choices you can use to create the new field. For information about available calculations, refer to [Calculation types][].
- **Operation** - If you select **Binary operation** or **Unary operation** mode, then the **Operation** fields appear. These fields allow you to apply basic math operations on values in a single row from selected fields. You can also use numerical values for binary operations.
  - **All number fields** - Set the left side of a **Binary operation** to apply the calculation to all number fields.
- **As percentile** - If you select **Row index** mode, then the **As percentile** switch appears. This switch allows you to transform the row index as a percentage of the total number of rows.
- **Alias** - (Optional) Enter the name of your new field. If you leave this blank, then the field will be named to match the calculation.
- **Replace all fields** - (Optional) Select this option if you want to hide all other fields and display only your calculated field in the visualization.

In the example below, we added two fields together and named them Sum.

${s("/static/img/docs/transformations/add-field-from-calc-stat-example-7-0.png",a,"A stat visualization including one field called Sum")}
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},concatenate:{name:"Concatenate fields",getHelperDocs:function(){return`
Use this transformation to combine all fields from all frames into one result.

For example, if you have separate queries retrieving temperature and uptime data (Query A) and air quality index and error information (Query B), applying the concatenate transformation yields a consolidated data frame with all relevant information in one view.

Consider the following:

**Query A:**

| Temp  | Uptime  |
| ----- | ------- |
| 15.4  | 1230233 |

**Query B:**

| AQI   | Errors |
| ----- | ------ |
| 3.2   | 5      |

After you concatenate the fields, the data frame would be:

| Temp | Uptime  | AQI | Errors |
| ---- | ------- | --- | ------ |
| 15.4 | 1230233 | 3.2 | 5      |

This transformation simplifies the process of merging data from different sources, providing a comprehensive view for analysis and visualization.
  `}},configFromData:{name:"Config from query results",getHelperDocs:function(){return`
Use this transformation to select a query and extract standard options, such as **Min**, **Max**, **Unit**, and **Thresholds**, and apply them to other query results. This feature enables dynamic visualization configuration based on the data returned by a specific query.

#### Options

- **Config query** - Select the query that returns the data you want to use as configuration.
- **Apply to** - Select the fields or series to which the configuration should be applied.
- **Apply to options** - Specify a field type or use a field name regex, depending on your selection in **Apply to**.

#### Field mapping table

Below the configuration options, you'll find the field mapping table. This table lists all fields found in the data returned by the config query, along with **Use as** and **Select** options. It provides control over mapping fields to config properties, and for multiple rows, it allows you to choose which value to select.

#### Example

Input[0] (From query: A, name: ServerA)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 10    |
| 1626178119129 | 30    |

Input[1] (From query: B)

| Time          | Value |
| ------------- | ----- |
| 1626178119127 | 100   |
| 1626178119129 | 100   |

Output (Same as Input[0] but now with config on the Value field)

| Time          | Value (config: Max=100) |
| ------------- | ----------------------- |
| 1626178119127 | 10                      |
| 1626178119129 | 30                      |

Each row in the source data becomes a separate field. Each field now has a maximum configuration option set. Options such as **Min**, **Max**, **Unit**, and **Thresholds** are part of the field configuration. If set, they are used by the visualization instead of any options manually configured in the panel editor options pane.

#### Value mappings

You can also transform a query result into value mappings. With this option, every row in the configuration query result defines a single value mapping row. See the following example.

Config query result:

| Value | Text   | Color |
| ----- | ------ | ----- |
| L     | Low    | blue  |
| M     | Medium | green |
| H     | High   | red   |

In the field mapping specify:

| Field | Use as                  | Select     |
| ----- | ----------------------- | ---------- |
| Value | Value mappings / Value  | All values |
| Text  | Value mappings / Text   | All values |
| Color | Value mappings / Color | All values |

Grafana builds value mappings from your query result and applies them to the real data query results. You should see values being mapped and colored according to the config query results.
  `}},convertFieldType:{name:"Convert field type",getHelperDocs:function(){return`
Use this transformation to modify the field type of a specified field.

This transformation has the following options:

- **Field** - Select from available fields
- **as** - Select the FieldType to convert to
  - **Numeric** - attempts to make the values numbers
  - **String** - will make the values strings
  - **Time** - attempts to parse the values as time
    - The input will be parsed according to the [Moment.js parsing format](https://momentjs.com/docs/#/parsing/)
    - It will parse the numeric input as a Unix epoch timestamp in milliseconds.
      You must multiply your input by 1000 if it's in seconds.
    - Will show an option to specify a DateFormat as input by a string like yyyy-mm-dd or DD MM YYYY hh:mm:ss
  - **Boolean** - will make the values booleans
  - **Enum** - will make the values enums
    - Will show a table to manage the enums
  - **Other** - attempts to parse the values as JSON

For example, consider the following query that could be modified by selecting the time field as Time and specifying Date Format as YYYY.

#### Sample Query

| Time       | Mark  | Value |
|------------|-------|-------|
| 2017-07-01 | above | 25    |
| 2018-08-02 | below | 22    |
| 2019-09-02 | below | 29    |
| 2020-10-04 | above | 22    |

The result:

#### Transformed Query

| Time                | Mark  | Value |
|---------------------|-------|-------|
| 2017-01-01 00:00:00 | above | 25    |
| 2018-01-01 00:00:00 | below | 22    |
| 2019-01-01 00:00:00 | below | 29    |
| 2020-01-01 00:00:00 | above | 22    |

This transformation allows you to flexibly adapt your data types, ensuring compatibility and consistency in your visualizations.
  `}},extractFields:{name:"Extract fields",getHelperDocs:function(){return`
Use this transformation to select a source of data and extract content from it in different formats. This transformation has the following fields:

- **Source** - Select the field for the source of data.
- **Format** - Choose one of the following:
  - **JSON** - Parse JSON content from the source.
  - **Key+value pairs** - Parse content in the format 'a=b' or 'c:d' from the source.
  - **Auto** - Discover fields automatically.
- **Replace All Fields** - (Optional) Select this option to hide all other fields and display only your calculated field in the visualization.
- **Keep Time** - (Optional) Available only if **Replace All Fields** is true. Keeps the time field in the output.

Consider the following dataset:

#### Dataset Example

| Timestamp           | json_data     |
|---------------------|---------------|
| 1636678740000000000 | {"value": 1}  |
| 1636678680000000000 | {"value": 5}  |
| 1636678620000000000 | {"value": 12} |

You could prepare the data to be used by a [Time series panel][] with this configuration:

- Source: json_data
- Format: JSON
  - Field: value
  - Alias: my_value
- Replace all fields: true
- Keep time: true

This will generate the following output:

#### Transformed Data

| Timestamp           | my_value |
|---------------------|----------|
| 1636678740000000000 | 1        |
| 1636678680000000000 | 5        |
| 1636678620000000000 | 12       |

This transformation allows you to extract and format data in various ways. You can customize the extraction format based on your specific data needs.
  `},links:[{title:"Time series panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/time-series/"}]},fieldLookup:{name:"Lookup fields from resource",getHelperDocs:function(){return`
Use this transformation to enrich a field value by looking up additional fields from an external source. 
  
This transformation has the following fields:

- **Field** - Select a text field from your dataset.
- **Lookup** - Choose from **Countries**, **USA States**, and **Airports**.

This transformation currently supports spatial data.

For example, if you have this data:

#### Dataset Example

| Location  | Values |
|-----------|--------|
| AL        | 0      |
| AK        | 10     |
| Arizona   | 5      |
| Arkansas  | 1      |
| Somewhere | 5      |

With this configuration:

- Field: location
- Lookup: USA States

You'll get the following output:

#### Transformed Data

| Location  | ID | Name     | Lng         | Lat       | Values |
|-----------|----|----------|-------------|-----------|--------|
| AL        | AL | Alabama  | -80.891064  | 12.448457 | 0      |
| AK        | AK | Arkansas | -100.891064 | 24.448457 | 10     |
| Arizona   |    |          |             |           | 5      |
| Arkansas  |    |          |             |           | 1      |
| Somewhere |    |          |             |           | 5      |

This transformation lets you augment your data by fetching additional information from external sources, providing a more comprehensive dataset for analysis and visualization.
  `}},filterByRefId:{name:"Filter data by query refId",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to hide one or more queries in panels that have multiple queries.

Grafana displays the query identification letters in dark gray text. Click a query identifier to toggle filtering. If the query letter is white, then the results are displayed. If the query letter is dark, then the results are hidden.

> **Note:** This transformation is not available for Graphite because this data source does not support correlating returned data with queries.

In the example below, the panel has three queries (A, B, C). We removed the B query from the visualization.

${s("/static/img/docs/transformations/filter-by-query-stat-example-7-0.png",a,"A stat visualization with results from two queries, A and C")}
  `}},filterByValue:{name:"Filter data by values",getHelperDocs:function(){return`
Use this transformation to selectively filter data points directly within your visualization. This transformation provides options to include or exclude data based on one or more conditions applied to a selected field.

This transformation is very useful if your data source does not natively filter by values. You might also use this to narrow values to display if you are using a shared query.

The available conditions for all fields are:

- **Regex** - Match a regex expression.
- **Is Null** - Match if the value is null.
- **Is Not Null** - Match if the value is not null.
- **Equal** - Match if the value is equal to the specified value.
- **Different** - Match if the value is different than the specified value.

The available conditions for string fields are:

- **Contains substring** - Match if the value contains the specified substring (case insensitive).
- **Does not contain substring** - Match if the value doesn't contain the specified substring (case insensitive).

The available conditions for number fields are:

- **Greater** - Match if the value is greater than the specified value.
- **Lower** - Match if the value is lower than the specified value.
- **Greater or equal** - Match if the value is greater or equal.
- **Lower or equal** - Match if the value is lower or equal.
- **Range** - Match a range between a specified minimum and maximum, min and max included.

Consider the following dataset:

#### Dataset Example

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:23 | 32          | 101      |
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:32:24 | 31          | 95       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

If you **Include** the data points that have a temperature below 30\xB0C, the configuration will look as follows:

- Filter Type: 'Include'
- Condition: Rows where 'Temperature' matches 'Lower Than' '30'

And you will get the following result, where only the temperatures below 30\xB0C are included:

#### Transformed Data

| Time                | Temperature | Altitude |
|---------------------|-------------|----------|
| 2020-07-07 11:34:22 | 28          | 125      |
| 2020-07-07 11:34:21 | 26          | 110      |
| 2020-07-07 11:34:20 | 23          | 98       |
| 2020-07-07 10:31:22 | 20          | 85       |
| 2020-07-07 09:30:57 | 19          | 101      |

You can add more than one condition to the filter. For example, you might want to include the data only if the altitude is greater than 100. To do so, add that condition to the following configuration:

- Filter type: 'Include' rows that 'Match All' conditions
- Condition 1: Rows where 'Temperature' matches 'Lower' than '30'
- Condition 2: Rows where 'Altitude' matches 'Greater' than '100'

When you have more than one condition, you can choose if you want the action (include/exclude) to be applied on rows that **Match all** conditions or **Match any** of the conditions you added.

In the example above, we chose **Match all** because we wanted to include the rows that have a temperature lower than 30\xB0C *AND* an altitude higher than 100. If we wanted to include the rows that have a temperature lower than 30\xB0C *OR* an altitude higher than 100 instead, then we would select **Match any**. This would include the first row in the original data, which has a temperature of 32\xB0C (does not match the first condition) but an altitude of 101 (which matches the second condition), so it is included.

Conditions that are invalid or incompletely configured are ignored.

This versatile data filtering transformation lets you to selectively include or exclude data points based on specific conditions. Customize the criteria to tailor your data presentation to meet your unique analytical needs.
  `}},filterFieldsByName:{name:"Filter fields by name",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to selectively remove parts of your query results. There are three ways to filter field names:

- [Using a regular expression](#use-a-regular-expression)
- [Manually selecting included fields](#manually-select-included-fields)
- [Using a dashboard variable](#use-a-dashboard-variable)

#### Use a regular expression

When you filter using a regular expression, field names that match the regular expression are included. 

For example, from the input data:

| Time                | dev-eu-west | dev-eu-north | prod-eu-west | prod-eu-north |
| ------------------- | ----------- | ------------ | ------------ | ------------- |
| 2023-03-04 23:56:23 | 23.5        | 24.5         | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 23.6        | 24.4         | 22.1         | 20.1          |

The result from using the regular expression 'prod.*' would be:

| Time                | prod-eu-west | prod-eu-north |
| ------------------- | ------------ | ------------- |
| 2023-03-04 23:56:23 | 22.2         | 20.2          |
| 2023-03-04 23:56:23 | 22.1         | 20.1          |

The regular expression can include an interpolated dashboard variable by using the \${variableName} syntax.

#### Manually select included fields

Click and uncheck the field names to remove them from the result. Fields that are matched by the regular expression are still included, even if they're unchecked.

#### Use a dashboard variable

Enable 'From variable' to let you select a dashboard variable that's used to include fields. By setting up a [dashboard variable][] with multiple choices, the same fields can be displayed across multiple visualizations.

${s("/static/img/docs/transformations/filter-name-table-before-7-0.png",a,"A table visualization with time, value, Min, and Max columns")}

Here's the table after we applied the transformation to remove the Min field.

${s("/static/img/docs/transformations/filter-name-table-after-7-0.png",a,"A table visualization with time, value, and Max columns")}

Here is the same query using a Stat visualization.

${s("/static/img/docs/transformations/filter-name-stat-after-7-0.png",a,"A stat visualization with value and Max fields")}

This transformation provides flexibility in tailoring your query results to focus on the specific fields you need for effective analysis and visualization.
  `}},formatString:{name:"Format string",getHelperDocs:function(){return`
Use this transformation to customize the output of a string field. This transformation has the following fields:

- **Upper case** - Formats the entire string in uppercase characters.
- **Lower case** - Formats the entire string in lowercase characters.
- **Sentence case** - Formats the first character of the string in uppercase.
- **Title case** - Formats the first character of each word in the string in uppercase.
- **Pascal case** - Formats the first character of each word in the string in uppercase and doesn't include spaces between words.
- **Camel case** - Formats the first character of each word in the string in uppercase, except the first word, and doesn't include spaces between words.
- **Snake case** - Formats all characters in the string in lowercase and uses underscores instead of spaces between words.
- **Kebab case** - Formats all characters in the string in lowercase and uses dashes instead of spaces between words.
- **Trim** - Removes all leading and trailing spaces from the string.
- **Substring** - Returns a substring of the string, using the specified start and end positions.

This transformation provides a convenient way to standardize and tailor the presentation of string data for better visualization and analysis.`}},formatTime:{name:"Format time",getHelperDocs:function(){return`
Use this transformation to customize the output of a time field. Output can be formatted using [Moment.js format strings](https://momentjs.com/docs/#/displaying/). For example, if you want to display only the year of a time field, the format string 'YYYY' can be used to show the calendar year (for example, 1999 or 2012).

**Before Transformation:**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 1636678740000000000 | System Start |
| 1636678680000000000 | User Login   |
| 1636678620000000000 | Data Updated |

**After applying 'YYYY-MM-DD HH:mm:ss':**

| Timestamp           | Event        |
| ------------------- | ------------ |
| 2021-11-12 14:25:40 | System Start |
| 2021-11-12 14:24:40 | User Login   |
| 2021-11-12 14:23:40 | Data Updated |

This transformation lets you tailor the time representation in your visualizations, providing flexibility and precision in displaying temporal data.

> **Note:** This transformation is available in Grafana 10.1+ as an alpha feature.
  `}},groupBy:{name:"Group by",getHelperDocs:function(){return`
Use this transformation to group the data by a specified field (column) value and process calculations on each group. Click to see a list of calculation choices. For information about available calculations, refer to [Calculation types][].

Here's an example of original data.

| Time                | Server ID | CPU Temperature | Server Status |
| ------------------- | --------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
| 2020-07-07 11:34:20 | server 3  | 62              | OK            |
| 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
| 2020-07-07 10:31:22 | server 3  | 55              | OK            |
| 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
| 2020-07-07 09:30:05 | server 2  | 88              | OK            |
| 2020-07-07 09:28:06 | server 1  | 80              | OK            |
| 2020-07-07 09:25:05 | server 2  | 88              | OK            |
| 2020-07-07 09:23:07 | server 1  | 86              | OK            |

This transformation goes in two steps. First you specify one or multiple fields to group the data by. This will group all the same values of those fields together, as if you sorted them. For instance if we group by the Server ID field, then it would group the data this way:

| Time                | Server ID      | CPU Temperature | Server Status |
| ------------------- | -------------- | --------------- | ------------- |
| 2020-07-07 11:34:20 | **server 1**   | 80              | Shutdown      |
| 2020-07-07 09:28:06 | **server 1**   | 80              | OK            |
| 2020-07-07 09:23:07 | **server 1**   | 86              | OK            |
| 2020-07-07 10:32:20 | server 2       | 90              | Overload      |
| 2020-07-07 09:30:05 | server 2       | 88              | OK            |
| 2020-07-07 09:25:05 | server 2       | 88              | OK            |
| 2020-07-07 11:34:20 | **_server 3_** | 62              | OK            |
| 2020-07-07 10:31:22 | **_server 3_** | 55              | OK            |
| 2020-07-07 09:30:57 | **_server 3_** | 62              | Rebooting     |

All rows with the same value of Server ID are grouped together.

After choosing which field you want to group your data by, you can add various calculations on the other fields, and apply the calculation to each group of rows. For instance, we could want to calculate the average CPU temperature for each of those servers. So we can add the _mean_ calculation applied on the CPU Temperature field to get the following:

| Server ID | CPU Temperature (mean) |
| --------- | ---------------------- |
| server 1  | 82                     |
| server 2  | 88.6                   |
| server 3  | 59.6                   |

And we can add more than one calculation. For instance:

- For field Time, we can calculate the _Last_ value, to know when the last data point was received for each server
- For field Server Status, we can calculate the _Last_ value to know what is the last state value for each server
- For field Temperature, we can also calculate the _Last_ value to know what is the latest monitored temperature for each server

We would then get:

| Server ID | CPU Temperature (mean) | CPU Temperature (last) | Time (last)         | Server Status (last) |
| --------- | ---------------------- | ---------------------- | ------------------- | -------------------- |
| server 1  | 82                     | 80                     | 2020-07-07 11:34:20 | Shutdown             |
| server 2  | 88.6                   | 90                     | 2020-07-07 10:32:20 | Overload             |
| server 3  | 59.6                   | 62                     | 2020-07-07 11:34:20 | OK                   |

This transformation allows you to extract essential information from your time series and present it conveniently.
  `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},groupingToMatrix:{name:"Grouping to matrix",getHelperDocs:function(){return`
Use this transformation to combine three fields\u2014which are used as input for the **Column**, **Row**, and **Cell value** fields from the query output\u2014and generate a matrix. The matrix is calculated as follows:

**Original data**

| Server ID | CPU Temperature | Server Status |
| --------- | --------------- | ------------- |
| server 1  | 82              | OK            |
| server 2  | 88.6            | OK            |
| server 3  | 59.6            | Shutdown      |

We can generate a matrix using the values of 'Server Status' as column names, the 'Server ID' values as row names, and the 'CPU Temperature' as content of each cell. The content of each cell will appear for the existing column ('Server Status') and row combination ('Server ID'). For the rest of the cells, you can select which value to display between: **Null**, **True**, **False**, or **Empty**.

**Output**

| Server IDServer Status | OK   | Shutdown |
| ----------------------- | ---- | -------- |
| server 1                | 82   |          |
| server 2                | 88.6 |          |
| server 3                |      | 59.6     |

Use this transformation to construct a matrix by specifying fields from your query results. The matrix output reflects the relationships between the unique values in these fields. This helps you present complex relationships in a clear and structured matrix format.
  `}},groupToNestedTable:{name:"Group to nested tables",getHelperDocs:function(a="shortcodeFigure"){return`
  Use this transformation to group the data by a specified field (column) value and process calculations on each group. Records are generated that share the same grouped field value, to be displayed in a nested table.
    
  To calculate a statistic for a field, click the selection box next to it and select the **Calculate** option:

  ${s("/static/img/docs/transformations/nested-table-select-calculation.png",a,"A select box showing the Group and Calculate options for the transformation.")}

  Once **Calculate** has been selected, another selection box will appear next to the respective field which will allow statistics to be selected:

  ${s("/static/img/docs/transformations/nested-table-select-stat.png",a,"A select box showing available statistic calculations once the calculate option for the field has been selected.")}

  For information about available calculations, refer to [Calculation types][].

  Here's an example of original data:

  | Time                | Server ID | CPU Temperature | Server Status |
  | ------------------- | --------- | --------------- | ------------- |
  | 2020-07-07 11:34:20 | server 1  | 80              | Shutdown      |
  | 2020-07-07 11:34:20 | server 3  | 62              | OK            |
  | 2020-07-07 10:32:20 | server 2  | 90              | Overload      |
  | 2020-07-07 10:31:22 | server 3  | 55              | OK            |
  | 2020-07-07 09:30:57 | server 3  | 62              | Rebooting     |
  | 2020-07-07 09:30:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:28:06 | server 1  | 80              | OK            |
  | 2020-07-07 09:25:05 | server 2  | 88              | OK            |
  | 2020-07-07 09:23:07 | server 1  | 86              | OK            |

  This transformation has two steps. First, specify one or more fields by which to group the data. This groups all the same values of those fields together, as if you sorted them. For instance, if you group by the Server ID field, Grafana groups the data this way:

  | Server ID      |  |
  | -------------- | ------------- |
  | server 1 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>80</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>80</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>86</td><td>OK</td></tr></tbody></table> |
  | server 2 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>90</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>88</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>88</td><td>OK</td></tr></tbody></table> |
  | server 3 | <table><th><tr><td>Time</td><td>CPU Temperature</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>62</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>55</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>62</td><td>Rebooting</td></tr></tbody></table> |

  After choosing the field by which you want to group your data, you can add various calculations on the other fields and apply the calculation to each group of rows. For instance, you might want to calculate the average CPU temperature for each of those servers. To do so, add the **mean calculation** applied on the CPU Temperature field to get the following result:

  | Server ID      | CPU Temperatute (mean) | |
  | -------------- | ------------- | ------------- |
  | server 1 | 82 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>Shutdown</td></tr><tr><td>2020-07-07 09:28:06</td><td>OK</td></tr><tr><td>2020-07-07 09:23:07</td><td>OK</td></tr></tbody></table> |
  | server 2 | 88.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 10:32:20</td><td>Overload</td></tr><tr><td>2020-07-07 09:30:05</td><td>OK</td></tr><tr><td>2020-07-07 09:25:05</td><td>OK</td></tr></tbody></table> |
  | server 3 | 59.6 | <table><th><tr><td>Time</td><td>Server Status</td></tr></th><tbody><tr><td>2020-07-07 11:34:20</td><td>OK</td></tr><tr><td>2020-07-07 10:31:22</td><td>OK</td></tr><tr><td>2020-07-07 09:30:57</td><td>Rebooting</td></tr></tbody></table> |
      `},links:[{title:"Calculation types",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/calculation-types/"}]},heatmap:{name:"Create heatmap",getHelperDocs:function(){return`
Use this transformation to prepare histogram data for visualizing trends over time. Similar to the heatmap visualization, this transformation converts histogram metrics into temporal buckets.

#### X Bucket

This setting determines how the x-axis is split into buckets.

- **Size** - Specify a time interval in the input field. For example, a time range of '1h' creates cells one hour wide on the x-axis.
- **Count** - For non-time-related series, use this option to define the number of elements in a bucket.

#### Y Bucket

This setting determines how the y-axis is split into buckets.

- **Linear**
- **Logarithmic** - Choose between log base 2 or log base 10.
- **Symlog** - Uses a symmetrical logarithmic scale. Choose between log base 2 or log base 10, allowing for negative values.

Assume you have the following dataset:

| Timestamp           | Value |
|-------------------- |-------|
| 2023-01-01 12:00:00 | 5     |
| 2023-01-01 12:15:00 | 10    |
| 2023-01-01 12:30:00 | 15    |
| 2023-01-01 12:45:00 | 8     |

- With X Bucket set to 'Size: 15m' and Y Bucket as 'Linear', the histogram organizes values into time intervals of 15 minutes on the x-axis and linearly on the y-axis.
- For X Bucket as 'Count: 2' and Y Bucket as 'Logarithmic (base 10)', the histogram groups values into buckets of two on the x-axis and use a logarithmic scale on the y-axis.
  `}},histogram:{name:"Histogram",getHelperDocs:function(){return`
Use this transformation to generate a histogram based on input data, allowing you to visualize the distribution of values.

- **Bucket size** - The range between the lowest and highest items in a bucket (xMin to xMax).
- **Bucket offset** - The offset for non-zero-based buckets.
- **Combine series** - Create a unified histogram using all available series.

**Original data**

Series 1:

| A | B | C |
| - | - | - |
| 1 | 3 | 5 |
| 2 | 4 | 6 |
| 3 | 5 | 7 |
| 4 | 6 | 8 |
| 5 | 7 | 9 |

Series 2:

| C |
| - |
| 5 |
| 6 |
| 7 |
| 8 |
| 9 |

**Output**

| xMin | xMax | A | B | C | C |
| ---- | ---- | --| --| --| --|
| 1    | 2    | 1 | 0 | 0 | 0 |
| 2    | 3    | 1 | 0 | 0 | 0 |
| 3    | 4    | 1 | 1 | 0 | 0 |
| 4    | 5    | 1 | 1 | 0 | 0 |
| 5    | 6    | 1 | 1 | 1 | 1 |
| 6    | 7    | 0 | 1 | 1 | 1 |
| 7    | 8    | 0 | 1 | 1 | 1 |
| 8    | 9    | 0 | 0 | 1 | 1 |
| 9    | 10   | 0 | 0 | 1 | 1 |

Visualize the distribution of values using the generated histogram, providing insights into the data's spread and density.
  `}},joinByField:{name:"Join by field",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to merge multiple results into a single table, enabling the consolidation of data from different queries.

This is especially useful for converting multiple time series results into a single wide table with a shared time field.

#### Inner join (for Time Series or SQL-like data)

An inner join merges data from multiple tables where all tables share the same value from the selected field. This type of join excludes data where values do not match in every result.

Use this transformation to combine the results from multiple queries (combining on a passed join field or the first time column) into one result, and drop rows where a successful join cannot occur. This is not optimized for large Time Series datasets.

In the following example, two queries return Time Series data. It is visualized as two separate tables before applying the inner join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the inner join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

This works in the same way for non-Time Series tabular data as well.

**Students**

| StudentID | Name     | Major            |
| --------- | -------- | ---------------- |
| 1         | John     | Computer Science |
| 2         | Emily    | Mathematics      |
| 3         | Michael  | Physics          |
| 4         | Jennifer | Chemistry        |

**Enrollments**

| StudentID | CourseID | Grade |
|-----------|----------|-------|
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the inner join transformation looks like the following:

| StudentID | Name    | Major            | CourseID | Grade |
| --------- | ------- | ---------------- | -------  | ----- |
| 1         | John    | Computer Science | CS101    | A     |
| 1         | John    | Computer Science | CS102    | B     |
| 2         | Emily   | Mathematics      | MATH201  | A     |
| 3         | Michael | Physics          | PHYS101  | B     |

The inner join only includes rows where there is a match between the "StudentID" in both tables. In this case, the result does not include "Jennifer" from the "Students" table because there are no matching enrollments for her in the "Enrollments" table.

#### Outer join (for Time Series data)

An outer join includes all data from an inner join and rows where values do not match in every input. While the inner join joins Query A and Query B on the time field, the outer join includes all rows that don't match on the time field.

In the following example, two queries return table data. It is visualized as two tables before applying the outer join transformation.

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |
| 2020-07-07 11:14:20 | postgre | 345001233 |

**Query B:**

| Time                | Server   | Errors |
| ------------------- | -------- | ------ |
| 2020-07-07 11:34:20 | server 1 | 15     |
| 2020-07-07 11:24:20 | server 2 | 5      |
| 2020-07-07 11:04:20 | server 3 | 10     |

The result after applying the outer join transformation looks like the following:

| Time                | Job     | Uptime    | Server   | Errors |
| ------------------- | ------- | --------- | -------- | ------ |
| 2020-07-07 11:04:20 |         |           | server 3 | 10     |
| 2020-07-07 11:14:20 | postgre | 345001233 |          |        |
| 2020-07-07 11:34:20 | node    | 25260122  | server 1 | 15     |
| 2020-07-07 11:24:20 | postgre | 123001233 | server 2 | 5      |

In the following example, a template query displays time series data from multiple servers in a table visualization. The results of only one query can be viewed at a time.

${s("/static/img/docs/transformations/join-fields-before-7-0.png",a,"A table visualization showing results for one server")}

I applied a transformation to join the query results using the time field. Now I can run calculations, combine, and organize the results in this new table.

${s("/static/img/docs/transformations/join-fields-after-7-0.png",a,"A table visualization showing results for multiple servers")}

#### Outer join (for SQL-like data)

A tabular outer join combining tables so that the result includes matched and unmatched rows from either or both tables.

| StudentID | Name      | Major            |
| --------- | --------- | ---------------- |
| 1         | John      | Computer Science |
| 2         | Emily     | Mathematics      |
| 3         | Michael   | Physics          |
| 4         | Jennifer  | Chemistry        |

Can now be joined with:

| StudentID | CourseID | Grade |
| --------- | -------- | ----- |
| 1         | CS101    | A     |
| 1         | CS102    | B     |
| 2         | MATH201  | A     |
| 3         | PHYS101  | B     |
| 5         | HIST101  | B     |

The result after applying the outer join transformation looks like the following:

| StudentID | Name     | Major            | CourseID | Grade |
| --------- | -------- | ---------------- | -------- | ----- |
| 1         | John     | Computer Science | CS101    | A     |
| 1         | John     | Computer Science | CS102    | B     |
| 2         | Emily    | Mathematics      | MATH201  | A     |
| 3         | Michael  | Physics          | PHYS101  | B     |
| 4         | Jennifer | Chemistry        | NULL     | NULL  |
| 5         | NULL     | NULL             | HIST101  | B     |

Combine and analyze data from various queries with table joining for a comprehensive view of your information.
  `}},joinByLabels:{name:"Join by labels",getHelperDocs:function(){return`
Use this transformation to join multiple results into a single table.

This is especially useful for converting multiple time series results into a single wide table with a shared **Label** field.

- **Join** - Select the label to join by between the labels available or common across all time series.
- **Value** - The name for the output result.

#### Example

##### Input

series1{what="Temp", cluster="A", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series2{what="Temp", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 1    | 10    |
| 2    | 200   |

series3{what="Speed", cluster="B", job="J1"}

| Time | Value |
| ---- | ----- |
| 22   | 22    |
| 28   | 77    |

##### Config

value: "what"

##### Output

| cluster | job | Temp | Speed |
| ------- | --- | ---- | ----- |
| A       | J1  | 10   |       |
| A       | J1  | 200  |       |
| B       | J1  | 10   | 22    |
| B       | J1  | 200  | 77    |

Combine and organize time series data effectively with this transformation for comprehensive insights.
  `}},labelsToFields:{name:"Labels to fields",getHelperDocs:function(){return`
Use this transformation to convert time series results with labels or tags into a table, including each label's keys and values in the result. Display labels as either columns or row values for enhanced data visualization.

Given a query result of two time series:

- Series 1: labels Server=Server A, Datacenter=EU
- Series 2: labels Server=Server B, Datacenter=EU

In "Columns" mode, the result looks like this:

| Time                | Server   | Datacenter | Value |
| ------------------- | -------- | ---------- | ----- |
| 2020-07-07 11:34:20 | Server A | EU         | 1     |
| 2020-07-07 11:34:20 | Server B | EU         | 2     |

In "Rows" mode, the result has a table for each series and show each label value like this:

| label      | value    |
| ---------- | -------- |
| Server     | Server A |
| Datacenter | EU       |

| label      | value    |
| ---------- | -------- |
| Server     | Server B |
| Datacenter | EU       |

#### Value field name

If you selected Server as the **Value field name**, then you would get one field for every value of the Server label.

| Time                | Datacenter | Server A | Server B |
| ------------------- | ---------- | -------- | -------- |
| 2020-07-07 11:34:20 | EU         | 1        | 2        |

#### Merging behavior

The labels to fields transformer is internally two separate transformations. The first acts on single series and extracts labels to fields. The second is the [merge](#merge) transformation that joins all the results into a single table. The merge transformation tries to join on all matching fields. This merge step is required and cannot be turned off.

To illustrate this, here is an example where you have two queries that return time series with no overlapping labels.

- Series 1: labels Server=ServerA
- Series 2: labels Datacenter=EU

This will first result in these two tables:

| Time                | Server  | Value |
| ------------------- | ------- | ----- |
| 2020-07-07 11:34:20 | ServerA | 10    |

| Time                | Datacenter | Value |
| ------------------- | ---------- | ----- |
| 2020-07-07 11:34:20 | EU         | 20    |

After merge:

| Time                | Server  | Value | Datacenter |
| ------------------- | ------- | ----- | ---------- |
| 2020-07-07 11:34:20 | ServerA | 10    |            |
| 2020-07-07 11:34:20 |         | 20    | EU         |

Convert your time series data into a structured table format for a clearer and more organized representation.
  `}},limit:{name:"Limit",getHelperDocs:function(){return`
Use this transformation to restrict the number of rows displayed, providing a more focused view of your data. This is particularly useful when dealing with large datasets.

Below is an example illustrating the impact of the **Limit** transformation on a response from a data source:

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

Here is the result after adding a Limit transformation with a value of '3':

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

This transformation helps you tailor the visual presentation of your data to focus on the most relevant information.
  `}},merge:{name:"Merge series/tables",getHelperDocs:function(){return`
Use this transformation to combine the results from multiple queries into a single result, which is particularly useful when using the table panel visualization. This transformation merges values into the same row if the shared fields contain the same data.

Here's an example illustrating the impact of the **Merge series/tables** transformation on two queries returning table data:

**Query A:**

| Time                | Job     | Uptime    |
| ------------------- | ------- | --------- |
| 2020-07-07 11:34:20 | node    | 25260122  |
| 2020-07-07 11:24:20 | postgre | 123001233 |

**Query B:**

| Time                | Job     | Errors |
| ------------------- | ------- | ------ |
| 2020-07-07 11:34:20 | node    | 15     |
| 2020-07-07 11:24:20 | postgre | 5      |

Here is the result after applying the Merge transformation.

| Time                | Job     | Errors | Uptime    |
| ------------------- | ------- | ------ | --------- |
| 2020-07-07 11:34:20 | node    | 15     | 25260122  |
| 2020-07-07 11:24:20 | postgre | 5      | 123001233 |

This transformation combines values from Query A and Query B into a unified table, enhancing the presentation of data for better insights.
  `},links:[{title:"Table panel",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/"}]},organize:{name:"Organize fields by name",getHelperDocs:function(){return`
Use this transformation to provide the flexibility to rename, reorder, or hide fields returned by a single query in your panel. This transformation is applicable only to panels with a single query. If your panel has multiple queries, consider using an "Outer join" transformation or removing extra queries.

#### Transforming fields

Grafana displays a list of fields returned by the query, allowing you to perform the following actions:

- **Change field order** - Hover over a field, and when your cursor turns into a hand, drag the field to its new position.
- **Hide or show a field** - Use the eye icon next to the field name to toggle the visibility of a specific field.
- **Rename fields** - Type a new name in the "Rename <field>" box to customize field names.

#### Example:

##### Original Query Result

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |

##### After Applying Field Overrides

| Time                | Sensor      | Reading |
| ------------------- | ----------- | ------- |
| 2020-07-07 11:34:20 | Temperature | 25      |
| 2020-07-07 11:34:20 | Humidity    | 22      |
| 2020-07-07 10:32:20 | Humidity    | 29      |

This transformation lets you to tailor the display of query results, ensuring a clear and insightful representation of your data in Grafana.
  `}},partitionByValues:{name:"Partition by values",getHelperDocs:function(){return`
Use this transformation to streamline the process of graphing multiple series without the need for multiple queries with different 'WHERE' clauses.

This is particularly useful when dealing with a metrics SQL table, as illustrated below:

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | US     | 1327  |
| 2022-10-20 01:00:00 | EU     | 912   |

With the **Partition by values** transformation, you can issue a single query and split the results by unique values in one or more columns (fields) of your choosing. The following example uses 'Region':

'SELECT Time, Region, Value FROM metrics WHERE Time > "2022-10-20"'

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | US     | 1520  |
| 2022-10-20 01:00:00 | US     | 1327  |

| Time                | Region | Value |
| ------------------- | ------ | ----- |
| 2022-10-20 12:00:00 | EU     | 2936  |
| 2022-10-20 01:00:00 | EU     | 912   |

This transformation simplifies the process and enhances the flexibility of visualizing multiple series within the same time series visualization.
  `}},prepareTimeSeries:{name:"Prepare time series",getHelperDocs:function(){return`
Use this transformation to address issues when a data source returns time series data in a format that isn't compatible with the desired visualization. This transformation allows you to convert time series data between wide and long formats, providing flexibility in data frame structures.

#### Available options

##### Multi-frame time series

Use this option to transform the time series data frame from the wide format to the long format. This is particularly helpful when your data source delivers time series information in a format that needs to be reshaped for optimal compatibility with your visualization.

**Example: Converting from wide to long format**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

**Transformed to:**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |


##### Wide time series

Select this option to transform the time series data frame from the long format to the wide format. If your data source returns time series data in a long format and your visualization requires a wide format, this transformation simplifies the process.

**Example: Converting from long to wide format**

| Timestamp           | Variable | Value |
|---------------------|----------|-------|
| 2023-01-01 00:00:00 | Value1   | 10    |
| 2023-01-01 00:00:00 | Value2   | 20    |
| 2023-01-01 01:00:00 | Value1   | 15    |
| 2023-01-01 01:00:00 | Value2   | 25    |

**Transformed to:**

| Timestamp           | Value1 | Value2 |
|---------------------|--------|--------|
| 2023-01-01 00:00:00 | 10     | 20     |
| 2023-01-01 01:00:00 | 15     | 25     |

> **Note:** This transformation is available in Grafana 7.5.10+ and Grafana 8.0.6+.
  `},links:[{title:"Data frames",url:"https://grafana.com/docs/grafana/latest/developers/plugins/introduction-to-plugin-development/data-frames/"}]},reduce:{name:"Reduce",getHelperDocs:function(){return`
Use this transformation to apply a calculation to each field in the data frame and return a single value. This transformation is particularly useful for consolidating multiple time series data into a more compact, summarized format. Time fields are removed when applying this transformation.

Consider the input:

**Query A:**

| Time                | Temp | Uptime  |
| ------------------- | ---- | ------- |
| 2020-07-07 11:34:20 | 12.3 | 256122  |
| 2020-07-07 11:24:20 | 15.4 | 1230233 |

**Query B:**

| Time                | AQI | Errors |
| ------------------- | --- | ------ |
| 2020-07-07 11:34:20 | 6.5 | 15     |
| 2020-07-07 11:24:20 | 3.2 | 5      |

The reduce transformer has two modes:

- **Series to rows** - Creates a row for each field and a column for each calculation.
- **Reduce fields** - Keeps the existing frame structure, but collapses each field into a single value.

For example, if you used the **First** and **Last** calculation with a **Series to rows** transformation, then
the result would be:

| Field  | First  | Last    |
| ------ | ------ | ------- |
| Temp   | 12.3   | 15.4    |
| Uptime | 256122 | 1230233 |
| AQI    | 6.5    | 3.2     |
| Errors | 15     | 5       |

The **Reduce fields** with the **Last** calculation,
results in two frames, each with one row:

**Query A:**

| Temp | Uptime  |
| ---- | ------- |
| 15.4 | 1230233 |

**Query B:**

| AQI | Errors |
| --- | ------ |
| 3.2 | 5      |

This flexible transformation simplifies the process of consolidating and summarizing data from multiple time series into a more manageable and organized format.
  `}},renameByRegex:{name:"Rename by regex",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to rename parts of the query results using a regular expression and replacement pattern.

You can specify a regular expression, which is only applied to matches, along with a replacement pattern that support back references. For example, let's imagine you're visualizing CPU usage per host and you want to remove the domain name. You could set the regex to '/^([^.]+).*/' and the replacement pattern to '$1', 'web-01.example.com' would become 'web-01'.

> **Note:** The Rename by regex transformation was improved in Grafana v9.0.0 to allow global patterns of the form '/<stringToReplace>/g'. Depending on the regex match used, this may cause some transformations to behave slightly differently. You can guarantee the same behavior as before by wrapping the match string in forward slashes '(/)', e.g. '(.*)' would become '/(.*)/'.

In the following example, we are stripping the 'A-' prefix from field names. In the before image, you can see everything is prefixed with 'A-':

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-before-v11.0.png",a,"A time series with full series names")}

With the transformation applied, you can see we are left with just the remainder of the string.

${s("/media/docs/grafana/panels-visualizations/screenshot-rename-by-regex-after-v11.0.png",a,"A time series with shortened series names")}

This transformation lets you to tailor your data to meet your visualization needs, making your dashboards more informative and user-friendly.
  `}},rowsToFields:{name:"Rows to fields",getHelperDocs:function(){return`
Use this transformation to convert rows into separate fields. This can be useful because fields can be styled and configured individually. It can also use additional fields as sources for dynamic field configuration or map them to field labels. The additional labels can then be used to define better display names for the resulting fields.

This transformation includes a field table which lists all fields in the data returned by the configuration query. This table gives you control over what field should be mapped to each configuration property (the **Use as** option). You can also choose which value to select if there are multiple rows in the returned data.

This transformation requires:

- One field to use as the source of field names.

  By default, the transform uses the first string field as the source. You can override this default setting by selecting **Field name** in the **Use as** column for the field you want to use instead.

- One field to use as the source of values.

  By default, the transform uses the first number field as the source. But you can override this default setting by selecting **Field value** in the **Use as** column for the field you want to use instead.

Useful when visualizing data in:

- Gauge
- Stat
- Pie chart

#### Map extra fields to labels

If a field does not map to config property Grafana will automatically use it as source for a label on the output field-

**Example:**

| Name    | DataCenter | Value |
| ------- | ---------- | ----- |
| ServerA | US         | 100   |
| ServerB | EU         | 200   |

**Output:**

| ServerA (labels: DataCenter: US) | ServerB (labels: DataCenter: EU) |
| -------------------------------- | -------------------------------- |
| 10                               | 20                               |

The extra labels can now be used in the field display name provide more complete field names.

If you want to extract config from one query and apply it to another you should use the config from query results transformation.

#### Example

**Input:**

| Name    | Value | Max |
| ------- | ----- | --- |
| ServerA | 10    | 100 |
| ServerB | 20    | 200 |
| ServerC | 30    | 300 |

**Output:**

| ServerA (config: max=100) | ServerB (config: max=200) | ServerC (config: max=300) |
| ------------------------- | ------------------------- | ------------------------- |
| 10                        | 20                        | 30                        |

As you can see each row in the source data becomes a separate field. Each field now also has a max config option set. Options like **Min**, **Max**, **Unit** and **Thresholds** are all part of field configuration and if set like this will be used by the visualization instead of any options manually configured in the panel editor options pane.

This transformation enables the conversion of rows into individual fields, facilitates dynamic field configuration, and maps additional fields to labels.
  `}},seriesToRows:{name:"Series to rows",getHelperDocs:function(){return`
Use this transformation to combine the result from multiple time series data queries into one single result. This is helpful when using the table panel visualization.

The result from this transformation will contain three columns: Time, Metric, and Value. The Metric column is added so you easily can see from which query the metric originates from. Customize this value by defining Label on the source query.

In the example below, we have two queries returning time series data. It is visualized as two separate tables before applying the transformation.

**Query A:**

| Time                | Temperature |
| ------------------- | ----------- |
| 2020-07-07 11:34:20 | 25          |
| 2020-07-07 10:31:22 | 22          |
| 2020-07-07 09:30:05 | 19          |

**Query B:**

| Time                | Humidity |
| ------------------- | -------- |
| 2020-07-07 11:34:20 | 24       |
| 2020-07-07 10:32:20 | 29       |
| 2020-07-07 09:30:57 | 33       |

Here is the result after applying the Series to rows transformation.

| Time                | Metric      | Value |
| ------------------- | ----------- | ----- |
| 2020-07-07 11:34:20 | Temperature | 25    |
| 2020-07-07 11:34:20 | Humidity    | 22    |
| 2020-07-07 10:32:20 | Humidity    | 29    |
| 2020-07-07 10:31:22 | Temperature | 22    |
| 2020-07-07 09:30:57 | Humidity    | 33    |
| 2020-07-07 09:30:05 | Temperature | 19    |

This transformation facilitates the consolidation of results from multiple time series queries, providing a streamlined and unified dataset for efficient analysis and visualization in a tabular format.

> **Note:** This transformation is available in Grafana 7.1+.
  `}},sortBy:{name:"Sort by",getHelperDocs:function(){return`
Use this transformation to sort each frame within a query result based on a specified field, making your data easier to understand and analyze. By configuring the desired field for sorting, you can control the order in which the data is presented in the table or visualization.

Use the **Reverse** switch to inversely order the values within the specified field. This functionality is particularly useful when you want to quickly toggle between ascending and descending order to suit your analytical needs.

For example, in a scenario where time-series data is retrieved from a data source, the **Sort by** transformation can be applied to arrange the data frames based on the timestamp, either in ascending or descending order, depending on the analytical requirements. This capability ensures that you can easily navigate and interpret time-series data, gaining valuable insights from the organized and visually coherent presentation.
  `}},spatial:{name:"Spatial",getHelperDocs:function(){return`
Use this transformation to apply spatial operations to query results.

- **Action** - Select an action:
  - **Prepare spatial field** - Set a geometry field based on the results of other fields.
    - **Location mode** - Select a location mode (these options are shared by the **Calculate value** and **Transform** modes):
      - **Auto** - Automatically identify location data based on default field names.
      - **Coords** - Specify latitude and longitude fields.
      - **Geohash** - Specify a geohash field.
      - **Lookup** - Specify Gazetteer location fields.
  - **Calculate value** - Use the geometry to define a new field (heading/distance/area).
    - **Function** - Choose a mathematical operation to apply to the geometry:
      - **Heading** - Calculate the heading (direction) between two points.
      - **Area** - Calculate the area enclosed by a polygon defined by the geometry.
      - **Distance** - Calculate the distance between two points.
  - **Transform** - Apply spatial operations to the geometry.
    - **Operation** - Choose an operation to apply to the geometry:
      - **As line** - Create a single line feature with a vertex at each row.
      - **Line builder** - Create a line between two points.

This transformation allows you to manipulate and analyze geospatial data, enabling operations such as creating lines between points, calculating spatial properties, and more.
  `}},timeSeriesTable:{name:"Time series to table transform",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to convert time series results into a table, transforming a time series data frame into a **Trend** field which can then be used with the [sparkline cell type][]. If there are multiple time series queries, each will result in a separate table data frame. These can be joined using join or merge transforms to produce a single table with multiple sparklines per row.

${s("/static/img/docs/transformations/table-sparklines.png",a,"A table panel showing multiple values and their corresponding sparklines.")}

For each generated **Trend** field value, a calculation function can be selected. This value is displayed next to the sparkline and will be used for sorting table rows.

${s("/static/img/docs/transformations/timeseries-table-select-stat.png",a,"A select box showing available statistics that can be calculated.")}


> **Note:** This transformation is available in Grafana 9.5+ as an opt-in beta feature. Modify the Grafana [configuration file][] to use it.
  `},links:[{title:"sparkline cell type",url:"https://grafana.com/docs/grafana/latest/panels-visualizations/visualizations/table/#sparkline"},{title:"configuration file",url:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/"}]},transpose:{name:"Transpose",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to pivot the data frame, converting rows into columns and columns into rows. This transformation is particularly useful when you want to switch the orientation of your data to better suit your visualization needs.
If you have multiple types it will default to string type.

**Before Transformation:**

| env  | January   | February |
| ---- | --------- | -------- |
| prod | 1 | 2 |
| dev | 3 | 4 |

**After applying transpose transformation:**

| Field  | prod   | dev |
| ---- | --------- | -------- |
| January | 1 | 3 |
| February  | 2 | 4 |

${s("/media/docs/grafana/transformations/screenshot-grafana-11-2-transpose-transformation.png",a,"Before and after transpose transformation")}
  `}},regression:{name:"Regression analysis",getHelperDocs:function(a="shortcodeFigure"){return`
Use this transformation to create a new data frame containing values predicted by a statistical model. This is useful for finding a trend in chaotic data. It works by fitting a mathematical function to the data, using either linear or polynomial regression. The data frame can then be used in a visualization to display a trendline.

There are two different models:

- **Linear regression** - Fits a linear function to the data.
${s("/static/img/docs/transformations/linear-regression.png",a,"A time series visualization with a straight line representing the linear function")}
- **Polynomial regression** - Fits a polynomial function to the data.
${s("/static/img/docs/transformations/polynomial-regression.png",a,"A time series visualization with a curved line representing the polynomial function")}

> **Note:** This transformation is currently in public preview. Grafana Labs offers limited support, and breaking changes might occur prior to the feature being made generally available. Enable the \`regressionTransformation\` feature toggle in Grafana to use this feature. Contact Grafana Support to enable this feature in Grafana Cloud.
  `}}};function r(){return`
  Go to the <a href="https://grafana.com/docs/grafana/latest/panels/transformations/?utm_source=grafana" target="_blank" rel="noreferrer">
  transformation documentation
  </a> for more general documentation.
  `}function s(a,g,i){return g==="shortcodeFigure"?`{{< figure src="${a}" class="docs-image--no-shadow" max-width= "1100px" alt="${i}" >}}`:`![${i}](https://grafana.com${a})`}},9581:(_,L,e)=>{"use strict";e.d(L,{YD:()=>s,dy:()=>n,kD:()=>r});var t=e(52622),n=(g=>(g.Prepare="prepare",g.Calculate="calculate",g.Modify="modify",g))(n||{}),r=(g=>(g.Heading="heading",g.Distance="distance",g.Area="area",g))(r||{}),s=(g=>(g.AsLine="asLine",g.LineBuilder="lineBuilder",g))(s||{});const a={action:"prepare",source:{mode:t.aG.Auto}}},78134:(_,L,e)=>{"use strict";e.d(L,{EX:()=>o,pp:()=>c,tt:()=>l});var t=e(70915),n=e(11217),r=e(44294),s=e(22796),a=e(52490),g=e(11261),i=e(9581);function l(p){const h=[];for(const y of p.values)y&&h.push(o(y));return new n.A(h)}function d(p){const h=new Array(p.length);if(p.length>1){let y=u(p[0]);for(let f=1;f<p.length;f++){let v=u(p[f]);if(y&&v){let P=Math.atan2(v[0]-y[0],v[1]-y[1])*180/Math.PI;P<0&&(P+=360),h[f-1]=h[f]=P}}}else h.fill(0);return h}function o(p){return p instanceof r.A?p.getCoordinates():(0,t.q1)(p.getExtent())}function u(p){if(p)return(0,s.WP)(o(p))}function c(p,h){const y=p.values,f=new Array(p.values.length),v=h.calc??i.kD.Heading,P=h.field??v;switch(v){case i.kD.Area:{for(let m=0;m<y.length;m++){const D=y[m];D&&(f[m]=(0,a.UG)(D))}return{name:P,type:g.PU.number,config:{unit:"areaM2"},values:f}}case i.kD.Distance:{for(let m=0;m<y.length;m++){const D=y[m];D&&(f[m]=(0,a.R3)(D))}return{name:P,type:g.PU.number,config:{unit:"lengthm"},values:f}}case i.kD.Heading:default:return{name:P,type:g.PU.number,config:{unit:"degree"},values:d(y)}}}},88841:(_,L,e)=>{"use strict";e.d(L,{c:()=>f,y:()=>P});var t=e(74848),n=e(32196),r=e(34743),s=e(83505),a=e(46885),g=e(96540),i=e(40845),l=e(17464),d=e(40276),o=e(72093),u=e(21744),c=e(43538),p=e(10354);const h=(D,x)=>D-x*Math.floor(D/x),y=8;var f=(D=>(D.InputElement="input",D.TextAreaElement="textarea",D))(f||{});const v=(D,x)=>({suggestionsWrapper:(0,n.css)({boxShadow:D.shadows.z2}),errorTooltip:(0,n.css)({position:"absolute",top:x+y+"px",zIndex:D.zIndex.tooltip}),inputWrapper:(0,n.css)({position:"relative"})}),P=({value:D="",onChange:x,suggestions:E,placeholder:C,error:b,invalid:T,type:A="input",style:R,autoFocus:S=!1})=>{const[O,j]=(0,g.useState)(!1),[B,N]=(0,g.useState)(0),[I,K]=(0,g.useState)(D.toString()),[w,U]=(0,g.useState)(0),[W,H]=(0,g.useState)(0),[z,G]=(0,g.useState)(0),M=(0,i.$j)(),Q=v(M,W),Y=(0,g.useRef)(),q=[(0,r.UU)({fallbackAxisSideDirection:"start",crossAxis:!1,boundary:document.body}),(0,r.BN)()],{refs:te,floatingStyles:X}=(0,s.we)({open:O,placement:"bottom-start",onOpenChange:j,middleware:q,whileElementsMounted:a.ll,strategy:"fixed"}),ee=(0,g.useCallback)(le=>{te.setReference(le),Y.current=le},[te]),ne=(0,g.useRef)(null);(0,g.useEffect)(()=>{U(m(ne.current,B))},[B]);const Z=g.useCallback((le,he=Y.current)=>{const ie=he.selectionStart,J=he.value;J[z-1]==="$"?he.value=J.slice(0,z)+le.value+J.slice(ie):he.value=J.slice(0,z)+`\${${le.value}}`+J.slice(ie),K(he.value),j(!1),N(0),x(he.value)},[x,z]),ae=g.useCallback(le=>{if(!O){if(le.key==="$"||le.key===" "&&le.ctrlKey){G(Y.current.selectionStart||0),j(!0);return}return}switch(le.key){case"Backspace":case"Escape":case"ArrowLeft":case"ArrowRight":return j(!1),N(0);case"Enter":return le.preventDefault(),Z(E[B]);case"ArrowDown":case"ArrowUp":le.preventDefault();const he=le.key==="ArrowDown"?1:-1;return N(ie=>h(ie+he,E.length));default:return}},[O,E,B,Z]),re=g.useCallback(le=>{K(le.currentTarget.value)},[]),se=g.useCallback(le=>{x(le.currentTarget.value)},[x]);(0,g.useEffect)(()=>{H(Y.current.clientHeight)},[]);const de={placeholder:C,invalid:T,value:I,onChange:re,onBlur:se,onKeyDown:ae};return(0,t.jsxs)("div",{className:Q.inputWrapper,style:R??{},children:[O&&(0,t.jsx)(l.ZL,{children:(0,t.jsx)("div",{ref:te.setFloating,style:X,className:Q.suggestionsWrapper,children:(0,t.jsx)(d.E,{scrollTop:w,autoHeightMax:"300px",setScrollTop:({scrollTop:le})=>U(le),children:(0,t.jsx)(c.k,{activeRef:ne,suggestions:E,onSuggestionSelect:Z,onClose:()=>j(!1),activeIndex:B})})})}),T&&b&&(0,t.jsx)("div",{className:Q.errorTooltip,children:(0,t.jsx)(o.P,{children:b})}),A==="input"?(0,t.jsx)(p.p,{...de,ref:ee,autoFocus:S}):(0,t.jsx)(u.f,{...de,ref:ee,autoFocus:S,rows:5})]})};P.displayName="SuggestionsInput";function m(D,x){return(D?.clientHeight??0)*x}},94397:(_,L,e)=>{"use strict";e.d(L,{N_:()=>l,ZI:()=>a,aG:()=>g,eJ:()=>i,qt:()=>d});var t=e(96540),n=e(28240),r=e(91410),s=e(32264);function a(o){return(0,t.useMemo)(()=>Array.isArray(o)?Object.keys(o.reduce((u,c)=>!c||!Array.isArray(c.fields)?u:c.fields.reduce((p,h)=>{const y=(0,n.Ct)(h,c,o);return p[y]=!0,p},u),{})):[],[o])}function g(o){const u=new Set;for(const c of o)for(const p of c.fields)if(p.labels)for(const h of Object.keys(p.labels))u.add(h);return u}const i={combine:"Combine",calculateNewFields:"Calculate new fields",createNewVisualization:"Create new visualization",filter:"Filter",performSpatialOperations:"Perform spatial operations",reformat:"Reformat",reorderAndRename:"Reorder and rename"},l=o=>!!(typeof o=="number"||!Number.isNaN(Number(o))||/^\$[A-Za-z0-9_]+$/.test(o)&&s.$.featureToggles.transformationsVariableSupport);function d(o){const u=[];o&&(u.push({label:"Browser",value:"browser"}),u.push({label:"UTC",value:"utc"}));const c=(0,r.P3)();for(const p of c)u.push({label:p,value:p});return u}},87617:(_,L,e)=>{"use strict";e.d(L,{$u:()=>u,Ay:()=>y,Cj:()=>l,EC:()=>o,Y_:()=>i,dJ:()=>c,g4:()=>d,jE:()=>p,t_:()=>a});var t=e(65307),n=e(2913);const r={users:[],searchQuery:"",page:0,perPage:30,totalPages:1,externalUserMngInfo:n.Ay.externalUserMngInfo,externalUserMngLinkName:n.Ay.externalUserMngLinkName,externalUserMngLinkUrl:n.Ay.externalUserMngLinkUrl,isLoading:!1,rolesLoading:!1},s=(0,t.Z0)({name:"users",initialState:r,reducers:{usersLoaded:(f,v)=>{const{totalCount:P,perPage:m,page:D,orgUsers:x}=v.payload,E=Math.ceil(P/m);return{...f,isLoading:!0,users:x,perPage:m,page:D,totalPages:E}},searchQueryChanged:(f,v)=>({...f,searchQuery:v.payload,page:r.page}),setUsersSearchPage:(f,v)=>({...f,page:v.payload}),pageChanged:(f,v)=>({...f,page:v.payload}),sortChanged:(f,v)=>({...f,sort:v.payload}),usersFetchBegin:f=>({...f,isLoading:!0}),usersFetchEnd:f=>({...f,isLoading:!1}),rolesFetchBegin:f=>({...f,rolesLoading:!0}),rolesFetchEnd:f=>({...f,rolesLoading:!1})}}),{searchQueryChanged:a,setUsersSearchPage:g,usersLoaded:i,usersFetchBegin:l,usersFetchEnd:d,pageChanged:o,sortChanged:u,rolesFetchBegin:c,rolesFetchEnd:p}=s.actions,y={users:s.reducer}},20601:(_,L,e)=>{"use strict";e.d(L,{B:()=>n});var t=e(83077);const n=new t.O},26260:(_,L,e)=>{"use strict";e.d(L,{$u:()=>h,D4:()=>v,Iv:()=>P,U2:()=>f,VT:()=>y,z_:()=>p});var t=e(2543),n=e.n(t),r=e(31193),s=e(3843),a=e(24240),g=e(72401),i=e(48594),l=e(87421),d=e(56968),o=e(75096),u=e(53699);const c="Filters",p=x=>async(E,C)=>{let b=D(x,C());if(!b&&(E(m(x)),b=D(x,C()),!b))return;const T=b.filters.findIndex(R=>R.key===x.key&&R.value===x.value);if(T===-1){const{value:R,key:S,operator:O}=x,j={value:R,key:S,operator:O};return await E(f((0,o.jX)(b),j))}const A={...b.filters[T],operator:x.operator};return await E(h((0,o.jX)(b),{index:T,filter:A}))},h=(x,E)=>async(C,b)=>{const T=(0,l.dn)(x,b());C((0,i.kb)(x.rootStateKey,(0,u.E2)((0,o.qD)(T,E)))),await C((0,g.us)((0,o.jX)(T),!0))},y=(x,E)=>async(C,b)=>{const T=(0,l.dn)(x,b());C((0,i.kb)(x.rootStateKey,(0,u.D$)((0,o.qD)(T,E)))),await C((0,g.us)((0,o.jX)(T),!0))},f=(x,E)=>async(C,b)=>{const T=(0,l.dn)(x,b());C((0,i.kb)(x.rootStateKey,(0,u.xt)((0,o.qD)(T,E)))),await C((0,g.us)((0,o.jX)(T),!0))},v=(x,E)=>async(C,b)=>{const T=(0,l.dn)(x,b());C((0,i.kb)(x.rootStateKey,(0,u.qZ)((0,o.qD)(T,E)))),await C((0,g.us)((0,o.jX)(T),!0))},P=(x,E)=>async(C,b)=>{const T=(0,l.dn)(x,b());C((0,i.kb)(x.rootStateKey,(0,d.QP)((0,o.qD)(T,{propName:"datasource",propValue:E}))));const R=(await(0,r.tR)().get(E))?.getTagKeys?"Ad hoc filters are applied automatically to all queries that target this data source":"This data source does not support ad hoc filters yet.";C((0,i.kb)(x.rootStateKey,(0,s.BC)({infoText:R})))},m=x=>(E,C)=>{const b=(0,l.y7)(C()),T={...(0,t.cloneDeep)(u.MK),datasource:x.datasource,name:c,id:c,rootStateKey:b},A=!1,R=(0,l.hk)(b,C()),S={type:"adhoc",id:T.id,rootStateKey:b};E((0,i.kb)(b,(0,d.QV)((0,o.qD)(S,{global:A,model:T,index:R}))))},D=(x,E)=>{const C=(0,l.y7)(E),b=(0,l.nx)(C,E);let T;for(const A of Object.values(b.variables))if((0,a.EW)(A)&&A.datasource?.uid===x.datasource.uid){T=A;break}return T}},53699:(_,L,e)=>{"use strict";e.d(L,{AA:()=>u,D$:()=>l,E2:()=>d,MK:()=>a,qZ:()=>o,xt:()=>i});var t=e(65307),n=e(80484),r=e(87421),s=e(83370);const a={...n.Vg,type:"adhoc",datasource:null,filters:[]},g=(0,t.Z0)({name:"templating/adhoc",initialState:s.j,reducers:{filterAdded:(c,p)=>{const h=(0,r.Fs)(c,p.payload.id);h.type==="adhoc"&&h.filters.push(p.payload.data)},filterRemoved:(c,p)=>{const h=(0,r.Fs)(c,p.payload.id);if(h.type!=="adhoc")return;const y=p.payload.data;h.filters.splice(y,1)},filterUpdated:(c,p)=>{const h=(0,r.Fs)(c,p.payload.id);if(h.type!=="adhoc")return;const{filter:y,index:f}=p.payload.data;h.filters[f]=y},filtersRestored:(c,p)=>{const h=(0,r.Fs)(c,p.payload.id);h.type==="adhoc"&&(h.filters=p.payload.data)}}}),{filterAdded:i,filterRemoved:l,filterUpdated:d,filtersRestored:o}=g.actions,u=g.reducer},13344:(_,L,e)=>{"use strict";e.d(L,{Ek:()=>a,To:()=>r,Zm:()=>n,ou:()=>s,qF:()=>t,qz:()=>g});const t="00000000-0000-0000-0000-000000000000",n="All",r="$__all",s="None",a="",g="var-"},35589:(_,L,e)=>{"use strict";e.d(L,{c:()=>l,z:()=>d});var t=e(74848),n=e(92145),r=e(96540),s=e(13544),a=e(40845),g=e(21744),i=e(85140);const l="Grafana-LegacyVariableQueryEditor",d=({onChange:o,query:u})=>{const c=(0,a.of)(i.$),[p,h]=(0,r.useState)(u),y=P=>{h(P.currentTarget.value)},f=(0,r.useCallback)(P=>{o(P.currentTarget.value,P.currentTarget.value)},[o]),v=(0,n.Bi)();return(0,t.jsx)(g.f,{id:v,rows:2,value:p,onChange:y,onBlur:f,placeholder:"Metric name or tags query",required:!0,"data-testid":s.Tp.pages.Dashboard.Settings.Variables.Edit.QueryVariable.queryOptionsQueryInput,cols:52,className:c.textarea})};d.displayName=l},70766:(_,L,e)=>{"use strict";e.d(L,{y:()=>i});var t=e(74848),n=e(96540),r=e(72574),s=e(1682),a=e(24240),g=e(35589);async function i(d,o=s.cS){if((0,a.zs)(d))return d.variables.editor;if((0,a.X3)(d)){const u=await o(d.meta);if(!u.components.QueryEditor)throw new Error("Missing QueryEditor in plugin definition.");return u.components.QueryEditor??null}return(0,a.Hf)(d)?l:(0,a.d5)(d)?(await o(d.meta)).components.VariableQueryEditor??g.z:null}function l({datasource:d,query:o,onChange:u}){const c=(0,n.useCallback)(p=>{u({refId:"StandardVariableQuery",query:p})},[u]);return(0,t.jsx)(g.z,{query:o.query,onChange:c,datasource:d,templateSrv:(0,r.w)()})}},3843:(_,L,e)=>{"use strict";e.d(L,{BC:()=>d,DW:()=>g,Eo:()=>u,FN:()=>a,NY:()=>o,T7:()=>l,nS:()=>n,sJ:()=>i,wf:()=>s,y8:()=>c});var t=e(65307);const n={id:"",isValid:!0,errors:{},name:"",extended:null},r=(0,t.Z0)({name:"templating/editor",initialState:n,reducers:{variableEditorMounted:(p,h)=>{p.name=h.payload.name,p.id=h.payload.id},variableEditorUnMounted:(p,h)=>n,changeVariableNameSucceeded:(p,h)=>{p.name=h.payload.data.newName,delete p.errors.name,p.isValid=Object.keys(p.errors).length===0},changeVariableNameFailed:(p,h)=>{p.name=h.payload.newName,p.errors.name=h.payload.errorText,p.isValid=Object.keys(p.errors).length===0},addVariableEditorError:(p,h)=>{p.errors[h.payload.errorProp]=h.payload.errorText,p.isValid=Object.keys(p.errors).length===0},removeVariableEditorError:(p,h)=>{delete p.errors[h.payload.errorProp],p.isValid=Object.keys(p.errors).length===0},changeVariableEditorExtended:(p,h)=>{p.extended={...p.extended,...h.payload}},cleanEditorState:()=>n}}),s=r.reducer,{changeVariableNameSucceeded:a,changeVariableNameFailed:g,variableEditorMounted:i,variableEditorUnMounted:l,changeVariableEditorExtended:d,addVariableEditorError:o,removeVariableEditorError:u,cleanEditorState:c}=r.actions},85830:(_,L,e)=>{"use strict";e.d(L,{M:()=>t});var t=(n=>(n[n.MaxSize=50]="MaxSize",n))(t||{})},25304:(_,L,e)=>{"use strict";e.d(L,{z:()=>s});var t=e(72574),n=e(20601),r=e(13344);function s(a){const g={},i=(0,t.w)().getVariables();for(let l=0;l<i.length;l++){const d=i[l],o=a&&a[d.name];d.skipUrlSync||(o?g[r.qz+d.name]=o.value:g[r.qz+d.name]=n.B.get(d.type).getValueForUrl(d))}return g}},24240:(_,L,e)=>{"use strict";e.d(L,{CH:()=>y,EW:()=>s,Hf:()=>u,P4:()=>r,SP:()=>i,VN:()=>h,VO:()=>a,X3:()=>p,d5:()=>o,iv:()=>g,m8:()=>l,zs:()=>c});var t=e(29505),n=e(35589);const r=f=>f.type==="query",s=f=>f.type==="adhoc",a=f=>f.type==="constant",g=f=>"multi"in f,i=f=>"options"in f,l=f=>"current"in f;function d(f){return f===null?!1:typeof f=="string"}const o=f=>!!f.metricFindQuery&&!f.variables,u=f=>{if(!f.variables||f.variables.getType()!==t.Qz.Standard)return!1;const v=f.variables;return"toDataQuery"in v&&!!v.toDataQuery},c=f=>{if(!f.variables||f.variables.getType()!==t.Qz.Custom)return!1;const v=f.variables;return"query"in v&&"editor"in v&&!!v.query&&!!v.editor},p=f=>f.variables?f.variables.getType()===t.Qz.Datasource:!1;function h(f,v){return f?f.displayName===n.c||o(v):!1}function y(f,v){return f?f.displayName!==n.c&&(p(v)||u(v)||c(v)):!1}},2223:(_,L,e)=>{"use strict";e.d(L,{i:()=>i});var t=e(74848),n=e(96540),r=e(37390);const s=({nodes:l,edges:d,direction:o,width:u,height:c,onDoubleClick:p})=>{const h=(0,n.useRef)(null),y=(0,n.useRef)(null),f=(0,n.useCallback)(v=>{p&&p(v.nodes[0])},[p]);return(0,n.useEffect)(()=>((async()=>{const P=await e.e(5083).then(e.t.bind(e,83416,23)),m={nodes:a(P,l),edges:g(P,d)},D={width:"100%",height:"100%",autoResize:!0,layout:{improvedLayout:!0,hierarchical:{enabled:!0,direction:o??"DU",sortMethod:"directed"}},interaction:{navigationButtons:!0,dragNodes:!1}};h.current=new P.Network(y.current,m,D),h.current?.on("doubleClick",f)})(),()=>{h.current&&h.current.off("doubleClick")}),[o,d,l,f]),(0,t.jsx)("div",{children:(0,t.jsx)("div",{ref:y,style:{width:u??"100%",height:c??"60vh"}})})};function a(l,d){const o=d.map(u=>({...u,shape:"box"}));return new l.DataSet(o)}function g(l,d){const o=d.map(u=>({...u,arrows:"to",dashes:!0}));return new l.DataSet(o)}function i({edges:l,nodes:d,show:o,title:u,children:c}){const[p,h]=(0,n.useState)(o),y=(0,n.useCallback)(()=>h(!0),[h]),f=(0,n.useCallback)(()=>h(!1),[h]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.a,{isOpen:p,title:u,icon:"info-circle",iconTooltip:"The graph can be moved, zoomed in, and zoomed out.",onClickBackdrop:f,onDismiss:f,children:(0,t.jsx)(s,{nodes:d,edges:l})}),c({showModal:y})]})}},27238:(_,L,e)=>{"use strict";e.d(L,{WT:()=>n,bX:()=>a,t4:()=>s});var t=e(65307);const n={usages:[],usagesNetwork:[]},r=(0,t.Z0)({name:"templating/inspect",initialState:n,reducers:{initInspect:(g,i)=>{const{usages:l,usagesNetwork:d}=i.payload;g.usages=l,g.usagesNetwork=d}}}),s=r.reducer,{initInspect:a}=r.actions},12846:(_,L,e)=>{"use strict";e.d(L,{qJ:()=>u,hI:()=>d,hM:()=>f,H7:()=>o,xU:()=>m,P5:()=>A,g0:()=>v,PK:()=>b,Ow:()=>E});var t=e(6709);function n(R,S){const O=new Set;for(const j of R)O.add(S(j));return O}var r=e(84423),s=e(87490),a=e(34214),g=e(20601),i=e(24240),l=e(75096);const d=R=>{const S=[];for(const O of R)S.push({id:O.id,label:`${O.id}`});return S},o=(R,S)=>R.filter(O=>S.some(j=>j.from===O.id||j.to===O.id)),u=R=>{const S=[];for(const O of R)for(const j of R){if(O===j)continue;g.B.get(O.type).dependsOn(O,j)&&S.push({from:O.id,to:j.id})}return S};function c(R){const S=(0,l.t4)(R);if(!S)return;const O=S.slice(1).find(j=>j!==void 0);if(!(O in{}))return O}const p=(R,S)=>{l.SY.lastIndex=0;const O=[],B=(0,s.MA)(S,2).match(l.SY);if(!B)return O;for(const N of B){if(!N||N.indexOf("$__")!==-1||N.indexOf("${__")!==-1||N.indexOf("$hashKey")!==-1)continue;const I=c(N);R.some(K=>K.id===I)||O.find(K=>K===I)||I&&O.push(I)}return O},h={alias:[/^m$/,/^measurement$/,/^col$/,/^tag_(\w+|\d+)$/],query:[/^timeFilter$/]},y=(R,S,O)=>{const j=Object.keys(S.value).reduce((N,I)=>{const K=S.value[I];if(!K||typeof K!="string")return N;const w=h[I]?h[I].find(W=>W.test(R)):void 0;let U=(0,l.wJ)(K,R);return I==="repeat"&&K===R&&(U=!0),!w&&U&&(N={...N,[I]:K}),N},{}),B=Object.keys(S.value).reduce((N,I)=>{const K=S.value[I];if(K&&typeof K=="object"&&Object.keys(K).length){let w=K.title||K.name||K.id||I;Array.isArray(S.value)&&S.key==="panels"&&(w=`${w}[${K.id}]`);const U=y(R,{key:I,value:K},{});Object.keys(U).length&&(N={...N,[w]:U})}return N},{});return(Object.keys(j).length||Object.keys(B).length)&&(O={...O,...j,...B}),O},f=(R,S)=>{if(!S)return{unUsed:[],usages:[]};const O=[];let j=[];const B=S.getSaveModelCloneOld();for(const N of R){const I=N.id,K=y(I,{key:"model",value:B},{});!Object.keys(K).length&&!(0,i.EW)(N)&&O.push(N),Object.keys(K).length&&j.push({variable:N,tree:K})}return{unUsed:O,usages:j}};async function v(R,S){return new Promise((O,j)=>{setTimeout(()=>{try{const B=P(R,S);O(E(B))}catch(B){j(B)}},200)})}function P(R,S){if(!S)return[];let O=[];const j=S.getSaveModelCloneOld(),B=p(R,j);for(const N of B){const I=y(N,{key:"model",value:j},{});if(Object.keys(I).length){const K={id:N,name:N};O.push({variable:K,tree:I})}}return O}function m(R,S,O){const j=n(S.descendants(R),N=>N.name);j.add(t.c.includeVars);for(const N of R)j.add(N);return D([...j],O)}function D(R,S){const O=[];for(const j of R)S[j]&&O.push(...S[j]);return new Set(O)}const x=(R,S)=>{const{id:O,value:j}=S,{nodes:B,edges:N}=R;if(j&&typeof j=="string"){const I=`${S.id}-${j}`;return B.push({id:I,label:j}),N.push({from:I,to:O}),R}if(j&&typeof j=="object"){const I=Object.keys(j);for(const K of I){const w=`${S.id}-${K}`;B.push({id:w,label:K}),N.push({from:w,to:O}),R=x(R,{id:w,value:j[K]})}return R}return R},E=R=>{const S=[];for(const O of R){const{variable:j,tree:B}=O,N={variable:j,nodes:[{id:"dashboard",label:"dashboard"}],edges:[],showGraph:!1};S.push(x(N,{id:"dashboard",value:B}))}return S},C=R=>Object.values(R).reduce((O,j)=>typeof j=="object"?O+C(j):O+1,0),b=(R,S)=>{const O=S.find(j=>j.variable.id===R);return O?C(O.tree):0};function T(R){const S=[];for(const O of R)S.push(O),O.panels?.length&&S.push(...T(O.panels.map(j=>new PanelModel(j))));return S}function A(R){const S={};for(const O of R){const j=(0,r.tw)(O),B=[...j.matchAll(/"repeat":"([^"]+)"/g)].map(K=>K[1]),N=j.match(l.SY)?.map(K=>c(K))??[],I=[...B,...N];for(const K of I)K in S?S[K].add(O.id):S[K]=new Set([O.id])}return S}},81515:(_,L,e)=>{"use strict";e.d(L,{E5:()=>o,Ez:()=>l,mn:()=>u});var t=e(65307),n=e(2543),r=e.n(n),s=e(12470),a=e(87421),g=e(83370),i=e(80484);const l={...i.Vg,type:"interval",auto_count:30,auto_min:"10s",options:[],auto:!1,query:"1m,10m,30m,1h,6h,12h,1d,7d,14d,30d",refresh:s.CO.onTimeRangeChanged,current:{}},d=(0,t.Z0)({name:"templating/interval",initialState:g.j,reducers:{createIntervalOptions:(c,p)=>{const h=(0,a.Fs)(c,p.payload.id);if(h.type!=="interval")return;const y=(0,n.map)(h.query.match(/(["'])(.*?)\1|\w+/g),f=>(f=f.replace(/["']+/g,""),{text:f.trim(),value:f.trim(),selected:!1}));h.auto&&y.length&&y[0].text!=="auto"&&y.unshift({text:"auto",value:"$__auto_interval_"+h.name,selected:!1}),h.options=y}}}),o=d.reducer,{createIntervalOptions:u}=d.actions},24300:(_,L,e)=>{"use strict";e.d(L,{jR:()=>R,Fu:()=>x,$z:()=>d,O$:()=>E,ho:()=>S,MO:()=>D,an:()=>C,U9:()=>m,fx:()=>T,qh:()=>A,S8:()=>b});var t=e(53076),n=e(65307),r=e(2543),s=e(92053);const a=(O,...j)=>j.reduce((B,N)=>N(B),O);var g=e(13344),i=e(24240);const l=/[^ -~]/gm,d={id:"",highlightIndex:-1,queryValue:"",selectedValues:[],options:[],multi:!1},o=1e3,u=new t.A({intraMode:1,intraIns:1,intraSub:1,intraTrn:1,intraDel:1}),c=O=>Array.isArray(O)?O.reduce((j,B)=>((0,r.isString)(B.value)&&(j[B.value]=B),j),{}):{},p=O=>{if(!Array.isArray(O.options))return O.options=[],O;const j=c(O.selectedValues);return O.selectedValues=Object.values(j),O.options=O.options.map(B=>{if(!(0,r.isString)(B.value))return B;const N=!!j[B.value];return B.selected===N?B:{...B,selected:N}}),O.options=h(O.options),O},h=O=>Array.isArray(O)?O.length<=o?O:O.slice(0,o):[],y=O=>{const{options:j,selectedValues:B}=O;return j.length===0||B.length>0||!j[0]||j[0].value!==g.To||(O.selectedValues=[{...j[0],selected:!0}]),O},f=O=>{const{selectedValues:j}=O;return j.length>1&&(O.selectedValues=j.filter(B=>B.value!==g.To)),O},v=O=>O.filter(j=>j.value!==g.To).map(j=>({...j,selected:!0})),P=(0,n.Z0)({name:"templating/optionsPicker",initialState:d,reducers:{showOptions:(O,j)=>{const{query:B,options:N}=j.payload;if(O.highlightIndex=-1,O.options=(0,r.cloneDeep)(N),O.id=j.payload.id,O.queryValue="",O.multi=!1,(0,i.iv)(j.payload)&&(O.multi=j.payload.multi??!1),(0,i.P4)(j.payload)){const{queryValue:I}=j.payload,K=(0,s.E)(B);O.queryValue=K&&I?I:""}return O.selectedValues=O.options.filter(I=>I.selected),a(O,y,p)},hideOptions:(O,j)=>({...d}),toggleOption:(O,j)=>{const{option:B,clearOthers:N,forceSelect:I}=j.payload,{multi:K,selectedValues:w}=O;if(B){const U=!w.find(W=>W.value===B.value&&W.text===B.text);if(B.value===g.To||!K||N)return U||I?O.selectedValues=[{...B,selected:!0}]:O.selectedValues=[],a(O,y,f,p);if(I||U)return O.selectedValues.push({...B,selected:!0}),a(O,y,f,p);O.selectedValues=w.filter(W=>W.value!==B.value&&W.text!==B.text)}else O.selectedValues=[];return a(O,y,f,p)},moveOptionsHighlight:(O,j)=>{let B=O.highlightIndex+j.payload;return B<0?B=-1:B>=O.options.length&&(B=O.options.length-1),{...O,highlightIndex:B}},toggleAllOptions:(O,j)=>{const B=O.selectedValues.find(I=>I.value===g.To),N=O.options.find(I=>I.value===g.To);return O.selectedValues.length>0&&N&&!B?(O.selectedValues=[],O.selectedValues.push({text:N.text??"All",value:N.value,selected:!0}),a(O,p)):B&&O.selectedValues.length===1?(O.selectedValues=v(O.options),a(O,p)):O.selectedValues.length>0&&!N?(O.selectedValues=[],a(O,p)):(O.selectedValues=v(O.options),a(O,p))},updateSearchQuery:(O,j)=>(O.queryValue=j.payload,O),updateOptionsAndFilter:(O,j)=>{const B=O.queryValue.trim();let N=[];if(B==="")N=j.payload;else if(l.test(B))N=j.payload.filter(I=>I.text.includes(B));else{const I=j.payload.map(({text:W})=>Array.isArray(W)?W.toString():W),[K,w,U]=u.search(I,B,5);K?.length&&(w&&U?N=U.map(W=>j.payload[w.idx[W]]):N=K.map(W=>j.payload[W]),N.sort((W,H)=>(W.value===g.To?-1:0)-(H.value===g.To?-1:0)))}if(O.highlightIndex=0,B!==""){let I=N.findIndex(K=>K.value!==g.To);(I===-1||N[I].value!==B)&&(N.unshift({selected:!1,text:"> "+B,value:B}),O.highlightIndex=I===-1?0:I+1)}return O.options=N,a(O,y,p)},updateOptionsFromSearch:(O,j)=>(O.options=j.payload,O.highlightIndex=0,a(O,y,p)),cleanPickerState:()=>d}}),{toggleOption:m,showOptions:D,hideOptions:x,moveOptionsHighlight:E,toggleAllOptions:C,updateSearchQuery:b,updateOptionsAndFilter:T,updateOptionsFromSearch:A,cleanPickerState:R}=P.actions,S=P.reducer},86886:(_,L,e)=>{"use strict";e.d(L,{C:()=>t});const t=(s,a)=>s&&(a&&!Array.isArray(s.value)?{...s,value:r(s.value),text:r(s.text)}:!a&&Array.isArray(s.value)?{...s,value:n(s.value),text:n(s.text)}:s),n=s=>Array.isArray(s)?s.length>0?s[0]:"":s,r=s=>Array.isArray(s)?s:[s]},72401:(_,L,e)=>{"use strict";e.d(L,{Y7:()=>Ve,TI:()=>X,_q:()=>we,RK:()=>Se,t9:()=>ie,x7:()=>de,Hn:()=>Ke,mZ:()=>Je,kl:()=>he,us:()=>ce});var t=e(2543),n=e(12470),r=e(92041),s=e(39070),a=e(22391),g=e(39601),i=e(34867),l=e(32264),d=e(82467),o=e(16233),u=e(74856),c=e(99140),p=e(3169),h=e(10096),y=e(27677),f=e(34525),v=e(31193),P=e(23989),m=e(20601),D=e(13344),x=e(3843),E=e(24240),C=e(12846),b=e(24300),T=e(86886),A=e(80484),R=e(75096),S=e(73134),O=e(28601),j=e(48594),B=e(84014);const N=(ye,je=-1,ue=!1,Ee=!1)=>{const Ce={};if(Ee){const Ne={...initialVariableModelState,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"A dashboard title",uid:"An dashboard UID",toString:()=>"A dashboard title"}}},Fe={...initialVariableModelState,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{name:"An org name",id:1,toString:()=>"1"}}},Ue={...initialVariableModelState,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:VariableHide.hideVariable,current:{value:{login:"admin",id:1,email:"admin@test",toString:()=>"1"}}};Ce[Ne.id]=Ne,Ce[Fe.id]=Fe,Ce[Ue.id]=Ue}for(let Ne=0;Ne<ye;Ne++)Ce[Ne]=createQueryVariable({id:Ne.toString(),name:`Name-${Ne}`,label:`Label-${Ne}`,index:Ne});return ue&&(Ce[NEW_VARIABLE_ID]=createQueryVariable({id:NEW_VARIABLE_ID,name:`Name-${NEW_VARIABLE_ID}`,label:`Label-${NEW_VARIABLE_ID}`,index:ye})),Ce},I=(ye,je={})=>{const ue={id:"0",rootStateKey:"key",index:0,name:"0"};return{initialState:{0:{...{...ye.initialState,...ue},...je}}}},K=()=>combineReducers({dashboard:dashboardReducer,templating:keyedVariablesReducer}),w=()=>combineReducers({templating:keyedVariablesReducer});function U(ye,je){return{templating:{lastKey:ye,keys:{[ye]:{...getInitialTemplatingState(),...je}}}}}function W(ye,je){return ye.find(Ee=>Ee.name===je)}function H(ye){return(ye.type==="query"||ye.type==="datasource"||ye.type==="interval")&&ye.refresh===S.CO.onTimeRangeChanged}var z=e(87421),G=e(56968),M=e(85675),Q=e(15120);const Y=(ye,je)=>(ue,Ee)=>{let Ce=0;const Ne=je.templating.list;for(let Ue=0;Ue<Ne.length;Ue++){const fe=q(Ne[Ue]);fe.rootStateKey=ye,m.B.getIfExists(fe.type)&&ue((0,j.kb)(ye,(0,G.QV)((0,R.qD)(fe,{global:!1,index:Ce++,model:fe}))))}(0,P.w)().updateTimeRange((0,u.jG)().timeRange());const Fe=(0,z.SS)(ye,Ee());for(const Ue of Fe)ue((0,j.kb)(ye,(0,G.wB)((0,R.qD)(Ue))))};function q(ye){if(!(0,E.SP)(ye))return ye;let je=!1;for(const ue of ye.options)if(ue.selected=!1,Array.isArray(ye.current.value))for(const Ee of ye.current.value)ue.value===Ee&&(ue.selected=je=!0);else ue.value===ye.current.value&&(ue.selected=je=!0);return!je&&ye.options.length&&(ye.options[0].selected=!0),ye}const te=(ye,je)=>ue=>{const Ee={...A.Vg,id:"__dashboard",name:"__dashboard",type:"system",index:-3,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:je.title,uid:je.uid,toString:()=>je.title}}};ue((0,j.kb)(ye,(0,G.QV)((0,R.qD)(Ee,{global:Ee.global,index:Ee.index,model:Ee}))));const Ce={...A.Vg,id:"__org",name:"__org",type:"system",index:-2,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{name:o.TP.user.orgName,id:o.TP.user.orgId,toString:()=>o.TP.user.orgId.toString()}}};ue((0,j.kb)(ye,(0,G.QV)((0,R.qD)(Ce,{global:Ce.global,index:Ce.index,model:Ce}))));const Ne={...A.Vg,id:"__user",name:"__user",type:"system",index:-1,skipUrlSync:!0,hide:n.zL.hideVariable,current:{value:{login:o.TP.user.login,id:o.TP.user.id,email:o.TP.user.email,toString:()=>o.TP.user.id.toString()}}};ue((0,j.kb)(ye,(0,G.QV)((0,R.qD)(Ne,{global:Ne.global,index:Ne.index,model:Ne}))))},X=(ye,je)=>(ue,Ee)=>{const{rootStateKey:Ce}=ye,Ne=(0,z.dn)(ye,Ee());if(!(0,E.iv)(Ne)||(0,r.R)(Ne.current))return;const Fe=(0,T.C)(Ne.current,je);ue((0,j.kb)(Ce,(0,G.QP)((0,R.qD)(ye,{propName:"multi",propValue:je})))),ue((0,j.kb)(Ce,(0,G.QP)((0,R.qD)(ye,{propName:"current",propValue:Fe}))))},ee=async(ye,je)=>{if(!ye.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ye.id}`);if(ne(ye,je))throw new Error("Circular dependency in dashboard variables detected. Dashboard may not work as expected.");const ue=Z(ye,je);ae(ye.rootStateKey,ue,je)&&await new Promise(Ee=>{const Ce=c.M_.subscribe(()=>{if(!ye.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${ye.id}`);ae(ye.rootStateKey,ue,c.M_.getState())||(Ce(),Ee())})})},ne=(ye,je,ue=new Set)=>ue.has(ye.id)?!0:(ue=new Set([...ue,ye.id]),Z(ye,je).some(Ee=>ne(Ee,je,ue))),Z=(ye,je)=>{if(!ye.rootStateKey)return[];const ue=[];for(const Ee of(0,z.SS)(ye.rootStateKey,je))ye!==Ee&&m.B.getIfExists(ye.type)&&m.B.get(ye.type).dependsOn(ye,Ee)&&ue.push(Ee);return ue},ae=(ye,je,ue)=>{if(je.length===0)return!1;const Ee=(0,z.SS)(ye,ue);return je.filter(Ne=>Ee.some(Fe=>Fe.id===Ne.id&&(Fe.state===s.Gu.NotStarted||Fe.state===s.Gu.Loading))).length>0},re=(ye,je)=>async(ue,Ee)=>{const Ce=(0,z.dn)(ye,Ee());await ee(Ce,Ee());const Ne=je[D.qz+Ce.name];if(Ne!==void 0){const Fe=(0,R.QT)(Ne);await m.B.get(Ce.type).setValueFromUrl(Ce,Fe);return}if(Ce.hasOwnProperty("refresh")){const Fe=Ce;if(Fe.refresh===n.CO.onDashboardLoad||Fe.refresh===n.CO.onTimeRangeChanged){await ue(Je((0,R.jX)(Fe)));return}}if(Ce.type==="custom"){await ue(Je((0,R.jX)(Ce)));return}ue(pt(ye))},se=ye=>async(je,ue)=>{const Ee=g.Ny.getSearchObject(),Ce=(0,z.SS)(ye,ue()).map(async Ne=>await je(re((0,R.jX)(Ne),Ee)));await Promise.all(Ce)},de=(ye,je)=>async(ue,Ee)=>{const Ce=(0,R.QT)(je),Ne=(0,z.dn)(ye,Ee());(0,R.q$)(Ne)!==n.CO.never&&await ue(Je((0,R.jX)(Ne)));const Fe=(0,z.dn)((0,R.jX)(Ne),Ee());if(!(0,E.SP)(Fe))return;if(!Fe)throw new Error(`Couldn't find variable with name: ${Ne.name}`);let Ue=Fe.options.find(fe=>fe.text===Ce||fe.value===Ce);if(!Ue&&(0,E.iv)(Fe)&&Fe.allValue&&Ce===Fe.allValue&&(Ue={text:D.Zm,value:D.To,selected:!1}),!Ue){let fe=Ce;const Te=Ce;Array.isArray(Ce)&&(fe=Ce.reduce((Ge,Qe)=>{const st=Fe.options.find(Xe=>Xe.value===Qe);return st?[].concat(Ge,[st.text]):[].concat(Ge,[Qe])},[])),Ue={text:fe,value:Te,selected:!1}}(0,E.iv)(Fe)&&(Ue=(0,T.C)({text:(0,t.castArray)(Ue.text),value:(0,t.castArray)(Ue.value),selected:!1},Fe.multi)),await m.B.get(Ne.type).setValue(Fe,Ue)},le=ye=>{let je,ue,Ee,Ce;const Ne=[];for(je=0;je<ye.options.length;je++)if(Ce={...ye.options[je]},Ce.selected=!1,Array.isArray(ye.current.value))for(ue=0;ue<ye.current.value.length;ue++)Ee=ye.current.value[ue],Ce.value===Ee&&(Ce.selected=!0,Ne.push(Ce));else Ce.value===ye.current.value&&(Ce.selected=!0,Ne.push(Ce));return Ne},he=(ye,je)=>(ue,Ee)=>{const Ce=(0,z.dn)(ye,Ee());if(!(0,E.SP)(Ce))return Promise.resolve();const Ne=Ce.current||{},Fe=m.B.get(Ce.type).setValue;if(Array.isArray(Ne.value)){const Ge=le(Ce);if(Ge.length===0){const st=Ce.options[0];return Fe(Ce,{value:typeof st.value=="string"?[st.value]:st.value,text:typeof st.text=="string"?[st.text]:st.text,selected:!0})}const Qe={value:Ge.map(st=>st.value),text:Ge.map(st=>st.text),selected:!0};return Fe(Ce,Qe)}let Ue=null;const fe=(0,R.Nz)(Ce),Te=(0,R.Lz)(Ce);if(Ue=Ce.options?.find(Ge=>Ge.text===fe||Ge.value===Te),Ue||je&&(Ue=Ce.options?.find(Ge=>Ge.text===je||Ge.value===je),Ue))return Fe(Ce,Ue);if(Ce.options){const Ge=Ce.options[0];if(Ge)return Fe(Ce,Ge)}return Promise.resolve()},ie=(ye,je,ue)=>async Ee=>{const{rootStateKey:Ce}=ye;return Ee((0,j.kb)(Ce,(0,G.dE)((0,R.qD)(ye,{option:je})))),await Ee(ce(ye,ue))},J=ye=>{const je=new f.TS;return ye.forEach(ue=>{je.createNode(ue.name)}),ye.forEach(ue=>{ye.forEach(Ee=>{if(ue!==Ee&&m.B.get(ue.type).dependsOn(ue,Ee))try{je.link(ue.name,Ee.name)}catch(Ce){const Ne=Ce instanceof Error?Ce.message:"Unknown error";(0,i.FF)("Error linking variables",{error:Ne})}})}),je},ce=(ye,je,ue=h.lE)=>async(Ee,Ce)=>{const Ne=Ce(),{rootStateKey:Fe}=ye,Ue=(0,z.dn)(ye,Ne);if((0,z.nx)(Fe,Ne).transaction.status===A.x8.Fetching)return(0,R.q$)(Ue)===n.CO.never&&(await Ee(bt((0,R.jX)(Ue))),Ee(pt(ye))),Promise.resolve();const fe=(0,z.SS)(Fe,Ne),Te=J(fe),Ge=Ne.dashboard?.getModel()?.panels??[],Qe=(0,C.P5)(Ge),st=Ue.type==="adhoc"?{refreshAll:!0,panelIds:[]}:{refreshAll:!1,panelIds:Array.from((0,C.xU)([Ue.id],Te,Qe)),variable:(0,z.dn)(ye,Ne)},Xe=Te.getNode(Ue.name);let ot=[];return Xe&&(ot=Xe.getOptimizedInputEdges().map(ft=>{const _e=fe.find(et=>et.name===ft.inputNode?.name);return _e?Ee(Je((0,R.jX)(_e))):Promise.resolve()})),Promise.all(ot).then(()=>{je&&(ue.publish(new A.og(st)),g.Ny.partial(be(Fe,Ce)))})},pe=(ye,je,ue,Ee)=>(je.includes(ye.name)||je.push(ye.name),ye.outputEdges.forEach(Ce=>{const Ne=Ce.outputNode;if(Ne&&!je.includes(Ne.name)){const Fe=ue.find(Ue=>Ue.name===Ne.name);Fe&&Fe.refresh===n.CO.onTimeRangeChanged&&Ee.indexOf(Fe)===-1?(Ee.push(Fe),je.push(Ne.name)):pe(Ne,je,ue,Ee)}}),Ee),Pe=(ye,je)=>ye.outputEdges.every(ue=>{const Ee=ue.outputNode;if(Ee){const Ce=W(je,Ee.name);if(Ce&&Ce.type==="query")return Ce.refresh!==n.CO.onTimeRangeChanged}return!0}),Ie=(ye,je)=>{const ue=(0,z.SS)(ye,je),Ee=J(ue),Ce=[],Ne=[];return ue.forEach(Fe=>{const Ue=Ee.getNode(Fe.name);if(!Ce.includes(Fe.name)&&Ue){const fe=W(ue,Ue.name);if(!fe)return;const Te=H(fe);Te&&Ue.outputEdges.length===0&&Ne.push(fe),Te&&Ne.includes(fe)&&Ue.outputEdges.length>0&&(Ne.push(fe),pe(Ue,Ce,ue,Ne)),Te&&Ue.outputEdges.length>0&&Pe(Ue,ue)&&(Ne.includes(fe)||Ne.push(fe)),!Te&&Ue.outputEdges.length>0&&pe(Ue,Ce,ue,Ne)}}),Ne},ge=(ye,je)=>(0,z.SS)(ye,je).filter(Ce=>"refresh"in Ce&&"options"in Ce?Ce.refresh===n.CO.onTimeRangeChanged:!1),Se=(ye,je,ue={templateSrv:(0,P.w)(),events:h.lE})=>async(Ee,Ce)=>{ue.templateSrv.updateTimeRange(je);let Ne=[];l.$.featureToggles.refactorVariablesTimeRange?Ne=Ie(ye,Ce()):Ne=ge(ye,Ce());const Fe=Ne.map(fe=>fe.id),Ue=Ne.map(fe=>Ee(De((0,R.jX)(fe))));try{await Promise.all(Ue),ue.events.publish(new A.BS({variableIds:Fe}))}catch(fe){console.error(fe),Ee((0,d.dx)(nt("Template variable service failed",fe)))}},De=ye=>async(je,ue)=>{const Ee=(0,z.dn)(ye,ue());if(!(0,E.SP)(Ee))return;const Ce=Ee.options.slice();await je(Je((0,R.jX)(Ee),!0));const Ne=(0,z.dn)(ye,ue());if(!(0,E.SP)(Ne))return;const Fe=Ne.options;JSON.stringify(Ce)!==JSON.stringify(Fe)&&ue().dashboard.getModel()?.templateVariableValueUpdated()},Ke=(ye,je,ue=h.lE)=>async(Ee,Ce)=>{const Ne=[],Fe=Ce().dashboard.getModel(),Ue=(0,z.SS)(ye,Ce());for(const st of Ue){const Xe=D.qz+st.name;if(!je.hasOwnProperty(Xe)||!Me(st,je[Xe].value))continue;let ot=je[Xe].value;if(je[Xe].removed){const _e=Fe?.templating.list.find(et=>et.name===st.name);_e&&(0,E.m8)(_e)&&(ot=_e.current.value),_e&&_e.type==="constant"&&(ot=_e.query)}const ft=m.B.get(st.type).setValueFromUrl(st,ot);Ne.push(ft)}const fe=Ue.filter(st=>{const Xe=D.qz+st.name;return je.hasOwnProperty(Xe)&&Me(st,je[Xe].value)&&st.type!=="adhoc"}),Te=J(Ue),Ge=(0,C.P5)(Fe?.panels??[]),Qe=(0,C.xU)(fe.map(st=>st.id),Te,Ge);Ne.length&&(await Promise.all(Ne),ue.publish(new A.eF({refreshAll:Qe.size===0,panelIds:Array.from(Qe)})))};function Me(ye,je){const ue=m.B.get(ye.type).getValueForUrl(ye);let Ee=(0,R.QT)(je);return Array.isArray(ue)&&!Array.isArray(Ee)&&(Ee=[Ee]),!(0,t.isEqual)(ue,Ee)}const be=(ye,je)=>{const ue=g.Ny.getSearchObject(),Ee=Object.keys(ue).filter(Ce=>Ce.indexOf(D.qz)===-1).reduce((Ce,Ne)=>(Ce[Ne]=ue[Ne],Ce),{});for(const Ce of(0,z.SS)(ye,je())){if(Ce.skipUrlSync)continue;const Ne=m.B.get(Ce.type);Ee[D.qz+Ce.name]=Ne.getValueForUrl(Ce)}return Ee},we=(ye,je)=>async(ue,Ee)=>{try{const Ce=(0,R.q4)(ye),Ne=Ee(),Fe=(0,z.Tk)(Ne);Fe&&(0,z.nx)(Fe,Ne).transaction.status===A.x8.Fetching&&ue(Ve(Fe)),ue((0,j.kb)(Ce,(0,M.kH)({uid:Ce}))),ue(te(Ce,je)),ue(Y(Ce,je)),ue(Be(Ce)),await ue(se(Ce)),ue((0,j.kb)(Ce,(0,M.$O)({uid:Ce})))}catch(Ce){ue((0,d.dx)(nt("Templating init failed",Ce))),console.error(Ce)}};function Be(ye,je=v.tR){return(ue,Ee)=>{const Ce=(0,z.SS)(ye,Ee());for(const Ne of Ce){if(Ne.type!=="adhoc"&&Ne.type!=="query")continue;const{datasource:Fe}=Ne;if((0,a.fN)(Fe))continue;const Ue=je().getInstanceSettings(Fe),fe=Ue?(0,a.p$)(Ue):{uid:Fe};ue((0,j.kb)(ye,(0,G.QP)((0,R.qD)(Ne,{propName:"datasource",propValue:fe}))))}}}const He=ye=>je=>{je((0,j.kb)(ye,(0,Q.v)())),je((0,j.kb)(ye,(0,x.y8)())),je((0,j.kb)(ye,(0,b.jR)())),je((0,j.kb)(ye,(0,M.pu)()))},Ve=(ye,je={getBackendSrv:y.AI})=>ue=>{je.getBackendSrv().cancelAllInFlightRequests(),ue(He(ye))},Je=(ye,je=!1)=>async(ue,Ee)=>{const{rootStateKey:Ce}=ye;try{if(!(0,R.sN)(Ce,Ee()))return;const Ne=(0,z.dn)(ye,Ee());ue((0,j.kb)(Ce,(0,G.a7)((0,R.qD)(Ne)))),await ue(bt((0,R.jX)(Ne))),await m.B.get(Ne.type).updateOptions(Ne),ue(pt(ye))}catch(Ne){if(ue((0,j.kb)(Ce,(0,G.Te)((0,R.qD)(ye,{error:Ne})))),je||(console.error(Ne),ue((0,d.dx)(nt("Error updating options:",Ne,ye)))),je)throw Ne}},nt=(ye,je,ue)=>(0,p.gi)(`${ue?`Templating [${ue.id}]`:"Templating"}`,je instanceof Error?`${ye} ${je.message}`:`${ye}`),pt=ye=>(je,ue)=>{const{rootStateKey:Ee}=ye;if(!(0,R.sN)(Ee,ue()))return;const Ce=(0,z.dn)(ye,ue());Ce.state!==s.Gu.Done&&je((0,j.kb)(ye.rootStateKey,(0,G.Pu)((0,R.qD)(Ce))))};function bt(ye,je=v.tR){return async function(ue,Ee){const{id:Ce,rootStateKey:Ne}=ye;if(!(0,R.sN)(Ne,Ee()))return;const Fe=(0,z.dn)(ye,Ee());if(Fe.type==="query")try{const Ue=await je().get(Fe.datasource??"");if((0,E.d5)(Ue)||!(0,E.Hf)(Ue)||Tt(Fe.query))return;const fe={refId:`${Ue.name}-${Ce}-Variable-Query`,query:Fe.query};ue((0,j.kb)(Ne,(0,G.QP)((0,R.qD)(ye,{propName:"query",propValue:fe}))))}catch(Ue){ue((0,d.dx)(nt("Failed to upgrade legacy queries",Ue))),console.error(Ue)}}}function Tt(ye){return(0,s.Gv)(ye)&&"refId"in ye&&typeof ye.refId=="string"}},48594:(_,L,e)=>{"use strict";e.d(L,{Ay:()=>d,L1:()=>s,kb:()=>g});var t=e(75096),n=e(84014),r=e(85675);const s={keys:{}},a=o=>({type:`templating/keyed/${o.action.type.replace(/^templating\//,"")}`,payload:o});function g(o,u){const c=(0,t.q4)(o);return a({key:c,action:u})}const i=o=>typeof o.type=="string"&&o.type.startsWith("templating/keyed")&&"payload"in o&&typeof o.payload.key=="string";function l(o=s,u){if(i(u)){const{key:c,action:p}=u.payload,h=(0,t.q4)(c),y=r.kH.match(p)?h:o.lastKey,f=(0,n.H)(),v=o.keys[h],P=f(v,p);return{...o,lastKey:y,keys:{...o.keys,[h]:P}}}return o}const d={templating:l}},84014:(_,L,e)=>{"use strict";e.d(L,{H:()=>d,x:()=>o});var t=e(14644),n=e(3843),r=e(27238),s=e(24300),a=e(85675),g=e(83370),i=e(15120);let l;function d(){return l||(l=(0,t.combineReducers)({editor:n.wf,variables:i.Y,optionsPicker:s.ho,transaction:a.Dd,inspect:r.t4})),l}function o(){return{editor:n.nS,variables:g.j,optionsPicker:s.$z,transaction:a.i3,inspect:r.WT}}},87421:(_,L,e)=>{"use strict";e.d(L,{Fs:()=>D,SS:()=>l,Tk:()=>y,UN:()=>P,_2:()=>m,bZ:()=>v,dn:()=>a,hk:()=>c,nS:()=>u,nx:()=>i,pi:()=>o,wk:()=>p,y7:()=>f});var t=e(41811),n=e(99140),r=e(75096),s=e(84014);function a(x,E=(0,n.Gu)(),C=!0){const{id:b,rootStateKey:T}=x,R=i(T,E).variables[b];if(!R){if(C)throw new Error(`Couldn't find variable with id:${b}`);return}return R}function g(x,E,C=(0,n.Gu)()){return Object.values(i(E,C).variables).filter(x).sort((b,T)=>b.index-T.index)}function i(x,E=(0,n.Gu)()){return E.templating.keys[(0,r.q4)(x)]??(0,s.x)()}function l(x,E=(0,n.Gu)()){return g(d,x,E)}function d(x){return x.type!=="system"}const o=(0,t.A)((x,E)=>l(x,(0,n.Gu)())),u=(x,E)=>l(x,E);function c(x,E=(0,n.Gu)()){return p(Object.values(i(x,E).variables))}function p(x){const E=x.filter(d).sort((C,b)=>C.index-b.index);return E.length>0?E[E.length-1].index+1:0}function h(x,E=getState()){return i(x,E).transaction.isDirty}function y(x=(0,n.Gu)()){return x.templating?.lastKey}function f(x=(0,n.Gu)()){if(!x.templating?.lastKey)throw new Error("Accessing lastKey without initializing it variables");return x.templating.lastKey}function v(x,E=(0,n.Gu)()){const C=y(E);return C?g(x,C,E):[]}function P(x=(0,n.Gu)()){const E=y(x);return E?l(E,x):[]}function m(x,E=(0,n.Gu)()){const C=y(E);if(C)return a({id:x,rootStateKey:C,type:"query"},E,!1)}function D(x,E){return x[E]}},56968:(_,L,e)=>{"use strict";e.d(L,{Hr:()=>p,Pu:()=>E,QP:()=>y,QV:()=>h,Te:()=>C,a7:()=>x,dE:()=>P,hj:()=>f,l_:()=>m,qi:()=>c,ut:()=>v,wB:()=>D});var t=e(65307),n=e(2543),r=e.n(n),s=e(39070),a=e(20601),g=e(3843),i=e(24240),l=e(75096),d=e(87421),o=e(83370);const u=(0,t.Z0)({name:"templating/shared",initialState:o.j,reducers:{addVariable:(b,T)=>{const A=T.payload.id??T.payload.data.model.name,R=a.B.get(T.payload.type),S=(0,n.cloneDeep)(R.initialState),O=R.beforeAdding?R.beforeAdding(T.payload.data.model):(0,n.cloneDeep)(T.payload.data.model),j={...(0,n.defaults)({},O,S),id:A,index:T.payload.data.index,global:T.payload.data.global};b[A]=j},variableStateNotStarted:(b,T)=>{const A=(0,d.Fs)(b,T.payload.id);A.state=s.Gu.NotStarted,A.error=null},variableStateFetching:(b,T)=>{const A=(0,d.Fs)(b,T.payload.id);A.state=s.Gu.Loading,A.error=null},variableStateCompleted:(b,T)=>{const A=(0,d.Fs)(b,T.payload.id);A&&(A.state=s.Gu.Done,A.error=null)},variableStateFailed:(b,T)=>{const A=(0,d.Fs)(b,T.payload.id);A&&(A.state=s.Gu.Error,A.error=T.payload.data.error)},removeVariable:(b,T)=>{if(delete b[T.payload.id],!T.payload.data.reIndex)return;const A=Object.values(b).sort((R,S)=>R.index-S.index);for(let R=0;R<A.length;R++)A[R].index=R},duplicateVariable:(b,T)=>{function A(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const R=(0,n.cloneDeep)(b[T.payload.id]),S=new RegExp(`^copy_of_${A(R.name)}(_(\\d+))?$`),O=Object.values(b).map(({name:w})=>w.match(S)).filter(w=>w!=null),j=O.map(w=>w[2]).filter(w=>w!=null),B=O.length===0?null:j.length===0?1:j.map(w=>+w).sort((w,U)=>U-w)[0]+1,N=`copy_of_${R.name}${B?`_${B}`:""}`,I=T.payload.data?.newId??N,K=(0,d.wk)(Object.values(b));b[I]={...(0,n.cloneDeep)(a.B.get(T.payload.type).initialState),...R,id:I,name:N,index:K}},changeVariableOrder:(b,T)=>{const{toIndex:A,fromIndex:R}=T.payload.data,S=Object.values(b);for(let O=0;O<S.length;O++){const j=S[O];j.index===R?j.index=A:j.index>R&&j.index<=A?j.index--:j.index<R&&j.index>=A&&j.index++}},changeVariableType:(b,T)=>{const{id:A}=T.payload,{label:R,name:S,index:O,description:j,rootStateKey:B}=b[A];b[A]={...(0,n.cloneDeep)(a.B.get(T.payload.data.newType).initialState),id:A,rootStateKey:B,label:R,name:S,index:O,description:j}},setCurrentVariableValue:(b,T)=>{if(!T.payload.data.option)return;const A=(0,d.Fs)(b,T.payload.id);if(!(0,i.SP)(A))return;const{option:R}=T.payload.data,S={...R,text:(0,l.QT)(R?.text),value:(0,l.QT)(R?.value)};A.current=S,A.options=A.options.map(O=>{O.value=(0,l.QT)(O.value),O.text=(0,l.QT)(O.text);let j=!1;if(Array.isArray(S.value))for(let B=0;B<S.value.length;B++){const N=S.value[B];if(O.value===N){j=!0;break}}else O.value===S.value&&(j=!0);return O.selected=j,O})},changeVariableProp:(b,T)=>{const A=(0,d.Fs)(b,T.payload.id);A[T.payload.data.propName]=T.payload.data.propValue}},extraReducers:b=>b.addCase(g.FN,(T,A)=>{const R=(0,d.Fs)(T,A.payload.id);R.name=A.payload.data.newName})}),c=u.reducer,{removeVariable:p,addVariable:h,changeVariableProp:y,changeVariableOrder:f,duplicateVariable:v,setCurrentVariableValue:P,changeVariableType:m,variableStateNotStarted:D,variableStateFetching:x,variableStateCompleted:E,variableStateFailed:C}=u.actions},85675:(_,L,e)=>{"use strict";e.d(L,{$O:()=>d,Dd:()=>o,i3:()=>s,kH:()=>i,pu:()=>l});var t=e(65307),n=e(80484),r=e(56968);const s={uid:null,status:n.x8.NotStarted,isDirty:!1},a=(0,t.Z0)({name:"templating/transaction",initialState:s,reducers:{variablesInitTransaction:(u,c)=>{u.uid=c.payload.uid,u.status=n.x8.Fetching},variablesCompleteTransaction:(u,c)=>{u.uid===c.payload.uid&&(u.status=n.x8.Completed)},variablesClearTransaction:(u,c)=>{u.uid=null,u.status=n.x8.NotStarted,u.isDirty=!1}},extraReducers:u=>u.addMatcher(g,(c,p)=>{c.status===n.x8.Completed&&(c.isDirty=!0)})});function g(u){return r.Hr.match(u)||r.QV.match(u)||r.QP.match(u)||r.hj.match(u)||r.ut.match(u)||r.l_.match(u)}const{variablesInitTransaction:i,variablesClearTransaction:l,variablesCompleteTransaction:d}=a.actions,o=a.reducer},83370:(_,L,e)=>{"use strict";e.d(L,{j:()=>t});const t={}},15120:(_,L,e)=>{"use strict";e.d(L,{Y:()=>g,v:()=>a});var t=e(65307),n=e(20601),r=e(56968),s=e(83370);const a=(0,t.VP)("templating/cleanVariables"),g=(i=s.j,l)=>{if(a.match(l)){const d=Object.values(i).filter(u=>u.global);return d?d.reduce((u,c)=>(u[c.id]=c,u),{}):s.j}return l?.payload?.type&&n.B.getIfExists(l?.payload?.type)?n.B.get(l.payload.type).reducer((0,r.qi)(i,l),l):i}},80484:(_,L,e)=>{"use strict";e.d(L,{BS:()=>l,Vg:()=>g,eF:()=>d,og:()=>i,x8:()=>a});var t=e(12470),n=e(39070),r=e(65463),s=e(13344),a=(o=>(o.NotStarted="Not started",o.Fetching="Fetching",o.Completed="Completed",o))(a||{});const g={id:s.qF,rootStateKey:null,name:"",type:"query",global:!1,index:-1,hide:t.zL.dontHide,skipUrlSync:!1,state:n.Gu.NotStarted,error:null,description:null};class i extends r.x{static{this.type="variables-changed"}}class l extends r.x{static{this.type="variables-time-range-process-done"}}class d extends r.x{static{this.type="variables-changed-in-url"}}},75096:(_,L,e)=>{"use strict";e.d(L,{AX:()=>D,Lz:()=>f,ML:()=>h,Nz:()=>y,QT:()=>C,SY:()=>u,Wz:()=>E,iP:()=>P,jX:()=>A,q$:()=>m,q4:()=>T,qD:()=>R,sN:()=>b,t4:()=>c,u7:()=>v,wJ:()=>p});var t=e(2543),n=e.n(t),r=e(12470),s=e(72574),a=e(87490),g=e(99140),i=e(20601),l=e(13344),d=e(87421),o=e(80484);const u=/\$(\w+)|\[\[(\w+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g,c=O=>(u.lastIndex=0,u.exec(O));function p(...O){const j=O[O.length-1];O[0]=typeof O[0]=="string"?O[0]:(0,a.MA)(O[0]);const N=O.slice(0,-1).join(" ").match(u);return!!(N!==null?N.find(K=>{const w=c(K);return w!==null&&w.indexOf(j)>-1}):!1)}const h=O=>{if(!O||!O.current)return!1;if(O.current.value){const j=Array.isArray(O.current.value);if(j&&O.current.value.length&&O.current.value[0]===l.To||!j&&O.current.value===l.To)return!0}if(O.current.text){const j=Array.isArray(O.current.text);if(j&&O.current.text.length&&O.current.text[0]===l.Zm||!j&&O.current.text===l.Zm)return!0}return!1},y=O=>!O||!O.current||!O.current.text?"":Array.isArray(O.current.text)?O.current.text.toString():typeof O.current.text!="string"?"":O.current.text,f=O=>!O||!O.current||O.current.value===void 0||O.current.value===null?null:Array.isArray(O.current.value)?O.current.value.toString():typeof O.current.value!="string"?null:O.current.value;function v(O,j=(0,s.w)()){return!O||!O.regex?"":j.replace(O.regex,{},"regex")}function P(O,j,B,N){const I={range:void 0,variable:O,searchFilter:j,scopedVars:N};return(O.refresh===r.CO.onTimeRangeChanged||O.refresh===r.CO.onDashboardLoad)&&(I.range=B.timeRange()),I}function m(O){return O?.type==="custom"?r.CO.onDashboardLoad:!O||!("refresh"in O)||O.refresh!==r.CO.onTimeRangeChanged&&O.refresh!==r.CO.onDashboardLoad?r.CO.never:O.refresh}function D(){return i.B.list().filter(O=>O.id!=="system").map(({id:O,name:j,description:B})=>({label:j,value:O,description:B}))}function x(O){return(0,t.isArray)(O)&&(O.length===0?O=void 0:O.length===1&&(O=O[0])),O}function E(O,j){let B=0;const N={};for(const I in O){if(!I.startsWith(l.qz))continue;let K=x(j[I]),w=x(O[I]);(0,t.isEqual)(w,K)||(N[I]={value:O[I]},B++)}for(const I in j){if(!I.startsWith(l.qz))continue;const K=j[I];(0,t.isArray)(K)&&K.length===0||O.hasOwnProperty(I)||(N[I]={value:"",removed:!0},B++)}return B?N:void 0}function C(O){return Array.isArray(O)?O.map(String):O==null?"":typeof O=="number"?O.toString(10):typeof O=="string"?O:typeof O=="boolean"?O.toString():""}function b(O,j=(0,g.Gu)()){return(0,d.nx)(O,j).transaction.status!==o.x8.NotStarted}function T(O){return String(O)}const A=O=>{if(!O.rootStateKey)throw new Error(`rootStateKey not found for variable with id:${O.id}`);return{type:O.type,id:O.id,rootStateKey:O.rootStateKey}};function R(O,j){return{type:O.type,id:O.id,data:j}}function S(){const O=getTemplateSrv().getVariables(),j=locationService.getSearchObject();return Object.keys(j).filter(B=>B.indexOf(VARIABLE_PREFIX)!==-1&&O.some(N=>N.name===B.replace(VARIABLE_PREFIX,""))).reduce((B,N)=>{const I=N.replace(VARIABLE_PREFIX,"");return B[I]=j[N],B},{})}},41188:(_,L,e)=>{"use strict";var t=e(6262),n=e(9423),r=e(7452),s=e(78624),a=e(4213),g=e(34796),i=e(13609),l=e(2543),d=e.n(l),o=e(96540),u=e(5338),c=e(47232),p=e(1933),h=e(69550),y=e(97497),f=e(96915),v=e(71733),P=e(17172),m=e(23509),D=e(39601),x=e(96937),E=e(61706),C=e(3591),b=e(63639),T=e(89191),A=e(19347),R=e(4402),S=e(3197),O=e(71798),j=e(79396),B=e(7299),N=e(14778),I=e(23172),K=e(63415),w=e(97152),U=e(24308),W=e(46235),H=e(2913),z=e(94041),G=e(32264),M=e(74848),Q=e(11261),Y=e(85200),q=e(1173),te=e(28240),X=e(18282),ee=e(97522),ne=e(73376),Z=e(14186),ae=e(94354),re=e(90613),se=e(55852),de=e(91847);function le(F){if(F in de.uk){const{name:V,getHelperDocs:k,links:oe}=de.uk[F],ve=k(de.g_.UIImage),me=he(ve);if(oe?.length){const Ae=oe.map(We=>`
  Or visit <a href="${We.url}" target="_blank">${We.title}</a>

  `).join("");return{name:V,helperDocs:`
        ${me}
        ${(0,de.$n)()}
  ${Ae}
        `}}return{name:V,helperDocs:`
      ${me}
      ${(0,de.$n)()}
      `}}return{name:"No documentation found",helperDocs:(0,de.$n)()}}const he=F=>F.replace(/\[(.*?)\]\(#.*?\)/g,"$1").replace(/\[[^\]]*\]\[\]/g,"");var ie=e(39268),J=e(90182),ce=e(83077),pe=e(91890),Pe=e(72574),Ie=e(10354),ge=e(88841),Se=e(94397);function De(F,V){switch(V.type){case Q.PU.boolean:return(0,l.isUndefined)(F)?!1:Ke(F);case Q.PU.number:return isNaN(F)?0:parseFloat(F);case Q.PU.string:return F?String(F):"";default:return F}}const Ke=F=>(0,l.isString)(F)?!(F[0]==="F"||F[0]==="f"||F[0]==="0"):!!F;function Me(F){return function({options:k,onChange:oe,field:ve}){const{validator:me,converter:Ae=De}=F,{value:We}=k,[$e,tt]=(0,o.useState)(!me(We)),ct=(0,Pe.w)().getVariables().map(gt=>({value:gt.name,label:gt.label||gt.name,origin:pe.$0.Template})),Et=(0,o.useCallback)(gt=>{tt(!me(gt.currentTarget.value))},[tt,me]),ht=(0,o.useCallback)(gt=>{if($e)return;const{value:Vt}=gt.currentTarget;oe({...k,value:Ae(Vt,ve)})},[k,oe,$e,ve,Ae]),mt=(0,o.useCallback)(gt=>{tt(!me(gt)),oe({...k,value:gt})},[tt,me,oe,k]);return G.$.featureToggles.transformationsVariableSupport?(0,M.jsx)(ge.y,{invalid:$e,value:We,error:"Value needs to be an integer or a variable",onChange:mt,placeholder:"Value or variable",suggestions:ct}):(0,M.jsx)(Ie.p,{className:"flex-grow-1",invalid:$e,defaultValue:String(k.value),placeholder:"Value",onChange:Et,onBlur:ht})}}const be=()=>[{name:"Is greater",id:q.Js.greater,component:Me({validator:Se.N_})},{name:"Is greater or equal",id:q.Js.greaterOrEqual,component:Me({validator:Se.N_})},{name:"Is lower",id:q.Js.lower,component:Me({validator:Se.N_})},{name:"Is lower or equal",id:q.Js.lowerOrEqual,component:Me({validator:Se.N_})},{name:"Is equal",id:q.Js.equal,component:Me({validator:()=>!0})},{name:"Is not equal",id:q.Js.notEqual,component:Me({validator:()=>!0})},{name:"Is Substring",id:q.Js.substring,component:Me({validator:()=>!0})},{name:"Is not substring",id:q.Js.notSubstring,component:Me({validator:()=>!0})}],we=()=>null,Be=()=>[{name:"Is null",id:q.Js.isNull,component:we},{name:"Is not null",id:q.Js.isNotNull,component:we}];var He=e(76892);function Ve(F){return function({options:k,onChange:oe,field:ve}){const{validator:me}=F,[Ae,We]=(0,o.useState)({from:!me(k.from),to:!me(k.to)}),tt=(0,Pe.w)().getVariables().map(ht=>({value:ht.name,label:ht.label||ht.name,origin:pe.$0.Template})),at=(0,o.useCallback)((ht,mt)=>{We({...Ae,[mt]:!me(ht.currentTarget.value)})},[We,me,Ae]),ct=(0,o.useCallback)((ht,mt)=>{if(Ae[mt])return;const{value:gt}=ht.currentTarget;oe({...k,[mt]:De(gt,ve)})},[k,oe,Ae,ve]),Et=(0,o.useCallback)((ht,mt)=>{const gt=!me(ht);We({...Ae,[mt]:gt}),!gt&&oe({...k,[mt]:ht})},[k,oe,Ae,We,me]);return G.$.featureToggles.transformationsVariableSupport?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ge.y,{value:String(k.from),invalid:Ae.from,error:"Value needs to be an integer or a variable",placeholder:"From",onChange:ht=>Et(ht,"from"),suggestions:tt}),(0,M.jsx)(He.c,{children:"and"}),(0,M.jsx)(ge.y,{invalid:Ae.to,error:"Value needs to be an integer or a variable",value:String(k.to),placeholder:"To",suggestions:tt,onChange:ht=>Et(ht,"to")})]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Ie.p,{invalid:Ae.from,defaultValue:String(k.from),placeholder:"From",onChange:ht=>at(ht,"from"),onBlur:ht=>ct(ht,"from")}),(0,M.jsx)(He.c,{children:"and"}),(0,M.jsx)(Ie.p,{invalid:Ae.to,defaultValue:String(k.to),placeholder:"To",onChange:ht=>at(ht,"to"),onBlur:ht=>ct(ht,"to")})]})}}const Je=()=>[{name:"Is between",id:q.Js.between,component:Ve({validator:Se.N_})}];function nt(F){return function({options:k,onChange:oe,field:ve}){const{validator:me,converter:Ae=De}=F,{value:We}=k,[$e,tt]=(0,o.useState)(!me(We)),ct=(0,Pe.w)().getVariables().map(gt=>({value:gt.name,label:gt.label||gt.name,origin:pe.$0.Template})),Et=(0,o.useCallback)(gt=>{tt(!me(gt.currentTarget.value))},[tt,me]),ht=(0,o.useCallback)(gt=>{tt(!me(gt)),oe({...k,value:gt})},[tt,me,oe,k]),mt=(0,o.useCallback)(gt=>{if($e)return;const{value:Vt}=gt.currentTarget;oe({...k,value:Ae(Vt,ve)})},[k,oe,$e,ve,Ae]);return G.$.featureToggles.transformationsVariableSupport?(0,M.jsx)(ge.y,{invalid:$e,value:We,onChange:ht,placeholder:"Value or variable",suggestions:ct}):(0,M.jsx)(Ie.p,{className:"flex-grow-1",invalid:$e,defaultValue:String(k.value),placeholder:"Value",onChange:Et,onBlur:mt})}}const pt=()=>[{name:"Regex",id:q.Js.regex,component:nt({validator:()=>!0,converter:F=>String(F)})}],bt=new ce.O(()=>[...be(),...Be(),...Je(),...pt()]),Tt=F=>{const{onDelete:V,onChange:k,filter:oe,fieldsInfo:ve}=F,{fieldsAsOptions:me,fieldByDisplayName:Ae}=ve,We=ue(oe,me)??"",$e=Ae[We],tt=$e?ye($e):[],at=je(oe,tt),ct=bt.getIfExists(at),Et=(0,o.useCallback)(gt=>{gt?.value&&k({...oe,fieldName:gt.value})},[k,oe]),ht=(0,o.useCallback)(gt=>{if(!gt?.value)return;const Vt=gt.value,Cn=Y.hI.get(Vt).getDefaultOptions($e);k({...oe,config:{id:Vt,options:Cn}})},[k,oe,$e]),mt=(0,o.useCallback)(gt=>{k({...oe,config:{...oe.config,options:gt}})},[k,oe]);return!$e||!ct||!ct.component?null:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Field",labelWidth:14,children:(0,M.jsx)(J.l6,{className:"min-width-15 max-width-24",placeholder:"Field Name",options:me,value:oe.fieldName,onChange:Et})}),(0,M.jsx)(Z.I,{label:"Match",children:(0,M.jsx)(J.l6,{className:"width-12",placeholder:"Select test",options:tt,value:at,onChange:ht})}),(0,M.jsx)(Z.I,{label:"Value",grow:!0,children:(0,M.jsx)(ct.component,{field:$e,options:oe.config.options??{},onChange:mt})}),(0,M.jsx)(re.a,{marginBottom:.5,children:(0,M.jsx)(se.$n,{icon:"times",onClick:V,variant:"secondary"})})]})},ye=F=>{const V=[];for(const k of Y.hI.list())!k.isApplicable(F)||!bt.getIfExists(k.id)||V.push({value:k.id,label:k.name,description:k.description});return V},je=(F,V)=>{const k=V.find(oe=>oe.value===F.config.id);if(k&&k.value)return k.value;if(V[0]?.value)return V[0]?.value},ue=(F,V)=>{const k=V.find(oe=>oe.value===F.fieldName);if(k&&k.value)return k.value;if(V[0]?.value)return V[0]?.value},Ee=[{label:"Include",value:ne.j4.include},{label:"Exclude",value:ne.j4.exclude}],Ce=[{label:"Match all",value:ne.Sm.all},{label:"Match any",value:ne.Sm.any}],Ne=F=>{const{input:V,options:k,onChange:oe}=F,ve=Ue(V),me=(0,o.useCallback)(()=>{const at=V[0],ct=at.fields.find(mt=>mt.type!==Q.PU.time);if(!ct)return;const Et=(0,l.cloneDeep)(k.filters),ht=Y.hI.get(q.Js.isNull);Et.push({fieldName:(0,te.Ct)(ct,at,V),config:{id:ht.id,options:ht.getDefaultOptions(ct)}}),oe({...k,filters:Et})},[oe,k,V]),Ae=(0,o.useCallback)(at=>{let ct=(0,l.cloneDeep)(k.filters);ct.splice(at,1),oe({...k,filters:ct})},[k,oe]),We=(0,o.useCallback)((at,ct)=>{let Et=(0,l.cloneDeep)(k.filters);Et[ct]=at,oe({...k,filters:Et})},[k,oe]),$e=(0,o.useCallback)(at=>{oe({...k,type:at??ne.j4.include})},[k,oe]),tt=(0,o.useCallback)(at=>{oe({...k,match:at??ne.Sm.all})},[k,oe]);return(0,M.jsxs)("div",{children:[(0,M.jsx)(Z.I,{label:"Filter type",labelWidth:16,children:(0,M.jsx)("div",{className:"width-15",children:(0,M.jsx)(ae.z,{options:Ee,value:k.type,onChange:$e,fullWidth:!0})})}),(0,M.jsx)(Z.I,{label:"Conditions",labelWidth:16,children:(0,M.jsx)("div",{className:"width-15",children:(0,M.jsx)(ae.z,{options:Ce,value:k.match,onChange:tt,fullWidth:!0})})}),(0,M.jsxs)(re.a,{paddingLeft:2,children:[k.filters.map((at,ct)=>(0,M.jsx)(Tt,{filter:at,fieldsInfo:ve,onChange:Et=>We(Et,ct),onDelete:()=>Ae(ct)},ct)),(0,M.jsx)(se.$n,{icon:"plus",size:"sm",onClick:me,variant:"secondary",children:"Add condition"})]})]})},Fe={id:X.F.filterByValue,editor:Ne,transformation:ee.c.filterByValueTransformer,name:ee.c.filterByValueTransformer.name,description:"Removes rows of the query results using user-defined filters. This is useful if you can not filter your data in the data source.",categories:new Set([y.m.Filter]),help:le(X.F.filterByValue).helperDocs},Ue=F=>(0,o.useMemo)(()=>{const V={fieldsAsOptions:[],fieldByDisplayName:{}};return Array.isArray(F)?F.reduce((k,oe)=>oe.fields.reduce((ve,me)=>{const Ae=(0,te.Ct)(me,oe,F);return ve.fieldByDisplayName[Ae]||(ve.fieldsAsOptions.push({label:Ae,value:Ae,type:me.type}),ve.fieldByDisplayName[Ae]=me),ve},k),V):V},[F]);var fe=e(43429),Te=e(60264),Ge=e(48192),Qe=e(66211),st=e(54612);function Xe(F,V){const k={data:F.input,options:F.options},oe=new Ge.C({id:"root",title:"root"}),ve=Ae=>{if(Ae?.length){const We=Ae[0];let $e=oe.categories.find(tt=>tt.props.id===We);return $e||($e=new Ge.C({id:We,title:We}),oe.categories.push($e)),$e}return oe},me={getValue:Ae=>(0,l.get)(F.options,Ae),onChange:(Ae,We)=>{F.onChange((0,st.Sf)(F.options,Ae,We))}};return(0,Qe.g5)(V,me,ve,k),oe}function ot(F){const V={data:[],options:{}},k={},oe=new Te.pv;F(oe,V);for(const ve of oe.getItems())ve.defaultValue!=null&&(0,l.set)(k,ve.path,ve.defaultValue);return k}var ft=e(27825),_e=e(80909);const et=(F,V)=>{const k=V.options??{};(0,ft.J)("",F,k)},it=F=>{(0,o.useEffect)(()=>{if(!F.options.xBuckets?.mode){const k=ot(et);F.onChange({...k,...F.options})}});const V=Xe(F,et);return(0,M.jsx)("div",{children:(0,M.jsx)("div",{children:V.items.map(k=>k.render())})})},dt={id:_e.wY.id,editor:it,transformation:_e.wY,name:_e.wY.name,description:_e.wY.description,state:fe.pn.alpha,categories:new Set([y.m.CreateNewVisualization]),help:le(_e.wY.id).helperDocs};var ze=e(32196),xe=e(40845),Oe=e(84349),Le=e(75059),Ze=e(42734),qe=e(24293),rt=e(28802),vt=e(50082),Ot=e(25019);function jt(F,V,k){const oe={},ve={};for(const me of F.fields){const Ae=(0,te.Ct)(me,F),We=k.index[Ae],$e=We.handler;if(!$e)continue;const tt=me.values[V];if(tt==null)continue;const at=$e.processor(tt,oe,ve,We.handlerArguments);at!=null&&(oe[$e.targetProperty??$e.key]=at)}return ve.mappingValues&&(oe.mappings=qt(ve)),oe}var Ut=(F=>(F.Name="field.name",F.Value="field.value",F.Label="field.label",F.Ignore="__ignore",F))(Ut||{});const zt=[{key:"field.name",name:"Field name",processor:()=>{}},{key:"field.value",name:"Field value",processor:()=>{}},{key:"field.label",name:"Field label",processor:()=>{}},{key:"__ignore",name:"Ignore",processor:()=>{}},{key:"max",processor:An},{key:"min",processor:An},{key:"unit",processor:F=>F.toString()},{key:"decimals",processor:An},{key:"displayName",name:"Display name",processor:F=>F.toString()},{key:"color",processor:F=>({fixedColor:F,mode:qe.Y.Fixed})},{key:"threshold1",name:"Threshold",targetProperty:"thresholds",processor:(F,V,k,oe)=>{const ve=(0,rt.t)(F);if(!isNaN(ve))return V.thresholds||(V.thresholds={mode:vt.O.Absolute,steps:[{value:-1/0,color:"green"}]}),V.thresholds.steps.push({value:ve,color:oe.threshold?.color??"red"}),V.thresholds}},{key:"mappings.value",name:"Value mappings / Value",targetProperty:"mappings",defaultReducer:Le.gy.allValues,processor:(F,V,k)=>{if((0,l.isArray)(F))return k.mappingValues=F,V.mappings}},{key:"mappings.color",name:"Value mappings / Color",targetProperty:"mappings",defaultReducer:Le.gy.allValues,processor:(F,V,k)=>{if((0,l.isArray)(F))return k.mappingColors=F,V.mappings}},{key:"mappings.text",name:"Value mappings / Display text",targetProperty:"mappings",defaultReducer:Le.gy.allValues,processor:(F,V,k)=>{if((0,l.isArray)(F))return k.mappingTexts=F,V.mappings}}];function qt(F){const V={type:Ot.d.ValueToText,options:{}};if(!F.mappingValues)return[];for(let k=0;k<F.mappingValues.length;k++){const oe=F.mappingValues[k];oe!=null&&(V.options[oe.toString()]={color:F.mappingColors&&F.mappingColors[k],text:F.mappingTexts&&F.mappingTexts[k],index:k})}return[V]}let fn=null;function Sn(){if(fn===null){fn={};for(const F of zt)fn[F.key]=F}return fn}function An(F){const V=(0,rt.t)(F);if(!isNaN(V))return V}function Hn(F,V){for(const k of V)if(F===k.fieldName)return k.handlerKey;return F.toLowerCase()}function es(F){return F?Sn()[F]:null}function rs(F,V,k){const oe={index:{}};let ve=V.find(Ae=>Ae.handlerKey==="field.name"),me=V.find(Ae=>Ae.handlerKey==="field.value");for(const Ae of F.fields){const We=(0,te.Ct)(Ae,F),$e=V.find(ct=>ct.fieldName===We),tt=$e?$e.handlerKey:We.toLowerCase();let at=es(tt);k&&(at?(at.key==="field.name"&&(oe.nameField=Ae),at.key==="field.value"&&(oe.valueField=Ae)):$e||(!oe.nameField&&!ve&&Ae.type===Q.PU.string&&(oe.nameField=Ae,at=es("field.name")),!oe.valueField&&!me&&Ae.type===Q.PU.number&&(oe.valueField=Ae,at=es("field.value")))),!at&&k&&(at=es("field.label")),oe.index[We]={automatic:!$e,handler:at,handlerArguments:$e?.handlerArguments??{},reducerId:$e?.reducerId??at?.defaultReducer??Le.gy.lastNotNull}}return oe}var Zn=e(83598);function kn(F){switch(F){case"threshold1":return!0;default:return!1}}function Gn({handlerArguments:F,handlerKey:V,onChange:k}){const oe=ve=>{k(ve?{...F,threshold:{...F.threshold,color:ve}}:{...F,threshold:void 0})};return(0,M.jsx)(M.Fragment,{children:V==="threshold1"&&(0,M.jsx)(Ie.p,{type:"text",value:"Threshold color","aria-label":"Threshold color",disabled:!0,width:20,prefix:(0,M.jsx)(Zn.sk,{color:F.threshold?.color??"red",onChange:oe,enableNamedColors:!0})})})}function Kn({frame:F,mappings:V,onChange:k,withReducers:oe,withNameAndValue:ve}){const me=(0,xe.of)(Jn),Ae=yn(F,V,ve),We=zt.map(Et=>wn(Et,!1)),$e=V.reduce((Et,ht)=>Et||kn(ht.handlerKey),!1),tt=(Et,ht)=>{const mt=V.findIndex(gt=>gt.fieldName===Et.fieldName);if(ht)if(mt!==-1){const gt=[...V];gt.splice(mt,1,{...V[mt],handlerKey:ht.value}),k(gt)}else k([...V,{fieldName:Et.fieldName,handlerKey:ht.value}]);else k(mt!==-1?V.filter((gt,Vt)=>Vt!==mt):[...V,{fieldName:Et.fieldName,handlerKey:"__ignore"}])},at=(Et,ht)=>{const mt=V.findIndex(gt=>gt.fieldName===Et.fieldName);if(mt!==-1){const gt=[...V];gt.splice(mt,1,{...V[mt],reducerId:ht}),k(gt)}else k([...V,{fieldName:Et.fieldName,handlerKey:Et.handlerKey,reducerId:ht}])},ct=(Et,ht)=>{const mt=V.findIndex(gt=>gt.fieldName===Et.fieldName);if(mt!==-1){const gt=[...V];gt.splice(mt,1,{...V[mt],handlerArguments:ht}),k(gt)}else k([...V,{fieldName:Et.fieldName,handlerKey:Et.handlerKey,handlerArguments:ht}])};return(0,M.jsxs)("table",{className:me.table,children:[(0,M.jsx)("thead",{children:(0,M.jsxs)("tr",{children:[(0,M.jsx)("th",{children:"Field"}),(0,M.jsx)("th",{children:"Use as"}),oe&&(0,M.jsx)("th",{children:"Select"}),$e&&(0,M.jsx)("th",{children:"Additional settings"})]})}),(0,M.jsx)("tbody",{children:Ae.map(Et=>(0,M.jsxs)("tr",{children:[(0,M.jsx)("td",{className:me.labelCell,children:Et.fieldName}),(0,M.jsx)("td",{className:me.selectCell,"data-testid":`${Et.fieldName}-config-key`,children:(0,M.jsx)(J.l6,{options:We,value:Et.configOption,placeholder:Et.placeholder,isClearable:!0,onChange:ht=>tt(Et,ht)})}),oe&&(0,M.jsx)("td",{"data-testid":`${Et.fieldName}-reducer`,className:me.selectCell,children:(0,M.jsx)(Ze.S,{stats:[Et.reducerId],defaultStat:Et.reducerId,onChange:ht=>at(Et,ht[0])})}),$e&&(0,M.jsx)("td",{"data-testid":`${Et.fieldName}-handler-arg`,className:me.selectCell,children:(0,M.jsx)(Gn,{handlerKey:Et.handlerKey,handlerArguments:Et.handlerArguments,onChange:ht=>ct(Et,ht)})})]},Et.fieldName))})]})}function yn(F,V,k){const oe=[],ve=rs(F,V??[],k);for(const me of F.fields){const Ae=(0,te.Ct)(me,F),We=ve.index[Ae],$e=wn(We.handler,We.automatic);oe.push({fieldName:Ae,configOption:We.automatic?null:$e,placeholder:We.automatic?$e?.label:"Choose",handlerKey:We.handler?.key??null,reducerId:We.reducerId,handlerArguments:We.handlerArguments})}for(const me of V)if(!oe.find(Ae=>Ae.fieldName===me.fieldName)){const Ae=es(me.handlerKey);oe.push({fieldName:me.fieldName,handlerKey:me.handlerKey,configOption:wn(Ae,!1),missingInFrame:!0,reducerId:me.reducerId??Le.gy.lastNotNull,handlerArguments:{}})}return Object.values(oe)}function wn(F,V){if(!F)return null;let k=F.name??(0,l.capitalize)(F.key);return V&&(k=`${k} (auto)`),{label:k,value:F.key}}const Jn=F=>({table:(0,ze.css)`
    margin-top: ${F.spacing(1)};

    td,
    th {
      border-right: 4px solid ${F.colors.background.primary};
      border-bottom: 4px solid ${F.colors.background.primary};
      white-space: nowrap;
    }
    th {
      font-size: ${F.typography.bodySmall.fontSize};
      line-height: ${F.spacing(4)};
      padding: ${F.spacing(0,1)};
    }
  `,labelCell:(0,ze.css)`
    font-size: ${F.typography.bodySmall.fontSize};
    background: ${F.colors.background.secondary};
    padding: ${F.spacing(0,1)};
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 140px;
  `,selectCell:(0,ze.css)`
    padding: 0;
    min-width: 161px;
  `});var bn=e(81160);function Pt(F,V){let k=null;for(const We of V)if(We.refId===F.configRefId){k=We;break}if(!k)return V;const oe={fields:[],length:1},ve=rs(k,F.mappings??[],!1);for(const We of k.fields){const $e={...We},tt=(0,te.Ct)(We,k),at=ve.index[tt],ct=(0,Le.Nw)({field:We,reducers:[at.reducerId]});$e.values=[ct[at.reducerId]],oe.fields.push($e)}const me=[],Ae=(0,Y.NS)(F.applyTo||{id:q.Ct.numeric});for(const We of V){if(We===k&&V.length>1)continue;const $e={fields:[],length:We.length,refId:We.refId};for(const tt of We.fields)if(Ae(tt,We,V)){const at=jt(oe,0,ve);$e.fields.push({...tt,config:{...tt.config,...at}})}else $e.fields.push(tt);me.push($e)}return me}const Ft={id:X.F.configFromData,name:"Config from query results",description:"Set unit, min, max and more from data.",defaultOptions:{configRefId:"config",mappings:[]},operator:F=>V=>V.pipe((0,bn.T)(k=>Pt(F,k)))};function Xt({input:F,onChange:V,options:k}){const oe=(0,xe.of)(on),ve=F.map(ht=>ht.refId).filter(ht=>ht!=null).map(ht=>({label:ht,value:ht})),me=k.configRefId||"config",Ae=k.applyTo??{id:q.Ct.byType,options:"number"},We=Oe.g.get(Ae.id),$e=F.find(ht=>ht.refId===me),tt=ht=>{V({...k,configRefId:ht.value||"config"})},at=ht=>{V({...k,applyTo:{id:ht.value}})},ct=ht=>{V({...k,applyTo:{id:Ae.id,options:ht}})},Et=Oe.g.list().filter(ht=>!ht.excludeFromPicker).map(ht=>({label:ht.name,value:ht.id,description:ht.description}));return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Config query",labelWidth:20,children:(0,M.jsx)(J.l6,{onChange:tt,options:ve,value:me,width:30})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Apply to",labelWidth:20,children:(0,M.jsx)(J.l6,{onChange:at,options:Et,value:Ae.id,width:30})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Apply to options",labelWidth:20,className:oe.matcherOptions,children:(0,M.jsx)(We.component,{matcher:We.matcher,data:F,options:Ae.options,onChange:ct})})}),(0,M.jsx)(ie.C,{children:$e&&(0,M.jsx)(Kn,{frame:$e,mappings:k.mappings,onChange:ht=>V({...k,mappings:ht}),withReducers:!0})})]})}const sn={id:Ft.id,editor:Xt,transformation:Ft,name:Ft.name,description:Ft.description,state:fe.pn.beta,categories:new Set([y.m.CalculateNewFields]),help:le(Ft.id).helperDocs},on=F=>({matcherOptions:(0,ze.css)`
    min-width: 404px;
  `});var xn=e(62467),Un=e(58307),hn=e(66350),St=e(15292),kt=e(11710),en=e(4025);const tn=16,gn=F=>{const{options:V,onChange:k}=F,oe=(0,hn.pR)(F.options.binary?.left??"",F.names),ve=(0,hn.pR)(F.options.binary?.right??"",F.names);(oe!==F.options.binary?.left||ve!==F.options.binary?.right)&&k({...V,mode:hn.UY.BinaryOperation,binary:{operator:V.binary?.operator,left:oe,right:ve}});const{binary:me}=V;let Ae=!me?.left,We=!me?.right;const $e=!me?.left?.matcher,tt=!me?.right?.matcher,at=me?.left?.matcher?.options,ct=me?.right?.matcher?.options,Et=me?.left?.matcher?.id===q.Ct.byName,ht=me?.right?.matcher?.id===q.Ct.byName,mt=F.names.map(Ms=>(Et&&Ms===at&&(Ae=!0),ht&&Ms===ct&&(We=!0),{label:Ms,value:JSON.stringify({matcher:{id:q.Ct.byName,options:Ms}})})),gt=Ae?[...mt]:Et?[...mt,{label:at,value:JSON.stringify(me.left),icon:""}]:[...mt],Vt=We?[...mt]:ht?[...mt,{label:ct,value:JSON.stringify(me.right),icon:""}]:[...mt];gt.push({label:`All ${Q.PU.number} fields`,value:JSON.stringify({matcher:{id:q.Ct.byType,options:Q.PU.number}}),icon:(0,en.lV)(Q.PU.number)}),$e&&me?.left?.fixed&&gt.push({label:me.left.fixed,value:JSON.stringify(me.left)??"",icon:""}),tt&&me?.right?.fixed&&Vt.push({label:me.right.fixed,value:JSON.stringify(me.right)??"",icon:""});const Cn=kt.b.list().map(Ms=>({label:Ms.binaryOperationID,value:Ms.binaryOperationID})),Mn=Ms=>{k({...V,mode:hn.UY.BinaryOperation,binary:Ms})},Fn=Ms=>{const Ca=JSON.parse(Ms.value??"");Ca.matcher?Mn({...me,left:Ca}):Mn({...me,left:{fixed:Ca.fixed??Ms.value?.toString()}})},Wn=Ms=>{const Ca=JSON.parse(Ms.value??"");Ca.matcher?Mn({...me,right:Ca}):Mn({...me,right:{fixed:Ca.fixed??Ms.value?.toString()}})},ta=Ms=>{Mn({...me,operator:Ms.value})};return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Operation",labelWidth:tn,children:(0,M.jsx)(J.l6,{allowCustomValue:!0,placeholder:"Field(s) or number",options:gt,className:"min-width-18",value:JSON.stringify(me?.left),onChange:Fn})}),(0,M.jsx)(Z.I,{children:(0,M.jsx)(J.l6,{className:"width-4",options:Cn,value:me?.operator??Cn[0].value,onChange:ta})}),(0,M.jsx)(Z.I,{children:(0,M.jsx)(J.l6,{allowCustomValue:!0,placeholder:"Field or number",className:"min-width-10",options:Vt,value:JSON.stringify(me?.right),onChange:Wn})})]})})},Nn=F=>{const{names:V,onChange:k,options:oe}=F,{cumulative:ve}=oe,me=V.map(tt=>({label:tt,value:tt})),Ae=tt=>{const at=tt.length?tt[0]:Le.gy.sum;We({...ve,reducer:at})},We=tt=>{k({...oe,mode:hn.UY.CumulativeFunctions,cumulative:tt})},$e=tt=>{We({...ve,field:tt.value})};return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Field",labelWidth:tn,children:(0,M.jsx)(J.l6,{placeholder:"Field",options:me,className:"min-width-18",value:ve?.field,onChange:$e})}),(0,M.jsx)(Z.I,{label:"Calculation",labelWidth:tn,children:(0,M.jsx)(Ze.S,{allowMultiple:!1,className:"width-18",stats:[ve?.reducer||Le.gy.sum],onChange:Ae,defaultStat:Le.gy.sum,filterOptions:tt=>tt.id===Le.gy.sum||tt.id===Le.gy.mean})})]})},Ct=F=>{const{options:V,onChange:k}=F,{index:oe}=V,ve=me=>{k({...V,index:{asPercentile:me.currentTarget.checked}})};return(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(Z.I,{labelWidth:tn,label:"As percentile",tooltip:"Transform the row index as a percentile.",children:(0,M.jsx)(St.K,{value:!!oe?.asPercentile,onChange:ve})})})};var Rt=e(66864),Mt=e(92174);const Kt=F=>{const{names:V,selected:k,onChange:oe,options:ve}=F,{reduce:me}=ve,Ae=at=>{oe({...ve,reduce:at})},We=at=>{k.indexOf(at)>-1?$e(k.filter(ct=>ct!==at)):$e([...k,at])},$e=at=>{Ae({...me,include:at})},tt=at=>{const ct=at.length?at[0]:Le.gy.sum,{reduce:Et}=ve;Ae({...Et,reducer:ct})};return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Operation",labelWidth:tn,grow:!0,children:(0,M.jsx)(Rt.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:V.map((at,ct)=>(0,M.jsx)(Mt.m,{onClick:()=>{We(at)},label:at,selected:k.indexOf(at)>-1},`${at}/${ct}`))})}),(0,M.jsx)(Z.I,{label:"Calculation",labelWidth:tn,children:(0,M.jsx)(Ze.S,{allowMultiple:!1,className:"width-18",stats:[me?.reducer||Le.gy.sum],onChange:tt,defaultStat:Le.gy.sum})})]})};var nn=e(27618);const Qt=F=>{const{options:V,onChange:k}=F,{unary:oe}=V,ve=ct=>{k({...V,mode:hn.UY.UnaryOperation,unary:ct})},me=ct=>{ve({...oe,operator:ct.value})},Ae=ct=>{ve({...oe,fieldName:ct.value})};let We=!oe?.fieldName;const $e=F.names.map(ct=>(ct===oe?.fieldName&&(We=!0),{label:ct,value:ct})),tt=nn.j.list().map(ct=>({label:ct.unaryOperationID,value:ct.unaryOperationID})),at=We?$e:[...$e,{label:oe?.fieldName,value:oe?.fieldName}];return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Operation",labelWidth:tn,children:(0,M.jsx)(J.l6,{options:tt,value:oe?.operator??tt[0].value,onChange:me})}),(0,M.jsx)(Z.I,{label:"(",labelWidth:2,children:(0,M.jsx)(J.l6,{placeholder:"Field",className:"min-width-11",options:at,value:oe?.fieldName,onChange:Ae})}),(0,M.jsx)(He.c,{width:2,children:")"})]})})};var ln=e(60188);const pn=F=>{const{options:V,names:k,onChange:oe}=F,{window:ve}=V,me=k.map(mt=>({label:mt,value:mt})),Ae=[{label:"Trailing",value:hn.ip.Trailing},{label:"Centered",value:hn.ip.Centered}],We=[{label:"Percentage",value:hn.Bp.Percentage},{label:"Fixed",value:hn.Bp.Fixed}],$e=mt=>{oe({...V,mode:hn.UY.WindowFunctions,window:mt})},tt=mt=>{$e({...ve,field:mt.value})},at=mt=>{$e({...ve,windowSize:mt&&ve?.windowSizeMode===hn.Bp.Percentage?mt/100:mt})},ct=mt=>{$e({...ve,windowSize:ve?.windowSize?mt===hn.Bp.Percentage?ve.windowSize/100:ve.windowSize*100:void 0,windowSizeMode:mt})},Et=mt=>{const gt=mt.length?mt[0]:Le.gy.sum;$e({...ve,reducer:gt})},ht=mt=>{$e({...ve,windowAlignment:mt})};return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Field",labelWidth:tn,children:(0,M.jsx)(J.l6,{placeholder:"Field",options:me,className:"min-width-18",value:ve?.field,onChange:tt})}),(0,M.jsx)(Z.I,{label:"Calculation",labelWidth:tn,children:(0,M.jsx)(Ze.S,{allowMultiple:!1,className:"width-18",stats:[ve?.reducer||Le.gy.mean],onChange:Et,defaultStat:Le.gy.mean,filterOptions:mt=>mt.id===Le.gy.mean||mt.id===Le.gy.variance||mt.id===Le.gy.stdDev})}),(0,M.jsx)(Z.I,{label:"Type",labelWidth:tn,children:(0,M.jsx)(ae.z,{value:ve?.windowAlignment??hn.ip.Trailing,options:Ae,onChange:ht})}),(0,M.jsx)(Z.I,{label:"Window size mode",children:(0,M.jsx)(ae.z,{value:ve?.windowSizeMode??hn.Bp.Percentage,options:We,onChange:ct})}),(0,M.jsx)(Z.I,{label:ve?.windowSizeMode===hn.Bp.Percentage?"Window size %":"Window size",labelWidth:tn,tooltip:ve?.windowSizeMode===hn.Bp.Percentage?"Set the window size as a percentage of the total data":"Window size",children:(0,M.jsx)(ln.Q,{placeholder:"Auto",min:.1,value:ve?.windowSize&&ve.windowSizeMode===hn.Bp.Percentage?ve.windowSize*100:ve?.windowSize,onChange:at})})]})},In=[{value:hn.UY.BinaryOperation,label:"Binary operation"},{value:hn.UY.UnaryOperation,label:"Unary operation"},{value:hn.UY.ReduceRow,label:"Reduce row"},{value:hn.UY.Index,label:"Row index"}];G.$.featureToggles.addFieldFromCalculationStatFunctions&&In.push({value:hn.UY.CumulativeFunctions,label:"Cumulative functions"},{value:hn.UY.WindowFunctions,label:"Window functions"});const Rn=new Set([Q.PU.time,Q.PU.number,Q.PU.string]),qn=F=>{const{options:V,onChange:k,input:oe}=F,ve=V?.reduce?.include,[me,Ae]=(0,o.useState)({names:[],selected:[]});(0,o.useEffect)(()=>{const gt={interpolate:Cn=>Cn},Vt=(0,xn.of)(oe).pipe(ee.c.ensureColumnsTransformer.operator(null,gt),$e(),We(),tt(ve||[])).subscribe(({selected:Cn,names:Mn})=>{Ae({names:Mn,selected:Cn})});return()=>{Vt.unsubscribe()}},[oe,ve]);const We=()=>{if(!G.$.featureToggles.transformationsVariableSupport)return Un.D;const gt=(0,Pe.w)();return Vt=>Vt.pipe((0,bn.T)(Cn=>(Cn.push(...gt.getVariables().map(Mn=>"$"+Mn.name)),Cn)))},$e=()=>gt=>gt.pipe((0,bn.T)(Vt=>{const Cn=[],Mn={};for(const Fn of Vt)for(const Wn of Fn.fields){if(!Rn.has(Wn.type))continue;const ta=(0,te.Ct)(Wn,Fn,Vt);Mn[ta]||(Mn[ta]=!0,Cn.push(ta))}return Cn})),tt=gt=>Vt=>Vt.pipe((0,bn.T)(Cn=>{if(!gt.length)return{names:Cn,selected:[]};const Mn=[],Fn=[];for(const Wn of Cn)gt.includes(Wn)&&Fn.push(Wn),Mn.push(Wn);return{names:Mn,selected:Fn}})),at=gt=>{k({...V,replaceFields:gt.currentTarget.checked})},ct=gt=>{const Vt=gt.value??hn.UY.BinaryOperation;Vt===hn.UY.WindowFunctions&&(V.window=V.window??hn.Uj),k({...V,mode:Vt})},Et=gt=>{k({...V,alias:gt.target.value})},ht=V.mode??hn.UY.BinaryOperation,mt=ht===hn.UY.BinaryOperation&&V.binary?.left.matcher?.id===q.Ct.byType;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{labelWidth:tn,label:"Mode",children:(0,M.jsx)(J.l6,{className:"width-18",options:In,value:In.find(gt=>gt.value===ht),onChange:ct})}),ht===hn.UY.BinaryOperation&&(0,M.jsx)(gn,{options:V,names:me.names,onChange:F.onChange}),ht===hn.UY.UnaryOperation&&(0,M.jsx)(Qt,{names:me.names,options:V,onChange:F.onChange}),ht===hn.UY.ReduceRow&&(0,M.jsx)(Kt,{names:me.names,selected:me.selected,options:V,onChange:F.onChange}),ht===hn.UY.CumulativeFunctions&&(0,M.jsx)(Nn,{names:me.names,options:V,onChange:F.onChange}),ht===hn.UY.WindowFunctions&&(0,M.jsx)(pn,{names:me.names,options:V,onChange:F.onChange}),ht===hn.UY.Index&&(0,M.jsx)(Ct,{options:V,onChange:F.onChange}),(0,M.jsx)(Z.I,{labelWidth:tn,label:"Alias",disabled:mt,children:(0,M.jsx)(Ie.p,{className:"width-18",value:V.alias??"",placeholder:(0,hn.sw)(V),onChange:Et})}),(0,M.jsx)(Z.I,{labelWidth:tn,label:"Replace all fields",children:(0,M.jsx)(St.K,{value:!!V.replaceFields,onChange:at})})]})},os={id:X.F.calculateField,editor:qn,transformation:ee.c.calculateFieldTransformer,name:ee.c.calculateFieldTransformer.name,description:"Use the row values to calculate a new field.",categories:new Set([y.m.CalculateNewFields]),help:le(X.F.calculateField).helperDocs};var cs=e(82150);const hs=[{value:cs.x1.FieldName,label:"Copy frame name to field name"},{value:cs.x1.Label,label:"Add a label with the frame name"},{value:cs.x1.Drop,label:"Ignore the frame name"}];class Ss extends o.PureComponent{constructor(V){super(V),this.onModeChanged=k=>{const{options:oe,onChange:ve}=this.props,me=k.value??cs.x1.FieldName;ve({...oe,frameNameMode:me})},this.onLabelChanged=k=>{const{options:oe}=this.props;this.props.onChange({...oe,frameNameLabel:k.target.value})}}render(){const{options:V}=this.props,k=V.frameNameMode??cs.x1.FieldName;return(0,M.jsxs)("div",{children:[(0,M.jsx)(Z.I,{label:"Name",labelWidth:16,grow:!0,children:(0,M.jsx)(J.l6,{width:36,options:hs,value:hs.find(oe=>oe.value===k),onChange:this.onModeChanged})}),k===cs.x1.Label&&(0,M.jsx)(Z.I,{label:"Label",labelWidth:16,grow:!0,children:(0,M.jsx)(Ie.p,{width:36,value:V.frameNameLabel??"",placeholder:"frame",onChange:this.onLabelChanged})})]})}}const Os={id:X.F.concatenate,editor:Ss,transformation:ee.c.concatenateTransformer,name:ee.c.concatenateTransformer.name,description:"Combine all fields into a single frame.  Values will be appended with undefined values if not the same length.",categories:new Set([y.m.Combine]),help:le(X.F.concatenate).helperDocs};var ka=e(91410),na=e(76218),_a=e(9988),Oa=e(63577),ba=e(91076),Rs=e(14578),Aa=e(72093),va=e(29158);const la=({transformIndex:F,value:V,index:k,mappedIndex:oe,onChangeEnumValue:ve,onRemoveEnumRow:me,checkIsEnumUniqueValue:Ae})=>{const We=(0,xe.of)(or),[$e,tt]=(0,o.useState)(V),[at,ct]=(0,o.useState)($e===""),[Et,ht]=(0,o.useState)(null),mt=(0,o.useRef)(null);(0,o.useEffect)(()=>{mt.current&&mt.current.focus()},[mt]);const gt=Wn=>{Wn.currentTarget.value!==""&&Ae(Wn.currentTarget.value)&&Wn.currentTarget.value!==V?ht("Enum value already exists"):ht(null),tt(Wn.currentTarget.value)},Vt=()=>{if(ct(!1),ht(null),$e===""||Et!==null){me(oe);return}ve(oe,$e)},Cn=Wn=>{Wn.key==="Enter"&&(Wn.preventDefault(),Vt())},Mn=()=>{ct(!0)},Fn=()=>{me(oe)};return(0,M.jsx)(ba.sx,{draggableId:`${F}/${V}`,index:k,children:Wn=>(0,M.jsxs)("tr",{ref:Wn.innerRef,...Wn.draggableProps,children:[(0,M.jsx)("td",{children:(0,M.jsx)("div",{className:We.dragHandle,...Wn.dragHandleProps,children:(0,M.jsx)(Rs.I,{name:"draggabledots",size:"lg"})})}),at?(0,M.jsxs)("td",{children:[(0,M.jsx)(Ie.p,{ref:mt,type:"text",value:$e,onChange:gt,onBlur:Vt,onKeyDown:Cn}),Et&&(0,M.jsx)(Aa.P,{children:Et})]}):(0,M.jsx)("td",{onClick:Mn,className:We.clickableTableCell,children:V&&V!==""?V:"Click to edit"}),(0,M.jsx)("td",{className:We.textAlignCenter,children:(0,M.jsx)(Rt.Gy,{spacing:"sm",children:(0,M.jsx)(va.K,{name:"trash-alt",onClick:Fn,"data-testid":"remove-enum-row","aria-label":"Delete enum row",tooltip:"Delete"})})})]},k)},`${F}/${V}`)},or=F=>({dragHandle:(0,ze.css)({cursor:"grab"}),textAlignCenter:(0,ze.css)({textAlign:"center"}),clickableTableCell:(0,ze.css)({cursor:"pointer",width:"100px","&:hover":{color:F.colors.text.maxContrast}})}),Dr=la,Cr=({input:F,options:V,transformIndex:k,onChange:oe})=>{const ve=(0,xe.of)(Fa),[me,Ae]=(0,o.useState)(V.conversions[k].enumConfig?.text??[]);(0,o.useEffect)(()=>{!V.conversions[k].enumConfig?.text?.length&&F.length&&We()},[F]),(0,o.useEffect)(()=>{(()=>{const gt=me.map(Mn=>Mn),Vt=V.conversions,Cn={text:gt};Vt[k]={...Vt[k],enumConfig:Cn},oe({...V,conversions:Vt})})()},[k,me]);const We=()=>{const mt=F.flatMap(Vt=>Vt?.fields??[]).find(Vt=>Vt.name===V.conversions[k].targetField);if(!mt)return;const gt=new Set(mt?.values);me.length>0&&!(0,l.isEqual)(me,Array.from(gt))&&!window.confirm("This action will overwrite the existing configuration. Are you sure you want to continue?")||Ae([...gt])},$e=(mt,gt)=>{const Vt=[...me];Vt.splice(mt,1,gt),Ae(Vt)},tt=mt=>{const gt=[...me];gt.splice(mt,1),Ae(gt)},at=()=>{Ae(["",...me])},ct=(mt,gt)=>{me.includes(gt)||$e(mt,gt)},Et=mt=>me.includes(mt),ht=mt=>{if(!mt.destination)return;const gt=me.length-mt.source.index-1,Vt=me.length-mt.destination.index-1,Cn=[...me],Mn=Cn[gt];Cn.splice(gt,1),Cn.splice(Vt,0,Mn),Ae(Cn)};return(0,M.jsxs)(ie.C,{children:[(0,M.jsxs)(Rt.Gy,{children:[(0,M.jsx)(se.$n,{size:"sm",icon:"plus",onClick:()=>We(),className:ve.button,children:"Generate enum values from data"}),(0,M.jsx)(se.$n,{size:"sm",icon:"plus",onClick:()=>at(),className:ve.button,children:"Add enum value"})]}),(0,M.jsx)(Rt.gW,{children:(0,M.jsx)("table",{className:ve.compactTable,children:(0,M.jsx)(ba.JY,{onDragEnd:ht,children:(0,M.jsx)(ba.gL,{droppableId:"sortable-enum-config-mappings",direction:"vertical",children:mt=>(0,M.jsxs)("tbody",{ref:mt.innerRef,...mt.droppableProps,children:[[...me].reverse().map((gt,Vt)=>{const Cn=me.length-Vt-1;return(0,M.jsx)(Dr,{transformIndex:k,value:gt,index:Vt,mappedIndex:Cn,onChangeEnumValue:ct,onRemoveEnumRow:tt,checkIsEnumUniqueValue:Et},`${k}/${gt}`)}),mt.placeholder]})})})})})]})},Fa=F=>({compactTable:(0,ze.css)({"tbody td":{padding:F.spacing(.5)},marginTop:F.spacing(1),marginBottom:F.spacing(2)}),button:(0,ze.css)({marginTop:F.spacing(1)})}),Ka={settings:{width:24,isClearable:!1}},wa=({input:F,options:V,onChange:k})=>{const oe=_a.bx.filter(ht=>ht.value!==Q.PU.trace),ve=(0,Se.qt)(!0),me=(0,ka.P3)();ve.push({label:"Browser",value:"browser"}),ve.push({label:"UTC",value:"utc"});for(const ht of me)ve.push({label:ht,value:ht});const Ae=(0,o.useCallback)(ht=>mt=>{const gt=V.conversions;gt[ht]={...gt[ht],targetField:mt??"",dateFormat:void 0},k({...V,conversions:gt})},[k,V]),We=(0,o.useCallback)(ht=>mt=>{const gt=V.conversions;gt[ht]={...gt[ht],destinationType:mt.value},k({...V,conversions:gt})},[k,V]),$e=(0,o.useCallback)(ht=>mt=>{const gt=V.conversions;gt[ht]={...gt[ht],dateFormat:mt.currentTarget.value},k({...V,conversions:gt})},[k,V]),tt=(0,o.useCallback)(ht=>mt=>{const gt=V.conversions;gt[ht]={...gt[ht],joinWith:mt.currentTarget.value},k({...V,conversions:gt})},[k,V]),at=(0,o.useCallback)(()=>{k({...V,conversions:[...V.conversions,{targetField:void 0,destinationType:void 0,dateFormat:void 0}]})},[k,V]),ct=(0,o.useCallback)(ht=>{const mt=V.conversions;mt.splice(ht,1),k({...V,conversions:mt})},[k,V]),Et=(0,o.useCallback)(ht=>mt=>{const gt=V.conversions;gt[ht]={...gt[ht],timezone:mt?.value},k({...V,conversions:gt})},[k,V]);return(0,M.jsxs)(M.Fragment,{children:[V.conversions.map((ht,mt)=>{const gt=(0,Oa.findField)(F?.[0],ht.targetField);return(0,M.jsxs)("div",{children:[(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Field",children:(0,M.jsx)(na.O,{context:{data:F},value:ht.targetField??"",onChange:Ae(mt),item:Ka})}),(0,M.jsx)(Z.I,{label:"as",children:(0,M.jsx)(J.l6,{options:oe,value:ht.destinationType,placeholder:"Type",onChange:We(mt),width:18})}),ht.destinationType===Q.PU.time&&(0,M.jsx)(Z.I,{label:"Input format",tooltip:"Specify the format of the input field so Grafana can parse the date string correctly.",children:(0,M.jsx)(Ie.p,{value:ht.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:$e(mt),width:24})}),ht.destinationType===Q.PU.string&&(0,M.jsxs)(M.Fragment,{children:[(ht.joinWith?.length||gt?.type===Q.PU.other)&&(0,M.jsx)(Z.I,{label:"Join with",tooltip:"Use an explicit separator when joining array values",children:(0,M.jsx)(Ie.p,{value:ht.joinWith,placeholder:"JSON",onChange:tt(mt),width:9})}),gt?.type===Q.PU.time&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Date format",tooltip:"Specify the output format.",children:(0,M.jsx)(Ie.p,{value:ht.dateFormat,placeholder:"e.g. YYYY-MM-DD",onChange:$e(mt),width:24})}),(0,M.jsx)(Z.I,{label:"Set timezone",tooltip:"Set the timezone of the date manually",children:(0,M.jsx)(J.l6,{options:ve,value:ht.timezone,onChange:Et(mt),isClearable:!0})})]})]}),(0,M.jsx)(se.$n,{size:"md",icon:"trash-alt",variant:"secondary",onClick:()=>ct(mt),"aria-label":"Remove convert field type transformer"})]}),ht.destinationType===Q.PU.enum&&(0,M.jsx)(Cr,{input:F,options:V,transformIndex:mt,onChange:k})]},`${ht.targetField}-${mt}`)}),(0,M.jsx)(se.$n,{size:"sm",icon:"plus",onClick:at,variant:"secondary","aria-label":"Add a convert field type transformer",children:"Convert field type"})]})},xt={id:X.F.convertFieldType,editor:wa,transformation:ee.c.convertFieldTypeTransformer,name:ee.c.convertFieldTypeTransformer.name,description:ee.c.convertFieldTypeTransformer.description,categories:new Set([y.m.Reformat]),help:le(X.F.convertFieldType).helperDocs};var wt=e(54479);class Zt extends o.PureComponent{constructor(V){super(V),this.onFieldToggle=k=>{const{selected:oe}=this.state;oe.indexOf(k)>-1?this.onChange(oe.filter(ve=>ve!==k)):this.onChange([...oe,k])},this.onChange=k=>{const{regex:oe,isRegexValid:ve}=this.state,me={...this.props.options,include:{names:k}};oe&&ve&&(me.include=me.include??{},me.include.pattern=oe),this.setState({selected:k},()=>{this.props.onChange(me)})},this.onInputBlur=k=>{const{selected:oe,regex:ve}=this.state;let me=!0;try{ve&&(0,wt.dO)(ve)}catch{me=!1}me?this.props.onChange({...this.props.options,include:{pattern:ve}}):this.props.onChange({...this.props.options,include:{names:oe}}),this.setState({isRegexValid:me})},this.onVariableChange=k=>{this.props.onChange({...this.props.options,include:{variable:k.value}}),this.setState({variable:k.value})},this.onFromVariableChange=k=>{const oe=k.currentTarget.checked;this.props.onChange({...this.props.options,byVariable:oe}),this.setState({byVariable:oe})},this.state={include:V.options.include?.names||[],regex:V.options.include?.pattern,variable:V.options.include?.variable,byVariable:V.options.byVariable||!1,options:[],variables:[],selected:[],isRegexValid:!0}}componentDidMount(){this.initOptions()}componentDidUpdate(V){this.props.input!==V.input&&this.initOptions()}initOptions(){const{input:V,options:k}=this.props,oe=Array.from(k.include?.names??[]),ve=(0,Pe.w)().getVariables().map(We=>({label:"$"+We.name,value:"$"+We.name})),me=[],Ae={};for(const We of V)for(const $e of We.fields){const tt=(0,te.Ct)($e,We,V);let at=Ae[tt];at||(at=Ae[tt]={name:tt,count:0},me.push(at)),at.count++}if(k.include?.pattern)try{const We=(0,wt.dO)(k.include.pattern);for(const $e of me)We.test($e.name)&&oe.push($e.name)}catch(We){console.error(We)}if(oe.length){const We=me.filter($e=>oe.includes($e.name));this.setState({options:me,selected:We.map($e=>$e.name),variables:ve,byVariable:k.byVariable||!1,variable:k.include?.variable,regex:k.include?.pattern})}else this.setState({options:me,selected:me.map(We=>We.name),variables:ve,byVariable:k.byVariable||!1,variable:k.include?.variable,regex:k.include?.pattern})}render(){const{options:V,selected:k,isRegexValid:oe}=this.state;return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{label:"Use variable",children:(0,M.jsx)(Z.I,{label:"From variable",children:(0,M.jsx)(St.K,{value:this.state.byVariable,onChange:this.onFromVariableChange})})}),this.state.byVariable?(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Variable",children:(0,M.jsx)(J.l6,{value:this.state.variable,onChange:this.onVariableChange,options:this.state.variables||[]})})}):(0,M.jsxs)(ie.C,{label:"Identifier",children:[(0,M.jsx)(Z.I,{label:"Identifier",invalid:!oe,error:oe?void 0:"Invalid pattern",children:(0,M.jsx)(Ie.p,{placeholder:"Regular expression pattern",value:this.state.regex||"",onChange:ve=>this.setState({regex:ve.currentTarget.value}),onBlur:this.onInputBlur,width:25})}),V.map((ve,me)=>{const Ae=`${ve.name}${ve.count>1?" ("+ve.count+")":""}`,We=k.indexOf(ve.name)>-1;return(0,M.jsx)(Mt.m,{onClick:()=>{this.onFieldToggle(ve.name)},label:Ae,selected:We},`${ve.name}/${me}`)})]})]})}}const cn={id:X.F.filterFieldsByName,editor:Zt,transformation:ee.c.filterFieldsByNameTransformer,name:ee.c.filterFieldsByNameTransformer.name,description:"Removes part of the query results using a regex pattern. The pattern can be inclusive or exclusive.",categories:new Set([y.m.Filter]),help:le(X.F.filterFieldsByName).helperDocs};class dn extends o.PureComponent{constructor(V){super(V),this.onFieldToggle=k=>{const{selected:oe}=this.state;oe.indexOf(k)>-1?this.onChange(oe.filter(ve=>ve!==k)):this.onChange([...oe,k])},this.onChange=k=>{this.setState({selected:k}),this.props.onChange({...this.props.options,include:k.join("|")})},this.state={include:V.options.include||"",options:[],selected:[]}}componentDidMount(){this.initOptions()}componentDidUpdate(V){this.props.input!==V.input&&this.initOptions()}initOptions(){const{input:V,options:k}=this.props,oe=k.include?k.include.split("|"):[],ve=[],me={};for(const Ae of V)if(Ae.refId){let We=me[Ae.refId];We||(We=me[Ae.refId]={refId:Ae.refId,count:0},ve.push(We)),We.count++}if(oe.length){const Ae=[],We=[];for(const $e of ve)oe.includes($e.refId)&&We.push($e),Ae.push($e);this.setState({options:Ae,selected:We.map($e=>$e.refId)})}else this.setState({options:ve,selected:[]})}render(){const{options:V,selected:k}=this.state,{input:oe}=this.props;return(0,M.jsxs)(M.Fragment,{children:[oe.length<=1&&(0,M.jsx)("div",{children:(0,M.jsx)(Aa.P,{children:"Filter data by query expects multiple queries in the input."})}),(0,M.jsx)(Z.I,{label:"Series refId",labelWidth:16,shrink:!0,children:(0,M.jsx)(Rt.Gy,{spacing:"xs",align:"flex-start",wrap:!0,children:V.map((ve,me)=>{const Ae=`${ve.refId}${ve.count>1?" ("+ve.count+")":""}`,We=k.indexOf(ve.refId)>-1;return(0,M.jsx)(Mt.m,{onClick:()=>{this.onFieldToggle(ve.refId)},label:Ae,selected:We},`${ve.refId}/${me}`)})})})]})}}const Tn={id:X.F.filterByRefId,editor:dn,transformation:ee.c.filterFramesByRefIdTransformer,name:ee.c.filterFramesByRefIdTransformer.name,description:"Filter data by query. This is useful if you are sharing the results from a different panel that has many queries and you want to only visualize a subset of that in this panel.",categories:new Set([y.m.Filter]),help:le(X.F.filterByRefId).helperDocs};var Qn=e(15400);const On={settings:{width:30,filter:F=>F.type===Q.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null};function ys({input:F,options:V,onChange:k}){const oe=(0,o.useCallback)($e=>{k({...V,stringField:$e??""})},[k,V]),ve=(0,o.useCallback)($e=>{const tt=$e.value??Qn.gs.UpperCase;k({...V,outputFormat:tt})},[k,V]),me=(0,o.useCallback)($e=>{k({...V,substringStart:$e??0})},[k,V]),Ae=(0,o.useCallback)($e=>{k({...V,substringEnd:$e??0})},[k,V]),We=Object.values(Qn.gs).map($e=>({label:$e,value:$e}));return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Field",labelWidth:10,children:(0,M.jsx)(na.O,{context:{data:F},value:V.stringField??"",onChange:oe,item:On})}),(0,M.jsx)(Z.I,{label:"Format",labelWidth:10,children:(0,M.jsx)(J.l6,{options:We,value:V.outputFormat,onChange:ve,width:20})})]}),V.outputFormat===Qn.gs.Substring&&(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Substring range",labelWidth:15,children:(0,M.jsx)(ln.Q,{min:0,value:V.substringStart??0,onChange:me,width:7})}),(0,M.jsx)(Z.I,{children:(0,M.jsx)(ln.Q,{min:0,value:V.substringEnd??0,onChange:Ae,width:7})})]})]})}const Ns={id:X.F.formatString,editor:ys,transformation:ee.c.formatStringTransformer,name:ee.c.formatStringTransformer.name,state:fe.pn.beta,description:ee.c.formatStringTransformer.description,categories:new Set([y.m.Reformat])};function xs({input:F,options:V,onChange:k}){const oe=[],ve=(0,Se.qt)(!0);for(const $e of F)for(const tt of $e.fields)if(tt.type==="time"){const at=(0,te.Ct)(tt,$e,F);oe.push({label:at,value:at})}const me=(0,o.useCallback)($e=>{const tt=$e?.value!==void 0?$e.value:"";k({...V,timeField:tt})},[k,V]),Ae=(0,o.useCallback)($e=>{const tt=$e.target.value;k({...V,outputFormat:tt})},[k,V]),We=(0,o.useCallback)($e=>{const tt=$e?.value!==void 0?$e.value:"";k({...V,timezone:tt})},[k,V]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Time Field",labelWidth:15,grow:!0,children:(0,M.jsx)(J.l6,{options:oe,value:V.timeField,onChange:me,placeholder:"time",isClearable:!0})}),(0,M.jsx)(Z.I,{label:"Format",labelWidth:10,tooltip:(0,M.jsxs)(M.Fragment,{children:["The output format for the field specified as a"," ",(0,M.jsx)("a",{href:"https://momentjs.com/docs/#/displaying/",target:"_blank",rel:"noopener noreferrer",children:"Moment.js format string"}),"."]}),interactive:!0,children:(0,M.jsx)(Ie.p,{onChange:Ae,value:V.outputFormat})}),(0,M.jsx)(Z.I,{label:"Set Timezone",tooltip:"Set the timezone of the date manually",labelWidth:20,children:(0,M.jsx)(J.l6,{options:ve,value:V.timezone,onChange:We,isClearable:!0})})]})})}const Ks={id:X.F.formatTime,editor:xs,transformation:ee.c.formatTimeTransformer,name:ee.c.formatTimeTransformer.name,state:fe.pn.alpha,description:ee.c.formatTimeTransformer.description,help:le(X.F.formatTime).helperDocs};var $s=e(25094),fs=e(67061),aa=e(42418);const Kr=({input:F,options:V,onChange:k})=>{const oe=(0,Se.ZI)(F),ve=(0,o.useCallback)($e=>tt=>{k({...V,fields:{...V.fields,[$e]:tt}})},[k]);let me,Ae=!1;for(const $e of Object.values(V.fields))$e.aggregations.length>0&&$e.operation!==null&&(Ae=!0),$e.operation===$s.R3.groupBy&&(me=!0);const We=Ae&&!me;return(0,M.jsxs)(fs.B,{direction:"column",children:[We&&(0,M.jsx)(aa.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),oe.map($e=>(0,M.jsx)(fo,{onConfigChange:ve($e),fieldName:$e,config:V.fields[$e]},$e))]})},wr=[{label:"Group by",value:$s.R3.groupBy},{label:"Calculate",value:$s.R3.aggregate}],fo=({fieldName:F,config:V,onConfigChange:k})=>{const oe=(0,xe.$j)(),ve=xi(oe),me=(0,o.useCallback)(Ae=>{k({aggregations:V?.aggregations??[],operation:Ae?.value??null})},[V,k]);return(0,M.jsx)(Z.I,{className:ve.label,label:F,grow:!0,shrink:!0,children:(0,M.jsxs)(fs.B,{gap:.5,direction:"row",children:[(0,M.jsx)("div",{className:ve.operation,children:(0,M.jsx)(J.l6,{options:wr,value:V?.operation,placeholder:"Ignored",onChange:me,isClearable:!0})}),V?.operation===$s.R3.aggregate&&(0,M.jsx)(Ze.S,{className:ve.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:V.aggregations,onChange:Ae=>{k({...V,aggregations:Ae})}})]})})},xi=F=>({label:(0,ze.css)`
      label {
        min-width: ${F.spacing(32)};
      }
    `,operation:(0,ze.css)`
      flex-shrink: 0;
      height: 100%;
      width: ${F.spacing(24)};
    `,aggregations:(0,ze.css)`
      flex-grow: 1;
    `}),br={id:X.F.groupBy,editor:Kr,transformation:ee.c.groupByTransformer,name:ee.c.groupByTransformer.name,description:ee.c.groupByTransformer.description,categories:new Set([y.m.Combine,y.m.CalculateNewFields,y.m.Reformat]),help:le(X.F.groupBy).helperDocs};var $r=e(68133),Ya=e(88575);const go=({input:F,options:V,onChange:k})=>{const oe=(0,Se.ZI)(F),ve=V.showSubframeHeaders===void 0?$r.l:V.showSubframeHeaders,me=(0,o.useCallback)(at=>ct=>{k({...V,fields:{...V.fields,[at]:ct}})},[k]),Ae=(0,o.useCallback)(()=>{const at=V.showSubframeHeaders===void 0?!$r.l:!V.showSubframeHeaders;k({showSubframeHeaders:at,fields:{...V.fields}})},[k]);let We,$e=!1;for(const at of Object.values(V.fields))at.aggregations.length>0&&at.operation!==null&&($e=!0),at.operation===$s.R3.groupBy&&(We=!0);const tt=$e&&!We;return(0,M.jsxs)(fs.B,{direction:"column",children:[tt&&(0,M.jsx)(aa.F,{title:"Calculations will not have an effect if no fields are being grouped on.",severity:"warning"}),(0,M.jsx)("div",{children:oe.map(at=>(0,M.jsx)(mo,{onConfigChange:me(at),fieldName:at,config:V.fields[at]},at))}),(0,M.jsx)(Ya.D,{label:"Show field names in nested tables",description:"If enabled nested tables will show field names as a table header",children:(0,M.jsx)(St.d,{value:ve,onChange:Ae})})]})},po=[{label:"Group by",value:$s.R3.groupBy},{label:"Calculate",value:$s.R3.aggregate}],mo=({fieldName:F,config:V,onConfigChange:k})=>{const oe=(0,xe.$j)(),ve=vo(oe),me=(0,o.useCallback)(Ae=>{k({aggregations:V?.aggregations??[],operation:Ae?.value??null})},[V,k]);return(0,M.jsx)(Z.I,{className:ve.label,label:F,grow:!0,shrink:!0,children:(0,M.jsxs)(fs.B,{gap:.5,direction:"row",wrap:!1,children:[(0,M.jsx)("div",{className:ve.operation,children:(0,M.jsx)(J.l6,{options:po,value:V?.operation,placeholder:"Ignored",onChange:me,isClearable:!0})}),V?.operation===$s.R3.aggregate&&(0,M.jsx)(Ze.S,{className:ve.aggregations,placeholder:"Select Stats",allowMultiple:!0,stats:V.aggregations,onChange:Ae=>{k({...V,aggregations:Ae})}})]})})},vo=F=>({label:(0,ze.css)({minWidth:F.spacing(32)}),operation:(0,ze.css)({flexShrink:0,height:"100%",width:F.spacing(24)}),aggregations:(0,ze.css)({flexGrow:1})}),yo={id:X.F.groupToNestedTable,editor:go,transformation:ee.c.groupToNestedTable,name:ee.c.groupToNestedTable.name,description:ee.c.groupToNestedTable.description,categories:new Set([y.m.Combine,y.m.CalculateNewFields,y.m.Reformat]),state:fe.pn.beta};var $a=e(81010);const xo=({input:F,options:V,onChange:k})=>{const oe=(0,Se.ZI)(F).map(at=>({label:at,value:at})),ve=(0,Pe.w)().getVariables().map(at=>({value:"$"+at.name,label:"$"+at.name})),me=(0,o.useCallback)(at=>{k({...V,columnField:at?.value})},[k,V]),Ae=(0,o.useCallback)(at=>{k({...V,rowField:at?.value})},[k,V]),We=(0,o.useCallback)(at=>{k({...V,valueField:at?.value})},[k,V]),$e=[{label:"Null",value:$a.N.Null,description:"Null value"},{label:"True",value:$a.N.True,description:"Boolean true value"},{label:"False",value:$a.N.False,description:"Boolean false value"},{label:"Empty",value:$a.N.Empty,description:"Empty string"}],tt=(0,o.useCallback)(at=>{k({...V,emptyValue:at?.value})},[k,V]);return(0,M.jsx)(M.Fragment,{children:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Column",labelWidth:8,children:(0,M.jsx)(J.l6,{options:[...oe,...ve],value:V.columnField,onChange:me,isClearable:!0})}),(0,M.jsx)(Z.I,{label:"Row",labelWidth:8,children:(0,M.jsx)(J.l6,{options:[...oe,...ve],value:V.rowField,onChange:Ae,isClearable:!0})}),(0,M.jsx)(Z.I,{label:"Cell Value",labelWidth:10,children:(0,M.jsx)(J.l6,{options:[...oe,...ve],value:V.valueField,onChange:We,isClearable:!0})}),(0,M.jsx)(Z.I,{label:"Empty Value",children:(0,M.jsx)(J.l6,{options:$e,value:V.emptyValue,onChange:tt,isClearable:!0})})]})})},Eo={id:X.F.groupingToMatrix,editor:xo,transformation:ee.c.groupingToMatrixTransformer,name:ee.c.groupingToMatrixTransformer.name,description:"Takes a three fields combination and produces a Matrix.",categories:new Set([y.m.Combine,y.m.Reformat]),help:le(X.F.groupingToMatrix).helperDocs};var Ys=e(77678);const Po=({input:F,options:V,onChange:k})=>{const[ve,me]=(0,o.useState)({bucketCount:!(0,Se.N_)(V.bucketCount||""),bucketSize:!(0,Se.N_)(V.bucketSize||""),bucketOffset:!(0,Se.N_)(V.bucketOffset||"")}),Ae=(0,o.useCallback)(gt=>{k({...V,bucketCount:gt})},[k,V]),We=(0,o.useCallback)(gt=>{k({...V,bucketSize:gt})},[k,V]),$e=(0,o.useCallback)(gt=>{k({...V,bucketOffset:gt})},[k,V]),tt=(0,o.useCallback)(gt=>{me({...ve,bucketCount:!(0,Se.N_)(gt)}),k({...V,bucketCount:Number(gt)===0?void 0:Number(gt)})},[k,V,ve]),at=(0,o.useCallback)(gt=>{me({...ve,bucketSize:!(0,Se.N_)(gt)}),k({...V,bucketSize:gt})},[k,V,ve,me]),ct=(0,o.useCallback)(gt=>{me({...ve,bucketOffset:!(0,Se.N_)(gt)}),k({...V,bucketOffset:gt})},[k,V,ve,me]),Et=(0,o.useCallback)(()=>{k({...V,combine:!V.combine})},[k,V]),mt=(0,Pe.w)().getVariables().map(gt=>({value:gt.name,label:gt.label||gt.name,origin:pe.$0.Template}));if(!G.$.featureToggles.transformationsVariableSupport){let gt;typeof V.bucketSize=="string"?gt=parseInt(V.bucketSize,10):gt=V.bucketSize;let Vt;return typeof V.bucketOffset=="string"?Vt=parseInt(V.bucketOffset,10):Vt=V.bucketOffset,(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.bucketCount.name,tooltip:Ys.Rt.bucketCount.description,children:(0,M.jsx)(ln.Q,{value:V.bucketCount,placeholder:"Default: 30",onChange:Ae,min:0})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.bucketSize.name,tooltip:Ys.Rt.bucketSize.description,children:(0,M.jsx)(ln.Q,{value:gt,placeholder:"auto",onChange:We,min:0})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.bucketOffset.name,tooltip:Ys.Rt.bucketOffset.description,children:(0,M.jsx)(ln.Q,{value:Vt,placeholder:"none",onChange:$e,min:0})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.combine.name,tooltip:Ys.Rt.combine.description,children:(0,M.jsx)(St.K,{value:V.combine??!1,onChange:Et})})})]})}return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{invalid:ve.bucketCount,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ys.Rt.bucketCount.name,tooltip:Ys.Rt.bucketCount.description,children:(0,M.jsx)(ge.y,{suggestions:mt,value:V.bucketCount,placeholder:"Default: 30",onChange:tt})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{invalid:ve.bucketSize,error:"Value needs to be an integer or a variable",labelWidth:18,label:Ys.Rt.bucketSize.name,tooltip:Ys.Rt.bucketSize.description,children:(0,M.jsx)(ge.y,{suggestions:mt,value:V.bucketSize,placeholder:"auto",onChange:at})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.bucketOffset.name,tooltip:Ys.Rt.bucketOffset.description,invalid:ve.bucketOffset,error:"Value needs to be an integer or a variable",children:(0,M.jsx)(ge.y,{suggestions:mt,value:V.bucketOffset,placeholder:"none",onChange:ct})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{labelWidth:18,label:Ys.Rt.combine.name,tooltip:Ys.Rt.combine.description,children:(0,M.jsx)(St.K,{value:V.combine??!1,onChange:Et})})})]})},Do={id:X.F.histogram,editor:Po,transformation:ee.c.histogramTransformer,name:ee.c.histogramTransformer.name,description:ee.c.histogramTransformer.description,categories:new Set([y.m.CreateNewVisualization]),help:le(X.F.histogram).helperDocs};var Ja=e(41511),ir=e(64278);const Co=[{value:Ja.W.outer,label:"OUTER (TIME SERIES)",description:"Keep all rows from any table with a value. Join on distinct field values. Performant and best used for time series."},{value:Ja.W.outerTabular,label:"OUTER (TABULAR)",description:"Join on a field value with duplicated values. Non performant outer join best used for tabular(SQL like) data."},{value:Ja.W.inner,label:"INNER",description:"Combine data from two tables whenever there are matching values in a fields common to both tables."}];function bo({input:F,options:V,onChange:k}){const oe=(0,ir.sE)(F),ve=(0,ir.m3)(oe),me=(0,Pe.w)().getVariables().map($e=>({value:"$"+$e.name,label:"$"+$e.name})),Ae=(0,o.useCallback)($e=>{k({...V,byField:$e?.value})},[k,V]),We=(0,o.useCallback)($e=>{k({...V,mode:$e?.value})},[k,V]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Mode",labelWidth:8,grow:!0,children:(0,M.jsx)(J.l6,{options:Co,value:V.mode??Ja.W.outer,onChange:We})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Field",labelWidth:8,grow:!0,children:(0,M.jsx)(J.l6,{options:[...ve,...me],value:V.byField,onChange:Ae,placeholder:"time",isClearable:!0})})})]})}const To={id:X.F.joinByField,aliasIds:[X.F.seriesToColumns],editor:bo,transformation:ee.c.joinByFieldTransformer,name:ee.c.joinByFieldTransformer.name,description:ee.c.joinByFieldTransformer.description,categories:new Set([y.m.Combine]),help:le(X.F.joinByField).helperDocs};var lr=e(6829);const Mo=[{value:lr.n.Columns,label:"Columns"},{value:lr.n.Rows,label:"Rows"}],So=({input:F,options:V,onChange:k})=>{const{labelNames:ve,selected:me}=(0,o.useMemo)(()=>{let $e=[],tt={};for(const ct of F)for(const Et of ct.fields)if(Et.labels)for(const ht of Object.keys(Et.labels))tt[ht]||($e.push({value:ht,label:ht}),tt[ht]=!0);const at=new Set(V.keepLabels?.length?V.keepLabels:Object.keys(tt));return{labelNames:$e,selected:at}},[V.keepLabels,F]),Ae=$e=>{k({...V,valueLabel:$e?.value})},We=$e=>{if(me.has($e)?me.delete($e):me.add($e),me.size===ve.length||!me.size){const{keepLabels:tt,...at}=V;k(at)}else k({...V,keepLabels:[...me]})};return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Mode",labelWidth:20,children:(0,M.jsx)(ae.z,{options:Mo,value:V.mode??lr.n.Columns,onChange:$e=>k({...V,mode:$e})})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Labels",labelWidth:20,children:(0,M.jsx)(fs.B,{gap:1,wrap:"wrap",children:ve.map(($e,tt)=>{const at=$e.label;return(0,M.jsx)(Mt.m,{onClick:()=>We(at),label:at,selected:me.has(at)},`${at}/${tt}`)})})})}),V.mode!==lr.n.Rows&&(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Value field name",labelWidth:20,tooltip:"Replace the value field name with a label",htmlFor:"labels-to-fields-as-name",children:(0,M.jsx)(J.l6,{inputId:"labels-to-fields-as-name",isClearable:!0,allowCustomValue:!1,placeholder:"(Optional) Select label",options:ve,value:V?.valueLabel,onChange:Ae,className:"min-width-16"})})})]})},Oo={id:X.F.labelsToFields,editor:So,transformation:ee.c.labelsToFieldsTransformer,name:ee.c.labelsToFieldsTransformer.name,description:`Groups series by time and return labels or tags as fields.
                Useful for showing time series with labels in a table where each label key becomes a separate column.`,categories:new Set([y.m.Reformat]),help:le(X.F.labelsToFields).helperDocs},Ao=({options:F,onChange:V})=>{const[k,oe]=(0,o.useState)(!1),ve=(0,o.useCallback)($e=>{V({...F,limitField:Number($e.currentTarget.value)})},[V,F]),me=(0,o.useCallback)($e=>{oe(!(0,Se.N_)($e)),V({...F,limitField:$e})},[V,F]),We=(0,Pe.w)().getVariables().map($e=>({value:$e.name,label:$e.label||$e.name,origin:pe.$0.Template}));return G.$.featureToggles.transformationsVariableSupport?(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(ie.C,{children:(0,M.jsx)(ge.y,{invalid:k,error:"Value needs to be an integer or a variable",value:String(F.limitField),onChange:me,placeholder:"Value or variable",suggestions:We})})}):(0,M.jsx)(M.Fragment,{children:(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Limit",labelWidth:8,children:(0,M.jsx)(Ie.p,{placeholder:"Limit count",pattern:"[0-9]*",value:F.limitField,onChange:ve,width:25})})})})},Io={id:X.F.limit,editor:Ao,transformation:ee.c.limitTransformer,name:ee.c.limitTransformer.name,description:"Limit the number of items displayed.",categories:new Set([y.m.Filter]),help:le(X.F.limit).helperDocs},Ro=({input:F,options:V,onChange:k})=>F.length<=1?(0,M.jsx)(Aa.P,{children:"Merge has no effect when applied on a single frame."}):null,Lo={id:X.F.merge,editor:Ro,transformation:ee.c.mergeTransformer,name:ee.c.mergeTransformer.name,description:`Merge many series/tables and return a single table where mergeable values will be combined into the same row.
                Useful for showing multiple series, tables or a combination of both visualized in a table.`,categories:new Set([y.m.Combine]),help:le(X.F.merge).helperDocs};var jo=e(82280),Vs=e(94753);const Vr=({options:F,input:V,onChange:k})=>{const{indexByName:oe,excludeByName:ve,renameByName:me,includeByName:Ae}=F,We=(0,Se.ZI)(V),$e=(0,o.useMemo)(()=>Uo(We,oe),[We,oe]),tt=Ae&&Object.keys(Ae).length>0?"include":"exclude",at=(0,o.useCallback)((mt,gt)=>{k({...F,excludeByName:{...ve,[mt]:gt}})},[k,F,ve]),ct=(0,o.useCallback)((mt,gt)=>{const Vt={...F,includeByName:{...Ae,[mt]:!gt}};k(Vt)},[k,F,Ae]),Et=(0,o.useCallback)(mt=>{if(!mt||!mt.destination)return;const gt=mt.source.index,Vt=mt.destination.index;gt!==Vt&&k({...F,indexByName:cr(We,gt,Vt)})},[k,F,We]),ht=(0,o.useCallback)((mt,gt)=>{k({...F,renameByName:{...F.renameByName,[mt]:gt}})},[k,F]);return V.length>1?(0,M.jsx)(Aa.P,{children:"Organize fields only works with a single frame. Consider applying a join transformation or filtering the input first."}):(0,M.jsx)(ba.JY,{onDragEnd:Et,children:(0,M.jsx)(ba.gL,{droppableId:"sortable-fields-transformer",direction:"vertical",children:mt=>(0,M.jsxs)("div",{ref:mt.innerRef,...mt.droppableProps,children:[$e.map((gt,Vt)=>{const Cn=Ae&&gt in Ae?Ae[gt]:!1,Mn=tt==="include"?Cn:!ve[gt],Fn=tt==="include"?ct:at;return(0,M.jsx)(zr,{fieldName:gt,renamedFieldName:me[gt],index:Vt,onToggleVisibility:Fn,onRenameField:ht,visible:Mn},gt)}),mt.placeholder]})})})};Vr.displayName="OrganizeFieldsTransformerEditor";const zr=({fieldName:F,renamedFieldName:V,index:k,visible:oe,onToggleVisibility:ve,onRenameField:me})=>{const Ae=(0,xe.of)(Bo);return(0,M.jsx)(ba.sx,{draggableId:F,index:k,children:We=>(0,M.jsxs)(re.a,{marginBottom:.5,display:"flex",gap:0,ref:We.innerRef,...We.draggableProps,children:[(0,M.jsx)(He.c,{width:60,as:"div",children:(0,M.jsxs)(fs.B,{gap:0,justifyContent:"flex-start",alignItems:"center",width:"100%",children:[(0,M.jsx)("span",{...We.dragHandleProps,children:(0,M.jsx)(Rs.I,{name:"draggabledots",title:"Drag and drop to reorder",size:"lg",className:Ae.draggable})}),(0,M.jsx)(va.K,{className:Ae.toggle,size:"md",name:oe?"eye":"eye-slash",onClick:()=>ve(F,oe),tooltip:oe?"Disable":"Enable"}),(0,M.jsx)(Vs.E,{truncate:!0,element:"p",variant:"bodySmall",weight:"bold",children:F})]})}),(0,M.jsx)(Ie.p,{defaultValue:V||"",placeholder:`Rename ${F}`,onBlur:$e=>me(F,$e.currentTarget.value)})]})})};zr.displayName="DraggableFieldName";const Bo=F=>({toggle:(0,ze.css)({margin:F.spacing(0,1),color:F.colors.text.secondary}),draggable:(0,ze.css)({opacity:.4,"&:hover":{color:F.colors.text.maxContrast}})}),cr=(F,V,k)=>{const oe=Array.from(F),[ve]=oe.splice(V,1);return oe.splice(k,0,ve),oe.reduce((me,Ae,We)=>(me[Ae]=We,me),{})},Uo=(F,V={})=>{if(!V||Object.keys(V).length===0)return F;const k=(0,jo.X)(V);return F.sort(k)},No={id:X.F.organize,editor:Vr,transformation:ee.c.organizeFieldsTransformer,name:ee.c.organizeFieldsTransformer.name,description:"Allows the user to re-order, hide, or rename fields / columns. Useful when data source doesn't allow overrides for visualizing data.",categories:new Set([y.m.ReorderAndRename]),help:le(X.F.organize).helperDocs};var Xa=e(21128),ra=e(13544);const Hr=({options:F,onChange:V})=>{const k=[{label:"Series to rows",value:Xa.rV.SeriesToRows,description:"Create a table with one row for each series value"},{label:"Reduce fields",value:Xa.rV.ReduceFields,description:"Collapse each field into a single value"}],oe=(0,o.useCallback)(Ae=>{const We=Ae.value;V({...F,mode:We,includeTimeField:We===Xa.rV.ReduceFields?!!F.includeTimeField:!1})},[V,F]),ve=(0,o.useCallback)(()=>{V({...F,includeTimeField:!F.includeTimeField})},[V,F]),me=(0,o.useCallback)(()=>{V({...F,labelsToFields:!F.labelsToFields})},[V,F]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Mode","data-testid":ra.Tp.components.Transforms.Reduce.modeLabel,grow:!0,labelWidth:16,children:(0,M.jsx)(J.l6,{options:k,value:k.find(Ae=>Ae.value===F.mode)||k[0],onChange:oe})}),(0,M.jsx)(Z.I,{label:"Calculations","data-testid":ra.Tp.components.Transforms.Reduce.calculationsLabel,grow:!0,labelWidth:16,children:(0,M.jsx)(Ze.S,{placeholder:"Choose Stat",allowMultiple:!0,stats:F.reducers||[],onChange:Ae=>{V({...F,reducers:Ae})}})}),F.mode===Xa.rV.ReduceFields&&(0,M.jsx)(Z.I,{htmlFor:"include-time-field",labelWidth:16,label:"Include time",children:(0,M.jsx)(St.K,{id:"include-time-field",value:!!F.includeTimeField,onChange:ve})}),F.mode!==Xa.rV.ReduceFields&&(0,M.jsx)(Z.I,{htmlFor:"labels-to-fields",labelWidth:16,label:"Labels to fields",children:(0,M.jsx)(St.K,{id:"labels-to-fields",value:!!F.labelsToFields,onChange:me})})]})},Wo={id:X.F.reduce,editor:Hr,transformation:ee.c.reduceTransformer,name:ee.c.reduceTransformer.name,description:ee.c.reduceTransformer.description,categories:new Set([y.m.CalculateNewFields]),help:le(X.F.reduce).helperDocs};class Fo extends o.PureComponent{constructor(V){super(V),this.handleRegexChange=k=>{const oe=k.currentTarget.value;let ve=!0;if(oe)try{oe&&(0,wt.dO)(oe)}catch{ve=!1}this.setState(me=>({...me,regex:oe,isRegexValid:ve}))},this.handleRenameChange=k=>{const oe=k.currentTarget.value;this.setState(ve=>({...ve,renamePattern:oe}))},this.handleRegexBlur=k=>{const oe=k.currentTarget.value;let ve=!0;try{oe&&(0,wt.dO)(oe)}catch{ve=!1}this.setState({isRegexValid:ve},()=>{ve&&this.props.onChange({...this.props.options,regex:oe})})},this.handleRenameBlur=k=>{const oe=k.currentTarget.value;this.setState({renamePattern:oe},()=>this.props.onChange({...this.props.options,renamePattern:oe}))},this.state={regex:V.options.regex,renamePattern:V.options.renamePattern,isRegexValid:!0}}render(){const{regex:V,renamePattern:k,isRegexValid:oe}=this.state;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{label:"Match",labelWidth:16,invalid:!oe,error:oe?void 0:"Invalid pattern",children:(0,M.jsx)(Ie.p,{placeholder:"Regular expression pattern",value:V||"",onChange:this.handleRegexChange,onBlur:this.handleRegexBlur,width:25})}),(0,M.jsx)(Z.I,{label:"Replace",labelWidth:16,children:(0,M.jsx)(Ie.p,{placeholder:"Replacement pattern",value:k||"",onChange:this.handleRenameChange,onBlur:this.handleRenameBlur,width:25})})]})}}const Ko={id:X.F.renameByRegex,editor:Fo,transformation:ee.c.renameByRegexTransformer,name:ee.c.renameByRegexTransformer.name,description:"Renames part of the query result by using regular expression with placeholders.",categories:new Set([y.m.ReorderAndRename]),help:le(X.F.renameByRegex).helperDocs},ya=({input:F,options:V,onChange:k})=>null,wo={id:X.F.seriesToRows,editor:ya,transformation:ee.c.seriesToRowsTransformer,name:ee.c.seriesToRowsTransformer.name,description:`Merge many series and return a single series with time, metric and value as columns.
                Useful for showing multiple time series visualized in a table.`,categories:new Set([y.m.Combine,y.m.Reformat]),help:le(X.F.seriesToRows).helperDocs},Gr=({input:F,options:V,onChange:k})=>{const oe=(0,Se.ZI)(F).map($e=>({label:$e,value:$e})),me=(0,Pe.w)().getVariables().map($e=>({label:"$"+$e.name,value:"$"+$e.name})),Ae=(0,o.useCallback)(($e,tt)=>{k({...V,sort:[tt]})},[k,V]),We=V.sort?.length?V.sort:[{}];return(0,M.jsx)("div",{children:We.map(($e,tt)=>(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Field",labelWidth:10,grow:!0,children:(0,M.jsx)(J.l6,{options:G.$.featureToggles.transformationsVariableSupport?[...oe,...me]:oe,value:$e.field,placeholder:"Select field",onChange:at=>{Ae(tt,{...$e,field:at.value})}})}),(0,M.jsx)(Z.I,{label:"Reverse",children:(0,M.jsx)(St.K,{value:!!$e.desc,onChange:()=>{Ae(tt,{...$e,desc:!$e.desc})}})})]},`${$e.field}/${tt}`))})},$o={id:X.F.sortBy,editor:Gr,transformation:ee.c.sortByTransformer,name:ee.c.sortByTransformer.name,description:ee.c.sortByTransformer.description,categories:new Set([y.m.ReorderAndRename]),help:le(X.F.sortBy).helperDocs},Tr=({options:F,onChange:V})=>(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"First field name",labelWidth:24,children:(0,M.jsx)(Ie.p,{placeholder:"Field",value:F.firstFieldName,onChange:k=>V({...F,firstFieldName:k.currentTarget.value}),width:25})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Remaining fields name",tooltip:"Name for value fields",labelWidth:24,children:(0,M.jsx)(Ie.p,{placeholder:"Value",value:F.restFieldsName,onChange:k=>V({...F,restFieldsName:k.currentTarget.value}),width:25})})})]}),Vo={id:X.F.transpose,editor:Tr,transformation:ee.c.transposeTransformer,name:ee.c.transposeTransformer.name,description:ee.c.transposeTransformer.description,categories:new Set([y.m.Reformat])};function Qr({options:F,onChange:V}){const[k,oe]=(0,o.useState)(F),ve=zo(),me=Ho(),Ae=()=>{k.push({path:""}),oe([...k]),tt()},We=at=>{k&&(k.splice(at,1),oe([...k]),tt())},$e=(at,ct,Et)=>{k&&(Et==="alias"?k[ct].alias=at.currentTarget.value??"":k[ct].path=at.currentTarget.value??"",oe([...k]))},tt=()=>{V(k)};return(0,M.jsxs)("ol",{className:(0,ze.cx)(me.list),children:[k&&k.map((at,ct)=>(0,M.jsx)("li",{children:(0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{label:"Field",tooltip:ve.field,grow:!0,children:(0,M.jsx)(Ie.p,{onBlur:tt,onChange:Et=>$e(Et,ct,"path"),value:at.path,placeholder:'A valid json path, e.g. "object.value1" or "object.value2[0]"'})}),(0,M.jsx)(Z.I,{label:"Alias",tooltip:ve.alias,children:(0,M.jsx)(Ie.p,{width:12,value:at.alias,onBlur:tt,onChange:Et=>$e(Et,ct,"alias")})}),(0,M.jsx)(Z.I,{className:(0,ze.cx)(me.removeIcon),children:(0,M.jsx)(va.K,{onClick:()=>We(ct),name:"trash-alt",tooltip:"Remove path"})})]})},ct)),(0,M.jsx)(Z.I,{children:(0,M.jsx)(se.$n,{icon:"plus",onClick:()=>Ae(),variant:"secondary",children:"Add path"})})]})}const zo=()=>{const F=[{path:"object",description:"=> extract fields from object"},{path:"object.value1",description:"=> extract value1"},{path:"object.value2",description:"=> extract value2"},{path:"object.value2[0]",description:"=> extract value2 first element"},{path:"object.value2[1]",description:"=> extract value2 second element"}];return{field:(0,M.jsxs)("div",{children:["A valid path of an json object.",(0,M.jsx)("div",{children:(0,M.jsx)("strong",{children:"JSON Value:"})}),(0,M.jsx)("pre",{children:(0,M.jsx)("code",{children:["{",'  "object": {','    "value1": "hello world"','    "value2": [1, 2, 3, 4]',"  }","}"].join(`
`)})}),(0,M.jsx)("strong",{children:"Valid Paths:"}),F.map((V,k)=>(0,M.jsxs)("p",{children:[(0,M.jsx)("code",{children:V.path}),(0,M.jsx)("i",{children:V.description})]},k))]}),alias:"An alias name for the variable in the dashboard. If left blank the given path will be used."}};function Ho(){return{list:(0,ze.css)`
      margin-left: 20px;
    `,removeIcon:(0,ze.css)`
      margin: 0 0 0 4px;
      align-items: center;
    `}}var dr=e(14236),Va=(F=>(F.JSON="json",F.KeyValues="kvp",F.Auto="auto",F))(Va||{});const Go={id:Va.JSON,name:"JSON",description:"Parse JSON string",parse:F=>JSON.parse(F)};function ur(F){const V=[];let k="",oe="";const ve={};for(let me=0;me<F.length;me++){let Ae=F[me];Ae===k&&(k="",Ae=F[++me]);const We=Ae==="\\";if(We&&(Ae=F[++me]),We||k.length){V.push(Ae);continue}switch((Ae==='"'||Ae==="'")&&(k=Ae),Ae){case":":case"=":V.length&&(oe&&(ve[oe]=""),oe=V.join(""),V.length=0);break;case'"':case"'":case" ":case`
`:case"	":case"\r":case`
`:V.length&&oe===""&&(ve[V.join("")]="",V.length=0);case",":case";":case"&":case"{":case"}":if(V.length){const $e=V.join("");oe.length?(ve[oe]=$e,oe=""):oe=$e,V.length=0}break;default:V.push(Ae),me===F.length-1&&oe===""&&V.length&&(ve[V.join("")]="",V.length=0)}}return oe.length&&(ve[oe]=V.join("")),ve}const Qo={id:Va.KeyValues,name:"Key+value pairs",description:"Look for a=b, c: d values in the line",parse:ur},kr=[Go,Qo],ko={id:Va.Auto,name:"Auto",description:"parse new fields automatically",parse:F=>{for(const V of kr)try{const k=V.parse(F);if(k!=null)return k}catch{}}},hr=new ce.O(()=>[...kr,ko]),Mr={id:X.F.extractFields,name:"Extract fields",description:"Parse fields from the contends of another",defaultOptions:{},operator:(F,V)=>k=>k.pipe((0,bn.T)(oe=>Mr.transformer(F,V)(oe))),transformer:F=>V=>V.map(k=>_o(k,F))};function _o(F,V){if(!V.source)return F;const k=(0,Oa.findField)(F,V.source);if(!k)return F;const oe=hr.getIfExists(V.format??Va.Auto);if(!oe)throw new Error("unkonwn extractor");const ve=F.length,me=[],Ae=new Map;for(let $e=0;$e<ve;$e++){let tt=k.values[$e];if((0,l.isString)(tt))try{tt=oe.parse(tt)}catch{tt={}}if(tt!=null){if(V.format===Va.JSON&&V.jsonPaths&&V.jsonPaths?.length>0){const at={},ct=V.jsonPaths.filter(Et=>Et.path);ct.length>0&&(ct.forEach(Et=>{const ht=Et.alias&&Et.alias.length>0?Et.alias:Et.path;at[ht]=(0,l.get)(tt,Et.path)??"Not Found"}),tt=at)}for(const[at,ct]of Object.entries(tt)){let Et=Ae.get(at);Et==null&&(Et=new Array(ve).fill(void 0),Ae.set(at,Et),me.push(at)),Et[$e]=ct}}}const We=me.map($e=>{const tt=Ae.get($e),at={name:$e,values:tt,type:tt?(0,dr.oE)(tt.find(ct=>ct!=null)):Q.PU.other,config:{}};return G.$.featureToggles.extractFieldsNameDeduplication&&(at.name=(0,te.fk)(at,F)),at});if(V.keepTime){const $e=(0,Oa.findField)(F,"Time")||(0,Oa.findField)(F,"time");$e&&We.unshift($e)}return V.replace||We.unshift(...F.fields),{...F,fields:We}}const Yo={settings:{width:30,placeholderText:"Select field"},name:"",id:"",editor:()=>null},Jo=({input:F,options:V,onChange:k})=>{const oe=tt=>{k({...V,source:tt})},ve=tt=>{k({...V,format:tt?.value})},me=tt=>{k({...V,jsonPaths:tt})},Ae=()=>{V.replace&&(V.keepTime=!1),k({...V,replace:!V.replace})},We=()=>{k({...V,keepTime:!V.keepTime})},$e=hr.selectOptions(V.format?[V.format]:void 0);return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Source",labelWidth:16,children:(0,M.jsx)(na.O,{context:{data:F},value:V.source??"",onChange:oe,item:Yo})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Format",labelWidth:16,children:(0,M.jsx)(J.l6,{value:$e.current[0],options:$e.options,onChange:ve,width:24,placeholder:"Auto"})})}),V.format==="json"&&(0,M.jsx)(Qr,{options:V.jsonPaths??[],onChange:me}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Replace all fields",labelWidth:16,children:(0,M.jsx)(St.K,{value:V.replace??!1,onChange:Ae})})}),V.replace&&(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Keep time",labelWidth:16,children:(0,M.jsx)(St.K,{value:V.keepTime??!1,onChange:We})})})]})},Sr={id:X.F.extractFields,editor:Jo,transformation:Mr,name:Mr.name,description:"Parse fields from content (JSON, labels, etc).",categories:new Set([y.m.Reformat]),help:le(X.F.extractFields).helperDocs};var Ta=e(51986);const za={id:X.F.joinByLabels,name:"Join by labels",description:"Flatten labeled results into a table joined by labels.",defaultOptions:{},operator:(F,V)=>k=>k.pipe((0,bn.T)(oe=>za.transformer(F,V)(oe))),transformer:F=>V=>!V||!V.length?V:[ts(F,V)]};function ts(F,V){if(!F.value?.length)return Za("No value labele configured");const k=(0,Se.aG)(V);if(k.size<1)return Za("No labels in result");if(!k.has(F.value))return Za("Value label not found");let oe=F.join?.length?F.join:Array.from(k);oe=oe.filter(ct=>ct!==F.value);const ve=new Set,me=new Map,Ae={};for(const ct of V)for(const Et of ct.fields)if(Et.labels&&Et.type!==Q.PU.time){const ht=oe.map(Fn=>Et.labels[Fn]),mt=ht.join(",");let gt=me.get(mt);gt||(gt={keys:ht,values:{}},me.set(mt,gt));const Vt=Et.labels[F.value],Cn=Et.values,Mn=gt.values[Vt];Mn?gt.values[Vt]=Mn.concat(Cn):gt.values[Vt]=Cn,Ae[Vt]||(Ae[Vt]=Et),ve.add(Vt)}const We=Array.from(ve),$e=oe.map(()=>[]),tt=We.map(()=>[]);for(const ct of me.values()){let Et=-1,ht=!1;for(;!ht;){Et++,ht=!0;for(let mt=0;mt<oe.length;mt++)$e[mt].push(ct.keys[mt]);for(let mt=0;mt<We.length;mt++){const gt=We[mt],Vt=ct.values[gt]??[];tt[mt].push(Vt[Et]),Vt.length>Et+1&&(ht=!1)}}}const at={fields:[],length:tt[0].length};for(let ct=0;ct<oe.length;ct++)at.fields.push({name:oe[ct],config:{},type:Q.PU.string,values:$e[ct]});for(let ct=0;ct<We.length;ct++){const Et=Ae[We[ct]];at.fields.push({name:We[ct],config:{},type:Et.type??Q.PU.number,values:tt[ct]})}return at}function Za(F){return{meta:{notices:[{severity:"error",text:F}]},fields:[{name:"Error",type:Q.PU.string,config:{},values:[F]}],length:0}}function _r({input:F,options:V,onChange:k}){const oe=(0,o.useMemo)(()=>{let $e;const tt=(0,Se.aG)(F),at=Array.from(tt).map(Vt=>({label:Vt,value:Vt}));let ct=at.find(Vt=>Vt.value===V.value);!ct&&V.value&&(ct={label:`${V.value} (not found)`,value:V.value},at.push(ct)),F.length?tt.size===0&&($e=(0,M.jsx)(aa.F,{title:"No labels found",children:"The input does not contain any labels"})):$e=(0,M.jsx)(aa.F,{title:"No input found",children:"No input (or labels) found"}),tt.delete(V.value);const Et=Array.from(tt).map(Vt=>({label:Vt,value:Vt}));let ht=Et;const mt=!!V.join?.length;let gt="Join";return mt?ht=Et.filter(Vt=>!V.join.includes(Vt.value)):gt=Et.map(Vt=>Vt.value).join(", "),{warn:$e,valueOptions:at,valueOption:ct,joinOptions:Et,addOptions:ht,addText:gt,hasJoin:mt,key:Date.now()}},[V,F]),ve=($e,tt)=>{if(!V.join)return;const at=V.join.slice();if(tt)at[$e]=tt;else if(at.splice($e,1),!at.length){k({...V,join:void 0});return}const ct=new Set(at);V.value&&ct.delete(V.value),k({...V,join:Array.from(ct)})},me=$e=>{const tt=$e?.value;if(!tt)return;const at=V.join?V.join.slice():[];at.push(tt),k({...V,join:at})},Ae=10,We="No labels found";return(0,M.jsxs)("div",{children:[oe.warn,(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{error:"required",invalid:!V.value?.length,label:"Value",labelWidth:Ae,tooltip:"Select the label indicating the values name",children:(0,M.jsx)(J.l6,{options:oe.valueOptions,value:oe.valueOption,onChange:$e=>k({...V,value:$e.value}),noOptionsMessage:We})})}),oe.hasJoin?V.join.map(($e,tt)=>(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Join",labelWidth:Ae,error:"Unable to join by the value label",invalid:$e===V.value,children:(0,M.jsxs)(Rt.Gy,{children:[(0,M.jsx)(J.l6,{options:oe.joinOptions,value:oe.joinOptions.find(at=>at.value===$e),isClearable:!0,onChange:at=>ve(tt,at?.value),noOptionsMessage:We}),!!(oe.addOptions.length&&tt===V.join.length-1)&&(0,M.jsx)(Ta.i,{icon:"plus",label:"",options:oe.addOptions,onChange:me,variant:"secondary"})]})})},$e+tt)):(0,M.jsx)(M.Fragment,{children:!!oe.addOptions.length&&(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Join",labelWidth:Ae,children:(0,M.jsx)(J.l6,{options:oe.addOptions,placeholder:oe.addText,onChange:me,noOptionsMessage:We})})})})]})}const Yr={id:za.id,editor:_r,transformation:za,name:za.name,description:za.description,state:fe.pn.beta,categories:new Set([y.m.Combine]),help:le(za.id).helperDocs};var Or=e(84350),qa=e(69862),Ma=e(65474),Jr=e(67140);const Ar={id:X.F.fieldLookup,name:"Lookup fields from resource",description:"Retrieve matching data based on specified field",defaultOptions:{},operator:F=>V=>V.pipe((0,qa.Z)(k=>(0,Ma.H)(Xo(k,F))))};async function Xo(F,V){const k=Y.sJ.get(q.Ct.byName).get(V?.lookupField),oe=await(0,Jr.q3)(V?.gazetteer??Jr.fx);return oe.frame?Ir(F,oe,k):Promise.reject("missing frame in gazetteer")}function Ir(F,V,k){const oe=V.frame()?.fields;return oe?F.map(ve=>{const me=ve.length,Ae=[];for(const We of ve.fields)if(Ae.push(We),k(We,ve,F)){const $e=We.values,tt=[];for(const at of oe){const ct=new Array(me);tt.push(ct),Ae.push({...at,values:ct})}for(let at=0;at<V.count;at++){const ct=V.find($e[at]);if(ct?.index!=null)for(let Et=0;Et<oe.length;Et++)tt[Et][at]=oe[Et].values[ct.index]}}return{...ve,fields:Ae}}):F}const Rr={settings:{width:30,filter:F=>F.type===Q.PU.string,placeholderText:"Select text field",noFieldsMessage:"No text fields found"},name:"",id:"",editor:()=>null},Zo={settings:{}},Xr=({input:F,options:V,onChange:k})=>{const oe=(0,o.useCallback)(me=>{k({...V,lookupField:me})},[k,V]),ve=(0,o.useCallback)(me=>{k({...V,gazetteer:me})},[k,V]);return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Field",labelWidth:12,children:(0,M.jsx)(na.O,{context:{data:F},value:V?.lookupField??"",onChange:oe,item:Rr})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Lookup",labelWidth:12,children:(0,M.jsx)(Or.G,{value:V?.gazetteer??"",context:{data:F},item:Zo,onChange:ve})})})]})},Zr={id:X.F.fieldLookup,editor:Xr,transformation:Ar,name:Ar.name,description:"Use a field value to lookup additional fields from an external source. This currently supports spatial data, but will eventually support more formats.",state:fe.pn.alpha,categories:new Set([y.m.PerformSpatialOperations]),help:le(X.F.fieldLookup).helperDocs};var qo=e(35602),Lr=e(64586);const ca=(F,V,k=[])=>(V===0?k.push(F):F.forEach(oe=>{ca(oe,V-1,k)}),k);function fr(F){const V=F[0].length,k=F.length,oe=new Map;for(let ve=0;ve<V;ve++){let me=oe;for(let Ae=0;Ae<k;Ae++){let We=F[Ae][ve],$e=me.get(We);$e==null&&($e=Ae===k-1?[]:new Map,me.set(We,$e)),me=$e}me.push(ve)}return ca(oe,k)}const xa={asLabels:!0,append:!1,withNames:!1,separator1:"=",separator2:" "};function ke(F,V,k){return V.map((oe,ve)=>F.withNames?`${oe}${F.separator1}${k[ve]}`:k[ve]).join(F.separator2)}function Re(F,V){const k={};return F.forEach((oe,ve)=>{k[oe]=String(V[ve])}),k}const Ye={id:X.F.partitionByValues,name:"Partition by values",description:"Splits a one-frame dataset into multiple series discriminated by unique/enum values in one or more fields.",defaultOptions:{keepFields:!1},operator:(F,V)=>k=>k.pipe((0,bn.T)(oe=>Ye.transformer(F,V)(oe))),transformer:(F,V)=>{const k=(0,qo.R)(V,{names:F.fields});if(!k)return Lr.W.transformer({},V);const oe=(0,Y.NS)(k);return ve=>ve.length?lt(ve[0],oe,F):ve}};function lt(F,V,k){const oe=F.fields.filter(We=>V(We,F,[F]));if(!oe.length)return[F];const ve=oe.map(We=>We.values),me=oe.map(We=>We.name),Ae={...xa,...k?.naming};return fr(ve).map(We=>{let $e=F.name,tt={};if(Ae.asLabels)tt=Re(me,oe.map((ct,Et)=>ve[Et][We[0]]));else{let ct=ke(Ae,me,oe.map((Et,ht)=>ve[ht][We[0]]));Ae?.append&&F.name&&(ct=`${F.name} ${ct}`),$e=ct}let at=F.fields;if(!k?.keepFields){const ct=new Set(me);at=F.fields.filter(Et=>!ct.has(Et.name))}return{name:$e,meta:F.meta,length:We.length,fields:at.map(ct=>{const Et=ct.values,ht=Array(We.length);for(let mt=0;mt<We.length;mt++)ht[mt]=Et[We[mt]];return{name:ct.name,type:ct.type,config:ct.config,labels:{...ct.labels,...tt},values:ht}})}})}function At({input:F,options:V,onChange:k}){const oe=(0,ir.sE)(F),ve=(0,ir.m3)(oe),me=(0,o.useMemo)(()=>{const Et=new Set(V.fields);return Et.size<1?ve:ve.filter(ht=>!Et.has(ht.value))},[ve,V]),Ae=(0,o.useCallback)(Et=>{if(!Et.value)return;const ht=new Set(V.fields);ht.add(Et.value),k({...V,fields:[...ht]})},[k,V]);let We;(Et=>{Et[Et.asLabels=0]="asLabels",Et[Et.frameName=1]="frameName"})(We||(We={}));const $e=[{label:"As label",value:0},{label:"As frame name",value:1}],tt=[{label:"Yes",value:!0},{label:"No",value:!1}],at=(0,o.useCallback)(Et=>{if(!Et)return;const ht=new Set(V.fields);ht.delete(Et),k({...V,fields:[...ht]})},[k,V]);if(F.length>1)return(0,M.jsx)(Aa.P,{children:"Partition by values only works with a single frame."});const ct=[...new Set(V.fields)];return(0,M.jsxs)("div",{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Field",labelWidth:10,grow:!0,children:(0,M.jsxs)(Rt.Gy,{children:[ct.map(Et=>(0,M.jsx)(se.$n,{icon:"times",variant:"secondary",size:"md",onClick:()=>at(Et),children:Et},Et)),me.length&&(0,M.jsx)(Ta.i,{variant:"secondary",size:"md",options:me,onChange:Ae,label:"Select field",icon:"plus"})]})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{tooltip:"Sets how the names of the selected fields are displayed. As frame name is usually better for tabular data",label:"Naming",labelWidth:10,children:(0,M.jsx)(ae.z,{options:$e,value:V.naming?.asLabels===void 0||V.naming.asLabels?0:1,onChange:Et=>k({...V,naming:{...V.naming,asLabels:Et===0}})})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{tooltip:"Keeps the partition fields in the frames.",label:"Keep fields",labelWidth:16,children:(0,M.jsx)(ae.z,{options:tt,value:V.keepFields,onChange:Et=>k({...V,keepFields:Et})})})})]})}const Nt={id:X.F.partitionByValues,editor:At,transformation:Ye,name:Ye.name,description:Ye.description,state:fe.pn.alpha,categories:new Set([y.m.Reformat]),help:le(X.F.partitionByValues).helperDocs};var Wt=e(41260),Ht=e(37471),un=e(73060),an=(F=>(F.TimeSeriesWide="wide",F.TimeSeriesLong="long",F.TimeSeriesMulti="multi",F.TimeSeriesMany="many",F))(an||{});function jn(F){if(!Array.isArray(F)||F.length===0)return F;const V=[];for(const k of Xn(F)){const oe=k.fields[0];if(!oe||oe.type!==Q.PU.time)continue;const ve=[],me=[];for(const Ae of k.fields)switch(Ae.type){case Q.PU.number:case Q.PU.boolean:ve.push(Ae);break;case Q.PU.string:me.push(Ae);break}for(const Ae of ve)if(me.length){const We=new Map;for(let $e=0;$e<k.length;$e++){const tt=oe.values[$e],at=Ae.values[$e];if(at===void 0||tt==null)continue;const ct=me.map(ht=>ht.values[$e]).join("/");let Et=We.get(ct);if(!Et){Et={key:ct,time:[],value:[],labels:{}};for(const ht of me)Et.labels[ht.name]=ht.values[$e];We.set(ct,Et)}Et.time.push(tt),Et.value.push(at)}for(const $e of We.values())V.push({name:k.name,refId:k.refId,meta:{...k.meta,type:Wt.m.TimeSeriesMulti},fields:[{...oe,values:$e.time},{...Ae,values:$e.value,labels:$e.labels}],length:$e.time.length})}else V.push({name:k.name,refId:k.refId,meta:{...k.meta,type:Wt.m.TimeSeriesMulti},fields:[oe,Ae],length:k.length})}return V}function Xn(F){if(!Array.isArray(F)||F.length===0)return F;const V=[];for(const k of F){let oe;const ve=[],me={},Ae={},We={},$e={};for(let mt=0;mt<k.fields.length;mt++){const gt=k.fields[mt];switch(gt.type){case Q.PU.string:case Q.PU.boolean:gt.name in $e||($e[gt.name]=mt,Ae[gt.name]=!0);break;case Q.PU.time:if(!oe){oe=gt;break}default:if(gt.name in me){const Mn=me[gt.name];if(gt.type!==Mn)continue}else me[gt.name]=gt.type,ve.push(gt.name);const Vt=JSON.stringify(gt.labels),Cn=We[Vt];if(Cn!==void 0?Cn.push(mt):We[Vt]=[mt],gt.labels!=null)for(const Mn in gt.labels)Ae[Mn]=!0}}if(!oe)continue;const tt=[],at=[],ct=[],Et=[];for(let mt=0;mt<k.length;mt++)tt.push({time:oe.values[mt],wideRowIndex:mt});for(const mt in We)at.push(mt);for(const mt in Ae)ct.push(mt);for(const mt in $e)Et.push(mt);tt.sort((mt,gt)=>mt.time-gt.time),at.sort(),ct.sort(),ve.sort();const ht=new Ht.k({...k,meta:{...k.meta,type:Wt.m.TimeSeriesLong},fields:[{name:oe.name,type:oe.type}]});for(const mt of ve)ht.addField({name:mt,type:me[mt]});for(const mt of ct)ht.addField({name:mt,type:Q.PU.string});for(const mt of tt){const{time:gt,wideRowIndex:Vt}=mt;for(const Cn of at){const Mn={};for(const Wn of Et)Mn[Wn]=k.fields[$e[Wn]].values[Vt];let Fn=0;for(const Wn of We[Cn]){const ta=k.fields[Wn];if(Fn++===0&&ta.labels!=null)for(const Ms in ta.labels)Mn[Ms]=ta.labels[Ms];Mn[ta.name]=ta.values[Vt]}Mn[oe.name]=gt,ht.add(Mn)}}V.push(ht)}return V}function ds(F){return lt(F,k=>k.type===Q.PU.string).map(k=>(k.meta||(k.meta={}),k.meta.type=Wt.m.TimeSeriesMulti,k))}const $n={id:X.F.prepareTimeSeries,name:"Prepare time series",description:"Will stretch data frames from the wide format into the long format. This is really helpful to be able to keep backwards compatibility for panels not supporting the new wide format.",defaultOptions:{},operator:(F,V)=>k=>k.pipe((0,bn.T)(oe=>$n.transformer(F,V)(oe))),transformer:F=>{const V=F?.format??"wide";if(V==="many"||V==="multi")return jn;if(V==="long")return Xn;const k=Y.sJ.get(q.Ct.firstTimeField).get({});return oe=>{if(!oe.length)return[];const ve=[];for(const Ae of oe)Ae.meta?.type===Wt.m.TimeSeriesLong?ds(Ae).forEach(We=>ve.push(We)):ve.push(Ae);const me=(0,un.Fd)({frames:ve,joinBy:k,keepOriginIndices:!0});return me?(me.meta||(me.meta={}),me.meta.type=Wt.m.TimeSeriesWide,[me]):[]}}},is={label:"Wide time series",value:an.TimeSeriesWide,description:"Creates a single frame joined by time",info:(0,M.jsxs)("ul",{children:[(0,M.jsx)("li",{children:"Single frame"}),(0,M.jsx)("li",{children:"1st field is shared time field"}),(0,M.jsx)("li",{children:"Time in ascending order"}),(0,M.jsx)("li",{children:"Multiple value fields of any type"})]})},gs={label:"Multi-frame time series",value:an.TimeSeriesMulti,description:"Creates a new frame for each time/number pair",info:(0,M.jsxs)("ul",{children:[(0,M.jsx)("li",{children:"Multiple frames"}),(0,M.jsx)("li",{children:"Each frame has two fields: time, value"}),(0,M.jsx)("li",{children:"Time in ascending order"}),(0,M.jsx)("li",{children:"String values are represented as labels"}),(0,M.jsx)("li",{children:"All values are numeric"})]})},ss={label:"Long time series",value:an.TimeSeriesLong,description:"Convert each frame to long format",info:(0,M.jsxs)("ul",{children:[(0,M.jsx)("li",{children:"Single frame"}),(0,M.jsx)("li",{children:"1st field is time field"}),(0,M.jsx)("li",{children:"Time in ascending order, but may have duplictes"}),(0,M.jsx)("li",{children:"String values are represented as separate fields rather than as labels"}),(0,M.jsx)("li",{children:"Multiple value fields may exist"})]})},us=[is,gs,ss];function ps(F){const{options:V,onChange:k}=F,oe=(0,xe.of)(Is),ve=(0,o.useCallback)(me=>{k({...V,format:me.value})},[k,V]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Format",labelWidth:12,children:(0,M.jsx)(J.l6,{width:35,options:us,value:us.find(me=>me.value===an.TimeSeriesMulti&&V.format===an.TimeSeriesMany?!0:me.value===V.format)||us[0],onChange:ve,className:"flex-grow-1"})})}),(0,M.jsx)(ie.C,{children:(0,M.jsx)(Z.I,{label:"Info",labelWidth:12,children:(0,M.jsx)("div",{className:oe.info,children:(us.find(me=>me.value===V.format)||us[0]).info})})})]})}const Is=F=>({info:(0,ze.css)`
    margin-left: 20px;
  `}),ns={id:$n.id,editor:ps,transformation:$n,name:$n.name,description:$n.description,categories:new Set([y.m.Reformat]),help:le($n.id).helperDocs};var Bs=e(66648),Js=e(48817),ws=(F=>(F.linear="linear",F.polynomial="polynomial",F))(ws||{});const Ws={predictionCount:100,modelType:"linear",degree:2},Ls={id:X.F.regression,name:"Regression analysis",operator:(F,V)=>k=>k.pipe((0,bn.T)(oe=>Ls.transformer(F,V)(oe))),transformer:(F,V)=>k=>{const{predictionCount:oe,modelType:ve,degree:me}={...Ws,...F};if(k.length===0)return k;const Ae=Y.sJ.get(q.Ct.byName).get(F.yFieldName),We=Y.sJ.get(q.Ct.byName).get(F.xFieldName);let $e,tt,at;for(const Wn of k){const ta=Wn.fields.find(Ms=>Ae(Ms,Wn,k));if(ta){tt=ta;const Ms=Wn.fields.find(Ca=>We(Ca,Wn,k));if(Ms){$e=Ms,at=Wn;break}else throw"X and Y fields must be part of the same frame"}}if(!$e||!tt)return k;let ct=$e.values[0],Et=$e.values[0];for(let Wn=1;Wn<$e.values.length;Wn++)$e.values[Wn]<ct&&(ct=$e.values[Wn]),$e.values[Wn]>Et&&(Et=$e.values[Wn]);const ht=(Et-ct)/(oe-1),mt=[...[...Array(oe-1).keys()].map((Wn,ta)=>ta*ht+ct),Et],gt=$e.type===Q.PU.time?ct:0,Vt=[],Cn=[];for(let Wn=0;Wn<$e.values.length;Wn++)tt.values[Wn]!==null&&!isNaN(tt.values[Wn])&&(Cn.push($e.values[Wn]-gt),Vt.push(tt.values[Wn]));let Mn;switch(ve){case"linear":Mn=new Js.X(Cn,Vt);break;case"polynomial":Mn=new Bs.Y(Cn,Vt,me);break;default:return k}const Fn={name:`${ve} regression`,length:mt.length,fields:[{name:$e.name,type:$e.type,values:mt,config:{}},{name:`${(0,te.Ct)(tt,at,k)} predicted`,type:tt.type,values:mt.map(Wn=>Mn.predict(Wn-gt)),config:{}}]};return[...k,Fn]}},Ia={editor:na.O,id:"",name:"",settings:{width:24,isClearable:!1}},jr=20,qr=({input:F,options:V,onChange:k})=>{const oe=[{label:"Linear",value:ws.linear},{label:"Polynomial",value:ws.polynomial}];return(0,o.useEffect)(()=>{let ve,me;if(!V.xFieldName){const Ae=Y.sJ.get(q.Ct.firstTimeField).get({});for(const We of F)if(ve=We.fields.find($e=>Ae($e,We,F)),ve)break;if(!ve){const We=Y.sJ.get(q.Ct.numeric).get({});for(const $e of F)if(ve=$e.fields.find(tt=>We(tt,$e,F)),ve)break}}if(!V.yFieldName){const Ae=Y.sJ.get(q.Ct.numeric).get({});for(const We of F)if(me=We.fields.find($e=>Ae($e,We,F)&&$e!==ve),me)break}ve&&me&&k({...V,xFieldName:ve.name,yFieldName:me.name})}),(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Z.I,{labelWidth:jr,label:"X field",children:(0,M.jsx)(na.O,{context:{data:F},value:V.xFieldName??"",item:Ia,onChange:ve=>{k({...V,xFieldName:ve})}})}),(0,M.jsx)(Z.I,{labelWidth:jr,label:"Y field",children:(0,M.jsx)(na.O,{context:{data:F},value:V.yFieldName??"",item:Ia,onChange:ve=>{k({...V,yFieldName:ve})}})}),(0,M.jsx)(Z.I,{labelWidth:jr,label:"Model type",children:(0,M.jsx)(J.l6,{value:V.modelType??Ws.modelType,onChange:ve=>{k({...V,modelType:ve.value??Ws.modelType})},options:oe})}),(0,M.jsx)(Z.I,{labelWidth:jr,label:"Predicted points",tooltip:"Number of X,Y points to predict",children:(0,M.jsx)(ln.Q,{value:V.predictionCount??Ws.predictionCount,onChange:ve=>{k({...V,predictionCount:ve})}})}),V.modelType===ws.polynomial&&(0,M.jsx)(Z.I,{labelWidth:jr,label:"Degree",children:(0,M.jsx)(J.l6,{value:V.degree??Ws.degree,options:[{label:"Quadratic",value:2},{label:"Cubic",value:3},{label:"Quartic",value:4},{label:"Quintic",value:5}],onChange:ve=>{k({...V,degree:ve.value})}})})]})},Ei={id:X.F.regression,editor:qr,transformation:Ls,name:Ls.name,description:Ls.description,categories:new Set([y.m.CalculateNewFields]),help:le(X.F.regression).helperDocs},Br={id:X.F.rowsToFields,name:"Rows to fields",description:"Convert each row into a field with dynamic config.",defaultOptions:{},operator:F=>V=>V.pipe((0,bn.T)(k=>k.map(oe=>Pi(F,oe))))};function Pi(F,V){const k=rs(V,F.mappings??[],!0),{nameField:oe,valueField:ve}=k;if(!oe||!ve)return V;const me=[];for(let Ae=0;Ae<oe.values.length;Ae++){const We=oe.values[Ae],$e=ve.values[Ae],tt=jt(V,Ae,k),at=Di(V,Ae,k),ct={name:`${We}`,type:ve.type,values:[$e],config:tt,labels:at};me.push(ct)}return{fields:me,length:1}}function Di(F,V,k){const oe={...k.nameField.labels};for(let ve=0;ve<F.fields.length;ve++){const me=F.fields[ve],Ae=(0,te.Ct)(me,F),We=k.index[Ae];if(We.handler&&We.handler.key!==Ut.Label)continue;const $e=me.values[V];$e!=null&&(oe[Ae]=$e)}return oe}function Ji({input:F,options:V,onChange:k}){return F.length===0?null:(0,M.jsx)("div",{children:(0,M.jsx)(Kn,{frame:F[0],mappings:V.mappings??[],onChange:oe=>k({...V,mappings:oe}),withNameAndValue:!0})})}const Xi={id:Br.id,editor:Ji,transformation:Br,name:Br.name,description:Br.description,state:fe.pn.beta,categories:new Set([y.m.Reformat]),help:le(Br.id).helperDocs};var ei=e(52622),eo=e(61983),Hs=e(9581),to=e(96606),Ha=e(31484),no=e(78134);const ti={id:X.F.spatial,name:"Spatial operations",description:"Apply spatial operations to query results.",defaultOptions:{},operator:F=>V=>V.pipe((0,qa.Z)(k=>(0,Ma.H)(ni(k,F))))};function Ci(F){return F.action===Hs.dy.Modify&&F.modify?.op===Hs.YD.LineBuilder}async function ni(F,V){const k=await(0,Ha.nE)(V.source);if(Ci(V)){const oe=await(0,Ha.nE)(V.modify?.target);return F.map(ve=>{const me=(0,Ha.FM)(ve,k),Ae=(0,Ha.FM)(ve,oe);if(me.field&&Ae.field){const We=[...ve.fields],$e=(0,to.XR)(me.field,Ae.field),tt=We[0];return tt.type===Q.PU.geo&&tt!==me.field&&tt!==Ae.field?We[0]=(0,to.RA)(tt,$e):We.unshift($e),{...ve,fields:We}}return ve})}return F.map(oe=>{let ve=(0,Ha.FM)(oe,k);if(ve.field){if(V.action===Hs.dy.Modify){switch(V.modify?.op){case Hs.YD.AsLine:let Ae=ve.field.name;return(!Ae||Ae==="Point")&&(Ae="Line"),{...oe,length:1,fields:[{...ve.field,name:Ae,type:Q.PU.geo,values:[(0,no.tt)(ve.field)]}]}}return oe}const me=ve.derived?[ve.field,...oe.fields]:oe.fields.slice(0);if(V.action===Hs.dy.Calculate&&(me.push((0,no.pp)(ve.field,V.calculate??{})),ve.derived=!0),ve.derived)return{...oe,fields:me}}return oe})}const bi=(F,V)=>{const k=V.options??{};F.addSelect({path:"action",name:"Action",description:"",defaultValue:Hs.dy.Prepare,settings:{options:[{value:Hs.dy.Prepare,label:"Prepare spatial field",description:"Set a geometry field based on the results of other fields"},{value:Hs.dy.Calculate,label:"Calculate value",description:"Use the geometry to define a new field (heading/distance/area)"},{value:Hs.dy.Modify,label:"Transform",description:"Apply spatial operations to the geometry"}]}}),k.action===Hs.dy.Calculate?F.addSelect({path:"calculate.calc",name:"Function",description:"",defaultValue:Hs.kD.Heading,settings:{options:[{value:Hs.kD.Heading,label:"Heading"},{value:Hs.kD.Area,label:"Area"},{value:Hs.kD.Distance,label:"Distance"}]}}):k.action===Hs.dy.Modify&&F.addSelect({path:"modify.op",name:"Operation",description:"",defaultValue:Hs.YD.AsLine,settings:{options:[{value:Hs.YD.AsLine,label:"As line",description:"Create a single line feature with a vertex at each row"},{value:Hs.YD.LineBuilder,label:"Line builder",description:"Create a line between two points"}]}}),Ci(k)?(F.addNestedOptions({category:["Source"],path:"source",build:(oe,ve)=>{const me=k.source??{mode:ei.aG.Auto};(0,eo.G)("Point","",oe,me)}}),F.addNestedOptions({category:["Target"],path:"modify",build:(oe,ve)=>{const me=k.modify?.target??{mode:ei.aG.Auto};(0,eo.G)("Point","target.",oe,me)}})):(0,eo.G)("Location","source.",F,k.source)},Zi=F=>{(0,o.useEffect)(()=>{if(!F.options.source?.mode){const oe=ot(bi);F.onChange({...oe,...F.options}),console.log("geometry useEffect",oe)}},[]);const V=qi((0,xe.$j)()),k=Xe(F,bi);return(0,M.jsxs)("div",{children:[(0,M.jsx)("div",{children:k.items.map(oe=>oe.render())}),(0,M.jsx)("div",{children:k.categories.map(oe=>(0,M.jsxs)("div",{className:V.wrap,children:[(0,M.jsx)("h5",{children:oe.props.title}),(0,M.jsx)("div",{className:V.item,children:oe.items.map(ve=>ve.render())})]},oe.props.id))})]})},qi=F=>({wrap:(0,ze.css)`
      margin-bottom: 20px;
    `,item:(0,ze.css)`
      border-left: 4px solid ${F.colors.border.strong};
      padding-left: 10px;
    `}),Ti={id:X.F.spatial,editor:Zi,transformation:ti,name:ti.name,description:ti.description,state:fe.pn.alpha,categories:new Set([y.m.PerformSpatialOperations]),help:le(X.F.spatial).helperDocs};var so=e(19845);const Ur={id:X.F.timeSeriesTable,name:"Time series to table",description:"Convert time series data to table rows so that they can be viewed in tabular or sparkline format.",defaultOptions:{},isApplicable:F=>{for(const V of F)if((0,so.aH)(V))return $a.M.Applicable;return $a.M.NotApplicable},isApplicableDescription:"The Time series to table transformation requires at least one time series frame to function. You currently have none.",operator:F=>V=>V.pipe((0,bn.T)(k=>Mi(F,k)))};function Mi(F,V){const k={},oe={},ve=[];let me=Oi(V);for(const Ae of Object.keys(me)){const We=V.filter(tt=>tt.refId===Ae);k[Ae]={},oe[Ae]={};const $e=[];We.forEach(tt=>{tt.fields.forEach(at=>{at.type===Q.PU.number&&at.labels&&Object.keys(at.labels).forEach(ct=>{$e.includes(ct)||(oe[Ae][ct]=Si(ct,Q.PU.string),$e.push(ct))})})});for(let tt=0;tt<We.length;tt++){const at=We[tt];let ct=null,Et=F[Ae]?.timeField;if(Et&&Et.length>0?ct=at.fields.find(ht=>ht.name===Et):ct=at.fields.find(ht=>(0,so.hF)(ht)),!(0,so.aH)(at)){ve.push(at);continue}for(const ht of at.fields){if(ht.type!==Q.PU.number)continue;const mt=F[Ae]?.stat??Le.gy.lastNotNull,gt=(0,Le.Nw)({field:ht,reducers:[mt]})[mt]??null,Vt=new Ht.k;ct!==void 0&&(Vt.addField(ct),Vt.addField(ht),k[Ae][`Trend #${Ae}`]===void 0&&(k[Ae][`Trend #${Ae}`]=Si(`Trend #${Ae}`,Q.PU.frame)),k[Ae][`Trend #${Ae}`].values.push({...Vt,value:gt,length:ht.values.length})),$e.forEach(Cn=>{oe[Ae][Cn].values.push(ht.labels?.[Cn]??"")})}}}for(const Ae of Object.keys(me)){const We={},$e=new Ht.k;$e.refId=Ae;const tt=oe[Ae];if(tt!==void 0)for(const[ct,Et]of Object.entries(tt))We[ct]===void 0&&(We[ct]=Et);for(const ct of Object.values(We))$e.addField(ct);const at=k[Ae];for(const ct of Object.values(at))$e.addField(ct);$e.fields.length>0&&ve.push($e)}return ve}function Si(F,V){return{name:F,type:V,config:{},values:[]}}function Oi(F){let V={};for(const k of F)k.refId!==void 0&&(V[k.refId]===void 0?V[k.refId]=1:V[k.refId]++);return V}function Ai({input:F,options:V,onChange:k}){const oe=Oi(F),ve=(0,o.useCallback)((We,$e)=>{const tt=$e?.value!==void 0?$e.value:"";k({...V,[We]:{...V[We],timeField:tt}})},[k,V]),me=(0,o.useCallback)((We,$e)=>{const tt=$e[0];tt&&(0,Le.Em)(tt)&&k({...V,[We]:{...V[We],stat:tt}})},[k,V]);let Ae=[];for(const We of Object.keys(oe)){const $e={},tt=[];for(const at of F)if(at.refId===We)for(const ct of at.fields)(0,so.hF)(ct)&&($e[ct.name]=ct);for(const at of Object.values($e)){const{name:ct}=at;tt.push({label:ct,value:ct})}Ae.push((0,M.jsxs)(ie.C,{children:[(0,M.jsx)(Z.I,{children:(0,M.jsx)(He.c,{children:`Trend #${We}`})}),(0,M.jsx)(Z.I,{label:"Time field",tooltip:"The time field that will be used for the time series. If not selected the first found will be used.",children:(0,M.jsx)(J.l6,{onChange:ve.bind(null,We),options:tt,value:V[We]?.timeField,isClearable:!0})}),(0,M.jsx)(Z.I,{label:"Stat",tooltip:"The statistic that should be calculated for this time series.",children:(0,M.jsx)(Ze.S,{stats:[V[We]?.stat??Le.gy.lastNotNull],onChange:me.bind(null,We),filterOptions:at=>at.id!==Le.gy.allValues&&at.id!==Le.gy.uniqueValues})})]},We))}return(0,M.jsx)(M.Fragment,{children:Ae})}const si={id:Ur.id,editor:Ai,transformation:Ur,name:Ur.name,description:Ur.description,state:fe.pn.beta,help:le(Ur.id).helperDocs},el=()=>[Wo,cn,Ko,Tn,Fe,No,To,wo,Os,os,Oo,br,$o,Lo,Do,Xi,sn,ns,xt,Ti,Zr,Sr,dt,Eo,Io,Yr,Nt,...G.$.featureToggles.formatString?[Ns]:[],...G.$.featureToggles.regressionTransformation?[Ei]:[],...G.$.featureToggles.groupToNestedTableTransformation?[yo]:[],Ks,si,Vo];var tl=e(22051),Gs=e(1503),Ra=e(71468),ao=e(24180),ai=e(35557),Xs=e(54148),da=e(14110),Ii=e(66602),ut=e(57108),yt=e(17464),Dt=e(39070),Lt=e(21780),$t=e(25249),It=e(10860);function _t({description:F,text:V,url:k}){const oe=(0,xe.of)(Jt);return(0,M.jsxs)(It.Z,{className:oe.card,href:k,children:[(0,M.jsx)(It.Z.Heading,{children:V}),(0,M.jsx)(It.Z.Description,{className:oe.description,children:F})]})}const Jt=F=>({card:(0,ze.css)({marginBottom:0,gridTemplateRows:"1fr 0 2fr"}),description:(0,ze.css)({WebkitLineClamp:3,WebkitBoxOrient:"vertical",display:"-webkit-box",overflow:"hidden"})});function rn({navId:F,header:V}){const{node:k}=(0,$t.C)(F),oe=(0,xe.of)(Yt),ve=k.children?.filter(me=>!me.hideFromTabs);return(0,M.jsx)(Lt.YW,{navId:k.id,children:(0,M.jsx)(Lt.YW.Contents,{children:(0,M.jsxs)("div",{className:oe.content,children:[V,ve&&ve.length>0&&(0,M.jsx)("section",{className:oe.grid,children:ve?.map(me=>(0,M.jsx)(_t,{description:me.subTitle,text:me.text,url:me.url??""},me.id))})]})})})}const Yt=F=>({content:(0,ze.css)({display:"flex",flexDirection:"column",gap:F.spacing(2)}),grid:(0,ze.css)({display:"grid",gap:F.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:F.spacing(2,0)})});var En=e(64915),mn=e(16233),Dn=e(49785),Vn=e(33378),_n=e(10096),Gt=e(31678),as=e(57334),Qs=e(56034),Fs=e(48840);const oa=({ldapConnectionInfo:F})=>{const V=(0,o.useMemo)(()=>[{id:"host",header:"Host",disableGrow:!0},{id:"port",header:"Port",disableGrow:!0},{id:"available",cell:oe=>oe.cell.value?(0,M.jsx)(fs.B,{justifyContent:"end",children:(0,M.jsx)(Qs.m,{content:"Connection is available",children:(0,M.jsx)(Rs.I,{name:"check"})})}):(0,M.jsx)(fs.B,{justifyContent:"end",children:(0,M.jsx)(Qs.m,{content:"Connection is not available",children:(0,M.jsx)(Rs.I,{name:"exclamation-triangle"})})})}],[]),k=(0,o.useMemo)(()=>F,[F]);return(0,M.jsx)("section",{children:(0,M.jsxs)(fs.B,{direction:"column",gap:2,children:[(0,M.jsx)(Vs.E,{color:"primary",element:"h3",children:"LDAP Connection"}),(0,M.jsx)(Fs.j,{data:k,columns:V,getRowId:oe=>oe.host+oe.port}),(0,M.jsx)(Zs,{ldapConnectionInfo:F})]})})},Zs=({ldapConnectionInfo:F})=>{if(!F.some(ve=>ve.error))return null;const k=[];F.forEach(ve=>{ve.error&&k.push(ve)});const oe=k.map((ve,me)=>(0,M.jsxs)("div",{children:[(0,M.jsxs)("span",{style:{fontWeight:500},children:[ve.host,":",ve.port,(0,M.jsx)("br",{})]}),(0,M.jsx)("span",{children:ve.error}),me!==k.length-1&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("br",{}),(0,M.jsx)("br",{})]})]},me));return(0,M.jsx)(aa.F,{title:"Connection error",severity:Gt.AppNotificationSeverity.Error,children:oe})};var ua=e(72724);const Yn="dddd YYYY-MM-DD HH:mm zz",vn=({ldapSyncInfo:F})=>{const V=(0,ua.LE)(F.nextSync,{format:Yn}),k=[{id:"syncAttribute"},{id:"syncValue"}],oe=[{syncAttribute:"Active synchronization",syncValue:F.enabled?"Enabled":"Disabled"},{syncAttribute:"Scheduled",syncValue:F.schedule},{syncAttribute:"Next synchronization",syncValue:V}];return(0,M.jsxs)("section",{children:[(0,M.jsx)(Vs.E,{element:"h3",children:"LDAP Synchronization"}),(0,M.jsx)(Fs.j,{data:oe,columns:k,getRowId:ve=>ve.syncAttribute})]})},ms=({groups:F})=>{const V=(0,o.useMemo)(()=>F,[F]),k=(0,o.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:oe=>oe.value&&oe.row.original.orgRole?oe.value:""},{id:"orgRole",header:"Role",cell:oe=>oe.value||(0,M.jsxs)(M.Fragment,{children:["No match"," ",(0,M.jsx)(Qs.m,{content:"No matching organizations found",children:(0,M.jsx)(Rs.I,{name:"info-circle"})})]})}],[]);return(0,M.jsx)(Fs.j,{headerTooltips:{orgName:{content:"Only the first match for an Organization will be used",iconName:"info-circle"}},columns:k,data:V,getRowId:oe=>oe.orgId+oe.orgRole+oe.groupDN})},Ln=({info:F})=>{const V=(0,o.useMemo)(()=>[{id:"userInfo",header:"User Information",disableGrow:!0},{id:"ldapValue"},{id:"cfgAttrValue",header:"LDAP attribute"}],[]),k=(0,o.useMemo)(()=>[{userInfo:"First name",ldapValue:F.name.ldapValue,cfgAttrValue:F.name.cfgAttrValue},{userInfo:"Surname",ldapValue:F.surname.ldapValue,cfgAttrValue:F.surname.cfgAttrValue},{userInfo:"Username",ldapValue:F.login.ldapValue,cfgAttrValue:F.login.cfgAttrValue},{userInfo:"Email",ldapValue:F.email.ldapValue,cfgAttrValue:F.email.cfgAttrValue}],[F]);return(0,M.jsx)(Fs.j,{columns:V,data:k,getRowId:oe=>oe.userInfo})},bs=({permissions:F})=>{const V=(0,o.useMemo)(()=>[{id:"permission",header:"Permissions",disableGrow:!0},{id:"value"}],[]),k=(0,o.useMemo)(()=>[{permission:"Grafana admin",value:F.isGrafanaAdmin?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Rs.I,{name:"shield"})," Yes"]}):"No"},{permission:"Status",value:F.isDisabled?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Rs.I,{name:"times"})," Inactive"]}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Rs.I,{name:"check"})," Active"]})}],[F]);return(0,M.jsx)(Fs.j,{data:k,columns:V,getRowId:oe=>oe.permission})},Ps=({teams:F})=>{const V=(0,o.useMemo)(()=>[{id:"groupDN",header:"LDAP Group"},{id:"orgName",header:"Organization",cell:({row:{original:{orgName:k}}})=>(0,M.jsx)(M.Fragment,{children:k||"No matching teams found"})},{id:"teamName",header:"Team",cell:({row:{original:{teamName:k,orgName:oe}}})=>k&&oe?k:""}],[]);return(0,M.jsx)(Fs.j,{data:F,columns:V,getRowId:k=>k.teamName})},Ts=({ldapUser:F})=>(0,M.jsxs)(fs.B,{direction:"column",gap:4,children:[(0,M.jsx)(Ln,{info:F.info}),(0,M.jsx)(bs,{permissions:F.permissions}),F.roles&&F.roles.length>0&&(0,M.jsx)(ms,{groups:F.roles}),F.teams&&F.teams.length>0?(0,M.jsx)(Ps,{teams:F.teams}):(0,M.jsx)(re.a,{children:(0,M.jsx)(Vs.E,{children:"No teams found via LDAP"})})]}),Ds={text:"LDAP",subTitle:"Verify your LDAP and user mapping configuration.",icon:"book",id:"LDAP"},Us=({clearUserMappingInfo:F,queryParams:V,loadLdapState:k,loadLdapSyncStatus:oe,loadUserMapping:ve,clearUserError:me,ldapUser:Ae,userError:We,ldapError:$e,ldapSyncInfo:tt,ldapConnectionInfo:at})=>{const[ct,Et]=(0,o.useState)(!0),{register:ht,handleSubmit:mt}=(0,Dn.mN)(),gt=(0,o.useCallback)(async Fn=>ve(Fn),[ve]);(0,o.useEffect)(()=>{const Fn=async()=>Promise.all([k(),oe()]);async function Wn(){await F(),await Fn(),V.username&&await gt(V.username),Et(!1)}Wn()},[F,gt,k,oe,V]);const Vt=({username:Fn})=>{Fn&&gt(Fn)},Cn=()=>{me()},Mn=_n.TP.hasPermission(Gt.AccessControlAction.LDAPUsersRead);return(0,M.jsx)(Lt.YW,{navId:"authentication",pageNav:Ds,children:(0,M.jsx)(Lt.YW.Contents,{isLoading:ct,children:(0,M.jsxs)(fs.B,{direction:"column",gap:4,children:[$e&&$e.title&&(0,M.jsx)(aa.F,{title:$e.title,severity:Gt.AppNotificationSeverity.Error,children:$e.body}),(0,M.jsx)(oa,{ldapConnectionInfo:at}),(0,Vn.a)("ldapsync")&&tt&&(0,M.jsx)(vn,{ldapSyncInfo:tt}),Mn&&(0,M.jsxs)("section",{children:[(0,M.jsx)("h3",{children:"Test user mapping"}),(0,M.jsx)("form",{onSubmit:mt(Vt),children:(0,M.jsx)(Ya.D,{label:"Username",children:(0,M.jsx)(Ie.p,{...ht("username",{required:!0}),width:34,id:"username",type:"text",defaultValue:V.username,addonAfter:(0,M.jsx)(se.$n,{variant:"primary",type:"submit",children:"Run"})})})}),We&&We.title&&(0,M.jsx)(aa.F,{title:We.title,severity:Gt.AppNotificationSeverity.Error,onRemove:Cn,children:We.body}),Ae&&(0,M.jsx)(Ts,{ldapUser:Ae})]})]})})})},zs=F=>({ldapConnectionInfo:F.ldap.connectionInfo,ldapUser:F.ldap.user,ldapSyncInfo:F.ldap.syncInfo,userError:F.ldap.userError,ldapError:F.ldap.ldapError}),ma={loadLdapState:as.JI,loadLdapSyncStatus:as.pm,loadUserMapping:as.Kg,clearUserError:as.DX,clearUserMappingInfo:as.Jc},Sa=(0,Ra.connect)(zs,ma)(Us);var Pn=e(27921),gr=e(99085),ls=e(75471);function Ea(F=H.$W){return[{path:"/alerting",component:Es(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/home",exact:!1,component:Es(()=>e.e(3236).then(e.bind(e,86695)))},{path:"/alerting/list",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleRead,Gt.AccessControlAction.AlertingRuleExternalRead]),component:Es(()=>Promise.all([e.e(5279),e.e(829),e.e(3511)]).then(e.bind(e,77253)))},{path:"/alerting/routes",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsRead,Gt.AccessControlAction.AlertingNotificationsExternalRead]),component:Es(()=>Promise.all([e.e(5279),e.e(2839),e.e(6719)]).then(e.bind(e,69510)))},{path:"/alerting/routes/mute-timing/new",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite]),component:Es(()=>Promise.all([e.e(9241),e.e(8302)]).then(e.bind(e,66162)))},{path:"/alerting/routes/mute-timing/edit",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite]),component:Es(()=>Promise.all([e.e(9241),e.e(558)]).then(e.bind(e,58125)))},{path:"/alerting/silences",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingInstanceRead,Gt.AccessControlAction.AlertingInstancesExternalRead,Gt.AccessControlAction.AlertingSilenceRead]),component:Es(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/new",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingInstanceCreate,Gt.AccessControlAction.AlertingInstancesExternalWrite,Gt.AccessControlAction.AlertingSilenceCreate,Gt.AccessControlAction.AlertingSilenceUpdate]),component:Es(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/silence/:id/edit",component:Es(()=>e.e(9347).then(e.bind(e,69645)))},{path:"/alerting/notifications",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsRead,Gt.AccessControlAction.AlertingNotificationsExternalRead,...gr.w]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/templates/*",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsRead,Gt.AccessControlAction.AlertingNotificationsExternalRead]),component:Es(()=>e.e(9224).then(e.bind(e,35868)))},{path:"/alerting/notifications/:type/new",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite,...gr.t]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/receivers/:id/edit",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite,Gt.AccessControlAction.AlertingNotificationsRead,Gt.AccessControlAction.AlertingNotificationsExternalRead,...gr.w]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/edit",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type/:id/duplicate",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/notifications/:type",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingNotificationsWrite,Gt.AccessControlAction.AlertingNotificationsExternalWrite]),component:Es(()=>e.e(4772).then(e.bind(e,78199)))},{path:"/alerting/groups/",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingInstanceRead,Gt.AccessControlAction.AlertingInstancesExternalRead]),component:Es(()=>e.e(8427).then(e.bind(e,12564)))},{path:"/alerting/history/",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleRead]),component:Es(()=>Promise.all([e.e(8895),e.e(285),e.e(44)]).then(e.bind(e,57362)))},{path:"/alerting/new/:type?",pageClass:"page-alerting",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleCreate,Gt.AccessControlAction.AlertingRuleExternalWrite]),component:Es(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,44848)))},{path:"/alerting/:id/edit",pageClass:"page-alerting",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleUpdate,Gt.AccessControlAction.AlertingRuleExternalWrite]),component:Es(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,44848)))},{path:"/alerting/:id/modify-export",pageClass:"page-alerting",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleRead]),component:Es(()=>Promise.all([e.e(5279),e.e(8373),e.e(829),e.e(2839),e.e(4009)]).then(e.bind(e,69179)))},{path:"/alerting/:sourceName/:id/view",pageClass:"page-alerting",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleRead,Gt.AccessControlAction.AlertingRuleExternalRead]),component:Es(()=>Promise.resolve().then(e.bind(e,79741)))},{path:"/alerting/:sourceName/:name/find",pageClass:"page-alerting",roles:(0,ls.C0)([Gt.AccessControlAction.AlertingRuleRead,Gt.AccessControlAction.AlertingRuleExternalRead]),component:Es(()=>e.e(5516).then(e.bind(e,6165)))},{path:"/alerting/admin",roles:()=>["Admin"],component:Es(()=>e.e(9438).then(e.bind(e,53191)))}]}function Es(F){const V=()=>e.e(9029).then(e.bind(e,5961));return(0,Pn.A)(H.$W.unifiedAlertingEnabled?F:V)}var ks=e(78742),qs=e(6320);const fa=F=>({alertContent:(0,ze.css)`
    display: flex;
    flex-direction: row;
    padding: 0;
    justify-content: space-between;
    align-items: center;
  `,alertParagraph:(0,ze.css)`
    margin: 0 ${F.spacing(1)} 0 0;
    line-height: ${F.spacing(F.components.height.sm)};
  `});function Pa(){const F=(0,xe.of)(fa),V=_n.TP.hasPermission(Gt.AccessControlAction.DataSourcesCreate)||_n.TP.hasPermission(Gt.AccessControlAction.DataSourcesWrite),[k,oe]=(0,o.useState)(V);return k?(0,M.jsx)(aa.F,{severity:"info",title:"",onRemove:()=>oe(!1),children:(0,M.jsxs)("div",{className:F.alertContent,children:[(0,M.jsx)("p",{className:F.alertParagraph,children:"Data sources have a new home! You can discover new data sources or manage existing ones in the Connections page, accessible from the main menu."}),(0,M.jsx)(se.z9,{"aria-label":"Link to Connections",icon:"arrow-right",href:qs.b.DataSources,fill:"text",children:"Go to connections"})]})}):(0,M.jsx)(M.Fragment,{})}function Da(){return[{path:`/${qs.q}`,exact:!1,component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(7743),e.e(2154)]).then(e.bind(e,19514)))}]}var La=e(83883),pr=e(39964),er=e(57220),ja=(F=>(F.ViewIRMMainPage="grafana_irm_configuration_tracker_main_page_view",F.OpenEssentials="grafana_irm_configuration_tracker_essentials_open",F.CloseEssentials="grafana_irm_configuration_tracker_essentials_closed",F.ClickDataSources="grafana_irm_configuration_tracker_data_sources_clicked",F))(ja||{});function Ba(F,V){(0,da.rR)(F,{...V})}var ro=e(3704),Ri=e(79938),tr=e(82843),mr=e(37534),jd=e(730);function Bd(){const[F,{data:V,isLoading:k}]=Ri.hK.endpoints.rulerRules.useLazyQuery({refetchOnFocus:!0,refetchOnReconnect:!0}),{dsFeatures:oe,isLoadingDsFeatures:ve}=(0,jd.O3)(er.hY),me=oe?.rulerConfig;return(0,o.useEffect)(()=>{me&&F({rulerConfig:me})},[me,F]),{isDone:(V?Object.entries(V).flatMap(([$e,tt])=>tt.flatMap(at=>at.rules)):[]).length>0,isLoading:k||ve}}function Ud(F){return F.some(V=>V.grafana_managed_receiver_configs?.some(k=>k.type===mr.J4.OnCall))}function Nd(){const F=tr.m.endpoints.getAlertmanagerConfiguration.useQuery(er.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{contactPoints:F.data?.alertmanager_config?.receivers??[],isLoading:F.isLoading}}function Wd(){const F=tr.m.endpoints.getAlertmanagerConfiguration.useQuery(er.hY,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{defaultContactpoint:F.data?.alertmanager_config?.route?.receiver??"",isLoading:F.isLoading}}const Fd="<example@email.com>";function Kd(F,V){return V.some(oe=>oe.name===F&&oe.grafana_managed_receiver_configs?.some(ve=>ve.name===F&&ve.settings?.address!==Fd))}var ri=e(99494),oi=e(49962);const wd=F=>`/api/plugins/${ri.W.Incident}/resources${F}`,$d=oi.H.injectEndpoints({endpoints:F=>({getIncidentsPluginConfig:F.query({query:()=>({url:wd("/api/ConfigurationTrackerService.GetConfigurationTracker"),data:{},method:"POST",showErrorAlert:!1})})})});var nl=e(12210);function Vd(){const{installed:F,loading:V}=(0,nl._)(ri.W.Incident),{data:k,isLoading:oe}=$d.endpoints.getIncidentsPluginConfig.useQuery();return{isInstalled:F??!1,isChatOpsInstalled:k?.isChatOpsInstalled??!1,isIncidentCreated:k?.isIncidentCreated??!1,isLoading:V||oe}}var $l=e(26423);function zd(){const{installed:F}=(0,nl._)(ri.W.OnCall),{data:V}=$l.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return V??[]}function Hd(){const{data:F,isLoading:V}=$l.WG.endpoints.onCallConfigChecks.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:V,onCallConfigChecks:F??{is_chatops_connected:!1,is_integration_chatops_connected:!1}}}function Gd(){return zd().map(V=>({label:V.display_name,value:V.value}))}function Qd(){const{onCallConfigChecks:{is_chatops_connected:F,is_integration_chatops_connected:V},isLoading:k}=Hd();return{is_chatops_connected:F,is_integration_chatops_connected:V,isLoading:k}}const kd=`/api/plugins/${ri.W.Slo}/resources/v1`,_d=oi.H.injectEndpoints({endpoints:F=>({getSlos:F.query({query:()=>({url:`${kd}/slo`,showErrorAlert:!1}),providesTags:["GrafanaSlo"]})})});function Yd(){const{installed:F}=(0,nl._)(ri.W.Slo),{data:V,isLoading:k}=_d.endpoints.getSlos.useQuery(void 0,{skip:!F,refetchOnFocus:!0,refetchOnReconnect:!0,refetchOnMountOrArgChange:!0});return{isLoading:k,hasSlo:!!V?.slos.length,hasSloWithAlert:!!V?.slos?.some(oe=>oe.alerting)}}function Jd(){const{contactPoints:F,isLoading:V}=Nd(),{defaultContactpoint:k,isLoading:oe}=Wd(),{isDone:ve,isLoading:me}=Bd(),{isChatOpsInstalled:Ae,isInstalled:We,isLoading:$e}=Vd(),tt=Gd(),{is_chatops_connected:at,is_integration_chatops_connected:ct,isLoading:Et}=Qd(),{hasSlo:ht,hasSloWithAlert:mt,isLoading:gt}=Yd();return{alerting:{contactPoints:F,defaultContactpoint:k,isCreateAlertRuleDone:ve},incidents:{isChatOpsInstalled:Ae,isIncidentsInstalled:We},onCall:{onCallOptions:tt,is_chatops_connected:at,is_integration_chatops_connected:ct},slo:{hasSlo:ht,hasSloWithAlert:mt},isLoading:V||oe||me||$e||Et||gt}}function Xd(){const{alerting:{contactPoints:F,defaultContactpoint:V,isCreateAlertRuleDone:k},incidents:{isChatOpsInstalled:oe,isIncidentsInstalled:ve},onCall:{onCallOptions:me,is_chatops_connected:Ae,is_integration_chatops_connected:We},slo:{hasSlo:$e,hasSloWithAlert:tt},isLoading:at}=Jd();function ct(gt,Vt){const Cn=(0,ro.G)(`${Vt} + ${gt}`,{returnTo:location.pathname+location.search});D.Ny.push(Cn)}const Et={sections:[{title:"Detect",description:"Configure Grafana Alerting",steps:[{title:"Update default email contact point",description:"Add a valid email to the default email contact point.",button:{type:"openLink",urlLink:{url:`/alerting/notifications/receivers/${V}/edit`,queryParams:{alertmanager:"grafana"}},label:"Edit",labelOnDone:"View",urlLinkOnDone:{url:"/alerting/notifications"}},done:Kd(V,F)},{title:"Connect alerting to OnCall",description:"Create an OnCall integration for an alerting contact point.",button:{type:"openLink",urlLink:{url:"/alerting/notifications/receivers/new"},label:"Connect",urlLinkOnDone:{url:"/alerting/notifications"},labelOnDone:"View"},done:Ud(F)},{title:"Create alert rule",description:"Create an alert rule to monitor your system.",button:{type:"openLink",urlLink:{url:"/alerting/new"},label:"Create",urlLinkOnDone:{url:"/alerting/list"},labelOnDone:"View"},done:k},{title:"Create your first SLO",description:"Create SLOs to monitor your service.",button:{type:"openLink",urlLink:{url:"/a/grafana-slo-app/wizard/new"},label:"Create",urlLinkOnDone:{url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:$e},{title:"Enable SLO alerting",description:"Configure SLO alerting to receive notifications when your SLOs are breached.",button:{type:"openLink",urlLink:{queryParams:{alertsEnabled:"disabled"},url:"/a/grafana-slo-app/manage-slos"},label:"Enable",urlLinkOnDone:{queryParams:{alertsEnabled:"enabled"},url:"/a/grafana-slo-app/manage-slos"},labelOnDone:"View"},done:tt}]},{title:"Respond",description:"Configure OnCall and Incident",steps:[{title:"Initialize Incident plugin",description:"Initialize the Incident plugin to declare and manage incidents.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/walkthrough/generate-key"},label:"Initialize",urlLinkOnDone:{url:"/a/grafana-incident-app"},labelOnDone:"View"},done:ve},{title:"Connect your Messaging workspace to OnCall",description:"Receive alerts and oncall notifications within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps",chatOpsTab:"Slack"}},label:"Connect",urlLinkOnDone:{url:"/a/grafana-oncall-app/settings",queryParams:{tab:"ChatOps"}},labelOnDone:"View"},done:Ae},{title:"Connect your Messaging workspace to Incident",description:"Automatically create an incident channel and manage incidents directly within your chat environment.",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app/integrations/grate.slack"},label:"Connect",urlLinkOnDone:{url:"/a/grafana-incident-app/integrations"}},done:oe},{title:"Add Messaging workspace channel to OnCall Integration",description:"Select ChatOps channels to route notifications",button:{type:"openLink",urlLink:{url:"/a/grafana-oncall-app/integrations/"},label:"Add",urlLinkOnDone:{url:"/a/grafana-oncall-app/integrations/"},labelOnDone:"View"},done:We}]},{title:"Test your configuration",description:"",steps:[{title:"Send OnCall demo alert via Alerting integration",description:"In the integration page, click Send demo alert, to review your notification",button:{type:"dropDown",label:"Select integration",options:me,onClickOption:gt=>ct(gt,"/a/grafana-oncall-app/integrations/"),stepNotAvailableText:"No integrations available"}},{title:"Create Incident drill",description:"Practice solving an Incident",button:{type:"openLink",urlLink:{url:"/a/grafana-incident-app",queryParams:{declare:"new",drill:"1"}},label:"Start drill"}}]}]},{stepsDone:ht,totalStepsToDo:mt}=Et.sections.reduce((gt,Vt)=>{const Cn=Vt.steps.filter(Fn=>Fn.done).length,Mn=Vt.steps.reduce((Fn,Wn)=>Wn.done!==void 0?Fn+1:Fn,0);return{stepsDone:gt.stepsDone+Cn,totalStepsToDo:gt.totalStepsToDo+Mn}},{stepsDone:0,totalStepsToDo:0});return{essentialContent:Et,stepsDone:ht,totalStepsToDo:mt,isLoading:at}}const Zd=({dataSourceConfigurationData:{dataSourceCompatibleWithAlerting:F},essentialsConfigurationData:{stepsDone:V,totalStepsToDo:k}})=>(0,o.useMemo)(()=>{function oe(){const ve=F?"You have connected a datasource.":"Connect at least one data source to start receiving data",me=F?"View":"Connect";return{id:sl.CONNECT_DATASOURCE,title:"Connect data source",description:ve,actionButtonTitle:me,isDone:F}}return[oe(),{id:sl.ESSENTIALS,title:"Essentials",titleIcon:"star",description:"Set up the necessary features to start using Grafana IRM workflows",actionButtonTitle:V===k?"View":"Configure",stepsDone:V,totalStepsToDo:k}]},[F,V,k]);var qd=e(39558),vs=e(8484);function Vl({stepsDone:F,totalStepsToDo:V}){const k=(0,xe.of)(eu);return V===0?null:(0,M.jsx)("div",{className:k.containerStyles,role:"progressbar","aria-valuenow":F,"aria-valuemax":V,children:(0,M.jsx)("div",{className:k.fillerStyles(F/V*100)})})}function zl({stepsDone:F,totalStepsToDo:V}){return(0,M.jsxs)("span",{children:[(0,M.jsx)(Vs.E,{color:"success",children:F})," of ",V]})}function eu(F){return{containerStyles:(0,ze.css)({height:F.spacing(2),borderRadius:F.shape.radius.pill,backgroundColor:F.colors.border.weak,flex:"auto"}),fillerStyles:V=>(0,ze.css)({height:"100%",width:`${V}%`,backgroundColor:F.colors.success.main,borderRadius:F.shape.radius.pill,textAlign:"right"})}}function tu({config:F,handleActionClick:V,isLoading:k=!1}){const oe=(0,xe.of)(nu);return(0,M.jsx)(fs.B,{direction:"column",gap:1,justifyContent:"space-around",children:(0,M.jsxs)("div",{className:oe.cardContent,children:[(0,M.jsxs)(fs.B,{direction:"column",gap:1,children:[(0,M.jsxs)(fs.B,{direction:"row",alignItems:"center",justifyContent:"space-between",gap:1,children:[(0,M.jsx)("div",{className:"fs-unmask",children:(0,M.jsxs)(fs.B,{direction:"row",gap:1,alignItems:"center",children:[F.title,F.titleIcon&&(0,M.jsx)(Rs.I,{name:F.titleIcon}),F.isDone&&!k&&(0,M.jsx)(Rs.I,{name:"check-circle",color:"green",size:"lg"})]})}),F.stepsDone&&F.totalStepsToDo&&!k&&(0,M.jsx)("div",{className:"fs-unmask",children:(0,M.jsxs)(fs.B,{direction:"row",gap:.5,children:[(0,M.jsx)(zl,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo}),(0,M.jsx)(vs.x6,{i18nKey:"configuration-tracker.config-card.complete",children:"complete"})]})})]}),(0,M.jsxs)(fs.B,{direction:"column",children:[k?(0,M.jsx)(qd._,{text:"Loading configuration...."}):F.description,!k&&F.stepsDone&&F.totalStepsToDo&&(0,M.jsx)(Vl,{stepsDone:F.stepsDone,totalStepsToDo:F.totalStepsToDo})]})]}),(0,M.jsx)(fs.B,{direction:"row",gap:1,justifyContent:"flex-start",alignItems:"flex-end",children:(0,M.jsx)(se.$n,{variant:"secondary",onClick:()=>V(F.id,F.isDone),className:"fs-unmask",children:F.actionButtonTitle})})]})})}const nu=F=>({cardTitle:(0,ze.css)({display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",width:"100%"}),cardContent:(0,ze.css)({background:F.colors.background.secondary,padding:F.spacing(2),borderRadius:F.shape.radius.default,height:"100%",gap:F.spacing(1),display:"flex",flexDirection:"column",justifyContent:"space-between"})});var Hl=e(87978),oo=e(83122),ii=e(38138);function su({onClose:F,essentialsConfig:V,stepsDone:k,totalStepsToDo:oe}){return(0,M.jsx)(Hl._,{title:"Essentials",subtitle:"Complete the following configuration tasks",onClose:F,children:(0,M.jsx)(au,{essentialContent:V,stepsDone:k,totalStepsToDo:oe})})}function au({essentialContent:F,stepsDone:V,totalStepsToDo:k}){return(0,M.jsxs)(fs.B,{direction:"column",gap:1,children:[(0,M.jsx)(du,{stepsDone:V,totalStepsToDo:k}),F.sections.map(oe=>(0,M.jsx)(ru,{section:oe},oe.title))]})}function ru({section:F}){const V=(0,xe.of)(uu);return(0,M.jsxs)("div",{className:V.wrapper,children:[(0,M.jsx)(Vs.E,{element:"h4",children:(0,M.jsx)("span",{className:"fs-unmask",children:F.title})}),(0,M.jsx)(Vs.E,{color:"secondary",children:(0,M.jsx)("span",{className:"fs-unmask",children:F.description})}),(0,M.jsx)(fs.B,{direction:"column",gap:2,children:F.steps.map((k,oe)=>(0,M.jsx)(iu,{step:k},oe))})]})}function ou({done:F}){return F?(0,M.jsx)(Rs.I,{name:"check-circle",color:"green","data-testid":"checked-step",className:"fs-unmask"}):(0,M.jsx)(Rs.I,{name:"circle","data-testid":"unckecked-step",className:"fs-unmask"})}function iu({step:F}){return(0,M.jsxs)(fs.B,{direction:"row",justifyContent:"space-between","data-testid":"step",children:[(0,M.jsxs)(fs.B,{direction:"row",alignItems:"center",children:[F.done!==void 0&&(0,M.jsx)(ou,{done:F.done}),(0,M.jsx)(Vs.E,{variant:"body",children:(0,M.jsx)("span",{className:"fs-unmask",children:F.title})}),(0,M.jsx)(Qs.m,{content:F.description,placement:"right",children:(0,M.jsx)(Rs.I,{name:"question-circle"})})]}),(0,M.jsx)(cu,{...F.button,done:F.done,"data-testid":"step-button"})]})}function lu(F){const{urlLink:V,label:k,urlLinkOnDone:oe,labelOnDone:ve,done:me}=F,Ae=V?.url?(0,ro.G)(V.url,{returnTo:location.pathname+location.search,...V.queryParams}):"",We=oe?.url?(0,ro.G)(oe.url,{returnTo:location.pathname+location.search,...oe.queryParams}):"",$e=me?We:Ae;return(0,M.jsx)(se.z9,{href:$e,variant:"secondary",className:"fs-unmask",children:me?ve??k:k})}function cu({type:F,urlLink:V,urlLinkOnDone:k,label:oe,labelOnDone:ve,options:me,onClickOption:Ae,done:We,stepNotAvailableText:$e}){switch(F){case"openLink":return(0,M.jsx)(lu,{urlLink:V,label:oe,urlLinkOnDone:k,labelOnDone:ve,done:We});case"dropDown":return me?.length?(0,M.jsx)(oo.m,{overlay:(0,M.jsx)(ii.W,{className:"fs-unmask",children:me?.map(tt=>(0,M.jsx)(ii.W.Item,{label:tt.label,className:"fs-unmask",onClick:()=>{Ae?.(tt.value)}},tt.value))}),children:(0,M.jsxs)(se.$n,{variant:"secondary",size:"md",className:"fs-unmask",children:[oe,(0,M.jsx)(Rs.I,{name:"angle-down"})]})}):(0,M.jsxs)(Vs.E,{children:[$e??"No options available"," "]})}}function du({stepsDone:F,totalStepsToDo:V}){return(0,M.jsxs)(fs.B,{direction:"row",gap:1,alignItems:"center",children:["Your progress",(0,M.jsx)(Vl,{stepsDone:F,totalStepsToDo:V}),(0,M.jsx)(zl,{stepsDone:F,totalStepsToDo:V})]})}const uu=F=>({wrapper:(0,ze.css)({margin:F.spacing(2,0),padding:F.spacing(2),border:`1px solid ${F.colors.border.medium}`,borderRadius:F.shape.radius.default,display:"flex",flexDirection:"column",gap:F.spacing(2)})});var sl=(F=>(F[F.CONNECT_DATASOURCE=0]="CONNECT_DATASOURCE",F[F.ESSENTIALS=1]="ESSENTIALS",F))(sl||{});function hu(){return{dataSourceCompatibleWithAlerting:!!(0,er.k5)()}}function fu(){const F=(0,xe.of)(gu),V=(0,Xs.Zp)(),k=hu(),oe=Xd(),ve=Zd({dataSourceConfigurationData:k,essentialsConfigurationData:oe});(0,o.useEffect)(()=>{Ba(ja.ViewIRMMainPage,{essentialStepsDone:0,essentialStepsToDo:0,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting})},[k.dataSourceCompatibleWithAlerting]);const[me,Ae]=(0,pr.l)(),We=me.get("essentials")==="open",$e=(at,ct)=>{switch(Ba(ja.ClickDataSources,{essentialStepsDone:oe.stepsDone,essentialStepsToDo:oe.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting}),at){case 0:V(ct?La.I.List:La.I.New);break;case 1:Ae({essentials:"open"}),Ba(ja.OpenEssentials,{essentialStepsDone:oe.stepsDone,essentialStepsToDo:oe.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting});break;default:return}};function tt(){Ae({essentials:void 0}),Ba(ja.CloseEssentials,{essentialStepsDone:oe.stepsDone,essentialStepsToDo:oe.totalStepsToDo,dataSourceCompatibleWithAlerting:k.dataSourceCompatibleWithAlerting})}return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Vs.E,{element:"h4",variant:"h4",children:"Configure"}),(0,M.jsxs)("section",{className:F.container,children:[ve.map(at=>(0,M.jsx)(tu,{config:at,handleActionClick:$e,isLoading:oe.isLoading},at.id)),We&&(0,M.jsx)(su,{onClose:tt,essentialsConfig:oe.essentialContent,stepsDone:oe.stepsDone,totalStepsToDo:oe.totalStepsToDo})]}),(0,M.jsx)(Vs.E,{element:"h4",variant:"h4",children:"IRM apps"})]})}const gu=F=>({container:(0,ze.css)({marginBottom:0,display:"grid",gap:F.spacing(3),gridTemplateColumns:" 1fr 1fr"})});var al=e(66253);const pu=[{path:"/plugins",navId:"plugins",roles:rl([Gt.AccessControlAction.PluginsInstall,Gt.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:al.vk.Home,component:(0,Pn.A)(()=>e.e(4519).then(e.bind(e,77205)))},{path:"/plugins/browse",navId:"plugins",roles:rl([Gt.AccessControlAction.PluginsInstall,Gt.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:al.vk.Browse,component:(0,Pn.A)(()=>e.e(4519).then(e.bind(e,77205)))},{path:"/plugins/:pluginId/",navId:"plugins",roles:rl([Gt.AccessControlAction.PluginsInstall,Gt.AccessControlAction.PluginsWrite],["Admin","ServerAdmin"]),routeName:al.vk.Details,component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(7743),e.e(7891)]).then(e.bind(e,86400)))}];function rl(F,V){return()=>F.some(k=>_n.TP.hasPermission(k))?[]:V}function mu(){return pu}var vu=e(17422),Ga=e(65307),yu=e(13834),ol=e(62625),Nr=e(26272),xu=e(39419),Eu=e(7392),Qa=e(76888);function UE(F){return console.error(F),Li("Exception thrown","See console for details")}function Pu(){return Li("Page not found","404 Error")}function Li(F,V){const k={text:F,subTitle:V,icon:"exclamation-triangle"};return{node:k,main:k}}var Du=e(94954);const Gl=(0,o.createContext)(void 0),Ql=(0,o.createContext)(void 0),kl=(0,o.createContext)(void 0);function _l(){const F=(0,o.useContext)(Gl);if(!F)throw new Error("No `AddedLinksRegistryContext` found.");return F}function Yl(){const F=(0,o.useContext)(Ql);if(!F)throw new Error("No `AddedComponentsRegistryContext` found.");return F}function Jl(){const F=(0,o.useContext)(kl);if(!F)throw new Error("No `ExposedComponentsRegistryContext` found.");return F}const Xl=({registries:F,children:V})=>(0,M.jsx)(Gl.Provider,{value:F.addedLinksRegistry,children:(0,M.jsx)(Ql.Provider,{value:F.addedComponentsRegistry,children:(0,M.jsx)(kl.Provider,{value:F.exposedComponentsRegistry,children:V})})});var Zl=e(27716),ql=e(1682),ec=e(60677);const il=(0,o.createContext)(tc());il.displayName="PluginPageContext";function tc(){return{sectionNav:{main:{text:"Plugin page"},node:{text:"Plugin page"}}}}function Cu(F){return{sectionNav:F??tc().sectionNav}}const nc={loading:!0,loadingError:!1,pluginNav:null,plugin:null};function bu({pluginId:F,pluginNavSection:V}){const{pluginId:k=""}=(0,Xs.g)();F=F||k;const oe=_l(),ve=Yl(),me=Jl(),Ae=(0,ao.zy)(),[We,$e]=(0,o.useReducer)(li.reducer,nc),tt=G.$.appSubUrl+Ae.pathname+Ae.search,{plugin:at,loading:ct,loadingError:Et,pluginNav:ht}=We,mt=(0,ec.Wy)(tt,V),gt=(0,o.useMemo)(()=>(0,D.SE)(Ae.search),[Ae.search]),Vt=(0,o.useMemo)(()=>Cu(mt),[mt]),Cn=(0,Qa.Il)();(0,o.useEffect)(()=>{Tu(F,$e)},[F]);const Mn=(0,o.useCallback)(Ms=>$e(li.actions.changeNav(Ms)),[]);if(!at||F!==at.meta.id){const Ms=Cn.chrome.state.getValue().layout;return(0,M.jsxs)(Lt.YW,{navModel:mt,pageNav:{text:""},layout:Ms,children:[ct&&(0,M.jsx)(xu.A,{}),!ct&&Et&&(0,M.jsx)(Eu.L,{entity:"App"})]})}if(!at.root)return(0,M.jsx)(Lt.YW,{navModel:mt??Li("Plugin load error"),children:(0,M.jsx)("div",{children:"No root app page component found"})});const Fn=at.root&&(0,M.jsx)(yu.a,{meta:at.meta,children:(0,M.jsx)(Xl,{registries:{addedLinksRegistry:oe.readOnly(),addedComponentsRegistry:ve.readOnly(),exposedComponentsRegistry:me.readOnly()},children:(0,M.jsx)(at.root,{meta:at.meta,basename:Ae.pathname,onNavChanged:Mn,query:gt,path:Ae.pathname})})}),Wn=()=>{if(!at.meta?.includes)return!0;const Ms=at.meta?.includes.find(BE=>BE.path===Ae.pathname);if(!Ms)return!0;if(Ms?.action&&G.$.featureToggles.accessControlOnCall)return _n.TP.hasPermission(Ms.action);if(_n.TP.isGrafanaAdmin||_n.TP.user.orgRole===ol.X.Admin)return!0;const Ca=Ms?.role||"";return!Ca||_n.TP.isEditor&&Ca===ol.X.Viewer?!0:_n.TP.hasRole(Ca)},ta=()=>(0,M.jsx)(aa.F,{severity:"warning",title:"Access denied",children:"You do not have permission to see this page."});return Wn()?ht?(0,M.jsx)(M.Fragment,{children:mt?(0,M.jsx)(Lt.YW,{navModel:mt,pageNav:ht?.node,children:(0,M.jsx)(Lt.YW.Contents,{isLoading:ct,children:Fn})}):(0,M.jsx)(Lt.YW,{children:Fn})}):(0,M.jsx)(il.Provider,{value:Vt,children:Fn}):(0,M.jsx)(ta,{})}const li=(0,Ga.Z0)({name:"prom-builder-container",initialState:nc,reducers:{setState:(F,V)=>{Object.assign(F,V.payload)},changeNav:(F,V)=>{let k=V.payload;k&&k.node.children&&(k={...k,node:{...k.main,hideFromBreadcrumbs:!0}}),F.pluginNav=k}}});async function Tu(F,V){try{const k=await(0,Zl.x)(F).then(oe=>{const ve=Mu(oe);return ve?(_n.lE.emit(Nr.r1.alertError,[ve]),V(li.actions.setState({pluginNav:Li(ve)})),null):(0,ql.ui)(oe)});V(li.actions.setState({plugin:k,loading:!1,loadingError:!1,pluginNav:null}))}catch(k){V(li.actions.setState({plugin:null,loading:!1,loadingError:!0,pluginNav:Pu()}));const oe=k instanceof Error?k:new Error((0,Du.q)(k));ec.z4.logError(oe),console.error(oe)}}function Mu(F){return F?F.type!==fe.QE.app?"Plugin must be an app":F.enabled?null:"Application Not Enabled":"Unknown Plugin"}const ll=bu;var js=e(99140);function Su(){const F=(0,js.Gu)(),{navIndex:V}=F,k=me=>me.startsWith("standalone-plugin-page-/"),oe=me=>"pluginId"in me&&"id"in me;return[...Object.values(V).filter(oe).map(me=>{const Ae=(0,vu.rH)(me),We=`/a/${me.pluginId}`,$e=k(me.id)&&me.url||We,tt=k(me.id)&&!me.url?.startsWith("/a/");return{path:$e,exact:!1,sensitive:tt,component:()=>(0,M.jsx)(ll,{pluginId:me.pluginId,pluginNavSection:Ae})}}),{path:"/a/:pluginId",exact:!1,component:()=>(0,M.jsx)(ll,{pluginNavSection:V.home})}]}const sc=[{path:"/profile",component:(0,Pn.A)(()=>Promise.all([e.e(4753),e.e(2472)]).then(e.bind(e,48357)))},{path:"/profile/password",component:(0,Pn.A)(()=>e.e(8107).then(e.bind(e,28107)))},{path:"/profile/select-org",component:(0,Pn.A)(()=>e.e(7430).then(e.bind(e,44613)))},{path:"/profile/notifications",component:(0,Pn.A)(()=>e.e(4140).then(e.bind(e,78015)))}];function Ou(F=H.$W){return F.profileEnabled?sc:(0,l.uniq)(sc.map(k=>k.path)).map(k=>({path:k,component:(0,Pn.A)(()=>e.e(5173).then(e.bind(e,35208)))}))}var ac=e(69529),Au=e(21286),ci=e(29795);function Iu(){const F=(0,xe.of)(Ru),V=(0,Au.s)(),k=(0,Gt.useSelector)(ve=>ve.navBarTree),oe=V.reduce((ve,me)=>{const Ae=(0,ci.Wk)(k,me);return Ae&&ve.push(Ae),ve},[]);return(0,M.jsx)(Lt.YW,{navId:"bookmarks",children:(0,M.jsx)(Lt.YW.Contents,{children:oe.length===0?(0,M.jsx)(ac.p,{variant:"call-to-action",message:(0,vs.t)("bookmarks-page.empty.message","It looks like you haven\u2019t created any bookmarks yet"),children:(0,M.jsx)(vs.x6,{i18nKey:"bookmarks-page.empty.tip",children:"Hover over any item in the nav menu and click on the bookmark icon to add it here."})}):(0,M.jsx)("section",{className:F.grid,children:oe.map(ve=>(0,M.jsx)(_t,{description:ve.subTitle,text:ve.text,url:ve.url??""},ve.id||ve.url))})})})}const Ru=F=>({grid:(0,ze.css)({display:"grid",gap:F.spacing(3),gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gridAutoRows:"138px",padding:F.spacing(2,0)})}),Lu=()=>!H.$W.publicDashboardsEnabled||!H.$W.featureToggles.publicDashboards?[]:[{path:"/dashboard/public",pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.Public,component:(0,Pn.A)(()=>e.e(5761).then(e.bind(e,53371)))},{path:"/public-dashboards/:accessToken",pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.Public,chromeless:!0,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(6263),e.e(7197)]).then(e.bind(e,20302)))}],ju=[];function Bu(){return[...Su(),{path:"/",pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.Home,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(9136)]).then(e.bind(e,80907)))},{path:"/d/:uid/:slug?",pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.Normal,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(9136)]).then(e.bind(e,80907)))},{path:"/dashboard/new",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.DashboardsCreate]),pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.New,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,80907)))},{path:"/dashboard/new-with-ds/:datasourceUid",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.DashboardsCreate]),component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,30798)))},{path:"/dashboard/:type/:slug",pageClass:"page-dashboard",routeName:Gt.DashboardRoutes.Normal,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,80907)))},{path:"/dashboards/embedding-test",component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(660),e.e(6263),e.e(8779),e.e(2976)]).then(e.bind(e,14962)))},{path:"/d-solo/:uid/:slug?",routeName:Gt.DashboardRoutes.Normal,chromeless:!0,component:(0,Pn.A)(()=>H.Ay.featureToggles.dashboardSceneSolo?Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,24880)):Promise.all([e.e(9569),e.e(4492)]).then(e.bind(e,55087)))},{path:"/dashboard-solo/:type/:slug",routeName:Gt.DashboardRoutes.Normal,chromeless:!0,component:(0,Pn.A)(()=>Promise.all([e.e(9569),e.e(7849)]).then(e.bind(e,55087)))},{path:"/dashboard/import",component:(0,Pn.A)(()=>e.e(2550).then(e.bind(e,23390)))},{path:La.I.List,component:()=>(0,M.jsx)(Xs.C5,{replace:!0,to:qs.b.DataSources})},{path:La.I.Edit,component:Wu},{path:La.I.Dashboards,component:Nu},{path:La.I.New,component:()=>(0,M.jsx)(Xs.C5,{replace:!0,to:qs.b.DataSourcesNew})},{path:"/datasources/correlations",component:(0,Pn.A)(()=>H.Ay.featureToggles.correlations?e.e(9981).then(e.bind(e,32429)):e.e(8014).then(e.bind(e,55244)))},{path:"/dashboards",component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid/:slug",component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/dashboards/f/:uid",component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(152)]).then(e.bind(e,2471)))},{path:"/explore",pageClass:"page-explore",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.DataSourcesExplore]),component:(0,Pn.A)(()=>H.Ay.exploreEnabled?Promise.all([e.e(407),e.e(5995),e.e(5194),e.e(660),e.e(1698),e.e(500),e.e(1166),e.e(5511),e.e(9604)]).then(e.bind(e,94767)):e.e(4422).then(e.bind(e,53518)))},{path:"/apps",component:()=>(0,M.jsx)(rn,{navId:"apps"})},{path:"/alerts-and-incidents",component:()=>(0,M.jsx)(rn,{navId:"alerts-and-incidents",header:!(0,ks.y$)()&&(0,ks.qc)()||(0,ks.ES)()?(0,M.jsx)(fu,{}):void 0})},{path:"/testing-and-synthetics",component:()=>(0,M.jsx)(rn,{navId:"testing-and-synthetics"})},{path:"/monitoring",component:()=>(0,M.jsx)(rn,{navId:"monitoring"})},{path:"/infrastructure",component:()=>(0,M.jsx)(rn,{navId:"infrastructure"})},{path:"/frontend",component:()=>(0,M.jsx)(rn,{navId:"frontend"})},{path:"/admin/general",component:()=>(0,M.jsx)(rn,{navId:"cfg/general"})},{path:"/admin/plugins",component:()=>(0,M.jsx)(rn,{navId:"cfg/plugins"})},{path:"/admin/access",component:()=>(0,M.jsx)(rn,{navId:"cfg/access"})},{path:"/org",component:(0,Pn.A)(()=>e.e(1510).then(e.bind(e,69047)))},{path:"/org/new",component:(0,Pn.A)(()=>e.e(7930).then(e.bind(e,25913)))},{path:"/org/users",component:()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/admin/users"})},{path:"/org/users/invite",component:(0,Pn.A)(()=>e.e(7720).then(e.bind(e,91230)))},{path:"/org/apikeys",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.ActionAPIKeysRead]),component:(0,Pn.A)(()=>e.e(4196).then(e.bind(e,9699)))},{path:"/org/serviceaccounts",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.ServiceAccountsRead,Gt.AccessControlAction.ServiceAccountsCreate]),component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(6777)]).then(e.bind(e,23645)))},{path:"/org/serviceaccounts/create",component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(4176)]).then(e.bind(e,63606)))},{path:"/org/serviceaccounts/:id",component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(6576)]).then(e.bind(e,82936)))},{path:"/org/teams",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.ActionTeamsRead,Gt.AccessControlAction.ActionTeamsCreate]),component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(1036)]).then(e.bind(e,52576)))},{path:"/org/teams/new",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.ActionTeamsCreate]),component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(5436)]).then(e.bind(e,80011)))},{path:"/org/teams/edit/:uid/:page?",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.ActionTeamsRead,Gt.AccessControlAction.ActionTeamsCreate]),component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(2212)]).then(e.bind(e,92886)))},{path:"/admin",component:()=>(0,M.jsx)(rn,{navId:"cfg",header:(0,M.jsx)(Pa,{})})},{path:"/admin/authentication",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.SettingsWrite]),component:H.Ay.licenseInfo.enabledFeatures?.saml||H.Ay.ldapEnabled||H.Ay.featureToggles.ssoSettingsApi?(0,Pn.A)(()=>e.e(5592).then(e.bind(e,51332))):()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/admin"})},{path:"/admin/authentication/ldap",component:H.Ay.featureToggles.ssoSettingsLDAP?(0,Pn.A)(()=>e.e(4582).then(e.bind(e,84647))):Sa},{path:"/admin/authentication/:provider",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.SettingsWrite]),component:H.Ay.featureToggles.ssoSettingsApi?(0,Pn.A)(()=>e.e(5592).then(e.bind(e,71703))):()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/admin"})},{path:"/admin/settings",component:(0,Pn.A)(()=>e.e(7659).then(e.bind(e,98493)))},{path:"/admin/upgrading",component:(0,Pn.A)(()=>e.e(5356).then(e.bind(e,55356)))},{path:"/admin/users",component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(1743)]).then(e.bind(e,21807)))},{path:"/admin/users/create",component:(0,Pn.A)(()=>e.e(9239).then(e.bind(e,64665)))},{path:"/admin/users/edit/:id",component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(4753),e.e(8054)]).then(e.bind(e,34562)))},{path:"/admin/orgs",component:(0,Pn.A)(()=>e.e(9736).then(e.bind(e,24870)))},{path:"/admin/orgs/edit/:id",component:(0,Pn.A)(()=>Promise.all([e.e(1783),e.e(9119)]).then(e.bind(e,57582)))},{path:"/admin/featuretoggles",component:H.Ay.featureToggles.featureToggleAdminPage?(0,Pn.A)(()=>e.e(7024).then(e.bind(e,47295))):()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/admin"})},{path:"/admin/storage/:path*",roles:()=>["Admin"],component:(0,Pn.A)(()=>e.e(1927).then(e.bind(e,68932)))},{path:"/admin/stats",component:(0,Pn.A)(()=>e.e(9299).then(e.bind(e,51372)))},H.Ay.featureToggles.onPremToCloudMigrations&&{path:"/admin/migrate-to-cloud",roles:()=>["Admin"],component:(0,Pn.A)(()=>Promise.all([e.e(4753),e.e(3704)]).then(e.bind(e,76491)))},{path:"/login",component:(0,Pn.A)(()=>e.e(3883).then(e.bind(e,57041))),pageClass:"login-page",chromeless:!0},{path:"/invite/:code",component:(0,Pn.A)(()=>e.e(8576).then(e.bind(e,14383))),chromeless:!0},{path:"/verify",component:H.Ay.verifyEmailEnabled?(0,Pn.A)(()=>e.e(8786).then(e.bind(e,78786))):()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/signup"}),pageClass:"login-page",chromeless:!0},{path:"/signup",component:H.Ay.disableUserSignUp?()=>(0,M.jsx)(Xs.C5,{replace:!0,to:"/login"}):(0,Pn.A)(()=>e.e(7914).then(e.bind(e,27914))),pageClass:"login-page",chromeless:!0},{path:"/user/password/send-reset-email",chromeless:!0,component:(0,Pn.A)(()=>e.e(3818).then(e.bind(e,2713)))},{path:"/user/password/reset",component:(0,Pn.A)(()=>e.e(641).then(e.bind(e,37344))),pageClass:"login-page",chromeless:!0},{path:"/dashboard/snapshots",component:(0,Pn.A)(()=>e.e(6590).then(e.bind(e,72602)))},H.Ay.featureToggles.dashboardRestoreUI&&{path:"/dashboard/recently-deleted",roles:()=>["Admin"],component:(0,Pn.A)(()=>Promise.all([e.e(4007),e.e(4753),e.e(6359),e.e(6299)]).then(e.bind(e,10421)))},{path:"/playlists",component:(0,Pn.A)(()=>e.e(1168).then(e.bind(e,44450)))},{path:"/playlists/play/:uid",component:(0,Pn.A)(()=>e.e(1374).then(e.bind(e,93129)))},{path:"/playlists/new",component:(0,Pn.A)(()=>e.e(7616).then(e.bind(e,62579)))},{path:"/playlists/edit/:uid",component:(0,Pn.A)(()=>e.e(7620).then(e.bind(e,84535)))},{path:"/sandbox/benchmarks",component:(0,Pn.A)(()=>e.e(9354).then(e.bind(e,98351)))},{path:"/sandbox/test",component:(0,Pn.A)(()=>e.e(5354).then(e.bind(e,65802)))},{path:"/dashboards/f/:uid/:slug/library-panels",component:(0,Pn.A)(()=>e.e(5804).then(e.bind(e,15111)))},{path:"/dashboards/f/:uid/:slug/alerting",roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.AlertingRuleRead]),component:(0,Pn.A)(()=>e.e(4333).then(e.bind(e,30027)))},{path:"/library-panels",component:(0,Pn.A)(()=>e.e(8516).then(e.bind(e,23053)))},{path:"/notifications",component:(0,Pn.A)(()=>e.e(4140).then(e.bind(e,78015)))},H.Ay.featureToggles.exploreMetrics&&{path:"/explore/metrics",chromeless:!1,exact:!1,roles:()=>mn.TP.evaluatePermission([Gt.AccessControlAction.DataSourcesExplore]),component:(0,Pn.A)(()=>e.e(4785).then(e.bind(e,89858)))},{path:"/bookmarks",component:()=>(0,M.jsx)(Iu,{})},...mu(),...Uu(),...Ea(),...Ou(),...ju,...Lu(),...Da(),{path:"/*",component:En.H}].filter(Dt.zz)}function Uu(F=H.Ay){return F.supportBundlesEnabled?[{path:"/support-bundles",component:(0,Pn.A)(()=>e.e(123).then(e.bind(e,21821)))},{path:"/support-bundles/create",component:(0,Pn.A)(()=>e.e(1515).then(e.bind(e,33809)))}]:[]}function Nu(){const{uid:F=""}=(0,Xs.g)();return(0,M.jsx)(Xs.C5,{replace:!0,to:qs.b.DataSourcesDashboards.replace(":uid",F)})}function Wu(){const{uid:F=""}=(0,Xs.g)();return(0,M.jsx)(Xs.C5,{replace:!0,to:qs.b.DataSourcesEdit.replace(":uid",F)})}var vr=e(95344),Fu=e(7376),Ku=e(81634),cl=e(14792),yr=e(74856),wu=e(71500),$u=e(29304);async function Vu(){if(G.$.angularSupportEnabled){const{AngularApp:F}=await Promise.all([e.e(9362),e.e(7808),e.e(8888)]).then(e.bind(e,27808)),V=new F;V.init(),V.bootstrap()}else(0,Fu.w)({load:(F,V,k)=>({destroy:()=>{},digest:()=>{},getScope:()=>({})})}),(0,Ku.j)({get:F=>{switch(F){case"backendSrv":return(0,vr.l)("getLegacyAngularInjector","backendSrv","use getBackendSrv() in @grafana/runtime"),(0,P.AI)();case"contextSrv":return(0,vr.l)("getLegacyAngularInjector","contextSrv"),_n.TP;case"dashboardSrv":return(0,vr.l)("getLegacyAngularInjector","getDashboardSrv"),(0,cl.UA)();case"datasourceSrv":return(0,vr.l)("getLegacyAngularInjector","datasourceSrv","use getDataSourceSrv() in @grafana/runtime"),(0,A.l)();case"linkSrv":return(0,vr.l)("getLegacyAngularInjector","linkSrv"),(0,$u.mQ)();case"validationSrv":return(0,vr.l)("getLegacyAngularInjector","validationSrv"),wu.P;case"timeSrv":return(0,vr.l)("getLegacyAngularInjector","timeSrv"),(0,yr.jG)();case"templateSrv":return(0,vr.l)("getLegacyAngularInjector","templateSrv","use getTemplateSrv() in @grafana/runtime"),(0,Pe.w)()}throw"Angular is disabled.  Unable to expose: "+F}})}var Wr=e(24120),dl=e(11848);const rc=(0,o.createContext)(dl.L);function oc(){const F=(0,Wr.A)(dl.L.activePluginId),V=(0,o.useContext)(rc);if(!V)throw new Error("No SidecarContext found");return{activePluginId:F,openApp:k=>V.openApp(k),closeApp:k=>V.closeApp(k),isAppOpened:k=>V.isAppOpened(k)}}var zu=e(66899),Hu=e.n(zu),ul=e(64388),ic=e(52446);function Gu({error:F,errorInfo:V}){const k=(0,Xs.zy)(),oe=F?.name==="ChunkLoadError",ve=(0,xe.of)(Qu);return(0,o.useEffect)(()=>{oe&&k.search.indexOf("chunkNotFound")===-1&&(window.location.href=v.I.getUrlForPartial(k,{chunkNotFound:!0}))},[k,oe]),(0,M.jsx)(Lt.YW,{navId:"error",layout:ul.k.Canvas,children:(0,M.jsxs)("div",{className:ve.container,children:[oe&&(0,M.jsxs)("div",{children:[(0,M.jsx)("h2",{children:"Unable to find application file"}),(0,M.jsx)("br",{}),(0,M.jsx)("h2",{className:"page-heading",children:"Grafana has likely been updated. Please try reloading the page."}),(0,M.jsx)("br",{}),(0,M.jsx)(se.$n,{size:"md",variant:"secondary",icon:"repeat",onClick:()=>window.location.reload(),children:"Reload"}),(0,M.jsx)(ic.D,{title:"Error details",error:F,errorInfo:V})]}),!oe&&(0,M.jsx)(ic.D,{title:"An unexpected error happened",error:F,errorInfo:V})]})})}const Qu=F=>({container:(0,ze.css)({width:"500px",margin:F.spacing(8,"auto")})});function ku(){const F=(0,xe.of)(Zu);return(0,M.jsx)("div",{className:F.container,"aria-live":"polite",role:"status","aria-label":(0,vs.t)("bouncing-loader.label","Loading"),children:(0,M.jsx)("div",{className:F.bounce,children:(0,M.jsx)("img",{alt:"",src:"public/img/grafana_icon.svg",className:F.logo})})})}const _u=(0,ze.keyframes)({"0%":{opacity:0,animationTimingFunction:"cubic-bezier(0, 0, 0.5, 1)"},"100%":{opacity:1}}),Yu=(0,ze.keyframes)({"0%":{opacity:0},"50%":{opacity:1},"100%":{opacity:0}}),Ju=(0,ze.keyframes)({"from, to":{transform:"translateY(0px)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"50%":{transform:"translateY(-50px)",animationTimingFunction:"cubic-bezier(0.9, 0, 0.7, 1)"}}),Xu=(0,ze.keyframes)({"0%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0.3, 0, 0.1, 1)"},"15%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 0.75)"},"55%":{transform:"scaleX(1.05) scaleY(0.95)",animationTimingFunction:"cubic-bezier(0.9, 0, 1, 1)"},"95%":{transform:"scaleX(0.75) scaleY(1.25)",animationTimingFunction:"cubic-bezier(0, 0, 0, 1)"},"100%":{transform:"scaleX(1.3) scaleY(0.8)",animationTimingFunction:"cubic-bezier(0, 0, 0.7, 1)"}}),Zu=F=>({container:(0,ze.css)({opacity:0,[F.transitions.handleMotion("no-preference")]:{animationName:_u,animationIterationCount:1,animationDuration:"0.9s",animationDelay:"0.5s",animationFillMode:"forwards"},[F.transitions.handleMotion("reduce")]:{animationName:Yu,animationIterationCount:"infinite",animationDuration:"4s",animationDelay:"0.5s"}}),bounce:(0,ze.css)({textAlign:"center",[F.transitions.handleMotion("no-preference")]:{animationName:Ju,animationDuration:"0.9s",animationIterationCount:"infinite"}}),logo:(0,ze.css)({display:"inline-block",[F.transitions.handleMotion("no-preference")]:{animationName:Xu,animationDuration:"0.9s",animationIterationCount:"infinite"},width:"60px",height:"60px"})});function qu(){const F=(0,xe.of)(eh);return(0,M.jsx)("div",{className:F.loadingPage,children:(0,M.jsx)(ku,{})})}const eh=F=>({loadingPage:(0,ze.css)({backgroundColor:F.colors.background.primary,flex:1,flexDrection:"column",display:"flex",justifyContent:"center",alignItems:"center"})});function th(F){const{chrome:V,keybindings:k}=(0,Qa.Il)();return V.setMatchedRoute(F.route),(0,o.useLayoutEffect)(()=>{k.clearAndInitGlobalBindings(F.route)},[k,F.route]),(0,o.useEffect)(()=>(lc(F.route),cc(),(0,D.Lc)("GrafanaRoute",!1,"Mounted",F.route),()=>{(0,D.Lc)("GrafanaRoute",!1,"Unmounted",F.route),lc(F.route,!0)}),[]),(0,o.useEffect)(()=>{cc(),(0,da.Jy)(),(0,D.Lc)("GrafanaRoute",!1,"Updated",F)}),(0,D.Lc)("GrafanaRoute",!1,"Rendered",F.route),(0,M.jsx)(Ii.tH,{children:({error:oe,errorInfo:ve})=>oe?(0,M.jsx)(Gu,{error:oe,errorInfo:ve}):(0,M.jsx)(o.Suspense,{fallback:(0,M.jsx)(qu,{}),children:(0,M.jsx)(F.route.component,{...F,queryParams:(0,D.SE)(F.location.search)})})})}function nh(F){return F.pageClass?F.pageClass.split(" "):[]}function lc(F,V=!1){for(const k of nh(F))V?document.body.classList.remove(k):document.body.classList.add(k)}function cc(){document.body.classList.remove("sidemenu-open--xs");const F=document.getElementById("tooltip");F?.parentElement?.removeChild(F);const V=document.querySelectorAll(".tooltip");for(let k=0;k<V.length;k++){const oe=V[k];oe.parentElement?.removeChild(oe)}for(const k of Hu().drops)k.destroy()}var sh=e(96378),hl=e(78731),dc=e(3911);class ah extends o.PureComponent{constructor(){super(...arguments),this.styles=rh(G.$.theme2),this.state={},this.initListener=()=>{const V=(0,hl.oF)();V&&(this.subscription=V.getConnectionState().subscribe({next:k=>{this.setState({show:!k})}}))}}componentDidMount(){}componentWillUnmount(){this.subscription&&this.subscription.unsubscribe()}render(){const{show:V}=this.state;return V?!mn.TP.isSignedIn||!G.$.liveEnabled||mn.TP.user.orgRole===ol.X.None?null:(0,M.jsx)("div",{className:this.styles.foot,children:(0,M.jsx)(aa.F,{severity:"warning",className:this.styles.warn,title:"connection to server is lost..."})}):null}}const rh=(0,dc.N)(F=>({foot:(0,ze.css)({position:"fixed",bottom:0,left:0,right:0,zIndex:1e4,cursor:"wait",margin:F.spacing(2)}),warn:(0,ze.css)({maxWidth:"400px",margin:"auto"})}));var oh=e(17929),uc=e(71678),ih=e(21633);const hc=(0,o.forwardRef)((F,V)=>(0,M.jsx)("div",{id:"ngRoot",ref:V,dangerouslySetInnerHTML:{__html:"<grafana-app ng-cloak></grafana-app>"}}));hc.displayName="AngularRoot";var lh=e(46942),ch=e.n(lh),ji=e(60619),xr=e(33390),fc=e(18828),gc=e(85690),pc=e(93225),dh=e(57514),mc=e(65178),uh=e(35822);const Bi=0,hh=F=>{const V=o.useRef(null),k=o.useRef(null),oe=o.useRef(F.items);oe.current=F.items;const ve=(0,uh.useVirtual)({size:oe.current.length,parentRef:k}),{query:me,search:Ae,currentRootActionId:We,activeIndex:$e,options:tt}=(0,Gs.useKBar)(ht=>({search:ht.searchQuery,currentRootActionId:ht.currentRootActionId,activeIndex:ht.activeIndex}));o.useEffect(()=>{const ht=mt=>{mt.key==="ArrowUp"||mt.ctrlKey&&mt.key==="p"?(mt.preventDefault(),me.setActiveIndex(gt=>{let Vt=gt>Bi?gt-1:gt;if(typeof oe.current[Vt]=="string"){if(Vt===0)return gt;Vt-=1}return Vt})):mt.key==="ArrowDown"||mt.ctrlKey&&mt.key==="n"?(mt.preventDefault(),me.setActiveIndex(gt=>{let Vt=gt<oe.current.length-1?gt+1:gt;if(typeof oe.current[Vt]=="string"){if(Vt===oe.current.length-1)return gt;Vt+=1}return Vt})):mt.key==="Enter"&&(mt.preventDefault(),V.current?.click())};return window.addEventListener("keydown",ht),()=>window.removeEventListener("keydown",ht)},[me]);const{scrollToIndex:at}=ve;o.useEffect(()=>{at($e,{align:$e<=1?"end":"auto"})},[$e,at]),o.useEffect(()=>{me.setActiveIndex(typeof F.items[Bi]=="string"?Bi+1:Bi)},[Ae,We,F.items,me]);const ct=o.useCallback((ht,mt)=>{if(typeof mt=="string")return;const gt=mt.url;mt.command?(mt.command.perform(mt),me.toggle()):gt?ht.ctrlKey||ht.metaKey||ht.shiftKey||me.toggle():(me.setSearch(""),me.setCurrentRootAction(mt.id)),tt.callbacks?.onSelectAction?.(mt)},[me,tt]),Et=(0,mc.usePointerMovedSinceMount)();return(0,M.jsx)("div",{ref:k,style:{maxHeight:F.maxHeight||400,position:"relative",overflow:"auto"},children:(0,M.jsx)("div",{role:"listbox",id:Gs.KBAR_LISTBOX,style:{height:`${ve.totalSize}px`,width:"100%"},children:ve.virtualItems.map(ht=>{const mt=oe.current[ht.index],{target:gt,url:Vt}=mt,Cn=typeof mt!="string"&&{onPointerMove:()=>Et&&$e!==ht.index&&me.setActiveIndex(ht.index),onPointerDown:()=>me.setActiveIndex(ht.index),onClick:ta=>ct(ta,mt)},Mn=ht.index===$e,Fn={id:(0,Gs.getListboxItemId)(ht.index),role:"option","aria-selected":Mn,style:{position:"absolute",top:0,left:0,width:"100%",transform:`translateY(${ht.start}px)`},...Cn},Wn=o.cloneElement(F.onRender({item:mt,active:Mn}),{ref:ht.measureRef});return Vt?(0,M.jsx)("a",{href:typeof Vt=="function"?Vt(Ae):Vt,target:gt,ref:Mn?V:null,...Fn,children:Wn},ht.index):(0,M.jsx)("div",{ref:Mn?V:null,...Fn,children:Wn},ht.index)})})})},vc=o.forwardRef(({action:F,active:V,currentRootActionId:k},oe)=>{const ve=o.useMemo(()=>{if(!k)return F.ancestors;const $e=F.ancestors.findIndex(tt=>tt.id===k);return F.ancestors.slice($e+1)},[F.ancestors,k]),me=(0,xe.of)(fh);let Ae=F.name;const We=$e=>!!($e.command?.perform||$e.url);return F.children.length&&!We(F)&&!Ae.endsWith("...")&&(Ae+="..."),(0,M.jsx)("div",{ref:oe,className:(0,ze.cx)(me.row,V&&me.activeRow),children:(0,M.jsxs)("div",{className:me.actionContainer,children:[F.icon,(0,M.jsxs)("div",{className:me.textContainer,children:[ve.map($e=>(0,M.jsx)(o.Fragment,{children:!We($e)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("span",{className:me.breadcrumbAncestor,children:$e.name}),(0,M.jsx)("span",{className:me.breadcrumbSeparator,children:"\u203A"})]})},$e.id)),(0,M.jsx)("span",{children:Ae})]}),F.subtitle&&(0,M.jsx)("span",{className:me.subtitleText,children:F.subtitle})]})})});vc.displayName="ResultItem";const fh=F=>({row:(0,ze.css)({padding:F.spacing(1,2),display:"flex",alightItems:"center",justifyContent:"space-between",cursor:"pointer",position:"relative",borderRadius:F.shape.radius.default,margin:F.spacing(0,1)}),activeRow:(0,ze.css)({color:F.colors.text.maxContrast,background:F.colors.emphasize(F.colors.background.primary,.03),"&:before":{display:"block",content:'" "',position:"absolute",left:0,top:0,bottom:0,width:F.spacing(.5),borderRadius:F.shape.radius.default,backgroundImage:F.colors.gradients.brandVertical}}),actionContainer:(0,ze.css)({display:"flex",gap:F.spacing(1),alignItems:"baseline",fontSize:F.typography.fontSize,width:"100%"}),textContainer:(0,ze.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}),breadcrumbAncestor:(0,ze.css)({color:F.colors.text.secondary}),breadcrumbSeparator:(0,ze.css)({color:F.colors.text.secondary,marginLeft:F.spacing(1),marginRight:F.spacing(1)}),subtitleText:(0,ze.css)({...F.typography.bodySmall,color:F.colors.text.secondary,display:"block",flexBasis:"20%",flexGrow:1,flexShrink:0,maxWidth:"fit-content",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"})});var gh=e(76459),ph=e.n(gh),mh=e(62301),yc=e(65812);const vh=6,yh=5,xh=4,fl=3,Eh=2,Ph=1,Dh=100,xc=5,Ch=ph()(Th,200);async function bh(){if(!mn.TP.user.isSignedIn)return[];const F=(await mh.A.getDashboardOpened()).slice(0,xc),k=(await(0,yc.getGrafanaSearcher)().search({kind:["dashboard"],limit:xc,uid:F})).view.toArray();return k.sort((ve,me)=>{const Ae=F.indexOf(ve.uid),We=F.indexOf(me.uid);return Ae-We}),k.map(ve=>{const{url:me,name:Ae}=ve;return{id:`recent-dashboards${me}`,name:`${Ae}`,section:(0,vs.t)("command-palette.section.recent-dashboards","Recent dashboards"),priority:vh,url:me}})}async function Th(F){if(F.length===0||!mn.TP.user.isSignedIn&&!G.$.bootData.settings.anonymousEnabled)return[];const V=await(0,yc.getGrafanaSearcher)().search({kind:["dashboard","folder"],query:F,limit:Dh});return V.view.map(oe=>{const{url:ve,name:me,kind:Ae,location:We}=oe;return{id:`go/${Ae}${ve}`,name:`${me}`,section:Ae==="dashboard"?(0,vs.t)("command-palette.section.dashboard-search-results","Dashboards"):(0,vs.t)("command-palette.section.folder-search-results","Folders"),priority:Ph,url:ve,subtitle:V.view.dataFrame.meta?.custom?.locationInfo[We]?.name}})}function Mh(F,V){const[k,oe]=(0,o.useState)([]),[ve,me]=(0,o.useState)(!1),Ae=(0,o.useRef)(0);return(0,o.useEffect)(()=>{const We=Date.now();V&&F.length>0?(me(!0),Ch(F).then($e=>{We>Ae.current&&(oe($e),me(!1),Ae.current=We)})):(oe([]),me(!1),Ae.current=We)},[V,F]),{searchResults:k,isFetchingSearchResults:ve}}var Ui=e(2769);function Ec(F){return"navModel."+F.id}function Pc(F,V=[]){const k=[];for(let oe of F){oe.id==="help"&&(oe=(0,ci.CS)({...oe}),delete oe.url);const{url:ve,target:me,text:Ae,isCreateAction:We,children:$e,onClick:tt,keywords:at}=oe,ct=!!$e?.length;if(!(ve||tt||ct))continue;let Et=ve;ve&&(oe.id==="connections-add-new-connection"||oe.id==="standalone-plugin-page-/connections/add-new-connection")&&(Et=Cn=>{const Mn=at?.find(Fn=>Fn.toLowerCase().includes(Cn.toLowerCase()));return Mn?`${ve}?search=${Mn}`:ve});const ht=We?(0,vs.t)("command-palette.section.actions","Actions"):(0,vs.t)("command-palette.section.pages","Pages"),mt=We?yh:xh,gt=V.map(Cn=>Cn.text).join(" > "),Vt={id:Ec(oe),name:Ae,section:ht,url:Et,target:me,parent:V.length>0&&!We?Ec(V[V.length-1]):void 0,perform:tt,keywords:at?.join(" "),priority:mt,subtitle:We?void 0:gt};if(k.push(Vt),$e?.length){const Cn=Pc($e,[...V,oe]);k.push(...Cn)}}return k}const Sh=(F,V)=>{const k=[{id:"preferences/theme",name:(0,vs.t)("command-palette.action.change-theme","Change theme..."),keywords:"interface color dark light",section:(0,vs.t)("command-palette.section.preferences","Preferences"),priority:fl},{id:"preferences/dark-theme",name:(0,vs.t)("command-palette.action.dark-theme","Dark"),keywords:"dark theme",perform:()=>(0,Ui.K)("dark"),parent:"preferences/theme",priority:fl},{id:"preferences/light-theme",name:(0,vs.t)("command-palette.action.light-theme","Light"),keywords:"light theme",perform:()=>(0,Ui.K)("light"),parent:"preferences/theme",priority:fl}],oe=Pc(F);return[...k,...V,...oe]};var io=e(74135);const Oh={};function Ah(){const{links:F}=(0,O.U)({extensionPointId:io.S.CommandPalette,context:Oh,limitPerPlugin:3});return(0,o.useMemo)(()=>F.map(V=>({section:V.category??"Extensions",priority:Eh,id:V.id,name:V.title,target:V.path,perform:()=>V.onClick&&V.onClick()})),[F])}function Ih(F){const[V,k]=(0,o.useState)([]),[oe,ve]=(0,o.useState)([]),me=Ah(),Ae=(0,Gt.useSelector)(We=>We.navBarTree);return(0,o.useEffect)(()=>{const We=Sh(Ae,me);k(We)},[Ae,me]),(0,o.useEffect)(()=>{F||bh().then(We=>ve(We)).catch(We=>{console.error("Error loading recent dashboard actions",We)})},[F]),F?V:[...oe,...V]}var Rh=e(53076);const Dc={name:"none",priority:Gs.Priority.NORMAL};function gl(F,V){return V.priority-F.priority}function Lh(){const{search:F,actions:V,rootActionId:k}=(0,Gs.useKBar)(at=>({search:at.searchQuery,actions:at.actions,rootActionId:at.currentRootActionId})),oe=o.useMemo(()=>Object.keys(V).reduce((at,ct)=>{const Et=V[ct];if(!Et.parent&&!k&&at.push(Et),Et.id===k)for(let ht=0;ht<Et.children.length;ht++)at.push(Et.children[ht]);return at},[]).sort(gl),[V,k]),ve=o.useCallback(at=>{let ct=[];for(let Et=0;Et<at.length;Et++)ct.push(at[Et]);return function Et(ht,mt=ct){for(let gt=0;gt<ht.length;gt++)if(ht[gt].children.length>0){let Vt=ht[gt].children;for(let Cn=0;Cn<Vt.length;Cn++)mt.push(Vt[Cn]);Et(ht[gt].children,mt)}return mt}(at)},[]),me=!F,Ae=o.useMemo(()=>me?oe:ve(oe),[ve,oe,me]),We=jh(Ae,F),$e=o.useMemo(()=>{let at={},ct=[],Et=[];for(let mt=0;mt<We.length;mt++){const gt=We[mt],Vt=gt.action,Cn=gt.score||Gs.Priority.NORMAL,Mn={name:typeof Vt.section=="string"?Vt.section:Vt.section?.name||Dc.name,priority:typeof Vt.section=="string"?Cn:Vt.section?.priority||0+Cn};at[Mn.name]||(at[Mn.name]=[],ct.push(Mn)),at[Mn.name].push({priority:Vt.priority+Cn,action:Vt})}Et=ct.sort(gl).map(mt=>({name:mt.name,actions:at[mt.name].sort(gl).map(gt=>gt.action)}));let ht=[];for(let mt=0;mt<Et.length;mt++){let gt=Et[mt];gt.name!==Dc.name&&ht.push(gt.name);for(let Vt=0;Vt<gt.actions.length;Vt++)ht.push(gt.actions[Vt])}return ht},[We]),tt=o.useMemo(()=>k,[$e]);return o.useMemo(()=>({results:$e,rootActionId:tt}),[tt,$e])}function jh(F,V){const k=Uh(),oe=o.useMemo(()=>({filtered:F,search:V}),[F,V]),{filtered:ve,search:me}=(0,mc.useThrottledValue)(oe);return o.useMemo(()=>{if(me.trim()==="")return ve.map($e=>({score:0,action:$e}));const Ae=ve.map(({name:$e,keywords:tt})=>`${$e} ${tt??""}`.toLowerCase()),We=[];if(me.length>Bh){const $e=me.toLowerCase();for(let tt=0;tt<Ae.length;tt++){const ct=Ae[tt].indexOf($e);if(ct>-1){const Et=ct*-1,ht=ve[tt];We.push({score:Et,action:ht})}}}else{const $e=k.split(me).length,tt=1/0,at=$e<5?4:0,[,ct,Et]=k.search(Ae,me,at,tt);if(ct&&Et)for(let ht=0;ht<Et.length;ht++){const mt=Et[ht],gt=Et.length-ht,Vt=ve[ct.idx[mt]];We.push({score:gt,action:Vt})}}return We},[ve,me,k])}const Bh=25;function Uh(){const F=o.useRef();return F.current||(F.current=new Rh.A({intraMode:0,intraIns:0})),F.current}function Nh(){const F=(0,xe.of)(Cc),{query:V,showing:k,searchQuery:oe}=(0,Gs.useKBar)(at=>({showing:at.visualState===Gs.VisualState.showing,searchQuery:at.searchQuery})),ve=Ih(oe);(0,Gs.useRegisterActions)(ve,[ve]);const{searchResults:me,isFetchingSearchResults:Ae}=Mh(oe,k),We=(0,o.useRef)(null),{overlayProps:$e}=(0,pc.e)({isOpen:k,onClose:()=>V.setVisualState(Gs.VisualState.animatingOut)},We),{dialogProps:tt}=(0,fc.s)({},We);return(0,o.useEffect)(()=>{k&&(0,da.rR)("command_palette_opened")},[k]),ve.length>0?(0,M.jsx)(Gs.KBarPortal,{children:(0,M.jsx)(Gs.KBarPositioner,{className:F.positioner,children:(0,M.jsx)(Gs.KBarAnimator,{className:F.animator,children:(0,M.jsx)(gc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,M.jsxs)("div",{...$e,...tt,children:[(0,M.jsxs)("div",{className:F.searchContainer,children:[(0,M.jsx)(Rs.I,{name:"search",size:"md"}),(0,M.jsx)(Gs.KBarSearch,{defaultPlaceholder:(0,vs.t)("command-palette.search-box.placeholder","Search or jump to..."),className:F.search}),(0,M.jsx)("div",{className:F.loadingBarContainer,children:Ae&&(0,M.jsx)(dh.G,{width:500,delay:0})})]}),(0,M.jsx)("div",{className:F.resultsContainer,children:(0,M.jsx)(Wh,{isFetchingSearchResults:Ae,searchResults:me})})]})})})})}):null}const Wh=({isFetchingSearchResults:F,searchResults:V})=>{const{results:k,rootActionId:oe}=Lh(),ve=(0,xe.of)(Cc),me=(0,vs.t)("command-palette.section.dashboard-search-results","Dashboards"),Ae=(0,vs.t)("command-palette.section.folder-search-results","Folders"),We=(0,o.useMemo)(()=>V.filter(ct=>ct.id.startsWith("go/dashboard")).map(ct=>new Gs.ActionImpl(ct,{store:{}})),[V]),$e=(0,o.useMemo)(()=>V.filter(ct=>ct.id.startsWith("go/folder")).map(ct=>new Gs.ActionImpl(ct,{store:{}})),[V]),tt=(0,o.useMemo)(()=>{const ct=[...k];return $e.length>0&&(ct.push(Ae),ct.push(...$e)),We.length>0&&(ct.push(me),ct.push(...We)),ct},[k,me,We,Ae,$e]);return!F&&tt.length===0?(0,M.jsx)(ac.p,{variant:"not-found",role:"alert",message:(0,vs.t)("command-palette.empty-state.message","No results found")}):(0,M.jsx)(hh,{items:tt,maxHeight:650,onRender:({item:ct,active:Et})=>{const ht=tt[0]===ct;return typeof ct=="string"?(0,M.jsx)("div",{className:(0,ze.cx)(ve.sectionHeader,ht&&ve.sectionHeaderFirst),children:ct}):(0,M.jsx)(vc,{action:ct,active:Et,currentRootActionId:oe})}})},Cc=F=>({positioner:(0,ze.css)({zIndex:F.zIndex.portal,marginTop:"0px",paddingTop:"4px !important","&::before":{content:'""',position:"fixed",top:0,right:0,bottom:0,left:0,background:F.components.overlay.background,backdropFilter:"blur(1px)"}}),animator:(0,ze.css)({maxWidth:F.breakpoints.values.md,width:"100%",background:F.colors.background.primary,color:F.colors.text.primary,borderRadius:F.shape.radius.default,border:`1px solid ${F.colors.border.weak}`,overflow:"hidden",boxShadow:F.shadows.z3}),loadingBarContainer:(0,ze.css)({position:"absolute",left:0,right:0,bottom:0}),searchContainer:(0,ze.css)({alignItems:"center",background:F.components.input.background,borderBottom:`1px solid ${F.colors.border.weak}`,display:"flex",gap:F.spacing(1),padding:F.spacing(1,2),position:"relative"}),search:(0,ze.css)({fontSize:F.typography.fontSize,width:"100%",boxSizing:"border-box",outline:"none",border:"none",color:F.components.input.text}),spinner:(0,ze.css)({height:"22px"}),resultsContainer:(0,ze.css)({paddingBottom:F.spacing(1)}),sectionHeader:(0,ze.css)({padding:F.spacing(1.5,2,2,2),fontSize:F.typography.bodySmall.fontSize,fontWeight:F.typography.fontWeightMedium,color:F.colors.text.secondary,borderTop:`1px solid ${F.colors.border.weak}`,marginTop:F.spacing(1)}),sectionHeaderFirst:(0,ze.css)({paddingBottom:F.spacing(1),borderTop:"none",marginTop:0})});var Ni=e(53001),Fh=e(59875),bc=e(86634),nr=e(32209),Wi=e(13390),Ua=e(27746),Fi=e(28215);function Kh({href:F,isCurrent:V,text:k,index:oe,flexGrow:ve}){const me=(0,xe.of)(wh),Ae=()=>{(0,da.rR)("grafana_breadcrumb_clicked",{url:F})};return(0,M.jsx)("li",{className:me.breadcrumbWrapper,style:{flexGrow:ve},children:V?(0,M.jsx)("span",{"data-testid":Wi.X.Breadcrumbs.breadcrumb(k),className:me.breadcrumb,"aria-current":"page",title:k,children:k}):(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("a",{onClick:Ae,"data-testid":Wi.X.Breadcrumbs.breadcrumb(k),className:(0,ze.cx)(me.breadcrumb,me.breadcrumbLink),title:k,href:F,children:k}),(0,M.jsx)("div",{className:me.separator,"aria-hidden":!0,children:(0,M.jsx)(Rs.I,{name:"angle-right"})})]})})}const wh=F=>({breadcrumb:(0,ze.css)({display:"block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",color:F.colors.text.secondary}),breadcrumbLink:(0,ze.css)({color:F.colors.text.primary,"&:hover":{textDecoration:"underline"}}),breadcrumbWrapper:(0,ze.css)({alignItems:"center",color:F.colors.text.primary,display:"flex",flex:1,gap:F.spacing(.5),minWidth:0,maxWidth:"max-content",padding:F.spacing(.5,0,.5,.5),[F.breakpoints.down("sm")]:{display:"none","&:nth-last-child(2)":{display:"flex",minWidth:"40px"},"&:last-child":{display:"flex"}}}),separator:(0,ze.css)({color:F.colors.text.secondary})});function Tc({breadcrumbs:F,className:V}){const k=(0,xe.of)(Vh);return(0,M.jsx)("nav",{"aria-label":"Breadcrumbs",className:V,children:(0,M.jsx)("ol",{className:k.breadcrumbs,children:F.map((oe,ve)=>(0,o.createElement)(Kh,{...oe,isCurrent:ve===F.length-1,key:ve,index:ve,flexGrow:$h(ve,F.length)}))})})}function $h(F,V){return V<5&&F>0&&F<V-2||V>6&&F>1&&F<V-3?4:10}const Vh=F=>({breadcrumbs:(0,ze.css)({display:"flex",alignItems:"center",flexWrap:"nowrap",overflow:"hidden"})});var Mc=e(3984),ga=e(57571),Sc=e(10804);const Oc="mega-menu-toggle";function zh({actions:F,searchBarHidden:V,sectionNav:k,pageNav:oe,onToggleMegaMenu:ve,onToggleSearchBar:me,onToggleKioskMode:Ae}){const{chrome:We}=(0,Qa.Il)(),$e=We.useState(),tt=(0,Gt.useSelector)(Et=>Et.navIndex)[Fi.Id],at=(0,xe.of)(Hh),ct=(0,Mc.Z)(k,oe,tt);return(0,M.jsxs)("div",{"data-testid":Wi.X.NavToolbar.container,className:at.pageToolbar,children:[(0,M.jsx)("div",{className:at.menuButton,children:(0,M.jsx)(va.K,{id:Oc,name:"bars",tooltip:$e.megaMenuOpen?(0,vs.t)("navigation.toolbar.close-menu","Close menu"):(0,vs.t)("navigation.toolbar.open-menu","Open menu"),tooltipPlacement:"bottom",size:"xl",onClick:ve,"data-testid":Wi.X.NavBar.Toggle.button})}),(0,M.jsx)(Tc,{breadcrumbs:ct,className:at.breadcrumbsWrapper}),(0,M.jsxs)("div",{className:at.actions,children:[F,V&&(0,M.jsx)(Ua.I,{onClick:Ae,narrow:!0,title:(0,vs.t)("navigation.toolbar.enable-kiosk","Enable kiosk mode"),icon:"monitor"}),F&&(0,M.jsx)(Sc.K,{}),(0,M.jsx)(Ua.I,{onClick:me,narrow:!0,title:(0,vs.t)("navigation.toolbar.toggle-search-bar","Toggle top search bar"),children:(0,M.jsx)(Rs.I,{name:V?"angle-down":"angle-up",size:"xl"})})]})]})}const Hh=F=>({breadcrumbsWrapper:(0,ze.css)({display:"flex",overflow:"hidden",[F.breakpoints.down("sm")]:{minWidth:"50%"}}),pageToolbar:(0,ze.css)({height:ga.l,display:"flex",padding:F.spacing(0,1,0,2),alignItems:"center",borderBottom:`1px solid ${F.colors.border.weak}`}),menuButton:(0,ze.css)({display:"flex",alignItems:"center",marginRight:F.spacing(1)}),actions:(0,ze.css)({label:"NavToolbar-actions",display:"flex",alignItems:"center",flexWrap:"nowrap",justifyContent:"flex-end",paddingLeft:F.spacing(1),flexGrow:1,gap:F.spacing(1),minWidth:0,".body-drawer-open &":{display:"none"}})});function Gh({}){const F=(0,xe.$j)(),{chrome:V}=(0,Qa.Il)(),k=V.useState(),oe=k.searchBarHidden||k.kioskMode===Gt.KioskMode.TV,ve=(0,o.useRef)(null),me=(0,o.useRef)(null),Ae=F.transitions.duration.shortest,We=(0,xe.of)(kh,Ae),$e=k.megaMenuOpen&&!k.megaMenuDocked,tt=()=>V.setMegaMenuOpen(!1),{overlayProps:at,underlayProps:ct}=(0,pc.e)({isDismissable:!0,isOpen:!0,onClose:tt,shouldCloseOnInteractOutside:mt=>!document.getElementById(Oc)?.contains(mt)},ve),{dialogProps:Et}=(0,fc.s)({},ve),ht=(0,xe.of)(Qh,oe);return(0,M.jsx)("div",{className:ht.wrapper,children:(0,M.jsxs)(Fh.Sf,{children:[(0,M.jsx)(bc.A,{nodeRef:ve,in:$e,unmountOnExit:!0,classNames:We.overlay,timeout:{enter:Ae,exit:0},children:(0,M.jsx)(gc.n1,{contain:!0,autoFocus:!0,restoreFocus:!0,children:(0,M.jsx)(nr.A,{className:ht.menu,onClose:tt,ref:ve,...at,...Et})})}),(0,M.jsx)(bc.A,{nodeRef:me,in:$e,unmountOnExit:!0,classNames:We.backdrop,timeout:{enter:Ae,exit:0},children:(0,M.jsx)("div",{ref:me,className:ht.backdrop,...ct})})]})})}const Qh=(F,V)=>{let k=V?ga.l:ga.l*2;return G.$.featureToggles.singleTopNav&&(k=0),{backdrop:(0,ze.css)({backdropFilter:"blur(1px)",backgroundColor:F.components.overlay.background,bottom:0,left:0,position:"fixed",right:0,top:V||G.$.featureToggles.singleTopNav?0:ga.l,zIndex:F.zIndex.modalBackdrop,[F.breakpoints.up("md")]:{top:k}}),menu:(0,ze.css)({display:"flex",bottom:0,flexDirection:"column",left:0,right:0,zIndex:F.zIndex.modal,position:"fixed",top:V||G.$.featureToggles.singleTopNav?0:ga.l,backgroundColor:F.colors.background.primary,flex:"1 1 0",[F.breakpoints.up("md")]:{right:"unset",top:k}}),wrapper:(0,ze.css)({position:"fixed",display:"grid",gridAutoFlow:"column",height:"100%",zIndex:F.zIndex.sidemenu})}},kh=(F,V)=>{const k={[F.transitions.handleMotion("no-preference")]:{transitionDuration:`${V}ms`,transitionTimingFunction:F.transitions.easing.easeInOut},[F.breakpoints.down("md")]:{overflow:"hidden"}},oe={...k,transitionProperty:"box-shadow, width",".scrollbar-view":{overflow:"hidden !important"}},ve={...k,transitionProperty:"opacity"},me={width:"100%",[F.breakpoints.up("md")]:{borderRight:`1px solid ${F.colors.border.weak}`,boxShadow:F.shadows.z3,width:nr.J}},Ae={boxShadow:"none",width:0},We={opacity:1},$e={opacity:0};return{backdrop:{enter:(0,ze.css)($e),enterActive:(0,ze.css)(ve,We),enterDone:(0,ze.css)(We)},overlay:{enter:(0,ze.css)(Ae),enterActive:(0,ze.css)(oe,me),enterDone:(0,ze.css)(me)}}};var _h=e(49426),ea=e(28138);function Yh(F,V){if(F===V)return!0;if(!(F instanceof Object)||!(V instanceof Object))return!1;const k=Object.keys(F),oe=k.length;for(let ve=0;ve<oe;ve++)if(!(k[ve]in V))return!1;for(let ve=0;ve<oe;ve++)if(F[k[ve]]!==V[k[ve]])return!1;return oe===Object.keys(V).length}const pl="grafana.navigation.docked",ml="grafana.navigation.open";class Jh{constructor(){this.searchBarStorageKey="SearchBar_Hidden",this.routeChangeHandled=!0,this.megaMenuDocked=!!(window.innerWidth>=G.$.theme2.breakpoints.values.xl&&xr.A.getBool(pl,window.innerWidth>=G.$.theme2.breakpoints.values.xxl)),this.sessionStorageData=window.sessionStorage.getItem("returnToPrevious"),this.returnToPreviousData=this.sessionStorageData?JSON.parse(this.sessionStorageData):void 0,this.state=new _h.t({chromeless:!0,sectionNav:{node:{text:(0,vs.t)("nav.home.title","Home")},main:{text:""}},searchBarHidden:xr.A.getBool(this.searchBarStorageKey,!1),megaMenuOpen:this.megaMenuDocked&&xr.A.getBool(ml,!0),megaMenuDocked:this.megaMenuDocked,kioskMode:null,layout:ul.k.Canvas,returnToPrevious:this.returnToPreviousData}),this.setReturnToPrevious=V=>{const k=this.state.getValue().returnToPrevious;(0,da.rR)("grafana_return_to_previous_button_created",{page:V.href,previousPage:k?.href}),this.update({returnToPrevious:V}),window.sessionStorage.setItem("returnToPrevious",JSON.stringify(V))},this.clearReturnToPrevious=V=>{const k=this.state.getValue().returnToPrevious;k&&(0,da.rR)("grafana_return_to_previous_button_dismissed",{action:V,page:k.href}),this.update({returnToPrevious:void 0}),window.sessionStorage.removeItem("returnToPrevious")},this.setMegaMenuOpen=V=>{const{megaMenuDocked:k}=this.state.getValue();k&&xr.A.set(ml,V),(0,da.rR)("grafana_mega_menu_open",{state:V}),this.update({megaMenuOpen:V})},this.setMegaMenuDocked=(V,k=!0)=>{k&&xr.A.set(pl,V),(0,da.rR)("grafana_mega_menu_docked",{state:V}),this.update({megaMenuDocked:V})},this.onToggleSearchBar=()=>{const{searchBarHidden:V,kioskMode:k}=this.state.getValue(),oe=!V;xr.A.set(this.searchBarStorageKey,oe),k&&D.Ny.partial({kiosk:null}),this.update({searchBarHidden:oe,kioskMode:null})},this.onToggleKioskMode=()=>{const V=this.getNextKioskMode();this.update({kioskMode:V}),D.Ny.partial({kiosk:this.getKioskUrlValue(V)})}}setMatchedRoute(V){this.currentRoute!==V&&(this.currentRoute=V,this.routeChangeHandled=!1)}update(V){const k=this.state.getValue(),oe={...k};this.routeChangeHandled||(oe.actions=void 0,oe.pageNav=void 0,oe.sectionNav={node:{text:(0,vs.t)("nav.home.title","Home")},main:{text:""}},oe.chromeless=this.currentRoute?.chromeless,oe.layout=ul.k.Standard,this.routeChangeHandled=!0),Object.assign(oe,V),oe.chromeless=oe.kioskMode===Gt.KioskMode.Full||this.currentRoute?.chromeless,this.ignoreStateUpdate(oe,k)||this.state.next(oe)}ignoreStateUpdate(V,k){return!!(Yh(V,k)||(V.sectionNav!==k.sectionNav||V.pageNav!==k.pageNav)&&V.actions===k.actions&&V.layout===k.layout&&vl(V.sectionNav.node,k.sectionNav.node)&&vl(V.pageNav,k.pageNav))}useState(){return(0,Wr.A)(this.state,this.state.getValue())}exitKioskMode(){this.update({kioskMode:void 0}),D.Ny.partial({kiosk:null})}setKioskModeFromUrl(V){let k;switch(V){case"tv":k=Gt.KioskMode.TV;break;case"1":case!0:k=Gt.KioskMode.Full}k&&k!==this.state.getValue().kioskMode&&this.update({kioskMode:k})}getKioskUrlValue(V){switch(V){case Gt.KioskMode.TV:return"tv";case Gt.KioskMode.Full:return!0;default:return null}}getNextKioskMode(){const{kioskMode:V,searchBarHidden:k}=this.state.getValue();return k||V===Gt.KioskMode.TV||G.$.featureToggles.singleTopNav?(ea.A.emit(Nr.r1.alertInfo,[(0,vs.t)("navigation.kiosk.tv-alert","Press ESC to exit kiosk mode")]),Gt.KioskMode.Full):V?null:Gt.KioskMode.TV}}function vl(F,V){if(F===V)return!0;const k=F?.children?.find(ve=>ve.active),oe=V?.children?.find(ve=>ve.active);return F?.text===V?.text&&F?.url===V?.url&&k?.url===oe?.url&&vl(F?.parentItem,V?.parentItem)}var Xh=e(19727);const Ac=({label:F,onClick:V,onDismiss:k})=>{const oe=(0,xe.of)(Zh);return(0,M.jsxs)(Xh.e,{className:oe.buttonGroup,children:[(0,M.jsx)(se.$n,{icon:"angle-left",size:"sm",variant:"primary",fill:"outline",onClick:V,title:F,className:oe.mainDismissableButton,"data-testid":ra.Tp.components.ReturnToPrevious.backButton,children:F}),(0,M.jsx)(se.$n,{icon:"times","aria-label":(0,vs.t)("return-to-previous.dismissable-button","Close"),variant:"primary",fill:"outline",size:"sm",onClick:k,"data-testid":ra.Tp.components.ReturnToPrevious.dismissButton})]})},Zh=F=>({mainDismissableButton:(0,ze.css)({width:"100%","> span":{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"270px",display:"inline-block"}}),buttonGroup:(0,ze.css)({width:"fit-content",backgroundColor:F.colors.background.secondary})});Ac.displayName="DismissableButton";const Ic=({href:F,title:V})=>{const k=(0,xe.of)(qh),{chrome:oe}=(0,Qa.Il)(),ve=(0,o.useCallback)(()=>{D.Ny.push(F),oe.clearReturnToPrevious("clicked")},[F,oe]),me=(0,o.useCallback)(()=>{oe.clearReturnToPrevious("dismissed")},[oe]);return(0,M.jsx)("div",{className:k.returnToPrevious,"data-testid":ra.Tp.components.ReturnToPrevious.buttonGroup,children:(0,M.jsx)(Ac,{label:(0,vs.t)("return-to-previous.button.label","Back to {{title}}",{title:V}),onClick:ve,onDismiss:me})})},qh=F=>({returnToPrevious:(0,ze.css)({label:"return-to-previous",display:"flex",justifyContent:"center",left:"50%",transform:"translateX(-50%)",zIndex:F.zIndex.tooltip,position:"fixed",bottom:F.spacing.x4,boxShadow:F.shadows.z3})});Ic.displayName="ReturnToPrevious";var Rc=e(19361),ef=e(42941),tf=e(62372),nf=e(49185),lo=e(69386),sf=e(4172);function af({feedUrl:F}){const V=(0,xe.of)(rf),{state:k,getNews:oe}=(0,sf.n)(F),[ve,me]=(0,nf.A)();return(0,o.useEffect)(()=>{oe()},[oe]),k.error?(0,M.jsx)("div",{className:V.innerWrapper,children:k.error&&k.error.message}):(0,M.jsxs)("div",{ref:ve,children:[k.loading?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(lo.K.Skeleton,{showImage:!0,width:me.width}),(0,M.jsx)(lo.K.Skeleton,{showImage:!0,width:me.width}),(0,M.jsx)(lo.K.Skeleton,{showImage:!0,width:me.width}),(0,M.jsx)(lo.K.Skeleton,{showImage:!0,width:me.width}),(0,M.jsx)(lo.K.Skeleton,{showImage:!0,width:me.width})]}):(0,M.jsx)(M.Fragment,{children:me.width>0&&k.value?.map((Ae,We)=>(0,M.jsx)(lo.K,{index:We,showImage:!0,width:me.width,data:k.value},We))}),(0,M.jsx)("div",{className:V.grot,children:(0,M.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",children:(0,M.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})})})]})}const rf=F=>({innerWrapper:(0,ze.css)({width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}),grot:(0,ze.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(5,0),img:{width:"186px",height:"186px"}})});function Lc({className:F}){const[V,k]=(0,ef.A)(!1),oe=(0,xe.of)(of);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Ua.I,{className:F,onClick:k,iconOnly:!0,icon:"rss","aria-label":"News"}),V&&(0,M.jsx)(Hl._,{title:(0,M.jsxs)("div",{className:oe.title,children:[(0,M.jsx)(Vs.E,{element:"h2",children:(0,vs.t)("news.title","Latest from the blog")}),(0,M.jsx)("a",{href:"https://grafana.com/blog/",target:"_blank",rel:"noreferrer",title:"Go to Grafana labs blog",className:oe.grot,children:(0,M.jsx)("img",{src:"public/img/grot-news.svg",alt:"Grot reading news"})}),(0,M.jsx)("div",{className:oe.actions,children:(0,M.jsx)(va.K,{name:"times",variant:"secondary",onClick:k,"data-testid":ra.Tp.components.Drawer.General.close,tooltip:(0,vs.t)("news.drawer.close","Close Drawer")})})]}),onClose:k,size:"md",children:(0,M.jsx)(af,{feedUrl:tf.$})})]})}const of=F=>({title:(0,ze.css)({display:"flex",alignItems:"center",justifyContent:"center",gap:F.spacing(2),borderBottom:`1px solid ${F.colors.border.weak}`}),grot:(0,ze.css)({display:"flex",alignItems:"center",justifyContent:"center",padding:F.spacing(2,0),img:{width:"75px",height:"75px"}}),actions:(0,ze.css)({position:"absolute",right:F.spacing(1),top:F.spacing(2)})});function jc(F){const V=[];for(const k of F)k.isCreateAction&&V.push(k),k.children&&V.push(...jc(k.children));return V}const Bc=({})=>{const F=(0,xe.of)(lf),V=(0,xe.$j)(),k=(0,Gt.useSelector)(Et=>Et.navBarTree),oe=V.breakpoints.values.sm,[ve,me]=(0,o.useState)(!1),[Ae,We]=(0,o.useState)(!window.matchMedia(`(min-width: ${oe}px)`).matches),$e=(0,o.useMemo)(()=>jc(k),[k]),tt=G.$.featureToggles.singleTopNav,at=$e.length>0&&(!tt||!Ae);(0,ji.Y)({breakpoint:oe,onChange:Et=>{We(!Et.matches)}});const ct=()=>(0,M.jsx)(ii.W,{children:$e.map((Et,ht)=>(0,M.jsx)(ii.W.Item,{url:Et.url,label:Et.text,onClick:()=>(0,da.rR)("grafana_menu_item_clicked",{url:Et.url,from:"quickadd"})},ht))});return at?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(oo.m,{overlay:ct,placement:"bottom-end",onVisibleChange:me,children:(0,M.jsx)(Ua.I,{iconOnly:!0,icon:Ae?"plus-circle":"plus",isOpen:Ae?void 0:ve,"aria-label":"New"})}),(0,M.jsx)(Sc.K,{className:F.separator})]}):null},lf=F=>({buttonContent:(0,ze.css)({alignItems:"center",display:"flex"}),buttonText:(0,ze.css)({[F.breakpoints.down("md")]:{display:"none"}}),separator:(0,ze.css)({[F.breakpoints.down("sm")]:{display:"none"}})});var yl=e(80997);function Uc(){const F=(0,Xs.zy)(),V=(0,xe.of)(cf);let k=yl.sQ.sanitizeUrl(v.I.getUrlForPartial(F,{forceLogin:"true"}));return k.startsWith("//")&&(k=k.replace(/\/+/g,"/")),(0,M.jsx)("a",{className:V.link,href:k,target:"_self",children:"Sign in"})}const cf=F=>({link:(0,ze.css)({paddingRight:F.spacing(1),whiteSpace:"nowrap","&:hover":{textDecoration:"underline"}})});var Nc=e(64539);function Ki({node:F}){const V=(0,xe.of)(df),k=(0,ci.J0)((0,l.cloneDeep)(F),!1);return k?(0,M.jsx)(ii.W,{header:(0,M.jsxs)("div",{onClick:oe=>oe.stopPropagation(),className:V.header,children:[(0,M.jsx)("div",{children:k.text}),k.subTitle&&(0,M.jsx)("div",{className:V.subTitle,children:k.subTitle})]}),children:k.children?.map(oe=>oe.url?(0,M.jsx)(Nc.D,{url:oe.url,label:oe.text,icon:oe.icon,target:oe.target},oe.id):(0,M.jsx)(Nc.D,{icon:oe.icon,onClick:oe.onClick,label:oe.text},oe.id))}):null}const df=F=>({header:(0,ze.css)({fontSize:F.typography.h5.fontSize,fontWeight:F.typography.h5.fontWeight,padding:F.spacing(.5,1),whiteSpace:"nowrap"}),subTitle:(0,ze.css)({color:F.colors.text.secondary,fontSize:F.typography.bodySmall.fontSize})});var uf=e(16797),hf=e(63917);function Wc(){const F=(0,xe.$j)(),V=G.$.featureToggles.singleTopNav,{query:k}=(0,Gs.useKBar)(We=>({kbarSearchQuery:We.searchQuery,kbarIsOpen:We.visualState===Gs.VisualState.showing})),oe=V?F.breakpoints.values.lg:F.breakpoints.values.sm,[ve,me]=(0,o.useState)(!window.matchMedia(`(min-width: ${oe}px)`).matches);(0,ji.Y)({breakpoint:oe,onChange:We=>{me(!We.matches)}});const Ae=()=>{k.toggle()};return ve?(0,M.jsx)(Ua.I,{iconOnly:!0,icon:"search","aria-label":(0,vs.t)("nav.search.placeholderCommandPalette","Search or jump to..."),onClick:Ae}):(0,M.jsx)(ff,{onClick:Ae})}function ff({onClick:F}){const V=(0,xe.of)(gf),k=(0,o.useMemo)(()=>(0,hf.gn)(),[]);return(0,M.jsx)("div",{className:V.wrapper,children:(0,M.jsxs)("div",{className:V.inputWrapper,children:[(0,M.jsx)("div",{className:V.prefix,children:(0,M.jsx)(Rs.I,{name:"search"})}),(0,M.jsx)("button",{className:V.fakeInput,onClick:F,children:(0,vs.t)("nav.search.placeholderCommandPalette","Search or jump to...")}),(0,M.jsxs)("div",{className:V.suffix,children:[(0,M.jsx)(Rs.I,{name:"keyboard"}),(0,M.jsxs)(Vs.E,{variant:"bodySmall",children:[k,"+k"]})]})]})})}const gf=F=>{const V=(0,Ie.n)({theme:F});return{wrapper:V.wrapper,inputWrapper:V.inputWrapper,prefix:V.prefix,suffix:(0,ze.css)([V.suffix,{display:"flex",gap:F.spacing(.5)}]),fakeInput:(0,ze.css)([V.input,{textAlign:"left",paddingLeft:28,color:F.colors.text.disabled,"&:focus":{outline:"unset",boxShadow:"unset"},"&:focus-visible":(0,ze.css)`
          ${(0,uf.focusCss)(F)}
        `}]),button:(0,ze.css)({width:"100%",textAlign:"center","> *":{width:"100%",textAlign:"center",justifyContent:"center",gap:"1ch"}})}},pf=(0,o.memo)(function({onToggleMegaMenu:V,onToggleKioskMode:k,pageNav:oe,sectionNav:ve}){const{chrome:me}=(0,Qa.Il)(),Ae=me.useState(),We=!Ae.chromeless&&Ae.megaMenuDocked&&Ae.megaMenuOpen,$e=(0,xe.of)(mf,We),tt=(0,Gt.useSelector)(gt=>gt.navIndex),at=(0,l.cloneDeep)(tt.help),ct=at?(0,ci.CS)(at):void 0,Et=tt.profile,ht=(0,Gt.useSelector)(gt=>gt.navIndex)[Fi.Id],mt=(0,Mc.Z)(ve,oe,ht);return(0,M.jsxs)("div",{className:$e.layout,children:[(0,M.jsxs)(fs.B,{minWidth:0,gap:.5,alignItems:"center",children:[!We&&(0,M.jsx)(Ua.I,{narrow:!0,onClick:V,tooltip:(0,vs.t)("navigation.megamenu.open","Open menu"),children:(0,M.jsxs)(fs.B,{gap:0,alignItems:"center",children:[(0,M.jsx)(Rc.M.MenuLogo,{className:$e.img}),(0,M.jsx)(Rs.I,{size:"sm",name:"angle-down"})]})}),(0,M.jsx)(Tc,{breadcrumbs:mt,className:$e.breadcrumbsWrapper})]}),(0,M.jsxs)(fs.B,{gap:.5,alignItems:"center",children:[(0,M.jsx)(Wc,{}),(0,M.jsx)(Bc,{}),ct&&(0,M.jsx)(oo.m,{overlay:()=>(0,M.jsx)(Ki,{node:ct}),placement:"bottom-end",children:(0,M.jsx)(Ua.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),H.$W.newsFeedEnabled&&(0,M.jsx)(Lc,{}),!_n.TP.user.isSignedIn&&(0,M.jsx)(Uc,{}),Et&&(0,M.jsx)(oo.m,{overlay:()=>(0,M.jsx)(Ki,{node:Et}),placement:"bottom-end",children:(0,M.jsx)(Ua.I,{className:$e.profileButton,imgSrc:_n.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})}),(0,M.jsx)(Ua.I,{className:$e.kioskToggle,onClick:k,narrow:!0,"aria-label":"Enable kiosk mode",children:(0,M.jsx)(Rs.I,{name:"angle-up",size:"xl"})})]})]})}),mf=(F,V)=>({layout:(0,ze.css)({height:ga.l,display:"flex",gap:F.spacing(2),alignItems:"center",padding:F.spacing(0,1),paddingLeft:V?F.spacing(3.5):F.spacing(.75),borderBottom:`1px solid ${F.colors.border.weak}`,justifyContent:"space-between",[F.breakpoints.up("lg")]:{gridTemplateColumns:"2fr minmax(440px, 1fr)",display:"grid",justifyContent:"flex-start"}}),breadcrumbsWrapper:(0,ze.css)({display:"flex",overflow:"hidden",[F.breakpoints.down("sm")]:{minWidth:"40%"}}),img:(0,ze.css)({alignSelf:"center",height:F.spacing(3),width:F.spacing(3)}),profileButton:(0,ze.css)({padding:F.spacing(0,.25),img:{borderRadius:F.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}}),kioskToggle:(0,ze.css)({[F.breakpoints.down("lg")]:{display:"none"}})});var vf=e(13884);function xl({children:F,align:V="left"}){const k=(0,xe.of)(yf),ve=(0,xe.$j)().breakpoints.values.sm,[me,Ae]=(0,o.useState)(!window.matchMedia(`(min-width: ${ve}px)`).matches);return(0,ji.Y)({breakpoint:ve,onChange:We=>{Ae(!We.matches)}}),me?(0,M.jsx)(M.Fragment,{children:F}):(0,M.jsx)("div",{"data-testid":"wrapper",className:(0,ze.cx)(k.wrapper,{[k[V]]:V==="right"}),children:F})}const yf=F=>({wrapper:(0,ze.css)({display:"flex",gap:F.spacing(.5),alignItems:"center"}),right:(0,ze.css)({justifyContent:"flex-end"}),left:(0,ze.css)({}),center:(0,ze.css)({})}),xf=(0,o.memo)(function(){const V=(0,xe.of)(Ef),k=(0,Gt.useSelector)($e=>$e.navIndex),oe=(0,Xs.zy)(),ve=(0,l.cloneDeep)(k.help),me=ve?(0,ci.CS)(ve):void 0,Ae=k.profile;let We=H.$W.appSubUrl||"/";return!H.$W.bootData.user.isSignedIn&&!H.$W.anonymousEnabled&&(We=yl.sQ.sanitizeUrl(v.I.getUrlForPartial(oe,{forceLogin:"true"}))),(0,M.jsxs)("div",{className:V.layout,children:[(0,M.jsxs)(xl,{children:[(0,M.jsx)("a",{className:V.logo,href:We,title:"Go to home",children:(0,M.jsx)(Rc.M.MenuLogo,{className:V.img})}),(0,M.jsx)(vf.N,{}),(0,M.jsx)(Ni.Dh,{})]}),(0,M.jsx)(xl,{children:(0,M.jsx)(Wc,{})}),(0,M.jsxs)(xl,{align:"right",children:[(0,M.jsx)(Bc,{}),me&&(0,M.jsx)(oo.m,{overlay:()=>(0,M.jsx)(Ki,{node:me}),placement:"bottom-end",children:(0,M.jsx)(Ua.I,{iconOnly:!0,icon:"question-circle","aria-label":"Help"})}),H.$W.newsFeedEnabled&&(0,M.jsx)(Lc,{}),!_n.TP.user.isSignedIn&&(0,M.jsx)(Uc,{}),Ae&&(0,M.jsx)(oo.m,{overlay:()=>(0,M.jsx)(Ki,{node:Ae}),placement:"bottom-end",children:(0,M.jsx)(Ua.I,{className:V.profileButton,imgSrc:_n.TP.user.gravatarUrl,imgAlt:"User avatar","aria-label":"Profile"})})]})]})}),Ef=F=>({layout:(0,ze.css)({height:ga.l,display:"flex",gap:F.spacing(1),alignItems:"center",padding:F.spacing(0,1,0,2),borderBottom:`1px solid ${F.colors.border.weak}`,justifyContent:"space-between",[F.breakpoints.up("sm")]:{gridTemplateColumns:"1.5fr minmax(240px, 1fr) 1.5fr",display:"grid",justifyContent:"flex-start"}}),img:(0,ze.css)({height:F.spacing(3),width:F.spacing(3)}),logo:(0,ze.css)({display:"flex"}),profileButton:(0,ze.css)({padding:F.spacing(0,.25),img:{borderRadius:F.shape.radius.circle,height:"24px",marginRight:0,width:"24px"}})});function Pf({children:F}){const{chrome:V}=(0,Qa.Il)(),k=V.useState(),oe=k.searchBarHidden||k.kioskMode===Gt.KioskMode.TV,ve=(0,xe.$j)(),me=(0,xe.of)(Df,oe),Ae=ve.breakpoints.values.xl,We=xr.A.getBool(pl,!0),$e=!k.chromeless&&k.megaMenuDocked&&k.megaMenuOpen,tt=(0,Ni.fX)(),at=!!(tt?.isEnabled&&tt?.isPanelOpened),ct=G.$.featureToggles.singleTopNav;(0,ji.Y)({breakpoint:Ae,onChange:Mn=>{We&&(V.setMegaMenuDocked(Mn.matches,!1),V.setMegaMenuOpen(Mn.matches?xr.A.getBool(ml,k.megaMenuOpen):!1))}});const Et=(0,ze.cx)({[me.content]:!0,[me.contentNoSearchBar]:oe,[me.contentChromeless]:k.chromeless}),ht=()=>{V.setMegaMenuOpen(!k.megaMenuOpen)},{pathname:mt,search:gt}=D.Ny.getLocation(),Vt=mt+gt,Cn=k.returnToPrevious&&Vt!==k.returnToPrevious.href;return(0,o.useEffect)(()=>{k.returnToPrevious&&Vt===k.returnToPrevious.href&&V.clearReturnToPrevious("auto_dismissed")},[V,Vt]),(0,o.useEffect)(()=>{const Mn=(0,D.SE)(gt);V.setKioskModeFromUrl(Mn.kiosk)},[V,gt]),(0,M.jsxs)("div",{className:ch()("main-view",{"main-view--search-bar-hidden":oe&&!k.chromeless,"main-view--chrome-hidden":k.chromeless}),children:[!k.chromeless&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(se.z9,{className:me.skipLink,href:"#pageContent",children:"Skip to main content"}),ct&&$e&&(0,M.jsx)(nr.A,{className:me.dockedMegaMenu,onClose:()=>V.setMegaMenuOpen(!1)}),(0,M.jsx)("header",{className:(0,ze.cx)(me.topNav,ct&&$e&&me.topNavMenuDocked),children:ct?(0,M.jsx)(pf,{sectionNav:k.sectionNav.node,pageNav:k.pageNav,onToggleMegaMenu:ht,onToggleKioskMode:V.onToggleKioskMode}):(0,M.jsxs)(M.Fragment,{children:[!oe&&(0,M.jsx)(xf,{}),(0,M.jsx)(zh,{searchBarHidden:oe,sectionNav:k.sectionNav.node,pageNav:k.pageNav,actions:k.actions,onToggleSearchBar:V.onToggleSearchBar,onToggleMegaMenu:ht,onToggleKioskMode:V.onToggleKioskMode})]})})]}),(0,M.jsx)("div",{className:Et,children:(0,M.jsxs)("div",{className:me.panes,children:[!ct&&$e&&(0,M.jsx)(nr.A,{className:me.dockedMegaMenu,onClose:()=>V.setMegaMenuOpen(!1)}),!k.chromeless&&(0,M.jsx)("div",{className:(0,ze.cx)(me.scopesDashboardsContainer,{[me.scopesDashboardsContainerDocked]:$e}),children:(0,M.jsx)(Ni.T3,{})}),(0,M.jsx)("main",{className:(0,ze.cx)(me.pageContainer,{[me.pageContainerMenuDocked]:$e||at,[me.pageContainerMenuDockedScopes]:$e&&at}),id:"pageContent",children:F})]})}),!k.chromeless&&!k.megaMenuDocked&&(0,M.jsx)(Gh,{}),!k.chromeless&&(0,M.jsx)(Nh,{}),Cn&&k.returnToPrevious&&(0,M.jsx)(Ic,{href:k.returnToPrevious.href,title:k.returnToPrevious.title})]})}const Df=(F,V)=>{const k=G.$.featureToggles.singleTopNav;return{content:(0,ze.css)({display:"flex",flexDirection:"column",paddingTop:k?ga.l:ga.l*2,flexGrow:1,height:"auto"}),contentNoSearchBar:(0,ze.css)({paddingTop:ga.l}),contentChromeless:(0,ze.css)({paddingTop:0}),dockedMegaMenu:(0,ze.css)({background:F.colors.background.primary,borderRight:`1px solid ${F.colors.border.weak}`,display:"none",width:nr.J,[F.breakpoints.up("xl")]:{display:"block"}},{position:"fixed",height:`calc(100% - ${V?ga.l:ga.l*2}px)`,zIndex:2},k&&{height:"100%",top:0}),scopesDashboardsContainer:(0,ze.css)({position:"fixed",height:`calc(100% - ${V||k?ga.l:ga.l*2}px)`,zIndex:1}),scopesDashboardsContainerDocked:(0,ze.css)({left:nr.J}),topNav:(0,ze.css)({display:"flex",position:"fixed",zIndex:F.zIndex.navbarFixed,left:0,right:0,background:F.colors.background.primary,flexDirection:"column"}),topNavMenuDocked:(0,ze.css)({left:nr.J}),panes:(0,ze.css)({display:"flex",flexDirection:"column",flexGrow:1,label:"page-panes"}),pageContainerMenuDocked:(0,ze.css)({paddingLeft:nr.J}),pageContainerMenuDockedScopes:(0,ze.css)({paddingLeft:`calc(${nr.J} * 2)`}),pageContainer:(0,ze.css)({label:"page-container",display:"flex",flexDirection:"column",flexGrow:1}),skipLink:(0,ze.css)({position:"fixed",top:-1e3,":focus":{left:F.spacing(1),top:F.spacing(1),zIndex:F.zIndex.portal}})}};var di=e(82467),Fc=e(16001),wi=e(3169),Cf=e(94701);function bf({appNotification:F,onClearNotification:V}){const k=(0,xe.of)(Tf);(0,Cf.A)(()=>{setTimeout(()=>{V(F.id)},Gt.timeoutMap[F.severity])});const oe=F.component||F.text||F.traceId;return(0,M.jsx)(aa.F,{severity:F.severity,title:F.title,onRemove:()=>V(F.id),elevated:!0,children:oe&&(0,M.jsxs)("div",{className:k.wrapper,children:[(0,M.jsx)("span",{children:F.component||F.text}),F.traceId&&(0,M.jsxs)("span",{className:k.trace,children:["Trace ID: ",F.traceId]})]})})}function Tf(F){return{wrapper:(0,ze.css)({display:"flex",flexDirection:"column"}),trace:(0,ze.css)({fontSize:F.typography.pxToRem(10)})}}function Mf(){const F=(0,Gt.useSelector)(ve=>(0,Fc.fX)(ve.appNotifications)),V=(0,Gt.useDispatch)(),k=(0,xe.of)(Sf);(0,o.useEffect)(()=>{ea.A.on(Nr.r1.alertWarning,ve=>V((0,di.dx)((0,wi.q8)(...ve)))),ea.A.on(Nr.r1.alertSuccess,ve=>V((0,di.dx)((0,wi.tZ)(...ve)))),ea.A.on(Nr.r1.alertError,ve=>V((0,di.dx)((0,wi.gi)(...ve)))),ea.A.on(Nr.r1.alertInfo,ve=>V((0,di.dx)((0,wi.Cf)(...ve))))},[V]);const oe=ve=>{V((0,di.Do)(ve))};return(0,M.jsx)("div",{className:k.wrapper,children:(0,M.jsx)(fs.B,{direction:"column",children:F.map((ve,me)=>(0,M.jsx)(bf,{appNotification:ve,onClearNotification:oe},`${ve.id}-${me}`))})})}function Sf(F){return{wrapper:(0,ze.css)({label:"app-notifications-list",zIndex:F.zIndex.portal,minWidth:400,maxWidth:600,position:"fixed",right:6,top:88})}}var Of=e(96374),pa=e(28444);function Af(F){const[V,k]=(0,o.useState)({component:null,props:{}}),oe=(0,o.useMemo)(()=>{function ve(Ae,We){k({component:Ae,props:We})}function me(){k({component:null,props:{}})}return{component:V.component,props:{...V.props,isOpen:!0,onDismiss:me},showModal:ve,hideModal:me}},[V]);return(0,o.useEffect)(()=>{ea.A.subscribe(pa.S8,({payload:me})=>{k({component:me.component,props:me.props})}),ea.A.subscribe(pa.bY,me=>{If(me,k)});let ve="";D.Ny.getHistory().listen(me=>{me.pathname!==ve&&k({component:null,props:{}}),ve=me.pathname})},[]),(0,M.jsx)(uc.wE.Provider,{value:oe,children:F.children})}function If({payload:F},V){const{confirmText:k,onConfirm:oe=()=>{},onDismiss:ve,text2:me,altActionText:Ae,onAltAction:We,noText:$e,text:tt,text2htmlBind:at,yesText:ct="Yes",icon:Et,title:ht="Confirm",yesButtonVariant:mt}=F,gt=()=>V({component:null,props:{}}),Vt={confirmText:ct,confirmButtonVariant:mt,confirmationText:k,icon:Et,title:ht,body:tt,description:me&&at?yl.sQ.sanitize(me):me,isOpen:!0,dismissText:$e,onConfirm:()=>{oe(),gt()},onDismiss:()=>{ve?.(),gt()},onAlternative:We?()=>{We(),gt()}:void 0,alternativeText:Ae};V({component:Of.u,props:Vt})}function Kc(F){return(0,M.jsx)(ao.Ix,{history:D.Ny.getHistory(),children:(0,M.jsx)(D._K,{service:D.Ny,children:(0,M.jsx)(ai.CompatRouter,{children:(0,M.jsxs)(Af,{children:[(0,M.jsxs)(Pf,{children:[(0,M.jsx)(hc,{}),(0,M.jsx)(Mf,{}),(0,M.jsxs)(fs.B,{gap:0,grow:1,direction:"column",children:[F.pageBanners.map((V,k)=>(0,M.jsx)(V,{},k.toString())),F.routes]}),F.bodyRenderHooks.map((V,k)=>(0,M.jsx)(V,{},k.toString()))]}),(0,M.jsx)(uc.EO,{})]})})})})}function Rf(F){const{activePluginId:V,closeApp:k}=oc();let{containerProps:oe,primaryProps:ve,secondaryProps:me,splitterProps:Ae}=(0,ih.h)({direction:"row",initialSize:.6,dragPosition:"end"});function We(at){return{...at,style:{...at.style,overflow:"auto",minWidth:"unset",minHeight:"unset"}}}ve=We(ve),me=We(me);const $e=(0,xe.of)(Lf,ga.l*2),tt=new D.K9(oh.sC({initialEntries:["/"]}));return(0,M.jsxs)("div",{...V?oe:{className:$e.dummyWrapper},children:[(0,M.jsx)("div",{...V?ve:{className:$e.dummyWrapper},children:(0,M.jsx)(Kc,{...F})}),V&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("div",{...Ae}),(0,M.jsx)("div",{...me,children:(0,M.jsx)(ao.Ix,{history:tt.getHistory(),children:(0,M.jsx)(D._K,{service:tt,children:(0,M.jsxs)(ai.CompatRouter,{children:[(0,M.jsx)(ut.k,{}),(0,M.jsxs)("div",{className:$e.secondAppWrapper,children:[(0,M.jsx)("div",{className:$e.secondAppToolbar,children:(0,M.jsx)(va.K,{size:"lg",style:{margin:"8px"},name:"times","aria-label":"close",onClick:()=>k(V)})}),(0,M.jsx)(ll,{pluginId:V})]})]})})})})]})]})}const Lf=(F,V)=>({secondAppWrapper:(0,ze.css)({label:"secondAppWrapper",display:"flex",height:"100%",paddingTop:V||0,flexGrow:1,flexDirection:"column"}),secondAppToolbar:(0,ze.css)({label:"secondAppToolbar",display:"flex",justifyContent:"flex-end"}),dummyWrapper:(0,ze.css)({label:"dummyWrapper",display:"flex",height:"100vh",flexDirection:"column"})});let wc=[],$c=[];function NE(F){wc.push(F)}function WE(F){$c.push(F)}class jf extends o.Component{constructor(V){super(V),this.renderRoute=k=>{const oe=k.roles?k.roles():[];return(0,M.jsx)(ai.CompatRoute,{exact:k.exact===void 0?!0:k.exact,sensitive:k.sensitive===void 0?!1:k.sensitive,path:k.path,render:ve=>{const me=D.Ny.getLocation();return oe?.length&&!oe.some(Ae=>mn.TP.hasRole(Ae))?(0,M.jsx)(Xs.C5,{replace:!0,to:"/"}):(0,M.jsx)(th,{...ve,route:k,location:me})}},k.path)},this.state={}}async componentDidMount(){await Vu(),this.setState({ready:!0}),$(".preloader").remove()}renderRoutes(){return(0,M.jsx)(ao.dO,{children:Bu().map(V=>this.renderRoute(V))})}render(){const{app:V}=this.props,{ready:k}=this.state;(0,D.Lc)("AppWrapper",!1,"rendering");const oe=me=>{(0,da.rR)("command_palette_action_selected",{actionId:me.id,actionName:me.name})},ve={routes:k&&this.renderRoutes(),pageBanners:$c,bodyRenderHooks:wc};return(0,M.jsx)(Ra.Provider,{store:js.M_,children:(0,M.jsx)(Ii.Xw,{style:"page",children:(0,M.jsx)(Qa.YE.Provider,{value:V.context,children:(0,M.jsx)(sh.N,{value:G.$.theme2,children:(0,M.jsxs)(Gs.KBarProvider,{actions:[],options:{enableHistory:!0,callbacks:{onSelectAction:oe}},children:[(0,M.jsx)(ut.k,{}),(0,M.jsx)(rc.Provider,{value:dl.L,children:(0,M.jsx)(Xl,{registries:V.pluginExtensionsRegistries,children:(0,M.jsxs)("div",{className:"grafana-app",children:[G.$.featureToggles.appSidecar?(0,M.jsx)(Rf,{...ve}):(0,M.jsx)(Kc,{...ve}),(0,M.jsx)(ah,{}),(0,M.jsx)(yt.qB,{})]})})})]})})})})})}}var Vc=e(79648);function Bf({actions:F,children:V,info:k,pageNav:oe,layout:ve,renderTitle:me,subTitle:Ae}){const We=(0,o.useContext)(il);return(0,M.jsx)(Lt.YW,{navModel:We.sectionNav,pageNav:oe,layout:ve,actions:F,renderTitle:me,info:k,subTitle:Ae,children:(0,M.jsx)(Lt.YW.Contents,{children:V})})}var Uf=e(8867),Nf=e(91324),Wf=e(23227),Ff=e(83712),Kf=e(93455),wf=e(99443),$f=e(70699),Vf=e(63997),zf=e(5798),Hf=e(61061),Gf=e(85346),Qf=e(41731),kf=e(36294),_f=e(62575),Yf=e(27798),Jf=e(53392),Xf=e(17694),Zf=e(27743),qf=e(66509),eg=e(98368),tg=e(67341),ng=e(51472),sg=e(90517),ag=e(78412),rg=e(24548),og=e(41366),ig=e(63892),lg=e(53927),cg=e(22965),dg=e(19336),ug=e(66163),hg=e(30259),fg=e(96725),gg=e(30283),pg=e(53141),mg=e(69382),vg=e(88790),yg=e(388),xg=e(58689),Eg=e(29342),Pg=e(27583),Dg=e(34153),Cg=e(13852),bg=e(5614),Tg=e(34715),Mg=e(25853),Sg=e(98020),Og=e(90088),Ag=e(79764),Ig=e(5422),Rg=e(61987),Lg=e(88225),jg=e(13896),Bg=e(68018),Ug=e(63023),Ng=e(32437),Wg=e(99996),Fg=e(99641),Kg=e(70649),wg=e(98828),$g=e(79151),Vg=e(53663),zg=e(27193),Hg=e(53123),Gg=e(4458),Qg=e(28643),kg=e(33311),_g=e(90841),Yg=e(49018),Jg=e(63738),Xg=e(63263),Zg=e(29340),qg=e(45937),ep=e(29339),tp=e(6820),np=e(77444),sp=e(3327),ap=e(70794),rp=e(11273),op=e(80641),ip=e(28867),lp=e(11220),cp=e(23544),dp=e(48339),up=e(4240),hp=e(95224),fp=e(82382),gp=e(87048),pp=e(53007),mp=e(12179),vp=e(17226),yp=e(42982),xp=e(42806),Ep=e(50459),Pp=e(84879),Dp=e(52664),Cp=e(26868),bp=e(72805),Tp=e(73575),Mp=e(56811),Sp=e(53896),Op=e(97918),Ap=e(81422),Ip=e(29130),Rp=e(45376),Lp=e(73642),jp=e(83267),Bp=e(80021),Up=e(41684),Np=e(72215),Wp=e(81656),Fp=e(29424),Kp=e(7682),wp=e(51764),$p=e(76151),Vp=e(30781),zp=e(65972),Hp=e(90756),Gp=e(24289),Qp=e(84472),kp=e(71533),_p=e(45298),Yp=e(96906),Jp=e(95311),Xp=e(82349),Zp=e(21101),qp=e(72316),em=e(48761),tm=e(97231),nm=e(13835),sm=e(91381),am=e(52859),rm=e(25928),om=e(36714),im=e(30815),lm=e(3465),cm=e(39012),dm=e(94675),um=e(40051),hm=e(4543),fm=e(89579),gm=e(82524),pm=e(31115),mm=e(99003),vm=e(95684),ym=e(1624),xm=e(93644),Em=e(96619),Pm=e(61748),Dm=e(57169),Cm=e(11769),bm=e(26551),Tm=e(40295),Mm=e(38514),Sm=e(81312),Om=e(64298),Am=e(70866),Im=e(30587),Rm=e(44850),Lm=e(54556),jm=e(81615),Bm=e(82798),Um=e(8687),Nm=e(77270),Wm=e(10742),Fm=e(41404),Km=e(72579),wm=e(39973),$m=e(56963),Vm=e(8807),zm=e(24109),Hm=e(46255),Gm=e(68636),Qm=e(74305),km=e(21391);let zc=!1;function Bt(F,V){Uf.cacheStore[V]={content:F,status:"loaded"}}function _m(){let F="public/img/icons/";const V=typeof window<"u"&&window.__grafana_public_path__;return V&&(F=V+"img/icons/"),k=>F+k}function Ym(){if(zc)return;zc=!0;const F=_m();Bt(Nf,F("unicons/at.svg")),Bt(Wf,F("unicons/adjust-circle.svg")),Bt(Ff,F("unicons/align-left.svg")),Bt(Kf,F("unicons/align-right.svg")),Bt(wf,F("unicons/angle-double-down.svg")),Bt($f,F("unicons/angle-double-right.svg")),Bt(Vf,F("unicons/angle-down.svg")),Bt(zf,F("unicons/angle-left.svg")),Bt(Hf,F("unicons/angle-right.svg")),Bt(Gf,F("unicons/angle-up.svg")),Bt(Qf,F("unicons/apps.svg")),Bt(kf,F("unicons/arrow.svg")),Bt(_f,F("unicons/arrow-down.svg")),Bt(Yf,F("unicons/arrow-from-right.svg")),Bt(Jf,F("unicons/arrow-left.svg")),Bt(Xf,F("unicons/arrow-random.svg")),Bt(Zf,F("unicons/arrow-right.svg")),Bt(qf,F("unicons/arrow-to-right.svg")),Bt(eg,F("unicons/arrow-up.svg")),Bt(tg,F("unicons/arrows-h.svg")),Bt(ng,F("unicons/backward.svg")),Bt(sg,F("unicons/bars.svg")),Bt(ag,F("unicons/bell.svg")),Bt(rg,F("unicons/bell-slash.svg")),Bt(og,F("unicons/bolt.svg")),Bt(ig,F("unicons/book.svg")),Bt(lg,F("unicons/bookmark.svg")),Bt(cg,F("unicons/book-open.svg")),Bt(dg,F("unicons/brackets-curly.svg")),Bt(ug,F("unicons/bug.svg")),Bt(hg,F("unicons/building.svg")),Bt(fg,F("unicons/calculator-alt.svg")),Bt(gg,F("unicons/calendar-alt.svg")),Bt(pg,F("unicons/calendar-slash.svg")),Bt(mg,F("unicons/camera.svg")),Bt(vg,F("unicons/channel-add.svg")),Bt(yg,F("unicons/chart-line.svg")),Bt(xg,F("unicons/check.svg")),Bt(Eg,F("unicons/check-circle.svg")),Bt(Pg,F("unicons/circle.svg")),Bt(Dg,F("unicons/clipboard-alt.svg")),Bt(Cg,F("unicons/clock-nine.svg")),Bt(bg,F("unicons/cloud.svg")),Bt(Tg,F("unicons/cloud-download.svg")),Bt(Mg,F("unicons/code-branch.svg")),Bt(Sg,F("unicons/cog.svg")),Bt(Og,F("unicons/columns.svg")),Bt(Ag,F("unicons/comment-alt.svg")),Bt(Ig,F("unicons/comment-alt-share.svg")),Bt(Rg,F("unicons/comments-alt.svg")),Bt(Lg,F("unicons/compass.svg")),Bt(jg,F("unicons/copy.svg")),Bt(Bg,F("unicons/corner-down-right-alt.svg")),Bt(Ug,F("unicons/cube.svg")),Bt(Ng,F("unicons/dashboard.svg")),Bt(Wg,F("unicons/database.svg")),Bt(Fg,F("unicons/document-info.svg")),Bt(Kg,F("unicons/download-alt.svg")),Bt(wg,F("unicons/draggabledots.svg")),Bt($g,F("unicons/edit.svg")),Bt(Vg,F("unicons/ellipsis-v.svg")),Bt(zg,F("unicons/ellipsis-h.svg")),Bt(Hg,F("unicons/envelope.svg")),Bt(Gg,F("unicons/exchange-alt.svg")),Bt(Qg,F("unicons/exclamation-circle.svg")),Bt(kg,F("unicons/exclamation-triangle.svg")),Bt(_g,F("unicons/external-link-alt.svg")),Bt(Yg,F("unicons/eye.svg")),Bt(Jg,F("unicons/eye-slash.svg")),Bt(Xg,F("unicons/file-alt.svg")),Bt(Zg,F("unicons/file-blank.svg")),Bt(qg,F("unicons/filter.svg")),Bt(ep,F("unicons/folder.svg")),Bt(tp,F("unicons/folder-open.svg")),Bt(np,F("unicons/folder-plus.svg")),Bt(sp,F("unicons/folder-upload.svg")),Bt(ap,F("unicons/forward.svg")),Bt(rp,F("unicons/graph-bar.svg")),Bt(op,F("unicons/history.svg")),Bt(ip,F("unicons/history-alt.svg")),Bt(lp,F("unicons/home-alt.svg")),Bt(cp,F("unicons/import.svg")),Bt(dp,F("unicons/info.svg")),Bt(up,F("unicons/info-circle.svg")),Bt(hp,F("unicons/k6.svg")),Bt(fp,F("unicons/key-skeleton-alt.svg")),Bt(gp,F("unicons/keyboard.svg")),Bt(pp,F("unicons/link.svg")),Bt(mp,F("unicons/list-ul.svg")),Bt(vp,F("unicons/lock.svg")),Bt(yp,F("unicons/minus.svg")),Bt(xp,F("unicons/minus-circle.svg")),Bt(Ep,F("unicons/mobile-android.svg")),Bt(Pp,F("unicons/monitor.svg")),Bt(Dp,F("unicons/pause.svg")),Bt(Cp,F("unicons/pen.svg")),Bt(bp,F("unicons/play.svg")),Bt(Tp,F("unicons/plug.svg")),Bt(Mp,F("unicons/plus.svg")),Bt(Sp,F("unicons/plus-circle.svg")),Bt(Op,F("unicons/power.svg")),Bt(Ap,F("unicons/presentation-play.svg")),Bt(Ip,F("unicons/process.svg")),Bt(Rp,F("unicons/question-circle.svg")),Bt(Lp,F("unicons/repeat.svg")),Bt(jp,F("unicons/rocket.svg")),Bt(Bp,F("unicons/rss.svg")),Bt(Up,F("unicons/save.svg")),Bt(Np,F("unicons/search.svg")),Bt(Wp,F("unicons/search-minus.svg")),Bt(Fp,F("unicons/search-plus.svg")),Bt(Kp,F("unicons/share-alt.svg")),Bt(wp,F("unicons/shield.svg")),Bt($p,F("unicons/signal.svg")),Bt(Vp,F("unicons/signin.svg")),Bt(zp,F("unicons/signout.svg")),Bt(Hp,F("unicons/sitemap.svg")),Bt(Gp,F("unicons/slack.svg")),Bt(Qp,F("unicons/sliders-v-alt.svg")),Bt(kp,F("unicons/sort-amount-down.svg")),Bt(_p,F("unicons/sort-amount-up.svg")),Bt(Yp,F("unicons/square-shape.svg")),Bt(Jp,F("unicons/star.svg")),Bt(Xp,F("unicons/step-backward.svg")),Bt(Zp,F("unicons/sync.svg")),Bt(qp,F("unicons/stopwatch.svg")),Bt(em,F("unicons/table.svg")),Bt(tm,F("unicons/tag-alt.svg")),Bt(nm,F("unicons/times.svg")),Bt(sm,F("unicons/trash-alt.svg")),Bt(am,F("unicons/unlock.svg")),Bt(rm,F("unicons/upload.svg")),Bt(om,F("unicons/user.svg")),Bt(im,F("unicons/users-alt.svg")),Bt(lm,F("unicons/wrap-text.svg")),Bt(cm,F("unicons/cloud-upload.svg")),Bt(dm,F("unicons/credit-card.svg")),Bt(um,F("unicons/file-copy-alt.svg")),Bt(hm,F("unicons/fire.svg")),Bt(fm,F("unicons/hourglass.svg")),Bt(gm,F("unicons/layer-group.svg")),Bt(pm,F("unicons/layers-alt.svg")),Bt(mm,F("unicons/line-alt.svg")),Bt(vm,F("unicons/list-ui-alt.svg")),Bt(ym,F("unicons/message.svg")),Bt(xm,F("unicons/palette.svg")),Bt(Em,F("unicons/percentage.svg")),Bt(Pm,F("unicons/shield-exclamation.svg")),Bt(Dm,F("unicons/plus-square.svg")),Bt(Cm,F("unicons/x.svg")),Bt(bm,F("unicons/capture.svg")),Bt(Tm,F("custom/gf-grid.svg")),Bt(Mm,F("custom/gf-landscape.svg")),Bt(Sm,F("custom/gf-layout-simple.svg")),Bt(Om,F("custom/gf-portrait.svg")),Bt(Am,F("custom/gf-show-context.svg")),Bt(Im,F("custom/gf-bar-alignment-after.svg")),Bt(Rm,F("custom/gf-bar-alignment-before.svg")),Bt(Lm,F("custom/gf-bar-alignment-center.svg")),Bt(jm,F("custom/gf-interpolation-linear.svg")),Bt(Bm,F("custom/gf-interpolation-smooth.svg")),Bt(Um,F("custom/gf-interpolation-step-after.svg")),Bt(Nm,F("custom/gf-interpolation-step-before.svg")),Bt(Wm,F("custom/gf-logs.svg")),Bt(Fm,F("custom/gf-movepane-left.svg")),Bt(Km,F("custom/gf-movepane-right.svg")),Bt(wm,F("mono/favorite.svg")),Bt($m,F("mono/grafana.svg")),Bt(Vm,F("mono/heart.svg")),Bt(zm,F("mono/heart-break.svg")),Bt(Hm,F("mono/panel-add.svg")),Bt(Gm,F("mono/library-panel.svg")),Bt(Qm,F("unicons/record-audio.svg")),Bt(km,F("solid/bookmark.svg"))}var Jm=e(47129),Xm=e(76885);function Zm(F){const V=F.target instanceof Element&&qm(F.target);if(!(F.ctrlKey||F.metaKey||F.defaultPrevented)&&V){let k=V.getAttribute("href");const oe=V.getAttribute("target");if(k&&!oe){const ve=Xm.kM.parseKeyValue(k.split("?")[1]),me=ve.orgId&&Number(ve.orgId)!==H.$W.bootData.user.orgId;if((0,D.Lc)("utils",!1,"intercepting link click",F),F.preventDefault(),k=v.I.stripBaseFromUrl(k),k[0]!=="/"||me)if(k.indexOf("://")>0||k.indexOf("mailto:")===0||me){window.location.href=k;return}else if(k.indexOf("#")===0){window.location.hash=k;return}else k=`/${k}`;D.Ny.push(k)}}}function qm(F){for(;F!==null&&F.tagName;){if(F.tagName.toUpperCase()==="A")return F;F=F.parentElement}return null}var e0=e(2609);class t0{constructor(V){this.hasUpdates=!1,this.checked=Date.now(),this.prevLocationPath="",this.interval=V??1e3*60*5}start(){const V=(0,hl.oF)();V&&V.getConnectionState().subscribe(k=>{k&&this._checkForUpdates()}),D.Ny.getHistory().listen(this.locationUpdated.bind(this)),this.prevLocationPath=D.Ny.getLocation().pathname}locationUpdated(V){if(this.prevLocationPath===V.pathname)return;const k=V.pathname.split("/");k[1]==="/"&&this.prevLocationPath!=="/"?this.reloadIfUpdateDetected():k[1]==="d"&&!e0._o.state.isPlaying?this.reloadIfUpdateDetected():this.hasUpdates&&(0,da.rR)("new_frontend_assets_reload_ignored",{newLocation:V.pathname,prevLocation:this.prevLocationPath}),this.prevLocationPath=V.pathname}async _checkForUpdates(){if(this.hasUpdates||Date.now()-this.checked<this.interval)return;this.checked=Date.now();const V=this.previous,k=await(0,P.AI)().get("/api/frontend/assets");V&&!(0,l.isEqual)(V,k)&&(this.hasUpdates=!0,(0,da.rR)("new_frontend_assets_detected",{assets:V.assets!==k.assets,plugins:V.plugins!==k.plugins,version:V.version!==k.version,flags:V.flags!==k.flags})),this.previous=k}reloadIfUpdateDetected(){this.hasUpdates&&((0,da.rR)("new_frontend_assets_reload",{}),window.location.reload()),this._checkForUpdates()}}var El=e(27677),n0=e(91040),s0=e(40621);function Pl(F,V=!1){return new Promise(k=>{const oe=document.createElement("script");oe.onload=k,oe.src=F,oe.async=V,document.head.appendChild(oe)})}const Hc=(0,n0.h)("EchoSrv"),Gc=Hc.logger;(0,s0.h)("echo",void 0,Hc);class a0{constructor(V){this.config={flushInterval:1e4,debug:!1},this.backends=[],this.flush=()=>{for(const k of this.backends)k.flush()},this.addBackend=k=>{Gc("Adding backend",!1,k),this.backends.push(k)},this.addEvent=(k,oe)=>{const ve=this.getMeta(),me={...k,meta:{...ve,...oe}};for(const Ae of this.backends)(Ae.supportedEvents.length===0||Ae.supportedEvents.indexOf(me.type)>-1)&&Ae.addEvent(me);Gc(`${k.type} event`,!1,{...k.payload,meta:me.meta})},this.getMeta=()=>({sessionId:"",userId:mn.TP.user.id,userLogin:mn.TP.user.login,userSignedIn:mn.TP.user.isSignedIn,screenSize:{width:window.innerWidth,height:window.innerHeight},windowSize:{width:window.screen.width,height:window.screen.height},userAgent:window.navigator.userAgent,ts:new Date().getTime(),timeSinceNavigationStart:performance.now(),path:window.location.pathname,url:window.location.href}),this.config={...this.config,...V},setInterval(this.flush,this.config.flushInterval)}}var r0=e(42614);class o0{constructor(V){this.options=V,this.buffer=[],this.supportedEvents=[K.on.Performance],this.addEvent=k=>{this.buffer.push(k.payload)},this.flush=()=>{this.buffer.length!==0&&(El.IB.post("/api/frontend-metrics",{events:this.buffer},{showErrorAlert:!1}).catch(()=>{}),this.buffer=[])}}}var ui=e(61298);class i0{constructor(V){this.options=V,this.supportedEvents=[K.on.Pageview,K.on.Interaction],this.addEvent=ve=>{window.applicationInsights&&((0,ui.nB)(ve)&&window.applicationInsights.trackPageView?.(),(0,ui.fX)(ve)&&window.applicationInsights.trackEvent?.({name:ve.payload.interactionName,properties:ve.payload.properties}))},this.flush=()=>{};const k={config:{connectionString:V.connectionString,endpointUrl:V.endpointUrl}};System.import("https://js.monitor.azure.com/scripts/b/ai.2.min.js").then(ve=>ve.default?ve.default:ve).then(({ApplicationInsights:ve})=>{const me=new ve(k);window.applicationInsights=me.loadAppInsights()})}}class l0{constructor(V){this.options=V,this.supportedEvents=[K.on.Pageview],this.googleAnalytics4SendManualPageViews=!1,this.addEvent=ve=>{window.gtag&&this.googleAnalytics4SendManualPageViews&&window.gtag("event","page_view",{page_path:ve.payload.page})},this.flush=()=>{};const k=`https://www.googletagmanager.com/gtag/js?id=${V.googleAnalyticsId}`;Pl(k,!0),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date);const oe={page_path:window.location.pathname};V.user&&(oe.user_id=V.user.analytics.identifier),this.googleAnalytics4SendManualPageViews=V.googleAnalytics4SendManualPageViews,window.gtag("config",V.googleAnalyticsId,oe)}}class c0{constructor(V){this.options=V,this.supportedEvents=[K.on.Pageview],this.trackedUserId=null,this.addEvent=ve=>{if(!window.ga)return;window.ga("set",{page:ve.payload.page}),window.ga("send","pageview");const{userSignedIn:me,userId:Ae}=ve.meta;me&&Ae!==this.trackedUserId&&(this.trackedUserId=Ae,window.ga("set","userId",Ae))},this.flush=()=>{};const k=`https://www.google-analytics.com/analytics${V.debug?"_debug":""}.js`;Pl(k);const oe=window.ga=window.ga||function(){(oe.q=oe.q||[]).push(arguments)};oe.l=+new Date,oe("create",V.googleAnalyticsId,"auto"),oe("set","anonymizeIp",!0)}}class d0{constructor(V){this.options=V,this.supportedEvents=[K.on.Pageview,K.on.Interaction,K.on.ExperimentView],this.addEvent=me=>{window.rudderanalytics&&((0,ui.nB)(me)&&window.rudderanalytics.page?.(),(0,ui.fX)(me)&&window.rudderanalytics.track?.(me.payload.interactionName,me.payload.properties),(0,ui.p6)(me)&&window.rudderanalytics.track?.("experiment_viewed",{experiment_id:me.payload.experimentId,experiment_group:me.payload.experimentGroup,experiment_variant:me.payload.experimentVariant}))},this.flush=()=>{};const k=V.sdkUrl||"https://cdn.rudderlabs.com/v1/rudder-analytics.min.js";Pl(k);const oe=window.rudderanalytics=[],ve=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId"];for(let me=0;me<ve.length;me++){const Ae=ve[me];oe[Ae]=function(We){return function(){oe.push([We].concat(Array.prototype.slice.call(arguments)))}}(Ae)}if(window.rudderanalytics?.load?.(V.writeKey,V.dataPlaneUrl,{configUrl:V.configUrl,destSDKBaseURL:V.integrationsUrl}),V.user){const{identifier:me,intercomIdentifier:Ae}=V.user.analytics,We={};Ae&&(We.Intercom={user_hash:Ae}),window.rudderanalytics?.identify?.(me,{email:V.user.email,orgId:V.user.orgId,language:V.user.language,version:V.buildInfo.version,edition:V.buildInfo.edition},We)}}}var u0=e(13515),h0=e(88285),f0=e(74940),g0=e(36043),p0=e(19439),m0=e(68738),v0=e(83946),y0=e(83824),x0=e(20467);class E0 extends x0.j{constructor(){super(...arguments),this.name="EchoSrvTransport",this.version=G.$.buildInfo.version}send(V){(0,K.x$)().addEvent({type:K.on.GrafanaJavascriptAgent,payload:V})}isBatched(){return!0}getIgnoreUrls(){return[]}}class P0{constructor(V){this.options=V,this.supportedEvents=[K.on.GrafanaJavascriptAgent],this.addEvent=me=>{},this.flush=()=>{};const k=[],oe=[new E0];V.customEndpoint&&oe.push(new h0.m({url:V.customEndpoint,apiKey:V.apiKey})),V.errorInstrumentalizationEnabled&&k.push(new f0.W),V.consoleInstrumentalizationEnabled&&k.push(new g0._),V.webVitalsInstrumentalizationEnabled&&k.push(new p0.I),V.tracingInstrumentalizationEnabled&&k.push(new y0.v),k.push(new m0.D);const ve={globalObjectKey:V.globalObjectKey||"faro",preventGlobalExposure:V.preventGlobalExposure||!1,app:{name:"grafana-frontend",version:V.buildInfo.version,environment:V.buildInfo.env},instrumentations:k,transports:oe,ignoreErrors:["ResizeObserver loop limit exceeded","ResizeObserver loop completed","Non-Error exception captured with keys"],ignoreUrls:[new RegExp(`/*${V.customEndpoint}/`),/frontend-metrics/],sessionTracking:{persistent:!0},batching:{sendTimeout:1e3},internalLoggerLevel:V.internalLoggerLevel||u0.vI};this.faroInstance=(0,v0.p)(ve),V.user&&this.faroInstance.api.setUser({id:V.user.id,attributes:{orgId:String(V.user.orgId)||""}})}}var D0=e(69129),C0=e(87490),b0=e(70497),T0=e(1702),M0=e(93522),$i=e(4898);class S0{constructor(V,k){this.locationService=V,this.chromeService=k,this.panelId=null,ea.A.subscribe(D0.Tp,oe=>{this.panelId=oe.payload.panelId})}clearAndInitGlobalBindings(V){$i.R.reset(),V.chromeless||(this.bind("?",this.showHelpModal),this.bind("g h",this.goToHome),this.bind("g d",this.goToDashboards),this.bind("g e",this.goToExplore),this.bind("g a",this.openAlerting),this.bind("g p",this.goToProfile),this.bind("esc",this.exit),this.bindGlobalEsc()),this.bind("c t",()=>(0,Ui.O)(!1)),this.bind("c r",()=>(0,Ui.O)(!0))}bindGlobalEsc(){this.bindGlobal("esc",this.globalEsc)}globalEsc(){const k=document.activeElement;if(!(document.querySelectorAll(".slate-typeahead--open").length>0)){if(k&&k instanceof HTMLElement&&(k.nodeName==="INPUT"||k.nodeName==="TEXTAREA"||k.hasAttribute("data-slate-editor"))){k.blur();return}this.exit()}}closeSearch(){this.locationService.partial({search:null})}openAlerting(){this.locationService.push("/alerting")}goToDashboards(){this.locationService.push("/dashboards")}goToHome(){this.locationService.push("/")}goToProfile(){this.locationService.push("/profile")}goToExplore(){this.locationService.push("/explore")}showHelpModal(){ea.A.publish(new pa.S8({component:M0.N}))}exit(){const V=this.locationService.getSearchObject();if(V.editview){this.locationService.partial({editview:null,editIndex:null});return}if(V.inspect){this.locationService.partial({inspect:null,inspectTab:null});return}if(V.editPanel){this.locationService.partial({editPanel:null,tab:null});return}if(V.viewPanel){this.locationService.partial({viewPanel:null,tab:null});return}const{kioskMode:k}=this.chromeService.state.getValue();k&&this.chromeService.exitKioskMode(),V.search&&this.closeSearch()}showDashEditView(){this.locationService.partial({editview:"settings"})}bind(V,k){$i.R.bind(V,oe=>{oe.preventDefault(),oe.stopPropagation(),oe.returnValue=!1,k.call(this)},"keydown")}bindGlobal(V,k){$i.R.bindGlobal(V,oe=>{oe.preventDefault(),oe.stopPropagation(),oe.returnValue=!1,k.call(this)},"keydown")}unbind(V,k){$i.R.unbind(V,k)}bindWithPanelId(V,k){this.bind(V,this.withFocusedPanel(k))}withFocusedPanel(V){return()=>{if(typeof this.panelId=="number"){V(this.panelId);return}}}setupTimeRangeBindings(V=!0){this.bind("t a",()=>{ea.A.publish(new pa.Rh({updateUrl:V}))}),this.bind("t z",()=>{ea.A.publish(new pa.U0({scale:2,updateUrl:V}))}),this.bind("ctrl+z",()=>{ea.A.publish(new pa.U0({scale:2,updateUrl:V}))}),this.bind("t left",()=>{ea.A.publish(new pa.Io({direction:pa.xL.Left,updateUrl:V}))}),this.bind("t right",()=>{ea.A.publish(new pa.Io({direction:pa.xL.Right,updateUrl:V}))}),this.bind("t c",()=>{ea.A.publish(new pa.Bt)}),this.bind("t v",()=>{ea.A.publish(new pa.VZ({updateUrl:V}))})}setupDashboardBindings(V){this.bind("mod+o",()=>{V.graphTooltip=(V.graphTooltip+1)%3,V.events.publish(new Nr.Tq),V.startRefresh()}),this.bind("mod+s",()=>{V.meta.canSave&&ea.A.publish(new pa.S8({component:b0.$,props:{dashboard:V}}))}),this.setupTimeRangeBindings(),this.bindWithPanelId("e",k=>{if(V.canEditPanelById(k)){const oe=this.locationService.getSearchObject().editPanel!==void 0;this.locationService.partial({editPanel:oe?null:k})}}),this.bindWithPanelId("v",k=>{const oe=this.locationService.getSearchObject().viewPanel!==void 0;this.locationService.partial({viewPanel:oe?null:k})}),this.bindWithPanelId("p l",k=>{const oe=V.getPanelById(k),ve={...oe.options};ve.legend.showLegend?ve.legend.showLegend=!1:ve.legend.showLegend=!0,oe.updateOptions(ve)}),this.bindWithPanelId("i",k=>{this.locationService.partial({inspect:k})}),_n.TP.hasAccessToExplore()&&this.bindWithPanelId("p x",async k=>{const oe=V.getPanelById(k),ve=await(0,C0.Xe)({queries:oe.targets,dsRef:oe.datasource,scopedVars:oe.scopedVars,timeRange:(0,yr.jG)().timeRange()});if(ve){const me=v.I.stripBaseFromUrl(ve);me&&this.locationService.push(me)}}),this.bindWithPanelId("p r",k=>{V.canEditPanelById(k)&&!(V.panelInView||V.panelInEdit)&&ea.A.publish(new pa.Vz(k))}),this.bindWithPanelId("p d",k=>{if(V.canEditPanelById(k)){const oe=V.getPanelInfoById(k).index;V.duplicatePanel(V.panels[oe])}}),this.bindWithPanelId("p s",k=>{const oe=V.getPanelInfoById(k);ea.A.publish(new pa.S8({component:T0.ShareModal,props:{dashboard:V,panel:oe?.panel}}))}),this.bind("d l",()=>{V.toggleLegendsForAll()}),this.bind("d x",()=>{V.toggleExemplarsForAll()}),this.bind("d shift+c",()=>{V.collapseRows()}),this.bind("d shift+e",()=>{V.expandRows()}),this.bind("d n",()=>{this.locationService.push("/dashboard/new")}),this.bind("d r",()=>{V.startRefresh()}),this.bind("d s",()=>{this.showDashEditView()}),this.bind("d k",()=>{this.chromeService.onToggleKioskMode()}),this.bind("d a",()=>{const oe=this.locationService.getSearchObject().autofitpanels?"":"&autofitpanels";window.location.href=window.location.href+oe})}}var co=e(78160);async function FE(){if(window.location.search.indexOf("why-render")!==-1){const{default:F}=await e.e(3718).then(e.t.bind(e,13718,23));F(React,{trackAllPureComponents:!0})}}var O0=e(20120);const A0=(0,o.lazy)(()=>e.e(192).then(e.bind(e,57029)));function I0(){const F=(0,ls.Wd)(er.hY),V=G.$.unifiedAlertingEnabled;mn.TP.hasPermission(F.read)&&(0,O0.fP)({show:()=>V,component:({dashboard:k})=>V?(0,M.jsx)(o.Suspense,{fallback:null,children:k&&(0,M.jsx)(A0,{dashboardUid:k.uid})},"alert-rules-button"):null,index:-2})}var R0=e(73399);function L0(F){return(0,M.jsx)(j0,{...F})}const j0=(0,o.lazy)(async()=>{const{EmbeddedDashboard:F}=await e.e(2859).then(e.bind(e,13251));return{default:F}});var B0=e(61582),U0=e(67027),N0=e(97527),KE=e(99355),hi=e(14590),W0=e(19895),F0=e(44838),K0=e(67278);const w0=()=>new K0.c(new URL(e.p+e.u(5358),e.b));var $0=e(88483),Qc=e(63720);const V0=F=>new $0.c(V=>{const k=F.subscribe(hi.BX(oe=>{V.next(oe)}),hi.BX(oe=>{V.error(oe)}),hi.BX(()=>{V.complete()}));return{unsubscribe:()=>{k.then(oe=>oe.unsubscribe())}}}),Dl=F=>(0,Ma.H)(F).pipe((0,Qc.n)(V=>V0(V)));class z0{constructor(V){this.getConnectionState=()=>Dl(this.centrifugeWorker.getConnectionState()),this.getDataStream=k=>Dl(this.centrifugeWorker.getDataStream(k)).pipe((0,W0.Q)(F0.E)),this.getQueryData=async k=>{const oe=JSON.parse(JSON.stringify(k));return this.centrifugeWorker.getQueryData(oe)},this.getPresence=k=>this.centrifugeWorker.getPresence(k),this.getStream=k=>Dl(this.centrifugeWorker.getStream(k)),this.centrifugeWorker=hi.LV(w0()),this.centrifugeWorker.initialize(V,hi.BX(V.dataStreamSubscriberReadiness))}}var kc=e(9631),H0=e(55004),G0=e(47773),_c=e(26657),Vi=e(47118);class Q0{constructor(V){this.deps=V,this.getConnectionState=()=>this.deps.centrifugeSrv.getConnectionState(),this.getDataStream=k=>{let oe;const ve=me=>{const Ae=me.data[0];if(!oe&&!(0,Vi.ot)(Ae,Vi._w.FullFrame)){console.warn(`expected first packet to contain a full frame, received ${Ae?.type}`);return}switch(Ae.type){case Vi._w.FullFrame:{oe=kc.k9.deserialize(Ae.frame);return}case Vi._w.NewValuesSameSchema:{oe.pushNewValues(Ae.values);return}}};return this.deps.centrifugeSrv.getDataStream(k).pipe((0,bn.T)(me=>(ve(me),{...me,data:[oe??kc.k9.empty()]})))},this.getStream=k=>this.deps.centrifugeSrv.getStream(k),this.getQueryData=k=>(0,Ma.H)(this.deps.centrifugeSrv.getQueryData(k)).pipe((0,Qc.n)(oe=>{const ve=(0,G0.bE)(oe,k.request.targets);return ve.data?.length&&ve.data.find(Ae=>Ae.meta?.channel)?(0,_c.x7)(ve,k.request,_c.ph):(0,xn.of)(ve)})),this.publish=async(k,oe)=>this.deps.backendSrv.post("api/live/publish",{channel:(0,H0.Qp)(k),data:oe}),this.getPresence=k=>this.deps.centrifugeSrv.getPresence(k)}}function k0(){const F={appUrl:`${window.location.origin}${G.$.appSubUrl}`,orgId:mn.TP.user.orgId,orgRole:mn.TP.user.orgRole,liveEnabled:G.$.liveEnabled,dataStreamSubscriberReadiness:B0.a.ok.asObservable(),grafanaAuthToken:(0,U0.r)()},V=G.$.featureToggles["live-service-web-worker"]?new z0(F):new N0.w(F);(0,hl.S8)(new Q0({centrifugeSrv:V,backendSrv:(0,P.AI)()}))}function wE(){return getGrafanaLiveSrv()}var _0=e(17888),Y0=e(20726),uo=e(31193),zn=e(75462);function J0(F){let V,k;return F.addedComponentsRegistry.asObservable().subscribe(oe=>{V=oe}),F.addedLinksRegistry.asObservable().subscribe(oe=>{k=oe}),oe=>Yc({...oe,addedComponentsRegistry:V,addedLinksRegistry:k})}const Yc=({context:F,extensionPointId:V,limitPerPlugin:k,addedLinksRegistry:oe,addedComponentsRegistry:ve})=>{const me=F?(0,zn.$Y)(F):{},Ae=[],We={};for(const tt of oe?.[V]??[])try{const{pluginId:at}=tt;if(k&&We[at]>=k)continue;We[at]===void 0&&(We[at]=0);const ct=(0,zn.hS)(at,tt,me);if(tt.configure&&ct===void 0)continue;const Et=ct?.path||tt.path,ht={id:(0,zn.yt)(at,V,tt.title),type:io.u.link,pluginId:at,onClick:(0,zn.dx)(at,V,tt,me),icon:ct?.icon||tt.icon,title:ct?.title||tt.title,description:ct?.description||tt.description,path:(0,l.isString)(Et)?(0,zn.YS)(at,Et,V):void 0,category:ct?.category||tt.category};Ae.push(ht),We[at]+=1}catch(at){at instanceof Error&&(0,zn.FF)(at.message)}const $e=ve?.[V]??[];for(const tt of $e){if(k&&We[tt.pluginId]>=k)continue;We[tt.pluginId]===void 0&&(We[tt.pluginId]=0);const at={id:(0,zn.yt)(tt.pluginId,V,tt.title),type:io.u.component,pluginId:tt.pluginId,title:tt.title,description:tt.description,component:(0,zn.nv)(tt.pluginId,tt.component)};Ae.push(at),We[tt.pluginId]+=1}return{extensions:Ae}};var Jc=e(29436),X0=e(23994),Z0=e(11140),q0=e(12881);function ev(){try{return[(0,zn.xJ)({title:"Add to dashboard",description:"Use the query and panel from explore and create/add it to a dashboard",targets:[io.S.ExploreToolbarAction],icon:"apps",category:"Dashboards",configure:()=>{if(_n.TP.hasPermission(Gt.AccessControlAction.DashboardsCreate)||_n.TP.hasPermission(Gt.AccessControlAction.DashboardsWrite))return{}},onClick:(F,{context:V,openModal:k})=>{k({title:(0,q0.t)(),body:({onDismiss:oe})=>(0,M.jsx)(Z0.v,{onClose:oe,exploreId:V?.exploreId})})}}),(0,zn.xJ)({title:"Add correlation",description:"Create a correlation from this query",targets:[io.S.ExploreToolbarAction],icon:"link",configure:F=>F?.shouldShowAddCorrelation?{}:void 0,onClick:(F,{context:V})=>{(0,js.JD)((0,Jc.am)({editorMode:!0})),(0,js.JD)((0,X0.Od)({exploreId:V.exploreId}))}})]}catch(F){return(0,zn.FF)(`Could not configure extensions for Explore due to: "${F}"`),[]}}function tv(){return[...ev()]}var Na=e(87092),zi=e(13752),Xc=e(39741),nv=e(29405),sv=e(96222),av=e(72985);const rv="Cannot register to a read-only registry";class Cl{constructor(V){if(this.resultSubject=new zi.B,this.isReadOnly=!1,V.registrySubject){this.registrySubject=V.registrySubject,this.isReadOnly=!0;return}this.registrySubject=new Xc.m(1),this.resultSubject.pipe((0,nv.S)(this.mapToRegistry,V.initialState??{}),(0,sv.Z)(V.initialState??{}),(0,bn.T)(k=>(0,zn.ol)(k))).subscribe(this.registrySubject)}register(V){if(this.isReadOnly)throw new Error(rv);this.resultSubject.next(V)}asObservable(){return this.registrySubject.asObservable()}getState(){return(0,av._)(this.asObservable())}}class bl extends Cl{constructor(V={}){super(V)}mapToRegistry(V,k){const{pluginId:oe,configs:ve}=k;for(const me of ve){if(!(0,Na.lr)(me.component)){(0,zn.FF)(`Could not register added component with title '${me.title}'. Reason: The provided component is not a valid React component.`);continue}if(!me.title){(0,zn.FF)(`Could not register added component with title '${me.title}'. Reason: Title is missing.`);continue}if(!me.description){(0,zn.FF)(`Could not register added component with title '${me.title}'. Reason: Description is missing.`);continue}if(oe!=="grafana"&&(0,zn.V2)()&&(0,zn.dt)(oe,me))continue;const Ae=Array.isArray(me.targets)?me.targets:[me.targets];for(const We of Ae){!(0,Na.Fk)(We)&&!(0,Na.w_)(We)&&(0,zn.FF)(`Added component "${me.title}": it's recommended to suffix the extension point id ("${We}") with a version, e.g 'myorg-basic-app/extension-point/v1'.`);const $e={pluginId:oe,component:(0,zn.nv)(oe,me.component),description:me.description,title:me.title};We in V?V[We].push($e):V[We]=[$e]}}return V}readOnly(){return new bl({registrySubject:this.registrySubject})}}class Tl extends Cl{constructor(V={}){super(V)}mapToRegistry(V,k){const{pluginId:oe,configs:ve}=k;for(const me of ve){const{path:Ae,title:We,description:$e,configure:tt,onClick:at,targets:ct}=me;if(!We){(0,zn.FF)(`Could not register added link with title '${We}'. Reason: Title is missing.`);continue}if(!$e){(0,zn.FF)(`Could not register added link with title '${We}'. Reason: Description is missing.`);continue}if(!(0,Na.jk)(tt)){(0,zn.FF)(`Could not register added link with title '${We}'. Reason: configure is not a function.`);continue}if(!Ae&&!at){(0,zn.FF)(`Could not register added link with title '${We}'. Reason: Either "path" or "onClick" is required.`);continue}if(Ae&&!(0,Na.kl)(oe,Ae)){(0,zn.FF)(`Could not register added link with title '${We}'. Reason: The "path" is required and should start with "/a/${oe}/" (currently: "${Ae}"). Skipping the extension.`);continue}if(oe!=="grafana"&&(0,zn.V2)()&&(0,zn.OO)(oe,me))continue;const Et=Array.isArray(ct)?ct:[ct];for(const ht of Et){!(0,Na.Fk)(ht)&&!(0,Na.w_)(ht)&&(0,zn.FF)(`Added link "${me.title}: it's recommended to suffix the extension point id ("${ht}") with a version, e.g 'myorg-basic-app/extension-point/v1'.`);const{targets:mt,...gt}=me;ht in V||(V[ht]=[]),V[ht].push({...gt,pluginId:oe,extensionPointId:ht})}}return V}readOnly(){return new Tl({registrySubject:this.registrySubject})}}class Ml extends Cl{constructor(V={}){super(V)}mapToRegistry(V,{pluginId:k,configs:oe}){if(!oe)return V;for(const ve of oe){const{id:me,description:Ae,title:We}=ve;if(!me.startsWith(k)){(0,zn.FF)(`Could not register exposed component with id '${me}'. Reason: The component id does not match the id naming convention. Id should be prefixed with plugin id. e.g 'myorg-basic-app/my-component-id/v1'.`);continue}if((0,Na.w_)(me)||(0,zn.FF)(`Exposed component with id '${me}' does not match the convention. It's recommended to suffix the id with the component version. e.g 'myorg-basic-app/my-component-id/v1'.`),V[me]){(0,zn.FF)(`Could not register exposed component with id '${me}'. Reason: An exposed component with the same id already exists.`);continue}if(!We){(0,zn.FF)(`Could not register exposed component with id '${me}'. Reason: Title is missing.`);continue}if(!Ae){(0,zn.FF)(`Could not register exposed component with id '${me}'. Reason: Description is missing.`);continue}k!=="grafana"&&(0,zn.V2)()&&(0,zn.nl)(k,ve)||(V[me]={...ve,pluginId:k})}return V}readOnly(){return new Ml({registrySubject:this.registrySubject})}}function ov(){const F={addedComponentsRegistry:new bl,exposedComponentsRegistry:new Ml,addedLinksRegistry:new Tl};return F.addedLinksRegistry.register({pluginId:"grafana",configs:tv()}),F}var Hi=e(92470),iv=e(34867);function lv(F){const V=Jl(),k=(0,Wr.A)(V.asObservable()),oe=(0,Hi.Q)();return(0,o.useMemo)(()=>{if((0,zn.V2)()&&oe&&(0,zn.xM)(F,oe))return(0,iv.FF)(`usePluginComponent("${F}") - The exposed component ("${F}") is missing from the dependencies[] in the "plugin.json" file.`),{isLoading:!1,component:null};if(!k?.[F])return{isLoading:!1,component:null};const me=k[F];return{isLoading:!1,component:(0,zn.nv)(me.pluginId,me.component)}},[F,oe,k])}function cv({limitPerPlugin:F,extensionPointId:V}){const k=Yl(),oe=(0,Wr.A)(k.asObservable()),ve=(0,Hi.Q)();return(0,o.useMemo)(()=>{const me=(0,zn.V2)()&&ve,Ae=[],We={},$e=ve?.meta.id??"";if(me&&!(0,Na.Fe)({extensionPointId:V,pluginId:$e}))return(0,zn.FF)(`Extension point usePluginComponents("${V}") - the id should be prefixed with your plugin id ("${$e}/").`),{isLoading:!1,components:[]};if(me&&(0,zn.PW)(V,ve))return(0,zn.FF)(`usePluginComponents("${V}") - The extension point is missing from the "plugin.json" file.`),{isLoading:!1,components:[]};for(const tt of oe?.[V]??[]){const{pluginId:at}=tt;F&&We[at]>=F||(We[at]===void 0&&(We[at]=0),Ae.push(tt.component),We[at]+=1)}return{isLoading:!1,components:Ae}},[V,F,ve,oe])}function dv(F){const V=F.addedComponentsRegistry.asObservable(),k=F.addedLinksRegistry.asObservable();return function(ve){const me=(0,Hi.Q)(),Ae=(0,Wr.A)(V),We=(0,Wr.A)(k),{activePluginId:$e}=oc(),{extensionPointId:tt,context:at,limitPerPlugin:ct}=ve,{extensions:Et}=(0,o.useMemo)(()=>{const ht=(0,zn.V2)()&&me!==null,mt=me?.meta.id??"";return!We&&!Ae?{extensions:[],isLoading:!1}:ht&&!(0,Na.Fe)({extensionPointId:tt,pluginId:mt})?((0,zn.FF)(`Extension point usePluginExtensions("${tt}") - the id should be prefixed with your plugin id ("${mt}/").`),{isLoading:!1,extensions:[]}):ht&&(0,zn.PW)(tt,me)?((0,zn.FF)(`Invalid extension point. Reason: The extension point is not declared in the "plugin.json" file. ExtensionPointId: "${tt}"`),{isLoading:!1,extensions:[]}):Yc({extensionPointId:tt,context:at,limitPerPlugin:ct,addedComponentsRegistry:Ae,addedLinksRegistry:We})},[We,Ae,tt,at,ct,$e,me]);return{extensions:Et,isLoading:!1}}}function uv({limitPerPlugin:F,extensionPointId:V,context:k}){const oe=_l(),ve=(0,Hi.Q)(),me=(0,Wr.A)(oe.asObservable());return(0,o.useMemo)(()=>{const Ae=(0,zn.V2)()&&ve!==null,We=ve?.meta.id??"";if(Ae&&!(0,Na.Fe)({extensionPointId:V,pluginId:We}))return(0,zn.FF)(`Extension point usePluginLinks("${V}") - the id should be prefixed with your plugin id ("${We}/").`),{isLoading:!1,links:[]};if(Ae&&(0,zn.PW)(V,ve))return(0,zn.FF)(`Invalid extension point. Reason: The extension point is not declared in the "plugin.json" file. ExtensionPointId: "${V}"`),{isLoading:!1,links:[]};if(!me||!me[V])return{isLoading:!1,links:[]};const $e=k?(0,zn.$Y)(k):{},tt=[],at={};for(const ct of me[V]??[]){const{pluginId:Et}=ct;if(F&&at[Et]>=F)continue;at[Et]===void 0&&(at[Et]=0);const ht=(0,zn.hS)(Et,ct,$e);if(ct.configure&&ht===void 0)continue;const mt=ht?.path||ct.path,gt={id:(0,zn.yt)(Et,V,ct.title),type:io.u.link,pluginId:Et,onClick:(0,zn.dx)(Et,V,ct,$e),icon:ht?.icon||ct.icon,title:ht?.title||ct.title,description:ht?.description||ct.description,path:(0,l.isString)(mt)?(0,zn.YS)(Et,mt,V):void 0,category:ht?.category||ct.category};tt.push(gt),at[Et]+=1}return{isLoading:!1,links:tt}},[k,V,F,me,ve])}var Zc=e(15162);async function qc(F=[],V,k="frontend_plugins_preload"){(0,co.j)(k);const oe=F.filter(me=>me.preload).map(me=>hv(me)),ve=await Promise.all(oe);for(const me of ve){if(me.error){console.error(`[Plugins] Skip loading extensions for "${me.pluginId}" due to an error.`);continue}V.exposedComponentsRegistry.register({pluginId:me.pluginId,configs:me.exposedComponentConfigs}),V.addedComponentsRegistry.register({pluginId:me.pluginId,configs:me.addedComponentConfigs||[]}),V.addedLinksRegistry.register({pluginId:me.pluginId,configs:me.addedLinkConfigs||[]})}(0,co.z)(k)}async function hv(F){const{path:V,version:k,id:oe,loadingStrategy:ve}=F;try{(0,co.j)(`frontend_plugin_preload_${oe}`);const{plugin:me}=await(0,ql.j4)({path:V,version:k,isAngular:F.angular.detected,pluginId:oe,loadingStrategy:ve,moduleHash:F.moduleHash}),{exposedComponentConfigs:Ae=[],addedComponentConfigs:We=[],addedLinkConfigs:$e=[]}=me;return(0,Zl.x)(oe),{pluginId:oe,exposedComponentConfigs:Ae,addedComponentConfigs:We,addedLinkConfigs:$e}}catch(me){return console.error(`[Plugins] Failed to preload plugin: ${V} (version: ${k})`,me),{pluginId:oe,error:me,exposedComponentConfigs:[],addedComponentConfigs:[],addedLinkConfigs:[]}}finally{(0,co.z)(`frontend_plugin_preload_${oe}`)}}var fv=e(57532),ed=e(41987),td=e(65879),gv=e(80924),pv=e(72955),Sl=e(39374);class mv{constructor(){this.subject=new Xc.m(1)}get(){return this.subject.asObservable()}run(V){const{queries:k,timezone:oe,datasource:ve,panelId:me,app:Ae,dashboardUID:We,timeRange:$e,timeInfo:tt,cacheTimeout:at,queryCachingTTL:ct,maxDataPoints:Et,scopedVars:ht,minInterval:mt}=V;this.subscription&&this.subscription.unsubscribe();const gt={app:Ae??ed.Jk.Unknown,requestId:(0,gv.S)(),timezone:oe,panelId:me,dashboardUID:We,range:$e,timeInfo:tt,interval:"",intervalMs:0,targets:(0,l.cloneDeep)(k),maxDataPoints:Et,scopedVars:ht||{},cacheTimeout:at,queryCachingTTL:ct,startTime:Date.now()};gt.rangeRaw=$e.raw,(0,Ma.H)(vv(ve,gt.scopedVars)).pipe((0,fv.$)()).subscribe({next:Vt=>{gt.targets=gt.targets.map(Fn=>(Fn.datasource||(Fn.datasource=Vt.getRef()),Fn));const Cn=mt?(0,Pe.w)().replace(mt,gt.scopedVars):Vt.interval,Mn=td.calculateInterval($e,Et,Cn);gt.scopedVars=Object.assign({},gt.scopedVars,{__interval:{text:Mn.interval,value:Mn.interval},__interval_ms:{text:Mn.intervalMs.toString(),value:Mn.intervalMs}}),gt.interval=Mn.interval,gt.intervalMs=Mn.intervalMs,this.subscription=(0,Sl.BN)(Vt,gt).subscribe({next:Fn=>{const Wn=(0,dr.N$)(Fn,this.lastResult);this.lastResult=(0,pv.B)(Wn,this.lastResult),this.subject.next(this.lastResult)}})},error:Vt=>console.error("PanelQueryRunner Error",Vt)})}cancel(){this.subscription&&(this.subscription.unsubscribe(),this.lastResult&&this.lastResult.state===Dt.Gu.Loading&&this.subject.next({...this.lastResult,state:Dt.Gu.Done}))}destroy(){this.subject&&this.subject.complete(),this.subscription&&this.subscription.unsubscribe()}}async function vv(F,V){return F&&"query"in F?F:(0,uo.tR)().get(F,V)}function yv(){window.grafanaRuntime={getDashboardSaveModel:()=>{const F=(0,cl.UA)().getCurrent();if(F)return F.getSaveModelCloneOld()},getDashboardTimeRange:()=>{const F=(0,yr.jG)().timeRange();return{from:F.from.valueOf(),to:F.to.valueOf(),raw:F.raw}},getPanelData:()=>{const F=(0,cl.UA)().getCurrent();if(F)return F.panels.reduce((V,k)=>(V[k.id]=k.getQueryRunner().getLastResult(),V),{})}}}var xv=e(16757),fi=e(20601),Bn=e(75096),nd=e(22391),Ev=e(27803),sr=e(3843);function sd(F){return F.extended&&"infoText"in F.extended?F.extended:null}function ad(F){return F.extended&&"dataSourceTypes"in F.extended?F.extended:null}function Ol(F){return F.extended&&"dataSource"in F.extended?F.extended:null}var Cs=e(87421),gi=e(26260);const Pv=(F,V)=>{const{rootStateKey:k}=V.variable;if(!k)return console.error("AdHocVariableEditor: variable has no rootStateKey"),{extended:sd(sr.nS)};const{editor:oe}=(0,Cs.nx)(k,F);return{extended:sd(oe)}},Dv={changeVariableDatasource:gi.Iv},Cv=(0,Ra.connect)(Pv,Dv);class bv extends o.PureComponent{constructor(){super(...arguments),this.onDatasourceChanged=V=>{this.props.changeVariableDatasource((0,Bn.jX)(this.props.variable),(0,nd.p$)(V))}}componentDidMount(){const{rootStateKey:V}=this.props.variable;if(!V){console.error("AdHocVariableEditor: variable has no rootStateKey");return}}render(){const{variable:V,extended:k}=this.props;return(0,M.jsx)(Ev.Q,{datasource:V.datasource??void 0,onDataSourceChange:this.onDatasourceChanged,infoText:k?.infoText})}}const Tv=Cv(bv);var rd=e(38401),Al=e(83684);const od=90,id=({datasource:F,onChange:V,disabled:k,filterKey:oe,allFilters:ve})=>{const me=()=>ld(F,oe,ve),Ae=()=>Ov(F,oe,ve);return oe===null?(0,M.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-add-key-wrapper",children:(0,M.jsx)(Al.s,{disabled:k,className:"query-segment-key",Component:Sv,value:oe,onChange:V,loadOptions:me,inputMinWidth:od})}):(0,M.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterKey-key-wrapper",children:(0,M.jsx)(Al.s,{disabled:k,className:"query-segment-key",value:oe,onChange:V,loadOptions:Ae,inputMinWidth:od})})},Gi="-- remove filter --",Mv={label:Gi,value:Gi},Sv=(0,M.jsx)("span",{className:"gf-form-label query-part","aria-label":"Add Filter",children:(0,M.jsx)(Rs.I,{name:"plus"})}),ld=async(F,V,k)=>{const oe=await(0,uo.tR)().get(F);if(!oe||!oe.getTagKeys)return[];const ve=k.filter(We=>We.key!==V),me=await oe.getTagKeys({filters:ve});return(Array.isArray(me)?me:me.data).map(We=>({label:We.text,value:We.text}))},Ov=async(F,V,k)=>{const oe=await ld(F,V,k);return[Mv,...oe]},Av=({datasource:F,disabled:V,onChange:k,filterKey:oe,filterValue:ve,placeHolder:me,allFilters:Ae})=>{const We=(0,xe.of)(Rv),$e=()=>Iv(F,oe,Ae);return(0,M.jsx)("div",{className:"gf-form","data-testid":"AdHocFilterValue-value-wrapper",children:(0,M.jsx)(Al.s,{className:We.segment,disabled:V,placeholder:me,value:ve,onChange:k,loadOptions:$e})})},Iv=async(F,V,k)=>{const oe=await(0,uo.tR)().get(F);if(!oe||!oe.getTagValues)return[];const ve=(0,yr.jG)().timeRange(),me=k.filter($e=>$e.key!==V),Ae=await oe.getTagValues({key:V,filters:me,timeRange:ve});return(Array.isArray(Ae)?Ae:Ae.data).map($e=>({label:$e.text,value:$e.text}))};function Rv(){return{segment:(0,ze.css)({display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"500px"})}}const Lv=["=","!=","<",">","=~","!~"].map(F=>({label:F,value:F})),jv=({value:F,disabled:V,onChange:k})=>(0,M.jsx)(rd.Y,{className:"query-segment-operator",value:F,disabled:V,options:Lv,onChange:k}),cd=({datasource:F,filter:{key:V,operator:k,value:oe},onKeyChange:ve,onOperatorChange:me,onValueChange:Ae,placeHolder:We,allFilters:$e,disabled:tt})=>(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(id,{disabled:tt,datasource:F,filterKey:V,onChange:ve,allFilters:$e}),(0,M.jsx)("div",{className:"gf-form",children:(0,M.jsx)(jv,{disabled:tt,value:k,onChange:me})}),(0,M.jsx)(Av,{disabled:tt,datasource:F,filterKey:V,filterValue:oe,allFilters:$e,onChange:Ae,placeHolder:We})]}),Bv=({datasource:F,appendBefore:V,onCompleted:k,allFilters:oe})=>{const[ve,me]=(0,o.useState)(null),[Ae,We]=(0,o.useState)("="),$e=(0,o.useCallback)(ct=>{if(ct.value!==Gi){me(ct.value??"");return}me(null)},[me]),tt=(0,o.useCallback)(ct=>We(ct.value??""),[We]),at=(0,o.useCallback)(ct=>{k({value:ct.value??"",operator:Ae,key:ve}),me(null),We("=")},[k,Ae,ve]);return ve===null?(0,M.jsx)(id,{datasource:F,filterKey:ve,onChange:$e,allFilters:oe}):(0,M.jsxs)(o.Fragment,{children:[V,(0,M.jsx)(cd,{datasource:F,filter:{key:ve,value:"",operator:Ae},placeHolder:(0,vs.t)("variable.adhoc.placeholder","Select value"),onKeyChange:$e,onOperatorChange:tt,onValueChange:at,allFilters:oe})]},"filter-builder")},dd=({label:F})=>(0,M.jsx)("div",{className:"gf-form",children:(0,M.jsx)("span",{className:"gf-form-label query-keyword",children:F})});class Uv extends o.PureComponent{constructor(){super(...arguments),this.onChange=(V,k)=>oe=>{const{filters:ve}=this.props,{value:me}=oe;return oe.value===Gi?this.props.removeFilter(V):this.props.changeFilter(V,{...ve[V],[k]:me})},this.appendFilterToVariable=V=>{this.props.addFilter(V)}}render(){const{filters:V,disabled:k}=this.props;return(0,M.jsxs)("div",{className:"gf-form-inline",children:[this.renderFilters(V,k),!k&&(0,M.jsx)(Bv,{datasource:this.props.datasource,appendBefore:V.length>0?(0,M.jsx)(dd,{label:"AND"}):null,onCompleted:this.appendFilterToVariable,allFilters:this.getAllFilters()})]})}getAllFilters(){return this.props.baseFilters?this.props.baseFilters.concat(this.props.filters):this.props.filters}renderFilters(V,k){return V.length===0&&k?(0,M.jsx)(rd.Y,{disabled:k,value:"No filters",options:[],onChange:()=>{}}):V.reduce((oe,ve,me)=>(oe.length>0&&oe.push((0,M.jsx)(dd,{label:"AND"},`condition-${me}`)),oe.push(this.renderFilterSegments(ve,me,k)),oe),[])}renderFilterSegments(V,k,oe){return(0,M.jsx)(o.Fragment,{children:(0,M.jsx)(cd,{disabled:oe,datasource:this.props.datasource,filter:V,onKeyChange:this.onChange(k,"key"),onOperatorChange:this.onChange(k,"operator"),onValueChange:this.onChange(k,"value"),allFilters:this.getAllFilters()})},`filter-${k}`)}}const Nv={addFilter:gi.U2,removeFilter:gi.VT,changeFilter:gi.$u},Wv=(0,Ra.connect)(null,Nv);class Fv extends o.PureComponent{constructor(){super(...arguments),this.addFilter=V=>{this.props.addFilter((0,Bn.jX)(this.props.variable),V)},this.removeFilter=V=>{this.props.removeFilter((0,Bn.jX)(this.props.variable),V)},this.changeFilter=(V,k)=>{this.props.changeFilter((0,Bn.jX)(this.props.variable),{index:V,filter:k})}}render(){const{filters:V,datasource:k,baseFilters:oe}=this.props.variable;return(0,M.jsx)(Uv,{datasource:k,filters:V,baseFilters:oe,disabled:this.props.readOnly,addFilter:this.addFilter,removeFilter:this.removeFilter,changeFilter:this.changeFilter})}}const ud=Wv(Fv);ud.displayName="AdHocPicker";var hd=e(53699);const Kv=F=>F.map(V=>zv(V).map($v).join("|")),wv=F=>{if((0,l.isArray)(F))return F.map(fd).filter(Hv);const V=fd(F);return V===null?[]:[V]};function $v(F){return F==null?"":/\|/g[Symbol.replace](F,"__gfp__")}function Vv(F){return F==null?"":/__gfp__/g[Symbol.replace](F,"|")}function zv(F){return[F.key,F.operator,F.value]}function fd(F){if(!(0,l.isString)(F)||F.length===0)return null;const V=F.split("|").map(Vv);return{key:V[0],operator:V[1],value:V[2]}}function Hv(F){return F!==null&&(0,l.isString)(F.value)}const gd=async()=>{},Gv=()=>({id:"adhoc",description:"Add key/value filters on the fly.",name:"Ad hoc filters",initialState:hd.MK,reducer:hd.AA,picker:ud,editor:Tv,dependsOn:()=>!1,setValue:gd,setValueFromUrl:async(F,V)=>{const k=wv(V);await(0,js.JD)((0,gi.D4)((0,Bn.jX)(F),k))},updateOptions:gd,getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,rootStateKey:me,...Ae}=(0,l.cloneDeep)(F);return Ae},getValueForUrl:F=>{const V=F?.filters??[];return Kv(V)}});var Il=e(14644),Qv=e(8866),ia=e(13344),sa=e(24240),pd=e(13288),kv=e(44240),Qi=e(16126),_v=e(38975),Yv=e(67791),Jv=e(66847),Xv=e(69850),Zv=e(62938),_s=e(72401),As=e(48594),Fr=e(12470),pi=e(83370),ho=e(80484);const qv={...ho.Vg,type:"query",datasource:null,query:"",regex:"",sort:Fr.ZG.disabled,refresh:Fr.CO.onDashboardLoad,multi:!1,includeAll:!1,allValue:null,options:[],current:{},definition:""},ey=(F,V)=>{if(V===Fr.ZG.disabled)return F;const k=Math.ceil(V/2),oe=V%2===0;return k===1?F=(0,l.sortBy)(F,"text"):k===2?F=(0,l.sortBy)(F,ve=>{if(!ve.text)return-1;const me=ve.text.match(/.*?(\d+).*/);return!me||me.length<2?-1:parseInt(me[1],10)}):k===3?F=(0,l.sortBy)(F,ve=>(0,l.toLower)(ve.text)):k===4&&F.sort((ve,me)=>ve.text?me.text?ve.text.localeCompare(me.text,void 0,{numeric:!0}):1:-1),oe&&(F=F.reverse()),F},ty=(F,V)=>{const k=[];let oe=null;V.lastIndex=0;do oe=V.exec(F),oe&&k.push(oe);while(V.global&&oe&&oe[0]!==""&&oe[0]!==void 0);return k},ny=(F,V,k)=>{let oe,ve=[];F&&(oe=(0,wt.dO)(F));for(let me=0;me<k.length;me++){const Ae=k[me];let We=Ae.text===void 0||Ae.text===null?Ae.value:Ae.text,$e=Ae.value===void 0||Ae.value===null?Ae.text:Ae.value;if((0,l.isNumber)($e)&&($e=$e.toString()),(0,l.isNumber)(We)&&(We=We.toString()),oe){const tt=ty($e,oe);if(!tt.length)continue;const at=tt.find(mt=>mt.groups&&mt.groups.value),ct=tt.find(mt=>mt.groups&&mt.groups.text),Et=tt.find(mt=>mt.length>1),ht=tt.length>1&&Et;if(at||ct)$e=at?.groups?.value??ct?.groups?.text,We=ct?.groups?.text??at?.groups?.value;else if(ht){for(let mt=0;mt<tt.length;mt++){const gt=tt[mt];ve.push({text:gt[1],value:gt[1],selected:!1})}continue}else Et&&(We=Et[1],$e=Et[1])}ve.push({text:We,value:$e,selected:!1})}return ve=(0,l.uniqBy)(ve,"value"),ey(ve,V)},md=(0,Ga.Z0)({name:"templating/query",initialState:pi.j,reducers:{updateVariableOptions:(F,V)=>{const{results:k,templatedRegex:oe}=V.payload.data,ve=(0,Cs.Fs)(F,V.payload.id);if(ve.type!=="query")return;const{includeAll:me,sort:Ae}=ve,We=ny(oe,Ae,k);me&&We.unshift({text:ia.Zm,value:ia.To,selected:!1}),We.length||We.push({text:ia.ou,value:ia.Ek,isNone:!0,selected:!1}),ve.options=We}}}),sy=md.reducer,{updateVariableOptions:ay}=md.actions;function ry(){return F=>F.pipe((0,bn.T)(oy))}function oy(F){const V=F.series;if(!V||!V.length)return[];if(cy(V))return V;const k=(0,dr.Bt)(V),oe=[];let ve=-1,me=-1,Ae=-1,We=-1;for(const $e of k)for(let tt=0;tt<$e.fields.length;tt++){const at=$e.fields[tt],ct=(0,te.Ct)(at,$e,V).toLowerCase();at.type===Q.PU.string&&Ae===-1&&(Ae=tt),ct==="text"&&at.type===Q.PU.string&&me===-1&&(me=tt),ct==="value"&&at.type===Q.PU.string&&ve===-1&&(ve=tt),ct==="expandable"&&(at.type===Q.PU.boolean||at.type===Q.PU.number)&&We===-1&&(We=tt)}if(Ae===-1)throw new Error("Couldn't find any field of type string in the results.");for(const $e of k)for(let tt=0;tt<$e.length;tt++){const at=We!==-1?$e.fields[We].values[tt]:void 0,ct=$e.fields[Ae].values[tt],Et=me!==-1?$e.fields[me].values[tt]:null,ht=ve!==-1?$e.fields[ve].values[tt]:null;if(ve===-1&&me===-1){oe.push({text:ct,value:ct,expandable:at});continue}if(ve===-1&&me!==-1){oe.push({text:Et,value:Et,expandable:at});continue}if(ve!==-1&&me===-1){oe.push({text:ht,value:ht,expandable:at});continue}oe.push({text:Et,value:ht,expandable:at})}return oe}function iy(F){return V=>V.pipe((0,bn.T)(k=>{const{variable:oe,dispatch:ve,getTemplatedRegexFunc:me}=F;if(!oe.rootStateKey){console.error("updateOptionsState: variable.rootStateKey is not defined");return}const Ae=me(oe),We=(0,Bn.qD)(oe,{results:k,templatedRegex:Ae});ve((0,As.kb)(oe.rootStateKey,ay(We)))}))}function ly(F){return V=>V.pipe((0,qa.Z)(()=>{const{dispatch:k,variable:oe,searchFilter:ve}=F;return ve?(0,xn.of)():(0,Ma.H)(k((0,_s.kl)((0,Bn.jX)(oe))))}))}function cy(F){if(!F)return!1;if(!F.length)return!0;const V=F[0];if((0,dr.ci)(V))return!1;for(const k in V){if(!V.hasOwnProperty(k)||V[k]!==null&&typeof V[k]!="string"&&typeof V[k]!="number")continue;const oe=k.toLowerCase();if(oe==="text"||oe==="value")return!0}return!1}var ki=e(29505),dy=e(43127);class uy{constructor(){this.runners=[new hy,new fy,new gy,new my]}getRunnerForDatasource(V){const k=this.runners.find(oe=>oe.canRun(V));if(k)return k;throw new Error("Couldn't find a query runner that matches supplied arguments.")}isQueryRunnerAvailableForDatasource(V){return this.runners.some(k=>k.canRun(V))}}class hy{constructor(){this.type=ki.Qz.Legacy}canRun(V){return(0,sa.d5)(V)}getTarget({datasource:V,variable:k}){if((0,sa.d5)(V))return k.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:V,variable:k,searchFilter:oe,timeSrv:ve},me){if(!(0,sa.d5)(V))return mi();const Ae=(0,Bn.iP)(k,oe,ve,me.scopedVars);return(0,Ma.H)(V.metricFindQuery(k.query,Ae)).pipe((0,qa.Z)(We=>{if(!We||!We.length)return mi();const $e=We;return(0,xn.of)({series:$e,state:Dt.Gu.Done,timeRange:Ae.range})}))}}class fy{constructor(){this.type=ki.Qz.Standard}canRun(V){return(0,sa.Hf)(V)}getTarget({datasource:V,variable:k}){if((0,sa.Hf)(V))return V.variables.toDataQuery(k.query);throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:V,runRequest:k},oe){return(0,sa.Hf)(V)?V.variables.query?k(V,oe,V.variables.query.bind(V.variables)):k(V,oe):mi()}}class gy{constructor(){this.type=ki.Qz.Custom}canRun(V){return(0,sa.zs)(V)}getTarget({datasource:V,variable:k}){if((0,sa.zs)(V))return k.query;throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:V,runRequest:k},oe){return(0,sa.zs)(V)?k(V,oe,V.variables.query.bind(V.variables)):mi()}}const py="variable-query";class my{constructor(){this.type=ki.Qz.Datasource}canRun(V){return(0,sa.X3)(V)}getTarget({datasource:V,variable:k}){if((0,sa.X3)(V))return{...k.query,refId:k.query.refId??py};throw new Error("Couldn't create a target with supplied arguments.")}runRequest({datasource:V,runRequest:k},oe){return(0,sa.X3)(V)?k(V,oe):mi()}}function mi(){return(0,xn.of)({state:Dt.Gu.Done,series:[],timeRange:(0,dy.E2)()})}class vy{constructor(V={dispatch:js.JD,getState:js.Gu,getVariable:Cs.dn,getTemplatedRegex:Bn.u7,getTimeSrv:yr.jG,queryRunners:new uy,runRequest:Sl.BN}){this.dependencies=V,this.updateOptionsRequests=new zi.B,this.updateOptionsResults=new zi.B,this.cancelRequests=new zi.B,this.onNewRequest=this.onNewRequest.bind(this),this.subscription=this.updateOptionsRequests.subscribe(this.onNewRequest)}queueRequest(V){this.updateOptionsRequests.next(V)}getResponse(V){return this.updateOptionsResults.asObservable().pipe((0,Qi.p)(k=>k.identifier===V))}cancelRequest(V){this.cancelRequests.next({identifier:V})}destroy(){this.subscription.unsubscribe()}onNewRequest(V){const{datasource:k,identifier:oe,searchFilter:ve}=V;try{const{dispatch:me,runRequest:Ae,getTemplatedRegex:We,getVariable:$e,queryRunners:tt,getTimeSrv:at,getState:ct}=this.dependencies,Et=(0,Cs.y7)(ct());this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Loading});const ht=$e(oe,ct());if(ht.type!=="query")return;const mt=at(),gt={variable:ht,datasource:k,searchFilter:ve,timeSrv:mt,runRequest:Ae};if(!tt.isQueryRunnerAvailableForDatasource(k)){const Fn=new Error("Query Runner is not available for datasource.");this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Error,error:Fn});return}const Vt=tt.getRunnerForDatasource(k),Cn=Vt.getTarget({datasource:k,variable:ht}),Mn=this.getRequest(ht,V,Cn);Vt.runRequest(gt,Mn).pipe((0,Qi.p)(()=>{const Fn=(0,Cs.y7)(ct());return Et===Fn}),(0,Qi.p)(Fn=>Fn.state===Dt.Gu.Done||Fn.state===Dt.Gu.Error),(0,_v.s)(1),(0,qa.Z)(Fn=>Fn.state===Dt.Gu.Error?(0,pd.$)(()=>Fn.error):(0,xn.of)(Fn)),ry(),iy({variable:ht,dispatch:me,getTemplatedRegexFunc:We}),ly({variable:ht,dispatch:me,searchFilter:ve}),(0,Yv.Q)((0,kv.h)(this.updateOptionsRequests,this.cancelRequests).pipe((0,Qi.p)(Fn=>{let Wn=!1;return Fn.identifier.id===oe.id&&(Wn=!0,this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Loading,cancelled:Wn})),Wn}))),(0,Jv.W)(Fn=>Fn.cancelled?(0,xn.of)({}):(this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Error,error:Fn}),(0,pd.$)(()=>Fn))),(0,Xv.j)(()=>{this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Done})})).subscribe()}catch(me){this.updateOptionsResults.next({identifier:oe,state:Dt.Gu.Error,error:me})}}getRequest(V,k,oe){const{searchFilter:ve}=k,me={variable:{text:V.current.text,value:V.current.value}},$e={...ve?{searchFilter:{text:ve,value:ve}}:{},...me},tt=this.dependencies.getTimeSrv().timeRange();return{app:ed.Jk.Dashboard,requestId:(0,Zv.A)(),timezone:"",range:tt,interval:"",intervalMs:0,targets:[oe],scopedVars:$e,startTime:Date.now()}}}let vd;function yy(F){vd=F}function Rl(){return vd}const xy=F=>{if(!Ey(F))return F.name;const{current:V}=F;return Array.isArray(V.text)?V.text.join(" + "):V.text},Ey=F=>Array.isArray(F?.options)||typeof F?.current=="object";var Er=(F=>(F[F.moveUp=38]="moveUp",F[F.moveDown=40]="moveDown",F[F.select=32]="select",F[F.cancel=27]="cancel",F[F.selectAndClose=13]="selectAndClose",F))(Er||{});class Py extends o.PureComponent{constructor(){super(...arguments),this.onKeyDown=V=>{if(Er[V.keyCode]&&V.keyCode!==Er.select){const k=V.ctrlKey||V.metaKey||V.shiftKey;this.props.onNavigate(V.keyCode,k),V.preventDefault()}},this.onChange=V=>{this.props.onChange(V.target.value)}}render(){const{value:V,id:k,onNavigate:oe,...ve}=this.props;return(0,M.jsx)("input",{...ve,ref:me=>{me&&(me.focus(),me.setAttribute("style",`width:${Math.max(me.width,150)}px`))},id:k,type:"text",className:"gf-form-input",value:V??"",onChange:this.onChange,onKeyDown:this.onKeyDown,placeholder:(0,vs.t)("variable.dropdown.placeholder","Enter variable value")})}}var Dy=e(89963),Cy=e(46334);const by=({loading:F,disabled:V,onClick:k,text:oe,onCancel:ve,id:me})=>{const Ae=(0,xe.of)(xd),We=(0,o.useCallback)($e=>{$e.stopPropagation(),$e.preventDefault(),k()},[k]);return F?(0,M.jsxs)("div",{className:Ae.container,"data-testid":ra.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${oe}`),title:oe,id:me,children:[(0,M.jsx)(yd,{text:oe}),(0,M.jsx)(Dy.I,{loading:!0,onCancel:ve})]}):(0,M.jsxs)("button",{onClick:We,className:Ae.container,"data-testid":ra.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownValueLinkTexts(`${oe}`),"aria-expanded":!1,"aria-controls":`options-${me}`,id:me,title:oe,disabled:V,children:[(0,M.jsx)(yd,{text:oe}),(0,M.jsx)(Rs.I,{"aria-hidden":!0,name:"angle-down",size:"sm"})]})},yd=({text:F})=>{const V=(0,xe.of)(xd);return(0,M.jsx)("span",{className:V.textAndTags,children:F===ia.Zm?(0,vs.t)("variable.picker.link-all","All"):F})},xd=F=>{const V=(0,Cy.$)(F);return{container:(0,ze.css)({maxWidth:"500px",paddingRight:"10px",padding:F.spacing(0,1),backgroundColor:F.components.input.background,border:`1px solid ${F.components.input.borderColor}`,borderRadius:F.shape.radius.default,display:"flex",alignItems:"center",color:F.colors.text.primary,height:F.spacing(F.components.height.md),[`.${V.badge}`]:{margin:"0 5px"},"&:disabled":{backgroundColor:F.colors.action.disabledBackground,color:F.colors.action.disabledText,border:`1px solid ${F.colors.action.disabledBackground}`}}),textAndTags:(0,ze.css)({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:F.spacing(.25),userSelect:"none"})}};class Ty extends o.PureComponent{constructor(){super(...arguments),this.onToggle=V=>k=>{const oe=k.shiftKey||k.ctrlKey||k.metaKey;this.handleEvent(k),this.props.onToggle(V,oe)},this.onToggleAll=V=>{this.handleEvent(V),this.props.onToggleAll()}}handleEvent(V){V.preventDefault(),V.stopPropagation()}render(){const{multi:V,values:k,highlightIndex:oe,selectedValues:ve,onToggle:me,onToggleAll:Ae,theme:We,...$e}=this.props,tt=Ll(We);return(0,M.jsx)("div",{className:tt.variableValueDropdown,children:(0,M.jsx)("div",{className:tt.variableOptionsWrapper,children:(0,M.jsxs)("ul",{className:tt.variableOptionsColumn,"aria-label":ra.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownDropDown,...$e,children:[this.renderMultiToggle(),k.map((at,ct)=>this.renderOption(at,ct))]})})})}renderOption(V,k){const{highlightIndex:oe,multi:ve,theme:me}=this.props,Ae=Ll(me),We=V.value===ia.To;return(0,M.jsx)("li",{children:(0,M.jsxs)("button",{"data-testid":ra.Tp.components.Variables.variableOption,role:"checkbox",type:"button","aria-checked":V.selected,className:(0,ze.cx)((0,se.my)(me),Ae.variableOption,{[Ae.highlighted]:k===oe,[Ae.variableAllOption]:We},Ae.noStyledButton),onClick:this.onToggle(V),children:[(0,M.jsx)("span",{className:(0,ze.cx)(Ae.variableOptionIcon,{[Ae.variableOptionIconSelected]:V.selected,[Ae.hideVariableOptionIcon]:!ve})}),(0,M.jsx)("span",{"data-testid":ra.Tp.pages.Dashboard.SubMenu.submenuItemValueDropDownOptionTexts(`${V.text}`),children:We?(0,vs.t)("variable.picker.option-all","All"):V.text})]})},`${V.value}`)}renderMultiToggle(){const{multi:V,selectedValues:k,theme:oe,values:ve}=this.props,me=Ll(oe),Ae=ve.some($e=>$e.value===ia.To);if(!V)return null;const We=()=>(0,M.jsx)(vs.x6,{i18nKey:"variable.picker.option-tooltip",children:"Clear selections"});return(0,M.jsx)(Qs.m,{content:We,placement:"top",children:(0,M.jsxs)("button",{className:(0,ze.cx)((0,se.my)(oe),me.variableOption,me.variableOptionColumnHeader,me.noStyledButton,{[me.noPaddingBotton]:Ae}),role:"checkbox","aria-checked":k.length>1?"mixed":"false",onClick:this.onToggleAll,"aria-label":"Toggle all values","data-placement":"top",children:[(0,M.jsx)("span",{className:(0,ze.cx)(me.variableOptionIcon,{[me.variableOptionIconManySelected]:k.length>1})}),(0,M.jsx)(vs.x6,{i18nKey:"variable.picker.option-selected-values",children:"Selected"})," (",k.length,")"]})})}}const Ll=(0,dc.N)(F=>{const V=F.isDark?"public/img/checkbox.png":"public/img/checkbox_white.png";return{hideVariableOptionIcon:(0,ze.css)({display:"none"}),highlighted:(0,ze.css)({backgroundColor:F.colors.action.hover}),noStyledButton:(0,ze.css)({width:"100%",textAlign:"left"}),variableOption:(0,ze.css)({display:"block",padding:"2px 27px 0 8px",position:"relative",whiteSpace:"nowrap",minWidth:"115px","&:hover":{backgroundColor:F.colors.action.hover}}),variableOptionColumnHeader:(0,ze.css)({paddingTop:"5px",paddingBottom:"5px",marginBottom:"5px"}),variableOptionIcon:(0,ze.css)({display:"inline-block",width:"24px",height:"18px",position:"relative",top:"4px",background:`url(${V}) left top no-repeat`}),variableOptionIconManySelected:(0,ze.css)({background:`url(${V}) 0px -36px no-repeat`}),variableOptionIconSelected:(0,ze.css)({background:`url(${V}) 0px -18px no-repeat`}),variableValueDropdown:(0,ze.css)({backgroundColor:F.colors.background.primary,border:`1px solid ${F.colors.border.weak}`,borderRadius:F.shape.borderRadius(2),boxShadow:F.shadows.z2,position:"absolute",top:F.spacing(F.components.height.md),maxHeight:"400px",minHeight:"150px",minWidth:"150px",overflowY:"auto",overflowX:"hidden",zIndex:F.zIndex.typeahead}),variableOptionsColumn:(0,ze.css)({maxHeight:"350px",display:"table-cell",lineHeight:"26px",listStyleType:"none"}),variableOptionsWrapper:(0,ze.css)({display:"table",width:"100%"}),variableAllOption:(0,ze.css)({borderBottom:`1px solid ${F.colors.border.weak}`,paddingBottom:F.spacing(1)}),noPaddingBotton:(0,ze.css)({paddingBottom:0})}}),My=(0,xe.cV)(Ty);var Sy=e(92053),Ed=e(92041),Pr=e(56968),Wa=e(24300);const Oy=(F,V,k)=>async(oe,ve)=>{if(V===Er.cancel)return await oe(_i(F));if(V===Er.select)return oe(jl(F,k));if(V===Er.selectAndClose)return(0,Cs.nx)(F,ve()).optionsPicker.multi?oe(jl(F,k)):(oe(jl(F,k,!0)),oe(_i(F)));if(V===Er.moveDown)return oe((0,As.kb)(F,(0,Wa.O$)(1)));if(V===Er.moveUp)return oe((0,As.kb)(F,(0,Wa.O$)(-1)))},Ay=(F,V="")=>async(k,oe)=>{const{rootStateKey:ve}=F,{id:me,queryValue:Ae}=(0,Cs.nx)(ve,oe()).optionsPicker,We={id:me,rootStateKey:ve,type:"query"},$e=(0,Cs.dn)(We,oe());if(!("options"in $e)||(k((0,As.kb)(ve,(0,Wa.S8)(V))),(0,l.trim)(Ae)===(0,l.trim)(V)))return;const{query:tt,options:at}=$e,ct=typeof tt=="string"?tt:tt.target;return(0,Sy.E)(ct)?jy(k,oe,V,ve):k((0,As.kb)(ve,(0,Wa.fx)(at)))},Iy=async F=>{if((0,Ed.R)(F.current))return;await fi.B.get(F.type).setValue(F,F.current,!0)},_i=(F,V)=>async(k,oe)=>{const ve=(0,Cs.nx)(F,oe()).optionsPicker,me={id:ve.id,rootStateKey:F,type:"query"},Ae=(0,Cs.dn)(me,oe());if(!(0,sa.SP)(Ae))return;const We={option:By(ve)},$e={propName:"queryValue",propValue:ve.queryValue};k((0,As.kb)(F,(0,Pr.dE)((0,Bn.qD)(Ae,We)))),k((0,As.kb)(F,(0,Pr.QP)((0,Bn.qD)(Ae,$e))));const tt=(0,Cs.dn)(me,oe());if((0,sa.SP)(tt)&&(k((0,As.kb)(F,(0,Wa.Fu)())),(0,Bn.Lz)(Ae)!==(0,Bn.Lz)(tt)))return V?V(tt):await Iy(tt)},Ry=(F,V)=>async(k,oe)=>{const{id:ve,rootStateKey:me}=F,Ae=(0,Cs.nx)(me,oe()).optionsPicker;Ae.id&&Ae.id!==ve&&await k(_i(me,V));const We=(0,Cs.dn)(F,oe());(0,sa.SP)(We)&&k((0,As.kb)(me,(0,Wa.MO)(We)))},jl=(F,V,k=!1)=>(oe,ve)=>{const{highlightIndex:me,options:Ae}=(0,Cs.nx)(F,ve()).optionsPicker,We=Ae[me];oe((0,As.kb)(F,(0,Wa.U9)({option:We,forceSelect:k,clearOthers:V})))},Ly=async(F,V,k,oe)=>{try{const{id:ve}=(0,Cs.nx)(oe,V()).optionsPicker,me={id:ve,rootStateKey:oe,type:"query"},Ae=(0,Cs.dn)(me,V());if(!(0,sa.SP)(Ae))return;await fi.B.get(Ae.type).updateOptions(Ae,k);const $e=(0,Cs.dn)(me,V());if(!(0,sa.SP)($e))return;F((0,As.kb)(oe,(0,Wa.qh)($e.options)))}catch(ve){console.error(ve)}},jy=(0,l.debounce)(Ly,500);function By(F){const{options:V,selectedValues:k,queryValue:oe,multi:ve}=F;if(V.length===0&&oe&&oe.length>0)return{text:oe,value:oe,selected:!1};if(!ve)return k.find(We=>We.selected);const me=[],Ae=[];for(const We of k)We.selected&&(me.push(We.text.toString()),Ae.push(We.value.toString()));return{value:Ae,text:me,selected:!0}}const vi=()=>{const F=me=>({...(0,Il.bindActionCreators)({openOptions:Ry,commitChangesToVariable:_i,navigateOptions:Oy},me),filterOrSearchOptions:(Ae,We="")=>{me(Ay(Ae,We))},toggleAllOptions:Ae=>me((0,As.kb)(Ae.rootStateKey,(0,Wa.an)())),toggleOption:(Ae,We,$e,tt)=>me((0,As.kb)(Ae.rootStateKey,(0,Wa.U9)({option:We,clearOthers:$e,forceSelect:tt})))}),V=(me,Ae)=>{const{rootStateKey:We}=Ae.variable;return We?{picker:(0,Cs.nx)(We,me).optionsPicker}:(console.error("OptionPickerFactory: variable has no rootStateKey"),{picker:Wa.$z})},k=(0,Ra.connect)(V,F);class oe extends o.PureComponent{constructor(){super(...arguments),this.onShowOptions=()=>this.props.openOptions((0,Bn.jX)(this.props.variable),this.props.onVariableChange),this.onHideOptions=()=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.commitChangesToVariable(this.props.variable.rootStateKey,this.props.onVariableChange)},this.onToggleOption=(Ae,We)=>{((0,sa.iv)(this.props.variable)&&this.props.variable.multi?this.onToggleMultiValueVariable:this.onToggleSingleValueVariable)(Ae,We)},this.onToggleSingleValueVariable=(Ae,We)=>{this.props.toggleOption((0,Bn.jX)(this.props.variable),Ae,We,!1),this.onHideOptions()},this.onToggleMultiValueVariable=(Ae,We)=>{this.props.toggleOption((0,Bn.jX)(this.props.variable),Ae,We,!1)},this.onToggleAllOptions=()=>{this.props.toggleAllOptions((0,Bn.jX)(this.props.variable))},this.onFilterOrSearchOptions=Ae=>{this.props.filterOrSearchOptions((0,Bn.jX)(this.props.variable),Ae)},this.onNavigate=(Ae,We)=>{if(!this.props.variable.rootStateKey){console.error("Variable has no rootStateKey");return}this.props.navigateOptions(this.props.variable.rootStateKey,Ae,We)},this.onCancel=()=>{Rl().cancelRequest((0,Bn.jX)(this.props.variable))}}render(){const{variable:Ae,picker:We}=this.props,$e=We.id===Ae.id,tt=Uy();return(0,M.jsx)("div",{className:tt.variableLinkWrapper,"data-testid":ra.Tp.components.Variables.variableLinkWrapper,children:$e?this.renderOptions(We):this.renderLink(Ae)})}renderLink(Ae){const We=xy(Ae),$e=Ae.state===Dt.Gu.Loading;return(0,M.jsx)(by,{id:ia.qz+Ae.id,text:We,onClick:this.onShowOptions,loading:$e,onCancel:this.onCancel,disabled:this.props.readOnly})}renderOptions(Ae){const{id:We}=this.props.variable;return(0,M.jsxs)(Qv.N,{onClick:this.onHideOptions,children:[(0,M.jsx)(Py,{id:ia.qz+We,value:Ae.queryValue,onChange:this.onFilterOrSearchOptions,onNavigate:this.onNavigate,"aria-expanded":!0,"aria-controls":`options-${We}`}),(0,M.jsx)(My,{values:Ae.options,onToggle:this.onToggleOption,onToggleAll:this.onToggleAllOptions,highlightIndex:Ae.highlightIndex,multi:Ae.multi,selectedValues:Ae.selectedValues,id:`options-${We}`})]})}}const ve=k(oe);return ve.displayName="OptionsPicker",ve},Uy=()=>({variableLinkWrapper:(0,ze.css)({display:"inline-block",position:"relative"})});var Ny=e(95802);class Wy extends o.PureComponent{constructor(){super(...arguments),this.onChange=V=>{this.props.onPropChange({propName:"query",propValue:V.currentTarget.value,updateOptions:!0})}}render(){return(0,M.jsx)(Ny.d,{constantValue:this.props.variable.query,onChange:this.onChange})}}const Fy={...ho.Vg,type:"constant",hide:Fr.zL.hideVariable,query:"",current:{},options:[]},Pd=(0,Ga.Z0)({name:"templating/constant",initialState:pi.j,reducers:{createConstantOptionsFromQuery:(F,V)=>{const k=(0,Cs.Fs)(F,V.payload.id);k.type==="constant"&&(k.options=[{text:k.query.trim(),value:k.query.trim(),selected:!1}])}}}),Ky=Pd.reducer,{createConstantOptionsFromQuery:wy}=Pd.actions,$y=F=>async V=>{const{rootStateKey:k}=F;await V((0,As.kb)(k,wy((0,Bn.qD)(F)))),await V((0,_s.kl)(F))},Vy=()=>({id:"constant",description:"Define a hidden constant variable, useful for metric prefixes in dashboards you want to share.",name:"Constant",initialState:Fy,reducer:Ky,picker:vi(),editor:Wy,dependsOn:()=>!1,setValue:async(F,V,k=!1)=>{await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)((0,_s.x7)((0,Bn.jX)(F),V))},updateOptions:async F=>{await(0,js.JD)($y((0,Bn.jX)(F)))},getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,current:me,options:Ae,rootStateKey:We,...$e}=(0,l.cloneDeep)(F);return $e},getValueForUrl:F=>F.current.value,beforeAdding:F=>{const{current:V,options:k,query:oe,...ve}=(0,l.cloneDeep)(F),me={selected:!0,text:oe,value:oe};return{...ve,current:me,options:[me],query:oe}}});function zy(F,...V){const k=(0,Ra.connect)(...V)(F);return oe=>(0,M.jsx)(k,{...oe,store:js.M_})}function $E(F,...V){const k=connect(...V)(F);return oe=>jsx(Provider,{store,children:jsx(k,{...oe,store})})}var Hy=e(58711);class Gy extends o.PureComponent{constructor(){super(...arguments),this.onSelectionOptionsChange=async({propName:V,propValue:k})=>{this.props.onPropChange({propName:V,propValue:k,updateOptions:!0})},this.onQueryChange=V=>{this.props.onPropChange({propName:"query",propValue:V.currentTarget.value,updateOptions:!0})}}render(){return(0,M.jsx)(Hy.w,{query:this.props.variable.query,multi:this.props.variable.multi,allValue:this.props.variable.allValue,includeAll:this.props.variable.includeAll,onQueryChange:this.onQueryChange,onMultiChange:V=>this.onSelectionOptionsChange({propName:"multi",propValue:V.currentTarget.checked}),onIncludeAllChange:V=>this.onSelectionOptionsChange({propName:"includeAll",propValue:V.currentTarget.checked}),onAllValueChange:V=>this.onSelectionOptionsChange({propName:"allValue",propValue:V.currentTarget.value})})}}const Qy=(F,V)=>({}),ky={changeVariableMultiValue:_s.TI},_y=zy(Gy,Qy,ky),Yy={...ho.Vg,type:"custom",multi:!1,includeAll:!1,allValue:null,query:"",options:[],current:{}},Dd=(0,Ga.Z0)({name:"templating/custom",initialState:pi.j,reducers:{createCustomOptionsFromQuery:(F,V)=>{const k=(0,Cs.Fs)(F,V.payload.id);if(k.type!=="custom")return;const{includeAll:oe}=k,Ae=(V.payload.data.match(/(?:\\,|[^,])+/g)??[]).map(We=>{We=We.replace(/\\,/g,",");const $e=/^(.+)\s:\s(.+)$/g.exec(We)??[];if($e.length===3){const[,tt,at]=$e;return{text:tt.trim(),value:at.trim(),selected:!1}}else return{text:We.trim(),value:We.trim(),selected:!1}});oe&&Ae.unshift({text:ia.Zm,value:ia.To,selected:!1}),k.options=Ae}}}),Jy=Dd.reducer,{createCustomOptionsFromQuery:Xy}=Dd.actions,Zy=F=>async(V,k)=>{const{rootStateKey:oe}=F,ve=(0,Cs.dn)(F,k());if(ve.type!=="custom")return;const me=(0,Pe.w)().replace(ve.query);await V((0,As.kb)(oe,Xy((0,Bn.qD)(F,me)))),await V((0,_s.kl)(F))},qy=()=>({id:"custom",description:"Define variable values manually",name:"Custom",initialState:Yy,reducer:Jy,picker:vi(),editor:_y,dependsOn:(F,V)=>(0,Bn.wJ)(F.query,V.name),setValue:async(F,V,k=!1)=>{await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)((0,_s.x7)((0,Bn.jX)(F),V))},updateOptions:async F=>{await(0,js.JD)(Zy((0,Bn.jX)(F)))},getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,rootStateKey:me,...Ae}=(0,l.cloneDeep)(F);return Ae},getValueForUrl:F=>(0,Bn.ML)(F)?ia.Zm:F.current.value});var ex=e(98917),tx=e(80147);const nx={...ho.Vg,type:"datasource",current:{},regex:"",options:[],query:"",multi:!1,includeAll:!1,refresh:Fr.CO.onDashboardLoad},Cd=(0,Ga.Z0)({name:"templating/datasource",initialState:pi.j,reducers:{createDataSourceOptions:(F,V)=>{const{sources:k,regex:oe}=V.payload.data,ve=[],me=(0,Cs.Fs)(F,V.payload.id);if(me.type==="datasource"){for(let Ae=0;Ae<k.length;Ae++){const We=k[Ae];(0,tx._)(me.query,We.meta)&&(sx(We,oe)&&ve.push({text:We.name,value:We.uid,selected:!1}),ax(We,oe)&&ve.push({text:"default",value:"default",selected:!1}))}ve.length===0&&ve.push({text:"No data sources found",value:"",selected:!1}),me.includeAll&&ve.unshift({text:ia.Zm,value:ia.To,selected:!1}),me.options=ve}}}});function sx(F,V){return V?V.exec(F.name):!0}function ax(F,V){return F.isDefault?V?V.exec("default"):!0:!1}const rx=Cd.reducer,{createDataSourceOptions:ox}=Cd.actions,ix=(F,V={getDatasourceSrv:uo.tR})=>async(k,oe)=>{const{rootStateKey:ve}=F,me=V.getDatasourceSrv().getList({metrics:!0,variables:!1}),Ae=(0,Cs.dn)(F,oe());if(Ae.type!=="datasource")return;let We;Ae.regex&&(We=(0,Pe.w)().replace(Ae.regex,void 0,"regex"),We=(0,wt.dO)(We)),k((0,As.kb)(ve,ox((0,Bn.qD)(F,{sources:me,regex:We})))),await k((0,_s.kl)(F))},lx=(F,V={getDatasourceSrv:uo.tR})=>k=>{const oe=V.getDatasourceSrv().getList({metrics:!0,variables:!0}),ve=(0,l.chain)(oe).uniqBy("meta.id").map(me=>({text:me.meta.name,value:me.meta.id})).value();ve.unshift({text:"",value:""}),k((0,As.kb)(F,(0,sr.BC)({dataSourceTypes:ve})))},cx=(F,V)=>{const{variable:{rootStateKey:k}}=V;if(!k)return console.error("DataSourceVariableEditor: variable has no rootStateKey"),{extended:ad(sr.nS)};const{editor:oe}=(0,Cs.nx)(k,F);return{extended:ad(oe)}},dx={initDataSourceVariableEditor:lx,changeVariableMultiValue:_s.TI},ux=(0,Ra.connect)(cx,dx);class hx extends o.PureComponent{constructor(){super(...arguments),this.onRegExBlur=V=>{this.props.onPropChange({propName:"regex",propValue:V.currentTarget.value,updateOptions:!0})},this.onSelectionOptionsChange=async({propValue:V,propName:k})=>{this.props.onPropChange({propName:k,propValue:V,updateOptions:!0})},this.onMultiChanged=V=>{this.props.changeVariableMultiValue((0,Bn.jX)(this.props.variable),V.currentTarget.checked)},this.onIncludeAllChanged=V=>{this.onSelectionOptionsChange({propName:"includeAll",propValue:V.currentTarget.checked})},this.onAllValueChanged=V=>{this.onSelectionOptionsChange({propName:"allValue",propValue:V.currentTarget.value})},this.getSelectedDataSourceTypeValue=()=>{const{extended:V}=this.props;if(!V?.dataSourceTypes.length)return"";const k=V.dataSourceTypes.find(ve=>ve.value===this.props.variable.query);return(k?k.value:V.dataSourceTypes[0].value)??""},this.onDataSourceTypeChanged=V=>{this.props.onPropChange({propName:"query",propValue:V.value,updateOptions:!0})}}componentDidMount(){const{rootStateKey:V}=this.props.variable;if(!V){console.error("DataSourceVariableEditor: variable has no rootStateKey");return}this.props.initDataSourceVariableEditor(V)}render(){const{variable:V,extended:k}=this.props,oe=k?.dataSourceTypes?.length?k.dataSourceTypes?.map(ve=>({value:ve.value??"",label:ve.text})):[];return(0,M.jsx)(ex.y,{query:V.query,regex:V.regex,multi:V.multi,includeAll:V.includeAll,optionTypes:oe,onChange:this.onDataSourceTypeChanged,onRegExBlur:this.onRegExBlur,onMultiChange:this.onMultiChanged,onIncludeAllChange:this.onIncludeAllChanged,onAllValueChange:this.onAllValueChanged})}}const fx=ux(hx),gx=()=>({id:"datasource",description:"Enables you to dynamically switch the data source for multiple panels.",name:"Data source",initialState:nx,reducer:rx,picker:vi(),editor:fx,dependsOn:(F,V)=>F.regex?(0,Bn.wJ)(F.regex,V.name):!1,setValue:async(F,V,k=!1)=>{await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)((0,_s.x7)((0,Bn.jX)(F),V))},updateOptions:async F=>{await(0,js.JD)(ix((0,Bn.jX)(F)))},getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,rootStateKey:me,...Ae}=(0,l.cloneDeep)(F);return{...Ae,options:[]}},getValueForUrl:F=>(0,Bn.ML)(F)?ia.Zm:F.current.value});var px=e(25304),mx=e(49317);const bd=(0,o.memo)(({onPropChange:F,variable:V})=>{const k=Ae=>{F({propName:"auto",propValue:Ae.target.checked,updateOptions:!0})},oe=Ae=>{F({propName:"query",propValue:Ae.currentTarget.value,updateOptions:!0})},ve=Ae=>{F({propName:"auto_count",propValue:Ae.value,updateOptions:!0})},me=Ae=>{F({propName:"auto_min",propValue:Ae.currentTarget.value,updateOptions:!0})};return(0,M.jsx)(mx.s,{intervals:V.query,autoStepCount:V.auto_count,autoEnabled:V.auto,onAutoCountChanged:ve,onIntervalsChange:oe,onAutoEnabledChange:k,onAutoMinIntervalChanged:me,autoMinInterval:V.auto_min})});bd.displayName="IntervalVariableEditor";var vx=e(23989),Bl=e(81515);const yx=F=>async V=>{const{rootStateKey:k}=F;await V((0,As.kb)(k,(0,Bl.mn)((0,Bn.qD)(F)))),await V(Ul(F)),await V((0,_s.kl)(F))},Ul=(F,V={calculateInterval:td.calculateInterval,getTimeSrv:yr.jG,templateSrv:(0,vx.w)()})=>(k,oe)=>{const ve=(0,Cs.dn)(F,oe());if(ve.type==="interval"&&ve.auto){const me=V.calculateInterval(V.getTimeSrv().timeRange(),ve.auto_count,ve.auto_min);V.templateSrv.setGrafanaVariable("$__auto_interval_"+ve.name,me.interval),V.templateSrv.setGrafanaVariable("$__auto_interval",me.interval)}},xx=()=>({id:"interval",description:"Define a timespan interval (ex 1m, 1h, 1d)",name:"Interval",initialState:Bl.Ez,reducer:Bl.E5,picker:vi(),editor:bd,dependsOn:()=>!1,setValue:async(F,V,k=!1)=>{await(0,js.JD)(Ul((0,Bn.jX)(F))),await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)(Ul((0,Bn.jX)(F))),await(0,js.JD)((0,_s.x7)((0,Bn.jX)(F),V))},updateOptions:async F=>{await(0,js.JD)(yx((0,Bn.jX)(F)))},getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,rootStateKey:me,...Ae}=(0,l.cloneDeep)(F);return Ae},getValueForUrl:F=>F.current.value});var Ex=e(44890),Px=e(64423),Dx=e(12091),Cx=e(70766);function bx(F,V,k){return{next:ve=>{if(ve.state===Dt.Gu.Error){k.unsubscribe(),V(ve.error);return}if(ve.state===Dt.Gu.Done){k.unsubscribe(),F();return}},error:ve=>{k.unsubscribe(),V(ve)},complete:()=>{k.unsubscribe(),F()}}}const Tx=(F,V)=>async(k,oe)=>{try{const{rootStateKey:ve}=F;if(!(0,Bn.sN)(ve,oe()))return;const me=(0,Cs.dn)(F,oe());if(me.type!=="query")return;(0,Cs.nx)(ve,oe()).editor.id===me.id&&k((0,As.kb)(ve,(0,sr.Eo)({errorProp:"update"})));const Ae=await(0,A.l)().get(me.datasource??"");await new Promise((We,$e)=>{const tt=new Px.yU,at=bx(We,$e,tt),ct=Rl().getResponse(F).subscribe(at);tt.add(ct),Rl().queueRequest({identifier:F,datasource:Ae,searchFilter:V})})}catch(ve){if(ve instanceof Error){const me=(0,Dx.u)(ve),{rootStateKey:Ae}=F;throw(0,Cs.nx)(Ae,oe()).editor.id===F.id&&k((0,As.kb)(Ae,(0,sr.NY)({errorProp:"update",errorText:me.message}))),me}}},Mx=F=>async(V,k)=>{const oe=(0,Cs.dn)(F,k());oe.type==="query"&&await V(Td((0,Bn.jX)(oe),oe.datasource))},Td=(F,V)=>async(k,oe)=>{try{const{rootStateKey:ve}=F,{editor:me}=(0,Cs.nx)(ve,oe()),We=Ol(me)?.dataSource,$e=await(0,A.l)().get(V??"");We&&We.type!==$e?.type&&k((0,As.kb)(ve,(0,Pr.QP)((0,Bn.qD)(F,{propName:"query",propValue:""}))));const tt=await(0,Cx.y)($e);k((0,As.kb)(ve,(0,sr.BC)({dataSource:$e,VariableQueryEditor:tt})))}catch(ve){console.error(ve)}},Sx=(F,V,k)=>async(oe,ve)=>{const{rootStateKey:me}=F,Ae=(0,Cs.dn)(F,ve());if(Ae.type==="query"){if(Ox(Ae.name,V)){const We="Query cannot contain a reference to itself. Variable: $"+Ae.name;oe((0,As.kb)(me,(0,sr.NY)({errorProp:"query",errorText:We})));return}oe((0,As.kb)(me,(0,sr.Eo)({errorProp:"query"}))),oe((0,As.kb)(me,(0,Pr.QP)((0,Bn.qD)(F,{propName:"query",propValue:V})))),k!==void 0?oe((0,As.kb)(me,(0,Pr.QP)((0,Bn.qD)(F,{propName:"definition",propValue:k})))):typeof V=="string"&&oe((0,As.kb)(me,(0,Pr.QP)((0,Bn.qD)(F,{propName:"definition",propValue:V})))),await oe((0,_s.mZ)(F))}};function Ox(F,V){if(typeof V=="string"&&V.match(new RegExp("\\$"+F+"(/| |$)")))return!0;const k=Md(V);for(let oe in k)if(k.hasOwnProperty(oe)){const ve=k[oe];if(typeof ve=="string"&&ve.match(new RegExp("\\$"+F+"(/| |$)")))return!0}return!1}function Md(F){return typeof F!="object"||F===null?{query:F}:Object.keys(F).reduce((oe,ve)=>{const me=F[ve];if(typeof me!="object"||me===null)return oe[ve]=me,oe;const Ae=Md(me);for(let We in Ae)Ae.hasOwnProperty(We)&&(oe[`${ve}_${We}`]=Ae[We]);return oe},{})}const Ax=(F,V)=>{const{rootStateKey:k}=V.variable;if(!k)return console.error("QueryVariableEditor: variable has no rootStateKey"),{extended:Ol(sr.nS)};const{editor:oe}=(0,Cs.nx)(k,F);return{extended:Ol(oe)}},Ix={initQueryVariableEditor:Mx,changeQueryVariableDataSource:Td,changeQueryVariableQuery:Sx,changeVariableMultiValue:_s.TI},Rx=(0,Ra.connect)(Ax,Ix);class Lx extends o.PureComponent{constructor(){super(...arguments),this.state={regex:null,tagsQuery:null,tagValuesQuery:null},this.onDataSourceChange=V=>{this.props.onPropChange({propName:"datasource",propValue:V.isDefault?null:(0,nd.p$)(V)})},this.onLegacyQueryChange=async(V,k)=>{this.props.variable.query!==V&&this.props.changeQueryVariableQuery((0,Bn.jX)(this.props.variable),V,k)},this.onQueryChange=async V=>{if(this.props.variable.query!==V){let k="";V&&V.hasOwnProperty("query")&&typeof V.query=="string"&&(k=V.query),this.props.changeQueryVariableQuery((0,Bn.jX)(this.props.variable),V,k)}},this.onRegExBlur=async V=>{const k=V.currentTarget.value;this.props.variable.regex!==k&&this.props.onPropChange({propName:"regex",propValue:k,updateOptions:!0})},this.onRefreshChange=V=>{this.props.onPropChange({propName:"refresh",propValue:V})},this.onSortChange=async V=>{this.props.onPropChange({propName:"sort",propValue:V.value,updateOptions:!0})},this.onMultiChange=V=>{this.props.onPropChange({propName:"multi",propValue:V.currentTarget.checked})},this.onIncludeAllChange=V=>{this.props.onPropChange({propName:"includeAll",propValue:V.currentTarget.checked})},this.onAllValueChange=V=>{this.props.onPropChange({propName:"allValue",propValue:V.currentTarget.value})}}async componentDidMount(){await this.props.initQueryVariableEditor((0,Bn.jX)(this.props.variable))}componentDidUpdate(V){V.variable.datasource!==this.props.variable.datasource&&this.props.changeQueryVariableDataSource((0,Bn.jX)(this.props.variable),this.props.variable.datasource)}render(){const{extended:V,variable:k}=this.props;if(!V||!V.dataSource)return null;const oe=(0,yr.jG)().timeRange();return(0,M.jsx)(Ex.u,{datasource:k.datasource??void 0,onDataSourceChange:this.onDataSourceChange,query:k.query,onQueryChange:this.onQueryChange,onLegacyQueryChange:this.onLegacyQueryChange,timeRange:oe,regex:k.regex,onRegExChange:this.onRegExBlur,sort:k.sort,onSortChange:this.onSortChange,refresh:k.refresh,onRefreshChange:this.onRefreshChange,isMulti:k.multi,includeAll:k.includeAll,allValue:k.allValue??"",onMultiChange:this.onMultiChange,onIncludeAllChange:this.onIncludeAllChange,onAllValueChange:this.onAllValueChange})}}const jx=Rx(Lx),Bx=()=>({id:"query",description:"Variable values are fetched from a datasource query",name:"Query",initialState:qv,reducer:sy,picker:vi(),editor:jx,dependsOn:(F,V)=>(0,Bn.wJ)(F.query,F.datasource?.uid,F.regex,V.name),setValue:async(F,V,k=!1)=>{await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)((0,_s.x7)((0,Bn.jX)(F),V))},updateOptions:async(F,V)=>{await(0,js.JD)(Tx((0,Bn.jX)(F),V))},getSaveModel:F=>{const{index:V,id:k,state:oe,global:ve,queryValue:me,rootStateKey:Ae,...We}=(0,l.cloneDeep)(F);return F.refresh!==Fr.CO.never?{...We,options:[]}:We},getValueForUrl:F=>(0,Bn.ML)(F)?ia.Zm:F.current.value}),Ux=()=>({id:"system",description:"",name:"system",initialState:{...ho.Vg,type:"system",hide:Fr.zL.hideVariable,skipUrlSync:!0,current:{value:{toString:()=>""}},state:Dt.Gu.Done},reducer:F=>F,picker:null,editor:null,dependsOn:()=>!1,setValue:async(F,V,k=!1)=>{},setValueFromUrl:async(F,V)=>{},updateOptions:async F=>{},getSaveModel:F=>({}),getValueForUrl:F=>""});var Nx=e(58975),Wx=e(14329);function Fx({onPropChange:F,variable:{query:V}}){const k=(0,o.useCallback)((me,Ae)=>{me.preventDefault(),F({propName:"originalQuery",propValue:me.currentTarget.value,updateOptions:!1}),F({propName:"query",propValue:me.currentTarget.value,updateOptions:Ae})},[F]),oe=(0,o.useCallback)(me=>k(me,!1),[k]),ve=(0,o.useCallback)(me=>k(me,!0),[k]);return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Nx.Y,{children:"Text options"}),(0,M.jsx)(Wx._,{value:V,name:"Default value",placeholder:"default value, if any",onChange:oe,onBlur:ve,width:30,testId:ra.Tp.pages.Dashboard.Settings.Variables.Edit.TextBoxVariable.textBoxOptionsQueryInputV2})]})}function Kx({variable:F,onVariableChange:V,readOnly:k}){const oe=(0,Gt.useDispatch)(),[ve,me]=(0,o.useState)(F.current.value);(0,o.useEffect)(()=>{me(F.current.value)},[F]);const Ae=(0,o.useCallback)(()=>{if(!F.rootStateKey){console.error("Cannot update variable without rootStateKey");return}if(F.current.value!==ve){if(oe((0,As.kb)(F.rootStateKey,(0,Pr.QP)((0,Bn.qD)({id:F.id,type:F.type},{propName:"query",propValue:ve})))),V){V({...F,current:(0,Ed.R)(F.current)?{}:{...F.current,value:ve}});return}fi.B.get(F.type).updateOptions(F)}},[F,ve,oe,V]),We=(0,o.useCallback)(at=>me(at.target.value),[me]),$e=at=>Ae(),tt=at=>{at.keyCode===13&&(at.preventDefault(),Ae())};return(0,M.jsx)(Ie.p,{type:"text",value:ve,onChange:We,onBlur:$e,disabled:k,onKeyDown:tt,placeholder:(0,vs.t)("variable.textbox.placeholder","Enter variable value"),id:ia.qz+F.id})}const wx={...ho.Vg,type:"textbox",query:"",current:{},options:[],originalQuery:null},Sd=(0,Ga.Z0)({name:"templating/textbox",initialState:pi.j,reducers:{createTextBoxOptions:(F,V)=>{const k=(0,Cs.Fs)(F,V.payload.id);if(k.type!=="textbox")return;const oe={text:k.query.trim(),value:k.query.trim(),selected:!1};k.options=[oe],k.current=oe}}}),$x=Sd.reducer,{createTextBoxOptions:Vx}=Sd.actions,zx=F=>async(V,k)=>{const{rootStateKey:oe,type:ve}=F;V((0,As.kb)(oe,Vx((0,Bn.qD)(F))));const me=(0,Cs.dn)(F,k());me.type==="textbox"&&await fi.B.get(ve).setValue(me,me.options[0],!0)},Hx=(F,V)=>async(k,oe)=>{const{rootStateKey:ve}=F,me=(0,Cs.dn)(F,oe());if(me.type!=="textbox")return;const Ae=(0,Bn.QT)(V);k((0,As.kb)(ve,(0,Pr.QP)((0,Bn.qD)(me,{propName:"query",propValue:Ae})))),await k((0,_s.x7)((0,Bn.jX)(me),Ae))},Gx=()=>({id:"textbox",description:"Define a textbox variable, where users can enter any arbitrary string",name:"Text box",initialState:wx,reducer:$x,picker:Kx,editor:Fx,dependsOn:(F,V)=>!1,setValue:async(F,V,k=!1)=>{await(0,js.JD)((0,_s.t9)((0,Bn.jX)(F),V,k))},setValueFromUrl:async(F,V)=>{await(0,js.JD)(Hx((0,Bn.jX)(F),V))},updateOptions:async F=>{await(0,js.JD)(zx((0,Bn.jX)(F)))},getSaveModel:(F,V)=>{const{index:k,id:oe,state:ve,global:me,originalQuery:Ae,rootStateKey:We,...$e}=(0,l.cloneDeep)(F);if(F.query!==Ae&&!V){const tt=Ae??"",at={selected:!1,text:tt,value:tt};return{...$e,query:tt,current:at,options:[at]}}return $e},getValueForUrl:F=>F.current.value,beforeAdding:F=>({...(0,l.cloneDeep)(F),originalQuery:F.query})});var Qx=e(10378),Nl=e(55314),Wl=e(72686),Fl=e(59120),Kl=e(8856),kx=e(91219);const _x={navBarTree:kx.I_,navIndex:Fi._h,appNotifications:Fc.g5};var Yx=e(44672),ar=e(88467),rr=e(26627);const Jx=(0,Il.combineReducers)({dataSources:(0,ar.Xw)("dataSources",rr.DC,({rulesSourceName:F})=>F).reducer,promRules:(0,ar.Xw)("promRules",rr.mB,({rulesSourceName:F})=>F).reducer,rulerRules:(0,ar.Xw)("rulerRules",rr.eB,({rulesSourceName:F})=>F).reducer,saveAMConfig:(0,ar.J7)("saveAMConfig",rr.RW).reducer,deleteAMConfig:(0,ar.J7)("deleteAMConfig",rr.nO).reducer,folders:(0,ar.Xw)("folders",rr.Tp,F=>F).reducer,amAlertGroups:(0,ar.Xw)("amAlertGroups",rr.D3,F=>F).reducer,testReceivers:(0,ar.J7)("testReceivers",rr.bO).reducer,managedAlertStateHistory:(0,ar.J7)("managedAlertStateHistory",rr.JH).reducer});var Xx=e(55907);const Zx={items:[],searchQuery:"",isLoading:!1},qx={notificationChannelTypes:[],notificationChannel:{},notifiers:[]};function eE(F,V){const k=Xx.A.getStateDisplayModel(V),oe={...F,stateText:k.text,stateIcon:k.iconClass,stateClass:k.stateClass,stateAge:(0,c.KQ)(F.newStateDate).fromNow(!0)};return oe.state!=="paused"&&(oe.executionError&&(oe.info="Execution Error: "+oe.executionError),oe.evalData&&oe.evalData.noData&&(oe.info="Query returned no data")),oe}const Od=(0,Ga.Z0)({name:"alertRules",initialState:Zx,reducers:{loadAlertRules:F=>({...F,isLoading:!0}),loadedAlertRules:(F,V)=>{const oe=V.payload.map(ve=>eE(ve,ve.state));return{...F,items:oe,isLoading:!1}},setSearchQuery:(F,V)=>({...F,searchQuery:V.payload})}}),Ad=(0,Ga.Z0)({name:"notificationChannel",initialState:qx,reducers:{setNotificationChannels:(F,V)=>({...F,notificationChannelTypes:rE(V.payload),notifiers:V.payload}),notificationChannelLoaded:(F,V)=>{const k=V.payload,ve=F.notifiers.find(me=>me.type===k.type).options.filter(me=>me.secure);return ve.length>0&&ve.some(me=>k.settings[me.propertyName]!=="")?aE(F,V.payload,ve):{...F,notificationChannel:k}},resetSecureField:(F,V)=>({...F,notificationChannel:{...F.notificationChannel,secureFields:{...F.notificationChannel.secureFields,[V.payload]:!1}}})}}),{loadAlertRules:zE,loadedAlertRules:HE,setSearchQuery:GE}=Od.actions,{setNotificationChannels:QE,notificationChannelLoaded:kE,resetSecureField:_E}=Ad.actions,tE=Od.reducer,nE=Ad.reducer,sE={alertRules:tE,notificationChannel:nE,unifiedAlerting:Jx};function aE(F,V,k){const oe={},ve={};return k.forEach(me=>{ve[me.propertyName]=V.settings[me.propertyName],oe[me.propertyName]=""}),{...F,notificationChannel:{...V,settings:{...V.settings,...oe},secureSettings:{...ve}}}}function rE(F){return F.map(V=>({value:V.type,label:V.name,...V,typeName:V.type})).sort((V,k)=>V.name>k.name?1:-1)}var oE=e(93584),iE=e(20604),lE=e(79763),cE=e(53466),dE=e(28601),uE=e(36227),hE=e(54650),fE=e(40823),gE=e(88264),pE=e(10943),mE=e(80095),vE=e(31326),yE=e(81862),xE=e(1936),EE=e(8212),PE=e(34655),DE=e(87617),wl=e(2858),CE=e(97007);const bE={..._x,...sE,...PE.Ay,...oE.Ay,...hE.Ay,...dE.Ay,...Jc.Ay,...uE.Ay,...DE.Ay,...xE.Ay,...yE.Ay,...fE.Ay,...pE.Ay,...lE.Ay,...Yx.Ay,...gE.Ay,...cE.Ay,...mE.Ay,...As.Ay,...EE.Ay,...iE.Ay,plugins:vE.Ff,[oi.H.reducerPath]:oi.H.reducer,[Wl.Sm.reducerPath]:Wl.Sm.reducer,[Nl.cU.reducerPath]:Nl.cU.reducer,[Fl.O5.reducerPath]:Fl.O5.reducer,[wl.g.reducerPath]:wl.g.reducer,[Kl.Aj.reducerPath]:Kl.Aj.reducer},Id={},YE=F=>{Object.assign(Id,F)},TE=()=>{const F=(0,Il.combineReducers)({...bE,...Id});return(V,k)=>{if(k.type!==CE.N.type)return F(V,k);const{cleanupAction:oe}=k.payload;return oe(V),F(V,k)}};function JE(F){addReducer(F)}const ME=(0,Ga.Nc)(),Rd=[];function XE(F){Rd.push(F)}function SE(F){const V=(0,Ga.U1)({reducer:TE(),middleware:k=>k({thunk:!0,serializableCheck:!1,immutableCheck:!1}).concat(ME.middleware,oi.H.middleware,Wl.Sm.middleware,Nl.cU.middleware,Fl.O5.middleware,wl.g.middleware,Kl.Aj.middleware,...Rd),devTools:!1,preloadedState:{navIndex:(0,Fi.s2)(),...F}});return(0,Qx.$k)(V.dispatch),(0,js.k3)(V),V}d().move=z.b;const Ld=e(39572),Yi=Ld.keys().map(F=>Ld(F));class OE{async init(){try{parent.postMessage("GrafanaAppInit","*");const V=(0,vs.JL)(H.Ay.bootData.user.language);V.then(({language:$e})=>(0,H._R)({language:$e})),(0,P.u5)(El.IB),RE(),Ym(),(0,co.j)("frontend_app_init"),(0,c.xS)(H.Ay.bootData.user.locale),(0,c.$D)(H.Ay.bootData.user.weekStart),(0,U.Y)(Y0.m),(0,W.l)(Bf),(0,w.e)(_0.a),(0,m.T)(D.Ny),(0,x.p)(L0),(0,p.G)(()=>H.Ay.bootData.user.timezone),k0(),(0,E.l)(mn.TP.user),(0,R0.initAuthConfig)(),(0,C.H8)(ea.A),await V,AE(),SE(),IE(),I0(),h.D.setInit(Vc.H),h.G.setInit(Vc.u),y.h.setInit(el),fi.B.setInit(()=>[Bx(),qy(),Gx(),Vy(),gx(),xx(),Gv(),Ux()]),f.l.setInit(tl.A),(0,Jm.f)(),(0,b.HC)(()=>new mv),yy(new vy),(0,b.pC)(Sl.BN),(0,T.se)({importPanelPlugin:Zc.TV,getPanelPluginFromCache:Zc.PY}),H.Ay.featureToggles.useSessionStorageForRedirection&&LE(),v.I.initialize({config:H.Ay,getTimeRangeForUrl:(0,yr.jG)().timeRangeForUrl,getVariablesUrlParams:px.z}),document.addEventListener("click",Zm);const k=new uo.xq;if(k.init(H.Ay.datasources,H.Ay.defaultDatasource),(0,A.h)(k),yv(),this.pluginExtensionsRegistries=ov(),mn.TP.user.orgRole!==""){const $e=["cloud-home-app"],tt=Object.values(H.Ay.apps).filter(ct=>$e.includes(ct.id)),at=Object.values(H.Ay.apps).filter(ct=>!$e.includes(ct.id));qc(at,this.pluginExtensionsRegistries),await qc(tt,this.pluginExtensionsRegistries,"frontend_awaited_plugins_preload")}(0,R.cE)(J0(this.pluginExtensionsRegistries)),(0,S.Vu)(dv(this.pluginExtensionsRegistries)),(0,O.q)(uv),(0,j.A)(lv),(0,B.R)(cv);const oe=D.Ny.getSearchObject(),ve=new Jh,me=new S0(D.Ny,ve),Ae=new t0;Ae.start(),ve.setKioskModeFromUrl(oe.kiosk);try{(0,xv.W1)()}catch($e){console.warn("Failed to clean up old expanded folders",$e)}this.context={backend:El.IB,location:D.Ny,chrome:ve,keybindings:me,newAssetsChecker:Ae,config:H.Ay},(0,N._)(Qa.ni),(0,I._)(Qa.k9),(0,Ni.sq)(),(0,u.H)(document.getElementById("reactRoot")).render((0,o.createElement)(jf,{app:this}))}catch(V){console.error("Failed to start Grafana",V),window.__grafana_load_failed()}finally{(0,co.z)("frontend_app_init")}}}function AE(){Yi.length>0&&Yi[0].addExtensionReducers()}function IE(){Yi.length>0&&Yi[0].init()}function RE(){(0,K.H2)(new a0({debug:!1})),window.addEventListener("load",F=>{const V="frontend_boot_load_time_seconds";performance&&(performance.mark(V),yi("first-paint","frontend_boot_","_time_seconds"),yi("first-contentful-paint","frontend_boot_","_time_seconds"),yi(V),yi("frontend_boot_js_done_time_seconds"),yi("frontend_boot_css_time_seconds"))}),mn.TP.user.orgRole!==""&&(0,K.pl)(new o0({})),H.Ay.grafanaJavascriptAgent.enabled&&(0,K.pl)(new P0({...H.Ay.grafanaJavascriptAgent,app:{version:H.Ay.buildInfo.version,environment:H.Ay.buildInfo.env},buildInfo:H.Ay.buildInfo,user:{id:String(H.Ay.bootData.user?.id),email:H.Ay.bootData.user?.email}})),H.Ay.googleAnalyticsId&&(0,K.pl)(new c0({googleAnalyticsId:H.Ay.googleAnalyticsId})),H.Ay.googleAnalytics4Id&&(0,K.pl)(new l0({googleAnalyticsId:H.Ay.googleAnalytics4Id,googleAnalytics4SendManualPageViews:H.Ay.googleAnalytics4SendManualPageViews})),H.Ay.rudderstackWriteKey&&H.Ay.rudderstackDataPlaneUrl&&(0,K.pl)(new d0({writeKey:H.Ay.rudderstackWriteKey,dataPlaneUrl:H.Ay.rudderstackDataPlaneUrl,user:H.Ay.bootData.user,sdkUrl:H.Ay.rudderstackSdkUrl,configUrl:H.Ay.rudderstackConfigUrl,integrationsUrl:H.Ay.rudderstackIntegrationsUrl,buildInfo:H.Ay.buildInfo})),H.Ay.applicationInsightsConnectionString&&(0,K.pl)(new i0({connectionString:H.Ay.applicationInsightsConnectionString,endpointUrl:H.Ay.applicationInsightsEndpointUrl}))}function yi(F,V="",k=""){const oe=d().first(performance.getEntriesByName(F));if(oe){const ve=oe.name.replace(/-/g,"_");(0,r0.n)(`${V}${ve}${k}`,Math.round(oe.startTime)/1e3)}}function LE(){const F=D.Ny.getSearch(),V="redirectTo";if(F.has(V)&&window.location.pathname!=="/"){const ve=F.get(V);window.sessionStorage.setItem(mn.OG,encodeURIComponent(ve)),F.delete(V),window.history.replaceState({},"",`${window.location.pathname}${F.size>0?`?${F}`:""}`);return}if(!mn.TP.user.isSignedIn)return;const k=window.sessionStorage.getItem(mn.OG);if(!k)return;window.sessionStorage.removeItem(mn.OG);const oe=decodeURIComponent(k);oe.startsWith("/goto/")?window.location.replace(oe):D.Ny.replace(oe)}const jE=new OE;window.public_cdn_path&&(e.p=window.public_cdn_path),window.__grafana_public_path__=e.p.substring(0,e.p.lastIndexOf("build/"))||e.p,window.nonce&&(e.nc=window.nonce),window.__grafana_app_bundle_loaded=!0,(async()=>Promise.resolve())().then(()=>{jE.init()})},60021:(_,L,e)=>{"use strict";e.d(L,{Or:()=>n,Oz:()=>a,RC:()=>t,ho:()=>r,nA:()=>s});var t=(g=>(g.Active="active",g.Expired="expired",g.Pending="pending",g))(t||{}),n=(g=>(g.Unprocessed="unprocessed",g.Active="active",g.Suppressed="suppressed",g))(n||{}),r=(g=>(g.equal="=",g.notEqual="!=",g.regex="=~",g.notRegex="!~",g))(r||{}),s=(g=>(g.Internal="internal",g.External="external",g.All="all",g))(s||{}),a=(g=>(g.cortex="cortex",g.mimir="mimir",g.prometheus="prometheus",g))(a||{})},91621:(_,L,e)=>{"use strict";e.d(L,{Dw:()=>g,Rx:()=>r,_M:()=>i,_W:()=>a,d$:()=>n});const t={statistics:[]};var n=(d=>(d[d.Insights=1]="Insights",d[d.Search=0]="Search",d))(n||{}),r=(d=>(d[d.Builder=0]="Builder",d[d.Code=1]="Code",d))(r||{});const s={parameters:[]};var a=(d=>(d.And="and",d.Function="function",d.FunctionParameter="functionParameter",d.GroupBy="groupBy",d.Operator="operator",d.Or="or",d.Property="property",d))(a||{}),g=(d=>(d.String="string",d))(g||{}),i=(d=>(d.CWLI="CWLI",d.PPL="PPL",d.SQL="SQL",d))(i||{});const l={logGroupNames:[],logGroups:[],statsGroups:[]}},25640:(_,L,e)=>{"use strict";e.d(L,{Rx:()=>t.Rx,YZ:()=>n,_M:()=>t._M,b4:()=>r,d$:()=>t.d$});var t=e(91621),n=(s=>(s.Scheduled="Scheduled",s.Running="Running",s.Complete="Complete",s.Failed="Failed",s.Cancelled="Cancelled",s.Timeout="Timeout",s))(n||{}),r=(s=>(s.Regions="regions",s.Namespaces="namespaces",s.Metrics="metrics",s.DimensionKeys="dimensionKeys",s.DimensionValues="dimensionValues",s.EBSVolumeIDs="ebsVolumeIDs",s.EC2InstanceAttributes="ec2InstanceAttributes",s.ResourceArns="resourceARNs",s.Statistics="statistics",s.LogGroups="logGroups",s.Accounts="accounts",s))(r||{})},36666:(_,L,e)=>{"use strict";e.d(L,{A:()=>A});var t=e(74848),n=e(32196),r=e(92145),s=e(55127),a=e.n(s),g=e(96540),i=e(16817),l=e(52622),d=e(21103),o=e(40845),u=e(67061),c=e(88575),p=e(90182),h=e(94354),y=e(15292),f=e(62930),v=e(2913),P=e(14792),m=e(55600),D=e(31193),x=e(48514),E=e(45994);function C(S){return JSON.stringify(S)}function b(S,O){let j=O;return window.__grafanaSceneContext&&window.__grafanaSceneContext instanceof m.H$&&(j=window.__grafanaSceneContext.state.editPanel?.getPanelId()),S===j}const T=[{label:"All data",value:!1},{label:"Annotations",value:!0,description:"Include annotations as regular data"}];function A({data:S,query:O,onChange:j,onRunQuery:B}){const{value:N}=(0,i.A)(()=>(0,D.tR)().get()),I=(0,g.useMemo)(()=>(0,P.UA)().getCurrent()?.getPanelById(O.panelId??-124134),[O.panelId]),{value:K,loading:w}=(0,i.A)(async()=>{if(!I||!S)return[];const ee=await(0,D.tR)().get(I.datasource);return Promise.all(I.targets.map(async ne=>{const Z=ne.datasource?await(0,D.tR)().get(ne.datasource):ee,ae=Z.getQueryDisplayText||C,re=(0,x.E)(S,ne.refId)??S;return{refId:ne.refId,query:ae(ne),name:Z.name,img:Z.meta.info.logos.small,data:re.series,error:re.error}}))},[S,I]),U=(0,g.useCallback)(ee=>{j(ee),B()},[j,B]),W=(0,g.useCallback)(ee=>{U({...O,panelId:ee})},[O,U]),H=(0,g.useCallback)(()=>{U({...O,withTransforms:!O.withTransforms})},[O,U]),z=(0,g.useCallback)(ee=>{U({...O,topic:ee?l.QR.Annotations:void 0})},[O,U]),G=(0,g.useCallback)(ee=>{const ne=ee.datasource??N,Z=(0,D.tR)().getInstanceSettings(ne)?.name,ae=ee.targets.length;return`${ae} ${a()("query",ae)} to ${Z}`},[N]),M=(0,P.UA)().getCurrent(),Q=!!(O.withTransforms||I?.transformations?.length),Y=(0,g.useMemo)(()=>M?.panels.filter(ee=>v.Ay.panels[ee.type]&&ee.targets&&!b(ee.id,M.panelInEdit?.id)&&ee.datasource?.uid!==E.K).map(ee=>({value:ee.id,label:ee.title??"Panel "+ee.id,description:G(ee),imgUrl:v.Ay.panels[ee.type].info.logos.small}))??[],[M,G]),q=(0,o.of)(R),te=(0,r.Bi)();if(!M)return null;if(Y.length<1)return(0,t.jsx)("p",{className:q.noQueriesText,children:"This dashboard does not have any other panels. Add queries to other panels and try again."});const X=Y.find(ee=>ee.value===O.panelId);return(0,t.jsx)(d.i,{children:(0,t.jsxs)(u.B,{direction:"column",children:[(0,t.jsxs)(u.B,{gap:3,children:[(0,t.jsx)(c.D,{label:"Source panel",description:"Use query results from another panel",children:(0,t.jsx)(p.l6,{inputId:te,placeholder:"Choose panel",isSearchable:!0,options:Y,value:X,onChange:ee=>W(ee.value)})}),(0,t.jsx)(c.D,{label:"Data",description:"Use data or annotations from the panel",children:(0,t.jsx)(h.z,{options:T,value:O.topic===l.QR.Annotations,onChange:z})}),Q&&(0,t.jsx)(c.D,{label:"Transform",description:"Apply transformations from the source panel",children:(0,t.jsx)(y.K,{value:!!O.withTransforms,onChange:H})})]}),w?(0,t.jsx)(f.y,{}):(0,t.jsx)(t.Fragment,{children:K&&!!K.length&&(0,t.jsx)(c.D,{label:"Queries from panel",children:(0,t.jsx)(u.B,{direction:"column",children:K.map((ee,ne)=>(0,t.jsxs)(u.B,{alignItems:"center",gap:1,children:[(0,t.jsx)("div",{children:ee.refId}),(0,t.jsx)("img",{src:ee.img,alt:ee.name,title:ee.name,width:16}),(0,t.jsx)("div",{children:ee.query})]},ne))})})})]})})}function R(S){return{noQueriesText:(0,n.css)({padding:S.spacing(1.25)})}}},14348:(_,L,e)=>{"use strict";e.d(L,{K:()=>i.K,kN:()=>l,mw:()=>d});var t=e(88483),n=e(52622),r=e(39070),s=e(43127),a=e(14792),g=e(34214),i=e(45994);function l(p){return p?typeof p=="string"?p===i.K:"meta"in p&&p.meta.name===i.K||p.uid===i.K:!1}function d(p,h){return new t.c(y=>{const f=(0,a.UA)().getCurrent(),v=o(p.queries);if(!v){y.next(u("Missing panel reference ID"));return}let P=f?.getPanelById(v,!0);if(P instanceof g.a||(P=new g.a(P)),!P){y.next(u("Unknown Panel: "+v));return}const m=P.getQueryRunner(),D=m.getData({withTransforms:!!h?.withTransforms,withFieldConfig:!1}).subscribe({next:x=>{h?.topic===n.QR.Annotations&&(x={...x,series:x.annotations??[],annotations:void 0}),y.next(x)}});if(!P.isInView&&P.refreshWhenInView||f?.otherPanelInFullscreen(P)){const{datasource:x,targets:E}=P,C={...p,datasource:x,panelId:v,queries:E};P.refreshWhenInView=!1,m.run(C)}return()=>{D.unsubscribe()}})}function o(p){if(!(!p||!p.length))return p[0].panelId}function u(p){return{state:r.Gu.Error,series:[],request:{},error:{message:p},timeRange:(0,s.E2)()}}var c=e(36666)},45994:(_,L,e)=>{"use strict";e.d(L,{K:()=>t});const t="-- Dashboard --",n="dashboard"},90183:(_,L,e)=>{"use strict";e.d(L,{i:()=>Pe,o:()=>Ie});var t=e(2543),n=e(65474),r=e(62467),s=e(44240),a=e(81160),g=e(89667),i=e(39070),l=e(55004),d=e(37471),o=e(78368),u=e(14236),c=e(26657),p=e(72574),h=e(78731),y=e(17172),f=e(19347),v=e(79056),P=e(14792),m=e(74848),D=e(32196),x=e(96540),E=e(40845),C=e(84167),b=e(88575),T=e(90182),A=e(15292),R=e(99818),S=e(10154),O=e(68706),j=e(95093),B=e.n(j),N=e(91410),I=e(20333),K=e(55852),w=e(67061),U=e(17624),W=e(67459),H=e(79770),z=e(14578),G=e(87266),M=e(16797);const Q="time-of-day-picker-panel",Y=({minuteStep:ge=1,showHour:Se=!0,showSeconds:De=!1,onChange:Ke,value:Me,size:be="auto",disabled:we,disabledHours:Be,disabledMinutes:He,disabledSeconds:Ve,placeholder:Je,format:nt="HH:mm",defaultValue:pt=void 0,allowEmpty:bt=!1,width:Tt})=>{const ye=(0,E.of)(te),je=()=>Tt?(0,D.css)`
        width: ${Tt}px;
      `:(0,G.lH)()[be];return(0,m.jsx)(H.A,{value:Me,defaultValue:pt,onChange:ue=>Ke(ue),showHour:Se,showSecond:De,format:nt,allowEmpty:bt,className:(0,D.cx)(je(),ye.input),popupClassName:(0,D.cx)(ye.picker,Q),minuteStep:ge,inputIcon:(0,m.jsx)(q,{wrapperStyle:ye.caretWrapper}),disabled:we,disabledHours:Be,disabledMinutes:He,disabledSeconds:Ve,placeholder:Je})},q=({wrapperStyle:ge=""})=>(0,m.jsx)("div",{className:ge,children:(0,m.jsx)(z.I,{name:"angle-down"})}),te=ge=>{const Se=ge.components.input.background,De=ge.v1.palette.black,Ke=ge.colors.background.secondary,Me=ge.shape.radius.default,be=ge.components.input.borderColor;return{caretWrapper:(0,D.css)`
      position: absolute;
      right: 8px;
      top: 50%;
      transform: translateY(-50%);
      display: inline-block;
      text-align: right;
      color: ${ge.colors.text.secondary};
    `,picker:(0,D.css)`
      .rc-time-picker-panel-select {
        font-size: 14px;
        background-color: ${Se};
        border-color: ${be};
        li {
          outline-width: 2px;
          &.rc-time-picker-panel-select-option-selected {
            background-color: inherit;
            border: 1px solid ${ge.v1.palette.orange};
            border-radius: ${Me};
          }

          &:hover {
            background: ${Ke};
          }

          &.rc-time-picker-panel-select-option-disabled {
            color: ${ge.colors.action.disabledText};
          }
        }
      }

      .rc-time-picker-panel-inner {
        box-shadow: 0px 4px 4px ${De};
        background-color: ${Se};
        border-color: ${be};
        border-radius: ${Me};
        margin-top: 3px;

        .rc-time-picker-panel-input-wrap {
          margin-right: 2px;

          &,
          .rc-time-picker-panel-input {
            background-color: ${Se};
            padding-top: 2px;
          }
        }

        .rc-time-picker-panel-combobox {
          display: flex;
        }
      }
    `,input:(0,D.css)`
      .rc-time-picker-input {
        background-color: ${Se};
        border-radius: ${Me};
        border-color: ${be};
        height: ${ge.spacing(4)};

        &:focus {
          ${(0,M.focusCss)(ge)}
        }

        &:disabled {
          background-color: ${ge.colors.action.disabledBackground};
          color: ${ge.colors.action.disabledText};
          border: 1px solid ${ge.colors.action.disabledBackground};
          &:focus {
            box-shadow: none;
          }
        }
      }

      .rc-time-picker-clear {
        position: absolute;
        right: 20px;
        top: 50%;
        cursor: pointer;
        overflow: hidden;
        transform: translateY(-50%);
        color: ${ge.colors.text.secondary};
      }
    `}},X=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].map((ge,Se)=>({label:ge,value:Se+1})),ee=({value:ge,onChange:Se})=>{const De=(0,E.of)(ne),Ke=Date.now(),Me=(0,N.QZ)(ge.timezone??"utc",Ke),be=(0,P.UA)().getCurrent()?.getTimezone()===ge.timezone,[we,Be]=(0,x.useState)(!1),He=()=>{Be(!we)},Ve=ue=>{if(!ue)return;const Ee=B()();if(ue){const Ce=ue.split(":");Ee.set("hour",parseInt(Ce[0],10)),Ee.set("minute",parseInt(Ce[1],10))}return Ee},Je=()=>{let ue="Everyday";return ge.fromDayOfWeek&&!ge.toDayOfWeek&&(ue=X[ge.fromDayOfWeek-1].label),ue},nt=()=>{const ue=(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(W.U,{title:Me?.name}),(0,m.jsx)(U.X,{timeZone:ge.timezone,timestamp:Ke})]});return be?(0,m.jsxs)(m.Fragment,{children:["Dashboard timezone (",ue,")"]}):ue},pt=(ue,Ee)=>{const Ce=ue?ue.format("HH:mm"):void 0;Se(Ee==="from"?{...ge,from:Ce}:{...ge,to:Ce})},bt=ue=>{Se({...ge,timezone:ue})},Tt=ue=>{const Ee=ue?ue.value:void 0,Ce=ue?ge.toDayOfWeek:void 0;Se({...ge,fromDayOfWeek:Ee,toDayOfWeek:Ce})},ye=ue=>{Se({...ge,toDayOfWeek:ue?ue.value:void 0})},je=()=>we?(0,m.jsx)(I.U,{value:ge.timezone,includeInternal:!0,onChange:ue=>bt(ue),onBlur:()=>Be(!1),openMenuOnFocus:!1,width:100,autoFocus:!0}):(0,m.jsxs)("div",{className:De.timezoneContainer,children:[(0,m.jsx)("div",{className:De.timezone,children:nt()}),(0,m.jsx)(K.$n,{variant:"secondary",onClick:He,size:"sm",children:"Change timezone"})]});return(0,m.jsxs)(C.n,{className:De.wrapper,children:[(0,m.jsx)(b.D,{label:"From",children:(0,m.jsxs)(w.B,{gap:.5,children:[(0,m.jsx)(T.l6,{options:X,isClearable:!0,placeholder:"Everyday",value:ge.fromDayOfWeek??null,onChange:ue=>Tt(ue),width:20}),(0,m.jsx)(Y,{value:Ve(ge.from),onChange:ue=>pt(ue,"from"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,m.jsx)(b.D,{label:"To",children:(0,m.jsxs)(w.B,{gap:.5,children:[(ge.fromDayOfWeek||ge.toDayOfWeek)&&(0,m.jsx)(T.l6,{options:X,isClearable:!0,placeholder:Je(),value:ge.toDayOfWeek??null,onChange:ue=>ye(ue),width:20}),(0,m.jsx)(Y,{value:Ve(ge.to),onChange:ue=>pt(ue,"to"),allowEmpty:!0,placeholder:"HH:mm",width:100})]})}),(0,m.jsx)(b.D,{label:"Timezone",children:je()})]})},ne=ge=>({wrapper:(0,D.css)({maxWidth:ge.spacing(60),marginBottom:ge.spacing(2)}),timezoneContainer:(0,D.css)`
      padding: 5px;
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      align-items: center;
      font-size: 12px;
    `,timezone:(0,D.css)`
      margin-right: 5px;
    `}),Z="Enabling this returns annotations that match any of the tags specified below",ae=(0,m.jsx)("div",{children:"Specify a list of tags to match. To specify a key and value tag use `key:value` syntax."}),re=[{label:"Dashboard",value:O.St.Dashboard,description:"Query for events created on this dashboard and show them in the panels where they where created"},{label:"Tags",value:O.St.Tags,description:"This will fetch any annotation events that match the tags filter"}],se=[{label:"Annotations & Alerts",value:O.nj.Annotations,description:"Show annotations or alerts managed by grafana"},{label:"Time regions",value:O.nj.TimeRegions,description:"Configure a repeating time region"}],de=[10,50,100,200,300,500,1e3,2e3].map(ge=>({label:String(ge),value:ge}));function le({query:ge,onChange:Se}){const De=ge,{limit:Ke,matchAny:Me,tags:be,type:we,queryType:Be}=De;let He=Be??O.nj.Annotations;const Ve=(0,x.useMemo)(()=>(0,P.UA)().dashboard?.getTimezone(),[]),Je=(0,E.of)(he),nt=ue=>Se({...De,type:ue.value}),pt=ue=>Se({...De,limit:ue.value}),bt=ue=>Se({...De,matchAny:ue.target.checked}),Tt=ue=>Se({...De,tags:ue}),ye=ue=>{const Ee={...De,queryType:ue.value};Ee.queryType===O.nj.TimeRegions?Ee.timeRegion||(Ee.timeRegion={timezone:Ve}):delete Ee.timeRegion,Se(Ee)},je=ue=>{Se({...De,timeRegion:ue})};return(0,m.jsxs)(C.n,{className:Je.container,children:[(0,m.jsx)(b.D,{label:"Query type",children:(0,m.jsx)(T.l6,{inputId:"grafana-annotations__query-type",options:se,value:He,onChange:ye})}),He===O.nj.Annotations&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(b.D,{label:"Filter by",children:(0,m.jsx)(T.l6,{inputId:"grafana-annotations__filter-by",options:re,value:we,onChange:nt})}),(0,m.jsx)(b.D,{label:"Max limit",children:(0,m.jsx)(T.l6,{inputId:"grafana-annotations__limit",width:16,options:de,value:Ke,onChange:pt})}),we===O.St.Tags&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(b.D,{label:"Match any",description:Z,children:(0,m.jsx)(A.d,{id:"grafana-annotations__match-any",value:Me,onChange:bt})}),(0,m.jsx)(b.D,{label:"Tags",description:ae,children:(0,m.jsx)(R.$,{allowCustomValue:!0,inputId:"grafana-annotations__tags",onChange:Tt,tagOptions:S.vy,tags:be??[]})})]})]}),He===O.nj.TimeRegions&&De.timeRegion&&(0,m.jsx)(ee,{value:De.timeRegion,onChange:je})]})}const he=ge=>({container:(0,D.css)({maxWidth:ge.spacing(60),marginBottom:ge.spacing(2)})});var ie=e(11261),J=e(94515);function ce(ge,Se,De,Ke){if(!Se)return;const Me=(0,J.iU)(Se,De);if(!Me.length)return;const be=[],we=[],Be=[],He=Se.timezone??Ke;for(const Ve of Me){let Je=Ve.from,nt=Ve.to;const pt=(0,N.QZ)(He,Je);if(pt){const bt=pt.offsetInMins*60*1e3;Je+=bt,nt+=bt}be.push(Je),we.push(nt),Be.push(ge)}return{fields:[{name:"time",type:ie.PU.time,values:be,config:{}},{name:"timeEnd",type:ie.PU.time,values:we,config:{}},{name:"text",type:ie.PU.string,values:Be,config:{}}],length:be.length}}let pe=100;class Pe extends c.iy{constructor(Se){super(Se),this.annotations={QueryEditor:le,prepareAnnotation(De){return De.target=De.target??{type:De.type??O.St.Dashboard,limit:De.limit??100,tags:De.tags??[],matchAny:De.matchAny??!1},De},prepareQuery(De){let Ke;if((0,t.isString)(De.datasource)){const we=(0,v.og)(De.datasource,{returnDefaultAsNull:!1});we&&(Ke=we)}else Ke=De.datasource;const{filter:Me,...be}=De;return{...be,refId:De.name,queryType:O.nj.Annotations,datasource:Ke}}}}getDefaultQuery(){return{queryType:O.nj.RandomWalk}}query(Se){const De=[],Ke=[],Me=(0,p.w)();for(const be of Se.targets){if(be.queryType===O.nj.Annotations)return(0,n.H)(this.getAnnotations({range:Se.range,rangeRaw:Se.range.raw,annotation:be,dashboard:(0,P.UA)().getCurrent()}));if(!be.hide){if(be.queryType===O.nj.Snapshot){De.push((0,r.of)({data:(be.snapshot??[]).map(we=>(0,g.or)(we)),state:i.Gu.Done}));continue}if(be.queryType===O.nj.TimeRegions){const we=ce("",be.timeRegion,Se.range,Se.timezone);De.push((0,r.of)({data:we?[we]:[],state:i.Gu.Done}));continue}if(be.queryType===O.nj.LiveMeasurements){let we=Me.replace(be.channel,Se.scopedVars);const{filter:Be}=be,He=(0,l.DG)(we);if(!(0,l.aj)(He))continue;const Ve={maxLength:Se.maxDataPoints??500};be.buffer?(Ve.maxDelta=be.buffer,Ve.maxLength=Ve.maxLength*2):Se.rangeRaw?.to==="now"&&(Ve.maxDelta=Se.range.to.valueOf()-Se.range.from.valueOf()),De.push((0,h.oF)().getDataStream({key:`${Se.requestId}.${pe++}`,addr:He,filter:Be,buffer:Ve}))}else be.queryType||(be.queryType=O.nj.RandomWalk),Ke.push(be)}}return Ke.length&&De.push(super.query({...Se,targets:Ke})),De.length?De.length===1?De[0]:(0,s.h)(...De):(0,r.of)()}listFiles(Se,De){return this.query({targets:[{refId:"A",queryType:O.nj.List,path:Se}],maxDataPoints:De}).pipe((0,a.T)(Ke=>{const Me=Ke.data[0]??new d.k;return new o.R(Me)}))}metricFindQuery(){return Promise.resolve([])}async getAnnotations(Se){const De=Se.annotation.target;if(De?.queryType===O.nj.TimeRegions){const Be=ce(Se.annotation.name,De.timeRegion,Se.range,(0,P.UA)().getCurrent()?.timezone);return Promise.resolve({data:Be?[Be]:[]})}const Ke=Se.annotation,Me=Ke.target,be={from:Se.range.from.valueOf(),to:Se.range.to.valueOf(),limit:Me.limit,tags:Me.tags,matchAny:Me.matchAny};if(Me.type===O.St.Dashboard){if(!Se.dashboard?.uid)return Promise.resolve({data:[]});be.dashboardUID=Se.dashboard.uid,delete be.tags}else{if(!Array.isArray(Me.tags)||Me.tags.length===0)return Promise.resolve({data:[]});const Be=(0,p.w)(),He="__delimiter__",Ve=[];for(const Je of be.tags){const nt=Be.replace(Je,{},pt=>typeof pt=="string"?pt:pt.join(He));for(const pt of nt.split(He))Ve.push(pt)}be.tags=Ve}const we=await(0,y.AI)().get("/api/annotations",be,`grafana-data-source-annotations-${Ke.name}-${Se.dashboard?.uid}`);return{data:[(0,u.Vc)(we)]}}testDatasource(){return Promise.resolve({message:"",status:""})}}async function Ie(){return await(0,f.l)().get("-- Grafana --")}},68706:(_,L,e)=>{"use strict";e.d(L,{St:()=>s,dx:()=>r,nj:()=>t,uJ:()=>n});var t=(a=>(a.LiveMeasurements="measurements",a.Annotations="annotations",a.Snapshot="snapshot",a.TimeRegions="timeRegions",a.RandomWalk="randomWalk",a.List="list",a.Read="read",a.Search="search",a.SearchNext="searchNext",a))(t||{});const n={refId:"A",queryType:"randomWalk"},r={refId:"A",datasource:{type:"grafana",uid:"grafana"},queryType:"snapshot",snapshot:[]};var s=(a=>(a.Dashboard="dashboard",a.Tags="tags",a))(s||{})},90478:(_,L,e)=>{"use strict";e.d(L,{H:()=>i,j:()=>d});var t=e(89667),n=e(28138),r=e(57220),s=e(40489),a=e(28444),g=e(68706);function i(o,u){return new Promise(c=>{if(o.datasource?.uid===r.vv){l(u,o),c(!0);return}n.A.publish(new a.bY({title:"Change to panel embedded data",text:"If you want to change the data shown in this panel Grafana will need to remove the panels current query and replace it with a snapshot of the current data. This enables you to edit the data.",yesText:"Continue",icon:"pen",onConfirm:()=>{l(u,o),c(!0)},onDismiss:()=>{c(!1)}}))})}function l(o,u){const c=o.map(h=>(0,t.Nw)(h)),p={refId:"A",queryType:g.nj.Snapshot,snapshot:c,datasource:{uid:r.vv}};u.updateQueries({dataSource:{uid:r.vv},queries:[p]}),u.refresh()}function d(o){return(u,c,p)=>{s.vI(u).subscribe(async h=>{const y=[];h.dataFrames.forEach(f=>{const v=(0,t.Nw)(f);y.push(v)}),o({...g.dx,snapshot:y,file:h.file},c)})}}},64100:(_,L,e)=>{"use strict";e.d(L,{Q$:()=>r,U3:()=>n,ti:()=>s});var t=(a=>(a.Builder="builder",a.Code="code",a))(t||{}),n=(a=>(a.Instant="instant",a.Range="range",a.Stream="stream",a))(n||{}),r=(a=>(a.DataSample="dataSample",a.InfiniteScroll="infiniteScroll",a.LogsSample="logsSample",a.LogsVolume="logsVolume",a))(r||{}),s=(a=>(a.Backward="backward",a.Forward="forward",a))(s||{})},71713:(_,L,e)=>{"use strict";e.d(L,{AW:()=>g,Ay:()=>l,RQ:()=>s,dZ:()=>t,fV:()=>a,vB:()=>i});const t=[{label:"avg",insertText:"avg",documentation:"Calculate the average over dimensions"},{label:"bottomk",insertText:"bottomk",documentation:"Smallest k elements by sample value"},{label:"count",insertText:"count",documentation:"Count number of elements in the vector"},{label:"max",insertText:"max",documentation:"Select maximum over dimensions"},{label:"min",insertText:"min",documentation:"Select minimum over dimensions"},{label:"stddev",insertText:"stddev",documentation:"Calculate population standard deviation over dimensions"},{label:"stdvar",insertText:"stdvar",documentation:"Calculate population standard variance over dimensions"},{label:"sum",insertText:"sum",documentation:"Calculate sum over dimensions"},{label:"topk",insertText:"topk",documentation:"Largest k elements by sample value"}],n=[{label:"json",insertText:"json",documentation:"Extracting labels from the log line using json parser."},{label:"regexp",insertText:'regexp ""',documentation:"Extracting labels from the log line using regexp parser.",move:-1},{label:"logfmt",insertText:"logfmt",documentation:"Extracting labels from the log line using logfmt parser."},{label:"pattern",insertText:"pattern",documentation:"Extracting labels from the log line using pattern parser. Only available in Loki 2.3+."},{label:"unpack",insertText:"unpack",detail:"unpack identifier",documentation:'Parses a JSON log line, unpacking all embedded labels in the pack stage. A special property "_entry" will also be used to replace the original log line. Only available in Loki 2.2+.'}],r=[{label:"unwrap",insertText:"unwrap",detail:"unwrap identifier",documentation:"Take labels and use the values as sample data for metric aggregations."},{label:"label_format",insertText:"label_format",documentation:"Use to rename, modify or add labels. For example, | label_format foo=bar ."},{label:"line_format",insertText:"line_format",documentation:'Rewrites log line content. For example, | line_format "{{.query}} {{.duration}}" .'}],s=[{insertText:"avg_over_time",label:"avg_over_time",detail:"avg_over_time(range-vector)",documentation:"The average of all values in the specified interval."},{insertText:"bytes_over_time",label:"bytes_over_time",detail:"bytes_over_time(range-vector)",documentation:"Counts the amount of bytes used by each log stream for a given range"},{insertText:"bytes_rate",label:"bytes_rate",detail:"bytes_rate(range-vector)",documentation:"Calculates the number of bytes per second for each stream."},{insertText:"first_over_time",label:"first_over_time",detail:"first_over_time(range-vector)",documentation:"The first of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"last_over_time",label:"last_over_time",detail:"last_over_time(range-vector)",documentation:"The last of all values in the specified interval. Only available in Loki 2.3+."},{insertText:"sum_over_time",label:"sum_over_time",detail:"sum_over_time(range-vector)",documentation:"The sum of all values in the specified interval."},{insertText:"count_over_time",label:"count_over_time",detail:"count_over_time(range-vector)",documentation:"The count of all values in the specified interval."},{insertText:"max_over_time",label:"max_over_time",detail:"max_over_time(range-vector)",documentation:"The maximum of all values in the specified interval."},{insertText:"min_over_time",label:"min_over_time",detail:"min_over_time(range-vector)",documentation:"The minimum of all values in the specified interval."},{insertText:"quantile_over_time",label:"quantile_over_time",detail:"quantile_over_time(scalar, range-vector)",documentation:"The \u03C6-quantile (0 \u2264 \u03C6 \u2264 1) of the values in the specified interval."},{insertText:"rate",label:"rate",detail:"rate(v range-vector)",documentation:"Calculates the number of entries per second."},{insertText:"stddev_over_time",label:"stddev_over_time",detail:"stddev_over_time(range-vector)",documentation:"The population standard deviation of the values in the specified interval."},{insertText:"stdvar_over_time",label:"stdvar_over_time",detail:"stdvar_over_time(range-vector)",documentation:"The population standard variance of the values in the specified interval."}],a=[{insertText:"vector",label:"vector",detail:"vector(scalar)",documentation:"Returns the scalar as a vector with no labels."}],g=[...t,...s,...a],i={comment:{pattern:/#.*/},"context-aggregation":{pattern:/((without|by)\s*)\([^)]*\)/,lookbehind:!0,inside:{"label-key":{pattern:/[^(),\s][^,)]*[^),\s]*/,alias:"attr-name"},punctuation:/[()]/}},"context-labels":{pattern:/\{[^}]*(?=}?)/,greedy:!0,inside:{comment:{pattern:/#.*/},"label-key":{pattern:/[a-zA-Z_]\w*(?=\s*(=|!=|=~|!~))/,alias:"attr-name",greedy:!0},"label-value":{pattern:/"(?:\\.|[^\\"])*"/,greedy:!0,alias:"attr-value"},punctuation:/[{]/}},"context-pipe":{pattern:/\s\|[^=~]\s?\w*/i,inside:{"pipe-operator":{pattern:/\|/i,alias:"operator"},"pipe-operations":{pattern:new RegExp(`${[...n,...r].map(d=>d.label).join("|")}`,"i"),alias:"keyword"}}},function:new RegExp(`\\b(?:${g.map(d=>d.label).join("|")})(?=\\s*\\()`,"i"),"context-range":[{pattern:/\[[^\]]*(?=\])/,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}},{pattern:/(offset\s+)\w+/,lookbehind:!0,inside:{"range-duration":{pattern:/\b\d+[smhdwy]\b/i,alias:"number"}}}],quote:{pattern:/"(?:\\.|[^\\"])*"/,alias:"string",greedy:!0},backticks:{pattern:/`(?:\\.|[^\\`])*`/,alias:"string",greedy:!0},number:/\b-?\d+((\.\d*)?([eE][+-]?\d+)?)?\b/,operator:/\s?(\|[=~]?|!=?|<(?:=>?|<|>)?|>[>=]?)\s?/i,punctuation:/[{}(),.]/},l=i},13137:(_,L,e)=>{"use strict";e.d(L,{HD:()=>r,Q$:()=>t.Q$,U3:()=>t.U3,ie:()=>s,ti:()=>t.ti});var t=e(64100),n=(a=>(a.Stream="streams",a.Vector="vector",a.Matrix="matrix",a))(n||{}),r=(a=>(a.Indexed="I",a.StructuredMetadata="S",a.Parsed="P",a))(r||{}),s=(a=>(a[a.LabelNames=0]="LabelNames",a[a.LabelValues=1]="LabelValues",a))(s||{})},14678:(_,L,e)=>{"use strict";e.d(L,{N8:()=>m,qM:()=>P,uv:()=>v});var t=e(2543),n=e.n(t),r=e(62467),s=e(65474),a=e(45650),g=e(69862),i=e(81160),l=e(9084),d=e(66847),o=e(93031),u=e(71030),c=e(40187),p=e(39070),h=e(72574),y=e(19347),f=e(12091);const v="-- Mixed --",P=(x,E)=>`mixed-${x}-${E||""}`;class m extends c.mA{constructor(E){super(E)}query(E){const C=E.targets.filter(A=>A.datasource?.uid!==v);if(!C.length)return(0,r.of)({data:[]});const b=(0,t.groupBy)(C,"datasource.uid"),T=[];for(const A in b)T.push(...this.getBatchesForQueries(b[A],E));return T.length?this.batchQueries(T,E):(0,r.of)({data:[]})}getBatchesForQueries(E,C){const b=E[0].datasource,T=[],A=(0,h.w)().replace(b?.uid,C.scopedVars,(R,S)=>{if(!Array.isArray(R))return R;for(const O of R){if(O==="default")continue;const j=(0,y.l)().getInstanceSettings(O);T.push({datasource:(0,y.l)().get(O),queries:(0,t.cloneDeep)(E),scopedVars:{...C.scopedVars,[S.name]:{value:O,text:j?.name}}})}return""});return A!==""&&T.push({datasource:(0,y.l)().get(A),queries:(0,t.cloneDeep)(E),scopedVars:{...C.scopedVars}}),T}batchQueries(E,C){const b=E.filter(this.isQueryable).map((T,A)=>(0,s.H)(T.datasource).pipe((0,g.Z)(R=>{const S=(0,t.cloneDeep)(C);return S.requestId=P(A,S.requestId),S.targets=T.queries,S.scopedVars=T.scopedVars,(0,s.H)(R.query(S)).pipe((0,i.T)(O=>({...O,data:O.data||[],state:p.Gu.Loading,key:P(A,O.key)})),(0,l.$)(),(0,d.W)(O=>(O=(0,f.u)(O),O.message=`${R.name}: ${O.message}`,(0,r.of)([{data:[],state:p.Gu.Error,error:O,key:P(A,S.requestId)}]))))})));return(0,a.p)(b).pipe(D(),(0,i.T)(this.finalizeResponses),(0,o.U)())}testDatasource(){return Promise.resolve({message:"",status:""})}isQueryable(E){return E&&Array.isArray(E.queries)&&E.queries.length>0}finalizeResponses(E){const{length:C}=E;if(C===0)return E;const b=E.find(T=>T.state===p.Gu.Error);return b?E.push(b):E[C-1].state=p.Gu.Done,E}}function D(){return(0,u.T)((x,E)=>E.reduce((C,b)=>(C.push.apply(C,b),C),x),[])}},19071:(_,L,e)=>{"use strict";e.d(L,{cd:()=>z,xw:()=>N});var t=e(37471),n=e(11261);const r={filters:[],groupBy:[]};var s=(se=>(se.Done="done",se.Error="error",se.Pending="pending",se.Streaming="streaming",se))(s||{}),a=(se=>(se.Raw="raw",se.Spans="spans",se.Traces="traces",se))(a||{}),g=(se=>(se.Intrinsic="intrinsic",se.Resource="resource",se.Span="span",se.Unscoped="unscoped",se))(g||{});function i(se){const{nodes:de,edges:le}=l(se),[he,ie]=makeFrames();for(const J of de)he.add(J);for(const J of le)ie.add(J);return[he,ie]}function l(se){const de=[],le=[],he=new DataFrameView(se),ie=d(he),J=makeSpanMap(ce=>{if(ce>=se.length)return;const pe=he.get(ce);return{span:{...pe},id:pe.spanID,parentIds:pe.parentSpanID?[pe.parentSpanID]:[]}});for(let ce=0;ce<he.length;ce++){const pe=he.get(ce),Pe=J[pe.spanID].children.map(De=>{const Ke=J[De].span;return[Ke.startTime,Ke.startTime+Ke.duration]}),Ie=getNonOverlappingDuration(Pe),ge=pe.duration-Ie,Se=getStats(pe.duration,ie,ge);de.push({[Fields.id]:pe.spanID,[Fields.title]:pe.serviceName??"",[Fields.subTitle]:pe.operationName,[Fields.mainStat]:Se.main,[Fields.secondaryStat]:Se.secondary,[Fields.color]:ge/ie}),pe.parentSpanID&&J[pe.parentSpanID].span&&le.push({[Fields.id]:pe.parentSpanID+"--"+pe.spanID,[Fields.target]:pe.spanID,[Fields.source]:pe.parentSpanID})}return{nodes:de,edges:le}}function d(se){let de=0,le=1/0;for(let he=0;he<se.length;he++){const ie=se.get(he);ie.startTime<le&&(le=ie.startTime),ie.startTime+ie.duration>de&&(de=ie.startTime+ie.duration)}return de-le}const o="traces_service_graph_request_server_seconds_sum",u="traces_service_graph_request_total",c="traces_service_graph_request_failed_total",p="traces_service_graph_request_server_seconds_bucket",h={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:[]},y={expr:"sum(rate(traces_spanmetrics_calls_total{}[$__range])) by (span_name)",topk:5,params:['status_code="STATUS_CODE_ERROR"']},f={expr:"histogram_quantile(.9, sum(rate(traces_spanmetrics_latency_bucket{}[$__range])) by (le))",params:[]},v='span_kind="SPAN_KIND_SERVER"',P=[o,u,c,p];function m(se,de){const le=x(se),he={},ie={};return C(le[u],"total",u,he,ie),C(le[o],"seconds",o,he,ie),C(le[c],"failed",c,he,ie),b(he,ie,de)}function D(){function se(he,ie){return new MutableDataFrame({name:he,fields:ie,meta:{preferredVisualisationType:"nodeGraph"}})}const de=se("Nodes",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.title,type:FieldType.string,config:{displayName:"Service name"},values:[]},{name:Fields.subTitle,type:FieldType.string,config:{displayName:"Service namespace"},values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]},{name:Fields.arc+"success",type:FieldType.number,config:{displayName:"Success",color:{fixedColor:"green",mode:FieldColorModeId.Fixed}},values:[]},{name:Fields.arc+"failed",type:FieldType.number,config:{displayName:"Failed",color:{fixedColor:"red",mode:FieldColorModeId.Fixed}},values:[]}]),le=se("Edges",[{name:Fields.id,type:FieldType.string,values:[]},{name:Fields.source,type:FieldType.string,values:[]},{name:"sourceName",type:FieldType.string,values:[]},{name:"sourceNamespace",type:FieldType.string,values:[]},{name:Fields.target,type:FieldType.string,values:[]},{name:"targetName",type:FieldType.string,values:[]},{name:"targetNamespace",type:FieldType.string,values:[]},{name:Fields.mainStat,type:FieldType.number,config:{unit:"ms/r",displayName:"Average response time"},values:[]},{name:Fields.secondaryStat,type:FieldType.number,config:{unit:"r/sec",displayName:"Requests per second"},values:[]}]);return[de,le]}function x(se){return(se[0]?.data||[]).reduce((de,le)=>{const he=toDataFrame(le);return de[he.refId??"A"]=new DataFrameView(he),de},{})}var E=(se=>(se.sourceName="sourceName",se.sourceNamespace="sourceNamespace",se.targetName="targetName",se.targetNamespace="targetNamespace",se))(E||{});function C(se,de,le,he,ie){if(!se)return;const J=`Value #${le}`;for(let ce=0;ce<se.length;ce++){const pe=se.get(ce),Pe=pe.server_service_namespace?`${pe.server_service_namespace}/${pe.server}`:pe.server,Ie=pe.client_service_namespace?`${pe.client_service_namespace}/${pe.client}`:pe.client,ge=`${Ie}_${Pe}`;ie[ge]?ie[ge][de]=(ie[ge][de]||0)+pe[J]:ie[ge]={target:Pe,targetName:pe.server,targetNamespace:pe.server_service_namespace,source:Ie,sourceName:pe.client,sourceNamespace:pe.client_service_namespace,[de]:pe[J]},he[Pe]?he[Pe][de]=(he[Pe][de]||0)+pe[J]:he[Pe]={name:pe.server,namespace:pe.server_service_namespace,[de]:pe[J]},he[Ie]||(he[Ie]={name:pe.client,namespace:pe.client_service_namespace,[de]:0})}}function b(se,de,le){const[he,ie]=D();for(const J of Object.keys(se)){const ce=se[J];he.add({[Fields.id]:J,[Fields.title]:ce.name,[Fields.subTitle]:ce.namespace,[Fields.mainStat]:ce.total?ce.seconds/ce.total*1e3:Number.NaN,[Fields.secondaryStat]:ce.total?Math.round(ce.total*100)/100:Number.NaN,[Fields.arc+"success"]:ce.total?(ce.total-Math.min(ce.failed||0,ce.total))/ce.total:1,[Fields.arc+"failed"]:ce.total?Math.min(ce.failed||0,ce.total)/ce.total:0})}for(const J of Object.keys(de)){const ce=de[J];ie.add({[Fields.id]:J,[Fields.source]:ce.source,sourceName:ce.sourceName,sourceNamespace:ce.sourceNamespace,[Fields.target]:ce.target,targetName:ce.targetName,targetNamespace:ce.targetNamespace,[Fields.mainStat]:ce.total?ce.seconds/ce.total*1e3:Number.NaN,[Fields.secondaryStat]:ce.total?Math.round(ce.total*100)/100:Number.NaN})}return{nodes:he,edges:ie}}function T(se){if(se.stringValue)return se.stringValue;if(se.boolValue!==void 0)return!!se.boolValue;if(se.intValue!==void 0)return Number.parseInt(String(se.intValue),10);if(se.doubleValue)return Number.parseFloat(String(se.doubleValue));if(se.arrayValue){const de=[];for(const le of se.arrayValue.values)de.push(T(le));return de}return""}function A(se){const de=[];let le="OTLPResourceNoServiceName";if(!se)return{serviceName:le,serviceTags:de};for(const he of se.attributes)he.key===SemanticResourceAttributes.SERVICE_NAME&&(le=he.value.stringValue||le),de.push({key:he.key,value:T(he.value)});return{serviceName:le,serviceTags:de}}function R(se){const de=[];if(se.attributes)for(const le of se.attributes)de.push({key:le.key,value:T(le.value)});return de}function S(se){let de;if(se.kind){const le=se.kind.toString().toLowerCase().split("_");de=le.length?le[le.length-1]:se.kind.toString()}return de}function O(se){const de=[];if(se.links)for(const le of se.links){const{traceId:he,spanId:ie}=le,J=[];if(le.attributes)for(const ce of le.attributes)J.push({key:ce.key,value:T(ce.value)});de.push({traceID:he,spanID:ie,tags:J})}return de}function j(se){const de=[];if(se.events)for(const le of se.events){const he=[];if(le.attributes)for(const ie of le.attributes)he.push({key:ie.key,value:T(ie.value)});de.push({fields:he,timestamp:le.timeUnixNano/1e6,name:le.name})}return de}function B(se,de=!1){const le=new MutableDataFrame({fields:[{name:"traceID",type:FieldType.string,values:[]},{name:"spanID",type:FieldType.string,values:[]},{name:"parentSpanID",type:FieldType.string,values:[]},{name:"operationName",type:FieldType.string,values:[]},{name:"serviceName",type:FieldType.string,values:[]},{name:"kind",type:FieldType.string,values:[]},{name:"statusCode",type:FieldType.number,values:[]},{name:"statusMessage",type:FieldType.string,values:[]},{name:"instrumentationLibraryName",type:FieldType.string,values:[]},{name:"instrumentationLibraryVersion",type:FieldType.string,values:[]},{name:"traceState",type:FieldType.string,values:[]},{name:"serviceTags",type:FieldType.other,values:[]},{name:"startTime",type:FieldType.number,values:[]},{name:"duration",type:FieldType.number,values:[]},{name:"logs",type:FieldType.other,values:[]},{name:"references",type:FieldType.other,values:[]},{name:"tags",type:FieldType.other,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}});try{for(const ie of se){const{serviceName:J,serviceTags:ce}=A(ie.resource);for(const pe of ie.instrumentationLibrarySpans)for(const Pe of pe.spans)le.add({traceID:Pe.traceId.length>16?Pe.traceId.slice(16):Pe.traceId,spanID:Pe.spanId,parentSpanID:Pe.parentSpanId||"",operationName:Pe.name||"",serviceName:J,kind:S(Pe),statusCode:Pe.status?.code,statusMessage:Pe.status?.message,instrumentationLibraryName:pe.instrumentationLibrary?.name,instrumentationLibraryVersion:pe.instrumentationLibrary?.version,traceState:Pe.traceState,serviceTags:ce,startTime:Pe.startTimeUnixNano/1e6,duration:(Pe.endTimeUnixNano-Pe.startTimeUnixNano)/1e6,tags:R(Pe),logs:j(Pe),references:O(Pe)})}}catch(ie){return console.error(ie),{error:{message:"JSON is not valid OpenTelemetry format: "+ie},data:[]}}let he=[le];return de&&he.push(...createGraphFrames(le)),{data:he}}function N(se){let de={batches:[]},le={};for(let he=0;he<se.length;he++){const ie=se.get(he);le[ie.serviceName]||(le[ie.serviceName]=de.batches.length,de.batches.push({resource:{attributes:[],droppedAttributesCount:0},instrumentationLibrarySpans:[{spans:[]}]}));let J=le[ie.serviceName];de.batches[J].resource.attributes.length===0&&(de.batches[J].resource.attributes=K(ie.serviceTags)),de.batches[J].instrumentationLibrarySpans[0].instrumentationLibrary||ie.instrumentationLibraryName&&(de.batches[J].instrumentationLibrarySpans[0].instrumentationLibrary={name:ie.instrumentationLibraryName,version:ie.instrumentationLibraryVersion?ie.instrumentationLibraryVersion:""}),de.batches[J].instrumentationLibrarySpans[0].spans.push({traceId:ie.traceID.padStart(32,"0"),spanId:ie.spanID,parentSpanId:ie.parentSpanID||"",traceState:ie.traceState||"",name:ie.operationName,kind:I(ie.kind),startTimeUnixNano:ie.startTime*1e6,endTimeUnixNano:(ie.startTime+ie.duration)*1e6,attributes:ie.tags?K(ie.tags):[],droppedAttributesCount:0,droppedEventsCount:0,droppedLinksCount:0,status:U(ie),events:W(ie.logs),links:H(ie.references)})}return de}function I(se){let de;if(se)switch(se){case"server":de="SPAN_KIND_SERVER";break;case"client":de="SPAN_KIND_CLIENT";break;case"producer":de="SPAN_KIND_PRODUCER";break;case"consumer":de="SPAN_KIND_CONSUMER";break;case"internal":de="SPAN_KIND_INTERNAL";break}return de}function K(se){return se.reduce((de,le)=>[...de,{key:le.key,value:w(le)}],[])}function w(se){if(typeof se.value=="string")return{stringValue:se.value};if(typeof se.value=="boolean")return{boolValue:se.value};if(typeof se.value=="number")return se.value%1===0?{intValue:se.value}:{doubleValue:se.value};if(typeof se.value=="object"&&Array.isArray(se.value)){const de=[];for(const le of se.value)de.push(w(le));return{arrayValue:{values:de}}}return{stringValue:se.value}}function U(se){let de;return se.statusCode!==void 0&&(de={code:se.statusCode,message:se.statusMessage?se.statusMessage:""}),de}function W(se){if(!se||!se.length)return;let de=[];for(const le of se){let he={timeUnixNano:le.timestamp*1e6,attributes:[],droppedAttributesCount:0,name:le.name||""};for(const ie of le.fields)he.attributes.push({key:ie.key,value:w(ie)});de.push(he)}return de}function H(se){if(!se||!se.length)return;let de=[];for(const le of se){let he={traceId:le.traceID,spanId:le.spanID,attributes:[],droppedAttributesCount:0};if(le.tags?.length)for(const ie of le.tags)he.attributes?.push({key:ie.key,value:w(ie)});de.push(he)}return de}const z="Related profiles";function G(se,de,le=!1){const he=se.data[0];if(!he)return re;const J=de?.jsonData?.tracesToProfiles;let ce;if(J?.datasourceUid&&(ce=getDataSourceSrv().getInstanceSettings(J.datasourceUid)),J&&ce){const Pe=J.customQuery?J.query:void 0,Ie={title:z,url:"",internal:{datasourceUid:ce.uid,datasourceName:ce.name,query:{labelSelector:Pe||"{${__tags}}",groupBy:[],profileTypeId:J.profileTypeId??"",queryType:"profile",spanSelector:['${__span.tags["pyroscope.profile.id"]}'],refId:"profile"}},origin:DataLinkConfigOrigin.Datasource};he.fields.forEach(ge=>{ge.name==="tags"&&(ge.config.links=[Ie])})}let pe=[...se.data];return le&&pe.push(...createGraphFrames(toDataFrame(he))),{...se,data:pe}}function M(se){return{traceID:se.traceID,startTime:parseInt(se.startTimeUnixNano,10)/1e6,traceDuration:se.durationMs,traceService:se.rootServiceName||"",traceName:se.rootTraceName||""}}const Q=se=>se.stringValue?`"${se.stringValue}"`:""+(se.intValue||se.doubleValue||se.boolValue||'""');function Y(se,de){return de.series.map((he,ie)=>{const J={};he.labels?.forEach(pe=>{J[pe.key]=Q(pe.value)});let ce=de.series.length===1?se:"";return he.labels&&(he.labels.length===1?ce=Q(he.labels[0].value):ce=`{${he.labels.map(pe=>`${pe.key}=${Q(pe.value)}`).join(", ")}}`),createDataFrame({refId:ce||`A${ie}`,fields:[{name:"time",type:FieldType.time,values:he.samples.map(pe=>parseInt(pe.timestampMs,10))},{name:ce,labels:J,type:FieldType.number,values:he.samples.map(pe=>pe.value),config:{displayNameFromDS:ce}}],meta:{preferredVisualisationType:"graph"}})})}function q(se,de,le){switch(le){case SearchTableType.Spans:return ee(se,de);case SearchTableType.Raw:return te(se);default:return X(se,de)}}function te(se){return[createDataFrame({name:"Raw response",refId:"raw",fields:[{name:"response",type:FieldType.string,values:[JSON.stringify(se,null,2)]}]})]}function X(se,de){const le=createDataFrame({name:"Traces",refId:"traces",fields:[{name:"traceID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Trace ID",custom:{width:200},links:[{title:"Trace: ${__value.raw}",url:"",internal:{datasourceUid:de.uid,datasourceName:de.name,query:{query:"${__value.raw}",queryType:"traceql"}}}]}},{name:"startTime",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Service"}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Name"}},{name:"traceDuration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ms",custom:{width:120}}},{name:"nested",type:FieldType.nestedFrames}],meta:{preferredVisualisationType:"table",uniqueRowIdFields:[0]}});return se?.length?(le.length=se.length,se.sort((he,ie)=>parseInt(ie?.startTimeUnixNano,10)/1e6-parseInt(he?.startTimeUnixNano,10)/1e6).forEach(he=>{const ie=M(he);le.fields[0].values.push(ie.traceID),le.fields[1].values.push(ie.startTime),le.fields[2].values.push(ie.traceService),le.fields[3].values.push(ie.traceName),le.fields[4].values.push(ie.traceDuration?ie.traceDuration:"<1ms"),he.spanSets?le.fields[5].values.push(he.spanSets.map(J=>Z(he,J,de))):he.spanSet&&le.fields[5].values.push([Z(he,he.spanSet,de)])}),[le]):[le]}function ee(se,de){const le={};let he=!1;se?.forEach(J=>ne(J).forEach(ce=>{ce.attributes?.forEach(pe=>{le[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key}}}),ce.spans.forEach(pe=>{pe.name&&(he=!0),pe.attributes?.forEach(Pe=>{le[Pe.key]={name:Pe.key,type:FieldType.string,config:{displayNameFromDS:Pe.key}}})})}));const ie=new MutableDataFrame({name:"Spans",refId:"traces",fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}}},{name:"traceService",type:FieldType.string,config:{displayNameFromDS:"Trace Service",custom:{width:200}}},{name:"traceName",type:FieldType.string,config:{displayNameFromDS:"Trace Name",custom:{width:200}}},{name:"spanID",type:FieldType.string,config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:de.uid,datasourceName:de.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time"}},{name:"name",type:FieldType.string,config:{displayNameFromDS:"Name",custom:{hidden:!he}}},...Object.values(le).sort((J,ce)=>J.name.localeCompare(ce.name)),{name:"duration",type:FieldType.number,config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}});return!se||!se.length?[ie]:(se.sort((J,ce)=>parseInt(ce?.startTimeUnixNano,10)/1e6-parseInt(J?.startTimeUnixNano,10)/1e6).forEach(J=>{ne(J).forEach(ce=>{ce.spans.forEach(pe=>{ie.add(ae(pe,ce,J))})})}),[ie])}const ne=se=>se.spanSets||(se.spanSet?[se.spanSet]:[]),Z=(se,de,le)=>{const he={};let ie=!1;de.attributes?.map(pe=>{he[pe.key]={name:pe.key,type:FieldType.string,config:{displayNameFromDS:pe.key},values:[]}}),de.spans.forEach(pe=>{pe.name&&(ie=!0),pe.attributes?.forEach(Pe=>{he[Pe.key]={name:Pe.key,type:FieldType.string,config:{displayNameFromDS:Pe.key},values:[]}})});const J=new MutableDataFrame({fields:[{name:"traceIdHidden",type:FieldType.string,config:{custom:{hidden:!0}},values:[]},{name:"spanID",type:FieldType.string,values:[],config:{unit:"string",displayNameFromDS:"Span ID",custom:{width:200},links:[{title:"Span: ${__value.raw}",url:"",internal:{datasourceUid:le.uid,datasourceName:le.name,query:{query:"${__data.fields.traceIdHidden}",queryType:"traceql"},panelsState:{trace:{spanId:"${__value.raw}"}}}}]}},{name:"time",type:FieldType.time,config:{displayNameFromDS:"Start time",custom:{width:200}}},{name:"name",type:FieldType.string,values:[],config:{displayNameFromDS:"Name",custom:{hidden:!ie}}},...Object.values(he).sort((pe,Pe)=>pe.name.localeCompare(Pe.name)),{name:"duration",type:FieldType.number,values:[],config:{displayNameFromDS:"Duration",unit:"ns",custom:{width:120}}}],meta:{preferredVisualisationType:"table"}}),ce=createTheme();for(const pe of J.fields)pe.display=getDisplayProcessor({field:pe,theme:ce});return de.spans.forEach(pe=>{J.add(ae(pe,de,se))}),J};function ae(se,de,le){const he=parseInt(se.startTimeUnixNano,10)/1e6,ie={traceIdHidden:le.traceID,traceService:le.rootServiceName||"",traceName:le.rootTraceName||"",spanID:se.spanID,time:he,duration:parseInt(se.durationNanos,10),name:se.name};let J=[];return de.attributes&&(J=J.concat(de.attributes)),se.attributes&&(J=J.concat(se.attributes)),J.forEach(ce=>{(ce.value.boolValue||ce.value.Value?.bool_value)&&(ie[ce.key]=ce.value.boolValue||ce.value.Value?.bool_value),(ce.value.doubleValue||ce.value.Value?.double_value)&&(ie[ce.key]=ce.value.doubleValue||ce.value.Value?.double_value),(ce.value.intValue||ce.value.Value?.int_value)&&(ie[ce.key]=ce.value.intValue||ce.value.Value?.int_value),(ce.value.stringValue||ce.value.Value?.string_value)&&(ie[ce.key]=ce.value.stringValue||ce.value.Value?.string_value)}),ie}const re={data:[new t.k({fields:[{name:"trace",type:n.PU.trace,values:[]}],meta:{preferredVisualisationType:"trace",custom:{traceFormat:"otlp"}}})]}},64861:(_,L,e)=>{"use strict";e.d(L,{nE:()=>s,r6:()=>r,xB:()=>t});var t=(a=>(a[a.AlphaAsc=1]="AlphaAsc",a[a.AlphaDesc=2]="AlphaDesc",a[a.Importance=3]="Importance",a[a.TimeAsc=4]="TimeAsc",a[a.TimeDesc=5]="TimeDesc",a))(t||{}),n=(a=>(a.Current="current",a.RecentChanges="changes",a))(n||{}),r=(a=>(a.Default="default",a.Custom="custom",a))(r||{}),s=(a=>(a.List="list",a.Stat="stat",a))(s||{})},6781:(_,L,e)=>{"use strict";e.d(L,{d:()=>D,l:()=>x});var t=e(74848),n=e(2543),r=e(96540),s=e(47070),a=e(56323),g=e(52622),i=e(97696),l=e(59796),d=e(67266),o=e(12509),u=e(2913),c=e(28240),p=e(11261),h=e(8066),y=e(40845),f=e(96516),v=e(16895);const P=(0,r.memo)(({data:E,placement:C,calcs:b,displayMode:T,...A})=>{const R=(0,y.$j)();let S=[];return(0,c.Fm)(E),E.forEach((O,j)=>{O.fields.forEach((B,N)=>{const I=N+1;if(B.type===p.PU.time||B.config.custom?.hideFrom?.legend)return;const K=B.state?.displayName??B.name,w=(0,h.lz)(B,R).color,U={label:K.toString(),color:w,yAxis:B.config.custom?.axisPlacement===g.vM.Right?2:1,disabled:B.state?.hideFrom?.viz,getDisplayValues:()=>(0,v.UO)(b,B,R),getItemKey:()=>`${K}-${j}-${I}`};S.push(U)})}),(0,t.jsx)(d.KU.Legend,{placement:C,...A,children:(0,t.jsx)(f.t,{placement:C,items:S,displayMode:T,sortBy:A.sortBy,sortDesc:A.sortDesc,isSortable:!0})})});P.displayName="BarGaugeLegend";var m=e(17516);class D extends r.PureComponent{constructor(){super(...arguments),this.renderComponent=(C,b)=>{const{options:T,fieldConfig:A}=this.props,{value:R,alignmentFactors:S,orientation:O,width:j,height:B,count:N}=C,{field:I,display:K,view:w,colIndex:U}=R,{openMenu:W,targetClassName:H}=b;let z;return w&&(0,n.isNumber)(U)&&(z=w.getFieldDisplayProcessor(U)),(0,t.jsx)(i.xE,{value:x(N,A.defaults,K),width:j,height:B,orientation:O,field:I,text:T.text,display:z,theme:u.$W.theme2,itemSpacing:this.getItemSpacing(),displayMode:T.displayMode,onClick:W,className:H,alignmentFactors:N>1?S:void 0,showUnfilled:T.showUnfilled,valueDisplayMode:T.valueMode,namePlacement:T.namePlacement})},this.renderValue=C=>{const{value:b,orientation:T}=C,{hasLinks:A,getLinks:R}=b;return A&&R?(0,t.jsx)("div",{style:{width:"100%",display:T===s.wV.Vertical?"flex":"initial"},children:(0,t.jsx)(l.e,{style:{height:"100%"},links:R,children:S=>this.renderComponent(C,S)})}):this.renderComponent(C,{})},this.getValues=()=>{const{data:C,options:b,replaceVariables:T,fieldConfig:A,timeZone:R}=this.props;return(0,a.PI)({fieldConfig:A,reduceOptions:b.reduceOptions,replaceVariables:T,theme:u.$W.theme2,data:C.series,timeZone:R})}}getItemSpacing(){return this.props.options.displayMode==="lcd"?2:10}getOrientation(){const{options:C,width:b,height:T}=this.props,{orientation:A}=C;return A===s.wV.Auto?b>T?s.wV.Vertical:s.wV.Horizontal:A}calcBarSize(){const{options:C}=this.props,b=this.getOrientation(),T=C.sizing===g.T6.Manual,A=b===s.wV.Vertical,R=b===s.wV.Horizontal,S=T&&A?C.minVizWidth:m.K.minVizWidth,O=T&&R?C.minVizHeight:m.K.minVizHeight,j=T&&R?C.maxVizHeight:m.K.maxVizHeight;return{minVizWidth:S,minVizHeight:O,maxVizHeight:j}}getLegend(){const{options:C,data:b}=this.props,{legend:T}=C;return T.showLegend&&b&&b.series.length>0?(0,t.jsx)(P,{data:b.series,...T}):null}render(){const{height:C,width:b,options:T,data:A,renderCounter:R}=this.props,{minVizWidth:S,minVizHeight:O,maxVizHeight:j}=this.calcBarSize();return(0,t.jsx)(d.KU,{width:b,height:C,legend:this.getLegend(),children:(B,N)=>(0,t.jsx)(o.S,{source:A,getAlignmentFactors:a.XS,getValues:this.getValues,renderValue:this.renderValue,renderCounter:R,width:B,height:N,maxVizHeight:j,minVizWidth:S,minVizHeight:O,itemSpacing:this.getItemSpacing(),orientation:T.orientation})})}}function x(E,C,b){return E===1&&!C.displayName?{...b,title:void 0}:b}},17516:(_,L,e)=>{"use strict";e.d(L,{K:()=>n});var t=e(52622);const n={displayMode:t.eX.Gradient,maxVizHeight:300,minVizHeight:16,minVizWidth:8,namePlacement:t.TZ.Auto,showUnfilled:!0,sizing:t.T6.Auto,valueMode:t.$l.Color}},14738:(_,L,e)=>{"use strict";e.r(L),e.d(L,{plugin:()=>E});var t=e(65158),n=e(52622),r=e(71242),s=e(23799),a=e(63250);const g=C=>(0,a._$)(C),i=(C,b,T)=>{const A=(0,a.gl)(C,b,T);if(b==="singlestat"&&T.angular){const R=T.angular.gauge;R&&(A.showThresholdMarkers=R.thresholdMarkers,A.showThresholdLabels=R.thresholdLabels)}return A};var l=e(74848),d=e(96540),o=e(57875),u=e(56323),c=e(95164),p=e(59796),h=e(12509),y=e(2913),f=e(6781);const v={minVizHeight:75,minVizWidth:75,showThresholdLabels:!1,showThresholdMarkers:!0,sizing:n.T6.Auto};class P extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,T)=>{const{options:A,fieldConfig:R}=this.props,{width:S,height:O,count:j,value:B}=b,{field:N,display:I}=B,{openMenu:K,targetClassName:w}=T;return(0,l.jsx)(c._,{value:(0,f.l)(j,R.defaults,I),width:S,height:O,field:N,text:A.text,showThresholdLabels:A.showThresholdLabels,showThresholdMarkers:A.showThresholdMarkers,theme:y.$W.theme2,onClick:K,className:w,orientation:A.orientation})},this.renderValue=b=>{const{value:T}=b,{getLinks:A,hasLinks:R}=T;return R&&A?(0,l.jsx)(p.e,{links:A,style:{flexGrow:1},children:S=>this.renderComponent(b,S)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:T,replaceVariables:A,fieldConfig:R,timeZone:S}=this.props;for(let O of b.series)for(let j of O.fields)if(j.config.unit==="percent"||j.config.unit==="percentunit"){const B=j.config.min??0,N=j.config.max??(j.config.unit==="percent"?100:1);j.state=j.state??{},j.state.range={min:B,max:N,delta:N-B},j.display=(0,o.J)({field:j,theme:y.$W.theme2})}return(0,u.PI)({fieldConfig:R,reduceOptions:T.reduceOptions,replaceVariables:A,theme:y.$W.theme2,data:b.series,timeZone:S})},this.calculateGaugeSize=()=>{const{options:b}=this.props,T=b.orientation,A=b.sizing===n.T6.Manual,R=T===n.wV.Vertical,S=T===n.wV.Horizontal,O=A&&R?b.minVizWidth:v.minVizWidth,j=A&&S?b.minVizHeight:v.minVizHeight;return{minVizWidth:O,minVizHeight:j}}}render(){const{height:b,width:T,data:A,renderCounter:R,options:S}=this.props,{minVizHeight:O,minVizWidth:j}=this.calculateGaugeSize();return(0,l.jsx)(h.S,{getValues:this.getValues,renderValue:this.renderValue,width:T,height:b,source:A,autoGrid:!0,renderCounter:R,orientation:S.orientation,minVizHeight:O,minVizWidth:j})}}var m=e(50082),D=e(38824);class x{getSuggestionsForData(b){const{dataSummary:T}=b;if(!T.hasData||!T.hasNumberField||T.numberFieldCount>=50)return;const A=b.getListAppender({name:D.m.Gauge,pluginId:"gauge",options:{},fieldConfig:{defaults:{thresholds:{steps:[{value:-1/0,color:"green"},{value:70,color:"orange"},{value:85,color:"red"}],mode:m.O.Percentage},custom:{}},overrides:[]},cardOptions:{previewModifier:R=>{R.options.reduceOptions.values&&(R.options.reduceOptions.limit=2)}}});T.hasStringField&&T.frameCount===1&&T.rowCountTotal<10?(A.append({name:D.m.Gauge,options:{reduceOptions:{values:!0,calcs:[]}}}),A.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!0,calcs:[]},showThresholdMarkers:!1}})):(A.append({name:D.m.Gauge,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),A.append({name:D.m.GaugeNoThresholds,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},showThresholdMarkers:!1}}))}}const E=new t.m(P).useFieldConfig({useCustomConfig:C=>{C.addNumberInput({path:"neutral",name:"Neutral",description:"Leave empty to use Min as neutral point",category:["Gauge"],settings:{placeholder:"auto"}})}}).setPanelOptions(C=>{(0,s.L)(C),(0,s.h)(C),C.addBooleanSwitch({path:"showThresholdLabels",name:"Show threshold labels",description:"Render the threshold values around the gauge bar",defaultValue:v.showThresholdLabels}).addBooleanSwitch({path:"showThresholdMarkers",name:"Show threshold markers",description:"Renders the thresholds as an outer bar",defaultValue:v.showThresholdMarkers}).addRadio({path:"sizing",name:"Gauge size",settings:{options:[{value:n.T6.Auto,label:"Auto"},{value:n.T6.Manual,label:"Manual"}]},defaultValue:v.sizing,showIf:b=>b.orientation!==n.wV.Auto}).addSliderInput({path:"minVizWidth",name:"Min width",description:"Minimum column width (vertical orientation)",defaultValue:v.minVizWidth,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Vertical}).addSliderInput({path:"minVizHeight",name:"Min height",description:"Minimum row height (horizontal orientation)",defaultValue:v.minVizHeight,settings:{min:0,max:600,step:1},showIf:b=>b.sizing===n.T6.Manual&&b.orientation===n.wV.Horizontal}),r.I(C)}).setPanelChangeHandler(i).setSuggestionsSupplier(new x).setMigrationHandler(g)},19743:(_,L,e)=>{"use strict";e.d(L,{x:()=>a});var t=e(74848),n=e(96540),r=e(1173),s=e(74668);const a=({value:g,context:i,onChange:l})=>{const d=(0,n.useCallback)(o=>{l(o?.length?{id:r.jR.byRefId,options:o}:void 0)},[l]);return(0,t.jsx)(s.X,{value:g?.options,onChange:d,data:i.data,placeholder:"Change filter"})}},52995:(_,L,e)=>{"use strict";e.d(L,{P7:()=>n,uM:()=>r,iS:()=>s,KQ:()=>g});var t=e(52622),n=(i=>(i.Opacity="opacity",i.Scheme="scheme",i))(n||{}),r=(i=>(i.Exponential="exponential",i.Linear="linear",i))(r||{}),s=(i=>(i.X="x",i.Xy="xy",i.Y="y",i))(s||{});const a={calculate:!1,cellGap:1,cellValues:{},color:{scheme:"Oranges",fill:"dark-orange",reverse:!1,exponent:.5,steps:64},exemplars:{color:"rgba(255,0,255,0.7)"},filterValues:{le:1e-9},legend:{show:!0},selectionMode:"x",showValue:t.yL.Auto,tooltip:{mode:t.$N.Single,yHistogram:!1,showColorScale:!1}},g={...a,color:{...a.color,mode:n.Scheme,scale:r.Exponential},yAxis:{...a.yAxis,axisPlacement:t.vM.Left},rowsFrame:{...a.rowsFrame,layout:t.D7.auto}}},69386:(_,L,e)=>{"use strict";e.d(L,{K:()=>o});var t=e(74848),n=e(32196),r=e(70255),s=e(80997),a=e(72724),g=e(40845),i=e(72129);function l({width:c,showImage:p,data:h,index:y}){const f=(0,g.of)(u),v=c>600,P=h.get(y),m=encodeURI(P.title);return(0,t.jsxs)("article",{"aria-labelledby":m,className:(0,n.cx)(f.item,v&&f.itemWide),children:[p&&P.ogImage&&(0,t.jsx)("a",{tabIndex:-1,href:s.sQ.sanitizeUrl(P.link),target:"_blank",rel:"noopener noreferrer",className:(0,n.cx)(f.socialImage,v&&f.socialImageWide),"aria-hidden":!0,children:(0,t.jsx)("img",{src:P.ogImage,alt:P.title})}),(0,t.jsxs)("div",{className:f.body,children:[(0,t.jsxs)("time",{className:f.date,dateTime:(0,a.LE)(P.date,{format:"MMM DD"}),children:[(0,a.LE)(P.date,{format:"MMM DD"})," "]}),(0,t.jsx)("a",{className:f.link,href:s.sQ.sanitizeUrl(P.link),target:"_blank",rel:"noopener noreferrer",children:(0,t.jsx)("h3",{className:f.title,id:m,children:P.title})}),(0,t.jsx)("div",{className:f.content,dangerouslySetInnerHTML:{__html:s.sQ.sanitize(P.content)}})]})]})}const d=({width:c,showImage:p,rootProps:h})=>{const y=(0,g.of)(u),f=c>600;return(0,t.jsxs)("div",{className:(0,n.cx)(y.item,f&&y.itemWide),...h,children:[p&&(0,t.jsx)(r.A,{containerClassName:(0,n.cx)(y.socialImage,f&&y.socialImageWide),width:f?"250px":"100%",height:f?"150px":c*.5}),(0,t.jsxs)("div",{className:y.body,children:[(0,t.jsx)(r.A,{containerClassName:y.date,width:60}),(0,t.jsx)(r.A,{containerClassName:y.title,width:250}),(0,t.jsx)(r.A,{containerClassName:y.content,width:"100%",count:6})]})]})},o=(0,i.j)(l,d),u=c=>({container:(0,n.css)({height:"100%"}),item:(0,n.css)({display:"flex",padding:c.spacing(1),position:"relative",marginBottom:c.spacing(.5),marginRight:c.spacing(1),borderBottom:`2px solid ${c.colors.border.weak}`,background:c.colors.background.primary,flexDirection:"column",flexShrink:0}),itemWide:(0,n.css)({flexDirection:"row"}),body:(0,n.css)({display:"flex",flexDirection:"column",flex:1}),socialImage:(0,n.css)({display:"flex",alignItems:"center",marginBottom:c.spacing(1),"> img":{width:"100%",borderRadius:`${c.shape.radius.default} ${c.shape.radius.default} 0 0`}}),socialImageWide:(0,n.css)({marginRight:c.spacing(2),marginBottom:0,"> img":{width:"250px",borderRadius:c.shape.radius.default}}),link:(0,n.css)({color:c.colors.text.link,display:"inline-block","&:hover":{color:c.colors.text.link,textDecoration:"underline"}}),title:(0,n.css)({fontSize:"16px",marginBottom:c.spacing(.5)}),content:(0,n.css)({p:{marginBottom:c.spacing(.5),color:c.colors.text.primary}}),date:(0,n.css)({marginBottom:c.spacing(.5),fontWeight:500,borderRadius:`0 0 0 ${c.shape.radius.default}`,color:c.colors.text.secondary})})},62372:(_,L,e)=>{"use strict";e.d(L,{$:()=>t});const t="https://grafana.com/blog/news.xml"},4172:(_,L,e)=>{"use strict";e.d(L,{n:()=>c});var t=e(41053),n=e(78368);function r(p){const y=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(y.querySelectorAll("entry")).map(v=>({title:i(v,"title"),link:v.querySelector("link")?.getAttribute("href")??"",content:i(v,"content"),pubDate:i(v,"published"),ogImage:v.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}function s(p){const y=new DOMParser().parseFromString(p,"text/xml");return{items:Array.from(y.querySelectorAll("item")).map(v=>({title:i(v,"title"),link:i(v,"link"),content:i(v,"description"),pubDate:i(v,"pubDate"),ogImage:v.querySelector("meta[property='og:image']")?.getAttribute("content")}))}}async function a(p){return await(await fetch(p)).text()}function g(p){return new DOMParser().parseFromString(p,"text/xml").querySelector("feed")!==null}function i(p,h){return p.querySelector(h)?.textContent??""}async function l(p){const h=await a(p);return g(h)?r(h):s(h)}var d=e(47232),o=e(11261);function u(p){const h=[],y=[],f=[],v=[],P=[];for(const m of p.items){const D=(0,d.KQ)(m.pubDate);try{if(h.push(D.valueOf()),y.push(m.title),f.push(m.link),P.push(m.ogImage),m.content){const x=m.content.replace(/<\/?[^>]+(>|$)/g,"");v.push(x)}}catch(x){console.warn("Error reading news item:",x,m)}}return{fields:[{name:"date",type:o.PU.time,config:{displayName:"Date"},values:h},{name:"title",type:o.PU.string,config:{},values:y},{name:"link",type:o.PU.string,config:{},values:f},{name:"content",type:o.PU.string,config:{},values:v},{name:"ogImage",type:o.PU.string,config:{},values:P}],length:h.length}}function c(p){const[h,y]=(0,t.A)(async()=>{const f=await l(p),v=u(f);return new n.R(v)},[p],{loading:!0});return{state:h,getNews:y}}},23799:(_,L,e)=>{"use strict";e.d(L,{L:()=>g,h:()=>i});var t=e(69550),n=e(75059),r=e(28240),s=e(54479),a=e(52622);function g(l,d=!0){const o=["Value options"];l.addRadio({path:"reduceOptions.values",name:"Show",description:"Calculate a single value per column or series or show each row",settings:{options:[{value:!1,label:"Calculate"},{value:!0,label:"All values"}]},category:o,defaultValue:!1}),l.addNumberInput({path:"reduceOptions.limit",name:"Limit",description:"Max number of rows to display",category:o,settings:{placeholder:"25",integer:!0,min:1,max:5e3},showIf:u=>u.reduceOptions.values===!0}),l.addCustomEditor({id:"reduceOptions.calcs",path:"reduceOptions.calcs",name:"Calculation",description:"Choose a reducer function / calculation",category:o,editor:t.D.get("stats-picker").editor,defaultValue:[n.gy.lastNotNull],showIf:u=>u.reduceOptions.values===!1}),d&&l.addSelect({path:"reduceOptions.fields",name:"Fields",description:"Select the fields that should be included in the panel",category:o,settings:{allowCustomValue:!0,options:[],getOptions:async u=>{const c=[{value:"",label:"Numeric Fields"},{value:"/.*/",label:"All Fields"}];if(u&&u.data)for(const p of u.data)for(const h of p.fields){const y=(0,r.Ct)(h,p,u.data),f=`/^${(0,s.jD)(y)}$/`;c.push({value:f,label:y})}return Promise.resolve(c)}},defaultValue:""})}function i(l,d){l.addRadio({path:"orientation",name:"Orientation",description:"Layout orientation",category:d,settings:{options:[{value:a.wV.Auto,label:"Auto"},{value:a.wV.Horizontal,label:"Horizontal"},{value:a.wV.Vertical,label:"Vertical"}]},defaultValue:a.wV.Auto})}},36373:(_,L,e)=>{"use strict";e.r(L),e.d(L,{plugin:()=>E});var t=e(65158),n=e(52622),r=e(71242),s=e(63250),a=e(24293);const g=(C,b,T)=>{const A=(0,s.gl)(C,b,T);if(T.angular&&(b==="singlestat"||b==="grafana-singlestat-panel")){const R=T.angular;if(A.graphMode=n.$p.None,R.sparkline&&R.sparkline.show&&(A.graphMode=n.$p.Area),R.colorBackground)A.colorMode=n.yp.Background;else if(R.colorValue)A.colorMode=n.yp.Value;else if(A.colorMode=n.yp.None,R.sparkline?.lineColor&&A.graphMode===n.$p.Area){const S=C.fieldConfig??{};S.defaults.color={mode:a.Y.Fixed,fixedColor:R.sparkline.lineColor},C.fieldConfig=S}R.valueName==="name"&&(A.textMode=n.SV.Name)}return A};var i=e(74848),l=e(2543),d=e(96540),o=e(11261),u=e(56323),c=e(90708),p=e(37494),h=e(59796),y=e(12509),f=e(2913);class v extends d.PureComponent{constructor(){super(...arguments),this.renderComponent=(b,T)=>{const{timeRange:A,options:R}=this.props,{value:S,alignmentFactors:O,width:j,height:B,count:N}=b,{openMenu:I,targetClassName:K}=T;let w=S.sparkline;return w&&(w.timeRange=A),(0,i.jsx)(p.yV,{value:S.display,count:N,sparkline:w,colorMode:R.colorMode,graphMode:R.graphMode,justifyMode:R.justifyMode,textMode:this.getTextMode(),alignmentFactors:O,text:R.text,width:j,height:B,theme:f.$W.theme2,onClick:I,className:K,disableWideLayout:!R.wideLayout,percentChangeColorMode:R.percentChangeColorMode})},this.renderValue=b=>{const{value:T}=b,{getLinks:A,hasLinks:R}=T;return R&&A?(0,i.jsx)(h.e,{links:A,children:S=>this.renderComponent(b,S)}):this.renderComponent(b,{})},this.getValues=()=>{const{data:b,options:T,replaceVariables:A,fieldConfig:R,timeZone:S}=this.props;let O;for(let j of b.series)for(let B of j.fields){let{config:N}=B;if(B.type===o.PU.number){if(B.state?.range)continue;!O&&(!(0,l.isNumber)(N.min)||!(0,l.isNumber)(N.max))&&(O=(0,c.nJ)(b.series));const I=N.min??O.min,K=N.max??O.max;B.state=B.state??{},B.state.range={min:I,max:K,delta:K-I}}}return(0,u.PI)({fieldConfig:R,reduceOptions:T.reduceOptions,replaceVariables:A,theme:f.$W.theme2,data:b.series,sparkline:T.graphMode!==n.$p.None,percentChange:T.showPercentChange,timeZone:S})}}getTextMode(){const{options:b,fieldConfig:T,title:A}=this.props;return b.textMode===n.SV.Auto&&(T.defaults.displayName||!A)?n.SV.ValueAndName:b.textMode}render(){const{height:b,options:T,width:A,data:R,renderCounter:S}=this.props;return(0,i.jsx)(y.S,{getValues:this.getValues,getAlignmentFactors:u.XS,renderValue:this.renderValue,width:A,height:b,source:R,itemSpacing:3,renderCounter:S,autoGrid:!0,orientation:T.orientation})}}var P=e(23799);const m={colorMode:n.yp.Value,graphMode:n.$p.Area,justifyMode:n.F8.Auto,percentChangeColorMode:n.CD.Standard,showPercentChange:!1,textMode:n.SV.Auto,wideLayout:!0};var D=e(38824);class x{getSuggestionsForData(b){const{dataSummary:T}=b;if(!T.hasData)return;const A=b.getListAppender({name:D.m.Stat,pluginId:"stat",options:{},fieldConfig:{defaults:{unit:"short",custom:{}},overrides:[]},cardOptions:{previewModifier:R=>{R.options.reduceOptions.values&&(R.options.reduceOptions.limit=1)}}});T.hasStringField&&T.hasNumberField&&T.frameCount===1&&T.rowCountTotal<10&&(A.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"}}}),A.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.Background}})),T.stringFieldCount===1&&T.frameCount===1&&T.rowCountTotal<10&&T.fieldCount===1&&A.append({name:D.m.Stat,options:{reduceOptions:{values:!0,calcs:[],fields:"/.*/"},colorMode:n.yp.None}}),T.hasNumberField&&T.hasTimeField&&(A.append({options:{reduceOptions:{values:!1,calcs:["lastNotNull"]}}}),A.append({name:D.m.StatColoredBackground,options:{reduceOptions:{values:!1,calcs:["lastNotNull"]},graphMode:n.$p.None,colorMode:n.yp.Background}}))}}const E=new t.m(v).useFieldConfig().setPanelOptions(C=>{const b=["Stat styles"];(0,P.L)(C),(0,P.h)(C,b),r.I(C),C.addSelect({path:"textMode",name:"Text mode",description:"Control if name and value is displayed or just name",category:b,settings:{options:[{value:n.SV.Auto,label:"Auto"},{value:n.SV.Value,label:"Value"},{value:n.SV.ValueAndName,label:"Value and name"},{value:n.SV.Name,label:"Name"},{value:n.SV.None,label:"None"}]},defaultValue:m.textMode}).addRadio({path:"wideLayout",name:"Wide layout",category:b,settings:{options:[{value:!0,label:"On"},{value:!1,label:"Off"}]},defaultValue:m.wideLayout,showIf:T=>T.textMode===n.SV.ValueAndName}),C.addSelect({path:"colorMode",name:"Color mode",defaultValue:n.yp.Value,category:b,settings:{options:[{value:n.yp.None,label:"None"},{value:n.yp.Value,label:"Value"},{value:n.yp.Background,label:"Background Gradient"},{value:n.yp.BackgroundSolid,label:"Background Solid"}]}}).addRadio({path:"graphMode",name:"Graph mode",description:"Stat panel graph / sparkline mode",category:b,defaultValue:m.graphMode,settings:{options:[{value:n.$p.None,label:"None"},{value:n.$p.Area,label:"Area"}]}}).addRadio({path:"justifyMode",name:"Text alignment",defaultValue:m.justifyMode,category:b,settings:{options:[{value:n.F8.Auto,label:"Auto"},{value:n.F8.Center,label:"Center"}]}}).addBooleanSwitch({path:"showPercentChange",name:"Show percent change",defaultValue:m.showPercentChange,category:b,showIf:T=>!T.reduceOptions.values}).addSelect({path:"percentChangeColorMode",name:"Percent change color mode",defaultValue:m.percentChangeColorMode,category:b,settings:{options:[{value:n.CD.Standard,label:"Standard"},{value:n.CD.Inverted,label:"Inverted"},{value:n.CD.SameAsValue,label:"Same as Value"}]},showIf:T=>T.showPercentChange})}).setNoPadding().setPanelChangeHandler(g).setSuggestionsSupplier(new x).setMigrationHandler(s._$)},11082:(_,L,e)=>{"use strict";e.d(L,{Z:()=>g});var t=e(74848),n=e(66864),r=e(94354),s=e(51275);const a=[{label:"Never",value:!1},{label:"Threshold",value:36e5}],g=({value:i,onChange:l,item:d})=>{const o=typeof i=="number";return a[1].value=o?i:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(r.z,{value:i,options:a,onChange:l}),o&&(0,t.jsx)(s.g,{value:i,onChange:l,inputPrefix:s.F.GreaterThan,isTime:d.settings?.isTime??!1})]})}},43228:(_,L,e)=>{"use strict";e.d(L,{F:()=>o});var t=e(74848),n=e(96540),r=e(66864),s=e(94354),a=e(90182),g=e(29158);const i=[{label:"Solid",value:"solid"},{label:"Dash",value:"dash"},{label:"Dots",value:"dot"}],l=["10, 10","10, 15","10, 20","10, 25","10, 30","10, 40","15, 10","20, 10","25, 10","30, 10","40, 10","50, 10","5, 10","30, 3, 3"].map(c=>({label:c,value:c})),d=["0, 10","0, 20","0, 30","0, 40","0, 3, 3"].map(c=>({label:c,value:c})),o=({value:c,onChange:p})=>{const h=(0,n.useMemo)(()=>c?.fill==="dash"?l:d,[c]),y=(0,n.useMemo)(()=>{if(!c?.dash?.length)return h[0];const f=c.dash?.join(", "),v=h.find(P=>P.value===f);return v||{label:f,value:f}},[c,h]);return(0,t.jsxs)(r.Gy,{children:[(0,t.jsx)(s.z,{value:c?.fill||"solid",options:i,onChange:f=>{let v;f==="dot"?v=u(d[0].value):f==="dash"&&(v=u(l[0].value)),p({...c,fill:f,dash:v})}}),c?.fill&&c?.fill!=="solid"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.l6,{allowCustomValue:!0,options:h,value:y,width:20,onChange:f=>{p({...c,dash:u(f.value??"")})},formatCreateLabel:f=>`Segments: ${u(f).join(", ")}`}),(0,t.jsxs)("div",{children:["\xA0",(0,t.jsx)("a",{title:"The input expects a segment list",href:"https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/setLineDash#Parameters",target:"_blank",rel:"noreferrer",children:(0,t.jsx)(g.K,{name:"question-circle",tooltip:"Help"})})]})]})]})};function u(c){const p=[];for(const h of c.split(/(?:,| )+/)){const y=Number.parseInt(h,10);isNaN(y)||p.push(y)}return p}},51275:(_,L,e)=>{"use strict";e.d(L,{F:()=>s,g:()=>a});var t=e(74848),n=e(65879),r=e(10354),s=(g=>(g.LessThan="lessthan",g.GreaterThan="greaterthan",g))(s||{});const a=({value:g,onChange:i,inputPrefix:l,isTime:d})=>{let o=n.secondsToHms(g/1e3);d||(o="10");const u=y=>{let f=!1;if(y)try{d&&n.isValidTimeSpan(y)?f=n.intervalToMs(y):f=Number(y)}catch(v){console.warn("ERROR",v)}i(f)},c=y=>{y.key==="Enter"&&u(y.currentTarget.value)},p=y=>{u(y.currentTarget.value)},h=l==="greaterthan"?(0,t.jsx)("div",{children:">"}):l==="lessthan"?(0,t.jsx)("div",{children:"<"}):null;return(0,t.jsx)(r.p,{autoFocus:!1,placeholder:"never",width:10,defaultValue:o,onKeyDown:c,onBlur:p,prefix:h,spellCheck:!1})}},34163:(_,L,e)=>{"use strict";e.d(L,{e:()=>g});var t=e(74848),n=e(66864),r=e(94354),s=e(51275);const a=[{label:"Never",value:!1},{label:"Always",value:!0},{label:"Threshold",value:36e5}],g=({value:i,onChange:l,item:d})=>{const o=typeof i=="number";return a[2].value=o?i:36e5,(0,t.jsxs)(n.Gy,{children:[(0,t.jsx)(r.z,{value:i,options:a,onChange:l}),o&&(0,t.jsx)(s.g,{value:i,onChange:l,inputPrefix:s.F.LessThan,isTime:d.settings?.isTime??!1})]})}},24882:(_,L,e)=>{"use strict";e.d(L,{D:()=>s});var t=e(74848),n=e(96540),r=e(90182);const s=({item:a,value:g,onChange:i,id:l})=>{const d=(0,n.useCallback)(o=>{i({mode:o.value})},[i]);return(0,t.jsx)(r.l6,{inputId:l,value:g.mode,options:a.settings?.options??[],onChange:d})}},41706:(_,L,e)=>{"use strict";e.d(L,{S:()=>h,V:()=>f});var t=e(37055),n=e(24293),r=e(11261),s=e(27310),a=e(52622),g=e(52198),i=e(56675),l=e(38248),d=e(11404),o=e(11082),u=e(43228),c=e(34163),p=e(24882);const h={drawStyle:a.GR.Line,lineInterpolation:a.dx.Linear,lineWidth:1,fillOpacity:0,gradientMode:a.on.None,barAlignment:a.Nj.Center,barWidthFactor:.6,stacking:{mode:a.gs.None,group:"A"},axisGridShow:!0,axisCenteredZero:!1,axisBorderShow:!1},y=["Graph styles"];function f(v,P=!0){return{standardOptions:{[t.uo.Color]:{settings:{byValueSupport:!0,bySeriesSupport:!0,preferThresholdsMode:!1},defaultValue:{mode:n.Y.PaletteClassic}}},useCustomConfig:m=>{m.addRadio({path:"drawStyle",name:"Style",category:y,defaultValue:v.drawStyle,settings:{options:g.t.drawStyle}}).addRadio({path:"lineInterpolation",name:"Line interpolation",category:y,defaultValue:v.lineInterpolation,settings:{options:g.t.lineInterpolation},showIf:D=>D.drawStyle===a.GR.Line}).addRadio({path:"barAlignment",name:"Bar alignment",category:y,defaultValue:v.barAlignment,settings:{options:g.t.barAlignment},showIf:D=>D.drawStyle===a.GR.Bars}).addSliderInput({path:"barWidthFactor",name:"Bar width factor",category:y,defaultValue:v.barWidthFactor,settings:{min:.1,max:1,step:.1,ariaLabelForHandle:"Bar width factor"},showIf:D=>D.drawStyle===a.GR.Bars}).addSliderInput({path:"lineWidth",name:"Line width",category:y,defaultValue:v.lineWidth,settings:{min:0,max:10,step:1,ariaLabelForHandle:"Line width"},showIf:D=>D.drawStyle!==a.GR.Points}).addSliderInput({path:"fillOpacity",name:"Fill opacity",category:y,defaultValue:v.fillOpacity,settings:{min:0,max:100,step:1,ariaLabelForHandle:"Fill opacity"},showIf:D=>D.drawStyle!==a.GR.Points}).addRadio({path:"gradientMode",name:"Gradient mode",category:y,defaultValue:g.t.fillGradient[0].value,settings:{options:g.t.fillGradient},showIf:D=>D.drawStyle!==a.GR.Points}).addFieldNamePicker({path:"fillBelowTo",name:"Fill below to",category:y,hideFromDefaults:!0,settings:{filter:D=>D.type===r.PU.number}}).addCustomEditor({id:"lineStyle",path:"lineStyle",name:"Line style",category:y,showIf:D=>D.drawStyle===a.GR.Line,editor:u.F,override:u.F,process:s.hS,shouldApply:D=>D.type===r.PU.number}).addCustomEditor({id:"spanNulls",path:"spanNulls",name:"Connect null values",category:y,defaultValue:!1,editor:c.e,override:c.e,showIf:D=>D.drawStyle===a.GR.Line,shouldApply:D=>D.type!==r.PU.time,process:s.hS,settings:{isTime:P}}).addCustomEditor({id:"insertNulls",path:"insertNulls",name:"Disconnect values",category:y,defaultValue:!1,editor:o.Z,override:o.Z,showIf:D=>D.drawStyle===a.GR.Line,shouldApply:D=>D.type!==r.PU.time,process:s.hS,settings:{isTime:P}}).addRadio({path:"showPoints",name:"Show points",category:y,defaultValue:g.t.showPoints[0].value,settings:{options:g.t.showPoints},showIf:D=>D.drawStyle!==a.GR.Points}).addSliderInput({path:"pointSize",name:"Point size",category:y,defaultValue:5,settings:{min:1,max:40,step:1,ariaLabelForHandle:"Point size"},showIf:D=>D.showPoints!==a.yL.Never||D.drawStyle===a.GR.Points}),i.I(m,v.stacking,y),m.addSelect({category:y,name:"Transform",path:"transform",settings:{options:[{label:"Constant",value:a.NU.Constant,description:"The first value will be shown as a constant line"},{label:"Negative Y",value:a.NU.NegativeY,description:"Flip the results to negative values on the y axis"}],isClearable:!0},hideFromDefaults:!0}),l.r(m,v),d.e(m),m.addCustomEditor({id:"thresholdsStyle",path:"thresholdsStyle",name:"Show thresholds",category:["Thresholds"],defaultValue:{mode:a.Ly.Off},settings:{options:g.t.thresholdsDisplayModes},editor:p.D,override:p.D,process:s.hS,shouldApply:()=>!0})}}}},99140:(_,L,e)=>{"use strict";e.d(L,{Gu:()=>s,JD:()=>a,M_:()=>n,k3:()=>r});var t=e(48594);let n;function r(g){n=g}function s(){return!n||!n.getState?{templating:{...t.L1,lastKey:"key"}}:n.getState()}function a(g){if(!(!n||!n.getState))return n.dispatch(g)}},38824:(_,L,e)=>{"use strict";e.d(L,{m:()=>t});var t=(n=>(n.LineChart="Line chart",n.LineChartSmooth="Line chart smooth",n.LineChartGradientColorScheme="Line chart with gradient color scheme",n.AreaChart="Area chart",n.AreaChartStacked="Area chart stacked",n.AreaChartStackedPercent="Area chart 100% stacked",n.BarChart="Bar chart",n.BarChartGradientColorScheme="Bar chart with gradient color scheme",n.BarChartStacked="Bar chart stacked",n.BarChartStackedPercent="Bar chart 100% stacked",n.BarChartHorizontal="Bar chart horizontal",n.BarChartHorizontalStacked="Bar chart horizontal stacked",n.BarChartHorizontalStackedPercent="Bar chart horizontal 100% stacked",n.Candlestick="Candlestick",n.PieChart="Pie chart",n.PieChartDonut="Pie chart donut",n.Stat="Stat",n.StatColoredBackground="Stat colored background",n.Gauge="Gauge",n.GaugeNoThresholds="Gauge no thresholds",n.BarGaugeBasic="Bar gauge basic",n.BarGaugeLCD="Bar gauge LCD",n.Table="Table",n.StateTimeline="State timeline",n.StatusHistory="Status history",n.TextPanel="Text",n.DashboardList="Dashboard list",n.Logs="Logs",n.FlameGraph="Flame graph",n.Trace="Trace",n.NodeGraph="Node graph",n))(t||{})},94822:(_,L,e)=>{"use strict";e.d(L,{$k:()=>g,Gi:()=>n,JS:()=>l,N1:()=>d,Q8:()=>o,Si:()=>r,cF:()=>t,lh:()=>i,qr:()=>a,s1:()=>s});var t=(u=>(u.Firing="firing",u.Inactive="inactive",u.Pending="pending",u))(t||{}),n=(u=>(u.Normal="Normal",u.Alerting="Alerting",u.Pending="Pending",u.NoData="NoData",u.Error="Error",u))(n||{});function r(u){return Object.values(t).includes(u)}function s(u){return Object.values(n).some(c=>c===u)}function a(u){const c=Object.values(t);return u!=null&&!c.includes(u)}function g(u){const c=u.match(/\((.*?)\)/);return c?c[1]:""}function i(u){return a(u)?u.split(" ")[0]:u}var l=(u=>(u.Alerting="alerting",u.Recording="recording",u))(l||{}),d=(u=>(u.Cortex="Cortex",u.Mimir="Mimir",u.Prometheus="Prometheus",u.Thanos="Thanos",u))(d||{}),o=(u=>(u.Alerting="Alerting",u.NoData="NoData",u.KeepLast="KeepLast",u.OK="OK",u.Error="Error",u))(o||{})},21460:(_,L,e)=>{"use strict";e.d(L,{$:()=>s,S:()=>n});var t=e(94822);function n(a,g){return(0,t.lh)(a.state)===g}var r=(a=>(a.Firing="firing",a))(r||{}),s=(a=>(a.Alerting="alerting",a.Pending="pending",a.Normal="inactive",a.NoData="nodata",a.Error="error",a))(s||{})},13609:()=>{(function(_){"use strict";_(function(){_.support.transition=function(){var L=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},n;for(n in t)if(e.style[n]!==void 0)return t[n]}();return L&&{end:L}}()})})(window.jQuery),function(_){"use strict";var L="[data-toggle=dropdown]",e=function(s){var a=_(s).on("click.dropdown.data-api",this.toggle);_("html").on("click.dropdown.data-api",function(){a.parent().removeClass("open")})};e.prototype={constructor:e,toggle:function(s){var a=_(this),g,i;if(!a.is(".disabled, :disabled"))return g=n(a),i=g.hasClass("open"),t(),i||("ontouchstart"in document.documentElement&&_('<div class="dropdown-backdrop"/>').insertBefore(_(this)).on("click",t),g.toggleClass("open")),a.focus(),!1},keydown:function(s){var a,g,i,l,d,o;if(/(38|40|27)/.test(s.keyCode)&&(a=_(this),s.preventDefault(),s.stopPropagation(),!a.is(".disabled, :disabled"))){if(l=n(a),d=l.hasClass("open"),!d||d&&s.keyCode==27)return s.which==27&&l.find(L).focus(),a.click();g=_("[role=menu] li:not(.divider):visible a",l),g.length&&(o=g.index(g.filter(":focus")),s.keyCode==38&&o>0&&o--,s.keyCode==40&&o<g.length-1&&o++,~o||(o=0),g.eq(o).focus())}}};function t(){_(".dropdown-backdrop").remove(),_(L).each(function(){n(_(this)).removeClass("open")})}function n(s){var a=s.attr("data-target"),g;return a||(a=s.attr("href"),a=a&&/#[A-Za-z]/.test(a)&&a.replace(/.*(?=#[^\s]*$)/,"")),g=a&&_.find(a),(!g||!g.length)&&(g=s.parent()),g}var r=_.fn.dropdown;_.fn.dropdown=function(s){return this.each(function(){var a=_(this),g=a.data("dropdown");g||a.data("dropdown",g=new e(this)),typeof s=="string"&&g[s].call(a)})},_.fn.dropdown.Constructor=e,_.fn.dropdown.noConflict=function(){return _.fn.dropdown=r,this},_(document).on("click.dropdown.data-api",t).on("click.dropdown.data-api",".dropdown form",function(s){s.stopPropagation()}).on("click.dropdown.data-api",L,e.prototype.toggle).on("keydown.dropdown.data-api",L+", [role=menu]",e.prototype.keydown)}(window.jQuery),function(_){"use strict";var L=function(t,n){this.options=n,this.$element=_(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",_.proxy(this.hide,this)),this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};L.prototype={constructor:L,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=_.Event("show");this.$element.trigger(n),!(this.isShown||n.isDefaultPrevented())&&(this.isShown=!0,this.escape(),this.backdrop(function(){var r=_.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),r&&t.$element[0].offsetWidth,t.$element.addClass("in").attr("aria-hidden",!1),t.enforceFocus(),r?t.$element.one(_.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")}))},hide:function(t){t&&t.preventDefault();var n=this;t=_.Event("hide"),this.$element.trigger(t),!(!this.isShown||t.isDefaultPrevented())&&(this.isShown=!1,this.escape(),_(document).off("focusin.modal"),this.$element.removeClass("in").attr("aria-hidden",!0),_.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal())},enforceFocus:function(){var t=this;_(document).on("focusin.modal",function(n){t.$element[0]!==n.target&&!t.$element.has(n.target).length&&t.$element.focus()})},escape:function(){var t=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(n){n.which==27&&t.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,n=setTimeout(function(){t.$element.off(_.support.transition.end),t.hideModal()},500);this.$element.one(_.support.transition.end,function(){clearTimeout(n),t.hideModal()})},hideModal:function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden")})},removeBackdrop:function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},backdrop:function(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=_.support.transition&&r;if(this.$backdrop=_('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.$backdrop.click(this.options.backdrop=="static"?_.proxy(this.$element[0].focus,this.$element[0]):_.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one(_.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),_.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(_.support.transition.end,t):t()):t&&t()}};var e=_.fn.modal;_.fn.modal=function(t){return this.each(function(){var n=_(this),r=n.data("modal"),s=_.extend({},_.fn.modal.defaults,n.data(),typeof t=="object"&&t);r||n.data("modal",r=new L(this,s)),typeof t=="string"?r[t]():s.show&&r.show()})},_.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},_.fn.modal.Constructor=L,_.fn.modal.noConflict=function(){return _.fn.modal=e,this},_(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=_(this),r=n.attr("href"),s=_.find(n.attr("data-target")||r&&r.replace(/.*(?=#[^\s]+$)/,"")),a=s.data("modal")?"toggle":_.extend({remote:!/#/.test(r)&&r},s.data(),n.data());t.preventDefault(),s.modal(a).one("hide",function(){n.focus()})})}(window.jQuery),function(_){"use strict";var L=function(t,n){this.init("tooltip",t,n)};L.prototype={constructor:L,init:function(t,n,r){var s,a,g,i,l;for(this.type=t,this.$element=_(n),this.options=this.getOptions(r),this.enabled=!0,g=this.options.trigger.split(" "),l=g.length;l--;)i=g[l],i=="click"?this.$element.on("click."+this.type,this.options.selector,_.proxy(this.toggle,this)):i!="manual"&&(s=i=="hover"?"mouseenter":"focus",a=i=="hover"?"mouseleave":"blur",this.$element.on(s+"."+this.type,this.options.selector,_.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,_.proxy(this.leave,this)));this.options.selector?this._options=_.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=_.extend({},_.fn[this.type].defaults,this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=_.fn[this.type].defaults,r={},s;if(this._options&&_.each(this._options,function(a,g){n[a]!=g&&(r[a]=g)},this),s=_(t.currentTarget)[this.type](r).data(this.type),!s.options.delay||!s.options.delay.show)return s.show();clearTimeout(this.timeout),s.hoverState="in",this.timeout=setTimeout(function(){s.hoverState=="in"&&s.show()},s.options.delay.show)},leave:function(t){var n=_(t.currentTarget)[this.type](this._options).data(this.type);if(this.timeout&&clearTimeout(this.timeout),!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var t,n,r,s,a,g,i=_.Event("show");if(this.hasContent()&&this.enabled){if(this.$element.trigger(i),i.isDefaultPrevented())return;switch(t=this.tip(),this.setContent(),this.options.animation&&t.addClass("fade"),a=typeof this.options.placement=="function"?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement,t.detach().css({top:0,left:0,display:"block"}),this.options.container?t.appendTo(_.find(this.options.container)):t.insertAfter(this.$element),n=this.getPosition(),r=t[0].offsetWidth,s=t[0].offsetHeight,a){case"bottom":g={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":g={top:n.top-s,left:n.left+n.width/2-r/2};break;case"left":g={top:n.top+n.height/2-s/2,left:n.left-r};break;case"right":g={top:n.top+n.height/2-s/2,left:n.left+n.width};break;case"topLeft":g={top:n.top-s,left:n.left+n.width/2-r*.1};break;case"topRight":g={top:n.top-s,left:n.left+n.width/2-r*.9};break;case"rightTop":g={top:n.top+n.height/2-s*.1,left:n.left+n.width};break;case"rightBottom":g={top:n.top+n.height/2-s*.9,left:n.left+n.width};break;case"bottomLeft":g={top:n.top+n.height,left:n.left+n.width/2-r*.1};break;case"bottomRight":g={top:n.top+n.height,left:n.left+n.width/2-r*.9};break;case"leftTop":g={top:n.top+n.height/2-s*.1,left:n.left-r};break;case"leftBottom":g={top:n.top+n.height/2-s*.9,left:n.left-r};break}this.applyPlacement(g,a),this.$element.trigger("shown")}},applyPlacement:function(t,n){var r=this.tip(),s=r[0].offsetWidth,a=r[0].offsetHeight,g,i,l,d;r.offset(t).addClass(n).addClass("in"),g=r[0].offsetWidth,i=r[0].offsetHeight,n=="top"&&i!=a&&(t.top=t.top+a-i,d=!0),n=="bottom"||n=="top"?(l=0,t.left<0&&(l=t.left*-2,t.left=0,r.offset(t),g=r[0].offsetWidth,i=r[0].offsetHeight),this.replaceArrow(l-s+g,g,"left")):this.replaceArrow(i-a,i,"top"),d&&r.offset(t)},replaceArrow:function(t,n,r){this.arrow().css(r,t?50*(1-t/n)+"%":"")},setContent:function(){var t=this.tip(),n=this.getTitle();t.find(".tooltip-inner").text(n),t.removeClass("fade in top bottom left right")},hide:function(){var t=this,n=this.tip(),r=_.Event("hide");if(this.$element.trigger(r),r.isDefaultPrevented())return;n.removeClass("in");function s(){var a=setTimeout(function(){n.off(_.support.transition.end).detach()},500);n.one(_.support.transition.end,function(){clearTimeout(a),n.detach()})}return _.support.transition&&this.$tip.hasClass("fade")?s():n.detach(),this.$element.trigger("hidden"),this},fixTitle:function(){var t=this.$element;(t.attr("title")||typeof t.attr("data-original-title")!="string")&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return _.extend({},typeof t.getBoundingClientRect=="function"?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var t,n=this.$element,r=this.options;return t=n.attr("data-original-title")||(typeof r.title=="function"?r.title.call(n[0]):r.title),t},tip:function(){return this.$tip=this.$tip||_(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var n=t?_(t.currentTarget)[this.type](this._options).data(this.type):this;n.tip().hasClass("in")?n.hide():n.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)}};var e=_.fn.tooltip;_.fn.tooltip=function(t){return this.each(function(){var n=_(this),r=n.data("tooltip"),s=typeof t=="object"&&t;r||n.data("tooltip",r=new L(this,s)),typeof t=="string"&&r[t]()})},_.fn.tooltip.Constructor=L,_.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},_.fn.tooltip.noConflict=function(){return _.fn.tooltip=e,this}}(window.jQuery),function(_){"use strict";var L=function(t){this.element=_(t)};L.prototype={constructor:L,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),s,a,g;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")&&(s=n.find(".active:last a")[0],g=_.Event("show",{relatedTarget:s}),t.trigger(g),!g.isDefaultPrevented()&&(a=_.find(r),this.activate(t.parent("li"),n),this.activate(a,a.parent(),function(){t.trigger({type:"shown",relatedTarget:s})})))},activate:function(t,n,r){var s=n.find("> .active"),a=r&&_.support.transition&&s.hasClass("fade");function g(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),a?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}a?s.one(_.support.transition.end,g):g(),s.removeClass("in")}};var e=_.fn.tab;_.fn.tab=function(t){return this.each(function(){var n=_(this),r=n.data("tab");r||n.data("tab",r=new L(this)),typeof t=="string"&&r[t]()})},_.fn.tab.Constructor=L,_.fn.tab.noConflict=function(){return _.fn.tab=e,this},_(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),_(this).tab("show")})}(window.jQuery),function(_){"use strict";var L=function(t,n){this.$element=_(t),this.options=_.extend({},_.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=_(this.options.menu),this.shown=!1,this.listen()};L.prototype={constructor:L,select:function(){var t=this.$menu.find(".active").attr("data-value")||this.$element.val();return this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},show:function(){var t=_.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n;return this.query=this.$element.val(),!this.query||this.query.length<this.options.minLength?this.shown?this.hide():this:(n=_.isFunction(this.source)?this.source(this.query,_.proxy(this.process,this)):this.source,n?this.process(n):this)},process:function(t){var n=this;return t=_.grep(t,function(r){return n.matcher(r)}),t=this.sorter(t),t.length?this.render(t.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var n=[],r=[],s=[],a;a=t.shift();)a.toLowerCase().indexOf(this.query.toLowerCase())?~a.indexOf(this.query)?r.push(a):s.push(a):n.push(a);return n.concat(r,s)},highlighter:function(t){var n=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return n?t.replace(new RegExp("("+n+")","ig"),function(r,s){return"<strong>"+s+"</strong>"}):t},render:function(t){var n=this;return t=_(t).map(function(r,s){return r=_(n.options.item).attr("data-value",s),r.find("a").html(n.highlighter(s)),r[0]}),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=_(this.$menu.find("li")[0])),r.addClass("active")},prev:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.prev();r.length||(r=this.$menu.find("li").last()),r.addClass("active")},listen:function(){this.$element.on("focus",_.proxy(this.focus,this)).on("blur",_.proxy(this.blur,this)).on("keypress",_.proxy(this.keypress,this)).on("keyup",_.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",_.proxy(this.keydown,this)),this.$menu.on("click",_.proxy(this.click,this)).on("mouseenter","li",_.proxy(this.mouseenter,this)).on("mouseleave","li",_.proxy(this.mouseleave,this))},destroy:function(){this.$element.off().removeData("typeahead"),this.$menu.off()},eventSupported:function(t){var n=t in this.$element;return n||(this.$element.setAttribute(t,"return;"),n=typeof this.$element[t]=="function"),n},move:function(t){if(this.shown&&!(t.shiftKey&&t.keyCode===40)){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next();break}t.stopPropagation()}},keydown:function(t){this.suppressKeyPressRepeat=~_.inArray(t.keyCode,[40,38,9,13,27,57]),this.move(t)},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.keyCode===13&&typeof this.$menu.find(".active").attr("data-value")>"u"?this.$element.submit():(t.stopPropagation(),t.preventDefault())},focus:function(t){this.focused=!0},blur:function(t){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(t){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),_(t.currentTarget).addClass("active")},mouseleave:function(t){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var e=_.fn.typeahead;_.fn.typeahead=function(t){return this.each(function(){var n=_(this),r=n.data("typeahead"),s=typeof t=="object"&&t;r||n.data("typeahead",r=new L(this,s)),typeof t=="string"&&r[t]()})},_.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1},_.fn.typeahead.Constructor=L,_.fn.typeahead.noConflict=function(){return _.fn.typeahead=e,this},_(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=_(this);n.data("typeahead")||n.typeahead(n.data())})}(window.jQuery),function(_){"use strict";var L=function(t,n){this.options=_.extend({},_.fn.affix.defaults,n),this.$window=_(window).on("scroll.affix.data-api",_.proxy(this.checkPosition,this)).on("click.affix.data-api",_.proxy(function(){setTimeout(_.proxy(this.checkPosition,this),1)},this)),this.$element=_(t),this.checkPosition()};L.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=_(document).height(),n=this.$window.scrollTop(),r=this.$element.offset(),s=this.options.offset,a=s.bottom,g=s.top,i="affix affix-top affix-bottom",l;typeof s!="object"&&(a=g=s),typeof g=="function"&&(g=s.top()),typeof a=="function"&&(a=s.bottom()),l=this.unpin!=null&&n+this.unpin<=r.top?!1:a!=null&&r.top+this.$element.height()>=t-a?"bottom":g!=null&&n<=g?"top":!1,this.affixed!==l&&(this.affixed=l,this.unpin=l=="bottom"?r.top-n:null,this.$element.removeClass(i).addClass("affix"+(l?"-"+l:"")))}};var e=_.fn.affix;_.fn.affix=function(t){return this.each(function(){var n=_(this),r=n.data("affix"),s=typeof t=="object"&&t;r||n.data("affix",r=new L(this,s)),typeof t=="string"&&r[t]()})},_.fn.affix.Constructor=L,_.fn.affix.defaults={offset:0},_.fn.affix.noConflict=function(){return _.fn.affix=e,this},_(window).on("load",function(){_('[data-spy="affix"]').each(function(){var t=_(this),n=t.data();n.offset=n.offset||{},n.offsetBottom&&(n.offset.bottom=n.offsetBottom),n.offsetTop&&(n.offset.top=n.offsetTop),t.affix(n)})})}(window.jQuery)},82013:()=>{(function(_){var L={crosshair:{mode:null,color:"rgba(170, 0, 0, 0.80)",lineWidth:1}};function e(t){var n={x:-1,y:-1,locked:!1};t.setCrosshair=function(g){if(!g)n.x=-1;else{var i=t.p2c(g);n.x=Math.max(0,Math.min(i.left,t.width())),n.y=Math.max(0,Math.min(i.top,t.height()))}t.triggerRedrawOverlay()},t.clearCrosshair=t.setCrosshair,t.lockCrosshair=function(g){g&&t.setCrosshair(g),n.locked=!0},t.unlockCrosshair=function(){n.locked=!1};function r(a){n.locked||n.x!=-1&&(n.x=-1,t.triggerRedrawOverlay())}function s(a){if(!n.locked){if(t.getSelection&&t.getSelection()){n.x=-1;return}var g=t.offset();n.x=Math.max(0,Math.min(a.pageX-g.left,t.width())),n.y=Math.max(0,Math.min(a.pageY-g.top,t.height())),t.triggerRedrawOverlay()}}t.hooks.bindEvents.push(function(a,g){a.getOptions().crosshair.mode&&(g.mouseout(r),g.mousemove(s))}),t.hooks.drawOverlay.push(function(a,g){var i=a.getOptions().crosshair;if(i.mode){var l=a.getPlotOffset();if(g.save(),g.translate(l.left,l.top),n.x!=-1){var d=a.getOptions().crosshair.lineWidth%2?.5:0;if(g.strokeStyle=i.color,g.lineWidth=i.lineWidth,g.lineJoin="round",g.beginPath(),i.mode.indexOf("x")!=-1){var o=Math.floor(n.x)+d;g.moveTo(o,0),g.lineTo(o,a.height())}if(i.mode.indexOf("y")!=-1){var u=Math.floor(n.y)+d;g.moveTo(0,u),g.lineTo(a.width(),u)}g.stroke()}g.restore()}}),t.hooks.shutdown.push(function(a,g){g.unbind("mouseout",r),g.unbind("mousemove",s)})}_.plot.plugins.push({init:e,options:L,name:"crosshair",version:"1.0"})})(jQuery)},2341:()=>{(function(_){function L(e){e.hooks.processDatapoints.push(function(t,n,r){n.dashes.show&&t.hooks.draw.push(function(s,a){var g=s.getPlotOffset(),i=n.xaxis,l=n.yaxis;function d(p,h){var y=r.points,f=r.pointsize,v=null,P=null,m=0,D=!0,x,E;n.dashes.dashLength[0]?(x=n.dashes.dashLength[0],n.dashes.dashLength[1]?E=n.dashes.dashLength[1]:E=x):E=x=n.dashes.dashLength,a.beginPath();for(var C=f;C<y.length;C+=f){let K=function(w){var U=Math.sqrt(Math.pow(j-S,2)+Math.pow(B-O,2));if(U<=w)return{deltaX:j-S,deltaY:B-O,distance:U,remainder:w-U};var W=j>S?1:-1,H=B>O?1:-1;return{deltaX:W*Math.sqrt(Math.pow(w,2)/(1+Math.pow((B-O)/(j-S),2))),deltaY:H*Math.sqrt(Math.pow(w,2)-Math.pow(w,2)/(1+Math.pow((B-O)/(j-S),2))),distance:w,remainder:0}};var I=K,b=y[C-f],T=y[C-f+1],A=y[C],R=y[C+1];if(!(b==null||A==null)){if(T<=R&&T<l.min){if(R<l.min)continue;b=(l.min-T)/(R-T)*(A-b)+b,T=l.min}else if(R<=T&&R<l.min){if(T<l.min)continue;A=(l.min-T)/(R-T)*(A-b)+b,R=l.min}if(T>=R&&T>l.max){if(R>l.max)continue;b=(l.max-T)/(R-T)*(A-b)+b,T=l.max}else if(R>=T&&R>l.max){if(T>l.max)continue;A=(l.max-T)/(R-T)*(A-b)+b,R=l.max}if(b<=A&&b<i.min){if(A<i.min)continue;T=(i.min-b)/(A-b)*(R-T)+T,b=i.min}else if(A<=b&&A<i.min){if(b<i.min)continue;R=(i.min-b)/(A-b)*(R-T)+T,A=i.min}if(b>=A&&b>i.max){if(A>i.max)continue;T=(i.max-b)/(A-b)*(R-T)+T,b=i.max}else if(A>=b&&A>i.max){if(b>i.max)continue;R=(i.max-b)/(A-b)*(R-T)+T,A=i.max}(b!=v||T!=P)&&a.moveTo(i.p2c(b)+p,l.p2c(T)+h);var S=i.p2c(b)+p,O=l.p2c(T)+h,j=i.p2c(A)+p,B=l.p2c(R)+h,N;do N=K(m>0?m:D?x:E),(N.deltaX!=0||N.deltaY!=0)&&(D?a.lineTo(S+N.deltaX,O+N.deltaY):a.moveTo(S+N.deltaX,O+N.deltaY)),D=!D,m=N.remainder,S+=N.deltaX,O+=N.deltaY;while(N.distance>0);v=A,P=R}}a.stroke()}a.save(),a.translate(g.left,g.top),a.lineJoin="round";var o=n.dashes.lineWidth,u=n.shadowSize;if(o>0&&u>0){a.lineWidth=u,a.strokeStyle="rgba(0,0,0,0.1)";var c=Math.PI/18;d(Math.sin(c)*(o/2+u/2),Math.cos(c)*(o/2+u/2)),a.lineWidth=u/2,d(Math.sin(c)*(o/2+u/4),Math.cos(c)*(o/2+u/4))}a.lineWidth=o,a.strokeStyle=n.color,o>0&&d(0,0),a.restore()})})}_.plot.plugins.push({init:L,options:{series:{dashes:{show:!1,lineWidth:2,dashLength:10}}},name:"dashes",version:"0.1"})})(jQuery)},92275:()=>{(function(_){"use strict";var L={series:{fillBelowTo:null}};function e(t){function n(a,g){var i;for(i=0;i<g.length;++i)if(g[i].id===a.fillBelowTo)return g[i];return null}function r(a,g,i,l,d,o,u,c){var p,h,y,f,v,P;return p=i-a,h=l-g,y=u-d,f=c-o,v=(-h*(a-d)+p*(g-o))/(-y*h+p*f),P=(y*(g-o)-f*(a-d))/(-y*h+p*f),v>=0&&v<=1&&P>=0&&P<=1?[a+P*p,g+P*h]:null}function s(a,g,i){if(i.fillBelowTo===null)return;var l,d,o,u,c,p,h;function y(E,C){g.beginPath(),g.moveTo(i.xaxis.p2c(E)+p.left,i.yaxis.p2c(C)+p.top)}function f(){g.closePath(),g.fill()}function v(){if(o.length/d!==c.length/u)return console.error("Refusing to graph inconsistent number of points"),!1;var E;for(E=0;E<o.length/d;E++)if(o[E*d]!==null&&c[E*u]!==null&&o[E*d]!==c[E*u])return console.error("Refusing to graph points without matching value"),!1;return!0}function P(E,C){console.assert(C>E,"expects the end index to be greater than the start index");var b=E===0||o[E-1]===null||c[E-1]===null,T=!1,A,R;for(A=E;A<C;A++)if(o[A*d+1]===null||c[A*d+1]===null)T=!1,b=!0;else if(o[A*d+1]===c[A*u+1])T=!0,b=!1;else if(o[A*d+1]>c[A*u+1]){b?y(o[A*d],o[A*d+1]):T?y(o[(A-1)*d],o[(A-1)*d+1]):(R=m(A),y(R[0],R[1])),x(A,C);return}else b=!1,T=!1}function m(E){console.assert(E>0,"expects the second point in the series line segment");var C,b;for(C=1;C<c.length/u;C++)if(b=r(o[(E-1)*d],o[(E-1)*d+1],o[E*d],o[E*d+1],c[(C-1)*u],c[(C-1)*u+1],c[C*u],c[C*u+1]),b!==null)return b;console.error("intersectionPoint() should only be called when an intersection happens")}function D(E,C){console.assert(E>=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b;for(b=E;b>=C;b--)g.lineTo(l.xaxis.p2c(c[b*u])+p.left,l.yaxis.p2c(c[b*u+1])+p.top);f()}function x(E,C){console.assert(E<=C,"the start should be the rightmost point, and the end should be the leftmost (excluding the equal or intersecting point)");var b,T;for(b=E;b<C;b++)if(o[b*d+1]===null&&b>E){D(b-1,E),P(b,C);return}else if(o[b*d+1]===c[b*u+1]){D(b,E),P(b,C);return}else if(o[b*d+1]<c[b*u+1]){T=m(b),g.lineTo(i.xaxis.p2c(T[0])+p.left,i.yaxis.p2c(T[1])+p.top),D(b,E),P(b,C);return}else g.lineTo(i.xaxis.p2c(o[b*d])+p.left,i.yaxis.p2c(o[b*d+1])+p.top);D(C,E)}l=n(i,a.getData()),l&&(d=i.datapoints.pointsize,o=i.datapoints.points,u=l.datapoints.pointsize,c=l.datapoints.points,p=a.getPlotOffset(),v()&&(h=_.color.parse(i.color),h.a=.4,h.normalize(),g.fillStyle=h.toString(),P(0,o.length/d)))}t.hooks.drawSeries.push(s)}_.plot.plugins.push({init:e,options:L,name:"fillbelow",version:"0.1.0"})})(jQuery)},19538:()=>{/*!
 * jquery.flot.gauge v1.1.0 *
 *
 * Flot plugin for rendering gauge charts.
 *
 * Copyright (c) 2015 @toyoty99.
 * Licensed under the MIT license.
 */(function(_){var L=function(){var i,l,d,o,u,c,p=function(E,C){i=C,l=E.getPlaceholder(),d=E.getOptions(),o=d.series.gauges,u=E.getData(),c=e(o.debug)};p.prototype.calculateLayout=function(){var E=l.width(),C=l.height(),b=Math.min(u.length,o.layout.columns),T=Math.ceil(u.length/b),A=o.layout.margin,R=o.layout.hMargin,S=o.layout.vMargin,O=(E-A*2-R*(b-1))/b,j=(C-A*2-S*(T-1))/T;if(o.layout.square){var B=Math.min(O,j);O=B,j=B}h(o,O);var N=o.cell.margin,I=0,K=0;o.label.show&&(I=o.label.margin,K=o.label.font.size);var w=0,U=0;o.value.show&&(w=o.value.margin,U=o.value.font.size);var W=0;o.threshold.show&&(W=o.threshold.width);var H=0,z=0;o.threshold.label.show&&(H=o.threshold.label.margin,z=o.threshold.label.font.size);for(var G=O/2-N-W-H*2-z,M=o.gauge.startAngle,Q=o.gauge.endAngle,Y=(Q-M)/100,q=-1,te=M;te<Q;te+=Y)q=Math.max(q,Math.sin(r(te)));q=Math.max(q,Math.sin(r(Q)));var X=(j-N*2-I*2-K)/(1+q);X*q<w+U/2&&(X=j-N*2-I*2-K-w-U/2);var ee=X-H*2-z-W,ne=Math.min(G,ee),Z=o.gauge.width;Z>=ne&&(Z=Math.max(3,ne/3));var ae=H*2+z+W+ne,re=Math.max(ae*(1+q),ae+w+U/2);return{canvasWidth:E,canvasHeight:C,margin:A,hMargin:R,vMargin:S,columns:b,rows:T,cellWidth:O,cellHeight:j,cellMargin:N,labelMargin:I,labelFontSize:K,valueMargin:w,valueFontSize:U,width:Z,radius:ne,thresholdWidth:W,thresholdLabelMargin:H,thresholdLabelFontSize:z,gaugeOuterHeight:re}};function h(E,C){E.gauge.width==="auto"&&(E.gauge.width=Math.max(5,C/8)),E.label.margin==="auto"&&(E.label.margin=Math.max(1,C/20)),E.label.font.size==="auto"&&(E.label.font.size=Math.max(5,C/8)),E.value.margin==="auto"&&(E.value.margin=Math.max(1,C/30)),E.value.font.size==="auto"&&(E.value.font.size=Math.max(5,C/9)),E.threshold.width==="auto"&&(E.threshold.width=Math.max(3,C/100)),E.threshold.label.margin==="auto"&&(E.threshold.label.margin=Math.max(3,C/40)),E.threshold.label.font.size==="auto"&&(E.threshold.label.font.size=Math.max(5,C/15))}p.prototype.calculateAutoValues=h,p.prototype.calculateCellLayout=function(E,C,b){var T=t(C.columns,b),A=n(C.columns,b),R=C.margin+(C.cellWidth+C.hMargin)*T,S=C.margin+(C.cellHeight+C.vMargin)*A,O=R+C.cellWidth/2,j=S+C.cellMargin+C.labelMargin*2+C.labelFontSize+C.thresholdWidth+C.thresholdLabelFontSize+C.thresholdLabelMargin*2+C.radius,B=C.cellHeight-C.cellMargin*2-C.labelMargin*2-C.labelFontSize-C.gaugeOuterHeight,N=0;return E.cell.vAlign==="middle"?N=B/2:E.cell.vAlign==="bottom"&&(N=B),j+=N,{col:T,row:A,x:R,y:S,offsetY:N,cellWidth:C.cellWidth,cellHeight:C.cellHeight,cellMargin:C.cellMargin,cx:O,cy:j}},p.prototype.drawBackground=function(E){o.frame.show&&(i.save(),i.strokeStyle=d.grid.borderColor,i.lineWidth=d.grid.borderWidth,i.strokeRect(0,0,E.canvasWidth,E.canvasHeight),d.grid.backgroundColor&&(i.fillStyle=d.grid.backgroundColor,i.fillRect(0,0,E.canvasWidth,E.canvasHeight)),i.restore())},p.prototype.drawCellBackground=function(E,C){i.save(),E.cell.border&&E.cell.border.show&&E.cell.border.color&&E.cell.border.width&&(i.strokeStyle=E.cell.border.color,i.lineWidth=E.cell.border.width,i.strokeRect(C.x,C.y,C.cellWidth,C.cellHeight)),E.cell.background&&E.cell.background.color&&(i.fillStyle=E.cell.background.color,i.fillRect(C.x,C.y,C.cellWidth,C.cellHeight)),i.restore()},p.prototype.drawGauge=function(E,C,b,T,A){var R=E.gauge.shadow.show?E.gauge.shadow.blur:0,S=v(E,A),O=y(E,C,A);m(b.cx,b.cy,C.radius,C.width,r(E.gauge.startAngle),r(E.gauge.endAngle),E.gauge.border.color,E.gauge.border.width,E.gauge.background.color,R),m(b.cx,b.cy,C.radius-1,C.width-2,r(O.a1),r(O.a2),S,1,S,R),E.gauge.neutralValue!=null&&f(E,C,b,S)};function y(E,C,b){let T={};var A=E.gauge.neutralValue;return A!=null?b<A?(T.a1=P(E,C,b),T.a2=P(E,C,A)):(T.a1=P(E,C,A),T.a2=P(E,C,b)):(T.a1=E.gauge.startAngle,T.a2=P(E,C,b)),T}function f(E,C,b,T){var A=(E.gauge.max-E.gauge.min)/600;s(i,b.cx,b.cy,C.radius-2,C.width-4,r(P(E,C,E.gauge.neutralValue-A)),r(P(E,C,E.gauge.neutralValue+A)),T,2,E.gauge.background.color)}function v(E,C){for(var b,T=0;T<E.threshold.values.length;T++){var A=E.threshold.values[T];if(b=A.color,C<A.value)break}return b}function P(E,C,b){var T=E.gauge.startAngle+(E.gauge.endAngle-E.gauge.startAngle)*((b-E.gauge.min)/(E.gauge.max-E.gauge.min));return T<E.gauge.startAngle?T=E.gauge.startAngle:T>E.gauge.endAngle&&(T=E.gauge.endAngle),T}p.prototype.drawThreshold=function(E,C,b){for(var T=E.gauge.startAngle,A=0;A<E.threshold.values.length;A++){var R=E.threshold.values[A];c1=R.color,a2=P(E,C,R.value),s(i,b.cx,b.cy,C.radius+C.thresholdWidth,C.thresholdWidth-2,r(T),r(a2),c1,1,c1),T=a2}};function m(E,C,b,T,A,R,S,O,j,B){A!==R&&(i.save(),s(i,E,C,b,T,A,R,S,O,j),B&&(s(i,E,C,b,T,A,R),i.clip(),i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=10,i.shadowColor="gray",s(i,E,C,b+1,T+2,A,R,S,1)),i.restore())}p.prototype.drawLable=function(E,C,b,T,A){x(b.cx,b.y+b.cellMargin+C.labelMargin+b.offsetY,"flotGaugeLabel"+T,E.label.formatter?E.label.formatter(A.label,A.data[0][1]):text,E.label)},p.prototype.drawValue=function(E,C,b,T,A){x(b.cx,b.cy-E.value.font.size/2,"flotGaugeValue"+T,E.value.formatter?E.value.formatter(A.label,A.data[0][1]):text,E.value)},p.prototype.drawThresholdValues=function(E,C,b,T){D(E,C,b,"Min"+T,E.gauge.min,E.gauge.startAngle),D(E,C,b,"Max"+T,E.gauge.max,E.gauge.endAngle);for(var A=0;A<E.threshold.values.length;A++){var R=E.threshold.values[A];if(R.value>E.gauge.min&&R.value<E.gauge.max){var S=P(E,C,R.value);D(E,C,b,T+"_"+A,R.value,S)}}var O=E.gauge.neutralValue;O!=null&&O>E.gauge.min&&O<E.gauge.max&&D(E,C,b,"Neutral"+T,O,P(E,C,O))};function D(E,C,b,T,A,R){x(b.cx+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.cos(r(R)),b.cy+(C.thresholdLabelMargin+C.thresholdLabelFontSize/2+C.radius)*Math.sin(r(R)),"flotGaugeThresholdValue"+T,E.threshold.label.formatter?E.threshold.label.formatter(A):A,E.threshold.label,R)}function x(E,C,b,T,A,R){var S=_(l).find("#"+b),O=S.length;O||(S=_("<span></span>"),S.attr("id",b),S.attr("class","flot-temp-elem"),l.append(S)),S.css("position","absolute"),S.css("top",C+"px"),S.css("white-space","nowrap"),A.font.size&&S.css("font-size",A.font.size+"px"),A.font.family&&S.css("font-family",A.font.family),A.color&&S.css("color",A.color),A.background.color&&S.css("background-color",A.background.color),A.background.opacity&&S.css("opacity",A.background.opacity),S.text(T),S.css("left",E+"px"),S.css("left",parseInt(S.css("left"))-S.width()/2+"px"),!O&&R&&(S.css("top",parseInt(S.css("top"))-S.height()/2+"px"),S.css("transform","rotate("+(180*R+90)+"deg)"))}return p}();function e(i){return typeof Logger<"u"?new Logger(i):null}function t(i,l){return l%i}function n(i,l){return Math.floor(l/i)}function r(i){return i*Math.PI}function s(i,l,d,o,u,c,p,h,y,f){if(c!==p){var v=!1;i.save(),i.beginPath(),i.arc(l,d,o,c,p,v),i.lineTo(l+(o-u)*Math.cos(p),d+(o-u)*Math.sin(p)),i.arc(l,d,o-u,p,c,!v),i.closePath(),y&&(i.lineWidth=y),h&&(i.strokeStyle=h,i.stroke()),f&&(i.fillStyle=f,i.fill()),i.restore()}}function a(i){i.hooks.processOptions.push(function(l,d){var o=e(d.series.gauges.debug);d.series.gauges.show&&(d.grid.show=!1,d.legend.show=!1);var u=d.series.gauges.threshold.values;u.sort(function(c,p){return c.value<p.value?-1:c.value>p.value?1:0})}),i.hooks.draw.push(function(l,d){var o=l.getOptions(),u=o.series.gauges,c=e(u.debug);if(u.show){var p=l.getData();if(!(!p||!p.length)){var h=new L(l,d),y=h.calculateLayout();u.debug.layout,h.drawBackground(y);for(var f=0;f<p.length;f++){var v=p[f],P=_.extend({},u,v.gauges);v.gauges&&h.calculateAutoValues(P,y.cellWidth);var m=h.calculateCellLayout(P,y,f);h.drawCellBackground(P,m),P.debug.layout,P.label.show&&h.drawLable(P,y,m,f,v),h.drawGauge(P,y,m,v.label,v.data[0][1]),P.threshold.show&&h.drawThreshold(P,y,m),P.threshold.label.show&&h.drawThresholdValues(P,y,m,f),P.value.show&&h.drawValue(P,y,m,f,v)}}}})}var g={series:{gauges:{debug:{log:!1,layout:!1,alert:!1},show:!1,layout:{margin:5,columns:3,hMargin:5,vMargin:5,square:!1},frame:{show:!0},cell:{background:{color:null},border:{show:!0,color:"black",width:1},margin:5,vAlign:"middle"},gauge:{width:"auto",startAngle:.9,endAngle:2.1,min:0,max:100,background:{color:"white"},border:{color:"lightgray",width:2},shadow:{show:!0,blur:5}},label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,l){return i}},value:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:"sans-serif"},color:null,formatter:function(i,l){return parseInt(l)}},threshold:{show:!0,width:"auto",label:{show:!0,margin:"auto",background:{color:null,opacity:0},font:{size:"auto",family:",sans-serif"},color:null,formatter:function(i){return i}},values:[]}}}};_.plot.plugins.push({init:a,options:g,name:"gauge",version:"1.1.0"})})(jQuery)},54087:()=>{(function(_){_.color={},_.color.make=function(e,t,n,r){var s={};return s.r=e||0,s.g=t||0,s.b=n||0,s.a=r??1,s.add=function(a,g){for(var i=0;i<a.length;++i)s[a.charAt(i)]+=g;return s.normalize()},s.scale=function(a,g){for(var i=0;i<a.length;++i)s[a.charAt(i)]*=g;return s.normalize()},s.toString=function(){return s.a>=1?"rgb("+[s.r,s.g,s.b].join(",")+")":"rgba("+[s.r,s.g,s.b,s.a].join(",")+")"},s.normalize=function(){function a(g,i,l){return i<g?g:i>l?l:i}return s.r=a(0,parseInt(s.r),255),s.g=a(0,parseInt(s.g),255),s.b=a(0,parseInt(s.b),255),s.a=a(0,s.a,1),s},s.clone=function(){return _.color.make(s.r,s.b,s.g,s.a)},s.normalize()},_.color.extract=function(e,t){var n;do{if(n=e.css(t).toLowerCase(),n!=""&&n!="transparent")break;e=e.parent()}while(e.length&&!_.nodeName(e.get(0),"body"));return n=="rgba(0, 0, 0, 0)"&&(n="transparent"),_.color.parse(n)},_.color.parse=function(e){var t,n=_.color.make;if(t=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10));if(t=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3],10),parseFloat(t[4]));if(t=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55);if(t=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(e))return n(parseFloat(t[1])*2.55,parseFloat(t[2])*2.55,parseFloat(t[3])*2.55,parseFloat(t[4]));if(t=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(e))return n(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16));if(t=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(e))return n(parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16));var r=_.trim(e).toLowerCase();return r=="transparent"?n(255,255,255,0):(t=L[r]||[0,0,0],n(t[0],t[1],t[2]))};var L={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]}})(jQuery),function(_){var L=Object.prototype.hasOwnProperty;_.fn.detach||(_.fn.detach=function(){return this.each(function(){this.parentNode&&this.parentNode.removeChild(this)})});function e(r,s){var a=s.children("."+r)[0];if(a==null&&(a=document.createElement("canvas"),a.className=r,_(a).css({direction:"ltr",position:"absolute",left:0,top:0}).appendTo(s),!a.getContext))if(window.G_vmlCanvasManager)a=window.G_vmlCanvasManager.initElement(a);else throw new Error("Canvas is not available. If you're using IE with a fall-back such as Excanvas, then there's either a mistake in your conditional include, or the page has no DOCTYPE and is rendering in Quirks Mode.");this.element=a;var g=this.context=a.getContext("2d"),i=window.devicePixelRatio||1,l=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;this.pixelRatio=i/l,this.resize(s.width(),s.height()),this.textContainer=null,this.text={},this._textCache={},this._textSizeCache=window.flotTextSizeCache=window.flotTextSizeCache||{}}e.prototype.resize=function(r,s){if(r<=0||s<=0)throw new Error("Invalid dimensions for plot, width = "+r+", height = "+s);var a=this.element,g=this.context,i=this.pixelRatio;this.width!=r&&(a.width=r*i,a.style.width=r+"px",this.width=r),this.height!=s&&(a.height=s*i,a.style.height=s+"px",this.height=s),g.restore(),g.save(),g.scale(i,i)},e.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},e.prototype.render=function(){var r=this._textCache;for(var s in r)if(L.call(r,s)){var a=this.getTextLayer(s),g=r[s];a.hide();for(var i in g)if(L.call(g,i)){var l=g[i];for(var d in l)if(L.call(l,d)){for(var o=l[d].positions,u=0,c;c=o[u];u++)c.active?c.rendered||(a.append(c.element),c.rendered=!0):(o.splice(u--,1),c.rendered&&c.element.detach());o.length==0&&delete l[d]}}a.show()}},e.prototype.getTextLayer=function(r){var s=this.text[r];return s==null&&(this.textContainer==null&&(this.textContainer=_("<div class='flot-text flot-temp-elem'></div>").css({position:"absolute",top:0,left:0,bottom:0,right:0,"font-size":"smaller",color:"#545454"}).insertAfter(this.element)),s=this.text[r]=_("<div></div>").addClass(r).css({position:"absolute",top:0,left:0,bottom:0,right:0}).appendTo(this.textContainer)),s},e.prototype.getTextInfo=function(r,s,a,g,i){var l,d,o,u;if(s=""+s,typeof a=="object"?l=a.style+" "+a.variant+" "+a.weight+" "+a.size+"px/"+a.lineHeight+"px "+a.family:l=a,d=this._textCache[r],d==null&&(d=this._textCache[r]={}),o=d[l],o==null&&(o=d[l]={}),u=o[s],u==null){var c=_("<div></div>").html(s).css({position:"absolute","max-width":i,top:-9999}).appendTo(this.getTextLayer(r));typeof a=="object"?c.css({font:l,color:a.color}):typeof a=="string"&&c.addClass(a),u=o[s]={element:c,positions:[]};var p=this._textSizeCache[s];p?(u.width=p.width,u.height=p.height):(u.width=c.outerWidth(!0),u.height=c.outerHeight(!0),this._textSizeCache[s]={width:u.width,height:u.height}),c.detach()}return u},e.prototype.addText=function(r,s,a,g,i,l,d,o,u){var c=this.getTextInfo(r,g,i,l,d),p=c.positions;o=="center"?s-=c.width/2:o=="right"&&(s-=c.width),u=="middle"?a-=c.height/2:u=="bottom"&&(a-=c.height);for(var h=0,y;y=p[h];h++)if(y.x==s&&y.y==a){y.active=!0;return}y={active:!0,rendered:!1,element:p.length?c.element.clone():c.element,x:s,y:a},p.push(y),y.element.css({top:Math.round(a),left:Math.round(s),"text-align":o})},e.prototype.removeText=function(r,s,a,g,i,l){if(g==null){var d=this._textCache[r];if(d!=null){for(var o in d)if(L.call(d,o)){var u=d[o];for(var c in u)if(L.call(u,c))for(var p=u[c].positions,h=0,y;y=p[h];h++)y.active=!1}}}else for(var p=this.getTextInfo(r,g,i,l).positions,h=0,y;y=p[h];h++)y.x==s&&y.y==a&&(y.active=!1)};function t(r,s,a,g){var i=[],l={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:.85,sorted:null},xaxis:{show:null,position:"bottom",mode:null,font:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,tickDecimals:null,tickSize:null,minTickSize:null},yaxis:{autoscaleMargin:.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1,zero:!0},shadowSize:3,highlightColor:null},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,margin:0,labelMargin:5,eventSectionHeight:0,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},interaction:{redrawOverlayInterval:16.666666666666668},hooks:{}},d=null,o=null,u=null,c=null,p=null,h=[],y=[],f={left:0,right:0,top:0,bottom:0},v=0,P=0,m={processOptions:[],processRawData:[],processDatapoints:[],processOffset:[],processRange:[],drawBackground:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},D=this;D.setData=b,D.setupGrid=M,D.draw=ee,D.getPlaceholder=function(){return r},D.getCanvas=function(){return d.element},D.getPlotOffset=function(){return f},D.width=function(){return v},D.height=function(){return P},D.offset=function(){var ye=u.offset();return ye.left+=f.left,ye.top+=f.top,ye},D.getData=function(){return i},D.getAxes=function(){var ye={},je;return _.each(h.concat(y),function(ue,Ee){Ee&&(ye[Ee.direction+(Ee.n!=1?Ee.n:"")+"axis"]=Ee)}),ye},D.getXAxes=function(){return h},D.getYAxes=function(){return y},D.c2p=S,D.p2c=O,D.getOptions=function(){return l},D.highlight=Ve,D.unhighlight=Je,D.triggerRedrawOverlay=Be,D.pointOffset=function(ye){return{left:parseInt(h[A(ye,"x")-1].p2c(+ye.x)+f.left,10),top:parseInt(y[A(ye,"y")-1].p2c(+ye.y)+f.top,10)}},D.shutdown=w,D.destroy=function(){w(),r.removeData("plot").empty(),i=[],l=null,d=null,o=null,u=null,c=null,p=null,h=[],y=[],m=null,Pe=[],D=null},D.resize=function(){var ye=r.width(),je=r.height();d.resize(ye,je),o.resize(ye,je)},D.hooks=m,E(D),C(a),I(),b(s),M(),ee(),K();function x(ye,je){je=[D].concat(je);for(var ue=0;ue<ye.length;++ue)ye[ue].apply(this,je)}function E(){for(var ye={Canvas:e},je=0;je<g.length;++je){var ue=g[je];ue.init(D,ye),ue.options&&_.extend(!0,l,ue.options)}}function C(ye){_.extend(!0,l,ye),ye&&ye.colors&&(l.colors=ye.colors),l.xaxis.color==null&&(l.xaxis.color=_.color.parse(l.grid.color).scale("a",.22).toString()),l.yaxis.color==null&&(l.yaxis.color=_.color.parse(l.grid.color).scale("a",.22).toString()),l.xaxis.tickColor==null&&(l.xaxis.tickColor=l.grid.tickColor||l.xaxis.color),l.yaxis.tickColor==null&&(l.yaxis.tickColor=l.grid.tickColor||l.yaxis.color),l.grid.borderColor==null&&(l.grid.borderColor=l.grid.color),l.grid.tickColor==null&&(l.grid.tickColor=_.color.parse(l.grid.color).scale("a",.22).toString());var je,ue,Ee,Ce=r.css("font-size"),Ne=Ce?+Ce.replace("px",""):13,Fe={style:r.css("font-style"),size:Math.round(.8*Ne),variant:r.css("font-variant"),weight:r.css("font-weight"),family:r.css("font-family")};for(Ee=l.xaxes.length||1,je=0;je<Ee;++je)ue=l.xaxes[je],ue&&!ue.tickColor&&(ue.tickColor=ue.color),ue=_.extend(!0,{},l.xaxis,ue),l.xaxes[je]=ue,ue.font&&(ue.font=_.extend({},Fe,ue.font),ue.font.color||(ue.font.color=ue.color),ue.font.lineHeight||(ue.font.lineHeight=Math.round(ue.font.size*1.15)));for(Ee=l.yaxes.length||1,je=0;je<Ee;++je)ue=l.yaxes[je],ue&&!ue.tickColor&&(ue.tickColor=ue.color),ue=_.extend(!0,{},l.yaxis,ue),l.yaxes[je]=ue,ue.font&&(ue.font=_.extend({},Fe,ue.font),ue.font.color||(ue.font.color=ue.color),ue.font.lineHeight||(ue.font.lineHeight=Math.round(ue.font.size*1.15)));for(l.xaxis.noTicks&&l.xaxis.ticks==null&&(l.xaxis.ticks=l.xaxis.noTicks),l.yaxis.noTicks&&l.yaxis.ticks==null&&(l.yaxis.ticks=l.yaxis.noTicks),l.x2axis&&(l.xaxes[1]=_.extend(!0,{},l.xaxis,l.x2axis),l.xaxes[1].position="top",l.x2axis.min==null&&(l.xaxes[1].min=null),l.x2axis.max==null&&(l.xaxes[1].max=null)),l.y2axis&&(l.yaxes[1]=_.extend(!0,{},l.yaxis,l.y2axis),l.yaxes[1].position="right",l.y2axis.min==null&&(l.yaxes[1].min=null),l.y2axis.max==null&&(l.yaxes[1].max=null)),l.grid.coloredAreas&&(l.grid.markings=l.grid.coloredAreas),l.grid.coloredAreasColor&&(l.grid.markingsColor=l.grid.coloredAreasColor),l.lines&&_.extend(!0,l.series.lines,l.lines),l.points&&_.extend(!0,l.series.points,l.points),l.bars&&_.extend(!0,l.series.bars,l.bars),l.shadowSize!=null&&(l.series.shadowSize=l.shadowSize),l.highlightColor!=null&&(l.series.highlightColor=l.highlightColor),je=0;je<l.xaxes.length;++je)j(h,je+1).options=l.xaxes[je];for(je=0;je<l.yaxes.length;++je)j(y,je+1).options=l.yaxes[je];for(var Ue in m)l.hooks[Ue]&&l.hooks[Ue].length&&(m[Ue]=m[Ue].concat(l.hooks[Ue]));x(m.processOptions,[l])}function b(ye){i=T(ye),B(),N()}function T(ye){for(var je=[],ue=0;ue<ye.length;++ue){var Ee=_.extend(!0,{},l.series);ye[ue].data!=null?(Ee.data=ye[ue].data,delete ye[ue].data,_.extend(!0,Ee,ye[ue]),ye[ue].data=Ee.data):Ee.data=ye[ue],je.push(Ee)}return je}function A(ye,je){var ue=ye[je+"axis"];return typeof ue=="object"&&(ue=ue.n),typeof ue!="number"&&(ue=1),ue}function R(){return _.grep(h.concat(y),function(ye){return ye})}function S(ye){var je={},ue,Ee;for(ue=0;ue<h.length;++ue)Ee=h[ue],Ee&&(je["x"+Ee.n]=Ee.c2p(ye.left));for(ue=0;ue<y.length;++ue)Ee=y[ue],Ee&&(je["y"+Ee.n]=Ee.c2p(ye.top));return je.x1!==void 0&&(je.x=je.x1),je.y1!==void 0&&(je.y=je.y1),je}function O(ye){var je={},ue,Ee,Ce;for(ue=0;ue<h.length;++ue)if(Ee=h[ue],Ee&&Ee.used&&(Ce="x"+Ee.n,ye[Ce]==null&&Ee.n==1&&(Ce="x"),ye[Ce]!=null)){je.left=Ee.p2c(ye[Ce]);break}for(ue=0;ue<y.length;++ue)if(Ee=y[ue],Ee&&Ee.used&&(Ce="y"+Ee.n,ye[Ce]==null&&Ee.n==1&&(Ce="y"),ye[Ce]!=null)){je.top=Ee.p2c(ye[Ce]);break}return je}function j(ye,je){return ye[je-1]||(ye[je-1]={n:je,direction:ye==h?"x":"y",options:_.extend(!0,{},ye==h?l.xaxis:l.yaxis)}),ye[je-1]}function B(){var ye=i.length,je=-1,ue;for(ue=0;ue<i.length;++ue){var Ee=i[ue].color;Ee!=null&&(ye--,typeof Ee=="number"&&Ee>je&&(je=Ee))}ye<=je&&(ye=je+1);var Ce,Ne=[],Fe=l.colors,Ue=Fe.length,fe=0;for(ue=0;ue<ye;ue++)Ce=_.color.parse(Fe[ue%Ue]||"#666"),ue%Ue==0&&ue&&(fe>=0?fe<.5?fe=-fe-.2:fe=0:fe=-fe),Ne[ue]=Ce.scale("rgb",1+fe);var Te=0,Ge;for(ue=0;ue<i.length;++ue){if(Ge=i[ue],Ge.color==null?(Ge.color=Ne[Te].toString(),++Te):typeof Ge.color=="number"&&(Ge.color=Ne[Ge.color].toString()),Ge.lines.show==null){var Qe,st=!0;for(Qe in Ge)if(Ge[Qe]&&Ge[Qe].show){st=!1;break}st&&(Ge.lines.show=!0)}Ge.lines.zero==null&&(Ge.lines.zero=!!Ge.lines.fill),Ge.xaxis=j(h,A(Ge,"x")),Ge.yaxis=j(y,A(Ge,"y"))}}function N(){var ye=Number.POSITIVE_INFINITY,je=Number.NEGATIVE_INFINITY,ue=Number.MAX_VALUE,Ee,Ce,Ne,Fe,Ue,fe,Te,Ge,Qe,st,Xe,ot,ft,_e,et,it;function dt(Ot,jt,Ut){jt<Ot.datamin&&jt!=-ue&&(Ot.datamin=jt),Ut>Ot.datamax&&Ut!=ue&&(Ot.datamax=Ut)}for(_.each(R(),function(Ot,jt){jt.datamin=ye,jt.datamax=je,jt.used=!1}),Ee=0;Ee<i.length;++Ee)fe=i[Ee],fe.datapoints={points:[]},x(m.processRawData,[fe,fe.data,fe.datapoints]);for(Ee=0;Ee<i.length;++Ee){if(fe=i[Ee],et=fe.data,it=fe.datapoints.format,!it){if(it=[],it.push({x:!0,number:!0,required:!0}),it.push({y:!0,number:!0,required:!0}),fe.stack||fe.bars.show||fe.lines.show&&fe.lines.fill){var ze=!!(fe.bars.show&&fe.bars.zero||fe.lines.show&&fe.lines.zero);it.push({y:!0,number:!0,required:!1,defaultValue:0,autoscale:ze}),fe.bars.horizontal&&(delete it[it.length-1].y,it[it.length-1].x=!0)}fe.datapoints.format=it}if(fe.datapoints.pointsize==null){fe.datapoints.pointsize=it.length,Ge=fe.datapoints.pointsize,Te=fe.datapoints.points;var xe=fe.lines.show&&fe.lines.steps;for(fe.xaxis.used=fe.yaxis.used=!0,Ce=Ne=0;Ce<et.length;++Ce,Ne+=Ge){_e=et[Ce];var Oe=_e==null;if(!Oe)for(Fe=0;Fe<Ge;++Fe)ot=_e[Fe],ft=it[Fe],ft&&(ft.number&&ot!=null&&(ot=+ot,isNaN(ot)?ot=null:ot==1/0?ot=ue:ot==-1/0&&(ot=-ue)),ot==null&&(ft.required&&(Oe=!0),ft.defaultValue!=null&&(ot=ft.defaultValue))),Te[Ne+Fe]=ot;if(Oe)for(Fe=0;Fe<Ge;++Fe)ot=Te[Ne+Fe],ot!=null&&(ft=it[Fe],ft.autoscale!==!1&&(ft.x&&dt(fe.xaxis,ot,ot),ft.y&&dt(fe.yaxis,ot,ot))),Te[Ne+Fe]=null;if(xe&&Ne>0&&(!Oe||Te[Ne-Ge]!=null)){for(Fe=0;Fe<Ge;++Fe)Te[Ne+Ge+Fe]=Te[Ne+Fe];Te[Ne+1]=Te[Ne-Ge+1]||0,Oe&&(Te[Ne]=_e[0]),Ne+=Ge}}}}for(Ee=0;Ee<i.length;++Ee){if(fe=i[Ee],Te=fe.datapoints.points,Ge=fe.datapoints.pointsize,fe.transform==="negative-Y")for(Ce=0;Ce<Te.length;Ce+=Ge)Te[Ce]!=null&&(ot=Te[Ce+1],Te[Ce+1]=-ot);x(m.processDatapoints,[fe,fe.datapoints])}for(Ee=0;Ee<i.length;++Ee){fe=i[Ee],Te=fe.datapoints.points,Ge=fe.datapoints.pointsize,it=fe.datapoints.format;var Le=ye,Ze=ye,qe=je,rt=je;for(Ce=0;Ce<Te.length;Ce+=Ge)if(Te[Ce]!=null)for(Fe=0;Fe<Ge;++Fe)ot=Te[Ce+Fe],ft=it[Fe],!(!ft||ft.autoscale===!1||ot==ue||ot==-ue)&&(ft.x&&(ot<Le&&(Le=ot),ot>qe&&(qe=ot)),ft.y&&(ot<Ze&&(Ze=ot),ot>rt&&(rt=ot)));if(fe.bars.show){var vt;switch(fe.bars.align){case"left":vt=0;break;case"right":vt=-fe.bars.barWidth;break;default:vt=-fe.bars.barWidth/2}fe.bars.horizontal?(Ze+=vt,rt+=vt+fe.bars.barWidth):(Le+=vt,qe+=vt+fe.bars.barWidth)}dt(fe.xaxis,Le,qe),dt(fe.yaxis,Ze,rt)}_.each(R(),function(Ot,jt){jt.datamin==ye&&(jt.datamin=null),jt.datamax==je&&(jt.datamax=null)})}function I(){r.find(".flot-temp-elem").remove(),r.css("position")=="static"&&r.css("position","relative"),d=new e("flot-base",r),o=new e("flot-overlay",r),c=d.context,p=o.context,u=_(o.element).unbind();var ye=r.data("plot");ye&&(ye.shutdown(),o.clear()),r.data("plot",D)}function K(){l.grid.hoverable&&(u.mousemove(Se),u.bind("mouseleave",De),_(document).bind("touchend",Me)),l.grid.clickable&&u.click(Ke),x(m.bindEvents,[u])}function w(){Ie&&clearTimeout(Ie),u.unbind("mousemove",Se),u.unbind("mouseleave",De),u.unbind("click",Ke),_(document).unbind("touchend",Me),x(m.shutdown,[u])}function U(ye){function je(Fe){return Fe}var ue,Ee,Ce=ye.options.transform||je,Ne=ye.options.inverseTransform;ye.direction=="x"?(ue=ye.scale=v/Math.abs(Ce(ye.max)-Ce(ye.min)),Ee=Math.min(Ce(ye.max),Ce(ye.min))):(ue=ye.scale=P/Math.abs(Ce(ye.max)-Ce(ye.min)),ue=-ue,Ee=Math.max(Ce(ye.max),Ce(ye.min))),Ce==je?ye.p2c=function(Fe){return(Fe-Ee)*ue}:ye.p2c=function(Fe){return(Ce(Fe)-Ee)*ue},Ne?ye.c2p=function(Fe){return Ne(Ee+Fe/ue)}:ye.c2p=function(Fe){return Ee+Fe/ue}}function W(ye){for(var je=ye.options,ue=ye.ticks||[],Ee=je.labelWidth||0,Ce=je.labelHeight||0,Ne=Ee||(ye.direction=="x"?Math.floor(d.width/(ue.length||1)):null),Fe=ye.direction+"Axis "+ye.direction+ye.n+"Axis",Ue="flot-"+ye.direction+"-axis flot-"+ye.direction+ye.n+"-axis "+Fe,fe=je.font||"flot-tick-label tickLabel",Te=0;Te<ue.length;++Te){var Ge=ue[Te];if(Ge.label){var Qe=d.getTextInfo(Ue,Ge.label,fe,null,Ne);Ee=Math.max(Ee,Qe.width+1),Ce=Math.max(Ce,Qe.height)}}ye.labelWidth=je.labelWidth||Ee,ye.labelHeight=je.labelHeight||Ce}function H(ye){var je=ye.labelWidth,ue=ye.labelHeight,Ee=ye.options.position,Ce=ye.direction==="x",Ne=ye.options.tickLength,Fe=l.grid.axisMargin,Ue=l.grid.labelMargin,fe=l.grid.eventSectionHeight,Te=!0,Ge=!0,Qe=!0,st=!1;_.each(Ce?h:y,function(Xe,ot){ot&&(ot.show||ot.reserveSpace)&&(ot===ye?st=!0:ot.options.position===Ee&&(st?Ge=!1:Te=!1),st||(Qe=!1))}),Ge&&(Fe=0),Ne==null&&(Ne=Qe?"full":5),isNaN(+Ne)||(Ue+=+Ne),Ce?(ue+=Ue,ue+=fe,Ee=="bottom"?(f.bottom+=ue+Fe,ye.box={top:d.height-f.bottom,height:ue}):(ye.box={top:f.top+Fe,height:ue},f.top+=ue+Fe)):(je+=Ue,Ee=="left"?(ye.box={left:f.left+Fe,width:je},f.left+=je+Fe):(f.right+=je+Fe,ye.box={left:d.width-f.right,width:je})),ye.position=Ee,ye.tickLength=Ne,ye.box.padding=Ue,ye.box.eventSectionPadding=fe,ye.innermost=Te}function z(ye){ye.direction=="x"?(ye.box.left=f.left-ye.labelWidth/2,ye.box.width=d.width-f.left-f.right+ye.labelWidth):(ye.box.top=f.top-ye.labelHeight/2,ye.box.height=d.height-f.bottom-f.top+ye.labelHeight)}function G(){var ye=l.grid.minBorderMargin,je,ue;if(ye==null)for(ye=0,ue=0;ue<i.length;++ue)ye=Math.max(ye,2*(i[ue].points.radius+i[ue].points.lineWidth/2));var Ee={left:ye,right:ye,top:ye,bottom:ye};_.each(R(),function(Ce,Ne){Ne.reserveSpace&&Ne.ticks&&Ne.ticks.length&&(Ne.direction==="x"?(Ee.left=Math.max(Ee.left,Ne.labelWidth/2),Ee.right=Math.max(Ee.right,Ne.labelWidth/2)):(Ee.bottom=Math.max(Ee.bottom,Ne.labelHeight/2),Ee.top=Math.max(Ee.top,Ne.labelHeight/2)))}),f.left=Math.ceil(Math.max(Ee.left,f.left)),f.right=Math.ceil(Math.max(Ee.right,f.right)),f.top=Math.ceil(Math.max(Ee.top,f.top)),f.bottom=Math.ceil(Math.max(Ee.bottom,f.bottom))}function M(){var ye,je=R(),ue=l.grid.show;for(var Ee in f){var Ce=l.grid.margin||0;f[Ee]=typeof Ce=="number"?Ce:Ce[Ee]||0}x(m.processOffset,[f]);for(var Ee in f)typeof l.grid.borderWidth=="object"?f[Ee]+=ue?l.grid.borderWidth[Ee]:0:f[Ee]+=ue?l.grid.borderWidth:0;if(_.each(je,function(Ue,fe){var Te=fe.options;fe.show=Te.show==null?fe.used:Te.show,fe.reserveSpace=Te.reserveSpace==null?fe.show:Te.reserveSpace,Q(fe)}),x(m.processRange,[]),ue){for(var Ne=_.grep(je,function(Ue){return Ue.show||Ue.reserveSpace}),Fe=!1,ye=0;ye<2&&(_.each(Ne,function(fe,Te){q(Te),te(Te),Fe=X(Te,Te.ticks)||Fe,W(Te)}),Fe&&m.processRange.length>0);ye++)x(m.processRange,[]),Fe=!1;for(ye=Ne.length-1;ye>=0;--ye)H(Ne[ye]);G(),_.each(Ne,function(Ue,fe){z(fe)})}v=d.width-f.left-f.right,P=d.height-f.bottom-f.top,_.each(je,function(Ue,fe){U(fe)}),ue&&re(),pe()}function Q(ye){var je=ye.options,ue=+(je.min!=null?je.min:ye.datamin),Ee=+(je.max!=null?je.max:ye.datamax),Ce=Ee-ue;if(Ce==0){var Ne=.25,Fe=Math.abs(Ee==0?1:Ee*Ne);je.min==null&&(ue-=Fe),(je.max==null||je.min!=null)&&(Ee+=Fe)}else{var Ue=je.autoscaleMargin;Ue!=null&&(je.min==null&&(ue-=Ce*Ue,ue<0&&ye.datamin!=null&&ye.datamin>=0&&(ue=0)),je.max==null&&(Ee+=Ce*Ue,Ee>0&&ye.datamax!=null&&ye.datamax<=0&&(Ee=0)))}ye.min=ue,ye.max=Ee}function Y(ye){if(ye=Math.abs(String(ye).replace(".","")),ye==0)return 0;for(;ye!=0&&ye%10==0;)ye/=10;return Math.floor(Math.log(ye)/Math.LN10)+1}function q(ye){var je=ye.options,ue;typeof je.ticks=="number"&&je.ticks>0?ue=je.ticks:ue=.3*Math.sqrt(ye.direction=="x"?d.width:d.height);var Ee=(ye.max-ye.min)/ue,Ce=-Math.floor(Math.log(Ee)/Math.LN10),Ne=je.tickDecimals;Ne!=null&&Ce>Ne&&(Ce=Ne);var Fe=Math.pow(10,-Ce),Ue=Ee/Fe,fe;if(Ue<1.5?fe=1:Ue<3?(fe=2,Ue>2.25&&(Ne==null||Ce+1<=Ne)&&(fe=2.5,++Ce)):Ue<7.5?fe=5:fe=10,fe*=Fe,je.minTickSize!=null&&fe<je.minTickSize&&(fe=je.minTickSize),ye.delta=Ee,ye.tickDecimals=Math.max(0,Ne??Ce),ye.tickSize=je.tickSize||fe,je.mode=="time"&&!ye.tickGenerator)throw new Error("Time mode requires the flot.time plugin.");if(ye.tickGenerator||(ye.tickGenerator=function(Xe){var ot=[],ft=n(Xe.min,Xe.tickSize),_e=0,et=Number.NaN,it;do it=et,et=ft+_e*Xe.tickSize,ot.push(et),++_e;while(et<Xe.max&&et!=it);return ot},ye.tickFormatter=function(Xe,ot){var ft=ot.tickDecimals?Math.pow(10,ot.tickDecimals):1,_e=""+Math.round(Xe*ft)/ft;if(ot.tickDecimals!=null){var et=_e.indexOf("."),it=et==-1?0:_e.length-et-1;if(it<ot.tickDecimals)return(it?_e:_e+".")+(""+ft).substr(1,ot.tickDecimals-it)}return _e}),_.isFunction(je.tickFormatter)&&(ye.tickFormatter=function(Xe,ot){return""+je.tickFormatter(Xe,ot)}),je.alignTicksWithAxis!=null){var Te=(ye.direction=="x"?h:y)[je.alignTicksWithAxis-1];if(Te&&Te.used&&Te!=ye){var Ge=ye.tickGenerator(ye);if(Ge.length>0&&(je.min==null&&(ye.min=Math.min(ye.min,Ge[0])),je.max==null&&Ge.length>1&&(ye.max=Math.max(ye.max,Ge[Ge.length-1]))),ye.tickGenerator=function(Xe){var ot=[],ft,_e;for(_e=0;_e<Te.ticks.length;++_e)ft=(Te.ticks[_e].v-Te.min)/(Te.max-Te.min),ft=Xe.min+ft*(Xe.max-Xe.min),ot.push(ft);return ot},!ye.mode&&je.tickDecimals==null){var Qe=Math.max(0,-Math.floor(Math.log(ye.delta)/Math.LN10)+1),st=ye.tickGenerator(ye);st.length>1&&/\..*0$/.test((st[1]-st[0]).toFixed(Qe))||(ye.tickDecimals=Qe)}}}}function te(ye){var je=ye.options.ticks,ue=[];je==null||typeof je=="number"&&je>0?ue=ye.tickGenerator(ye):je&&(_.isFunction(je)?ue=je(ye):ue=je);var Ee,Ce;for(ye.ticks=[],Ee=0;Ee<ue.length;++Ee){var Ne=null,Fe=ue[Ee];typeof Fe=="object"?(Ce=+Fe[0],Fe.length>1&&(Ne=Fe[1])):Ce=+Fe,Ne==null&&(Ne=ye.tickFormatter(Ce,ye)),isNaN(Ce)||ye.ticks.push({v:Ce,label:Ne})}}function X(ye,je){var ue=!1;return ye.options.autoscaleMargin&&je.length>0&&(ye.options.min==null&&(ye.min=Math.min(ye.min,je[0].v),ue=!0),ye.options.max==null&&je.length>1&&(ye.max=Math.max(ye.max,je[je.length-1].v),ue=!0)),ue}function ee(){d.clear(),x(m.drawBackground,[c]);var ye=l.grid;ye.show&&ye.backgroundColor&&Z(),ye.show&&!ye.aboveData&&ae();for(var je=0;je<i.length;++je)x(m.drawSeries,[c,i[je]]),de(i[je]);x(m.draw,[c]),ye.show&&ye.aboveData&&ae(),d.render(),Be()}function ne(ye,je){for(var ue,Ee,Ce,Ne,Fe=R(),Ue=0;Ue<Fe.length;++Ue)if(ue=Fe[Ue],ue.direction==je&&(Ne=je+ue.n+"axis",!ye[Ne]&&ue.n==1&&(Ne=je+"axis"),ye[Ne])){Ee=ye[Ne].from,Ce=ye[Ne].to;break}if(ye[Ne]||(ue=je=="x"?h[0]:y[0],Ee=ye[je+"1"],Ce=ye[je+"2"]),Ee!=null&&Ce!=null&&Ee>Ce){var fe=Ee;Ee=Ce,Ce=fe}return{from:Ee,to:Ce,axis:ue}}function Z(){c.save(),c.translate(f.left,f.top),c.fillStyle=Tt(l.grid.backgroundColor,P,0,"rgba(255, 255, 255, 0)"),c.fillRect(0,0,v,P),c.restore()}function ae(){var ye,je,ue,Ee;c.save(),c.translate(f.left,f.top);var Ce=l.grid.markings;if(Ce)for(_.isFunction(Ce)&&(je=D.getAxes(),je.xmin=je.xaxis.min,je.xmax=je.xaxis.max,je.ymin=je.yaxis.min,je.ymax=je.yaxis.max,Ce=Ce(je)),ye=0;ye<Ce.length;++ye){var Ne=Ce[ye],Fe=ne(Ne,"x"),Ue=ne(Ne,"y");if(Fe.from==null&&(Fe.from=Fe.axis.min),Fe.to==null&&(Fe.to=Fe.axis.max),Ue.from==null&&(Ue.from=Ue.axis.min),Ue.to==null&&(Ue.to=Ue.axis.max),!(Fe.to<Fe.axis.min||Fe.from>Fe.axis.max||Ue.to<Ue.axis.min||Ue.from>Ue.axis.max)){Fe.from=Math.max(Fe.from,Fe.axis.min),Fe.to=Math.min(Fe.to,Fe.axis.max),Ue.from=Math.max(Ue.from,Ue.axis.min),Ue.to=Math.min(Ue.to,Ue.axis.max);var fe=Fe.from===Fe.to,Te=Ue.from===Ue.to;if(!(fe&&Te))if(Fe.from=Math.floor(Fe.axis.p2c(Fe.from)),Fe.to=Math.floor(Fe.axis.p2c(Fe.to)),Ue.from=Math.floor(Ue.axis.p2c(Ue.from)),Ue.to=Math.floor(Ue.axis.p2c(Ue.to)),fe||Te){var Ge=Ne.lineWidth||l.grid.markingsLineWidth,Qe=Ge%2?.5:0;c.beginPath(),c.strokeStyle=Ne.color||l.grid.markingsColor,c.lineWidth=Ge,fe?(c.moveTo(Fe.to+Qe,Ue.from),c.lineTo(Fe.to+Qe,Ue.to)):(c.moveTo(Fe.from,Ue.to+Qe),c.lineTo(Fe.to,Ue.to+Qe)),c.stroke()}else c.fillStyle=Ne.color||l.grid.markingsColor,c.fillRect(Fe.from,Ue.to,Fe.to-Fe.from,Ue.from-Ue.to)}}je=R(),ue=l.grid.borderWidth;for(var st=0;st<je.length;++st){var Xe=je[st],ot=Xe.box,ft=Xe.tickLength,_e,et,it,dt;if(!(!Xe.show||Xe.ticks.length==0)){for(c.lineWidth=1,Xe.direction=="x"?(_e=0,ft=="full"?et=Xe.position=="top"?0:P:et=ot.top-f.top+(Xe.position=="top"?ot.height:0)):(et=0,ft=="full"?_e=Xe.position=="left"?0:v:_e=ot.left-f.left+(Xe.position=="left"?ot.width:0)),Xe.innermost||(c.strokeStyle=Xe.options.color,c.beginPath(),it=dt=0,Xe.direction=="x"?it=v+1:dt=P+1,c.lineWidth==1&&(Xe.direction=="x"?et=Math.floor(et)+.5:_e=Math.floor(_e)+.5),c.moveTo(_e,et),c.lineTo(_e+it,et+dt),c.stroke()),c.strokeStyle=Xe.options.tickColor,c.beginPath(),ye=0;ye<Xe.ticks.length;++ye){var ze=Xe.ticks[ye].v;it=dt=0,!(isNaN(ze)||ze<Xe.min||ze>Xe.max||ft=="full"&&(typeof ue=="object"&&ue[Xe.position]>0||ue>0)&&(ze==Xe.min||ze==Xe.max))&&(Xe.direction=="x"?(_e=Xe.p2c(ze),dt=ft=="full"?-P:ft,Xe.position=="top"&&(dt=-dt)):(et=Xe.p2c(ze),it=ft=="full"?-v:ft,Xe.position=="left"&&(it=-it)),c.lineWidth==1&&(Xe.direction=="x"?_e=Math.floor(_e)+.5:et=Math.floor(et)+.5),c.moveTo(_e,et),c.lineTo(_e+it,et+dt))}c.stroke()}}ue&&(Ee=l.grid.borderColor,typeof ue=="object"||typeof Ee=="object"?(typeof ue!="object"&&(ue={top:ue,right:ue,bottom:ue,left:ue}),typeof Ee!="object"&&(Ee={top:Ee,right:Ee,bottom:Ee,left:Ee}),ue.top>0&&(c.strokeStyle=Ee.top,c.lineWidth=ue.top,c.beginPath(),c.moveTo(0-ue.left,0-ue.top/2),c.lineTo(v,0-ue.top/2),c.stroke()),ue.right>0&&(c.strokeStyle=Ee.right,c.lineWidth=ue.right,c.beginPath(),c.moveTo(v+ue.right/2,0-ue.top),c.lineTo(v+ue.right/2,P),c.stroke()),ue.bottom>0&&(c.strokeStyle=Ee.bottom,c.lineWidth=ue.bottom,c.beginPath(),c.moveTo(v+ue.right,P+ue.bottom/2),c.lineTo(0,P+ue.bottom/2),c.stroke()),ue.left>0&&(c.strokeStyle=Ee.left,c.lineWidth=ue.left,c.beginPath(),c.moveTo(0-ue.left/2,P+ue.bottom),c.lineTo(0-ue.left/2,0),c.stroke())):(c.lineWidth=ue,c.strokeStyle=l.grid.borderColor,c.strokeRect(-ue/2,-ue/2,v+ue,P+ue))),c.restore()}function re(){_.each(R(),function(ye,je){var ue=je.box,Ee=je.direction+"Axis "+je.direction+je.n+"Axis",Ce="flot-"+je.direction+"-axis flot-"+je.direction+je.n+"-axis "+Ee,Ne=je.options.font||"flot-tick-label tickLabel",Fe,Ue,fe,Te,Ge;if(d.removeText(Ce),!(!je.show||je.ticks.length==0))for(var Qe=0;Qe<je.ticks.length;++Qe)Fe=je.ticks[Qe],!(!Fe.label||Fe.v<je.min||Fe.v>je.max)&&(je.direction=="x"?(Te="center",Ue=f.left+je.p2c(Fe.v),je.position=="bottom"?fe=ue.top+ue.padding+ue.eventSectionPadding:(fe=ue.top+ue.height-ue.padding,Ge="bottom")):(Ge="middle",fe=f.top+je.p2c(Fe.v),je.position=="left"?(Ue=ue.left+ue.width-ue.padding,Te="right"):Ue=ue.left+ue.padding),d.addText(Ce,Ue,fe,Fe.label,Ne,null,null,Te,Ge))})}function se(ye){for(var je=[],ue=null,Ee=null,Ce=ye.datapoints,Ne=[],Fe=0;Fe<Ce.pointsize-2;Fe++)Ne.push(0);for(var Ue=0;Ue<Ce.points.length;Ue+=Ce.pointsize){var fe=Ce.points[Ue],Te=Ce.points[Ue+1];Ue===Ce.points.length-Ce.pointsize?Ee=null:Ee=Ce.points[Ue+Ce.pointsize],fe!==null&&Te!==null&&ue===null&&Ee===null&&(je.push(fe),je.push(Te),je.push.apply(je,Ne)),ue=fe}var Ge=Ce.points;Ce.points=je,ye.points.radius=ye.lines.lineWidth/2,he(ye),Ce.points=Ge}function de(ye){ye.lines.show&&(le(ye),!ye.points.show&&!ye.bars.show&&se(ye)),ye.bars.show&&J(ye),ye.points.show&&he(ye)}function le(ye){function je(Ue,fe,Te,Ge,Qe){var st=Ue.points,Xe=Ue.pointsize,ot=null,ft=null;c.beginPath();for(var _e=Xe;_e<st.length;_e+=Xe){var et=st[_e-Xe],it=st[_e-Xe+1],dt=st[_e],ze=st[_e+1];if(!(et==null||dt==null)){if(it<=ze&&it<Qe.min){if(ze<Qe.min)continue;et=(Qe.min-it)/(ze-it)*(dt-et)+et,it=Qe.min}else if(ze<=it&&ze<Qe.min){if(it<Qe.min)continue;dt=(Qe.min-it)/(ze-it)*(dt-et)+et,ze=Qe.min}if(it>=ze&&it>Qe.max){if(ze>Qe.max)continue;et=(Qe.max-it)/(ze-it)*(dt-et)+et,it=Qe.max}else if(ze>=it&&ze>Qe.max){if(it>Qe.max)continue;dt=(Qe.max-it)/(ze-it)*(dt-et)+et,ze=Qe.max}if(et<=dt&&et<Ge.min){if(dt<Ge.min)continue;it=(Ge.min-et)/(dt-et)*(ze-it)+it,et=Ge.min}else if(dt<=et&&dt<Ge.min){if(et<Ge.min)continue;ze=(Ge.min-et)/(dt-et)*(ze-it)+it,dt=Ge.min}if(et>=dt&&et>Ge.max){if(dt>Ge.max)continue;it=(Ge.max-et)/(dt-et)*(ze-it)+it,et=Ge.max}else if(dt>=et&&dt>Ge.max){if(et>Ge.max)continue;ze=(Ge.max-et)/(dt-et)*(ze-it)+it,dt=Ge.max}(et!=ot||it!=ft)&&c.moveTo(Ge.p2c(et)+fe,Qe.p2c(it)+Te),ot=dt,ft=ze,c.lineTo(Ge.p2c(dt)+fe,Qe.p2c(ze)+Te)}}c.stroke()}function ue(Ue,fe,Te){for(var Ge=Ue.points,Qe=Ue.pointsize,st=Math.min(Math.max(0,Te.min),Te.max),Xe=0,ot,ft=!1,_e=1,et=0,it=0;!(Qe>0&&Xe>Ge.length+Qe);){Xe+=Qe;var dt=Ge[Xe-Qe],ze=Ge[Xe-Qe+_e],xe=Ge[Xe],Oe=Ge[Xe+_e];if(ft){if(Qe>0&&dt!=null&&xe==null){it=Xe,Qe=-Qe,_e=2;continue}if(Qe<0&&Xe==et+Qe){c.fill(),ft=!1,Qe=-Qe,_e=1,Xe=et=it+Qe;continue}}if(!(dt==null||xe==null)){if(dt<=xe&&dt<fe.min){if(xe<fe.min)continue;ze=(fe.min-dt)/(xe-dt)*(Oe-ze)+ze,dt=fe.min}else if(xe<=dt&&xe<fe.min){if(dt<fe.min)continue;Oe=(fe.min-dt)/(xe-dt)*(Oe-ze)+ze,xe=fe.min}if(dt>=xe&&dt>fe.max){if(xe>fe.max)continue;ze=(fe.max-dt)/(xe-dt)*(Oe-ze)+ze,dt=fe.max}else if(xe>=dt&&xe>fe.max){if(dt>fe.max)continue;Oe=(fe.max-dt)/(xe-dt)*(Oe-ze)+ze,xe=fe.max}if(ft||(c.beginPath(),c.moveTo(fe.p2c(dt),Te.p2c(st)),ft=!0),ze>=Te.max&&Oe>=Te.max){c.lineTo(fe.p2c(dt),Te.p2c(Te.max)),c.lineTo(fe.p2c(xe),Te.p2c(Te.max));continue}else if(ze<=Te.min&&Oe<=Te.min){c.lineTo(fe.p2c(dt),Te.p2c(Te.min)),c.lineTo(fe.p2c(xe),Te.p2c(Te.min));continue}var Le=dt,Ze=xe;ze<=Oe&&ze<Te.min&&Oe>=Te.min?(dt=(Te.min-ze)/(Oe-ze)*(xe-dt)+dt,ze=Te.min):Oe<=ze&&Oe<Te.min&&ze>=Te.min&&(xe=(Te.min-ze)/(Oe-ze)*(xe-dt)+dt,Oe=Te.min),ze>=Oe&&ze>Te.max&&Oe<=Te.max?(dt=(Te.max-ze)/(Oe-ze)*(xe-dt)+dt,ze=Te.max):Oe>=ze&&Oe>Te.max&&ze<=Te.max&&(xe=(Te.max-ze)/(Oe-ze)*(xe-dt)+dt,Oe=Te.max),dt!=Le&&c.lineTo(fe.p2c(Le),Te.p2c(ze)),c.lineTo(fe.p2c(dt),Te.p2c(ze)),c.lineTo(fe.p2c(xe),Te.p2c(Oe)),xe!=Ze&&(c.lineTo(fe.p2c(xe),Te.p2c(Oe)),c.lineTo(fe.p2c(Ze),Te.p2c(Oe)))}}}c.save(),c.translate(f.left,f.top),c.lineJoin="round";var Ee=ye.lines.lineWidth,Ce=ye.shadowSize;if(Ee>0&&Ce>0){c.lineWidth=Ce,c.strokeStyle="rgba(0,0,0,0.1)";var Ne=Math.PI/18;je(ye.datapoints,Math.sin(Ne)*(Ee/2+Ce/2),Math.cos(Ne)*(Ee/2+Ce/2),ye.xaxis,ye.yaxis),c.lineWidth=Ce/2,je(ye.datapoints,Math.sin(Ne)*(Ee/2+Ce/4),Math.cos(Ne)*(Ee/2+Ce/4),ye.xaxis,ye.yaxis)}c.lineWidth=Ee,c.strokeStyle=ye.color;var Fe=ce(ye.lines,ye.color,0,P);Fe&&(c.fillStyle=Fe,ue(ye.datapoints,ye.xaxis,ye.yaxis)),Ee>0&&je(ye.datapoints,0,0,ye.xaxis,ye.yaxis),c.restore()}function he(ye){function je(Ue,fe,Te,Ge,Qe,st,Xe,ot){for(var ft=Ue.points,_e=Ue.pointsize,et=0;et<ft.length;et+=_e){var it=ft[et],dt=ft[et+1];it==null||it<st.min||it>st.max||dt<Xe.min||dt>Xe.max||(c.beginPath(),it=st.p2c(it),dt=Xe.p2c(dt)+Ge,ot=="circle"?c.arc(it,dt,fe,0,Qe?Math.PI:Math.PI*2,!1):ot(c,it,dt,fe,Qe),c.closePath(),Te&&(c.fillStyle=Te,c.fill()),c.stroke())}}c.save(),c.translate(f.left,f.top);var ue=ye.points.lineWidth,Ee=ye.shadowSize,Ce=ye.points.radius,Ne=ye.points.symbol;if(ue==0&&(ue=1e-4),ue>0&&Ee>0){var Fe=Ee/2;c.lineWidth=Fe,c.strokeStyle="rgba(0,0,0,0.1)",je(ye.datapoints,Ce,null,Fe+Fe/2,!0,ye.xaxis,ye.yaxis,Ne),c.strokeStyle="rgba(0,0,0,0.2)",je(ye.datapoints,Ce,null,Fe/2,!0,ye.xaxis,ye.yaxis,Ne)}c.lineWidth=ue,c.strokeStyle=ye.color,je(ye.datapoints,Ce,ce(ye.points,ye.color),0,!1,ye.xaxis,ye.yaxis,Ne),c.restore()}function ie(ye,je,ue,Ee,Ce,Ne,Fe,Ue,fe,Te,Ge){var Qe,st,Xe,ot,ft,_e,et,it,dt;Te?(it=_e=et=!0,ft=!1,Qe=ue,st=ye,ot=je+Ee,Xe=je+Ce,st<Qe&&(dt=st,st=Qe,Qe=dt,ft=!0,_e=!1)):(ft=_e=et=!0,it=!1,Qe=ye+Ee,st=ye+Ce,Xe=ue,ot=je,ot<Xe&&(dt=ot,ot=Xe,Xe=dt,it=!0,et=!1)),!(st<Fe.min||Qe>Fe.max||ot<Ue.min||Xe>Ue.max)&&(Qe<Fe.min&&(Qe=Fe.min,ft=!1),st>Fe.max&&(st=Fe.max,_e=!1),Xe<Ue.min&&(Xe=Ue.min,it=!1),ot>Ue.max&&(ot=Ue.max,et=!1),Qe=Fe.p2c(Qe),Xe=Ue.p2c(Xe),st=Fe.p2c(st),ot=Ue.p2c(ot),Ne&&(fe.fillStyle=Ne(Xe,ot),fe.fillRect(Qe,ot,st-Qe,Xe-ot)),Ge>0&&(ft||_e||et||it)&&(fe.beginPath(),fe.moveTo(Qe,Xe),ft?fe.lineTo(Qe,ot):fe.moveTo(Qe,ot),et?fe.lineTo(st,ot):fe.moveTo(st,ot),_e?fe.lineTo(st,Xe):fe.moveTo(st,Xe),it?fe.lineTo(Qe,Xe):fe.moveTo(Qe,Xe),fe.stroke()))}function J(ye){function je(Ce,Ne,Fe,Ue,fe,Te){for(var Ge=Ce.points,Qe=Ce.pointsize,st=0;st<Ge.length;st+=Qe)Ge[st]!=null&&ie(Ge[st],Ge[st+1],Ge[st+2],Ne,Fe,Ue,fe,Te,c,ye.bars.horizontal,ye.bars.lineWidth)}c.save(),c.translate(f.left,f.top),c.lineWidth=ye.bars.lineWidth,c.strokeStyle=ye.color;var ue;switch(ye.bars.align){case"left":ue=0;break;case"right":ue=-ye.bars.barWidth;break;default:ue=-ye.bars.barWidth/2}var Ee=ye.bars.fill?function(Ce,Ne){return ce(ye.bars,ye.color,Ce,Ne)}:null;je(ye.datapoints,ue,ue+ye.bars.barWidth,Ee,ye.xaxis,ye.yaxis),c.restore()}function ce(ye,je,ue,Ee){var Ce=ye.fill;if(!Ce)return null;if(ye.fillColor)return Tt(ye.fillColor,ue,Ee,je);var Ne=_.color.parse(je);return Ne.a=typeof Ce=="number"?Ce:.4,Ne.normalize(),Ne.toString()}function pe(){if(l.legend.container!=null?_.find(l.legend.container).html(""):r.find(".legend").remove(),!!l.legend.show){for(var ye=[],je=[],ue=!1,Ee=l.legend.labelFormatter,Ce,Ne,Fe=0;Fe<i.length;++Fe)Ce=i[Fe],Ce.label&&(Ne=Ee?Ee(Ce.label,Ce):Ce.label,Ne&&je.push({label:Ne,color:Ce.color}));if(l.legend.sorted)if(_.isFunction(l.legend.sorted))je.sort(l.legend.sorted);else if(l.legend.sorted=="reverse")je.reverse();else{var Ue=l.legend.sorted!="descending";je.sort(function(_e,et){return _e.label==et.label?0:_e.label<et.label!=Ue?1:-1})}for(var Fe=0;Fe<je.length;++Fe){var fe=je[Fe];Fe%l.legend.noColumns==0&&(ue&&ye.push("</tr>"),ye.push("<tr>"),ue=!0),ye.push('<td class="legendColorBox"><div style="border:1px solid '+l.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+fe.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+fe.label+"</td>")}if(ue&&ye.push("</tr>"),ye.length!=0){var Te='<table style="font-size:smaller;color:'+l.grid.color+'">'+ye.join("")+"</table>";if(l.legend.container!=null)_(l.legend.container).html(Te);else{var Ge="",Qe=l.legend.position,st=l.legend.margin;st[0]==null&&(st=[st,st]),Qe.charAt(0)=="n"?Ge+="top:"+(st[1]+f.top)+"px;":Qe.charAt(0)=="s"&&(Ge+="bottom:"+(st[1]+f.bottom)+"px;"),Qe.charAt(1)=="e"?Ge+="right:"+(st[0]+f.right)+"px;":Qe.charAt(1)=="w"&&(Ge+="left:"+(st[0]+f.left)+"px;");var Xe=_('<div class="legend">'+Te.replace('style="','style="position:absolute;'+Ge+";")+"</div>").appendTo(r);if(l.legend.backgroundOpacity!=0){var ot=l.legend.backgroundColor;ot==null&&(ot=l.grid.backgroundColor,ot&&typeof ot=="string"?ot=_.color.parse(ot):ot=_.color.extract(Xe,"background-color"),ot.a=1,ot=ot.toString());var ft=Xe.children();_('<div style="position:absolute;width:'+ft.width()+"px;height:"+ft.height()+"px;"+Ge+"background-color:"+ot+';"> </div>').prependTo(Xe).css("opacity",l.legend.backgroundOpacity)}}}}}var Pe=[],Ie=null;function ge(ye,je,ue){var Ee=l.grid.mouseActiveRadius,Ce=Ee*Ee+1,Ne=null,Fe=!1,Ue,fe,Te;for(Ue=i.length-1;Ue>=0;--Ue)if(ue(i[Ue])){var Ge=i[Ue],Qe=Ge.xaxis,st=Ge.yaxis,Xe=Ge.datapoints.points,ot=Qe.c2p(ye),ft=st.c2p(je),_e=Ee/Qe.scale,et=Ee/st.scale;if(Te=Ge.datapoints.pointsize,Qe.options.inverseTransform&&(_e=Number.MAX_VALUE),st.options.inverseTransform&&(et=Number.MAX_VALUE),Ge.lines.show||Ge.points.show)for(fe=0;fe<Xe.length;fe+=Te){var it=Xe[fe],dt=Xe[fe+1];if(it!=null&&!(it-ot>_e||it-ot<-_e||dt-ft>et||dt-ft<-et)){var ze=Math.abs(Qe.p2c(it)-ye),xe=Math.abs(st.p2c(dt)-je),Oe=ze*ze+xe*xe;Oe<Ce&&(Ce=Oe,Ne=[Ue,fe/Te])}}if(Ge.bars.show&&!Ne){var Le,Ze;switch(Ge.bars.align){case"left":Le=0;break;case"right":Le=-Ge.bars.barWidth;break;default:Le=-Ge.bars.barWidth/2}for(Ze=Le+Ge.bars.barWidth,fe=0;fe<Xe.length;fe+=Te){var it=Xe[fe],dt=Xe[fe+1],qe=Xe[fe+2];it!=null&&(i[Ue].bars.horizontal?ot<=Math.max(qe,it)&&ot>=Math.min(qe,it)&&ft>=dt+Le&&ft<=dt+Ze:ot>=it+Le&&ot<=it+Ze&&ft>=Math.min(qe,dt)&&ft<=Math.max(qe,dt))&&(Ne=[Ue,fe/Te])}}}return Ne?(Ue=Ne[0],fe=Ne[1],Te=i[Ue].datapoints.pointsize,{datapoint:i[Ue].datapoints.points.slice(fe*Te,(fe+1)*Te),dataIndex:fe,series:i[Ue],seriesIndex:Ue}):null}function Se(ye){l.grid.hoverable&&we("plothover",ye,function(je){return je.hoverable!=!1})}function De(ye){l.grid.hoverable&&we("plothover",ye,function(je){return!1})}function Ke(ye){D.isSelecting||we("plotclick",ye,function(je){return je.clickable!=!1})}function Me(ye){if(ye.cancelable){if(!u.is(ye.target)&&u.has(ye.target).length===0){we("plotleave",ye,function(je){});return}Se(be(ye)),ye.preventDefault()}}function be(ye){if(!ye||!ye.originalEvent||ye.pageX&&ye.pageY)return ye;var je=ye.originalEvent;if(je.changedTouches.length===0)return ye;var ue=je.changedTouches[0];return ye.pageX=ue.pageX,ye.pageY=ue.pageY,ye}function we(ye,je,ue){var Ee=u.offset(),Ce=je.pageX-Ee.left-f.left,Ne=je.pageY-Ee.top-f.top,Fe=S({left:Ce,top:Ne});Fe.pageX=je.pageX,Fe.pageY=je.pageY,Fe.ctrlKey=je.ctrlKey,Fe.metaKey=je.metaKey;var Ue=ge(Ce,Ne,ue);if(Ue&&(Ue.pageX=parseInt(Ue.series.xaxis.p2c(Ue.datapoint[0])+Ee.left+f.left,10),Ue.pageY=parseInt(Ue.series.yaxis.p2c(Ue.datapoint[1])+Ee.top+f.top,10)),l.grid.autoHighlight){for(var fe=0;fe<Pe.length;++fe){var Te=Pe[fe];Te.auto==ye&&!(Ue&&Te.series==Ue.series&&Te.point[0]==Ue.datapoint[0]&&Te.point[1]==Ue.datapoint[1])&&Je(Te.series,Te.point)}Ue&&Ve(Ue.series,Ue.datapoint,ye)}r.trigger(ye,[Fe,Ue])}function Be(){var ye=l.interaction.redrawOverlayInterval;if(ye==-1){He();return}Ie||(Ie=setTimeout(He,ye))}function He(){Ie=null,p.save(),o.clear(),p.translate(f.left,f.top);var ye,je;for(ye=0;ye<Pe.length;++ye)je=Pe[ye],je.series.bars.show?bt(je.series,je.point):pt(je.series,je.point);p.restore(),x(m.drawOverlay,[p])}function Ve(ye,je,ue){if(typeof ye=="number"&&(ye=i[ye]),typeof je=="number"){var Ee=ye.datapoints.pointsize;je=ye.datapoints.points.slice(Ee*je,Ee*(je+1))}var Ce=nt(ye,je);Ce==-1?(Pe.push({series:ye,point:je,auto:ue}),Be()):ue||(Pe[Ce].auto=!1)}function Je(ye,je){if(ye==null&&je==null){Pe=[],Be();return}if(typeof ye=="number"&&(ye=i[ye]),typeof je=="number"){var ue=ye.datapoints.pointsize;je=ye.datapoints.points.slice(ue*je,ue*(je+1))}var Ee=nt(ye,je);Ee!=-1&&(Pe.splice(Ee,1),Be())}function nt(ye,je){for(var ue=0;ue<Pe.length;++ue){var Ee=Pe[ue];if(Ee.series==ye&&Ee.point[0]==je[0]&&Ee.point[1]==je[1])return ue}return-1}function pt(ye,je){var ue=je[0],Ee=je[1],Ce=ye.xaxis,Ne=ye.yaxis,Fe=typeof ye.highlightColor=="string"?ye.highlightColor:_.color.parse(ye.color).scale("a",.5).toString();if(!(ue<Ce.min||ue>Ce.max||Ee<Ne.min||Ee>Ne.max)){var Ue=ye.points.radius+ye.points.lineWidth/2;p.lineWidth=Ue,p.strokeStyle=Fe;var fe=1.5*Ue;ue=Ce.p2c(ue),Ee=Ne.p2c(Ee),p.beginPath(),ye.points.symbol=="circle"?p.arc(ue,Ee,fe,0,2*Math.PI,!1):ye.points.symbol(p,ue,Ee,fe,!1),p.closePath(),p.stroke()}}function bt(ye,je){var ue=typeof ye.highlightColor=="string"?ye.highlightColor:_.color.parse(ye.color).scale("a",.5).toString(),Ee=ue,Ce;switch(ye.bars.align){case"left":Ce=0;break;case"right":Ce=-ye.bars.barWidth;break;default:Ce=-ye.bars.barWidth/2}p.lineWidth=ye.bars.lineWidth,p.strokeStyle=ue,ie(je[0],je[1],je[2]||0,Ce,Ce+ye.bars.barWidth,function(){return Ee},ye.xaxis,ye.yaxis,p,ye.bars.horizontal,ye.bars.lineWidth)}function Tt(ye,je,ue,Ee){if(typeof ye=="string")return ye;for(var Ce=c.createLinearGradient(0,ue,0,je),Ne=0,Fe=ye.colors.length;Ne<Fe;++Ne){var Ue=ye.colors[Ne];if(typeof Ue!="string"){var fe=_.color.parse(Ee);Ue.brightness!=null&&(fe=fe.scale("rgb",Ue.brightness)),Ue.opacity!=null&&(fe.a*=Ue.opacity),Ue=fe.toString()}Ce.addColorStop(Ne/(Fe-1),Ue)}return Ce}}_.plot=function(r,s,a){var g=new t(_(r),s,a,_.plot.plugins);return g},_.plot.version="0.8.3",_.plot.plugins=[],_.fn.plot=function(r,s){return this.each(function(){_.plot(this,r,s)})};function n(r,s){return s*Math.floor(r/s)}}(jQuery)},80851:()=>{(function(_){function L(e){var t={first:{x:-1,y:-1},second:{x:-1,y:-1},show:!1,active:!1},n={},r=null;function s(f){t.active&&(u(f),e.getPlaceholder().trigger("plotselecting",[i()]))}function a(f){f.which==1&&(document.body.focus(),document.onselectstart!==void 0&&n.onselectstart==null&&(n.onselectstart=document.onselectstart,document.onselectstart=function(){return!1}),document.ondrag!==void 0&&n.ondrag==null&&(n.ondrag=document.ondrag,document.ondrag=function(){return!1}),o(t.first,f),t.active=!0,r=function(v){g(v)},_(document).one("mouseup",r))}function g(f){return r=null,document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag),t.active=!1,u(f),y()?l(f):(e.getPlaceholder().trigger("plotunselected",[]),e.getPlaceholder().trigger("plotselecting",[null])),setTimeout(function(){e.isSelecting=!1},10),!1}function i(){if(!y()||!t.show)return null;var f={},v=t.first,P=t.second,m=e.getAxes(),D=!0;return _.each(m,function(x,E){E.used&&(anyUsed=!1)}),_.each(m,function(x,E){if(E.used||D){var C=E.c2p(v[E.direction]),b=E.c2p(P[E.direction]);f[x]={from:Math.min(C,b),to:Math.max(C,b)}}}),f}function l(f){var v=i();v.ctrlKey=f.ctrlKey,v.metaKey=f.metaKey,e.getPlaceholder().trigger("plotselected",[v]),v.xaxis&&v.yaxis&&e.getPlaceholder().trigger("selected",[{x1:v.xaxis.from,y1:v.yaxis.from,x2:v.xaxis.to,y2:v.yaxis.to}])}function d(f,v,P){return v<f?f:v>P?P:v}function o(f,v){var P=e.getOptions(),m=e.getPlaceholder().offset(),D=e.getPlotOffset();f.x=d(0,v.pageX-m.left-D.left,e.width()),f.y=d(0,v.pageY-m.top-D.top,e.height()),P.selection.mode=="y"&&(f.x=f==t.first?0:e.width()),P.selection.mode=="x"&&(f.y=f==t.first?0:e.height())}function u(f){f.pageX!=null&&(o(t.second,f),y()?(e.isSelecting=!0,t.show=!0,e.triggerRedrawOverlay()):c(!0))}function c(f){t.show&&(t.show=!1,e.triggerRedrawOverlay(),f||e.getPlaceholder().trigger("plotunselected",[]))}function p(f,v){var P,m,D,x,E=e.getAxes();for(var C in E)if(P=E[C],P.direction==v&&(x=v+P.n+"axis",!f[x]&&P.n==1&&(x=v+"axis"),f[x])){m=f[x].from,D=f[x].to;break}if(f[x]||(P=v=="x"?e.getXAxes()[0]:e.getYAxes()[0],m=f[v+"1"],D=f[v+"2"]),m!=null&&D!=null&&m>D){var b=m;m=D,D=b}return{from:m,to:D,axis:P}}function h(f,v){var P,m,D=e.getOptions();D.selection.mode=="y"?(t.first.x=0,t.second.x=e.width()):(m=p(f,"x"),t.first.x=m.axis.p2c(m.from),t.second.x=m.axis.p2c(m.to)),D.selection.mode=="x"?(t.first.y=0,t.second.y=e.height()):(m=p(f,"y"),t.first.y=m.axis.p2c(m.from),t.second.y=m.axis.p2c(m.to)),t.show=!0,e.triggerRedrawOverlay(),!v&&y()&&l()}function y(){var f=e.getOptions().selection.minSize;return Math.abs(t.second.x-t.first.x)>=f&&Math.abs(t.second.y-t.first.y)>=f}e.clearSelection=c,e.setSelection=h,e.getSelection=i,e.hooks.bindEvents.push(function(f,v){var P=f.getOptions();P.selection.mode!=null&&(v.mousemove(s),v.mousedown(a))}),e.hooks.drawOverlay.push(function(f,v){if(t.show&&y()){var P=f.getPlotOffset(),m=f.getOptions();v.save(),v.translate(P.left,P.top);var D=_.color.parse(m.selection.color);v.strokeStyle=D.scale("a",.8).toString(),v.lineWidth=1,v.lineJoin=m.selection.shape,v.fillStyle=D.scale("a",.4).toString();var x=Math.min(t.first.x,t.second.x)+.5,E=Math.min(t.first.y,t.second.y)+.5,C=Math.abs(t.second.x-t.first.x)-1,b=Math.abs(t.second.y-t.first.y)-1;v.fillRect(x,E,C,b),v.strokeRect(x,E,C,b),v.restore()}}),e.hooks.shutdown.push(function(f,v){v.unbind("mousemove",s),v.unbind("mousedown",a),r&&(_(document).unbind("mouseup",r),document.onselectstart!==void 0&&(document.onselectstart=n.onselectstart),document.ondrag!==void 0&&(document.ondrag=n.ondrag))})}_.plot.plugins.push({init:L,options:{selection:{mode:null,color:"#e8cfac",shape:"round",minSize:5}},name:"selection",version:"1.1"})})(jQuery)},31221:()=>{(function(_){var L={series:{stack:null}};function e(t){function n(s,a){for(var g=null,i=0;i<a.length&&s!=a[i];++i)a[i].stack==s.stack&&(g=a[i]);return g}function r(s,a,g){if(!(a.stack==null||a.stack===!1)){var i=n(a,s.getData());if(i){for(var l=g.pointsize,d=g.points,o=i.datapoints.pointsize,u=i.datapoints.points,c=[],p,h,y,f,v,P,m=a.lines.show,D=a.bars.horizontal,x=l>2&&(D?g.format[2].x:g.format[2].y),E=m&&a.lines.steps,C=D?1:0,b=D?0:1,T=0,A=0,R,S;!(T>=d.length&&A>=u.length);){if(R=c.length,T<d.length&&d[T]==null){for(S=0;S<l;++S)c.push(d[T+S]);T+=l}else if(T>=d.length){for(S=0;S<l;++S)c.push(u[A+S]);x&&(c[R+2]=u[A+b]),A+=o}else if(A>=u.length){for(S=0;S<l;++S)c.push(d[T+S]);T+=l}else if(A<u.length&&u[A]==null)A+=o;else{if(p=d[T+C],h=d[T+b],f=u[A+C],v=u[A+b],P=0,p==f){for(S=0;S<l;++S)c.push(d[T+S]);c[R+b]+=v,P=v,T+=l,A+=o}else if(p>f){if(T==0){for(S=0;S<l;++S)c.push(u[A+S]);P=v}if(T>0&&d[T-l]!=null){for(y=0,c.push(f),c.push(y+v),S=2;S<l;++S)c.push(d[T+S]);P=v}A+=o}else{for(S=0;S<l;++S)c.push(d[T+S]);A>0&&u[A-o]!=null&&(P=0),c[R+b]+=P,T+=l}fromgap=!1,R!=c.length&&x&&(c[R+2]=P)}if(E&&R!=c.length&&R>0&&c[R]!=null&&c[R]!=c[R-l]&&c[R+1]!=c[R-l+1]){for(S=0;S<l;++S)c[R+l+S]=c[R+S];c[R+1]=c[R-l+1]}}g.points=c}}}t.hooks.processDatapoints.push(r)}_.plot.plugins.push({init:e,options:L,name:"stack",version:"1.2"})})(jQuery)},91520:()=>{(function(_){var L={series:{stackpercent:null}};function e(t){var n={},r=!1,s={};function a(l,d,o,u){if(r||(r=!0,s=g(l.getData())),d.stackpercent==!0){var c=o.length;d.percents=[];var p=0,h=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(p=1,h=0);for(var y=0;y<c;y++){var f=s[o[y][p]+""];f>0?d.percents.push(o[y][h]*100/f):d.percents.push(0)}}}function g(l){var d=l.length,o={};if(d>0){for(var u=0;u<d;u++)if(l[u].stackpercent){var c=0,p=1;l[u].bars&&l[u].bars.horizontal&&l[u].bars.horizontal===!0&&(c=1,p=0);for(var h=l[u].data.length,y=0;y<h;y++){var f=0;l[u].data[y][1]!=null&&(f=l[u].data[y][p]),o[l[u].data[y][c]+""]?o[l[u].data[y][c]+""]+=f:o[l[u].data[y][c]+""]=f}}}return o}function i(l,d,o){if(d.stackpercent){r||(s=g(l.getData()));var u=[],c=0,p=1;d.bars&&d.bars.horizontal&&d.bars.horizontal===!0&&(c=1,p=0);for(var h=0;h<o.points.length;h+=3)n[o.points[h+c]]||(n[o.points[h+c]]=0),u[h+c]=o.points[h+c],u[h+p]=o.points[h+p]+n[o.points[h+c]],u[h+2]=n[o.points[h+c]],n[o.points[h+c]]+=o.points[h+p],s[u[h+c]+""]>0?(u[h+p]=u[h+p]*100/s[u[h+c]+""],u[h+2]=u[h+2]*100/s[u[h+c]+""]):(u[h+p]=0,u[h+2]=0);o.points=u}}t.hooks.processRawData.push(a),t.hooks.processDatapoints.push(i)}_.plot.plugins.push({init:e,options:L,name:"stackpercent",version:"0.1"})})(jQuery)},32176:()=>{(function(_){var L={xaxis:{timezone:null,timeformat:null,twelveHourClock:!1,monthNames:null}};function e(d,o){return o*Math.floor(d/o)}function t(d,o,u,c){if(typeof d.strftime=="function")return d.strftime(o);var p=function(x,E){return x=""+x,E=""+(E??"0"),x.length==1?E+x:x},h=[],y=!1,f=d.getHours(),v=f<12;u==null&&(u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]),c==null&&(c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]);var P;f>12?P=f-12:f==0?P=12:P=f;for(var m=0;m<o.length;++m){var D=o.charAt(m);if(y){switch(D){case"a":D=""+c[d.getDay()];break;case"b":D=""+u[d.getMonth()];break;case"d":D=p(d.getDate(),"");break;case"e":D=p(d.getDate()," ");break;case"h":case"H":D=p(f);break;case"I":D=p(P);break;case"l":D=p(P," ");break;case"m":D=p(d.getMonth()+1,"");break;case"M":D=p(d.getMinutes());break;case"q":D=""+(Math.floor(d.getMonth()/3)+1);break;case"S":D=p(d.getSeconds());break;case"y":D=p(d.getFullYear()%100);break;case"Y":D=""+d.getFullYear();break;case"p":D=v?"am":"pm";break;case"P":D=v?"AM":"PM";break;case"w":D=""+d.getDay();break}h.push(D),y=!1}else D=="%"?y=!0:h.push(D)}return h.join("")}function n(d){function o(h,y,f,v){h[y]=function(){return f[v].apply(f,arguments)}}var u={date:d};d.strftime!=null&&o(u,"strftime",d,"strftime"),o(u,"getTime",d,"getTime"),o(u,"setTime",d,"setTime");for(var c=["Date","Day","FullYear","Hours","Milliseconds","Minutes","Month","Seconds"],p=0;p<c.length;p++)o(u,"get"+c[p],d,"getUTC"+c[p]),o(u,"set"+c[p],d,"setUTC"+c[p]);return u}function r(d,o){if(o.timezone=="browser")return new Date(d);if(!o.timezone||o.timezone=="utc")return n(new Date(d));if(typeof timezoneJS<"u"&&typeof timezoneJS.Date<"u"){var u=new timezoneJS.Date;return u.setTimezone(o.timezone),u.setTime(d),u}else return n(new Date(d))}var s={second:1e3,minute:60*1e3,hour:60*60*1e3,day:24*60*60*1e3,month:30*24*60*60*1e3,quarter:3*30*24*60*60*1e3,year:365.2425*24*60*60*1e3},a=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[.25,"month"],[.5,"month"],[1,"month"],[2,"month"]],g=a.concat([[3,"month"],[6,"month"],[1,"year"]]),i=a.concat([[1,"quarter"],[2,"quarter"],[1,"year"]]);function l(d){d.hooks.processOptions.push(function(o,u){_.each(o.getAxes(),function(c,p){var h=p.options;h.mode=="time"&&(p.tickGenerator=function(y){var f=[],v=r(y.min,h),P=0,m=h.tickSize&&h.tickSize[1]==="quarter"||h.minTickSize&&h.minTickSize[1]==="quarter"?i:g;h.minTickSize!=null&&(typeof h.tickSize=="number"?P=h.tickSize:P=h.minTickSize[0]*s[h.minTickSize[1]]);for(var D=0;D<m.length-1&&!(y.delta<(m[D][0]*s[m[D][1]]+m[D+1][0]*s[m[D+1][1]])/2&&m[D][0]*s[m[D][1]]>=P);++D);var x=m[D][0],E=m[D][1];if(E=="year"){if(h.minTickSize!=null&&h.minTickSize[1]=="year")x=Math.floor(h.minTickSize[0]);else{var C=Math.pow(10,Math.floor(Math.log(y.delta/s.year)/Math.LN10)),b=y.delta/s.year/C;b<1.5?x=1:b<3?x=2:b<7.5?x=5:x=10,x*=C}x<1&&(x=1)}y.tickSize=h.tickSize||[x,E];var T=y.tickSize[0];E=y.tickSize[1];var A=T*s[E];E=="second"?v.setSeconds(e(v.getSeconds(),T)):E=="minute"?v.setMinutes(e(v.getMinutes(),T)):E=="hour"?v.setHours(e(v.getHours(),T)):E=="month"?v.setMonth(e(v.getMonth(),T)):E=="quarter"?v.setMonth(3*e(v.getMonth()/3,T)):E=="year"&&v.setFullYear(e(v.getFullYear(),T)),v.setMilliseconds(0),A>=s.minute&&v.setSeconds(0),A>=s.hour&&v.setMinutes(0),A>=s.day&&v.setHours(0),A>=s.day*4&&v.setDate(1),A>=s.month*2&&v.setMonth(e(v.getMonth(),3)),A>=s.quarter*2&&v.setMonth(e(v.getMonth(),6)),A>=s.year&&v.setMonth(0);var R=0,S=Number.NaN,O;do if(O=S,S=v.getTime(),f.push(S),E=="month"||E=="quarter")if(T<1){v.setDate(1);var j=v.getTime();v.setMonth(v.getMonth()+(E=="quarter"?3:1));var B=v.getTime();v.setTime(S+R*s.hour+(B-j)*T),R=v.getHours(),v.setHours(0)}else v.setMonth(v.getMonth()+T*(E=="quarter"?3:1));else E=="year"?v.setFullYear(v.getFullYear()+T):v.setTime(S+A);while(S<y.max&&S!=O);return f},p.tickFormatter=function(y,f){var v=r(y,f.options);if(h.timeformat!=null)return t(v,h.timeformat,h.monthNames,h.dayNames);var P=f.options.tickSize&&f.options.tickSize[1]=="quarter"||f.options.minTickSize&&f.options.minTickSize[1]=="quarter",m=f.tickSize[0]*s[f.tickSize[1]],D=f.max-f.min,x=h.twelveHourClock?" %p":"",E=h.twelveHourClock?"%I":"%H",C;m<s.minute?C=E+":%M:%S"+x:m<s.day?D<2*s.day?C=E+":%M"+x:C="%b %d "+E+":%M"+x:m<s.month?C="%b %d":P&&m<s.quarter||!P&&m<s.year?D<s.year?C="%b":C="%b %Y":P&&m<s.year?D<s.year?C="Q%q":C="Q%q %Y":C="%Y";var b=t(v,C,h.monthNames,h.dayNames);return b})})})}_.plot.plugins.push({init:l,options:L,name:"time",version:"1.0"}),_.plot.formatDate=t})(jQuery)}}]);

//# sourceMappingURL=322.177b4bb01c5d74f9b28f.js.map