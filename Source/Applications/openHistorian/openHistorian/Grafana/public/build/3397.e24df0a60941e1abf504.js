"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3397],{11389:(w,R,t)=>{t.d(R,{o:()=>g});var e=t(74848),a=t(32196),d=t(40845),M=t(13471);const g=({items:y,children:m,isPinned:n,scrollable:P=!1,maxHeight:S})=>{const h=(0,d.of)(v),r=P?{maxHeight:S,overflowY:"auto"}:{};return(0,e.jsxs)("div",{className:h.wrapper,style:r,children:[y.map(({label:l,value:u,color:s,colorIndicator:p,colorPlacement:x,isActive:D,lineStyle:E},O)=>(0,e.jsx)(M.B,{label:l,value:u,color:s,colorIndicator:p,colorPlacement:x,isActive:D,justify:"space-between",isPinned:n,lineStyle:E,showValueScroll:!P},O)),m]})},v=y=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,gap:2,borderTop:`1px solid ${y.colors.border.medium}`,padding:y.spacing(1)})})},75073:(w,R,t)=>{t.d(R,{S:()=>S});var e=t(74848),a=t(32196),d=t(67061),M=t(14689),g=t(55852),v=t(40845);function y({action:r,...l}){return(0,e.jsx)(g.$n,{variant:"primary",size:"sm",onClick:r.onClick,...l,children:r.title})}const m="add-annotation-button",n=(r,l)=>(0,e.jsx)(d.B,{direction:"column",justifyContent:"flex-start",gap:.5,children:r.map((u,s)=>(0,e.jsx)(M.R,{link:u,buttonProps:{className:l.dataLinkButton,fill:"text"}},s))}),P=r=>(0,e.jsx)(d.B,{direction:"column",justifyContent:"flex-start",children:r.map((l,u)=>(0,e.jsx)(y,{action:l,variant:"secondary"},u))}),S=({dataLinks:r,actions:l,annotate:u})=>{const s=(0,v.of)(h);return(0,e.jsxs)("div",{className:s.wrapper,children:[r.length>0&&(0,e.jsx)("div",{className:s.dataLinks,children:n(r,s)}),l&&l.length>0&&(0,e.jsx)("div",{className:s.dataLinks,children:P(l)}),u!=null&&(0,e.jsx)("div",{className:s.addAnnotations,children:(0,e.jsx)(g.$n,{icon:"comment-alt",variant:"secondary",size:"sm",id:m,onClick:u,children:"Add annotation"})})]})},h=r=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:r.spacing(0)}),dataLinks:(0,a.css)({borderTop:`1px solid ${r.colors.border.medium}`,padding:r.spacing(1)}),addAnnotations:(0,a.css)({borderTop:`1px solid ${r.colors.border.medium}`,padding:r.spacing(1)}),dataLinkButton:(0,a.css)({cursor:"pointer","&:hover":{textDecoration:"underline",background:"none"}})})},52415:(w,R,t)=>{t.d(R,{A:()=>g});var e=t(74848),a=t(32196),d=t(40845),M=t(13471);const g=({item:y,isPinned:m})=>{const n=(0,d.of)(v),{label:P,value:S,color:h,colorIndicator:r}=y;return(0,e.jsx)("div",{className:n.wrapper,children:(0,e.jsx)(M.B,{label:P,value:S,color:h,colorIndicator:r,marginRight:"22px",isPinned:m})})},v=y=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",flex:1,padding:y.spacing(1),lineHeight:1})})},55307:(w,R,t)=>{t.d(R,{i:()=>M});var e=t(74848),a=t(32196),d=t(40845);const M=({children:v,className:y})=>{const m=(0,d.of)(g);return(0,e.jsx)("div",{className:(0,a.cx)(m.wrapper,y),children:v})},g=v=>({wrapper:(0,a.css)({display:"flex",flexDirection:"column",fontSize:v.typography.bodySmall.fontSize})})},72235:(w,R,t)=>{t.d(R,{l:()=>g});var e=t(74848),a=t(32196),d=t(96540),M=t(49785);function g({defaultValues:v,onSubmit:y,validateOnMount:m=!1,validateFieldsOnMount:n,children:P,validateOn:S="onSubmit",maxWidth:h=600,...r}){const{handleSubmit:l,trigger:u,formState:s,...p}=(0,M.mN)({mode:S,defaultValues:v});return(0,d.useEffect)(()=>{m&&u(n)},[u,n,m]),(0,e.jsx)("form",{className:(0,a.css)({maxWidth:h!=="none"?h+"px":h,width:"100%"}),onSubmit:l(y),...r,children:P({errors:s.errors,formState:s,trigger:u,...p})})}},81530:(w,R,t)=>{t.d(R,{X:()=>S,k:()=>n});var e=t(90708),a=t(26272),d=t(11261),M=t(80997),g=t(17172),v=t(10096),y=t(77920),m=t(3704);const n=(l,u,s,p,x,D)=>!x||x.length===0?[]:x.map(O=>{const A=(0,e.vd)(l,u,s),B={...s,__dataContext:A},N=(ot,V,rt)=>p(ot,{...B,...V},rt);D.valueRowIndex!==void 0&&!isNaN(D.valueRowIndex)?A.value.rowIndex=D.valueRowIndex:A.value.calculatedValue=D.calculatedValue;let C={title:"",onClick:ot=>{}};return C={title:p(O.title||"",B),onClick:(ot,V)=>{P(O,N)}},C}).filter(O=>!!O),P=(l,u)=>{try{const s=new URL(h(u(l.fetch.url))),p={};let x={url:s.toString(),method:l.fetch.method,data:r(l,u),headers:p};l.fetch.headers&&l.fetch.headers.forEach(([D,E])=>{p[u(D)]=u(E)}),l.fetch.queryParams&&(l.fetch.queryParams?.forEach(([D,E])=>{s.searchParams.append(u(D),u(E))}),x.url=s.toString()),p["X-Grafana-Action"]="1",x.headers=p,(0,g.AI)().fetch(x).subscribe({error:D=>{v.lE.emit(a.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(D)},complete:()=>{v.lE.emit(a.r1.alertSuccess,["API call was successful"])}})}catch(s){v.lE.emit(a.r1.alertError,["An error has occurred. Check console output for more details."]),console.error(s);return}},S=(l=[],u=[])=>({name:"Default field",type:d.PU.string,config:{links:l,actions:u},values:[]}),h=l=>{if(l.startsWith("/")){const s=M.sQ.sanitizeUrl(l);l=(0,m.z)(s,[])}return l},r=(l,u)=>{let s=l.fetch.body?u(l.fetch.body):"{}";return l.fetch.method===y.DO.GET&&(s=void 0),s}},77920:(w,R,t)=>{t.d(R,{DO:()=>M,en:()=>e,gR:()=>a,xp:()=>d});var e=(n=>(n.Center="center",n.Left="left",n.LeftRight="leftright",n.Right="right",n.Scale="scale",n))(e||{}),a=(n=>(n.Bottom="bottom",n.Center="center",n.Scale="scale",n.Top="top",n.TopBottom="topbottom",n))(a||{}),d=(n=>(n.Contain="contain",n.Cover="cover",n.Fill="fill",n.Original="original",n.Tile="tile",n))(d||{}),M=(n=>(n.GET="GET",n.POST="POST",n.PUT="PUT",n))(M||{}),g=(n=>(n.Straight="straight",n))(g||{});const v={vertices:[]},y={connections:[]},m={infinitePan:!0,inlineEditing:!0,panZoom:!0,showAdvancedTypes:!0}},21164:(w,R,t)=>{t.d(R,{O:()=>M,u:()=>d});var e=t(32264),a=t(81530);const d=(g,v)=>{const y=[];if((g.config.links?.length??0)>0&&g.getLinks!=null){const m=g.values[v],n=g.display?g.display(m):{text:`${m}`,numeric:+m},P=new Set;g.getLinks({calculatedValue:n,valueRowIndex:v}).forEach(S=>{const h=`${S.title}/${S.href}`;P.has(h)||(y.push(S),P.add(h))})}return y},M=(g,v,y,m)=>{if(!e.$.featureToggles?.vizActions)return[];const n=[],P=new Set;return(0,a.k)(g,v,v.state.scopedVars,y,v.config.actions??[],{valueRowIndex:m}).forEach(h=>{const r=`${h.title}`;P.has(r)||(n.push(h),P.add(r))}),n}},62567:(w,R,t)=>{t.d(R,{W:()=>Ot});var e=t(74848),a=t(32196),d=t(96540),M=t(40961),g=t(84140),v=t(36613),y=t(33948),m=t(52622),n=t(23596),P=t(24284),S=t(17464),h=t(40845),r=t(46885),l=t(83505),u=t(13544),s=t(49785),p=t(29647),x=t(41053),D=t(72724),E=t(42994),O=t(79041),A=t(67061),B=t(88575),N=t(21744),C=t(55852),ot=t(72235),V=t(99818),rt=t(10154);const gt=({annoVals:o,annoIdx:i,dismiss:U,timeZone:b,...X})=>{const j=(0,h.of)(it),{onAnnotationCreate:I,onAnnotationUpdate:nt}=(0,O.d2)(),F=(0,d.useRef)(null);(0,p.A)(F,U);const[k,G]=(0,x.A)(async c=>{const L=await I(c);return U(),L}),[at,tt]=(0,x.A)(async c=>{const L=await nt(c);return U(),L}),H=c=>(0,D.LE)(c,{format:E.WC.fullDate,timeZone:b}),J=o.id?.[i]!=null,lt=o.isRegion?.[i],ut=J?tt:G,st=J?at:k,f=lt?`${H(o.time[i])} - ${H(o.timeEnd[i])}`:H(o.time[i]),_=({tags:c,description:L})=>{ut({id:o.id?.[i]??void 0,tags:c,description:L,from:Math.round(o.time[i]),to:Math.round(o.timeEnd?.[i]??o.time[i])})};return(0,e.jsxs)("div",{ref:F,className:j.editor,...X,children:[(0,e.jsx)("div",{className:j.header,children:(0,e.jsxs)(A.B,{justifyContent:"space-between",alignItems:"center",children:[(0,e.jsx)("div",{children:J?"Edit annotation":"Add annotation"}),(0,e.jsx)("div",{children:f})]})}),(0,e.jsx)(ot.l,{onSubmit:_,defaultValues:{description:o.text?.[i],tags:o.tags?.[i]||[]},children:({register:c,errors:L,control:W})=>(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:j.content,children:[(0,e.jsx)(B.D,{label:"Description",invalid:!!L.description,error:L?.description?.message,children:(0,e.jsx)(N.f,{className:j.textarea,...c("description",{required:"Annotation description is required"})})}),(0,e.jsx)(B.D,{label:"Tags",children:(0,e.jsx)(s.xI,{control:W,name:"tags",render:({field:{ref:K,onChange:Q,...T}})=>(0,e.jsx)(V.$,{allowCustomValue:!0,placeholder:"Add tags",onChange:Q,tagOptions:rt.vy,tags:T.value})})})]}),(0,e.jsx)("div",{className:j.footer,children:(0,e.jsxs)(A.B,{justifyContent:"flex-end",children:[(0,e.jsx)(C.$n,{size:"sm",variant:"secondary",onClick:U,fill:"outline",children:"Cancel"}),(0,e.jsx)(C.$n,{size:"sm",type:"submit",disabled:st?.loading,children:st?.loading?"Saving":"Save"})]})})]})})]})},it=o=>({editor:(0,a.css)({background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,borderRadius:o.shape.radius.default,boxShadow:o.shadows.z3,userSelect:"text",width:"460px"}),content:(0,a.css)({padding:o.spacing(1)}),header:(0,a.css)({borderBottom:`1px solid ${o.colors.border.weak}`,padding:o.spacing(.5,1),fontWeight:o.typography.fontWeightBold,fontSize:o.typography.fontSize,color:o.colors.text.primary}),footer:(0,a.css)({borderTop:`1px solid ${o.colors.border.weak}`,padding:o.spacing(1,1)}),textarea:(0,a.css)({color:o.colors.text.secondary,fontSize:o.typography.bodySmall.fontSize})});var $=t(80997),ct=t(66864),dt=t(29158),q=t(78369),xt=t(55907);const Et=()=>!1,Dt=({annoVals:o,annoIdx:i,timeZone:U,onEdit:b})=>{const X=o.id?.[i],j=(0,h.of)(At),{canEditAnnotations:I=Et,canDeleteAnnotations:nt=Et,onAnnotationDelete:F}=(0,O.d2)(),k=o.dashboardUID?.[i],G=I(k),at=nt(k)&&F!=null,tt=f=>(0,D.LE)(f,{format:E.WC.fullDate,timeZone:U});let H=tt(o.time[i]),J=o.text?.[i]??"";o.isRegion?.[i]&&(H+=" - "+tt(o.timeEnd[i]));let lt;o.login?.[i]&&o.avatarUrl?.[i]&&(lt=(0,e.jsx)("img",{className:j.avatar,alt:"Annotation avatar",src:o.avatarUrl[i]}));let ut=null,st="";if(o.alertId?.[i]!==void 0&&o.newState?.[i]){const f=xt.A.getStateDisplayModel(o.newState[i]);ut=(0,e.jsx)("div",{className:j.alertState,children:(0,e.jsx)("i",{className:f.stateClass,children:f.text})}),st=o.data?.[i]?xt.A.getAlertAnnotationText(o.data[i]):""}else o.title?.[i]&&(J=o.title[i]+(J?`<br />${J}`:""));return(0,e.jsxs)("div",{className:j.wrapper,children:[(0,e.jsx)("div",{className:j.header,children:(0,e.jsxs)(ct.Gy,{justify:"space-between",align:"center",spacing:"md",children:[(0,e.jsxs)("div",{className:j.meta,children:[(0,e.jsxs)("span",{children:[lt,ut]}),H]}),(G||at)&&(0,e.jsxs)("div",{className:j.editControls,children:[G&&(0,e.jsx)(dt.K,{name:"pen",size:"sm",onClick:b,tooltip:"Edit"}),at&&(0,e.jsx)(dt.K,{name:"trash-alt",size:"sm",onClick:()=>F(X),tooltip:"Delete"})]})]})}),(0,e.jsxs)("div",{className:j.body,children:[J&&(0,e.jsx)("div",{className:j.text,dangerouslySetInnerHTML:{__html:$.sQ.sanitize(J)}}),st,(0,e.jsx)("div",{children:(0,e.jsx)(ct.Gy,{spacing:"xs",wrap:!0,children:o.tags?.[i]?.map((f,_)=>(0,e.jsx)(q.v,{name:f},`${f}-${_}`))})})]})]})},At=o=>({wrapper:(0,a.css)({zIndex:o.zIndex.tooltip,whiteSpace:"initial",borderRadius:o.shape.radius.default,background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:o.shadows.z2,userSelect:"text"}),header:(0,a.css)({padding:o.spacing(.5,1),borderBottom:`1px solid ${o.colors.border.weak}`,fontWeight:o.typography.fontWeightBold,fontSize:o.typography.fontSize,color:o.colors.text.primary,display:"flex"}),meta:(0,a.css)({display:"flex",justifyContent:"space-between",color:o.colors.text.primary,fontWeight:400}),editControls:(0,a.css)({display:"flex",alignItems:"center","> :last-child":{marginLeft:0}}),body:(0,a.css)({padding:o.spacing(1),fontSize:o.typography.bodySmall.fontSize,color:o.colors.text.secondary,fontWeight:400,a:{color:o.colors.text.link,"&:hover":{textDecoration:"underline"}}}),text:(0,a.css)({paddingBottom:o.spacing(1)}),avatar:(0,a.css)({borderRadius:o.shape.radius.circle,width:16,height:16,marginRight:o.spacing(1)}),alertState:(0,a.css)({paddingRight:o.spacing(1),fontWeight:o.typography.fontWeightMedium})}),pt=0,ft=1,yt=2,Mt=({annoVals:o,annoIdx:i,className:U,style:b,exitWipEdit:X,timeZone:j,portalRoot:I})=>{const nt=(0,h.of)(Tt),[F,k]=(0,d.useState)(X!=null?ft:pt),{refs:G,floatingStyles:at}=(0,l.we)({open:!0,placement:"bottom",middleware:[(0,r.UU)({fallbackAxisSideDirection:"end",crossAxis:!1,boundary:document.body}),(0,r.BN)()],whileElementsMounted:r.ll,strategy:"fixed"}),tt=F===yt?(0,e.jsx)(Dt,{annoIdx:i,annoVals:o,timeZone:j,onEdit:()=>k(ft)}):F===ft?(0,e.jsx)(gt,{annoIdx:i,annoVals:o,timeZone:j,dismiss:()=>{X?.(),k(pt)}}):null;return(0,e.jsx)("div",{ref:G.setReference,className:U,style:b,onMouseEnter:()=>F!==ft&&k(yt),onMouseLeave:()=>F!==ft&&k(pt),"data-testid":u.Tp.pages.Dashboard.Annotations.marker,children:tt&&(0,M.createPortal)((0,e.jsx)("div",{ref:G.setFloating,className:nt.annoBox,style:at,"data-testid":"annotation-marker",children:tt}),I)})},Tt=o=>({annoBox:(0,a.css)({top:0,left:0,zIndex:o.zIndex.tooltip,borderRadius:o.shape.radius.default,position:"absolute",background:o.colors.background.primary,border:`1px solid ${o.colors.border.weak}`,boxShadow:o.shadows.z2,userSelect:"text",minWidth:"300px"})}),vt=(o,i,U,b,X)=>{o.beginPath(),o.moveTo(b,i),o.lineTo(b,U),o.strokeStyle=X,o.stroke()},ht=(0,g.A)(P.Mk).toHex8String();function Pt(o){let i={};return o.fields.forEach(U=>{i[U.name]=U.values}),i}const Ot=({annotations:o,timeZone:i,config:U,newRange:b,setNewRange:X,canvasRegionRendering:j=!0})=>{const[I,nt]=(0,d.useState)(),[F]=(0,d.useState)(()=>(0,S.gF)()),k=(0,h.of)(Ct),G=(0,h.$j)().visualization.getColorByName,[at,tt]=(0,d.useReducer)(f=>f+1,0),H=(0,d.useMemo)(()=>{let f=o.filter(_=>_.name!=="exemplar"&&_.length>0&&_.fields.some(c=>c.name==="time"));if(b){let _=b.to>b.from;const c=(0,y.I)([{time:b.from,timeEnd:_?b.to:null,isRegion:_,color:ht}]);c.meta={dataTopic:m.QR.Annotations,custom:{isWip:!0}},f.push(c)}return f},[o,b]),J=(0,d.useCallback)(()=>{X(null)},[X]),lt=(0,d.useRef)(H);lt.current=H;const ut=(0,d.useRef)(b);ut.current=b;const st=(0,d.useRef)();if((0,d.useLayoutEffect)(()=>{U.addHook("ready",f=>{let _=f.root.querySelector(".u-axis");st.current=_,nt(f)}),U.addHook("draw",f=>{let _=lt.current;const c=f.ctx;c.save(),c.beginPath(),c.rect(f.bbox.left,f.bbox.top,f.bbox.width,f.bbox.height),c.clip(),_.forEach(L=>{let W=Pt(L);if(L.name==="xymark"){let K=U.scales[0].props.scaleKey,Q=U.scales[1].props.scaleKey;for(let T=0;T<L.length;T++){let Y=G(W.color?.[T]||ht),z=f.valToPos(W.xMin[T],K,!0),Z=f.valToPos(W.xMax[T],K,!0),et=f.valToPos(W.yMax[T],Q,!0),mt=f.valToPos(W.yMin[T],Q,!0);c.fillStyle=n.MV.alpha(Y,W.fillOpacity[T]),c.fillRect(z,et,Z-z,mt-et),c.lineWidth=Math.round(W.lineWidth[T]*v.A.pxRatio),W.lineStyle[T]==="dash"?c.setLineDash([5,5]):c.setLineDash([]),c.strokeStyle=Y,c.strokeRect(z,et,Z-z,mt-et)}}else{let K=f.bbox.top,Q=K+f.bbox.height;c.lineWidth=2,c.setLineDash([5,5]);for(let T=0;T<W.time.length;T++){let Y=G(W.color?.[T]||ht),z=f.valToPos(W.time[T],"x",!0);if(!W.isRegion?.[T])vt(c,K,Q,z,Y);else if(j){vt(c,K,Q,z,Y);let Z=f.valToPos(W.timeEnd[T],"x",!0);vt(c,K,Q,Z,Y),c.fillStyle=n.MV.alpha(Y,.1),c.fillRect(z,K,Z-z,f.bbox.height)}}}}),c.restore()})},[U,j,G]),(0,d.useEffect)(()=>{I&&(I.redraw(),setTimeout(()=>{tt()},0))},[H,I]),I){let f=H.flatMap((_,c)=>{let L=Pt(_),W=[];for(let K=0;K<L.time.length;K++){let Q=G(L.color?.[K]||P.Mk),T=Math.round(I.valToPos(L.time[K],"x"))||0,Y=null,z="",Z=!0;if(L.isRegion?.[K]){let et=Math.round(I.valToPos(L.timeEnd?.[K],"x"))||0;if(Z=T<I.rect.width&&et>0,Z){let mt=Math.max(0,T),Rt=Math.min(I.rect.width,et);Y={left:mt,background:Q,width:Rt-mt},z=k.annoRegion}}else Z=T>=0&&T<=I.rect.width,Z&&(Y={left:T,borderBottomColor:Q},z=k.annoMarker);if(Z){let et=_.meta?.custom?.isWip;W.push((0,e.jsx)(Mt,{annoIdx:K,annoVals:L,className:z,style:Y,timeZone:i,exitWipEdit:et?J:null,portalRoot:F},`${c}:${K}`))}}return W});return(0,M.createPortal)(f,st.current)}return null},Ct=()=>({annoMarker:(0,a.css)({position:"absolute",width:0,height:0,borderLeft:"5px solid transparent",borderRight:"5px solid transparent",borderBottomWidth:"5px",borderBottomStyle:"solid",transform:"translateX(-50%)",cursor:"pointer",zIndex:1}),annoRegion:(0,a.css)({position:"absolute",height:"5px",cursor:"pointer",zIndex:1})})},7874:(w,R,t)=>{t.d(R,{U:()=>M});var e=t(74848),a=t(96540),d=t(55852);const M=({config:g,onChangeTimeRange:v})=>{const y=(0,a.useRef)(),[m,n]=(0,a.useState)([]),[P,S]=(0,a.useState)();if((0,a.useLayoutEffect)(()=>{g.addHook("init",x=>{y.current=x}),g.addHook("setScale",x=>{n(x.data?.[0]??[]),S(x.scales.x??void 0)})},[g]),m.length<2||!v||!P||!P.time||!P.min||!P.max)return null;let h=0,r=m.length-1;for(;h<=r&&m[h]==null;)h++;for(;r>=0&&m[r]==null;)r--;const l=m[h],u=m[r],s=P.min,p=P.max;return l==null||u==null||l<=p&&u>=s?null:(0,e.jsx)("div",{style:{position:"absolute",top:"50%",transform:"translateY(-50%)",width:"100%",textAlign:"center"},children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:"Data outside time range"}),(0,e.jsx)(d.$n,{onClick:x=>v({from:l,to:u}),variant:"secondary","data-testid":"time-series-zoom-to-data",children:"Zoom to data"})]})})};M.displayName="OutsideRangePlugin"},82915:(w,R,t)=>{t.d(R,{B_:()=>S,Fg:()=>l,O2:()=>r,T5:()=>u});var e=t(11261),a=t(28240),d=t(83195),M=t(57875),g=t(50311),v=t(46294),y=t(39624),m=t(52622),n=t(55129);function P(s){let p=new Map;return s.map(D=>({...D,fields:D.fields.map(E=>{if(E.type===e.PU.enum){let O=(0,n.M)(E.config,E.type),A=p.get(O);A||(A=[],p.set(O,A));let B=E.values.toArray().slice(),N=E.config.type.enum.text;if(A.length>0)for(let C=0;C<B.length;C++)B[C]+=A.length;return A.push(...N),E.config.type.enum.text=A,{...E,values:B}}return E})}))}function S(s,p,x,D){if(!s?.length)return null;(0,a.Fm)(s);let E=D!=null;D!=null&&D>0&&(s=[{...s[0],fields:[s[0].fields[D],...s[0].fields.filter((N,C)=>C!==D)]}]);for(let N of s)for(let C of N.fields)C.type===e.PU.time&&typeof C.values[0]!="number"&&(C.values=(0,g.s7)(C,{destinationType:e.PU.time}).values);let O=0;t:for(let N of s)for(let C of N.fields)if(C.type===e.PU.enum&&++O>1){s=P(s);break t}let A;const B=[];for(let N of s){const C=[];let ot=!1,V=!1,rt=E?N:(0,v.M)({frame:N,refFieldPseudoMin:x?.from.valueOf(),refFieldPseudoMax:x?.to.valueOf()});const gt=(0,y.C)(rt).fields;for(let it=0;it<gt?.length;it++){const $=gt[it];switch($.type){case e.PU.time:ot=!0,C.push($);break;case e.PU.number:V=E?it>0:!0,A={...$,values:$.values.map(q=>Number.isFinite(q)||q==null?q:null)},C.push(A);break;case e.PU.enum:V=!0;case e.PU.string:A={...$,values:$.values},C.push(A);break;case e.PU.boolean:V=!0;const ct=$.config?.custom??{},dt={...$.config,max:1,min:0,custom:ct};ct.lineInterpolation!==m.dx.StepBefore&&(ct.lineInterpolation=m.dx.StepAfter),A={...$,config:dt,type:e.PU.number,values:$.values.map(q=>q==null?q:q?1:0)},(0,d.j9)(dt.unit)||(dt.unit="bool",A.display=(0,M.J)({field:A,theme:p})),C.push(A);break}}(E||ot)&&V&&B.push({...N,length:rt.length,fields:C})}return B.length?(r(B,p,0),h(B,p),B):null}const h=(s,p)=>{const{palette:x}=p.visualization;for(const D of s)for(const E of D.fields)if(E.type===e.PU.enum){const O=x[E.state?.seriesIndex%x.length],A=p.visualization.getColorByName(O),B=E.config.type.enum;B.color=Array(B.text.length).fill(A),E.display=(0,M.J)({field:E,theme:p})}},r=(s,p,x)=>{let D=0;s.forEach(E=>{E.fields.forEach((O,A)=>{A!==x&&(O.type===e.PU.number||O.type===e.PU.boolean||O.type===e.PU.enum)&&(O.state={...O.state,seriesIndex:D++},O.display=(0,M.J)({field:O,theme:p}))})})};function l(s,p){return!s||!s.length?[p]:s.map(x=>x?.length?x:p)}const u=s=>s.mode===m.$N.Multi&&s.maxHeight!=null}}]);

//# sourceMappingURL=3397.e24df0a60941e1abf504.js.map