"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[4254],{41564:(ne,Y,_)=>{_.d(Y,{F:()=>s});var v=_(30252),U=_(4252),M=_(80522);function s(C,k,x,G="="){if(!k||!x)throw new Error("Need label to add to query.");const B=i(C);if(!B.length)return C;const I=g(k,x,G);return h(C,B,I)}function i(C){const k=v.E2.parse(C),x=[];return k.iterate({enter:({to:G,from:B,type:I})=>{if(I.id===v.m6){const H=(0,M._)(C.substring(B,G));return x.push({query:H.query,from:B,to:G}),!1}}}),x}function g(C,k,x){const G=k===1/0?"+Inf":k.toString();return{label:C,op:x,value:G}}function h(C,k,x){const G=new U.K;let B="",I=0;for(let H=0;H<k.length;H++){const r=k[H],a=H===k.length-1,b=C.substring(I,r.from),T=a?C.substring(r.to):"";X(r.query.labels,x)||r.query.labels.push(x);const f=G.renderQuery(r.query);B+=b+f+T,I=r.to}return B}function X(C,k){return C.find(x=>x.label===k.label&&x.value===k.value)}},36784:(ne,Y,_)=>{_.d(Y,{UQ:()=>d,ZK:()=>b,ZP:()=>S,nW:()=>l,ws:()=>L});var v=_(82897),U=_.n(v),M=_(52998),s=_(57706),i=_.n(s),g=_(46519),h=_(7238),X=_(62163),C=_(35645),k=_(8644),x=_(51649),G=_(21899),B=_(37462);const I=["job","instance"],H="{}",r=5,a=1e3*60*60*24,b=1e4,T=Q=>({label:Q}),f=Q=>(Q.kind="function",Q),e=Q=>({headers:{"X-Grafana-Cache":`private, max-age=${Q}`}});function t(Q,c){const F=Date.now()-a,y=c.filter(u=>u.ts>F&&u.query===Q.label),E=y.length,o=y[0];let O=`Queried ${E} times in the last 24h.`;if(o){const u=(0,g.CQ)(o.ts).fromNow();O=`${O} Last queried ${u}.`}return{...Q,documentation:O}}function n(Q,c){const F={label:Q};return c&&c[Q]&&(F.documentation=d(Q,c)),F}function d(Q,c){if(!c[Q])return;const{type:F,help:y}=c[Q];return`${F.toUpperCase()}: ${y}`}function L(Q,c){if(c[Q])return c[Q].help}function l(Q,c){if(c[Q])return c[Q].type}const p=/(="|!="|=~"|!~"|\{|\[|\(|\+|-|\/|\*|%|\^|\band\b|\bor\b|\bunless\b|==|>=|!=|<=|>|<|=|~|,)/,P=86400;class S extends h.iL{constructor(c,F){super(),this.labelKeys=[],this.labelsCache=new M.Z({max:10}),this.labelValuesCache=new M.Z({max:10}),this.request=async(y,E,o={},O)=>{try{return(await this.datasource.metadataRequest(y,o,O)).data.data}catch(u){console.error(u)}return E},this.start=async()=>this.datasource.lookupsDisabled?[]:(this.metrics=await this.fetchLabelValues("__name__")||[],this.histogramMetrics=(0,x.NO)(this.metrics).sort(),Promise.all([this.loadMetricsMetadata(),this.fetchLabels()])),this.provideCompletionItems=async({prefix:y,text:E,value:o,labelKey:O,wrapperClasses:u},$={})=>{const A={suggestions:[]};if(!o)return A;const R=o.document.text.length===0,V=o.document.getTextsAtRange(o.selection),W=V.size===1?V.first().getText():null,N=W?W[o.selection.anchor.offset]:null,K=u.length>3,Z=y&&!K,ee=!N||N===")",se=y&&!E.match(/^[\]})\s]+$/)&&ee,oe=/[+\-*/^%]/,Oe=E.match(oe);return u.includes("context-range")?this.getRangeCompletionItems():u.includes("context-labels")?this.getLabelCompletionItems({prefix:y,text:E,value:o,labelKey:O,wrapperClasses:u}):u.includes("context-aggregation")?this.getAggregationCompletionItems(o):R?this.getEmptyCompletionItems($):Z&&ee&&!Oe?this.getBeginningCompletionItems($):Z&&se?this.getTermCompletionItems():A},this.getBeginningCompletionItems=y=>({suggestions:[...this.getEmptyCompletionItems(y).suggestions,...this.getTermCompletionItems().suggestions]}),this.getEmptyCompletionItems=y=>{const{history:E}=y,o=[];if(E&&E.length){const O=(0,v.chain)(E).map(u=>u.query.expr).filter().uniq().take(r).map(T).map(u=>t(u,E)).value();o.push({searchFunctionType:k.Z.Prefix,skipSort:!0,label:"History",items:O})}return{suggestions:o}},this.getTermCompletionItems=()=>{const{metrics:y,metricsMetadata:E}=this,o=[];return o.push({searchFunctionType:k.Z.Prefix,label:"Functions",items:G.r8.map(f)}),y&&y.length&&o.push({label:"Metrics",items:y.map(O=>n(O,E)),searchFunctionType:k.Z.Fuzzy}),{suggestions:o}},this.getAggregationCompletionItems=async y=>{const E=[];let o;const O=y.document.getBlocks().reduce((Z,ee)=>{if(Z===void 0)return"";if(!ee)return Z;const se=ee?.getText();return y.anchorBlock.key===ee.key&&(o=y.selection.anchor.offset+Z.length),Z+se},""),u=O.lastIndexOf("(",o);let $=O.lastIndexOf("(",u-1),A=O.indexOf(")",$);if($===-1){const Z=O.indexOf(")",o);A=O.indexOf(")",Z+1),$=O.lastIndexOf("(",A)}const R={suggestions:E,context:"context-aggregation"};if($===-1)return R;const V=O.slice($+1,A).replace(/\[[^\]]+\]$/,""),W=(0,x.rV)(V,V.length-2).selector,N=await this.getSeries(W),K=Object.keys(N);if(K.length>0){const Z=(0,x.ZO)(K);E.push({label:`Labels${Z}`,items:K.map(T),searchFunctionType:k.Z.Fuzzy})}return R},this.getLabelCompletionItems=async({text:y,wrapperClasses:E,labelKey:o,value:O})=>{if(!O)return{suggestions:[]};const u=[],$=O.anchorBlock.getText(),A=O.selection.anchor.offset,R=$.substr(A),V=$.substr(0,A),W=y.match(/^(=|=~|!=|!~)/),N=R.match(/^"?[,}]|$/),K=V.match(/(=|=~|!=|!~)$/)&&R.match(/^"/);if(!(W&&N)&&!(N&&!W)||K)return{suggestions:u};let se,oe;try{oe=(0,x.rV)($,A),se=oe.selector}catch{se=H}const Oe=se.includes("__name__="),Ee=oe?oe.labelKeys:[];let le={};if(se&&(le=await this.getSeries(se,!Oe)),Object.keys(le).length===0)return console.warn(`Server did not return any values for selector = ${se}`),{suggestions:u};let ce;if(y&&W||E.includes("attr-value")){if(o&&le[o]){ce="context-label-values";const ue=(0,x.ZO)(le[o]);u.push({label:`Label values for "${o}"${ue}`,items:le[o].map(T),searchFunctionType:k.Z.Fuzzy})}}else{const ue=le?Object.keys(le):Oe?null:I;if(ue){const fe=(0,v.difference)(ue,Ee);if(fe.length){ce="context-labels";const ge=fe.map($e=>({label:$e})),_e={label:`Labels${(0,x.ZO)(ge)}`,items:ge,searchFunctionType:k.Z.Fuzzy};u.push(_e)}}}return{context:ce,suggestions:u}},this.fetchLabelValues=async y=>{const E=this.datasource.getAdjustedInterval(),O=`/api/v1/label/${this.datasource.interpolateString(y)}/values`;return await this.request(O,[],E,this.getDefaultCacheHeaders())??[]},this.getSeriesValues=async(y,E)=>this.datasource.hasLabelsMatchAPISupport()?await this.fetchSeriesValuesWithMatch(y,E):(await this.getSeries(E))[y]??[],this.fetchSeriesValuesWithMatch=async(y,E)=>{const o=y?this.datasource.interpolateString(y):null,O=this.datasource.getAdjustedInterval(),u={...O,...E&&{"match[]":E}};return C.v.featureToggles.prometheusResourceBrowserCache?await this.request(`/api/v1/label/${o}/values`,[],u,this.getDefaultCacheHeaders())??[]:await this.fetchSeriesValuesLRUCache(o,O,y,u)},this.getSeriesLabels=async(y,E)=>{let o,O;this.datasource.hasLabelsMatchAPISupport()?(E.push({name:"__name__",value:"",op:"!="}),O=await this.fetchSeriesLabelsMatch(y),o=Object.keys(O)):(O=await this.getSeries(y),o=Object.keys(O));const u=new Set(E.map($=>$.name));return o.filter($=>!u.has($))},this.fetchSeriesLabels=async(y,E)=>{const o=this.datasource.interpolateString(y),O=this.datasource.getAdjustedInterval(),u={...O,"match[]":o},$="/api/v1/series";if(!C.v.featureToggles.prometheusResourceBrowserCache)return await this.fetchSeriesLabelsLRUCache(o,O,E,$,u);const A=await this.request($,[],u,this.getDefaultCacheHeaders()),{values:R}=(0,x.DY)(A,E);return R},this.fetchSeriesLabelsMatch=async(y,E)=>{const o=this.datasource.interpolateString(y),O=this.datasource.getAdjustedInterval(),u={...O,"match[]":o},$="/api/v1/labels";return C.v.featureToggles.prometheusResourceBrowserCache?(await this.request($,[],u,this.getDefaultCacheHeaders())).reduce((R,V)=>({...R,[V]:""}),{}):await this.fetchSeriesLabelMatchLRUCache(o,O,E,$,u)},this.fetchSeries=async y=>{const E="/api/v1/series",O={...this.datasource.getTimeRangeParams(),"match[]":y};return await this.request(E,{},O,this.getDefaultCacheHeaders())},this.fetchDefaultSeries=(0,v.once)(async()=>{const y=await Promise.all(I.map(E=>this.fetchLabelValues(E)));return I.reduce((E,o,O)=>({...E,[o]:y[O]}),{})}),this.datasource=c,this.histogramMetrics=[],this.timeRange={start:0,end:0},this.metrics=[],Object.assign(this,F)}getDefaultCacheHeaders(){if(C.v.featureToggles.prometheusResourceBrowserCache&&this.datasource.cacheLevel!==B.x3.None)return e(this.datasource.getCacheDurationInMinutes()*60)}cleanText(c){return c.split(p).pop().trimLeft().replace(/"$/,"").replace(/^"/,"")}get syntax(){return G.ZP}async loadMetricsMetadata(){const c=C.v.featureToggles.prometheusResourceBrowserCache?e(this.datasource.getDaysToCacheMetadata()*P):{};this.metricsMetadata=(0,x.I4)(await this.request("/api/v1/metadata",{},{},{showErrorAlert:!1,...c}))}getLabelKeys(){return this.labelKeys}getRangeCompletionItems(){return{context:"context-range",suggestions:[{label:"Range vector",items:[...G.Ty]}]}}importFromAbstractQuery(c){return(0,x.e5)(c)}exportToAbstractQuery(c){const F=c.expr;if(!F||F.length===0)return{refId:c.refId,labelMatchers:[]};const y=i().tokenize(F,G.ZP),E=(0,x.UO)(y),o=D(F,y);return o&&o.length>0&&E.push({name:"__name__",operator:X.K2.Equal,value:o}),{refId:c.refId,labelMatchers:E}}async getSeries(c,F){if(this.datasource.lookupsDisabled)return{};try{return c===H?await this.fetchDefaultSeries():await this.fetchSeriesLabels(c,F)}catch(y){return console.error(y),{}}}async getLabelValues(c){return await this.fetchLabelValues(c)}async fetchLabels(){const c="/api/v1/labels",F=this.datasource.getAdjustedInterval();this.labelFetchTs=Date.now().valueOf();const y=await this.request(c,[],F,this.getDefaultCacheHeaders());return Array.isArray(y)&&(this.labelKeys=y.slice().sort()),[]}async fetchSeriesValuesLRUCache(c,F,y,E){const O=`/api/v1/label/?${new URLSearchParams({"match[]":c??"",start:(0,x.s4)(parseInt(F.start,10)).toString(),end:(0,x.s4)(parseInt(F.end,10)).toString(),name:y}).toString()}/values`;let u=this.labelValuesCache.get(O);return u||(u=await this.request(`/api/v1/label/${c}/values`,[],E),u&&this.labelValuesCache.set(O,u)),u??[]}async fetchSeriesLabelsLRUCache(c,F,y,E,o){const u=`/api/v1/series?${new URLSearchParams({"match[]":c,start:(0,x.s4)(parseInt(F.start,10)).toString(),end:(0,x.s4)(parseInt(F.end,10)).toString(),withName:y?"true":"false"}).toString()}`;let $=this.labelsCache.get(u);if(!$){const A=await this.request(E,[],o),{values:R}=(0,x.DY)(A,y);$=R,this.labelsCache.set(u,$)}return $}async fetchSeriesLabelMatchLRUCache(c,F,y,E,o){const O=new URLSearchParams({"match[]":c,start:(0,x.s4)(parseInt(F.start,10)).toString(),end:(0,x.s4)(parseInt(F.end,10)).toString(),withName:y?"true":"false"}),u=`${E}?${O.toString()}`;let $=this.labelsCache.get(u);return $||($=(await this.request(E,[],o)).reduce((R,V)=>({...R,[V]:""}),{}),this.labelsCache.set(u,$)),$}}function D(Q,c){let F="";for(let y in c)if(typeof c[y]=="string"){F=c[y];break}return F}},51649:(ne,Y,_)=>{_.d(Y,{DY:()=>G,I4:()=>b,NO:()=>x,PL:()=>D,U9:()=>l,UO:()=>c,ZO:()=>n,e5:()=>Q,jj:()=>E,l3:()=>y,ll:()=>r,o8:()=>T,rV:()=>H,s4:()=>f,tU:()=>p,wY:()=>F});var v=_(82897),U=_.n(v),M=_(57706),s=_.n(M),i=_(62163),g=_(15128),h=_(21053),X=_(41564),C=_(36784),k=_(37462);const x=o=>{const O=new Set,u=new RegExp("_bucket($|:)");for(let $=0;$<o.length;$++){const A=o[$];u.test(A)&&O.add(A)}return[...O]};function G(o,O=!1){const u={};o.forEach(A=>{const{__name__:R,...V}=A;O&&(u.__name__=u.__name__||new Set,u.__name__.has(R)||u.__name__.add(R)),Object.keys(V).forEach(W=>{u[W]||(u[W]=new Set),u[W].has(V[W])||u[W].add(V[W])})});const $={};return t(Object.keys(u)).forEach(A=>{$[A]=t(Array.from(u[A]))}),{values:$,keys:Object.keys($)}}const B=/\{[^}]*?(\}|$)/,I=/\b(\w+)(!?=~?)("[^"\n]*?")/g;function H(o,O=1){if(!o.match(B)){if(o.match(/^[A-Za-z:][\w:]*$/))return{selector:`{__name__="${o}"}`,labelKeys:["__name__"]};throw new Error("Query must contain a selector: "+o)}const u=o.slice(0,O),$=u.lastIndexOf("{"),A=u.lastIndexOf("}");if($===-1)throw new Error("Not inside selector, missing open brace: "+u);if(A>-1&&A>$)throw new Error("Not inside selector, previous selector already closed: "+u);const R=o.slice(O),W=R.indexOf("}")+O,N=R.indexOf("{"),K=N+O;if(W===-1)throw new Error("Not inside selector, missing closing brace in suffix: "+R);if(N>-1&&K<W)throw new Error("Not inside selector, next selector opens before this one closed: "+R);const Z=o.slice($,W),ee={};Z.replace(I,(ce,ue,fe,ge)=>{const pe=o.indexOf(ce),_e=pe+ue.length+fe.length+1,$e=pe+ue.length+fe.length+ge.length-1;return(O<_e||O>$e)&&(ee[ue]={value:ge,operator:fe}),""});const oe=o.slice(0,$).match(/[A-Za-z:][\w:]*$/);oe&&(ee.__name__={value:`"${oe[0]}"`,operator:"="});const Oe=Object.keys(ee).sort(),le=["{",Oe.map(ce=>`${ce}${ee[ce].operator}${ee[ce].value}`).join(","),"}"].join("");return{labelKeys:Oe,selector:le}}function r(o,O){const u=Object.keys(O),$=new RegExp(`(\\s|^)(${u.join("|")})(\\s|$|\\(|\\[|\\{)`,"ig"),R=o.replace($,(N,K,Z,ee)=>`${K}${O[Z]}${ee}`).split(/(\+|\-|\*|\/|\%|\^)/),V=/(\)\{|\}\{|\]\{)/;return R.map(N=>a(N,V)).join("")}function a(o,O){const u=o.match(O);if(!u)return o;const $=u.index??0,A=o.slice(0,$+1),R=o.slice($+1),V=[];R.replace(I,(N,K,Z,ee)=>(V.push({key:K,operator:Z,value:ee}),""));let W=A;return V.filter(Boolean).forEach(N=>{const K=N.value.slice(1,-1);W=(0,X.F)(W,N.key,K,N.operator)}),W}function b(o){if(!o)return o;const O={},u={};for(const A in o){const R=o[A][0];O[A]=R,R.type==="histogram"&&(u[`${A}_bucket`]={type:"counter",help:`Cumulative counters for the observation buckets (${R.help})`},u[`${A}_count`]={type:"counter",help:`Count of events that have been observed for the histogram metric (${R.help})`},u[`${A}_sum`]={type:"counter",help:`Total sum of all observed values for the histogram metric (${R.help})`}),R.type==="summary"&&(u[`${A}_count`]={type:"counter",help:`Count of events that have been observed for the base metric (${R.help})`},u[`${A}_sum`]={type:"counter",help:`Total sum of all observed values for the base metric (${R.help})`})}const $={};return $.ALERTS={type:"counter",help:"Time series showing pending and firing alerts. The sample value is set to 1 as long as the alert is in the indicated active (pending or firing) state."},{...O,...u,...$}}function T(o){return f(o/1e3)}function f(o){return Math.floor(o/60)}function e(o,O=1){return Math.ceil(o/60)-Math.ceil(o/60)%O}function t(o){return o.slice(0,C.ZK)}function n(o){return o&&o.length>=C.ZK?`, limited to the first ${C.ZK} received items`:""}const d=/[*+?()|\\.\[\]{}^$]/g;function L(o){return o.replace(d,"\\$&")}function l(o){return o.replace(/\\/g,"\\\\").replace(/\n/g,"\\n").replace(/"/g,'\\"')}function p(o){return l(L(o))}const P={"=":i.K2.Equal,"!=":i.K2.NotEqual,"=~":i.K2.EqualRegEx,"!~":i.K2.NotEqualRegEx},S=(0,v.invert)(P);function D(o){const O=o.labelMatchers.map(u=>{const $=S[u.operator];return $?`${u.name}${$}"${u.value}"`:""}).filter(u=>u!=="").join(", ");return O?`{${O}}`:""}function Q(o){return{refId:o.refId,expr:D(o),range:!0}}function c(o){const O=[];for(let u in o)if(o[u]instanceof M.Token){let $=o[u];if($.type==="context-labels"){let A="",R="",V="",W=$.content;for(let N in W)if(typeof W[N]=="string"){let K;K=W[N],(K==="="||K==="!="||K==="=~"||K==="!~")&&(V=K)}else if(W[N]instanceof M.Token)switch(W[N].type){case"label-key":A=W[N].content;break;case"label-value":R=W[N].content,R=R.substring(1,R.length-1);const K=P[V];K&&O.push({name:A,operator:K,value:R});break}}}return O}function F(o,O){if(o===k.x3.None)return{start:E(O.from,!1).toString(),end:E(O.to,!0).toString()};const u=E(O.from,!1),$=(0,g.mB)(u,y(o)*60),A=E(O.to,!0),R=e(A,y(o))*60;if($===R){const N=R+y(o)*60;return{start:$.toString(),end:N.toString()}}const V=$.toString(),W=R.toString();return{start:V,end:W}}function y(o){switch(o){case k.x3.Medium:return 10;case k.x3.High:return 60;default:return 1}}function E(o,O){return typeof o=="string"&&(o=h.parse(o,O)),Math.ceil(o.valueOf()/1e3)}},4252:(ne,Y,_)=>{_.d(Y,{K:()=>T,Z:()=>f});var v=_(21899),U=_(12530),M=_(31075),s=_(8373),i=_(62513);function g(){return[{id:i.G3.HistogramQuantile,name:"Histogram quantile",params:[{name:"Quantile",type:"number",options:[.99,.95,.9,.75,.5,.25]}],defaultParams:[.9],category:i.CM.Functions,renderer:s.pS,addOperationHandler:s.PP},{id:i.G3.LabelReplace,name:"Label replace",params:[{name:"Destination label",type:"string"},{name:"Replacement",type:"string"},{name:"Source label",type:"string"},{name:"Regex",type:"string"}],category:i.CM.Functions,defaultParams:["","$1","","(.*)"],renderer:s.zJ,addOperationHandler:s.PP},{id:i.G3.Ln,name:"Ln",params:[],defaultParams:[],category:i.CM.Functions,renderer:s.pS,addOperationHandler:s.PP},X(i.G3.Changes),X(i.G3.Rate,!0),X(i.G3.Irate),X(i.G3.Increase,!0),X(i.G3.Idelta),X(i.G3.Delta),h({id:i.G3.HoltWinters,params:[(0,s.kq)(),{name:"Smoothing Factor",type:"number"},{name:"Trend Factor",type:"number"}],defaultParams:["$__interval",.5,.5],alternativesKey:"range function",category:i.CM.RangeFunctions,renderer:s.e8,addOperationHandler:x,changeTypeHandler:C}),h({id:i.G3.PredictLinear,params:[(0,s.kq)(),{name:"Seconds from now",type:"number"}],defaultParams:["$__interval",60],alternativesKey:"range function",category:i.CM.RangeFunctions,renderer:s.e8,addOperationHandler:x,changeTypeHandler:C}),h({id:i.G3.QuantileOverTime,params:[(0,s.kq)(),{name:"Quantile",type:"number"}],defaultParams:["$__interval",.5],alternativesKey:"overtime function",category:i.CM.RangeFunctions,renderer:s.NZ,addOperationHandler:x,changeTypeHandler:C}),...U.EX,{id:i.G3.NestedQuery,name:"Binary operation with query",params:[],defaultParams:[],category:i.CM.BinaryOps,renderer:(t,n,d)=>d,addOperationHandler:G},h({id:i.G3.Abs}),h({id:i.G3.Absent}),h({id:i.G3.Acos,category:i.CM.Trigonometric}),h({id:i.G3.Acosh,category:i.CM.Trigonometric}),h({id:i.G3.Asin,category:i.CM.Trigonometric}),h({id:i.G3.Asinh,category:i.CM.Trigonometric}),h({id:i.G3.Atan,category:i.CM.Trigonometric}),h({id:i.G3.Atanh,category:i.CM.Trigonometric}),h({id:i.G3.Ceil}),h({id:i.G3.Clamp,name:"Clamp",params:[{name:"Minimum Scalar",type:"number"},{name:"Maximum Scalar",type:"number"}],defaultParams:[1,1]}),h({id:i.G3.ClampMax,params:[{name:"Maximum Scalar",type:"number"}],defaultParams:[1]}),h({id:i.G3.ClampMin,params:[{name:"Minimum Scalar",type:"number"}],defaultParams:[1]}),h({id:i.G3.Cos,category:i.CM.Trigonometric}),h({id:i.G3.Cosh,category:i.CM.Trigonometric}),h({id:i.G3.DayOfMonth,category:i.CM.Time}),h({id:i.G3.DayOfWeek,category:i.CM.Time}),h({id:i.G3.DaysInMonth,category:i.CM.Time}),h({id:i.G3.Deg}),X(i.G3.Deriv),h({id:i.G3.Exp}),h({id:i.G3.Floor}),h({id:i.G3.Group}),h({id:i.G3.Hour}),h({id:i.G3.LabelJoin,params:[{name:"Destination Label",type:"string",editor:M.g},{name:"Separator",type:"string"},{name:"Source Label",type:"string",restParam:!0,optional:!0,editor:M.g}],defaultParams:["",",",""],renderer:B,addOperationHandler:I}),h({id:i.G3.Log10}),h({id:i.G3.Log2}),h({id:i.G3.Minute}),h({id:i.G3.Month}),h({id:i.G3.Pi,renderer:t=>`${t.id}()`}),h({id:i.G3.Quantile,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:s.pS}),h({id:i.G3.Rad}),X(i.G3.Resets),h({id:i.G3.Round,category:i.CM.Functions,params:[{name:"To Nearest",type:"number"}],defaultParams:[1]}),h({id:i.G3.Scalar}),h({id:i.G3.Sgn}),h({id:i.G3.Sin,category:i.CM.Trigonometric}),h({id:i.G3.Sinh,category:i.CM.Trigonometric}),h({id:i.G3.Sort}),h({id:i.G3.SortDesc}),h({id:i.G3.Sqrt}),h({id:i.G3.Stddev}),h({id:i.G3.Tan,category:i.CM.Trigonometric}),h({id:i.G3.Tanh,category:i.CM.Trigonometric}),h({id:i.G3.Time,renderer:t=>`${t.id}()`}),h({id:i.G3.Timestamp}),h({id:i.G3.Vector,params:[{name:"Value",type:"number"}],defaultParams:[1],renderer:t=>`${t.id}(${t.params[0]})`}),h({id:i.G3.Year})]}function h(e){return{...e,id:e.id,name:e.name??(0,s.t7)(e.id),params:e.params??[],defaultParams:e.defaultParams??[],category:e.category??i.CM.Functions,renderer:e.renderer??(e.params?s.zJ:s.pS),addOperationHandler:e.addOperationHandler??s.PP}}function X(e,t=!1){return{id:e,name:(0,s.t7)(e),params:[(0,s.kq)(t)],defaultParams:[t?"$__rate_interval":"$__interval"],alternativesKey:"range function",category:i.CM.RangeFunctions,renderer:k,addOperationHandler:x,changeTypeHandler:C}}function C(e,t){return(e.params[0]==="$__rate_interval"&&t.defaultParams[0]!=="$__rate_interval"||e.params[0]==="$__interval"&&t.defaultParams[0]!=="$__interval")&&(e.params=t.defaultParams),e}function k(e,t,n){let d=(e.params??[])[0]??"5m";return`${t.id}(${n}[${d}])`}function x(e,t,n){const d={id:e.id,params:e.defaultParams};return t.operations.length>0&&n.getOperationDef(t.operations[0].id).addOperationHandler===x?{...t,operations:[d,...t.operations.slice(1)]}:{...t,operations:[d,...t.operations]}}function G(e,t){return{...t,binaryQueries:[...t.binaryQueries??[],{operator:"/",query:t}]}}function B(e,t,n){if(typeof e.params[1]!="string")throw"The separator must be a string";const d=`"${e.params[1]}"`;return`${e.id}(${n}, "${e.params[0]}", ${d}, "${e.params.slice(2).join(d)}")`}function I(e,t){const n={id:e.id,params:e.defaultParams};return{...t,operations:[...t.operations,n]}}function H(){return[...(0,s.IT)(i.G3.Sum),...(0,s.IT)(i.G3.Avg),...(0,s.IT)(i.G3.Min),...(0,s.IT)(i.G3.Max),...(0,s.IT)(i.G3.Count),...(0,s.Z3)(i.G3.TopK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,s.Z3)(i.G3.BottomK,{params:[{name:"K-value",type:"number"}],defaultParams:[5]}),...(0,s.Z3)(i.G3.CountValues,{params:[{name:"Identifier",type:"string"}],defaultParams:["count"]}),r(i.G3.SumOverTime),r(i.G3.AvgOverTime),r(i.G3.MinOverTime),r(i.G3.MaxOverTime),r(i.G3.CountOverTime),r(i.G3.LastOverTime),r(i.G3.PresentOverTime),r(i.G3.AbsentOverTime),r(i.G3.StddevOverTime)]}function r(e){return{id:e,name:(0,s.t7)(e),params:[(0,s.kq)()],defaultParams:["$__interval"],alternativesKey:"overtime function",category:i.CM.RangeFunctions,renderer:a,addOperationHandler:x}}function a(e,t,n){let d=(e.params??[])[0]??"$__interval";return`${t.id}(${n}[${d}])`}var b=_(78625);class T extends b.x{constructor(){super(()=>{const t=[...g(),...H()];for(const n of t){const d=v.r8.find(L=>L.insertText===n.id);d&&(n.documentation=d.documentation)}return t}),this.setOperationCategories([i.CM.Aggregations,i.CM.RangeFunctions,i.CM.Functions,i.CM.BinaryOps,i.CM.Trigonometric,i.CM.Time])}getQueryPatterns(){return[{name:"Rate then sum",type:i.Fz.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]},{name:"Rate then sum by(label) then avg",type:i.Fz.Rate,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:[""]},{id:"avg",params:[]}]},{name:"Histogram quantile on rate",type:i.Fz.Histogram,operations:[{id:"rate",params:["$__rate_interval"]},{id:"__sum_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Histogram quantile on increase",type:i.Fz.Histogram,operations:[{id:"increase",params:["$__rate_interval"]},{id:"__max_by",params:["le"]},{id:"histogram_quantile",params:[.95]}]},{name:"Binary Query",type:i.Fz.Binary,operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}],binaryQueries:[{operator:"/",query:{metric:"",labels:[],operations:[{id:"rate",params:["$__rate_interval"]},{id:"sum",params:[]}]}}]}]}}const f=new T},12530:(ne,Y,_)=>{_.d(Y,{EX:()=>i,PX:()=>s,iQ:()=>M});var v=_(8373),U=_(62513);const M=[{id:U.G3.Addition,name:"Add scalar",sign:"+"},{id:U.G3.Subtraction,name:"Subtract scalar",sign:"-"},{id:U.G3.MultiplyBy,name:"Multiply by scalar",sign:"*"},{id:U.G3.DivideBy,name:"Divide by scalar",sign:"/"},{id:U.G3.Modulo,name:"Modulo by scalar",sign:"%"},{id:U.G3.Exponent,name:"Exponent",sign:"^"},{id:U.G3.EqualTo,name:"Equal to",sign:"==",comparison:!0},{id:U.G3.NotEqualTo,name:"Not equal to",sign:"!=",comparison:!0},{id:U.G3.GreaterThan,name:"Greater than",sign:">",comparison:!0},{id:U.G3.LessThan,name:"Less than",sign:"<",comparison:!0},{id:U.G3.GreaterOrEqual,name:"Greater or equal to",sign:">=",comparison:!0},{id:U.G3.LessOrEqual,name:"Less or equal to",sign:"<=",comparison:!0}],s=M.reduce((h,X)=>(h[X.sign]={id:X.id,comparison:X.comparison},h),{}),i=M.map(h=>{const X=[{name:"Value",type:"number"}],C=[2];return h.comparison&&(X.push({name:"Bool",type:"boolean",description:"If checked comparison will return 0 or 1 for the value rather than filtering."}),C.push(!1)),{id:h.id,name:h.name,params:X,defaultParams:C,alternativesKey:"binary scalar operations",category:U.CM.BinaryOps,renderer:g(h.sign),addOperationHandler:v.PP}});function g(h){return function(C,k,x){let G=C.params[0],B="";return C.params.length===2&&(B=C.params[1]?" bool":""),`${x} ${h}${B} ${G}`}}},31075:(ne,Y,_)=>{_.d(Y,{g:()=>g});var v=_(68404),U=_(63134),M=_(53217),s=_(4252),i=_(8373);function g({onChange:X,index:C,operationIndex:k,value:x,query:G,datasource:B}){const[I,H]=(0,v.useState)({});return v.createElement(M.Ph,{inputId:(0,i.i1)(k,C),autoFocus:x===""?!0:void 0,openMenuOnFocus:!0,onOpenMenu:async()=>{H({isLoading:!0});const r=await h(G,B);H({options:r,isLoading:void 0})},isLoading:I.isLoading,allowCustomValue:!0,noOptionsMessage:"No labels found",loadingMessage:"Loading labels",options:I.options,value:(0,U.E)(x),onChange:r=>X(C,r.value)})}async function h(X,C){let k=X.labels;C.type==="prometheus"&&(k=[{label:"__name__",op:"=",value:X.metric},...X.labels]);const x=s.Z.renderLabels(k),G=await C.languageProvider.fetchSeriesLabels(x);return Object.keys(G).map(B=>({label:B,value:B}))}},80522:(ne,Y,_)=>{_.d(Y,{_:()=>s});var v=_(30252),U=_(12530),M=_(44812);function s(r){const a=(0,M.bU)(r),T=v.E2.parse(a).topNode,e={query:{metric:"",labels:[],operations:[]},errors:[]};try{g(a,T,e)}catch(t){console.error(t),t instanceof Error&&e.errors.push({text:t.message})}return H(e.query)&&(e.errors=[]),i(r)&&(e.errors=[]),e}function i(r){const a={query:{metric:"",labels:[],operations:[]},errors:[]};r=r.replace(/\$__interval/g,"1s"),r=r.replace(/\$__interval_ms/g,"1000"),r=r.replace(/\$__rate_interval/g,"1s"),r=r.replace(/\$__range_ms/g,"1000"),r=r.replace(/\$__range_s/g,"1"),r=r.replace(/\$__range/g,"1s");const T=v.E2.parse(r).topNode;try{g(r,T,a)}catch{return!1}return a.errors.length===0}function g(r,a,b){const T=b.query;switch(a.type.id){case v.tz:{T.metric=(0,M.KF)(r,a);break}case v.Zm:{T.labels.push(X(r,a));const f=a.getChild(M._A);f&&b.errors.push((0,M.wf)(r,f));break}case v.lX:{k(r,a,b);break}case v.aZ:{x(r,a,b);break}case v.vU:{B(r,a,b);break}case M._A:{if(h(a))break;b.errors.push((0,M.wf)(r,a));break}default:{a.type.id===v.Om&&b.errors.push((0,M.wf)(r,a));let f=a.firstChild;for(;f;)g(r,f,b),f=f.nextSibling}}}function h(r){return r.prevSibling?.type.id===v.wi&&r.prevSibling?.firstChild?.type.id===v.m6}function X(r,a){const b=(0,M.KF)(r,a.getChild(v.m0)),T=(0,M.KF)(r,a.getChild(v.e8)),f=(0,M.KF)(r,a.getChild(v.nv)).replace(/"/g,"");return{label:b,op:T,value:f}}const C=["changes","rate","irate","increase","delta"];function k(r,a,b){const T=b.query,f=a.getChild(v.hT),e=(0,M.KF)(r,f),n=a.getChild(v.yY).getChild(v.mW),d=[];let L="";if(C.includes(e)||e.endsWith("_over_time")){let p=(0,M.KF)(r,a).match(/\[(.+)\]/);p?.[1]&&(L=p[1],d.push(p[1]))}const l={id:e,params:d};if(T.operations.unshift(l),n){if((0,M.KF)(r,n)===L+"]")return;G(r,n,b,l)}}function x(r,a,b){const T=b.query,f=a.getChild(v.Ki);let e=(0,M.KF)(r,f);const t=a.getChild(v.Ip),n=[];t&&(t.getChild("By")&&e&&(e=`__${e}_by`),t.getChild(v.yN)&&(e=`__${e}_without`),n.push(...(0,M.ff)(r,t,v.Tm)));const L=a.getChild(v.yY).getChild(v.mW),l={id:e,params:[]};T.operations.unshift(l),G(r,L,b,l),l.params.push(...n)}function G(r,a,b,T){if(a)switch(a.type.id){case v.wi:case v.mW:{let f=a.firstChild;for(;f;)G(r,f,b,T),f=f.nextSibling;break}case v.iy:{T.params.push(parseFloat((0,M.KF)(r,a)));break}case v.nv:{T.params.push((0,M.KF)(r,a).replace(/"/g,""));break}default:g(r,a,b)}}function B(r,a,b){const T=b.query,f=a.firstChild,e=(0,M.KF)(r,f.nextSibling),t=I(r,a.getChild(v.v3)),n=a.lastChild,d=U.PX[e],L=f.getChild(v.iy),l=n.getChild(v.iy),p=n.getChild(v.vU);if(L||g(r,f,b),l)T.operations.push((0,M.Es)(d,r,n,!!t?.isBool));else if(p){const P=(0,M.ge)(n);P?.type.id===v.iy&&T.operations.push((0,M.Es)(d,r,P,!!t?.isBool)),g(r,n,b)}else{T.binaryQueries=T.binaryQueries||[];const P={operator:e,query:{metric:"",labels:[],operations:[]}};t?.isMatcher&&(P.vectorMatchesType=t.matchType,P.vectorMatches=t.matches),T.binaryQueries.push(P),g(r,n,{query:P.query,errors:b.errors})}}function I(r,a){if(a){if(a.getChild("Bool"))return{isBool:!0,isMatcher:!1};{const b=a.getChild(v.Wc);return b?{isMatcher:!0,isBool:!1,matches:(0,M.KF)(r,b.getChild(v.XT)?.getChild(v.pQ)),matchType:b.getChild(v.On)?"on":"ignoring"}:void 0}}}function H(r){return r.labels.length===0&&r.operations.length===0&&!r.metric}},78625:(ne,Y,_)=>{_.d(Y,{x:()=>M});var v=_(64140),U=_(62513);class M{constructor(i){this.categories=[],this.operationsRegistry=new v.B(i)}setOperationCategories(i){this.categories=i}getOperationsForCategory(i){return this.operationsRegistry.list().filter(g=>g.category===i&&!g.hideFromList)}getAlternativeOperations(i){return this.operationsRegistry.list().filter(g=>g.alternativesKey&&g.alternativesKey===i)}getCategories(){return this.categories}getOperationDef(i){return this.operationsRegistry.getIfExists(i)}renderOperations(i,g){for(const h of g){const X=this.operationsRegistry.getIfExists(h.id);if(!X)throw new Error(`Could not find operation ${h.id} in the registry`);i=X.renderer(h,X,i)}return i}renderBinaryQueries(i,g){if(g)for(const h of g)i=`${this.renderBinaryQuery(i,h)}`;return i}renderBinaryQuery(i,g){let h=i+` ${g.operator} `;return g.vectorMatches&&(h+=`${g.vectorMatchesType}(${g.vectorMatches}) `),h+this.renderQuery(g.query,!0)}renderLabels(i){if(i.length===0)return"";let g="{";for(const h of i)g!=="{"&&(g+=", "),g+=`${h.label}${h.op}"${h.value}"`;return g+"}"}renderQuery(i,g){let h=`${i.metric??""}${this.renderLabels(i.labels)}`;return h=this.renderOperations(h,i.operations),!g&&this.hasBinaryOp(i)&&Boolean(i.binaryQueries?.length)&&(h=`(${h})`),h=this.renderBinaryQueries(h,i.binaryQueries),g&&(this.hasBinaryOp(i)||Boolean(i.binaryQueries?.length))&&(h=`(${h})`),h}hasBinaryOp(i){return i.operations.find(g=>this.getOperationDef(g.id)?.category===U.CM.BinaryOps)!==void 0}}},8373:(ne,Y,_)=>{_.d(Y,{IT:()=>a,NZ:()=>x,PP:()=>B,Sp:()=>e,Z3:()=>b,ZI:()=>d,Zc:()=>L,e8:()=>k,i1:()=>H,j8:()=>n,kq:()=>r,pS:()=>h,t7:()=>I,zJ:()=>X});var v=_(82897),U=_.n(v),M=_(64681),s=_.n(M),i=_(31075),g=_(62513);function h(l,p,P){const S=G(l,p,P),D=l.id+"(";return P&&S.push(P),D+S.join(", ")+")"}function X(l,p,P){const S=G(l,p,P),D=l.id+"(";return P&&S.unshift(P),D+S.join(", ")+")"}function C(l,p,P,S){if(p.params.length<2)throw`Cannot render a function with params of length [${p.params.length}]`;let D=(l.params??[])[0]??"5m";const Q=G({...l,params:l.params.slice(1)},{...p,params:p.params.slice(1),defaultParams:p.defaultParams.slice(1)},P),c=l.id+"(";return P&&(S?Q.push(`${P}[${D}]`):Q.unshift(`${P}[${D}]`)),c+Q.join(", ")+")"}function k(l,p,P){return C(l,p,P,!1)}function x(l,p,P){return C(l,p,P,!0)}function G(l,p,P){return(l.params??[]).map((S,D)=>p.params[D].type==="string"?'"'+S+'"':S)}function B(l,p){const P={id:l.id,params:l.defaultParams};return{...p,operations:[...p.operations,P]}}function I(l){return(0,v.capitalize)(l.replace(/_/g," "))}function H(l,p){return`operations.${l}.param.${p}`}function r(l=!1){const p={name:"Range",type:"string",options:[{label:"$__interval",value:"$__interval"},{label:"1m",value:"1m"},{label:"5m",value:"5m"},{label:"10m",value:"10m"},{label:"1h",value:"1h"},{label:"24h",value:"24h"}]};return l&&p.options.unshift({label:"$__rate_interval",value:"$__rate_interval"}),p}function a(l,p={}){return[{id:l,name:I(l),params:[{name:"By label",type:"string",restParam:!0,optional:!0}],defaultParams:[],alternativesKey:"plain aggregations",category:g.CM.Aggregations,renderer:h,paramChangedHandler:d(`__${l}_by`),explainHandler:e(l,""),addOperationHandler:B,...p},{id:`__${l}_by`,name:`${I(l)} by`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.g}],defaultParams:[""],alternativesKey:"aggregations by",category:g.CM.Aggregations,renderer:T(l),paramChangedHandler:n(l),explainHandler:e(l,"by"),addOperationHandler:B,hideFromList:!0,...p},{id:`__${l}_without`,name:`${I(l)} without`,params:[{name:"Label",type:"string",restParam:!0,optional:!0,editor:i.g}],defaultParams:[""],alternativesKey:"aggregations by",category:g.CM.Aggregations,renderer:f(l),paramChangedHandler:n(l),explainHandler:e(l,"without"),addOperationHandler:B,hideFromList:!0,...p}]}function b(l,p,P={}){const S=a(l,P);return S[0].params.unshift(...p.params),S[1].params.unshift(...p.params),S[2].params.unshift(...p.params),S[0].defaultParams=p.defaultParams,S[1].defaultParams=[...p.defaultParams,""],S[2].defaultParams=[...p.defaultParams,""],S[1].renderer=t(l),S[2].renderer=t(l),S}function T(l){return function(P,S,D){return`${l} by(${P.params.join(", ")}) (${D})`}}function f(l){return function(P,S,D){return`${l} without(${P.params.join(", ")}) (${D})`}}function e(l,p){return function(S){const D=S.params.map(c=>`\`${c}\``).join(" and "),Q=s()("label",S.params.length);switch(p){case"by":return`Calculates ${l} over dimensions while preserving ${Q} ${D}.`;case"without":return`Calculates ${l} over the dimensions ${D}. All other labels are preserved.`;default:return`Calculates ${l} over the dimensions.`}}}function t(l){return function(P,S,D){const Q=S.params.findIndex(y=>y.restParam),c=P.params.slice(0,Q),F=P.params.slice(Q);return`${l} by(${F.join(", ")}) (${c.map((y,E)=>S.params[E].type==="string"?`"${y}"`:y).join(", ")}, ${D})`}}function n(l){return function(P,S,D){return S.params.length<D.params.length?{...S,id:l}:S}}function d(l){return function(P,S,D){return S.params.length===D.params.length?{...S,id:l}:S}}function L(l,p){if(!l.label||!l.op||!l.value||p.length<2)return!1;const P=l.op.toString().startsWith("!");return p.filter(Q=>Q.label===l.label&&Q.value===l.value&&Q.op!==l.op).some(Q=>!!(P&&Q?.op?.toString().startsWith("!")===!1||P===!1&&Q?.op?.toString().startsWith("!")))}},44812:(ne,Y,_)=>{_.d(Y,{Es:()=>C,KF:()=>X,Tt:()=>h,Vl:()=>H,_A:()=>v,bU:()=>i,ff:()=>k,ge:()=>U,wf:()=>M});const v=0;function U(r){return r.firstChild?U(r.firstChild):r}function M(r,a){return{text:X(r,a),from:a.from,to:a.to,parentType:a.parent?.name}}const s=/\$(\w+)|\[\[([\s\S]+?)(?::(\w+))?\]\]|\${(\w+)(?:\.([^:^\}]+))?(?::([^\}]+))?}/g;function i(r){return r.replace(s,(a,b,T,f,e,t,n)=>{const d=f||n;let L=b,l="0";return T&&(L=T,l="1"),e&&(L=e,l="2"),`__V_${l}__`+L+"__V__"+(d?"__F__"+d+"__F__":"")})}const g=[(r,a)=>`$${r}`,(r,a)=>`[[${r}${a?`:${a}`:""}]]`,(r,a)=>`\${${r}${a?`:${a}`:""}}`];function h(r){return r.replace(/__V_(\d)__(.+?)__V__(?:__F__(\w+)__F__)?/g,(a,b,T,f)=>g[parseInt(b,10)](T,f))}function X(r,a){return a?h(r.substring(a.from,a.to)):""}function C(r,a,b,T){const f=[parseFloat(X(a,b))];return r.comparison&&f.push(T),{id:r.id,params:f}}function k(r,a,b){if(a.type.id===b||a.name===b)return[X(r,a)];const T=[];let f=0,e=a.childAfter(f);for(;e;)T.push(...k(r,e,b)),f=e.to,e=a.childAfter(f);return T}function x(r,a){if(!a){console.log("<empty>");return}const b=G(r,a),T=B(b);if(!T){console.log("<empty>");return}console.log(T)}function G(r,a){const b={},T=I(r,a),f=[];let e=0,t=a.childAfter(e);for(;t;)f.push(G(r,t)),e=t.to,t=a.childAfter(e);return b.name=T,b.children=f,b}function B(r,a={lastChild:!0,indent:""}){const b=r.name,{lastChild:T,indent:f}=a;let t=(f!==""?f+(T?"\u2514\u2500":"\u251C\u2500"):"")+b;const n=r.children;return n.forEach((d,L)=>{const l=L===n.length-1;t+=`
`+B(d,{lastChild:l,indent:f+(T?"  ":"\u2502 ")})}),t}function I(r,a){return a.name+": "+X(r,a)}const H=r=>r.split(" ").map(b=>`${b}.*`).join("")},62513:(ne,Y,_)=>{_.d(Y,{CM:()=>v,Fz:()=>M,G3:()=>U});var v=(s=>(s.Aggregations="Aggregations",s.RangeFunctions="Range functions",s.Functions="Functions",s.BinaryOps="Binary operations",s.Trigonometric="Trigonometric",s.Time="Time Functions",s))(v||{}),U=(s=>(s.Abs="abs",s.Absent="absent",s.AbsentOverTime="absent_over_time",s.Acos="acos",s.Acosh="acosh",s.Asin="asin",s.Asinh="asinh",s.Atan="atan",s.Atanh="atanh",s.Avg="avg",s.AvgOverTime="avg_over_time",s.BottomK="bottomk",s.Ceil="ceil",s.Changes="changes",s.Clamp="clamp",s.ClampMax="clamp_max",s.ClampMin="clamp_min",s.Cos="cos",s.Cosh="cosh",s.Count="count",s.CountOverTime="count_over_time",s.CountScalar="count_scalar",s.CountValues="count_values",s.DayOfMonth="day_of_month",s.DayOfWeek="day_of_week",s.DaysInMonth="days_in_month",s.Deg="deg",s.Delta="delta",s.Deriv="deriv",s.DropCommonLabels="drop_common_labels",s.Exp="exp",s.Floor="floor",s.Group="group",s.HistogramQuantile="histogram_quantile",s.HoltWinters="holt_winters",s.Hour="hour",s.Idelta="idelta",s.Increase="increase",s.Irate="irate",s.LabelJoin="label_join",s.LabelReplace="label_replace",s.Last="last",s.LastOverTime="last_over_time",s.Ln="ln",s.Log10="log10",s.Log2="log2",s.Max="max",s.MaxOverTime="max_over_time",s.Min="min",s.MinOverTime="min_over_time",s.Minute="minute",s.Month="month",s.Pi="pi",s.PredictLinear="predict_linear",s.Present="present",s.PresentOverTime="present_over_time",s.Quantile="quantile",s.QuantileOverTime="quantile_over_time",s.Rad="rad",s.Rate="rate",s.Resets="resets",s.Round="round",s.Scalar="scalar",s.Sgn="sgn",s.Sin="sin",s.Sinh="sinh",s.Sort="sort",s.SortDesc="sort_desc",s.Sqrt="sqrt",s.Stddev="stddev",s.StddevOverTime="stddev_over_time",s.Sum="sum",s.SumOverTime="sum_over_time",s.Tan="tan",s.Tanh="tanh",s.Time="time",s.Timestamp="timestamp",s.TopK="topk",s.Vector="vector",s.Year="year",s.Addition="__addition",s.Subtraction="__subtraction",s.MultiplyBy="__multiply_by",s.DivideBy="__divide_by",s.Modulo="__modulo",s.Exponent="__exponent",s.NestedQuery="__nested_query",s.EqualTo="__equal_to",s.NotEqualTo="__not_equal_to",s.GreaterThan="__greater_than",s.LessThan="__less_than",s.GreaterOrEqual="__greater_or_equal",s.LessOrEqual="__less_or_equal",s))(U||{}),M=(s=>(s.Rate="rate",s.Histogram="histogram",s.Binary="binary",s))(M||{})},37462:(ne,Y,_)=>{_.d(Y,{WS:()=>M,el:()=>U,jo:()=>i,pD:()=>s,x3:()=>v});var v=(g=>(g.Low="Low",g.Medium="Medium",g.High="High",g.None="None",g))(v||{});function U(g){return"values"in g}function M(g){return g==null||!Array.isArray(g)?!1:g.length?"exemplars"in g[0]:!1}var s=(g=>(g.Auto="__auto",g.Verbose="__verbose",g.Custom="__custom",g))(s||{}),i=(g=>(g[g.LabelNames=0]="LabelNames",g[g.LabelValues=1]="LabelValues",g[g.MetricNames=2]="MetricNames",g[g.VarQueryResult=3]="VarQueryResult",g[g.SeriesQuery=4]="SeriesQuery",g))(i||{})},30252:(ne,Y,_)=>{_.d(Y,{aZ:()=>Be,Ip:()=>Ie,Ki:()=>Ue,v3:()=>Ze,vU:()=>He,f0:()=>gt,M5:()=>ft,wi:()=>We,lX:()=>tt,mW:()=>Ye,yY:()=>je,hT:()=>at,Tm:()=>Ve,pQ:()=>Ne,XT:()=>qe,xb:()=>it,z5:()=>ut,Zm:()=>dt,m$:()=>ht,m0:()=>Ke,e8:()=>Ot,uM:()=>st,tz:()=>ct,IJ:()=>et,JW:()=>yt,iy:()=>nt,On:()=>Fe,Wc:()=>Je,Om:()=>rt,vD:()=>ze,nv:()=>ot,m6:()=>lt,yN:()=>Ge,E2:()=>ke});var v=_(25181),U=_(99100);let M=0;class s{constructor(m,w,z){this.set=m,this.base=w,this.modified=z,this.id=M++}static define(m){if(m?.base)throw new Error("Can not derive from a modified tag");let w=new s([],null,[]);if(w.set.push(w),m)for(let z of m.set)w.set.push(z);return w}static defineModifier(){let m=new g;return w=>w.modified.indexOf(m)>-1?w:g.get(w.base||w,w.modified.concat(m).sort((z,q)=>z.id-q.id))}}let i=0;class g{constructor(){this.instances=[],this.id=i++}static get(m,w){if(!w.length)return m;let z=w[0].instances.find(te=>te.base==m&&h(w,te.modified));if(z)return z;let q=[],J=new s(q,m,w);for(let te of w)te.instances.push(J);let ae=X(w);for(let te of m.set)if(!te.modified.length)for(let de of ae)q.push(g.get(te,de));return J}}function h(j,m){return j.length==m.length&&j.every((w,z)=>w==m[z])}function X(j){let m=[[]];for(let w=0;w<j.length;w++)for(let z=0,q=m.length;z<q;z++)m.push(m[z].concat(j[w]));return m.sort((w,z)=>z.length-w.length)}function C(j){let m=Object.create(null);for(let w in j){let z=j[w];Array.isArray(z)||(z=[z]);for(let q of w.split(" "))if(q){let J=[],ae=2,te=q;for(let he=0;;){if(te=="..."&&he>0&&he+3==q.length){ae=1;break}let re=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(te);if(!re)throw new RangeError("Invalid path: "+q);if(J.push(re[0]=="*"?"":re[0][0]=='"'?JSON.parse(re[0]):re[0]),he+=re[0].length,he==q.length)break;let ye=q[he++];if(he==q.length&&ye=="!"){ae=0;break}if(ye!="/")throw new RangeError("Invalid path: "+q);te=q.slice(he)}let de=J.length-1,ie=J[de];if(!ie)throw new RangeError("Invalid path: "+q);let ve=new x(z,ae,de>0?J.slice(0,de):null);m[ie]=ve.sort(m[ie])}}return k.add(m)}const k=new U.md;class x{constructor(m,w,z,q){this.tags=m,this.mode=w,this.context=z,this.next=q}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(m){return!m||m.depth<this.depth?(this.next=m,this):(m.next=this.sort(m.next),m)}get depth(){return this.context?this.context.length:0}}x.empty=new x([],2,null);function G(j,m){let w=Object.create(null);for(let J of j)if(!Array.isArray(J.tag))w[J.tag.id]=J.class;else for(let ae of J.tag)w[ae.id]=J.class;let{scope:z,all:q=null}=m||{};return{style:J=>{let ae=q;for(let te of J)for(let de of te.set){let ie=w[de.id];if(ie){ae=ae?ae+" "+ie:ie;break}}return ae},scope:z}}function B(j,m){let w=null;for(let z of j){let q=z.style(m);q&&(w=w?w+" "+q:q)}return w}function I(j,m,w,z=0,q=j.length){let J=new H(z,Array.isArray(m)?m:[m],w);J.highlightRange(j.cursor(),z,q,"",J.highlighters),J.flush(q)}class H{constructor(m,w,z){this.at=m,this.highlighters=w,this.span=z,this.class=""}startSpan(m,w){w!=this.class&&(this.flush(m),m>this.at&&(this.at=m),this.class=w)}flush(m){m>this.at&&this.class&&this.span(this.at,m,this.class)}highlightRange(m,w,z,q,J){let{type:ae,from:te,to:de}=m;if(te>=z||de<=w)return;ae.isTop&&(J=this.highlighters.filter(ye=>!ye.scope||ye.scope(ae)));let ie=q,ve=r(m)||x.empty,he=B(J,ve.tags);if(he&&(ie&&(ie+=" "),ie+=he,ve.mode==1&&(q+=(q?" ":"")+he)),this.startSpan(m.from,ie),ve.opaque)return;let re=m.tree&&m.tree.prop(NodeProp.mounted);if(re&&re.overlay){let ye=m.node.enter(re.overlay[0].from+te,1),mt=this.highlighters.filter(me=>!me.scope||me.scope(re.tree.type)),Te=m.firstChild();for(let me=0,be=te;;me++){let Pe=me<re.overlay.length?re.overlay[me]:null,Qe=Pe?Pe.from+te:de,xe=Math.max(w,be),Se=Math.min(z,Qe);if(xe<Se&&Te)for(;m.from<Se&&(this.highlightRange(m,xe,Se,q,J),this.startSpan(Math.min(Se,m.to),ie),!(m.to>=Qe||!m.nextSibling())););if(!Pe||Qe>z)break;be=Pe.to+te,be>w&&(this.highlightRange(ye.cursor(),Math.max(w,Pe.from+te),Math.min(z,be),q,mt),this.startSpan(be,ie))}Te&&m.parent()}else if(m.firstChild()){do if(!(m.to<=w)){if(m.from>=z)break;this.highlightRange(m,w,z,q,J),this.startSpan(Math.min(z,m.to),ie)}while(m.nextSibling());m.parent()}}}function r(j){let m=j.type.prop(k);for(;m&&m.context&&!j.matchContext(m.context);)m=m.next;return m||null}const a=s.define,b=a(),T=a(),f=a(T),e=a(T),t=a(),n=a(t),d=a(t),L=a(),l=a(L),p=a(),P=a(),S=a(),D=a(S),Q=a(),c={comment:b,lineComment:a(b),blockComment:a(b),docComment:a(b),name:T,variableName:a(T),typeName:f,tagName:a(f),propertyName:e,attributeName:a(e),className:a(T),labelName:a(T),namespace:a(T),macroName:a(T),literal:t,string:n,docString:a(n),character:a(n),attributeValue:a(n),number:d,integer:a(d),float:a(d),bool:a(t),regexp:a(t),escape:a(t),color:a(t),url:a(t),keyword:p,self:a(p),null:a(p),atom:a(p),unit:a(p),modifier:a(p),operatorKeyword:a(p),controlKeyword:a(p),definitionKeyword:a(p),moduleKeyword:a(p),operator:P,derefOperator:a(P),arithmeticOperator:a(P),logicOperator:a(P),bitwiseOperator:a(P),compareOperator:a(P),updateOperator:a(P),definitionOperator:a(P),typeOperator:a(P),controlOperator:a(P),punctuation:S,separator:a(S),bracket:D,angleBracket:a(D),squareBracket:a(D),paren:a(D),brace:a(D),content:L,heading:l,heading1:a(l),heading2:a(l),heading3:a(l),heading4:a(l),heading5:a(l),heading6:a(l),contentSeparator:a(L),list:a(L),quote:a(L),emphasis:a(L),strong:a(L),link:a(L),monospace:a(L),strikethrough:a(L),inserted:a(),deleted:a(),changed:a(),invalid:a(),meta:Q,documentMeta:a(Q),annotation:a(Q),processingInstruction:a(Q),definition:s.defineModifier(),constant:s.defineModifier(),function:s.defineModifier(),standard:s.defineModifier(),local:s.defineModifier(),special:s.defineModifier()},F=G([{tag:c.link,class:"tok-link"},{tag:c.heading,class:"tok-heading"},{tag:c.emphasis,class:"tok-emphasis"},{tag:c.strong,class:"tok-strong"},{tag:c.keyword,class:"tok-keyword"},{tag:c.atom,class:"tok-atom"},{tag:c.bool,class:"tok-bool"},{tag:c.url,class:"tok-url"},{tag:c.labelName,class:"tok-labelName"},{tag:c.inserted,class:"tok-inserted"},{tag:c.deleted,class:"tok-deleted"},{tag:c.literal,class:"tok-literal"},{tag:c.string,class:"tok-string"},{tag:c.number,class:"tok-number"},{tag:[c.regexp,c.escape,c.special(c.string)],class:"tok-string2"},{tag:c.variableName,class:"tok-variableName"},{tag:c.local(c.variableName),class:"tok-variableName tok-local"},{tag:c.definition(c.variableName),class:"tok-variableName tok-definition"},{tag:c.special(c.variableName),class:"tok-variableName2"},{tag:c.definition(c.propertyName),class:"tok-propertyName tok-definition"},{tag:c.typeName,class:"tok-typeName"},{tag:c.namespace,class:"tok-namespace"},{tag:c.className,class:"tok-className"},{tag:c.macroName,class:"tok-macroName"},{tag:c.propertyName,class:"tok-propertyName"},{tag:c.operator,class:"tok-operator"},{tag:c.comment,class:"tok-comment"},{tag:c.meta,class:"tok-meta"},{tag:c.invalid,class:"tok-invalid"},{tag:c.punctuation,class:"tok-punctuation"}]),y=147,E=148,o=1,O=2,u=3,$=4,A=5,R=6,V=7,W=8,N=9,K=10,Z=11,ee=12,se=13,oe=14,Oe=15,Ee=16,le=17,ce=18,ue=19,fe=20,ge=21,pe=22,_e=23,$e=24,Me=25,we=26,Ce={inf:y,nan:E,bool:o,ignoring:O,on:u,group_left:$,group_right:A,offset:R},Le=(j,m)=>Ce[j.toLowerCase()]||-1,Ae={avg:W,atan2:V,bottomk:N,count:K,count_values:Z,group:ee,max:se,min:oe,quantile:Oe,stddev:Ee,stdvar:le,sum:ce,topk:ue,by:fe,without:ge,and:pe,or:_e,unless:$e,start:Me,end:we},Re=(j,m)=>Ae[j.toLowerCase()]||-1,Xe=C({LineComment:c.comment,LabelName:c.labelName,StringLiteral:c.string,NumberLiteral:c.number,Duration:c.number,"Abs Absent AbsentOverTime Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Time Timestamp Vector Year":c.function(c.variableName),"Avg Bottomk Count Count_values Group Max Min Quantile Stddev Stdvar Sum Topk":c.operatorKeyword,"By Without Bool On Ignoring GroupLeft GroupRight Offset Start End":c.modifier,"And Unless Or":c.logicOperator,"Sub Add Mul Mod Div Atan2 Eql Neq Lte Lss Gte Gtr EqlRegex EqlSingle NeqRegex Pow At":c.operator,UnaryOp:c.arithmeticOperator,"( )":c.paren,"[ ]":c.squareBracket,"{ }":c.brace,"\u26A0":c.invalid}),De={__proto__:null,absent_over_time:309,absent:311,abs:313,acos:315,acosh:317,asin:319,asinh:321,atan:323,atanh:325,avg_over_time:327,ceil:329,changes:331,clamp:333,clamp_max:335,clamp_min:337,cos:339,cosh:341,count_over_time:343,days_in_month:345,day_of_month:347,day_of_week:349,day_of_year:351,deg:353,delta:355,deriv:357,exp:359,floor:361,histogram_quantile:363,holt_winters:365,hour:367,idelta:369,increase:371,irate:373,label_replace:375,label_join:377,last_over_time:379,ln:381,log10:383,log2:385,max_over_time:387,min_over_time:389,minute:391,month:393,pi:395,predict_linear:397,present_over_time:399,quantile_over_time:401,rad:403,rate:405,resets:407,round:409,scalar:411,sgn:413,sin:415,sinh:417,sort:419,sort_desc:421,sqrt:423,stddev_over_time:425,stdvar_over_time:427,sum_over_time:429,tan:431,tanh:433,timestamp:435,time:437,vector:439,year:441},ke=v.WQ.deserialize({version:14,states:"6bOYQPOOO'OQPOOOOQO'#C{'#C{O'TQPO'#CzQ'`QQOOOOQO'#De'#DeO'ZQPO'#DdOOQO'#FO'#FOO(mQPO'#FUOYQPO'#FQOYQPO'#FTOOQO'#FW'#FWO.lQSO'#FXO.tQQO'#FVOOQO'#FV'#FVOOQO'#Cy'#CyOOQO'#Df'#DfOOQO'#Dh'#DhOOQO'#Di'#DiOOQO'#Dj'#DjOOQO'#Dk'#DkOOQO'#Dl'#DlOOQO'#Dm'#DmOOQO'#Dn'#DnOOQO'#Do'#DoOOQO'#Dp'#DpOOQO'#Dq'#DqOOQO'#Dr'#DrOOQO'#Ds'#DsOOQO'#Dt'#DtOOQO'#Du'#DuOOQO'#Dv'#DvOOQO'#Dw'#DwOOQO'#Dx'#DxOOQO'#Dy'#DyOOQO'#Dz'#DzOOQO'#D{'#D{OOQO'#D|'#D|OOQO'#D}'#D}OOQO'#EO'#EOOOQO'#EP'#EPOOQO'#EQ'#EQOOQO'#ER'#EROOQO'#ES'#ESOOQO'#ET'#ETOOQO'#EU'#EUOOQO'#EV'#EVOOQO'#EW'#EWOOQO'#EX'#EXOOQO'#EY'#EYOOQO'#EZ'#EZOOQO'#E['#E[OOQO'#E]'#E]OOQO'#E^'#E^OOQO'#E_'#E_OOQO'#E`'#E`OOQO'#Ea'#EaOOQO'#Eb'#EbOOQO'#Ec'#EcOOQO'#Ed'#EdOOQO'#Ee'#EeOOQO'#Ef'#EfOOQO'#Eg'#EgOOQO'#Eh'#EhOOQO'#Ei'#EiOOQO'#Ej'#EjOOQO'#Ek'#EkOOQO'#El'#ElOOQO'#Em'#EmOOQO'#En'#EnOOQO'#Eo'#EoOOQO'#Ep'#EpOOQO'#Eq'#EqOOQO'#Er'#ErOOQO'#Es'#EsOOQO'#Et'#EtOOQO'#Eu'#EuOOQO'#Ev'#EvOOQO'#Ew'#EwOOQO'#Ex'#ExOOQO'#Ey'#EyOOQO'#Ez'#EzOOQO'#E{'#E{QOQPOOO0_QPO'#C|O0dQPO'#DRO'ZQPO,59fO0kQQO,59fO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO2XQPO,59oO8WQQO,5;hO8]QQO,5;kO8eQPO,5;zOOQO,5:O,5:OOOQO,5;j,5;jO8|QQO,5;lO9TQQO,5;oO:kQPO'#FZO:yQPO,5;sOOQO'#FY'#FYOOQO,5;s,5;sOOQO,5;q,5;qO;RQSO'#C}OOQO,59h,59hO;ZQPO,59mO;cQQO'#DSOOQO,59m,59mOOQO1G/Q1G/QO0_QPO'#DWOAcQPO'#DVOAmQPO'#DVOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOYQPO1G/ZOAwQSO1G1SOOQO1G1V1G1VOBPQQO1G1VOBUQPO'#FOOOQO'#Fb'#FbOOQO1G1f1G1fOBaQPO1G1fOOQO1G1W1G1WOOQO'#F['#F[OBfQPO,5;uOBkQSO1G1_OOQO1G1_1G1_OOQO'#DP'#DPOBsQPO,59iOOQO'#DO'#DOOOQO,59i,59iOYQPO,59nOOQO1G/X1G/XOOQO,59r,59rOHnQPO,59qOHuQPO,59qOJ^QQO7+$uOJnQQO7+$uOLSQQO7+$uOLjQQO7+$uONRQQO7+$uOOQO7+&n7+&nONlQQO7+&tOOQO7+&q7+&qONtQPO7+'QOOQO1G1a1G1aOOQO1G1`1G1`OOQO7+&y7+&yONyQSO1G/TOOQO1G/T1G/TO! RQQO1G/YOOQO1G/]1G/]O! ]QPO1G/]OOQO<<J`<<J`O!'RQPO<<J`OOQO<<Jl<<JlOOQO1G/U1G/UOOQO7+$o7+$oOOQO7+$w7+$wOOQOAN?zAN?z",stateData:"!'W~O$[OSkOS~OWQOXQOYQOZQO[QO]QO^QO_QO`QOaQObQOcQO!ZZO#u_O$XVO$YVO$]XO$``O$aaO$bbO$ccO$ddO$eeO$ffO$ggO$hhO$iiO$jjO$kkO$llO$mmO$nnO$ooO$ppO$qqO$rrO$ssO$ttO$uuO$vvO$wwO$xxO$yyO$zzO${{O$||O$}}O%O!OO%P!PO%Q!QO%R!RO%S!SO%T!TO%U!UO%V!VO%W!WO%X!XO%Y!YO%Z!ZO%[![O%]!]O%^!^O%_!_O%`!`O%a!aO%b!bO%c!cO%d!dO%e!eO%f!fO%g!gO%h!hO%i!iO%j!jO%k!kO%l!lO%m!mO%n!nO%o!oO%p!pO%q!qO%r!rO%s!sO%t!tO%wWO%xWO%yVO%{[O~O!ZZO~Od!vOe!vO$]!wO~OU#QOV!zOf!}Og#OOh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O$T#RO%u#PO~O$X#TO$Y#TO%y#TOW#xXX#xXY#xXZ#xX[#xX]#xX^#xX_#xX`#xXa#xXb#xXc#xX!Z#xX#u#xX$X#xX$Y#xX$]#xX$`#xX$a#xX$b#xX$c#xX$d#xX$e#xX$f#xX$g#xX$h#xX$i#xX$j#xX$k#xX$l#xX$m#xX$n#xX$o#xX$p#xX$q#xX$r#xX$s#xX$t#xX$u#xX$v#xX$w#xX$x#xX$y#xX$z#xX${#xX$|#xX$}#xX%O#xX%P#xX%Q#xX%R#xX%S#xX%T#xX%U#xX%V#xX%W#xX%X#xX%Y#xX%Z#xX%[#xX%]#xX%^#xX%_#xX%`#xX%a#xX%b#xX%c#xX%d#xX%e#xX%f#xX%g#xX%h#xX%i#xX%j#xX%k#xX%l#xX%m#xX%n#xX%o#xX%p#xX%q#xX%r#xX%s#xX%t#xX%w#xX%x#xX%y#xX%{#xX~Ot#WO%|#ZO~O%{[OU#yXV#yXf#yXg#yXh#yXx#yX{#yX|#yX}#yX!O#yX!P#yX!Q#yX!R#yX!S#yX!T#yX!U#yX!V#yX$T#yX$W#yX%u#yX$_#yX$^#yX~O$]#]O~O$_#aO~PYOd!vOe!vOUnaVnafnagnahnaxna{na|na}na!Ona!Pna!Qna!Rna!Sna!Tna!Una!Vna$Tna$Wna%una$_na$^na~OP#eOQ#cOR#cOWyPXyPYyPZyP[yP]yP^yP_yP`yPayPbyPcyP!ZyP#uyP$XyP$YyP$]yP$`yP$ayP$byP$cyP$dyP$eyP$fyP$gyP$hyP$iyP$jyP$kyP$lyP$myP$nyP$oyP$pyP$qyP$ryP$syP$tyP$uyP$vyP$wyP$xyP$yyP$zyP${yP$|yP$}yP%OyP%PyP%QyP%RyP%SyP%TyP%UyP%VyP%WyP%XyP%YyP%ZyP%[yP%]yP%^yP%_yP%`yP%ayP%byP%cyP%dyP%eyP%fyP%gyP%hyP%iyP%jyP%kyP%lyP%myP%nyP%oyP%pyP%qyP%ryP%syP%tyP%wyP%xyP%yyP%{yP~O#q#kO~O!P#mO#q#lO~Oi#oOj#oO$XVO$YVO%w#nO%x#nO%yVO~O$_#rO~P'`Ox!zOU#waV#waf#wag#wah#wa{#wa|#wa}#wa!O#wa!P#wa!Q#wa!R#wa!S#wa!T#wa!U#wa!V#wa$T#wa$W#wa%u#wa$_#wa$^#wa~O!V#sO$P#sO$Q#sO$R#sO~O$^#uO%|#vO~Ot#wO$_#zO~O$^#{O$_#|O~O$^vX$_vX~P'`OWyXXyXYyXZyX[yX]yX^yX_yX`yXayXbyXcyX!ZyX#uyX$XyX$YyX$]yX$`yX$ayX$byX$cyX$dyX$eyX$fyX$gyX$hyX$iyX$jyX$kyX$lyX$myX$nyX$oyX$pyX$qyX$ryX$syX$tyX$uyX$vyX$wyX$xyX$yyX$zyX${yX$|yX$}yX%OyX%PyX%QyX%RyX%SyX%TyX%UyX%VyX%WyX%XyX%YyX%ZyX%[yX%]yX%^yX%_yX%`yX%ayX%byX%cyX%dyX%eyX%fyX%gyX%hyX%iyX%jyX%kyX%lyX%myX%nyX%oyX%pyX%qyX%ryX%syX%tyX%wyX%xyX%yyX%{yX~OS$OOT$OO~P;mOQ#cOR#cO~P;mO%v$VO%z$WO~O#q$XO~O$X#TO$Y#TO%y#TO~O$]$YO~O#u$ZO~Ot#WO%|$]O~O$^$^O$_$_O~OWyaXyaYyaZya[ya]ya^ya_ya`yaayabyacya!Zya#uya$Xya$Yya$`ya$aya$bya$cya$dya$eya$fya$gya$hya$iya$jya$kya$lya$mya$nya$oya$pya$qya$rya$sya$tya$uya$vya$wya$xya$yya$zya${ya$|ya$}ya%Oya%Pya%Qya%Rya%Sya%Tya%Uya%Vya%Wya%Xya%Yya%Zya%[ya%]ya%^ya%_ya%`ya%aya%bya%cya%dya%eya%fya%gya%hya%iya%jya%kya%lya%mya%nya%oya%pya%qya%rya%sya%tya%wya%xya%yya%{ya~O$]#]O~PB{OS$bOT$bO$]ya~PB{Ox!zOUwqfwqgwqhwq!Owq!Pwq!Qwq!Rwq!Swq!Twq!Uwq!Vwq$Twq$Wwq%uwq$_wq$^wq~OVwq{wq|wq}wq~PISOV!zO{!zO|!zO}!zO~PISOV!zOx!zO{!zO|!zO}!zO!O!{O!P!{OUwqfwqgwqhwq$Twq$Wwq%uwq$_wq$^wq~O!Qwq!Rwq!Swq!Twq!Uwq!Vwq~PKOO!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~PKOOV!zOf!}Oh!}Ox!zO{!zO|!zO}!zO!O!{O!P!{O!Q!|O!R!|O!S!|O!T!|O!U!|O!V!|O~OUwqgwq$Twq$Wwq%uwq$_wq$^wq~PMQO#q$dO%v$cO~O$_$eO~Ot#wO$_$gO~O$^vi$_vi~P'`O$]#]OWyiXyiYyiZyi[yi]yi^yi_yi`yiayibyicyi!Zyi#uyi$Xyi$Yyi$`yi$ayi$byi$cyi$dyi$eyi$fyi$gyi$hyi$iyi$jyi$kyi$lyi$myi$nyi$oyi$pyi$qyi$ryi$syi$tyi$uyi$vyi$wyi$xyi$yyi$zyi${yi$|yi$}yi%Oyi%Pyi%Qyi%Ryi%Syi%Tyi%Uyi%Vyi%Wyi%Xyi%Yyi%Zyi%[yi%]yi%^yi%_yi%`yi%ayi%byi%cyi%dyi%eyi%fyi%gyi%hyi%iyi%jyi%kyi%lyi%myi%nyi%oyi%pyi%qyi%ryi%syi%tyi%wyi%xyi%yyi%{yi~O%v$iO~O",goto:"(v$VPPPPPPPPPPPPPPPPPPPPPPPPPPPPP$W$v%S%`%f%r%uP%{&U$vP&X&hPPPPPPPPPPP$v&r'OP'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O'O$vP'[$v$vP$v$v'k$v'w(W(g(j(pPPP$vP(sQSOQ#UXQ#VYQ#`!wQ$Q#fQ$R#gQ$S#hQ$T#iQ$U#jR$`#{e_OXY!w#f#g#h#i#j#{eROXY!w#f#g#h#i#j#{Q!xRR#b!yQ#^!vQ#}#cQ$a$OR$h$bR#x#]Q#y#]R$f$^Q!yRQ#SUR#b!xR#_!wQ#f!zQ#g!{Q#h!|Q#i!}R#j#OY#d!z!{!|!}#OR$P#eeUOXY!w#f#g#h#i#j#{eTOXY!w#f#g#h#i#j#{d_OXY!w#f#g#h#i#j#{R#p#ReYOXY!w#f#g#h#i#j#{d]OXY!w#f#g#h#i#j#{R!uPd^OXY!w#f#g#h#i#j#{R#[]R#X[Q#Y[R$[#uR#t#WR#q#R",nodeNames:"\u26A0 Bool Ignoring On GroupLeft GroupRight Offset Atan2 Avg Bottomk Count CountValues Group Max Min Quantile Stddev Stdvar Sum Topk By Without And Or Unless Start End LineComment PromQL Expr AggregateExpr AggregateOp AggregateModifier GroupingLabels GroupingLabelList GroupingLabel LabelName FunctionCallBody FunctionCallArgs BinaryExpr Pow BinModifiers OnOrIgnoring Mul Div Mod Add Sub Eql Gte Gtr Lte Lss Neq FunctionCall FunctionIdentifier AbsentOverTime Identifier Absent Abs Acos Acosh Asin Asinh Atan Atanh AvgOverTime Ceil Changes Clamp ClampMax ClampMin Cos Cosh CountOverTime DaysInMonth DayOfMonth DayOfWeek DayOfYear Deg Delta Deriv Exp Floor HistogramQuantile HoltWinters Hour Idelta Increase Irate LabelReplace LabelJoin LastOverTime Ln Log10 Log2 MaxOverTime MinOverTime Minute Month Pi PredictLinear PresentOverTime QuantileOverTime Rad Rate Resets Round Scalar Sgn Sin Sinh Sort SortDesc Sqrt StddevOverTime StdvarOverTime SumOverTime Tan Tanh Timestamp Time Vector Year MatrixSelector Duration NumberLiteral OffsetExpr ParenExpr StringLiteral SubqueryExpr UnaryExpr UnaryOp VectorSelector MetricIdentifier LabelMatchers LabelMatchList LabelMatcher MatchOp EqlSingle EqlRegex NeqRegex StepInvariantExpr At AtModifierPreprocessors MetricName",maxTerm:228,propSources:[Xe],skippedNodes:[0,27],repeatNodeCount:0,tokenData:"1R~RwX^#lpq#lqr$ars$tst%huv%swx%xxy&gyz&lz{&q{|&v|}&}}!O'S!O!P'Z!P!Q(Z!Q!R(`!R![)W![!]-r!^!_.n!_!`.{!`!a/b!b!c/o!c!}/t!}#O0[#P#Q0a#Q#R0f#R#S/t#S#T0k#T#o/t#o#p0w#q#r0|#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~#qY$[~X^#lpq#l#y#z#l$f$g#l#BY#BZ#l$IS$I_#l$I|$JO#l$JT$JU#l$KV$KW#l&FU&FV#l~$dQ!_!`$j#r#s$o~$oO!V~~$tO$R~~$yU#u~OY$tZr$trs%]s#O$t#O#P%b#P~$t~%bO#u~~%ePO~$t~%mQk~OY%hZ~%h~%xO}~~%}U#u~OY%xZw%xwx%]x#O%x#O#P&a#P~%x~&dPO~%x~&lO$]~~&qO$_~~&vO{~R&}O%xP!OQ~'SO$^~R'ZO%wP!PQP'^P!Q!['aP'fR%yP!Q!['a!g!h'o#X#Y'oP'rR{|'{}!O'{!Q![(RP(OP!Q![(RP(WP%yP!Q![(R~(`O|~R(eZ%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#l#m-W#m#n,iR)]Y%yP!O!P'a!Q![)W!g!h'o#W#X){#X#Y'o#[#]*d#a#b*x#g#h+l#k#l+}#m#n,iQ*QP#qQ!Q![*TQ*WS!Q![*T#[#]*d#a#b*x#g#h+lQ*iP#qQ!Q![*lQ*oR!Q![*l#a#b*x#g#h+lQ*}Q#qQ!Q![+T#g#h+gQ+WR!Q![+T#a#b+a#g#h+lQ+dP#g#h+gQ+lO#qQQ+qP#qQ!Q![+tQ+wQ!Q![+t#a#b+aQ,SP#qQ!Q![,VQ,YT!Q![,V#W#X){#[#]*d#a#b*x#g#h+lQ,nP#qQ!Q![,qQ,tU!Q![,q#W#X){#[#]*d#a#b*x#g#h+l#k#l+}P-ZR!Q![-d!c!i-d#T#Z-dP-iR%yP!Q![-d!c!i-d#T#Z-dV-yT%zS!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.YR._T!ZR!Q![.Y![!].Y!c!}.Y#R#S.Y#T#o.Y~.sP!U~!_!`.v~.{O!T~~/QQ$PP!_!`/W#r#s/]Q/]O!QQ~/bO$Q~~/gP!S~!_!`/j~/oO!R~~/tO$T~V/{T!ZRtS!Q![/t![!].Y!c!}/t#R#S/t#T#o/t~0aO%u~~0fO%v~~0kOx~~0nRO#S0k#S#T%]#T~0k~0|O%{~~1RO%|~",tokenizers:[0,1,2],topRules:{PromQL:[0,28],MetricName:[1,145]},specialized:[{term:57,get:(j,m)=>Le(j)<<1},{term:57,get:(j,m)=>Re(j)<<1|1},{term:57,get:j=>De[j]||-1}],tokenPrec:0}),pt=147,_t=148,$t=1,vt=2,Fe=3,bt=4,Pt=5,Et=6,St=7,Qt=8,Tt=9,xt=10,Mt=11,wt=12,Ct=13,Lt=14,At=15,Rt=16,Xt=17,Dt=18,kt=19,Ft=20,Ge=21,Gt=22,zt=23,Wt=24,Bt=25,Ut=26,It=27,ze=28,We=29,Be=30,Ue=31,Ie=32,qe=33,Ne=34,Ve=35,Ke=36,je=37,Ye=38,He=39,qt=40,Ze=41,Je=42,Nt=43,Vt=44,Kt=45,jt=46,Yt=47,Ht=48,Zt=49,Jt=50,ea=51,ta=52,et=53,tt=54,at=55,aa=56,it=57,ia=58,sa=59,na=60,ra=61,oa=62,la=63,ca=64,ha=65,ua=66,da=67,Oa=68,fa=69,ga=70,ya=71,ma=72,pa=73,_a=74,$a=75,va=76,ba=77,Pa=78,Ea=79,Sa=80,Qa=81,Ta=82,xa=83,Ma=84,wa=85,Ca=86,La=87,Aa=88,Ra=89,Xa=90,Da=91,ka=92,Fa=93,Ga=94,za=95,Wa=96,Ba=97,Ua=98,Ia=99,qa=100,Na=101,Va=102,Ka=103,ja=104,Ya=105,Ha=106,Za=107,Ja=108,ei=109,ti=110,ai=111,ii=112,si=113,ni=114,ri=115,oi=116,li=117,ci=118,hi=119,ui=120,di=121,Oi=122,fi=123,st=124,gi=125,nt=126,yi=127,rt=128,ot=129,mi=130,pi=131,_i=132,lt=133,ct=134,ht=135,ut=136,dt=137,Ot=138,ft=139,gt=140,yt=141,$i=142,vi=143,bi=144,Pi=145},52998:(ne,Y,_)=>{_.d(Y,{Z:()=>T});const v=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,M=typeof AbortController=="function"?AbortController:class{constructor(){this.signal=new g}abort(e=new Error("This operation was aborted")){this.signal.reason=e,this.signal.dispatchEvent({type:"abort",target:this.signal})}},s=typeof AbortSignal=="function",i=typeof M.AbortSignal=="function",g=s?AbortSignal:i?M.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(t=>t(e),this))}onabort(){}addEventListener(e,t){e==="abort"&&this._listeners.push(t)}removeEventListener(e,t){e==="abort"&&(this._listeners=this._listeners.filter(n=>n!==t))}},h=new Set,X=(f,e)=>{const t=`LRU_CACHE_OPTION_${f}`;G(t)&&B(t,`${f} option`,`options.${e}`,b)},C=(f,e)=>{const t=`LRU_CACHE_METHOD_${f}`;if(G(t)){const{prototype:n}=b,{get:d}=Object.getOwnPropertyDescriptor(n,f);B(t,`${f} method`,`cache.${e}()`,d)}},k=(f,e)=>{const t=`LRU_CACHE_PROPERTY_${f}`;if(G(t)){const{prototype:n}=b,{get:d}=Object.getOwnPropertyDescriptor(n,f);B(t,`${f} property`,`cache.${e}`,d)}},x=(...f)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...f):console.error(...f)},G=f=>!h.has(f),B=(f,e,t,n)=>{h.add(f);const d=`The ${e} is deprecated. Please use ${t} instead.`;x(d,"DeprecationWarning",f,n)},I=f=>f&&f===Math.floor(f)&&f>0&&isFinite(f),H=f=>I(f)?f<=Math.pow(2,8)?Uint8Array:f<=Math.pow(2,16)?Uint16Array:f<=Math.pow(2,32)?Uint32Array:f<=Number.MAX_SAFE_INTEGER?r:null:null;class r extends Array{constructor(e){super(e),this.fill(0)}}class a{constructor(e){if(e===0)return[];const t=H(e);this.heap=new t(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class b{constructor(e={}){const{max:t=0,ttl:n,ttlResolution:d=1,ttlAutopurge:L,updateAgeOnGet:l,updateAgeOnHas:p,allowStale:P,dispose:S,disposeAfter:D,noDisposeOnSet:Q,noUpdateTTL:c,maxSize:F=0,maxEntrySize:y=0,sizeCalculation:E,fetchMethod:o,fetchContext:O,noDeleteOnFetchRejection:u,noDeleteOnStaleGet:$,allowStaleOnFetchRejection:A,allowStaleOnFetchAbort:R,ignoreFetchAbort:V}=e,{length:W,maxAge:N,stale:K}=e instanceof b?{}:e;if(t!==0&&!I(t))throw new TypeError("max option must be a nonnegative integer");const Z=t?H(t):Array;if(!Z)throw new Error("invalid max value: "+t);if(this.max=t,this.maxSize=F,this.maxEntrySize=y||this.maxSize,this.sizeCalculation=E||W,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=o||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=O,!this.fetchMethod&&O!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(t).fill(null),this.valList=new Array(t).fill(null),this.next=new Z(t),this.prev=new Z(t),this.head=0,this.tail=0,this.free=new a(t),this.initialFill=1,this.size=0,typeof S=="function"&&(this.dispose=S),typeof D=="function"?(this.disposeAfter=D,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!Q,this.noUpdateTTL=!!c,this.noDeleteOnFetchRejection=!!u,this.allowStaleOnFetchRejection=!!A,this.allowStaleOnFetchAbort=!!R,this.ignoreFetchAbort=!!V,this.maxEntrySize!==0){if(this.maxSize!==0&&!I(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!I(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!P||!!K,this.noDeleteOnStaleGet=!!$,this.updateAgeOnGet=!!l,this.updateAgeOnHas=!!p,this.ttlResolution=I(d)||d===0?d:1,this.ttlAutopurge=!!L,this.ttl=n||N||0,this.ttl){if(!I(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const ee="LRU_CACHE_UNBOUNDED";G(ee)&&(h.add(ee),x("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",ee,b))}K&&X("stale","allowStale"),N&&X("maxAge","ttl"),W&&X("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new r(this.max),this.starts=new r(this.max),this.setItemTTL=(n,d,L=v.now())=>{if(this.starts[n]=d!==0?L:0,this.ttls[n]=d,d!==0&&this.ttlAutopurge){const l=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},d+1);l.unref&&l.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?v.now():0};let e=0;const t=()=>{const n=v.now();if(this.ttlResolution>0){e=n;const d=setTimeout(()=>e=0,this.ttlResolution);d.unref&&d.unref()}return n};this.getRemainingTTL=n=>{const d=this.keyMap.get(n);return d===void 0?0:this.ttls[d]===0||this.starts[d]===0?1/0:this.starts[d]+this.ttls[d]-(e||t())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||t())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,t,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new r(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,t,n,d)=>{if(this.isBackgroundFetch(t))return 0;if(!I(n))if(d){if(typeof d!="function")throw new TypeError("sizeCalculation must be a function");if(n=d(t,e),!I(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return n},this.addItemSize=(e,t)=>{if(this.sizes[e]=t,this.maxSize){const n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0)}this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,t){}requireSize(e,t,n,d){if(n||d)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.tail;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.head));)t=this.prev[t]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let t=this.head;!(!this.isValidIndex(t)||((e||!this.isStale(t))&&(yield t),t===this.tail));)t=this.next[t]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*rentries(){for(const e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield[this.keyList[e],this.valList[e]])}*keys(){for(const e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*rkeys(){for(const e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.keyList[e])}*values(){for(const e of this.indexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}*rvalues(){for(const e of this.rindexes())this.isBackgroundFetch(this.valList[e])||(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,t={}){for(const n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],t)}forEach(e,t=this){for(const n of this.indexes())e.call(t,this.valList[n],this.keyList[n],this)}rforEach(e,t=this){for(const n of this.rindexes())e.call(t,this.valList[n],this.keyList[n],this)}get prune(){return C("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const t of this.rindexes({allowStale:!0}))this.isStale(t)&&(this.delete(this.keyList[t]),e=!0);return e}dump(){const e=[];for(const t of this.indexes({allowStale:!0})){const n=this.keyList[t],d=this.valList[t],L=this.isBackgroundFetch(d)?d.__staleWhileFetching:d;if(L===void 0)continue;const l={value:L};if(this.ttls){l.ttl=this.ttls[t];const p=v.now()-this.starts[t];l.start=Math.floor(Date.now()-p)}this.sizes&&(l.size=this.sizes[t]),e.unshift([n,l])}return e}load(e){this.clear();for(const[t,n]of e){if(n.start){const d=Date.now()-n.start;n.start=v.now()-d}this.set(t,n.value,n)}}dispose(e,t,n){}set(e,t,{ttl:n=this.ttl,start:d,noDisposeOnSet:L=this.noDisposeOnSet,size:l=0,sizeCalculation:p=this.sizeCalculation,noUpdateTTL:P=this.noUpdateTTL}={}){if(l=this.requireSize(e,t,l,p),this.maxEntrySize&&l>this.maxEntrySize)return this.delete(e),this;let S=this.size===0?void 0:this.keyMap.get(e);if(S===void 0)S=this.newIndex(),this.keyList[S]=e,this.valList[S]=t,this.keyMap.set(e,S),this.next[this.tail]=S,this.prev[S]=this.tail,this.tail=S,this.size++,this.addItemSize(S,l),P=!1;else{this.moveToTail(S);const D=this.valList[S];t!==D&&(this.isBackgroundFetch(D)?D.__abortController.abort(new Error("replaced")):L||(this.dispose(D,e,"set"),this.disposeAfter&&this.disposed.push([D,e,"set"])),this.removeItemSize(S),this.valList[S]=t,this.addItemSize(S,l))}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),P||this.setItemTTL(S,n,d),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const t=this.head,n=this.keyList[t],d=this.valList[t];return this.isBackgroundFetch(d)?d.__abortController.abort(new Error("evicted")):(this.dispose(d,n,"evict"),this.disposeAfter&&this.disposed.push([d,n,"evict"])),this.removeItemSize(t),e&&(this.keyList[t]=null,this.valList[t]=null,this.free.push(t)),this.head=this.next[t],this.keyMap.delete(n),this.size--,t}has(e,{updateAgeOnHas:t=this.updateAgeOnHas}={}){const n=this.keyMap.get(e);return n!==void 0&&!this.isStale(n)?(t&&this.updateItemAge(n),!0):!1}peek(e,{allowStale:t=this.allowStale}={}){const n=this.keyMap.get(e);if(n!==void 0&&(t||!this.isStale(n))){const d=this.valList[n];return this.isBackgroundFetch(d)?d.__staleWhileFetching:d}}backgroundFetch(e,t,n,d){const L=t===void 0?void 0:this.valList[t];if(this.isBackgroundFetch(L))return L;const l=new M;n.signal&&n.signal.addEventListener("abort",()=>l.abort(n.signal.reason));const p={signal:l.signal,options:n,context:d},P=(c,F=!1)=>{const{aborted:y}=l.signal,E=n.ignoreFetchAbort&&c!==void 0;return y&&!E&&!F?S(l.signal.reason):(this.valList[t]===Q&&(c===void 0?Q.__staleWhileFetching?this.valList[t]=Q.__staleWhileFetching:this.delete(e):this.set(e,c,p.options)),c)},S=c=>{const{aborted:F}=l.signal,y=F&&n.allowStaleOnFetchAbort,E=y||n.allowStaleOnFetchRejection,o=E||n.noDeleteOnFetchRejection;if(this.valList[t]===Q&&(!o||Q.__staleWhileFetching===void 0?this.delete(e):y||(this.valList[t]=Q.__staleWhileFetching)),E)return Q.__staleWhileFetching;if(Q.__returned===Q)throw c},D=(c,F)=>{this.fetchMethod(e,L,p).then(y=>c(y),F),l.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(c(),n.allowStaleOnFetchAbort&&(c=y=>P(y,!0)))})},Q=new Promise(D).then(P,S);return Q.__abortController=l,Q.__staleWhileFetching=L,Q.__returned=null,t===void 0?(this.set(e,Q,p.options),t=this.keyMap.get(e)):this.valList[t]=Q,Q}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:d=this.noDeleteOnStaleGet,ttl:L=this.ttl,noDisposeOnSet:l=this.noDisposeOnSet,size:p=0,sizeCalculation:P=this.sizeCalculation,noUpdateTTL:S=this.noUpdateTTL,noDeleteOnFetchRejection:D=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:Q=this.allowStaleOnFetchRejection,ignoreFetchAbort:c=this.ignoreFetchAbort,allowStaleOnFetchAbort:F=this.allowStaleOnFetchAbort,fetchContext:y=this.fetchContext,forceRefresh:E=!1,signal:o}={}){if(!this.fetchMethod)return this.get(e,{allowStale:t,updateAgeOnGet:n,noDeleteOnStaleGet:d});const O={allowStale:t,updateAgeOnGet:n,noDeleteOnStaleGet:d,ttl:L,noDisposeOnSet:l,size:p,sizeCalculation:P,noUpdateTTL:S,noDeleteOnFetchRejection:D,allowStaleOnFetchRejection:Q,allowStaleOnFetchAbort:F,ignoreFetchAbort:c,signal:o};let u=this.keyMap.get(e);if(u===void 0){const $=this.backgroundFetch(e,u,O,y);return $.__returned=$}else{const $=this.valList[u];if(this.isBackgroundFetch($))return t&&$.__staleWhileFetching!==void 0?$.__staleWhileFetching:$.__returned=$;if(!E&&!this.isStale(u))return this.moveToTail(u),n&&this.updateItemAge(u),$;const A=this.backgroundFetch(e,u,O,y);return t&&A.__staleWhileFetching!==void 0?A.__staleWhileFetching:A.__returned=A}}get(e,{allowStale:t=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:d=this.noDeleteOnStaleGet}={}){const L=this.keyMap.get(e);if(L!==void 0){const l=this.valList[L],p=this.isBackgroundFetch(l);return this.isStale(L)?p?t?l.__staleWhileFetching:void 0:(d||this.delete(e),t?l:void 0):p?void 0:(this.moveToTail(L),n&&this.updateItemAge(L),l)}}connect(e,t){this.prev[t]=e,this.next[e]=t}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return C("del","delete"),this.delete}delete(e){let t=!1;if(this.size!==0){const n=this.keyMap.get(e);if(n!==void 0)if(t=!0,this.size===1)this.clear();else{this.removeItemSize(n);const d=this.valList[n];this.isBackgroundFetch(d)?d.__abortController.abort(new Error("deleted")):(this.dispose(d,e,"delete"),this.disposeAfter&&this.disposed.push([d,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return t}clear(){for(const e of this.rindexes({allowStale:!0})){const t=this.valList[e];if(this.isBackgroundFetch(t))t.__abortController.abort(new Error("deleted"));else{const n=this.keyList[e];this.dispose(t,n,"delete"),this.disposeAfter&&this.disposed.push([t,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return C("reset","clear"),this.clear}get length(){return k("length","size"),this.size}static get AbortController(){return M}static get AbortSignal(){return g}}const T=b}}]);

//# sourceMappingURL=4254.f378ade17a0d4d269298.js.map