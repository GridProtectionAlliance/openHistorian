(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"8uRs":function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"d",function(){return s}),n.d(t,"g",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"e",function(){return m}),n.d(t,"i",function(){return l}),n.d(t,"h",function(){return d});var r=n("GQ3c"),a=function(e){return e.searchQuery},i=function(e){return e.searchMemberQuery},s=function(e){return e.groups},o=function(e){return e.teams.length},c=function(e,t){return e.team.id===parseInt(t,10)?e.team:null},u=function(e){var t=RegExp(e.searchQuery,"i");return e.teams.filter(function(e){return t.test(e.name)})},m=function(e){var t=RegExp(e.searchMemberQuery,"i");return e.members.filter(function(e){return t.test(e.login)||t.test(e.email)||t.test(e.name)})},l=function(e){var t=e.members,n=e.signedInUser,a=e.editorsCanAdmin,i=t.find(function(e){return e.userId===n.id}),s=i?i.permission:r.TeamPermissionLevel.Member;return d({permission:s,signedInUser:n,editorsCanAdmin:a})},d=function(e){var t=e.permission,n=e.signedInUser,a=e.editorsCanAdmin,i=n.isGrafanaAdmin||n.orgRole===r.OrgRole.Admin,s=t===r.TeamPermissionLevel.Admin;return i||s||!a}},EKT6:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n("q1tI"),a=n.n(r),i=n("Obii"),s=Object(r.forwardRef)(function(e,t){return a.a.createElement("label",{className:e.labelClassName},a.a.createElement("input",{ref:t,type:"text",className:e.inputClassName,value:Object(i.unEscapeStringFromRegex)(e.value),onChange:function(t){return e.onChange(Object(i.escapeStringForRegex)(t.target.value))},placeholder:e.placeholder?e.placeholder:null}),a.a.createElement("i",{className:"gf-form-input-icon fa fa-search"}))})},Rczg:function(e,t,n){"use strict";var r=n("mrSG"),a=n("q1tI"),i=n.n(a),s=n("/MKj"),o=n("kDLi"),c=n("mHLn"),u=n("gxTa"),m=n("X+V3"),l=n("8uRs"),d=function(e){function t(t){var n=e.call(this,t)||this;return n.onChangeName=function(e){n.setState({name:e.target.value})},n.onChangeEmail=function(e){n.setState({email:e.target.value})},n.onUpdate=function(e){var t=n.state,r=t.name,a=t.email;e.preventDefault(),n.props.updateTeam(r,a)},n.state={name:t.team.name,email:t.team.email},n}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props.team,t=this.state,n=t.name,r=t.email;return i.a.createElement("div",null,i.a.createElement("h3",{className:"page-sub-heading"},"Team Settings"),i.a.createElement("form",{name:"teamDetailsForm",className:"gf-form-group",onSubmit:this.onUpdate},i.a.createElement("div",{className:"gf-form max-width-30"},i.a.createElement(o.FormLabel,null,"Name"),i.a.createElement(o.Input,{type:"text",required:!0,value:n,className:"gf-form-input max-width-22",onChange:this.onChangeName})),i.a.createElement("div",{className:"gf-form max-width-30"},i.a.createElement(o.FormLabel,{tooltip:"This is optional and is primarily used to set the team profile avatar (via gravatar service)"},"Email"),i.a.createElement(o.Input,{type:"email",className:"gf-form-input max-width-22",value:r,placeholder:"team@email.com",onChange:this.onChangeEmail})),i.a.createElement("div",{className:"gf-form-button-row"},i.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Update"))),i.a.createElement(c.a,{resourceUri:"teams/"+e.id}))},t}(i.a.Component);var f={updateTeam:u.j};t.a=Object(s.connect)(function(e){var t=Object(m.a)(e.location);return{team:Object(l.c)(e.team,t)}},f)(d)},WB4m:function(e,t,n){"use strict";var r=n("mrSG"),a=n("q1tI"),i=n.n(a),s=n("/MKj"),o=n("BVom"),c=n("kDLi"),u=n("gxTa"),m=n("8uRs"),l=n("QQVG"),d="Sync LDAP or OAuth groups with your Grafana teams.",f=function(e){function t(t){var n=e.call(this,t)||this;return n.onToggleAdding=function(){n.setState({isAdding:!n.state.isAdding})},n.onNewGroupIdChanged=function(e){n.setState({newGroupId:e.target.value})},n.onAddGroup=function(e){e.preventDefault(),n.props.addTeamGroup(n.state.newGroupId),n.setState({isAdding:!1,newGroupId:""})},n.onRemoveGroup=function(e){n.props.removeTeamGroup(e.groupId)},n.state={isAdding:!1,newGroupId:""},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){this.fetchTeamGroups()},t.prototype.fetchTeamGroups=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,this.props.loadTeamGroups()];case 1:return e.sent(),[2]}})})},t.prototype.isNewGroupValid=function(){return this.state.newGroupId.length>1},t.prototype.renderGroup=function(e){var t=this;return i.a.createElement("tr",{key:e.groupId},i.a.createElement("td",null,e.groupId),i.a.createElement("td",{style:{width:"1%"}},i.a.createElement("a",{className:"btn btn-danger btn-small",onClick:function(){return t.onRemoveGroup(e)}},i.a.createElement("i",{className:"fa fa-remove"}))))},t.prototype.render=function(){var e=this,t=this.state,n=t.isAdding,r=t.newGroupId,a=this.props.groups;return i.a.createElement("div",null,i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("h3",{className:"page-sub-heading"},"External group sync"),i.a.createElement(c.Tooltip,{placement:"auto",content:d},i.a.createElement("div",{className:"page-sub-heading-icon"},i.a.createElement("i",{className:"gicon gicon-question gicon--has-hover"}))),i.a.createElement("div",{className:"page-action-bar__spacer"}),a.length>0&&i.a.createElement("button",{className:"btn btn-primary pull-right",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-plus"})," Add group")),i.a.createElement(o.a,{in:n},i.a.createElement("div",{className:"cta-form"},i.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-close"})),i.a.createElement("h5",null,"Add External Group"),i.a.createElement("form",{className:"gf-form-inline",onSubmit:this.onAddGroup},i.a.createElement("div",{className:"gf-form"},i.a.createElement(c.Input,{type:"text",className:"gf-form-input width-30",value:r,onChange:this.onNewGroupIdChanged,placeholder:"cn=ops,ou=groups,dc=grafana,dc=org"})),i.a.createElement("div",{className:"gf-form"},i.a.createElement("button",{className:"btn btn-primary gf-form-btn",type:"submit",disabled:!this.isNewGroupValid()},"Add group"))))),0===a.length&&!n&&i.a.createElement(l.a,{onClick:this.onToggleAdding,buttonIcon:"gicon gicon-team",title:"There are no external groups to sync with",buttonTitle:"Add Group",proTip:d,proTipLinkTitle:"Learn more",proTipLink:"http://docs.grafana.org/auth/enhanced_ldap/",proTipTarget:"_blank"}),a.length>0&&i.a.createElement("div",{className:"admin-list-table"},i.a.createElement("table",{className:"filter-table filter-table--hover form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"External Group ID"),i.a.createElement("th",{style:{width:"1%"}}))),i.a.createElement("tbody",null,a.map(function(t){return e.renderGroup(t)})))))},t}(a.PureComponent);var p={loadTeamGroups:u.e,addTeamGroup:u.a,removeTeamGroup:u.h};t.a=Object(s.connect)(function(e){return{groups:Object(m.d)(e.team)}},p)(f)},cwy8:function(e,t,n){"use strict";var r=n("mrSG"),a=n("q1tI"),i=n.n(a),s=n("/MKj"),o=n("BVom"),c=n("+dgx"),u=n("rCnR"),m=n("gxTa"),l=n("8uRs"),d=n("EKT6"),f=function(e){var t=e.featureToggle,n=e.children;return!0===t?i.a.createElement(i.a.Fragment,null,n):null},p=n("ZFWI"),b=n("umNM"),g=n("kDLi"),h=n("GQ3c"),v=function(e){function t(t){var n=e.call(this,t)||this;return n.onPermissionChange=function(e,t){var a=e.value,i=Object(r.__assign)(Object(r.__assign)({},t),{permission:a});n.props.updateTeamMember(i)},n.renderLabels=n.renderLabels.bind(n),n.renderPermissions=n.renderPermissions.bind(n),n}return Object(r.__extends)(t,e),t.prototype.onRemoveMember=function(e){this.props.removeTeamMember(e.userId)},t.prototype.renderPermissions=function(e){var t=this,n=this.props,r=n.editorsCanAdmin,a=n.signedInUserIsTeamAdmin,s=h.teamsPermissionLevels.find(function(t){return t.value===e.permission});return i.a.createElement(f,{featureToggle:r},i.a.createElement("td",{className:"width-5 team-permissions"},i.a.createElement("div",{className:"gf-form"},a&&i.a.createElement(g.Select,{isSearchable:!1,options:h.teamsPermissionLevels,onChange:function(n){return t.onPermissionChange(n,e)},className:"gf-form-select-box__control--menu-right",value:s}),!a&&i.a.createElement("span",null,s.label))))},t.prototype.renderLabels=function(e){return e?i.a.createElement("td",null,e.map(function(e){return i.a.createElement(u.a,{key:e,label:e,removeIcon:!1,count:0,onClick:function(){}})})):i.a.createElement("td",null)},t.prototype.render=function(){var e=this,t=this.props,n=t.member,r=t.syncEnabled,a=t.signedInUserIsTeamAdmin;return i.a.createElement("tr",{key:n.userId},i.a.createElement("td",{className:"width-4 text-center"},i.a.createElement("img",{className:"filter-table__avatar",src:n.avatarUrl})),i.a.createElement("td",null,n.login),i.a.createElement("td",null,n.email),i.a.createElement("td",null,n.name),this.renderPermissions(n),r&&this.renderLabels(n.labels),i.a.createElement("td",{className:"text-right"},i.a.createElement(g.DeleteButton,{size:"sm",disabled:!a,onConfirm:function(){return e.onRemoveMember(n)}})))},t}(a.PureComponent);var E={removeTeamMember:m.i,updateTeamMember:m.k},_=Object(s.connect)(function(e){return{}},E)(v),j=n("BPIC"),O=function(e){function t(t){var n=e.call(this,t)||this;return n.onSearchQueryChange=function(e){n.props.setSearchMemberQuery(e)},n.onToggleAdding=function(){n.setState({isAdding:!n.state.isAdding})},n.onUserSelected=function(e){n.setState({newTeamMember:e})},n.onAddUserToTeam=function(){return Object(r.__awaiter)(n,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return this.props.addTeamMember(this.state.newTeamMember.id),this.setState({newTeamMember:null}),[2]})})},n.state={isAdding:!1,newTeamMember:null},n}return Object(r.__extends)(t,e),t.prototype.renderLabels=function(e){return e?i.a.createElement("td",null,e.map(function(e){return i.a.createElement(u.a,{key:e,label:e,removeIcon:!1,count:0,onClick:function(){}})})):i.a.createElement("td",null)},t.prototype.render=function(){var e=this.state.isAdding,t=this.props,n=t.searchMemberQuery,r=t.members,a=t.syncEnabled,s=t.editorsCanAdmin,u=t.signedInUser,m=Object(l.i)({members:r,editorsCanAdmin:s,signedInUser:u});return i.a.createElement("div",null,i.a.createElement("div",{className:"page-action-bar"},i.a.createElement("div",{className:"gf-form gf-form--grow"},i.a.createElement(d.a,{labelClassName:"gf-form--has-input-icon gf-form--grow",inputClassName:"gf-form-input",placeholder:"Search members",value:n,onChange:this.onSearchQueryChange})),i.a.createElement("div",{className:"page-action-bar__spacer"}),i.a.createElement("button",{className:"btn btn-primary pull-right",onClick:this.onToggleAdding,disabled:e||!m},"Add member")),i.a.createElement(o.a,{in:e},i.a.createElement("div",{className:"cta-form"},i.a.createElement("button",{className:"cta-form__close btn btn-transparent",onClick:this.onToggleAdding},i.a.createElement("i",{className:"fa fa-close"})),i.a.createElement("h5",null,"Add team member"),i.a.createElement("div",{className:"gf-form-inline"},i.a.createElement(c.a,{onSelected:this.onUserSelected,className:"min-width-30"}),this.state.newTeamMember&&i.a.createElement("button",{className:"btn btn-primary gf-form-btn",type:"submit",onClick:this.onAddUserToTeam},"Add to team")))),i.a.createElement("div",{className:"admin-list-table"},i.a.createElement("table",{className:"filter-table filter-table--hover form-inline"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("th",null,"Login"),i.a.createElement("th",null,"Email"),i.a.createElement("th",null,"Name"),i.a.createElement(f,{featureToggle:s},i.a.createElement("th",null,"Permission")),a&&i.a.createElement("th",null),i.a.createElement("th",{style:{width:"1%"}}))),i.a.createElement("tbody",null,r&&r.map(function(e){return i.a.createElement(_,{key:e.userId,member:e,syncEnabled:a,editorsCanAdmin:s,signedInUserIsTeamAdmin:m})})))))},t}(a.PureComponent);var w={addTeamMember:m.b,setSearchMemberQuery:j.b};t.a=Object(s.connect)(function(e){return{searchMemberQuery:Object(l.a)(e.team),editorsCanAdmin:p.a.editorsCanAdmin,signedInUser:b.a.user}},w)(O)},gxTa:function(e,t,n){"use strict";n.d(t,"g",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"f",function(){return m}),n.d(t,"b",function(){return l}),n.d(t,"i",function(){return d}),n.d(t,"j",function(){return f}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return b}),n.d(t,"h",function(){return g}),n.d(t,"c",function(){return h}),n.d(t,"k",function(){return v});var r=n("mrSG"),a=n("t8hP"),i=n("3SGO"),s=n("zsYB"),o=n("BPIC");function c(){var e=this;return function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,Object(a.getBackendSrv)().get("/api/teams/search",{perpage:1e3,page:1})];case 1:return e=n.sent(),t(Object(o.g)(e.teams)),[2]}})})}}function u(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(a.getBackendSrv)().get("/api/teams/"+e)];case 1:return t=r.sent(),n(Object(o.e)(t)),n(Object(i.d)(Object(s.a)(t))),[2]}})})}}function m(){var e=this;return function(t,n){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e=n().team.team,[4,Object(a.getBackendSrv)().get("/api/teams/"+e.id+"/members")];case 1:return i=r.sent(),t(Object(o.f)(i)),[2]}})})}}function l(e){var t=this;return function(n,i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=i().team.team,[4,Object(a.getBackendSrv)().post("/api/teams/"+t.id+"/members",{userId:e})];case 1:return r.sent(),n(m()),[2]}})})}}function d(e){var t=this;return function(n,i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=i().team.team,[4,Object(a.getBackendSrv)().delete("/api/teams/"+t.id+"/members/"+e)];case 1:return r.sent(),n(m()),[2]}})})}}function f(e,t){var n=this;return function(i,s){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=s().team.team,[4,Object(a.getBackendSrv)().put("/api/teams/"+n.id,{name:e,email:t})];case 1:return r.sent(),i(u(n.id)),[2]}})})}}function p(){var e=this;return function(t,n){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e=n().team.team,[4,Object(a.getBackendSrv)().get("/api/teams/"+e.id+"/groups")];case 1:return i=r.sent(),t(Object(o.d)(i)),[2]}})})}}function b(e){var t=this;return function(n,i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=i().team.team,[4,Object(a.getBackendSrv)().post("/api/teams/"+t.id+"/groups",{groupId:e})];case 1:return r.sent(),n(p()),[2]}})})}}function g(e){var t=this;return function(n,i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=i().team.team,[4,Object(a.getBackendSrv)().delete("/api/teams/"+t.id+"/groups/"+encodeURIComponent(e))];case 1:return r.sent(),n(p()),[2]}})})}}function h(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(a.getBackendSrv)().delete("/api/teams/"+e)];case 1:return t.sent(),n(c()),[2]}})})}}function v(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(a.getBackendSrv)().put("/api/teams/"+e.teamId+"/members/"+e.userId,{permission:e.permission})];case 1:return t.sent(),n(m()),[2]}})})}}},"p+xb":function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"TeamPages",function(){return O});var r,a=n("mrSG"),i=n("q1tI"),s=n.n(i),o=n("/MKj"),c=n("LvDl"),u=n.n(c),m=n("0cfB"),l=n("ZFWI"),d=n("ZGyg"),f=n("cwy8"),p=n("Rczg"),b=n("WB4m"),g=n("gxTa"),h=n("8uRs"),v=n("zsYB"),E=n("lzJ5"),_=n("X+V3"),j=n("umNM");!function(e){e.Members="members",e.Settings="settings",e.GroupSync="groupsync"}(r||(r={}));var O=function(e){function t(t){var n=e.call(this,t)||this;return n.textsAreEqual=function(e,t){return!e&&!t||!(!e||!t)&&e.toLocaleLowerCase()===t.toLocaleLowerCase()},n.hideTabsFromNonTeamAdmin=function(e,t){return!t&&e.main&&e.main.children&&e.main.children.filter(function(e){return!n.textsAreEqual(e.text,r.Members)}).map(function(e){e.hideFromTabs=!0}),e},n.state={isLoading:!1,isSyncEnabled:l.b.licenseInfo.hasLicense},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,this.fetchTeam()];case 1:return e.sent(),[2]}})})},t.prototype.fetchTeam=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,r;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=this.props,t=e.loadTeam,n=e.teamId,this.setState({isLoading:!0}),[4,t(n)];case 1:return r=a.sent(),[4,this.props.loadTeamMembers()];case 2:return a.sent(),this.setState({isLoading:!1}),[2,r]}})})},t.prototype.getCurrentPage=function(){var e=["members","settings","groupsync"],t=this.props.pageName;return u.a.includes(e,t)?t:e[0]},t.prototype.renderPage=function(e){var t=this.state.isSyncEnabled,n=this.props.members;switch(this.getCurrentPage()){case r.Members:return s.a.createElement(f.a,{syncEnabled:t,members:n});case r.Settings:return e&&s.a.createElement(p.a,null);case r.GroupSync:return e&&t&&s.a.createElement(b.a,null)}return null},t.prototype.render=function(){var e=this.props,t=e.team,n=e.navModel,r=e.members,a=e.editorsCanAdmin,i=e.signedInUser,o=Object(h.i)({members:r,editorsCanAdmin:a,signedInUser:i});return s.a.createElement(d.a,{navModel:this.hideTabsFromNonTeamAdmin(n,o)},s.a.createElement(d.a.Contents,{isLoading:this.state.isLoading},t&&0!==Object.keys(t).length&&this.renderPage(o)))},t}(i.PureComponent);var w={loadTeam:g.d,loadTeamMembers:g.f};t.default=Object(m.hot)(e)(Object(o.connect)(function(e){var t=Object(_.a)(e.location),n=Object(_.b)(e.location)||"members",r=Object(v.b)(n);return{navModel:Object(E.a)(e.navIndex,"team-"+n+"-"+t,r),teamId:t,pageName:n,team:Object(h.c)(e.team,t),members:Object(h.e)(e.team),editorsCanAdmin:l.b.editorsCanAdmin,signedInUser:j.a.user}},w)(O))}.call(this,n("3UD+")(e))},zsYB:function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return o});var r=n("mrSG"),a=n("GQ3c"),i=n("ZFWI");function s(e){var t={img:e.avatarUrl,id:"team-"+e.id,subTitle:"Manage members & settings",url:"",text:e.name,breadcrumbs:[{title:"Teams",url:"org/teams"}],children:[{active:!1,icon:"gicon gicon-team",id:"team-members-"+e.id,text:"Members",url:"org/teams/edit/"+e.id+"/members"},{active:!1,icon:"fa fa-fw fa-sliders",id:"team-settings-"+e.id,text:"Settings",url:"org/teams/edit/"+e.id+"/settings"}]};return i.b.licenseInfo.hasLicense&&t.children.push({active:!1,icon:"fa fa-fw fa-refresh",id:"team-groupsync-"+e.id,text:"External group sync",url:"org/teams/edit/"+e.id+"/groupsync"}),t}function o(e){var t,n,i,o=s({avatarUrl:"public/img/user_profile.png",id:1,name:"Loading",email:"loading",memberCount:0,permission:a.TeamPermissionLevel.Member});try{for(var c=Object(r.__values)(o.children),u=c.next();!u.done;u=c.next()){var m=u.value;if(m.id.indexOf(e)>0){m.active=!0,i=m;break}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return{main:o,node:i}}}}]);
//# sourceMappingURL=TeamPages.4d0490a94b199a11f40c.js.map