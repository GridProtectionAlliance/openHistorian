{"version":3,"file":"3833.fe8dcff66b78faf8db53.js","mappings":"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","sources":["webpack://grafana/./public/app/core/components/PluginHelp/PluginHelp.tsx","webpack://grafana/./public/app/features/query/components/QueryGroupOptions.tsx","webpack://grafana/./public/app/features/query/components/QueryGroup.tsx","webpack://grafana/./public/app/features/query/state/updateQueries.ts"],"sourcesContent":["import React, { PureComponent } from 'react';\n\nimport { renderMarkdown } from '@grafana/data';\nimport { getBackendSrv } from '@grafana/runtime';\n\ninterface Props {\n  plugin: {\n    name: string;\n    id: string;\n  };\n  type: string;\n}\n\ninterface State {\n  isError: boolean;\n  isLoading: boolean;\n  help: string;\n}\n\nexport class PluginHelp extends PureComponent<Props, State> {\n  state = {\n    isError: false,\n    isLoading: false,\n    help: '',\n  };\n\n  componentDidMount(): void {\n    this.loadHelp();\n  }\n\n  constructPlaceholderInfo() {\n    return 'No plugin help or readme markdown file was found';\n  }\n\n  loadHelp = () => {\n    const { plugin, type } = this.props;\n    this.setState({ isLoading: true });\n\n    getBackendSrv()\n      .get(`/api/plugins/${plugin.id}/markdown/${type}`)\n      .then((response: string) => {\n        const helpHtml = renderMarkdown(response);\n\n        if (response === '' && type === 'help') {\n          this.setState({\n            isError: false,\n            isLoading: false,\n            help: this.constructPlaceholderInfo(),\n          });\n        } else {\n          this.setState({\n            isError: false,\n            isLoading: false,\n            help: helpHtml,\n          });\n        }\n      })\n      .catch(() => {\n        this.setState({\n          isError: true,\n          isLoading: false,\n        });\n      });\n  };\n\n  render() {\n    const { type } = this.props;\n    const { isError, isLoading, help } = this.state;\n\n    if (isLoading) {\n      return <h2>Loading help...</h2>;\n    }\n\n    if (isError) {\n      return <h3>&apos;Error occurred when loading help&apos;</h3>;\n    }\n\n    if (type === 'panel_help' && help === '') {\n    }\n\n    return <div className=\"markdown-html\" dangerouslySetInnerHTML={{ __html: help }} />;\n  }\n}\n","import { css } from '@emotion/css';\nimport React, { PureComponent, ChangeEvent, FocusEvent } from 'react';\n\nimport { rangeUtil, PanelData, DataSourceApi } from '@grafana/data';\nimport { Switch, Input, InlineField, InlineFormLabel, stylesFactory } from '@grafana/ui';\nimport { QueryOperationRow } from 'app/core/components/QueryOperationRow/QueryOperationRow';\nimport { config } from 'app/core/config';\nimport { QueryGroupOptions } from 'app/types';\n\ninterface Props {\n  options: QueryGroupOptions;\n  dataSource: DataSourceApi;\n  data: PanelData;\n  onChange: (options: QueryGroupOptions) => void;\n}\n\ninterface State {\n  timeRangeFrom: string;\n  timeRangeShift: string;\n  timeRangeHide: boolean;\n  isOpen: boolean;\n  relativeTimeIsValid: boolean;\n  timeShiftIsValid: boolean;\n}\n\nexport class QueryGroupOptionsEditor extends PureComponent<Props, State> {\n  constructor(props: Props) {\n    super(props);\n\n    const { options } = props;\n\n    this.state = {\n      timeRangeFrom: options.timeRange?.from || '',\n      timeRangeShift: options.timeRange?.shift || '',\n      timeRangeHide: options.timeRange?.hide ?? false,\n      isOpen: false,\n      relativeTimeIsValid: true,\n      timeShiftIsValid: true,\n    };\n  }\n\n  onRelativeTimeChange = (event: ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      timeRangeFrom: event.target.value,\n    });\n  };\n\n  onTimeShiftChange = (event: ChangeEvent<HTMLInputElement>) => {\n    this.setState({\n      timeRangeShift: event.target.value,\n    });\n  };\n\n  onOverrideTime = (event: FocusEvent<HTMLInputElement>) => {\n    const { options, onChange } = this.props;\n\n    const newValue = emptyToNull(event.target.value);\n    const isValid = timeRangeValidation(newValue);\n\n    if (isValid && options.timeRange?.from !== newValue) {\n      onChange({\n        ...options,\n        timeRange: {\n          ...(options.timeRange ?? {}),\n          from: newValue,\n        },\n      });\n    }\n\n    this.setState({ relativeTimeIsValid: isValid });\n  };\n\n  onTimeShift = (event: FocusEvent<HTMLInputElement>) => {\n    const { options, onChange } = this.props;\n\n    const newValue = emptyToNull(event.target.value);\n    const isValid = timeRangeValidation(newValue);\n\n    if (isValid && options.timeRange?.shift !== newValue) {\n      onChange({\n        ...options,\n        timeRange: {\n          ...(options.timeRange ?? {}),\n          shift: newValue,\n        },\n      });\n    }\n\n    this.setState({ timeShiftIsValid: isValid });\n  };\n\n  onToggleTimeOverride = () => {\n    const { onChange, options } = this.props;\n\n    this.setState({ timeRangeHide: !this.state.timeRangeHide }, () => {\n      onChange({\n        ...options,\n        timeRange: {\n          ...(options.timeRange ?? {}),\n          hide: this.state.timeRangeHide,\n        },\n      });\n    });\n  };\n\n  onCacheTimeoutBlur = (event: ChangeEvent<HTMLInputElement>) => {\n    const { options, onChange } = this.props;\n    onChange({\n      ...options,\n      cacheTimeout: emptyToNull(event.target.value),\n    });\n  };\n\n  onMaxDataPointsBlur = (event: ChangeEvent<HTMLInputElement>) => {\n    const { options, onChange } = this.props;\n\n    let maxDataPoints: number | null = parseInt(event.target.value as string, 10);\n\n    if (isNaN(maxDataPoints) || maxDataPoints === 0) {\n      maxDataPoints = null;\n    }\n\n    if (maxDataPoints !== options.maxDataPoints) {\n      onChange({\n        ...options,\n        maxDataPoints,\n      });\n    }\n  };\n\n  onMinIntervalBlur = (event: ChangeEvent<HTMLInputElement>) => {\n    const { options, onChange } = this.props;\n    const minInterval = emptyToNull(event.target.value);\n    if (minInterval !== options.minInterval) {\n      onChange({\n        ...options,\n        minInterval,\n      });\n    }\n  };\n\n  renderCacheTimeoutOption() {\n    const { dataSource, options } = this.props;\n\n    const tooltip = `If your time series store has a query cache this option can override the default cache timeout. Specify a\n    numeric value in seconds.`;\n\n    if (!dataSource.meta.queryOptions?.cacheTimeout) {\n      return null;\n    }\n\n    return (\n      <div className=\"gf-form-inline\">\n        <div className=\"gf-form\">\n          <InlineFormLabel width={9} tooltip={tooltip}>\n            Cache timeout\n          </InlineFormLabel>\n          <Input\n            type=\"text\"\n            className=\"width-6\"\n            placeholder=\"60\"\n            spellCheck={false}\n            onBlur={this.onCacheTimeoutBlur}\n            defaultValue={options.cacheTimeout ?? ''}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  renderMaxDataPointsOption() {\n    const { data, options } = this.props;\n    const realMd = data.request?.maxDataPoints;\n    const value = options.maxDataPoints ?? '';\n    const isAuto = value === '';\n\n    return (\n      <div className=\"gf-form-inline\">\n        <div className=\"gf-form\">\n          <InlineFormLabel\n            width={9}\n            tooltip={\n              <>\n                The maximum data points per series. Used directly by some data sources and used in calculation of auto\n                interval. With streaming data this value is used for the rolling buffer.\n              </>\n            }\n          >\n            Max data points\n          </InlineFormLabel>\n          <Input\n            type=\"number\"\n            className=\"width-6\"\n            placeholder={`${realMd}`}\n            spellCheck={false}\n            onBlur={this.onMaxDataPointsBlur}\n            defaultValue={value}\n          />\n          {isAuto && (\n            <>\n              <div className=\"gf-form-label query-segment-operator\">=</div>\n              <div className=\"gf-form-label\">Width of panel</div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderIntervalOption() {\n    const { data, dataSource, options } = this.props;\n    const realInterval = data.request?.interval;\n    const minIntervalOnDs = dataSource.interval ?? 'No limit';\n\n    return (\n      <>\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <InlineFormLabel\n              width={9}\n              tooltip={\n                <>\n                  A lower limit for the interval. Recommended to be set to write frequency, for example <code>1m</code>{' '}\n                  if your data is written every minute. Default value can be set in data source settings for most data\n                  sources.\n                </>\n              }\n            >\n              Min interval\n            </InlineFormLabel>\n            <Input\n              type=\"text\"\n              className=\"width-6\"\n              placeholder={`${minIntervalOnDs}`}\n              spellCheck={false}\n              onBlur={this.onMinIntervalBlur}\n              defaultValue={options.minInterval ?? ''}\n            />\n          </div>\n        </div>\n        <div className=\"gf-form-inline\">\n          <div className=\"gf-form\">\n            <InlineFormLabel\n              width={9}\n              tooltip={\n                <>\n                  The evaluated interval that is sent to data source and is used in <code>$__interval</code> and{' '}\n                  <code>$__interval_ms</code>\n                </>\n              }\n            >\n              Interval\n            </InlineFormLabel>\n            <InlineFormLabel width={6}>{realInterval}</InlineFormLabel>\n            <div className=\"gf-form-label query-segment-operator\">=</div>\n            <div className=\"gf-form-label\">Time range / max data points</div>\n          </div>\n        </div>\n      </>\n    );\n  }\n\n  onOpenOptions = () => {\n    this.setState({ isOpen: true });\n  };\n\n  onCloseOptions = () => {\n    this.setState({ isOpen: false });\n  };\n\n  renderCollapsedText(styles: StylesType): React.ReactNode | undefined {\n    const { data, options } = this.props;\n    const { isOpen } = this.state;\n\n    if (isOpen) {\n      return undefined;\n    }\n\n    let mdDesc = options.maxDataPoints ?? '';\n    if (mdDesc === '' && data.request) {\n      mdDesc = `auto = ${data.request.maxDataPoints}`;\n    }\n\n    let intervalDesc = options.minInterval;\n    if (data.request) {\n      intervalDesc = `${data.request.interval}`;\n    }\n\n    return (\n      <>\n        {<div className={styles.collapsedText}>MD = {mdDesc}</div>}\n        {<div className={styles.collapsedText}>Interval = {intervalDesc}</div>}\n      </>\n    );\n  }\n\n  render() {\n    const { timeRangeHide: hideTimeOverride, relativeTimeIsValid, timeShiftIsValid } = this.state;\n    const { timeRangeFrom: relativeTime, timeRangeShift: timeShift, isOpen } = this.state;\n    const styles = getStyles();\n\n    return (\n      <QueryOperationRow\n        id=\"Query options\"\n        index={0}\n        title=\"Query options\"\n        headerElement={this.renderCollapsedText(styles)}\n        isOpen={isOpen}\n        onOpen={this.onOpenOptions}\n        onClose={this.onCloseOptions}\n      >\n        {this.renderMaxDataPointsOption()}\n        {this.renderIntervalOption()}\n        {this.renderCacheTimeoutOption()}\n\n        <div className=\"gf-form\">\n          <InlineFormLabel width={9}>Relative time</InlineFormLabel>\n          <Input\n            type=\"text\"\n            className=\"width-6\"\n            placeholder=\"1h\"\n            onChange={this.onRelativeTimeChange}\n            onBlur={this.onOverrideTime}\n            invalid={!relativeTimeIsValid}\n            value={relativeTime}\n          />\n        </div>\n\n        <div className=\"gf-form\">\n          <span className=\"gf-form-label width-9\">Time shift</span>\n          <Input\n            type=\"text\"\n            className=\"width-6\"\n            placeholder=\"1h\"\n            onChange={this.onTimeShiftChange}\n            onBlur={this.onTimeShift}\n            invalid={!timeShiftIsValid}\n            value={timeShift}\n          />\n        </div>\n        {(timeShift || relativeTime) && (\n          <div className=\"gf-form-inline\">\n            <InlineField label=\"Hide time info\" labelWidth={18}>\n              <Switch value={hideTimeOverride} onChange={this.onToggleTimeOverride} />\n            </InlineField>\n          </div>\n        )}\n      </QueryOperationRow>\n    );\n  }\n}\n\nconst timeRangeValidation = (value: string | null) => {\n  if (!value) {\n    return true;\n  }\n\n  return rangeUtil.isValidTimeSpan(value);\n};\n\nconst emptyToNull = (value: string) => {\n  return value === '' ? null : value;\n};\n\nconst getStyles = stylesFactory(() => {\n  const { theme } = config;\n\n  return {\n    collapsedText: css`\n      margin-left: ${theme.spacing.md};\n      font-size: ${theme.typography.size.sm};\n      color: ${theme.colors.textWeak};\n    `,\n  };\n});\n\ntype StylesType = ReturnType<typeof getStyles>;\n","import { css } from '@emotion/css';\nimport React, { PureComponent } from 'react';\nimport { Unsubscribable } from 'rxjs';\n\nimport {\n  CoreApp,\n  DataQuery,\n  DataSourceApi,\n  DataSourceInstanceSettings,\n  getDefaultTimeRange,\n  LoadingState,\n  PanelData,\n} from '@grafana/data';\nimport { selectors } from '@grafana/e2e-selectors';\nimport { DataSourcePicker, getDataSourceSrv } from '@grafana/runtime';\nimport { Button, CustomScrollbar, HorizontalGroup, InlineFormLabel, Modal, stylesFactory } from '@grafana/ui';\nimport { PluginHelp } from 'app/core/components/PluginHelp/PluginHelp';\nimport config from 'app/core/config';\nimport { backendSrv } from 'app/core/services/backend_srv';\nimport { addQuery } from 'app/core/utils/query';\nimport { dataSource as expressionDatasource } from 'app/features/expressions/ExpressionDatasource';\nimport { DashboardQueryEditor, isSharedDashboardQuery } from 'app/plugins/datasource/dashboard';\nimport { QueryGroupOptions } from 'app/types';\n\nimport { PanelQueryRunner } from '../state/PanelQueryRunner';\nimport { updateQueries } from '../state/updateQueries';\n\nimport { GroupActionComponents } from './QueryActionComponent';\nimport { QueryEditorRows } from './QueryEditorRows';\nimport { QueryGroupOptionsEditor } from './QueryGroupOptions';\n\ninterface Props {\n  queryRunner: PanelQueryRunner;\n  options: QueryGroupOptions;\n  onOpenQueryInspector?: () => void;\n  onRunQueries: () => void;\n  onOptionsChange: (options: QueryGroupOptions) => void;\n}\n\ninterface State {\n  dataSource?: DataSourceApi;\n  dsSettings?: DataSourceInstanceSettings;\n  queries: DataQuery[];\n  helpContent: React.ReactNode;\n  isLoadingHelp: boolean;\n  isPickerOpen: boolean;\n  isAddingMixed: boolean;\n  data: PanelData;\n  isHelpOpen: boolean;\n  defaultDataSource?: DataSourceApi;\n  scrollElement?: HTMLDivElement;\n}\n\nexport class QueryGroup extends PureComponent<Props, State> {\n  backendSrv = backendSrv;\n  dataSourceSrv = getDataSourceSrv();\n  querySubscription: Unsubscribable | null = null;\n\n  state: State = {\n    isLoadingHelp: false,\n    helpContent: null,\n    isPickerOpen: false,\n    isAddingMixed: false,\n    isHelpOpen: false,\n    queries: [],\n    data: {\n      state: LoadingState.NotStarted,\n      series: [],\n      timeRange: getDefaultTimeRange(),\n    },\n  };\n\n  async componentDidMount() {\n    const { queryRunner, options } = this.props;\n\n    this.querySubscription = queryRunner.getData({ withTransforms: false, withFieldConfig: false }).subscribe({\n      next: (data: PanelData) => this.onPanelDataUpdate(data),\n    });\n\n    try {\n      const ds = await this.dataSourceSrv.get(options.dataSource);\n      const dsSettings = this.dataSourceSrv.getInstanceSettings(options.dataSource);\n      const defaultDataSource = await this.dataSourceSrv.get();\n      const datasource = ds.getRef();\n      const queries = options.queries.map((q) => (q.datasource ? q : { ...q, datasource }));\n      this.setState({ queries, dataSource: ds, dsSettings, defaultDataSource });\n    } catch (error) {\n      console.log('failed to load data source', error);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.querySubscription) {\n      this.querySubscription.unsubscribe();\n      this.querySubscription = null;\n    }\n  }\n\n  onPanelDataUpdate(data: PanelData) {\n    this.setState({ data });\n  }\n\n  onChangeDataSource = async (newSettings: DataSourceInstanceSettings) => {\n    const { dsSettings } = this.state;\n    const currentDS = dsSettings ? await getDataSourceSrv().get(dsSettings.uid) : undefined;\n    const nextDS = await getDataSourceSrv().get(newSettings.uid);\n\n    // We need to pass in newSettings.uid as well here as that can be a variable expression and we want to store that in the query model not the current ds variable value\n    const queries = await updateQueries(nextDS, newSettings.uid, this.state.queries, currentDS);\n\n    const dataSource = await this.dataSourceSrv.get(newSettings.name);\n    this.onChange({\n      queries,\n      dataSource: {\n        name: newSettings.name,\n        uid: newSettings.uid,\n        type: newSettings.meta.id,\n        default: newSettings.isDefault,\n      },\n    });\n\n    this.setState({\n      queries,\n      dataSource: dataSource,\n      dsSettings: newSettings,\n    });\n  };\n\n  onAddQueryClick = () => {\n    const { queries } = this.state;\n    this.onQueriesChange(addQuery(queries, this.newQuery()));\n    this.onScrollBottom();\n  };\n\n  newQuery(): Partial<DataQuery> {\n    const { dsSettings, defaultDataSource } = this.state;\n\n    const ds = !dsSettings?.meta.mixed ? dsSettings : defaultDataSource;\n\n    return {\n      ...this.state.dataSource?.getDefaultQuery?.(CoreApp.PanelEditor),\n      datasource: { uid: ds?.uid, type: ds?.type },\n    };\n  }\n\n  onChange(changedProps: Partial<QueryGroupOptions>) {\n    this.props.onOptionsChange({\n      ...this.props.options,\n      ...changedProps,\n    });\n  }\n\n  onAddExpressionClick = () => {\n    this.onQueriesChange(addQuery(this.state.queries, expressionDatasource.newQuery()));\n    this.onScrollBottom();\n  };\n\n  onScrollBottom = () => {\n    setTimeout(() => {\n      if (this.state.scrollElement) {\n        this.state.scrollElement.scrollTo({ top: 10000 });\n      }\n    }, 20);\n  };\n\n  onUpdateAndRun = (options: QueryGroupOptions) => {\n    this.props.onOptionsChange(options);\n    this.props.onRunQueries();\n  };\n\n  renderTopSection(styles: QueriesTabStyles) {\n    const { onOpenQueryInspector, options } = this.props;\n    const { dataSource, data } = this.state;\n\n    return (\n      <div>\n        <div className={styles.dataSourceRow}>\n          <InlineFormLabel htmlFor=\"data-source-picker\" width={'auto'}>\n            Data source\n          </InlineFormLabel>\n          <div className={styles.dataSourceRowItem}>\n            <DataSourcePicker\n              onChange={this.onChangeDataSource}\n              current={options.dataSource}\n              metrics={true}\n              mixed={true}\n              dashboard={true}\n              variables={true}\n            />\n          </div>\n          {dataSource && (\n            <>\n              <div className={styles.dataSourceRowItem}>\n                <Button\n                  variant=\"secondary\"\n                  icon=\"question-circle\"\n                  title=\"Open data source help\"\n                  onClick={this.onOpenHelp}\n                />\n              </div>\n              <div className={styles.dataSourceRowItemOptions}>\n                <QueryGroupOptionsEditor\n                  options={options}\n                  dataSource={dataSource}\n                  data={data}\n                  onChange={this.onUpdateAndRun}\n                />\n              </div>\n              {onOpenQueryInspector && (\n                <div className={styles.dataSourceRowItem}>\n                  <Button\n                    variant=\"secondary\"\n                    onClick={onOpenQueryInspector}\n                    aria-label={selectors.components.QueryTab.queryInspectorButton}\n                  >\n                    Query inspector\n                  </Button>\n                </div>\n              )}\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  onOpenHelp = () => {\n    this.setState({ isHelpOpen: true });\n  };\n\n  onCloseHelp = () => {\n    this.setState({ isHelpOpen: false });\n  };\n\n  renderMixedPicker = () => {\n    return (\n      <DataSourcePicker\n        mixed={false}\n        onChange={this.onAddMixedQuery}\n        current={null}\n        autoFocus={true}\n        variables={true}\n        onBlur={this.onMixedPickerBlur}\n        openMenuOnFocus={true}\n      />\n    );\n  };\n\n  onAddMixedQuery = (datasource: any) => {\n    this.onAddQuery({ datasource: datasource.name });\n    this.setState({ isAddingMixed: false });\n  };\n\n  onMixedPickerBlur = () => {\n    this.setState({ isAddingMixed: false });\n  };\n\n  onAddQuery = (query: Partial<DataQuery>) => {\n    const { dsSettings, queries } = this.state;\n    this.onQueriesChange(addQuery(queries, query, { type: dsSettings?.type, uid: dsSettings?.uid }));\n    this.onScrollBottom();\n  };\n\n  onQueriesChange = (queries: DataQuery[]) => {\n    this.onChange({ queries });\n    this.setState({ queries });\n  };\n\n  renderQueries(dsSettings: DataSourceInstanceSettings) {\n    const { onRunQueries } = this.props;\n    const { data, queries } = this.state;\n\n    if (isSharedDashboardQuery(dsSettings.name)) {\n      return (\n        <DashboardQueryEditor\n          queries={queries}\n          panelData={data}\n          onChange={this.onQueriesChange}\n          onRunQueries={onRunQueries}\n        />\n      );\n    }\n\n    return (\n      <div aria-label={selectors.components.QueryTab.content}>\n        <QueryEditorRows\n          queries={queries}\n          dsSettings={dsSettings}\n          onQueriesChange={this.onQueriesChange}\n          onAddQuery={this.onAddQuery}\n          onRunQueries={onRunQueries}\n          data={data}\n        />\n      </div>\n    );\n  }\n\n  isExpressionsSupported(dsSettings: DataSourceInstanceSettings): boolean {\n    return (dsSettings.meta.alerting || dsSettings.meta.mixed) === true;\n  }\n\n  renderExtraActions() {\n    return GroupActionComponents.getAllExtraRenderAction()\n      .map((action, index) =>\n        action({\n          onAddQuery: this.onAddQuery,\n          onChangeDataSource: this.onChangeDataSource,\n          key: index,\n        })\n      )\n      .filter(Boolean);\n  }\n\n  renderAddQueryRow(dsSettings: DataSourceInstanceSettings, styles: QueriesTabStyles) {\n    const { isAddingMixed } = this.state;\n    const showAddButton = !(isAddingMixed || isSharedDashboardQuery(dsSettings.name));\n\n    return (\n      <HorizontalGroup spacing=\"md\" align=\"flex-start\">\n        {showAddButton && (\n          <Button\n            icon=\"plus\"\n            onClick={this.onAddQueryClick}\n            variant=\"secondary\"\n            aria-label={selectors.components.QueryTab.addQuery}\n          >\n            Query\n          </Button>\n        )}\n        {config.expressionsEnabled && this.isExpressionsSupported(dsSettings) && (\n          <Button\n            icon=\"plus\"\n            onClick={this.onAddExpressionClick}\n            variant=\"secondary\"\n            className={styles.expressionButton}\n          >\n            <span>Expression&nbsp;</span>\n          </Button>\n        )}\n        {this.renderExtraActions()}\n      </HorizontalGroup>\n    );\n  }\n\n  setScrollRef = (scrollElement: HTMLDivElement): void => {\n    this.setState({ scrollElement });\n  };\n\n  render() {\n    const { isHelpOpen, dsSettings } = this.state;\n    const styles = getStyles();\n\n    return (\n      <CustomScrollbar autoHeightMin=\"100%\" scrollRefCallback={this.setScrollRef}>\n        <div className={styles.innerWrapper}>\n          {this.renderTopSection(styles)}\n          {dsSettings && (\n            <>\n              <div className={styles.queriesWrapper}>{this.renderQueries(dsSettings)}</div>\n              {this.renderAddQueryRow(dsSettings, styles)}\n              {isHelpOpen && (\n                <Modal title=\"Data source help\" isOpen={true} onDismiss={this.onCloseHelp}>\n                  <PluginHelp plugin={dsSettings.meta} type=\"query_help\" />\n                </Modal>\n              )}\n            </>\n          )}\n        </div>\n      </CustomScrollbar>\n    );\n  }\n}\n\nconst getStyles = stylesFactory(() => {\n  const { theme } = config;\n\n  return {\n    innerWrapper: css`\n      display: flex;\n      flex-direction: column;\n      padding: ${theme.spacing.md};\n    `,\n    dataSourceRow: css`\n      display: flex;\n      margin-bottom: ${theme.spacing.md};\n    `,\n    dataSourceRowItem: css`\n      margin-right: ${theme.spacing.inlineFormMargin};\n    `,\n    dataSourceRowItemOptions: css`\n      flex-grow: 1;\n      margin-right: ${theme.spacing.inlineFormMargin};\n    `,\n    queriesWrapper: css`\n      padding-bottom: 16px;\n    `,\n    expressionWrapper: css``,\n    expressionButton: css`\n      margin-right: ${theme.spacing.sm};\n    `,\n  };\n});\n\ntype QueriesTabStyles = ReturnType<typeof getStyles>;\n","import { DataQuery, DataSourceApi, hasQueryExportSupport, hasQueryImportSupport } from '@grafana/data';\nimport { isExpressionReference } from '@grafana/runtime/src/utils/DataSourceWithBackend';\n\nexport async function updateQueries(\n  nextDS: DataSourceApi,\n  nextDSUidOrVariableExpression: string,\n  queries: DataQuery[],\n  currentDS?: DataSourceApi\n): Promise<DataQuery[]> {\n  let nextQueries = queries;\n  const datasource = { type: nextDS.type, uid: nextDSUidOrVariableExpression };\n\n  // we are changing data source type\n  if (currentDS?.meta.id !== nextDS.meta.id) {\n    // If changing to mixed do nothing\n    if (nextDS.meta.mixed) {\n      return queries;\n    }\n    // when both data sources support abstract queries\n    else if (hasQueryExportSupport(currentDS) && hasQueryImportSupport(nextDS)) {\n      const abstractQueries = await currentDS.exportToAbstractQueries(queries);\n      nextQueries = await nextDS.importFromAbstractQueries(abstractQueries);\n    }\n    // when datasource supports query import\n    else if (currentDS && nextDS.importQueries) {\n      nextQueries = await nextDS.importQueries(queries, currentDS);\n    }\n    // Otherwise clear queries\n    else {\n      return [{ refId: 'A', datasource }];\n    }\n  }\n\n  if (nextQueries.length === 0) {\n    return [{ refId: 'A', datasource }];\n  }\n\n  // Set data source on all queries except expression queries\n  return nextQueries.map((query) => {\n    if (!isExpressionReference(query.datasource) && !nextDS.meta.mixed) {\n      query.datasource = datasource;\n    }\n    return query;\n  });\n}\n"],"names":["PluginHelp","PureComponent","isError","isLoading","help","plugin","type","this","props","setState","getBackendSrv","get","id","then","response","helpHtml","renderMarkdown","constructPlaceholderInfo","catch","componentDidMount","loadHelp","render","state","className","dangerouslySetInnerHTML","__html","QueryGroupOptionsEditor","constructor","super","event","timeRangeFrom","target","value","timeRangeShift","options","onChange","newValue","emptyToNull","isValid","timeRangeValidation","timeRange","from","relativeTimeIsValid","shift","timeShiftIsValid","timeRangeHide","hide","cacheTimeout","maxDataPoints","parseInt","isNaN","minInterval","isOpen","renderCacheTimeoutOption","dataSource","meta","queryOptions","InlineFormLabel","width","tooltip","Input","placeholder","spellCheck","onBlur","onCacheTimeoutBlur","defaultValue","renderMaxDataPointsOption","data","realMd","request","isAuto","onMaxDataPointsBlur","renderIntervalOption","realInterval","interval","minIntervalOnDs","onMinIntervalBlur","renderCollapsedText","styles","mdDesc","intervalDesc","collapsedText","hideTimeOverride","relativeTime","timeShift","getStyles","QueryOperationRow","index","title","headerElement","onOpen","onOpenOptions","onClose","onCloseOptions","onRelativeTimeChange","onOverrideTime","invalid","onTimeShiftChange","onTimeShift","InlineField","label","labelWidth","Switch","onToggleTimeOverride","rangeUtil","stylesFactory","theme","config","css","spacing","md","typography","size","sm","colors","textWeak","QueryGroup","backendSrv","getDataSourceSrv","isLoadingHelp","helpContent","isPickerOpen","isAddingMixed","isHelpOpen","queries","LoadingState","series","getDefaultTimeRange","async","dsSettings","currentDS","uid","undefined","nextDS","newSettings","nextDSUidOrVariableExpression","nextQueries","datasource","mixed","hasQueryExportSupport","hasQueryImportSupport","abstractQueries","exportToAbstractQueries","importFromAbstractQueries","importQueries","refId","length","map","query","isExpressionReference","updateQueries","dataSourceSrv","name","default","isDefault","onQueriesChange","addQuery","newQuery","onScrollBottom","expressionDatasource","setTimeout","scrollElement","scrollTo","top","onOptionsChange","onRunQueries","DataSourcePicker","onAddMixedQuery","current","autoFocus","variables","onMixedPickerBlur","openMenuOnFocus","onAddQuery","queryRunner","querySubscription","getData","withTransforms","withFieldConfig","subscribe","next","onPanelDataUpdate","ds","getInstanceSettings","defaultDataSource","getRef","q","error","console","log","componentWillUnmount","unsubscribe","getDefaultQuery","CoreApp","changedProps","renderTopSection","onOpenQueryInspector","dataSourceRow","htmlFor","dataSourceRowItem","onChangeDataSource","metrics","dashboard","Button","variant","icon","onClick","onOpenHelp","dataSourceRowItemOptions","onUpdateAndRun","selectors","renderQueries","isSharedDashboardQuery","panelData","QueryEditorRows","isExpressionsSupported","alerting","renderExtraActions","GroupActionComponents","action","key","filter","Boolean","renderAddQueryRow","showAddButton","HorizontalGroup","align","onAddQueryClick","onAddExpressionClick","expressionButton","CustomScrollbar","autoHeightMin","scrollRefCallback","setScrollRef","innerWrapper","queriesWrapper","Modal","onDismiss","onCloseHelp","inlineFormMargin","expressionWrapper"],"sourceRoot":""}