"use strict";var V=[],F=[],T=[],TAGS=[],NPTS={},SUBS=[],BAYS=[],DCRS=[],ANOTS=[],STONS=[],STOFS=[],HAS_ALARMS=0,LIMSUPS=[],LIMINFS=[],INVTAGS={},SVGDoc=null,Color_BackgroundSVG="gray";function LoadImage(e,t){e.setAttributeNS("http://www.w3.org/1999/xlink","href",t)}function sprintf(e){let t=function(e,t,i){let a="";for(let e=0;e<Math.abs(i);e++)a+=t;return i>0?e+a:a+e},i=function(e,i,a,n){let l=function(e,t,i){return t>=0?e.indexOf(" ")>=0?i=" "+i:e.indexOf("+")>=0&&(i="+"+i):i="-"+i,i},r=parseInt(i,10);if("0"==i.charAt(0)){let i=0;return(e.indexOf(" ")>=0||e.indexOf("+")>=0)&&i++,a.length<r-i&&(a=t(a,"0",a.length-(r-i))),l(e,n,a)}return(a=l(e,n,a)).length<r&&(a=e.indexOf("-")<0?t(a," ",a.length-r):t(a," ",r-a.length)),a},a=new Array;a.c=function(e,t,i,a){return"number"==typeof a?String.fromCharCode(a):"string"==typeof a?a.charAt(0):""},a.d=function(e,t,i,n){return a.i(e,t,i,n)},a.u=function(e,t,i,n){return a.i(e,t,i,Math.abs(n))},a.i=function(e,a,n,l){let r=parseInt(n),s=Math.abs(l).toString().split(".")[0];return s.length<r&&(s=t(s," ",r-s.length)),i(e,a,s,l)},a.E=function(e,t,i,n){return a.e(e,t,i,n).toUpperCase()},a.e=function(e,t,a,n){let l=parseInt(a);isNaN(l)&&(l=6);let r=Math.abs(n).toExponential(l);return r.indexOf(".")<0&&e.indexOf("#")>=0&&(r=r.replace(/^(.*)(e.*)$/,"$1.$2")),i(e,t,r,n)},a.f=function(e,t,a,n){let l=parseInt(a);isNaN(l)&&(l=6);let r=Math.abs(n).toFixed(l);return r.indexOf(".")<0&&e.indexOf("#")>=0&&(r+="."),i(e,t,r,n)},a.G=function(e,t,i,n){return a.g(e,t,i,n).toUpperCase()},a.g=function(e,t,a,n){let l=parseInt(a),r=Math.abs(n),s=r.toExponential(),o=r.toFixed(6);if(!isNaN(l)){let e=r.toExponential(l);s=e.length<s.length?e:s;let t=r.toFixed(l);o=t.length<o.length?t:o}s.indexOf(".")<0&&e.indexOf("#")>=0&&(s=s.replace(/^(.*)(e.*)$/,"$1.$2")),o.indexOf(".")<0&&e.indexOf("#")>=0&&(o+=".");let b=s.length<o.length?s:o;return i(e,t,b,n)},a.o=function(e,a,n,l){let r=parseInt(n),s=Math.round(Math.abs(l)).toString(8);return s.length<r&&(s=t(s," ",r-s.length)),e.indexOf("#")>=0&&(s="0"+s),i(e,a,s,l)},a.X=function(e,t,i,n){return a.x(e,t,i,n).toUpperCase()},a.x=function(e,a,n,l){let r=parseInt(n);l=Math.abs(l);let s=Math.round(l).toString(16);return s.length<r&&(s=t(s," ",r-s.length)),e.indexOf("#")>=0&&(s="0x"+s),i(e,a,s,l)},a.s=function(e,t,a,n){let l=parseInt(a),r=n;return r.length>l&&(r=r.substring(0,l)),i(e,t,r,0)};let n=e.split("%"),l=n[0],r=/^([-+ #]*)(\d*)\.?(\d*)([cdieEfFgGosuxX])(.*)$/;for(let e=1;e<n.length;e++){let t=r.exec(n[e]);t&&(null!=arguments[e]&&(l+=a[t[4]](t[1],t[2],t[3],arguments[e])),l+=t[5])}return l}function RemoveAnimate(e){if(null===e)return;let t=0;for(;t<e.childNodes.length;)"animate"==e.childNodes[t].nodeName||"animateTransform"==e.childNodes.nodeName||"animateMotion"==e.childNodes.nodeName?(e.removeChild(e.childNodes[t]),t=0):t++}function Animate(e,t,i){let a,n;for(a in n=document.createElementNS("http://www.w3.org/2000/svg",t),i)i.hasOwnProperty(a)&&n.setAttributeNS(null,a,i[a]);setTimeout((function(){e.appendChild(n),void 0!==n.beginElement&&(n.endElement(),n.beginElement())}),100)}function ShowHideTranslate(e,t,i){let a;t=t||0,i=i||0;const n=document.getElementById("svgdiv").firstElementChild;null!==n&&(a="object"==typeof e?e:n.getElementById(e),null!==a&&("none"===a.style.display?a.style.display="block":a.style.display="none",void 0===a.inittransform&&(a.inittransform=a.getAttributeNS(null,"transform")),null===a.inittransform&&(a.inittransform=""),0==t&&0==i||a.setAttributeNS(null,"transform",a.inittransform+" translate("+parseFloat(t)+" "+parseFloat(i)+")")))}var WebSAGE={RemoveAnimate,Animate,ShowHideTranslate,LoadImage,g_isInkscape:!1,g_blinktimerID:0,g_blinkperiod:1e3,g_blinkcnt:0,g_blinkList:[],g_blinkListAna:[],g_blinkListOld:[],g_blinkListAnaOld:[],g_zpX:0,g_zpY:0,g_zpW:0,g_zpH:0,g_obj_onclick:"{ var pt=parseInt('PONTO'); if (isNaN(pt)) pt=window.NPTS['PONTO']; window.onmouseclick(evt, pt); evt.stopPropagation(); }",g_loadtime:0,g_idprefixes:[],lstpnt:"",InkSage:[],SetIniExtended:function(){},SetExeExtended:function(){},doNothing:function(){},getValue:function(e){return e in V?V[e]:e in NPTS&&NPTS[e]in V?V[NPTS[e]]:0},getFlags:function(e){let t;return e in F?t=F[e]:e in NPTS&&NPTS[e]in F&&(t=F[NPTS[e]]),isNaN(t)?160|(0==WebSAGE.getValue(e)?2:1):t},getInfLim:function(e){return e in LIMINFS?LIMINFS[e]:e in NPTS&&NPTS[e]in LIMINFS?LIMINFS[NPTS[e]]:0},getSupLim:function(e){return e in LIMSUPS?LIMSUPS[e]:e in NPTS&&NPTS[e]in LIMSUPS?LIMSUPS[NPTS[e]]:0},getSubstation:function(e){return e in SUBS?SUBS[e]:e in NPTS&&NPTS[e]in SUBS?SUBS[NPTS[e]]:""},getBay:function(e){return e in BAYS?BAYS[e]:e in NPTS&&NPTS[e]in BAYS?BAYS[NPTS[e]]:""},getDescription:function(e){return e in DCRS?DCRS[e]:e in NPTS&&NPTS[e]in DCRS?DCRS[NPTS[e]]:""},getTime:function(e){return e in T?T[e]:e in NPTS&&NPTS[e]in T?T[NPTS[e]]:0},getTag:function(e){return e in TAGS?TAGS[e]:e in NPTS&&NPTS[e]in TAGS?TAGS[NPTS[e]]:""},tooltipRelac:function(e,t){0==t||99999==t||99989==t||e.hasTooltip||setTimeout((function(){if(e.hasTooltip||e.parentNode.hasTooltip)return;let i=document.createElementNS("http://www.w3.org/2000/svg","title");i.textContent="Tag: "+WebSAGE.getTag(t)+"\nDescr: "+WebSAGE.getDescription(t)+"\n",e.appendChild(i),e.hasTooltip=1}),7e3)},addPointToList:function(e){if(0===(e=e.trim()).indexOf("!ALM")||0===e.indexOf("!TMP")||0===e.indexOf("!ALR")||0===e.indexOf("!ALR")||0===e.indexOf("!TAG")||0===e.indexOf("!DCR")?e=e.substr(4).trim():0===e.indexOf("!SLIM")||0===e.indexOf("!ILIM")||0===e.indexOf("!STON")?e=e.substr(5).trim():0!==e.indexOf("!STOFF")&&0!==e.indexOf("!STVAL")||(e=e.substr(6).trim()),isNaN(e))if(e in NPTS)e=NPTS[e];else if(0===e.indexOf("!")||0===e.indexOf("#")||0===e.indexOf("%"))return 0;return WebSAGE.lstpnt.indexOf(","+e+",")<0&&0!==WebSAGE.lstpnt.indexOf(e+",")&&(WebSAGE.lstpnt=WebSAGE.lstpnt+e+","),e},timerBlink:function(){requestAnimationFrame(WebSAGE.timerBlinkDraw)},timerBlinkDraw:function(){let e,t=.5;if(!(WebSAGE.g_blinkcnt%2)){for(e=0;e<WebSAGE.g_blinkListOld.length;e++)-1===WebSAGE.g_blinkList.indexOf(WebSAGE.g_blinkListOld[e])&&(WebSAGE.g_blinkListOld[e].style.fillOpacity=1);for(e=0;e<WebSAGE.g_blinkListAnaOld.length;e++)-1===WebSAGE.g_blinkListAna.indexOf(WebSAGE.g_blinkListAnaOld[e])&&(WebSAGE.g_blinkListAnaOld[e].style.fillOpacity=1)}for(e=0;e<WebSAGE.g_blinkList.length;e++)WebSAGE.g_blinkcnt%2?(WebSAGE.g_blinkList[e].style.strokeOpacity=t,WebSAGE.g_blinkList[e].style.fillOpacity=t):(WebSAGE.g_blinkList[e].style.strokeOpacity=1,WebSAGE.g_blinkList[e].style.fillOpacity=1);for(e=0;e<WebSAGE.g_blinkListAna.length;e++)WebSAGE.g_blinkcnt%2?(WebSAGE.g_blinkListAna[e].style.strokeOpacity=t,WebSAGE.g_blinkListAna[e].style.fillOpacity=t):(WebSAGE.g_blinkListAna[e].style.strokeOpacity=1,WebSAGE.g_blinkListAna[e].style.fillOpacity=1);WebSAGE.g_blinkListOld=WebSAGE.g_blinkList.slice(),WebSAGE.g_blinkListAnaOld=WebSAGE.g_blinkListAna.slice(),WebSAGE.g_blinkcnt++},processInvalidTagInElement(e,t){INVTAGS.hasOwnProperty(e)||(INVTAGS[e]=0),t&&"collapse"!==t.style.visibility&&(t.style.visibility="collapse")},valueResolveCoded:function(tag,obj){const retnok="????";if(""==tag||void 0===tag)return retnok;let t=parseInt(tag);if(!isNaN(t))return void 0===V[t]?retnok:V[t];if(tag=tag.trim(),void 0!==NPTS[tag]){if(obj&&"collapse"===obj.style.visibility&&(obj.style.visibility="inherit"),void 0!==obj.autoTooltip){let e=obj.getElementsByTagName("title");e.length>0&&(e[0].textContent="TAG: "+tag+"\nKEY: "+NPTS[tag]+"\nVAL: "+V[NPTS[tag]])}return V[NPTS[tag]]}if(obj&&"collapse"===obj.style.visibility&&(obj.style.visibility="inherit"),void 0!==V[tag])return V[tag];if(0==tag.indexOf("#")||0==tag.indexOf("%"))return WebSAGE.g_retnok;let f=WebSAGE.getFlags(t);if(0===tag.indexOf("!SLIM"))return t=tag.substr(5).trim(),isNaN(t)&&(t=NPTS[t]),void 0===LIMSUPS[t]?999999:LIMSUPS[t];if(0===tag.indexOf("!ILIM"))return t=tag.substr(5).trim(),isNaN(t)&&(t=NPTS[t]),void 0===LIMINFS[t]?-999999:LIMINFS[t];if(0===tag.indexOf("!TAG"))return t=tag.substr(4).trim(),isNaN(t)&&(t=NPTS[t]),void 0===TAGS[t]?"":TAGS[t];if(0===tag.indexOf("!DCR"))return t=tag.substr(4).trim(),isNaN(t)&&(t=NPTS[t]),void 0===DCRS[t]?"":DCRS[t];if(0===tag.indexOf("!STON"))return t=tag.substr(5).trim(),isNaN(t)&&(t=NPTS[t]),void 0===STONS[t]?"":STONS[t];if(0===tag.indexOf("!STOFF"))return t=tag.substr(6).trim(),isNaN(t)&&(t=NPTS[t]),void 0===STOFS[t]?"":STOFS[t];if(0===tag.indexOf("!STVAL")){if(t=tag.substr(6).trim(),isNaN(t)&&(t=NPTS[t]),2==(3&f))return STONS[t];if(1==(3&f))return STOFS[t];if(0==(3&f))return"";if(3==(3&f))return""}if(0===tag.indexOf("!ALR"))return t=tag.substr(4).trim(),isNaN(t)&&(t=NPTS[t]),void 0===f?0:256&f?1:0;if(0===tag.indexOf("!ALM"))return t=tag.substr(3).trim(),isNaN(t)&&(t=NPTS[t]),void 0===f?0:2048&f||256&f?1:0;if(0===tag.indexOf("!TMP"))return t=tag.substr(3).trim(),isNaN(t)&&(t=NPTS[t]),getTime(t);if(0===tag.indexOf("!EVAL")){t=tag.substr(5).trim();try{return eval('var thisobj=window.SVGDoc.getElementById("'+obj.id+'"); '+t)}catch(e){return WebSAGE.processInvalidTagInElement(tag,obj),console.log(e),retnok}}return WebSAGE.processInvalidTagInElement(tag,obj),retnok},printCFormat:function(e,t,i){let a=WebSAGE.valueResolveCoded(t,i);if("????"===a)return a;if(void 0!==e&&""!==e||(e=isNaN(parseFloat(a))?"%s":"%1.1f"),e.search(/[udrla][\^▲▼△▽]/)>=0&&(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace("u▲",a>0?"▲":a<0?"▼":" ")).replace("d▼",a>0?"▼":a<0?"▲":" ")).replace("u△",a>0?"△":a<0?"▽":" ")).replace("d▽",a>0?"▽":a<0?"△":" ")).replace("u^",String.fromCharCode(a>=0?8593:8595))).replace("d^",String.fromCharCode(a>=0?8595:8593))).replace("r^",String.fromCharCode(a>=0?8611:8610))).replace("l^",String.fromCharCode(a>=0?8610:8611))).replace("a^",""),a=Math.abs(a)),e.indexOf("%")<0){let t=e.split("`");return t[0]=t[0].replace("~","%"),d3.format(t[0])(a)+(t.length>1?t[1]:"")}return sprintf(e,a)},pegaTagClone:function(e,t){let i,a,n,l,r,s;if(void 0!==t.list){for(i=0;i<t.list.length;i++)if(void 0!==t.list[i].tag&&-1!==t.list[i].tag.indexOf("%")&&"g"===e.parentNode.nodeName)for(a=0;a<WebSAGE.InkSage.length;a++)if(WebSAGE.InkSage[a].parent.id===e.parentNode.id){for(void 0!==e.parentNode.noTrace&&(e.noTrace=e.parentNode.noTrace),n=0;n<WebSAGE.InkSage[a].map.length;n++)l=WebSAGE.InkSage[a].map[n].indexOf("="),r=WebSAGE.InkSage[a].map[n].substring(0,l),s=t.list[i].tag.indexOf("%"),r===t.list[i].tag.substring(s,s+r.length)&&(t.list[i].tag=t.list[i].tag.substring(0,s)+WebSAGE.InkSage[a].map[n].substring(l+1),t.tag=t.list[i].tag,WebSAGE.InkSage[a].tag=t.list[i].tag);break}}else{if(void 0!==t.tag&&-1!==t.tag.indexOf("%")&&"g"===e.parentNode.nodeName)for(void 0!==e.parentNode.noTrace&&(e.noTrace=e.parentNode.noTrace),a=0;a<WebSAGE.InkSage.length;a++)if(WebSAGE.InkSage[a].parent.id===e.parentNode.id){for(n=0;n<WebSAGE.InkSage[a].map.length;n++)l=WebSAGE.InkSage[a].map[n].indexOf("="),r=WebSAGE.InkSage[a].map[n].substring(0,l),s=t.tag.indexOf("%"),r===t.tag.substring(s,s+r.length)&&(t.tag=t.tag.substring(0,s)+WebSAGE.InkSage[a].map[n].substring(l+1)+t.tag.substring(s+r.length),e.temPaiGrupo=1);break}if(void 0!==t.src&&-1!==t.src.indexOf("%")&&"g"===e.parentNode.nodeName)for(void 0!==e.parentNode.noTrace&&(e.noTrace=e.parentNode.noTrace),a=0;a<WebSAGE.InkSage.length;a++)if(WebSAGE.InkSage[a].parent.id===e.parentNode.id){for(n=0;n<WebSAGE.InkSage[a].map.length;n++)l=WebSAGE.InkSage[a].map[n].indexOf("="),r=WebSAGE.InkSage[a].map[n].substring(0,l),s=t.src.indexOf("%"),r===t.src.substring(s,s+r.length)&&(t.tag=t.src.substring(0,s)+WebSAGE.InkSage[a].map[n].substring(l+1)+t.src.substring(s+r.length),t.src=t.tag,e.temPaiGrupo=1);break}if("tooltips"===t.attr)for(i=0;i<t.param.length;i++)if(-1!==t.param[i].indexOf("!EVAL")&&-1!==t.param[i].indexOf("%")&&"g"===e.parentNode.nodeName)for(void 0!==e.parentNode.noTrace&&(e.noTrace=e.parentNode.noTrace),a=0;a<WebSAGE.InkSage.length;a++)if(WebSAGE.InkSage[a].parent.id===e.parentNode.id){for(n=0;n<WebSAGE.InkSage[a].map.length;n++)l=WebSAGE.InkSage[a].map[n].indexOf("="),r=WebSAGE.InkSage[a].map[n].substring(0,l),s=t.param[i].indexOf("%"),r===t.param[i].substring(s,s+r.length)&&(t.param[i]=t.param[i].substring(0,s)+WebSAGE.InkSage[a].map[n].substring(l+1)+t.param[i].substring(s+r.length),e.temPaiGrupo=1);break}}},setGroupDistrib:function(e){let t,i,a,n,l,r;for(t=0;t<e.children.length;t++)t>0&&(void 0===e.children[t].inittransform&&(e.children[t].inittransform=e.children[t].getAttributeNS(null,"transform")),a=e.children[t].getBoundingClientRect(),void 0===e.children[t].lastXlate&&(e.children[t].lastXlate=0),"vertical"===e.groupDistribType?(l=parseFloat(n-a.top+e.groupDistribSpacing)+e.children[t].lastXlate,r=" translate(0 "+l+")"):(l=parseFloat(i-a.left+e.groupDistribSpacing)+e.children[t].lastXlate,r=" translate("+l+" 0)"),e.children[t].setAttributeNS(null,"transform",e.children[t].inittransform+r),e.children[t].lastXlate=l),a=e.children[t].getBoundingClientRect(),i=a.right,n=a.bottom,e.children[t].groupDistrib=1},processInkscapeSAGETags:function(item){let inksage_labeltxt=item.getAttributeNS(null,"inkscape:label")||item.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","label"),lbv,pnt,inksage_labelvec,j,i,t,tspl,src,xsacsrc,arrcores,tooltip,tooltiptext,textNode,clone,nohs,bb,sep,tfm,auxobj,pospfx,aft,arr=[];if(null!==inksage_labeltxt&&""!=inksage_labeltxt&&void 0!==inksage_labeltxt){try{for(;(pospfx=inksage_labeltxt.indexOf("$$#"))>=0;)aft=inksage_labeltxt.substr(pospfx),inksage_labeltxt=inksage_labeltxt.substr(0,pospfx)+WebSAGE.g_idprefixes[parseInt(inksage_labeltxt.substr(pospfx+3))-1]+aft.substr(aft.indexOf("_")+1);inksage_labelvec=JSON.parse("["+inksage_labeltxt+"]")}catch(e){return}for(lbv=0;lbv<inksage_labelvec.length;lbv++){switch(inksage_labelvec[lbv].parent=item,WebSAGE.pegaTagClone(item,inksage_labelvec[lbv]),void 0!==inksage_labelvec[lbv].tag&&(pnt=WebSAGE.addPointToList(inksage_labelvec[lbv].tag),99999!==pnt&&0!==pnt&&void 0===item.blockPopup&&null==item.pontoPopup&&(WebSAGE.tooltipRelac(item,pnt),item.setAttributeNS(null,"onclick",WebSAGE.g_obj_onclick.replace(/PONTO/g,pnt)),null!==item.style&&(item.style.cursor="pointer"))),inksage_labelvec[lbv].attr){case"set":switch(inksage_labelvec[lbv].tag){case"#exec_once":case"#exec":try{eval('var thisobj=window.SVGDoc.getElementById("'+item.id+'"); '+inksage_labelvec[lbv].src)}catch(t){$("#SP_STATUS").text(t.name+": "+t.message+" [8]"),document.getElementById("SP_STATUS").title=t.stack}break;case"#set_filter":"undefined"==typeof xPlain&&""!=inksage_labelvec[lbv].src&&""==document.getElementById("almiframe").src&&(document.getElementById("almiframe").src="almbox.html?SUBST="+inksage_labelvec[lbv].src,document.getElementById("almiframe").style.display="");break;case"#copy_xsac_from":if(""!=inksage_labelvec[lbv].src)for(src=inksage_labelvec[lbv].src.split(","),j=0;j<src.length;j++)auxobj=SVGDoc.getElementById(src[j]),null!==auxobj?(xsacsrc=auxobj.getAttributeNS(null,"inkscape:label")||auxobj.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","label"),""!=xsacsrc&&(item.setAttribute("inkscape:label",xsacsrc),WebSAGE.processInkscapeSAGETags(item))):$("#SP_STATUS").text("Err: 'copy_xsac_from' "+src[j]+" --\x3e "+item.id);break;case"#set_group_distribution":sep=parseFloat(inksage_labelvec[lbv].src),isNaN(sep)?item.groupDistribSpacing=0:item.groupDistribSpacing=sep,"vertical"===inksage_labelvec[lbv].prompt?item.groupDistribType="vertical":item.groupDistribType="horizontal",WebSAGE.setGroupDistrib(item);break;default:WebSAGE.SetIniExtended(inksage_labelvec,lbv,item)}break;case"popup":0===inksage_labelvec[lbv].src.indexOf("preview:")||("block"===inksage_labelvec[lbv].src?(item.setAttributeNS(null,"onclick",null),null!=item.style&&(item.style.cursor=""),item.blockPopup=1,item.noTrace=1):"notrace"===inksage_labelvec[lbv].src?item.noTrace=1:(pnt=WebSAGE.addPointToList(inksage_labelvec[lbv].src),WebSAGE.tooltipRelac(item,pnt),item.setAttributeNS(null,"onclick",WebSAGE.g_obj_onclick.replace(/PONTO/g,pnt)),null===item.style&&void 0!==item.style||(item.style.cursor="pointer"),item.pontoPopup=pnt));break;case"get":inksage_labelvec[lbv].parent.firstElementChild.textContent.indexOf("|")>=0?inksage_labelvec[lbv].txtOFFON=inksage_labelvec[lbv].parent.firstElementChild.textContent.split("|"):(inksage_labelvec[lbv].formatoC=inksage_labelvec[lbv].parent.firstElementChild.textContent,pnt=inksage_labelvec[lbv].tag);break;case"color":for(null!==item.style?(inksage_labelvec[lbv].initfill=item.style.fill,inksage_labelvec[lbv].initstroke=item.style.stroke):(inksage_labelvec[lbv].initfill="",inksage_labelvec[lbv].initstroke=""),j=0;j<inksage_labelvec[lbv].list.length;j++)pnt=WebSAGE.addPointToList(inksage_labelvec[lbv].list[j].tag),inksage_labelvec[lbv].list[j].cscript="",inksage_labelvec[lbv].list[j].cfill="",inksage_labelvec[lbv].list[j].cstroke="",inksage_labelvec[lbv].list[j].cattrib="",inksage_labelvec[lbv].list[j].cattribval="",0===inksage_labelvec[lbv].list[j].param.indexOf("attrib: ")?(arr=inksage_labelvec[lbv].list[j].param.substr(8).split("="),arr.length>1&&(inksage_labelvec[lbv].list[j].cattrib=arr[0],inksage_labelvec[lbv].list[j].cattribval=arr[1])):0===inksage_labelvec[lbv].list[j].param.indexOf("script: ")?inksage_labelvec[lbv].list[j].cscript=inksage_labelvec[lbv].list[j].param.substr(8):(arrcores=[],arrcores=inksage_labelvec[lbv].list[j].param.split("|"),inksage_labelvec[lbv].list[j].cfill=WebSAGE.translateColor(arrcores[0]),arrcores.length>1?inksage_labelvec[lbv].list[j].cstroke=WebSAGE.translateColor(arrcores[1]):inksage_labelvec[lbv].list[j].cstroke=inksage_labelvec[lbv].list[j].cfill),99999!=pnt&&void 0===item.blockPopup&&void 0===item.pontoPopup&&0===j&&(WebSAGE.tooltipRelac(item,pnt),item.setAttributeNS(null,"onclick",WebSAGE.g_obj_onclick.replace(/PONTO/g,pnt)),null!==item.style&&(item.style.cursor="pointer"));break;case"bar":inksage_labelvec[lbv].initheight=item.getAttributeNS(null,"height");break;case"opac":case"text":default:break;case"open":0==inksage_labelvec[lbv].istag?0===inksage_labelvec[lbv].src.indexOf("new:")?(item.style.cursor="pointer",item.setAttributeNS(null,"onclick","window.open( '"+inksage_labelvec[lbv].src.substr(4)+"','','dependent=yes,height="+inksage_labelvec[lbv].height+",width="+inksage_labelvec[lbv].width+",toolbar=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,modal=yes' );")):inksage_labelvec[lbv].src.indexOf("preview:"):"rect"===item.tagName&&(inksage_labelvec[lbv].grafico=document.createElementNS("http://www.w3.org/2000/svg","polyline"),item.parentNode.appendChild(inksage_labelvec[lbv].grafico),inksage_labelvec[lbv].grafico.setAttributeNS(null,"style","fill:none; stroke:white; stroke-width: 2"),tfm=item.getAttributeNS(null,"transform"),null!=tfm&&inksage_labelvec[lbv].grafico.setAttributeNS(null,"transform",tfm),null!=item.style&&(""!=item.style.strokeWidth&&(inksage_labelvec[lbv].grafico.style.strokeWidth=item.style.strokeWidth),""!=item.style.stroke&&(inksage_labelvec[lbv].grafico.style.stroke=item.style.stroke)),tspl=inksage_labelvec[lbv].src.split("|"),inksage_labelvec[lbv].tag=tspl[0],void 0!==tspl[1]&&""!=tspl[1].trim()&&inksage_labelvec[lbv].grafico.setAttributeNS(null,"style",tspl[1]),inksage_labelvec[lbv].valores=[],inksage_labelvec[lbv].datas=[],inksage_labelvec[lbv].bb=item.getBBox(),inksage_labelvec[lbv].bb.left=inksage_labelvec[lbv].bb.x,inksage_labelvec[lbv].bb.right=inksage_labelvec[lbv].bb.x+inksage_labelvec[lbv].bb.width,inksage_labelvec[lbv].bb.top=inksage_labelvec[lbv].bb.y,inksage_labelvec[lbv].bb.bottom=inksage_labelvec[lbv].bb.y+inksage_labelvec[lbv].bb.height,pnt=WebSAGE.addPointToList(inksage_labelvec[lbv].tag),void 0===item.blockPopup&&null==item.pontoPopup&&(WebSAGE.tooltipRelac(item,pnt),item.setAttributeNS(null,"onclick",WebSAGE.g_obj_onclick.replace(/PONTO/g,pnt)),null!=item.style&&(item.style.cursor="pointer")));break;case"rotate":null===item.getAttributeNS(null,"transform")?inksage_labelvec[lbv].inittransform="":inksage_labelvec[lbv].inittransform=item.getAttributeNS(null,"transform");break;case"tooltips":for(tooltiptext="",j=0;j<inksage_labelvec[lbv].param.length;j++)j>0&&(tooltiptext+="\n"),tooltiptext+=inksage_labelvec[lbv].param[j];tooltip=document.createElementNS("http://www.w3.org/2000/svg","title"),textNode=document.createTextNode(tooltiptext),tooltip.appendChild(textNode),item.appendChild(tooltip),item.hasTooltip=1,-1!==tooltiptext.indexOf("!EVAL")&&(inksage_labelvec[lbv].hasActiveTooltip=1,inksage_labelvec[lbv].tooltipTitle=tooltip,inksage_labelvec[lbv].tooltipText=tooltiptext);break;case"slider":for(null===item.getAttributeNS(null,"transform")?inksage_labelvec[lbv].inittransform="":inksage_labelvec[lbv].inittransform=item.getAttributeNS(null,"transform"),inksage_labelvec[lbv].min=parseFloat(inksage_labelvec[lbv].min),inksage_labelvec[lbv].max=parseFloat(inksage_labelvec[lbv].max),clone=void 0,nohs=SVGDoc.getElementsByTagName("use"),i=0;i<nohs.length;i++)if(nohs.item(i).getAttributeNS("http://www.w3.org/1999/xlink","href")=="#"+item.getAttributeNS(null,"id")){clone=nohs.item(i),inksage_labelvec[lbv].clone=clone;break}if(null!=clone){clone.style.display="none";let a=clone.getAttributeNS(null,"transform"),n=a.indexOf("("),l=a.indexOf(",");-1===l&&(l=a.indexOf(" "));let r=a.indexOf(")");-1==l&&(l=r),inksage_labelvec[lbv].rangex=parseFloat(a.substring(n+1,l))||0,inksage_labelvec[lbv].rangey=parseFloat(a.substring(l+1,r))||0}break;case"zoom":bb=item.getBoundingClientRect(),item.setAttributeNS(null,"onclick"," window.WebSAGE.g_zpX = "+bb.left+";window.WebSAGE.g_zpY = "+bb.top+";window.WebSAGE.g_zpW = "+2*bb.width+";window.WebSAGE.g_zpH = "+2*bb.height+";window.WebSAGE.zoomPan(10);evt.currentTarget.style.display='none';");break;case"script":for(i=0;i<inksage_labelvec[lbv].list.length;i++)switch(inksage_labelvec[lbv].list[i].evt){case"mouseup":case"mousedown":case"mouseover":case"mouseout":case"mousemove":case"keydown":item.setAttributeNS(null,"on"+inksage_labelvec[lbv].list[i].evt,"thisobj=evt.currentTarget;"+inksage_labelvec[lbv].list[i].param),inksage_labelvec[lbv].list[i].evt.indexOf("mouse")>=0&&void 0===item.blockPopup&&null!==item.style&&(item.style.cursor="pointer");break;case"exec_once":try{function evalprot(src){var lbv=null,i=null;return eval(src)}evalprot('var thisobj=document.getElementById("'+item.id+'"); '+inksage_labelvec[lbv].list[i].param)}catch(s){$("#SP_STATUS").text(s.name+": "+s.message+" [8]"),document.getElementById("SP_STATUS").title=s.stack}break;case"exec_on_update":break;case"vega":case"vega-lite":case"vega4":inksage_labelvec[lbv].tag="#"+inksage_labelvec[lbv].list[i].evt,inksage_labelvec[lbv].src=inksage_labelvec[lbv].list[i].param.split("\n")[0],inksage_labelvec[lbv].prompt=inksage_labelvec[lbv].list[i].param.substring(inksage_labelvec[lbv].list[i].param.indexOf("\n")+1),WebSAGE.SetIniExtended(inksage_labelvec,lbv,item);break;case"vega-json":case"vega4-json":inksage_labelvec[lbv].tag="#"+inksage_labelvec[lbv].list[i].evt,inksage_labelvec[lbv].prompt=inksage_labelvec[lbv].list[i].param,WebSAGE.SetIniExtended(inksage_labelvec,lbv,item)}break;case"clone":if("map"in inksage_labelvec[lbv]&&inksage_labelvec[lbv].map.length>0){let o=inksage_labelvec[lbv].map[0].split("=");pnt=WebSAGE.addPointToList(o[1]),0!==pnt&&(item.setAttributeNS(null,"onclick",WebSAGE.g_obj_onclick.replace(/PONTO/g,pnt)),null===item.style&&void 0!==item.style||(item.style.cursor="pointer"),item.pontoPopup=pnt)}}WebSAGE.InkSage.push(inksage_labelvec[lbv])}}},preprocessSVGDisplay:function(){if(null===SVGDoc)return;let e,t,i=SVGDoc.getElementsByTagName("g");for(e=0;e<i.length;e++)WebSAGE.processInkscapeSAGETags(i.item(e));i=SVGDoc.getElementsByTagName("text");try{for(e=0;e<i.length;e++)WebSAGE.processInkscapeSAGETags(i.item(e))}catch(e){$("#SP_STATUS").text("Error! [4]"),document.getElementById("SP_STATUS").title=e.stack}for(i=[],t=SVGDoc.getElementsByTagName("rect"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("ellipse"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("path"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("image"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("circle"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("line"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("polyline"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("polygon"),e=0;e<t.length;e++)i.push(t.item(e));for(t=SVGDoc.getElementsByTagName("use"),e=0;e<t.length;e++)i.push(t.item(e));for(e=0;e<i.length;e++)if("g"!==i[e].nodeName&&"text"!==i[e].nodeName)try{WebSAGE.processInkscapeSAGETags(i[e])}catch(t){$("#SP_STATUS").text("Error! [5]"),document.getElementById("SP_STATUS").title="Obj ID="+i[e].id+" "+t.stack}},blinkAlarmed:function(e,t){let i=WebSAGE.getFlags(e);if(!(256&i)){let e=WebSAGE.g_blinkList.indexOf(t);return t.style.fillOpacity=1,t.style.strokeOpacity=1,-1!==e&&WebSAGE.g_blinkList.splice(e,1),e=WebSAGE.g_blinkListOld.indexOf(t),-1!==e&&WebSAGE.g_blinkListOld.splice(e,1),e=WebSAGE.g_blinkListAna.indexOf(t),-1!==e&&WebSAGE.g_blinkListAna.splice(e,1),e=WebSAGE.g_blinkListAnaOld.indexOf(t),void(-1!==e&&WebSAGE.g_blinkListAnaOld.splice(e,1))}0==(32&i)?-1===WebSAGE.g_blinkList.indexOf(t)&&WebSAGE.g_blinkList.push(t):-1===WebSAGE.g_blinkListAna.indexOf(t)&&WebSAGE.g_blinkListAna.push(t)},showValsSVG:function(){document.hidden||!requestAnimationFrame?WebSAGE.drawSVG():requestAnimationFrame(WebSAGE.drawSVG)},drawSVG:function(){try{SVGDoc=document.getElementById("svgdiv").children[0]}catch(e){return void console.log("Unsupported browser!")}let fill,stroke,attrib,attribval,bb,ft,i,j,digital,val,tag,vt,ch;for(i=0;i<WebSAGE.InkSage.length;i++)if(void 0===WebSAGE.InkSage[i].xdone&&(null!=WebSAGE.InkSage[i].tag&&(tag=WebSAGE.InkSage[i].tag,vt=WebSAGE.valueResolveCoded(tag,WebSAGE.InkSage[i].parent)),"????"!=vt||"color"===WebSAGE.InkSage[i].attr||"set"===WebSAGE.InkSage[i].attr||"script"===WebSAGE.InkSage[i].attr))switch(WebSAGE.InkSage[i].attr){case"set":if("#exec_on_update"===WebSAGE.InkSage[i].tag)try{eval('var thisobj=window.SVGDoc.getElementById("'+WebSAGE.InkSage[i].parent.id+'"); '+WebSAGE.InkSage[i].src)}catch(t){$("#SP_STATUS").text(t.name+": "+t.message+" [8]"),document.getElementById("SP_STATUS").title=t.stack}else WebSAGE.SetExeExtended(i);break;case"open":if(1==WebSAGE.InkSage[i].istag&&"rect"===WebSAGE.InkSage[i].parent.tagName){let a,n,l,r,s="",o=new Date;if(WebSAGE.InkSage[i].hasOwnProperty("valores")&&void 0===WebSAGE.InkSage[i].valores[tag]&&(WebSAGE.InkSage[i].valores[tag]=[],WebSAGE.InkSage[i].datas[tag]=[]),WebSAGE.InkSage[i].hasOwnProperty("valores")&&void 0!==WebSAGE.InkSage[i].valores[tag]&&WebSAGE.InkSage[i].valores[tag].length>0&&vt==WebSAGE.InkSage[i].valores[tag][WebSAGE.InkSage[i].valores[tag].length-1]&&(o.getTime()-WebSAGE.InkSage[i].datas[WebSAGE.InkSage[i].datas[tag].length-1])/1e3<30)break;if(WebSAGE.InkSage[i].hasOwnProperty("valores")&&void 0!==WebSAGE.InkSage[i].valores[tag]){if(WebSAGE.InkSage[i].valores[tag].push(vt),WebSAGE.InkSage[i].datas[tag].push(o.getTime()),bb=WebSAGE.InkSage[i].bb,WebSAGE.InkSage[i].width>0)for(a=WebSAGE.InkSage[i].valores[tag].length-1;a>=0;a--){let b=(o.getTime()-WebSAGE.InkSage[i].datas[tag][a])/1e3;b>Math.abs(WebSAGE.InkSage[i].width)?(WebSAGE.InkSage[i].valores[tag].splice(a,1),WebSAGE.InkSage[i].datas[tag].splice(a,1)):(n=bb.right-parseFloat(b/Math.abs(WebSAGE.InkSage[i].width)*bb.width),l=bb.bottom-parseFloat((WebSAGE.InkSage[i].valores[tag][a]-WebSAGE.InkSage[i].y)/WebSAGE.InkSage[i].height*bb.height),l>bb.bottom&&(l=bb.bottom),l<bb.top&&(l=bb.top),r=0===a?"":",",s=s+n.toFixed(3)+" "+l.toFixed(3)+r)}else for(a=WebSAGE.InkSage[i].valores[tag].length-1;a>=0;a--){let g=(WebSAGE.InkSage[i].datas[tag][a]-WebSAGE.InkSage[i].dataini)/1e3;if(WebSAGE.InkSage[i].datas[tag][a]>WebSAGE.InkSage[i].datafim){WebSAGE.InkSage[i].valores[tag]=[],WebSAGE.InkSage[i].datas[tag]=[];let S=new Date;WebSAGE.InkSage[i].dataini=S.getTime()-S.getTime()%(1e3*Math.abs(WebSAGE.InkSage[i].width))+60*S.getTimezoneOffset()*1e3%(1e3*Math.abs(WebSAGE.InkSage[i].width)),WebSAGE.InkSage[i].datafim=WebSAGE.InkSage[i].dataini+Math.abs(1e3*WebSAGE.InkSage[i].width)}else n=bb.left+parseFloat(g/Math.abs(WebSAGE.InkSage[i].width)*bb.width),l=bb.bottom-parseFloat((WebSAGE.InkSage[i].valores[tag][a]-WebSAGE.InkSage[i].y)/WebSAGE.InkSage[i].height*bb.height),l>bb.bottom&&(l=bb.bottom),l<bb.top&&(l=bb.top),r=0===a?"":",",s=s+n.toFixed(3)+" "+l.toFixed(3)+r}","===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),WebSAGE.InkSage[i].grafico.setAttributeNS(null,"points",s)}}break;case"get":val=void 0!==WebSAGE.InkSage[i].txtOFFON?0===WebSAGE.valueResolveCoded(tag,WebSAGE.InkSage[i].parent)?WebSAGE.InkSage[i].txtOFFON[1]:WebSAGE.InkSage[i].txtOFFON[0]:WebSAGE.printCFormat(WebSAGE.InkSage[i].formatoC,tag,WebSAGE.InkSage[i].parent),val!=WebSAGE.InkSage[i].parent.firstElementChild.textContent&&(WebSAGE.InkSage[i].parent.firstElementChild.textContent=val,WebSAGE.InkSage[i].parent.groupDistrib&&WebSAGE.setGroupDistrib(WebSAGE.InkSage[i].parent.parentNode),WebSAGE.InkSage[i].lastVal=WebSAGE.getValue(tag)),WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"color":let script="";for(fill="",stroke="",attrib="",attribval="",tag="",vt=0,j=0;j<WebSAGE.InkSage[i].list.length;j++)if(tag!==WebSAGE.InkSage[i].list[j].tag&&(tag=WebSAGE.InkSage[i].list[j].tag,vt=WebSAGE.valueResolveCoded(tag,WebSAGE.InkSage[i].parent)),ft=void 0===WebSAGE.getFlags(tag)?"????"===vt?160:32:WebSAGE.getFlags(tag),digital=0==(32&ft),"????"!==vt){if(ch=WebSAGE.InkSage[i].list[j].data,digital)val=parseInt(ch),(!isNaN(val)&&(3&ft)>=val||!isNaN(val)&&(131&ft)>=(128|val)||"a"===ch&&256&ft||"f"===ch&&128&ft)&&(fill=WebSAGE.InkSage[i].list[j].cfill,stroke=WebSAGE.InkSage[i].list[j].cstroke,script=WebSAGE.InkSage[i].list[j].cscript,attrib=WebSAGE.InkSage[i].list[j].cattrib,attribval=WebSAGE.InkSage[i].list[j].cattribval);else if(val=parseFloat(ch),"n"===ch&&2048&ft||"c"===ch&&4096&ft||"a"===ch&&256&ft||"f"===ch&&128&ft||!isNaN(val)&&vt>=val){let c,p,d;void 0!==WebSAGE.InkSage[i].list[j+1]?(c=WebSAGE.InkSage[i].list[j+1].cfill,"@"===c[0]?(c=c.substring(1),p=WebSAGE.InkSage[i].list[j].cfill,"@"===p[0]&&(p=p.substring(1)),d=parseFloat(WebSAGE.InkSage[i].list[j+1].data),fill=chroma.mix(p,c,(vt-val)/(d-val),"hsl").toString()):fill=WebSAGE.InkSage[i].list[j].cfill,c=WebSAGE.InkSage[i].list[j+1].cstroke,"@"===c[0]?(c=c.substring(1),p=WebSAGE.InkSage[i].list[j].cstroke,"@"===p[0]&&(p=p.substring(1)),d=parseFloat(WebSAGE.InkSage[i].list[j+1].data),stroke=chroma.mix(p,c,(vt-val)/(d-val),"hsl").toString()):stroke=WebSAGE.InkSage[i].list[j].cstroke):(fill=WebSAGE.InkSage[i].list[j].cfill,"@"===fill[0]&&(fill=fill.substring(1)),stroke=WebSAGE.InkSage[i].list[j].cstroke,"@"===stroke[0]&&(stroke=stroke.substring(1))),script=WebSAGE.InkSage[i].list[j].cscript,attrib=WebSAGE.InkSage[i].list[j].cattrib,attribval=WebSAGE.InkSage[i].list[j].cattribval}WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent)}if(void 0!==WebSAGE.InkSage[i].parent.temAnimacao&&WebSAGE.InkSage[i].parent.temAnimacao&&RemoveAnimate(WebSAGE.InkSage[i].parent),""!==attrib)WebSAGE.InkSage[i].parent.setAttributeNS(null,attrib,attribval);else if(""!==script){WebSAGE.InkSage[i].parent.temAnimacao=1,WebSAGE.InkSage[i].parent.style.fill=WebSAGE.InkSage[i].initfill,WebSAGE.InkSage[i].parent.style.stroke=WebSAGE.InkSage[i].initstroke;try{eval('var thisobj=window.SVGDoc.getElementById("'+WebSAGE.InkSage[i].parent.id+'"); '+script)}catch(k){$("#SP_STATUS").text(k.name+": "+k.message+" [7]"),document.getElementById("SP_STATUS").title=k.stack}}else WebSAGE.InkSage[i].parent.style.fill=""!==fill?fill:WebSAGE.InkSage[i].initfill,WebSAGE.InkSage[i].parent.style.stroke=""!==stroke?stroke:WebSAGE.InkSage[i].initstroke;WebSAGE.InkSage[i].parent.groupDistrib&&WebSAGE.setGroupDistrib(WebSAGE.InkSage[i].parent.parentNode),99999==tag&&(WebSAGE.InkSage[i].xdone=1);break;case"bar":let heigth=WebSAGE.InkSage[i].initheight*(vt-WebSAGE.InkSage[i].min)/(WebSAGE.InkSage[i].max-WebSAGE.InkSage[i].min);heigth<0&&(heigth=0),heigth>WebSAGE.InkSage[i].initheight&&(heigth=WebSAGE.InkSage[i].initheight),WebSAGE.InkSage[i].parent.setAttributeNS(null,"height",heigth),WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"opac":let opac=1;WebSAGE.InkSage[i].max===WebSAGE.InkSage[i].min?opac=1:(opac=(vt-WebSAGE.InkSage[i].min)/(WebSAGE.InkSage[i].max-WebSAGE.InkSage[i].min),opac<0&&(opac=0),opac>1&&(opac=1)),isNaN(opac)&&(opac=1),WebSAGE.InkSage[i].parent.style.opacity=opac,WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"rotate":bb=WebSAGE.InkSage[i].parent.getBBox();let tcx=parseFloat(WebSAGE.InkSage[i].parent.getAttributeNS(null,"inkscape:transform-center-x")||WebSAGE.InkSage[i].parent.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","transform-center-x")),tcy=parseFloat(WebSAGE.InkSage[i].parent.getAttributeNS(null,"inkscape:transform-center-y")||WebSAGE.InkSage[i].parent.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","transform-center-y"));isNaN(tcx)&&(tcx=0),isNaN(tcy)&&(tcy=0);let xcen=bb.x+bb.width/2+tcx,ycen=bb.y+bb.height/2-tcy,ang=(vt-WebSAGE.InkSage[i].min)/(WebSAGE.InkSage[i].max-WebSAGE.InkSage[i].min)*360;WebSAGE.InkSage[i].parent.setAttributeNS(null,"transform",WebSAGE.InkSage[i].inittransform+" rotate("+ang+" "+xcen+" "+ycen+") "),WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"tooltips":if(void 0!==WebSAGE.InkSage[i].hasActiveTooltip&&1===WebSAGE.InkSage[i].hasActiveTooltip){let pini,pend,ev,tc;tc=WebSAGE.InkSage[i].tooltipText;do{pini=tc.indexOf("!EVAL",0),pend=tc.indexOf("!END",1),-1===pend&&(pend=9999999),-1!==pini&&(ev=eval(tc.substring(pini+5,pend)),isNaN(Number(ev))||(ev=sprintf("%1.3f",ev)),tc=tc.substring(0,pini)+ev+tc.substring(pend+4))}while(-1!==pini);WebSAGE.InkSage[i].tooltipTitle.textContent=tc}break;case"slider":vt>WebSAGE.InkSage[i].max&&(vt=WebSAGE.InkSage[i].max),vt<WebSAGE.InkSage[i].min&&(vt=WebSAGE.InkSage[i].min);let proporcao=(vt-WebSAGE.InkSage[i].min)/(WebSAGE.InkSage[i].max-WebSAGE.InkSage[i].min);WebSAGE.InkSage[i].parent.setAttributeNS(null,"transform",WebSAGE.InkSage[i].inittransform+" translate("+proporcao*WebSAGE.InkSage[i].rangex+" "+proporcao*WebSAGE.InkSage[i].rangey+") "),WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"text":ft=void 0===WebSAGE.getFlags(tag)?vt:WebSAGE.getFlags(tag),digital=0==(32&ft);let txt="";for(j=0;j<WebSAGE.InkSage[i].map.length;j++){let A=WebSAGE.InkSage[i].map[j].indexOf("=");ch=WebSAGE.InkSage[i].map[j].substring(0,1),digital?(val=parseInt(WebSAGE.InkSage[i].map[j].substring(0,A)),((3&ft)>=val||(131&ft)>=(128|val)||"a"===ch&&256&ft||"f"===ch&&128&ft)&&(txt=WebSAGE.InkSage[i].map[j].substring(A+1))):(val=parseFloat(WebSAGE.InkSage[i].map[j].substring(0,A)),(vt>=val||"a"===ch&&256&ft||"f"===ch&&128&ft)&&(txt=WebSAGE.InkSage[i].map[j].substring(A+1)))}txt!=WebSAGE.InkSage[i].parent.textContent&&(WebSAGE.InkSage[i].parent.firstChild&&"tspan"===WebSAGE.InkSage[i].parent.firstChild.tagName?WebSAGE.InkSage[i].parent.firstChild.textContent=txt:WebSAGE.InkSage[i].parent.textContent=txt),WebSAGE.blinkAlarmed(tag,WebSAGE.InkSage[i].parent);break;case"clone":default:break;case"script":for(j=0;j<WebSAGE.InkSage[i].list.length;j++)switch(WebSAGE.InkSage[i].list[j].evt){case"exec_on_update":try{function evalprot(src){var i,j,val,vt,mudou_dig,mudou_ana=null;return eval(src)}evalprot('var thisobj=document.getElementById("'+WebSAGE.InkSage[i].parent.id+'"); '+WebSAGE.InkSage[i].list[j].param)}catch(u){$("#SP_STATUS").text(u.name+": "+u.message+" [8]"),document.getElementById("SP_STATUS").title=u.stack}break;case"vega":case"vega-lite":case"vega-json":case"vega4":case"vega4-json":WebSAGE.SetExeExtended(i)}}0==document.getElementById("svgdiv").style.opacity&&(document.getElementById("svgdiv").style.opacity=1)},zoomPan:function(e,t,i){if(null===SVGDoc)return;let a,n,l,r;switch(void 0===t&&(t=1),e){case 12:a=SVGDoc.createSVGPoint(),a.x=i.clientX,a.y=i.clientY,n=a.matrixTransform(SVGDoc.getScreenCTM().inverse()),WebSAGE.g_zpW=.95*WebSAGE.g_zpW,WebSAGE.g_zpH=.95*WebSAGE.g_zpH,l=WebSAGE.g_zpW/.95,r=WebSAGE.g_zpH/.95,WebSAGE.g_zpX=WebSAGE.g_zpX+(l-WebSAGE.g_zpW)*((n.x-WebSAGE.g_zpX)/WebSAGE.g_zpW)-2.5,WebSAGE.g_zpY=WebSAGE.g_zpY+(r-WebSAGE.g_zpH)*((n.y-WebSAGE.g_zpY)/WebSAGE.g_zpH)-1.5;break;case 18:a=SVGDoc.createSVGPoint(),a.x=i.clientX,a.y=i.clientY,n=a.matrixTransform(SVGDoc.getScreenCTM().inverse()),WebSAGE.g_zpW=1.05*WebSAGE.g_zpW,WebSAGE.g_zpH=1.05*WebSAGE.g_zpH,l=WebSAGE.g_zpW/1.05,r=WebSAGE.g_zpH/1.05,WebSAGE.g_zpX=WebSAGE.g_zpX+(l-WebSAGE.g_zpW)*((n.x-WebSAGE.g_zpX)/WebSAGE.g_zpW)-2.5,WebSAGE.g_zpY=WebSAGE.g_zpY+(r-WebSAGE.g_zpH)*((n.y-WebSAGE.g_zpY)/WebSAGE.g_zpH)-1.5;break;case 0:case 2:WebSAGE.g_zpW=.9*WebSAGE.g_zpW,WebSAGE.g_zpH=.9*WebSAGE.g_zpH,WebSAGE.g_zpX=WebSAGE.g_zpX+1;break;case 1:WebSAGE.g_zpY=WebSAGE.g_zpY+20*t*WebSAGE.g_zpW/ScreenViewer_SVGMaxWidth;break;case 3:WebSAGE.g_zpX=WebSAGE.g_zpX+30*t*WebSAGE.g_zpW/ScreenViewer_SVGMaxWidth;break;case 4:WebSAGE.g_zpX=0,WebSAGE.g_zpY=0,WebSAGE.g_zpW=ScreenViewer_SVGMaxWidth,WebSAGE.g_zpH=ScreenViewer_SVGMaxHeight;break;case 5:WebSAGE.g_zpX=WebSAGE.g_zpX-30*t*WebSAGE.g_zpW/ScreenViewer_SVGMaxWidth;break;case 6:case 8:WebSAGE.g_zpW=1.1*WebSAGE.g_zpW,WebSAGE.g_zpH=1.1*WebSAGE.g_zpH,WebSAGE.g_zpX=WebSAGE.g_zpX+1;break;case 7:WebSAGE.g_zpY=WebSAGE.g_zpY-20*t*WebSAGE.g_zpW/ScreenViewer_SVGMaxWidth;break;case 9:WebSAGE.g_zpW=1.3*WebSAGE.g_zpW,WebSAGE.g_zpH=1.3*WebSAGE.g_zpH,WebSAGE.g_zpX=WebSAGE.g_zpX+1}SVGDoc.setAttributeNS(null,"viewBox",WebSAGE.g_zpX+" "+WebSAGE.g_zpY+" "+WebSAGE.g_zpW+" "+WebSAGE.g_zpH)},setBgColor:function(e){if("none"==e){const t=SVGDoc.getElementById("base");if(!t)return;Color_BackgroundSVG=e=t.attributes.pagecolor.value}SVGDoc.setAttributeNS(null,"style","background-color: "+e+";"),$("#svgdiv").css("background-color",e),document.body.bgColor=e},translateColor:function(e){let t;if("-cor-"==e.substr(0,5)||"-clr-"==e.substr(0,5)||"-pbi-"==e.substr(0,5))switch(e){case"-pbi-background":e=PBIColorBackground;break;case"-pbi-foreground":e=PBIColorForeground;break;case"-pbi-bad":case"-pbi-good":e=PBIColorBad;break;case"-pbi-maximum":e=PBIColorMaximum;break;case"-pbi-minimum":e=PBIColorMinimum;break;case"-pbi-selected":e=PBIColorSelected;break;case"-pbi-negative":e=PBIColorNegative;break;case"-pbi-positive":e=PBIColorPositive;break;case"-clr-background":case"-clr-bgd":case"-cor-bgd":e=Color_BackgroundSVG;break;case"-clr-tbr":case"-cor-tbr":e=ScreenViewer_ToolbarColor;break;case"-clr-almini":case"-cor-almini":e=VisorTelas_CorAlarmeInibido;break;case"-clr-failed":case"-cor-medfal":e=VisorTelas_Medidas_Cor_Falha;break;default:"-pbi-"==e.substr(0,5)?(t=parseInt(e.substr(5,3),10),isNaN(t)?e="none":(t=t>0?t-1:0,e=PBIColorTable[t])):(t=parseInt(e.substr(5,3),10),e=isNaN(t)?"none":ScreenViewer_ColorTable[t])}return e},makeDraggable:function(e){e&&(e.style.cursor="crosshair",e.drgDragging=!1,e.drgX=0,e.drgY=0,void 0===e.inittransform&&(e.inittransform=e.getAttributeNS(null,"transform")),null===e.inittransform&&(e.inittransform=""),$(e).bind("mousedown",(function(t){if("none"==e.style.display)return e.style.cursor="crosshair",e.drgDragging=!1,e.drgMouseOffsetX=0,e.drgMouseOffsetY=0,void(window.drgObject=null);e.style.cursor="move",e.drgDragging=!0,window.drgObject=e;let i=SVGDoc.createSVGPoint();i.x=t.clientX,i.y=t.clientY,e.drgMouseOffsetX=i.x-e.drgX,e.drgMouseOffsetY=i.y-e.drgY})),$(e).bind("mouseup",(function(t){e.style.cursor="crosshair",e.drgDragging=!1,e.drgMouseOffsetX=0,e.drgMouseOffsetY=0,window.drgObject=null})),$(e).bind("mousemove",(function(t){if(!0===e.drgDragging){let i=SVGDoc.createSVGPoint();i.x=t.clientX,i.y=t.clientY;let a=e.parentNode.getScreenCTM();i.x-=e.drgMouseOffsetX,i.y-=e.drgMouseOffsetY,window.MOUSEX=t.clientX,window.MOUSEY=t.clientY,e.drgX=i.x,e.drgY=i.y,a.e=a.f=0,i=i.matrixTransform(a.inverse()),e.setAttributeNS(null,"transform","translate("+i.x+","+i.y+") "+e.inittransform),t.stopPropagation()}})))},init:function(){WebSAGE.g_loadtime=new Date;try{if(null==(SVGDoc=document.getElementById("svgdiv").children[0])&&""!==tela)return;WebSAGE.g_isInkscape=""!=(SVGDoc.getAttributeNS(null,"inkscape:version")||SVGDoc.getAttributeNS("http://www.inkscape.org/namespaces/inkscape","version")),WebSAGE.g_isInkscape&&(Color_BackgroundSVG=ScreenViewer_Background),null!=SVGDoc&&WebSAGE.setBgColor(Color_BackgroundSVG)}catch(e){}WebSAGE.g_blinktimerID=setInterval(WebSAGE.timerBlink,WebSAGE.g_blinkperiod),document.oncontextmenu=function(){return!1},$("html > head").append("<style> body { user-select:none; -webkit-user-select:none; } </style>"),void 0!==SVGDoc&&null!=SVGDoc&&(SVGDoc.oncontextmenu=function(){return!1}),document.body.style.overflowX="hidden",document.body.style.overflowY="hidden",void 0!==SVGDoc&&null!=SVGDoc&&(SVGDoc.setAttributeNS(null,"width",ScreenViewer_SVGMaxWidth),SVGDoc.setAttributeNS(null,"height",ScreenViewer_SVGMaxHeight),SVGDoc.onselectstart=new Function("return false;")),WebSAGE.g_zpW=ScreenViewer_SVGMaxWidth,WebSAGE.g_zpH=ScreenViewer_SVGMaxHeight;try{WebSAGE.preprocessSVGDisplay()}catch(e){$("#SP_STATUS").text("Error! [0]"),document.getElementById("SP_STATUS").title=e.stack}$(SVGDoc).bind("mousewheel wheel DOMMouseScroll",(function(e){!1===window.wheelBlock&&(e.originalEvent.wheelDelta>0||e.originalEvent.detail<0||e.originalEvent.deltaY<0?WebSAGE.zoomPan(!0===window.wheelDirBackOut?12:18,null,e.originalEvent):WebSAGE.zoomPan(!0===window.wheelDirBackOut?18:12,null,e.originalEvent),window.wheelBlockEventPropagation&&e.stopPropagation())})),$(SVGDoc).bind("mousedown",(function(e){(e.originalEvent.isTrusted||80!==e.clientX||20!==e.clientY)&&(window.MOUSEX=e.clientX,window.MOUSEY=e.clientY,window.SVGDoc.style.cursor="move")})),$(SVGDoc).bind("mouseup",(function(e){(e.originalEvent.isTrusted||80!==e.clientX||20!==e.clientY)&&(window.SVGDoc.style.cursor="default",void 0===window.drgBlock&&(window.MOUSEX>e.clientX?window.WebSAGE.zoomPan(3,(window.MOUSEX-e.clientX)/30):window.WebSAGE.zoomPan(5,(e.clientX-window.MOUSEX)/30),window.MOUSEY>e.clientY?window.WebSAGE.zoomPan(1,(window.MOUSEY-e.clientY)/20):window.WebSAGE.zoomPan(7,(e.clientY-window.MOUSEY)/20),window.drgObject&&(window.drgObject.drgDragging=!1,window.drgObject.drgMouseOffsetX=0,window.drgObject.drgMouseOffsetY=0,window.drgObject=null)))}))}},$V=WebSAGE.getValue,$F=WebSAGE.getFlags,$T=WebSAGE.getTime,$W=WebSAGE;