<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">
  <Product Id="*" Name="openHistorian" Language="1033" Version="!(bind.FileVersion.openHistorian.exe)" Manufacturer="Grid Protection Alliance" UpgradeCode="{B34DA7F9-23D9-4573-9348-1414B653341E}">
    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />

    <MediaTemplate EmbedCab="yes" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <PropertyRef Id='WIXNETFX4RELEASEINSTALLED'/>
    <Condition Message='This setup requires Microsoft .NET Framework 4.8 or greater - this will need to be installed before installation can continue.'>
      <![CDATA[Installed OR (WIXNETFX4RELEASEINSTALLED >= "#528040")]]>
    </Condition>

    <!-- Restore last installation folder -->
    <Property Id="INSTALLFOLDER">
      <RegistrySearch Id="InstallFolderRegSearch" Root="HKLM" Key="SOFTWARE\Grid Protection Alliance\openHistorian" Name="InstallPath" Type="raw" />
    </Property>

    <Feature Id="AllProducts" Title="All Products" Level="1" Display="expand" ConfigurableDirectory="INSTALLFOLDER">
      <!-- openHistorian -->
      <Feature Id="openHistorianFeature" Title="openHistorian" Description="Installs the openHistorian Windows service application along with any needed dependencies.">
        <ComponentGroupRef Id="openHistorianComponents" />
        <ComponentGroupRef Id="AdapterComponents" />
        <ComponentGroupRef Id="BouncyCastleDependencyComponents" />
        <ComponentGroupRef Id="ConfigurationSetupUtilityComponents" />
        <ComponentGroupRef Id="GSFDependencyComponents" />
        <ComponentGroupRef Id="MicrosoftDependencyComponents" />
        <ComponentGroupRef Id="AzureADDependencyComponents" />
        <ComponentGroupRef Id="MySQLScriptComponents" />
        <ComponentGroupRef Id="OracleScriptComponents" />
        <ComponentGroupRef Id="PostgresScriptComponents" />
        <ComponentGroupRef Id="SQLServerScriptComponents" />
        <ComponentGroupRef Id="SQLiteScriptComponents" />
        <ComponentRef Id="makecert"/>

        <!-- Web Files -->
        <?include WebFeatures.wxi ?>

        <!-- Grafana -->
        <?include GrafanaFeatures.wxi ?>

        <!-- EE Files -->
        <?include EEFeatures.wxi ?>
      </Feature>

      <!-- openHistorian Manager -->
      <Feature Id="openHistorianManagerFeature" Title="openHistorian Manager" Description="Installs the openHistorian Manager Windows application along with any needed dependencies.">
        <ComponentGroupRef Id="openHistorianManagerComponents" />
        <ComponentGroupRef Id="AdapterComponents" />
        <ComponentGroupRef Id="ConfigurationSetupUtilityComponents" />
        <ComponentGroupRef Id="GSFDependencyComponents" />
        <ComponentGroupRef Id="MicrosoftDependencyComponents" />
        <ComponentGroupRef Id="AzureADDependencyComponents" />
        <ComponentRef Id="makecert"/>
      </Feature>

      <!-- openHistorian Console -->
      <Feature Id="openHistorianConsoleFeature" Title="openHistorian Console" Description="Installs the openHistorian remote console application along with any needed dependencies.">
        <ComponentGroupRef Id="openHistorianConsoleComponents" />
        <ComponentGroupRef Id="GSFDependencyComponents" />
        <ComponentGroupRef Id="AzureADDependencyComponents" />
      </Feature>

      <!-- openHistorian Tools -->
      <Feature Id="openHistorianToolsFeature" Title="Tools" Description="Installs the openHistorian support applications and tools along with any needed dependencies.">
        <Feature Id="ConfigCrypterFeature" Title="Config Crypter" Description="The Config Crypter tool is used to encrypt text strings for use in XML-based configuration files, as well as import and export local cipher keys.">
          <ComponentGroupRef Id="ConfigCrypterComponents" />
        </Feature>
        <Feature Id="ConfigurationEditorFeature" Title="XML Configuration Editor" Description="The XML Configuration Editor is used to modify XML-based application configuration files, i.e., files suffixed with '.exe.Config'.">
          <ComponentGroupRef Id="ConfigurationEditorComponents" />
        </Feature>
        <Feature Id="CSVDataManagerFeature" Title="CSV Data Manager" Description="The CSV Data Manager tool is used for bulk database operations and is used to allow CSV based I/O for update and delete operations associated with a target database.">
          <ComponentGroupRef Id="CSVDataManagerComponents" />
        </Feature>
        <Feature Id="StatisticViewFeature" Title="Statistics Trending Tool" Description="The Statistics Trending Tool is used to trend and export archived diagnostic statistics over a provided time range.">
          <ComponentGroupRef Id="StatisticViewComponents" />
        </Feature>
        <Feature Id="HistorianViewFeature" Title="Historian View Utility" Description="The Historian View Utility is used to trend archived openHistorian time-series data over a provided time range.">
          <ComponentGroupRef Id="HistorianViewComponents" />
        </Feature>
        <Feature Id="LogFileViewerFeature" Title="Log File Viewer" Description="The Log File Viewer tool is used to examine and filter logged diagnostics data and perform detailed analysis and filtering of log information.">
          <ComponentGroupRef Id="LogFileViewerComponents" />
        </Feature>
        <Feature Id="ArchiveUpgradeUtilityFeature" Title="Archive Upgrade Utility" Description="The Archive Upgrade Utility is used to convert version 1.0 openHistorian files into the new 2.0 file format.">
          <ComponentGroupRef Id="ArchiveUpgradeUtilityComponents" />
        </Feature>
        <Feature Id="DNP3ConfigGeneratorFeature" Title="DNP3 Configuration Generator" Description="The DNP3 Configuration Generator is a console tool to create a sample DNP3 configuration files and extract any needed DNP3 adapter dependencies.">
          <ComponentRef Id="DNP3ConfigGenerator" />
        </Feature>
        <Feature Id="CreateOutputStreamFeature" Title="Create Output Stream Tool" Description="The Create Output Stream Tool is a console tool to create an IEEE C37.118 output stream from a source CSV file.">
          <ComponentRef Id="CreateOutputStream"/>
        </Feature>
        <Feature Id="UpdateCOMTRADECountersFeature" Title="Update COMTRADE Counters Utility" Description="The Update COMTRADE Counters Utility allows for web-based exports of COMTRADE Combined File Format (CFF) files to update counts post download.">
          <ComponentRef Id="UpdateCOMTRADECounters"/>
        </Feature>
        <Feature Id="ArchiveComparisonUtilityFeature" Title="Archive Comparison Utility" Description="The Archive Comparison tool is used to compare two separate openHistorian archives and produce a report of differences.">
          <ComponentGroupRef Id="ArchiveComparisonUtilityComponents" />
        </Feature>
        <Feature Id="DataExtractionUtilityFeature" Title="Data Extraction Utility" Description="The Data Extraction Utility is a simple openHistorian to CSV export utility that exports data based on signal type selections.">
          <ComponentGroupRef Id="DataExtractionUtilityComponents" />
        </Feature>
        <Feature Id="GEPDataExtractorFeature" Title="GEP Data Extractor" Description="The Gateway Exchange Protocol (GEP) Data Extraction Utility is used to export selected signals from a given time-range to CSV files.">
          <ComponentGroupRef Id="GEPDataExtractorComponents" />
        </Feature>
        <Feature Id="UpdateTagNamesFeature" Title="Update Tag Names Tool" Description="The Update Point Tag Name tool is used update the point tag naming expression used to automate naming of measurement points tags in time-series databases.">
          <ComponentGroupRef Id="UpdateTagNamesComponents" />
        </Feature>
        <Feature Id="openVisNFeature" Title="openVisN" Description="The openVision application is a visualization and analysis tool for the openHistorian that display parallel data charts over a provided time window.">
          <ComponentGroupRef Id="openVisNComponents" />
        </Feature>
        <Feature Id="NoInetFixUtilFeature" Title="No-Internet Fix Utility" Description="The No-Internet File Utility tool is used to update a system that does not have access to an Internet connection.">
          <ComponentRef Id="NoInetFixUtil" />
        </Feature>

        <ComponentGroupRef Id="GSFDependencyComponents" />
      </Feature>

      <!-- openHistorian Optional Features -->
      <Feature Id="openHistorianOptionalFeatures" Title="Optional Components" Description="Allows installation of optional openHistorian components that are not required for common deployments." Level="2">
        <!-- eDNA Adapter Components -->
        <Feature Id="eDNAAdapterFeature" Title="eDNA Historian Adapter" Description="Installs the eDNA Historian time-series library output adapter and associated eDNA API dependencies">
          <ComponentGroupRef Id="eDNAAdapterComponents" />
        </Feature>
      </Feature>

      <ComponentRef Id="InstallFolderPermissions"/>
      <ComponentRef Id="Registry" />
      <ComponentRef Id="Cleanup" />
    </Feature>

    <!-- User Interface -->
    <UI>
      <UIRef Id="CustomFeatureTree" />
      <UIRef Id="WixUI_ErrorProgressText" />
      <DialogRef Id="CompanyInfoDialog" />
      <DialogRef Id="ServiceAccountDialog" />
      <Publish Dialog="CustomizeDlg" Control="Next" Event="NewDialog" Value="ServiceAccountDialog"><![CDATA[&openHistorianFeature=3]]></Publish>
      <Publish Dialog="CustomizeDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg"><![CDATA[NOT(&openHistorianFeature=3)]]></Publish>
      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="CompanyInfoDialog">(NOT Installed OR WixUI_InstallMode = "Change") AND <![CDATA[&openHistorianFeature=3]]></Publish>
      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="CustomizeDlg">(NOT Installed OR WixUI_InstallMode = "Change") AND <![CDATA[NOT(&openHistorianFeature=3)]]></Publish>
      <Publish Dialog="CustomExitDialog" Control="Finish" Event="DoAction" Value="StartCSUProcessAction">WIXUI_CUSTOMEXITDIALOGOPTIONALCHECKBOX = 1</Publish>
    </UI>

    <Icon Id="openHistorian.ico.exe" SourceFile="$(var.openHistorian.TargetPath)" />
    <Icon Id="openHistorianManager.ico.exe" SourceFile="$(var.openHistorianManager.TargetPath)" />
    <Icon Id="openHistorianWebManager.ico.exe" SourceFile="$(var.SolutionDir)Applications\openHistorian\openHistorian\wwwroot\Images\Icons\openHistorianWebManager.ico" />
    <Icon Id="openHistorianConsole.ico.exe" SourceFile="$(var.openHistorianConsole.TargetPath)" />
    <Icon Id="ConfigurationSetupUtility.ico.exe" SourceFile="$(var.ConfigurationSetupUtility.TargetPath)" />
    <Icon Id="DataMigrationUtility.ico.exe" SourceFile="$(var.ProjectDir)\DataMigrationUtility.exe" />
    <Icon Id="ConfigCrypter.ico.exe" SourceFile="$(var.ProjectDir)\ConfigCrypter.exe" />
    <Icon Id="ConfigurationEditor.ico.exe" SourceFile="$(var.ProjectDir)\ConfigurationEditor.exe" />
    <Icon Id="CSVDataManager.ico.exe" SourceFile="$(var.ProjectDir)\CSVDataManager.exe" />
    <Icon Id="StatisticView.ico.exe" SourceFile="$(var.ProjectDir)\HistorianView.exe" />
    <Icon Id="HistorianView.ico.exe" SourceFile="$(var.HistorianView.TargetPath)" />
    <Icon Id="openVisN.ico.exe" SourceFile="$(var.openVisN.TargetPath)" />
    <Icon Id="LogFileViewer.ico.exe" SourceFile="$(var.ProjectDir)\LogFileViewer.exe" />
    <Icon Id="ArchiveUpgradeUtility.ico.exe" SourceFile="$(var.MigrationUtility.TargetPath)" />
    <Icon Id="ArchiveComparisonUtility.ico.exe" SourceFile="$(var.ComparisonUtility.TargetPath)" />
    <Icon Id="NoInetFixUtil.ico.exe" SourceFile="$(var.ProjectDir)\NoInetFixUtil.exe" />

    <Property Id="SERVICENAME" Value="$(var.openHistorian.TargetName)" />
    <Property Id="SERVICEPASSWORD" Hidden="yes" />
    <Property Id="HTTPSERVICEPORTS" Value="8180,8185,6055,6056,6155,6156,6356,5020" />
    <Property Id="COMPANYNAME" Value="Grid Protection Alliance" />
    <Property Id="COMPANYACRONYM" Value="GPA" />
    <Property Id="SYSTEMNAME" Value=" " />
    <Property Id="REGSERVICEACCOUNT">
      <RegistrySearch Id="ServiceAccountRegSearch" Root="HKLM" Key="SYSTEM\CurrentControlSet\Services\[SERVICENAME]" Name="ObjectName" Type="raw" />
    </Property>
    <Property Id="REGSERVICESTARTVALUE">
      <RegistrySearch Id="ServiceStartRegSearch" Root="HKLM" Key="SYSTEM\CurrentControlSet\Services\[SERVICENAME]" Name="Start" Type="raw" />
    </Property>
    <SetProperty Action="SetServiceStartDefault" Id="SERVICESTART" After="AppSearch" Value="#2" Sequence="first"><![CDATA[NOT REGSERVICESTARTVALUE]]></SetProperty>
    <SetProperty Action="SetServiceStartRegistry" Id="SERVICESTART" After="AppSearch" Value="[REGSERVICESTARTVALUE]" Sequence="first"><![CDATA[REGSERVICESTARTVALUE]]></SetProperty>
    <SetProperty Action="SetServiceAccountDefault" Id="SERVICEACCOUNT" After="AppSearch" Value="NT SERVICE\[SERVICENAME]" Sequence="first"><![CDATA[NOT REGSERVICEACCOUNT]]></SetProperty>
    <SetProperty Action="SetServiceAccountRegistry" Id="SERVICEACCOUNT" After="AppSearch" Value="[REGSERVICEACCOUNT]" Sequence="first"><![CDATA[REGSERVICEACCOUNT]]></SetProperty>
    <SetProperty Id="PROCESSSTARTINFO" Value="FileName={[#ConfigurationSetupUtility.exe]};Arguments=-install;UseShellExecute=True;Verb=runas" After="ExecuteAction" Sequence="ui" />
    <SetProperty Id="WEBMANAGERURL" Value="http://localhost:8180/" Before="CreateShortcuts" Sequence="execute" />
    <WixVariable Id="WixUIBannerBmp" Value="$(var.ProjectDir)\openHistorianSetupBanner.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="$(var.ProjectDir)\openHistorianSetupDialog.bmp" />
    <WixVariable Id="WixUILicenseRtf" Value="$(var.ProjectDir)\INSTALL_LICENSE.rtf" />

    <!-- Add/Remove Programs Icon -->
    <Property Id="ARPPRODUCTICON" Value="openHistorian.ico.exe" />

    <!-- Display checkbox to select whether to launch the CSU -->
    <SetProperty Id="WIXUI_CUSTOMEXITDIALOGOPTIONALCHECKBOX" Value="1" After="ExecuteAction" Sequence="ui">(NOT Installed OR WixUI_InstallMode = "Change") AND ($ConfigurationSetupUtility=3 OR (?ConfigurationSetupUtility=3 AND $ConfigurationSetupUtility=-1))</SetProperty>
    <SetProperty Id="WIXUI_CUSTOMEXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch Configuration Setup Utility" After="ExecuteAction" Sequence="ui">(NOT Installed OR WixUI_InstallMode = "Change") AND ($ConfigurationSetupUtility=3 OR (?ConfigurationSetupUtility=3 AND $ConfigurationSetupUtility=-1))</SetProperty>

    <!-- Custom Actions -->
    <Binary Id="InstallerActions" SourceFile="$(var.SolutionDir)\Dependencies\GSF\GSF.InstallerActions.CA.dll" />
    <CustomAction Id="AuthenticateServiceAccountAction" BinaryKey="InstallerActions" DllEntry="AuthenticateServiceAccountAction" Execute="immediate" />
    <CustomAction Id="LoadExistingCompanyInfoAction" BinaryKey="InstallerActions" DllEntry="LoadExistingCompanyInfoAction" Execute="immediate" />
    <CustomAction Id="StartCSUProcessAction" BinaryKey="InstallerActions" DllEntry="StartProcessAction" Execute="immediate" />
    <CustomAction Id="CompanyInfoAction.SetProperty" Property="CompanyInfoAction" Value="SERVICENAME=[SERVICENAME];INSTALLDIR=[INSTALLFOLDER];COMPANYNAME=[COMPANYNAME];COMPANYACRONYM=[COMPANYACRONYM];SYSTEMNAME=[SYSTEMNAME]" />
    <CustomAction Id="CompanyInfoAction" BinaryKey="InstallerActions" DllEntry="CompanyInfoAction" Execute="deferred" Impersonate="no" />
    <CustomAction Id="ConfigureServiceAction.SetProperty" Property="ConfigureServiceAction" Value="SERVICENAME=[SERVICENAME]" />
    <CustomAction Id="ConfigureServiceAction" BinaryKey="InstallerActions" DllEntry="ConfigureServiceAction" Execute="deferred" Impersonate="no" />
    <CustomAction Id="ServiceAccountAction.SetProperty" Property="ServiceAccountAction" Value="SERVICENAME=[SERVICENAME];SERVICEACCOUNT=[SERVICEACCOUNT];HTTPSERVICEPORTS=[HTTPSERVICEPORTS]" />
    <CustomAction Id="ServiceAccountAction" BinaryKey="InstallerActions" DllEntry="ServiceAccountAction" Execute="deferred" Impersonate="no" />

    <UI>
      <ProgressText Action="ConfigureServiceAction">Configuring service failure recovery operations...</ProgressText>
      <ProgressText Action="ServiceAccountAction">Applying minimum needed permissions for service user...</ProgressText>
      <ProgressText Action="NetFxExecuteNativeImageInstall">Generating optimized native images for installation, this will take some time...</ProgressText>
    </UI>

    <InstallExecuteSequence>
      <Custom Action="CompanyInfoAction.SetProperty" After="InstallFiles">NOT REMOVE AND <![CDATA[&openHistorianFeature=3]]></Custom>
      <Custom Action="CompanyInfoAction" After="CompanyInfoAction.SetProperty">NOT REMOVE AND <![CDATA[&openHistorianFeature=3]]></Custom>
      <Custom Action="ConfigureServiceAction.SetProperty" After="InstallServices">NOT REMOVE AND <![CDATA[&openHistorianFeature=3]]></Custom>
      <Custom Action="ConfigureServiceAction" After="ConfigureServiceAction.SetProperty">NOT REMOVE AND <![CDATA[&openHistorianFeature=3]]></Custom>
      <Custom Action="ServiceAccountAction.SetProperty" After="ConfigureServiceAction">NOT REMOVE</Custom>
      <Custom Action="ServiceAccountAction" After="ServiceAccountAction.SetProperty">NOT REMOVE</Custom>
      <Custom Action="NetFxExecuteNativeImageCommitInstall" After="NetFxExecuteNativeImageUninstall">0</Custom>
      <Custom Action="NetFxExecuteNativeImageInstall" After="NetFxExecuteNativeImageCommitInstall" />
      <!-- Set write registry values sequence after service install but before service start to restore original service start mode -->
      <WriteRegistryValues Sequence="5850" />
    </InstallExecuteSequence>
  </Product>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <?if $(var.Platform) = x64 ?>
      <Directory Id="ProgramFiles64Folder">
        <!-- C:\Program Files\openHistorian -->
        <Directory Id="INSTALLFOLDER" Name="openHistorian">
          <Component Id="InstallFolderPermissions" Guid="{F54F753D-C6A6-45D4-B9AA-E9B20CD68FA1}">
            <CreateFolder>
              <util:PermissionEx User="[SERVICENAME] Admins" CreateFile="yes" CreateChild="yes" GenericRead="yes" GenericWrite="yes" GenericExecute="yes" Delete="yes" DeleteChild="yes" />
            </CreateFolder>
          </Component>

          <Directory Id="UTILITIESFOLDER" Name="Utilities" />
          <Directory Id="SQLCLRFOLDER" Name="SqlClr" />

          <Directory Id="DATABASESCRIPTSFOLDER" Name="Database Scripts">
            <Directory Id="MYSQLSCRIPTSFOLDER" Name="MySQL" />
            <Directory Id="ORACLESCRIPTSFOLDER" Name="Oracle" />
            <Directory Id="POSTGRESSCRIPTSFOLDER" Name="PostgreSQL" />
            <Directory Id="SQLSERVERSCRIPTSFOLDER" Name="SQL Server" />
            <Directory Id="SQLITESCRIPTSFOLDER" Name="SQLite" />
          </Directory>

          <?include WebFolders.wxi ?>

          <?include GrafanaFolders.wxi ?>
          
          <Directory Id="OPTIONALINSTALLSFOLDER" Name="Installers" />
        </Directory>
      </Directory>
      <?else ?>
      <Directory Id="ProgramFilesFolder">
        <!-- C:\Program Files (x86)\openHistorian -->
        <Directory Id="INSTALLFOLDER" Name="openHistorian">
          <Component Id="InstallFolderPermissions" Guid="{F54F753D-C6A6-45D4-B9AA-E9B20CD68FA1}">
            <CreateFolder>
              <util:PermissionEx User="[SERVICENAME] Admins" CreateFile="yes" CreateChild="yes" GenericRead="yes" GenericWrite="yes" GenericExecute="yes" Delete="yes" DeleteChild="yes" />
            </CreateFolder>
          </Component>

          <Directory Id="UTILITIESFOLDER" Name="Utilities" />
          <Directory Id="SQLCLRFOLDER" Name="SqlClr" />

          <Directory Id="DATABASESCRIPTSFOLDER" Name="Database Scripts">
            <Directory Id="MYSQLSCRIPTSFOLDER" Name="MySQL" />
            <Directory Id="ORACLESCRIPTSFOLDER" Name="Oracle" />
            <Directory Id="POSTGRESSCRIPTSFOLDER" Name="PostgreSQL" />
            <Directory Id="SQLSERVERSCRIPTSFOLDER" Name="SQL Server" />
            <Directory Id="SQLITESCRIPTSFOLDER" Name="SQLite" />
          </Directory>

          <?include WebFolders.wxi ?>
          
          <?include GrafanaFolders.wxi ?>

          <Directory Id="OPTIONALINSTALLSFOLDER" Name="Installers" />
        </Directory>
      </Directory>
      <?endif ?>

      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="openHistorian" />
      </Directory>
    </Directory>
  </Fragment>

  <Fragment>
    <?include WebFiles.wxi ?>
  </Fragment>

  <Fragment>
    <?include GrafanaFiles.wxi ?>
  </Fragment>

  <Fragment>
    <?include EEFiles.wxi ?>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="OptionalInstallsFiles" Directory="OPTIONALINSTALLSFOLDER">
      <Component Id="PMUConnectionTesterSetup">
        <File Id="PMUConnectionTesterSetup" Name="PMUConnectionTesterSetup.msi" Source="$(var.SolutionDir)Applications\openHistorian\openHistorian\Installers\PMUConnectionTesterSetup.msi" />
      </Component>
      <Component Id="PMUConnectionTesterVersion">
        <File Id="PMUConnectionTesterVersion" Name="PMUConnectionTesterVersion.txt" Source="$(var.SolutionDir)Applications\openHistorian\openHistorian\Installers\PMUConnectionTesterVersion.txt" />
      </Component>
      <Component Id="StreamSplitterSetup">
        <File Id="StreamSplitterSetup" Name="StreamSplitterSetup.msi" Source="$(var.SolutionDir)Applications\openHistorian\openHistorian\Installers\StreamSplitterSetup.msi" />
      </Component>
      <Component Id="StreamSplitterVersion">
        <File Id="StreamSplitterVersion" Name="StreamSplitterVersion.txt" Source="$(var.SolutionDir)Applications\openHistorian\openHistorian\Installers\StreamSplitterVersion.txt" />
      </Component>
    </ComponentGroup>
  </Fragment>
  
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">
      <!-- Applications -->
      <ComponentGroupRef Id="openHistorianComponents" />
      <ComponentGroupRef Id="openHistorianManagerComponents" />
      <ComponentGroupRef Id="openHistorianConsoleComponents" />
      <ComponentGroupRef Id="openHistorianToolsComponents" />

      <!-- Libraries -->
      <ComponentGroupRef Id="AdapterComponents" />
      <ComponentGroupRef Id="GSFDependencyComponents" />
      <ComponentGroupRef Id="MicrosoftDependencyComponents" />
      <ComponentGroupRef Id="AzureADDependencyComponents" />

      <!-- Database Scripts -->
      <ComponentGroupRef Id="MySQLScriptComponents" />
      <ComponentGroupRef Id="OracleScriptComponents" />
      <ComponentGroupRef Id="PostgresScriptComponents" />
      <ComponentGroupRef Id="SQLServerScriptComponents" />
      <ComponentGroupRef Id="SQLiteScriptComponents" />

      <!-- Makecert -->
      <Component Id="makecert">
        <File Id="makecert.exe" Name="makecert.exe" Source="$(var.ProjectDir)\makecert.exe" />
      </Component>

      <!-- Registry Settings -->
      <Component Id="Registry" Guid="{F74C123C-C923-4B04-813B-05E81397C764}">
        <RegistryKey Id="REG_GridProtectionAlliance" Root="HKLM" Key="SOFTWARE\Grid Protection Alliance" ForceCreateOnInstall="yes">
          <RegistryKey Id="REG_GridProtectionAlliance.openHistorian" Key="openHistorian" ForceCreateOnInstall="yes">
            <RegistryValue Id="REG_GridProtectionAlliance.openHistorian.InstallPath" Name="InstallPath" Value="[INSTALLFOLDER]" Type="string" />
            <RegistryValue Id="REG_GridProtectionAlliance.openHistorian.Revision" Name="Revision" Value="[ProductVersion]" Type="string" />
            <RegistryValue Id="REG_GridProtectionAlliance.openHistorian.TargetBitSize" Name="TargetBitSize" Value="64bit" Type="string" />
          </RegistryKey>
        </RegistryKey>
        <RegistryKey Id="REG_ServiceParams" Root="HKLM" Key="SYSTEM\CurrentControlSet\Services\[SERVICENAME]" ForceCreateOnInstall="yes">
          <RegistryValue Id="REG_ServiceParams.Start" Name="Start" Value="[SERVICESTART]" Type="string" />
        </RegistryKey>
      </Component>

      <!-- Cleanup -->
      <Component Id="Cleanup" Guid="{C8EBB158-C708-4C94-87C1-F5DBC77D7BDE}">
        <CreateFolder />
        <RemoveFolder Id="RemoveMySQLScriptsFolder" Directory="MYSQLSCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveOracleScriptsFolder" Directory="ORACLESCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemovePostgresScriptsFolder" Directory="POSTGRESSCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveSQLServerScriptsFolder" Directory="SQLSERVERSCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveSQLiteScriptsFolder" Directory="SQLITESCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveDatabaseScriptsFolder" Directory="DATABASESCRIPTSFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveSqlClrFolder" Directory="SQLCLRFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveUtilitiesFolder" Directory="UTILITIESFOLDER" On="uninstall" />
        <RemoveFolder Id="RemoveApplicationProgramsFolder" Directory="ApplicationProgramsFolder" On="uninstall" />
        <RemoveFolder Id="RemoveInstallFolder" Directory="INSTALLFOLDER" On="uninstall" />
      </Component>
    </ComponentGroup>

    <!-- openHistorian -->
    <ComponentGroup Id="openHistorianComponents" Directory="INSTALLFOLDER">
      <Component Id="openHistorian">
        <File Id="openHistorian.exe" Name="$(var.openHistorian.TargetFileName)" Source="$(var.openHistorian.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <ServiceInstall Id="openHistorianService" Name="openHistorian" Account="[SERVICEACCOUNT]" Password="[SERVICEPASSWORD]" Type="ownProcess" Start="auto" ErrorControl="normal" Description="Provides archive management and routing services for streaming time-series data in real-time for process applications." />
        <ServiceControl Id="openHistorianServiceControl" Name="openHistorian" Stop="both" Remove="uninstall" />
      </Component>
      <Component Id="openHistorianConfig" Permanent="yes">
        <File Id="openHistorian.exe.config" Name="$(var.openHistorian.TargetFileName).config" Source="$(var.openHistorian.TargetPath).config" />
      </Component>
      <Component Id="DataMigrationUtility">
        <File Id="DataMigrationUtility.exe" Name="DataMigrationUtility.exe" Source="$(var.ProjectDir)\DataMigrationUtility.exe">
          <netfx:NativeImage Id="ngen_DataMigrationUtility.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="DataMigrationUtilityStartMenuShortcut" Name="Data Migration Utility" Icon="DataMigrationUtility.ico.exe" Description="Tool used to migrate data from an old configuration database to the latest version." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="DataMigrationUtilityConfig">
        <File Id="DataMigrationUtility.exe.config" Name="DataMigrationUtility.exe.config" Source="$(var.ProjectDir)\DataMigrationUtility.exe.config" />
      </Component>
      <Component Id="StatHistorianReportGenerator">
        <File Id="StatHistorianReportGenerator.exe" Name="StatHistorianReportGenerator.exe" Source="$(var.ProjectDir)\StatHistorianReportGenerator.exe">
          <netfx:NativeImage Id="ngen_StatHistorianReportGenerator.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="StatHistorianReportGeneratorConfig">
        <File Id="StatHistorianReportGenerator.exe.config" Name="StatHistorianReportGenerator.exe.config" Source="$(var.ProjectDir)\StatHistorianReportGenerator.exe.config" />
      </Component>
      <Component Id="AdapterExplorer">
        <File Id="AdapterExplorer.exe" Name="AdapterExplorer.exe" Source="$(var.ProjectDir)\AdapterExplorer.exe">
          <netfx:NativeImage Id="ngen_AdapterExplorer.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="AdapterExplorerConfig">
        <File Id="AdapterExplorer.exe.config" Name="AdapterExplorer.exe.config" Source="$(var.ProjectDir)\AdapterExplorer.exe.config" />
      </Component>
      <Component Id="BulkCalculationState">
        <File Id="BulkCalculationState.exe" Name="BulkCalculationState.exe" Source="$(var.ProjectDir)\BulkCalculationState.exe">
          <netfx:NativeImage Id="ngen_BulkCalculationState.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="BulkCalculationStateConfig">
        <File Id="BulkCalculationState.exe.config" Name="BulkCalculationState.exe.config" Source="$(var.ProjectDir)\BulkCalculationState.exe.config" />
      </Component>
      <Component Id="APPPDCImporter">
        <File Id="APPPDCImporter.exe" Name="APPPDCImporter.exe" Source="$(var.ProjectDir)\APPPDCImporter.exe">
          <netfx:NativeImage Id="ngen_APPPDCImporter.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="APPPDCImporterConfig">
        <File Id="APPPDCImporter.exe.config" Name="APPPDCImporter.exe.config" Source="$(var.ProjectDir)\APPPDCImporter.exe.config" />
      </Component>
      <Component Id="SELPDCImporter">
        <File Id="SELPDCImporter.exe" Name="SELPDCImporter.exe" Source="$(var.ProjectDir)\SELPDCImporter.exe">
          <netfx:NativeImage Id="ngen_SELPDCImporter.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="SELPDCImporterConfig">
        <File Id="SELPDCImporter.exe.config" Name="SELPDCImporter.exe.config" Source="$(var.ProjectDir)\SELPDCImporter.exe.config" />
      </Component>
      <Component Id="Reports">
        <File Id="Reports.dll" Name="Reports.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Reports.dll">
          <netfx:NativeImage Id="ngen_Reports.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="SerializedSchema">
        <File Id="SerializedSchema.bin" Name="SerializedSchema.bin" Source="$(var.SolutionDir)\Data\SerializedSchema.bin" />
      </Component>
      <Component Id="openHistorian.Core">
        <File Id="openHistorian.Core.dll" Name="$(var.openHistorian.Core.TargetFileName)" Source="$(var.openHistorian.Core.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.Core.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.SortedTreeStore">
        <File Id="GSF.SortedTreeStore.dll" Name="$(var.GSF.SortedTreeStore.TargetFileName)" Source="$(var.GSF.SortedTreeStore.TargetPath)" >
          <netfx:NativeImage Id="ngen_GSF.SortedTreeStore.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openHistorian.Adapters">
        <File Id="openHistorian.Adapters.dll" Name="$(var.openHistorian.Adapters.TargetFileName)" Source="$(var.openHistorian.Adapters.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.Adapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openHistorian.eDNAGrafanaController">
        <File Id="openHistorian.eDNAGrafanaController.dll" Name="$(var.openHistorian.eDNAGrafanaController.TargetFileName)" Source="$(var.openHistorian.eDNAGrafanaController.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.eDNAGrafanaController.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openHistorian.OSIPIGrafanaController">
        <File Id="openHistorian.OSIPIGrafanaController.dll" Name="$(var.openHistorian.OSIPIGrafanaController.TargetFileName)" Source="$(var.openHistorian.OSIPIGrafanaController.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.OSIPIGrafanaController.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openHistorian.TrenDAPController">
        <File Id="openHistorian.TrenDAPController.dll" Name="$(var.openHistorian.TrenDAPController.TargetFileName)" Source="$(var.openHistorian.TrenDAPController.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.TrenDAPController.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>

      <Component Id="WebManagerShortcutComponent" Guid="{81B17113-C022-4751-9C08-D5BC57D08F7F}">
        <Shortcut Id="WebManagerStartMenuShortcut" Directory="ApplicationProgramsFolder" Name="openHistorian Web Manager" Icon="openHistorianWebManager.ico.exe" Description="URL to the openHistorian Web Manager." Target="[WEBMANAGERURL]" />
        <RegistryValue Root="HKLM" Key="SOFTWARE\Grid Protection Alliance\openHistorian" Name="WebManagerShortcut" Type="string" Value="" KeyPath="yes" />
      </Component>

      <ComponentGroupRef Id="SqlClrComponents" />

      <ComponentGroupRef Id="OptionalInstallsFiles" />
    </ComponentGroup>

    <!-- openHistorian Manager -->
    <ComponentGroup Id="openHistorianManagerComponents" Directory="INSTALLFOLDER">
      <Component Id="openHistorianManager">
        <File Id="openHistorianManager.exe" Name="$(var.openHistorianManager.TargetFileName)" Source="$(var.openHistorianManager.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorianManager.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="openHistorianManagerStartMenuShortcut" Name="openHistorian Manager" Icon="openHistorianManager.ico.exe" Description="Manager application for the openHistorian service." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="openHistorianManagerConfig">
        <File Id="openHistorianManager.exe.config" Name="$(var.openHistorianManager.TargetFileName).config" Source="$(var.openHistorianManager.TargetPath).config" />
      </Component>
      <Component Id="openHistorianManagerMenu">
        <File Id="Menu.xml" Name="Menu.xml" Source="$(var.openHistorianManager.ProjectDir)\Menu.xml" />
      </Component>
      <Component Id="openHistorian.UI">
        <File Id="openHistorian.UI.dll" Name="$(var.openHistorian.UI.TargetFileName)" Source="$(var.openHistorian.UI.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.UI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openHistorian.UI.WPF">
        <File Id="openHistorian.UI.WPF.dll" Name="$(var.openHistorian.UI.WPF.TargetFileName)" Source="$(var.openHistorian.UI.WPF.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorian.UI.WPF.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- openHistorian Console -->
    <ComponentGroup Id="openHistorianConsoleComponents" Directory="INSTALLFOLDER">
      <Component Id="openHistorianConsole">
        <File Id="openHistorianConsole.exe" Name="$(var.openHistorianConsole.TargetFileName)" Source="$(var.openHistorianConsole.TargetPath)" >
          <netfx:NativeImage Id="ngen_openHistorianConsole.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="openHistorianConsoleStartMenuShortcut" Name="openHistorian Console" Icon="openHistorianConsole.ico.exe" Description="Console application to monitor the openHistorian service." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="openHistorianConsoleConfig">
        <File Id="openHistorianConsole.exe.config" Name="$(var.openHistorianConsole.TargetFileName).config" Source="$(var.openHistorianConsole.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <!-- openHistorian Tools -->
    <ComponentGroup Id="openHistorianToolsComponents" Directory="INSTALLFOLDER">
      <ComponentGroupRef Id="ConfigCrypterComponents" />
      <ComponentGroupRef Id="ConfigurationEditorComponents" />
      <ComponentGroupRef Id="CSVDataManagerComponents" />
      <ComponentGroupRef Id="StatisticViewComponents" />
      <ComponentGroupRef Id="HistorianViewComponents" />
      <ComponentGroupRef Id="LogFileViewerComponents" />
      <ComponentGroupRef Id="ArchiveUpgradeUtilityComponents" />
      <ComponentGroupRef Id="ArchiveComparisonUtilityComponents" />
      <ComponentGroupRef Id="DataExtractionUtilityComponents" />
      <ComponentGroupRef Id="GEPDataExtractorComponents" />
      <ComponentGroupRef Id="UpdateTagNamesComponents" />
      <ComponentGroupRef Id="openVisNComponents" />

      <Component Id="NoInetFixUtil">
        <File Id="NoInetFixUtil.exe" Name="NoInetFixUtil.exe" Source="$(var.ProjectDir)\NoInetFixUtil.exe">
          <netfx:NativeImage Id="ngen_NoInetFixUtil.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="NoInetFixUtilStartMenuShortcut" Name="No-Internet Fix Utility" Icon="NoInetFixUtil.ico.exe" Description="Tool used to fix long timeouts on systems with no internet access available." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>

      <Component Id="DNP3ConfigGenerator">
        <File Id="DNP3ConfigGenerator.exe" Name="DNP3ConfigGenerator.exe" Source="$(var.ProjectDir)\DNP3ConfigGenerator.exe">
          <netfx:NativeImage Id="ngen_DNP3ConfigGenerator.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="DNP3ConfigGeneratorUtilitiesShortcut" Name="DNP3ConfigGenerator" Target="[#DNP3ConfigGenerator.exe]" Description="Used to create sample DNP3 config and extract openSSL dependencies." WorkingDirectory="INSTALLFOLDER" Directory="UTILITIESFOLDER" Advertise="no" />
      </Component>

      <Component Id="CreateOutputStream">
        <File Id="CreateOutputStream.exe" Name="CreateOutputStream.exe" Source="$(var.ProjectDir)\CreateOutputStream.exe">
          <netfx:NativeImage Id="ngen_CreateOutputStream.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="CreateOutputStreamUtilitiesShortcut" Name="CreateOutputStream" Target="[#CreateOutputStream.exe]" Description="Used to create an output stream from a CSV file." WorkingDirectory="INSTALLFOLDER" Directory="UTILITIESFOLDER" Advertise="no" />
      </Component>

      <Component Id="UpdateCOMTRADECounters">
        <File Id="UpdateCOMTRADECounters.exe" Name="UpdateCOMTRADECounters.exe" Source="$(var.UpdateCOMTRADECounters.TargetPath)">
          <netfx:NativeImage Id="ngen_UpdateCOMTRADECounters.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="ConfigCrypterComponents" Directory="INSTALLFOLDER">
      <Component Id="ConfigCrypter">
        <File Id="ConfigCrypter.exe" Name="ConfigCrypter.exe" Source="$(var.ProjectDir)\ConfigCrypter.exe">
          <netfx:NativeImage Id="ngen_ConfigCrypter.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="ConfigurationCrypterStartMenuShortcut" Name="Cipher Key Manager" Icon="ConfigCrypter.ico.exe" Description="Tool used to manage cryptographic cipher keys." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="ConfigCrypterConfig">
        <File Id="ConfigCrypter.exe.config" Name="ConfigCrypter.exe.config" Source="$(var.ProjectDir)\ConfigCrypter.exe.config" />
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="ConfigurationEditorComponents" Directory="INSTALLFOLDER">
      <Component Id="ConfigurationEditor">
        <File Id="ConfigurationEditor.exe" Name="ConfigurationEditor.exe" Source="$(var.ProjectDir)\ConfigurationEditor.exe">
          <netfx:NativeImage Id="ngen_ConfigurationEditor.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="ConfigurationEditorStartMenuShortcut" Name="XML Configuration Editor" Icon="ConfigurationEditor.ico.exe" Description="Tool used edit the XML configuration file for the openHistorian service and its components." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="ConfigurationEditorConfig">
        <File Id="ConfigurationEditor.exe.config" Name="ConfigurationEditor.exe.config" Source="$(var.ProjectDir)\ConfigurationEditor.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="CSVDataManagerComponents" Directory="INSTALLFOLDER">
      <Component Id="CSVDataManager">
        <File Id="CSVDataManager.exe" Name="CSVDataManager.exe" Source="$(var.ProjectDir)\CSVDataManager.exe">
          <netfx:NativeImage Id="ngen_CSVDataManager.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="CSVDataManagerStartMenuShortcut" Name="CSV Data Manager" Icon="CSVDataManager.ico.exe" Description="Tool used to manage database configuration through CSV files." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="CSVDataManagerConfig">
        <File Id="CSVDataManager.exe.config" Name="CSVDataManager.exe.config" Source="$(var.ProjectDir)\CSVDataManager.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="ConfigurationSetupUtilityComponents" Directory="INSTALLFOLDER">
      <Component Id="ConfigurationSetupUtility">
        <File Id="ConfigurationSetupUtility.exe" Name="$(var.ConfigurationSetupUtility.TargetFileName)" Source="$(var.ConfigurationSetupUtility.TargetPath)">
          <netfx:NativeImage Id="ngen_ConfigurationSetupUtility.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="ConfigurationSetupUtilityStartMenuShortcut" Name="Configuration Setup Utility" Icon="ConfigurationSetupUtility.ico.exe" Description="Utility used to set up openHistorian service configuration database." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="ConfigurationSetupUtilityConfig">
        <File Id="ConfigurationSetupUtility.exe.config" Name="$(var.ConfigurationSetupUtility.TargetFileName).config" Source="$(var.ConfigurationSetupUtility.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="StatisticViewComponents" Directory="INSTALLFOLDER">
      <Component Id="StatisticView">
        <File Id="StatisticView.exe" Name="StatisticView.exe" Source="$(var.ProjectDir)\HistorianView.exe" >
          <netfx:NativeImage Id="ngen_StatisticView.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="StatisticViewStartMenuShortcut" Name="Statistics Trending Tool" Icon="StatisticView.ico.exe" Description="Tool used to analyze historic files to create charts and export statistic data to CSV format." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="StatisticViewConfig">
        <File Id="StatisticView.exe.config" Name="StatisticView.exe.config" Source="$(var.ProjectDir)\HistorianView.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="HistorianViewComponents" Directory="INSTALLFOLDER">
      <Component Id="HistorianView">
        <File Id="HistorianView.exe" Name="HistorianView.exe" Source="$(var.HistorianView.TargetPath)">
          <netfx:NativeImage Id="ngen_HistorianView.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="HistorianViewStartMenuShortcut" Name="Historian Trending Tool" Icon="HistorianView.ico.exe" Description="Tool used to analyze historic files to create charts and export archived data to CSV format." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="HistorianViewConfig">
        <File Id="HistorianView.exe.config" Name="HistorianView.exe.config" Source="$(var.HistorianView.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="LogFileViewerComponents" Directory="INSTALLFOLDER">
      <Component Id="LogFileViewer">
        <File Id="LogFileViewer.exe" Name="LogFileViewer.exe" Source="$(var.ProjectDir)\LogFileViewer.exe">
          <netfx:NativeImage Id="ngen_LogFileViewer.exe" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="LogFileViewerStartMenuShortcut" Name="Log File Viewer" Icon="LogFileViewer.ico.exe" Description="Tool used to analyze log files produced by the openHistorian." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="LogFileViewerConfig">
        <File Id="LogFileViewer.exe.config" Name="LogFileViewer.exe.config" Source="$(var.ProjectDir)\LogFileViewer.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="ArchiveUpgradeUtilityComponents" Directory="INSTALLFOLDER">
      <Component Id="ArchiveUpgradeUtility">
        <File Id="ArchiveUpgradeUtility.exe" Name="ArchiveUpgradeUtility.exe" Source="$(var.MigrationUtility.TargetPath)" >
          <netfx:NativeImage Id="ngen_ArchiveUpgradeUtility.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="ArchiveUpgradeUtilityStartMenuShortcut" Name="Archive Upgrade Utility" Icon="ArchiveUpgradeUtility.ico.exe" Description="Tool used to migrate data from openHistorian 1.0 archives to openHistorian 2.0 archives." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="ArchiveUpgradeUtilityConfig">
        <File Id="ArchiveUpgradeUtility.exe.config" Name="ArchiveUpgradeUtility.exe.config" Source="$(var.MigrationUtility.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="ArchiveComparisonUtilityComponents" Directory="INSTALLFOLDER">
      <Component Id="ArchiveComparisonUtility">
        <File Id="ArchiveComparisonUtility.exe" Name="ArchiveComparisonUtility.exe" Source="$(var.ComparisonUtility.TargetPath)" >
          <netfx:NativeImage Id="ngen_ArchiveComparisonUtility.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="ArchiveComparisonUtilityStartMenuShortcut" Name="Archive Comparison Utility" Icon="ArchiveComparisonUtility.ico.exe" Description="Tool used to compare data stored in separate archives." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="ArchiveComparisonUtilityConfig">
        <File Id="ArchiveComparisonUtility.exe.config" Name="ArchiveComparisonUtility.exe.config" Source="$(var.ComparisonUtility.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="DataExtractionUtilityComponents" Directory="INSTALLFOLDER">
      <Component Id="DataExtractionUtility">
        <File Id="DataExtractionUtility.exe" Name="DataExtractionUtility.exe" Source="$(var.DataExtractionUtility.TargetPath)" >
          <netfx:NativeImage Id="ngen_DataExtractionUtility.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="DataExtractionUtilityConfig">
        <File Id="DataExtractionUtility.exe.config" Name="DataExtractionUtility.exe.config" Source="$(var.DataExtractionUtility.TargetPath).config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="GEPDataExtractorComponents" Directory="INSTALLFOLDER">
      <Component Id="GEPDataExtractor">
        <File Id="GEPDataExtractor.exe" Name="GEPDataExtractor.exe" Source="$(var.ProjectDir)\GEPDataExtractor.exe" >
          <netfx:NativeImage Id="ngen_GEPDataExtractor.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GEPDataExtractorConfig">
        <File Id="GEPDataExtractor.exe.config" Name="GEPDataExtractor.exe.config" Source="$(var.ProjectDir)\GEPDataExtractor.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="UpdateTagNamesComponents" Directory="INSTALLFOLDER">
      <Component Id="UpdateTagNames">
        <File Id="UpdateTagNames.exe" Name="UpdateTagNames.exe" Source="$(var.ProjectDir)\UpdateTagNames.exe" >
          <netfx:NativeImage Id="ngen_UpdateTagNames.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="UpdateTagNamesConfig">
        <File Id="UpdateTagNames.exe.config" Name="UpdateTagNames.exe.config" Source="$(var.ProjectDir)\UpdateTagNames.exe.config" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="openVisNComponents" Directory="INSTALLFOLDER">
      <Component Id="openVisN">
        <File Id="openVisN.exe" Name="openVisN.exe" Source="$(var.openVisN.TargetPath)" >
          <netfx:NativeImage Id="ngen_openVisN.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
        <Shortcut Id="openVisNStartMenuShortcut" Name="openVisN" Icon="openVisN.ico.exe" Description="Synchrophasor visualization application for openHistorian 2.0 data." WorkingDirectory="INSTALLFOLDER" Directory="ApplicationProgramsFolder" Advertise="yes" />
      </Component>
      <Component Id="openVisNConfig">
        <File Id="openVisN.exe.config" Name="openVisN.exe.config" Source="$(var.openVisN.TargetPath).config" />
      </Component>
      <Component Id="openVisN.Framework">
        <File Id="openVisN.Framework.dll" Name="openVisN.Framework.dll" Source="$(var.openVisN.Framework.TargetPath)" >
          <netfx:NativeImage Id="ngen_openVisN.Framework.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="openVisN.WinForms">
        <File Id="openVisN.WinForms.dll" Name="openVisN.WinForms.dll" Source="$(var.openVisN.WinForms.TargetPath)" >
          <netfx:NativeImage Id="ngen_openVisN.WinForms.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="NPlot45">
        <File Id="NPlot45.dll"  Name="$(var.NPlot45.TargetFileName)" Source="$(var.NPlot45.TargetPath)" >
          <netfx:NativeImage Id="ngen_NPlot45.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- Adapters -->
    <ComponentGroup Id="AdapterComponents" Directory="INSTALLFOLDER">
      <Component Id="AudioAdapters">
        <File Id="AudioAdapters.dll" Name="AudioAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\AudioAdapters.dll">
          <netfx:NativeImage Id="ngen_AudioAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="AdoAdapters">
        <File Id="AdoAdapters.dll" Name="AdoAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\AdoAdapters.dll">
          <netfx:NativeImage Id="ngen_AdoAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Ciloci.Flee">
        <File Id="Ciloci.Flee.dll" Name="Ciloci.Flee.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Ciloci.Flee.dll">
          <netfx:NativeImage Id="ngen_Ciloci.Flee.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="COMTRADEAdapters">
        <File Id="COMTRADEAdapters.dll" Name="COMTRADEAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\COMTRADEAdapters.dll">
          <netfx:NativeImage Id="ngen_COMTRADEAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="CsvAdapters">
        <File Id="CsvAdapters.dll" Name="CsvAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\CsvAdapters.dll">
          <netfx:NativeImage Id="ngen_CsvAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="DataQualityMonitoring">
        <File Id="DataQualityMonitoring.dll" Name="DataQualityMonitoring.dll" Source="$(var.SolutionDir)\Dependencies\GSF\DataQualityMonitoring.dll">
          <netfx:NativeImage Id="ngen_DataQualityMonitoring.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Dnp3Adapters">
        <File Id="Dnp3Adapters.dll" Name="Dnp3Adapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Dnp3Adapters.dll" />
      </Component>
      <Component Id="DNP3CLRAdapter">
        <File Id="DNP3CLRAdapter.dll" Name="DNP3CLRAdapter.dll" Source="$(var.SolutionDir)\Dependencies\GSF\DNP3CLRAdapter.dll" />
      </Component>
      <Component Id="DNP3CLRInterface">
        <File Id="DNP3CLRInterface.dll" Name="DNP3CLRInterface.dll" Source="$(var.SolutionDir)\Dependencies\GSF\DNP3CLRInterface.dll">
          <netfx:NativeImage Id="ngen_DNP3CLRInterface.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="DeviceStatAdapters">
        <File Id="DeviceStatAdapters.dll" Name="DeviceStatAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\DeviceStatAdapters.dll">
          <netfx:NativeImage Id="ngen_DeviceStatAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="DynamicCalculator">
        <File Id="DynamicCalculator.dll" Name="DynamicCalculator.dll" Source="$(var.SolutionDir)\Dependencies\GSF\DynamicCalculator.dll">
          <netfx:NativeImage Id="ngen_DynamicCalculator.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="EpriExport">
        <File Id="EpriExport.dll" Name="EpriExport.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EpriExport.dll">
          <netfx:NativeImage Id="ngen_EpriExport.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="FileAdapters">
        <File Id="FileAdapters.dll" Name="FileAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\FileAdapters.dll">
          <netfx:NativeImage Id="ngen_FileAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="FtpAdapters">
        <File Id="FtpAdapters.dll" Name="FtpAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\FtpAdapters.dll">
          <netfx:NativeImage Id="ngen_FtpAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Google.ProtocolBuffers">
        <File Id="Google.ProtocolBuffers.dll" Name="Google.ProtocolBuffers.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Google.ProtocolBuffers.dll">
          <netfx:NativeImage Id="ngen_Google.ProtoBuffers.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GrafanaAdapters">
        <File Id="GrafanaAdapters.dll" Name="GrafanaAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GrafanaAdapters.dll">
          <netfx:NativeImage Id="ngen_GrafanaAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Hadoop.Replication">
        <File Id="Hadoop.Replication.dll" Name="Hadoop.Replication.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Hadoop.Replication.dll">
          <netfx:NativeImage Id="ngen_Hadoop.Replication.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="HistorianAdapters">
        <File Id="HistorianAdapters.dll" Name="HistorianAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\HistorianAdapters.dll">
          <netfx:NativeImage Id="ngen_HistorianAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="ICCPExport">
        <File Id="ICCPExport.dll" Name="ICCPExport.dll" Source="$(var.SolutionDir)\Dependencies\GSF\ICCPExport.dll">
          <netfx:NativeImage Id="ngen_ICCPExport.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="InfluxDBAdapters">
        <File Id="InfluxDBAdapters.dll" Name="InfluxDBAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\InfluxDBAdapters.dll">
          <netfx:NativeImage Id="ngen_InfluxDBAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="KafkaAdapters">
        <File Id="KafkaAdapters.dll" Name="KafkaAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\KafkaAdapters.dll">
          <netfx:NativeImage Id="ngen_KafkaAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="NAudio">
        <!-- Dependency for AudioAdapters -->
        <File Id="NAudio.dll" Name="NAudio.dll" Source="$(var.SolutionDir)\Dependencies\GSF\NAudio.dll">
          <netfx:NativeImage Id="ngen_NAudio.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Misakai.Kafka">
        <!-- Dependency for KafkaAdapters -->
        <File Id="Misakai.Kafka.dll" Name="Misakai.Kafka.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Misakai.Kafka.dll">
          <netfx:NativeImage Id="ngen_Misakai.Kafka.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="ModbusAdapters">
        <File Id="ModbusAdapters.dll" Name="ModbusAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\ModbusAdapters.dll">
          <netfx:NativeImage Id="ngen_ModbusAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="MongoAdapters">
        <File Id="MongoAdapters.dll" Name="MongoAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\MongoAdapters.dll">
          <netfx:NativeImage Id="ngen_MonogAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="MongoDB">
        <File Id="MongoDB.dll" Name="MongoDB.dll" Source="$(var.SolutionDir)\Dependencies\GSF\MongoDB.dll">
          <netfx:NativeImage Id="ngen_MongoDB.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="MongoDB.GridFS">
        <File Id="MongoDB.GridFS.dll" Name="MongoDB.GridFS.dll" Source="$(var.SolutionDir)\Dependencies\GSF\MongoDB.GridFS.dll">
          <netfx:NativeImage Id="ngen_MongoDB.GridFS.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="MySqlAdapters">
        <File Id="MySqlAdapters.dll" Name="MySqlAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\MySqlAdapters.dll">
          <netfx:NativeImage Id="ngen_MySqlAdapters.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="OneSecondFrequencyAverager">
        <File Id="OneSecondFrequencyAverager.dll" Name="OneSecondFrequencyAverager.dll" Source="$(var.SolutionDir)\Dependencies\GSF\OneSecondFrequencyAverager.dll">
          <netfx:NativeImage Id="ngen_OneSecondFrequencyAverager.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PhasorProtocolAdapters">
        <File Id="PhasorProtocolAdapters.dll" Name="PhasorProtocolAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PhasorProtocolAdapters.dll">
          <netfx:NativeImage Id="ngen_PhasorProtocolAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PIAdapters">
        <!-- OSI-PI Historian Adapters -->
        <File Id="PIAdapters.dll" Name="PIAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PIAdapters.dll">
          <netfx:NativeImage Id="ngen_PIAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PowerCalculations">
        <File Id="PowerCalculations.dll" Name="PowerCalculations.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PowerCalculations.dll">
          <netfx:NativeImage Id="ngen_PowerCalculations.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PowerCalculations.UI">
        <File Id="PowerCalculations.UI.dll" Name="PowerCalculations.UI.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PowerCalculations.UI.dll">
          <netfx:NativeImage Id="ngen_PowerCalculations.UI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PowerCalculations.UI.WPF">
        <File Id="PowerCalculations.UI.WPF.dll" Name="PowerCalculations.UI.WPF.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PowerCalculations.UI.WPF.dll">
          <netfx:NativeImage Id="ngen_PowerCalculations.UI.WPF.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="TestingAdapters">
        <File Id="TestingAdapters.dll" Name="TestingAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\TestingAdapters.dll">
          <netfx:NativeImage Id="ngen_TestingAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="WavInputAdapter">
        <File Id="WavInputAdapter.dll" Name="WavInputAdapter.dll" Source="$(var.SolutionDir)\Dependencies\GSF\WavInputAdapter.dll">
          <netfx:NativeImage Id="ngen_WavInputAdapter.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="NModbus4">
        <!-- Dependency for Modbus connectivity -->
        <File Id="NModbus4.dll" Name="NModbus4.dll" Source="$(var.SolutionDir)\Dependencies\GSF\NModbus4.dll">
          <netfx:NativeImage Id="ngen_NModbus4.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="AzureEventHubAdapters">
        <File Id="AzureEventHubAdapters.dll" Name="AzureEventHubAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\AzureEventHubAdapters.dll">
          <netfx:NativeImage Id="ngen_AzureEventHubAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Azure.Amqp">
        <File Id="Microsoft.Azure.Amqp.dll" Name="Microsoft.Azure.Amqp.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Azure.Amqp.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Azure.Ampq.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Azure.EventHubs">
        <File Id="Microsoft.Azure.EventHubs.dll" Name="Microsoft.Azure.EventHubs.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Azure.EventHubs.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Azure.EventHubs.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>
    
    <ComponentGroup Id="eDNAAdapterComponents" Directory="INSTALLFOLDER">
      <Component Id="eDNAAdapters">
        <!-- eDNA Historian Adapters -->
        <File Id="eDNAAdapters.dll" Name="eDNAAdapters.dll" Source="$(var.SolutionDir)\Dependencies\GSF\eDNAAdapters.dll">
          <netfx:NativeImage Id="ngen_eDNAAdapters.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="EzDnaApi64">
        <File Id="EzDnaApi64.dll" Name="EzDnaApi64.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EzDnaApi64.dll" />
      </Component>
      <Component Id="EzDNAApiNet64">
        <File Id="EzDNAApiNet64.dll" Name="EzDNAApiNet64.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EzDNAApiNet64.dll">
          <netfx:NativeImage Id="ngen_EzDNAApiNet64.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="EzDNAApiNetSecure64">
        <File Id="EzDNAApiNetSecure64.dll" Name="EzDNAApiNetSecure64.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EzDNAApiNetSecure64.dll">
          <netfx:NativeImage Id="ngen_EzDNAApiNetSecure.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="EZDnaServApi64">
        <File Id="EZDnaServApi64.dll" Name="EZDnaServApi64.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EZDnaServApi64.dll" />
      </Component>
      <Component Id="EzDNAServApiNet64">
        <File Id="EzDNAServApiNet64.dll" Name="EzDNAServApiNet64.dll" Source="$(var.SolutionDir)\Dependencies\GSF\EzDNAServApiNet64.dll">
          <netfx:NativeImage Id="ngen_ExDNAServApiNet64.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- BouncyCastle Dependencies -->
    <ComponentGroup Id="BouncyCastleDependencyComponents" Directory="INSTALLFOLDER">
      <Component Id="crypto">
        <File Id="crypto.dll" Name="crypto.dll" Source="$(var.SolutionDir)\Dependencies\BouncyCastle\crypto.dll" >
          <netfx:NativeImage Id="ngen_crypto.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- GSF Dependencies -->
    <ComponentGroup Id="GSFDependencyComponents" Directory="INSTALLFOLDER">
      <Component Id="Antlr3.Runtime">
        <File Id="Antlr3.Runtime.dll" Name="Antlr3.Runtime.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Antlr3.Runtime.dll">
          <netfx:NativeImage Id="ngen_Antlr3.Runtime.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="ExpressionEvaluator">
        <File Id="ExpressionEvaluator.dll" Name="ExpressionEvaluator.dll" Source="$(var.SolutionDir)\Dependencies\GSF\ExpressionEvaluator.dll">
          <netfx:NativeImage Id="ngen_ExpressionEvaluator.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Communication">
        <File Id="GSF.Communication.dll" Name="GSF.Communication.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Communication.dll">
          <netfx:NativeImage Id="ngen_GSF.Communication.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.COMTRADE">
        <File Id="GSF.COMTRADE.dll" Name="GSF.COMTRADE.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.COMTRADE.dll">
          <netfx:NativeImage Id="ngen_GSF.COMTRADE.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Core">
        <File Id="GSF.Core.dll" Name="GSF.Core.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Core.dll">
          <netfx:NativeImage Id="ngen_GSF.Core.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Geo">
        <File Id="GSF.Geo.dll" Name="GSF.Geo.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Geo.dll">
          <netfx:NativeImage Id="ngen_GSF.Geo.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Historian">
        <File Id="GSF.Historian.dll" Name="GSF.Historian.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Historian.dll">
          <netfx:NativeImage Id="ngen_GSF.Historian.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Media">
        <File Id="GSF.Media.dll" Name="GSF.Media.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Media.dll">
          <netfx:NativeImage Id="ngen_GSF.Media.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.MMS">
        <File Id="GSF.MMS.dll" Name="GSF.MMS.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.MMS.dll">
          <netfx:NativeImage Id="ngen_GSF.MMS.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Net">
        <File Id="GSF.Net.dll" Name="GSF.Net.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Net.dll">
          <netfx:NativeImage Id="ngen_GSF.Net.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.PhasorProtocols">
        <File Id="GSF.PhasorProtocols.dll" Name="GSF.PhasorProtocols.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.PhasorProtocols.dll">
          <netfx:NativeImage Id="ngen_GSF.PhasorProtocols.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.PhasorProtocols.UI">
        <File Id="GSF.PhasorProtocols.UI.dll" Name="GSF.PhasorProtocols.UI.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.PhasorProtocols.UI.dll">
          <netfx:NativeImage Id="ngen_GSF.PhasorProtocols.UI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.PhasorProtocols.UI.WPF">
        <File Id="GSF.PhasorProtocols.UI.WPF.dll" Name="GSF.PhasorProtocols.UI.WPF.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.PhasorProtocols.UI.WPF.dll">
          <netfx:NativeImage Id="ngen_GSF.PhasorProtocols.UI.WPF.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Security">
        <File Id="GSF.Security.dll" Name="GSF.Security.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Security.dll">
          <netfx:NativeImage Id="ngen_GSF.Security.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.ServiceBus">
        <File Id="GSF.ServiceBus.dll" Name="GSF.ServiceBus.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.ServiceBus.dll">
          <netfx:NativeImage Id="ngen_GSF.ServiceBus.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.ServiceModel">
        <File Id="GSF.ServiceModel.dll" Name="GSF.ServiceModel.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.ServiceModel.dll">
          <netfx:NativeImage Id="ngen_GSF.ServiceModel.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.ServiceProcess">
        <File Id="GSF.ServiceProcess.dll" Name="GSF.ServiceProcess.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.ServiceProcess.dll">
          <netfx:NativeImage Id="ngen_GSF.ServiceProcess.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.TimeSeries">
        <File Id="GSF.TimeSeries.dll" Name="GSF.TimeSeries.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.TimeSeries.dll">
          <netfx:NativeImage Id="ngen_GSF.TimeSeries.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.TimeSeries.Transport.UI">
        <File Id="GSF.TimeSeries.Transport.UI.dll" Name="GSF.TimeSeries.Transport.UI.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.TimeSeries.Transport.UI.dll">
          <netfx:NativeImage Id="ngen_GSF.TimeSeries.Transport.UI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.TimeSeries.Transport.UI.WPF">
        <File Id="GSF.TimeSeries.Transport.UI.WPF.dll" Name="GSF.TimeSeries.Transport.UI.WPF.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.TimeSeries.Transport.UI.WPF.dll">
          <netfx:NativeImage Id="ngen_GSF.TimeSeries.Transport.UI.WPF.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.TimeSeries.UI">
        <File Id="GSF.TimeSeries.UI.dll" Name="GSF.TimeSeries.UI.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.TimeSeries.UI.dll">
          <netfx:NativeImage Id="ngen_GSF.TimeSeries.UI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.TimeSeries.UI.WPF">
        <File Id="GSF.TimeSeries.UI.WPF.dll" Name="GSF.TimeSeries.UI.WPF.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.TimeSeries.UI.WPF.dll">
          <netfx:NativeImage Id="ngen_GSF.TimeSeries.UI.WPF.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Web">
        <File Id="GSF.Web.dll" Name="GSF.Web.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Web.dll">
          <netfx:NativeImage Id="ngen_GSF.Web.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="GSF.Web.config">
        <File Id="GSF.Web.dll.config" Name="GSF.Web.dll.config" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Web.dll.config" />
      </Component>
      <Component Id="GSF.Windows">
        <File Id="GSF.Windows.dll" Name="GSF.Windows.dll" Source="$(var.SolutionDir)\Dependencies\GSF\GSF.Windows.dll">
          <netfx:NativeImage Id="ngen_GSF.Windows.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Npgsql">
        <File Id="Npgsql.dll" Name="Npgsql.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Npgsql.dll">
          <netfx:NativeImage Id="ngen_Npgsql.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Buffers">
        <File Id="System.Buffers.dll" Name="System.Buffers.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Buffers.dll">
          <netfx:NativeImage Id="ngen_System.Buffers.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Memory">
        <File Id="System.Memory.dll" Name="System.Memory.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Memory.dll">
          <netfx:NativeImage Id="ngen_System.Memory.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Runtime.CompilerServices.Unsafe">
        <File Id="System.Runtime.CompilerServices.Unsafe.dll" Name="System.Runtime.CompilerServices.Unsafe.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Runtime.CompilerServices.Unsafe.dll">
          <netfx:NativeImage Id="ngen_System.Runtime.CompilerServices.Unsafe.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Threading.Tasks.Extensions">
        <File Id="System.Threading.Tasks.Extensions.dll" Name="System.Threading.Tasks.Extensions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Threading.Tasks.Extensions.dll">
          <netfx:NativeImage Id="ngen_System.Threading.Tasks.Extensions.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.ValueTuple">
        <File Id="System.ValueTuple.dll" Name="System.ValueTuple.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.ValueTuple.dll">
          <netfx:NativeImage Id="ngen_System.ValueTuple.dll" Platform="64bit" Priority="1" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Data.SQLite">
        <File Id="System.Data.SQLite.dll" Name="System.Data.SQLite.dll" Source="$(var.SolutionDir)Dependencies\GSF\System.Data.SQLite.dll">
          <netfx:NativeImage Id="ngen_System.Data.SQLite.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="sttp.gsf">
        <File Id="sttp.gsf.dll" Name="sttp.gsf.dll" Source="$(var.SolutionDir)\Dependencies\GSF\sttp.gsf.dll">
          <netfx:NativeImage Id="ngen_sttp.gsf.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="PhasorWebUI">
        <File Id="PhasorWebUI.dll" Name="PhasorWebUI.dll" Source="$(var.SolutionDir)\Dependencies\GSF\PhasorWebUI.dll">
          <netfx:NativeImage Id="ngen_PhasorWebUI.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="ValidateAssemblyBindings">
        <File Id="ValidateAssemblyBindings.exe" Name="ValidateAssemblyBindings.exe" Source="$(var.SolutionDir)\Dependencies\GSF\ValidateAssemblyBindings.exe">
          <netfx:NativeImage Id="ngen_ValidateAssemblyBindings.exe" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- Microsoft Dependencies -->
    <ComponentGroup Id="MicrosoftDependencyComponents" Directory="INSTALLFOLDER">
      <Component Id="DynamicDataDisplay">
        <File Id="DynamicDataDisplay.dll" Name="DynamicDataDisplay.dll" Source="$(var.SolutionDir)\Dependencies\Microsoft\D3\DynamicDataDisplay.dll">
          <netfx:NativeImage Id="ngen_DynamicDataDisplay.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Windows.Controls.DataVisualization.Toolkit">
        <File Id="System.Windows.Controls.DataVisualization.Toolkit.dll" Name="System.Windows.Controls.DataVisualization.Toolkit.dll" Source="$(var.SolutionDir)\Dependencies\Microsoft\WPF\System.Windows.Controls.DataVisualization.Toolkit.dll">
          <netfx:NativeImage Id="ngen_System.Windows.Controls.DataVisualization.Toolkit.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Windows.Controls.Input.Toolkit">
        <File Id="System.Windows.Controls.Input.Toolkit.dll" Name="System.Windows.Controls.Input.Toolkit.dll" Source="$(var.SolutionDir)\Dependencies\Microsoft\WPF\System.Windows.Controls.Input.Toolkit.dll">
          <netfx:NativeImage Id="ngen_System.Windows.Controls.Input.Toolkit.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Windows.Controls.Layout.Toolkit">
        <File Id="System.Windows.Controls.Layout.Toolkit.dll" Name="System.Windows.Controls.Layout.Toolkit.dll" Source="$(var.SolutionDir)\Dependencies\Microsoft\WPF\System.Windows.Controls.Layout.Toolkit.dll">
          <netfx:NativeImage Id="ngen_System.Windows.Controls.Layout.Toolkit.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="WPFToolkit">
        <File Id="WPFToolkit.dll" Name="WPFToolkit.dll" Source="$(var.SolutionDir)\Dependencies\Microsoft\WPF\WPFToolkit.dll">
          <netfx:NativeImage Id="ngen_WPFToolkit.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>

      <!-- Self Hosting SignalR, WebAPI and Razor Engine Components (these are managed as NuGet dependencies to GSF.Web) -->
      <Component Id="AjaxMin">
        <File Id="AjaxMin.dll" Name="AjaxMin.dll" Source="$(var.SolutionDir)\Dependencies\GSF\AjaxMin.dll">
          <netfx:NativeImage Id="ngen_AjaxMin.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.AspNet.SignalR.Core">
        <File Id="Microsoft.AspNet.SignalR.Core.dll" Name="Microsoft.AspNet.SignalR.Core.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.AspNet.SignalR.Core.dll">
          <netfx:NativeImage Id="ngen_Microsoft.AspNet.SignalR.Core.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Net.Http.Formatting">
        <File Id="System.Net.Http.Formatting.dll" Name="System.Net.Http.Formatting.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Net.Http.Formatting.dll">
          <netfx:NativeImage Id="ngen_System.Net.Http.Formatting.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Mvc">
        <File Id="System.Web.Mvc.dll" Name="System.Web.Mvc.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Mvc.dll">
          <netfx:NativeImage Id="ngen_System.Web.Mvc.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Http">
        <File Id="System.Web.Http.dll" Name="System.Web.Http.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Http.dll">
          <netfx:NativeImage Id="ngen_System.Web.Http.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Http.Owin">
        <File Id="System.Web.Http.Owin.dll" Name="System.Web.Http.Owin.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Http.Owin.dll">
          <netfx:NativeImage Id="ngen_System.Web.Http.Owin.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Http.Cors">
        <File Id="System.Web.Http.Cors.dll" Name="System.Web.Http.Cors.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Http.Cors.dll">
          <netfx:NativeImage Id="ngen_System.Web.Http.Cors.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin">
        <File Id="Microsoft.Owin.dll" Name="Microsoft.Owin.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin.Cors">
        <File Id="Microsoft.Owin.Cors.dll" Name="Microsoft.Owin.Cors.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.Cors.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.Cors.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin.Diagnostics">
        <File Id="Microsoft.Owin.Diagnostics.dll" Name="Microsoft.Owin.Diagnostics.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.Diagnostics.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.Diagnostics.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin.Host.HttpListener">
        <File Id="Microsoft.Owin.Host.HttpListener.dll" Name="Microsoft.Owin.Host.HttpListener.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.Host.HttpListener.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.Host.HttpListener.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin.Hosting">
        <File Id="Microsoft.Owin.Hosting.dll" Name="Microsoft.Owin.Hosting.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.Hosting.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.Hosting.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Owin.Security">
        <File Id="Microsoft.Owin.Security.dll" Name="Microsoft.Owin.Security.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Owin.Security.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Owin.Security.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Newtonsoft.Json">
        <File Id="Newtonsoft.Json.dll" Name="Newtonsoft.Json.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Newtonsoft.Json.dll">
          <netfx:NativeImage Id="ngen_Newtonsoft.Json.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Owin">
        <File Id="Owin.dll" Name="Owin.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Owin.dll">
          <netfx:NativeImage Id="ngen_Owin.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="RazorEngine">
        <File Id="RazorEngine.dll" Name="RazorEngine.dll" Source="$(var.SolutionDir)\Dependencies\GSF\RazorEngine.dll">
          <netfx:NativeImage Id="ngen_RazorEngine.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Razor">
        <File Id="System.Web.Razor.dll" Name="System.Web.Razor.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Razor.dll">
          <netfx:NativeImage Id="ngen_System.Web.Razor.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Cors">
        <File Id="System.Web.Cors.dll" Name="System.Web.Cors.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Cors.dll">
          <netfx:NativeImage Id="ngen_System.Web.Cors.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.Helpers">
        <File Id="System.Web.Helpers.dll" Name="System.Web.Helpers.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.Helpers.dll">
          <netfx:NativeImage Id="ngen_System.Web.Helpers.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.WebPages">
        <File Id="System.Web.WebPages.dll" Name="System.Web.WebPages.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.WebPages.dll">
          <netfx:NativeImage Id="ngen_System.Web.WebPages.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.WebPages.Deployment">
        <File Id="System.Web.WebPages.Deployment.dll" Name="System.Web.WebPages.Deployment.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.WebPages.Deployment.dll">
          <netfx:NativeImage Id="ngen_System.Web.WebPages.Deployment.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Web.WebPages.Razor">
        <File Id="System.Web.WebPages.Razor.dll" Name="System.Web.WebPages.Razor.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Web.WebPages.Razor.dll">
          <netfx:NativeImage Id="ngen_System.Web.WebPages.Razor.dll" Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>
    
    <!-- Azure AD Dependencies -->
    <ComponentGroup Id="AzureADDependencyComponents" Directory="INSTALLFOLDER">
      <Component Id="Azure.Core">
        <File Id="Azure.Core.dll" Name="Azure.Core.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Azure.Core.dll">
          <netfx:NativeImage Id="ngen_Azure.Core.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.AspNetCore.Cryptography.Internal">
        <File Id="Microsoft.AspNetCore.Cryptography.Internal.dll" Name="Microsoft.AspNetCore.Cryptography.Internal.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.AspNetCore.Cryptography.Internal.dll">
          <netfx:NativeImage Id="ngen_Microsoft.AspNetCore.Cryptography.Internal.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.AspNetCore.DataProtection.Abstractions">
        <File Id="Microsoft.AspNetCore.DataProtection.Abstractions.dll" Name="Microsoft.AspNetCore.DataProtection.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.AspNetCore.DataProtection.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.AspNetCore.DataProtection.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.AspNetCore.DataProtection">
        <File Id="Microsoft.AspNetCore.DataProtection.dll" Name="Microsoft.AspNetCore.DataProtection.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.AspNetCore.DataProtection.dll">
          <netfx:NativeImage Id="ngen_Microsoft.AspNetCore.DataProtection.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Bcl.AsyncInterfaces">
        <File Id="Microsoft.Bcl.AsyncInterfaces.dll" Name="Microsoft.Bcl.AsyncInterfaces.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Bcl.AsyncInterfaces.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Bcl.AsyncInterfaces.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Caching.Abstractions">
        <File Id="Microsoft.Extensions.Caching.Abstractions.dll" Name="Microsoft.Extensions.Caching.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Caching.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Caching.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Caching.Memory">
        <File Id="Microsoft.Extensions.Caching.Memory.dll" Name="Microsoft.Extensions.Caching.Memory.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Caching.Memory.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Caching.Memory.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Configuration.Abstractions">
        <File Id="Microsoft.Extensions.Configuration.Abstractions.dll" Name="Microsoft.Extensions.Configuration.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Configuration.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Configuration.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.DependencyInjection.Abstractions">
        <File Id="Microsoft.Extensions.DependencyInjection.Abstractions.dll" Name="Microsoft.Extensions.DependencyInjection.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.DependencyInjection.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.DependencyInjection.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.DependencyInjection">
        <File Id="Microsoft.Extensions.DependencyInjection.dll" Name="Microsoft.Extensions.DependencyInjection.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.DependencyInjection.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.DependencyInjection.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.FileProviders.Abstractions">
        <File Id="Microsoft.Extensions.FileProviders.Abstractions.dll" Name="Microsoft.Extensions.FileProviders.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.FileProviders.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.FileProviders.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Hosting.Abstractions">
        <File Id="Microsoft.Extensions.Hosting.Abstractions.dll" Name="Microsoft.Extensions.Hosting.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Hosting.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Hosting.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Logging.Abstractions">
        <File Id="Microsoft.Extensions.Logging.Abstractions.dll" Name="Microsoft.Extensions.Logging.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Logging.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Logging.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Logging">
        <File Id="Microsoft.Extensions.Logging.dll" Name="Microsoft.Extensions.Logging.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Logging.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Logging.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Options">
        <File Id="Microsoft.Extensions.Options.dll" Name="Microsoft.Extensions.Options.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Options.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Options.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Extensions.Primitives">
        <File Id="Microsoft.Extensions.Primitives.dll" Name="Microsoft.Extensions.Primitives.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Extensions.Primitives.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Extensions.Primitives.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Graph.Core">
        <File Id="Microsoft.Graph.Core.dll" Name="Microsoft.Graph.Core.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Graph.Core.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Graph.Core.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Graph">
        <File Id="Microsoft.Graph.dll" Name="Microsoft.Graph.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Graph.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Graph.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Identity.Client.Broker">
        <File Id="Microsoft.Identity.Client.Broker.dll" Name="Microsoft.Identity.Client.Broker.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Identity.Client.Broker.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Identity.Client.Broker.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Identity.Client.Desktop">
        <File Id="Microsoft.Identity.Client.Desktop.dll" Name="Microsoft.Identity.Client.Desktop.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Identity.Client.Desktop.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Identity.Client.Desktop.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Identity.Client">
        <File Id="Microsoft.Identity.Client.dll" Name="Microsoft.Identity.Client.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Identity.Client.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Identity.Client.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Identity.Client.NativeInterop">
        <File Id="Microsoft.Identity.Client.NativeInterop.dll" Name="Microsoft.Identity.Client.NativeInterop.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Identity.Client.NativeInterop.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Identity.Client.NativeInterop.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Identity.Web.TokenCache">
        <File Id="Microsoft.Identity.Web.TokenCache.dll" Name="Microsoft.Identity.Web.TokenCache.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Identity.Web.TokenCache.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Identity.Web.TokenCache.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.Abstractions">
        <File Id="Microsoft.IdentityModel.Abstractions.dll" Name="Microsoft.IdentityModel.Abstractions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.Abstractions.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.Abstractions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.JsonWebTokens">
        <File Id="Microsoft.IdentityModel.JsonWebTokens.dll" Name="Microsoft.IdentityModel.JsonWebTokens.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.JsonWebTokens.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.JsonWebTokens.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.Logging">
        <File Id="Microsoft.IdentityModel.Logging.dll" Name="Microsoft.IdentityModel.Logging.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.Logging.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.Logging.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.Protocols">
        <File Id="Microsoft.IdentityModel.Protocols.dll" Name="Microsoft.IdentityModel.Protocols.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.Protocols.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.Protocols.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.Protocols.OpenIdConnect">
        <File Id="Microsoft.IdentityModel.Protocols.OpenIdConnect.dll" Name="Microsoft.IdentityModel.Protocols.OpenIdConnect.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.Protocols.OpenIdConnect.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.Protocols.OpenIdConnect.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.IdentityModel.Tokens">
        <File Id="Microsoft.IdentityModel.Tokens.dll" Name="Microsoft.IdentityModel.Tokens.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.IdentityModel.Tokens.dll">
          <netfx:NativeImage Id="ngen_Microsoft.IdentityModel.Tokens.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Web.WebView2.Core">
        <File Id="Microsoft.Web.WebView2.Core.dll" Name="Microsoft.Web.WebView2.Core.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Web.WebView2.Core.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Web.WebView2.Core.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Web.WebView2.WinForms">
        <File Id="Microsoft.Web.WebView2.WinForms.dll" Name="Microsoft.Web.WebView2.WinForms.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Web.WebView2.WinForms.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Web.WebView2.WinForms.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Web.WebView2.Wpf">
        <File Id="Microsoft.Web.WebView2.Wpf.dll" Name="Microsoft.Web.WebView2.Wpf.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Web.WebView2.Wpf.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Web.WebView2.Wpf.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="Microsoft.Win32.Registry">
        <File Id="Microsoft.Win32.Registry.dll" Name="Microsoft.Win32.Registry.dll" Source="$(var.SolutionDir)\Dependencies\GSF\Microsoft.Win32.Registry.dll">
          <netfx:NativeImage Id="ngen_Microsoft.Win32.Registry.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Diagnostics.DiagnosticSource">
        <File Id="System.Diagnostics.DiagnosticSource.dll" Name="System.Diagnostics.DiagnosticSource.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Diagnostics.DiagnosticSource.dll">
          <netfx:NativeImage Id="ngen_System.Diagnostics.DiagnosticSource.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Drawing.Common">
        <File Id="System.Drawing.Common.dll" Name="System.Drawing.Common.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Drawing.Common.dll">
          <netfx:NativeImage Id="ngen_System.Drawing.Common.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.IdentityModel.Tokens.Jwt">
        <File Id="System.IdentityModel.Tokens.Jwt.dll" Name="System.IdentityModel.Tokens.Jwt.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.IdentityModel.Tokens.Jwt.dll">
          <netfx:NativeImage Id="ngen_System.IdentityModel.Tokens.Jwt.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Memory.Data">
        <File Id="System.Memory.Data.dll" Name="System.Memory.Data.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Memory.Data.dll">
          <netfx:NativeImage Id="ngen_System.Memory.Data.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Net.Http.Json">
        <File Id="System.Net.Http.Json.dll" Name="System.Net.Http.Json.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Net.Http.Json.dll">
          <netfx:NativeImage Id="ngen_System.Net.Http.Json.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Net.Http.WinHttpHandler">
        <File Id="System.Net.Http.WinHttpHandler.dll" Name="System.Net.Http.WinHttpHandler.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Net.Http.WinHttpHandler.dll">
          <netfx:NativeImage Id="ngen_System.Net.Http.WinHttpHandler.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Numerics.Vectors">
        <File Id="System.Numerics.Vectors.dll" Name="System.Numerics.Vectors.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Numerics.Vectors.dll">
          <netfx:NativeImage Id="ngen_System.Numerics.Vectors.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Security.AccessControl">
        <File Id="System.Security.AccessControl.dll" Name="System.Security.AccessControl.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Security.AccessControl.dll">
          <netfx:NativeImage Id="ngen_System.Security.AccessControl.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Security.Cryptography.Xml">
        <File Id="System.Security.Cryptography.Xml.dll" Name="System.Security.Cryptography.Xml.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Security.Cryptography.Xml.dll">
          <netfx:NativeImage Id="ngen_System.Security.Cryptography.Xml.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Security.Permissions">
        <File Id="System.Security.Permissions.dll" Name="System.Security.Permissions.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Security.Permissions.dll">
          <netfx:NativeImage Id="ngen_System.Security.Permissions.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Security.Principal.Windows">
        <File Id="System.Security.Principal.Windows.dll" Name="System.Security.Principal.Windows.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Security.Principal.Windows.dll">
          <netfx:NativeImage Id="ngen_System.Security.Principal.Windows.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Text.Encodings.Web">
        <File Id="System.Text.Encodings.Web.dll" Name="System.Text.Encodings.Web.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Text.Encodings.Web.dll">
          <netfx:NativeImage Id="ngen_System.Text.Encodings.Web.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
      <Component Id="System.Text.Json">
        <File Id="System.Text.Json.dll" Name="System.Text.Json.dll" Source="$(var.SolutionDir)\Dependencies\GSF\System.Text.Json.dll">
          <netfx:NativeImage Id="ngen_System.Text.Json.dll"  Platform="64bit" Priority="0" AppBaseDirectory="INSTALLFOLDER"/>
        </File>
      </Component>
    </ComponentGroup>

    <!-- SQL CLR -->
    <ComponentGroup Id="SqlClrComponents" Directory="SQLCLRFOLDER">
      <Component Id="GSF.Core.SqlClr">
        <File Id="GSF.Core.SqlClr.dll" Name="GSF.Core.SqlClr.dll" Source="$(var.SolutionDir)\Dependencies\GSF\SqlClr\GSF.Core.SqlClr.dll" />
      </Component>
      <Component Id="openHistorian.SqlClr">
        <File Id="openHistorian.SqlClr.dll" Name="$(var.openHistorian.SqlClr.TargetFileName)" Source="$(var.openHistorian.SqlClr.TargetPath)" />
      </Component>
      <Component Id="openHistorian.Core.SqlClr">
        <File Id="openHistorian.Core.SqlClr.dll" Name="$(var.openHistorian.Core.SqlClr.TargetFileName)" Source="$(var.openHistorian.Core.SqlClr.TargetPath)" />
      </Component>
      <Component Id="GSF.SortedTreeStore.SqlClr">
        <File Id="GSF.SortedTreeStore.SqlClr.dll" Name="$(var.GSF.SortedTreeStore.SqlClr.TargetFileName)" Source="$(var.GSF.SortedTreeStore.SqlClr.TargetPath)" />
      </Component>
      <Component Id="EnableHistorianSqlClr">
        <File Id="EnableHistorianSqlClr.sql" Name="EnableHistorianSqlClr.sql" Source="$(var.openHistorian.SqlClr.ProjectDir)/EnableHistorianSqlClr.sql" />
      </Component>
    </ComponentGroup>

    <!-- MySQL Scripts -->
    <ComponentGroup Id="MySQLScriptComponents" Directory="MYSQLSCRIPTSFOLDER">
      <Component Id="MySQLAuditLog">
        <File Id="MySQLAuditLog.sql" Name="AuditLog.sql" Source="$(var.SolutionDir)\Data\MySQL\AuditLog.sql" />
      </Component>
      <Component Id="MySQLInitialDataSet">
        <File Id="MySQLInitialDataSet.sql" Name="InitialDataSet.sql" Source="$(var.SolutionDir)\Data\MySQL\InitialDataSet.sql" />
      </Component>
      <Component Id="MySQLopenHistorian">
        <File Id="MySQLopenHistorian.sql" Name="openHistorian.sql" Source="$(var.SolutionDir)\Data\MySQL\openHistorian.sql" />
      </Component>
      <Component Id="MySQLSampleDataSet">
        <File Id="MySQLSampleDataSet.sql" Name="SampleDataSet.sql" Source="$(var.SolutionDir)\Data\MySQL\SampleDataSet.sql" />
      </Component>
    </ComponentGroup>

    <!-- Oracle Scripts -->
    <ComponentGroup Id="OracleScriptComponents" Directory="ORACLESCRIPTSFOLDER">
      <Component Id="OracleAuditLog">
        <File Id="OracleAuditLog.sql" Name="AuditLog.sql" Source="$(var.SolutionDir)\Data\Oracle\AuditLog.sql" />
      </Component>
      <Component Id="OracleInitialDataSet">
        <File Id="OracleInitialDataSet.sql" Name="InitialDataSet.sql" Source="$(var.SolutionDir)\Data\Oracle\InitialDataSet.sql" />
      </Component>
      <Component Id="OracleopenHistorian">
        <File Id="OracleopenHistorian.sql" Name="openHistorian.sql" Source="$(var.SolutionDir)\Data\Oracle\openHistorian.sql" />
      </Component>
      <Component Id="OracleSampleDataSet">
        <File Id="OracleSampleDataSet.sql" Name="SampleDataSet.sql" Source="$(var.SolutionDir)\Data\Oracle\SampleDataSet.sql" />
      </Component>
    </ComponentGroup>

    <!-- Postgres Scripts -->
    <ComponentGroup Id="PostgresScriptComponents" Directory="POSTGRESSCRIPTSFOLDER">
      <Component Id="PostgresInitialDataSet">
        <File Id="PostgresInitialDataSet.sql" Name="InitialDataSet.sql" Source="$(var.SolutionDir)\Data\PostgreSQL\InitialDataSet.sql" />
      </Component>
      <Component Id="PostgresopenHistorian">
        <File Id="PostgresopenHistorian.sql" Name="openHistorian.sql" Source="$(var.SolutionDir)\Data\PostgreSQL\openHistorian.sql" />
      </Component>
      <Component Id="PostgresSampleDataSet">
        <File Id="PostgresSampleDataSet.sql" Name="SampleDataSet.sql" Source="$(var.SolutionDir)\Data\PostgreSQL\SampleDataSet.sql" />
      </Component>
    </ComponentGroup>

    <!-- SQL Server Scripts -->
    <ComponentGroup Id="SQLServerScriptComponents" Directory="SQLSERVERSCRIPTSFOLDER">
      <Component Id="SQLServerAuditLog">
        <File Id="SQLServerAuditLog.sql" Name="AuditLog.sql" Source="$(var.SolutionDir)\Data\SQL Server\AuditLog.sql" />
      </Component>
      <Component Id="SQLServerInitialDataSet">
        <File Id="SQLServerInitialDataSet.sql" Name="InitialDataSet.sql" Source="$(var.SolutionDir)\Data\SQL Server\InitialDataSet.sql" />
      </Component>
      <Component Id="SQLServeropenHistorian">
        <File Id="SQLServeropenHistorian.sql" Name="openHistorian.sql" Source="$(var.SolutionDir)\Data\SQL Server\openHistorian.sql" />
      </Component>
      <Component Id="SQLServerSampleDataSet">
        <File Id="SQLServerSampleDataSet.sql" Name="SampleDataSet.sql" Source="$(var.SolutionDir)\Data\SQL Server\SampleDataSet.sql" />
      </Component>
      <Component Id="SQLServerOscEvents">
        <File Id="SQLServerOscEvents.sql" Name="OscEvents.sql" Source="$(var.SolutionDir)\Data\SQL Server\OscEvents.sql" />
      </Component>    
    </ComponentGroup>

    <!-- SQLite Scripts -->
    <ComponentGroup Id="SQLiteScriptComponents" Directory="SQLITESCRIPTSFOLDER">
      <Component Id="sqlite3">
        <File Id="sqlite3.exe" Name="sqlite3.exe" Source="$(var.SolutionDir)\Data\SQLite\sqlite3.exe" />
      </Component>
      <Component Id="SQLiteInitialDataSetDB">
        <File Id="SQLiteInitialDataSet.db" Name="openHistorian-InitialDataSet.db" Source="$(var.SolutionDir)\Data\SQLite\openHistorian-InitialDataSet.db" />
      </Component>
      <Component Id="SQLiteopenHistorianDB">
        <File Id="SQLiteopenHistorian.db" Name="openHistorian.db" Source="$(var.SolutionDir)\Data\SQLite\openHistorian.db" />
      </Component>
      <Component Id="SQLiteSampleDataSetDB">
        <File Id="SQLiteSampleDataSet.db" Name="openHistorian-SampleDataSet.db" Source="$(var.SolutionDir)\Data\SQLite\openHistorian-SampleDataSet.db" />
      </Component>
      <Component Id="SQLiteInitialDataSet">
        <File Id="SQLiteInitialDataSet.sql" Name="InitialDataSet.sql" Source="$(var.SolutionDir)\Data\SQLite\InitialDataSet.sql" />
      </Component>
      <Component Id="SQLiteopenHistorian">
        <File Id="SQLiteopenHistorian.sql" Name="openHistorian.sql" Source="$(var.SolutionDir)\Data\SQLite\openHistorian.sql" />
      </Component>
      <Component Id="SQLiteSampleDataSet">
        <File Id="SQLiteSampleDataSet.sql" Name="SampleDataSet.sql" Source="$(var.SolutionDir)\Data\SQLite\SampleDataSet.sql" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!-- Custom Dialogs -->
  <Fragment>
    <UI>
      <!-- ServiceAccount Dialog -->
      <Dialog Id="ServiceAccountDialog" Width="370" Height="270" Title="[ProductName] Setup">
        <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="WixUI_Bmp_Banner" />
        <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>{\WixUI_Font_Title}Service Account</Text>
        </Control>
        <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>Enter the [ProductName] service account.</Text>
        </Control>
        <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
        <Control Id="ServiceAccountLabel" Type="Text" X="45" Y="73" Width="100" Height="15" TabSkip="no" Text="Service &amp;Account:" />
        <Control Id="ServiceAccountEdit" Type="Edit" X="45" Y="85" Width="220" Height="18" Property="SERVICEACCOUNT" Text="{80}" />
        <Control Id="ServicePasswordLabel" Type="Text" X="45" Y="113" Width="100" Height="15" TabSkip="no" Text="Service &amp;Password:" />
        <Control Id="ServicePasswordEdit" Type="Edit" X="45" Y="125" Width="220" Height="18" Property="SERVICEPASSWORD" Text="{80}" Password="yes" />
        <Control Id="ServicePasswordInfo" Type="Text" X="45" Y="153" Width="280" Height="30" Transparent="yes" NoPrefix="yes">
          <Text>NOTE: If the service account is LocalSystem or begins with NT AUTHORITY or NT SERVICE you may leave the password field blank.</Text>
        </Control>
        <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
        <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="&amp;Back">
          <Publish Event="NewDialog" Value="CustomizeDlg">1</Publish>
        </Control>
        <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="&amp;Next">
          <Publish Event="DoAction" Value="AuthenticateServiceAccountAction">1</Publish>
          <Publish Event="NewDialog" Value="ServiceAccountErrorDialog">NOT SERVICEAUTHENTICATED</Publish>
          <Publish Event="NewDialog" Value="CompanyInfoDialog">SERVICEAUTHENTICATED</Publish>
          <Publish Event="DoAction" Value="LoadExistingCompanyInfoAction" Order="2">SERVICEAUTHENTICATED</Publish>
        </Control>
        <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="Cancel">
          <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
        </Control>
      </Dialog>

      <!-- ServiceAccountError Dialog -->
      <Dialog Id="ServiceAccountErrorDialog" Width="370" Height="270" Title="[ProductName] Setup">
        <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="WixUI_Bmp_Banner" />
        <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>{\WixUI_Font_Title}Service Account</Text>
        </Control>
        <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>Setup encountered an error authenticating the service account.</Text>
        </Control>
        <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
        <Control Id="InfoLabel" Type="Text" X="45" Y="73" Width="280" Height="60" TabSkip="no">
          <Text>The service account entered could not be authorized. The username or password may have been entered incorrectly. To correct this, please click the "Back" button to go back to the previous step. To ignore this error and proceed with the installation, click the "Next" button.</Text>
        </Control>
        <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
        <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Default="yes" Text="&amp;Back">
          <Publish Event="NewDialog" Value="ServiceAccountDialog">1</Publish>
        </Control>
        <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="&amp;Next">
          <Publish Event="NewDialog" Value="CompanyInfoDialog">1</Publish>
        </Control>
        <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="Cancel">
          <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
        </Control>
      </Dialog>

      <!-- CompanyInfo Dialog -->
      <Dialog Id="CompanyInfoDialog" Width="370" Height="270" Title="[ProductName] Setup">
        <Control Id="BannerBitmap" Type="Bitmap" X="0" Y="0" Width="370" Height="44" TabSkip="no" Text="WixUI_Bmp_Banner" />
        <Control Id="Title" Type="Text" X="15" Y="6" Width="200" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>{\WixUI_Font_Title}Company Information</Text>
        </Control>
        <Control Id="Description" Type="Text" X="25" Y="23" Width="280" Height="15" Transparent="yes" NoPrefix="yes">
          <Text>Enter information for the company using [ProductName].</Text>
        </Control>
        <Control Id="BannerLine" Type="Line" X="0" Y="44" Width="370" Height="0" />
        <Control Id="CompanyNameLabel" Type="Text" X="45" Y="73" Width="100" Height="15" TabSkip="no" Text="Company &amp;Name:" />
        <Control Id="CompanyNameEdit" Type="Edit" X="45" Y="85" Width="220" Height="18" Property="COMPANYNAME" Text="{80}" />
        <Control Id="CompanyAcronymLabel" Type="Text" X="45" Y="113" Width="100" Height="15" TabSkip="no" Text="Company &amp;Acronym:" />
        <Control Id="CompanyAcronymEdit" Type="Edit" X="45" Y="125" Width="220" Height="18" Property="COMPANYACRONYM" Text="{80}" />
        <Control Id="SystemNameLabel" Type="Text" X="45" Y="153" Width="250" Height="15" TabSkip="no" Text="&amp;System Name: (e.g., a location name, dev or prod)" />
        <Control Id="SystemNameEdit" Type="Edit" X="45" Y="165" Width="220" Height="18" Property="SYSTEMNAME" Text="{80}" />
        <Control Id="BottomLine" Type="Line" X="0" Y="234" Width="370" Height="0" />
        <Control Id="Back" Type="PushButton" X="180" Y="243" Width="56" Height="17" Text="&amp;Back">
          <Publish Event="NewDialog" Value="ServiceAccountDialog">1</Publish>
        </Control>
        <Control Id="Next" Type="PushButton" X="236" Y="243" Width="56" Height="17" Default="yes" Text="&amp;Next">
          <Publish Event="NewDialog" Value="VerifyReadyDlg">1</Publish>
        </Control>
        <Control Id="Cancel" Type="PushButton" X="304" Y="243" Width="56" Height="17" Cancel="yes" Text="Cancel">
          <Publish Event="SpawnDialog" Value="CancelDlg">1</Publish>
        </Control>
      </Dialog>
    </UI>
  </Fragment>
</Wix>